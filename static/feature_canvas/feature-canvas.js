var sE=gn=>{throw TypeError(gn)};var V_=(gn,Dn,Pn)=>Dn.has(gn)||sE("Cannot "+Pn);var re=(gn,Dn,Pn)=>(V_(gn,Dn,"read from private field"),Pn?Pn.call(gn):Dn.get(gn)),rt=(gn,Dn,Pn)=>Dn.has(gn)?sE("Cannot add the same private member more than once"):Dn instanceof WeakSet?Dn.add(gn):Dn.set(gn,Pn),Ke=(gn,Dn,Pn,Io)=>(V_(gn,Dn,"write to private field"),Io?Io.call(gn,Pn):Dn.set(gn,Pn),Pn),kt=(gn,Dn,Pn)=>(V_(gn,Dn,"access private method"),Pn);var zh=(gn,Dn,Pn,Io)=>({set _(Et){Ke(gn,Dn,Et,Pn)},get _(){return re(gn,Dn,Io)}});(function(){"use strict";var ao,_g,_1,li,oo,Cl,y1,kl,io,Ml,v1,ci,x1,ui,Al,fr,di,es,iu,mi,Or,qa,b1,Hs,Dt,lu,ks,hi,Ol,wa,lo,cu,Tl,$l,fi,pi,co,Ll,Xt,Wu,K_,Y_,W_,G_,X_,Q_,Z_,rE,w1,uu,Wr,Ms,gi,Gr,Po,N1,Na,Tr,du,j1,ja,uo,Us,Sa,Ea,Rh,J_,S1,Xr,E1,jn,mo,ho,zl,Rl,fo,Dl,Pl,C1;function gn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Dn={exports:{}},Pn={},Io={exports:{}},Et={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ey;function aE(){if(ey)return Et;ey=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),h=Symbol.iterator;function m(H){return H===null||typeof H!="object"?null:(H=h&&H[h]||H["@@iterator"],typeof H=="function"?H:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,y={};function b(H,G,W){this.props=H,this.context=G,this.refs=y,this.updater=W||_}b.prototype.isReactComponent={},b.prototype.setState=function(H,G){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,G,"setState")},b.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function w(){}w.prototype=b.prototype;function E(H,G,W){this.props=H,this.context=G,this.refs=y,this.updater=W||_}var N=E.prototype=new w;N.constructor=E,v(N,b.prototype),N.isPureReactComponent=!0;var j=Array.isArray,C=Object.prototype.hasOwnProperty,M={current:null},z={key:!0,ref:!0,__self:!0,__source:!0};function D(H,G,W){var J,ee={},Z=null,K=null;if(G!=null)for(J in G.ref!==void 0&&(K=G.ref),G.key!==void 0&&(Z=""+G.key),G)C.call(G,J)&&!z.hasOwnProperty(J)&&(ee[J]=G[J]);var X=arguments.length-2;if(X===1)ee.children=W;else if(1<X){for(var Q=Array(X),ne=0;ne<X;ne++)Q[ne]=arguments[ne+2];ee.children=Q}if(H&&H.defaultProps)for(J in X=H.defaultProps,X)ee[J]===void 0&&(ee[J]=X[J]);return{$$typeof:e,type:H,key:Z,ref:K,props:ee,_owner:M.current}}function k(H,G){return{$$typeof:e,type:H.type,key:G,ref:H.ref,props:H.props,_owner:H._owner}}function T(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function A(H){var G={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(W){return G[W]})}var O=/\/+/g;function R(H,G){return typeof H=="object"&&H!==null&&H.key!=null?A(""+H.key):G.toString(36)}function L(H,G,W,J,ee){var Z=typeof H;(Z==="undefined"||Z==="boolean")&&(H=null);var K=!1;if(H===null)K=!0;else switch(Z){case"string":case"number":K=!0;break;case"object":switch(H.$$typeof){case e:case t:K=!0}}if(K)return K=H,ee=ee(K),H=J===""?"."+R(K,0):J,j(ee)?(W="",H!=null&&(W=H.replace(O,"$&/")+"/"),L(ee,G,W,"",function(ne){return ne})):ee!=null&&(T(ee)&&(ee=k(ee,W+(!ee.key||K&&K.key===ee.key?"":(""+ee.key).replace(O,"$&/")+"/")+H)),G.push(ee)),1;if(K=0,J=J===""?".":J+":",j(H))for(var X=0;X<H.length;X++){Z=H[X];var Q=J+R(Z,X);K+=L(Z,G,W,Q,ee)}else if(Q=m(H),typeof Q=="function")for(H=Q.call(H),X=0;!(Z=H.next()).done;)Z=Z.value,Q=J+R(Z,X++),K+=L(Z,G,W,Q,ee);else if(Z==="object")throw G=String(H),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.");return K}function F(H,G,W){if(H==null)return H;var J=[],ee=0;return L(H,J,"","",function(Z){return G.call(W,Z,ee++)}),J}function B(H){if(H._status===-1){var G=H._result;G=G(),G.then(function(W){(H._status===0||H._status===-1)&&(H._status=1,H._result=W)},function(W){(H._status===0||H._status===-1)&&(H._status=2,H._result=W)}),H._status===-1&&(H._status=0,H._result=G)}if(H._status===1)return H._result.default;throw H._result}var q={current:null},I={transition:null},U={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:I,ReactCurrentOwner:M};function V(){throw Error("act(...) is not supported in production builds of React.")}return Et.Children={map:F,forEach:function(H,G,W){F(H,function(){G.apply(this,arguments)},W)},count:function(H){var G=0;return F(H,function(){G++}),G},toArray:function(H){return F(H,function(G){return G})||[]},only:function(H){if(!T(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Et.Component=b,Et.Fragment=n,Et.Profiler=r,Et.PureComponent=E,Et.StrictMode=s,Et.Suspense=d,Et.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,Et.act=V,Et.cloneElement=function(H,G,W){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var J=v({},H.props),ee=H.key,Z=H.ref,K=H._owner;if(G!=null){if(G.ref!==void 0&&(Z=G.ref,K=M.current),G.key!==void 0&&(ee=""+G.key),H.type&&H.type.defaultProps)var X=H.type.defaultProps;for(Q in G)C.call(G,Q)&&!z.hasOwnProperty(Q)&&(J[Q]=G[Q]===void 0&&X!==void 0?X[Q]:G[Q])}var Q=arguments.length-2;if(Q===1)J.children=W;else if(1<Q){X=Array(Q);for(var ne=0;ne<Q;ne++)X[ne]=arguments[ne+2];J.children=X}return{$$typeof:e,type:H.type,key:ee,ref:Z,props:J,_owner:K}},Et.createContext=function(H){return H={$$typeof:l,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:i,_context:H},H.Consumer=H},Et.createElement=D,Et.createFactory=function(H){var G=D.bind(null,H);return G.type=H,G},Et.createRef=function(){return{current:null}},Et.forwardRef=function(H){return{$$typeof:u,render:H}},Et.isValidElement=T,Et.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:B}},Et.memo=function(H,G){return{$$typeof:f,type:H,compare:G===void 0?null:G}},Et.startTransition=function(H){var G=I.transition;I.transition={};try{H()}finally{I.transition=G}},Et.unstable_act=V,Et.useCallback=function(H,G){return q.current.useCallback(H,G)},Et.useContext=function(H){return q.current.useContext(H)},Et.useDebugValue=function(){},Et.useDeferredValue=function(H){return q.current.useDeferredValue(H)},Et.useEffect=function(H,G){return q.current.useEffect(H,G)},Et.useId=function(){return q.current.useId()},Et.useImperativeHandle=function(H,G,W){return q.current.useImperativeHandle(H,G,W)},Et.useInsertionEffect=function(H,G){return q.current.useInsertionEffect(H,G)},Et.useLayoutEffect=function(H,G){return q.current.useLayoutEffect(H,G)},Et.useMemo=function(H,G){return q.current.useMemo(H,G)},Et.useReducer=function(H,G,W){return q.current.useReducer(H,G,W)},Et.useRef=function(H){return q.current.useRef(H)},Et.useState=function(H){return q.current.useState(H)},Et.useSyncExternalStore=function(H,G,W){return q.current.useSyncExternalStore(H,G,W)},Et.useTransition=function(){return q.current.useTransition()},Et.version="18.3.1",Et}Io.exports=aE();var x=Io.exports;const ve=gn(x);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ty;function oE(){if(ty)return Pn;ty=1;var e=x,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,r=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function l(u,d,f){var p,h={},m=null,_=null;f!==void 0&&(m=""+f),d.key!==void 0&&(m=""+d.key),d.ref!==void 0&&(_=d.ref);for(p in d)s.call(d,p)&&!i.hasOwnProperty(p)&&(h[p]=d[p]);if(u&&u.defaultProps)for(p in d=u.defaultProps,d)h[p]===void 0&&(h[p]=d[p]);return{$$typeof:t,type:u,key:m,ref:_,props:h,_owner:r.current}}return Pn.Fragment=n,Pn.jsx=l,Pn.jsxs=l,Pn}Dn.exports=oE();var a=Dn.exports,Dh={},ny={exports:{}},Ps={},Ph={exports:{}},Ih={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sy;function iE(){return sy||(sy=1,function(e){function t(I,U){var V=I.length;I.push(U);e:for(;0<V;){var H=V-1>>>1,G=I[H];if(0<r(G,U))I[H]=U,I[V]=G,V=H;else break e}}function n(I){return I.length===0?null:I[0]}function s(I){if(I.length===0)return null;var U=I[0],V=I.pop();if(V!==U){I[0]=V;e:for(var H=0,G=I.length,W=G>>>1;H<W;){var J=2*(H+1)-1,ee=I[J],Z=J+1,K=I[Z];if(0>r(ee,V))Z<G&&0>r(K,ee)?(I[H]=K,I[Z]=V,H=Z):(I[H]=ee,I[J]=V,H=J);else if(Z<G&&0>r(K,V))I[H]=K,I[Z]=V,H=Z;else break e}}return U}function r(I,U){var V=I.sortIndex-U.sortIndex;return V!==0?V:I.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,u=l.now();e.unstable_now=function(){return l.now()-u}}var d=[],f=[],p=1,h=null,m=3,_=!1,v=!1,y=!1,b=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function N(I){for(var U=n(f);U!==null;){if(U.callback===null)s(f);else if(U.startTime<=I)s(f),U.sortIndex=U.expirationTime,t(d,U);else break;U=n(f)}}function j(I){if(y=!1,N(I),!v)if(n(d)!==null)v=!0,B(C);else{var U=n(f);U!==null&&q(j,U.startTime-I)}}function C(I,U){v=!1,y&&(y=!1,w(D),D=-1),_=!0;var V=m;try{for(N(U),h=n(d);h!==null&&(!(h.expirationTime>U)||I&&!A());){var H=h.callback;if(typeof H=="function"){h.callback=null,m=h.priorityLevel;var G=H(h.expirationTime<=U);U=e.unstable_now(),typeof G=="function"?h.callback=G:h===n(d)&&s(d),N(U)}else s(d);h=n(d)}if(h!==null)var W=!0;else{var J=n(f);J!==null&&q(j,J.startTime-U),W=!1}return W}finally{h=null,m=V,_=!1}}var M=!1,z=null,D=-1,k=5,T=-1;function A(){return!(e.unstable_now()-T<k)}function O(){if(z!==null){var I=e.unstable_now();T=I;var U=!0;try{U=z(!0,I)}finally{U?R():(M=!1,z=null)}}else M=!1}var R;if(typeof E=="function")R=function(){E(O)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,F=L.port2;L.port1.onmessage=O,R=function(){F.postMessage(null)}}else R=function(){b(O,0)};function B(I){z=I,M||(M=!0,R())}function q(I,U){D=b(function(){I(e.unstable_now())},U)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_continueExecution=function(){v||_||(v=!0,B(C))},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(I){switch(m){case 1:case 2:case 3:var U=3;break;default:U=m}var V=m;m=U;try{return I()}finally{m=V}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(I,U){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var V=m;m=I;try{return U()}finally{m=V}},e.unstable_scheduleCallback=function(I,U,V){var H=e.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?H+V:H):V=H,I){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=V+G,I={id:p++,callback:U,priorityLevel:I,startTime:V,expirationTime:G,sortIndex:-1},V>H?(I.sortIndex=V,t(f,I),n(d)===null&&I===n(f)&&(y?(w(D),D=-1):y=!0,q(j,V-H))):(I.sortIndex=G,t(d,I),v||_||(v=!0,B(C))),I},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(I){var U=m;return function(){var V=m;m=U;try{return I.apply(this,arguments)}finally{m=V}}}}(Ih)),Ih}var ry;function lE(){return ry||(ry=1,Ph.exports=iE()),Ph.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ay;function cE(){if(ay)return Ps;ay=1;var e=x,t=lE();function n(o){for(var c="https://reactjs.org/docs/error-decoder.html?invariant="+o,g=1;g<arguments.length;g++)c+="&args[]="+encodeURIComponent(arguments[g]);return"Minified React error #"+o+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,r={};function i(o,c){l(o,c),l(o+"Capture",c)}function l(o,c){for(r[o]=c,o=0;o<c.length;o++)s.add(c[o])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},h={};function m(o){return d.call(h,o)?!0:d.call(p,o)?!1:f.test(o)?h[o]=!0:(p[o]=!0,!1)}function _(o,c,g,S){if(g!==null&&g.type===0)return!1;switch(typeof c){case"function":case"symbol":return!0;case"boolean":return S?!1:g!==null?!g.acceptsBooleans:(o=o.toLowerCase().slice(0,5),o!=="data-"&&o!=="aria-");default:return!1}}function v(o,c,g,S){if(c===null||typeof c>"u"||_(o,c,g,S))return!0;if(S)return!1;if(g!==null)switch(g.type){case 3:return!c;case 4:return c===!1;case 5:return isNaN(c);case 6:return isNaN(c)||1>c}return!1}function y(o,c,g,S,$,P,Y){this.acceptsBooleans=c===2||c===3||c===4,this.attributeName=S,this.attributeNamespace=$,this.mustUseProperty=g,this.propertyName=o,this.type=c,this.sanitizeURL=P,this.removeEmptyString=Y}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(o){b[o]=new y(o,0,!1,o,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(o){var c=o[0];b[c]=new y(c,1,!1,o[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(o){b[o]=new y(o,2,!1,o.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(o){b[o]=new y(o,2,!1,o,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(o){b[o]=new y(o,3,!1,o.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(o){b[o]=new y(o,3,!0,o,null,!1,!1)}),["capture","download"].forEach(function(o){b[o]=new y(o,4,!1,o,null,!1,!1)}),["cols","rows","size","span"].forEach(function(o){b[o]=new y(o,6,!1,o,null,!1,!1)}),["rowSpan","start"].forEach(function(o){b[o]=new y(o,5,!1,o.toLowerCase(),null,!1,!1)});var w=/[\-:]([a-z])/g;function E(o){return o[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(o){var c=o.replace(w,E);b[c]=new y(c,1,!1,o,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(o){var c=o.replace(w,E);b[c]=new y(c,1,!1,o,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(o){var c=o.replace(w,E);b[c]=new y(c,1,!1,o,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(o){b[o]=new y(o,1,!1,o.toLowerCase(),null,!1,!1)}),b.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(o){b[o]=new y(o,1,!1,o.toLowerCase(),null,!0,!0)});function N(o,c,g,S){var $=b.hasOwnProperty(c)?b[c]:null;($!==null?$.type!==0:S||!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(v(c,g,$,S)&&(g=null),S||$===null?m(c)&&(g===null?o.removeAttribute(c):o.setAttribute(c,""+g)):$.mustUseProperty?o[$.propertyName]=g===null?$.type===3?!1:"":g:(c=$.attributeName,S=$.attributeNamespace,g===null?o.removeAttribute(c):($=$.type,g=$===3||$===4&&g===!0?"":""+g,S?o.setAttributeNS(S,c,g):o.setAttribute(c,g))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),M=Symbol.for("react.portal"),z=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),A=Symbol.for("react.context"),O=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),I=Symbol.iterator;function U(o){return o===null||typeof o!="object"?null:(o=I&&o[I]||o["@@iterator"],typeof o=="function"?o:null)}var V=Object.assign,H;function G(o){if(H===void 0)try{throw Error()}catch(g){var c=g.stack.trim().match(/\n( *(at )?)/);H=c&&c[1]||""}return`
`+H+o}var W=!1;function J(o,c){if(!o||W)return"";W=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(c)if(c=function(){throw Error()},Object.defineProperty(c.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(c,[])}catch(pe){var S=pe}Reflect.construct(o,[],c)}else{try{c.call()}catch(pe){S=pe}o.call(c.prototype)}else{try{throw Error()}catch(pe){S=pe}o()}}catch(pe){if(pe&&S&&typeof pe.stack=="string"){for(var $=pe.stack.split(`
`),P=S.stack.split(`
`),Y=$.length-1,se=P.length-1;1<=Y&&0<=se&&$[Y]!==P[se];)se--;for(;1<=Y&&0<=se;Y--,se--)if($[Y]!==P[se]){if(Y!==1||se!==1)do if(Y--,se--,0>se||$[Y]!==P[se]){var ae=`
`+$[Y].replace(" at new "," at ");return o.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",o.displayName)),ae}while(1<=Y&&0<=se);break}}}finally{W=!1,Error.prepareStackTrace=g}return(o=o?o.displayName||o.name:"")?G(o):""}function ee(o){switch(o.tag){case 5:return G(o.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return o=J(o.type,!1),o;case 11:return o=J(o.type.render,!1),o;case 1:return o=J(o.type,!0),o;default:return""}}function Z(o){if(o==null)return null;if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case z:return"Fragment";case M:return"Portal";case k:return"Profiler";case D:return"StrictMode";case R:return"Suspense";case L:return"SuspenseList"}if(typeof o=="object")switch(o.$$typeof){case A:return(o.displayName||"Context")+".Consumer";case T:return(o._context.displayName||"Context")+".Provider";case O:var c=o.render;return o=o.displayName,o||(o=c.displayName||c.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case F:return c=o.displayName||null,c!==null?c:Z(o.type)||"Memo";case B:c=o._payload,o=o._init;try{return Z(o(c))}catch{}}return null}function K(o){var c=o.type;switch(o.tag){case 24:return"Cache";case 9:return(c.displayName||"Context")+".Consumer";case 10:return(c._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return o=c.render,o=o.displayName||o.name||"",c.displayName||(o!==""?"ForwardRef("+o+")":"ForwardRef");case 7:return"Fragment";case 5:return c;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Z(c);case 8:return c===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof c=="function")return c.displayName||c.name||null;if(typeof c=="string")return c}return null}function X(o){switch(typeof o){case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function Q(o){var c=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(c==="checkbox"||c==="radio")}function ne(o){var c=Q(o)?"checked":"value",g=Object.getOwnPropertyDescriptor(o.constructor.prototype,c),S=""+o[c];if(!o.hasOwnProperty(c)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var $=g.get,P=g.set;return Object.defineProperty(o,c,{configurable:!0,get:function(){return $.call(this)},set:function(Y){S=""+Y,P.call(this,Y)}}),Object.defineProperty(o,c,{enumerable:g.enumerable}),{getValue:function(){return S},setValue:function(Y){S=""+Y},stopTracking:function(){o._valueTracker=null,delete o[c]}}}}function le(o){o._valueTracker||(o._valueTracker=ne(o))}function ce(o){if(!o)return!1;var c=o._valueTracker;if(!c)return!0;var g=c.getValue(),S="";return o&&(S=Q(o)?o.checked?"true":"false":o.value),o=S,o!==g?(c.setValue(o),!0):!1}function ie(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}function ge(o,c){var g=c.checked;return V({},c,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:g??o._wrapperState.initialChecked})}function Re(o,c){var g=c.defaultValue==null?"":c.defaultValue,S=c.checked!=null?c.checked:c.defaultChecked;g=X(c.value!=null?c.value:g),o._wrapperState={initialChecked:S,initialValue:g,controlled:c.type==="checkbox"||c.type==="radio"?c.checked!=null:c.value!=null}}function ze(o,c){c=c.checked,c!=null&&N(o,"checked",c,!1)}function me(o,c){ze(o,c);var g=X(c.value),S=c.type;if(g!=null)S==="number"?(g===0&&o.value===""||o.value!=g)&&(o.value=""+g):o.value!==""+g&&(o.value=""+g);else if(S==="submit"||S==="reset"){o.removeAttribute("value");return}c.hasOwnProperty("value")?Ce(o,c.type,g):c.hasOwnProperty("defaultValue")&&Ce(o,c.type,X(c.defaultValue)),c.checked==null&&c.defaultChecked!=null&&(o.defaultChecked=!!c.defaultChecked)}function xe(o,c,g){if(c.hasOwnProperty("value")||c.hasOwnProperty("defaultValue")){var S=c.type;if(!(S!=="submit"&&S!=="reset"||c.value!==void 0&&c.value!==null))return;c=""+o._wrapperState.initialValue,g||c===o.value||(o.value=c),o.defaultValue=c}g=o.name,g!==""&&(o.name=""),o.defaultChecked=!!o._wrapperState.initialChecked,g!==""&&(o.name=g)}function Ce(o,c,g){(c!=="number"||ie(o.ownerDocument)!==o)&&(g==null?o.defaultValue=""+o._wrapperState.initialValue:o.defaultValue!==""+g&&(o.defaultValue=""+g))}var Ae=Array.isArray;function Ve(o,c,g,S){if(o=o.options,c){c={};for(var $=0;$<g.length;$++)c["$"+g[$]]=!0;for(g=0;g<o.length;g++)$=c.hasOwnProperty("$"+o[g].value),o[g].selected!==$&&(o[g].selected=$),$&&S&&(o[g].defaultSelected=!0)}else{for(g=""+X(g),c=null,$=0;$<o.length;$++){if(o[$].value===g){o[$].selected=!0,S&&(o[$].defaultSelected=!0);return}c!==null||o[$].disabled||(c=o[$])}c!==null&&(c.selected=!0)}}function Se(o,c){if(c.dangerouslySetInnerHTML!=null)throw Error(n(91));return V({},c,{value:void 0,defaultValue:void 0,children:""+o._wrapperState.initialValue})}function We(o,c){var g=c.value;if(g==null){if(g=c.children,c=c.defaultValue,g!=null){if(c!=null)throw Error(n(92));if(Ae(g)){if(1<g.length)throw Error(n(93));g=g[0]}c=g}c==null&&(c=""),g=c}o._wrapperState={initialValue:X(g)}}function ht(o,c){var g=X(c.value),S=X(c.defaultValue);g!=null&&(g=""+g,g!==o.value&&(o.value=g),c.defaultValue==null&&o.defaultValue!==g&&(o.defaultValue=g)),S!=null&&(o.defaultValue=""+S)}function ye(o){var c=o.textContent;c===o._wrapperState.initialValue&&c!==""&&c!==null&&(o.value=c)}function Fe(o){switch(o){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qe(o,c){return o==null||o==="http://www.w3.org/1999/xhtml"?Fe(c):o==="http://www.w3.org/2000/svg"&&c==="foreignObject"?"http://www.w3.org/1999/xhtml":o}var tt,xt=function(o){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(c,g,S,$){MSApp.execUnsafeLocalFunction(function(){return o(c,g,S,$)})}:o}(function(o,c){if(o.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in o)o.innerHTML=c;else{for(tt=tt||document.createElement("div"),tt.innerHTML="<svg>"+c.valueOf().toString()+"</svg>",c=tt.firstChild;o.firstChild;)o.removeChild(o.firstChild);for(;c.firstChild;)o.appendChild(c.firstChild)}});function _t(o,c){if(c){var g=o.firstChild;if(g&&g===o.lastChild&&g.nodeType===3){g.nodeValue=c;return}}o.textContent=c}var Bt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$e=["Webkit","ms","Moz","O"];Object.keys(Bt).forEach(function(o){$e.forEach(function(c){c=c+o.charAt(0).toUpperCase()+o.substring(1),Bt[c]=Bt[o]})});function Ie(o,c,g){return c==null||typeof c=="boolean"||c===""?"":g||typeof c!="number"||c===0||Bt.hasOwnProperty(o)&&Bt[o]?(""+c).trim():c+"px"}function Be(o,c){o=o.style;for(var g in c)if(c.hasOwnProperty(g)){var S=g.indexOf("--")===0,$=Ie(g,c[g],S);g==="float"&&(g="cssFloat"),S?o.setProperty(g,$):o[g]=$}}var Ee=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lt(o,c){if(c){if(Ee[o]&&(c.children!=null||c.dangerouslySetInnerHTML!=null))throw Error(n(137,o));if(c.dangerouslySetInnerHTML!=null){if(c.children!=null)throw Error(n(60));if(typeof c.dangerouslySetInnerHTML!="object"||!("__html"in c.dangerouslySetInnerHTML))throw Error(n(61))}if(c.style!=null&&typeof c.style!="object")throw Error(n(62))}}function Je(o,c){if(o.indexOf("-")===-1)return typeof c.is=="string";switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ue=null;function Rt(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Yt=null,bt=null,Ot=null;function Pt(o){if(o=Li(o)){if(typeof Yt!="function")throw Error(n(280));var c=o.stateNode;c&&(c=Xl(c),Yt(o.stateNode,o.type,c))}}function wt(o){bt?Ot?Ot.push(o):Ot=[o]:bt=o}function pt(){if(bt){var o=bt,c=Ot;if(Ot=bt=null,Pt(o),c)for(o=0;o<c.length;o++)Pt(c[o])}}function rn(o,c){return o(c)}function Jt(){}var tn=!1;function Pe(o,c,g){if(tn)return o(c,g);tn=!0;try{return rn(o,c,g)}finally{tn=!1,(bt!==null||Ot!==null)&&(Jt(),pt())}}function Wt(o,c){var g=o.stateNode;if(g===null)return null;var S=Xl(g);if(S===null)return null;g=S[c];e:switch(c){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(S=!S.disabled)||(o=o.type,S=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!S;break e;default:o=!1}if(o)return null;if(g&&typeof g!="function")throw Error(n(231,c,typeof g));return g}var mn=!1;if(u)try{var Fn={};Object.defineProperty(Fn,"passive",{get:function(){mn=!0}}),window.addEventListener("test",Fn,Fn),window.removeEventListener("test",Fn,Fn)}catch{mn=!1}function Gt(o,c,g,S,$,P,Y,se,ae){var pe=Array.prototype.slice.call(arguments,3);try{c.apply(g,pe)}catch(je){this.onError(je)}}var jt=!1,Bn=null,ts=!1,Hn=null,Sn={onError:function(o){jt=!0,Bn=o}};function Un(o,c,g,S,$,P,Y,se,ae){jt=!1,Bn=null,Gt.apply(Sn,arguments)}function ns(o,c,g,S,$,P,Y,se,ae){if(Un.apply(this,arguments),jt){if(jt){var pe=Bn;jt=!1,Bn=null}else throw Error(n(198));ts||(ts=!0,Hn=pe)}}function cn(o){var c=o,g=o;if(o.alternate)for(;c.return;)c=c.return;else{o=c;do c=o,c.flags&4098&&(g=c.return),o=c.return;while(o)}return c.tag===3?g:null}function Mn(o){if(o.tag===13){var c=o.memoizedState;if(c===null&&(o=o.alternate,o!==null&&(c=o.memoizedState)),c!==null)return c.dehydrated}return null}function Mt(o){if(cn(o)!==o)throw Error(n(188))}function An(o){var c=o.alternate;if(!c){if(c=cn(o),c===null)throw Error(n(188));return c!==o?null:o}for(var g=o,S=c;;){var $=g.return;if($===null)break;var P=$.alternate;if(P===null){if(S=$.return,S!==null){g=S;continue}break}if($.child===P.child){for(P=$.child;P;){if(P===g)return Mt($),o;if(P===S)return Mt($),c;P=P.sibling}throw Error(n(188))}if(g.return!==S.return)g=$,S=P;else{for(var Y=!1,se=$.child;se;){if(se===g){Y=!0,g=$,S=P;break}if(se===S){Y=!0,S=$,g=P;break}se=se.sibling}if(!Y){for(se=P.child;se;){if(se===g){Y=!0,g=P,S=$;break}if(se===S){Y=!0,S=P,g=$;break}se=se.sibling}if(!Y)throw Error(n(189))}}if(g.alternate!==S)throw Error(n(190))}if(g.tag!==3)throw Error(n(188));return g.stateNode.current===g?o:c}function hs(o){return o=An(o),o!==null?Qn(o):null}function Qn(o){if(o.tag===5||o.tag===6)return o;for(o=o.child;o!==null;){var c=Qn(o);if(c!==null)return c;o=o.sibling}return null}var qs=t.unstable_scheduleCallback,Vs=t.unstable_cancelCallback,As=t.unstable_shouldYield,en=t.unstable_requestPaint,et=t.unstable_now,Qt=t.unstable_getCurrentPriorityLevel,ss=t.unstable_ImmediatePriority,Ks=t.unstable_UserBlockingPriority,Os=t.unstable_NormalPriority,Nt=t.unstable_LowPriority,vs=t.unstable_IdlePriority,de=null,be=null;function qe(o){if(be&&typeof be.onCommitFiberRoot=="function")try{be.onCommitFiberRoot(de,o,void 0,(o.current.flags&128)===128)}catch{}}var gt=Math.clz32?Math.clz32:Tt,Le=Math.log,Lt=Math.LN2;function Tt(o){return o>>>=0,o===0?32:31-(Le(o)/Lt|0)|0}var an=64,hn=4194304;function Ct(o){switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return o&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return o}}function On(o,c){var g=o.pendingLanes;if(g===0)return 0;var S=0,$=o.suspendedLanes,P=o.pingedLanes,Y=g&268435455;if(Y!==0){var se=Y&~$;se!==0?S=Ct(se):(P&=Y,P!==0&&(S=Ct(P)))}else Y=g&~$,Y!==0?S=Ct(Y):P!==0&&(S=Ct(P));if(S===0)return 0;if(c!==0&&c!==S&&!(c&$)&&($=S&-S,P=c&-c,$>=P||$===16&&(P&4194240)!==0))return c;if(S&4&&(S|=g&16),c=o.entangledLanes,c!==0)for(o=o.entanglements,c&=S;0<c;)g=31-gt(c),$=1<<g,S|=o[g],c&=~$;return S}function sr(o,c){switch(o){case 1:case 2:case 4:return c+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return c+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Tn(o,c){for(var g=o.suspendedLanes,S=o.pingedLanes,$=o.expirationTimes,P=o.pendingLanes;0<P;){var Y=31-gt(P),se=1<<Y,ae=$[Y];ae===-1?(!(se&g)||se&S)&&($[Y]=sr(se,c)):ae<=c&&(o.expiredLanes|=se),P&=~se}}function qn(o){return o=o.pendingLanes&-1073741825,o!==0?o:o&1073741824?1073741824:0}function Ys(){var o=an;return an<<=1,!(an&4194240)&&(an=64),o}function $n(o){for(var c=[],g=0;31>g;g++)c.push(o);return c}function rs(o,c,g){o.pendingLanes|=c,c!==536870912&&(o.suspendedLanes=0,o.pingedLanes=0),o=o.eventTimes,c=31-gt(c),o[c]=g}function Qr(o,c){var g=o.pendingLanes&~c;o.pendingLanes=c,o.suspendedLanes=0,o.pingedLanes=0,o.expiredLanes&=c,o.mutableReadLanes&=c,o.entangledLanes&=c,c=o.entanglements;var S=o.eventTimes;for(o=o.expirationTimes;0<g;){var $=31-gt(g),P=1<<$;c[$]=0,S[$]=-1,o[$]=-1,g&=~P}}function Ts(o,c){var g=o.entangledLanes|=c;for(o=o.entanglements;g;){var S=31-gt(g),$=1<<S;$&c|o[S]&c&&(o[S]|=c),g&=~$}}var It=0;function $r(o){return o&=-o,1<o?4<o?o&268435455?16:536870912:4:1}var Zr,Ca,Il,Lr,Fl,Jr=!1,ea=[],rr=null,ar=null,yt=null,St=new Map,zr=new Map,or=[],te="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function _e(o,c){switch(o){case"focusin":case"focusout":rr=null;break;case"dragenter":case"dragleave":ar=null;break;case"mouseover":case"mouseout":yt=null;break;case"pointerover":case"pointerout":St.delete(c.pointerId);break;case"gotpointercapture":case"lostpointercapture":zr.delete(c.pointerId)}}function fe(o,c,g,S,$,P){return o===null||o.nativeEvent!==P?(o={blockedOn:c,domEventName:g,eventSystemFlags:S,nativeEvent:P,targetContainers:[$]},c!==null&&(c=Li(c),c!==null&&Ca(c)),o):(o.eventSystemFlags|=S,c=o.targetContainers,$!==null&&c.indexOf($)===-1&&c.push($),o)}function De(o,c,g,S,$){switch(c){case"focusin":return rr=fe(rr,o,c,g,S,$),!0;case"dragenter":return ar=fe(ar,o,c,g,S,$),!0;case"mouseover":return yt=fe(yt,o,c,g,S,$),!0;case"pointerover":var P=$.pointerId;return St.set(P,fe(St.get(P)||null,o,c,g,S,$)),!0;case"gotpointercapture":return P=$.pointerId,zr.set(P,fe(zr.get(P)||null,o,c,g,S,$)),!0}return!1}function Me(o){var c=Ra(o.target);if(c!==null){var g=cn(c);if(g!==null){if(c=g.tag,c===13){if(c=Mn(g),c!==null){o.blockedOn=c,Fl(o.priority,function(){Il(g)});return}}else if(c===3&&g.stateNode.current.memoizedState.isDehydrated){o.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}o.blockedOn=null}function we(o){if(o.blockedOn!==null)return!1;for(var c=o.targetContainers;0<c.length;){var g=ir(o.domEventName,o.eventSystemFlags,c[0],o.nativeEvent);if(g===null){g=o.nativeEvent;var S=new g.constructor(g.type,g);Ue=S,g.target.dispatchEvent(S),Ue=null}else return c=Li(g),c!==null&&Ca(c),o.blockedOn=g,!1;c.shift()}return!0}function ft(o,c,g){we(o)&&g.delete(c)}function st(){Jr=!1,rr!==null&&we(rr)&&(rr=null),ar!==null&&we(ar)&&(ar=null),yt!==null&&we(yt)&&(yt=null),St.forEach(ft),zr.forEach(ft)}function Te(o,c){o.blockedOn===c&&(o.blockedOn=null,Jr||(Jr=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,st)))}function dt(o){function c($){return Te($,o)}if(0<ea.length){Te(ea[0],o);for(var g=1;g<ea.length;g++){var S=ea[g];S.blockedOn===o&&(S.blockedOn=null)}}for(rr!==null&&Te(rr,o),ar!==null&&Te(ar,o),yt!==null&&Te(yt,o),St.forEach(c),zr.forEach(c),g=0;g<or.length;g++)S=or[g],S.blockedOn===o&&(S.blockedOn=null);for(;0<or.length&&(g=or[0],g.blockedOn===null);)Me(g),g.blockedOn===null&&or.shift()}var ot=j.ReactCurrentBatchConfig,zt=!0;function Vn(o,c,g,S){var $=It,P=ot.transition;ot.transition=null;try{It=1,as(o,c,g,S)}finally{It=$,ot.transition=P}}function fn(o,c,g,S){var $=It,P=ot.transition;ot.transition=null;try{It=4,as(o,c,g,S)}finally{It=$,ot.transition=P}}function as(o,c,g,S){if(zt){var $=ir(o,c,g,S);if($===null)ju(o,c,S,pr,g),_e(o,S);else if(De($,o,c,g,S))S.stopPropagation();else if(_e(o,S),c&4&&-1<te.indexOf(o)){for(;$!==null;){var P=Li($);if(P!==null&&Zr(P),P=ir(o,c,g,S),P===null&&ju(o,c,S,pr,g),P===$)break;$=P}$!==null&&S.stopPropagation()}else ju(o,c,S,null,g)}}var pr=null;function ir(o,c,g,S){if(pr=null,o=Rt(S),o=Ra(o),o!==null)if(c=cn(o),c===null)o=null;else if(g=c.tag,g===13){if(o=Mn(c),o!==null)return o;o=null}else if(g===3){if(c.stateNode.current.memoizedState.isDehydrated)return c.tag===3?c.stateNode.containerInfo:null;o=null}else c!==o&&(o=null);return pr=o,null}function lr(o){switch(o){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Qt()){case ss:return 1;case Ks:return 4;case Os:case Nt:return 16;case vs:return 536870912;default:return 16}default:return 16}}var Kn=null,$s=null,yn=null;function Ls(){if(yn)return yn;var o,c=$s,g=c.length,S,$="value"in Kn?Kn.value:Kn.textContent,P=$.length;for(o=0;o<g&&c[o]===$[o];o++);var Y=g-o;for(S=1;S<=Y&&c[g-S]===$[P-S];S++);return yn=$.slice(o,1<S?1-S:void 0)}function ta(o){var c=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&c===13&&(o=13)):o=c,o===10&&(o=13),32<=o||o===13?o:0}function Rr(){return!0}function _i(){return!1}function os(o){function c(g,S,$,P,Y){this._reactName=g,this._targetInst=$,this.type=S,this.nativeEvent=P,this.target=Y,this.currentTarget=null;for(var se in o)o.hasOwnProperty(se)&&(g=o[se],this[se]=g?g(P):P[se]);return this.isDefaultPrevented=(P.defaultPrevented!=null?P.defaultPrevented:P.returnValue===!1)?Rr:_i,this.isPropagationStopped=_i,this}return V(c.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Rr)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Rr)},persist:function(){},isPersistent:Rr}),c}var gr={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},yi=os(gr),ka=V({},gr,{view:0,detail:0}),vi=os(ka),Ma,Ln,na,po=V({},ka,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Aa,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==na&&(na&&o.type==="mousemove"?(Ma=o.screenX-na.screenX,Ln=o.screenY-na.screenY):Ln=Ma=0,na=o),Ma)},movementY:function(o){return"movementY"in o?o.movementY:Ln}}),Bl=os(po),xi=V({},po,{dataTransfer:0}),En=os(xi),xs=V({},ka,{relatedTarget:0}),zs=os(xs),mu=V({},gr,{animationName:0,elapsedTime:0,pseudoElement:0}),Mm=os(mu),yg=V({},gr,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),vg=os(yg),hu=V({},gr,{data:0}),Am=os(hu),xg={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},bg={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wg={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function bi(o){var c=this.nativeEvent;return c.getModifierState?c.getModifierState(o):(o=wg[o])?!!c[o]:!1}function Aa(){return bi}var go=V({},ka,{key:function(o){if(o.key){var c=xg[o.key]||o.key;if(c!=="Unidentified")return c}return o.type==="keypress"?(o=ta(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?bg[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Aa,charCode:function(o){return o.type==="keypress"?ta(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?ta(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),wi=os(go),Ni=V({},po,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),_o=os(Ni),Ng=V({},ka,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Aa}),jg=os(Ng),Sg=V({},gr,{propertyName:0,elapsedTime:0,pseudoElement:0}),Om=os(Sg),Eg=V({},po,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),Cg=os(Eg),Tm=[9,13,27,32],Hl=u&&"CompositionEvent"in window,ji=null;u&&"documentMode"in document&&(ji=document.documentMode);var kg=u&&"TextEvent"in window&&!ji,fu=u&&(!Hl||ji&&8<ji&&11>=ji),pu=" ",Oa=!1;function gu(o,c){switch(o){case"keyup":return Tm.indexOf(c.keyCode)!==-1;case"keydown":return c.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $m(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var Ta=!1;function Lm(o,c){switch(o){case"compositionend":return $m(c);case"keypress":return c.which!==32?null:(Oa=!0,pu);case"textInput":return o=c.data,o===pu&&Oa?null:o;default:return null}}function Mg(o,c){if(Ta)return o==="compositionend"||!Hl&&gu(o,c)?(o=Ls(),yn=$s=Kn=null,Ta=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(c.ctrlKey||c.altKey||c.metaKey)||c.ctrlKey&&c.altKey){if(c.char&&1<c.char.length)return c.char;if(c.which)return String.fromCharCode(c.which)}return null;case"compositionend":return fu&&c.locale!=="ko"?null:c.data;default:return null}}var zm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function _u(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c==="input"?!!zm[o.type]:c==="textarea"}function Rm(o,c,g,S){wt(S),c=Wl(c,"onChange"),0<c.length&&(g=new yi("onChange","change",null,g,S),o.push({event:g,listeners:c}))}var yo=null,Ul=null;function Ag(o){Wm(o,0)}function ql(o){var c=So(o);if(ce(c))return o}function Og(o,c){if(o==="change")return c}var sa=!1;if(u){var Si;if(u){var Ei="oninput"in document;if(!Ei){var vo=document.createElement("div");vo.setAttribute("oninput","return;"),Ei=typeof vo.oninput=="function"}Si=Ei}else Si=!1;sa=Si&&(!document.documentMode||9<document.documentMode)}function Ci(){yo&&(yo.detachEvent("onpropertychange",$a),Ul=yo=null)}function $a(o){if(o.propertyName==="value"&&ql(Ul)){var c=[];Rm(c,Ul,o,Rt(o)),Pe(Ag,c)}}function La(o,c,g){o==="focusin"?(Ci(),yo=c,Ul=g,yo.attachEvent("onpropertychange",$a)):o==="focusout"&&Ci()}function Tg(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return ql(Ul)}function zn(o,c){if(o==="click")return ql(c)}function vn(o,c){if(o==="input"||o==="change")return ql(c)}function Ut(o,c){return o===c&&(o!==0||1/o===1/c)||o!==o&&c!==c}var xn=typeof Object.is=="function"?Object.is:Ut;function xo(o,c){if(xn(o,c))return!0;if(typeof o!="object"||o===null||typeof c!="object"||c===null)return!1;var g=Object.keys(o),S=Object.keys(c);if(g.length!==S.length)return!1;for(S=0;S<g.length;S++){var $=g[S];if(!d.call(c,$)||!xn(o[$],c[$]))return!1}return!0}function bn(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function Dm(o,c){var g=bn(o);o=0;for(var S;g;){if(g.nodeType===3){if(S=o+g.textContent.length,o<=c&&S>=c)return{node:g,offset:c-o};o=S}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=bn(g)}}function Pm(o,c){return o&&c?o===c?!0:o&&o.nodeType===3?!1:c&&c.nodeType===3?Pm(o,c.parentNode):"contains"in o?o.contains(c):o.compareDocumentPosition?!!(o.compareDocumentPosition(c)&16):!1:!1}function Im(){for(var o=window,c=ie();c instanceof o.HTMLIFrameElement;){try{var g=typeof c.contentWindow.location.href=="string"}catch{g=!1}if(g)o=c.contentWindow;else break;c=ie(o.document)}return c}function yu(o){var c=o&&o.nodeName&&o.nodeName.toLowerCase();return c&&(c==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||c==="textarea"||o.contentEditable==="true")}function $g(o){var c=Im(),g=o.focusedElem,S=o.selectionRange;if(c!==g&&g&&g.ownerDocument&&Pm(g.ownerDocument.documentElement,g)){if(S!==null&&yu(g)){if(c=S.start,o=S.end,o===void 0&&(o=c),"selectionStart"in g)g.selectionStart=c,g.selectionEnd=Math.min(o,g.value.length);else if(o=(c=g.ownerDocument||document)&&c.defaultView||window,o.getSelection){o=o.getSelection();var $=g.textContent.length,P=Math.min(S.start,$);S=S.end===void 0?P:Math.min(S.end,$),!o.extend&&P>S&&($=S,S=P,P=$),$=Dm(g,P);var Y=Dm(g,S);$&&Y&&(o.rangeCount!==1||o.anchorNode!==$.node||o.anchorOffset!==$.offset||o.focusNode!==Y.node||o.focusOffset!==Y.offset)&&(c=c.createRange(),c.setStart($.node,$.offset),o.removeAllRanges(),P>S?(o.addRange(c),o.extend(Y.node,Y.offset)):(c.setEnd(Y.node,Y.offset),o.addRange(c)))}}for(c=[],o=g;o=o.parentNode;)o.nodeType===1&&c.push({element:o,left:o.scrollLeft,top:o.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<c.length;g++)o=c[g],o.element.scrollLeft=o.left,o.element.scrollTop=o.top}}var Lg=u&&"documentMode"in document&&11>=document.documentMode,bo=null,vu=null,ki=null,xu=!1;function Fm(o,c,g){var S=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;xu||bo==null||bo!==ie(S)||(S=bo,"selectionStart"in S&&yu(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),ki&&xo(ki,S)||(ki=S,S=Wl(vu,"onSelect"),0<S.length&&(c=new yi("onSelect","select",null,c,g),o.push({event:c,listeners:S}),c.target=bo)))}function Vl(o,c){var g={};return g[o.toLowerCase()]=c.toLowerCase(),g["Webkit"+o]="webkit"+c,g["Moz"+o]="moz"+c,g}var wo={animationend:Vl("Animation","AnimationEnd"),animationiteration:Vl("Animation","AnimationIteration"),animationstart:Vl("Animation","AnimationStart"),transitionend:Vl("Transition","TransitionEnd")},bu={},Bm={};u&&(Bm=document.createElement("div").style,"AnimationEvent"in window||(delete wo.animationend.animation,delete wo.animationiteration.animation,delete wo.animationstart.animation),"TransitionEvent"in window||delete wo.transitionend.transition);function Kl(o){if(bu[o])return bu[o];if(!wo[o])return o;var c=wo[o],g;for(g in c)if(c.hasOwnProperty(g)&&g in Bm)return bu[o]=c[g];return o}var Hm=Kl("animationend"),zg=Kl("animationiteration"),Rg=Kl("animationstart"),ra=Kl("transitionend"),Um=new Map,qm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function aa(o,c){Um.set(o,c),i(c,[o])}for(var wu=0;wu<qm.length;wu++){var Mi=qm[wu],Vm=Mi.toLowerCase(),Dg=Mi[0].toUpperCase()+Mi.slice(1);aa(Vm,"on"+Dg)}aa(Hm,"onAnimationEnd"),aa(zg,"onAnimationIteration"),aa(Rg,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(ra,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ai="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Km=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ai));function Ym(o,c,g){var S=o.type||"unknown-event";o.currentTarget=g,ns(S,c,void 0,o),o.currentTarget=null}function Wm(o,c){c=(c&4)!==0;for(var g=0;g<o.length;g++){var S=o[g],$=S.event;S=S.listeners;e:{var P=void 0;if(c)for(var Y=S.length-1;0<=Y;Y--){var se=S[Y],ae=se.instance,pe=se.currentTarget;if(se=se.listener,ae!==P&&$.isPropagationStopped())break e;Ym($,se,pe),P=ae}else for(Y=0;Y<S.length;Y++){if(se=S[Y],ae=se.instance,pe=se.currentTarget,se=se.listener,ae!==P&&$.isPropagationStopped())break e;Ym($,se,pe),P=ae}}}if(ts)throw o=Hn,ts=!1,Hn=null,o}function on(o,c){var g=c[Au];g===void 0&&(g=c[Au]=new Set);var S=o+"__bubble";g.has(S)||(Gm(c,o,2,!1),g.add(S))}function Nu(o,c,g){var S=0;c&&(S|=4),Gm(g,o,S,c)}var Yl="_reactListening"+Math.random().toString(36).slice(2);function Oi(o){if(!o[Yl]){o[Yl]=!0,s.forEach(function(g){g!=="selectionchange"&&(Km.has(g)||Nu(g,!1,o),Nu(g,!0,o))});var c=o.nodeType===9?o:o.ownerDocument;c===null||c[Yl]||(c[Yl]=!0,Nu("selectionchange",!1,c))}}function Gm(o,c,g,S){switch(lr(c)){case 1:var $=Vn;break;case 4:$=fn;break;default:$=as}g=$.bind(null,c,g,o),$=void 0,!mn||c!=="touchstart"&&c!=="touchmove"&&c!=="wheel"||($=!0),S?$!==void 0?o.addEventListener(c,g,{capture:!0,passive:$}):o.addEventListener(c,g,!0):$!==void 0?o.addEventListener(c,g,{passive:$}):o.addEventListener(c,g,!1)}function ju(o,c,g,S,$){var P=S;if(!(c&1)&&!(c&2)&&S!==null)e:for(;;){if(S===null)return;var Y=S.tag;if(Y===3||Y===4){var se=S.stateNode.containerInfo;if(se===$||se.nodeType===8&&se.parentNode===$)break;if(Y===4)for(Y=S.return;Y!==null;){var ae=Y.tag;if((ae===3||ae===4)&&(ae=Y.stateNode.containerInfo,ae===$||ae.nodeType===8&&ae.parentNode===$))return;Y=Y.return}for(;se!==null;){if(Y=Ra(se),Y===null)return;if(ae=Y.tag,ae===5||ae===6){S=P=Y;continue e}se=se.parentNode}}S=S.return}Pe(function(){var pe=P,je=Rt(g),ke=[];e:{var Ne=Um.get(o);if(Ne!==void 0){var Ye=yi,Xe=o;switch(o){case"keypress":if(ta(g)===0)break e;case"keydown":case"keyup":Ye=wi;break;case"focusin":Xe="focus",Ye=zs;break;case"focusout":Xe="blur",Ye=zs;break;case"beforeblur":case"afterblur":Ye=zs;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=Bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=En;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=jg;break;case Hm:case zg:case Rg:Ye=Mm;break;case ra:Ye=Om;break;case"scroll":Ye=vi;break;case"wheel":Ye=Cg;break;case"copy":case"cut":case"paste":Ye=vg;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=_o}var Ze=(c&4)!==0,Rn=!Ze&&o==="scroll",ue=Ze?Ne!==null?Ne+"Capture":null:Ne;Ze=[];for(var oe=pe,he;oe!==null;){he=oe;var Oe=he.stateNode;if(he.tag===5&&Oe!==null&&(he=Oe,ue!==null&&(Oe=Wt(oe,ue),Oe!=null&&Ze.push(Ti(oe,Oe,he)))),Rn)break;oe=oe.return}0<Ze.length&&(Ne=new Ye(Ne,Xe,null,g,je),ke.push({event:Ne,listeners:Ze}))}}if(!(c&7)){e:{if(Ne=o==="mouseover"||o==="pointerover",Ye=o==="mouseout"||o==="pointerout",Ne&&g!==Ue&&(Xe=g.relatedTarget||g.fromElement)&&(Ra(Xe)||Xe[Dr]))break e;if((Ye||Ne)&&(Ne=je.window===je?je:(Ne=je.ownerDocument)?Ne.defaultView||Ne.parentWindow:window,Ye?(Xe=g.relatedTarget||g.toElement,Ye=pe,Xe=Xe?Ra(Xe):null,Xe!==null&&(Rn=cn(Xe),Xe!==Rn||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(Ye=null,Xe=pe),Ye!==Xe)){if(Ze=Bl,Oe="onMouseLeave",ue="onMouseEnter",oe="mouse",(o==="pointerout"||o==="pointerover")&&(Ze=_o,Oe="onPointerLeave",ue="onPointerEnter",oe="pointer"),Rn=Ye==null?Ne:So(Ye),he=Xe==null?Ne:So(Xe),Ne=new Ze(Oe,oe+"leave",Ye,g,je),Ne.target=Rn,Ne.relatedTarget=he,Oe=null,Ra(je)===pe&&(Ze=new Ze(ue,oe+"enter",Xe,g,je),Ze.target=he,Ze.relatedTarget=Rn,Oe=Ze),Rn=Oe,Ye&&Xe)t:{for(Ze=Ye,ue=Xe,oe=0,he=Ze;he;he=No(he))oe++;for(he=0,Oe=ue;Oe;Oe=No(Oe))he++;for(;0<oe-he;)Ze=No(Ze),oe--;for(;0<he-oe;)ue=No(ue),he--;for(;oe--;){if(Ze===ue||ue!==null&&Ze===ue.alternate)break t;Ze=No(Ze),ue=No(ue)}Ze=null}else Ze=null;Ye!==null&&Xm(ke,Ne,Ye,Ze,!1),Xe!==null&&Rn!==null&&Xm(ke,Rn,Xe,Ze,!0)}}e:{if(Ne=pe?So(pe):window,Ye=Ne.nodeName&&Ne.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&Ne.type==="file")var nt=Og;else if(_u(Ne))if(sa)nt=vn;else{nt=Tg;var ct=La}else(Ye=Ne.nodeName)&&Ye.toLowerCase()==="input"&&(Ne.type==="checkbox"||Ne.type==="radio")&&(nt=zn);if(nt&&(nt=nt(o,pe))){Rm(ke,nt,g,je);break e}ct&&ct(o,Ne,pe),o==="focusout"&&(ct=Ne._wrapperState)&&ct.controlled&&Ne.type==="number"&&Ce(Ne,"number",Ne.value)}switch(ct=pe?So(pe):window,o){case"focusin":(_u(ct)||ct.contentEditable==="true")&&(bo=ct,vu=pe,ki=null);break;case"focusout":ki=vu=bo=null;break;case"mousedown":xu=!0;break;case"contextmenu":case"mouseup":case"dragend":xu=!1,Fm(ke,g,je);break;case"selectionchange":if(Lg)break;case"keydown":case"keyup":Fm(ke,g,je)}var ut;if(Hl)e:{switch(o){case"compositionstart":var vt="onCompositionStart";break e;case"compositionend":vt="onCompositionEnd";break e;case"compositionupdate":vt="onCompositionUpdate";break e}vt=void 0}else Ta?gu(o,g)&&(vt="onCompositionEnd"):o==="keydown"&&g.keyCode===229&&(vt="onCompositionStart");vt&&(fu&&g.locale!=="ko"&&(Ta||vt!=="onCompositionStart"?vt==="onCompositionEnd"&&Ta&&(ut=Ls()):(Kn=je,$s="value"in Kn?Kn.value:Kn.textContent,Ta=!0)),ct=Wl(pe,vt),0<ct.length&&(vt=new Am(vt,o,null,g,je),ke.push({event:vt,listeners:ct}),ut?vt.data=ut:(ut=$m(g),ut!==null&&(vt.data=ut)))),(ut=kg?Lm(o,g):Mg(o,g))&&(pe=Wl(pe,"onBeforeInput"),0<pe.length&&(je=new Am("onBeforeInput","beforeinput",null,g,je),ke.push({event:je,listeners:pe}),je.data=ut))}Wm(ke,c)})}function Ti(o,c,g){return{instance:o,listener:c,currentTarget:g}}function Wl(o,c){for(var g=c+"Capture",S=[];o!==null;){var $=o,P=$.stateNode;$.tag===5&&P!==null&&($=P,P=Wt(o,g),P!=null&&S.unshift(Ti(o,P,$)),P=Wt(o,c),P!=null&&S.push(Ti(o,P,$))),o=o.return}return S}function No(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5);return o||null}function Xm(o,c,g,S,$){for(var P=c._reactName,Y=[];g!==null&&g!==S;){var se=g,ae=se.alternate,pe=se.stateNode;if(ae!==null&&ae===S)break;se.tag===5&&pe!==null&&(se=pe,$?(ae=Wt(g,P),ae!=null&&Y.unshift(Ti(g,ae,se))):$||(ae=Wt(g,P),ae!=null&&Y.push(Ti(g,ae,se)))),g=g.return}Y.length!==0&&o.push({event:c,listeners:Y})}var Pg=/\r\n?/g,Ig=/\u0000|\uFFFD/g;function Qm(o){return(typeof o=="string"?o:""+o).replace(Pg,`
`).replace(Ig,"")}function Su(o,c,g){if(c=Qm(c),Qm(o)!==c&&g)throw Error(n(425))}function Gl(){}var Zm=null,Eu=null;function Cu(o,c){return o==="textarea"||o==="noscript"||typeof c.children=="string"||typeof c.children=="number"||typeof c.dangerouslySetInnerHTML=="object"&&c.dangerouslySetInnerHTML!==null&&c.dangerouslySetInnerHTML.__html!=null}var ku=typeof setTimeout=="function"?setTimeout:void 0,Fg=typeof clearTimeout=="function"?clearTimeout:void 0,Jm=typeof Promise=="function"?Promise:void 0,Bg=typeof queueMicrotask=="function"?queueMicrotask:typeof Jm<"u"?function(o){return Jm.resolve(null).then(o).catch(Hg)}:ku;function Hg(o){setTimeout(function(){throw o})}function Mu(o,c){var g=c,S=0;do{var $=g.nextSibling;if(o.removeChild(g),$&&$.nodeType===8)if(g=$.data,g==="/$"){if(S===0){o.removeChild($),dt(c);return}S--}else g!=="$"&&g!=="$?"&&g!=="$!"||S++;g=$}while(g);dt(c)}function za(o){for(;o!=null;o=o.nextSibling){var c=o.nodeType;if(c===1||c===3)break;if(c===8){if(c=o.data,c==="$"||c==="$!"||c==="$?")break;if(c==="/$")return null}}return o}function eh(o){o=o.previousSibling;for(var c=0;o;){if(o.nodeType===8){var g=o.data;if(g==="$"||g==="$!"||g==="$?"){if(c===0)return o;c--}else g==="/$"&&c++}o=o.previousSibling}return null}var jo=Math.random().toString(36).slice(2),_r="__reactFiber$"+jo,$i="__reactProps$"+jo,Dr="__reactContainer$"+jo,Au="__reactEvents$"+jo,Ug="__reactListeners$"+jo,k1="__reactHandles$"+jo;function Ra(o){var c=o[_r];if(c)return c;for(var g=o.parentNode;g;){if(c=g[Dr]||g[_r]){if(g=c.alternate,c.child!==null||g!==null&&g.child!==null)for(o=eh(o);o!==null;){if(g=o[_r])return g;o=eh(o)}return c}o=g,g=o.parentNode}return null}function Li(o){return o=o[_r]||o[Dr],!o||o.tag!==5&&o.tag!==6&&o.tag!==13&&o.tag!==3?null:o}function So(o){if(o.tag===5||o.tag===6)return o.stateNode;throw Error(n(33))}function Xl(o){return o[$i]||null}var Ou=[],Eo=-1;function oa(o){return{current:o}}function ln(o){0>Eo||(o.current=Ou[Eo],Ou[Eo]=null,Eo--)}function nn(o,c){Eo++,Ou[Eo]=o.current,o.current=c}var ia={},is=oa(ia),bs=oa(!1),Da=ia;function Co(o,c){var g=o.type.contextTypes;if(!g)return ia;var S=o.stateNode;if(S&&S.__reactInternalMemoizedUnmaskedChildContext===c)return S.__reactInternalMemoizedMaskedChildContext;var $={},P;for(P in g)$[P]=c[P];return S&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=c,o.__reactInternalMemoizedMaskedChildContext=$),$}function ws(o){return o=o.childContextTypes,o!=null}function Ql(){ln(bs),ln(is)}function la(o,c,g){if(is.current!==ia)throw Error(n(168));nn(is,c),nn(bs,g)}function Zt(o,c,g){var S=o.stateNode;if(c=c.childContextTypes,typeof S.getChildContext!="function")return g;S=S.getChildContext();for(var $ in S)if(!($ in c))throw Error(n(108,K(o)||"Unknown",$));return V({},g,S)}function zi(o){return o=(o=o.stateNode)&&o.__reactInternalMemoizedMergedChildContext||ia,Da=is.current,nn(is,o),nn(bs,bs.current),!0}function Tu(o,c,g){var S=o.stateNode;if(!S)throw Error(n(169));g?(o=Zt(o,c,Da),S.__reactInternalMemoizedMergedChildContext=o,ln(bs),ln(is),nn(is,o)):ln(bs),nn(bs,g)}var yr=null,Ri=!1,Zl=!1;function $u(o){yr===null?yr=[o]:yr.push(o)}function th(o){Ri=!0,$u(o)}function mt(){if(!Zl&&yr!==null){Zl=!0;var o=0,c=It;try{var g=yr;for(It=1;o<g.length;o++){var S=g[o];do S=S(!0);while(S!==null)}yr=null,Ri=!1}catch($){throw yr!==null&&(yr=yr.slice(o+1)),qs(ss,mt),$}finally{It=c,Zl=!1}}return null}var fs=[],un=0,Yn=null,ko=0,vr=[],xr=0,Di=null,Pa=1,Ia="";function Pi(o,c){fs[un++]=ko,fs[un++]=Yn,Yn=o,ko=c}function M1(o,c,g){vr[xr++]=Pa,vr[xr++]=Ia,vr[xr++]=Di,Di=o;var S=Pa;o=Ia;var $=32-gt(S)-1;S&=~(1<<$),g+=1;var P=32-gt(c)+$;if(30<P){var Y=$-$%5;P=(S&(1<<Y)-1).toString(32),S>>=Y,$-=Y,Pa=1<<32-gt(c)+$|g<<$|S,Ia=P+o}else Pa=1<<P|g<<$|S,Ia=o}function qg(o){o.return!==null&&(Pi(o,1),M1(o,1,0))}function Vg(o){for(;o===Yn;)Yn=fs[--un],fs[un]=null,ko=fs[--un],fs[un]=null;for(;o===Di;)Di=vr[--xr],vr[xr]=null,Ia=vr[--xr],vr[xr]=null,Pa=vr[--xr],vr[xr]=null}var cr=null,ur=null,pn=!1,Pr=null;function A1(o,c){var g=jr(5,null,null,0);g.elementType="DELETED",g.stateNode=c,g.return=o,c=o.deletions,c===null?(o.deletions=[g],o.flags|=16):c.push(g)}function O1(o,c){switch(o.tag){case 5:var g=o.type;return c=c.nodeType!==1||g.toLowerCase()!==c.nodeName.toLowerCase()?null:c,c!==null?(o.stateNode=c,cr=o,ur=za(c.firstChild),!0):!1;case 6:return c=o.pendingProps===""||c.nodeType!==3?null:c,c!==null?(o.stateNode=c,cr=o,ur=null,!0):!1;case 13:return c=c.nodeType!==8?null:c,c!==null?(g=Di!==null?{id:Pa,overflow:Ia}:null,o.memoizedState={dehydrated:c,treeContext:g,retryLane:1073741824},g=jr(18,null,null,0),g.stateNode=c,g.return=o,o.child=g,cr=o,ur=null,!0):!1;default:return!1}}function Kg(o){return(o.mode&1)!==0&&(o.flags&128)===0}function Yg(o){if(pn){var c=ur;if(c){var g=c;if(!O1(o,c)){if(Kg(o))throw Error(n(418));c=za(g.nextSibling);var S=cr;c&&O1(o,c)?A1(S,g):(o.flags=o.flags&-4097|2,pn=!1,cr=o)}}else{if(Kg(o))throw Error(n(418));o.flags=o.flags&-4097|2,pn=!1,cr=o}}}function T1(o){for(o=o.return;o!==null&&o.tag!==5&&o.tag!==3&&o.tag!==13;)o=o.return;cr=o}function nh(o){if(o!==cr)return!1;if(!pn)return T1(o),pn=!0,!1;var c;if((c=o.tag!==3)&&!(c=o.tag!==5)&&(c=o.type,c=c!=="head"&&c!=="body"&&!Cu(o.type,o.memoizedProps)),c&&(c=ur)){if(Kg(o))throw $1(),Error(n(418));for(;c;)A1(o,c),c=za(c.nextSibling)}if(T1(o),o.tag===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,c=0;o;){if(o.nodeType===8){var g=o.data;if(g==="/$"){if(c===0){ur=za(o.nextSibling);break e}c--}else g!=="$"&&g!=="$!"&&g!=="$?"||c++}o=o.nextSibling}ur=null}}else ur=cr?za(o.stateNode.nextSibling):null;return!0}function $1(){for(var o=ur;o;)o=za(o.nextSibling)}function Jl(){ur=cr=null,pn=!1}function Wg(o){Pr===null?Pr=[o]:Pr.push(o)}var b8=j.ReactCurrentBatchConfig;function Lu(o,c,g){if(o=g.ref,o!==null&&typeof o!="function"&&typeof o!="object"){if(g._owner){if(g=g._owner,g){if(g.tag!==1)throw Error(n(309));var S=g.stateNode}if(!S)throw Error(n(147,o));var $=S,P=""+o;return c!==null&&c.ref!==null&&typeof c.ref=="function"&&c.ref._stringRef===P?c.ref:(c=function(Y){var se=$.refs;Y===null?delete se[P]:se[P]=Y},c._stringRef=P,c)}if(typeof o!="string")throw Error(n(284));if(!g._owner)throw Error(n(290,o))}return o}function sh(o,c){throw o=Object.prototype.toString.call(c),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(c).join(", ")+"}":o))}function L1(o){var c=o._init;return c(o._payload)}function z1(o){function c(ue,oe){if(o){var he=ue.deletions;he===null?(ue.deletions=[oe],ue.flags|=16):he.push(oe)}}function g(ue,oe){if(!o)return null;for(;oe!==null;)c(ue,oe),oe=oe.sibling;return null}function S(ue,oe){for(ue=new Map;oe!==null;)oe.key!==null?ue.set(oe.key,oe):ue.set(oe.index,oe),oe=oe.sibling;return ue}function $(ue,oe){return ue=Ro(ue,oe),ue.index=0,ue.sibling=null,ue}function P(ue,oe,he){return ue.index=he,o?(he=ue.alternate,he!==null?(he=he.index,he<oe?(ue.flags|=2,oe):he):(ue.flags|=2,oe)):(ue.flags|=1048576,oe)}function Y(ue){return o&&ue.alternate===null&&(ue.flags|=2),ue}function se(ue,oe,he,Oe){return oe===null||oe.tag!==6?(oe=I_(he,ue.mode,Oe),oe.return=ue,oe):(oe=$(oe,he),oe.return=ue,oe)}function ae(ue,oe,he,Oe){var nt=he.type;return nt===z?je(ue,oe,he.props.children,Oe,he.key):oe!==null&&(oe.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===B&&L1(nt)===oe.type)?(Oe=$(oe,he.props),Oe.ref=Lu(ue,oe,he),Oe.return=ue,Oe):(Oe=Ch(he.type,he.key,he.props,null,ue.mode,Oe),Oe.ref=Lu(ue,oe,he),Oe.return=ue,Oe)}function pe(ue,oe,he,Oe){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==he.containerInfo||oe.stateNode.implementation!==he.implementation?(oe=F_(he,ue.mode,Oe),oe.return=ue,oe):(oe=$(oe,he.children||[]),oe.return=ue,oe)}function je(ue,oe,he,Oe,nt){return oe===null||oe.tag!==7?(oe=Ki(he,ue.mode,Oe,nt),oe.return=ue,oe):(oe=$(oe,he),oe.return=ue,oe)}function ke(ue,oe,he){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=I_(""+oe,ue.mode,he),oe.return=ue,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case C:return he=Ch(oe.type,oe.key,oe.props,null,ue.mode,he),he.ref=Lu(ue,null,oe),he.return=ue,he;case M:return oe=F_(oe,ue.mode,he),oe.return=ue,oe;case B:var Oe=oe._init;return ke(ue,Oe(oe._payload),he)}if(Ae(oe)||U(oe))return oe=Ki(oe,ue.mode,he,null),oe.return=ue,oe;sh(ue,oe)}return null}function Ne(ue,oe,he,Oe){var nt=oe!==null?oe.key:null;if(typeof he=="string"&&he!==""||typeof he=="number")return nt!==null?null:se(ue,oe,""+he,Oe);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case C:return he.key===nt?ae(ue,oe,he,Oe):null;case M:return he.key===nt?pe(ue,oe,he,Oe):null;case B:return nt=he._init,Ne(ue,oe,nt(he._payload),Oe)}if(Ae(he)||U(he))return nt!==null?null:je(ue,oe,he,Oe,null);sh(ue,he)}return null}function Ye(ue,oe,he,Oe,nt){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number")return ue=ue.get(he)||null,se(oe,ue,""+Oe,nt);if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case C:return ue=ue.get(Oe.key===null?he:Oe.key)||null,ae(oe,ue,Oe,nt);case M:return ue=ue.get(Oe.key===null?he:Oe.key)||null,pe(oe,ue,Oe,nt);case B:var ct=Oe._init;return Ye(ue,oe,he,ct(Oe._payload),nt)}if(Ae(Oe)||U(Oe))return ue=ue.get(he)||null,je(oe,ue,Oe,nt,null);sh(oe,Oe)}return null}function Xe(ue,oe,he,Oe){for(var nt=null,ct=null,ut=oe,vt=oe=0,us=null;ut!==null&&vt<he.length;vt++){ut.index>vt?(us=ut,ut=null):us=ut.sibling;var Kt=Ne(ue,ut,he[vt],Oe);if(Kt===null){ut===null&&(ut=us);break}o&&ut&&Kt.alternate===null&&c(ue,ut),oe=P(Kt,oe,vt),ct===null?nt=Kt:ct.sibling=Kt,ct=Kt,ut=us}if(vt===he.length)return g(ue,ut),pn&&Pi(ue,vt),nt;if(ut===null){for(;vt<he.length;vt++)ut=ke(ue,he[vt],Oe),ut!==null&&(oe=P(ut,oe,vt),ct===null?nt=ut:ct.sibling=ut,ct=ut);return pn&&Pi(ue,vt),nt}for(ut=S(ue,ut);vt<he.length;vt++)us=Ye(ut,ue,vt,he[vt],Oe),us!==null&&(o&&us.alternate!==null&&ut.delete(us.key===null?vt:us.key),oe=P(us,oe,vt),ct===null?nt=us:ct.sibling=us,ct=us);return o&&ut.forEach(function(Do){return c(ue,Do)}),pn&&Pi(ue,vt),nt}function Ze(ue,oe,he,Oe){var nt=U(he);if(typeof nt!="function")throw Error(n(150));if(he=nt.call(he),he==null)throw Error(n(151));for(var ct=nt=null,ut=oe,vt=oe=0,us=null,Kt=he.next();ut!==null&&!Kt.done;vt++,Kt=he.next()){ut.index>vt?(us=ut,ut=null):us=ut.sibling;var Do=Ne(ue,ut,Kt.value,Oe);if(Do===null){ut===null&&(ut=us);break}o&&ut&&Do.alternate===null&&c(ue,ut),oe=P(Do,oe,vt),ct===null?nt=Do:ct.sibling=Do,ct=Do,ut=us}if(Kt.done)return g(ue,ut),pn&&Pi(ue,vt),nt;if(ut===null){for(;!Kt.done;vt++,Kt=he.next())Kt=ke(ue,Kt.value,Oe),Kt!==null&&(oe=P(Kt,oe,vt),ct===null?nt=Kt:ct.sibling=Kt,ct=Kt);return pn&&Pi(ue,vt),nt}for(ut=S(ue,ut);!Kt.done;vt++,Kt=he.next())Kt=Ye(ut,ue,vt,Kt.value,Oe),Kt!==null&&(o&&Kt.alternate!==null&&ut.delete(Kt.key===null?vt:Kt.key),oe=P(Kt,oe,vt),ct===null?nt=Kt:ct.sibling=Kt,ct=Kt);return o&&ut.forEach(function(e6){return c(ue,e6)}),pn&&Pi(ue,vt),nt}function Rn(ue,oe,he,Oe){if(typeof he=="object"&&he!==null&&he.type===z&&he.key===null&&(he=he.props.children),typeof he=="object"&&he!==null){switch(he.$$typeof){case C:e:{for(var nt=he.key,ct=oe;ct!==null;){if(ct.key===nt){if(nt=he.type,nt===z){if(ct.tag===7){g(ue,ct.sibling),oe=$(ct,he.props.children),oe.return=ue,ue=oe;break e}}else if(ct.elementType===nt||typeof nt=="object"&&nt!==null&&nt.$$typeof===B&&L1(nt)===ct.type){g(ue,ct.sibling),oe=$(ct,he.props),oe.ref=Lu(ue,ct,he),oe.return=ue,ue=oe;break e}g(ue,ct);break}else c(ue,ct);ct=ct.sibling}he.type===z?(oe=Ki(he.props.children,ue.mode,Oe,he.key),oe.return=ue,ue=oe):(Oe=Ch(he.type,he.key,he.props,null,ue.mode,Oe),Oe.ref=Lu(ue,oe,he),Oe.return=ue,ue=Oe)}return Y(ue);case M:e:{for(ct=he.key;oe!==null;){if(oe.key===ct)if(oe.tag===4&&oe.stateNode.containerInfo===he.containerInfo&&oe.stateNode.implementation===he.implementation){g(ue,oe.sibling),oe=$(oe,he.children||[]),oe.return=ue,ue=oe;break e}else{g(ue,oe);break}else c(ue,oe);oe=oe.sibling}oe=F_(he,ue.mode,Oe),oe.return=ue,ue=oe}return Y(ue);case B:return ct=he._init,Rn(ue,oe,ct(he._payload),Oe)}if(Ae(he))return Xe(ue,oe,he,Oe);if(U(he))return Ze(ue,oe,he,Oe);sh(ue,he)}return typeof he=="string"&&he!==""||typeof he=="number"?(he=""+he,oe!==null&&oe.tag===6?(g(ue,oe.sibling),oe=$(oe,he),oe.return=ue,ue=oe):(g(ue,oe),oe=I_(he,ue.mode,Oe),oe.return=ue,ue=oe),Y(ue)):g(ue,oe)}return Rn}var ec=z1(!0),R1=z1(!1),rh=oa(null),ah=null,tc=null,Gg=null;function Xg(){Gg=tc=ah=null}function Qg(o){var c=rh.current;ln(rh),o._currentValue=c}function Zg(o,c,g){for(;o!==null;){var S=o.alternate;if((o.childLanes&c)!==c?(o.childLanes|=c,S!==null&&(S.childLanes|=c)):S!==null&&(S.childLanes&c)!==c&&(S.childLanes|=c),o===g)break;o=o.return}}function nc(o,c){ah=o,Gg=tc=null,o=o.dependencies,o!==null&&o.firstContext!==null&&(o.lanes&c&&(Ws=!0),o.firstContext=null)}function br(o){var c=o._currentValue;if(Gg!==o)if(o={context:o,memoizedValue:c,next:null},tc===null){if(ah===null)throw Error(n(308));tc=o,ah.dependencies={lanes:0,firstContext:o}}else tc=tc.next=o;return c}var Ii=null;function Jg(o){Ii===null?Ii=[o]:Ii.push(o)}function D1(o,c,g,S){var $=c.interleaved;return $===null?(g.next=g,Jg(c)):(g.next=$.next,$.next=g),c.interleaved=g,Fa(o,S)}function Fa(o,c){o.lanes|=c;var g=o.alternate;for(g!==null&&(g.lanes|=c),g=o,o=o.return;o!==null;)o.childLanes|=c,g=o.alternate,g!==null&&(g.childLanes|=c),g=o,o=o.return;return g.tag===3?g.stateNode:null}var Mo=!1;function e_(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function P1(o,c){o=o.updateQueue,c.updateQueue===o&&(c.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,effects:o.effects})}function Ba(o,c){return{eventTime:o,lane:c,tag:0,payload:null,callback:null,next:null}}function Ao(o,c,g){var S=o.updateQueue;if(S===null)return null;if(S=S.shared,qt&2){var $=S.pending;return $===null?c.next=c:(c.next=$.next,$.next=c),S.pending=c,Fa(o,g)}return $=S.interleaved,$===null?(c.next=c,Jg(S)):(c.next=$.next,$.next=c),S.interleaved=c,Fa(o,g)}function oh(o,c,g){if(c=c.updateQueue,c!==null&&(c=c.shared,(g&4194240)!==0)){var S=c.lanes;S&=o.pendingLanes,g|=S,c.lanes=g,Ts(o,g)}}function I1(o,c){var g=o.updateQueue,S=o.alternate;if(S!==null&&(S=S.updateQueue,g===S)){var $=null,P=null;if(g=g.firstBaseUpdate,g!==null){do{var Y={eventTime:g.eventTime,lane:g.lane,tag:g.tag,payload:g.payload,callback:g.callback,next:null};P===null?$=P=Y:P=P.next=Y,g=g.next}while(g!==null);P===null?$=P=c:P=P.next=c}else $=P=c;g={baseState:S.baseState,firstBaseUpdate:$,lastBaseUpdate:P,shared:S.shared,effects:S.effects},o.updateQueue=g;return}o=g.lastBaseUpdate,o===null?g.firstBaseUpdate=c:o.next=c,g.lastBaseUpdate=c}function ih(o,c,g,S){var $=o.updateQueue;Mo=!1;var P=$.firstBaseUpdate,Y=$.lastBaseUpdate,se=$.shared.pending;if(se!==null){$.shared.pending=null;var ae=se,pe=ae.next;ae.next=null,Y===null?P=pe:Y.next=pe,Y=ae;var je=o.alternate;je!==null&&(je=je.updateQueue,se=je.lastBaseUpdate,se!==Y&&(se===null?je.firstBaseUpdate=pe:se.next=pe,je.lastBaseUpdate=ae))}if(P!==null){var ke=$.baseState;Y=0,je=pe=ae=null,se=P;do{var Ne=se.lane,Ye=se.eventTime;if((S&Ne)===Ne){je!==null&&(je=je.next={eventTime:Ye,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var Xe=o,Ze=se;switch(Ne=c,Ye=g,Ze.tag){case 1:if(Xe=Ze.payload,typeof Xe=="function"){ke=Xe.call(Ye,ke,Ne);break e}ke=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Ze.payload,Ne=typeof Xe=="function"?Xe.call(Ye,ke,Ne):Xe,Ne==null)break e;ke=V({},ke,Ne);break e;case 2:Mo=!0}}se.callback!==null&&se.lane!==0&&(o.flags|=64,Ne=$.effects,Ne===null?$.effects=[se]:Ne.push(se))}else Ye={eventTime:Ye,lane:Ne,tag:se.tag,payload:se.payload,callback:se.callback,next:null},je===null?(pe=je=Ye,ae=ke):je=je.next=Ye,Y|=Ne;if(se=se.next,se===null){if(se=$.shared.pending,se===null)break;Ne=se,se=Ne.next,Ne.next=null,$.lastBaseUpdate=Ne,$.shared.pending=null}}while(!0);if(je===null&&(ae=ke),$.baseState=ae,$.firstBaseUpdate=pe,$.lastBaseUpdate=je,c=$.shared.interleaved,c!==null){$=c;do Y|=$.lane,$=$.next;while($!==c)}else P===null&&($.shared.lanes=0);Hi|=Y,o.lanes=Y,o.memoizedState=ke}}function F1(o,c,g){if(o=c.effects,c.effects=null,o!==null)for(c=0;c<o.length;c++){var S=o[c],$=S.callback;if($!==null){if(S.callback=null,S=g,typeof $!="function")throw Error(n(191,$));$.call(S)}}}var zu={},ca=oa(zu),Ru=oa(zu),Du=oa(zu);function Fi(o){if(o===zu)throw Error(n(174));return o}function t_(o,c){switch(nn(Du,c),nn(Ru,o),nn(ca,zu),o=c.nodeType,o){case 9:case 11:c=(c=c.documentElement)?c.namespaceURI:Qe(null,"");break;default:o=o===8?c.parentNode:c,c=o.namespaceURI||null,o=o.tagName,c=Qe(c,o)}ln(ca),nn(ca,c)}function sc(){ln(ca),ln(Ru),ln(Du)}function B1(o){Fi(Du.current);var c=Fi(ca.current),g=Qe(c,o.type);c!==g&&(nn(Ru,o),nn(ca,g))}function n_(o){Ru.current===o&&(ln(ca),ln(Ru))}var wn=oa(0);function lh(o){for(var c=o;c!==null;){if(c.tag===13){var g=c.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||g.data==="$?"||g.data==="$!"))return c}else if(c.tag===19&&c.memoizedProps.revealOrder!==void 0){if(c.flags&128)return c}else if(c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return null;c=c.return}c.sibling.return=c.return,c=c.sibling}return null}var s_=[];function r_(){for(var o=0;o<s_.length;o++)s_[o]._workInProgressVersionPrimary=null;s_.length=0}var ch=j.ReactCurrentDispatcher,a_=j.ReactCurrentBatchConfig,Bi=0,Nn=null,Zn=null,ls=null,uh=!1,Pu=!1,Iu=0,w8=0;function Ns(){throw Error(n(321))}function o_(o,c){if(c===null)return!1;for(var g=0;g<c.length&&g<o.length;g++)if(!xn(o[g],c[g]))return!1;return!0}function i_(o,c,g,S,$,P){if(Bi=P,Nn=c,c.memoizedState=null,c.updateQueue=null,c.lanes=0,ch.current=o===null||o.memoizedState===null?E8:C8,o=g(S,$),Pu){P=0;do{if(Pu=!1,Iu=0,25<=P)throw Error(n(301));P+=1,ls=Zn=null,c.updateQueue=null,ch.current=k8,o=g(S,$)}while(Pu)}if(ch.current=hh,c=Zn!==null&&Zn.next!==null,Bi=0,ls=Zn=Nn=null,uh=!1,c)throw Error(n(300));return o}function l_(){var o=Iu!==0;return Iu=0,o}function ua(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ls===null?Nn.memoizedState=ls=o:ls=ls.next=o,ls}function wr(){if(Zn===null){var o=Nn.alternate;o=o!==null?o.memoizedState:null}else o=Zn.next;var c=ls===null?Nn.memoizedState:ls.next;if(c!==null)ls=c,Zn=o;else{if(o===null)throw Error(n(310));Zn=o,o={memoizedState:Zn.memoizedState,baseState:Zn.baseState,baseQueue:Zn.baseQueue,queue:Zn.queue,next:null},ls===null?Nn.memoizedState=ls=o:ls=ls.next=o}return ls}function Fu(o,c){return typeof c=="function"?c(o):c}function c_(o){var c=wr(),g=c.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=o;var S=Zn,$=S.baseQueue,P=g.pending;if(P!==null){if($!==null){var Y=$.next;$.next=P.next,P.next=Y}S.baseQueue=$=P,g.pending=null}if($!==null){P=$.next,S=S.baseState;var se=Y=null,ae=null,pe=P;do{var je=pe.lane;if((Bi&je)===je)ae!==null&&(ae=ae.next={lane:0,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null}),S=pe.hasEagerState?pe.eagerState:o(S,pe.action);else{var ke={lane:je,action:pe.action,hasEagerState:pe.hasEagerState,eagerState:pe.eagerState,next:null};ae===null?(se=ae=ke,Y=S):ae=ae.next=ke,Nn.lanes|=je,Hi|=je}pe=pe.next}while(pe!==null&&pe!==P);ae===null?Y=S:ae.next=se,xn(S,c.memoizedState)||(Ws=!0),c.memoizedState=S,c.baseState=Y,c.baseQueue=ae,g.lastRenderedState=S}if(o=g.interleaved,o!==null){$=o;do P=$.lane,Nn.lanes|=P,Hi|=P,$=$.next;while($!==o)}else $===null&&(g.lanes=0);return[c.memoizedState,g.dispatch]}function u_(o){var c=wr(),g=c.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=o;var S=g.dispatch,$=g.pending,P=c.memoizedState;if($!==null){g.pending=null;var Y=$=$.next;do P=o(P,Y.action),Y=Y.next;while(Y!==$);xn(P,c.memoizedState)||(Ws=!0),c.memoizedState=P,c.baseQueue===null&&(c.baseState=P),g.lastRenderedState=P}return[P,S]}function H1(){}function U1(o,c){var g=Nn,S=wr(),$=c(),P=!xn(S.memoizedState,$);if(P&&(S.memoizedState=$,Ws=!0),S=S.queue,d_(K1.bind(null,g,S,o),[o]),S.getSnapshot!==c||P||ls!==null&&ls.memoizedState.tag&1){if(g.flags|=2048,Bu(9,V1.bind(null,g,S,$,c),void 0,null),cs===null)throw Error(n(349));Bi&30||q1(g,c,$)}return $}function q1(o,c,g){o.flags|=16384,o={getSnapshot:c,value:g},c=Nn.updateQueue,c===null?(c={lastEffect:null,stores:null},Nn.updateQueue=c,c.stores=[o]):(g=c.stores,g===null?c.stores=[o]:g.push(o))}function V1(o,c,g,S){c.value=g,c.getSnapshot=S,Y1(c)&&W1(o)}function K1(o,c,g){return g(function(){Y1(c)&&W1(o)})}function Y1(o){var c=o.getSnapshot;o=o.value;try{var g=c();return!xn(o,g)}catch{return!0}}function W1(o){var c=Fa(o,1);c!==null&&Hr(c,o,1,-1)}function G1(o){var c=ua();return typeof o=="function"&&(o=o()),c.memoizedState=c.baseState=o,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fu,lastRenderedState:o},c.queue=o,o=o.dispatch=S8.bind(null,Nn,o),[c.memoizedState,o]}function Bu(o,c,g,S){return o={tag:o,create:c,destroy:g,deps:S,next:null},c=Nn.updateQueue,c===null?(c={lastEffect:null,stores:null},Nn.updateQueue=c,c.lastEffect=o.next=o):(g=c.lastEffect,g===null?c.lastEffect=o.next=o:(S=g.next,g.next=o,o.next=S,c.lastEffect=o)),o}function X1(){return wr().memoizedState}function dh(o,c,g,S){var $=ua();Nn.flags|=o,$.memoizedState=Bu(1|c,g,void 0,S===void 0?null:S)}function mh(o,c,g,S){var $=wr();S=S===void 0?null:S;var P=void 0;if(Zn!==null){var Y=Zn.memoizedState;if(P=Y.destroy,S!==null&&o_(S,Y.deps)){$.memoizedState=Bu(c,g,P,S);return}}Nn.flags|=o,$.memoizedState=Bu(1|c,g,P,S)}function Q1(o,c){return dh(8390656,8,o,c)}function d_(o,c){return mh(2048,8,o,c)}function Z1(o,c){return mh(4,2,o,c)}function J1(o,c){return mh(4,4,o,c)}function eS(o,c){if(typeof c=="function")return o=o(),c(o),function(){c(null)};if(c!=null)return o=o(),c.current=o,function(){c.current=null}}function tS(o,c,g){return g=g!=null?g.concat([o]):null,mh(4,4,eS.bind(null,c,o),g)}function m_(){}function nS(o,c){var g=wr();c=c===void 0?null:c;var S=g.memoizedState;return S!==null&&c!==null&&o_(c,S[1])?S[0]:(g.memoizedState=[o,c],o)}function sS(o,c){var g=wr();c=c===void 0?null:c;var S=g.memoizedState;return S!==null&&c!==null&&o_(c,S[1])?S[0]:(o=o(),g.memoizedState=[o,c],o)}function rS(o,c,g){return Bi&21?(xn(g,c)||(g=Ys(),Nn.lanes|=g,Hi|=g,o.baseState=!0),c):(o.baseState&&(o.baseState=!1,Ws=!0),o.memoizedState=g)}function N8(o,c){var g=It;It=g!==0&&4>g?g:4,o(!0);var S=a_.transition;a_.transition={};try{o(!1),c()}finally{It=g,a_.transition=S}}function aS(){return wr().memoizedState}function j8(o,c,g){var S=Lo(o);if(g={lane:S,action:g,hasEagerState:!1,eagerState:null,next:null},oS(o))iS(c,g);else if(g=D1(o,c,g,S),g!==null){var $=Ds();Hr(g,o,S,$),lS(g,c,S)}}function S8(o,c,g){var S=Lo(o),$={lane:S,action:g,hasEagerState:!1,eagerState:null,next:null};if(oS(o))iS(c,$);else{var P=o.alternate;if(o.lanes===0&&(P===null||P.lanes===0)&&(P=c.lastRenderedReducer,P!==null))try{var Y=c.lastRenderedState,se=P(Y,g);if($.hasEagerState=!0,$.eagerState=se,xn(se,Y)){var ae=c.interleaved;ae===null?($.next=$,Jg(c)):($.next=ae.next,ae.next=$),c.interleaved=$;return}}catch{}finally{}g=D1(o,c,$,S),g!==null&&($=Ds(),Hr(g,o,S,$),lS(g,c,S))}}function oS(o){var c=o.alternate;return o===Nn||c!==null&&c===Nn}function iS(o,c){Pu=uh=!0;var g=o.pending;g===null?c.next=c:(c.next=g.next,g.next=c),o.pending=c}function lS(o,c,g){if(g&4194240){var S=c.lanes;S&=o.pendingLanes,g|=S,c.lanes=g,Ts(o,g)}}var hh={readContext:br,useCallback:Ns,useContext:Ns,useEffect:Ns,useImperativeHandle:Ns,useInsertionEffect:Ns,useLayoutEffect:Ns,useMemo:Ns,useReducer:Ns,useRef:Ns,useState:Ns,useDebugValue:Ns,useDeferredValue:Ns,useTransition:Ns,useMutableSource:Ns,useSyncExternalStore:Ns,useId:Ns,unstable_isNewReconciler:!1},E8={readContext:br,useCallback:function(o,c){return ua().memoizedState=[o,c===void 0?null:c],o},useContext:br,useEffect:Q1,useImperativeHandle:function(o,c,g){return g=g!=null?g.concat([o]):null,dh(4194308,4,eS.bind(null,c,o),g)},useLayoutEffect:function(o,c){return dh(4194308,4,o,c)},useInsertionEffect:function(o,c){return dh(4,2,o,c)},useMemo:function(o,c){var g=ua();return c=c===void 0?null:c,o=o(),g.memoizedState=[o,c],o},useReducer:function(o,c,g){var S=ua();return c=g!==void 0?g(c):c,S.memoizedState=S.baseState=c,o={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:c},S.queue=o,o=o.dispatch=j8.bind(null,Nn,o),[S.memoizedState,o]},useRef:function(o){var c=ua();return o={current:o},c.memoizedState=o},useState:G1,useDebugValue:m_,useDeferredValue:function(o){return ua().memoizedState=o},useTransition:function(){var o=G1(!1),c=o[0];return o=N8.bind(null,o[1]),ua().memoizedState=o,[c,o]},useMutableSource:function(){},useSyncExternalStore:function(o,c,g){var S=Nn,$=ua();if(pn){if(g===void 0)throw Error(n(407));g=g()}else{if(g=c(),cs===null)throw Error(n(349));Bi&30||q1(S,c,g)}$.memoizedState=g;var P={value:g,getSnapshot:c};return $.queue=P,Q1(K1.bind(null,S,P,o),[o]),S.flags|=2048,Bu(9,V1.bind(null,S,P,g,c),void 0,null),g},useId:function(){var o=ua(),c=cs.identifierPrefix;if(pn){var g=Ia,S=Pa;g=(S&~(1<<32-gt(S)-1)).toString(32)+g,c=":"+c+"R"+g,g=Iu++,0<g&&(c+="H"+g.toString(32)),c+=":"}else g=w8++,c=":"+c+"r"+g.toString(32)+":";return o.memoizedState=c},unstable_isNewReconciler:!1},C8={readContext:br,useCallback:nS,useContext:br,useEffect:d_,useImperativeHandle:tS,useInsertionEffect:Z1,useLayoutEffect:J1,useMemo:sS,useReducer:c_,useRef:X1,useState:function(){return c_(Fu)},useDebugValue:m_,useDeferredValue:function(o){var c=wr();return rS(c,Zn.memoizedState,o)},useTransition:function(){var o=c_(Fu)[0],c=wr().memoizedState;return[o,c]},useMutableSource:H1,useSyncExternalStore:U1,useId:aS,unstable_isNewReconciler:!1},k8={readContext:br,useCallback:nS,useContext:br,useEffect:d_,useImperativeHandle:tS,useInsertionEffect:Z1,useLayoutEffect:J1,useMemo:sS,useReducer:u_,useRef:X1,useState:function(){return u_(Fu)},useDebugValue:m_,useDeferredValue:function(o){var c=wr();return Zn===null?c.memoizedState=o:rS(c,Zn.memoizedState,o)},useTransition:function(){var o=u_(Fu)[0],c=wr().memoizedState;return[o,c]},useMutableSource:H1,useSyncExternalStore:U1,useId:aS,unstable_isNewReconciler:!1};function Ir(o,c){if(o&&o.defaultProps){c=V({},c),o=o.defaultProps;for(var g in o)c[g]===void 0&&(c[g]=o[g]);return c}return c}function h_(o,c,g,S){c=o.memoizedState,g=g(S,c),g=g==null?c:V({},c,g),o.memoizedState=g,o.lanes===0&&(o.updateQueue.baseState=g)}var fh={isMounted:function(o){return(o=o._reactInternals)?cn(o)===o:!1},enqueueSetState:function(o,c,g){o=o._reactInternals;var S=Ds(),$=Lo(o),P=Ba(S,$);P.payload=c,g!=null&&(P.callback=g),c=Ao(o,P,$),c!==null&&(Hr(c,o,$,S),oh(c,o,$))},enqueueReplaceState:function(o,c,g){o=o._reactInternals;var S=Ds(),$=Lo(o),P=Ba(S,$);P.tag=1,P.payload=c,g!=null&&(P.callback=g),c=Ao(o,P,$),c!==null&&(Hr(c,o,$,S),oh(c,o,$))},enqueueForceUpdate:function(o,c){o=o._reactInternals;var g=Ds(),S=Lo(o),$=Ba(g,S);$.tag=2,c!=null&&($.callback=c),c=Ao(o,$,S),c!==null&&(Hr(c,o,S,g),oh(c,o,S))}};function cS(o,c,g,S,$,P,Y){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(S,P,Y):c.prototype&&c.prototype.isPureReactComponent?!xo(g,S)||!xo($,P):!0}function uS(o,c,g){var S=!1,$=ia,P=c.contextType;return typeof P=="object"&&P!==null?P=br(P):($=ws(c)?Da:is.current,S=c.contextTypes,P=(S=S!=null)?Co(o,$):ia),c=new c(g,P),o.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=fh,o.stateNode=c,c._reactInternals=o,S&&(o=o.stateNode,o.__reactInternalMemoizedUnmaskedChildContext=$,o.__reactInternalMemoizedMaskedChildContext=P),c}function dS(o,c,g,S){o=c.state,typeof c.componentWillReceiveProps=="function"&&c.componentWillReceiveProps(g,S),typeof c.UNSAFE_componentWillReceiveProps=="function"&&c.UNSAFE_componentWillReceiveProps(g,S),c.state!==o&&fh.enqueueReplaceState(c,c.state,null)}function f_(o,c,g,S){var $=o.stateNode;$.props=g,$.state=o.memoizedState,$.refs={},e_(o);var P=c.contextType;typeof P=="object"&&P!==null?$.context=br(P):(P=ws(c)?Da:is.current,$.context=Co(o,P)),$.state=o.memoizedState,P=c.getDerivedStateFromProps,typeof P=="function"&&(h_(o,c,P,g),$.state=o.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof $.getSnapshotBeforeUpdate=="function"||typeof $.UNSAFE_componentWillMount!="function"&&typeof $.componentWillMount!="function"||(c=$.state,typeof $.componentWillMount=="function"&&$.componentWillMount(),typeof $.UNSAFE_componentWillMount=="function"&&$.UNSAFE_componentWillMount(),c!==$.state&&fh.enqueueReplaceState($,$.state,null),ih(o,g,$,S),$.state=o.memoizedState),typeof $.componentDidMount=="function"&&(o.flags|=4194308)}function rc(o,c){try{var g="",S=c;do g+=ee(S),S=S.return;while(S);var $=g}catch(P){$=`
Error generating stack: `+P.message+`
`+P.stack}return{value:o,source:c,stack:$,digest:null}}function p_(o,c,g){return{value:o,source:null,stack:g??null,digest:c??null}}function g_(o,c){try{console.error(c.value)}catch(g){setTimeout(function(){throw g})}}var M8=typeof WeakMap=="function"?WeakMap:Map;function mS(o,c,g){g=Ba(-1,g),g.tag=3,g.payload={element:null};var S=c.value;return g.callback=function(){bh||(bh=!0,O_=S),g_(o,c)},g}function hS(o,c,g){g=Ba(-1,g),g.tag=3;var S=o.type.getDerivedStateFromError;if(typeof S=="function"){var $=c.value;g.payload=function(){return S($)},g.callback=function(){g_(o,c)}}var P=o.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(g.callback=function(){g_(o,c),typeof S!="function"&&(To===null?To=new Set([this]):To.add(this));var Y=c.stack;this.componentDidCatch(c.value,{componentStack:Y!==null?Y:""})}),g}function fS(o,c,g){var S=o.pingCache;if(S===null){S=o.pingCache=new M8;var $=new Set;S.set(c,$)}else $=S.get(c),$===void 0&&($=new Set,S.set(c,$));$.has(g)||($.add(g),o=U8.bind(null,o,c,g),c.then(o,o))}function pS(o){do{var c;if((c=o.tag===13)&&(c=o.memoizedState,c=c!==null?c.dehydrated!==null:!0),c)return o;o=o.return}while(o!==null);return null}function gS(o,c,g,S,$){return o.mode&1?(o.flags|=65536,o.lanes=$,o):(o===c?o.flags|=65536:(o.flags|=128,g.flags|=131072,g.flags&=-52805,g.tag===1&&(g.alternate===null?g.tag=17:(c=Ba(-1,1),c.tag=2,Ao(g,c,1))),g.lanes|=1),o)}var A8=j.ReactCurrentOwner,Ws=!1;function Rs(o,c,g,S){c.child=o===null?R1(c,null,g,S):ec(c,o.child,g,S)}function _S(o,c,g,S,$){g=g.render;var P=c.ref;return nc(c,$),S=i_(o,c,g,S,P,$),g=l_(),o!==null&&!Ws?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~$,Ha(o,c,$)):(pn&&g&&qg(c),c.flags|=1,Rs(o,c,S,$),c.child)}function yS(o,c,g,S,$){if(o===null){var P=g.type;return typeof P=="function"&&!P_(P)&&P.defaultProps===void 0&&g.compare===null&&g.defaultProps===void 0?(c.tag=15,c.type=P,vS(o,c,P,S,$)):(o=Ch(g.type,null,S,c,c.mode,$),o.ref=c.ref,o.return=c,c.child=o)}if(P=o.child,!(o.lanes&$)){var Y=P.memoizedProps;if(g=g.compare,g=g!==null?g:xo,g(Y,S)&&o.ref===c.ref)return Ha(o,c,$)}return c.flags|=1,o=Ro(P,S),o.ref=c.ref,o.return=c,c.child=o}function vS(o,c,g,S,$){if(o!==null){var P=o.memoizedProps;if(xo(P,S)&&o.ref===c.ref)if(Ws=!1,c.pendingProps=S=P,(o.lanes&$)!==0)o.flags&131072&&(Ws=!0);else return c.lanes=o.lanes,Ha(o,c,$)}return __(o,c,g,S,$)}function xS(o,c,g){var S=c.pendingProps,$=S.children,P=o!==null?o.memoizedState:null;if(S.mode==="hidden")if(!(c.mode&1))c.memoizedState={baseLanes:0,cachePool:null,transitions:null},nn(oc,dr),dr|=g;else{if(!(g&1073741824))return o=P!==null?P.baseLanes|g:g,c.lanes=c.childLanes=1073741824,c.memoizedState={baseLanes:o,cachePool:null,transitions:null},c.updateQueue=null,nn(oc,dr),dr|=o,null;c.memoizedState={baseLanes:0,cachePool:null,transitions:null},S=P!==null?P.baseLanes:g,nn(oc,dr),dr|=S}else P!==null?(S=P.baseLanes|g,c.memoizedState=null):S=g,nn(oc,dr),dr|=S;return Rs(o,c,$,g),c.child}function bS(o,c){var g=c.ref;(o===null&&g!==null||o!==null&&o.ref!==g)&&(c.flags|=512,c.flags|=2097152)}function __(o,c,g,S,$){var P=ws(g)?Da:is.current;return P=Co(c,P),nc(c,$),g=i_(o,c,g,S,P,$),S=l_(),o!==null&&!Ws?(c.updateQueue=o.updateQueue,c.flags&=-2053,o.lanes&=~$,Ha(o,c,$)):(pn&&S&&qg(c),c.flags|=1,Rs(o,c,g,$),c.child)}function wS(o,c,g,S,$){if(ws(g)){var P=!0;zi(c)}else P=!1;if(nc(c,$),c.stateNode===null)gh(o,c),uS(c,g,S),f_(c,g,S,$),S=!0;else if(o===null){var Y=c.stateNode,se=c.memoizedProps;Y.props=se;var ae=Y.context,pe=g.contextType;typeof pe=="object"&&pe!==null?pe=br(pe):(pe=ws(g)?Da:is.current,pe=Co(c,pe));var je=g.getDerivedStateFromProps,ke=typeof je=="function"||typeof Y.getSnapshotBeforeUpdate=="function";ke||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(se!==S||ae!==pe)&&dS(c,Y,S,pe),Mo=!1;var Ne=c.memoizedState;Y.state=Ne,ih(c,S,Y,$),ae=c.memoizedState,se!==S||Ne!==ae||bs.current||Mo?(typeof je=="function"&&(h_(c,g,je,S),ae=c.memoizedState),(se=Mo||cS(c,g,se,S,Ne,ae,pe))?(ke||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount()),typeof Y.componentDidMount=="function"&&(c.flags|=4194308)):(typeof Y.componentDidMount=="function"&&(c.flags|=4194308),c.memoizedProps=S,c.memoizedState=ae),Y.props=S,Y.state=ae,Y.context=pe,S=se):(typeof Y.componentDidMount=="function"&&(c.flags|=4194308),S=!1)}else{Y=c.stateNode,P1(o,c),se=c.memoizedProps,pe=c.type===c.elementType?se:Ir(c.type,se),Y.props=pe,ke=c.pendingProps,Ne=Y.context,ae=g.contextType,typeof ae=="object"&&ae!==null?ae=br(ae):(ae=ws(g)?Da:is.current,ae=Co(c,ae));var Ye=g.getDerivedStateFromProps;(je=typeof Ye=="function"||typeof Y.getSnapshotBeforeUpdate=="function")||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(se!==ke||Ne!==ae)&&dS(c,Y,S,ae),Mo=!1,Ne=c.memoizedState,Y.state=Ne,ih(c,S,Y,$);var Xe=c.memoizedState;se!==ke||Ne!==Xe||bs.current||Mo?(typeof Ye=="function"&&(h_(c,g,Ye,S),Xe=c.memoizedState),(pe=Mo||cS(c,g,pe,S,Ne,Xe,ae)||!1)?(je||typeof Y.UNSAFE_componentWillUpdate!="function"&&typeof Y.componentWillUpdate!="function"||(typeof Y.componentWillUpdate=="function"&&Y.componentWillUpdate(S,Xe,ae),typeof Y.UNSAFE_componentWillUpdate=="function"&&Y.UNSAFE_componentWillUpdate(S,Xe,ae)),typeof Y.componentDidUpdate=="function"&&(c.flags|=4),typeof Y.getSnapshotBeforeUpdate=="function"&&(c.flags|=1024)):(typeof Y.componentDidUpdate!="function"||se===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||se===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=1024),c.memoizedProps=S,c.memoizedState=Xe),Y.props=S,Y.state=Xe,Y.context=ae,S=pe):(typeof Y.componentDidUpdate!="function"||se===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||se===o.memoizedProps&&Ne===o.memoizedState||(c.flags|=1024),S=!1)}return y_(o,c,g,S,P,$)}function y_(o,c,g,S,$,P){bS(o,c);var Y=(c.flags&128)!==0;if(!S&&!Y)return $&&Tu(c,g,!1),Ha(o,c,P);S=c.stateNode,A8.current=c;var se=Y&&typeof g.getDerivedStateFromError!="function"?null:S.render();return c.flags|=1,o!==null&&Y?(c.child=ec(c,o.child,null,P),c.child=ec(c,null,se,P)):Rs(o,c,se,P),c.memoizedState=S.state,$&&Tu(c,g,!0),c.child}function NS(o){var c=o.stateNode;c.pendingContext?la(o,c.pendingContext,c.pendingContext!==c.context):c.context&&la(o,c.context,!1),t_(o,c.containerInfo)}function jS(o,c,g,S,$){return Jl(),Wg($),c.flags|=256,Rs(o,c,g,S),c.child}var v_={dehydrated:null,treeContext:null,retryLane:0};function x_(o){return{baseLanes:o,cachePool:null,transitions:null}}function SS(o,c,g){var S=c.pendingProps,$=wn.current,P=!1,Y=(c.flags&128)!==0,se;if((se=Y)||(se=o!==null&&o.memoizedState===null?!1:($&2)!==0),se?(P=!0,c.flags&=-129):(o===null||o.memoizedState!==null)&&($|=1),nn(wn,$&1),o===null)return Yg(c),o=c.memoizedState,o!==null&&(o=o.dehydrated,o!==null)?(c.mode&1?o.data==="$!"?c.lanes=8:c.lanes=1073741824:c.lanes=1,null):(Y=S.children,o=S.fallback,P?(S=c.mode,P=c.child,Y={mode:"hidden",children:Y},!(S&1)&&P!==null?(P.childLanes=0,P.pendingProps=Y):P=kh(Y,S,0,null),o=Ki(o,S,g,null),P.return=c,o.return=c,P.sibling=o,c.child=P,c.child.memoizedState=x_(g),c.memoizedState=v_,o):b_(c,Y));if($=o.memoizedState,$!==null&&(se=$.dehydrated,se!==null))return O8(o,c,Y,S,se,$,g);if(P){P=S.fallback,Y=c.mode,$=o.child,se=$.sibling;var ae={mode:"hidden",children:S.children};return!(Y&1)&&c.child!==$?(S=c.child,S.childLanes=0,S.pendingProps=ae,c.deletions=null):(S=Ro($,ae),S.subtreeFlags=$.subtreeFlags&14680064),se!==null?P=Ro(se,P):(P=Ki(P,Y,g,null),P.flags|=2),P.return=c,S.return=c,S.sibling=P,c.child=S,S=P,P=c.child,Y=o.child.memoizedState,Y=Y===null?x_(g):{baseLanes:Y.baseLanes|g,cachePool:null,transitions:Y.transitions},P.memoizedState=Y,P.childLanes=o.childLanes&~g,c.memoizedState=v_,S}return P=o.child,o=P.sibling,S=Ro(P,{mode:"visible",children:S.children}),!(c.mode&1)&&(S.lanes=g),S.return=c,S.sibling=null,o!==null&&(g=c.deletions,g===null?(c.deletions=[o],c.flags|=16):g.push(o)),c.child=S,c.memoizedState=null,S}function b_(o,c){return c=kh({mode:"visible",children:c},o.mode,0,null),c.return=o,o.child=c}function ph(o,c,g,S){return S!==null&&Wg(S),ec(c,o.child,null,g),o=b_(c,c.pendingProps.children),o.flags|=2,c.memoizedState=null,o}function O8(o,c,g,S,$,P,Y){if(g)return c.flags&256?(c.flags&=-257,S=p_(Error(n(422))),ph(o,c,Y,S)):c.memoizedState!==null?(c.child=o.child,c.flags|=128,null):(P=S.fallback,$=c.mode,S=kh({mode:"visible",children:S.children},$,0,null),P=Ki(P,$,Y,null),P.flags|=2,S.return=c,P.return=c,S.sibling=P,c.child=S,c.mode&1&&ec(c,o.child,null,Y),c.child.memoizedState=x_(Y),c.memoizedState=v_,P);if(!(c.mode&1))return ph(o,c,Y,null);if($.data==="$!"){if(S=$.nextSibling&&$.nextSibling.dataset,S)var se=S.dgst;return S=se,P=Error(n(419)),S=p_(P,S,void 0),ph(o,c,Y,S)}if(se=(Y&o.childLanes)!==0,Ws||se){if(S=cs,S!==null){switch(Y&-Y){case 4:$=2;break;case 16:$=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:$=32;break;case 536870912:$=268435456;break;default:$=0}$=$&(S.suspendedLanes|Y)?0:$,$!==0&&$!==P.retryLane&&(P.retryLane=$,Fa(o,$),Hr(S,o,$,-1))}return D_(),S=p_(Error(n(421))),ph(o,c,Y,S)}return $.data==="$?"?(c.flags|=128,c.child=o.child,c=q8.bind(null,o),$._reactRetry=c,null):(o=P.treeContext,ur=za($.nextSibling),cr=c,pn=!0,Pr=null,o!==null&&(vr[xr++]=Pa,vr[xr++]=Ia,vr[xr++]=Di,Pa=o.id,Ia=o.overflow,Di=c),c=b_(c,S.children),c.flags|=4096,c)}function ES(o,c,g){o.lanes|=c;var S=o.alternate;S!==null&&(S.lanes|=c),Zg(o.return,c,g)}function w_(o,c,g,S,$){var P=o.memoizedState;P===null?o.memoizedState={isBackwards:c,rendering:null,renderingStartTime:0,last:S,tail:g,tailMode:$}:(P.isBackwards=c,P.rendering=null,P.renderingStartTime=0,P.last=S,P.tail=g,P.tailMode=$)}function CS(o,c,g){var S=c.pendingProps,$=S.revealOrder,P=S.tail;if(Rs(o,c,S.children,g),S=wn.current,S&2)S=S&1|2,c.flags|=128;else{if(o!==null&&o.flags&128)e:for(o=c.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&ES(o,g,c);else if(o.tag===19)ES(o,g,c);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===c)break e;for(;o.sibling===null;){if(o.return===null||o.return===c)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}S&=1}if(nn(wn,S),!(c.mode&1))c.memoizedState=null;else switch($){case"forwards":for(g=c.child,$=null;g!==null;)o=g.alternate,o!==null&&lh(o)===null&&($=g),g=g.sibling;g=$,g===null?($=c.child,c.child=null):($=g.sibling,g.sibling=null),w_(c,!1,$,g,P);break;case"backwards":for(g=null,$=c.child,c.child=null;$!==null;){if(o=$.alternate,o!==null&&lh(o)===null){c.child=$;break}o=$.sibling,$.sibling=g,g=$,$=o}w_(c,!0,g,null,P);break;case"together":w_(c,!1,null,null,void 0);break;default:c.memoizedState=null}return c.child}function gh(o,c){!(c.mode&1)&&o!==null&&(o.alternate=null,c.alternate=null,c.flags|=2)}function Ha(o,c,g){if(o!==null&&(c.dependencies=o.dependencies),Hi|=c.lanes,!(g&c.childLanes))return null;if(o!==null&&c.child!==o.child)throw Error(n(153));if(c.child!==null){for(o=c.child,g=Ro(o,o.pendingProps),c.child=g,g.return=c;o.sibling!==null;)o=o.sibling,g=g.sibling=Ro(o,o.pendingProps),g.return=c;g.sibling=null}return c.child}function T8(o,c,g){switch(c.tag){case 3:NS(c),Jl();break;case 5:B1(c);break;case 1:ws(c.type)&&zi(c);break;case 4:t_(c,c.stateNode.containerInfo);break;case 10:var S=c.type._context,$=c.memoizedProps.value;nn(rh,S._currentValue),S._currentValue=$;break;case 13:if(S=c.memoizedState,S!==null)return S.dehydrated!==null?(nn(wn,wn.current&1),c.flags|=128,null):g&c.child.childLanes?SS(o,c,g):(nn(wn,wn.current&1),o=Ha(o,c,g),o!==null?o.sibling:null);nn(wn,wn.current&1);break;case 19:if(S=(g&c.childLanes)!==0,o.flags&128){if(S)return CS(o,c,g);c.flags|=128}if($=c.memoizedState,$!==null&&($.rendering=null,$.tail=null,$.lastEffect=null),nn(wn,wn.current),S)break;return null;case 22:case 23:return c.lanes=0,xS(o,c,g)}return Ha(o,c,g)}var kS,N_,MS,AS;kS=function(o,c){for(var g=c.child;g!==null;){if(g.tag===5||g.tag===6)o.appendChild(g.stateNode);else if(g.tag!==4&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===c)break;for(;g.sibling===null;){if(g.return===null||g.return===c)return;g=g.return}g.sibling.return=g.return,g=g.sibling}},N_=function(){},MS=function(o,c,g,S){var $=o.memoizedProps;if($!==S){o=c.stateNode,Fi(ca.current);var P=null;switch(g){case"input":$=ge(o,$),S=ge(o,S),P=[];break;case"select":$=V({},$,{value:void 0}),S=V({},S,{value:void 0}),P=[];break;case"textarea":$=Se(o,$),S=Se(o,S),P=[];break;default:typeof $.onClick!="function"&&typeof S.onClick=="function"&&(o.onclick=Gl)}lt(g,S);var Y;g=null;for(pe in $)if(!S.hasOwnProperty(pe)&&$.hasOwnProperty(pe)&&$[pe]!=null)if(pe==="style"){var se=$[pe];for(Y in se)se.hasOwnProperty(Y)&&(g||(g={}),g[Y]="")}else pe!=="dangerouslySetInnerHTML"&&pe!=="children"&&pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&pe!=="autoFocus"&&(r.hasOwnProperty(pe)?P||(P=[]):(P=P||[]).push(pe,null));for(pe in S){var ae=S[pe];if(se=$!=null?$[pe]:void 0,S.hasOwnProperty(pe)&&ae!==se&&(ae!=null||se!=null))if(pe==="style")if(se){for(Y in se)!se.hasOwnProperty(Y)||ae&&ae.hasOwnProperty(Y)||(g||(g={}),g[Y]="");for(Y in ae)ae.hasOwnProperty(Y)&&se[Y]!==ae[Y]&&(g||(g={}),g[Y]=ae[Y])}else g||(P||(P=[]),P.push(pe,g)),g=ae;else pe==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,se=se?se.__html:void 0,ae!=null&&se!==ae&&(P=P||[]).push(pe,ae)):pe==="children"?typeof ae!="string"&&typeof ae!="number"||(P=P||[]).push(pe,""+ae):pe!=="suppressContentEditableWarning"&&pe!=="suppressHydrationWarning"&&(r.hasOwnProperty(pe)?(ae!=null&&pe==="onScroll"&&on("scroll",o),P||se===ae||(P=[])):(P=P||[]).push(pe,ae))}g&&(P=P||[]).push("style",g);var pe=P;(c.updateQueue=pe)&&(c.flags|=4)}},AS=function(o,c,g,S){g!==S&&(c.flags|=4)};function Hu(o,c){if(!pn)switch(o.tailMode){case"hidden":c=o.tail;for(var g=null;c!==null;)c.alternate!==null&&(g=c),c=c.sibling;g===null?o.tail=null:g.sibling=null;break;case"collapsed":g=o.tail;for(var S=null;g!==null;)g.alternate!==null&&(S=g),g=g.sibling;S===null?c||o.tail===null?o.tail=null:o.tail.sibling=null:S.sibling=null}}function js(o){var c=o.alternate!==null&&o.alternate.child===o.child,g=0,S=0;if(c)for(var $=o.child;$!==null;)g|=$.lanes|$.childLanes,S|=$.subtreeFlags&14680064,S|=$.flags&14680064,$.return=o,$=$.sibling;else for($=o.child;$!==null;)g|=$.lanes|$.childLanes,S|=$.subtreeFlags,S|=$.flags,$.return=o,$=$.sibling;return o.subtreeFlags|=S,o.childLanes=g,c}function $8(o,c,g){var S=c.pendingProps;switch(Vg(c),c.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return js(c),null;case 1:return ws(c.type)&&Ql(),js(c),null;case 3:return S=c.stateNode,sc(),ln(bs),ln(is),r_(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(o===null||o.child===null)&&(nh(c)?c.flags|=4:o===null||o.memoizedState.isDehydrated&&!(c.flags&256)||(c.flags|=1024,Pr!==null&&(L_(Pr),Pr=null))),N_(o,c),js(c),null;case 5:n_(c);var $=Fi(Du.current);if(g=c.type,o!==null&&c.stateNode!=null)MS(o,c,g,S,$),o.ref!==c.ref&&(c.flags|=512,c.flags|=2097152);else{if(!S){if(c.stateNode===null)throw Error(n(166));return js(c),null}if(o=Fi(ca.current),nh(c)){S=c.stateNode,g=c.type;var P=c.memoizedProps;switch(S[_r]=c,S[$i]=P,o=(c.mode&1)!==0,g){case"dialog":on("cancel",S),on("close",S);break;case"iframe":case"object":case"embed":on("load",S);break;case"video":case"audio":for($=0;$<Ai.length;$++)on(Ai[$],S);break;case"source":on("error",S);break;case"img":case"image":case"link":on("error",S),on("load",S);break;case"details":on("toggle",S);break;case"input":Re(S,P),on("invalid",S);break;case"select":S._wrapperState={wasMultiple:!!P.multiple},on("invalid",S);break;case"textarea":We(S,P),on("invalid",S)}lt(g,P),$=null;for(var Y in P)if(P.hasOwnProperty(Y)){var se=P[Y];Y==="children"?typeof se=="string"?S.textContent!==se&&(P.suppressHydrationWarning!==!0&&Su(S.textContent,se,o),$=["children",se]):typeof se=="number"&&S.textContent!==""+se&&(P.suppressHydrationWarning!==!0&&Su(S.textContent,se,o),$=["children",""+se]):r.hasOwnProperty(Y)&&se!=null&&Y==="onScroll"&&on("scroll",S)}switch(g){case"input":le(S),xe(S,P,!0);break;case"textarea":le(S),ye(S);break;case"select":case"option":break;default:typeof P.onClick=="function"&&(S.onclick=Gl)}S=$,c.updateQueue=S,S!==null&&(c.flags|=4)}else{Y=$.nodeType===9?$:$.ownerDocument,o==="http://www.w3.org/1999/xhtml"&&(o=Fe(g)),o==="http://www.w3.org/1999/xhtml"?g==="script"?(o=Y.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild)):typeof S.is=="string"?o=Y.createElement(g,{is:S.is}):(o=Y.createElement(g),g==="select"&&(Y=o,S.multiple?Y.multiple=!0:S.size&&(Y.size=S.size))):o=Y.createElementNS(o,g),o[_r]=c,o[$i]=S,kS(o,c,!1,!1),c.stateNode=o;e:{switch(Y=Je(g,S),g){case"dialog":on("cancel",o),on("close",o),$=S;break;case"iframe":case"object":case"embed":on("load",o),$=S;break;case"video":case"audio":for($=0;$<Ai.length;$++)on(Ai[$],o);$=S;break;case"source":on("error",o),$=S;break;case"img":case"image":case"link":on("error",o),on("load",o),$=S;break;case"details":on("toggle",o),$=S;break;case"input":Re(o,S),$=ge(o,S),on("invalid",o);break;case"option":$=S;break;case"select":o._wrapperState={wasMultiple:!!S.multiple},$=V({},S,{value:void 0}),on("invalid",o);break;case"textarea":We(o,S),$=Se(o,S),on("invalid",o);break;default:$=S}lt(g,$),se=$;for(P in se)if(se.hasOwnProperty(P)){var ae=se[P];P==="style"?Be(o,ae):P==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&xt(o,ae)):P==="children"?typeof ae=="string"?(g!=="textarea"||ae!=="")&&_t(o,ae):typeof ae=="number"&&_t(o,""+ae):P!=="suppressContentEditableWarning"&&P!=="suppressHydrationWarning"&&P!=="autoFocus"&&(r.hasOwnProperty(P)?ae!=null&&P==="onScroll"&&on("scroll",o):ae!=null&&N(o,P,ae,Y))}switch(g){case"input":le(o),xe(o,S,!1);break;case"textarea":le(o),ye(o);break;case"option":S.value!=null&&o.setAttribute("value",""+X(S.value));break;case"select":o.multiple=!!S.multiple,P=S.value,P!=null?Ve(o,!!S.multiple,P,!1):S.defaultValue!=null&&Ve(o,!!S.multiple,S.defaultValue,!0);break;default:typeof $.onClick=="function"&&(o.onclick=Gl)}switch(g){case"button":case"input":case"select":case"textarea":S=!!S.autoFocus;break e;case"img":S=!0;break e;default:S=!1}}S&&(c.flags|=4)}c.ref!==null&&(c.flags|=512,c.flags|=2097152)}return js(c),null;case 6:if(o&&c.stateNode!=null)AS(o,c,o.memoizedProps,S);else{if(typeof S!="string"&&c.stateNode===null)throw Error(n(166));if(g=Fi(Du.current),Fi(ca.current),nh(c)){if(S=c.stateNode,g=c.memoizedProps,S[_r]=c,(P=S.nodeValue!==g)&&(o=cr,o!==null))switch(o.tag){case 3:Su(S.nodeValue,g,(o.mode&1)!==0);break;case 5:o.memoizedProps.suppressHydrationWarning!==!0&&Su(S.nodeValue,g,(o.mode&1)!==0)}P&&(c.flags|=4)}else S=(g.nodeType===9?g:g.ownerDocument).createTextNode(S),S[_r]=c,c.stateNode=S}return js(c),null;case 13:if(ln(wn),S=c.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(pn&&ur!==null&&c.mode&1&&!(c.flags&128))$1(),Jl(),c.flags|=98560,P=!1;else if(P=nh(c),S!==null&&S.dehydrated!==null){if(o===null){if(!P)throw Error(n(318));if(P=c.memoizedState,P=P!==null?P.dehydrated:null,!P)throw Error(n(317));P[_r]=c}else Jl(),!(c.flags&128)&&(c.memoizedState=null),c.flags|=4;js(c),P=!1}else Pr!==null&&(L_(Pr),Pr=null),P=!0;if(!P)return c.flags&65536?c:null}return c.flags&128?(c.lanes=g,c):(S=S!==null,S!==(o!==null&&o.memoizedState!==null)&&S&&(c.child.flags|=8192,c.mode&1&&(o===null||wn.current&1?Jn===0&&(Jn=3):D_())),c.updateQueue!==null&&(c.flags|=4),js(c),null);case 4:return sc(),N_(o,c),o===null&&Oi(c.stateNode.containerInfo),js(c),null;case 10:return Qg(c.type._context),js(c),null;case 17:return ws(c.type)&&Ql(),js(c),null;case 19:if(ln(wn),P=c.memoizedState,P===null)return js(c),null;if(S=(c.flags&128)!==0,Y=P.rendering,Y===null)if(S)Hu(P,!1);else{if(Jn!==0||o!==null&&o.flags&128)for(o=c.child;o!==null;){if(Y=lh(o),Y!==null){for(c.flags|=128,Hu(P,!1),S=Y.updateQueue,S!==null&&(c.updateQueue=S,c.flags|=4),c.subtreeFlags=0,S=g,g=c.child;g!==null;)P=g,o=S,P.flags&=14680066,Y=P.alternate,Y===null?(P.childLanes=0,P.lanes=o,P.child=null,P.subtreeFlags=0,P.memoizedProps=null,P.memoizedState=null,P.updateQueue=null,P.dependencies=null,P.stateNode=null):(P.childLanes=Y.childLanes,P.lanes=Y.lanes,P.child=Y.child,P.subtreeFlags=0,P.deletions=null,P.memoizedProps=Y.memoizedProps,P.memoizedState=Y.memoizedState,P.updateQueue=Y.updateQueue,P.type=Y.type,o=Y.dependencies,P.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),g=g.sibling;return nn(wn,wn.current&1|2),c.child}o=o.sibling}P.tail!==null&&et()>ic&&(c.flags|=128,S=!0,Hu(P,!1),c.lanes=4194304)}else{if(!S)if(o=lh(Y),o!==null){if(c.flags|=128,S=!0,g=o.updateQueue,g!==null&&(c.updateQueue=g,c.flags|=4),Hu(P,!0),P.tail===null&&P.tailMode==="hidden"&&!Y.alternate&&!pn)return js(c),null}else 2*et()-P.renderingStartTime>ic&&g!==1073741824&&(c.flags|=128,S=!0,Hu(P,!1),c.lanes=4194304);P.isBackwards?(Y.sibling=c.child,c.child=Y):(g=P.last,g!==null?g.sibling=Y:c.child=Y,P.last=Y)}return P.tail!==null?(c=P.tail,P.rendering=c,P.tail=c.sibling,P.renderingStartTime=et(),c.sibling=null,g=wn.current,nn(wn,S?g&1|2:g&1),c):(js(c),null);case 22:case 23:return R_(),S=c.memoizedState!==null,o!==null&&o.memoizedState!==null!==S&&(c.flags|=8192),S&&c.mode&1?dr&1073741824&&(js(c),c.subtreeFlags&6&&(c.flags|=8192)):js(c),null;case 24:return null;case 25:return null}throw Error(n(156,c.tag))}function L8(o,c){switch(Vg(c),c.tag){case 1:return ws(c.type)&&Ql(),o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 3:return sc(),ln(bs),ln(is),r_(),o=c.flags,o&65536&&!(o&128)?(c.flags=o&-65537|128,c):null;case 5:return n_(c),null;case 13:if(ln(wn),o=c.memoizedState,o!==null&&o.dehydrated!==null){if(c.alternate===null)throw Error(n(340));Jl()}return o=c.flags,o&65536?(c.flags=o&-65537|128,c):null;case 19:return ln(wn),null;case 4:return sc(),null;case 10:return Qg(c.type._context),null;case 22:case 23:return R_(),null;case 24:return null;default:return null}}var _h=!1,Ss=!1,z8=typeof WeakSet=="function"?WeakSet:Set,Ge=null;function ac(o,c){var g=o.ref;if(g!==null)if(typeof g=="function")try{g(null)}catch(S){Cn(o,c,S)}else g.current=null}function j_(o,c,g){try{g()}catch(S){Cn(o,c,S)}}var OS=!1;function R8(o,c){if(Zm=zt,o=Im(),yu(o)){if("selectionStart"in o)var g={start:o.selectionStart,end:o.selectionEnd};else e:{g=(g=o.ownerDocument)&&g.defaultView||window;var S=g.getSelection&&g.getSelection();if(S&&S.rangeCount!==0){g=S.anchorNode;var $=S.anchorOffset,P=S.focusNode;S=S.focusOffset;try{g.nodeType,P.nodeType}catch{g=null;break e}var Y=0,se=-1,ae=-1,pe=0,je=0,ke=o,Ne=null;t:for(;;){for(var Ye;ke!==g||$!==0&&ke.nodeType!==3||(se=Y+$),ke!==P||S!==0&&ke.nodeType!==3||(ae=Y+S),ke.nodeType===3&&(Y+=ke.nodeValue.length),(Ye=ke.firstChild)!==null;)Ne=ke,ke=Ye;for(;;){if(ke===o)break t;if(Ne===g&&++pe===$&&(se=Y),Ne===P&&++je===S&&(ae=Y),(Ye=ke.nextSibling)!==null)break;ke=Ne,Ne=ke.parentNode}ke=Ye}g=se===-1||ae===-1?null:{start:se,end:ae}}else g=null}g=g||{start:0,end:0}}else g=null;for(Eu={focusedElem:o,selectionRange:g},zt=!1,Ge=c;Ge!==null;)if(c=Ge,o=c.child,(c.subtreeFlags&1028)!==0&&o!==null)o.return=c,Ge=o;else for(;Ge!==null;){c=Ge;try{var Xe=c.alternate;if(c.flags&1024)switch(c.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var Ze=Xe.memoizedProps,Rn=Xe.memoizedState,ue=c.stateNode,oe=ue.getSnapshotBeforeUpdate(c.elementType===c.type?Ze:Ir(c.type,Ze),Rn);ue.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var he=c.stateNode.containerInfo;he.nodeType===1?he.textContent="":he.nodeType===9&&he.documentElement&&he.removeChild(he.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Oe){Cn(c,c.return,Oe)}if(o=c.sibling,o!==null){o.return=c.return,Ge=o;break}Ge=c.return}return Xe=OS,OS=!1,Xe}function Uu(o,c,g){var S=c.updateQueue;if(S=S!==null?S.lastEffect:null,S!==null){var $=S=S.next;do{if(($.tag&o)===o){var P=$.destroy;$.destroy=void 0,P!==void 0&&j_(c,g,P)}$=$.next}while($!==S)}}function yh(o,c){if(c=c.updateQueue,c=c!==null?c.lastEffect:null,c!==null){var g=c=c.next;do{if((g.tag&o)===o){var S=g.create;g.destroy=S()}g=g.next}while(g!==c)}}function S_(o){var c=o.ref;if(c!==null){var g=o.stateNode;switch(o.tag){case 5:o=g;break;default:o=g}typeof c=="function"?c(o):c.current=o}}function TS(o){var c=o.alternate;c!==null&&(o.alternate=null,TS(c)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(c=o.stateNode,c!==null&&(delete c[_r],delete c[$i],delete c[Au],delete c[Ug],delete c[k1])),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}function $S(o){return o.tag===5||o.tag===3||o.tag===4}function LS(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||$S(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function E_(o,c,g){var S=o.tag;if(S===5||S===6)o=o.stateNode,c?g.nodeType===8?g.parentNode.insertBefore(o,c):g.insertBefore(o,c):(g.nodeType===8?(c=g.parentNode,c.insertBefore(o,g)):(c=g,c.appendChild(o)),g=g._reactRootContainer,g!=null||c.onclick!==null||(c.onclick=Gl));else if(S!==4&&(o=o.child,o!==null))for(E_(o,c,g),o=o.sibling;o!==null;)E_(o,c,g),o=o.sibling}function C_(o,c,g){var S=o.tag;if(S===5||S===6)o=o.stateNode,c?g.insertBefore(o,c):g.appendChild(o);else if(S!==4&&(o=o.child,o!==null))for(C_(o,c,g),o=o.sibling;o!==null;)C_(o,c,g),o=o.sibling}var ps=null,Fr=!1;function Oo(o,c,g){for(g=g.child;g!==null;)zS(o,c,g),g=g.sibling}function zS(o,c,g){if(be&&typeof be.onCommitFiberUnmount=="function")try{be.onCommitFiberUnmount(de,g)}catch{}switch(g.tag){case 5:Ss||ac(g,c);case 6:var S=ps,$=Fr;ps=null,Oo(o,c,g),ps=S,Fr=$,ps!==null&&(Fr?(o=ps,g=g.stateNode,o.nodeType===8?o.parentNode.removeChild(g):o.removeChild(g)):ps.removeChild(g.stateNode));break;case 18:ps!==null&&(Fr?(o=ps,g=g.stateNode,o.nodeType===8?Mu(o.parentNode,g):o.nodeType===1&&Mu(o,g),dt(o)):Mu(ps,g.stateNode));break;case 4:S=ps,$=Fr,ps=g.stateNode.containerInfo,Fr=!0,Oo(o,c,g),ps=S,Fr=$;break;case 0:case 11:case 14:case 15:if(!Ss&&(S=g.updateQueue,S!==null&&(S=S.lastEffect,S!==null))){$=S=S.next;do{var P=$,Y=P.destroy;P=P.tag,Y!==void 0&&(P&2||P&4)&&j_(g,c,Y),$=$.next}while($!==S)}Oo(o,c,g);break;case 1:if(!Ss&&(ac(g,c),S=g.stateNode,typeof S.componentWillUnmount=="function"))try{S.props=g.memoizedProps,S.state=g.memoizedState,S.componentWillUnmount()}catch(se){Cn(g,c,se)}Oo(o,c,g);break;case 21:Oo(o,c,g);break;case 22:g.mode&1?(Ss=(S=Ss)||g.memoizedState!==null,Oo(o,c,g),Ss=S):Oo(o,c,g);break;default:Oo(o,c,g)}}function RS(o){var c=o.updateQueue;if(c!==null){o.updateQueue=null;var g=o.stateNode;g===null&&(g=o.stateNode=new z8),c.forEach(function(S){var $=V8.bind(null,o,S);g.has(S)||(g.add(S),S.then($,$))})}}function Br(o,c){var g=c.deletions;if(g!==null)for(var S=0;S<g.length;S++){var $=g[S];try{var P=o,Y=c,se=Y;e:for(;se!==null;){switch(se.tag){case 5:ps=se.stateNode,Fr=!1;break e;case 3:ps=se.stateNode.containerInfo,Fr=!0;break e;case 4:ps=se.stateNode.containerInfo,Fr=!0;break e}se=se.return}if(ps===null)throw Error(n(160));zS(P,Y,$),ps=null,Fr=!1;var ae=$.alternate;ae!==null&&(ae.return=null),$.return=null}catch(pe){Cn($,c,pe)}}if(c.subtreeFlags&12854)for(c=c.child;c!==null;)DS(c,o),c=c.sibling}function DS(o,c){var g=o.alternate,S=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:if(Br(c,o),da(o),S&4){try{Uu(3,o,o.return),yh(3,o)}catch(Ze){Cn(o,o.return,Ze)}try{Uu(5,o,o.return)}catch(Ze){Cn(o,o.return,Ze)}}break;case 1:Br(c,o),da(o),S&512&&g!==null&&ac(g,g.return);break;case 5:if(Br(c,o),da(o),S&512&&g!==null&&ac(g,g.return),o.flags&32){var $=o.stateNode;try{_t($,"")}catch(Ze){Cn(o,o.return,Ze)}}if(S&4&&($=o.stateNode,$!=null)){var P=o.memoizedProps,Y=g!==null?g.memoizedProps:P,se=o.type,ae=o.updateQueue;if(o.updateQueue=null,ae!==null)try{se==="input"&&P.type==="radio"&&P.name!=null&&ze($,P),Je(se,Y);var pe=Je(se,P);for(Y=0;Y<ae.length;Y+=2){var je=ae[Y],ke=ae[Y+1];je==="style"?Be($,ke):je==="dangerouslySetInnerHTML"?xt($,ke):je==="children"?_t($,ke):N($,je,ke,pe)}switch(se){case"input":me($,P);break;case"textarea":ht($,P);break;case"select":var Ne=$._wrapperState.wasMultiple;$._wrapperState.wasMultiple=!!P.multiple;var Ye=P.value;Ye!=null?Ve($,!!P.multiple,Ye,!1):Ne!==!!P.multiple&&(P.defaultValue!=null?Ve($,!!P.multiple,P.defaultValue,!0):Ve($,!!P.multiple,P.multiple?[]:"",!1))}$[$i]=P}catch(Ze){Cn(o,o.return,Ze)}}break;case 6:if(Br(c,o),da(o),S&4){if(o.stateNode===null)throw Error(n(162));$=o.stateNode,P=o.memoizedProps;try{$.nodeValue=P}catch(Ze){Cn(o,o.return,Ze)}}break;case 3:if(Br(c,o),da(o),S&4&&g!==null&&g.memoizedState.isDehydrated)try{dt(c.containerInfo)}catch(Ze){Cn(o,o.return,Ze)}break;case 4:Br(c,o),da(o);break;case 13:Br(c,o),da(o),$=o.child,$.flags&8192&&(P=$.memoizedState!==null,$.stateNode.isHidden=P,!P||$.alternate!==null&&$.alternate.memoizedState!==null||(A_=et())),S&4&&RS(o);break;case 22:if(je=g!==null&&g.memoizedState!==null,o.mode&1?(Ss=(pe=Ss)||je,Br(c,o),Ss=pe):Br(c,o),da(o),S&8192){if(pe=o.memoizedState!==null,(o.stateNode.isHidden=pe)&&!je&&o.mode&1)for(Ge=o,je=o.child;je!==null;){for(ke=Ge=je;Ge!==null;){switch(Ne=Ge,Ye=Ne.child,Ne.tag){case 0:case 11:case 14:case 15:Uu(4,Ne,Ne.return);break;case 1:ac(Ne,Ne.return);var Xe=Ne.stateNode;if(typeof Xe.componentWillUnmount=="function"){S=Ne,g=Ne.return;try{c=S,Xe.props=c.memoizedProps,Xe.state=c.memoizedState,Xe.componentWillUnmount()}catch(Ze){Cn(S,g,Ze)}}break;case 5:ac(Ne,Ne.return);break;case 22:if(Ne.memoizedState!==null){FS(ke);continue}}Ye!==null?(Ye.return=Ne,Ge=Ye):FS(ke)}je=je.sibling}e:for(je=null,ke=o;;){if(ke.tag===5){if(je===null){je=ke;try{$=ke.stateNode,pe?(P=$.style,typeof P.setProperty=="function"?P.setProperty("display","none","important"):P.display="none"):(se=ke.stateNode,ae=ke.memoizedProps.style,Y=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,se.style.display=Ie("display",Y))}catch(Ze){Cn(o,o.return,Ze)}}}else if(ke.tag===6){if(je===null)try{ke.stateNode.nodeValue=pe?"":ke.memoizedProps}catch(Ze){Cn(o,o.return,Ze)}}else if((ke.tag!==22&&ke.tag!==23||ke.memoizedState===null||ke===o)&&ke.child!==null){ke.child.return=ke,ke=ke.child;continue}if(ke===o)break e;for(;ke.sibling===null;){if(ke.return===null||ke.return===o)break e;je===ke&&(je=null),ke=ke.return}je===ke&&(je=null),ke.sibling.return=ke.return,ke=ke.sibling}}break;case 19:Br(c,o),da(o),S&4&&RS(o);break;case 21:break;default:Br(c,o),da(o)}}function da(o){var c=o.flags;if(c&2){try{e:{for(var g=o.return;g!==null;){if($S(g)){var S=g;break e}g=g.return}throw Error(n(160))}switch(S.tag){case 5:var $=S.stateNode;S.flags&32&&(_t($,""),S.flags&=-33);var P=LS(o);C_(o,P,$);break;case 3:case 4:var Y=S.stateNode.containerInfo,se=LS(o);E_(o,se,Y);break;default:throw Error(n(161))}}catch(ae){Cn(o,o.return,ae)}o.flags&=-3}c&4096&&(o.flags&=-4097)}function D8(o,c,g){Ge=o,PS(o)}function PS(o,c,g){for(var S=(o.mode&1)!==0;Ge!==null;){var $=Ge,P=$.child;if($.tag===22&&S){var Y=$.memoizedState!==null||_h;if(!Y){var se=$.alternate,ae=se!==null&&se.memoizedState!==null||Ss;se=_h;var pe=Ss;if(_h=Y,(Ss=ae)&&!pe)for(Ge=$;Ge!==null;)Y=Ge,ae=Y.child,Y.tag===22&&Y.memoizedState!==null?BS($):ae!==null?(ae.return=Y,Ge=ae):BS($);for(;P!==null;)Ge=P,PS(P),P=P.sibling;Ge=$,_h=se,Ss=pe}IS(o)}else $.subtreeFlags&8772&&P!==null?(P.return=$,Ge=P):IS(o)}}function IS(o){for(;Ge!==null;){var c=Ge;if(c.flags&8772){var g=c.alternate;try{if(c.flags&8772)switch(c.tag){case 0:case 11:case 15:Ss||yh(5,c);break;case 1:var S=c.stateNode;if(c.flags&4&&!Ss)if(g===null)S.componentDidMount();else{var $=c.elementType===c.type?g.memoizedProps:Ir(c.type,g.memoizedProps);S.componentDidUpdate($,g.memoizedState,S.__reactInternalSnapshotBeforeUpdate)}var P=c.updateQueue;P!==null&&F1(c,P,S);break;case 3:var Y=c.updateQueue;if(Y!==null){if(g=null,c.child!==null)switch(c.child.tag){case 5:g=c.child.stateNode;break;case 1:g=c.child.stateNode}F1(c,Y,g)}break;case 5:var se=c.stateNode;if(g===null&&c.flags&4){g=se;var ae=c.memoizedProps;switch(c.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&g.focus();break;case"img":ae.src&&(g.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(c.memoizedState===null){var pe=c.alternate;if(pe!==null){var je=pe.memoizedState;if(je!==null){var ke=je.dehydrated;ke!==null&&dt(ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Ss||c.flags&512&&S_(c)}catch(Ne){Cn(c,c.return,Ne)}}if(c===o){Ge=null;break}if(g=c.sibling,g!==null){g.return=c.return,Ge=g;break}Ge=c.return}}function FS(o){for(;Ge!==null;){var c=Ge;if(c===o){Ge=null;break}var g=c.sibling;if(g!==null){g.return=c.return,Ge=g;break}Ge=c.return}}function BS(o){for(;Ge!==null;){var c=Ge;try{switch(c.tag){case 0:case 11:case 15:var g=c.return;try{yh(4,c)}catch(ae){Cn(c,g,ae)}break;case 1:var S=c.stateNode;if(typeof S.componentDidMount=="function"){var $=c.return;try{S.componentDidMount()}catch(ae){Cn(c,$,ae)}}var P=c.return;try{S_(c)}catch(ae){Cn(c,P,ae)}break;case 5:var Y=c.return;try{S_(c)}catch(ae){Cn(c,Y,ae)}}}catch(ae){Cn(c,c.return,ae)}if(c===o){Ge=null;break}var se=c.sibling;if(se!==null){se.return=c.return,Ge=se;break}Ge=c.return}}var P8=Math.ceil,vh=j.ReactCurrentDispatcher,k_=j.ReactCurrentOwner,Nr=j.ReactCurrentBatchConfig,qt=0,cs=null,Wn=null,gs=0,dr=0,oc=oa(0),Jn=0,qu=null,Hi=0,xh=0,M_=0,Vu=null,Gs=null,A_=0,ic=1/0,Ua=null,bh=!1,O_=null,To=null,wh=!1,$o=null,Nh=0,Ku=0,T_=null,jh=-1,Sh=0;function Ds(){return qt&6?et():jh!==-1?jh:jh=et()}function Lo(o){return o.mode&1?qt&2&&gs!==0?gs&-gs:b8.transition!==null?(Sh===0&&(Sh=Ys()),Sh):(o=It,o!==0||(o=window.event,o=o===void 0?16:lr(o.type)),o):1}function Hr(o,c,g,S){if(50<Ku)throw Ku=0,T_=null,Error(n(185));rs(o,g,S),(!(qt&2)||o!==cs)&&(o===cs&&(!(qt&2)&&(xh|=g),Jn===4&&zo(o,gs)),Xs(o,S),g===1&&qt===0&&!(c.mode&1)&&(ic=et()+500,Ri&&mt()))}function Xs(o,c){var g=o.callbackNode;Tn(o,c);var S=On(o,o===cs?gs:0);if(S===0)g!==null&&Vs(g),o.callbackNode=null,o.callbackPriority=0;else if(c=S&-S,o.callbackPriority!==c){if(g!=null&&Vs(g),c===1)o.tag===0?th(US.bind(null,o)):$u(US.bind(null,o)),Bg(function(){!(qt&6)&&mt()}),g=null;else{switch($r(S)){case 1:g=ss;break;case 4:g=Ks;break;case 16:g=Os;break;case 536870912:g=vs;break;default:g=Os}g=QS(g,HS.bind(null,o))}o.callbackPriority=c,o.callbackNode=g}}function HS(o,c){if(jh=-1,Sh=0,qt&6)throw Error(n(327));var g=o.callbackNode;if(lc()&&o.callbackNode!==g)return null;var S=On(o,o===cs?gs:0);if(S===0)return null;if(S&30||S&o.expiredLanes||c)c=Eh(o,S);else{c=S;var $=qt;qt|=2;var P=VS();(cs!==o||gs!==c)&&(Ua=null,ic=et()+500,qi(o,c));do try{B8();break}catch(se){qS(o,se)}while(!0);Xg(),vh.current=P,qt=$,Wn!==null?c=0:(cs=null,gs=0,c=Jn)}if(c!==0){if(c===2&&($=qn(o),$!==0&&(S=$,c=$_(o,$))),c===1)throw g=qu,qi(o,0),zo(o,S),Xs(o,et()),g;if(c===6)zo(o,S);else{if($=o.current.alternate,!(S&30)&&!I8($)&&(c=Eh(o,S),c===2&&(P=qn(o),P!==0&&(S=P,c=$_(o,P))),c===1))throw g=qu,qi(o,0),zo(o,S),Xs(o,et()),g;switch(o.finishedWork=$,o.finishedLanes=S,c){case 0:case 1:throw Error(n(345));case 2:Vi(o,Gs,Ua);break;case 3:if(zo(o,S),(S&130023424)===S&&(c=A_+500-et(),10<c)){if(On(o,0)!==0)break;if($=o.suspendedLanes,($&S)!==S){Ds(),o.pingedLanes|=o.suspendedLanes&$;break}o.timeoutHandle=ku(Vi.bind(null,o,Gs,Ua),c);break}Vi(o,Gs,Ua);break;case 4:if(zo(o,S),(S&4194240)===S)break;for(c=o.eventTimes,$=-1;0<S;){var Y=31-gt(S);P=1<<Y,Y=c[Y],Y>$&&($=Y),S&=~P}if(S=$,S=et()-S,S=(120>S?120:480>S?480:1080>S?1080:1920>S?1920:3e3>S?3e3:4320>S?4320:1960*P8(S/1960))-S,10<S){o.timeoutHandle=ku(Vi.bind(null,o,Gs,Ua),S);break}Vi(o,Gs,Ua);break;case 5:Vi(o,Gs,Ua);break;default:throw Error(n(329))}}}return Xs(o,et()),o.callbackNode===g?HS.bind(null,o):null}function $_(o,c){var g=Vu;return o.current.memoizedState.isDehydrated&&(qi(o,c).flags|=256),o=Eh(o,c),o!==2&&(c=Gs,Gs=g,c!==null&&L_(c)),o}function L_(o){Gs===null?Gs=o:Gs.push.apply(Gs,o)}function I8(o){for(var c=o;;){if(c.flags&16384){var g=c.updateQueue;if(g!==null&&(g=g.stores,g!==null))for(var S=0;S<g.length;S++){var $=g[S],P=$.getSnapshot;$=$.value;try{if(!xn(P(),$))return!1}catch{return!1}}}if(g=c.child,c.subtreeFlags&16384&&g!==null)g.return=c,c=g;else{if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return!0;c=c.return}c.sibling.return=c.return,c=c.sibling}}return!0}function zo(o,c){for(c&=~M_,c&=~xh,o.suspendedLanes|=c,o.pingedLanes&=~c,o=o.expirationTimes;0<c;){var g=31-gt(c),S=1<<g;o[g]=-1,c&=~S}}function US(o){if(qt&6)throw Error(n(327));lc();var c=On(o,0);if(!(c&1))return Xs(o,et()),null;var g=Eh(o,c);if(o.tag!==0&&g===2){var S=qn(o);S!==0&&(c=S,g=$_(o,S))}if(g===1)throw g=qu,qi(o,0),zo(o,c),Xs(o,et()),g;if(g===6)throw Error(n(345));return o.finishedWork=o.current.alternate,o.finishedLanes=c,Vi(o,Gs,Ua),Xs(o,et()),null}function z_(o,c){var g=qt;qt|=1;try{return o(c)}finally{qt=g,qt===0&&(ic=et()+500,Ri&&mt())}}function Ui(o){$o!==null&&$o.tag===0&&!(qt&6)&&lc();var c=qt;qt|=1;var g=Nr.transition,S=It;try{if(Nr.transition=null,It=1,o)return o()}finally{It=S,Nr.transition=g,qt=c,!(qt&6)&&mt()}}function R_(){dr=oc.current,ln(oc)}function qi(o,c){o.finishedWork=null,o.finishedLanes=0;var g=o.timeoutHandle;if(g!==-1&&(o.timeoutHandle=-1,Fg(g)),Wn!==null)for(g=Wn.return;g!==null;){var S=g;switch(Vg(S),S.tag){case 1:S=S.type.childContextTypes,S!=null&&Ql();break;case 3:sc(),ln(bs),ln(is),r_();break;case 5:n_(S);break;case 4:sc();break;case 13:ln(wn);break;case 19:ln(wn);break;case 10:Qg(S.type._context);break;case 22:case 23:R_()}g=g.return}if(cs=o,Wn=o=Ro(o.current,null),gs=dr=c,Jn=0,qu=null,M_=xh=Hi=0,Gs=Vu=null,Ii!==null){for(c=0;c<Ii.length;c++)if(g=Ii[c],S=g.interleaved,S!==null){g.interleaved=null;var $=S.next,P=g.pending;if(P!==null){var Y=P.next;P.next=$,S.next=Y}g.pending=S}Ii=null}return o}function qS(o,c){do{var g=Wn;try{if(Xg(),ch.current=hh,uh){for(var S=Nn.memoizedState;S!==null;){var $=S.queue;$!==null&&($.pending=null),S=S.next}uh=!1}if(Bi=0,ls=Zn=Nn=null,Pu=!1,Iu=0,k_.current=null,g===null||g.return===null){Jn=1,qu=c,Wn=null;break}e:{var P=o,Y=g.return,se=g,ae=c;if(c=gs,se.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var pe=ae,je=se,ke=je.tag;if(!(je.mode&1)&&(ke===0||ke===11||ke===15)){var Ne=je.alternate;Ne?(je.updateQueue=Ne.updateQueue,je.memoizedState=Ne.memoizedState,je.lanes=Ne.lanes):(je.updateQueue=null,je.memoizedState=null)}var Ye=pS(Y);if(Ye!==null){Ye.flags&=-257,gS(Ye,Y,se,P,c),Ye.mode&1&&fS(P,pe,c),c=Ye,ae=pe;var Xe=c.updateQueue;if(Xe===null){var Ze=new Set;Ze.add(ae),c.updateQueue=Ze}else Xe.add(ae);break e}else{if(!(c&1)){fS(P,pe,c),D_();break e}ae=Error(n(426))}}else if(pn&&se.mode&1){var Rn=pS(Y);if(Rn!==null){!(Rn.flags&65536)&&(Rn.flags|=256),gS(Rn,Y,se,P,c),Wg(rc(ae,se));break e}}P=ae=rc(ae,se),Jn!==4&&(Jn=2),Vu===null?Vu=[P]:Vu.push(P),P=Y;do{switch(P.tag){case 3:P.flags|=65536,c&=-c,P.lanes|=c;var ue=mS(P,ae,c);I1(P,ue);break e;case 1:se=ae;var oe=P.type,he=P.stateNode;if(!(P.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||he!==null&&typeof he.componentDidCatch=="function"&&(To===null||!To.has(he)))){P.flags|=65536,c&=-c,P.lanes|=c;var Oe=hS(P,se,c);I1(P,Oe);break e}}P=P.return}while(P!==null)}YS(g)}catch(nt){c=nt,Wn===g&&g!==null&&(Wn=g=g.return);continue}break}while(!0)}function VS(){var o=vh.current;return vh.current=hh,o===null?hh:o}function D_(){(Jn===0||Jn===3||Jn===2)&&(Jn=4),cs===null||!(Hi&268435455)&&!(xh&268435455)||zo(cs,gs)}function Eh(o,c){var g=qt;qt|=2;var S=VS();(cs!==o||gs!==c)&&(Ua=null,qi(o,c));do try{F8();break}catch($){qS(o,$)}while(!0);if(Xg(),qt=g,vh.current=S,Wn!==null)throw Error(n(261));return cs=null,gs=0,Jn}function F8(){for(;Wn!==null;)KS(Wn)}function B8(){for(;Wn!==null&&!As();)KS(Wn)}function KS(o){var c=XS(o.alternate,o,dr);o.memoizedProps=o.pendingProps,c===null?YS(o):Wn=c,k_.current=null}function YS(o){var c=o;do{var g=c.alternate;if(o=c.return,c.flags&32768){if(g=L8(g,c),g!==null){g.flags&=32767,Wn=g;return}if(o!==null)o.flags|=32768,o.subtreeFlags=0,o.deletions=null;else{Jn=6,Wn=null;return}}else if(g=$8(g,c,dr),g!==null){Wn=g;return}if(c=c.sibling,c!==null){Wn=c;return}Wn=c=o}while(c!==null);Jn===0&&(Jn=5)}function Vi(o,c,g){var S=It,$=Nr.transition;try{Nr.transition=null,It=1,H8(o,c,g,S)}finally{Nr.transition=$,It=S}return null}function H8(o,c,g,S){do lc();while($o!==null);if(qt&6)throw Error(n(327));g=o.finishedWork;var $=o.finishedLanes;if(g===null)return null;if(o.finishedWork=null,o.finishedLanes=0,g===o.current)throw Error(n(177));o.callbackNode=null,o.callbackPriority=0;var P=g.lanes|g.childLanes;if(Qr(o,P),o===cs&&(Wn=cs=null,gs=0),!(g.subtreeFlags&2064)&&!(g.flags&2064)||wh||(wh=!0,QS(Os,function(){return lc(),null})),P=(g.flags&15990)!==0,g.subtreeFlags&15990||P){P=Nr.transition,Nr.transition=null;var Y=It;It=1;var se=qt;qt|=4,k_.current=null,R8(o,g),DS(g,o),$g(Eu),zt=!!Zm,Eu=Zm=null,o.current=g,D8(g),en(),qt=se,It=Y,Nr.transition=P}else o.current=g;if(wh&&(wh=!1,$o=o,Nh=$),P=o.pendingLanes,P===0&&(To=null),qe(g.stateNode),Xs(o,et()),c!==null)for(S=o.onRecoverableError,g=0;g<c.length;g++)$=c[g],S($.value,{componentStack:$.stack,digest:$.digest});if(bh)throw bh=!1,o=O_,O_=null,o;return Nh&1&&o.tag!==0&&lc(),P=o.pendingLanes,P&1?o===T_?Ku++:(Ku=0,T_=o):Ku=0,mt(),null}function lc(){if($o!==null){var o=$r(Nh),c=Nr.transition,g=It;try{if(Nr.transition=null,It=16>o?16:o,$o===null)var S=!1;else{if(o=$o,$o=null,Nh=0,qt&6)throw Error(n(331));var $=qt;for(qt|=4,Ge=o.current;Ge!==null;){var P=Ge,Y=P.child;if(Ge.flags&16){var se=P.deletions;if(se!==null){for(var ae=0;ae<se.length;ae++){var pe=se[ae];for(Ge=pe;Ge!==null;){var je=Ge;switch(je.tag){case 0:case 11:case 15:Uu(8,je,P)}var ke=je.child;if(ke!==null)ke.return=je,Ge=ke;else for(;Ge!==null;){je=Ge;var Ne=je.sibling,Ye=je.return;if(TS(je),je===pe){Ge=null;break}if(Ne!==null){Ne.return=Ye,Ge=Ne;break}Ge=Ye}}}var Xe=P.alternate;if(Xe!==null){var Ze=Xe.child;if(Ze!==null){Xe.child=null;do{var Rn=Ze.sibling;Ze.sibling=null,Ze=Rn}while(Ze!==null)}}Ge=P}}if(P.subtreeFlags&2064&&Y!==null)Y.return=P,Ge=Y;else e:for(;Ge!==null;){if(P=Ge,P.flags&2048)switch(P.tag){case 0:case 11:case 15:Uu(9,P,P.return)}var ue=P.sibling;if(ue!==null){ue.return=P.return,Ge=ue;break e}Ge=P.return}}var oe=o.current;for(Ge=oe;Ge!==null;){Y=Ge;var he=Y.child;if(Y.subtreeFlags&2064&&he!==null)he.return=Y,Ge=he;else e:for(Y=oe;Ge!==null;){if(se=Ge,se.flags&2048)try{switch(se.tag){case 0:case 11:case 15:yh(9,se)}}catch(nt){Cn(se,se.return,nt)}if(se===Y){Ge=null;break e}var Oe=se.sibling;if(Oe!==null){Oe.return=se.return,Ge=Oe;break e}Ge=se.return}}if(qt=$,mt(),be&&typeof be.onPostCommitFiberRoot=="function")try{be.onPostCommitFiberRoot(de,o)}catch{}S=!0}return S}finally{It=g,Nr.transition=c}}return!1}function WS(o,c,g){c=rc(g,c),c=mS(o,c,1),o=Ao(o,c,1),c=Ds(),o!==null&&(rs(o,1,c),Xs(o,c))}function Cn(o,c,g){if(o.tag===3)WS(o,o,g);else for(;c!==null;){if(c.tag===3){WS(c,o,g);break}else if(c.tag===1){var S=c.stateNode;if(typeof c.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(To===null||!To.has(S))){o=rc(g,o),o=hS(c,o,1),c=Ao(c,o,1),o=Ds(),c!==null&&(rs(c,1,o),Xs(c,o));break}}c=c.return}}function U8(o,c,g){var S=o.pingCache;S!==null&&S.delete(c),c=Ds(),o.pingedLanes|=o.suspendedLanes&g,cs===o&&(gs&g)===g&&(Jn===4||Jn===3&&(gs&130023424)===gs&&500>et()-A_?qi(o,0):M_|=g),Xs(o,c)}function GS(o,c){c===0&&(o.mode&1?(c=hn,hn<<=1,!(hn&130023424)&&(hn=4194304)):c=1);var g=Ds();o=Fa(o,c),o!==null&&(rs(o,c,g),Xs(o,g))}function q8(o){var c=o.memoizedState,g=0;c!==null&&(g=c.retryLane),GS(o,g)}function V8(o,c){var g=0;switch(o.tag){case 13:var S=o.stateNode,$=o.memoizedState;$!==null&&(g=$.retryLane);break;case 19:S=o.stateNode;break;default:throw Error(n(314))}S!==null&&S.delete(c),GS(o,g)}var XS;XS=function(o,c,g){if(o!==null)if(o.memoizedProps!==c.pendingProps||bs.current)Ws=!0;else{if(!(o.lanes&g)&&!(c.flags&128))return Ws=!1,T8(o,c,g);Ws=!!(o.flags&131072)}else Ws=!1,pn&&c.flags&1048576&&M1(c,ko,c.index);switch(c.lanes=0,c.tag){case 2:var S=c.type;gh(o,c),o=c.pendingProps;var $=Co(c,is.current);nc(c,g),$=i_(null,c,S,o,$,g);var P=l_();return c.flags|=1,typeof $=="object"&&$!==null&&typeof $.render=="function"&&$.$$typeof===void 0?(c.tag=1,c.memoizedState=null,c.updateQueue=null,ws(S)?(P=!0,zi(c)):P=!1,c.memoizedState=$.state!==null&&$.state!==void 0?$.state:null,e_(c),$.updater=fh,c.stateNode=$,$._reactInternals=c,f_(c,S,o,g),c=y_(null,c,S,!0,P,g)):(c.tag=0,pn&&P&&qg(c),Rs(null,c,$,g),c=c.child),c;case 16:S=c.elementType;e:{switch(gh(o,c),o=c.pendingProps,$=S._init,S=$(S._payload),c.type=S,$=c.tag=Y8(S),o=Ir(S,o),$){case 0:c=__(null,c,S,o,g);break e;case 1:c=wS(null,c,S,o,g);break e;case 11:c=_S(null,c,S,o,g);break e;case 14:c=yS(null,c,S,Ir(S.type,o),g);break e}throw Error(n(306,S,""))}return c;case 0:return S=c.type,$=c.pendingProps,$=c.elementType===S?$:Ir(S,$),__(o,c,S,$,g);case 1:return S=c.type,$=c.pendingProps,$=c.elementType===S?$:Ir(S,$),wS(o,c,S,$,g);case 3:e:{if(NS(c),o===null)throw Error(n(387));S=c.pendingProps,P=c.memoizedState,$=P.element,P1(o,c),ih(c,S,null,g);var Y=c.memoizedState;if(S=Y.element,P.isDehydrated)if(P={element:S,isDehydrated:!1,cache:Y.cache,pendingSuspenseBoundaries:Y.pendingSuspenseBoundaries,transitions:Y.transitions},c.updateQueue.baseState=P,c.memoizedState=P,c.flags&256){$=rc(Error(n(423)),c),c=jS(o,c,S,g,$);break e}else if(S!==$){$=rc(Error(n(424)),c),c=jS(o,c,S,g,$);break e}else for(ur=za(c.stateNode.containerInfo.firstChild),cr=c,pn=!0,Pr=null,g=R1(c,null,S,g),c.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling;else{if(Jl(),S===$){c=Ha(o,c,g);break e}Rs(o,c,S,g)}c=c.child}return c;case 5:return B1(c),o===null&&Yg(c),S=c.type,$=c.pendingProps,P=o!==null?o.memoizedProps:null,Y=$.children,Cu(S,$)?Y=null:P!==null&&Cu(S,P)&&(c.flags|=32),bS(o,c),Rs(o,c,Y,g),c.child;case 6:return o===null&&Yg(c),null;case 13:return SS(o,c,g);case 4:return t_(c,c.stateNode.containerInfo),S=c.pendingProps,o===null?c.child=ec(c,null,S,g):Rs(o,c,S,g),c.child;case 11:return S=c.type,$=c.pendingProps,$=c.elementType===S?$:Ir(S,$),_S(o,c,S,$,g);case 7:return Rs(o,c,c.pendingProps,g),c.child;case 8:return Rs(o,c,c.pendingProps.children,g),c.child;case 12:return Rs(o,c,c.pendingProps.children,g),c.child;case 10:e:{if(S=c.type._context,$=c.pendingProps,P=c.memoizedProps,Y=$.value,nn(rh,S._currentValue),S._currentValue=Y,P!==null)if(xn(P.value,Y)){if(P.children===$.children&&!bs.current){c=Ha(o,c,g);break e}}else for(P=c.child,P!==null&&(P.return=c);P!==null;){var se=P.dependencies;if(se!==null){Y=P.child;for(var ae=se.firstContext;ae!==null;){if(ae.context===S){if(P.tag===1){ae=Ba(-1,g&-g),ae.tag=2;var pe=P.updateQueue;if(pe!==null){pe=pe.shared;var je=pe.pending;je===null?ae.next=ae:(ae.next=je.next,je.next=ae),pe.pending=ae}}P.lanes|=g,ae=P.alternate,ae!==null&&(ae.lanes|=g),Zg(P.return,g,c),se.lanes|=g;break}ae=ae.next}}else if(P.tag===10)Y=P.type===c.type?null:P.child;else if(P.tag===18){if(Y=P.return,Y===null)throw Error(n(341));Y.lanes|=g,se=Y.alternate,se!==null&&(se.lanes|=g),Zg(Y,g,c),Y=P.sibling}else Y=P.child;if(Y!==null)Y.return=P;else for(Y=P;Y!==null;){if(Y===c){Y=null;break}if(P=Y.sibling,P!==null){P.return=Y.return,Y=P;break}Y=Y.return}P=Y}Rs(o,c,$.children,g),c=c.child}return c;case 9:return $=c.type,S=c.pendingProps.children,nc(c,g),$=br($),S=S($),c.flags|=1,Rs(o,c,S,g),c.child;case 14:return S=c.type,$=Ir(S,c.pendingProps),$=Ir(S.type,$),yS(o,c,S,$,g);case 15:return vS(o,c,c.type,c.pendingProps,g);case 17:return S=c.type,$=c.pendingProps,$=c.elementType===S?$:Ir(S,$),gh(o,c),c.tag=1,ws(S)?(o=!0,zi(c)):o=!1,nc(c,g),uS(c,S,$),f_(c,S,$,g),y_(null,c,S,!0,o,g);case 19:return CS(o,c,g);case 22:return xS(o,c,g)}throw Error(n(156,c.tag))};function QS(o,c){return qs(o,c)}function K8(o,c,g,S){this.tag=o,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=c,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jr(o,c,g,S){return new K8(o,c,g,S)}function P_(o){return o=o.prototype,!(!o||!o.isReactComponent)}function Y8(o){if(typeof o=="function")return P_(o)?1:0;if(o!=null){if(o=o.$$typeof,o===O)return 11;if(o===F)return 14}return 2}function Ro(o,c){var g=o.alternate;return g===null?(g=jr(o.tag,c,o.key,o.mode),g.elementType=o.elementType,g.type=o.type,g.stateNode=o.stateNode,g.alternate=o,o.alternate=g):(g.pendingProps=c,g.type=o.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=o.flags&14680064,g.childLanes=o.childLanes,g.lanes=o.lanes,g.child=o.child,g.memoizedProps=o.memoizedProps,g.memoizedState=o.memoizedState,g.updateQueue=o.updateQueue,c=o.dependencies,g.dependencies=c===null?null:{lanes:c.lanes,firstContext:c.firstContext},g.sibling=o.sibling,g.index=o.index,g.ref=o.ref,g}function Ch(o,c,g,S,$,P){var Y=2;if(S=o,typeof o=="function")P_(o)&&(Y=1);else if(typeof o=="string")Y=5;else e:switch(o){case z:return Ki(g.children,$,P,c);case D:Y=8,$|=8;break;case k:return o=jr(12,g,c,$|2),o.elementType=k,o.lanes=P,o;case R:return o=jr(13,g,c,$),o.elementType=R,o.lanes=P,o;case L:return o=jr(19,g,c,$),o.elementType=L,o.lanes=P,o;case q:return kh(g,$,P,c);default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case T:Y=10;break e;case A:Y=9;break e;case O:Y=11;break e;case F:Y=14;break e;case B:Y=16,S=null;break e}throw Error(n(130,o==null?o:typeof o,""))}return c=jr(Y,g,c,$),c.elementType=o,c.type=S,c.lanes=P,c}function Ki(o,c,g,S){return o=jr(7,o,S,c),o.lanes=g,o}function kh(o,c,g,S){return o=jr(22,o,S,c),o.elementType=q,o.lanes=g,o.stateNode={isHidden:!1},o}function I_(o,c,g){return o=jr(6,o,null,c),o.lanes=g,o}function F_(o,c,g){return c=jr(4,o.children!==null?o.children:[],o.key,c),c.lanes=g,c.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},c}function W8(o,c,g,S,$){this.tag=c,this.containerInfo=o,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$n(0),this.expirationTimes=$n(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$n(0),this.identifierPrefix=S,this.onRecoverableError=$,this.mutableSourceEagerHydrationData=null}function B_(o,c,g,S,$,P,Y,se,ae){return o=new W8(o,c,g,se,ae),c===1?(c=1,P===!0&&(c|=8)):c=0,P=jr(3,null,null,c),o.current=P,P.stateNode=o,P.memoizedState={element:S,isDehydrated:g,cache:null,transitions:null,pendingSuspenseBoundaries:null},e_(P),o}function G8(o,c,g){var S=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:S==null?null:""+S,children:o,containerInfo:c,implementation:g}}function ZS(o){if(!o)return ia;o=o._reactInternals;e:{if(cn(o)!==o||o.tag!==1)throw Error(n(170));var c=o;do{switch(c.tag){case 3:c=c.stateNode.context;break e;case 1:if(ws(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break e}}c=c.return}while(c!==null);throw Error(n(171))}if(o.tag===1){var g=o.type;if(ws(g))return Zt(o,g,c)}return c}function JS(o,c,g,S,$,P,Y,se,ae){return o=B_(g,S,!0,o,$,P,Y,se,ae),o.context=ZS(null),g=o.current,S=Ds(),$=Lo(g),P=Ba(S,$),P.callback=c??null,Ao(g,P,$),o.current.lanes=$,rs(o,$,S),Xs(o,S),o}function Mh(o,c,g,S){var $=c.current,P=Ds(),Y=Lo($);return g=ZS(g),c.context===null?c.context=g:c.pendingContext=g,c=Ba(P,Y),c.payload={element:o},S=S===void 0?null:S,S!==null&&(c.callback=S),o=Ao($,c,Y),o!==null&&(Hr(o,$,Y,P),oh(o,$,Y)),Y}function Ah(o){if(o=o.current,!o.child)return null;switch(o.child.tag){case 5:return o.child.stateNode;default:return o.child.stateNode}}function eE(o,c){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var g=o.retryLane;o.retryLane=g!==0&&g<c?g:c}}function H_(o,c){eE(o,c),(o=o.alternate)&&eE(o,c)}function X8(){return null}var tE=typeof reportError=="function"?reportError:function(o){console.error(o)};function U_(o){this._internalRoot=o}Oh.prototype.render=U_.prototype.render=function(o){var c=this._internalRoot;if(c===null)throw Error(n(409));Mh(o,c,null,null)},Oh.prototype.unmount=U_.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var c=o.containerInfo;Ui(function(){Mh(null,o,null,null)}),c[Dr]=null}};function Oh(o){this._internalRoot=o}Oh.prototype.unstable_scheduleHydration=function(o){if(o){var c=Lr();o={blockedOn:null,target:o,priority:c};for(var g=0;g<or.length&&c!==0&&c<or[g].priority;g++);or.splice(g,0,o),g===0&&Me(o)}};function q_(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function Th(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11&&(o.nodeType!==8||o.nodeValue!==" react-mount-point-unstable "))}function nE(){}function Q8(o,c,g,S,$){if($){if(typeof S=="function"){var P=S;S=function(){var pe=Ah(Y);P.call(pe)}}var Y=JS(c,S,o,0,null,!1,!1,"",nE);return o._reactRootContainer=Y,o[Dr]=Y.current,Oi(o.nodeType===8?o.parentNode:o),Ui(),Y}for(;$=o.lastChild;)o.removeChild($);if(typeof S=="function"){var se=S;S=function(){var pe=Ah(ae);se.call(pe)}}var ae=B_(o,0,!1,null,null,!1,!1,"",nE);return o._reactRootContainer=ae,o[Dr]=ae.current,Oi(o.nodeType===8?o.parentNode:o),Ui(function(){Mh(c,ae,g,S)}),ae}function $h(o,c,g,S,$){var P=g._reactRootContainer;if(P){var Y=P;if(typeof $=="function"){var se=$;$=function(){var ae=Ah(Y);se.call(ae)}}Mh(c,Y,o,$)}else Y=Q8(g,c,o,$,S);return Ah(Y)}Zr=function(o){switch(o.tag){case 3:var c=o.stateNode;if(c.current.memoizedState.isDehydrated){var g=Ct(c.pendingLanes);g!==0&&(Ts(c,g|1),Xs(c,et()),!(qt&6)&&(ic=et()+500,mt()))}break;case 13:Ui(function(){var S=Fa(o,1);if(S!==null){var $=Ds();Hr(S,o,1,$)}}),H_(o,1)}},Ca=function(o){if(o.tag===13){var c=Fa(o,134217728);if(c!==null){var g=Ds();Hr(c,o,134217728,g)}H_(o,134217728)}},Il=function(o){if(o.tag===13){var c=Lo(o),g=Fa(o,c);if(g!==null){var S=Ds();Hr(g,o,c,S)}H_(o,c)}},Lr=function(){return It},Fl=function(o,c){var g=It;try{return It=o,c()}finally{It=g}},Yt=function(o,c,g){switch(c){case"input":if(me(o,g),c=g.name,g.type==="radio"&&c!=null){for(g=o;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll("input[name="+JSON.stringify(""+c)+'][type="radio"]'),c=0;c<g.length;c++){var S=g[c];if(S!==o&&S.form===o.form){var $=Xl(S);if(!$)throw Error(n(90));ce(S),me(S,$)}}}break;case"textarea":ht(o,g);break;case"select":c=g.value,c!=null&&Ve(o,!!g.multiple,c,!1)}},rn=z_,Jt=Ui;var Z8={usingClientEntryPoint:!1,Events:[Li,So,Xl,wt,pt,z_]},Yu={findFiberByHostInstance:Ra,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},J8={bundleType:Yu.bundleType,version:Yu.version,rendererPackageName:Yu.rendererPackageName,rendererConfig:Yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(o){return o=hs(o),o===null?null:o.stateNode},findFiberByHostInstance:Yu.findFiberByHostInstance||X8,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Lh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Lh.isDisabled&&Lh.supportsFiber)try{de=Lh.inject(J8),be=Lh}catch{}}return Ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Z8,Ps.createPortal=function(o,c){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!q_(c))throw Error(n(200));return G8(o,c,null,g)},Ps.createRoot=function(o,c){if(!q_(o))throw Error(n(299));var g=!1,S="",$=tE;return c!=null&&(c.unstable_strictMode===!0&&(g=!0),c.identifierPrefix!==void 0&&(S=c.identifierPrefix),c.onRecoverableError!==void 0&&($=c.onRecoverableError)),c=B_(o,1,!1,null,null,g,!1,S,$),o[Dr]=c.current,Oi(o.nodeType===8?o.parentNode:o),new U_(c)},Ps.findDOMNode=function(o){if(o==null)return null;if(o.nodeType===1)return o;var c=o._reactInternals;if(c===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=hs(c),o=o===null?null:o.stateNode,o},Ps.flushSync=function(o){return Ui(o)},Ps.hydrate=function(o,c,g){if(!Th(c))throw Error(n(200));return $h(null,o,c,!0,g)},Ps.hydrateRoot=function(o,c,g){if(!q_(o))throw Error(n(405));var S=g!=null&&g.hydratedSources||null,$=!1,P="",Y=tE;if(g!=null&&(g.unstable_strictMode===!0&&($=!0),g.identifierPrefix!==void 0&&(P=g.identifierPrefix),g.onRecoverableError!==void 0&&(Y=g.onRecoverableError)),c=JS(c,null,o,1,g??null,$,!1,P,Y),o[Dr]=c.current,Oi(o),S)for(o=0;o<S.length;o++)g=S[o],$=g._getVersion,$=$(g._source),c.mutableSourceEagerHydrationData==null?c.mutableSourceEagerHydrationData=[g,$]:c.mutableSourceEagerHydrationData.push(g,$);return new Oh(c)},Ps.render=function(o,c,g){if(!Th(c))throw Error(n(200));return $h(null,o,c,!1,g)},Ps.unmountComponentAtNode=function(o){if(!Th(o))throw Error(n(40));return o._reactRootContainer?(Ui(function(){$h(null,null,o,!1,function(){o._reactRootContainer=null,o[Dr]=null})}),!0):!1},Ps.unstable_batchedUpdates=z_,Ps.unstable_renderSubtreeIntoContainer=function(o,c,g,S){if(!Th(g))throw Error(n(200));if(o==null||o._reactInternals===void 0)throw Error(n(38));return $h(o,c,g,!1,S)},Ps.version="18.3.1-next-f1338f8080-20240426",Ps}function oy(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(oy)}catch(e){console.error(e)}}oy(),ny.exports=cE();var iy=ny.exports,ly=iy;Dh.createRoot=ly.createRoot,Dh.hydrateRoot=ly.hydrateRoot;var Yi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},uE={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},dE=(_1=class{constructor(){rt(this,ao,uE);rt(this,_g,!1)}setTimeoutProvider(e){Ke(this,ao,e)}setTimeout(e,t){return re(this,ao).setTimeout(e,t)}clearTimeout(e){re(this,ao).clearTimeout(e)}setInterval(e,t){return re(this,ao).setInterval(e,t)}clearInterval(e){re(this,ao).clearInterval(e)}},ao=new WeakMap,_g=new WeakMap,_1),Fo=new dE;function mE(e){setTimeout(e,0)}var Bo=typeof window>"u"||"Deno"in globalThis;function Es(){}function hE(e,t){return typeof e=="function"?e(t):e}function Fh(e){return typeof e=="number"&&e>=0&&e!==1/0}function cy(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Va(e,t){return typeof e=="function"?e(t):e}function mr(e,t){return typeof e=="function"?e(t):e}function uy(e,t){const{type:n="all",exact:s,fetchStatus:r,predicate:i,queryKey:l,stale:u}=e;if(l){if(s){if(t.queryHash!==Bh(l,t.options))return!1}else if(!cc(t.queryKey,l))return!1}if(n!=="all"){const d=t.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||r&&r!==t.state.fetchStatus||i&&!i(t))}function dy(e,t){const{exact:n,status:s,predicate:r,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Ho(t.options.mutationKey)!==Ho(i))return!1}else if(!cc(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||r&&!r(t))}function Bh(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ho)(e)}function Ho(e){return JSON.stringify(e,(t,n)=>Hh(n)?Object.keys(n).sort().reduce((s,r)=>(s[r]=n[r],s),{}):n)}function cc(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>cc(e[n],t[n])):!1}var fE=Object.prototype.hasOwnProperty;function my(e,t){if(e===t)return e;const n=hy(e)&&hy(t);if(!n&&!(Hh(e)&&Hh(t)))return t;const r=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),l=i.length,u=n?new Array(l):{};let d=0;for(let f=0;f<l;f++){const p=n?f:i[f],h=e[p],m=t[p];if(h===m){u[p]=h,(n?f<r:fE.call(e,p))&&d++;continue}if(h===null||m===null||typeof h!="object"||typeof m!="object"){u[p]=m;continue}const _=my(h,m);u[p]=_,_===h&&d++}return r===l&&d===r?e:u}function Gu(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function hy(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Hh(e){if(!fy(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!fy(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function fy(e){return Object.prototype.toString.call(e)==="[object Object]"}function pE(e){return new Promise(t=>{Fo.setTimeout(t,e)})}function Uh(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?my(e,t):t}function gE(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function _E(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var qh=Symbol();function py(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===qh?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function gy(e,t){return typeof e=="function"?e(...t):!!e}var yE=(y1=class extends Yi{constructor(){super();rt(this,li);rt(this,oo);rt(this,Cl);Ke(this,Cl,t=>{if(!Bo&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){re(this,oo)||this.setEventListener(re(this,Cl))}onUnsubscribe(){var t;this.hasListeners()||((t=re(this,oo))==null||t.call(this),Ke(this,oo,void 0))}setEventListener(t){var n;Ke(this,Cl,t),(n=re(this,oo))==null||n.call(this),Ke(this,oo,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){re(this,li)!==t&&(Ke(this,li,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof re(this,li)=="boolean"?re(this,li):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},li=new WeakMap,oo=new WeakMap,Cl=new WeakMap,y1),Vh=new yE;function Kh(){let e,t;const n=new Promise((r,i)=>{e=r,t=i});n.status="pending",n.catch(()=>{});function s(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{s({status:"fulfilled",value:r}),e(r)},n.reject=r=>{s({status:"rejected",reason:r}),t(r)},n}var vE=mE;function xE(){let e=[],t=0,n=u=>{u()},s=u=>{u()},r=vE;const i=u=>{t?e.push(u):r(()=>{n(u)})},l=()=>{const u=e;e=[],u.length&&r(()=>{s(()=>{u.forEach(d=>{n(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||l()}return d},batchCalls:u=>(...d)=>{i(()=>{u(...d)})},schedule:i,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{r=u}}}var Gn=xE(),bE=(v1=class extends Yi{constructor(){super();rt(this,kl,!0);rt(this,io);rt(this,Ml);Ke(this,Ml,t=>{if(!Bo&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){re(this,io)||this.setEventListener(re(this,Ml))}onUnsubscribe(){var t;this.hasListeners()||((t=re(this,io))==null||t.call(this),Ke(this,io,void 0))}setEventListener(t){var n;Ke(this,Ml,t),(n=re(this,io))==null||n.call(this),Ke(this,io,t(this.setOnline.bind(this)))}setOnline(t){re(this,kl)!==t&&(Ke(this,kl,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return re(this,kl)}},kl=new WeakMap,io=new WeakMap,Ml=new WeakMap,v1),Xu=new bE;function wE(e){return Math.min(1e3*2**e,3e4)}function _y(e){return(e??"online")==="online"?Xu.isOnline():!0}var Yh=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function yy(e){let t=!1,n=0,s;const r=Kh(),i=()=>r.status!=="pending",l=y=>{var b;if(!i()){const w=new Yh(y);m(w),(b=e.onCancel)==null||b.call(e,w)}},u=()=>{t=!0},d=()=>{t=!1},f=()=>Vh.isFocused()&&(e.networkMode==="always"||Xu.isOnline())&&e.canRun(),p=()=>_y(e.networkMode)&&e.canRun(),h=y=>{i()||(s==null||s(),r.resolve(y))},m=y=>{i()||(s==null||s(),r.reject(y))},_=()=>new Promise(y=>{var b;s=w=>{(i()||f())&&y(w)},(b=e.onPause)==null||b.call(e)}).then(()=>{var y;s=void 0,i()||(y=e.onContinue)==null||y.call(e)}),v=()=>{if(i())return;let y;const b=n===0?e.initialPromise:void 0;try{y=b??e.fn()}catch(w){y=Promise.reject(w)}Promise.resolve(y).then(h).catch(w=>{var M;if(i())return;const E=e.retry??(Bo?0:3),N=e.retryDelay??wE,j=typeof N=="function"?N(n,w):N,C=E===!0||typeof E=="number"&&n<E||typeof E=="function"&&E(n,w);if(t||!C){m(w);return}n++,(M=e.onFail)==null||M.call(e,n,w),pE(j).then(()=>f()?void 0:_()).then(()=>{t?m(w):v()})})};return{promise:r,status:()=>r.status,cancel:l,continue:()=>(s==null||s(),r),cancelRetry:u,continueRetry:d,canStart:p,start:()=>(p()?v():_().then(v),r)}}var vy=(x1=class{constructor(){rt(this,ci)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Fh(this.gcTime)&&Ke(this,ci,Fo.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Bo?1/0:5*60*1e3))}clearGcTimeout(){re(this,ci)&&(Fo.clearTimeout(re(this,ci)),Ke(this,ci,void 0))}},ci=new WeakMap,x1),NE={NODE_ENV:"production"},jE=(b1=class extends vy{constructor(t){super();rt(this,Or);rt(this,ui);rt(this,Al);rt(this,fr);rt(this,di);rt(this,es);rt(this,iu);rt(this,mi);Ke(this,mi,!1),Ke(this,iu,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ke(this,di,t.client),Ke(this,fr,re(this,di).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ke(this,ui,by(this.options)),this.state=t.state??re(this,ui),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=re(this,es))==null?void 0:t.promise}setOptions(t){if(this.options={...re(this,iu),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=by(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),Ke(this,ui,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&re(this,fr).remove(this)}setData(t,n){const s=Uh(this.state.data,t,this.options);return kt(this,Or,qa).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){kt(this,Or,qa).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,r;const n=(s=re(this,es))==null?void 0:s.promise;return(r=re(this,es))==null||r.cancel(t),n?n.then(Es).catch(Es):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(re(this,ui))}isActive(){return this.observers.some(t=>mr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===qh||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Va(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!cy(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=re(this,es))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=re(this,es))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),re(this,fr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(re(this,es)&&(re(this,mi)?re(this,es).cancel({revert:!0}):re(this,es).cancelRetry()),this.scheduleGc()),re(this,fr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||kt(this,Or,qa).call(this,{type:"invalidate"})}async fetch(t,n){var d,f,p,h,m,_,v,y,b,w,E,N;if(this.state.fetchStatus!=="idle"&&((d=re(this,es))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(re(this,es))return re(this,es).continueRetry(),re(this,es).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(C=>C.options.queryFn);j&&this.setOptions(j.options)}const s=new AbortController,r=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(Ke(this,mi,!0),s.signal)})},i=()=>{const j=py(this.options,n),M=(()=>{const z={client:re(this,di),queryKey:this.queryKey,meta:this.meta};return r(z),z})();return Ke(this,mi,!1),this.options.persister?this.options.persister(j,M,this):j(M)},u=(()=>{const j={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:re(this,di),state:this.state,fetchFn:i};return r(j),j})();(f=this.options.behavior)==null||f.onFetch(u,this),Ke(this,Al,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=u.fetchOptions)==null?void 0:p.meta))&&kt(this,Or,qa).call(this,{type:"fetch",meta:(h=u.fetchOptions)==null?void 0:h.meta}),Ke(this,es,yy({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,onCancel:j=>{j instanceof Yh&&j.revert&&this.setState({...re(this,Al),fetchStatus:"idle"}),s.abort()},onFail:(j,C)=>{kt(this,Or,qa).call(this,{type:"failed",failureCount:j,error:C})},onPause:()=>{kt(this,Or,qa).call(this,{type:"pause"})},onContinue:()=>{kt(this,Or,qa).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const j=await re(this,es).start();if(j===void 0)throw NE.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(j),(_=(m=re(this,fr).config).onSuccess)==null||_.call(m,j,this),(y=(v=re(this,fr).config).onSettled)==null||y.call(v,j,this.state.error,this),j}catch(j){if(j instanceof Yh){if(j.silent)return re(this,es).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw kt(this,Or,qa).call(this,{type:"error",error:j}),(w=(b=re(this,fr).config).onError)==null||w.call(b,j,this),(N=(E=re(this,fr).config).onSettled)==null||N.call(E,this.state.data,j,this),j}finally{this.scheduleGc()}}},ui=new WeakMap,Al=new WeakMap,fr=new WeakMap,di=new WeakMap,es=new WeakMap,iu=new WeakMap,mi=new WeakMap,Or=new WeakSet,qa=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...xy(s.data,this.options),fetchMeta:t.meta??null};case"success":const r={...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Ke(this,Al,t.manual?r:void 0),r;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),Gn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),re(this,fr).notify({query:this,type:"updated",action:t})})},b1);function xy(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_y(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function by(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var SE=(w1=class extends Yi{constructor(t,n){super();rt(this,Xt);rt(this,Hs);rt(this,Dt);rt(this,lu);rt(this,ks);rt(this,hi);rt(this,Ol);rt(this,wa);rt(this,lo);rt(this,cu);rt(this,Tl);rt(this,$l);rt(this,fi);rt(this,pi);rt(this,co);rt(this,Ll,new Set);this.options=n,Ke(this,Hs,t),Ke(this,lo,null),Ke(this,wa,Kh()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(re(this,Dt).addObserver(this),wy(re(this,Dt),this.options)?kt(this,Xt,Wu).call(this):this.updateResult(),kt(this,Xt,G_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Wh(re(this,Dt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Wh(re(this,Dt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,kt(this,Xt,X_).call(this),kt(this,Xt,Q_).call(this),re(this,Dt).removeObserver(this)}setOptions(t){const n=this.options,s=re(this,Dt);if(this.options=re(this,Hs).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof mr(this.options.enabled,re(this,Dt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");kt(this,Xt,Z_).call(this),re(this,Dt).setOptions(this.options),n._defaulted&&!Gu(this.options,n)&&re(this,Hs).getQueryCache().notify({type:"observerOptionsUpdated",query:re(this,Dt),observer:this});const r=this.hasListeners();r&&Ny(re(this,Dt),s,this.options,n)&&kt(this,Xt,Wu).call(this),this.updateResult(),r&&(re(this,Dt)!==s||mr(this.options.enabled,re(this,Dt))!==mr(n.enabled,re(this,Dt))||Va(this.options.staleTime,re(this,Dt))!==Va(n.staleTime,re(this,Dt)))&&kt(this,Xt,K_).call(this);const i=kt(this,Xt,Y_).call(this);r&&(re(this,Dt)!==s||mr(this.options.enabled,re(this,Dt))!==mr(n.enabled,re(this,Dt))||i!==re(this,co))&&kt(this,Xt,W_).call(this,i)}getOptimisticResult(t){const n=re(this,Hs).getQueryCache().build(re(this,Hs),t),s=this.createResult(n,t);return CE(this,s)&&(Ke(this,ks,s),Ke(this,Ol,this.options),Ke(this,hi,re(this,Dt).state)),s}getCurrentResult(){return re(this,ks)}trackResult(t,n){return new Proxy(t,{get:(s,r)=>(this.trackProp(r),n==null||n(r),r==="promise"&&!this.options.experimental_prefetchInRender&&re(this,wa).status==="pending"&&re(this,wa).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(s,r))})}trackProp(t){re(this,Ll).add(t)}getCurrentQuery(){return re(this,Dt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=re(this,Hs).defaultQueryOptions(t),s=re(this,Hs).getQueryCache().build(re(this,Hs),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(t){return kt(this,Xt,Wu).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),re(this,ks)))}createResult(t,n){var k;const s=re(this,Dt),r=this.options,i=re(this,ks),l=re(this,hi),u=re(this,Ol),f=t!==s?t.state:re(this,lu),{state:p}=t;let h={...p},m=!1,_;if(n._optimisticResults){const T=this.hasListeners(),A=!T&&wy(t,n),O=T&&Ny(t,s,n,r);(A||O)&&(h={...h,...xy(p.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:v,errorUpdatedAt:y,status:b}=h;_=h.data;let w=!1;if(n.placeholderData!==void 0&&_===void 0&&b==="pending"){let T;i!=null&&i.isPlaceholderData&&n.placeholderData===(u==null?void 0:u.placeholderData)?(T=i.data,w=!0):T=typeof n.placeholderData=="function"?n.placeholderData((k=re(this,$l))==null?void 0:k.state.data,re(this,$l)):n.placeholderData,T!==void 0&&(b="success",_=Uh(i==null?void 0:i.data,T,n),m=!0)}if(n.select&&_!==void 0&&!w)if(i&&_===(l==null?void 0:l.data)&&n.select===re(this,cu))_=re(this,Tl);else try{Ke(this,cu,n.select),_=n.select(_),_=Uh(i==null?void 0:i.data,_,n),Ke(this,Tl,_),Ke(this,lo,null)}catch(T){Ke(this,lo,T)}re(this,lo)&&(v=re(this,lo),_=re(this,Tl),y=Date.now(),b="error");const E=h.fetchStatus==="fetching",N=b==="pending",j=b==="error",C=N&&E,M=_!==void 0,D={status:b,fetchStatus:h.fetchStatus,isPending:N,isSuccess:b==="success",isError:j,isInitialLoading:C,isLoading:C,data:_,dataUpdatedAt:h.dataUpdatedAt,error:v,errorUpdatedAt:y,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>f.dataUpdateCount||h.errorUpdateCount>f.errorUpdateCount,isFetching:E,isRefetching:E&&!N,isLoadingError:j&&!M,isPaused:h.fetchStatus==="paused",isPlaceholderData:m,isRefetchError:j&&M,isStale:Gh(t,n),refetch:this.refetch,promise:re(this,wa),isEnabled:mr(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=R=>{D.status==="error"?R.reject(D.error):D.data!==void 0&&R.resolve(D.data)},A=()=>{const R=Ke(this,wa,D.promise=Kh());T(R)},O=re(this,wa);switch(O.status){case"pending":t.queryHash===s.queryHash&&T(O);break;case"fulfilled":(D.status==="error"||D.data!==O.value)&&A();break;case"rejected":(D.status!=="error"||D.error!==O.reason)&&A();break}}return D}updateResult(){const t=re(this,ks),n=this.createResult(re(this,Dt),this.options);if(Ke(this,hi,re(this,Dt).state),Ke(this,Ol,this.options),re(this,hi).data!==void 0&&Ke(this,$l,re(this,Dt)),Gu(n,t))return;Ke(this,ks,n);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:r}=this.options,i=typeof r=="function"?r():r;if(i==="all"||!i&&!re(this,Ll).size)return!0;const l=new Set(i??re(this,Ll));return this.options.throwOnError&&l.add("error"),Object.keys(re(this,ks)).some(u=>{const d=u;return re(this,ks)[d]!==t[d]&&l.has(d)})};kt(this,Xt,rE).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&kt(this,Xt,G_).call(this)}},Hs=new WeakMap,Dt=new WeakMap,lu=new WeakMap,ks=new WeakMap,hi=new WeakMap,Ol=new WeakMap,wa=new WeakMap,lo=new WeakMap,cu=new WeakMap,Tl=new WeakMap,$l=new WeakMap,fi=new WeakMap,pi=new WeakMap,co=new WeakMap,Ll=new WeakMap,Xt=new WeakSet,Wu=function(t){kt(this,Xt,Z_).call(this);let n=re(this,Dt).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Es)),n},K_=function(){kt(this,Xt,X_).call(this);const t=Va(this.options.staleTime,re(this,Dt));if(Bo||re(this,ks).isStale||!Fh(t))return;const s=cy(re(this,ks).dataUpdatedAt,t)+1;Ke(this,fi,Fo.setTimeout(()=>{re(this,ks).isStale||this.updateResult()},s))},Y_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(re(this,Dt)):this.options.refetchInterval)??!1},W_=function(t){kt(this,Xt,Q_).call(this),Ke(this,co,t),!(Bo||mr(this.options.enabled,re(this,Dt))===!1||!Fh(re(this,co))||re(this,co)===0)&&Ke(this,pi,Fo.setInterval(()=>{(this.options.refetchIntervalInBackground||Vh.isFocused())&&kt(this,Xt,Wu).call(this)},re(this,co)))},G_=function(){kt(this,Xt,K_).call(this),kt(this,Xt,W_).call(this,kt(this,Xt,Y_).call(this))},X_=function(){re(this,fi)&&(Fo.clearTimeout(re(this,fi)),Ke(this,fi,void 0))},Q_=function(){re(this,pi)&&(Fo.clearInterval(re(this,pi)),Ke(this,pi,void 0))},Z_=function(){const t=re(this,Hs).getQueryCache().build(re(this,Hs),this.options);if(t===re(this,Dt))return;const n=re(this,Dt);Ke(this,Dt,t),Ke(this,lu,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},rE=function(t){Gn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(re(this,ks))}),re(this,Hs).getQueryCache().notify({query:re(this,Dt),type:"observerResultsUpdated"})})},w1);function EE(e,t){return mr(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function wy(e,t){return EE(e,t)||e.state.data!==void 0&&Wh(e,t,t.refetchOnMount)}function Wh(e,t,n){if(mr(t.enabled,e)!==!1&&Va(t.staleTime,e)!=="static"){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&Gh(e,t)}return!1}function Ny(e,t,n,s){return(e!==t||mr(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Gh(e,n)}function Gh(e,t){return mr(t.enabled,e)!==!1&&e.isStaleByTime(Va(t.staleTime,e))}function CE(e,t){return!Gu(e.getCurrentResult(),t)}function jy(e){return{onFetch:(t,n)=>{var p,h,m,_,v;const s=t.options,r=(m=(h=(p=t.fetchOptions)==null?void 0:p.meta)==null?void 0:h.fetchMore)==null?void 0:m.direction,i=((_=t.state.data)==null?void 0:_.pages)||[],l=((v=t.state.data)==null?void 0:v.pageParams)||[];let u={pages:[],pageParams:[]},d=0;const f=async()=>{let y=!1;const b=N=>{Object.defineProperty(N,"signal",{enumerable:!0,get:()=>(t.signal.aborted?y=!0:t.signal.addEventListener("abort",()=>{y=!0}),t.signal)})},w=py(t.options,t.fetchOptions),E=async(N,j,C)=>{if(y)return Promise.reject();if(j==null&&N.pages.length)return Promise.resolve(N);const z=(()=>{const A={client:t.client,queryKey:t.queryKey,pageParam:j,direction:C?"backward":"forward",meta:t.options.meta};return b(A),A})(),D=await w(z),{maxPages:k}=t.options,T=C?_E:gE;return{pages:T(N.pages,D,k),pageParams:T(N.pageParams,j,k)}};if(r&&i.length){const N=r==="backward",j=N?kE:Sy,C={pages:i,pageParams:l},M=j(s,C);u=await E(C,M,N)}else{const N=e??i.length;do{const j=d===0?l[0]??s.initialPageParam:Sy(s,u);if(d>0&&j==null)break;u=await E(u,j),d++}while(d<N)}return u};t.options.persister?t.fetchFn=()=>{var y,b;return(b=(y=t.options).persister)==null?void 0:b.call(y,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=f}}}function Sy(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function kE(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var ME=(N1=class extends vy{constructor(t){super();rt(this,Gr);rt(this,uu);rt(this,Wr);rt(this,Ms);rt(this,gi);Ke(this,uu,t.client),this.mutationId=t.mutationId,Ke(this,Ms,t.mutationCache),Ke(this,Wr,[]),this.state=t.state||Ey(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){re(this,Wr).includes(t)||(re(this,Wr).push(t),this.clearGcTimeout(),re(this,Ms).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ke(this,Wr,re(this,Wr).filter(n=>n!==t)),this.scheduleGc(),re(this,Ms).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){re(this,Wr).length||(this.state.status==="pending"?this.scheduleGc():re(this,Ms).remove(this))}continue(){var t;return((t=re(this,gi))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var l,u,d,f,p,h,m,_,v,y,b,w,E,N,j,C,M,z,D,k;const n=()=>{kt(this,Gr,Po).call(this,{type:"continue"})},s={client:re(this,uu),meta:this.options.meta,mutationKey:this.options.mutationKey};Ke(this,gi,yy({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(T,A)=>{kt(this,Gr,Po).call(this,{type:"failed",failureCount:T,error:A})},onPause:()=>{kt(this,Gr,Po).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>re(this,Ms).canRun(this)}));const r=this.state.status==="pending",i=!re(this,gi).canStart();try{if(r)n();else{kt(this,Gr,Po).call(this,{type:"pending",variables:t,isPaused:i}),await((u=(l=re(this,Ms).config).onMutate)==null?void 0:u.call(l,t,this,s));const A=await((f=(d=this.options).onMutate)==null?void 0:f.call(d,t,s));A!==this.state.context&&kt(this,Gr,Po).call(this,{type:"pending",context:A,variables:t,isPaused:i})}const T=await re(this,gi).start();return await((h=(p=re(this,Ms).config).onSuccess)==null?void 0:h.call(p,T,t,this.state.context,this,s)),await((_=(m=this.options).onSuccess)==null?void 0:_.call(m,T,t,this.state.context,s)),await((y=(v=re(this,Ms).config).onSettled)==null?void 0:y.call(v,T,null,this.state.variables,this.state.context,this,s)),await((w=(b=this.options).onSettled)==null?void 0:w.call(b,T,null,t,this.state.context,s)),kt(this,Gr,Po).call(this,{type:"success",data:T}),T}catch(T){try{throw await((N=(E=re(this,Ms).config).onError)==null?void 0:N.call(E,T,t,this.state.context,this,s)),await((C=(j=this.options).onError)==null?void 0:C.call(j,T,t,this.state.context,s)),await((z=(M=re(this,Ms).config).onSettled)==null?void 0:z.call(M,void 0,T,this.state.variables,this.state.context,this,s)),await((k=(D=this.options).onSettled)==null?void 0:k.call(D,void 0,T,t,this.state.context,s)),T}finally{kt(this,Gr,Po).call(this,{type:"error",error:T})}}finally{re(this,Ms).runNext(this)}}},uu=new WeakMap,Wr=new WeakMap,Ms=new WeakMap,gi=new WeakMap,Gr=new WeakSet,Po=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Gn.batch(()=>{re(this,Wr).forEach(s=>{s.onMutationUpdate(t)}),re(this,Ms).notify({mutation:this,type:"updated",action:t})})},N1);function Ey(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var AE=(j1=class extends Yi{constructor(t={}){super();rt(this,Na);rt(this,Tr);rt(this,du);this.config=t,Ke(this,Na,new Set),Ke(this,Tr,new Map),Ke(this,du,0)}build(t,n,s){const r=new ME({client:t,mutationCache:this,mutationId:++zh(this,du)._,options:t.defaultMutationOptions(n),state:s});return this.add(r),r}add(t){re(this,Na).add(t);const n=Qu(t);if(typeof n=="string"){const s=re(this,Tr).get(n);s?s.push(t):re(this,Tr).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(re(this,Na).delete(t)){const n=Qu(t);if(typeof n=="string"){const s=re(this,Tr).get(n);if(s)if(s.length>1){const r=s.indexOf(t);r!==-1&&s.splice(r,1)}else s[0]===t&&re(this,Tr).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Qu(t);if(typeof n=="string"){const s=re(this,Tr).get(n),r=s==null?void 0:s.find(i=>i.state.status==="pending");return!r||r===t}else return!0}runNext(t){var s;const n=Qu(t);if(typeof n=="string"){const r=(s=re(this,Tr).get(n))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(r==null?void 0:r.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Gn.batch(()=>{re(this,Na).forEach(t=>{this.notify({type:"removed",mutation:t})}),re(this,Na).clear(),re(this,Tr).clear()})}getAll(){return Array.from(re(this,Na))}find(t){const n={exact:!0,...t};return this.getAll().find(s=>dy(n,s))}findAll(t={}){return this.getAll().filter(n=>dy(t,n))}notify(t){Gn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Gn.batch(()=>Promise.all(t.map(n=>n.continue().catch(Es))))}},Na=new WeakMap,Tr=new WeakMap,du=new WeakMap,j1);function Qu(e){var t;return(t=e.options.scope)==null?void 0:t.id}var OE=(S1=class extends Yi{constructor(t,n){super();rt(this,Ea);rt(this,ja);rt(this,uo);rt(this,Us);rt(this,Sa);Ke(this,ja,t),this.setOptions(n),this.bindMethods(),kt(this,Ea,Rh).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const n=this.options;this.options=re(this,ja).defaultMutationOptions(t),Gu(this.options,n)||re(this,ja).getMutationCache().notify({type:"observerOptionsUpdated",mutation:re(this,Us),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Ho(n.mutationKey)!==Ho(this.options.mutationKey)?this.reset():((s=re(this,Us))==null?void 0:s.state.status)==="pending"&&re(this,Us).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=re(this,Us))==null||t.removeObserver(this)}onMutationUpdate(t){kt(this,Ea,Rh).call(this),kt(this,Ea,J_).call(this,t)}getCurrentResult(){return re(this,uo)}reset(){var t;(t=re(this,Us))==null||t.removeObserver(this),Ke(this,Us,void 0),kt(this,Ea,Rh).call(this),kt(this,Ea,J_).call(this)}mutate(t,n){var s;return Ke(this,Sa,n),(s=re(this,Us))==null||s.removeObserver(this),Ke(this,Us,re(this,ja).getMutationCache().build(re(this,ja),this.options)),re(this,Us).addObserver(this),re(this,Us).execute(t)}},ja=new WeakMap,uo=new WeakMap,Us=new WeakMap,Sa=new WeakMap,Ea=new WeakSet,Rh=function(){var n;const t=((n=re(this,Us))==null?void 0:n.state)??Ey();Ke(this,uo,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},J_=function(t){Gn.batch(()=>{var n,s,r,i,l,u,d,f;if(re(this,Sa)&&this.hasListeners()){const p=re(this,uo).variables,h=re(this,uo).context,m={client:re(this,ja),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((s=(n=re(this,Sa)).onSuccess)==null||s.call(n,t.data,p,h,m),(i=(r=re(this,Sa)).onSettled)==null||i.call(r,t.data,null,p,h,m)):(t==null?void 0:t.type)==="error"&&((u=(l=re(this,Sa)).onError)==null||u.call(l,t.error,p,h,m),(f=(d=re(this,Sa)).onSettled)==null||f.call(d,void 0,t.error,p,h,m))}this.listeners.forEach(p=>{p(re(this,uo))})})},S1),TE=(E1=class extends Yi{constructor(t={}){super();rt(this,Xr);this.config=t,Ke(this,Xr,new Map)}build(t,n,s){const r=n.queryKey,i=n.queryHash??Bh(r,n);let l=this.get(i);return l||(l=new jE({client:t,queryKey:r,queryHash:i,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(r)}),this.add(l)),l}add(t){re(this,Xr).has(t.queryHash)||(re(this,Xr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=re(this,Xr).get(t.queryHash);n&&(t.destroy(),n===t&&re(this,Xr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Gn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return re(this,Xr).get(t)}getAll(){return[...re(this,Xr).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>uy(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>uy(t,s)):n}notify(t){Gn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Gn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Gn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Xr=new WeakMap,E1),$E=(C1=class{constructor(e={}){rt(this,jn);rt(this,mo);rt(this,ho);rt(this,zl);rt(this,Rl);rt(this,fo);rt(this,Dl);rt(this,Pl);Ke(this,jn,e.queryCache||new TE),Ke(this,mo,e.mutationCache||new AE),Ke(this,ho,e.defaultOptions||{}),Ke(this,zl,new Map),Ke(this,Rl,new Map),Ke(this,fo,0)}mount(){zh(this,fo)._++,re(this,fo)===1&&(Ke(this,Dl,Vh.subscribe(async e=>{e&&(await this.resumePausedMutations(),re(this,jn).onFocus())})),Ke(this,Pl,Xu.subscribe(async e=>{e&&(await this.resumePausedMutations(),re(this,jn).onOnline())})))}unmount(){var e,t;zh(this,fo)._--,re(this,fo)===0&&((e=re(this,Dl))==null||e.call(this),Ke(this,Dl,void 0),(t=re(this,Pl))==null||t.call(this),Ke(this,Pl,void 0))}isFetching(e){return re(this,jn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return re(this,mo).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=re(this,jn).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=re(this,jn).build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Va(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return re(this,jn).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),r=re(this,jn).get(s.queryHash),i=r==null?void 0:r.state.data,l=hE(t,i);if(l!==void 0)return re(this,jn).build(this,s).setData(l,{...n,manual:!0})}setQueriesData(e,t,n){return Gn.batch(()=>re(this,jn).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=re(this,jn).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=re(this,jn);Gn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=re(this,jn);return Gn.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=Gn.batch(()=>re(this,jn).findAll(e).map(r=>r.cancel(n)));return Promise.all(s).then(Es).catch(Es)}invalidateQueries(e,t={}){return Gn.batch(()=>(re(this,jn).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=Gn.batch(()=>re(this,jn).findAll(e).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let i=r.fetch(void 0,n);return n.throwOnError||(i=i.catch(Es)),r.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Es)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=re(this,jn).build(this,t);return n.isStaleByTime(Va(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Es).catch(Es)}fetchInfiniteQuery(e){return e.behavior=jy(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Es).catch(Es)}ensureInfiniteQueryData(e){return e.behavior=jy(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Xu.isOnline()?re(this,mo).resumePausedMutations():Promise.resolve()}getQueryCache(){return re(this,jn)}getMutationCache(){return re(this,mo)}getDefaultOptions(){return re(this,ho)}setDefaultOptions(e){Ke(this,ho,e)}setQueryDefaults(e,t){re(this,zl).set(Ho(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...re(this,zl).values()],n={};return t.forEach(s=>{cc(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){re(this,Rl).set(Ho(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...re(this,Rl).values()],n={};return t.forEach(s=>{cc(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...re(this,ho).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Bh(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===qh&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...re(this,ho).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){re(this,jn).clear(),re(this,mo).clear()}},jn=new WeakMap,mo=new WeakMap,ho=new WeakMap,zl=new WeakMap,Rl=new WeakMap,fo=new WeakMap,Dl=new WeakMap,Pl=new WeakMap,C1),Cy=x.createContext(void 0),Ka=e=>{const t=x.useContext(Cy);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},LE=({client:e,children:t})=>(x.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(Cy.Provider,{value:e,children:t})),ky=x.createContext(!1),zE=()=>x.useContext(ky);ky.Provider;function RE(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var DE=x.createContext(RE()),PE=()=>x.useContext(DE),IE=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},FE=e=>{x.useEffect(()=>{e.clearReset()},[e])},BE=({result:e,errorResetBoundary:t,throwOnError:n,query:s,suspense:r})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(r&&e.data===void 0||gy(n,[e.error,s])),HE=e=>{if(e.suspense){const n=r=>r==="static"?r:Math.max(r??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...r)=>n(s(...r)):n(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},UE=(e,t)=>e.isLoading&&e.isFetching&&!t,qE=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,My=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function VE(e,t,n){var h,m,_,v,y;const s=zE(),r=PE(),i=Ka(),l=i.defaultQueryOptions(e);(m=(h=i.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||m.call(h,l),l._optimisticResults=s?"isRestoring":"optimistic",HE(l),IE(l,r),FE(r);const u=!i.getQueryCache().get(l.queryHash),[d]=x.useState(()=>new t(i,l)),f=d.getOptimisticResult(l),p=!s&&e.subscribed!==!1;if(x.useSyncExternalStore(x.useCallback(b=>{const w=p?d.subscribe(Gn.batchCalls(b)):Es;return d.updateResult(),w},[d,p]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),x.useEffect(()=>{d.setOptions(l)},[l,d]),qE(l,f))throw My(l,d,r);if(BE({result:f,errorResetBoundary:r,throwOnError:l.throwOnError,query:i.getQueryCache().get(l.queryHash),suspense:l.suspense}))throw f.error;if((v=(_=i.getDefaultOptions().queries)==null?void 0:_._experimental_afterQuery)==null||v.call(_,l,f),l.experimental_prefetchInRender&&!Bo&&UE(f,s)){const b=u?My(l,d,r):(y=i.getQueryCache().get(l.queryHash))==null?void 0:y.promise;b==null||b.catch(Es).finally(()=>{d.updateResult()})}return l.notifyOnChangeProps?f:d.trackResult(f)}function Is(e,t){return VE(e,SE)}function Wi(e,t){const n=Ka(),[s]=x.useState(()=>new OE(n,e));x.useEffect(()=>{s.setOptions(e)},[s,e]);const r=x.useSyncExternalStore(x.useCallback(l=>s.subscribe(Gn.batchCalls(l)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=x.useCallback((l,u)=>{s.mutate(l,u).catch(Es)},[s]);if(r.error&&gy(s.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:i,mutateAsync:r.mutate}}function KE(e){let t;const n=new Set,s=(f,p)=>{const h=typeof f=="function"?f(t):f;if(h!==t){const m=t;t=p?h:Object.assign({},t,h),n.forEach(_=>_(t,m))}},r=()=>t,i=(f,p=r,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let m=p(t);function _(){const v=p(t);if(!h(m,v)){const y=m;f(m=v,y)}}return n.add(_),()=>n.delete(_)},d={setState:s,getState:r,subscribe:(f,p,h)=>p||h?i(f,p,h):(n.add(f),()=>n.delete(f)),destroy:()=>n.clear()};return t=e(s,r,d),d}const Ay=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?x.useEffect:x.useLayoutEffect;function YE(e){const t=typeof e=="function"?KE(e):e,n=(s=t.getState,r=Object.is)=>{const[,i]=x.useReducer(b=>b+1,0),l=t.getState(),u=x.useRef(l),d=x.useRef(s),f=x.useRef(r),p=x.useRef(!1),h=x.useRef();h.current===void 0&&(h.current=s(l));let m,_=!1;(u.current!==l||d.current!==s||f.current!==r||p.current)&&(m=s(l),_=!r(h.current,m)),Ay(()=>{_&&(h.current=m),u.current=l,d.current=s,f.current=r,p.current=!1});const v=x.useRef(l);Ay(()=>{const b=()=>{try{const E=t.getState(),N=d.current(E);f.current(h.current,N)||(u.current=E,h.current=N,i())}catch{p.current=!0,i()}},w=t.subscribe(b);return t.getState()!==v.current&&b(),w},[]);const y=_?m:h.current;return x.useDebugValue(y),y};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[n,t];return{next(){const r=s.length<=0;return{value:s.shift(),done:r}}}},n}function WE(){const e=x.createContext(void 0);return{Provider:({initialStore:r,createStore:i,children:l})=>{const u=x.useRef();return u.current||(r&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),i||(i=()=>r)),u.current=i()),x.createElement(e.Provider,{value:u.current},l)},useStore:(r,i=Object.is)=>{const l=x.useContext(e);if(!l)throw new Error("Seems like you have not used zustand provider as an ancestor.");return l(r,i)},useStoreApi:()=>{const r=x.useContext(e);if(!r)throw new Error("Seems like you have not used zustand provider as an ancestor.");return x.useMemo(()=>({getState:r.getState,setState:r.setState,subscribe:r.subscribe,destroy:r.destroy}),[r])}}}var GE={value:()=>{}};function Zu(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new Ju(n)}function Ju(e){this._=e}function XE(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",r=n.indexOf(".");if(r>=0&&(s=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}Ju.prototype=Zu.prototype={constructor:Ju,on:function(e,t){var n=this._,s=XE(e+"",n),r,i=-1,l=s.length;if(arguments.length<2){for(;++i<l;)if((r=(e=s[i]).type)&&(r=QE(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<l;)if(r=(e=s[i]).type)n[r]=Oy(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Oy(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Ju(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),s=0,r,i;s<r;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],s=0,r=i.length;s<r;++s)i[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],r=0,i=s.length;r<i;++r)s[r].value.apply(t,n)}};function QE(e,t){for(var n=0,s=e.length,r;n<s;++n)if((r=e[n]).name===t)return r.value}function Oy(e,t,n){for(var s=0,r=e.length;s<r;++s)if(e[s].name===t){e[s]=GE,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var Xh="http://www.w3.org/1999/xhtml";const Ty={svg:"http://www.w3.org/2000/svg",xhtml:Xh,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function ed(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ty.hasOwnProperty(t)?{space:Ty[t],local:e}:e}function ZE(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Xh&&t.documentElement.namespaceURI===Xh?t.createElement(e):t.createElementNS(n,e)}}function JE(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function $y(e){var t=ed(e);return(t.local?JE:ZE)(t)}function eC(){}function Qh(e){return e==null?eC:function(){return this.querySelector(e)}}function tC(e){typeof e!="function"&&(e=Qh(e));for(var t=this._groups,n=t.length,s=new Array(n),r=0;r<n;++r)for(var i=t[r],l=i.length,u=s[r]=new Array(l),d,f,p=0;p<l;++p)(d=i[p])&&(f=e.call(d,d.__data__,p,i))&&("__data__"in d&&(f.__data__=d.__data__),u[p]=f);return new Qs(s,this._parents)}function nC(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function sC(){return[]}function Ly(e){return e==null?sC:function(){return this.querySelectorAll(e)}}function rC(e){return function(){return nC(e.apply(this,arguments))}}function aC(e){typeof e=="function"?e=rC(e):e=Ly(e);for(var t=this._groups,n=t.length,s=[],r=[],i=0;i<n;++i)for(var l=t[i],u=l.length,d,f=0;f<u;++f)(d=l[f])&&(s.push(e.call(d,d.__data__,f,l)),r.push(d));return new Qs(s,r)}function zy(e){return function(){return this.matches(e)}}function Ry(e){return function(t){return t.matches(e)}}var oC=Array.prototype.find;function iC(e){return function(){return oC.call(this.children,e)}}function lC(){return this.firstElementChild}function cC(e){return this.select(e==null?lC:iC(typeof e=="function"?e:Ry(e)))}var uC=Array.prototype.filter;function dC(){return Array.from(this.children)}function mC(e){return function(){return uC.call(this.children,e)}}function hC(e){return this.selectAll(e==null?dC:mC(typeof e=="function"?e:Ry(e)))}function fC(e){typeof e!="function"&&(e=zy(e));for(var t=this._groups,n=t.length,s=new Array(n),r=0;r<n;++r)for(var i=t[r],l=i.length,u=s[r]=[],d,f=0;f<l;++f)(d=i[f])&&e.call(d,d.__data__,f,i)&&u.push(d);return new Qs(s,this._parents)}function Dy(e){return new Array(e.length)}function pC(){return new Qs(this._enter||this._groups.map(Dy),this._parents)}function td(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}td.prototype={constructor:td,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function gC(e){return function(){return e}}function _C(e,t,n,s,r,i){for(var l=0,u,d=t.length,f=i.length;l<f;++l)(u=t[l])?(u.__data__=i[l],s[l]=u):n[l]=new td(e,i[l]);for(;l<d;++l)(u=t[l])&&(r[l]=u)}function yC(e,t,n,s,r,i,l){var u,d,f=new Map,p=t.length,h=i.length,m=new Array(p),_;for(u=0;u<p;++u)(d=t[u])&&(m[u]=_=l.call(d,d.__data__,u,t)+"",f.has(_)?r[u]=d:f.set(_,d));for(u=0;u<h;++u)_=l.call(e,i[u],u,i)+"",(d=f.get(_))?(s[u]=d,d.__data__=i[u],f.delete(_)):n[u]=new td(e,i[u]);for(u=0;u<p;++u)(d=t[u])&&f.get(m[u])===d&&(r[u]=d)}function vC(e){return e.__data__}function xC(e,t){if(!arguments.length)return Array.from(this,vC);var n=t?yC:_C,s=this._parents,r=this._groups;typeof e!="function"&&(e=gC(e));for(var i=r.length,l=new Array(i),u=new Array(i),d=new Array(i),f=0;f<i;++f){var p=s[f],h=r[f],m=h.length,_=bC(e.call(p,p&&p.__data__,f,s)),v=_.length,y=u[f]=new Array(v),b=l[f]=new Array(v),w=d[f]=new Array(m);n(p,h,y,b,w,_,t);for(var E=0,N=0,j,C;E<v;++E)if(j=y[E]){for(E>=N&&(N=E+1);!(C=b[N])&&++N<v;);j._next=C||null}}return l=new Qs(l,s),l._enter=u,l._exit=d,l}function bC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wC(){return new Qs(this._exit||this._groups.map(Dy),this._parents)}function NC(e,t,n){var s=this.enter(),r=this,i=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),s&&r?s.merge(r).order():r}function jC(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,r=n.length,i=s.length,l=Math.min(r,i),u=new Array(r),d=0;d<l;++d)for(var f=n[d],p=s[d],h=f.length,m=u[d]=new Array(h),_,v=0;v<h;++v)(_=f[v]||p[v])&&(m[v]=_);for(;d<r;++d)u[d]=n[d];return new Qs(u,this._parents)}function SC(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],r=s.length-1,i=s[r],l;--r>=0;)(l=s[r])&&(i&&l.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(l,i),i=l);return this}function EC(e){e||(e=CC);function t(h,m){return h&&m?e(h.__data__,m.__data__):!h-!m}for(var n=this._groups,s=n.length,r=new Array(s),i=0;i<s;++i){for(var l=n[i],u=l.length,d=r[i]=new Array(u),f,p=0;p<u;++p)(f=l[p])&&(d[p]=f);d.sort(t)}return new Qs(r,this._parents).order()}function CC(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function kC(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function MC(){return Array.from(this)}function AC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],r=0,i=s.length;r<i;++r){var l=s[r];if(l)return l}return null}function OC(){let e=0;for(const t of this)++e;return e}function TC(){return!this.node()}function $C(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var r=t[n],i=0,l=r.length,u;i<l;++i)(u=r[i])&&e.call(u,u.__data__,i,r);return this}function LC(e){return function(){this.removeAttribute(e)}}function zC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function RC(e,t){return function(){this.setAttribute(e,t)}}function DC(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function PC(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function IC(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function FC(e,t){var n=ed(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?zC:LC:typeof t=="function"?n.local?IC:PC:n.local?DC:RC)(n,t))}function Py(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function BC(e){return function(){this.style.removeProperty(e)}}function HC(e,t,n){return function(){this.style.setProperty(e,t,n)}}function UC(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function qC(e,t,n){return arguments.length>1?this.each((t==null?BC:typeof t=="function"?UC:HC)(e,t,n??"")):Gi(this.node(),e)}function Gi(e,t){return e.style.getPropertyValue(t)||Py(e).getComputedStyle(e,null).getPropertyValue(t)}function VC(e){return function(){delete this[e]}}function KC(e,t){return function(){this[e]=t}}function YC(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function WC(e,t){return arguments.length>1?this.each((t==null?VC:typeof t=="function"?YC:KC)(e,t)):this.node()[e]}function Iy(e){return e.trim().split(/^|\s+/)}function Zh(e){return e.classList||new Fy(e)}function Fy(e){this._node=e,this._names=Iy(e.getAttribute("class")||"")}Fy.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function By(e,t){for(var n=Zh(e),s=-1,r=t.length;++s<r;)n.add(t[s])}function Hy(e,t){for(var n=Zh(e),s=-1,r=t.length;++s<r;)n.remove(t[s])}function GC(e){return function(){By(this,e)}}function XC(e){return function(){Hy(this,e)}}function QC(e,t){return function(){(t.apply(this,arguments)?By:Hy)(this,e)}}function ZC(e,t){var n=Iy(e+"");if(arguments.length<2){for(var s=Zh(this.node()),r=-1,i=n.length;++r<i;)if(!s.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?QC:t?GC:XC)(n,t))}function JC(){this.textContent=""}function ek(e){return function(){this.textContent=e}}function tk(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function nk(e){return arguments.length?this.each(e==null?JC:(typeof e=="function"?tk:ek)(e)):this.node().textContent}function sk(){this.innerHTML=""}function rk(e){return function(){this.innerHTML=e}}function ak(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ok(e){return arguments.length?this.each(e==null?sk:(typeof e=="function"?ak:rk)(e)):this.node().innerHTML}function ik(){this.nextSibling&&this.parentNode.appendChild(this)}function lk(){return this.each(ik)}function ck(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function uk(){return this.each(ck)}function dk(e){var t=typeof e=="function"?e:$y(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function mk(){return null}function hk(e,t){var n=typeof e=="function"?e:$y(e),s=t==null?mk:typeof t=="function"?t:Qh(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function fk(){var e=this.parentNode;e&&e.removeChild(this)}function pk(){return this.each(fk)}function gk(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function _k(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function yk(e){return this.select(e?_k:gk)}function vk(e){return arguments.length?this.property("__data__",e):this.node().__data__}function xk(e){return function(t){e.call(this,t,this.__data__)}}function bk(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function wk(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++s]=i;++s?t.length=s:delete this.__on}}}function Nk(e,t,n){return function(){var s=this.__on,r,i=xk(t);if(s){for(var l=0,u=s.length;l<u;++l)if((r=s[l]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},s?s.push(r):this.__on=[r]}}function jk(e,t,n){var s=bk(e+""),r,i=s.length,l;if(arguments.length<2){var u=this.node().__on;if(u){for(var d=0,f=u.length,p;d<f;++d)for(r=0,p=u[d];r<i;++r)if((l=s[r]).type===p.type&&l.name===p.name)return p.value}return}for(u=t?Nk:wk,r=0;r<i;++r)this.each(u(s[r],t,n));return this}function Uy(e,t,n){var s=Py(e),r=s.CustomEvent;typeof r=="function"?r=new r(t,n):(r=s.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Sk(e,t){return function(){return Uy(this,e,t)}}function Ek(e,t){return function(){return Uy(this,e,t.apply(this,arguments))}}function Ck(e,t){return this.each((typeof t=="function"?Ek:Sk)(e,t))}function*kk(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],r=0,i=s.length,l;r<i;++r)(l=s[r])&&(yield l)}var qy=[null];function Qs(e,t){this._groups=e,this._parents=t}function uc(){return new Qs([[document.documentElement]],qy)}function Mk(){return this}Qs.prototype=uc.prototype={constructor:Qs,select:tC,selectAll:aC,selectChild:cC,selectChildren:hC,filter:fC,data:xC,enter:pC,exit:wC,join:NC,merge:jC,selection:Mk,order:SC,sort:EC,call:kC,nodes:MC,node:AC,size:OC,empty:TC,each:$C,attr:FC,style:qC,property:WC,classed:ZC,text:nk,html:ok,raise:lk,lower:uk,append:dk,insert:hk,remove:pk,clone:yk,datum:vk,on:jk,dispatch:Ck,[Symbol.iterator]:kk};function Cs(e){return typeof e=="string"?new Qs([[document.querySelector(e)]],[document.documentElement]):new Qs([[e]],qy)}function Ak(e){let t;for(;t=e.sourceEvent;)e=t;return e}function hr(e,t){if(e=Ak(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Ok={passive:!1},dc={capture:!0,passive:!1};function Jh(e){e.stopImmediatePropagation()}function Xi(e){e.preventDefault(),e.stopImmediatePropagation()}function Vy(e){var t=e.document.documentElement,n=Cs(e).on("dragstart.drag",Xi,dc);"onselectstart"in t?n.on("selectstart.drag",Xi,dc):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Ky(e,t){var n=e.document.documentElement,s=Cs(e).on("dragstart.drag",null);t&&(s.on("click.drag",Xi,dc),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const nd=e=>()=>e;function ef(e,{sourceEvent:t,subject:n,target:s,identifier:r,active:i,x:l,y:u,dx:d,dy:f,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:p}})}ef.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Tk(e){return!e.ctrlKey&&!e.button}function $k(){return this.parentNode}function Lk(e,t){return t??{x:e.x,y:e.y}}function zk(){return navigator.maxTouchPoints||"ontouchstart"in this}function tf(){var e=Tk,t=$k,n=Lk,s=zk,r={},i=Zu("start","drag","end"),l=0,u,d,f,p,h=0;function m(j){j.on("mousedown.drag",_).filter(s).on("touchstart.drag",b).on("touchmove.drag",w,Ok).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(j,C){if(!(p||!e.call(this,j,C))){var M=N(this,t.call(this,j,C),j,C,"mouse");M&&(Cs(j.view).on("mousemove.drag",v,dc).on("mouseup.drag",y,dc),Vy(j.view),Jh(j),f=!1,u=j.clientX,d=j.clientY,M("start",j))}}function v(j){if(Xi(j),!f){var C=j.clientX-u,M=j.clientY-d;f=C*C+M*M>h}r.mouse("drag",j)}function y(j){Cs(j.view).on("mousemove.drag mouseup.drag",null),Ky(j.view,f),Xi(j),r.mouse("end",j)}function b(j,C){if(e.call(this,j,C)){var M=j.changedTouches,z=t.call(this,j,C),D=M.length,k,T;for(k=0;k<D;++k)(T=N(this,z,j,C,M[k].identifier,M[k]))&&(Jh(j),T("start",j,M[k]))}}function w(j){var C=j.changedTouches,M=C.length,z,D;for(z=0;z<M;++z)(D=r[C[z].identifier])&&(Xi(j),D("drag",j,C[z]))}function E(j){var C=j.changedTouches,M=C.length,z,D;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),z=0;z<M;++z)(D=r[C[z].identifier])&&(Jh(j),D("end",j,C[z]))}function N(j,C,M,z,D,k){var T=i.copy(),A=hr(k||M,C),O,R,L;if((L=n.call(j,new ef("beforestart",{sourceEvent:M,target:m,identifier:D,active:l,x:A[0],y:A[1],dx:0,dy:0,dispatch:T}),z))!=null)return O=L.x-A[0]||0,R=L.y-A[1]||0,function F(B,q,I){var U=A,V;switch(B){case"start":r[D]=F,V=l++;break;case"end":delete r[D],--l;case"drag":A=hr(I||q,C),V=l;break}T.call(B,j,new ef(B,{sourceEvent:q,subject:L,target:m,identifier:D,active:V,x:A[0]+O,y:A[1]+R,dx:A[0]-U[0],dy:A[1]-U[1],dispatch:T}),z)}}return m.filter=function(j){return arguments.length?(e=typeof j=="function"?j:nd(!!j),m):e},m.container=function(j){return arguments.length?(t=typeof j=="function"?j:nd(j),m):t},m.subject=function(j){return arguments.length?(n=typeof j=="function"?j:nd(j),m):n},m.touchable=function(j){return arguments.length?(s=typeof j=="function"?j:nd(!!j),m):s},m.on=function(){var j=i.on.apply(i,arguments);return j===i?m:j},m.clickDistance=function(j){return arguments.length?(h=(j=+j)*j,m):Math.sqrt(h)},m}function nf(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Yy(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function mc(){}var hc=.7,sd=1/hc,Qi="\\s*([+-]?\\d+)\\s*",fc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ur="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Rk=/^#([0-9a-f]{3,8})$/,Dk=new RegExp(`^rgb\\(${Qi},${Qi},${Qi}\\)$`),Pk=new RegExp(`^rgb\\(${Ur},${Ur},${Ur}\\)$`),Ik=new RegExp(`^rgba\\(${Qi},${Qi},${Qi},${fc}\\)$`),Fk=new RegExp(`^rgba\\(${Ur},${Ur},${Ur},${fc}\\)$`),Bk=new RegExp(`^hsl\\(${fc},${Ur},${Ur}\\)$`),Hk=new RegExp(`^hsla\\(${fc},${Ur},${Ur},${fc}\\)$`),Wy={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};nf(mc,Uo,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Gy,formatHex:Gy,formatHex8:Uk,formatHsl:qk,formatRgb:Xy,toString:Xy});function Gy(){return this.rgb().formatHex()}function Uk(){return this.rgb().formatHex8()}function qk(){return tv(this).formatHsl()}function Xy(){return this.rgb().formatRgb()}function Uo(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=Rk.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Qy(t):n===3?new Fs(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?rd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?rd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=Dk.exec(e))?new Fs(t[1],t[2],t[3],1):(t=Pk.exec(e))?new Fs(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Ik.exec(e))?rd(t[1],t[2],t[3],t[4]):(t=Fk.exec(e))?rd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Bk.exec(e))?ev(t[1],t[2]/100,t[3]/100,1):(t=Hk.exec(e))?ev(t[1],t[2]/100,t[3]/100,t[4]):Wy.hasOwnProperty(e)?Qy(Wy[e]):e==="transparent"?new Fs(NaN,NaN,NaN,0):null}function Qy(e){return new Fs(e>>16&255,e>>8&255,e&255,1)}function rd(e,t,n,s){return s<=0&&(e=t=n=NaN),new Fs(e,t,n,s)}function Vk(e){return e instanceof mc||(e=Uo(e)),e?(e=e.rgb(),new Fs(e.r,e.g,e.b,e.opacity)):new Fs}function sf(e,t,n,s){return arguments.length===1?Vk(e):new Fs(e,t,n,s??1)}function Fs(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}nf(Fs,sf,Yy(mc,{brighter(e){return e=e==null?sd:Math.pow(sd,e),new Fs(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?hc:Math.pow(hc,e),new Fs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Fs(qo(this.r),qo(this.g),qo(this.b),ad(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Zy,formatHex:Zy,formatHex8:Kk,formatRgb:Jy,toString:Jy}));function Zy(){return`#${Vo(this.r)}${Vo(this.g)}${Vo(this.b)}`}function Kk(){return`#${Vo(this.r)}${Vo(this.g)}${Vo(this.b)}${Vo((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jy(){const e=ad(this.opacity);return`${e===1?"rgb(":"rgba("}${qo(this.r)}, ${qo(this.g)}, ${qo(this.b)}${e===1?")":`, ${e})`}`}function ad(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function qo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Vo(e){return e=qo(e),(e<16?"0":"")+e.toString(16)}function ev(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Sr(e,t,n,s)}function tv(e){if(e instanceof Sr)return new Sr(e.h,e.s,e.l,e.opacity);if(e instanceof mc||(e=Uo(e)),!e)return new Sr;if(e instanceof Sr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,r=Math.min(t,n,s),i=Math.max(t,n,s),l=NaN,u=i-r,d=(i+r)/2;return u?(t===i?l=(n-s)/u+(n<s)*6:n===i?l=(s-t)/u+2:l=(t-n)/u+4,u/=d<.5?i+r:2-i-r,l*=60):u=d>0&&d<1?0:l,new Sr(l,u,d,e.opacity)}function Yk(e,t,n,s){return arguments.length===1?tv(e):new Sr(e,t,n,s??1)}function Sr(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}nf(Sr,Yk,Yy(mc,{brighter(e){return e=e==null?sd:Math.pow(sd,e),new Sr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?hc:Math.pow(hc,e),new Sr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,r=2*n-s;return new Fs(rf(e>=240?e-240:e+120,r,s),rf(e,r,s),rf(e<120?e+240:e-120,r,s),this.opacity)},clamp(){return new Sr(nv(this.h),od(this.s),od(this.l),ad(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ad(this.opacity);return`${e===1?"hsl(":"hsla("}${nv(this.h)}, ${od(this.s)*100}%, ${od(this.l)*100}%${e===1?")":`, ${e})`}`}}));function nv(e){return e=(e||0)%360,e<0?e+360:e}function od(e){return Math.max(0,Math.min(1,e||0))}function rf(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const af=e=>()=>e;function Wk(e,t){return function(n){return e+n*t}}function Gk(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function Xk(e){return(e=+e)==1?sv:function(t,n){return n-t?Gk(t,n,e):af(isNaN(t)?n:t)}}function sv(e,t){var n=t-e;return n?Wk(e,n):af(isNaN(e)?t:e)}const id=function e(t){var n=Xk(t);function s(r,i){var l=n((r=sf(r)).r,(i=sf(i)).r),u=n(r.g,i.g),d=n(r.b,i.b),f=sv(r.opacity,i.opacity);return function(p){return r.r=l(p),r.g=u(p),r.b=d(p),r.opacity=f(p),r+""}}return s.gamma=e,s}(1);function Qk(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,s=t.slice(),r;return function(i){for(r=0;r<n;++r)s[r]=e[r]*(1-i)+t[r]*i;return s}}function Zk(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function Jk(e,t){var n=t?t.length:0,s=e?Math.min(n,e.length):0,r=new Array(s),i=new Array(n),l;for(l=0;l<s;++l)r[l]=pc(e[l],t[l]);for(;l<n;++l)i[l]=t[l];return function(u){for(l=0;l<s;++l)i[l]=r[l](u);return i}}function eM(e,t){var n=new Date;return e=+e,t=+t,function(s){return n.setTime(e*(1-s)+t*s),n}}function qr(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function tM(e,t){var n={},s={},r;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(r in t)r in e?n[r]=pc(e[r],t[r]):s[r]=t[r];return function(i){for(r in n)s[r]=n[r](i);return s}}var of=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lf=new RegExp(of.source,"g");function nM(e){return function(){return e}}function sM(e){return function(t){return e(t)+""}}function rv(e,t){var n=of.lastIndex=lf.lastIndex=0,s,r,i,l=-1,u=[],d=[];for(e=e+"",t=t+"";(s=of.exec(e))&&(r=lf.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),u[l]?u[l]+=i:u[++l]=i),(s=s[0])===(r=r[0])?u[l]?u[l]+=r:u[++l]=r:(u[++l]=null,d.push({i:l,x:qr(s,r)})),n=lf.lastIndex;return n<t.length&&(i=t.slice(n),u[l]?u[l]+=i:u[++l]=i),u.length<2?d[0]?sM(d[0].x):nM(t):(t=d.length,function(f){for(var p=0,h;p<t;++p)u[(h=d[p]).i]=h.x(f);return u.join("")})}function pc(e,t){var n=typeof t,s;return t==null||n==="boolean"?af(t):(n==="number"?qr:n==="string"?(s=Uo(t))?(t=s,id):rv:t instanceof Uo?id:t instanceof Date?eM:Zk(t)?Qk:Array.isArray(t)?Jk:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?tM:qr)(e,t)}var av=180/Math.PI,cf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ov(e,t,n,s,r,i){var l,u,d;return(l=Math.sqrt(e*e+t*t))&&(e/=l,t/=l),(d=e*n+t*s)&&(n-=e*d,s-=t*d),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,d/=u),e*s<t*n&&(e=-e,t=-t,d=-d,l=-l),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*av,skewX:Math.atan(d)*av,scaleX:l,scaleY:u}}var ld;function rM(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?cf:ov(t.a,t.b,t.c,t.d,t.e,t.f)}function aM(e){return e==null||(ld||(ld=document.createElementNS("http://www.w3.org/2000/svg","g")),ld.setAttribute("transform",e),!(e=ld.transform.baseVal.consolidate()))?cf:(e=e.matrix,ov(e.a,e.b,e.c,e.d,e.e,e.f))}function iv(e,t,n,s){function r(f){return f.length?f.pop()+" ":""}function i(f,p,h,m,_,v){if(f!==h||p!==m){var y=_.push("translate(",null,t,null,n);v.push({i:y-4,x:qr(f,h)},{i:y-2,x:qr(p,m)})}else(h||m)&&_.push("translate("+h+t+m+n)}function l(f,p,h,m){f!==p?(f-p>180?p+=360:p-f>180&&(f+=360),m.push({i:h.push(r(h)+"rotate(",null,s)-2,x:qr(f,p)})):p&&h.push(r(h)+"rotate("+p+s)}function u(f,p,h,m){f!==p?m.push({i:h.push(r(h)+"skewX(",null,s)-2,x:qr(f,p)}):p&&h.push(r(h)+"skewX("+p+s)}function d(f,p,h,m,_,v){if(f!==h||p!==m){var y=_.push(r(_)+"scale(",null,",",null,")");v.push({i:y-4,x:qr(f,h)},{i:y-2,x:qr(p,m)})}else(h!==1||m!==1)&&_.push(r(_)+"scale("+h+","+m+")")}return function(f,p){var h=[],m=[];return f=e(f),p=e(p),i(f.translateX,f.translateY,p.translateX,p.translateY,h,m),l(f.rotate,p.rotate,h,m),u(f.skewX,p.skewX,h,m),d(f.scaleX,f.scaleY,p.scaleX,p.scaleY,h,m),f=p=null,function(_){for(var v=-1,y=m.length,b;++v<y;)h[(b=m[v]).i]=b.x(_);return h.join("")}}}var oM=iv(rM,"px, ","px)","deg)"),iM=iv(aM,", ",")",")"),lM=1e-12;function lv(e){return((e=Math.exp(e))+1/e)/2}function cM(e){return((e=Math.exp(e))-1/e)/2}function uM(e){return((e=Math.exp(2*e))-1)/(e+1)}const cd=function e(t,n,s){function r(i,l){var u=i[0],d=i[1],f=i[2],p=l[0],h=l[1],m=l[2],_=p-u,v=h-d,y=_*_+v*v,b,w;if(y<lM)w=Math.log(m/f)/t,b=function(z){return[u+z*_,d+z*v,f*Math.exp(t*z*w)]};else{var E=Math.sqrt(y),N=(m*m-f*f+s*y)/(2*f*n*E),j=(m*m-f*f-s*y)/(2*m*n*E),C=Math.log(Math.sqrt(N*N+1)-N),M=Math.log(Math.sqrt(j*j+1)-j);w=(M-C)/t,b=function(z){var D=z*w,k=lv(C),T=f/(n*E)*(k*uM(t*D+C)-cM(C));return[u+T*_,d+T*v,f*k/lv(t*D+C)]}}return b.duration=w*1e3*t/Math.SQRT2,b}return r.rho=function(i){var l=Math.max(.001,+i),u=l*l,d=u*u;return e(l,u,d)},r}(Math.SQRT2,2,4);var Zi=0,gc=0,_c=0,cv=1e3,ud,yc,dd=0,Ko=0,md=0,vc=typeof performance=="object"&&performance.now?performance:Date,uv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function uf(){return Ko||(uv(dM),Ko=vc.now()+md)}function dM(){Ko=0}function hd(){this._call=this._time=this._next=null}hd.prototype=dv.prototype={constructor:hd,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?uf():+n)+(t==null?0:+t),!this._next&&yc!==this&&(yc?yc._next=this:ud=this,yc=this),this._call=e,this._time=n,df()},stop:function(){this._call&&(this._call=null,this._time=1/0,df())}};function dv(e,t,n){var s=new hd;return s.restart(e,t,n),s}function mM(){uf(),++Zi;for(var e=ud,t;e;)(t=Ko-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Zi}function mv(){Ko=(dd=vc.now())+md,Zi=gc=0;try{mM()}finally{Zi=0,fM(),Ko=0}}function hM(){var e=vc.now(),t=e-dd;t>cv&&(md-=t,dd=e)}function fM(){for(var e,t=ud,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:ud=n);yc=e,df(s)}function df(e){if(!Zi){gc&&(gc=clearTimeout(gc));var t=e-Ko;t>24?(e<1/0&&(gc=setTimeout(mv,e-vc.now()-md)),_c&&(_c=clearInterval(_c))):(_c||(dd=vc.now(),_c=setInterval(hM,cv)),Zi=1,uv(mv))}}function hv(e,t,n){var s=new hd;return t=t==null?0:+t,s.restart(r=>{s.stop(),e(r+t)},t,n),s}var pM=Zu("start","end","cancel","interrupt"),gM=[],fv=0,pv=1,mf=2,fd=3,gv=4,hf=5,pd=6;function gd(e,t,n,s,r,i){var l=e.__transition;if(!l)e.__transition={};else if(n in l)return;_M(e,n,{name:t,index:s,group:r,on:pM,tween:gM,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:fv})}function ff(e,t){var n=Er(e,t);if(n.state>fv)throw new Error("too late; already scheduled");return n}function Vr(e,t){var n=Er(e,t);if(n.state>fd)throw new Error("too late; already running");return n}function Er(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function _M(e,t,n){var s=e.__transition,r;s[t]=n,n.timer=dv(i,0,n.time);function i(f){n.state=pv,n.timer.restart(l,n.delay,n.time),n.delay<=f&&l(f-n.delay)}function l(f){var p,h,m,_;if(n.state!==pv)return d();for(p in s)if(_=s[p],_.name===n.name){if(_.state===fd)return hv(l);_.state===gv?(_.state=pd,_.timer.stop(),_.on.call("interrupt",e,e.__data__,_.index,_.group),delete s[p]):+p<t&&(_.state=pd,_.timer.stop(),_.on.call("cancel",e,e.__data__,_.index,_.group),delete s[p])}if(hv(function(){n.state===fd&&(n.state=gv,n.timer.restart(u,n.delay,n.time),u(f))}),n.state=mf,n.on.call("start",e,e.__data__,n.index,n.group),n.state===mf){for(n.state=fd,r=new Array(m=n.tween.length),p=0,h=-1;p<m;++p)(_=n.tween[p].value.call(e,e.__data__,n.index,n.group))&&(r[++h]=_);r.length=h+1}}function u(f){for(var p=f<n.duration?n.ease.call(null,f/n.duration):(n.timer.restart(d),n.state=hf,1),h=-1,m=r.length;++h<m;)r[h].call(e,p);n.state===hf&&(n.on.call("end",e,e.__data__,n.index,n.group),d())}function d(){n.state=pd,n.timer.stop(),delete s[t];for(var f in s)return;delete e.__transition}}function _d(e,t){var n=e.__transition,s,r,i=!0,l;if(n){t=t==null?null:t+"";for(l in n){if((s=n[l]).name!==t){i=!1;continue}r=s.state>mf&&s.state<hf,s.state=pd,s.timer.stop(),s.on.call(r?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[l]}i&&delete e.__transition}}function yM(e){return this.each(function(){_d(this,e)})}function vM(e,t){var n,s;return function(){var r=Vr(this,e),i=r.tween;if(i!==n){s=n=i;for(var l=0,u=s.length;l<u;++l)if(s[l].name===t){s=s.slice(),s.splice(l,1);break}}r.tween=s}}function xM(e,t,n){var s,r;if(typeof n!="function")throw new Error;return function(){var i=Vr(this,e),l=i.tween;if(l!==s){r=(s=l).slice();for(var u={name:t,value:n},d=0,f=r.length;d<f;++d)if(r[d].name===t){r[d]=u;break}d===f&&r.push(u)}i.tween=r}}function bM(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=Er(this.node(),n).tween,r=0,i=s.length,l;r<i;++r)if((l=s[r]).name===e)return l.value;return null}return this.each((t==null?vM:xM)(n,e,t))}function pf(e,t,n){var s=e._id;return e.each(function(){var r=Vr(this,s);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return Er(r,s).value[t]}}function _v(e,t){var n;return(typeof t=="number"?qr:t instanceof Uo?id:(n=Uo(t))?(t=n,id):rv)(e,t)}function wM(e){return function(){this.removeAttribute(e)}}function NM(e){return function(){this.removeAttributeNS(e.space,e.local)}}function jM(e,t,n){var s,r=n+"",i;return function(){var l=this.getAttribute(e);return l===r?null:l===s?i:i=t(s=l,n)}}function SM(e,t,n){var s,r=n+"",i;return function(){var l=this.getAttributeNS(e.space,e.local);return l===r?null:l===s?i:i=t(s=l,n)}}function EM(e,t,n){var s,r,i;return function(){var l,u=n(this),d;return u==null?void this.removeAttribute(e):(l=this.getAttribute(e),d=u+"",l===d?null:l===s&&d===r?i:(r=d,i=t(s=l,u)))}}function CM(e,t,n){var s,r,i;return function(){var l,u=n(this),d;return u==null?void this.removeAttributeNS(e.space,e.local):(l=this.getAttributeNS(e.space,e.local),d=u+"",l===d?null:l===s&&d===r?i:(r=d,i=t(s=l,u)))}}function kM(e,t){var n=ed(e),s=n==="transform"?iM:_v;return this.attrTween(e,typeof t=="function"?(n.local?CM:EM)(n,s,pf(this,"attr."+e,t)):t==null?(n.local?NM:wM)(n):(n.local?SM:jM)(n,s,t))}function MM(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function AM(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function OM(e,t){var n,s;function r(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&AM(e,i)),n}return r._value=t,r}function TM(e,t){var n,s;function r(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&MM(e,i)),n}return r._value=t,r}function $M(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=ed(e);return this.tween(n,(s.local?OM:TM)(s,t))}function LM(e,t){return function(){ff(this,e).delay=+t.apply(this,arguments)}}function zM(e,t){return t=+t,function(){ff(this,e).delay=t}}function RM(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?LM:zM)(t,e)):Er(this.node(),t).delay}function DM(e,t){return function(){Vr(this,e).duration=+t.apply(this,arguments)}}function PM(e,t){return t=+t,function(){Vr(this,e).duration=t}}function IM(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?DM:PM)(t,e)):Er(this.node(),t).duration}function FM(e,t){if(typeof t!="function")throw new Error;return function(){Vr(this,e).ease=t}}function BM(e){var t=this._id;return arguments.length?this.each(FM(t,e)):Er(this.node(),t).ease}function HM(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Vr(this,e).ease=n}}function UM(e){if(typeof e!="function")throw new Error;return this.each(HM(this._id,e))}function qM(e){typeof e!="function"&&(e=zy(e));for(var t=this._groups,n=t.length,s=new Array(n),r=0;r<n;++r)for(var i=t[r],l=i.length,u=s[r]=[],d,f=0;f<l;++f)(d=i[f])&&e.call(d,d.__data__,f,i)&&u.push(d);return new ma(s,this._parents,this._name,this._id)}function VM(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,r=n.length,i=Math.min(s,r),l=new Array(s),u=0;u<i;++u)for(var d=t[u],f=n[u],p=d.length,h=l[u]=new Array(p),m,_=0;_<p;++_)(m=d[_]||f[_])&&(h[_]=m);for(;u<s;++u)l[u]=t[u];return new ma(l,this._parents,this._name,this._id)}function KM(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function YM(e,t,n){var s,r,i=KM(t)?ff:Vr;return function(){var l=i(this,e),u=l.on;u!==s&&(r=(s=u).copy()).on(t,n),l.on=r}}function WM(e,t){var n=this._id;return arguments.length<2?Er(this.node(),n).on.on(e):this.each(YM(n,e,t))}function GM(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function XM(){return this.on("end.remove",GM(this._id))}function QM(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Qh(e));for(var s=this._groups,r=s.length,i=new Array(r),l=0;l<r;++l)for(var u=s[l],d=u.length,f=i[l]=new Array(d),p,h,m=0;m<d;++m)(p=u[m])&&(h=e.call(p,p.__data__,m,u))&&("__data__"in p&&(h.__data__=p.__data__),f[m]=h,gd(f[m],t,n,m,f,Er(p,n)));return new ma(i,this._parents,t,n)}function ZM(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Ly(e));for(var s=this._groups,r=s.length,i=[],l=[],u=0;u<r;++u)for(var d=s[u],f=d.length,p,h=0;h<f;++h)if(p=d[h]){for(var m=e.call(p,p.__data__,h,d),_,v=Er(p,n),y=0,b=m.length;y<b;++y)(_=m[y])&&gd(_,t,n,y,m,v);i.push(m),l.push(p)}return new ma(i,l,t,n)}var JM=uc.prototype.constructor;function eA(){return new JM(this._groups,this._parents)}function tA(e,t){var n,s,r;return function(){var i=Gi(this,e),l=(this.style.removeProperty(e),Gi(this,e));return i===l?null:i===n&&l===s?r:r=t(n=i,s=l)}}function yv(e){return function(){this.style.removeProperty(e)}}function nA(e,t,n){var s,r=n+"",i;return function(){var l=Gi(this,e);return l===r?null:l===s?i:i=t(s=l,n)}}function sA(e,t,n){var s,r,i;return function(){var l=Gi(this,e),u=n(this),d=u+"";return u==null&&(d=u=(this.style.removeProperty(e),Gi(this,e))),l===d?null:l===s&&d===r?i:(r=d,i=t(s=l,u))}}function rA(e,t){var n,s,r,i="style."+t,l="end."+i,u;return function(){var d=Vr(this,e),f=d.on,p=d.value[i]==null?u||(u=yv(t)):void 0;(f!==n||r!==p)&&(s=(n=f).copy()).on(l,r=p),d.on=s}}function aA(e,t,n){var s=(e+="")=="transform"?oM:_v;return t==null?this.styleTween(e,tA(e,s)).on("end.style."+e,yv(e)):typeof t=="function"?this.styleTween(e,sA(e,s,pf(this,"style."+e,t))).each(rA(this._id,e)):this.styleTween(e,nA(e,s,t),n).on("end.style."+e,null)}function oA(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function iA(e,t,n){var s,r;function i(){var l=t.apply(this,arguments);return l!==r&&(s=(r=l)&&oA(e,l,n)),s}return i._value=t,i}function lA(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,iA(e,t,n??""))}function cA(e){return function(){this.textContent=e}}function uA(e){return function(){var t=e(this);this.textContent=t??""}}function dA(e){return this.tween("text",typeof e=="function"?uA(pf(this,"text",e)):cA(e==null?"":e+""))}function mA(e){return function(t){this.textContent=e.call(this,t)}}function hA(e){var t,n;function s(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&mA(r)),t}return s._value=e,s}function fA(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,hA(e))}function pA(){for(var e=this._name,t=this._id,n=vv(),s=this._groups,r=s.length,i=0;i<r;++i)for(var l=s[i],u=l.length,d,f=0;f<u;++f)if(d=l[f]){var p=Er(d,t);gd(d,e,n,f,l,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new ma(s,this._parents,e,n)}function gA(){var e,t,n=this,s=n._id,r=n.size();return new Promise(function(i,l){var u={value:l},d={value:function(){--r===0&&i()}};n.each(function(){var f=Vr(this,s),p=f.on;p!==e&&(t=(e=p).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(d)),f.on=t}),r===0&&i()})}var _A=0;function ma(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function vv(){return++_A}var ha=uc.prototype;ma.prototype={constructor:ma,select:QM,selectAll:ZM,selectChild:ha.selectChild,selectChildren:ha.selectChildren,filter:qM,merge:VM,selection:eA,transition:pA,call:ha.call,nodes:ha.nodes,node:ha.node,size:ha.size,empty:ha.empty,each:ha.each,on:WM,attr:kM,attrTween:$M,style:aA,styleTween:lA,text:dA,textTween:fA,remove:XM,tween:bM,delay:RM,duration:IM,ease:BM,easeVarying:UM,end:gA,[Symbol.iterator]:ha[Symbol.iterator]};function yA(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var vA={time:null,delay:0,duration:250,ease:yA};function xA(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function bA(e){var t,n;e instanceof ma?(t=e._id,e=e._name):(t=vv(),(n=vA).time=uf(),e=e==null?null:e+"");for(var s=this._groups,r=s.length,i=0;i<r;++i)for(var l=s[i],u=l.length,d,f=0;f<u;++f)(d=l[f])&&gd(d,e,t,f,l,n||xA(d,t));return new ma(s,this._parents,e,t)}uc.prototype.interrupt=yM,uc.prototype.transition=bA;const yd=e=>()=>e;function wA(e,{sourceEvent:t,target:n,transform:s,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:r}})}function fa(e,t,n){this.k=e,this.x=t,this.y=n}fa.prototype={constructor:fa,scale:function(e){return e===1?this:new fa(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new fa(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var pa=new fa(1,0,0);xv.prototype=fa.prototype;function xv(e){for(;!e.__zoom;)if(!(e=e.parentNode))return pa;return e.__zoom}function gf(e){e.stopImmediatePropagation()}function xc(e){e.preventDefault(),e.stopImmediatePropagation()}function NA(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function jA(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function bv(){return this.__zoom||pa}function SA(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function EA(){return navigator.maxTouchPoints||"ontouchstart"in this}function CA(e,t,n){var s=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],l=e.invertY(t[1][1])-n[1][1];return e.translate(r>s?(s+r)/2:Math.min(0,s)||Math.max(0,r),l>i?(i+l)/2:Math.min(0,i)||Math.max(0,l))}function _f(){var e=NA,t=jA,n=CA,s=SA,r=EA,i=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,d=cd,f=Zu("start","zoom","end"),p,h,m,_=500,v=150,y=0,b=10;function w(L){L.property("__zoom",bv).on("wheel.zoom",D,{passive:!1}).on("mousedown.zoom",k).on("dblclick.zoom",T).filter(r).on("touchstart.zoom",A).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}w.transform=function(L,F,B,q){var I=L.selection?L.selection():L;I.property("__zoom",bv),L!==I?C(L,F,B,q):I.interrupt().each(function(){M(this,arguments).event(q).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},w.scaleBy=function(L,F,B,q){w.scaleTo(L,function(){var I=this.__zoom.k,U=typeof F=="function"?F.apply(this,arguments):F;return I*U},B,q)},w.scaleTo=function(L,F,B,q){w.transform(L,function(){var I=t.apply(this,arguments),U=this.__zoom,V=B==null?j(I):typeof B=="function"?B.apply(this,arguments):B,H=U.invert(V),G=typeof F=="function"?F.apply(this,arguments):F;return n(N(E(U,G),V,H),I,l)},B,q)},w.translateBy=function(L,F,B,q){w.transform(L,function(){return n(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof B=="function"?B.apply(this,arguments):B),t.apply(this,arguments),l)},null,q)},w.translateTo=function(L,F,B,q,I){w.transform(L,function(){var U=t.apply(this,arguments),V=this.__zoom,H=q==null?j(U):typeof q=="function"?q.apply(this,arguments):q;return n(pa.translate(H[0],H[1]).scale(V.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof B=="function"?-B.apply(this,arguments):-B),U,l)},q,I)};function E(L,F){return F=Math.max(i[0],Math.min(i[1],F)),F===L.k?L:new fa(F,L.x,L.y)}function N(L,F,B){var q=F[0]-B[0]*L.k,I=F[1]-B[1]*L.k;return q===L.x&&I===L.y?L:new fa(L.k,q,I)}function j(L){return[(+L[0][0]+ +L[1][0])/2,(+L[0][1]+ +L[1][1])/2]}function C(L,F,B,q){L.on("start.zoom",function(){M(this,arguments).event(q).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(q).end()}).tween("zoom",function(){var I=this,U=arguments,V=M(I,U).event(q),H=t.apply(I,U),G=B==null?j(H):typeof B=="function"?B.apply(I,U):B,W=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),J=I.__zoom,ee=typeof F=="function"?F.apply(I,U):F,Z=d(J.invert(G).concat(W/J.k),ee.invert(G).concat(W/ee.k));return function(K){if(K===1)K=ee;else{var X=Z(K),Q=W/X[2];K=new fa(Q,G[0]-X[0]*Q,G[1]-X[1]*Q)}V.zoom(null,K)}})}function M(L,F,B){return!B&&L.__zooming||new z(L,F)}function z(L,F){this.that=L,this.args=F,this.active=0,this.sourceEvent=null,this.extent=t.apply(L,F),this.taps=0}z.prototype={event:function(L){return L&&(this.sourceEvent=L),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(L,F){return this.mouse&&L!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&L!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&L!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(L){var F=Cs(this.that).datum();f.call(L,this.that,new wA(L,{sourceEvent:this.sourceEvent,target:w,transform:this.that.__zoom,dispatch:f}),F)}};function D(L,...F){if(!e.apply(this,arguments))return;var B=M(this,F).event(L),q=this.__zoom,I=Math.max(i[0],Math.min(i[1],q.k*Math.pow(2,s.apply(this,arguments)))),U=hr(L);if(B.wheel)(B.mouse[0][0]!==U[0]||B.mouse[0][1]!==U[1])&&(B.mouse[1]=q.invert(B.mouse[0]=U)),clearTimeout(B.wheel);else{if(q.k===I)return;B.mouse=[U,q.invert(U)],_d(this),B.start()}xc(L),B.wheel=setTimeout(V,v),B.zoom("mouse",n(N(E(q,I),B.mouse[0],B.mouse[1]),B.extent,l));function V(){B.wheel=null,B.end()}}function k(L,...F){if(m||!e.apply(this,arguments))return;var B=L.currentTarget,q=M(this,F,!0).event(L),I=Cs(L.view).on("mousemove.zoom",G,!0).on("mouseup.zoom",W,!0),U=hr(L,B),V=L.clientX,H=L.clientY;Vy(L.view),gf(L),q.mouse=[U,this.__zoom.invert(U)],_d(this),q.start();function G(J){if(xc(J),!q.moved){var ee=J.clientX-V,Z=J.clientY-H;q.moved=ee*ee+Z*Z>y}q.event(J).zoom("mouse",n(N(q.that.__zoom,q.mouse[0]=hr(J,B),q.mouse[1]),q.extent,l))}function W(J){I.on("mousemove.zoom mouseup.zoom",null),Ky(J.view,q.moved),xc(J),q.event(J).end()}}function T(L,...F){if(e.apply(this,arguments)){var B=this.__zoom,q=hr(L.changedTouches?L.changedTouches[0]:L,this),I=B.invert(q),U=B.k*(L.shiftKey?.5:2),V=n(N(E(B,U),q,I),t.apply(this,F),l);xc(L),u>0?Cs(this).transition().duration(u).call(C,V,q,L):Cs(this).call(w.transform,V,q,L)}}function A(L,...F){if(e.apply(this,arguments)){var B=L.touches,q=B.length,I=M(this,F,L.changedTouches.length===q).event(L),U,V,H,G;for(gf(L),V=0;V<q;++V)H=B[V],G=hr(H,this),G=[G,this.__zoom.invert(G),H.identifier],I.touch0?!I.touch1&&I.touch0[2]!==G[2]&&(I.touch1=G,I.taps=0):(I.touch0=G,U=!0,I.taps=1+!!p);p&&(p=clearTimeout(p)),U&&(I.taps<2&&(h=G[0],p=setTimeout(function(){p=null},_)),_d(this),I.start())}}function O(L,...F){if(this.__zooming){var B=M(this,F).event(L),q=L.changedTouches,I=q.length,U,V,H,G;for(xc(L),U=0;U<I;++U)V=q[U],H=hr(V,this),B.touch0&&B.touch0[2]===V.identifier?B.touch0[0]=H:B.touch1&&B.touch1[2]===V.identifier&&(B.touch1[0]=H);if(V=B.that.__zoom,B.touch1){var W=B.touch0[0],J=B.touch0[1],ee=B.touch1[0],Z=B.touch1[1],K=(K=ee[0]-W[0])*K+(K=ee[1]-W[1])*K,X=(X=Z[0]-J[0])*X+(X=Z[1]-J[1])*X;V=E(V,Math.sqrt(K/X)),H=[(W[0]+ee[0])/2,(W[1]+ee[1])/2],G=[(J[0]+Z[0])/2,(J[1]+Z[1])/2]}else if(B.touch0)H=B.touch0[0],G=B.touch0[1];else return;B.zoom("touch",n(N(V,H,G),B.extent,l))}}function R(L,...F){if(this.__zooming){var B=M(this,F).event(L),q=L.changedTouches,I=q.length,U,V;for(gf(L),m&&clearTimeout(m),m=setTimeout(function(){m=null},_),U=0;U<I;++U)V=q[U],B.touch0&&B.touch0[2]===V.identifier?delete B.touch0:B.touch1&&B.touch1[2]===V.identifier&&delete B.touch1;if(B.touch1&&!B.touch0&&(B.touch0=B.touch1,delete B.touch1),B.touch0)B.touch0[1]=this.__zoom.invert(B.touch0[0]);else if(B.end(),B.taps===2&&(V=hr(V,this),Math.hypot(h[0]-V[0],h[1]-V[1])<b)){var H=Cs(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return w.wheelDelta=function(L){return arguments.length?(s=typeof L=="function"?L:yd(+L),w):s},w.filter=function(L){return arguments.length?(e=typeof L=="function"?L:yd(!!L),w):e},w.touchable=function(L){return arguments.length?(r=typeof L=="function"?L:yd(!!L),w):r},w.extent=function(L){return arguments.length?(t=typeof L=="function"?L:yd([[+L[0][0],+L[0][1]],[+L[1][0],+L[1][1]]]),w):t},w.scaleExtent=function(L){return arguments.length?(i[0]=+L[0],i[1]=+L[1],w):[i[0],i[1]]},w.translateExtent=function(L){return arguments.length?(l[0][0]=+L[0][0],l[1][0]=+L[1][0],l[0][1]=+L[0][1],l[1][1]=+L[1][1],w):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},w.constrain=function(L){return arguments.length?(n=L,w):n},w.duration=function(L){return arguments.length?(u=+L,w):u},w.interpolate=function(L){return arguments.length?(d=L,w):d},w.on=function(){var L=f.on.apply(f,arguments);return L===f?w:L},w.clickDistance=function(L){return arguments.length?(y=(L=+L)*L,w):Math.sqrt(y)},w.tapDistance=function(L){return arguments.length?(b=+L,w):b},w}function Ht(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yf(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function wv(e,t){if(e){if(typeof e=="string")return yf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yf(e,t)}}function kA(e){if(Array.isArray(e))return e}function MA(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s=[],r=!0,i=!1,l,u;try{for(n=n.call(e);!(r=(l=n.next()).done)&&(s.push(l.value),!(t&&s.length===t));r=!0);}catch(d){i=!0,u=d}finally{try{!r&&n.return!=null&&n.return()}finally{if(i)throw u}}return s}}function AA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $t(e,t){return kA(e)||MA(e,t)||wv(e,t)||AA()}var Yo;(function(e){e.Strict="strict",e.Loose="loose"})(Yo||(Yo={}));var Ji;(function(e){e.Lines="lines",e.Dots="dots"})(Ji||(Ji={}));var el;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(el||(el={}));var Ya;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ya||(Ya={}));var vd;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(vd||(vd={}));var He;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(He||(He={}));var vf=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},tl=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),s)},Nv=function(t,n){return{x:tl(t.x,n[0][0],n[1][0]),y:tl(t.y,n[0][1],n[1][1])}},jv=function(t){var n,s;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((s=window)===null||s===void 0?void 0:s.document)},OA=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},xd=function(t){var n=t.x,s=t.y,r=t.width,i=t.height;return{x:n,y:s,x2:n+r,y2:s+i}},TA=function(t){var n=t.x,s=t.y,r=t.x2,i=t.y2;return{x:n,y:s,width:r-n,height:i-s}},Sv=function(t){return!isNaN(t)&&isFinite(t)},ds=Symbol("internals");function Ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function bc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ev(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ev(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Cv(e,t){var n=e.find(function(f){return f.id===t.parentNode});if(n){var s=t.position.x+t.width-n.width,r=t.position.y+t.height-n.height;if(s>0||r>0||t.position.x<0||t.position.y<0){var i,l;if(n.style=bc({},n.style)||{},n.style.width=(i=n.style.width)!==null&&i!==void 0?i:n.width,n.style.height=(l=n.style.height)!==null&&l!==void 0?l:n.height,s>0&&(n.style.width+=s),r>0&&(n.style.height+=r),t.position.x<0){var u=Math.abs(t.position.x);n.position.x=n.position.x-u,n.style.width+=u,t.position.x=0}if(t.position.y<0){var d=Math.abs(t.position.y);n.position.y=n.position.y-d,n.style.height+=d,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function kv(e,t){if(e.some(function(s){return s.type==="reset"}))return e.filter(function(s){return s.type==="reset"}).map(function(s){return s.item});var n=e.filter(function(s){return s.type==="add"}).map(function(s){return s.item});return t.reduce(function(s,r){var i=e.find(function(d){return d.id===r.id});if(i)switch(i.type){case"select":return s.push(bc(bc({},r),{},{selected:i.selected})),s;case"position":{var l=bc({},r);return typeof i.position<"u"&&(l.position=i.position),typeof i.positionAbsolute<"u"&&(l.positionAbsolute=i.positionAbsolute),typeof i.dragging<"u"&&(l.dragging=i.dragging),l.expandParent&&Cv(s,l),s.push(l),s}case"dimensions":{var u=bc({},r);return typeof i.dimensions<"u"&&(u.width=i.dimensions.width,u.height=i.dimensions.height),u.expandParent&&Cv(s,u),s.push(u),s}case"remove":return s}return s.push(r),s},n)}function Mv(e,t){return kv(e,t)}function $A(e,t){return kv(e,t)}var Wa=function(t,n){return{id:t,type:"select",selected:n}};function nl(e,t){return e.reduce(function(n,s){var r=t.includes(s.id);return!s.selected&&r?(s.selected=!0,n.push(Wa(s.id,!0))):s.selected&&!r&&(s.selected=!1,n.push(Wa(s.id,!1))),n},[])}function Av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Ov(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Av(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Av(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Tv=function(t,n,s){var r=n.querySelectorAll(t);if(!r||!r.length)return null;var i=Array.from(r),l=n.getBoundingClientRect();return i.map(function(u){var d=u.getBoundingClientRect();return Ov({id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(d.left-l.left)/s,y:(d.top-l.top)/s},vf(u))})};function wc(e,t,n){return n===void 0?n:function(s){var r=t().nodeInternals.get(e);n(s,Ov({},r))}}function $v(e){var t=e.id,n=e.store,s=n.getState(),r=s.addSelectedNodes,i=s.unselectNodesAndEdges,l=s.multiSelectionActive,u=s.nodeInternals,d=u.get(t);n.setState({nodesSelectionActive:!1}),d.selected?d.selected&&l&&i({nodes:[d]}):r([t])}function Lv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Nc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lv(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var LA=function(t){return"id"in t&&"source"in t&&"target"in t},zA=function(t){var n=t.source,s=t.sourceHandle,r=t.target,i=t.targetHandle;return"reactflow__edge-".concat(n).concat(s||"","-").concat(r).concat(i||"")},xf=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var s=n?"".concat(n,"__"):"";return"".concat(s).concat(Object.keys(t).sort().map(function(r){return"".concat(r,"=").concat(t[r])}).join("&"))},RA=function(t,n){return n.some(function(s){return s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)})},zv=function(t,n){if(!t.source||!t.target)return n;var s;return LA(t)?s=Nc({},t):s=Nc(Nc({},t),{},{id:zA(t)}),RA(s,n)?n:n.concat(s)},Rv=function(t,n,s,r){var i=t.x,l=t.y,u=$t(n,3),d=u[0],f=u[1],p=u[2],h=$t(r,2),m=h[0],_=h[1],v={x:(i-d)/p,y:(l-f)/p};return s?{x:m*Math.round(v.x/m),y:_*Math.round(v.y/_)}:v},bf=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(s,r){var i=r.positionAbsolute,l=r.position,u=r.width,d=r.height;return OA(s,xd({x:i?i.x:l.x,y:i?i.y:l.y,width:u||0,height:d||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return TA(n)},Dv=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],r=$t(s,3),i=r[0],l=r[1],u=r[2],d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,p=xd({x:(n.x-i)/u,y:(n.y-l)/u,width:n.width/u,height:n.height/u}),h=[];return t.forEach(function(m){var _=m.positionAbsolute,v=m.width,y=m.height,b=m.selectable,w=b===void 0?!0:b;if(f&&!w)return!1;var E=xd(Nc(Nc({},_),{},{width:v||0,height:y||0})),N=Math.max(0,Math.min(p.x2,E.x2)-Math.max(p.x,E.x)),j=Math.max(0,Math.min(p.y2,E.y2)-Math.max(p.y,E.y)),C=Math.ceil(N*j),M=typeof v>"u"||typeof y>"u"||v===null||y===null,z=d&&C>0,D=(v||0)*(y||0),k=M||z||C>=D;k&&h.push(m)}),h},Pv=function(t,n){var s=t.map(function(r){return r.id});return n.filter(function(r){return s.includes(r.source)||s.includes(r.target)})},Iv=function(t,n,s,r,i){var l=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,u=n/(t.width*(1+l)),d=s/(t.height*(1+l)),f=Math.min(u,d),p=tl(f,r,i),h=t.x+t.width/2,m=t.y+t.height/2,_=n/2-h*p,v=s/2-m*p;return[_,v,p]},Wo=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function Fv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function sl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fv(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Bv(e,t,n,s){var r,i,l,u,d,f,p,h,m,_,v,y;if(!e.parentNode)return s;var b=t.get(e.parentNode);return Bv(b,t,n,{x:((r=s.x)!==null&&r!==void 0?r:0)+((i=(l=b.position)===null||l===void 0?void 0:l.x)!==null&&i!==void 0?i:0),y:((u=s.y)!==null&&u!==void 0?u:0)+((d=(f=b.position)===null||f===void 0?void 0:f.y)!==null&&d!==void 0?d:0),z:((p=(h=b[ds])===null||h===void 0?void 0:h.z)!==null&&p!==void 0?p:0)>((m=s.z)!==null&&m!==void 0?m:0)?(_=(v=b[ds])===null||v===void 0?void 0:v.z)!==null&&_!==void 0?_:0:(y=s.z)!==null&&y!==void 0?y:0})}function wf(e,t){var n=new Map,s={};return e.forEach(function(r){var i,l=Sv(r.zIndex)?r.zIndex:r.selected?1e3:0,u=t.get(r.id),d=sl(sl({width:u==null?void 0:u.width,height:u==null?void 0:u.height},r),{},{positionAbsolute:{x:r.position.x,y:r.position.y}});r.parentNode&&(d.parentNode=r.parentNode,s[r.parentNode]=!0),Object.defineProperty(d,ds,{enumerable:!1,value:{handleBounds:u==null||(i=u[ds])===null||i===void 0?void 0:i.handleBounds,z:l}}),n.set(r.id,d)}),n.forEach(function(r){if(r.parentNode&&!n.has(r.parentNode))throw new Error("Parent node ".concat(r.parentNode," not found"));if(r.parentNode||s[r.id]){var i,l,u=Bv(r,n,s,sl(sl({},r.position),{},{z:(i=(l=r[ds])===null||l===void 0?void 0:l.z)!==null&&i!==void 0?i:0})),d=u.x,f=u.y,p=u.z;r.positionAbsolute={x:d,y:f},r[ds].z=p,s[r.id]&&(r[ds].isParent=!0)}}),n}function Hv(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),s=n.nodeInternals,r=n.width,i=n.height,l=n.minZoom,u=n.maxZoom,d=n.d3Zoom,f=n.d3Selection,p=n.fitViewOnInitDone,h=n.fitViewOnInit;if((t.initial&&!p&&h||!t.initial)&&d&&f){var m=Array.from(s.values()).filter(function(D){return t.includeHiddenNodes?D.width&&D.height:!D.hidden}),_=m.every(function(D){return D.width&&D.height});if(m.length>0&&_){var v,y,b,w=bf(m),E=Iv(w,r,i,(v=t.minZoom)!==null&&v!==void 0?v:l,(y=t.maxZoom)!==null&&y!==void 0?y:u,(b=t.padding)!==null&&b!==void 0?b:.1),N=$t(E,3),j=N[0],C=N[1],M=N[2],z=pa.translate(j,C).scale(M);return typeof t.duration=="number"&&t.duration>0?d.transform(Wo(f,t.duration),z):d.transform(f,z),!0}}return!1}function DA(e,t){return e.forEach(function(n){var s=t.get(n.id);if(s){var r;t.set(s.id,sl(sl({},s),{},(r={},Ht(r,ds,s[ds]),Ht(r,"selected",n.selected),r)))}}),new Map(t)}function PA(e,t){return t.map(function(n){var s=e.find(function(r){return r.id===n.id});return s&&(n.selected=s.selected),n})}function bd(e){var t=e.changedNodes,n=e.changedEdges,s=e.get,r=e.set,i=s(),l=i.nodeInternals,u=i.edges,d=i.onNodesChange,f=i.onEdgesChange,p=i.hasDefaultNodes,h=i.hasDefaultEdges;t!=null&&t.length&&(p&&r({nodeInternals:DA(t,l)}),d==null||d(t)),n!=null&&n.length&&(h&&r({edges:PA(n,u)}),f==null||f(n))}var Nf=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Uv={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Nf,nodeExtent:Nf,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:Yo.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function qv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Kr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qv(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var jf=WE(),Vv=jf.Provider,In=jf.useStore,_s=jf.useStoreApi,Kv=function(){return YE(function(t,n){return Kr(Kr({},Uv),{},{setNodes:function(r){t({nodeInternals:wf(r,n().nodeInternals)})},setEdges:function(r){var i=n(),l=i.defaultEdgeOptions,u=l===void 0?{}:l;t({edges:r.map(function(d){return Kr(Kr({},u),d)})})},setDefaultNodesAndEdges:function(r,i){var l=typeof r<"u",u=typeof i<"u",d=l?wf(r,new Map):new Map,f=u?i:[];t({nodeInternals:d,edges:f,hasDefaultNodes:l,hasDefaultEdges:u})},updateNodeDimensions:function(r){var i=n(),l=i.onNodesChange,u=i.nodeInternals,d=i.fitViewOnInit,f=i.fitViewOnInitDone,p=i.fitViewOnInitOptions,h=i.domNode,m=h==null?void 0:h.querySelector(".react-flow__viewport");if(m){var _=window.getComputedStyle(m),v=new window.DOMMatrixReadOnly(_.transform),y=v.m22,b=r.reduce(function(E,N){var j=u.get(N.id);if(j){var C=vf(N.nodeElement),M=!!(C.width&&C.height&&(j.width!==C.width||j.height!==C.height||N.forceUpdate));M&&(u.set(j.id,Kr(Kr({},j),{},Ht({},ds,Kr(Kr({},j[ds]),{},{handleBounds:{source:Tv(".source",N.nodeElement,y),target:Tv(".target",N.nodeElement,y)}})),C)),E.push({id:j.id,type:"dimensions",dimensions:C}))}return E},[]),w=f||d&&!f&&Hv(n,Kr({initial:!0},p));t({nodeInternals:new Map(u),fitViewOnInitDone:w}),(b==null?void 0:b.length)>0&&(l==null||l(b))}},updateNodePositions:function(r){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=n(),d=u.onNodesChange,f=u.nodeInternals,p=u.hasDefaultNodes;if(p||d){var h=r.map(function(v){var y={id:v.id,type:"position",dragging:l};return i&&(y.positionAbsolute=v.positionAbsolute,y.position=v.position),y});if(h!=null&&h.length){if(p){var m=Mv(h,Array.from(f.values())),_=wf(m,f);t({nodeInternals:_})}d==null||d(h)}}},addSelectedNodes:function(r){var i=n(),l=i.multiSelectionActive,u=i.nodeInternals,d=i.edges,f,p=null;l?f=r.map(function(h){return Wa(h,!0)}):(f=nl(Array.from(u.values()),r),p=nl(d,[])),bd({changedNodes:f,changedEdges:p,get:n,set:t})},addSelectedEdges:function(r){var i=n(),l=i.multiSelectionActive,u=i.edges,d=i.nodeInternals,f,p=null;l?f=r.map(function(h){return Wa(h,!0)}):(f=nl(u,r),p=nl(Array.from(d.values()),[])),bd({changedNodes:p,changedEdges:f,get:n,set:t})},unselectNodesAndEdges:function(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=r.nodes,l=r.edges,u=n(),d=u.nodeInternals,f=u.edges,p=i||Array.from(d.values()),h=l||f,m=p.map(function(v){return v.selected=!1,Wa(v.id,!1)}),_=h.map(function(v){return Wa(v.id,!1)});bd({changedNodes:m,changedEdges:_,get:n,set:t})},setMinZoom:function(r){var i=n(),l=i.d3Zoom,u=i.maxZoom;l==null||l.scaleExtent([r,u]),t({minZoom:r})},setMaxZoom:function(r){var i=n(),l=i.d3Zoom,u=i.minZoom;l==null||l.scaleExtent([u,r]),t({maxZoom:r})},setTranslateExtent:function(r){var i=n(),l=i.d3Zoom;l==null||l.translateExtent(r),t({translateExtent:r})},resetSelectedElements:function(){var r=n(),i=r.nodeInternals,l=r.edges,u=Array.from(i.values()),d=u.filter(function(p){return p.selected}).map(function(p){return Wa(p.id,!1)}),f=l.filter(function(p){return p.selected}).map(function(p){return Wa(p.id,!1)});bd({changedNodes:d,changedEdges:f,get:n,set:t})},setNodeExtent:function(r){var i=n(),l=i.nodeInternals;l.forEach(function(u){u.positionAbsolute=Nv(u.position,r)}),t({nodeExtent:r,nodeInternals:new Map(l)})},reset:function(){return t(Kr({},Uv))}})})};function Vt(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=Vt(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function Zs(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let s=0;s<n.length;s++)if(!Object.prototype.hasOwnProperty.call(t,n[s])||!Object.is(e[n[s]],t[n[s]]))return!1;return!0}function IA(e){if(Array.isArray(e))return yf(e)}function FA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function BA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Go(e){return IA(e)||FA(e)||wv(e)||BA()}var HA={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},UA=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},qA=function(){var t=_s(),n=In(UA,Zs),s=n.d3Zoom,r=n.d3Selection,i=x.useMemo(function(){return r&&s?{zoomIn:function(u){return s.scaleBy(Wo(r,u==null?void 0:u.duration),1.2)},zoomOut:function(u){return s.scaleBy(Wo(r,u==null?void 0:u.duration),1/1.2)},zoomTo:function(u,d){return s.scaleTo(Wo(r,d==null?void 0:d.duration),u)},getZoom:function(){return t.getState().transform[2]},setViewport:function(u,d){var f,p,h,m=$t(t.getState().transform,3),_=m[0],v=m[1],y=m[2],b=pa.translate((f=u.x)!==null&&f!==void 0?f:_,(p=u.y)!==null&&p!==void 0?p:v).scale((h=u.zoom)!==null&&h!==void 0?h:y);s.transform(Wo(r,d==null?void 0:d.duration),b)},getViewport:function(){var u=$t(t.getState().transform,3),d=u[0],f=u[1],p=u[2];return{x:d,y:f,zoom:p}},fitView:function(u){return Hv(t.getState,u)},setCenter:function(u,d,f){var p=t.getState(),h=p.width,m=p.height,_=p.maxZoom,v=typeof(f==null?void 0:f.zoom)<"u"?f.zoom:_,y=h/2-u*v,b=m/2-d*v,w=pa.translate(y,b).scale(v);s.transform(Wo(r,f==null?void 0:f.duration),w)},fitBounds:function(u,d){var f,p=t.getState(),h=p.width,m=p.height,_=p.minZoom,v=p.maxZoom,y=Iv(u,h,m,_,v,(f=d==null?void 0:d.padding)!==null&&f!==void 0?f:.1),b=$t(y,3),w=b[0],E=b[1],N=b[2],j=pa.translate(w,E).scale(N);s.transform(Wo(r,d==null?void 0:d.duration),j)},project:function(u){var d=t.getState(),f=d.transform,p=d.snapToGrid,h=d.snapGrid;return Rv(u,f,p,h)},viewportInitialized:!0}:HA},[s,r]);return i};function Yv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function rl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yv(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Sf(){var e=qA(),t=_s(),n=x.useCallback(function(){var h=t.getState(),m=h.nodeInternals,_=Array.from(m.values());return _.map(function(v){return rl({},v)})},[]),s=x.useCallback(function(h){var m=t.getState(),_=m.nodeInternals;return _.get(h)},[]),r=x.useCallback(function(){var h=t.getState(),m=h.edges,_=m===void 0?[]:m;return _.map(function(v){return rl({},v)})},[]),i=x.useCallback(function(h){var m=t.getState(),_=m.edges,v=_===void 0?[]:_;return v.find(function(y){return y.id===h})},[]),l=x.useCallback(function(h){var m=t.getState(),_=m.nodeInternals,v=m.setNodes,y=m.hasDefaultNodes,b=m.onNodesChange,w=Array.from(_.values()),E=typeof h=="function"?h(w):h;if(y)v(E);else if(b){var N=E.length===0?w.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});b(N)}},[]),u=x.useCallback(function(h){var m=t.getState(),_=m.edges,v=_===void 0?[]:_,y=m.setEdges,b=m.hasDefaultEdges,w=m.onEdgesChange,E=typeof h=="function"?h(v):h;if(b)y(E);else if(w){var N=E.length===0?v.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});w(N)}},[]),d=x.useCallback(function(h){var m=Array.isArray(h)?h:[h],_=t.getState(),v=_.nodeInternals,y=_.setNodes,b=_.hasDefaultNodes,w=_.onNodesChange;if(b){var E=Array.from(v.values()),N=[].concat(E,Go(m));y(N)}else if(w){var j=m.map(function(C){return{item:C,type:"add"}});w(j)}},[]),f=x.useCallback(function(h){var m=Array.isArray(h)?h:[h],_=t.getState(),v=_.edges,y=v===void 0?[]:v,b=_.setEdges,w=_.hasDefaultEdges,E=_.onEdgesChange;if(w)b([].concat(Go(y),Go(m)));else if(E){var N=m.map(function(j){return{item:j,type:"add"}});E(N)}},[]),p=x.useCallback(function(){var h=t.getState(),m=h.nodeInternals,_=h.edges,v=_===void 0?[]:_,y=h.transform,b=Array.from(m.values()),w=$t(y,3),E=w[0],N=w[1],j=w[2];return{nodes:b.map(function(C){return rl({},C)}),edges:v.map(function(C){return rl({},C)}),viewport:{x:E,y:N,zoom:j}}},[]);return x.useMemo(function(){return rl(rl({},e),{},{getNodes:n,getNode:s,getEdges:r,getEdge:i,setNodes:l,setEdges:u,addNodes:d,addEdges:f,toObject:p})},[e,n,s,r,i,l,u,d,f,p])}function VA(e,t){if(e==null)return{};var n={},s=Object.keys(e),r,i;for(i=0;i<s.length;i++)r=s[i],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function wd(e,t){if(e==null)return{};var n=VA(e,t),s,r;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)s=i[r],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function KA(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},ve.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function YA(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},ve.createElement("path",{d:"M0 0h32v4.2H0z"}))}function WA(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},ve.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function GA(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ve.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function XA(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ve.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var QA=["children","className"];function Wv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function ZA(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Wv(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Nd=function(t){var n=t.children,s=t.className,r=wd(t,QA);return ve.createElement("button",ZA({type:"button",className:Vt(["react-flow__controls-button",s])},r),n)},JA=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},Gv=function(t){var n=t.style,s=t.showZoom,r=s===void 0?!0:s,i=t.showFitView,l=i===void 0?!0:i,u=t.showInteractive,d=u===void 0?!0:u,f=t.fitViewOptions,p=t.onZoomIn,h=t.onZoomOut,m=t.onFitView,_=t.onInteractiveChange,v=t.className,y=t.children,b=_s(),w=x.useState(!1),E=$t(w,2),N=E[0],j=E[1],C=In(JA),M=Sf(),z=M.zoomIn,D=M.zoomOut,k=M.fitView;if(x.useEffect(function(){j(!0)},[]),!N)return null;var T=function(){z==null||z(),p==null||p()},A=function(){D==null||D(),h==null||h()},O=function(){k==null||k(f),m==null||m()},R=function(){b.setState({nodesDraggable:!C,nodesConnectable:!C,elementsSelectable:!C}),_==null||_(!C)};return ve.createElement("div",{className:Vt(["react-flow__controls",v]),style:n},r&&ve.createElement(ve.Fragment,null,ve.createElement(Nd,{onClick:T,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},ve.createElement(KA,null)),ve.createElement(Nd,{onClick:A,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},ve.createElement(YA,null))),l&&ve.createElement(Nd,{className:"react-flow__controls-fitview",onClick:O,title:"fit view","aria-label":"fit view"},ve.createElement(WA,null)),d&&ve.createElement(Nd,{className:"react-flow__controls-interactive",onClick:R,title:"toggle interactivity","aria-label":"toggle interactivity"},C?ve.createElement(XA,null):ve.createElement(GA,null)),y)};Gv.displayName="Controls";var eO=x.memo(Gv),tO=function(t,n,s){return ve.createElement("path",{stroke:s,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},nO=function(t,n){return ve.createElement("circle",{cx:t,cy:t,r:t,fill:n})},jd;function Xv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Qv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Xv(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var sO=(jd={},Ht(jd,Ji.Dots,"#81818a"),Ht(jd,Ji.Lines,"#eee"),jd),rO=function(t){return t.transform},Zv=function(t){var n=t.variant,s=n===void 0?Ji.Dots:n,r=t.gap,i=r===void 0?15:r,l=t.size,u=l===void 0?.4:l,d=t.color,f=t.style,p=t.className,h=x.useRef(null),m=x.useState(null),_=$t(m,2),v=_[0],y=_[1],b=In(rO),w=$t(b,3),E=w[0],N=w[1],j=w[2];x.useEffect(function(){var A=document.querySelectorAll(".react-flow__background"),O=Array.from(A).findIndex(function(R){return R===h.current});y("pattern-".concat(O))},[]);var C=i*j||1,M=E%C,z=N%C,D=s===Ji.Lines,k=d||sO[s],T=D?tO(C,u,k):nO(u*j,k);return ve.createElement("svg",{className:Vt(["react-flow__background","react-flow__container",p]),style:Qv(Qv({},f),{},{width:"100%",height:"100%"}),ref:h},v&&ve.createElement(ve.Fragment,null,ve.createElement("pattern",{id:v,x:M,y:z,width:C,height:C,patternUnits:"userSpaceOnUse"},T),ve.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(v,")")})))};Zv.displayName="Background";var aO=x.memo(Zv),oO=function(t){return t.updateNodeDimensions};function iO(){var e=_s(),t=In(oO);return x.useCallback(function(n){var s,r=(s=e.getState().domNode)===null||s===void 0?void 0:s.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));r&&requestAnimationFrame(function(){return t([{id:n,nodeElement:r,forceUpdate:!0}])})},[])}var lO=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function cO(e){var t=e.proOptions,n=e.position,s=n===void 0?"bottom-right":n;if(t!=null&&t.account&&lO.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var r="".concat(s).split("-");return ve.createElement("div",{className:Vt(["react-flow__attribution"].concat(Go(r))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},ve.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var uO=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function Jv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function dO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jv(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var mO=function(t){var n=t.x,s=t.y,r=t.label,i=t.labelStyle,l=i===void 0?{}:i,u=t.labelShowBg,d=u===void 0?!0:u,f=t.labelBgStyle,p=f===void 0?{}:f,h=t.labelBgPadding,m=h===void 0?[2,4]:h,_=t.labelBgBorderRadius,v=_===void 0?2:_,y=t.children,b=t.className,w=wd(t,uO),E=x.useRef(null),N=x.useState({x:0,y:0,width:0,height:0}),j=$t(N,2),C=j[0],M=j[1],z=Vt(["react-flow__edge-textwrapper",b]);return x.useEffect(function(){if(E.current){var D=E.current.getBBox();M({x:D.x,y:D.y,width:D.width,height:D.height})}},[r]),typeof r>"u"||!r?null:ve.createElement("g",dO({transform:"translate(".concat(n-C.width/2," ").concat(s-C.height/2,")"),className:z},w),d&&ve.createElement("rect",{width:C.width+2*m[0],x:-m[0],y:-m[1],height:C.height+2*m[1],className:"react-flow__edge-textbg",style:p,rx:v,ry:v}),ve.createElement("text",{className:"react-flow__edge-text",y:C.height/2,dy:"0.3em",ref:E,style:l},r),y)},hO=x.memo(mO),Sd=function(e){var t=e.path,n=e.centerX,s=e.centerY,r=e.label,i=e.labelStyle,l=e.labelShowBg,u=e.labelBgStyle,d=e.labelBgPadding,f=e.labelBgBorderRadius,p=e.style,h=e.markerEnd,m=e.markerStart,_=r?ve.createElement(hO,{x:n,y:s,label:r,labelStyle:i,labelShowBg:l,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f}):null;return ve.createElement(ve.Fragment,null,ve.createElement("path",{style:p,d:t,className:"react-flow__edge-path",markerEnd:h,markerStart:m}),_)};function Ed(e){var t=e.pos,n=e.x1,s=e.y1,r=e.x2,i=e.y2,l,u;switch(t){case He.Left:case He.Right:l=.5*(n+r),u=s;break;case He.Top:case He.Bottom:l=n,u=.5*(s+i);break}return[l,u]}function ex(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,r=s===void 0?He.Bottom:s,i=e.targetX,l=e.targetY,u=e.targetPosition,d=u===void 0?He.Top:u,f=Ed({pos:r,x1:t,y1:n,x2:i,y2:l}),p=$t(f,2),h=p[0],m=p[1],_=Ed({pos:d,x1:i,y1:l,x2:t,y2:n}),v=$t(_,2),y=v[0],b=v[1];return"M".concat(t,",").concat(n," C").concat(h,",").concat(m," ").concat(y,",").concat(b," ").concat(i,",").concat(l)}function fO(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,r=s===void 0?He.Bottom:s,i=e.targetX,l=e.targetY,u=e.targetPosition,d=u===void 0?He.Top:u,f=Ed({pos:r,x1:t,y1:n,x2:i,y2:l}),p=$t(f,2),h=p[0],m=p[1],_=Ed({pos:d,x1:i,y1:l,x2:t,y2:n}),v=$t(_,2),y=v[0],b=v[1],w=t*.125+h*.375+y*.375+i*.125,E=n*.125+m*.375+b*.375+l*.125,N=Math.abs(w-t),j=Math.abs(E-n);return[w,E,N,j]}var tx=x.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,r=e.targetY,i=e.sourcePosition,l=i===void 0?He.Bottom:i,u=e.targetPosition,d=u===void 0?He.Top:u,f=e.label,p=e.labelStyle,h=e.labelShowBg,m=e.labelBgStyle,_=e.labelBgPadding,v=e.labelBgBorderRadius,y=e.style,b=e.markerEnd,w=e.markerStart,E={sourceX:t,sourceY:n,sourcePosition:l,targetX:s,targetY:r,targetPosition:d},N=ex(E),j=fO(E),C=$t(j,2),M=C[0],z=C[1];return ve.createElement(Sd,{path:N,centerX:M,centerY:z,label:f,labelStyle:p,labelShowBg:h,labelBgStyle:m,labelBgPadding:_,labelBgBorderRadius:v,style:y,markerEnd:b,markerStart:w})});function nx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function pO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var sx=[He.Left,He.Right],rx=function(t){var n=t.sourceX,s=t.sourceY,r=t.targetX,i=t.targetY,l=t.sourcePosition,u=l===void 0?He.Bottom:l,d=t.targetPosition,f=d===void 0?He.Top:d,p=sx.includes(u),h=sx.includes(f),m=p&&!h||h&&!p;if(m){var _=p?Math.abs(r-n):0,v=n>r?n-_:n+_,y=p?0:Math.abs(i-s),b=s<i?s+y:s-y;return[v,b,_,y]}var w=Math.abs(r-n)/2,E=r<n?r+w:r-w,N=Math.abs(i-s)/2,j=i<s?i+N:i-N;return[E,j,w,N]};function jc(e,t,n){return n===void 0?n:function(s){var r=t().edges.find(function(i){return i.id===e});n(s,pO({},r))}}var Ef=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},Cf=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},kf=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},Mf=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},Af=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)},Of=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},Tf=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},$f=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)};function Lf(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,r=s===void 0?He.Bottom:s,i=e.targetX,l=e.targetY,u=e.targetPosition,d=u===void 0?He.Top:u,f=e.borderRadius,p=f===void 0?5:f,h=e.centerX,m=e.centerY,_=rx({sourceX:t,sourceY:n,targetX:i,targetY:l}),v=$t(_,4),y=v[0],b=v[1],w=v[2],E=v[3],N=Math.min(p,Math.abs(i-t)),j=Math.min(p,Math.abs(l-n)),C=Math.min(N,j,w,E),M=[He.Left,He.Right],z=typeof h<"u"?h:y,D=typeof m<"u"?m:b,k=null,T=null;return t<=i?(k=n<=l?Ef(t,D,C):Of(t,D,C),T=n<=l?$f(i,D,C):Mf(i,D,C)):(k=n<l?kf(t,D,C):Tf(t,D,C),T=n<l?Af(i,D,C):Cf(i,D,C)),M.includes(r)&&M.includes(d)?t<=i?(k=n<=l?$f(z,n,C):Mf(z,n,C),T=n<=l?Ef(z,l,C):Of(z,l,C)):(r===He.Right&&d===He.Left||r===He.Left&&d===He.Right||r===He.Left&&d===He.Left)&&(k=n<=l?Af(z,n,C):Cf(z,n,C),T=n<=l?kf(z,l,C):Tf(z,l,C)):M.includes(r)&&!M.includes(d)?(t<=i?k=n<=l?$f(i,n,C):Mf(i,n,C):k=n<=l?Af(i,n,C):Cf(i,n,C),T=""):!M.includes(r)&&M.includes(d)&&(t<=i?k=n<=l?Ef(t,l,C):Of(t,l,C):k=n<=l?kf(t,l,C):Tf(t,l,C),T=""),"M ".concat(t,",").concat(n).concat(k).concat(T,"L ").concat(i,",").concat(l)}var zf=x.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,r=e.targetY,i=e.label,l=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,f=e.labelBgPadding,p=e.labelBgBorderRadius,h=e.style,m=e.sourcePosition,_=m===void 0?He.Bottom:m,v=e.targetPosition,y=v===void 0?He.Top:v,b=e.markerEnd,w=e.markerStart,E=e.borderRadius,N=E===void 0?5:E,j=rx({sourceX:t,sourceY:n,targetX:s,targetY:r,sourcePosition:_,targetPosition:y}),C=$t(j,2),M=C[0],z=C[1],D=Lf({sourceX:t,sourceY:n,sourcePosition:_,targetX:s,targetY:r,targetPosition:y,borderRadius:N});return ve.createElement(Sd,{path:D,centerX:M,centerY:z,label:i,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:h,markerEnd:b,markerStart:w})});function ax(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function ox(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ax(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ax(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var ix=x.memo(function(e){return ve.createElement(zf,ox(ox({},e),{},{borderRadius:0}))}),lx=x.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,r=e.targetY,i=e.label,l=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,f=e.labelBgPadding,p=e.labelBgBorderRadius,h=e.style,m=e.markerEnd,_=e.markerStart,v=Math.abs(r-n)/2,y=r<n?r+v:r-v,b=Math.abs(s-t)/2,w=s<t?s+b:s-b,E="M ".concat(t,",").concat(n,"L ").concat(s,",").concat(r);return ve.createElement(Sd,{path:E,centerX:w,centerY:y,label:i,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:p,style:h,markerEnd:m,markerStart:_})});function Cd(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function kd(e){var t=e.pos,n=e.x1,s=e.y1,r=e.x2,i=e.y2,l=e.c,u,d;switch(t){case He.Left:u=n-Cd(n-r,l),d=s;break;case He.Right:u=n+Cd(r-n,l),d=s;break;case He.Top:u=n,d=s-Cd(s-i,l);break;case He.Bottom:u=n,d=s+Cd(i-s,l);break}return[u,d]}function cx(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,r=s===void 0?He.Bottom:s,i=e.targetX,l=e.targetY,u=e.targetPosition,d=u===void 0?He.Top:u,f=e.curvature,p=f===void 0?.25:f,h=kd({pos:r,x1:t,y1:n,x2:i,y2:l,c:p}),m=$t(h,2),_=m[0],v=m[1],y=kd({pos:d,x1:i,y1:l,x2:t,y2:n,c:p}),b=$t(y,2),w=b[0],E=b[1];return"M".concat(t,",").concat(n," C").concat(_,",").concat(v," ").concat(w,",").concat(E," ").concat(i,",").concat(l)}function gO(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,r=s===void 0?He.Bottom:s,i=e.targetX,l=e.targetY,u=e.targetPosition,d=u===void 0?He.Top:u,f=e.curvature,p=f===void 0?.25:f,h=kd({pos:r,x1:t,y1:n,x2:i,y2:l,c:p}),m=$t(h,2),_=m[0],v=m[1],y=kd({pos:d,x1:i,y1:l,x2:t,y2:n,c:p}),b=$t(y,2),w=b[0],E=b[1],N=t*.125+_*.375+w*.375+i*.125,j=n*.125+v*.375+E*.375+l*.125,C=Math.abs(N-t),M=Math.abs(j-n);return[N,j,C,M]}var Rf=x.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,r=e.targetY,i=e.sourcePosition,l=i===void 0?He.Bottom:i,u=e.targetPosition,d=u===void 0?He.Top:u,f=e.label,p=e.labelStyle,h=e.labelShowBg,m=e.labelBgStyle,_=e.labelBgPadding,v=e.labelBgBorderRadius,y=e.style,b=e.markerEnd,w=e.markerStart,E=e.curvature,N={sourceX:t,sourceY:n,sourcePosition:l,targetX:s,targetY:r,targetPosition:d,curvature:E},j=cx(N),C=gO(N),M=$t(C,2),z=M[0],D=M[1];return ve.createElement(Sd,{path:j,centerX:z,centerY:D,label:f,labelStyle:p,labelShowBg:h,labelBgStyle:m,labelBgPadding:_,labelBgBorderRadius:v,style:y,markerEnd:b,markerStart:w})}),Df=x.createContext(null),_O=Df.Provider;Df.Consumer;function Pf(e,t,n,s,r,i,l){var u=l.elementFromPoint(e.clientX,e.clientY),d=(u==null?void 0:u.classList.contains("target"))||!1,f=(u==null?void 0:u.classList.contains("source"))||!1,p={elementBelow:u,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(u&&(d||f)){p.isHoveringHandle=!0;var h=u.getAttribute("data-nodeid"),m=u.getAttribute("data-handleid"),_=n?{source:h,sourceHandle:m,target:s,targetHandle:r}:{source:s,sourceHandle:r,target:h,targetHandle:m};p.connection=_;var v=t===Yo.Strict?n&&f||!n&&d:!0;v&&(p.isValid=i(_))}return p}function If(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function ux(e){var t=e.event,n=e.handleId,s=e.nodeId,r=e.onConnect,i=e.isTarget,l=e.getState,u=e.setState,d=e.isValidConnection,f=e.elementEdgeUpdaterType,p=e.onEdgeUpdateEnd,h=t.target.closest(".react-flow"),m=jv(t.target);if(!m)return;var _=m.elementFromPoint(t.clientX,t.clientY),v=_==null?void 0:_.classList.contains("target"),y=_==null?void 0:_.classList.contains("source");if(!h||!v&&!y&&!f)return;var b=l(),w=b.onConnectStart,E=b.connectionMode,N=f||(v?"target":"source"),j=h.getBoundingClientRect(),C;u({connectionPosition:{x:t.clientX-j.left,y:t.clientY-j.top},connectionNodeId:s,connectionHandleId:n,connectionHandleType:N}),w==null||w(t,{nodeId:s,handleId:n,handleType:N});function M(D){u({connectionPosition:{x:D.clientX-j.left,y:D.clientY-j.top}});var k=Pf(D,E,i,s,n,d,m),T=k.connection,A=k.elementBelow,O=k.isValid,R=k.isHoveringHandle;if(!R)return If(C);T.source!==T.target&&A&&(If(C),C=A,A.classList.add("react-flow__handle-connecting"),A.classList.toggle("react-flow__handle-valid",O))}function z(D){var k=l(),T=k.onConnectStop,A=k.onConnectEnd,O=Pf(D,E,i,s,n,d,m),R=O.connection,L=O.isValid;T==null||T(D),L&&(r==null||r(R)),A==null||A(D),f&&p&&p(D),If(C),u({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),m.removeEventListener("mousemove",M),m.removeEventListener("mouseup",z)}m.addEventListener("mousemove",M),m.addEventListener("mouseup",z)}var yO=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function dx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Ff(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var vO=function(){return!0},xO=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},mx=x.forwardRef(function(e,t){var n=e.type,s=n===void 0?"source":n,r=e.position,i=r===void 0?He.Top:r,l=e.isValidConnection,u=l===void 0?vO:l,d=e.isConnectable,f=d===void 0?!0:d,p=e.id,h=e.onConnect,m=e.children,_=e.className,v=e.onMouseDown,y=wd(e,yO),b=_s(),w=x.useContext(Df),E=In(xO,Zs),N=E.connectionStartHandle,j=E.connectOnClick,C=p||null,M=s==="target",z=function(A){var O=b.getState(),R=O.defaultEdgeOptions,L=O.onConnect,F=O.hasDefaultEdges,B=Ff(Ff({},R),A);if(F){var q=b.getState(),I=q.edges;b.setState({edges:zv(B,I)})}L==null||L(B),h==null||h(B)},D=function(A){A.button===0&&ux({event:A,handleId:C,nodeId:w,onConnect:z,isTarget:M,getState:b.getState,setState:b.setState,isValidConnection:u}),v==null||v(A)},k=function(A){var O=b.getState(),R=O.onClickConnectStart,L=O.onClickConnectStop,F=O.onClickConnectEnd,B=O.connectionMode;if(!N){R==null||R(A,{nodeId:w,handleId:C,handleType:s}),b.setState({connectionStartHandle:{nodeId:w,type:s,handleId:C}});return}var q=jv(A.target),I=Pf(A,B,N.type==="target",N.nodeId,N.handleId||null,u,q),U=I.connection,V=I.isValid;L==null||L(A),V&&z(U),F==null||F(A),b.setState({connectionStartHandle:null})};return ve.createElement("div",Ff({"data-handleid":C,"data-nodeid":w,"data-handlepos":i,className:Vt(["react-flow__handle","react-flow__handle-".concat(i),"nodrag",_,{source:!M,target:M,connectable:f,connecting:(N==null?void 0:N.nodeId)===w&&(N==null?void 0:N.handleId)===C&&(N==null?void 0:N.type)===s}]),onMouseDown:D,onClick:j?k:void 0,ref:t},y),m)});mx.displayName="Handle";var Sc=x.memo(mx),hx=function(t){var n=t.data,s=t.isConnectable,r=t.targetPosition,i=r===void 0?He.Top:r,l=t.sourcePosition,u=l===void 0?He.Bottom:l;return ve.createElement(ve.Fragment,null,ve.createElement(Sc,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label,ve.createElement(Sc,{type:"source",position:u,isConnectable:s}))};hx.displayName="DefaultNode";var Bf=x.memo(hx),fx=function(t){var n=t.data,s=t.isConnectable,r=t.sourcePosition,i=r===void 0?He.Bottom:r;return ve.createElement(ve.Fragment,null,n==null?void 0:n.label,ve.createElement(Sc,{type:"source",position:i,isConnectable:s}))};fx.displayName="InputNode";var px=x.memo(fx),gx=function(t){var n=t.data,s=t.isConnectable,r=t.targetPosition,i=r===void 0?He.Top:r;return ve.createElement(ve.Fragment,null,ve.createElement(Sc,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label)};gx.displayName="OutputNode";var _x=x.memo(gx),bO=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},wO=function(t,n){var s=t.selectedNodes.map(function(u){return u.id}),r=n.selectedNodes.map(function(u){return u.id}),i=t.selectedEdges.map(function(u){return u.id}),l=n.selectedEdges.map(function(u){return u.id});return Zs(s,r)&&Zs(i,l)};function NO(e){var t=e.onSelectionChange,n=In(bO,wO),s=n.selectedNodes,r=n.selectedEdges;return x.useEffect(function(){t({nodes:s,edges:r})},[s,r]),null}var jO=x.memo(NO),SO=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function Ga(e,t){x.useEffect(function(){typeof e<"u"&&t(e)},[e])}function sn(e,t,n){x.useEffect(function(){typeof t<"u"&&n(Ht({},e,t))},[t])}var EO=function(t){var n=t.nodes,s=t.edges,r=t.defaultNodes,i=t.defaultEdges,l=t.onConnect,u=t.onConnectStart,d=t.onConnectStop,f=t.onConnectEnd,p=t.onClickConnectStart,h=t.onClickConnectStop,m=t.onClickConnectEnd,_=t.nodesDraggable,v=t.nodesConnectable,y=t.minZoom,b=t.maxZoom,w=t.nodeExtent,E=t.onNodesChange,N=t.onEdgesChange,j=t.elementsSelectable,C=t.connectionMode,M=t.snapGrid,z=t.snapToGrid,D=t.translateExtent,k=t.connectOnClick,T=t.defaultEdgeOptions,A=t.fitView,O=t.fitViewOptions,R=t.onNodesDelete,L=t.onEdgesDelete,F=t.onNodeDrag,B=t.onNodeDragStart,q=t.onNodeDragStop,I=t.onSelectionDrag,U=t.onSelectionDragStart,V=t.onSelectionDragStop,H=In(SO,Zs),G=H.setNodes,W=H.setEdges,J=H.setDefaultNodesAndEdges,ee=H.setMinZoom,Z=H.setMaxZoom,K=H.setTranslateExtent,X=H.setNodeExtent,Q=H.reset,ne=_s();return x.useEffect(function(){return J(r,i),function(){Q()}},[]),sn("defaultEdgeOptions",T,ne.setState),sn("connectionMode",C,ne.setState),sn("onConnect",l,ne.setState),sn("onConnectStart",u,ne.setState),sn("onConnectStop",d,ne.setState),sn("onConnectEnd",f,ne.setState),sn("onClickConnectStart",p,ne.setState),sn("onClickConnectStop",h,ne.setState),sn("onClickConnectEnd",m,ne.setState),sn("nodesDraggable",_,ne.setState),sn("nodesConnectable",v,ne.setState),sn("elementsSelectable",j,ne.setState),sn("snapToGrid",z,ne.setState),sn("snapGrid",M,ne.setState),sn("onNodesChange",E,ne.setState),sn("onEdgesChange",N,ne.setState),sn("connectOnClick",k,ne.setState),sn("fitViewOnInit",A,ne.setState),sn("fitViewOnInitOptions",O,ne.setState),sn("onNodesDelete",R,ne.setState),sn("onEdgesDelete",L,ne.setState),sn("onNodeDrag",F,ne.setState),sn("onNodeDragStart",B,ne.setState),sn("onNodeDragStop",q,ne.setState),sn("onSelectionDrag",I,ne.setState),sn("onSelectionDragStart",U,ne.setState),sn("onSelectionDragStop",V,ne.setState),Ga(n,G),Ga(s,W),Ga(r,G),Ga(i,W),Ga(y,ee),Ga(b,Z),Ga(D,K),Ga(w,X),null},CO=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",kO=CO,MO=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",AO=MO,OO=function(t,n,s){return s===He.Left?t-n:s===He.Right?t+n:t},TO=function(t,n,s){return s===He.Top?t-n:s===He.Bottom?t+n:t},yx=function(t){var n=t.className,s=t.position,r=t.centerX,i=t.centerY,l=t.radius,u=l===void 0?10:l;return ve.createElement("circle",{className:Vt(["react-flow__edgeupdater",n]),cx:OO(r,u,s),cy:TO(i,u,s),r:u,stroke:"transparent",fill:"transparent"})},al=function(e){var t=function(s){var r=s.id,i=s.className,l=s.type,u=s.data,d=s.onClick,f=s.onEdgeDoubleClick,p=s.selected,h=s.animated,m=s.label,_=s.labelStyle,v=s.labelShowBg,y=s.labelBgStyle,b=s.labelBgPadding,w=s.labelBgBorderRadius,E=s.style,N=s.source,j=s.target,C=s.sourceX,M=s.sourceY,z=s.targetX,D=s.targetY,k=s.sourcePosition,T=s.targetPosition,A=s.elementsSelectable,O=s.hidden,R=s.sourceHandleId,L=s.targetHandleId,F=s.onContextMenu,B=s.onMouseEnter,q=s.onMouseMove,I=s.onMouseLeave,U=s.edgeUpdaterRadius,V=s.onEdgeUpdate,H=s.onEdgeUpdateStart,G=s.onEdgeUpdateEnd,W=s.markerEnd,J=s.markerStart,ee=s.rfId,Z=x.useState(!1),K=$t(Z,2),X=K[0],Q=K[1],ne=_s(),le=function(tt){var xt=ne.getState(),_t=xt.edges,Bt=xt.addSelectedEdges,$e=_t.find(function(Ie){return Ie.id===r});A&&(ne.setState({nodesSelectionActive:!1}),Bt([r])),d==null||d(tt,$e)},ce=jc(r,ne.getState,f),ie=jc(r,ne.getState,F),ge=jc(r,ne.getState,B),Re=jc(r,ne.getState,q),ze=jc(r,ne.getState,I),me=function(tt,xt){var _t=xt?j:N,Bt=(xt?L:R)||null,$e=xt?"target":"source",Ie=function(){return!0},Be=xt,Ee=ne.getState().edges.find(function(Ue){return Ue.id===r});H==null||H(tt,Ee,$e);var lt=G?function(Ue){return G(Ue,Ee,$e)}:void 0,Je=function(Rt){return V==null?void 0:V(Ee,Rt)};ux({event:tt,handleId:Bt,nodeId:_t,onConnect:Je,isTarget:Be,getState:ne.getState,setState:ne.setState,isValidConnection:Ie,elementEdgeUpdaterType:$e,onEdgeUpdateEnd:lt})},xe=function(tt){return me(tt,!0)},Ce=function(tt){return me(tt,!1)},Ae=function(){return Q(!0)},Ve=function(){return Q(!1)},Se=x.useMemo(function(){return"url(#".concat(xf(J,ee),")")},[J,ee]),We=x.useMemo(function(){return"url(#".concat(xf(W,ee),")")},[W,ee]);if(O)return null;var ht=!A&&!d,ye=typeof V<"u",Fe=Vt(["react-flow__edge","react-flow__edge-".concat(l),i,{selected:p,animated:h,inactive:ht,updating:X}]);return ve.createElement("g",{className:Fe,onClick:le,onDoubleClick:ce,onContextMenu:ie,onMouseEnter:ge,onMouseMove:Re,onMouseLeave:ze},ve.createElement(e,{id:r,source:N,target:j,selected:p,animated:h,label:m,labelStyle:_,labelShowBg:v,labelBgStyle:y,labelBgPadding:b,labelBgBorderRadius:w,data:u,style:E,sourceX:C,sourceY:M,targetX:z,targetY:D,sourcePosition:k,targetPosition:T,sourceHandleId:R,targetHandleId:L,markerStart:Se,markerEnd:We,"data-testid":"rf__edge-".concat(r)}),ye&&ve.createElement("g",{onMouseDown:xe,onMouseEnter:Ae,onMouseOut:Ve},ve.createElement(yx,{position:k,centerX:C,centerY:M,radius:U})),ye&&ve.createElement("g",{onMouseDown:Ce,onMouseEnter:Ae,onMouseOut:Ve},ve.createElement(yx,{position:T,centerX:z,centerY:D,radius:U})))};return t.displayName="EdgeWrapper",x.memo(t)};function vx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function xx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function $O(e){var t={default:al(e.default||Rf),straight:al(e.bezier||lx),step:al(e.step||ix),smoothstep:al(e.step||zf),simplebezier:al(e.simplebezier||tx)},n={},s=Object.keys(e).filter(function(r){return!["default","bezier"].includes(r)}).reduce(function(r,i){return r[i]=al(e[i]||Rf),r},n);return xx(xx({},t),s)}function bx(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=((n==null?void 0:n.x)||0)+t.x,r=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,l=(n==null?void 0:n.height)||t.height;switch(e){case He.Top:return{x:s+i/2,y:r};case He.Right:return{x:s+i,y:r+l/2};case He.Bottom:return{x:s+i/2,y:r+l};case He.Left:return{x:s,y:r+l/2}}}function wx(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(s){return s.id===t})),typeof n>"u"?null:n}var LO=function(t,n,s,r,i,l){var u=bx(s,t,n),d=bx(l,r,i);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y}};function zO(e){var t=e.sourcePos,n=e.targetPos,s=e.sourceWidth,r=e.sourceHeight,i=e.targetWidth,l=e.targetHeight,u=e.width,d=e.height,f=e.transform,p={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+s,n.x+i),y2:Math.max(t.y+r,n.y+l)};p.x===p.x2&&(p.x2+=1),p.y===p.y2&&(p.y2+=1);var h=xd({x:(0-f[0])/f[2],y:(0-f[1])/f[2],width:u/f[2],height:d/f[2]}),m=Math.max(0,Math.min(h.x2,p.x2)-Math.max(h.x,p.x)),_=Math.max(0,Math.min(h.y2,p.y2)-Math.max(h.y,p.y)),v=Math.ceil(m*_);return v>0}function Nx(e,t){var n,s,r,i,l,u=e.get(t),d=(u==null||(n=u[ds])===null||n===void 0?void 0:n.handleBounds)||null,f=!u||!d||!u.width||!u.height||typeof((s=u.positionAbsolute)===null||s===void 0?void 0:s.x)>"u"||typeof((r=u.positionAbsolute)===null||r===void 0?void 0:r.y)>"u";return[{x:(u==null||(i=u.positionAbsolute)===null||i===void 0?void 0:i.x)||0,y:(u==null||(l=u.positionAbsolute)===null||l===void 0?void 0:l.y)||0,width:(u==null?void 0:u.width)||0,height:(u==null?void 0:u.height)||0},d,!f]}var RO=typeof document<"u"?document:null,Md=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:RO},n=x.useState(!1),s=$t(n,2),r=s[0],i=s[1],l=x.useRef(new Set([])),u=x.useMemo(function(){if(e!==null){var h=Array.isArray(e)?e:[e],m=h.filter(function(v){return typeof v=="string"}).map(function(v){return v.split("+")}),_=m.reduce(function(v,y){return v.concat.apply(v,Go(y))},[]);return[m,_]}return[[],[]]},[e]),d=$t(u,2),f=d[0],p=d[1];return x.useEffect(function(){if(e!==null){var h,m,_=function(w){if(Ex(w))return!1;var E=Sx(w.code,p);l.current.add(w[E]),jx(f,l.current,!1)&&(w.preventDefault(),i(!0))},v=function(w){if(Ex(w))return!1;var E=Sx(w.code,p);jx(f,l.current,!0)?(i(!1),l.current.clear()):l.current.delete(w[E])},y=function(){l.current.clear(),i(!1)};return t==null||(h=t.target)===null||h===void 0||h.addEventListener("keydown",_),t==null||(m=t.target)===null||m===void 0||m.addEventListener("keyup",v),window.addEventListener("blur",y),function(){var b,w;t==null||(b=t.target)===null||b===void 0||b.removeEventListener("keydown",_),t==null||(w=t.target)===null||w===void 0||w.removeEventListener("keyup",v),window.removeEventListener("blur",y)}}},[e,i]),r};function jx(e,t,n){return e.filter(function(s){return n||s.length===t.size}).some(function(s){return s.every(function(r){return t.has(r)})})}function Sx(e,t){return t.includes(e)?"code":"key"}function Ex(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var DO=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},PO=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,s=_s(),r=In(DO,Zs),i=r.onNodesChange,l=r.onEdgesChange,u=Md(t),d=Md(n);x.useEffect(function(){var f=s.getState(),p=f.nodeInternals,h=f.edges,m=f.hasDefaultNodes,_=f.hasDefaultEdges,v=f.onNodesDelete,y=f.onEdgesDelete,b=Array.from(p.values()),w=b.reduce(function(D,k){return(!k.selected&&k.parentNode&&D.find(function(T){return T.id===k.parentNode})||k.selected)&&D.push(k),D},[]),E=h.filter(function(D){return D.selected});if(u&&(w||E)){var N=Pv(w,h),j=[].concat(Go(E),Go(N)),C=j.reduce(function(D,k){return D.includes(k.id)||D.push(k.id),D},[]);if((_||m)&&(_&&s.setState({edges:h.filter(function(D){return!C.includes(D.id)})}),m&&(w.forEach(function(D){p.delete(D.id)}),s.setState({nodeInternals:new Map(p)}))),C.length>0&&(y==null||y(j),l)){var M=C.map(function(D){return{id:D,type:"remove"}});l(M)}if(w.length>0&&(v==null||v(w),i)){var z=w.map(function(D){return{id:D.id,type:"remove"}});i(z)}s.setState({nodesSelectionActive:!1})}},[u,i,l]),x.useEffect(function(){s.setState({multiSelectionActive:d})},[d])};function IO(e){var t=_s();x.useEffect(function(){var n,s=function(){if(e.current){var i=vf(e.current);t.setState({width:i.width||500,height:i.height||500})}};return s(),window.onresize=s,e.current&&(n=new ResizeObserver(function(){return s()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var FO=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},Hf=function(t){return{x:t.x,y:t.y,zoom:t.k}},Ad=function(t,n){return t.target.closest(".".concat(n))},BO=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},HO=function(t){var n=t.onMove,s=t.onMoveStart,r=t.onMoveEnd,i=t.zoomOnScroll,l=i===void 0?!0:i,u=t.zoomOnPinch,d=u===void 0?!0:u,f=t.panOnScroll,p=f===void 0?!1:f,h=t.panOnScrollSpeed,m=h===void 0?.5:h,_=t.panOnScrollMode,v=_===void 0?el.Free:_,y=t.zoomOnDoubleClick,b=y===void 0?!0:y,w=t.selectionKeyPressed,E=t.elementsSelectable,N=t.panOnDrag,j=N===void 0?!0:N,C=t.translateExtent,M=t.minZoom,z=t.maxZoom,D=t.defaultZoom,k=D===void 0?1:D,T=t.defaultPosition,A=T===void 0?[0,0]:T,O=t.zoomActivationKeyCode,R=t.preventScrolling,L=R===void 0?!0:R,F=t.children,B=t.noWheelClassName,q=t.noPanClassName,I=_s(),U=x.useRef(!1),V=x.useRef(null),H=x.useRef({x:0,y:0,zoom:0}),G=In(BO,Zs),W=G.d3Zoom,J=G.d3Selection,ee=G.d3ZoomHandler,Z=Md(O);return IO(V),x.useEffect(function(){if(V.current){var K,X=_f().scaleExtent([M,z]).translateExtent(C),Q=Cs(V.current).call(X),ne=tl(A[0],C[0][0],C[1][0]),le=tl(A[1],C[0][1],C[1][1]),ce=tl(k,M,z),ie=pa.translate(ne,le).scale(ce);X.transform(Q,ie),I.setState({d3Zoom:X,d3Selection:Q,d3ZoomHandler:Q.on("wheel.zoom"),transform:[ne,le,ce],domNode:(K=Q.node())===null||K===void 0?void 0:K.closest(".react-flow")})}},[]),x.useEffect(function(){J&&W&&(p&&!Z?J.on("wheel",function(K){if(Ad(K,B))return!1;K.preventDefault(),K.stopImmediatePropagation();var X=J.property("__zoom").k||1;if(K.ctrlKey&&d){var Q=hr(K),ne=-K.deltaY*(K.deltaMode===1?.05:K.deltaMode?1:.002)*10,le=X*Math.pow(2,ne);W.scaleTo(J,le,Q);return}var ce=K.deltaMode===1?20:1,ie=v===el.Vertical?0:K.deltaX*ce,ge=v===el.Horizontal?0:K.deltaY*ce;W.translateBy(J,-(ie/X)*m,-(ge/X)*m)}).on("wheel.zoom",null):typeof ee<"u"&&J.on("wheel",function(K){if(!L||Ad(K,B))return null;K.preventDefault()}).on("wheel.zoom",ee))},[p,v,J,W,ee,Z,d,L,B]),x.useEffect(function(){W&&(w&&!U.current?W.on("zoom",null):w||W.on("zoom",function(K){if(I.setState({transform:[K.transform.x,K.transform.y,K.transform.k]}),n){var X=Hf(K.transform);n(K.sourceEvent,X)}}))},[w,W,n]),x.useEffect(function(){W&&W.on("start",function(K){if(U.current=!0,s){var X=Hf(K.transform);H.current=X,s(K.sourceEvent,X)}})},[W,s]),x.useEffect(function(){W&&W.on("end",function(K){if(U.current=!1,r&&FO(H.current,K.transform)){var X=Hf(K.transform);H.current=X,r(K.sourceEvent,X)}})},[W,r]),x.useEffect(function(){W&&W.filter(function(K){var X=Z||l,Q=d&&K.ctrlKey;return!j&&!X&&!p&&!b&&!d||w||!b&&K.type==="dblclick"||Ad(K,B)&&K.type==="wheel"||Ad(K,q)&&K.type!=="wheel"||!d&&K.ctrlKey&&K.type==="wheel"||!X&&!p&&!Q&&K.type==="wheel"||!j&&(K.type==="mousedown"||K.type==="touchstart")?!1:(!K.ctrlKey||K.type==="wheel")&&!K.button})},[W,l,d,p,b,j,w,E,Z]),ve.createElement("div",{className:"react-flow__renderer react-flow__container",ref:V},F)};function Cx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function kx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Mx(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var UO=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},Ax={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},qO=x.memo(function(e){var t=e.selectionKeyPressed,n=_s(),s=x.useRef(0),r=x.useRef(0),i=x.useRef(),l=x.useState(Ax),u=$t(l,2),d=u[0],f=u[1],p=In(UO,Zs),h=p.userSelectionActive,m=p.elementsSelectable,_=h||t;if(!m||!_)return null;var v=function(){f(Ax),n.setState({userSelectionActive:!1}),s.current=0,r.current=0},y=function(j){var C=j.target.closest(".react-flow");i.current=C.getBoundingClientRect();var M=Mx(j,i.current);f({width:0,height:0,startX:M.x,startY:M.y,x:M.x,y:M.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},b=function(j){var C,M;if(!(!t||!d.draw||!i.current)){var z=Mx(j,i.current),D=(C=d.startX)!==null&&C!==void 0?C:0,k=(M=d.startY)!==null&&M!==void 0?M:0,T=kx(kx({},d),{},{x:z.x<D?z.x:D,y:z.y<k?z.y:k,width:Math.abs(z.x-D),height:Math.abs(z.y-k)}),A=n.getState(),O=A.nodeInternals,R=A.edges,L=A.transform,F=A.onNodesChange,B=A.onEdgesChange,q=Array.from(O.values()),I=Dv(O,T,L,!1,!0),U=Pv(I,R).map(function(W){return W.id}),V=I.map(function(W){return W.id});if(s.current!==V.length){s.current=V.length;var H=nl(q,V);H.length&&(F==null||F(H))}if(r.current!==U.length){r.current=U.length;var G=nl(R,U);G.length&&(B==null||B(G))}f(T)}},w=function(){n.setState({nodesSelectionActive:s.current>0}),v()},E=function(){n.setState({nodesSelectionActive:!1}),v()};return ve.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:y,onMouseMove:b,onMouseUp:w,onMouseLeave:E},d.draw&&ve.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:d.width,height:d.height,transform:"translate(".concat(d.x,"px, ").concat(d.y,"px)")}}))});function Ox(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Tx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ox(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ox(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function $x(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:$x(n,t):!1}function Lx(e,t,n){var s=e;do{var r;if((r=s)!==null&&r!==void 0&&r.matches(t))return!0;if(s===n.current)return!1;s=s.parentElement}while(s);return!1}function VO(e,t,n){return Array.from(e.values()).filter(function(s){return(s.selected||s.id===n)&&(!s.parentNode||!$x(s,e))}).map(function(s){var r,i,l,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:t.x-((r=(i=s.positionAbsolute)===null||i===void 0?void 0:i.x)!==null&&r!==void 0?r:0),y:t.y-((l=(u=s.positionAbsolute)===null||u===void 0?void 0:u.y)!==null&&l!==void 0?l:0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function KO(e,t,n,s,r,i){var l=$t(s,2),u=l[0],d=l[1],f=e.extent||i,p={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(p.x=u*Math.round(p.x/u),p.y=d*Math.round(p.y/d)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var h=r.get(e.parentNode);f=h!=null&&h.positionAbsolute&&h!==null&&h!==void 0&&h.width&&h!==null&&h!==void 0&&h.height?[[h.positionAbsolute.x,h.positionAbsolute.y],[h.positionAbsolute.x+h.width-e.width,h.positionAbsolute.y+h.height-e.height]]:f}else f=i;else if(e.extent&&e.parentNode){var m,_,v,y,b=r.get(e.parentNode),w=(m=b==null||(_=b.positionAbsolute)===null||_===void 0?void 0:_.x)!==null&&m!==void 0?m:0,E=(v=b==null||(y=b.positionAbsolute)===null||y===void 0?void 0:y.y)!==null&&v!==void 0?v:0;f=[[e.extent[0][0]+w,e.extent[0][1]+E],[e.extent[1][0]+w,e.extent[1][1]+E]]}var N={x:0,y:0};if(e.parentNode){var j,C,M,z,D=r.get(e.parentNode);N={x:(j=D==null||(C=D.positionAbsolute)===null||C===void 0?void 0:C.x)!==null&&j!==void 0?j:0,y:(M=D==null||(z=D.positionAbsolute)===null||z===void 0?void 0:z.y)!==null&&M!==void 0?M:0}}return e.positionAbsolute=f?Nv(p,f):p,e.position={x:e.positionAbsolute.x-N.x,y:e.positionAbsolute.y-N.y},e}function Uf(e){var t=e.nodeId,n=e.dragItems,s=e.nodeInternals,r=n.map(function(i){var l=s.get(i.id);return Tx(Tx({},l),{},{position:i.position,positionAbsolute:i.positionAbsolute})});return[t?r.find(function(i){return i.id===t}):r[0],r]}function qf(e){return function(t,n,s){return e==null?void 0:e(t,s)}}function zx(e){var t=e.nodeRef,n=e.disabled,s=n===void 0?!1:n,r=e.noDragClassName,i=e.handleSelector,l=e.nodeId,u=e.isSelectable,d=e.selectNodesOnDrag,f=x.useState(!1),p=$t(f,2),h=p[0],m=p[1],_=_s(),v=x.useRef(),y=x.useRef({x:null,y:null}),b=x.useCallback(function(w){var E=w.sourceEvent,N=_.getState(),j=N.transform,C=N.snapGrid,M=N.snapToGrid,z=E.touches?E.touches[0].clientX:E.clientX,D=E.touches?E.touches[0].clientY:E.clientY,k=Rv({x:z,y:D},j,M,C);return k},[]);return x.useEffect(function(){if(t!=null&&t.current){var w=Cs(t.current);if(s)w.on(".drag",null);else{var E=tf().on("start",function(N){var j=_.getState(),C=j.nodeInternals,M=j.multiSelectionActive,z=j.unselectNodesAndEdges,D=j.onNodeDragStart,k=j.onSelectionDragStart,T=l?D:qf(k);if(!d&&!M&&l){var A;(A=C.get(l))!==null&&A!==void 0&&A.selected||z()}l&&u&&d&&$v({id:l,store:_});var O=b(N);if(y.current=O,v.current=VO(C,O,l),T&&v.current){var R=Uf({nodeId:l,dragItems:v.current,nodeInternals:C}),L=$t(R,2),F=L[0],B=L[1];T(N.sourceEvent,F,B)}}).on("drag",function(N){var j=_.getState(),C=j.updateNodePositions,M=j.snapToGrid,z=j.snapGrid,D=j.nodeInternals,k=j.nodeExtent,T=j.onNodeDrag,A=j.onSelectionDrag,O=b(N);if((y.current.x!==O.x||y.current.y!==O.y)&&v.current){y.current=O,v.current=v.current.map(function(I){return KO(I,O,M,z,D,k)});var R=l?T:qf(A);if(C(v.current,!0,!0),m(!0),R){var L=Uf({nodeId:l,dragItems:v.current,nodeInternals:D}),F=$t(L,2),B=F[0],q=F[1];R(N.sourceEvent,B,q)}}N.on("end",function(I){if(m(!1),v.current){var U=_.getState(),V=U.updateNodePositions,H=U.nodeInternals,G=U.onNodeDragStop,W=U.onSelectionDragStop,J=l?G:qf(W);if(V(v.current,!1,!1),J){var ee=Uf({nodeId:l,dragItems:v.current,nodeInternals:H}),Z=$t(ee,2),K=Z[0],X=Z[1];J(I.sourceEvent,K,X)}}})}).filter(function(N){var j=N.target,C=!N.button&&(!r||!Lx(j,".".concat(r),t))&&(!i||Lx(j,i,t));return C});return w.call(E),function(){w.on(".drag",null)}}}},[t,s,r,i,u,_,l,d,b]),h}function Rx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function YO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var WO=function(t){return YO({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},bf(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},GO=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(s){return s.selected});return bf(n)};function XO(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,s=_s(),r=In(WO,Zs),i=r.transformString,l=r.userSelectionActive,u=In(GO,Zs),d=u.width,f=u.height,p=u.x,h=u.y,m=x.useRef(null);if(zx({nodeRef:m}),l||!d||!f)return null;var _=t?function(v){var y=Array.from(s.getState().nodeInternals.values()).filter(function(b){return b.selected});t(v,y)}:void 0;return ve.createElement("div",{className:Vt(["react-flow__nodesselection","react-flow__container",n]),style:{transform:i}},ve.createElement("div",{ref:m,className:"react-flow__nodesselection-rect",onContextMenu:_,style:{width:d,height:f,top:h,left:p}}))}var QO=x.memo(XO),ZO=function(t){return t.nodesSelectionActive},Dx=function(t){var n=t.children,s=t.onPaneClick,r=t.onPaneContextMenu,i=t.onPaneScroll,l=t.deleteKeyCode,u=t.onMove,d=t.onMoveStart,f=t.onMoveEnd,p=t.selectionKeyCode,h=t.multiSelectionKeyCode,m=t.zoomActivationKeyCode,_=t.elementsSelectable,v=t.zoomOnScroll,y=t.zoomOnPinch,b=t.panOnScroll,w=t.panOnScrollSpeed,E=t.panOnScrollMode,N=t.zoomOnDoubleClick,j=t.panOnDrag,C=t.translateExtent,M=t.minZoom,z=t.maxZoom,D=t.defaultZoom,k=t.defaultPosition,T=t.preventScrolling,A=t.onSelectionContextMenu,O=t.noWheelClassName,R=t.noPanClassName,L=_s(),F=In(ZO),B=Md(p);PO({deleteKeyCode:l,multiSelectionKeyCode:h});var q=function(H){s==null||s(H),L.getState().resetSelectedElements(),L.setState({nodesSelectionActive:!1})},I=r?function(V){return r(V)}:void 0,U=i?function(V){return i(V)}:void 0;return ve.createElement(HO,{onMove:u,onMoveStart:d,onMoveEnd:f,selectionKeyPressed:B,elementsSelectable:_,zoomOnScroll:v,zoomOnPinch:y,panOnScroll:b,panOnScrollSpeed:w,panOnScrollMode:E,zoomOnDoubleClick:N,panOnDrag:j,translateExtent:C,minZoom:M,maxZoom:z,defaultZoom:D,defaultPosition:k,zoomActivationKeyCode:m,preventScrolling:T,noWheelClassName:O,noPanClassName:R},n,ve.createElement(qO,{selectionKeyPressed:B}),F&&ve.createElement(QO,{onSelectionContextMenu:A,noPanClassName:R}),ve.createElement("div",{className:"react-flow__pane react-flow__container",onClick:q,onContextMenu:I,onWheel:U}))};Dx.displayName="FlowRenderer";var JO=x.memo(Dx);function e2(e){var t=In(x.useCallback(function(n){return e?Dv(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var t2=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},Px=function(t){var n=In(t2,Zs),s=n.nodesDraggable,r=n.nodesConnectable,i=n.elementsSelectable,l=n.updateNodeDimensions,u=e2(t.onlyRenderVisibleElements),d=x.useRef(),f=x.useMemo(function(){if(typeof ResizeObserver>"u")return null;var p=new ResizeObserver(function(h){var m=h.map(function(_){return{id:_.target.getAttribute("data-id"),nodeElement:_.target,forceUpdate:!0}});l(m)});return d.current=p,p},[]);return x.useEffect(function(){return function(){var p;d==null||(p=d.current)===null||p===void 0||p.disconnect()}},[]),ve.createElement("div",{className:"react-flow__nodes react-flow__container"},u.map(function(p){var h,m,_,v,y,b,w,E=p.type||"default";t.nodeTypes[E]||(E="default");var N=t.nodeTypes[E]||t.nodeTypes.default,j=!!(p.draggable||s&&typeof p.draggable>"u"),C=!!(p.selectable||i&&typeof p.selectable>"u"),M=!!(p.connectable||r&&typeof p.connectable>"u");return ve.createElement(N,{key:p.id,id:p.id,className:p.className,style:p.style,type:E,data:p.data,sourcePosition:p.sourcePosition||He.Bottom,targetPosition:p.targetPosition||He.Top,hidden:p.hidden,xPos:(h=(m=p.positionAbsolute)===null||m===void 0?void 0:m.x)!==null&&h!==void 0?h:0,yPos:(_=(v=p.positionAbsolute)===null||v===void 0?void 0:v.y)!==null&&_!==void 0?_:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!p.selected,isDraggable:j,isSelectable:C,isConnectable:M,resizeObserver:f,dragHandle:p.dragHandle,zIndex:(y=(b=p[ds])===null||b===void 0?void 0:b.z)!==null&&y!==void 0?y:0,isParent:!!((w=p[ds])!==null&&w!==void 0&&w.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!p.width&&!!p.height})}))};Px.displayName="NodeRenderer";var n2=x.memo(Px),ol;function Ix(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Fx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ix(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ix(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var s2=(ol={},Ht(ol,He.Left,He.Right),Ht(ol,He.Right,He.Left),Ht(ol,He.Top,He.Bottom),Ht(ol,He.Bottom,He.Top),ol),r2=function(e){var t,n,s,r,i,l=e.connectionNodeId,u=e.connectionHandleType,d=e.connectionLineStyle,f=e.connectionLineType,p=f===void 0?Ya.Bezier:f,h=e.isConnectable,m=e.CustomConnectionLineComponent,_=In(x.useCallback(function(U){return{fromNode:U.nodeInternals.get(l),handleId:U.connectionHandleId,toX:(U.connectionPosition.x-U.transform[0])/U.transform[2],toY:(U.connectionPosition.y-U.transform[1])/U.transform[2]}},[l]),Zs),v=_.fromNode,y=_.handleId,b=_.toX,w=_.toY,E=v==null||(t=v[ds])===null||t===void 0?void 0:t.handleBounds;if(!v||!h||!(E!=null&&E[u]))return null;var N=E[u],j=y?N.find(function(U){return U.id===y}):N[0],C=j?j.x+j.width/2:((n=v==null?void 0:v.width)!==null&&n!==void 0?n:0)/2,M=j?j.y+j.height/2:(s=v==null?void 0:v.height)!==null&&s!==void 0?s:0,z=((v==null||(r=v.positionAbsolute)===null||r===void 0?void 0:r.x)||0)+C,D=((v==null||(i=v.positionAbsolute)===null||i===void 0?void 0:i.y)||0)+M,k=j==null?void 0:j.position;if(!k)return null;var T=s2[k],A,O,R,L,F,B;switch(u){case"source":A=z,O=D,R=k,L=b,F=w,B=T;break;case"target":A=b,O=w,R=T,L=z,F=D,B=k;break}if(m)return ve.createElement("g",{className:"react-flow__connection"},ve.createElement(m,{connectionLineType:p,connectionLineStyle:d,fromNode:v,fromHandle:j,fromX:z,fromY:D,toX:b,toY:w,fromPosition:k,toPosition:T,sourcePosition:R,targetPosition:B,sourceNode:v,sourceHandle:j,targetX:L,targetY:F,sourceX:A,sourceY:O}));var q="",I={sourceX:A,sourceY:O,sourcePosition:R,targetX:L,targetY:F,targetPosition:B};return p===Ya.Bezier?q=cx(I):p===Ya.Step?q=Lf(Fx(Fx({},I),{},{borderRadius:0})):p===Ya.SmoothStep?q=Lf(I):p===Ya.SimpleBezier?q=ex(I):q="M".concat(A,",").concat(O," ").concat(L,",").concat(F),ve.createElement("g",{className:"react-flow__connection"},ve.createElement("path",{d:q,className:"react-flow__connection-path",style:d}))};function Vf(e){"@babel/helpers - typeof";return Vf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vf(e)}var Od,a2=function(t){var n=t.color,s=n===void 0?"none":n,r=t.strokeWidth,i=r===void 0?1:r;return ve.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:"none",points:"-5,-4 0,0 -5,4"})},o2=function(t){var n=t.color,s=n===void 0?"none":n,r=t.strokeWidth,i=r===void 0?1:r;return ve.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:s,points:"-5,-4 0,0 -5,4 -5,-4"})},Bx=(Od={},Ht(Od,vd.Arrow,a2),Ht(Od,vd.ArrowClosed,o2),Od);function i2(e){var t=x.useMemo(function(){var n=Bx.hasOwnProperty(e);return n?Bx[e]:function(){return null}},[e]);return t}function Hx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function l2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Hx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var c2=function(t){var n=t.id,s=t.type,r=t.color,i=t.width,l=i===void 0?12.5:i,u=t.height,d=u===void 0?12.5:u,f=t.markerUnits,p=f===void 0?"strokeWidth":f,h=t.strokeWidth,m=t.orient,_=m===void 0?"auto":m,v=i2(s);return ve.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(l),markerHeight:"".concat(d),viewBox:"-10 -10 20 20",markerUnits:p,orient:_,refX:"0",refY:"0"},ve.createElement(v,{color:r,strokeWidth:h}))},u2=function(t){var n=t.defaultColor,s=t.rfId;return function(r){var i=[];return r.edges.reduce(function(l,u){return[u.markerStart,u.markerEnd].forEach(function(d){if(d&&Vf(d)==="object"){var f=xf(d,s);i.includes(f)||(l.push(l2({id:f,color:d.color||n},d)),i.push(f))}}),l},[]).sort(function(l,u){return l.id.localeCompare(u.id)})}},Ux=function(t){var n=t.defaultColor,s=t.rfId,r=In(x.useCallback(u2({defaultColor:n,rfId:s}),[n,s]),function(i,l){return!(i.length!==l.length||i.some(function(u,d){return u.id!==l[d].id}))});return ve.createElement("defs",null,r.map(function(i){return ve.createElement(c2,{id:i.id,key:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient})}))};Ux.displayName="MarkerDefinitions";var d2=x.memo(Ux),m2=[{level:0,isMaxLevel:!0,edges:[]}];function h2(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=-1,r=e.reduce(function(l,u){var d=Sv(u.zIndex),f=d?u.zIndex:0;if(n){var p,h,m,_;f=d?u.zIndex:Math.max(((p=t.get(u.source))===null||p===void 0||(h=p[ds])===null||h===void 0?void 0:h.z)||0,((m=t.get(u.target))===null||m===void 0||(_=m[ds])===null||_===void 0?void 0:_.z)||0)}return l[f]?l[f].push(u):l[f]=[u],s=f>s?f:s,l},{}),i=Object.entries(r).map(function(l){var u=$t(l,2),d=u[0],f=u[1],p=+d;return{edges:f,level:p,isMaxLevel:p===s}});return i.length===0?m2:i}function f2(e,t,n){var s=In(x.useCallback(function(r){return e?r.edges.filter(function(i){var l=t.get(i.source),u=t.get(i.target);return(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&zO({sourcePos:l.positionAbsolute||{x:0,y:0},targetPos:u.positionAbsolute||{x:0,y:0},sourceWidth:l.width,sourceHeight:l.height,targetWidth:u.width,targetHeight:u.height,width:r.width,height:r.height,transform:r.transform})}):r.edges},[e,t]));return h2(s,t,n)}var p2=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},qx=function(t){var n=In(p2,Zs),s=n.connectionNodeId,r=n.connectionHandleType,i=n.nodesConnectable,l=n.elementsSelectable,u=n.width,d=n.height,f=n.connectionMode,p=n.nodeInternals,h=f2(t.onlyRenderVisibleElements,p,t.elevateEdgesOnSelect);if(!u)return null;var m=t.connectionLineType,_=t.defaultMarkerColor,v=t.connectionLineStyle,y=t.connectionLineComponent,b=t.connectionLineContainerStyle,w=s&&r;return ve.createElement(ve.Fragment,null,h.map(function(E){var N=E.level,j=E.edges,C=E.isMaxLevel;return ve.createElement("svg",{key:N,style:{zIndex:N},width:u,height:d,className:"react-flow__edges react-flow__container"},C&&ve.createElement(d2,{defaultColor:_,rfId:t.rfId}),ve.createElement("g",null,j.map(function(M){var z=Nx(p,M.source),D=$t(z,3),k=D[0],T=D[1],A=D[2],O=Nx(p,M.target),R=$t(O,3),L=R[0],F=R[1],B=R[2];if(!A||!B)return null;var q=M.type||"default";t.edgeTypes[q]||(console.warn('[React Flow]: Edge type "'.concat(q,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),q="default");var I=t.edgeTypes[q]||t.edgeTypes.default,U=f===Yo.Strict?F.target:F.target||F.source,V=wx(T.source,M.sourceHandle||null),H=wx(U,M.targetHandle||null),G=(V==null?void 0:V.position)||He.Bottom,W=(H==null?void 0:H.position)||He.Top;if(!V||!H)return null;var J=LO(k,V,G,L,H,W),ee=J.sourceX,Z=J.sourceY,K=J.targetX,X=J.targetY;return ve.createElement(I,{key:M.id,id:M.id,className:Vt([M.className,t.noPanClassName]),type:q,data:M.data,selected:!!M.selected,animated:!!M.animated,hidden:!!M.hidden,label:M.label,labelStyle:M.labelStyle,labelShowBg:M.labelShowBg,labelBgStyle:M.labelBgStyle,labelBgPadding:M.labelBgPadding,labelBgBorderRadius:M.labelBgBorderRadius,style:M.style,source:M.source,target:M.target,sourceHandleId:M.sourceHandle,targetHandleId:M.targetHandle,markerEnd:M.markerEnd,markerStart:M.markerStart,sourceX:ee,sourceY:Z,targetX:K,targetY:X,sourcePosition:G,targetPosition:W,elementsSelectable:l,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),w&&ve.createElement("svg",{style:b,width:u,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},ve.createElement(r2,{connectionNodeId:s,connectionHandleType:r,connectionLineStyle:v,connectionLineType:m,isConnectable:i,CustomConnectionLineComponent:y})))};qx.displayName="EdgeRenderer";var g2=x.memo(qx),_2=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function y2(e){var t=e.children,n=In(_2);return ve.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function v2(e){var t=Sf(),n=x.useRef(!1);x.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var Vx=function(t){var n=t.nodeTypes,s=t.edgeTypes,r=t.onMove,i=t.onMoveStart,l=t.onMoveEnd,u=t.onInit,d=t.onNodeClick,f=t.onEdgeClick,p=t.onNodeDoubleClick,h=t.onEdgeDoubleClick,m=t.onNodeMouseEnter,_=t.onNodeMouseMove,v=t.onNodeMouseLeave,y=t.onNodeContextMenu,b=t.onSelectionContextMenu,w=t.connectionLineType,E=t.connectionLineStyle,N=t.connectionLineComponent,j=t.connectionLineContainerStyle,C=t.selectionKeyCode,M=t.multiSelectionKeyCode,z=t.zoomActivationKeyCode,D=t.deleteKeyCode,k=t.onlyRenderVisibleElements,T=t.elementsSelectable,A=t.selectNodesOnDrag,O=t.translateExtent,R=t.minZoom,L=t.maxZoom,F=t.defaultZoom,B=t.defaultPosition,q=t.preventScrolling,I=t.defaultMarkerColor,U=t.zoomOnScroll,V=t.zoomOnPinch,H=t.panOnScroll,G=t.panOnScrollSpeed,W=t.panOnScrollMode,J=t.zoomOnDoubleClick,ee=t.panOnDrag,Z=t.onPaneClick,K=t.onPaneScroll,X=t.onPaneContextMenu,Q=t.onEdgeUpdate,ne=t.onEdgeContextMenu,le=t.onEdgeMouseEnter,ce=t.onEdgeMouseMove,ie=t.onEdgeMouseLeave,ge=t.edgeUpdaterRadius,Re=t.onEdgeUpdateStart,ze=t.onEdgeUpdateEnd,me=t.noDragClassName,xe=t.noWheelClassName,Ce=t.noPanClassName,Ae=t.elevateEdgesOnSelect,Ve=t.id;return v2(u),ve.createElement(JO,{onPaneClick:Z,onPaneContextMenu:X,onPaneScroll:K,deleteKeyCode:D,selectionKeyCode:C,multiSelectionKeyCode:M,zoomActivationKeyCode:z,elementsSelectable:T,onMove:r,onMoveStart:i,onMoveEnd:l,zoomOnScroll:U,zoomOnPinch:V,zoomOnDoubleClick:J,panOnScroll:H,panOnScrollSpeed:G,panOnScrollMode:W,panOnDrag:ee,translateExtent:O,minZoom:R,maxZoom:L,defaultZoom:F,defaultPosition:B,onSelectionContextMenu:b,preventScrolling:q,noDragClassName:me,noWheelClassName:xe,noPanClassName:Ce},ve.createElement(y2,null,ve.createElement(g2,{edgeTypes:s,onEdgeClick:f,onEdgeDoubleClick:h,connectionLineType:w,connectionLineStyle:E,connectionLineComponent:N,connectionLineContainerStyle:j,onEdgeUpdate:Q,onlyRenderVisibleElements:k,onEdgeContextMenu:ne,onEdgeMouseEnter:le,onEdgeMouseMove:ce,onEdgeMouseLeave:ie,onEdgeUpdateStart:Re,onEdgeUpdateEnd:ze,edgeUpdaterRadius:ge,defaultMarkerColor:I,noPanClassName:Ce,elevateEdgesOnSelect:!!Ae,rfId:Ve}),ve.createElement(n2,{nodeTypes:n,onNodeClick:d,onNodeDoubleClick:p,onNodeMouseEnter:m,onNodeMouseMove:_,onNodeMouseLeave:v,onNodeContextMenu:y,selectNodesOnDrag:A,onlyRenderVisibleElements:k,noPanClassName:Ce,noDragClassName:me})))};Vx.displayName="GraphView";var x2=x.memo(Vx),Kx=function(){return null};Kx.displayName="GroupNode";function Yx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Wx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Ec=function(e){var t=function(s){var r=s.id,i=s.type,l=s.data,u=s.xPos,d=s.yPos,f=s.selected,p=s.onClick,h=s.onMouseEnter,m=s.onMouseMove,_=s.onMouseLeave,v=s.onContextMenu,y=s.onDoubleClick,b=s.style,w=s.className,E=s.isDraggable,N=s.isSelectable,j=s.isConnectable,C=s.selectNodesOnDrag,M=s.sourcePosition,z=s.targetPosition,D=s.hidden,k=s.resizeObserver,T=s.dragHandle,A=s.zIndex,O=s.isParent,R=s.noPanClassName,L=s.noDragClassName,F=s.initialized,B=_s(),q=x.useRef(null),I=x.useRef(M),U=x.useRef(z),V=x.useRef(i),H=N||E||p||h||m||_,G=wc(r,B.getState,h),W=wc(r,B.getState,m),J=wc(r,B.getState,_),ee=wc(r,B.getState,v),Z=wc(r,B.getState,y),K=function(ne){if(N&&(!C||!E)&&$v({id:r,store:B}),p){var le=B.getState().nodeInternals.get(r);p(ne,Wx({},le))}};x.useEffect(function(){if(q.current&&!D){var Q=q.current;return k==null||k.observe(Q),function(){return k==null?void 0:k.unobserve(Q)}}},[D]),x.useEffect(function(){var Q=V.current!==i,ne=I.current!==M,le=U.current!==z;q.current&&(Q||ne||le)&&(Q&&(V.current=i),ne&&(I.current=M),le&&(U.current=z),B.getState().updateNodeDimensions([{id:r,nodeElement:q.current,forceUpdate:!0}]))},[r,i,M,z]);var X=zx({nodeRef:q,disabled:D||!E,noDragClassName:L,handleSelector:T,nodeId:r,isSelectable:N,selectNodesOnDrag:C});return D?null:ve.createElement("div",{className:Vt(["react-flow__node","react-flow__node-".concat(i),R,w,{selected:f,selectable:N,parent:O}]),ref:q,style:Wx({zIndex:A,transform:"translate(".concat(u,"px,").concat(d,"px)"),pointerEvents:H?"all":"none",visibility:F?"visible":"hidden"},b),onMouseEnter:G,onMouseMove:W,onMouseLeave:J,onContextMenu:ee,onClick:K,onDoubleClick:Z,"data-testid":"rf__node-".concat(r),"data-id":r},ve.createElement(_O,{value:r},ve.createElement(e,{id:r,data:l,type:i,xPos:u,yPos:d,selected:f,isConnectable:j,sourcePosition:M,targetPosition:z,dragging:X,dragHandle:T,zIndex:A})))};return t.displayName="NodeWrapper",x.memo(t)};function Gx(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function Xx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Gx(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gx(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function b2(e){var t={input:Ec(e.input||px),default:Ec(e.default||Bf),output:Ec(e.output||_x),group:Ec(e.group||Kx)},n={},s=Object.keys(e).filter(function(r){return!["input","default","output","group"].includes(r)}).reduce(function(r,i){return r[i]=Ec(e[i]||Bf),r},n);return Xx(Xx({},t),s)}function Qx(e,t){x.useRef(null);var n=x.useMemo(function(){return t(e)},[e]);return n}function Zx(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var Jx=function(t){var n=t.children,s=!0;try{_s()}catch{s=!1}return s?ve.createElement(ve.Fragment,null,n):ve.createElement(Vv,{createStore:Kv},n)};Jx.displayName="ReactFlowWrapper";var w2=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function e0(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,s)}return n}function t0(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?e0(Object(n),!0).forEach(function(s){Ht(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e0(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}Zx(kO),Zx(AO);var N2={input:px,default:Bf,output:_x},j2={default:Rf,straight:lx,step:ix,smoothstep:zf,simplebezier:tx},S2=[15,15],E2=[0,0],n0=x.forwardRef(function(e,t){var n=e.nodes,s=e.edges,r=e.defaultNodes,i=e.defaultEdges,l=e.className,u=e.nodeTypes,d=u===void 0?N2:u,f=e.edgeTypes,p=f===void 0?j2:f,h=e.onNodeClick,m=e.onEdgeClick,_=e.onInit,v=e.onMove,y=e.onMoveStart,b=e.onMoveEnd,w=e.onConnect,E=e.onConnectStart,N=e.onConnectStop,j=e.onConnectEnd,C=e.onClickConnectStart,M=e.onClickConnectStop,z=e.onClickConnectEnd,D=e.onNodeMouseEnter,k=e.onNodeMouseMove,T=e.onNodeMouseLeave,A=e.onNodeContextMenu,O=e.onNodeDoubleClick,R=e.onNodeDragStart,L=e.onNodeDrag,F=e.onNodeDragStop,B=e.onNodesDelete,q=e.onEdgesDelete,I=e.onSelectionChange,U=e.onSelectionDragStart,V=e.onSelectionDrag,H=e.onSelectionDragStop,G=e.onSelectionContextMenu,W=e.connectionMode,J=W===void 0?Yo.Strict:W,ee=e.connectionLineType,Z=ee===void 0?Ya.Bezier:ee,K=e.connectionLineStyle,X=e.connectionLineComponent,Q=e.connectionLineContainerStyle,ne=e.deleteKeyCode,le=ne===void 0?"Backspace":ne,ce=e.selectionKeyCode,ie=ce===void 0?"Shift":ce,ge=e.multiSelectionKeyCode,Re=ge===void 0?"Meta":ge,ze=e.zoomActivationKeyCode,me=ze===void 0?"Meta":ze,xe=e.snapToGrid,Ce=xe===void 0?!1:xe,Ae=e.snapGrid,Ve=Ae===void 0?S2:Ae,Se=e.onlyRenderVisibleElements,We=Se===void 0?!1:Se,ht=e.selectNodesOnDrag,ye=ht===void 0?!0:ht,Fe=e.nodesDraggable,Qe=e.nodesConnectable,tt=e.elementsSelectable,xt=e.minZoom,_t=xt===void 0?.5:xt,Bt=e.maxZoom,$e=Bt===void 0?2:Bt,Ie=e.defaultZoom,Be=Ie===void 0?1:Ie,Ee=e.defaultPosition,lt=Ee===void 0?E2:Ee,Je=e.translateExtent,Ue=Je===void 0?Nf:Je,Rt=e.preventScrolling,Yt=Rt===void 0?!0:Rt,bt=e.nodeExtent,Ot=e.defaultMarkerColor,Pt=Ot===void 0?"#b1b1b7":Ot,wt=e.zoomOnScroll,pt=wt===void 0?!0:wt,rn=e.zoomOnPinch,Jt=rn===void 0?!0:rn,tn=e.panOnScroll,Pe=tn===void 0?!1:tn,Wt=e.panOnScrollSpeed,mn=Wt===void 0?.5:Wt,Fn=e.panOnScrollMode,Gt=Fn===void 0?el.Free:Fn,jt=e.zoomOnDoubleClick,Bn=jt===void 0?!0:jt,ts=e.panOnDrag,Hn=ts===void 0?!0:ts,Sn=e.onPaneClick,Un=e.onPaneScroll,ns=e.onPaneContextMenu,cn=e.children,Mn=e.onEdgeUpdate,Mt=e.onEdgeContextMenu,An=e.onEdgeDoubleClick,hs=e.onEdgeMouseEnter,Qn=e.onEdgeMouseMove,qs=e.onEdgeMouseLeave,Vs=e.onEdgeUpdateStart,As=e.onEdgeUpdateEnd,en=e.edgeUpdaterRadius,et=en===void 0?10:en,Qt=e.onNodesChange,ss=e.onEdgesChange,Ks=e.noDragClassName,Os=Ks===void 0?"nodrag":Ks,Nt=e.noWheelClassName,vs=Nt===void 0?"nowheel":Nt,de=e.noPanClassName,be=de===void 0?"nopan":de,qe=e.fitView,gt=qe===void 0?!1:qe,Le=e.fitViewOptions,Lt=e.connectOnClick,Tt=Lt===void 0?!0:Lt,an=e.attributionPosition,hn=e.proOptions,Ct=e.defaultEdgeOptions,On=e.elevateEdgesOnSelect,sr=On===void 0?!1:On,Tn=wd(e,w2),qn=Qx(d,b2),Ys=Qx(p,$O);return ve.createElement("div",t0(t0({},Tn),{},{ref:t,className:Vt(["react-flow",l])}),ve.createElement(Jx,null,ve.createElement(x2,{onInit:_,onMove:v,onMoveStart:y,onMoveEnd:b,onNodeClick:h,onEdgeClick:m,onNodeMouseEnter:D,onNodeMouseMove:k,onNodeMouseLeave:T,onNodeContextMenu:A,onNodeDoubleClick:O,nodeTypes:qn,edgeTypes:Ys,connectionLineType:Z,connectionLineStyle:K,connectionLineComponent:X,connectionLineContainerStyle:Q,selectionKeyCode:ie,deleteKeyCode:le,multiSelectionKeyCode:Re,zoomActivationKeyCode:me,onlyRenderVisibleElements:We,selectNodesOnDrag:ye,translateExtent:Ue,minZoom:_t,maxZoom:$e,defaultZoom:Be,defaultPosition:lt,preventScrolling:Yt,zoomOnScroll:pt,zoomOnPinch:Jt,zoomOnDoubleClick:Bn,panOnScroll:Pe,panOnScrollSpeed:mn,panOnScrollMode:Gt,panOnDrag:Hn,onPaneClick:Sn,onPaneScroll:Un,onPaneContextMenu:ns,onSelectionContextMenu:G,onEdgeUpdate:Mn,onEdgeContextMenu:Mt,onEdgeDoubleClick:An,onEdgeMouseEnter:hs,onEdgeMouseMove:Qn,onEdgeMouseLeave:qs,onEdgeUpdateStart:Vs,onEdgeUpdateEnd:As,edgeUpdaterRadius:et,defaultMarkerColor:Pt,noDragClassName:Os,noWheelClassName:vs,noPanClassName:be,elevateEdgesOnSelect:sr,id:Tn==null?void 0:Tn.id}),ve.createElement(EO,{nodes:n,edges:s,defaultNodes:r,defaultEdges:i,onConnect:w,onConnectStart:E,onConnectStop:N,onConnectEnd:j,onClickConnectStart:C,onClickConnectStop:M,onClickConnectEnd:z,nodesDraggable:Fe,nodesConnectable:Qe,elementsSelectable:tt,minZoom:_t,maxZoom:$e,nodeExtent:bt,onNodesChange:Qt,onEdgesChange:ss,snapToGrid:Ce,snapGrid:Ve,connectionMode:J,translateExtent:Ue,connectOnClick:Tt,defaultEdgeOptions:Ct,fitView:gt,fitViewOptions:Le,onNodesDelete:B,onEdgesDelete:q,onNodeDragStart:R,onNodeDrag:L,onNodeDragStop:F,onSelectionDrag:V,onSelectionDragStart:U,onSelectionDragStop:H}),I&&ve.createElement(jO,{onSelectionChange:I}),cn,ve.createElement(cO,{proOptions:hn,position:an})))});n0.displayName="ReactFlow";var s0=function(t){var n=t.children;return ve.createElement(Vv,{createStore:Kv},n)};s0.displayName="ReactFlowProvider";function r0(e){return function(t){var n=x.useState(t),s=$t(n,2),r=s[0],i=s[1],l=x.useCallback(function(u){return i(function(d){return e(u,d)})},[]);return[r,i,l]}}var C2=r0(Mv),k2=r0($A);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),A2=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,s)=>s?s.toUpperCase():n.toLowerCase()),a0=e=>{const t=A2(e);return t.charAt(0).toUpperCase()+t.slice(1)},o0=(...e)=>e.filter((t,n,s)=>!!t&&t.trim()!==""&&s.indexOf(t)===n).join(" ").trim(),O2=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var T2={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $2=x.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:l,...u},d)=>x.createElement("svg",{ref:d,...T2,width:t,height:t,stroke:e,strokeWidth:s?Number(n)*24/Number(t):n,className:o0("lucide",r),...!i&&!O2(u)&&{"aria-hidden":"true"},...u},[...l.map(([f,p])=>x.createElement(f,p)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=(e,t)=>{const n=x.forwardRef(({className:s,...r},i)=>x.createElement($2,{ref:i,iconNode:t,className:o0(`lucide-${M2(a0(e))}`,`lucide-${e}`,s),...r}));return n.displayName=a0(e),n};/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kf=kn("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=kn("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wf=kn("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=kn("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z2=kn("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=kn("cpu",[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=kn("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=kn("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=kn("layers",[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=kn("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=kn("minimize-2",[["path",{d:"m14 10 7-7",key:"oa77jy"}],["path",{d:"M20 10h-6V4",key:"mjg0md"}],["path",{d:"m3 21 7-7",key:"tjx5ai"}],["path",{d:"M4 14h6v6",key:"rmj7iw"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=kn("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=kn("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H2=kn("rotate-cw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=kn("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U2=kn("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q2=kn("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=kn("sliders-horizontal",[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cc=kn("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=kn("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.555.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const il=kn("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Yr={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:s})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:s}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},kc=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],l0=["Enter"," ","Escape"],c0={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var ll;(function(e){e.Strict="strict",e.Loose="loose"})(ll||(ll={}));var Xo;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Xo||(Xo={}));var Mc;(function(e){e.Partial="partial",e.Full="full"})(Mc||(Mc={}));const u0={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null,pointer:null};var Xa;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Xa||(Xa={}));var Td;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Td||(Td={}));var it;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(it||(it={}));const d0={[it.Left]:it.Right,[it.Right]:it.Left,[it.Top]:it.Bottom,[it.Bottom]:it.Top};function m0(e){return e===null?null:e?"valid":"invalid"}const h0=e=>"id"in e&&"source"in e&&"target"in e,K2=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),Qf=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Ac=(e,t=[0,0])=>{const{width:n,height:s}=_a(e),r=e.origin??t,i=n*r[0],l=s*r[1];return{x:e.position.x-i,y:e.position.y-l}},Y2=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((s,r)=>{const i=typeof r=="string";let l=!t.nodeLookup&&!i?r:void 0;t.nodeLookup&&(l=i?t.nodeLookup.get(r):Qf(r)?r:t.nodeLookup.get(r.id));const u=l?zd(l,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return $d(s,u)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Ld(n)},Oc=(e,t={})=>{let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0},s=!1;return e.forEach(r=>{(t.filter===void 0||t.filter(r))&&(n=$d(n,zd(r)),s=!0)}),s?Ld(n):{x:0,y:0,width:0,height:0}},Zf=(e,t,[n,s,r]=[0,0,1],i=!1,l=!1)=>{const u={...Lc(t,[n,s,r]),width:t.width/r,height:t.height/r},d=[];for(const f of e.values()){const{measured:p,selectable:h=!0,hidden:m=!1}=f;if(l&&!h||m)continue;const _=p.width??f.width??f.initialWidth??null,v=p.height??f.height??f.initialHeight??null,y=Tc(u,ul(f)),b=(_??0)*(v??0),w=i&&y>0;(!f.internals.handleBounds||w||y>=b||f.dragging)&&d.push(f)}return d},W2=(e,t)=>{const n=new Set;return e.forEach(s=>{n.add(s.id)}),t.filter(s=>n.has(s.source)||n.has(s.target))};function G2(e,t){const n=new Map,s=t!=null&&t.nodes?new Set(t.nodes.map(r=>r.id)):null;return e.forEach(r=>{r.measured.width&&r.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!r.hidden)&&(!s||s.has(r.id))&&n.set(r.id,r)}),n}async function X2({nodes:e,width:t,height:n,panZoom:s,minZoom:r,maxZoom:i},l){if(e.size===0)return Promise.resolve(!0);const u=G2(e,l),d=Oc(u),f=ep(d,t,n,(l==null?void 0:l.minZoom)??r,(l==null?void 0:l.maxZoom)??i,(l==null?void 0:l.padding)??.1);return await s.setViewport(f,{duration:l==null?void 0:l.duration,ease:l==null?void 0:l.ease,interpolate:l==null?void 0:l.interpolate}),Promise.resolve(!0)}function f0({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:s=[0,0],nodeExtent:r,onError:i}){const l=n.get(e),u=l.parentId?n.get(l.parentId):void 0,{x:d,y:f}=u?u.internals.positionAbsolute:{x:0,y:0},p=l.origin??s;let h=l.extent||r;if(l.extent==="parent"&&!l.expandParent)if(!u)i==null||i("005",Yr.error005());else{const _=u.measured.width,v=u.measured.height;_&&v&&(h=[[d,f],[d+_,f+v]])}else u&&ml(l.extent)&&(h=[[l.extent[0][0]+d,l.extent[0][1]+f],[l.extent[1][0]+d,l.extent[1][1]+f]]);const m=ml(h)?Qo(t,h,l.measured):t;return(l.measured.width===void 0||l.measured.height===void 0)&&(i==null||i("015",Yr.error015())),{position:{x:m.x-d+(l.measured.width??0)*p[0],y:m.y-f+(l.measured.height??0)*p[1]},positionAbsolute:m}}async function Q2({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:s,onBeforeDelete:r}){const i=new Set(e.map(m=>m.id)),l=[];for(const m of n){if(m.deletable===!1)continue;const _=i.has(m.id),v=!_&&m.parentId&&l.find(y=>y.id===m.parentId);(_||v)&&l.push(m)}const u=new Set(t.map(m=>m.id)),d=s.filter(m=>m.deletable!==!1),p=W2(l,d);for(const m of d)u.has(m.id)&&!p.find(v=>v.id===m.id)&&p.push(m);if(!r)return{edges:p,nodes:l};const h=await r({nodes:l,edges:p});return typeof h=="boolean"?h?{edges:p,nodes:l}:{edges:[],nodes:[]}:h}const cl=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Qo=(e={x:0,y:0},t,n)=>({x:cl(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:cl(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function p0(e,t,n){const{width:s,height:r}=_a(n),{x:i,y:l}=n.internals.positionAbsolute;return Qo(e,[[i,l],[i+s,l+r]],t)}const g0=(e,t,n)=>e<t?cl(Math.abs(e-t),1,t)/t:e>n?-cl(Math.abs(e-n),1,t)/t:0,_0=(e,t,n=15,s=40)=>{const r=g0(e.x,s,t.width-s)*n,i=g0(e.y,s,t.height-s)*n;return[r,i]},$d=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Jf=({x:e,y:t,width:n,height:s})=>({x:e,y:t,x2:e+n,y2:t+s}),Ld=({x:e,y:t,x2:n,y2:s})=>({x:e,y:t,width:n-e,height:s-t}),ul=(e,t=[0,0])=>{var r,i;const{x:n,y:s}=Qf(e)?e.internals.positionAbsolute:Ac(e,t);return{x:n,y:s,width:((r=e.measured)==null?void 0:r.width)??e.width??e.initialWidth??0,height:((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0}},zd=(e,t=[0,0])=>{var r,i;const{x:n,y:s}=Qf(e)?e.internals.positionAbsolute:Ac(e,t);return{x:n,y:s,x2:n+(((r=e.measured)==null?void 0:r.width)??e.width??e.initialWidth??0),y2:s+(((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0)}},y0=(e,t)=>Ld($d(Jf(e),Jf(t))),Tc=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),s=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*s)},v0=e=>Cr(e.width)&&Cr(e.height)&&Cr(e.x)&&Cr(e.y),Cr=e=>!isNaN(e)&&isFinite(e),Z2=(e,t)=>{},$c=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Lc=({x:e,y:t},[n,s,r],i=!1,l=[1,1])=>{const u={x:(e-n)/r,y:(t-s)/r};return i?$c(u,l):u},Rd=({x:e,y:t},[n,s,r])=>({x:e*r+n,y:t*r+s});function dl(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function J2(e,t,n){if(typeof e=="string"||typeof e=="number"){const s=dl(e,n),r=dl(e,t);return{top:s,right:r,bottom:s,left:r,x:r*2,y:s*2}}if(typeof e=="object"){const s=dl(e.top??e.y??0,n),r=dl(e.bottom??e.y??0,n),i=dl(e.left??e.x??0,t),l=dl(e.right??e.x??0,t);return{top:s,right:l,bottom:r,left:i,x:i+l,y:s+r}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function eT(e,t,n,s,r,i){const{x:l,y:u}=Rd(e,[t,n,s]),{x:d,y:f}=Rd({x:e.x+e.width,y:e.y+e.height},[t,n,s]),p=r-d,h=i-f;return{left:Math.floor(l),top:Math.floor(u),right:Math.floor(p),bottom:Math.floor(h)}}const ep=(e,t,n,s,r,i)=>{const l=J2(i,t,n),u=(t-l.x)/e.width,d=(n-l.y)/e.height,f=Math.min(u,d),p=cl(f,s,r),h=e.x+e.width/2,m=e.y+e.height/2,_=t/2-h*p,v=n/2-m*p,y=eT(e,_,v,p,t,n),b={left:Math.min(y.left-l.left,0),top:Math.min(y.top-l.top,0),right:Math.min(y.right-l.right,0),bottom:Math.min(y.bottom-l.bottom,0)};return{x:_-b.left+b.right,y:v-b.top+b.bottom,zoom:p}},zc=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function ml(e){return e!=null&&e!=="parent"}function _a(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function x0(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function b0(e,t={width:0,height:0},n,s,r){const i={...e},l=s.get(n);if(l){const u=l.origin||r;i.x+=l.internals.positionAbsolute.x-(t.width??0)*u[0],i.y+=l.internals.positionAbsolute.y-(t.height??0)*u[1]}return i}function w0(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function tT(){let e,t;return{promise:new Promise((s,r)=>{e=s,t=r}),resolve:e,reject:t}}function nT(e){return{...c0,...e||{}}}function Rc(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:s,containerBounds:r}){const{x:i,y:l}=kr(e),u=Lc({x:i-((r==null?void 0:r.left)??0),y:l-((r==null?void 0:r.top)??0)},s),{x:d,y:f}=n?$c(u,t):u;return{xSnapped:d,ySnapped:f,...u}}const tp=e=>({width:e.offsetWidth,height:e.offsetHeight}),N0=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},sT=["INPUT","SELECT","TEXTAREA"];function j0(e){var s,r;const t=((r=(s=e.composedPath)==null?void 0:s.call(e))==null?void 0:r[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:sT.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const S0=e=>"clientX"in e,kr=(e,t)=>{var i,l;const n=S0(e),s=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,r=n?e.clientY:(l=e.touches)==null?void 0:l[0].clientY;return{x:s-((t==null?void 0:t.left)??0),y:r-((t==null?void 0:t.top)??0)}},E0=(e,t,n,s,r)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(l=>{const u=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),type:e,nodeId:r,position:l.getAttribute("data-handlepos"),x:(u.left-n.left)/s,y:(u.top-n.top)/s,...tp(l)}})};function C0({sourceX:e,sourceY:t,targetX:n,targetY:s,sourceControlX:r,sourceControlY:i,targetControlX:l,targetControlY:u}){const d=e*.125+r*.375+l*.375+n*.125,f=t*.125+i*.375+u*.375+s*.125,p=Math.abs(d-e),h=Math.abs(f-t);return[d,f,p,h]}function Dd(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function k0({pos:e,x1:t,y1:n,x2:s,y2:r,c:i}){switch(e){case it.Left:return[t-Dd(t-s,i),n];case it.Right:return[t+Dd(s-t,i),n];case it.Top:return[t,n-Dd(n-r,i)];case it.Bottom:return[t,n+Dd(r-n,i)]}}function M0({sourceX:e,sourceY:t,sourcePosition:n=it.Bottom,targetX:s,targetY:r,targetPosition:i=it.Top,curvature:l=.25}){const[u,d]=k0({pos:n,x1:e,y1:t,x2:s,y2:r,c:l}),[f,p]=k0({pos:i,x1:s,y1:r,x2:e,y2:t,c:l}),[h,m,_,v]=C0({sourceX:e,sourceY:t,targetX:s,targetY:r,sourceControlX:u,sourceControlY:d,targetControlX:f,targetControlY:p});return[`M${e},${t} C${u},${d} ${f},${p} ${s},${r}`,h,m,_,v]}function A0({sourceX:e,sourceY:t,targetX:n,targetY:s}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,l=Math.abs(s-t)/2,u=s<t?s+l:s-l;return[i,u,r,l]}function rT({sourceNode:e,targetNode:t,selected:n=!1,zIndex:s,elevateOnSelect:r=!1}){if(s!==void 0)return s;const i=r&&n?1e3:0,l=Math.max(e.parentId||r&&e.selected?e.internals.z:0,t.parentId||r&&t.selected?t.internals.z:0);return i+l}function aT({sourceNode:e,targetNode:t,width:n,height:s,transform:r}){const i=$d(zd(e),zd(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const l={x:-r[0]/r[2],y:-r[1]/r[2],width:n/r[2],height:s/r[2]};return Tc(l,Ld(i))>0}const oT=({source:e,sourceHandle:t,target:n,targetHandle:s})=>`xy-edge__${e}${t||""}-${n}${s||""}`,iT=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),lT=(e,t)=>{if(!e.source||!e.target)return t;let n;return h0(e)?n={...e}:n={...e,id:oT(e)},iT(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function O0({sourceX:e,sourceY:t,targetX:n,targetY:s}){const[r,i,l,u]=A0({sourceX:e,sourceY:t,targetX:n,targetY:s});return[`M ${e},${t}L ${n},${s}`,r,i,l,u]}const T0={[it.Left]:{x:-1,y:0},[it.Right]:{x:1,y:0},[it.Top]:{x:0,y:-1},[it.Bottom]:{x:0,y:1}},cT=({source:e,sourcePosition:t=it.Bottom,target:n})=>t===it.Left||t===it.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},$0=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function uT({source:e,sourcePosition:t=it.Bottom,target:n,targetPosition:s=it.Top,center:r,offset:i,stepPosition:l}){const u=T0[t],d=T0[s],f={x:e.x+u.x*i,y:e.y+u.y*i},p={x:n.x+d.x*i,y:n.y+d.y*i},h=cT({source:f,sourcePosition:t,target:p}),m=h.x!==0?"x":"y",_=h[m];let v=[],y,b;const w={x:0,y:0},E={x:0,y:0},[,,N,j]=A0({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(u[m]*d[m]===-1){m==="x"?(y=r.x??f.x+(p.x-f.x)*l,b=r.y??(f.y+p.y)/2):(y=r.x??(f.x+p.x)/2,b=r.y??f.y+(p.y-f.y)*l);const M=[{x:y,y:f.y},{x:y,y:p.y}],z=[{x:f.x,y:b},{x:p.x,y:b}];u[m]===_?v=m==="x"?M:z:v=m==="x"?z:M}else{const M=[{x:f.x,y:p.y}],z=[{x:p.x,y:f.y}];if(m==="x"?v=u.x===_?z:M:v=u.y===_?M:z,t===s){const O=Math.abs(e[m]-n[m]);if(O<=i){const R=Math.min(i-1,i-O);u[m]===_?w[m]=(f[m]>e[m]?-1:1)*R:E[m]=(p[m]>n[m]?-1:1)*R}}if(t!==s){const O=m==="x"?"y":"x",R=u[m]===d[O],L=f[O]>p[O],F=f[O]<p[O];(u[m]===1&&(!R&&L||R&&F)||u[m]!==1&&(!R&&F||R&&L))&&(v=m==="x"?M:z)}const D={x:f.x+w.x,y:f.y+w.y},k={x:p.x+E.x,y:p.y+E.y},T=Math.max(Math.abs(D.x-v[0].x),Math.abs(k.x-v[0].x)),A=Math.max(Math.abs(D.y-v[0].y),Math.abs(k.y-v[0].y));T>=A?(y=(D.x+k.x)/2,b=v[0].y):(y=v[0].x,b=(D.y+k.y)/2)}return[[e,{x:f.x+w.x,y:f.y+w.y},...v,{x:p.x+E.x,y:p.y+E.y},n],y,b,N,j]}function dT(e,t,n,s){const r=Math.min($0(e,t)/2,$0(t,n)/2,s),{x:i,y:l}=t;if(e.x===i&&i===n.x||e.y===l&&l===n.y)return`L${i} ${l}`;if(e.y===l){const f=e.x<n.x?-1:1,p=e.y<n.y?1:-1;return`L ${i+r*f},${l}Q ${i},${l} ${i},${l+r*p}`}const u=e.x<n.x?1:-1,d=e.y<n.y?-1:1;return`L ${i},${l+r*d}Q ${i},${l} ${i+r*u},${l}`}function np({sourceX:e,sourceY:t,sourcePosition:n=it.Bottom,targetX:s,targetY:r,targetPosition:i=it.Top,borderRadius:l=5,centerX:u,centerY:d,offset:f=20,stepPosition:p=.5}){const[h,m,_,v,y]=uT({source:{x:e,y:t},sourcePosition:n,target:{x:s,y:r},targetPosition:i,center:{x:u,y:d},offset:f,stepPosition:p});return[h.reduce((w,E,N)=>{let j="";return N>0&&N<h.length-1?j=dT(h[N-1],E,h[N+1],l):j=`${N===0?"M":"L"}${E.x} ${E.y}`,w+=j,w},""),m,_,v,y]}function L0(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function mT(e){var h;const{sourceNode:t,targetNode:n}=e;if(!L0(t)||!L0(n))return null;const s=t.internals.handleBounds||z0(t.handles),r=n.internals.handleBounds||z0(n.handles),i=R0((s==null?void 0:s.source)??[],e.sourceHandle),l=R0(e.connectionMode===ll.Strict?(r==null?void 0:r.target)??[]:((r==null?void 0:r.target)??[]).concat((r==null?void 0:r.source)??[]),e.targetHandle);if(!i||!l)return(h=e.onError)==null||h.call(e,"008",Yr.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const u=(i==null?void 0:i.position)||it.Bottom,d=(l==null?void 0:l.position)||it.Top,f=Dc(t,i,u),p=Dc(n,l,d);return{sourceX:f.x,sourceY:f.y,targetX:p.x,targetY:p.y,sourcePosition:u,targetPosition:d}}function z0(e){if(!e)return null;const t=[],n=[];for(const s of e)s.width=s.width??1,s.height=s.height??1,s.type==="source"?t.push(s):s.type==="target"&&n.push(s);return{source:t,target:n}}function Dc(e,t,n=it.Left,s=!1){const r=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,i=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:l,height:u}=t??_a(e);if(s)return{x:r+l/2,y:i+u/2};switch((t==null?void 0:t.position)??n){case it.Top:return{x:r+l/2,y:i};case it.Right:return{x:r+l,y:i+u/2};case it.Bottom:return{x:r+l/2,y:i+u};case it.Left:return{x:r,y:i+u/2}}}function R0(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function sp(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(s=>`${s}=${e[s]}`).join("&")}`:""}function hT(e,{id:t,defaultColor:n,defaultMarkerStart:s,defaultMarkerEnd:r}){const i=new Set;return e.reduce((l,u)=>([u.markerStart||s,u.markerEnd||r].forEach(d=>{if(d&&typeof d=="object"){const f=sp(d,t);i.has(f)||(l.push({id:f,color:d.color||n,...d}),i.add(f))}}),l),[]).sort((l,u)=>l.id.localeCompare(u.id))}const D0=1e3,fT=10,rp={nodeOrigin:[0,0],nodeExtent:kc,elevateNodesOnSelect:!0,defaults:{}},pT={...rp,checkEquality:!0};function ap(e,t){const n={...e};for(const s in t)t[s]!==void 0&&(n[s]=t[s]);return n}function gT(e,t,n){const s=ap(rp,n);for(const r of e.values())if(r.parentId)ip(r,e,t,s);else{const i=Ac(r,s.nodeOrigin),l=ml(r.extent)?r.extent:s.nodeExtent,u=Qo(i,l,_a(r));r.internals.positionAbsolute=u}}function _T(e,t){if(!e.handles)return e.measured?t==null?void 0:t.internals.handleBounds:void 0;const n=[],s=[];for(const r of e.handles){const i={id:r.id,width:r.width??1,height:r.height??1,nodeId:e.id,x:r.x,y:r.y,position:r.position,type:r.type};r.type==="source"?n.push(i):r.type==="target"&&s.push(i)}return{source:n,target:s}}function op(e,t,n,s){var f,p;const r=ap(pT,s);let i={i:-1},l=e.length>0;const u=new Map(t),d=r!=null&&r.elevateNodesOnSelect?D0:0;t.clear(),n.clear();for(const h of e){let m=u.get(h.id);if(r.checkEquality&&h===(m==null?void 0:m.internals.userNode))t.set(h.id,m);else{const _=Ac(h,r.nodeOrigin),v=ml(h.extent)?h.extent:r.nodeExtent,y=Qo(_,v,_a(h));m={...r.defaults,...h,measured:{width:(f=h.measured)==null?void 0:f.width,height:(p=h.measured)==null?void 0:p.height},internals:{positionAbsolute:y,handleBounds:_T(h,m),z:P0(h,d),userNode:h}},t.set(h.id,m)}(m.measured===void 0||m.measured.width===void 0||m.measured.height===void 0)&&!m.hidden&&(l=!1),h.parentId&&ip(m,t,n,s,i)}return l}function yT(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function ip(e,t,n,s,r){const{elevateNodesOnSelect:i,nodeOrigin:l,nodeExtent:u}=ap(rp,s),d=e.parentId,f=t.get(d);if(!f){console.warn(`Parent node ${d} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}yT(e,n),r&&!f.parentId&&f.internals.rootParentIndex===void 0&&(f.internals.rootParentIndex=++r.i,f.internals.z=f.internals.z+r.i*fT),r&&f.internals.rootParentIndex!==void 0&&(r.i=f.internals.rootParentIndex);const p=i?D0:0,{x:h,y:m,z:_}=vT(e,f,l,u,p),{positionAbsolute:v}=e.internals,y=h!==v.x||m!==v.y;(y||_!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:y?{x:h,y:m}:v,z:_}})}function P0(e,t){return(Cr(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function vT(e,t,n,s,r){const{x:i,y:l}=t.internals.positionAbsolute,u=_a(e),d=Ac(e,n),f=ml(e.extent)?Qo(d,e.extent,u):d;let p=Qo({x:i+f.x,y:l+f.y},s,u);e.extent==="parent"&&(p=p0(p,u,t));const h=P0(e,r),m=t.internals.z??0;return{x:p.x,y:p.y,z:m>=h?m+1:h}}function lp(e,t,n,s=[0,0]){var l;const r=[],i=new Map;for(const u of e){const d=t.get(u.parentId);if(!d)continue;const f=((l=i.get(u.parentId))==null?void 0:l.expandedRect)??ul(d),p=y0(f,u.rect);i.set(u.parentId,{expandedRect:p,parent:d})}return i.size>0&&i.forEach(({expandedRect:u,parent:d},f)=>{var N;const p=d.internals.positionAbsolute,h=_a(d),m=d.origin??s,_=u.x<p.x?Math.round(Math.abs(p.x-u.x)):0,v=u.y<p.y?Math.round(Math.abs(p.y-u.y)):0,y=Math.max(h.width,Math.round(u.width)),b=Math.max(h.height,Math.round(u.height)),w=(y-h.width)*m[0],E=(b-h.height)*m[1];(_>0||v>0||w||E)&&(r.push({id:f,type:"position",position:{x:d.position.x-_+w,y:d.position.y-v+E}}),(N=n.get(f))==null||N.forEach(j=>{e.some(C=>C.id===j.id)||r.push({id:j.id,type:"position",position:{x:j.position.x+_,y:j.position.y+v}})})),(h.width<u.width||h.height<u.height||_||v)&&r.push({id:f,type:"dimensions",setAttributes:!0,dimensions:{width:y+(_?m[0]*_-w:0),height:b+(v?m[1]*v-E:0)}})}),r}function xT(e,t,n,s,r,i){const l=s==null?void 0:s.querySelector(".xyflow__viewport");let u=!1;if(!l)return{changes:[],updatedInternals:u};const d=[],f=window.getComputedStyle(l),{m22:p}=new window.DOMMatrixReadOnly(f.transform),h=[];for(const m of e.values()){const _=t.get(m.id);if(!_)continue;if(_.hidden){t.set(_.id,{..._,internals:{..._.internals,handleBounds:void 0}}),u=!0;continue}const v=tp(m.nodeElement),y=_.measured.width!==v.width||_.measured.height!==v.height;if(!!(v.width&&v.height&&(y||!_.internals.handleBounds||m.force))){const w=m.nodeElement.getBoundingClientRect(),E=ml(_.extent)?_.extent:i;let{positionAbsolute:N}=_.internals;_.parentId&&_.extent==="parent"?N=p0(N,v,t.get(_.parentId)):E&&(N=Qo(N,E,v));const j={..._,measured:v,internals:{..._.internals,positionAbsolute:N,handleBounds:{source:E0("source",m.nodeElement,w,p,_.id),target:E0("target",m.nodeElement,w,p,_.id)}}};t.set(_.id,j),_.parentId&&ip(j,t,n,{nodeOrigin:r}),u=!0,y&&(d.push({id:_.id,type:"dimensions",dimensions:v}),_.expandParent&&_.parentId&&h.push({id:_.id,parentId:_.parentId,rect:ul(j,r)}))}}if(h.length>0){const m=lp(h,t,n,r);d.push(...m)}return{changes:d,updatedInternals:u}}async function bT({delta:e,panZoom:t,transform:n,translateExtent:s,width:r,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const l=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[r,i]],s),u=!!l&&(l.x!==n[0]||l.y!==n[1]||l.k!==n[2]);return Promise.resolve(u)}function I0(e,t,n,s,r,i){let l=r;const u=s.get(l)||new Map;s.set(l,u.set(n,t)),l=`${r}-${e}`;const d=s.get(l)||new Map;if(s.set(l,d.set(n,t)),i){l=`${r}-${e}-${i}`;const f=s.get(l)||new Map;s.set(l,f.set(n,t))}}function F0(e,t,n){e.clear(),t.clear();for(const s of n){const{source:r,target:i,sourceHandle:l=null,targetHandle:u=null}=s,d={edgeId:s.id,source:r,target:i,sourceHandle:l,targetHandle:u},f=`${r}-${l}--${i}-${u}`,p=`${i}-${u}--${r}-${l}`;I0("source",d,p,e,r,l),I0("target",d,f,e,i,u),t.set(s.id,s)}}function B0(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:B0(n,t):!1}function H0(e,t,n){var r;let s=e;do{if((r=s==null?void 0:s.matches)!=null&&r.call(s,t))return!0;if(s===n)return!1;s=s==null?void 0:s.parentElement}while(s);return!1}function wT(e,t,n,s){const r=new Map;for(const[i,l]of e)if((l.selected||l.id===s)&&(!l.parentId||!B0(l,e))&&(l.draggable||t&&typeof l.draggable>"u")){const u=e.get(i);u&&r.set(i,{id:i,position:u.position||{x:0,y:0},distance:{x:n.x-u.internals.positionAbsolute.x,y:n.y-u.internals.positionAbsolute.y},extent:u.extent,parentId:u.parentId,origin:u.origin,expandParent:u.expandParent,internals:{positionAbsolute:u.internals.positionAbsolute||{x:0,y:0}},measured:{width:u.measured.width??0,height:u.measured.height??0}})}return r}function cp({nodeId:e,dragItems:t,nodeLookup:n,dragging:s=!0}){var l,u,d;const r=[];for(const[f,p]of t){const h=(l=n.get(f))==null?void 0:l.internals.userNode;h&&r.push({...h,position:p.position,dragging:s})}if(!e)return[r[0],r];const i=(u=n.get(e))==null?void 0:u.internals.userNode;return[i?{...i,position:((d=t.get(e))==null?void 0:d.position)||i.position,dragging:s}:r[0],r]}function NT({dragItems:e,snapGrid:t,x:n,y:s}){const r=e.values().next().value;if(!r)return null;const i={x:n-r.distance.x,y:s-r.distance.y},l=$c(i,t);return{x:l.x-i.x,y:l.y-i.y}}function jT({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:s,onDragStop:r}){let i={x:null,y:null},l=0,u=new Map,d=!1,f={x:0,y:0},p=null,h=!1,m=null,_=!1,v=!1,y=null;function b({noDragClassName:E,handleSelector:N,domNode:j,isSelectable:C,nodeId:M,nodeClickDistance:z=0}){m=Cs(j);function D({x:O,y:R}){const{nodeLookup:L,nodeExtent:F,snapGrid:B,snapToGrid:q,nodeOrigin:I,onNodeDrag:U,onSelectionDrag:V,onError:H,updateNodePositions:G}=t();i={x:O,y:R};let W=!1;const J=u.size>1,ee=J&&F?Jf(Oc(u)):null,Z=J&&q?NT({dragItems:u,snapGrid:B,x:O,y:R}):null;for(const[K,X]of u){if(!L.has(K))continue;let Q={x:O-X.distance.x,y:R-X.distance.y};q&&(Q=Z?{x:Math.round(Q.x+Z.x),y:Math.round(Q.y+Z.y)}:$c(Q,B));let ne=null;if(J&&F&&!X.extent&&ee){const{positionAbsolute:ie}=X.internals,ge=ie.x-ee.x+F[0][0],Re=ie.x+X.measured.width-ee.x2+F[1][0],ze=ie.y-ee.y+F[0][1],me=ie.y+X.measured.height-ee.y2+F[1][1];ne=[[ge,ze],[Re,me]]}const{position:le,positionAbsolute:ce}=f0({nodeId:K,nextPosition:Q,nodeLookup:L,nodeExtent:ne||F,nodeOrigin:I,onError:H});W=W||X.position.x!==le.x||X.position.y!==le.y,X.position=le,X.internals.positionAbsolute=ce}if(v=v||W,!!W&&(G(u,!0),y&&(s||U||!M&&V))){const[K,X]=cp({nodeId:M,dragItems:u,nodeLookup:L});s==null||s(y,u,K,X),U==null||U(y,K,X),M||V==null||V(y,X)}}async function k(){if(!p)return;const{transform:O,panBy:R,autoPanSpeed:L,autoPanOnNodeDrag:F}=t();if(!F){d=!1,cancelAnimationFrame(l);return}const[B,q]=_0(f,p,L);(B!==0||q!==0)&&(i.x=(i.x??0)-B/O[2],i.y=(i.y??0)-q/O[2],await R({x:B,y:q})&&D(i)),l=requestAnimationFrame(k)}function T(O){var J;const{nodeLookup:R,multiSelectionActive:L,nodesDraggable:F,transform:B,snapGrid:q,snapToGrid:I,selectNodesOnDrag:U,onNodeDragStart:V,onSelectionDragStart:H,unselectNodesAndEdges:G}=t();h=!0,(!U||!C)&&!L&&M&&((J=R.get(M))!=null&&J.selected||G()),C&&U&&M&&(e==null||e(M));const W=Rc(O.sourceEvent,{transform:B,snapGrid:q,snapToGrid:I,containerBounds:p});if(i=W,u=wT(R,F,W,M),u.size>0&&(n||V||!M&&H)){const[ee,Z]=cp({nodeId:M,dragItems:u,nodeLookup:R});n==null||n(O.sourceEvent,u,ee,Z),V==null||V(O.sourceEvent,ee,Z),M||H==null||H(O.sourceEvent,Z)}}const A=tf().clickDistance(z).on("start",O=>{const{domNode:R,nodeDragThreshold:L,transform:F,snapGrid:B,snapToGrid:q}=t();p=(R==null?void 0:R.getBoundingClientRect())||null,_=!1,v=!1,y=O.sourceEvent,L===0&&T(O),i=Rc(O.sourceEvent,{transform:F,snapGrid:B,snapToGrid:q,containerBounds:p}),f=kr(O.sourceEvent,p)}).on("drag",O=>{const{autoPanOnNodeDrag:R,transform:L,snapGrid:F,snapToGrid:B,nodeDragThreshold:q,nodeLookup:I}=t(),U=Rc(O.sourceEvent,{transform:L,snapGrid:F,snapToGrid:B,containerBounds:p});if(y=O.sourceEvent,(O.sourceEvent.type==="touchmove"&&O.sourceEvent.touches.length>1||M&&!I.has(M))&&(_=!0),!_){if(!d&&R&&h&&(d=!0,k()),!h){const V=kr(O.sourceEvent,p),H=V.x-f.x,G=V.y-f.y;Math.sqrt(H*H+G*G)>q&&T(O)}(i.x!==U.xSnapped||i.y!==U.ySnapped)&&u&&h&&(f=kr(O.sourceEvent,p),D(U))}}).on("end",O=>{if(!(!h||_)&&(d=!1,h=!1,cancelAnimationFrame(l),u.size>0)){const{nodeLookup:R,updateNodePositions:L,onNodeDragStop:F,onSelectionDragStop:B}=t();if(v&&(L(u,!1),v=!1),r||F||!M&&B){const[q,I]=cp({nodeId:M,dragItems:u,nodeLookup:R,dragging:!1});r==null||r(O.sourceEvent,u,q,I),F==null||F(O.sourceEvent,q,I),M||B==null||B(O.sourceEvent,I)}}}).filter(O=>{const R=O.target;return!O.button&&(!E||!H0(R,`.${E}`,j))&&(!N||H0(R,N,j))});m.call(A)}function w(){m==null||m.on(".drag",null)}return{update:b,destroy:w}}function ST(e,t,n){const s=[],r={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())Tc(r,ul(i))>0&&s.push(i);return s}const ET=250;function CT(e,t,n,s){var u,d;let r=[],i=1/0;const l=ST(e,n,t+ET);for(const f of l){const p=[...((u=f.internals.handleBounds)==null?void 0:u.source)??[],...((d=f.internals.handleBounds)==null?void 0:d.target)??[]];for(const h of p){if(s.nodeId===h.nodeId&&s.type===h.type&&s.id===h.id)continue;const{x:m,y:_}=Dc(f,h,h.position,!0),v=Math.sqrt(Math.pow(m-e.x,2)+Math.pow(_-e.y,2));v>t||(v<i?(r=[{...h,x:m,y:_}],i=v):v===i&&r.push({...h,x:m,y:_}))}}if(!r.length)return null;if(r.length>1){const f=s.type==="source"?"target":"source";return r.find(p=>p.type===f)??r[0]}return r[0]}function U0(e,t,n,s,r,i=!1){var f,p,h;const l=s.get(e);if(!l)return null;const u=r==="strict"?(f=l.internals.handleBounds)==null?void 0:f[t]:[...((p=l.internals.handleBounds)==null?void 0:p.source)??[],...((h=l.internals.handleBounds)==null?void 0:h.target)??[]],d=(n?u==null?void 0:u.find(m=>m.id===n):u==null?void 0:u[0])??null;return d&&i?{...d,...Dc(l,d,d.position,!0)}:d}function q0(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function kT(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const V0=()=>!0;function MT(e,{connectionMode:t,connectionRadius:n,handleId:s,nodeId:r,edgeUpdaterType:i,isTarget:l,domNode:u,nodeLookup:d,lib:f,autoPanOnConnect:p,flowId:h,panBy:m,cancelConnection:_,onConnectStart:v,onConnect:y,onConnectEnd:b,isValidConnection:w=V0,onReconnectEnd:E,updateConnection:N,getTransform:j,getFromHandle:C,autoPanSpeed:M,dragThreshold:z=1,handleDomNode:D}){const k=N0(e.target);let T=0,A;const{x:O,y:R}=kr(e),L=q0(i,D),F=u==null?void 0:u.getBoundingClientRect();let B=!1;if(!F||!L)return;const q=U0(r,L,s,d,t);if(!q)return;let I=kr(e,F),U=!1,V=null,H=!1,G=null;function W(){if(!p||!F)return;const[le,ce]=_0(I,F,M);m({x:le,y:ce}),T=requestAnimationFrame(W)}const J={...q,nodeId:r,type:L,position:q.position},ee=d.get(r);let K={inProgress:!0,isValid:null,from:Dc(ee,J,it.Left,!0),fromHandle:J,fromPosition:J.position,fromNode:ee,to:I,toHandle:null,toPosition:d0[J.position],toNode:null,pointer:I};function X(){B=!0,N(K),v==null||v(e,{nodeId:r,handleId:s,handleType:L})}z===0&&X();function Q(le){if(!B){const{x:Re,y:ze}=kr(le),me=Re-O,xe=ze-R;if(!(me*me+xe*xe>z*z))return;X()}if(!C()||!J){ne(le);return}const ce=j();I=kr(le,F),A=CT(Lc(I,ce,!1,[1,1]),n,d,J),U||(W(),U=!0);const ie=K0(le,{handle:A,connectionMode:t,fromNodeId:r,fromHandleId:s,fromType:l?"target":"source",isValidConnection:w,doc:k,lib:f,flowId:h,nodeLookup:d});G=ie.handleDomNode,V=ie.connection,H=kT(!!A,ie.isValid);const ge={...K,isValid:H,to:ie.toHandle&&H?Rd({x:ie.toHandle.x,y:ie.toHandle.y},ce):I,toHandle:ie.toHandle,toPosition:H&&ie.toHandle?ie.toHandle.position:d0[J.position],toNode:ie.toHandle?d.get(ie.toHandle.nodeId):null,pointer:I};N(ge),K=ge}function ne(le){if(!("touches"in le&&le.touches.length>0)){if(B){(A||G)&&V&&H&&(y==null||y(V));const{inProgress:ce,...ie}=K,ge={...ie,toPosition:K.toHandle?K.toPosition:null};b==null||b(le,ge),i&&(E==null||E(le,ge))}_(),cancelAnimationFrame(T),U=!1,H=!1,V=null,G=null,k.removeEventListener("mousemove",Q),k.removeEventListener("mouseup",ne),k.removeEventListener("touchmove",Q),k.removeEventListener("touchend",ne)}}k.addEventListener("mousemove",Q),k.addEventListener("mouseup",ne),k.addEventListener("touchmove",Q),k.addEventListener("touchend",ne)}function K0(e,{handle:t,connectionMode:n,fromNodeId:s,fromHandleId:r,fromType:i,doc:l,lib:u,flowId:d,isValidConnection:f=V0,nodeLookup:p}){const h=i==="target",m=t?l.querySelector(`.${u}-flow__handle[data-id="${d}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:_,y:v}=kr(e),y=l.elementFromPoint(_,v),b=y!=null&&y.classList.contains(`${u}-flow__handle`)?y:m,w={handleDomNode:b,isValid:!1,connection:null,toHandle:null};if(b){const E=q0(void 0,b),N=b.getAttribute("data-nodeid"),j=b.getAttribute("data-handleid"),C=b.classList.contains("connectable"),M=b.classList.contains("connectableend");if(!N||!E)return w;const z={source:h?N:s,sourceHandle:h?j:r,target:h?s:N,targetHandle:h?r:j};w.connection=z;const k=C&&M&&(n===ll.Strict?h&&E==="source"||!h&&E==="target":N!==s||j!==r);w.isValid=k&&f(z),w.toHandle=U0(N,E,j,p,n,!0)}return w}const up={onPointerDown:MT,isValid:K0};function AT({domNode:e,panZoom:t,getTransform:n,getViewScale:s}){const r=Cs(e);function i({translateExtent:u,width:d,height:f,zoomStep:p=1,pannable:h=!0,zoomable:m=!0,inversePan:_=!1}){const v=N=>{if(N.sourceEvent.type!=="wheel"||!t)return;const j=n(),C=N.sourceEvent.ctrlKey&&zc()?10:1,M=-N.sourceEvent.deltaY*(N.sourceEvent.deltaMode===1?.05:N.sourceEvent.deltaMode?1:.002)*p,z=j[2]*Math.pow(2,M*C);t.scaleTo(z)};let y=[0,0];const b=N=>{(N.sourceEvent.type==="mousedown"||N.sourceEvent.type==="touchstart")&&(y=[N.sourceEvent.clientX??N.sourceEvent.touches[0].clientX,N.sourceEvent.clientY??N.sourceEvent.touches[0].clientY])},w=N=>{const j=n();if(N.sourceEvent.type!=="mousemove"&&N.sourceEvent.type!=="touchmove"||!t)return;const C=[N.sourceEvent.clientX??N.sourceEvent.touches[0].clientX,N.sourceEvent.clientY??N.sourceEvent.touches[0].clientY],M=[C[0]-y[0],C[1]-y[1]];y=C;const z=s()*Math.max(j[2],Math.log(j[2]))*(_?-1:1),D={x:j[0]-M[0]*z,y:j[1]-M[1]*z},k=[[0,0],[d,f]];t.setViewportConstrained({x:D.x,y:D.y,zoom:j[2]},k,u)},E=_f().on("start",b).on("zoom",h?w:null).on("zoom.wheel",m?v:null);r.call(E,{})}function l(){r.on("zoom",null)}return{update:i,destroy:l,pointer:hr}}const Pd=e=>({x:e.x,y:e.y,zoom:e.k}),dp=({x:e,y:t,zoom:n})=>pa.translate(e,t).scale(n),hl=(e,t)=>e.target.closest(`.${t}`),Y0=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),OT=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,mp=(e,t=0,n=OT,s=()=>{})=>{const r=typeof t=="number"&&t>0;return r||s(),r?e.transition().duration(t).ease(n).on("end",s):e},W0=e=>{const t=e.ctrlKey&&zc()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function TT({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:s,panOnScrollMode:r,panOnScrollSpeed:i,zoomOnPinch:l,onPanZoomStart:u,onPanZoom:d,onPanZoomEnd:f}){return p=>{if(hl(p,t))return p.ctrlKey&&p.preventDefault(),!1;p.preventDefault(),p.stopImmediatePropagation();const h=n.property("__zoom").k||1;if(p.ctrlKey&&l){const b=hr(p),w=W0(p),E=h*Math.pow(2,w);s.scaleTo(n,E,b,p);return}const m=p.deltaMode===1?20:1;let _=r===Xo.Vertical?0:p.deltaX*m,v=r===Xo.Horizontal?0:p.deltaY*m;!zc()&&p.shiftKey&&r!==Xo.Vertical&&(_=p.deltaY*m,v=0),s.translateBy(n,-(_/h)*i,-(v/h)*i,{internal:!0});const y=Pd(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling?(d==null||d(p,y),e.panScrollTimeout=setTimeout(()=>{f==null||f(p,y),e.isPanScrolling=!1},150)):(e.isPanScrolling=!0,u==null||u(p,y))}}function $T({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(s,r){const i=s.type==="wheel",l=!t&&i&&!s.ctrlKey,u=hl(s,e);if(s.ctrlKey&&i&&u&&s.preventDefault(),l||u)return null;s.preventDefault(),n.call(this,s,r)}}function LT({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return s=>{var i,l,u;if((i=s.sourceEvent)!=null&&i.internal)return;const r=Pd(s.transform);e.mouseButton=((l=s.sourceEvent)==null?void 0:l.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=r,((u=s.sourceEvent)==null?void 0:u.type)==="mousedown"&&t(!0),n&&(n==null||n(s.sourceEvent,r))}}function zT({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:s,onPanZoom:r}){return i=>{var l,u;e.usedRightMouseButton=!!(n&&Y0(t,e.mouseButton??0)),(l=i.sourceEvent)!=null&&l.sync||s([i.transform.x,i.transform.y,i.transform.k]),r&&!((u=i.sourceEvent)!=null&&u.internal)&&(r==null||r(i.sourceEvent,Pd(i.transform)))}}function RT({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:s,onPanZoomEnd:r,onPaneContextMenu:i}){return l=>{var u;if(!((u=l.sourceEvent)!=null&&u.internal)&&(e.isZoomingOrPanning=!1,i&&Y0(t,e.mouseButton??0)&&!e.usedRightMouseButton&&l.sourceEvent&&i(l.sourceEvent),e.usedRightMouseButton=!1,s(!1),r)){const d=Pd(l.transform);e.prevViewport=d,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{r==null||r(l.sourceEvent,d)},n?150:0)}}}function DT({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:s,panOnScroll:r,zoomOnDoubleClick:i,userSelectionActive:l,noWheelClassName:u,noPanClassName:d,lib:f,connectionInProgress:p}){return h=>{var b;const m=e||t,_=n&&h.ctrlKey,v=h.type==="wheel";if(h.button===1&&h.type==="mousedown"&&(hl(h,`${f}-flow__node`)||hl(h,`${f}-flow__edge`)))return!0;if(!s&&!m&&!r&&!i&&!n||l||p&&!v||hl(h,u)&&v||hl(h,d)&&(!v||r&&v&&!e)||!n&&h.ctrlKey&&v)return!1;if(!n&&h.type==="touchstart"&&((b=h.touches)==null?void 0:b.length)>1)return h.preventDefault(),!1;if(!m&&!r&&!_&&v||!s&&(h.type==="mousedown"||h.type==="touchstart")||Array.isArray(s)&&!s.includes(h.button)&&h.type==="mousedown")return!1;const y=Array.isArray(s)&&s.includes(h.button)||!h.button||h.button<=1;return(!h.ctrlKey||v)&&y}}function PT({domNode:e,minZoom:t,maxZoom:n,translateExtent:s,viewport:r,onPanZoom:i,onPanZoomStart:l,onPanZoomEnd:u,onDraggingChange:d}){const f={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},p=e.getBoundingClientRect(),h=_f().scaleExtent([t,n]).translateExtent(s),m=Cs(e).call(h);E({x:r.x,y:r.y,zoom:cl(r.zoom,t,n)},[[0,0],[p.width,p.height]],s);const _=m.on("wheel.zoom"),v=m.on("dblclick.zoom");h.wheelDelta(W0);function y(A,O){return m?new Promise(R=>{h==null||h.interpolate((O==null?void 0:O.interpolate)==="linear"?pc:cd).transform(mp(m,O==null?void 0:O.duration,O==null?void 0:O.ease,()=>R(!0)),A)}):Promise.resolve(!1)}function b({noWheelClassName:A,noPanClassName:O,onPaneContextMenu:R,userSelectionActive:L,panOnScroll:F,panOnDrag:B,panOnScrollMode:q,panOnScrollSpeed:I,preventScrolling:U,zoomOnPinch:V,zoomOnScroll:H,zoomOnDoubleClick:G,zoomActivationKeyPressed:W,lib:J,onTransformChange:ee,connectionInProgress:Z,paneClickDistance:K,selectionOnDrag:X}){L&&!f.isZoomingOrPanning&&w();const Q=F&&!W&&!L;h.clickDistance(X?1/0:!Cr(K)||K<0?0:K);const ne=Q?TT({zoomPanValues:f,noWheelClassName:A,d3Selection:m,d3Zoom:h,panOnScrollMode:q,panOnScrollSpeed:I,zoomOnPinch:V,onPanZoomStart:l,onPanZoom:i,onPanZoomEnd:u}):$T({noWheelClassName:A,preventScrolling:U,d3ZoomHandler:_});if(m.on("wheel.zoom",ne,{passive:!1}),!L){const ce=LT({zoomPanValues:f,onDraggingChange:d,onPanZoomStart:l});h.on("start",ce);const ie=zT({zoomPanValues:f,panOnDrag:B,onPaneContextMenu:!!R,onPanZoom:i,onTransformChange:ee});h.on("zoom",ie);const ge=RT({zoomPanValues:f,panOnDrag:B,panOnScroll:F,onPaneContextMenu:R,onPanZoomEnd:u,onDraggingChange:d});h.on("end",ge)}const le=DT({zoomActivationKeyPressed:W,panOnDrag:B,zoomOnScroll:H,panOnScroll:F,zoomOnDoubleClick:G,zoomOnPinch:V,userSelectionActive:L,noPanClassName:O,noWheelClassName:A,lib:J,connectionInProgress:Z});h.filter(le),G?m.on("dblclick.zoom",v):m.on("dblclick.zoom",null)}function w(){h.on("zoom",null)}async function E(A,O,R){const L=dp(A),F=h==null?void 0:h.constrain()(L,O,R);return F&&await y(F),new Promise(B=>B(F))}async function N(A,O){const R=dp(A);return await y(R,O),new Promise(L=>L(R))}function j(A){if(m){const O=dp(A),R=m.property("__zoom");(R.k!==A.zoom||R.x!==A.x||R.y!==A.y)&&(h==null||h.transform(m,O,null,{sync:!0}))}}function C(){const A=m?xv(m.node()):{x:0,y:0,k:1};return{x:A.x,y:A.y,zoom:A.k}}function M(A,O){return m?new Promise(R=>{h==null||h.interpolate((O==null?void 0:O.interpolate)==="linear"?pc:cd).scaleTo(mp(m,O==null?void 0:O.duration,O==null?void 0:O.ease,()=>R(!0)),A)}):Promise.resolve(!1)}function z(A,O){return m?new Promise(R=>{h==null||h.interpolate((O==null?void 0:O.interpolate)==="linear"?pc:cd).scaleBy(mp(m,O==null?void 0:O.duration,O==null?void 0:O.ease,()=>R(!0)),A)}):Promise.resolve(!1)}function D(A){h==null||h.scaleExtent(A)}function k(A){h==null||h.translateExtent(A)}function T(A){const O=!Cr(A)||A<0?0:A;h==null||h.clickDistance(O)}return{update:b,destroy:w,setViewport:N,setViewportConstrained:E,getViewport:C,scaleTo:M,scaleBy:z,setScaleExtent:D,setTranslateExtent:k,syncViewport:j,setClickDistance:T}}var fl;(function(e){e.Line="line",e.Handle="handle"})(fl||(fl={}));function IT({width:e,prevWidth:t,height:n,prevHeight:s,affectsX:r,affectsY:i}){const l=e-t,u=n-s,d=[l>0?1:l<0?-1:0,u>0?1:u<0?-1:0];return l&&r&&(d[0]=d[0]*-1),u&&i&&(d[1]=d[1]*-1),d}function G0(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),s=e.includes("left"),r=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:s,affectsY:r}}function Qa(e,t){return Math.max(0,t-e)}function Za(e,t){return Math.max(0,e-t)}function Id(e,t,n){return Math.max(0,t-e,e-n)}function X0(e,t){return e?!t:t}function FT(e,t,n,s,r,i,l,u){let{affectsX:d,affectsY:f}=t;const{isHorizontal:p,isVertical:h}=t,m=p&&h,{xSnapped:_,ySnapped:v}=n,{minWidth:y,maxWidth:b,minHeight:w,maxHeight:E}=s,{x:N,y:j,width:C,height:M,aspectRatio:z}=e;let D=Math.floor(p?_-e.pointerX:0),k=Math.floor(h?v-e.pointerY:0);const T=C+(d?-D:D),A=M+(f?-k:k),O=-i[0]*C,R=-i[1]*M;let L=Id(T,y,b),F=Id(A,w,E);if(l){let I=0,U=0;d&&D<0?I=Qa(N+D+O,l[0][0]):!d&&D>0&&(I=Za(N+T+O,l[1][0])),f&&k<0?U=Qa(j+k+R,l[0][1]):!f&&k>0&&(U=Za(j+A+R,l[1][1])),L=Math.max(L,I),F=Math.max(F,U)}if(u){let I=0,U=0;d&&D>0?I=Za(N+D,u[0][0]):!d&&D<0&&(I=Qa(N+T,u[1][0])),f&&k>0?U=Za(j+k,u[0][1]):!f&&k<0&&(U=Qa(j+A,u[1][1])),L=Math.max(L,I),F=Math.max(F,U)}if(r){if(p){const I=Id(T/z,w,E)*z;if(L=Math.max(L,I),l){let U=0;!d&&!f||d&&!f&&m?U=Za(j+R+T/z,l[1][1])*z:U=Qa(j+R+(d?D:-D)/z,l[0][1])*z,L=Math.max(L,U)}if(u){let U=0;!d&&!f||d&&!f&&m?U=Qa(j+T/z,u[1][1])*z:U=Za(j+(d?D:-D)/z,u[0][1])*z,L=Math.max(L,U)}}if(h){const I=Id(A*z,y,b)/z;if(F=Math.max(F,I),l){let U=0;!d&&!f||f&&!d&&m?U=Za(N+A*z+O,l[1][0])/z:U=Qa(N+(f?k:-k)*z+O,l[0][0])/z,F=Math.max(F,U)}if(u){let U=0;!d&&!f||f&&!d&&m?U=Qa(N+A*z,u[1][0])/z:U=Za(N+(f?k:-k)*z,u[0][0])/z,F=Math.max(F,U)}}}k=k+(k<0?F:-F),D=D+(D<0?L:-L),r&&(m?T>A*z?k=(X0(d,f)?-D:D)/z:D=(X0(d,f)?-k:k)*z:p?(k=D/z,f=d):(D=k*z,d=f));const B=d?N+D:N,q=f?j+k:j;return{width:C+(d?-D:D),height:M+(f?-k:k),x:i[0]*D*(d?-1:1)+B,y:i[1]*k*(f?-1:1)+q}}const Q0={width:0,height:0,x:0,y:0},BT={...Q0,pointerX:0,pointerY:0,aspectRatio:1};function HT(e){return[[0,0],[e.measured.width,e.measured.height]]}function UT(e,t,n){const s=t.position.x+e.position.x,r=t.position.y+e.position.y,i=e.measured.width??0,l=e.measured.height??0,u=n[0]*i,d=n[1]*l;return[[s-u,r-d],[s+i-u,r+l-d]]}function qT({domNode:e,nodeId:t,getStoreItems:n,onChange:s,onEnd:r}){const i=Cs(e);let l={controlDirection:G0("bottom-right"),boundaries:{minWidth:0,minHeight:0,maxWidth:Number.MAX_VALUE,maxHeight:Number.MAX_VALUE},resizeDirection:void 0,keepAspectRatio:!1};function u({controlPosition:f,boundaries:p,keepAspectRatio:h,resizeDirection:m,onResizeStart:_,onResize:v,onResizeEnd:y,shouldResize:b}){let w={...Q0},E={...BT};l={boundaries:p,resizeDirection:m,keepAspectRatio:h,controlDirection:G0(f)};let N,j=null,C=[],M,z,D,k=!1;const T=tf().on("start",A=>{const{nodeLookup:O,transform:R,snapGrid:L,snapToGrid:F,nodeOrigin:B,paneDomNode:q}=n();if(N=O.get(t),!N)return;j=(q==null?void 0:q.getBoundingClientRect())??null;const{xSnapped:I,ySnapped:U}=Rc(A.sourceEvent,{transform:R,snapGrid:L,snapToGrid:F,containerBounds:j});w={width:N.measured.width??0,height:N.measured.height??0,x:N.position.x??0,y:N.position.y??0},E={...w,pointerX:I,pointerY:U,aspectRatio:w.width/w.height},M=void 0,N.parentId&&(N.extent==="parent"||N.expandParent)&&(M=O.get(N.parentId),z=M&&N.extent==="parent"?HT(M):void 0),C=[],D=void 0;for(const[V,H]of O)if(H.parentId===t&&(C.push({id:V,position:{...H.position},extent:H.extent}),H.extent==="parent"||H.expandParent)){const G=UT(H,N,H.origin??B);D?D=[[Math.min(G[0][0],D[0][0]),Math.min(G[0][1],D[0][1])],[Math.max(G[1][0],D[1][0]),Math.max(G[1][1],D[1][1])]]:D=G}_==null||_(A,{...w})}).on("drag",A=>{const{transform:O,snapGrid:R,snapToGrid:L,nodeOrigin:F}=n(),B=Rc(A.sourceEvent,{transform:O,snapGrid:R,snapToGrid:L,containerBounds:j}),q=[];if(!N)return;const{x:I,y:U,width:V,height:H}=w,G={},W=N.origin??F,{width:J,height:ee,x:Z,y:K}=FT(E,l.controlDirection,B,l.boundaries,l.keepAspectRatio,W,z,D),X=J!==V,Q=ee!==H,ne=Z!==I&&X,le=K!==U&&Q;if(!ne&&!le&&!X&&!Q)return;if((ne||le||W[0]===1||W[1]===1)&&(G.x=ne?Z:w.x,G.y=le?K:w.y,w.x=G.x,w.y=G.y,C.length>0)){const Re=Z-I,ze=K-U;for(const me of C)me.position={x:me.position.x-Re+W[0]*(J-V),y:me.position.y-ze+W[1]*(ee-H)},q.push(me)}if((X||Q)&&(G.width=X&&(!l.resizeDirection||l.resizeDirection==="horizontal")?J:w.width,G.height=Q&&(!l.resizeDirection||l.resizeDirection==="vertical")?ee:w.height,w.width=G.width,w.height=G.height),M&&N.expandParent){const Re=W[0]*(G.width??0);G.x&&G.x<Re&&(w.x=Re,E.x=E.x-(G.x-Re));const ze=W[1]*(G.height??0);G.y&&G.y<ze&&(w.y=ze,E.y=E.y-(G.y-ze))}const ce=IT({width:w.width,prevWidth:V,height:w.height,prevHeight:H,affectsX:l.controlDirection.affectsX,affectsY:l.controlDirection.affectsY}),ie={...w,direction:ce};(b==null?void 0:b(A,ie))!==!1&&(k=!0,v==null||v(A,ie),s(G,q))}).on("end",A=>{k&&(y==null||y(A,{...w}),r==null||r({...w}),k=!1)});i.call(T)}function d(){i.on(".drag",null)}return{update:u,destroy:d}}var Z0={exports:{}},hp={},fp={exports:{}},pp={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var J0;function VT(){if(J0)return pp;J0=1;var e=x;function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var n=typeof Object.is=="function"?Object.is:t,s=e.useState,r=e.useEffect,i=e.useLayoutEffect,l=e.useDebugValue;function u(h,m){var _=m(),v=s({inst:{value:_,getSnapshot:m}}),y=v[0].inst,b=v[1];return i(function(){y.value=_,y.getSnapshot=m,d(y)&&b({inst:y})},[h,_,m]),r(function(){return d(y)&&b({inst:y}),h(function(){d(y)&&b({inst:y})})},[h]),l(_),_}function d(h){var m=h.getSnapshot;h=h.value;try{var _=m();return!n(h,_)}catch{return!0}}function f(h,m){return m()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?f:u;return pp.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:p,pp}var eb;function KT(){return eb||(eb=1,fp.exports=VT()),fp.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tb;function YT(){if(tb)return hp;tb=1;var e=x,t=KT();function n(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var s=typeof Object.is=="function"?Object.is:n,r=t.useSyncExternalStore,i=e.useRef,l=e.useEffect,u=e.useMemo,d=e.useDebugValue;return hp.useSyncExternalStoreWithSelector=function(f,p,h,m,_){var v=i(null);if(v.current===null){var y={hasValue:!1,value:null};v.current=y}else y=v.current;v=u(function(){function w(M){if(!E){if(E=!0,N=M,M=m(M),_!==void 0&&y.hasValue){var z=y.value;if(_(z,M))return j=z}return j=M}if(z=j,s(N,M))return z;var D=m(M);return _!==void 0&&_(z,D)?(N=M,z):(N=M,j=D)}var E=!1,N,j,C=h===void 0?null:h;return[function(){return w(p())},C===null?void 0:function(){return w(C())}]},[p,h,m,_]);var b=r(f,v[0],v[1]);return l(function(){y.hasValue=!0,y.value=b},[b]),d(b),b},hp}Z0.exports=YT();var WT=Z0.exports;const GT=gn(WT),XT={},nb=e=>{let t;const n=new Set,s=(p,h)=>{const m=typeof p=="function"?p(t):p;if(!Object.is(m,t)){const _=t;t=h??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(v=>v(t,_))}},r=()=>t,d={setState:s,getState:r,getInitialState:()=>f,subscribe:p=>(n.add(p),()=>n.delete(p)),destroy:()=>{(XT?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},f=t=e(s,r,d);return d},QT=e=>e?nb(e):nb,{useDebugValue:ZT}=ve,{useSyncExternalStoreWithSelector:JT}=GT,e$=e=>e;function sb(e,t=e$,n){const s=JT(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return ZT(s),s}const rb=(e,t)=>{const n=QT(e),s=(r,i=t)=>sb(n,r,i);return Object.assign(s,n),s},t$=(e,t)=>e?rb(e,t):rb;function _n(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,r]of e)if(!Object.is(r,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const s of n)if(!Object.prototype.hasOwnProperty.call(t,s)||!Object.is(e[s],t[s]))return!1;return!0}const Fd=x.createContext(null),n$=Fd.Provider,ab=Yr.error001();function Ft(e,t){const n=x.useContext(Fd);if(n===null)throw new Error(ab);return sb(n,e,t)}function dn(){const e=x.useContext(Fd);if(e===null)throw new Error(ab);return x.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const ob={display:"none"},s$={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ib="react-flow__node-desc",lb="react-flow__edge-desc",r$="react-flow__aria-live",a$=e=>e.ariaLiveMessage,o$=e=>e.ariaLabelConfig;function i$({rfId:e}){const t=Ft(a$);return a.jsx("div",{id:`${r$}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:s$,children:t})}function l$({rfId:e,disableKeyboardA11y:t}){const n=Ft(o$);return a.jsxs(a.Fragment,{children:[a.jsx("div",{id:`${ib}-${e}`,style:ob,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),a.jsx("div",{id:`${lb}-${e}`,style:ob,children:n["edge.a11yDescription.default"]}),!t&&a.jsx(i$,{rfId:e})]})}const Bd=x.forwardRef(({position:e="top-left",children:t,className:n,style:s,...r},i)=>{const l=`${e}`.split("-");return a.jsx("div",{className:Vt(["react-flow__panel",n,...l]),style:s,ref:i,...r,children:t})});Bd.displayName="Panel";function c$({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:a.jsx(Bd,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:a.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const u$=e=>{const t=[],n=[];for(const[,s]of e.nodeLookup)s.selected&&t.push(s.internals.userNode);for(const[,s]of e.edgeLookup)s.selected&&n.push(s);return{selectedNodes:t,selectedEdges:n}},Hd=e=>e.id;function d$(e,t){return _n(e.selectedNodes.map(Hd),t.selectedNodes.map(Hd))&&_n(e.selectedEdges.map(Hd),t.selectedEdges.map(Hd))}function m$({onSelectionChange:e}){const t=dn(),{selectedNodes:n,selectedEdges:s}=Ft(u$,d$);return x.useEffect(()=>{const r={nodes:n,edges:s};e==null||e(r),t.getState().onSelectionChangeHandlers.forEach(i=>i(r))},[n,s,e]),null}const h$=e=>!!e.onSelectionChangeHandlers;function f$({onSelectionChange:e}){const t=Ft(h$);return e||t?a.jsx(m$,{onSelectionChange:e}):null}const cb=[0,0],p$={x:0,y:0,zoom:1},ub=[...["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","ariaLabelConfig"],"rfId"],g$=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges}),db={translateExtent:kc,nodeOrigin:cb,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1"};function _$(e){const{setNodes:t,setEdges:n,setMinZoom:s,setMaxZoom:r,setTranslateExtent:i,setNodeExtent:l,reset:u,setDefaultNodesAndEdges:d}=Ft(g$,_n),f=dn();x.useEffect(()=>(d(e.defaultNodes,e.defaultEdges),()=>{p.current=db,u()}),[]);const p=x.useRef(db);return x.useEffect(()=>{for(const h of ub){const m=e[h],_=p.current[h];m!==_&&(typeof e[h]>"u"||(h==="nodes"?t(m):h==="edges"?n(m):h==="minZoom"?s(m):h==="maxZoom"?r(m):h==="translateExtent"?i(m):h==="nodeExtent"?l(m):h==="ariaLabelConfig"?f.setState({ariaLabelConfig:nT(m)}):h==="fitView"?f.setState({fitViewQueued:m}):h==="fitViewOptions"?f.setState({fitViewOptions:m}):f.setState({[h]:m})))}p.current=e},ub.map(h=>e[h])),null}function mb(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function y$(e){var s;const[t,n]=x.useState(e==="system"?null:e);return x.useEffect(()=>{if(e!=="system"){n(e);return}const r=mb(),i=()=>n(r!=null&&r.matches?"dark":"light");return i(),r==null||r.addEventListener("change",i),()=>{r==null||r.removeEventListener("change",i)}},[e]),t!==null?t:(s=mb())!=null&&s.matches?"dark":"light"}const hb=typeof document<"u"?document:null;function Pc(e=null,t={target:hb,actInsideInputWithModifier:!0}){const[n,s]=x.useState(!1),r=x.useRef(!1),i=x.useRef(new Set([])),[l,u]=x.useMemo(()=>{if(e!==null){const f=(Array.isArray(e)?e:[e]).filter(h=>typeof h=="string").map(h=>h.replace("+",`
`).replace(`

`,`
+`).split(`
`)),p=f.reduce((h,m)=>h.concat(...m),[]);return[f,p]}return[[],[]]},[e]);return x.useEffect(()=>{const d=(t==null?void 0:t.target)??hb,f=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const p=_=>{var b,w;if(r.current=_.ctrlKey||_.metaKey||_.shiftKey||_.altKey,(!r.current||r.current&&!f)&&j0(_))return!1;const y=pb(_.code,u);if(i.current.add(_[y]),fb(l,i.current,!1)){const E=((w=(b=_.composedPath)==null?void 0:b.call(_))==null?void 0:w[0])||_.target,N=(E==null?void 0:E.nodeName)==="BUTTON"||(E==null?void 0:E.nodeName)==="A";t.preventDefault!==!1&&(r.current||!N)&&_.preventDefault(),s(!0)}},h=_=>{const v=pb(_.code,u);fb(l,i.current,!0)?(s(!1),i.current.clear()):i.current.delete(_[v]),_.key==="Meta"&&i.current.clear(),r.current=!1},m=()=>{i.current.clear(),s(!1)};return d==null||d.addEventListener("keydown",p),d==null||d.addEventListener("keyup",h),window.addEventListener("blur",m),window.addEventListener("contextmenu",m),()=>{d==null||d.removeEventListener("keydown",p),d==null||d.removeEventListener("keyup",h),window.removeEventListener("blur",m),window.removeEventListener("contextmenu",m)}}},[e,s]),n}function fb(e,t,n){return e.filter(s=>n||s.length===t.size).some(s=>s.every(r=>t.has(r)))}function pb(e,t){return t.includes(e)?"code":"key"}const v$=()=>{const e=dn();return x.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:s}=e.getState();return s?s.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[s,r,i],panZoom:l}=e.getState();return l?(await l.setViewport({x:t.x??s,y:t.y??r,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,s]=e.getState().transform;return{x:t,y:n,zoom:s}},setCenter:async(t,n,s)=>e.getState().setCenter(t,n,s),fitBounds:async(t,n)=>{const{width:s,height:r,minZoom:i,maxZoom:l,panZoom:u}=e.getState(),d=ep(t,s,r,i,l,(n==null?void 0:n.padding)??.1);return u?(await u.setViewport(d,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:s,snapGrid:r,snapToGrid:i,domNode:l}=e.getState();if(!l)return t;const{x:u,y:d}=l.getBoundingClientRect(),f={x:t.x-u,y:t.y-d},p=n.snapGrid??r,h=n.snapToGrid??i;return Lc(f,s,h,p)},flowToScreenPosition:t=>{const{transform:n,domNode:s}=e.getState();if(!s)return t;const{x:r,y:i}=s.getBoundingClientRect(),l=Rd(t,n);return{x:l.x+r,y:l.y+i}}}),[])};function gb(e,t){const n=[],s=new Map,r=[];for(const i of e)if(i.type==="add"){r.push(i);continue}else if(i.type==="remove"||i.type==="replace")s.set(i.id,[i]);else{const l=s.get(i.id);l?l.push(i):s.set(i.id,[i])}for(const i of t){const l=s.get(i.id);if(!l){n.push(i);continue}if(l[0].type==="remove")continue;if(l[0].type==="replace"){n.push({...l[0].item});continue}const u={...i};for(const d of l)x$(d,u);n.push(u)}return r.length&&r.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function x$(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function b$(e,t){return gb(e,t)}function w$(e,t){return gb(e,t)}function Zo(e,t){return{id:e,type:"select",selected:t}}function pl(e,t=new Set,n=!1){const s=[];for(const[r,i]of e){const l=t.has(r);!(i.selected===void 0&&!l)&&i.selected!==l&&(n&&(i.selected=l),s.push(Zo(i.id,l)))}return s}function _b({items:e=[],lookup:t}){var r;const n=[],s=new Map(e.map(i=>[i.id,i]));for(const[i,l]of e.entries()){const u=t.get(l.id),d=((r=u==null?void 0:u.internals)==null?void 0:r.userNode)??u;d!==void 0&&d!==l&&n.push({id:l.id,item:l,type:"replace"}),d===void 0&&n.push({item:l,type:"add",index:i})}for(const[i]of t)s.get(i)===void 0&&n.push({id:i,type:"remove"});return n}function yb(e){return{id:e.id,type:"remove"}}const vb=e=>K2(e),N$=e=>h0(e);function xb(e){return x.forwardRef(e)}const j$=typeof window<"u"?x.useLayoutEffect:x.useEffect;function bb(e){const[t,n]=x.useState(BigInt(0)),[s]=x.useState(()=>S$(()=>n(r=>r+BigInt(1))));return j$(()=>{const r=s.get();r.length&&(e(r),s.reset())},[t]),s}function S$(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const wb=x.createContext(null);function E$({children:e}){const t=dn(),n=x.useCallback(u=>{const{nodes:d=[],setNodes:f,hasDefaultNodes:p,onNodesChange:h,nodeLookup:m,fitViewQueued:_}=t.getState();let v=d;for(const b of u)v=typeof b=="function"?b(v):b;const y=_b({items:v,lookup:m});p&&f(v),y.length>0?h==null||h(y):_&&window.requestAnimationFrame(()=>{const{fitViewQueued:b,nodes:w,setNodes:E}=t.getState();b&&E(w)})},[]),s=bb(n),r=x.useCallback(u=>{const{edges:d=[],setEdges:f,hasDefaultEdges:p,onEdgesChange:h,edgeLookup:m}=t.getState();let _=d;for(const v of u)_=typeof v=="function"?v(_):v;p?f(_):h&&h(_b({items:_,lookup:m}))},[]),i=bb(r),l=x.useMemo(()=>({nodeQueue:s,edgeQueue:i}),[]);return a.jsx(wb.Provider,{value:l,children:e})}function C$(){const e=x.useContext(wb);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const k$=e=>!!e.panZoom;function gp(){const e=v$(),t=dn(),n=C$(),s=Ft(k$),r=x.useMemo(()=>{const i=h=>t.getState().nodeLookup.get(h),l=h=>{n.nodeQueue.push(h)},u=h=>{n.edgeQueue.push(h)},d=h=>{var w,E;const{nodeLookup:m,nodeOrigin:_}=t.getState(),v=vb(h)?h:m.get(h.id),y=v.parentId?b0(v.position,v.measured,v.parentId,m,_):v.position,b={...v,position:y,width:((w=v.measured)==null?void 0:w.width)??v.width,height:((E=v.measured)==null?void 0:E.height)??v.height};return ul(b)},f=(h,m,_={replace:!1})=>{l(v=>v.map(y=>{if(y.id===h){const b=typeof m=="function"?m(y):m;return _.replace&&vb(b)?b:{...y,...b}}return y}))},p=(h,m,_={replace:!1})=>{u(v=>v.map(y=>{if(y.id===h){const b=typeof m=="function"?m(y):m;return _.replace&&N$(b)?b:{...y,...b}}return y}))};return{getNodes:()=>t.getState().nodes.map(h=>({...h})),getNode:h=>{var m;return(m=i(h))==null?void 0:m.internals.userNode},getInternalNode:i,getEdges:()=>{const{edges:h=[]}=t.getState();return h.map(m=>({...m}))},getEdge:h=>t.getState().edgeLookup.get(h),setNodes:l,setEdges:u,addNodes:h=>{const m=Array.isArray(h)?h:[h];n.nodeQueue.push(_=>[..._,...m])},addEdges:h=>{const m=Array.isArray(h)?h:[h];n.edgeQueue.push(_=>[..._,...m])},toObject:()=>{const{nodes:h=[],edges:m=[],transform:_}=t.getState(),[v,y,b]=_;return{nodes:h.map(w=>({...w})),edges:m.map(w=>({...w})),viewport:{x:v,y,zoom:b}}},deleteElements:async({nodes:h=[],edges:m=[]})=>{const{nodes:_,edges:v,onNodesDelete:y,onEdgesDelete:b,triggerNodeChanges:w,triggerEdgeChanges:E,onDelete:N,onBeforeDelete:j}=t.getState(),{nodes:C,edges:M}=await Q2({nodesToRemove:h,edgesToRemove:m,nodes:_,edges:v,onBeforeDelete:j}),z=M.length>0,D=C.length>0;if(z){const k=M.map(yb);b==null||b(M),E(k)}if(D){const k=C.map(yb);y==null||y(C),w(k)}return(D||z)&&(N==null||N({nodes:C,edges:M})),{deletedNodes:C,deletedEdges:M}},getIntersectingNodes:(h,m=!0,_)=>{const v=v0(h),y=v?h:d(h),b=_!==void 0;return y?(_||t.getState().nodes).filter(w=>{const E=t.getState().nodeLookup.get(w.id);if(E&&!v&&(w.id===h.id||!E.internals.positionAbsolute))return!1;const N=ul(b?w:E),j=Tc(N,y);return m&&j>0||j>=N.width*N.height||j>=y.width*y.height}):[]},isNodeIntersecting:(h,m,_=!0)=>{const y=v0(h)?h:d(h);if(!y)return!1;const b=Tc(y,m);return _&&b>0||b>=m.width*m.height||b>=y.width*y.height},updateNode:f,updateNodeData:(h,m,_={replace:!1})=>{f(h,v=>{const y=typeof m=="function"?m(v):m;return _.replace?{...v,data:y}:{...v,data:{...v.data,...y}}},_)},updateEdge:p,updateEdgeData:(h,m,_={replace:!1})=>{p(h,v=>{const y=typeof m=="function"?m(v):m;return _.replace?{...v,data:y}:{...v,data:{...v.data,...y}}},_)},getNodesBounds:h=>{const{nodeLookup:m,nodeOrigin:_}=t.getState();return Y2(h,{nodeLookup:m,nodeOrigin:_})},getHandleConnections:({type:h,id:m,nodeId:_})=>{var v;return Array.from(((v=t.getState().connectionLookup.get(`${_}-${h}${m?`-${m}`:""}`))==null?void 0:v.values())??[])},getNodeConnections:({type:h,handleId:m,nodeId:_})=>{var v;return Array.from(((v=t.getState().connectionLookup.get(`${_}${h?m?`-${h}-${m}`:`-${h}`:""}`))==null?void 0:v.values())??[])},fitView:async h=>{const m=t.getState().fitViewResolver??tT();return t.setState({fitViewQueued:!0,fitViewOptions:h,fitViewResolver:m}),n.nodeQueue.push(_=>[..._]),m.promise}}},[]);return x.useMemo(()=>({...r,...e,viewportInitialized:s}),[s])}const Nb=e=>e.selected,M$=typeof window<"u"?window:void 0;function A$({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=dn(),{deleteElements:s}=gp(),r=Pc(e,{actInsideInputWithModifier:!1}),i=Pc(t,{target:M$});x.useEffect(()=>{if(r){const{edges:l,nodes:u}=n.getState();s({nodes:u.filter(Nb),edges:l.filter(Nb)}),n.setState({nodesSelectionActive:!1})}},[r]),x.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function O$(e){const t=dn();x.useEffect(()=>{const n=()=>{var r,i,l,u;if(!e.current||!(((i=(r=e.current).checkVisibility)==null?void 0:i.call(r))??!0))return!1;const s=tp(e.current);(s.height===0||s.width===0)&&((u=(l=t.getState()).onError)==null||u.call(l,"004",Yr.error004())),t.setState({width:s.width||500,height:s.height||500})};if(e.current){n(),window.addEventListener("resize",n);const s=new ResizeObserver(()=>n());return s.observe(e.current),()=>{window.removeEventListener("resize",n),s&&e.current&&s.unobserve(e.current)}}},[])}const Ud={position:"absolute",width:"100%",height:"100%",top:0,left:0},T$=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib,connectionInProgress:e.connection.inProgress});function $$({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:s=!1,panOnScrollSpeed:r=.5,panOnScrollMode:i=Xo.Free,zoomOnDoubleClick:l=!0,panOnDrag:u=!0,defaultViewport:d,translateExtent:f,minZoom:p,maxZoom:h,zoomActivationKeyCode:m,preventScrolling:_=!0,children:v,noWheelClassName:y,noPanClassName:b,onViewportChange:w,isControlledViewport:E,paneClickDistance:N,selectionOnDrag:j}){const C=dn(),M=x.useRef(null),{userSelectionActive:z,lib:D,connectionInProgress:k}=Ft(T$,_n),T=Pc(m),A=x.useRef();O$(M);const O=x.useCallback(R=>{w==null||w({x:R[0],y:R[1],zoom:R[2]}),E||C.setState({transform:R})},[w,E]);return x.useEffect(()=>{if(M.current){A.current=PT({domNode:M.current,minZoom:p,maxZoom:h,translateExtent:f,viewport:d,onDraggingChange:B=>C.setState({paneDragging:B}),onPanZoomStart:(B,q)=>{const{onViewportChangeStart:I,onMoveStart:U}=C.getState();U==null||U(B,q),I==null||I(q)},onPanZoom:(B,q)=>{const{onViewportChange:I,onMove:U}=C.getState();U==null||U(B,q),I==null||I(q)},onPanZoomEnd:(B,q)=>{const{onViewportChangeEnd:I,onMoveEnd:U}=C.getState();U==null||U(B,q),I==null||I(q)}});const{x:R,y:L,zoom:F}=A.current.getViewport();return C.setState({panZoom:A.current,transform:[R,L,F],domNode:M.current.closest(".react-flow")}),()=>{var B;(B=A.current)==null||B.destroy()}}},[]),x.useEffect(()=>{var R;(R=A.current)==null||R.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:s,panOnScrollSpeed:r,panOnScrollMode:i,zoomOnDoubleClick:l,panOnDrag:u,zoomActivationKeyPressed:T,preventScrolling:_,noPanClassName:b,userSelectionActive:z,noWheelClassName:y,lib:D,onTransformChange:O,connectionInProgress:k,selectionOnDrag:j,paneClickDistance:N})},[e,t,n,s,r,i,l,u,T,_,b,z,y,D,O,k,j,N]),a.jsx("div",{className:"react-flow__renderer",ref:M,style:Ud,children:v})}const L$=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function z$(){const{userSelectionActive:e,userSelectionRect:t}=Ft(L$,_n);return e&&t?a.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const _p=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},R$=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function D$({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Mc.Full,panOnDrag:s,paneClickDistance:r,selectionOnDrag:i,onSelectionStart:l,onSelectionEnd:u,onPaneClick:d,onPaneContextMenu:f,onPaneScroll:p,onPaneMouseEnter:h,onPaneMouseMove:m,onPaneMouseLeave:_,children:v}){const y=dn(),{userSelectionActive:b,elementsSelectable:w,dragging:E,connectionInProgress:N}=Ft(R$,_n),j=w&&(e||b),C=x.useRef(null),M=x.useRef(),z=x.useRef(new Set),D=x.useRef(new Set),k=x.useRef(!1),T=I=>{if(k.current||N){k.current=!1;return}d==null||d(I),y.getState().resetSelectedElements(),y.setState({nodesSelectionActive:!1})},A=I=>{if(Array.isArray(s)&&(s!=null&&s.includes(2))){I.preventDefault();return}f==null||f(I)},O=p?I=>p(I):void 0,R=I=>{k.current&&(I.stopPropagation(),k.current=!1)},L=I=>{var ee,Z;const{domNode:U}=y.getState();if(M.current=U==null?void 0:U.getBoundingClientRect(),!M.current)return;const V=I.target===C.current;if(!V&&!!I.target.closest(".nokey")||!e||!(i&&V||t)||I.button!==0||!I.isPrimary)return;(Z=(ee=I.target)==null?void 0:ee.setPointerCapture)==null||Z.call(ee,I.pointerId),k.current=!1;const{x:W,y:J}=kr(I.nativeEvent,M.current);y.setState({userSelectionRect:{width:0,height:0,startX:W,startY:J,x:W,y:J}}),V||(I.stopPropagation(),I.preventDefault())},F=I=>{const{userSelectionRect:U,transform:V,nodeLookup:H,edgeLookup:G,connectionLookup:W,triggerNodeChanges:J,triggerEdgeChanges:ee,defaultEdgeOptions:Z,resetSelectedElements:K}=y.getState();if(!M.current||!U)return;const{x:X,y:Q}=kr(I.nativeEvent,M.current),{startX:ne,startY:le}=U;if(!k.current){const ze=t?0:r;if(Math.hypot(X-ne,Q-le)<=ze)return;K(),l==null||l(I)}k.current=!0;const ce={startX:ne,startY:le,x:X<ne?X:ne,y:Q<le?Q:le,width:Math.abs(X-ne),height:Math.abs(Q-le)},ie=z.current,ge=D.current;z.current=new Set(Zf(H,ce,V,n===Mc.Partial,!0).map(ze=>ze.id)),D.current=new Set;const Re=(Z==null?void 0:Z.selectable)??!0;for(const ze of z.current){const me=W.get(ze);if(me)for(const{edgeId:xe}of me.values()){const Ce=G.get(xe);Ce&&(Ce.selectable??Re)&&D.current.add(xe)}}if(!w0(ie,z.current)){const ze=pl(H,z.current,!0);J(ze)}if(!w0(ge,D.current)){const ze=pl(G,D.current);ee(ze)}y.setState({userSelectionRect:ce,userSelectionActive:!0,nodesSelectionActive:!1})},B=I=>{var U,V;I.button===0&&((V=(U=I.target)==null?void 0:U.releasePointerCapture)==null||V.call(U,I.pointerId),!b&&I.target===C.current&&y.getState().userSelectionRect&&(T==null||T(I)),y.setState({userSelectionActive:!1,userSelectionRect:null}),k.current&&(u==null||u(I),y.setState({nodesSelectionActive:z.current.size>0})))},q=s===!0||Array.isArray(s)&&s.includes(0);return a.jsxs("div",{className:Vt(["react-flow__pane",{draggable:q,dragging:E,selection:e}]),onClick:j?void 0:_p(T,C),onContextMenu:_p(A,C),onWheel:_p(O,C),onPointerEnter:j?void 0:h,onPointerMove:j?F:m,onPointerUp:j?B:void 0,onPointerDownCapture:j?L:void 0,onClickCapture:j?R:void 0,onPointerLeave:_,ref:C,style:Ud,children:[v,a.jsx(z$,{})]})}function yp({id:e,store:t,unselect:n=!1,nodeRef:s}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:l,nodeLookup:u,onError:d}=t.getState(),f=u.get(e);if(!f){d==null||d("012",Yr.error012(e));return}t.setState({nodesSelectionActive:!1}),f.selected?(n||f.selected&&l)&&(i({nodes:[f],edges:[]}),requestAnimationFrame(()=>{var p;return(p=s==null?void 0:s.current)==null?void 0:p.blur()})):r([e])}function jb({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:s,nodeId:r,isSelectable:i,nodeClickDistance:l}){const u=dn(),[d,f]=x.useState(!1),p=x.useRef();return x.useEffect(()=>{p.current=jT({getStoreItems:()=>u.getState(),onNodeMouseDown:h=>{yp({id:h,store:u,nodeRef:e})},onDragStart:()=>{f(!0)},onDragStop:()=>{f(!1)}})},[]),x.useEffect(()=>{var h,m;if(t)(h=p.current)==null||h.destroy();else if(e.current)return(m=p.current)==null||m.update({noDragClassName:n,handleSelector:s,domNode:e.current,isSelectable:i,nodeId:r,nodeClickDistance:l}),()=>{var _;(_=p.current)==null||_.destroy()}},[n,s,t,i,e,r]),d}const P$=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Sb(){const e=dn();return x.useCallback(n=>{const{nodeExtent:s,snapToGrid:r,snapGrid:i,nodesDraggable:l,onError:u,updateNodePositions:d,nodeLookup:f,nodeOrigin:p}=e.getState(),h=new Map,m=P$(l),_=r?i[0]:5,v=r?i[1]:5,y=n.direction.x*_*n.factor,b=n.direction.y*v*n.factor;for(const[,w]of f){if(!m(w))continue;let E={x:w.internals.positionAbsolute.x+y,y:w.internals.positionAbsolute.y+b};r&&(E=$c(E,i));const{position:N,positionAbsolute:j}=f0({nodeId:w.id,nextPosition:E,nodeLookup:f,nodeExtent:s,nodeOrigin:p,onError:u});w.position=N,w.internals.positionAbsolute=j,h.set(w.id,w)}d(h)},[])}const vp=x.createContext(null),I$=vp.Provider;vp.Consumer;const Eb=()=>x.useContext(vp),F$=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),B$=(e,t,n)=>s=>{const{connectionClickStartHandle:r,connectionMode:i,connection:l}=s,{fromHandle:u,toHandle:d,isValid:f}=l,p=(d==null?void 0:d.nodeId)===e&&(d==null?void 0:d.id)===t&&(d==null?void 0:d.type)===n;return{connectingFrom:(u==null?void 0:u.nodeId)===e&&(u==null?void 0:u.id)===t&&(u==null?void 0:u.type)===n,connectingTo:p,clickConnecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.id)===t&&(r==null?void 0:r.type)===n,isPossibleEndHandle:i===ll.Strict?(u==null?void 0:u.type)!==n:e!==(u==null?void 0:u.nodeId)||t!==(u==null?void 0:u.id),connectionInProcess:!!u,clickConnectionInProcess:!!r,valid:p&&f}};function H$({type:e="source",position:t=it.Top,isValidConnection:n,isConnectable:s=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:l,onConnect:u,children:d,className:f,onMouseDown:p,onTouchStart:h,...m},_){var F,B;const v=l||null,y=e==="target",b=dn(),w=Eb(),{connectOnClick:E,noPanClassName:N,rfId:j}=Ft(F$,_n),{connectingFrom:C,connectingTo:M,clickConnecting:z,isPossibleEndHandle:D,connectionInProcess:k,clickConnectionInProcess:T,valid:A}=Ft(B$(w,v,e),_n);w||(B=(F=b.getState()).onError)==null||B.call(F,"010",Yr.error010());const O=q=>{const{defaultEdgeOptions:I,onConnect:U,hasDefaultEdges:V}=b.getState(),H={...I,...q};if(V){const{edges:G,setEdges:W}=b.getState();W(lT(H,G))}U==null||U(H),u==null||u(H)},R=q=>{if(!w)return;const I=S0(q.nativeEvent);if(r&&(I&&q.button===0||!I)){const U=b.getState();up.onPointerDown(q.nativeEvent,{handleDomNode:q.currentTarget,autoPanOnConnect:U.autoPanOnConnect,connectionMode:U.connectionMode,connectionRadius:U.connectionRadius,domNode:U.domNode,nodeLookup:U.nodeLookup,lib:U.lib,isTarget:y,handleId:v,nodeId:w,flowId:U.rfId,panBy:U.panBy,cancelConnection:U.cancelConnection,onConnectStart:U.onConnectStart,onConnectEnd:U.onConnectEnd,updateConnection:U.updateConnection,onConnect:O,isValidConnection:n||U.isValidConnection,getTransform:()=>b.getState().transform,getFromHandle:()=>b.getState().connection.fromHandle,autoPanSpeed:U.autoPanSpeed,dragThreshold:U.connectionDragThreshold})}I?p==null||p(q):h==null||h(q)},L=q=>{const{onClickConnectStart:I,onClickConnectEnd:U,connectionClickStartHandle:V,connectionMode:H,isValidConnection:G,lib:W,rfId:J,nodeLookup:ee,connection:Z}=b.getState();if(!w||!V&&!r)return;if(!V){I==null||I(q.nativeEvent,{nodeId:w,handleId:v,handleType:e}),b.setState({connectionClickStartHandle:{nodeId:w,type:e,id:v}});return}const K=N0(q.target),X=n||G,{connection:Q,isValid:ne}=up.isValid(q.nativeEvent,{handle:{nodeId:w,id:v,type:e},connectionMode:H,fromNodeId:V.nodeId,fromHandleId:V.id||null,fromType:V.type,isValidConnection:X,flowId:J,doc:K,lib:W,nodeLookup:ee});ne&&Q&&O(Q);const le=structuredClone(Z);delete le.inProgress,le.toPosition=le.toHandle?le.toHandle.position:null,U==null||U(q,le),b.setState({connectionClickStartHandle:null})};return a.jsx("div",{"data-handleid":v,"data-nodeid":w,"data-handlepos":t,"data-id":`${j}-${w}-${v}-${e}`,className:Vt(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",N,f,{source:!y,target:y,connectable:s,connectablestart:r,connectableend:i,clickconnecting:z,connectingfrom:C,connectingto:M,valid:A,connectionindicator:s&&(!k||D)&&(k||T?i:r)}]),onMouseDown:R,onTouchStart:R,onClick:E?L:void 0,ref:_,...m,children:d})}const qd=x.memo(xb(H$));function U$({data:e,isConnectable:t,sourcePosition:n=it.Bottom}){return a.jsxs(a.Fragment,{children:[e==null?void 0:e.label,a.jsx(qd,{type:"source",position:n,isConnectable:t})]})}function q$({data:e,isConnectable:t,targetPosition:n=it.Top,sourcePosition:s=it.Bottom}){return a.jsxs(a.Fragment,{children:[a.jsx(qd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,a.jsx(qd,{type:"source",position:s,isConnectable:t})]})}function V$(){return null}function K$({data:e,isConnectable:t,targetPosition:n=it.Top}){return a.jsxs(a.Fragment,{children:[a.jsx(qd,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const Vd={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},Cb={input:U$,default:q$,output:K$,group:V$};function Y$(e){var t,n,s,r;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((s=e.style)==null?void 0:s.width),height:e.height??((r=e.style)==null?void 0:r.height)}}const W$=e=>{const{width:t,height:n,x:s,y:r}=Oc(e.nodeLookup,{filter:i=>!!i.selected});return{width:Cr(t)?t:null,height:Cr(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${s}px,${r}px)`}};function G$({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const s=dn(),{width:r,height:i,transformString:l,userSelectionActive:u}=Ft(W$,_n),d=Sb(),f=x.useRef(null);if(x.useEffect(()=>{var m;n||(m=f.current)==null||m.focus({preventScroll:!0})},[n]),jb({nodeRef:f}),u||!r||!i)return null;const p=e?m=>{const _=s.getState().nodes.filter(v=>v.selected);e(m,_)}:void 0,h=m=>{Object.prototype.hasOwnProperty.call(Vd,m.key)&&(m.preventDefault(),d({direction:Vd[m.key],factor:m.shiftKey?4:1}))};return a.jsx("div",{className:Vt(["react-flow__nodesselection","react-flow__container",t]),style:{transform:l},children:a.jsx("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:p,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:r,height:i}})})}const kb=typeof window<"u"?window:void 0,X$=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function Mb({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:l,paneClickDistance:u,deleteKeyCode:d,selectionKeyCode:f,selectionOnDrag:p,selectionMode:h,onSelectionStart:m,onSelectionEnd:_,multiSelectionKeyCode:v,panActivationKeyCode:y,zoomActivationKeyCode:b,elementsSelectable:w,zoomOnScroll:E,zoomOnPinch:N,panOnScroll:j,panOnScrollSpeed:C,panOnScrollMode:M,zoomOnDoubleClick:z,panOnDrag:D,defaultViewport:k,translateExtent:T,minZoom:A,maxZoom:O,preventScrolling:R,onSelectionContextMenu:L,noWheelClassName:F,noPanClassName:B,disableKeyboardA11y:q,onViewportChange:I,isControlledViewport:U}){const{nodesSelectionActive:V,userSelectionActive:H}=Ft(X$),G=Pc(f,{target:kb}),W=Pc(y,{target:kb}),J=W||D,ee=W||j,Z=p&&J!==!0,K=G||H||Z;return A$({deleteKeyCode:d,multiSelectionKeyCode:v}),a.jsx($$,{onPaneContextMenu:i,elementsSelectable:w,zoomOnScroll:E,zoomOnPinch:N,panOnScroll:ee,panOnScrollSpeed:C,panOnScrollMode:M,zoomOnDoubleClick:z,panOnDrag:!G&&J,defaultViewport:k,translateExtent:T,minZoom:A,maxZoom:O,zoomActivationKeyCode:b,preventScrolling:R,noWheelClassName:F,noPanClassName:B,onViewportChange:I,isControlledViewport:U,paneClickDistance:u,selectionOnDrag:Z,children:a.jsxs(D$,{onSelectionStart:m,onSelectionEnd:_,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:s,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:l,panOnDrag:J,isSelecting:!!K,selectionMode:h,selectionKeyPressed:G,paneClickDistance:u,selectionOnDrag:Z,children:[e,V&&a.jsx(G$,{onSelectionContextMenu:L,noPanClassName:B,disableKeyboardA11y:q})]})})}Mb.displayName="FlowRenderer";const Q$=x.memo(Mb),Z$=e=>t=>e?Zf(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function J$(e){return Ft(x.useCallback(Z$(e),[e]),_n)}const eL=e=>e.updateNodeInternals;function tL(){const e=Ft(eL),[t]=x.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const s=new Map;n.forEach(r=>{const i=r.target.getAttribute("data-id");s.set(i,{id:i,nodeElement:r.target,force:!0})}),e(s)}));return x.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function nL({node:e,nodeType:t,hasDimensions:n,resizeObserver:s}){const r=dn(),i=x.useRef(null),l=x.useRef(null),u=x.useRef(e.sourcePosition),d=x.useRef(e.targetPosition),f=x.useRef(t),p=n&&!!e.internals.handleBounds;return x.useEffect(()=>{i.current&&!e.hidden&&(!p||l.current!==i.current)&&(l.current&&(s==null||s.unobserve(l.current)),s==null||s.observe(i.current),l.current=i.current)},[p,e.hidden]),x.useEffect(()=>()=>{l.current&&(s==null||s.unobserve(l.current),l.current=null)},[]),x.useEffect(()=>{if(i.current){const h=f.current!==t,m=u.current!==e.sourcePosition,_=d.current!==e.targetPosition;(h||m||_)&&(f.current=t,u.current=e.sourcePosition,d.current=e.targetPosition,r.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function sL({id:e,onClick:t,onMouseEnter:n,onMouseMove:s,onMouseLeave:r,onContextMenu:i,onDoubleClick:l,nodesDraggable:u,elementsSelectable:d,nodesConnectable:f,nodesFocusable:p,resizeObserver:h,noDragClassName:m,noPanClassName:_,disableKeyboardA11y:v,rfId:y,nodeTypes:b,nodeClickDistance:w,onError:E}){const{node:N,internals:j,isParent:C}=Ft(X=>{const Q=X.nodeLookup.get(e),ne=X.parentLookup.has(e);return{node:Q,internals:Q.internals,isParent:ne}},_n);let M=N.type||"default",z=(b==null?void 0:b[M])||Cb[M];z===void 0&&(E==null||E("003",Yr.error003(M)),M="default",z=(b==null?void 0:b.default)||Cb.default);const D=!!(N.draggable||u&&typeof N.draggable>"u"),k=!!(N.selectable||d&&typeof N.selectable>"u"),T=!!(N.connectable||f&&typeof N.connectable>"u"),A=!!(N.focusable||p&&typeof N.focusable>"u"),O=dn(),R=x0(N),L=nL({node:N,nodeType:M,hasDimensions:R,resizeObserver:h}),F=jb({nodeRef:L,disabled:N.hidden||!D,noDragClassName:m,handleSelector:N.dragHandle,nodeId:e,isSelectable:k,nodeClickDistance:w}),B=Sb();if(N.hidden)return null;const q=_a(N),I=Y$(N),U=k||D||t||n||s||r,V=n?X=>n(X,{...j.userNode}):void 0,H=s?X=>s(X,{...j.userNode}):void 0,G=r?X=>r(X,{...j.userNode}):void 0,W=i?X=>i(X,{...j.userNode}):void 0,J=l?X=>l(X,{...j.userNode}):void 0,ee=X=>{const{selectNodesOnDrag:Q,nodeDragThreshold:ne}=O.getState();k&&(!Q||!D||ne>0)&&yp({id:e,store:O,nodeRef:L}),t&&t(X,{...j.userNode})},Z=X=>{if(!(j0(X.nativeEvent)||v)){if(l0.includes(X.key)&&k){const Q=X.key==="Escape";yp({id:e,store:O,unselect:Q,nodeRef:L})}else if(D&&N.selected&&Object.prototype.hasOwnProperty.call(Vd,X.key)){X.preventDefault();const{ariaLabelConfig:Q}=O.getState();O.setState({ariaLiveMessage:Q["node.a11yDescription.ariaLiveMessage"]({direction:X.key.replace("Arrow","").toLowerCase(),x:~~j.positionAbsolute.x,y:~~j.positionAbsolute.y})}),B({direction:Vd[X.key],factor:X.shiftKey?4:1})}}},K=()=>{var ge;if(v||!((ge=L.current)!=null&&ge.matches(":focus-visible")))return;const{transform:X,width:Q,height:ne,autoPanOnNodeFocus:le,setCenter:ce}=O.getState();if(!le)return;Zf(new Map([[e,N]]),{x:0,y:0,width:Q,height:ne},X,!0).length>0||ce(N.position.x+q.width/2,N.position.y+q.height/2,{zoom:X[2]})};return a.jsx("div",{className:Vt(["react-flow__node",`react-flow__node-${M}`,{[_]:D},N.className,{selected:N.selected,selectable:k,parent:C,draggable:D,dragging:F}]),ref:L,style:{zIndex:j.z,transform:`translate(${j.positionAbsolute.x}px,${j.positionAbsolute.y}px)`,pointerEvents:U?"all":"none",visibility:R?"visible":"hidden",...N.style,...I},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:V,onMouseMove:H,onMouseLeave:G,onContextMenu:W,onClick:ee,onDoubleClick:J,onKeyDown:A?Z:void 0,tabIndex:A?0:void 0,onFocus:A?K:void 0,role:N.ariaRole??(A?"group":void 0),"aria-roledescription":"node","aria-describedby":v?void 0:`${ib}-${y}`,"aria-label":N.ariaLabel,...N.domAttributes,children:a.jsx(I$,{value:e,children:a.jsx(z,{id:e,data:N.data,type:M,positionAbsoluteX:j.positionAbsolute.x,positionAbsoluteY:j.positionAbsolute.y,selected:N.selected??!1,selectable:k,draggable:D,deletable:N.deletable??!0,isConnectable:T,sourcePosition:N.sourcePosition,targetPosition:N.targetPosition,dragging:F,dragHandle:N.dragHandle,zIndex:j.z,parentId:N.parentId,...q})})})}var rL=x.memo(sL);const aL=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ab(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:s,elementsSelectable:r,onError:i}=Ft(aL,_n),l=J$(e.onlyRenderVisibleElements),u=tL();return a.jsx("div",{className:"react-flow__nodes",style:Ud,children:l.map(d=>a.jsx(rL,{id:d,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:u,nodesDraggable:t,nodesConnectable:n,nodesFocusable:s,elementsSelectable:r,nodeClickDistance:e.nodeClickDistance,onError:i},d))})}Ab.displayName="NodeRenderer";const oL=x.memo(Ab);function iL(e){return Ft(x.useCallback(n=>{if(!e)return n.edges.map(r=>r.id);const s=[];if(n.width&&n.height)for(const r of n.edges){const i=n.nodeLookup.get(r.source),l=n.nodeLookup.get(r.target);i&&l&&aT({sourceNode:i,targetNode:l,width:n.width,height:n.height,transform:n.transform})&&s.push(r.id)}return s},[e]),_n)}const lL=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e}};return a.jsx("polyline",{className:"arrow",style:n,strokeLinecap:"round",fill:"none",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4"})},cL=({color:e="none",strokeWidth:t=1})=>{const n={strokeWidth:t,...e&&{stroke:e,fill:e}};return a.jsx("polyline",{className:"arrowclosed",style:n,strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"})},Ob={[Td.Arrow]:lL,[Td.ArrowClosed]:cL};function uL(e){const t=dn();return x.useMemo(()=>{var r,i;return Object.prototype.hasOwnProperty.call(Ob,e)?Ob[e]:((i=(r=t.getState()).onError)==null||i.call(r,"009",Yr.error009(e)),null)},[e])}const dL=({id:e,type:t,color:n,width:s=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:l,orient:u="auto-start-reverse"})=>{const d=uL(t);return d?a.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${s}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:u,refX:"0",refY:"0",children:a.jsx(d,{color:n,strokeWidth:l})}):null},Tb=({defaultColor:e,rfId:t})=>{const n=Ft(i=>i.edges),s=Ft(i=>i.defaultEdgeOptions),r=x.useMemo(()=>hT(n,{id:t,defaultColor:e,defaultMarkerStart:s==null?void 0:s.markerStart,defaultMarkerEnd:s==null?void 0:s.markerEnd}),[n,s,t,e]);return r.length?a.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:a.jsx("defs",{children:r.map(i=>a.jsx(dL,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Tb.displayName="MarkerDefinitions";var mL=x.memo(Tb);function $b({x:e,y:t,label:n,labelStyle:s,labelShowBg:r=!0,labelBgStyle:i,labelBgPadding:l=[2,4],labelBgBorderRadius:u=2,children:d,className:f,...p}){const[h,m]=x.useState({x:1,y:0,width:0,height:0}),_=Vt(["react-flow__edge-textwrapper",f]),v=x.useRef(null);return x.useEffect(()=>{if(v.current){const y=v.current.getBBox();m({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),n?a.jsxs("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:_,visibility:h.width?"visible":"hidden",...p,children:[r&&a.jsx("rect",{width:h.width+2*l[0],x:-l[0],y:-l[1],height:h.height+2*l[1],className:"react-flow__edge-textbg",style:i,rx:u,ry:u}),a.jsx("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:v,style:s,children:n}),d]}):null}$b.displayName="EdgeText";const hL=x.memo($b);function Kd({path:e,labelX:t,labelY:n,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,interactionWidth:f=20,...p}){return a.jsxs(a.Fragment,{children:[a.jsx("path",{...p,d:e,fill:"none",className:Vt(["react-flow__edge-path",p.className])}),f?a.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:f,className:"react-flow__edge-interaction"}):null,s&&Cr(t)&&Cr(n)?a.jsx(hL,{x:t,y:n,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d}):null]})}function Lb({pos:e,x1:t,y1:n,x2:s,y2:r}){return e===it.Left||e===it.Right?[.5*(t+s),n]:[t,.5*(n+r)]}function zb({sourceX:e,sourceY:t,sourcePosition:n=it.Bottom,targetX:s,targetY:r,targetPosition:i=it.Top}){const[l,u]=Lb({pos:n,x1:e,y1:t,x2:s,y2:r}),[d,f]=Lb({pos:i,x1:s,y1:r,x2:e,y2:t}),[p,h,m,_]=C0({sourceX:e,sourceY:t,targetX:s,targetY:r,sourceControlX:l,sourceControlY:u,targetControlX:d,targetControlY:f});return[`M${e},${t} C${l},${u} ${d},${f} ${s},${r}`,p,h,m,_]}function Rb(e){return x.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,sourcePosition:l,targetPosition:u,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:m,labelBgBorderRadius:_,style:v,markerEnd:y,markerStart:b,interactionWidth:w})=>{const[E,N,j]=zb({sourceX:n,sourceY:s,sourcePosition:l,targetX:r,targetY:i,targetPosition:u}),C=e.isInternal?void 0:t;return a.jsx(Kd,{id:C,path:E,labelX:N,labelY:j,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:m,labelBgBorderRadius:_,style:v,markerEnd:y,markerStart:b,interactionWidth:w})})}const fL=Rb({isInternal:!1}),Db=Rb({isInternal:!0});fL.displayName="SimpleBezierEdge",Db.displayName="SimpleBezierEdgeInternal";function Pb(e){return x.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:h,style:m,sourcePosition:_=it.Bottom,targetPosition:v=it.Top,markerEnd:y,markerStart:b,pathOptions:w,interactionWidth:E})=>{const[N,j,C]=np({sourceX:n,sourceY:s,sourcePosition:_,targetX:r,targetY:i,targetPosition:v,borderRadius:w==null?void 0:w.borderRadius,offset:w==null?void 0:w.offset,stepPosition:w==null?void 0:w.stepPosition}),M=e.isInternal?void 0:t;return a.jsx(Kd,{id:M,path:N,labelX:j,labelY:C,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:h,style:m,markerEnd:y,markerStart:b,interactionWidth:E})})}const Ib=Pb({isInternal:!1}),Fb=Pb({isInternal:!0});Ib.displayName="SmoothStepEdge",Fb.displayName="SmoothStepEdgeInternal";function Bb(e){return x.memo(({id:t,...n})=>{var r;const s=e.isInternal?void 0:t;return a.jsx(Ib,{...n,id:s,pathOptions:x.useMemo(()=>{var i;return{borderRadius:0,offset:(i=n.pathOptions)==null?void 0:i.offset}},[(r=n.pathOptions)==null?void 0:r.offset])})})}const pL=Bb({isInternal:!1}),Hb=Bb({isInternal:!0});pL.displayName="StepEdge",Hb.displayName="StepEdgeInternal";function Ub(e){return x.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:h,style:m,markerEnd:_,markerStart:v,interactionWidth:y})=>{const[b,w,E]=O0({sourceX:n,sourceY:s,targetX:r,targetY:i}),N=e.isInternal?void 0:t;return a.jsx(Kd,{id:N,path:b,labelX:w,labelY:E,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:f,labelBgPadding:p,labelBgBorderRadius:h,style:m,markerEnd:_,markerStart:v,interactionWidth:y})})}const gL=Ub({isInternal:!1}),qb=Ub({isInternal:!0});gL.displayName="StraightEdge",qb.displayName="StraightEdgeInternal";function Vb(e){return x.memo(({id:t,sourceX:n,sourceY:s,targetX:r,targetY:i,sourcePosition:l=it.Bottom,targetPosition:u=it.Top,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:m,labelBgBorderRadius:_,style:v,markerEnd:y,markerStart:b,pathOptions:w,interactionWidth:E})=>{const[N,j,C]=M0({sourceX:n,sourceY:s,sourcePosition:l,targetX:r,targetY:i,targetPosition:u,curvature:w==null?void 0:w.curvature}),M=e.isInternal?void 0:t;return a.jsx(Kd,{id:M,path:N,labelX:j,labelY:C,label:d,labelStyle:f,labelShowBg:p,labelBgStyle:h,labelBgPadding:m,labelBgBorderRadius:_,style:v,markerEnd:y,markerStart:b,interactionWidth:E})})}const _L=Vb({isInternal:!1}),Kb=Vb({isInternal:!0});_L.displayName="BezierEdge",Kb.displayName="BezierEdgeInternal";const Yb={default:Kb,straight:qb,step:Hb,smoothstep:Fb,simplebezier:Db},Wb={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},yL=(e,t,n)=>n===it.Left?e-t:n===it.Right?e+t:e,vL=(e,t,n)=>n===it.Top?e-t:n===it.Bottom?e+t:e,Gb="react-flow__edgeupdater";function Xb({position:e,centerX:t,centerY:n,radius:s=10,onMouseDown:r,onMouseEnter:i,onMouseOut:l,type:u}){return a.jsx("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:l,className:Vt([Gb,`${Gb}-${u}`]),cx:yL(t,s,e),cy:vL(n,s,e),r:s,stroke:"transparent",fill:"transparent"})}function xL({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:s,sourceY:r,targetX:i,targetY:l,sourcePosition:u,targetPosition:d,onReconnect:f,onReconnectStart:p,onReconnectEnd:h,setReconnecting:m,setUpdateHover:_}){const v=dn(),y=(j,C)=>{if(j.button!==0)return;const{autoPanOnConnect:M,domNode:z,isValidConnection:D,connectionMode:k,connectionRadius:T,lib:A,onConnectStart:O,onConnectEnd:R,cancelConnection:L,nodeLookup:F,rfId:B,panBy:q,updateConnection:I}=v.getState(),U=C.type==="target",V=(W,J)=>{m(!1),h==null||h(W,n,C.type,J)},H=W=>f==null?void 0:f(n,W),G=(W,J)=>{m(!0),p==null||p(j,n,C.type),O==null||O(W,J)};up.onPointerDown(j.nativeEvent,{autoPanOnConnect:M,connectionMode:k,connectionRadius:T,domNode:z,handleId:C.id,nodeId:C.nodeId,nodeLookup:F,isTarget:U,edgeUpdaterType:C.type,lib:A,flowId:B,cancelConnection:L,panBy:q,isValidConnection:D,onConnect:H,onConnectStart:G,onConnectEnd:R,onReconnectEnd:V,updateConnection:I,getTransform:()=>v.getState().transform,getFromHandle:()=>v.getState().connection.fromHandle,dragThreshold:v.getState().connectionDragThreshold,handleDomNode:j.currentTarget})},b=j=>y(j,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),w=j=>y(j,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),E=()=>_(!0),N=()=>_(!1);return a.jsxs(a.Fragment,{children:[(e===!0||e==="source")&&a.jsx(Xb,{position:u,centerX:s,centerY:r,radius:t,onMouseDown:b,onMouseEnter:E,onMouseOut:N,type:"source"}),(e===!0||e==="target")&&a.jsx(Xb,{position:d,centerX:i,centerY:l,radius:t,onMouseDown:w,onMouseEnter:E,onMouseOut:N,type:"target"})]})}function bL({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:s,onClick:r,onDoubleClick:i,onContextMenu:l,onMouseEnter:u,onMouseMove:d,onMouseLeave:f,reconnectRadius:p,onReconnect:h,onReconnectStart:m,onReconnectEnd:_,rfId:v,edgeTypes:y,noPanClassName:b,onError:w,disableKeyboardA11y:E}){let N=Ft(ce=>ce.edgeLookup.get(e));const j=Ft(ce=>ce.defaultEdgeOptions);N=j?{...j,...N}:N;let C=N.type||"default",M=(y==null?void 0:y[C])||Yb[C];M===void 0&&(w==null||w("011",Yr.error011(C)),C="default",M=(y==null?void 0:y.default)||Yb.default);const z=!!(N.focusable||t&&typeof N.focusable>"u"),D=typeof h<"u"&&(N.reconnectable||n&&typeof N.reconnectable>"u"),k=!!(N.selectable||s&&typeof N.selectable>"u"),T=x.useRef(null),[A,O]=x.useState(!1),[R,L]=x.useState(!1),F=dn(),{zIndex:B,sourceX:q,sourceY:I,targetX:U,targetY:V,sourcePosition:H,targetPosition:G}=Ft(x.useCallback(ce=>{const ie=ce.nodeLookup.get(N.source),ge=ce.nodeLookup.get(N.target);if(!ie||!ge)return{zIndex:N.zIndex,...Wb};const Re=mT({id:e,sourceNode:ie,targetNode:ge,sourceHandle:N.sourceHandle||null,targetHandle:N.targetHandle||null,connectionMode:ce.connectionMode,onError:w});return{zIndex:rT({selected:N.selected,zIndex:N.zIndex,sourceNode:ie,targetNode:ge,elevateOnSelect:ce.elevateEdgesOnSelect}),...Re||Wb}},[N.source,N.target,N.sourceHandle,N.targetHandle,N.selected,N.zIndex]),_n),W=x.useMemo(()=>N.markerStart?`url('#${sp(N.markerStart,v)}')`:void 0,[N.markerStart,v]),J=x.useMemo(()=>N.markerEnd?`url('#${sp(N.markerEnd,v)}')`:void 0,[N.markerEnd,v]);if(N.hidden||q===null||I===null||U===null||V===null)return null;const ee=ce=>{var ze;const{addSelectedEdges:ie,unselectNodesAndEdges:ge,multiSelectionActive:Re}=F.getState();k&&(F.setState({nodesSelectionActive:!1}),N.selected&&Re?(ge({nodes:[],edges:[N]}),(ze=T.current)==null||ze.blur()):ie([e])),r&&r(ce,N)},Z=i?ce=>{i(ce,{...N})}:void 0,K=l?ce=>{l(ce,{...N})}:void 0,X=u?ce=>{u(ce,{...N})}:void 0,Q=d?ce=>{d(ce,{...N})}:void 0,ne=f?ce=>{f(ce,{...N})}:void 0,le=ce=>{var ie;if(!E&&l0.includes(ce.key)&&k){const{unselectNodesAndEdges:ge,addSelectedEdges:Re}=F.getState();ce.key==="Escape"?((ie=T.current)==null||ie.blur(),ge({edges:[N]})):Re([e])}};return a.jsx("svg",{style:{zIndex:B},children:a.jsxs("g",{className:Vt(["react-flow__edge",`react-flow__edge-${C}`,N.className,b,{selected:N.selected,animated:N.animated,inactive:!k&&!r,updating:A,selectable:k}]),onClick:ee,onDoubleClick:Z,onContextMenu:K,onMouseEnter:X,onMouseMove:Q,onMouseLeave:ne,onKeyDown:z?le:void 0,tabIndex:z?0:void 0,role:N.ariaRole??(z?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":N.ariaLabel===null?void 0:N.ariaLabel||`Edge from ${N.source} to ${N.target}`,"aria-describedby":z?`${lb}-${v}`:void 0,ref:T,...N.domAttributes,children:[!R&&a.jsx(M,{id:e,source:N.source,target:N.target,type:N.type,selected:N.selected,animated:N.animated,selectable:k,deletable:N.deletable??!0,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,sourceX:q,sourceY:I,targetX:U,targetY:V,sourcePosition:H,targetPosition:G,data:N.data,style:N.style,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerStart:W,markerEnd:J,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth}),D&&a.jsx(xL,{edge:N,isReconnectable:D,reconnectRadius:p,onReconnect:h,onReconnectStart:m,onReconnectEnd:_,sourceX:q,sourceY:I,targetX:U,targetY:V,sourcePosition:H,targetPosition:G,setUpdateHover:O,setReconnecting:L})]})})}var wL=x.memo(bL);const NL=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Qb({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:s,noPanClassName:r,onReconnect:i,onEdgeContextMenu:l,onEdgeMouseEnter:u,onEdgeMouseMove:d,onEdgeMouseLeave:f,onEdgeClick:p,reconnectRadius:h,onEdgeDoubleClick:m,onReconnectStart:_,onReconnectEnd:v,disableKeyboardA11y:y}){const{edgesFocusable:b,edgesReconnectable:w,elementsSelectable:E,onError:N}=Ft(NL,_n),j=iL(t);return a.jsxs("div",{className:"react-flow__edges",children:[a.jsx(mL,{defaultColor:e,rfId:n}),j.map(C=>a.jsx(wL,{id:C,edgesFocusable:b,edgesReconnectable:w,elementsSelectable:E,noPanClassName:r,onReconnect:i,onContextMenu:l,onMouseEnter:u,onMouseMove:d,onMouseLeave:f,onClick:p,reconnectRadius:h,onDoubleClick:m,onReconnectStart:_,onReconnectEnd:v,rfId:n,onError:N,edgeTypes:s,disableKeyboardA11y:y},C))]})}Qb.displayName="EdgeRenderer";const jL=x.memo(Qb),SL=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function EL({children:e}){const t=Ft(SL);return a.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function CL(e){const t=gp(),n=x.useRef(!1);x.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const kL=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function ML(e){const t=Ft(kL),n=dn();return x.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function AL(e){return e.connection.inProgress?{...e.connection,to:Lc(e.connection.to,e.transform)}:{...e.connection}}function OL(e){return AL}function TL(e){const t=OL();return Ft(t,_n)}const $L=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function LL({containerStyle:e,style:t,type:n,component:s}){const{nodesConnectable:r,width:i,height:l,isValid:u,inProgress:d}=Ft($L,_n);return!(i&&r&&d)?null:a.jsx("svg",{style:e,width:i,height:l,className:"react-flow__connectionline react-flow__container",children:a.jsx("g",{className:Vt(["react-flow__connection",m0(u)]),children:a.jsx(Zb,{style:t,type:n,CustomComponent:s,isValid:u})})})}const Zb=({style:e,type:t=Xa.Bezier,CustomComponent:n,isValid:s})=>{const{inProgress:r,from:i,fromNode:l,fromHandle:u,fromPosition:d,to:f,toNode:p,toHandle:h,toPosition:m,pointer:_}=TL();if(!r)return;if(n)return a.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:l,fromHandle:u,fromX:i.x,fromY:i.y,toX:f.x,toY:f.y,fromPosition:d,toPosition:m,connectionStatus:m0(s),toNode:p,toHandle:h,pointer:_});let v="";const y={sourceX:i.x,sourceY:i.y,sourcePosition:d,targetX:f.x,targetY:f.y,targetPosition:m};switch(t){case Xa.Bezier:[v]=M0(y);break;case Xa.SimpleBezier:[v]=zb(y);break;case Xa.Step:[v]=np({...y,borderRadius:0});break;case Xa.SmoothStep:[v]=np(y);break;default:[v]=O0(y)}return a.jsx("path",{d:v,fill:"none",className:"react-flow__connection-path",style:e})};Zb.displayName="ConnectionLine";const zL={};function Jb(e=zL){x.useRef(e),dn(),x.useEffect(()=>{},[e])}function RL(){dn(),x.useRef(!1),x.useEffect(()=>{},[])}function ew({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:s,onEdgeClick:r,onNodeDoubleClick:i,onEdgeDoubleClick:l,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,onSelectionContextMenu:h,onSelectionStart:m,onSelectionEnd:_,connectionLineType:v,connectionLineStyle:y,connectionLineComponent:b,connectionLineContainerStyle:w,selectionKeyCode:E,selectionOnDrag:N,selectionMode:j,multiSelectionKeyCode:C,panActivationKeyCode:M,zoomActivationKeyCode:z,deleteKeyCode:D,onlyRenderVisibleElements:k,elementsSelectable:T,defaultViewport:A,translateExtent:O,minZoom:R,maxZoom:L,preventScrolling:F,defaultMarkerColor:B,zoomOnScroll:q,zoomOnPinch:I,panOnScroll:U,panOnScrollSpeed:V,panOnScrollMode:H,zoomOnDoubleClick:G,panOnDrag:W,onPaneClick:J,onPaneMouseEnter:ee,onPaneMouseMove:Z,onPaneMouseLeave:K,onPaneScroll:X,onPaneContextMenu:Q,paneClickDistance:ne,nodeClickDistance:le,onEdgeContextMenu:ce,onEdgeMouseEnter:ie,onEdgeMouseMove:ge,onEdgeMouseLeave:Re,reconnectRadius:ze,onReconnect:me,onReconnectStart:xe,onReconnectEnd:Ce,noDragClassName:Ae,noWheelClassName:Ve,noPanClassName:Se,disableKeyboardA11y:We,nodeExtent:ht,rfId:ye,viewport:Fe,onViewportChange:Qe}){return Jb(e),Jb(t),RL(),CL(n),ML(Fe),a.jsx(Q$,{onPaneClick:J,onPaneMouseEnter:ee,onPaneMouseMove:Z,onPaneMouseLeave:K,onPaneContextMenu:Q,onPaneScroll:X,paneClickDistance:ne,deleteKeyCode:D,selectionKeyCode:E,selectionOnDrag:N,selectionMode:j,onSelectionStart:m,onSelectionEnd:_,multiSelectionKeyCode:C,panActivationKeyCode:M,zoomActivationKeyCode:z,elementsSelectable:T,zoomOnScroll:q,zoomOnPinch:I,zoomOnDoubleClick:G,panOnScroll:U,panOnScrollSpeed:V,panOnScrollMode:H,panOnDrag:W,defaultViewport:A,translateExtent:O,minZoom:R,maxZoom:L,onSelectionContextMenu:h,preventScrolling:F,noDragClassName:Ae,noWheelClassName:Ve,noPanClassName:Se,disableKeyboardA11y:We,onViewportChange:Qe,isControlledViewport:!!Fe,children:a.jsxs(EL,{children:[a.jsx(jL,{edgeTypes:t,onEdgeClick:r,onEdgeDoubleClick:l,onReconnect:me,onReconnectStart:xe,onReconnectEnd:Ce,onlyRenderVisibleElements:k,onEdgeContextMenu:ce,onEdgeMouseEnter:ie,onEdgeMouseMove:ge,onEdgeMouseLeave:Re,reconnectRadius:ze,defaultMarkerColor:B,noPanClassName:Se,disableKeyboardA11y:We,rfId:ye}),a.jsx(LL,{style:y,type:v,component:b,containerStyle:w}),a.jsx("div",{className:"react-flow__edgelabel-renderer"}),a.jsx(oL,{nodeTypes:e,onNodeClick:s,onNodeDoubleClick:i,onNodeMouseEnter:u,onNodeMouseMove:d,onNodeMouseLeave:f,onNodeContextMenu:p,nodeClickDistance:le,onlyRenderVisibleElements:k,noPanClassName:Se,noDragClassName:Ae,disableKeyboardA11y:We,nodeExtent:ht,rfId:ye}),a.jsx("div",{className:"react-flow__viewport-portal"})]})})}ew.displayName="GraphView";const DL=x.memo(ew),tw=({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:r,height:i,fitView:l,fitViewOptions:u,minZoom:d=.5,maxZoom:f=2,nodeOrigin:p,nodeExtent:h}={})=>{const m=new Map,_=new Map,v=new Map,y=new Map,b=s??t??[],w=n??e??[],E=p??[0,0],N=h??kc;F0(v,y,b);const j=op(w,m,_,{nodeOrigin:E,nodeExtent:N,elevateNodesOnSelect:!1});let C=[0,0,1];if(l&&r&&i){const M=Oc(m,{filter:T=>!!((T.width||T.initialWidth)&&(T.height||T.initialHeight))}),{x:z,y:D,zoom:k}=ep(M,r,i,d,f,(u==null?void 0:u.padding)??.1);C=[z,D,k]}return{rfId:"1",width:r??0,height:i??0,transform:C,nodes:w,nodesInitialized:j,nodeLookup:m,parentLookup:_,edges:b,edgeLookup:y,connectionLookup:v,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:s!==void 0,panZoom:null,minZoom:d,maxZoom:f,translateExtent:kc,nodeExtent:N,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:ll.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:E,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:l??!1,fitViewOptions:u,fitViewResolver:null,connection:{...u0},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:Z2,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:c0}},PL=({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:r,height:i,fitView:l,fitViewOptions:u,minZoom:d,maxZoom:f,nodeOrigin:p,nodeExtent:h})=>t$((m,_)=>{async function v(){const{nodeLookup:y,panZoom:b,fitViewOptions:w,fitViewResolver:E,width:N,height:j,minZoom:C,maxZoom:M}=_();b&&(await X2({nodes:y,width:N,height:j,panZoom:b,minZoom:C,maxZoom:M},w),E==null||E.resolve(!0),m({fitViewResolver:null}))}return{...tw({nodes:e,edges:t,width:r,height:i,fitView:l,fitViewOptions:u,minZoom:d,maxZoom:f,nodeOrigin:p,nodeExtent:h,defaultNodes:n,defaultEdges:s}),setNodes:y=>{const{nodeLookup:b,parentLookup:w,nodeOrigin:E,elevateNodesOnSelect:N,fitViewQueued:j}=_(),C=op(y,b,w,{nodeOrigin:E,nodeExtent:h,elevateNodesOnSelect:N,checkEquality:!0});j&&C?(v(),m({nodes:y,nodesInitialized:C,fitViewQueued:!1,fitViewOptions:void 0})):m({nodes:y,nodesInitialized:C})},setEdges:y=>{const{connectionLookup:b,edgeLookup:w}=_();F0(b,w,y),m({edges:y})},setDefaultNodesAndEdges:(y,b)=>{if(y){const{setNodes:w}=_();w(y),m({hasDefaultNodes:!0})}if(b){const{setEdges:w}=_();w(b),m({hasDefaultEdges:!0})}},updateNodeInternals:y=>{const{triggerNodeChanges:b,nodeLookup:w,parentLookup:E,domNode:N,nodeOrigin:j,nodeExtent:C,debug:M,fitViewQueued:z}=_(),{changes:D,updatedInternals:k}=xT(y,w,E,N,j,C);k&&(gT(w,E,{nodeOrigin:j,nodeExtent:C}),z?(v(),m({fitViewQueued:!1,fitViewOptions:void 0})):m({}),(D==null?void 0:D.length)>0&&(M&&console.log("React Flow: trigger node changes",D),b==null||b(D)))},updateNodePositions:(y,b=!1)=>{const w=[],E=[],{nodeLookup:N,triggerNodeChanges:j}=_();for(const[C,M]of y){const z=N.get(C),D=!!(z!=null&&z.expandParent&&(z!=null&&z.parentId)&&(M!=null&&M.position)),k={id:C,type:"position",position:D?{x:Math.max(0,M.position.x),y:Math.max(0,M.position.y)}:M.position,dragging:b};D&&z.parentId&&w.push({id:C,parentId:z.parentId,rect:{...M.internals.positionAbsolute,width:M.measured.width??0,height:M.measured.height??0}}),E.push(k)}if(w.length>0){const{parentLookup:C,nodeOrigin:M}=_(),z=lp(w,N,C,M);E.push(...z)}j(E)},triggerNodeChanges:y=>{const{onNodesChange:b,setNodes:w,nodes:E,hasDefaultNodes:N,debug:j}=_();if(y!=null&&y.length){if(N){const C=b$(y,E);w(C)}j&&console.log("React Flow: trigger node changes",y),b==null||b(y)}},triggerEdgeChanges:y=>{const{onEdgesChange:b,setEdges:w,edges:E,hasDefaultEdges:N,debug:j}=_();if(y!=null&&y.length){if(N){const C=w$(y,E);w(C)}j&&console.log("React Flow: trigger edge changes",y),b==null||b(y)}},addSelectedNodes:y=>{const{multiSelectionActive:b,edgeLookup:w,nodeLookup:E,triggerNodeChanges:N,triggerEdgeChanges:j}=_();if(b){const C=y.map(M=>Zo(M,!0));N(C);return}N(pl(E,new Set([...y]),!0)),j(pl(w))},addSelectedEdges:y=>{const{multiSelectionActive:b,edgeLookup:w,nodeLookup:E,triggerNodeChanges:N,triggerEdgeChanges:j}=_();if(b){const C=y.map(M=>Zo(M,!0));j(C);return}j(pl(w,new Set([...y]))),N(pl(E,new Set,!0))},unselectNodesAndEdges:({nodes:y,edges:b}={})=>{const{edges:w,nodes:E,nodeLookup:N,triggerNodeChanges:j,triggerEdgeChanges:C}=_(),M=y||E,z=b||w,D=M.map(T=>{const A=N.get(T.id);return A&&(A.selected=!1),Zo(T.id,!1)}),k=z.map(T=>Zo(T.id,!1));j(D),C(k)},setMinZoom:y=>{const{panZoom:b,maxZoom:w}=_();b==null||b.setScaleExtent([y,w]),m({minZoom:y})},setMaxZoom:y=>{const{panZoom:b,minZoom:w}=_();b==null||b.setScaleExtent([w,y]),m({maxZoom:y})},setTranslateExtent:y=>{var b;(b=_().panZoom)==null||b.setTranslateExtent(y),m({translateExtent:y})},resetSelectedElements:()=>{const{edges:y,nodes:b,triggerNodeChanges:w,triggerEdgeChanges:E,elementsSelectable:N}=_();if(!N)return;const j=b.reduce((M,z)=>z.selected?[...M,Zo(z.id,!1)]:M,[]),C=y.reduce((M,z)=>z.selected?[...M,Zo(z.id,!1)]:M,[]);w(j),E(C)},setNodeExtent:y=>{const{nodes:b,nodeLookup:w,parentLookup:E,nodeOrigin:N,elevateNodesOnSelect:j,nodeExtent:C}=_();y[0][0]===C[0][0]&&y[0][1]===C[0][1]&&y[1][0]===C[1][0]&&y[1][1]===C[1][1]||(op(b,w,E,{nodeOrigin:N,nodeExtent:y,elevateNodesOnSelect:j,checkEquality:!1}),m({nodeExtent:y}))},panBy:y=>{const{transform:b,width:w,height:E,panZoom:N,translateExtent:j}=_();return bT({delta:y,panZoom:N,transform:b,translateExtent:j,width:w,height:E})},setCenter:async(y,b,w)=>{const{width:E,height:N,maxZoom:j,panZoom:C}=_();if(!C)return Promise.resolve(!1);const M=typeof(w==null?void 0:w.zoom)<"u"?w.zoom:j;return await C.setViewport({x:E/2-y*M,y:N/2-b*M,zoom:M},{duration:w==null?void 0:w.duration,ease:w==null?void 0:w.ease,interpolate:w==null?void 0:w.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{m({connection:{...u0}})},updateConnection:y=>{m({connection:y})},reset:()=>m({...tw()})}},Object.is);function IL({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:s,initialWidth:r,initialHeight:i,initialMinZoom:l,initialMaxZoom:u,initialFitViewOptions:d,fitView:f,nodeOrigin:p,nodeExtent:h,children:m}){const[_]=x.useState(()=>PL({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,width:r,height:i,fitView:f,minZoom:l,maxZoom:u,fitViewOptions:d,nodeOrigin:p,nodeExtent:h}));return a.jsx(n$,{value:_,children:a.jsx(E$,{children:m})})}function FL({children:e,nodes:t,edges:n,defaultNodes:s,defaultEdges:r,width:i,height:l,fitView:u,fitViewOptions:d,minZoom:f,maxZoom:p,nodeOrigin:h,nodeExtent:m}){return x.useContext(Fd)?a.jsx(a.Fragment,{children:e}):a.jsx(IL,{initialNodes:t,initialEdges:n,defaultNodes:s,defaultEdges:r,initialWidth:i,initialHeight:l,fitView:u,initialFitViewOptions:d,initialMinZoom:f,initialMaxZoom:p,nodeOrigin:h,nodeExtent:m,children:e})}const BL={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function HL({nodes:e,edges:t,defaultNodes:n,defaultEdges:s,className:r,nodeTypes:i,edgeTypes:l,onNodeClick:u,onEdgeClick:d,onInit:f,onMove:p,onMoveStart:h,onMoveEnd:m,onConnect:_,onConnectStart:v,onConnectEnd:y,onClickConnectStart:b,onClickConnectEnd:w,onNodeMouseEnter:E,onNodeMouseMove:N,onNodeMouseLeave:j,onNodeContextMenu:C,onNodeDoubleClick:M,onNodeDragStart:z,onNodeDrag:D,onNodeDragStop:k,onNodesDelete:T,onEdgesDelete:A,onDelete:O,onSelectionChange:R,onSelectionDragStart:L,onSelectionDrag:F,onSelectionDragStop:B,onSelectionContextMenu:q,onSelectionStart:I,onSelectionEnd:U,onBeforeDelete:V,connectionMode:H,connectionLineType:G=Xa.Bezier,connectionLineStyle:W,connectionLineComponent:J,connectionLineContainerStyle:ee,deleteKeyCode:Z="Backspace",selectionKeyCode:K="Shift",selectionOnDrag:X=!1,selectionMode:Q=Mc.Full,panActivationKeyCode:ne="Space",multiSelectionKeyCode:le=zc()?"Meta":"Control",zoomActivationKeyCode:ce=zc()?"Meta":"Control",snapToGrid:ie,snapGrid:ge,onlyRenderVisibleElements:Re=!1,selectNodesOnDrag:ze,nodesDraggable:me,autoPanOnNodeFocus:xe,nodesConnectable:Ce,nodesFocusable:Ae,nodeOrigin:Ve=cb,edgesFocusable:Se,edgesReconnectable:We,elementsSelectable:ht=!0,defaultViewport:ye=p$,minZoom:Fe=.5,maxZoom:Qe=2,translateExtent:tt=kc,preventScrolling:xt=!0,nodeExtent:_t,defaultMarkerColor:Bt="#b1b1b7",zoomOnScroll:$e=!0,zoomOnPinch:Ie=!0,panOnScroll:Be=!1,panOnScrollSpeed:Ee=.5,panOnScrollMode:lt=Xo.Free,zoomOnDoubleClick:Je=!0,panOnDrag:Ue=!0,onPaneClick:Rt,onPaneMouseEnter:Yt,onPaneMouseMove:bt,onPaneMouseLeave:Ot,onPaneScroll:Pt,onPaneContextMenu:wt,paneClickDistance:pt=1,nodeClickDistance:rn=0,children:Jt,onReconnect:tn,onReconnectStart:Pe,onReconnectEnd:Wt,onEdgeContextMenu:mn,onEdgeDoubleClick:Fn,onEdgeMouseEnter:Gt,onEdgeMouseMove:jt,onEdgeMouseLeave:Bn,reconnectRadius:ts=10,onNodesChange:Hn,onEdgesChange:Sn,noDragClassName:Un="nodrag",noWheelClassName:ns="nowheel",noPanClassName:cn="nopan",fitView:Mn,fitViewOptions:Mt,connectOnClick:An,attributionPosition:hs,proOptions:Qn,defaultEdgeOptions:qs,elevateNodesOnSelect:Vs,elevateEdgesOnSelect:As,disableKeyboardA11y:en=!1,autoPanOnConnect:et,autoPanOnNodeDrag:Qt,autoPanSpeed:ss,connectionRadius:Ks,isValidConnection:Os,onError:Nt,style:vs,id:de,nodeDragThreshold:be,connectionDragThreshold:qe,viewport:gt,onViewportChange:Le,width:Lt,height:Tt,colorMode:an="light",debug:hn,onScroll:Ct,ariaLabelConfig:On,...sr},Tn){const qn=de||"1",Ys=y$(an),$n=x.useCallback(rs=>{rs.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),Ct==null||Ct(rs)},[Ct]);return a.jsx("div",{"data-testid":"rf__wrapper",...sr,onScroll:$n,style:{...vs,...BL},ref:Tn,className:Vt(["react-flow",r,Ys]),id:de,role:"application",children:a.jsxs(FL,{nodes:e,edges:t,width:Lt,height:Tt,fitView:Mn,fitViewOptions:Mt,minZoom:Fe,maxZoom:Qe,nodeOrigin:Ve,nodeExtent:_t,children:[a.jsx(DL,{onInit:f,onNodeClick:u,onEdgeClick:d,onNodeMouseEnter:E,onNodeMouseMove:N,onNodeMouseLeave:j,onNodeContextMenu:C,onNodeDoubleClick:M,nodeTypes:i,edgeTypes:l,connectionLineType:G,connectionLineStyle:W,connectionLineComponent:J,connectionLineContainerStyle:ee,selectionKeyCode:K,selectionOnDrag:X,selectionMode:Q,deleteKeyCode:Z,multiSelectionKeyCode:le,panActivationKeyCode:ne,zoomActivationKeyCode:ce,onlyRenderVisibleElements:Re,defaultViewport:ye,translateExtent:tt,minZoom:Fe,maxZoom:Qe,preventScrolling:xt,zoomOnScroll:$e,zoomOnPinch:Ie,zoomOnDoubleClick:Je,panOnScroll:Be,panOnScrollSpeed:Ee,panOnScrollMode:lt,panOnDrag:Ue,onPaneClick:Rt,onPaneMouseEnter:Yt,onPaneMouseMove:bt,onPaneMouseLeave:Ot,onPaneScroll:Pt,onPaneContextMenu:wt,paneClickDistance:pt,nodeClickDistance:rn,onSelectionContextMenu:q,onSelectionStart:I,onSelectionEnd:U,onReconnect:tn,onReconnectStart:Pe,onReconnectEnd:Wt,onEdgeContextMenu:mn,onEdgeDoubleClick:Fn,onEdgeMouseEnter:Gt,onEdgeMouseMove:jt,onEdgeMouseLeave:Bn,reconnectRadius:ts,defaultMarkerColor:Bt,noDragClassName:Un,noWheelClassName:ns,noPanClassName:cn,rfId:qn,disableKeyboardA11y:en,nodeExtent:_t,viewport:gt,onViewportChange:Le}),a.jsx(_$,{nodes:e,edges:t,defaultNodes:n,defaultEdges:s,onConnect:_,onConnectStart:v,onConnectEnd:y,onClickConnectStart:b,onClickConnectEnd:w,nodesDraggable:me,autoPanOnNodeFocus:xe,nodesConnectable:Ce,nodesFocusable:Ae,edgesFocusable:Se,edgesReconnectable:We,elementsSelectable:ht,elevateNodesOnSelect:Vs,elevateEdgesOnSelect:As,minZoom:Fe,maxZoom:Qe,nodeExtent:_t,onNodesChange:Hn,onEdgesChange:Sn,snapToGrid:ie,snapGrid:ge,connectionMode:H,translateExtent:tt,connectOnClick:An,defaultEdgeOptions:qs,fitView:Mn,fitViewOptions:Mt,onNodesDelete:T,onEdgesDelete:A,onDelete:O,onNodeDragStart:z,onNodeDrag:D,onNodeDragStop:k,onSelectionDrag:F,onSelectionDragStart:L,onSelectionDragStop:B,onMove:p,onMoveStart:h,onMoveEnd:m,noPanClassName:cn,nodeOrigin:Ve,rfId:qn,autoPanOnConnect:et,autoPanOnNodeDrag:Qt,autoPanSpeed:ss,onError:Nt,connectionRadius:Ks,isValidConnection:Os,selectNodesOnDrag:ze,nodeDragThreshold:be,connectionDragThreshold:qe,onBeforeDelete:V,debug:hn,ariaLabelConfig:On}),a.jsx(f$,{onSelectionChange:R}),Jt,a.jsx(c$,{proOptions:Qn,position:hs}),a.jsx(l$,{rfId:qn,disableKeyboardA11y:en})]})})}xb(HL);function UL({dimensions:e,lineWidth:t,variant:n,className:s}){return a.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:Vt(["react-flow__background-pattern",n,s])})}function qL({radius:e,className:t}){return a.jsx("circle",{cx:e,cy:e,r:e,className:Vt(["react-flow__background-pattern","dots",t])})}var Ja;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Ja||(Ja={}));const VL={[Ja.Dots]:1,[Ja.Lines]:1,[Ja.Cross]:6},KL=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function nw({id:e,variant:t=Ja.Dots,gap:n=20,size:s,lineWidth:r=1,offset:i=0,color:l,bgColor:u,style:d,className:f,patternClassName:p}){const h=x.useRef(null),{transform:m,patternId:_}=Ft(KL,_n),v=s||VL[t],y=t===Ja.Dots,b=t===Ja.Cross,w=Array.isArray(n)?n:[n,n],E=[w[0]*m[2]||1,w[1]*m[2]||1],N=v*m[2],j=Array.isArray(i)?i:[i,i],C=b?[N,N]:E,M=[j[0]*m[2]||1+C[0]/2,j[1]*m[2]||1+C[1]/2],z=`${_}${e||""}`;return a.jsxs("svg",{className:Vt(["react-flow__background",f]),style:{...d,...Ud,"--xy-background-color-props":u,"--xy-background-pattern-color-props":l},ref:h,"data-testid":"rf__background",children:[a.jsx("pattern",{id:z,x:m[0]%E[0],y:m[1]%E[1],width:E[0],height:E[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${M[0]},-${M[1]})`,children:y?a.jsx(qL,{radius:N/2,className:p}):a.jsx(UL,{dimensions:C,lineWidth:r,variant:t,className:p})}),a.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${z})`})]})}nw.displayName="Background",x.memo(nw);function YL(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:a.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function WL(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:a.jsx("path",{d:"M0 0h32v4.2H0z"})})}function GL(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:a.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function XL(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:a.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function QL(){return a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:a.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function Yd({children:e,className:t,...n}){return a.jsx("button",{type:"button",className:Vt(["react-flow__controls-button",t]),...n,children:e})}const ZL=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function sw({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:s=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:l,onFitView:u,onInteractiveChange:d,className:f,children:p,position:h="bottom-left",orientation:m="vertical","aria-label":_}){const v=dn(),{isInteractive:y,minZoomReached:b,maxZoomReached:w,ariaLabelConfig:E}=Ft(ZL,_n),{zoomIn:N,zoomOut:j,fitView:C}=gp(),M=()=>{N(),i==null||i()},z=()=>{j(),l==null||l()},D=()=>{C(r),u==null||u()},k=()=>{v.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),d==null||d(!y)},T=m==="horizontal"?"horizontal":"vertical";return a.jsxs(Bd,{className:Vt(["react-flow__controls",T,f]),position:h,style:e,"data-testid":"rf__controls","aria-label":_??E["controls.ariaLabel"],children:[t&&a.jsxs(a.Fragment,{children:[a.jsx(Yd,{onClick:M,className:"react-flow__controls-zoomin",title:E["controls.zoomIn.ariaLabel"],"aria-label":E["controls.zoomIn.ariaLabel"],disabled:w,children:a.jsx(YL,{})}),a.jsx(Yd,{onClick:z,className:"react-flow__controls-zoomout",title:E["controls.zoomOut.ariaLabel"],"aria-label":E["controls.zoomOut.ariaLabel"],disabled:b,children:a.jsx(WL,{})})]}),n&&a.jsx(Yd,{className:"react-flow__controls-fitview",onClick:D,title:E["controls.fitView.ariaLabel"],"aria-label":E["controls.fitView.ariaLabel"],children:a.jsx(GL,{})}),s&&a.jsx(Yd,{className:"react-flow__controls-interactive",onClick:k,title:E["controls.interactive.ariaLabel"],"aria-label":E["controls.interactive.ariaLabel"],children:y?a.jsx(QL,{}):a.jsx(XL,{})}),p]})}sw.displayName="Controls",x.memo(sw);function JL({id:e,x:t,y:n,width:s,height:r,style:i,color:l,strokeColor:u,strokeWidth:d,className:f,borderRadius:p,shapeRendering:h,selected:m,onClick:_}){const{background:v,backgroundColor:y}=i||{},b=l||v||y;return a.jsx("rect",{className:Vt(["react-flow__minimap-node",{selected:m},f]),x:t,y:n,rx:p,ry:p,width:s,height:r,style:{fill:b,stroke:u,strokeWidth:d},shapeRendering:h,onClick:_?w=>_(w,e):void 0})}const ez=x.memo(JL),tz=e=>e.nodes.map(t=>t.id),xp=e=>e instanceof Function?e:()=>e;function nz({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:s=5,nodeStrokeWidth:r,nodeComponent:i=ez,onClick:l}){const u=Ft(tz,_n),d=xp(t),f=xp(e),p=xp(n),h=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return a.jsx(a.Fragment,{children:u.map(m=>a.jsx(rz,{id:m,nodeColorFunc:d,nodeStrokeColorFunc:f,nodeClassNameFunc:p,nodeBorderRadius:s,nodeStrokeWidth:r,NodeComponent:i,onClick:l,shapeRendering:h},m))})}function sz({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:s,nodeBorderRadius:r,nodeStrokeWidth:i,shapeRendering:l,NodeComponent:u,onClick:d}){const{node:f,x:p,y:h,width:m,height:_}=Ft(v=>{const{internals:y}=v.nodeLookup.get(e),b=y.userNode,{x:w,y:E}=y.positionAbsolute,{width:N,height:j}=_a(b);return{node:b,x:w,y:E,width:N,height:j}},_n);return!f||f.hidden||!x0(f)?null:a.jsx(u,{x:p,y:h,width:m,height:_,style:f.style,selected:!!f.selected,className:s(f),color:t(f),borderRadius:r,strokeColor:n(f),strokeWidth:i,shapeRendering:l,onClick:d,id:f.id})}const rz=x.memo(sz);var az=x.memo(nz);const oz=200,iz=150,lz=e=>!e.hidden,cz=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?y0(Oc(e.nodeLookup,{filter:lz}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},uz="react-flow__minimap-desc";function rw({style:e,className:t,nodeStrokeColor:n,nodeColor:s,nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:l,nodeComponent:u,bgColor:d,maskColor:f,maskStrokeColor:p,maskStrokeWidth:h,position:m="bottom-right",onClick:_,onNodeClick:v,pannable:y=!1,zoomable:b=!1,ariaLabel:w,inversePan:E,zoomStep:N=1,offsetScale:j=5}){const C=dn(),M=x.useRef(null),{boundingRect:z,viewBB:D,rfId:k,panZoom:T,translateExtent:A,flowWidth:O,flowHeight:R,ariaLabelConfig:L}=Ft(cz,_n),F=(e==null?void 0:e.width)??oz,B=(e==null?void 0:e.height)??iz,q=z.width/F,I=z.height/B,U=Math.max(q,I),V=U*F,H=U*B,G=j*U,W=z.x-(V-z.width)/2-G,J=z.y-(H-z.height)/2-G,ee=V+G*2,Z=H+G*2,K=`${uz}-${k}`,X=x.useRef(0),Q=x.useRef();X.current=U,x.useEffect(()=>{if(M.current&&T)return Q.current=AT({domNode:M.current,panZoom:T,getTransform:()=>C.getState().transform,getViewScale:()=>X.current}),()=>{var ie;(ie=Q.current)==null||ie.destroy()}},[T]),x.useEffect(()=>{var ie;(ie=Q.current)==null||ie.update({translateExtent:A,width:O,height:R,inversePan:E,pannable:y,zoomStep:N,zoomable:b})},[y,b,E,N,A,O,R]);const ne=_?ie=>{var ze;const[ge,Re]=((ze=Q.current)==null?void 0:ze.pointer(ie))||[0,0];_(ie,{x:ge,y:Re})}:void 0,le=v?x.useCallback((ie,ge)=>{const Re=C.getState().nodeLookup.get(ge).internals.userNode;v(ie,Re)},[]):void 0,ce=w??L["minimap.ariaLabel"];return a.jsx(Bd,{position:m,style:{...e,"--xy-minimap-background-color-props":typeof d=="string"?d:void 0,"--xy-minimap-mask-background-color-props":typeof f=="string"?f:void 0,"--xy-minimap-mask-stroke-color-props":typeof p=="string"?p:void 0,"--xy-minimap-mask-stroke-width-props":typeof h=="number"?h*U:void 0,"--xy-minimap-node-background-color-props":typeof s=="string"?s:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof l=="number"?l:void 0},className:Vt(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:a.jsxs("svg",{width:F,height:B,viewBox:`${W} ${J} ${ee} ${Z}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":K,ref:M,onClick:ne,children:[ce&&a.jsx("title",{id:K,children:ce}),a.jsx(az,{onClick:le,nodeColor:s,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:l,nodeComponent:u}),a.jsx("path",{className:"react-flow__minimap-mask",d:`M${W-G},${J-G}h${ee+G*2}v${Z+G*2}h${-ee-G*2}z
        M${D.x},${D.y}h${D.width}v${D.height}h${-D.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}rw.displayName="MiniMap",x.memo(rw);const dz=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,mz={[fl.Line]:"right",[fl.Handle]:"bottom-right"};function hz({nodeId:e,position:t,variant:n=fl.Handle,className:s,style:r=void 0,children:i,color:l,minWidth:u=10,minHeight:d=10,maxWidth:f=Number.MAX_VALUE,maxHeight:p=Number.MAX_VALUE,keepAspectRatio:h=!1,resizeDirection:m,autoScale:_=!0,shouldResize:v,onResizeStart:y,onResize:b,onResizeEnd:w}){const E=Eb(),N=typeof e=="string"?e:E,j=dn(),C=x.useRef(null),M=n===fl.Handle,z=Ft(x.useCallback(dz(M&&_),[M,_]),_n),D=x.useRef(null),k=t??mz[n];x.useEffect(()=>{if(!(!C.current||!N))return D.current||(D.current=qT({domNode:C.current,nodeId:N,getStoreItems:()=>{const{nodeLookup:A,transform:O,snapGrid:R,snapToGrid:L,nodeOrigin:F,domNode:B}=j.getState();return{nodeLookup:A,transform:O,snapGrid:R,snapToGrid:L,nodeOrigin:F,paneDomNode:B}},onChange:(A,O)=>{const{triggerNodeChanges:R,nodeLookup:L,parentLookup:F,nodeOrigin:B}=j.getState(),q=[],I={x:A.x,y:A.y},U=L.get(N);if(U&&U.expandParent&&U.parentId){const V=U.origin??B,H=A.width??U.measured.width??0,G=A.height??U.measured.height??0,W={id:U.id,parentId:U.parentId,rect:{width:H,height:G,...b0({x:A.x??U.position.x,y:A.y??U.position.y},{width:H,height:G},U.parentId,L,V)}},J=lp([W],L,F,B);q.push(...J),I.x=A.x?Math.max(V[0]*H,A.x):void 0,I.y=A.y?Math.max(V[1]*G,A.y):void 0}if(I.x!==void 0&&I.y!==void 0){const V={id:N,type:"position",position:{...I}};q.push(V)}if(A.width!==void 0&&A.height!==void 0){const H={id:N,type:"dimensions",resizing:!0,setAttributes:m?m==="horizontal"?"width":"height":!0,dimensions:{width:A.width,height:A.height}};q.push(H)}for(const V of O){const H={...V,type:"position"};q.push(H)}R(q)},onEnd:({width:A,height:O})=>{const R={id:N,type:"dimensions",resizing:!1,dimensions:{width:A,height:O}};j.getState().triggerNodeChanges([R])}})),D.current.update({controlPosition:k,boundaries:{minWidth:u,minHeight:d,maxWidth:f,maxHeight:p},keepAspectRatio:h,resizeDirection:m,onResizeStart:y,onResize:b,onResizeEnd:w,shouldResize:v}),()=>{var A;(A=D.current)==null||A.destroy()}},[k,u,d,f,p,h,y,b,w,v]);const T=k.split("-");return a.jsx("div",{className:Vt(["react-flow__resize-control","nodrag",...T,n,s]),ref:C,style:{...r,scale:z,...l&&{[M?"backgroundColor":"borderColor"]:l}},children:i})}x.memo(hz);const fz=(e,t,n)=>{var r;const s=new Array(t);for(let i=0;i<t;i++){const l=new Array(e);for(let u=0;u<e;u++){const d=!!(n&&(r=n[i])!=null&&r[u]),f=n?!d:!0;l[u]={x:u,y:i,walkable:f}}s[i]=l}return s},bp=(e,t,n,s)=>n>=0&&n<e&&s>=0&&s<t,aw=(e,t,n)=>{const s=fz(e,t,n),r=(l,u)=>s[u][l],i=(l,u)=>bp(e,t,l,u)&&s[u][l].walkable;return{width:e,height:t,nodes:s,getNodeAt:r,isWalkableAt:i,setWalkableAt:(l,u,d)=>{bp(e,t,l,u)&&(s[u][l].walkable=d)},getNeighbors:(l,u)=>{const d=l.x,f=l.y,p=[],h=i(d,f-1),m=i(d+1,f),_=i(d,f+1),v=i(d-1,f);h&&p.push(r(d,f-1)),m&&p.push(r(d+1,f)),_&&p.push(r(d,f+1)),v&&p.push(r(d-1,f));const y=i(d+1,f-1),b=i(d+1,f+1),w=i(d-1,f+1),E=i(d-1,f-1);return u==="Never"||(y&&p.push(r(d+1,f-1)),b&&p.push(r(d+1,f+1)),w&&p.push(r(d-1,f+1)),E&&p.push(r(d-1,f-1))),p},isInside:(l,u)=>bp(e,t,l,u),clone:()=>{const l=s.map(u=>u.map(d=>d.walkable?0:1));return aw(e,t,l)}}},wp=(e,t)=>{switch(t){case"top":return{x:e.x,y:e.y-1};case"bottom":return{x:e.x,y:e.y+1};case"left":return{x:e.x-1,y:e.y};case"right":return{x:e.x+1,y:e.y}}},ow=(e,t,n)=>{let s=e.getNodeAt(t.x,t.y);for(;!s.walkable;){e.setWalkableAt(s.x,s.y,!0);const r=wp(s,n);s=e.getNodeAt(r.x,r.y)}},Wd=(e,t,n,s)=>{const r=(e.x-t)/s+1,i=(e.y-n)/s+1;return{x:r,y:i}},iw=(e,t,n,s)=>{const r=(e.x-1)*s+t,i=(e.y-1)*s+n;return{x:r,y:i}},Gd=(e,t=10)=>Math.round(e/t)*t,gl=(e,t=10)=>Math.floor(e/t)*t,eo=(e,t=10)=>Math.ceil(e/t)*t,lw=(e,t=0)=>{let n=Math.max(Math.round(e),t);return n=Number.isInteger(n)?n:t,n=n>=t?n:t,n},pz=(e,t,n,s,r=2)=>{const{xMin:i,yMin:l,width:u,height:d}=e,f=eo(u,r)/r+1,p=eo(d,r)/r+1,h=aw(f,p);t.forEach(E=>{const N=Wd(E.topLeft,i,l,r),j=Wd(E.bottomRight,i,l,r);for(let C=N.x;C<j.x;C++)for(let M=N.y;M<j.y;M++)h.setWalkableAt(C,M,!1)});const m=Wd({x:Gd(n.x,r),y:Gd(n.y,r)},i,l,r),_=Wd({x:Gd(s.x,r),y:Gd(s.y,r)},i,l,r),v=h.getNodeAt(m.x,m.y);ow(h,v,n.position);const y=h.getNodeAt(_.x,_.y);ow(h,y,s.position);const b=wp(v,n.position),w=wp(y,s.position);return{grid:h,start:b,end:w}},gz=(e,t,n)=>{const s=[[e.x,e.y],...n,[t.x,t.y]];return _z(s)},_z=e=>{let t=e[0];const n=e[0];let s=`M${String(n[0])},${String(n[1])}M`;for(const i of e){const l=yz(t[0],t[1],i[0],i[1]);s+=` ${String(l[0])},${String(l[1])}`,s+=`Q${String(i[0])},${String(i[1])}`,t=i}const r=e[e.length-1];return s+=` ${String(r[0])},${String(r[1])}`,s},yz=(e,t,n,s)=>{const r=(e-n)/2+n,i=(t-s)/2+s;return[r,i]},vz=(e,t)=>e+t,xz=(e,t)=>{const n=Math.SQRT2-1;return e<t?n*e+t:n*t+e},bz=e=>{const t=[];let n=e;for(;n;)t.push([n.x,n.y]),n=n.parent;return t.reverse()},wz=e=>e==="Never"?vz:xz,Nz=e=>{let t=0;for(let n=1;n<e.length;n++)(e[n].estimatedTotalCost??1/0)<(e[t].estimatedTotalCost??1/0)&&(t=n);return e.splice(t,1)[0]},jz=(e,t,n,s,r,i)=>{if(e.closed)return;const l=Math.abs(e.x-t.x),u=Math.abs(e.y-t.y),d=(t.costFromStart??0)+(l===0||u===0?1:Math.SQRT2);(!e.opened||d<(e.costFromStart??1/0))&&(e.costFromStart=d,e.heuristicCostToGoal=e.heuristicCostToGoal??i*r(Math.abs(e.x-n.x),Math.abs(e.y-n.y)),e.estimatedTotalCost=(e.costFromStart??0)+(e.heuristicCostToGoal??0),e.parent=t,e.opened||(e.opened=!0,s.push(e)))},Sz=(e={})=>{const t=e.diagonalMovement??"Never",n=e.heuristic??wz(t),s=e.weight??1;return{findPath:(r,i,l,u,d)=>{const f=d.getNodeAt(r,i),p=d.getNodeAt(l,u),h=[];for(f.costFromStart=0,f.heuristicCostToGoal=0,f.estimatedTotalCost=0,f.opened=!0,h.push(f);h.length>0;){const m=Nz(h);if(m.closed=!0,m===p)return bz(p);const _=d.getNeighbors(m,t);for(const v of _)jz(v,m,p,h,n,s)}return[]}}},Ez=(e,t,n)=>{try{const s=Sz({diagonalMovement:"Always"}).findPath(t.x,t.y,n.x,n.y,e);if(s.length===0)throw new Error("No path found");return s}catch(s){throw s instanceof Error?s:new Error(`Unknown error: ${String(s)}`)}},Cz=(e,t=2,n=2)=>{let s=Number.MIN_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER;const u=e.map(y=>{var z,D;const b=Math.max(((z=y.measured)==null?void 0:z.width)??0,1),w=Math.max(((D=y.measured)==null?void 0:D.height)??0,1),E={x:y.position.x,y:y.position.y},N={x:E.x-t,y:E.y-t},j={x:E.x-t,y:E.y+w+t},C={x:E.x+b+t,y:E.y-t},M={x:E.x+b+t,y:E.y+w+t};return n>0&&(N.x=gl(N.x,n),N.y=gl(N.y,n),j.x=gl(j.x,n),j.y=eo(j.y,n),C.x=eo(C.x,n),C.y=gl(C.y,n),M.x=eo(M.x,n),M.y=eo(M.y,n)),N.y<l&&(l=N.y),N.x<i&&(i=N.x),M.y>r&&(r=M.y),M.x>s&&(s=M.x),{id:y.id,width:b,height:w,topLeft:N,bottomLeft:j,topRight:C,bottomRight:M}}),d=t*2;s=eo(s+d,n),r=eo(r+d,n),i=gl(i-d,n),l=gl(l-d,n);const f={x:i,y:l},p={x:i,y:r},h={x:s,y:l},m={x:s,y:r},_=Math.abs(f.x-h.x),v=Math.abs(f.y-p.y);return{nodeBoxes:u,graphBox:{topLeft:f,bottomLeft:p,topRight:h,bottomRight:m,width:_,height:v,xMax:s,yMax:r,xMin:i,yMin:l}}},kz=({options:e={},nodes:t=[],sourceX:n,sourceY:s,targetX:r,targetY:i,sourcePosition:l,targetPosition:u})=>{var d;try{const{drawEdge:f=gz,generatePath:p=Ez}=e;let{gridRatio:h=10,nodePadding:m=10}=e;h=lw(h),m=lw(m);const{graphBox:_,nodeBoxes:v}=Cz(t,m,h);(d=e.debug)!=null&&d.enabled&&e.debug.setGraphBox&&e.debug.setGraphBox({x:_.topLeft.x,y:_.topLeft.y,width:_.width,height:_.height});const y={x:n,y:s,position:l},b={x:r,y:i,position:u},{grid:w,start:E,end:N}=pz(_,v,y,b,h),j=p(w,E,N),C=j.map(R=>{const[L,F]=R,B=iw({x:L,y:F},_.xMin,_.yMin,h);return[B.x,B.y]}),M=f(y,b,C),z=Math.floor(j.length/2),D=j[z],[k,T]=D,{x:A,y:O}=iw({x:k,y:T},_.xMin,_.yMin,h);return{svgPathString:M,edgeCenterX:A,edgeCenterY:O}}catch(f){return f instanceof Error?f:new Error(`Unknown error: ${String(f)}`)}};x.createContext({enabled:!1,graphBox:null,setGraphBox:()=>{}});const Mz=e=>Number.isFinite(e),Xd=e=>Math.round(e*100)/100,Az=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const r=Math.abs(n-e),i=Math.abs(s-t),l=Math.sqrt(r*r+i*i),u=Math.max(80,Math.min(l*.4,280)),d=Number.isFinite(u)?u:120,f=n>=e?1:-1,p=Math.min(Math.abs(s-t)*.2,50),h=e+f*d,m=t+(s>t?p:-p),_=n-f*d,v=s-(s>t?p:-p);return`M ${e},${t} C ${h},${m} ${_},${v} ${n},${s}`},Oz=({id:e,sourceX:t,sourceY:n,targetX:s,targetY:r,sourcePosition:i=He.Bottom,targetPosition:l=He.Top,markerEnd:u,style:d})=>{const{setEdges:f,getNodes:p}=Sf(),[h,m]=x.useState(!1),_=x.useCallback(()=>{m(!0)},[]),v=x.useCallback(()=>{m(!1)},[]),y=x.useMemo(()=>[t,n,s,r].every(L=>Mz(L))?{sourceX:Xd(t),sourceY:Xd(n),targetX:Xd(s),targetY:Xd(r)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:s,targetY:r}),null),[t,n,s,r,e]),b=x.useMemo(()=>{if(!y)return null;const{sourceX:L,sourceY:F,targetX:B,targetY:q}=y;try{const H=p().map(W=>({...W,width:W.width&&W.width>0?W.width:320,height:W.height&&W.height>0?W.height:170})),G=kz({sourcePosition:i,targetPosition:l,sourceX:L,sourceY:F,targetX:B,targetY:q,nodes:H,options:{nodePadding:40,gridRatio:10}});if(G&&"svgPathString"in G){const{svgPathString:W,edgeCenterX:J,edgeCenterY:ee}=G;return{path:W,labelX:J,labelY:ee}}}catch{}const I=Az(L,F,B,q),U=(L+B)/2,V=(F+q)/2;return{path:I,labelX:U,labelY:V}},[y,i,l,p]),w=x.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!y||!b)return null;const{sourceX:E,sourceY:N,targetX:j,targetY:C}=y,{path:M,labelX:z,labelY:D}=b,k=40,T=z-k/2,A=D-k/2,O=`animated-edge${h?" animated-edge--hovered":""}`,R=`canvas-edge-remove${h?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:O,onMouseEnter:_,onMouseLeave:v,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:w,gradientUnits:"userSpaceOnUse",x1:E,y1:N,x2:j,y2:C,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:M,fill:"none",stroke:"transparent",strokeWidth:40,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:M,fill:"none",stroke:`url(#${w})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:M,fill:"none",stroke:`url(#${w})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:u,className:"animated-edge__base",style:{...d,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:M,fill:"none",stroke:`url(#${w})`,strokeWidth:h?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:M,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:R,x:T,y:A,width:k,height:k,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:L=>{L.stopPropagation(),f(F=>F.filter(B=>B.id!==e))},"aria-label":"Remove connection",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(il,{size:12})})})})]})},Np="pending configuration",Tz="not configured",cw="pending configuration detected for ",jp="no categorical columns selected",uw="no columns selected for ",Ic=e=>e.replace(/\s+/g," ").trim(),Sp=e=>{var n;const t=new Map;for(const s of e){const r=Ic(s.label);if(!r)continue;const i=r.toLowerCase();t.has(i)||t.set(i,{label:r,reason:((n=s.reason)==null?void 0:n.trim())||null})}return Array.from(t.values())},$z=e=>{const[,t]=e.split(":",2);if(!t)return null;const n=t.trim();if(!n)return null;const s=n.indexOf("")>=0?n.indexOf(""):n.indexOf("-");if(s>=0)return Ic(n.slice(s+1));const r=n.toLowerCase();return r.startsWith(Np)?Ic(n.slice(Np.length)):r.startsWith(jp)?Ic(n.slice(jp.length)):Ic(n)},Lz=e=>{var n;if(!Array.isArray(e))return[];const t=[];for(const s of e){if(typeof s!="string")continue;const r=s.trim(),i=r.toLowerCase();if(!r||!i.includes(Np)&&!i.includes(Tz)&&!i.includes(jp))continue;const l=(n=r.split(":",1)[0])==null?void 0:n.trim();l&&t.push({label:l,reason:$z(r)})}return Sp(t)},zz=e=>{if(!e||typeof e!="string")return[];const t=e.toLowerCase();let n=t.indexOf(cw),s=cw.length;if(n===-1&&(n=t.indexOf(uw),s=uw.length),n===-1)return[];const r=n+s,i=e.indexOf(".",r),l=e.substring(r,i===-1?e.length:i).trim();if(!l)return[];const d=l.replace(/and \d+ other nodes?$/i,"").trim().split(/,| and /i).map(f=>f.trim()).filter(Boolean);return Sp(d.map(f=>({label:f,reason:null})))},Rz=e=>Array.isArray(e)?Sp(e.map(t=>typeof t=="string"?t:"").filter(t=>!!t).map(t=>{const n=t.split(":");if(n.length>1){const s=n[0].trim(),r=n.slice(1).join(":").trim();return{label:s,reason:r}}return{label:t,reason:null}})):[],At=e=>{if(!e)return[];const t=Rz((e==null?void 0:e.pending_nodes)??null);if(t.length)return t;const n=Lz(e.applied_steps);return n.length?n:zz(e.reason??null)},Dz=({thresholdParameter:e,dropColumnParameter:t,dropIfAnyValue:n,selectedColumns:s,renderParameterField:r,renderMultiSelectField:i,previewState:l,onPendingConfigurationWarning:u,onPendingConfigurationCleared:d})=>(x.useEffect(()=>{var f,p;if((p=(f=l==null?void 0:l.data)==null?void 0:f.signals)!=null&&p.full_execution){let m=At(l.data.signals.full_execution);n&&(m=m.filter(_=>!_.label.toLowerCase().includes("rows"))),s&&s.length>0&&(m=m.filter(_=>{const v=_.label.toLowerCase().includes("threshold")||_.reason&&_.reason.toLowerCase().includes("threshold"),y=_.label.toLowerCase().includes("rows");return!(v&&!y)})),m.length>0?u==null||u(m):d==null||d()}},[l,u,d,n,s]),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),e&&r(e),i(t)]})),Pz=({thresholdParameter:e,dropIfAnyParameter:t,dropIfAnyValue:n,suppressWarnings:s,renderParameterField:r,previewState:i,onPendingConfigurationWarning:l,onPendingConfigurationCleared:u})=>(x.useEffect(()=>{var d,f;if(!s){if(n){u==null||u();return}if((f=(d=i==null?void 0:i.data)==null?void 0:d.signals)!=null&&f.full_execution){const h=At(i.data.signals.full_execution).filter(m=>m.label.toLowerCase().includes("rows"));h.length>0?l==null||l(h):u==null||u()}}},[i,l,u,n,s]),!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&r(e),t&&r(t)]})),dw="first",Iz=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],Fz=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:s,renderMultiSelectField:r,removeDuplicatesKeepSelectId:i,removeDuplicatesKeep:l,onKeepChange:u,previewState:d,onPendingConfigurationWarning:f,onPendingConfigurationCleared:p})=>{if(x.useEffect(()=>{var m,_;if((_=(m=d==null?void 0:d.data)==null?void 0:m.signals)!=null&&_.full_execution){const v=At(d.data.signals.full_execution);v.length>0?f==null||f(v):p==null||p()}},[d,f,p]),!n&&!s)return null;const h=m=>{const _=m.target.value;u(_==="last"||_==="none"?_:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),r(n)]}),s&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:i,className:"canvas-modal__parameter-label",children:s.label??"Keep strategy"}),s.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:s.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:i,value:l,onChange:h,children:Iz.map(m=>a.jsx("option",{value:m.value,children:m.label},m.value))})})]})]})},at=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],Bz=["float64","Int64","boolean","string","category","datetime64[ns]","object"],Hz=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:s,columnSuggestions:r,selectedColumns:i,previewColumns:l,previewStatus:u,previewState:d,sourceId:f,hasReachableSource:p,onPendingConfigurationWarning:h,onPendingConfigurationCleared:m})=>{var z,D;x.useEffect(()=>{var T,A;if(!((A=(T=d==null?void 0:d.data)==null?void 0:T.signals)!=null&&A.full_execution)){m==null||m();return}const k=At(d.data.signals.full_execution);k.length>0?h==null||h(k):m==null||m()},[(D=(z=d==null?void 0:d.data)==null?void 0:z.signals)==null?void 0:D.full_execution,h,m]);const _=x.useMemo(()=>{const k=e==null?void 0:e.column_overrides;if(!k||typeof k!="object"||Array.isArray(k))return{};const T={};return Object.entries(k).forEach(([A,O])=>{const R=String(A??"").trim();if(!R||typeof O!="string")return;const L=O.trim();L&&(T[R]=L)}),T},[e==null?void 0:e.column_overrides]),v=x.useMemo(()=>{const k=e==null?void 0:e.target_dtype;return typeof k=="string"?k.trim():""},[e==null?void 0:e.target_dtype]),y=x.useMemo(()=>{const k=new Set;return n.forEach(A=>k.add(A)),Object.keys(s).forEach(A=>k.add(A)),Object.keys(r).forEach(A=>k.add(A)),Object.keys(_).forEach(A=>k.add(A)),i.forEach(A=>k.add(A)),l.forEach(A=>{typeof A=="string"&&k.add(A)}),Array.from(k).sort((A,O)=>A.localeCompare(O)).map(A=>{const O=s[A]??"Unknown",R=r[A]??[],L=R.length?R[0]:null,F=Object.prototype.hasOwnProperty.call(_,A),B=F?_[A]:null,q=typeof B=="string"?B.trim():"",I=F?q:v,U=new Set;I&&U.add(I),R.forEach(ee=>U.add(ee)),O&&O!=="Unknown"&&U.add(O),v&&U.add(v),Bz.forEach(ee=>U.add(ee));const V=I??"",H=!!(L&&L!==V),G=!!(L&&L===V),W=i.includes(A),J=Array.from(U).sort((ee,Z)=>ee.localeCompare(Z));return{column:A,originalType:O,recommended:L,currentTarget:I,suggestions:R,options:J,hasRecommendationGap:H,hasOverride:F,usesDefaultTarget:!F,isRecommendationApplied:G,isSelected:W}})},[n,v,_,r,s,l,i]),b=x.useMemo(()=>{const k=y.filter(O=>O.hasRecommendationGap),T=y.filter(O=>!O.hasRecommendationGap),A=[];return k.length&&A.push({key:"needs-attention",label:"Needs attention",rows:k}),T.length&&A.push({key:"all-columns",label:k.length?"Other columns":"All columns",rows:T}),A},[y]),w=x.useMemo(()=>y.filter(k=>k.hasRecommendationGap).length,[y]),E=x.useMemo(()=>w>0,[w]),N=x.useMemo(()=>y.filter(k=>k.isSelected).length,[y]),j=x.useCallback((k,T)=>{const A=k.trim();A&&t(O=>{const R=O.column_overrides&&typeof O.column_overrides=="object"&&!Array.isArray(O.column_overrides)?{...O.column_overrides}:{},L=typeof T=="string"?T.trim():"",F=new Set(at(O.columns)),B=new Set(at(O.skipped_columns)),q=B.delete(A);L?(R[A]=L,F.add(A)):delete R[A];const I={...O,columns:Array.from(F).sort((U,V)=>U.localeCompare(V)),column_overrides:R};return q&&(I.skipped_columns=Array.from(B).sort((U,V)=>U.localeCompare(V))),I})},[t]),C=x.useCallback(()=>{const k=Object.entries(r).filter(([,T])=>T.length>0);k.length&&t(T=>{const A=new Set(at(T.columns)),O=T.column_overrides&&typeof T.column_overrides=="object"&&!Array.isArray(T.column_overrides)?{...T.column_overrides}:{};return k.forEach(([R,L])=>{const F=R.trim();F&&(A.add(F),L.length&&(O[F]=L[0]))}),{...T,columns:Array.from(A).sort((R,L)=>R.localeCompare(L)),column_overrides:O}})},[r,t]),M=x.useCallback((k,T)=>{T==="__default__"?j(k,null):j(k,T)},[j]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:C,disabled:!E,children:"Apply recommendations"})})]}),!f&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),f&&!p&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),v?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:v}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),y.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",y.length," column",y.length===1?"":"s","  ",N," mapped in node selection."]}),E?a.jsxs("p",{className:"canvas-modal__note",children:[w," column",w===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):y.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),u==="loading"&&!y.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),y.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:b.map(k=>a.jsxs("div",{className:"canvas-cast__group",children:[k.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:k.label}),a.jsxs("span",{children:[k.rows.length," column",k.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:k.rows.map(T=>{const A=["canvas-cast__row"];T.hasRecommendationGap&&A.push("canvas-cast__row--attention"),T.hasOverride&&A.push("canvas-cast__row--override");const O=T.hasOverride?T.currentTarget||"":"__default__",R=T.isRecommendationApplied,L=T.suggestions.slice(1,4),F=T.hasOverride?T.currentTarget?`Override  ${T.currentTarget}`:"Override cleared (uses original dtype)":v?`Inheriting ${v}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:A.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:T.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[T.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),T.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!T.isSelected&&!T.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:T.originalType})}),a.jsx("td",{children:T.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${T.hasRecommendationGap?" canvas-cast__chip--attention":""}${R?" canvas-cast__chip--applied":""}`,children:T.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:R?"Aligned with target":"Not applied yet"}),L.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",L.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:O,onChange:B=>M(T.column,B.target.value),children:[a.jsx("option",{value:"__default__",children:v?`Inherit global (${v})`:"No override (use original)"}),T.options.map(B=>a.jsx("option",{value:B,children:B},`${T.column}-${B}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:F})]})})]},`cast-row-${T.column}`)})})]})})]},`cast-group-${k.key}`))})]})};async function Ep(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function mw(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function hw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load label encoding recommendations");return l.json()}async function fw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load ordinal encoding suggestions");return l.json()}async function pw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load target encoding recommendations");return l.json()}async function gw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load hash encoding recommendations");return l.json()}async function _w(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load one-hot encoding recommendations");return l.json()}async function yw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load dummy encoding recommendations");return l.json()}async function Cp(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load column drop recommendations");return l.json()}async function vw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,l={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),r&&(l.target_node_id=r);const u=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load outlier recommendations");return u.json()}async function xw(e,t={}){const{sampleSize:n=500,transformations:s,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};Array.isArray(s)?s.length>0&&(l.transformations=JSON.stringify(s)):s&&typeof s=="object"&&Object.keys(s).length>0&&(l.transformations=JSON.stringify(s)),r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load skewness recommendations");return u.json()}async function bw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load scaling recommendations");return l.json()}async function ww(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),r&&(i.target_node_id=r);const l=await fetch("/ml-workflow/api/recommendations/binning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!l.ok)throw new Error("Failed to load binning recommendations");return l.json()}async function Nw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,l={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),r&&(l.target_node_id=r);const u=await fetch("/ml-workflow/api/analytics/binned-distribution",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok){let d="Failed to load binned column distributions";try{const f=await u.clone().json(),p=typeof(f==null?void 0:f.detail)=="string"&&f.detail.trim()?f.detail.trim():typeof(f==null?void 0:f.error)=="string"&&f.error.trim()?f.error.trim():typeof(f==null?void 0:f.message)=="string"&&f.message.trim()?f.message.trim():null;p&&(d=p)}catch{try{const p=(await u.text()).trim();p&&(d=p)}catch{}}throw new Error(d)}return u.json()}async function jw(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:r}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,l=new URLSearchParams({dataset_source_id:e,sample_size:String(i)});s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&l.set("graph",JSON.stringify({nodes:s.nodes,edges:s.edges})),r&&l.set("target_node_id",r);const u=await fetch(`/ml-workflow/api/analytics/quick-profile?${l.toString()}`);if(!u.ok){let d="Failed to generate dataset profile";try{const f=await u.clone().json(),p=typeof(f==null?void 0:f.detail)=="string"&&f.detail.trim()?f.detail.trim():typeof(f==null?void 0:f.error)=="string"&&f.error.trim()?f.error.trim():typeof(f==null?void 0:f.message)=="string"&&f.message.trim()?f.message.trim():null;p&&(d=p)}catch{try{const p=(await u.text()).trim();p&&(d=p)}catch{}}throw new Error(d)}return u.json()}async function Uz(e,t={}){const{config:n,sampleSize:s,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:s==="all"?0:typeof s=="number"&&Number.isFinite(s)?s:300};if(n&&typeof n=="object"){const d=(m,_)=>{const v=Number(m);return Number.isFinite(v)?v<0?0:v>100?100:v:_},f=m=>{if(!m||typeof m!="object")return{};const _={};return Object.entries(m).forEach(([v,y])=>{const b=String(v??"").trim();if(!b)return;let w=null,E=null;if(y&&typeof y=="object"){const N=y.lower??y.min??y.minimum??null,j=y.upper??y.max??y.maximum??null,C=Number(N);Number.isFinite(C)&&(w=C);const M=Number(j);Number.isFinite(M)&&(E=M)}if(!(w===null&&E===null)){if(w!==null&&E!==null&&w>E){const N=w;w=E,E=N}_[b]={lower:w,upper:E}}}),_},p=d(n.lower_percentile,5),h=d(n.upper_percentile,95);l.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:p,upper_percentile:h<=p?Math.min(p+1,100):h,manual_bounds:f(n.manual_bounds)}}r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok){const d=await u.text();throw new Error(d||"Failed to load outlier diagnostics")}return u.json()}async function Sw(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function Ew(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function Cw(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}function qz(e,t){const n={},s={};e.forEach(l=>{n[l.id]=[],s[l.id]=0}),t.forEach(l=>{n[l.source]&&(n[l.source].push(l.target),s[l.target]=(s[l.target]||0)+1)});const r=[];e.forEach(l=>{s[l.id]===0&&r.push(l.id)});const i=[];for(;r.length>0;){const l=r.shift(),u=e.find(d=>d.id===l);u&&i.push(u),n[l]&&n[l].forEach(d=>{s[d]--,s[d]===0&&r.push(d)})}return i}function Vz(e,t,n){var i;if(e.type==="dataset")return{node_id:e.id,step_type:"data_loader",params:{source_id:n,sample:!0,limit:1e3},inputs:[]};let s="",r=((i=e.data)==null?void 0:i.config)||{};switch(e.type){case"imputation":s="SimpleImputer";break;case"scaling":s="StandardScaler";break;case"one_hot_encoding":s="OneHotEncoder";break;case"ordinal_encoding":s="OrdinalEncoder";break;case"outlier":s="IQR";break;case"transformation":s="PowerTransformer";break;case"drop_col_rows":s="DropMissingColumns";break;case"remove_duplicates":s="Deduplicate";break;case"text_cleaning":s="TextCleaning";break;case"value_replacement":s="ValueReplacement";break;case"binning":s="GeneralBinning";break;case"feature_selection":s="UnivariateSelection";break;case"cast_column":s="Casting";break;case"variance_threshold":s="VarianceThreshold";break;case"correlation_threshold":s="CorrelationThreshold";break;case"polynomial_features":s="PolynomialFeatures";break;case"feature_math":s="FeatureMath";break;case"resampling":const l=r.method||"";r.type==="oversampling"||["smote","adasyn","borderline_smote","svm_smote","kmeans_smote","smote_tomek"].includes(l)?s="Oversampling":s="Undersampling";break;default:s="Unknown"}return{node_id:e.id,step_type:"feature_engineering",params:{steps:[{name:`${e.type}_${e.id}`,transformer:s,params:r}]},inputs:t}}function kw(e){const{graph:t,dataset_source_id:n}=e,s=t.nodes||[],r=t.edges||[],l=qz(s,r).map(u=>{const d=r.filter(f=>f.target===u.id).map(f=>f.source);return Vz(u,d,n)});return{pipeline_id:`preview_${Date.now()}`,nodes:l,metadata:{original_source_id:n}}}async function Mw(e,t={}){return console.warn("fetchPipelinePreviewRows is deprecated in V2. Use fetchPipelinePreview."),{columns:[],rows:[],total_rows:0}}async function Aw(e){const t=kw(e),n=await fetch("/api/pipeline/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const l=await n.text();throw new Error(l||"Failed to load pipeline preview")}const s=await n.json(),r=s.preview_data||[],i=r.length>0?Object.keys(r[0]):[];return{columns:i,rows:r,metrics:{row_count:r.length,column_count:i.length,duplicate_rows:0,missing_cells:0,preview_rows:r.length,total_rows:r.length,requested_sample_size:1e3},recommendations:s.recommendations}}async function Ow(e){const t=kw(e),n=await fetch("/api/pipeline/run",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const r=await n.text();throw new Error(r||"Failed to trigger full dataset execution")}const s=await n.json();return{columns:[],rows:[],metrics:{row_count:0,column_count:0,duplicate_rows:0,missing_cells:0,preview_rows:0,total_rows:0,requested_sample_size:0},job_id:s.job_id}}async function Tw(e,t){const n=await fetch(`/api/pipeline/jobs/${encodeURIComponent(t)}`);if(!n.ok)throw new Error("Failed to fetch full execution status");const s=await n.json();let r="queued";return s.status==="running"&&(r="running"),s.status==="completed"&&(r="succeeded"),s.status==="failed"&&(r="failed"),{status:r==="succeeded"?"succeeded":"deferred",job_status:r,job_id:s.job_id,reason:s.error,last_updated:new Date().toISOString(),poll_after_seconds:r==="succeeded"||r==="failed"?null:2}}async function $w(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,r=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:r}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function Lw(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/cancel`,{method:"POST",credentials:"include"});if(!t.ok){const n=await t.text();let s=n;try{const r=JSON.parse(n);r.detail&&(s=r.detail)}catch{}throw t.status===501?new Error(s||"Cancellation is not supported in this environment."):new Error(s||"Failed to cancel training job")}}async function zw(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function Jo(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view training jobs.");const r=await s.text();throw new Error(r||"Failed to load training jobs")}return s.json()}async function Rw(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const s=await n.text();throw new Error(s||"Failed to evaluate model")}return n.json()}async function Dw(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,r=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:r}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function Pw(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}/cancel`,{method:"POST",credentials:"include"});if(!t.ok){const n=await t.text();let s=n;try{const r=JSON.parse(n);r.detail&&(s=r.detail)}catch{}throw t.status===501?new Error(s||"Cancellation is not supported in this environment."):new Error(s||"Failed to cancel tuning job")}}async function Kz(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function ei(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view tuning jobs.");const r=await s.text();throw new Error(r||"Failed to load tuning jobs")}return s.json()}async function Qd(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function Iw(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const s=n.toString(),r=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${s?`?${s}`:""}`,{credentials:"include"});if(!r.ok){if(r.status===404)throw new Error(`Model type '${e}' not found`);const i=await r.text();throw new Error(i||"Failed to fetch best hyperparameters")}return r.json()}const kp=e=>{if(Array.isArray(e))return e.map(t=>kp(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(s=>{n[s]=kp(e[s])}),n}return e},Yz=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),Wz=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return Yz(n)},Gz=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],s=t.map(i=>{let l=null;if(i&&i.data&&typeof i.data=="object"){const u=i.data.config;if(u!==void 0)try{l=JSON.parse(JSON.stringify(u))}catch{l=u}}return{id:i&&Object.prototype.hasOwnProperty.call(i,"id")?i.id??null:null,type:i&&Object.prototype.hasOwnProperty.call(i,"type")?i.type??null:null,catalogType:i&&i.data&&Object.prototype.hasOwnProperty.call(i.data,"catalogType")?i.data.catalogType??null:null,config:l}}).sort((i,l)=>{const u=typeof i.id=="string"?i.id:String(i.id??""),d=typeof l.id=="string"?l.id:String(l.id??"");return u.localeCompare(d)}),r=n.map(i=>({source:i&&Object.prototype.hasOwnProperty.call(i,"source")?i.source??null:null,target:i&&Object.prototype.hasOwnProperty.call(i,"target")?i.target??null:null,sourceHandle:i&&Object.prototype.hasOwnProperty.call(i,"sourceHandle")?i.sourceHandle??null:null,targetHandle:i&&Object.prototype.hasOwnProperty.call(i,"targetHandle")?i.targetHandle??null:null})).sort((i,l)=>{const u=String(i.source??"").localeCompare(String(l.source??""));return u!==0?u:String(i.target??"").localeCompare(String(l.target??""))});return{nodes:s,edges:r}};async function ti(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=Gz(t),s=JSON.stringify(kp(n)),r=await Wz(s);return`${e}_${r.slice(0,8)}`}const Xz=Object.freeze(Object.defineProperty({__proto__:null,cancelHyperparameterTuningJob:Pw,cancelTrainingJob:Lw,createHyperparameterTuningJob:Dw,createTrainingJob:$w,evaluateTrainingJob:Rw,fetchBestHyperparameters:Iw,fetchBinnedDistribution:Nw,fetchBinningRecommendations:ww,fetchDatasets:mw,fetchDropColumnRecommendations:Cp,fetchDummyEncodingRecommendations:yw,fetchFullExecutionStatus:Tw,fetchHashEncodingRecommendations:gw,fetchHyperparameterTuningJob:Kz,fetchHyperparameterTuningJobs:ei,fetchLabelEncodingRecommendations:hw,fetchModelHyperparameters:Qd,fetchNodeCatalog:Ep,fetchOneHotEncodingRecommendations:_w,fetchOrdinalEncodingRecommendations:fw,fetchOutlierDiagnostics:Uz,fetchOutlierRecommendations:vw,fetchPipeline:Sw,fetchPipelineHistory:Cw,fetchPipelinePreview:Aw,fetchPipelinePreviewRows:Mw,fetchQuickProfile:jw,fetchScalingRecommendations:bw,fetchSkewnessRecommendations:xw,fetchTargetEncodingRecommendations:pw,fetchTrainingJob:zw,fetchTrainingJobs:Jo,generatePipelineId:ti,savePipeline:Ew,triggerFullDatasetExecution:Ow},Symbol.toStringTag,{value:"Module"})),Zd=100,Qz=12,Zz={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},Fw={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},Jz={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details.",pending_configuration:"Some nodes still need configuration. Open each highlighted node and save its settings before retrying the full dataset run."},eR={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},tR=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},nR=e=>{if(!e)return"";const t=Jz[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},Bw=(e,t)=>{if(!e)return null;const n=e.job_status??null,s=tR(n??e.status??null),r=Fw[n??e.status??s]??Fw[s],i=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,l=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let u=`Full dataset run: ${r}`;s==="running"&&i&&l?u=`Full dataset run: In progress (${i}/${l})`:s==="running"&&i?u=`Full dataset run: In progress (${i} rows)`:s==="succeeded"&&i?u=`Full dataset run: Completed (${i} rows)`:s==="succeeded"&&l&&(u=`Full dataset run: Completed (${l} rows)`);const d=[],f=[],p=n?eR[n]??n:null;if(n==="running"?i&&l?d.push(`Processed ${i} of ${l} rows.`):i?d.push(`Processed ${i} rows.`):l&&d.push(`Processing ${l} rows.`):i?d.push(`Processed ${i} rows.`):l&&d.push(`Total rows ${l}.`),e.reason&&d.push(e.reason),p&&f.push({label:"Background job",value:p}),e.job_id&&f.push({label:"Background job ID",value:e.job_id}),l&&f.push({label:"Dataset rows",value:l}),i&&s!=="queued"&&s!=="skipped"&&f.push({label:"Processed rows",value:i}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&f.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const _=new Date(e.last_updated).toLocaleString();f.push({label:"Last updated",value:_})}catch{f.push({label:"Last updated",value:String(e.last_updated)})}const h=Array.isArray(e.warnings)?e.warnings.map(nR).map(_=>_.trim()).filter(Boolean):[];let m=null;switch(s){case"queued":m=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":m=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(i){const _=e.processed_rows===1?"":"s";m=`Full dataset run processed ${i} row${_}.`}else l?m=`Full dataset run completed (${l} rows).`:m="Full dataset run completed.";break;case"failed":m=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":m="Full dataset run cancelled.";break;case"skipped":m=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":m=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:m=null;break}return{label:u,tone:s,details:d,metadata:f,warnings:h,stepLabel:m,isActive:n==="queued"||n==="running"}},Hw=e=>{if(!e)return"idle";const t=(e.job_status??e.status??"").toLowerCase();return t?t==="succeeded"?At(e).length>0?"error":"success":t==="failed"||t==="skipped"||t==="cancelled"?"error":t==="running"||t==="queued"||t==="deferred"?"loading":"idle":"idle"},Uw=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),sR=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const s=e.split(":",2)[1]??"";return s?`Preview mode "${s}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=Zz[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},rR=({preview:e,columns:t,rows:n,tableNote:s,formatCellValue:r,formatMetricValue:i,formatMissingPercentage:l,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:f,fullExecutionWarnings:p})=>{const h=e==null?void 0:e.metrics,m=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],_=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],v=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let y=v;const b=f||null;if(b){const j=v.findIndex(C=>typeof C=="string"&&C.toLowerCase().startsWith("full dataset run"));j>=0?y=[...v.slice(0,j),b,...v.slice(j+1)]:v.includes(b)||(y=[...v,b])}const w=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],E=_.reduce((j,C)=>(C&&typeof C.index=="number"&&(j[C.index]=typeof C.missing_percentage=="number"?C.missing_percentage:0),j),{}),N=w.slice(0,Qz);return a.jsxs("div",{className:"canvas-preview",children:[h&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(h.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(h.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(h.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(h.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(h.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(h.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:h.requested_sample_size===0?"Full dataset":i(h.requested_sample_size)})]})]}),y.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:y.map((j,C)=>a.jsx("li",{children:j},`${j}-${C}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(j=>a.jsx("th",{children:j},j))})}),a.jsx("tbody",{children:n.map((j,C)=>a.jsx("tr",{children:t.map(M=>a.jsx("td",{children:r(j==null?void 0:j[M])},`${C}-${M}`))},`row-${C}`))})]}),s?a.jsx("p",{className:"canvas-modal__note",children:s}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),_.length>0&&N.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:N.map((j,C)=>{const M=E[C]??0,z=M%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",C+1]}),a.jsxs("strong",{children:[i(M,z),"%"]})]},`row-missing-${C}`)})})]}),m.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:m.map(j=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:j.name}),j.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",j.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",l(j.missing_percentage)," (",i(j.missing_count),")"]}),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",u(j.mean)]}),typeof j.median=="number"&&!Number.isNaN(j.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",u(j.median)]}),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",d(j.mode)]}),typeof j.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",i(j.distinct_count)]})]},j.name))})]}),p&&p.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:p.map((j,C)=>a.jsx("li",{children:j},`${j}-${C}`))})]})]})},aR=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:s,formatCellValue:r,formatMetricValue:i,formatMissingPercentage:l,formatNumericStat:u,formatModeStat:d,nodeId:f,onUpdateNodeData:p,onPendingConfigurationWarning:h,onPendingConfigurationCleared:m})=>{var J,ee,Z,K,X;const[_,v]=x.useState(()=>Uw()),[y,b]=x.useState(null),[w,E]=x.useState(!1),N=x.useRef("idle"),j=x.useCallback(Q=>{if(!f||!p){N.current=Hw(Q);return}const ne=Hw(Q);ne!==N.current&&(N.current=ne,p(f,{backgroundExecutionStatus:ne}))},[f,p]),C=x.useCallback(Q=>{if(!h&&!m)return;const ne=At(Q);ne.length>0?h==null||h(ne):m==null||m()},[m,h]),M=e.status==="loading",z=M||!n,D=x.useMemo(()=>{var ne;const Q=(ne=e.data)==null?void 0:ne.columns;return Array.isArray(Q)?Q.filter(le=>typeof le=="string"):[]},[(J=e.data)==null?void 0:J.columns]),k=x.useMemo(()=>{var Q;return Array.isArray((Q=e.data)==null?void 0:Q.sample_rows)?e.data.sample_rows.slice(0,Zd):[]},[(ee=e.data)==null?void 0:ee.sample_rows]),T=k.length,A=Array.isArray((Z=e.data)==null?void 0:Z.sample_rows)?e.data.sample_rows.length:0,O=(K=e.data)==null?void 0:K.metrics,R=x.useMemo(()=>O?A>T||typeof O.total_rows=="number"&&O.total_rows>A:!1,[O,T,A]);x.useEffect(()=>{var ne,le;if(e.status!=="success"||!e.data){v(ce=>ce.status==="idle"?ce:Uw()),b(null),j(null);return}const Q=Bw((ne=e.data.signals)==null?void 0:ne.full_execution,i);b(Q),j((le=e.data.signals)==null?void 0:le.full_execution),v({status:"ready",columns:[...D],rows:[...k],nextOffset:T,hasMore:R,totalRows:typeof(O==null?void 0:O.total_rows)=="number"?O.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[D,k,T,R,i,O==null?void 0:O.total_rows,j,e.data,e.status]),x.useEffect(()=>{var ce,ie;if(!y||!y.isActive)return;const Q=(ie=(ce=e.data)==null?void 0:ce.signals)==null?void 0:ie.full_execution;if(!Q||!Q.job_id||!t)return;const ne=typeof Q.poll_after_seconds=="number"&&Q.poll_after_seconds>0?Q.poll_after_seconds*1e3:5e3,le=setTimeout(()=>{Promise.resolve().then(()=>Xz).then(ge=>ge.fetchFullExecutionStatus(t,Q.job_id)).then(ge=>{const Re=Bw(ge,i);b(Re),j(ge),C(ge),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(ge=>{console.error("Failed to poll background job status:",ge)})},ne);return()=>clearTimeout(le)},[y,t,i,C,j,e.data]);const L=_.columns.length>0?_.columns:D,F=_.rows.length>0?_.rows:k,B=_.totalRows??(typeof(O==null?void 0:O.total_rows)=="number"?O.total_rows:null),q=_.status==="idle"?R:_.hasMore,I=_.status==="loading",U=F.length,V=x.useMemo(()=>{if(!U)return null;const Q=i(U);if(B!==null&&B>=0){const ne=i(B),le=`Loaded ${Q} of ${ne} rows.`;return q&&U<B?`${le} Load more rows to continue.`:!q&&U<B?`${le} Preview limited by backend settings.`:le}return q?`Loaded ${Q} rows. Additional rows available.`:`Loaded ${Q} rows.`},[q,i,U,B]),H=x.useMemo(()=>(_.status==="idle"?[]:_.samplingAdjustments).map(sR).map(ne=>ne.trim()).filter(Boolean),[_.samplingAdjustments,_.status]),G=_.status==="idle"?!1:_.largeDataset,W=x.useCallback(()=>{var ce;if(!t||!q||_.status==="loading")return;const Q=_.rows.length>0?_.rows:k,ne=_.status==="idle"?Q.length:_.nextOffset??Q.length,le=Array.isArray((ce=e.data)==null?void 0:ce.sample_rows)?e.data.sample_rows:[];if(ne<le.length){const ie=le.slice(ne,ne+Zd),ge=Q.concat(ie),Re=ne+ie.length,ze=Re<le.length||typeof(O==null?void 0:O.total_rows)=="number"&&O.total_rows>le.length;v({status:"ready",columns:_.columns.length>0?_.columns:D,rows:ge,nextOffset:ze?Re:null,hasMore:ze,totalRows:typeof(O==null?void 0:O.total_rows)=="number"?O.total_rows:null,samplingAdjustments:_.samplingAdjustments,largeDataset:_.largeDataset,error:null});return}v(ie=>({...ie,status:"loading",error:null})),Mw(t,{}).then(ie=>{v(ge=>{const Re=ge.rows.length>0?ge.rows:Q,ze=Array.isArray(ie.columns)&&ie.columns.length>0?ie.columns.map(Qe=>String(Qe)):ge.columns.length>0?ge.columns:D,me=typeof ie.offset=="number"&&ie.offset>=0?ie.offset:0,xe=Array.isArray(ie.rows)?ie.rows:[],Ce=me<=Re.length?Re.slice(0,me):Re.slice(),Ae=me<=Re.length?Ce.concat(xe):Re.concat(xe),Ve=xe.length,Se=!!ie.has_more,We=typeof ie.next_offset=="number"?ie.next_offset:Se?me+Ve:null,ht=typeof ie.total_rows=="number"?ie.total_rows:null,ye=Se?null:Ae.length,Fe=ht!==null?ht:ge.totalRows!==null?ge.totalRows:ye;return{status:"ready",columns:[...ze],rows:Ae,nextOffset:We,hasMore:Se,totalRows:Fe,samplingAdjustments:Array.isArray(ie.sampling_adjustments)?ie.sampling_adjustments:[],largeDataset:!!ie.large_dataset,error:null}})}).catch(ie=>{v(ge=>({...ge,status:"error",error:(ie==null?void 0:ie.message)??"Unable to load additional rows."}))})},[D,k,t,q,_,(X=e.data)==null?void 0:X.sample_rows,O]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),y&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${y.tone}`,role:"status","aria-live":y.isActive?"polite":"off",title:y.details.length>0?y.details.join(" "):void 0,children:y.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:z,children:M?"Refreshing":"Refresh"})})]}),y&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[y.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:y.details.map((Q,ne)=>a.jsx("li",{children:Q},`${Q}-${ne}`))}),y.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>E(!w),"aria-expanded":w,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[w?a.jsx(Yf,{size:14}):a.jsx(Wf,{size:14}),w?"Hide":"Show"," job details"]}),w&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:y.metadata.map((Q,ne)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:Q.label}),a.jsx("dd",{children:Q.value})]},`${Q.label}-${Q.value}-${ne}`))})]})]}),M&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(rR,{preview:e.data,columns:L,rows:F,tableNote:V,formatCellValue:r,formatMetricValue:i,formatMissingPercentage:l,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:(y==null?void 0:y.stepLabel)??null,fullExecutionWarnings:(y==null?void 0:y.warnings)??[]}),_.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:_.error}),G&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",i(Zd)," rows to stay responsive."]}),H.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:H.map((Q,ne)=>a.jsx("li",{children:Q},`${Q}-${ne}`))})]}),q&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:W,disabled:I,children:I?"Loading rows":`Load next ${i(Zd)} rows`})}),!q&&!M&&B!==null&&U>=B&&U>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},_l=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],oR=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:s,graphContext:r,profilingGraphSignature:i,formatRelativeTime:l})=>{var B;const[u,d]=x.useState({status:"idle",data:null,error:null}),[f,p]=x.useState(0),[h,m]=x.useState({}),[_,v]=x.useState("500"),[y,b]=x.useState("summary"),[w,E]=x.useState(!1),N=x.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${_}::${i}`,[t,e==null?void 0:e.id,i,_,n]),j=x.useMemo(()=>N?h[N]??null:null,[h,N]);x.useEffect(()=>{v("500"),d({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),x.useEffect(()=>{if(!t){d({status:"idle",data:null,error:null});return}if(!n){d({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!s){d({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(j){d({status:"success",data:j,error:null});return}let q=!0;d({status:"loading",data:null,error:null});const I=_l.find(V=>V.value===_)??_l[1]??_l[0],U=I.value==="all"?"all":Number(I.value);return jw(n,{sampleSize:U,graph:r,targetNodeId:(e==null?void 0:e.id)??null}).then(V=>{q&&(N&&V&&m(H=>({...H,[N]:V})),d({status:"success",data:V??null,error:null}))}).catch(V=>{q&&d({status:"error",data:null,error:(V==null?void 0:V.message)??"Unable to generate dataset profile"})}),()=>{q=!1}},[j,r,s,t,e==null?void 0:e.id,f,N,_,n]);const C=u.data,M=(C==null?void 0:C.generated_at)??null,z=((B=C==null?void 0:C.correlations)==null?void 0:B.length)??0;x.useEffect(()=>{E(!1),b("summary")},[t,M]),x.useEffect(()=>{y==="correlations"&&z===0&&b("summary")},[y,z]);const D=x.useCallback(()=>{N&&m(q=>{if(!Object.prototype.hasOwnProperty.call(q,N))return q;const I={...q};return delete I[N],I}),p(q=>q+1)},[N]),k=x.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),T=x.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),A=x.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),O=x.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),R=x.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),L=x.useMemo(()=>_l.find(q=>q.value===_)??_l[0],[_]),F=x.useMemo(()=>l((C==null?void 0:C.generated_at)??null),[l,C==null?void 0:C.generated_at]);return{profileState:u,profileData:C,profilingSamplePreset:_,setProfilingSamplePreset:v,profilingActiveTab:y,setProfilingActiveTab:b,isProfilingWarningsOpen:w,setIsProfilingWarningsOpen:E,handleRefreshDatasetProfile:D,activeProfilingSamplePreset:L,profilingWarningsListId:k,profilingSummaryPanelId:T,profilingCorrelationsPanelId:A,profilingSummaryTabId:O,profilingCorrelationsTabId:R,profilingCorrelationCount:z,relativeProfilingGeneratedAt:F}},iR=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:s,formatMissingPercentage:r,previewState:i,onPendingConfigurationWarning:l})=>{if(!e)return null;const{profileState:u,profileData:d,profilingSamplePreset:f,setProfilingSamplePreset:p,profilingActiveTab:h,setProfilingActiveTab:m,isProfilingWarningsOpen:_,setIsProfilingWarningsOpen:v,handleRefreshDatasetProfile:y,activeProfilingSamplePreset:b,profilingWarningsListId:w,profilingSummaryPanelId:E,profilingCorrelationsPanelId:N,profilingSummaryTabId:j,profilingCorrelationsTabId:C,profilingCorrelationCount:M,relativeProfilingGeneratedAt:z}=t,D=u.status==="success"&&!!d;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:_l.map(k=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":k.value===f,onClick:()=>p(k.value),disabled:u.status==="loading",children:k.label},k.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:y,disabled:u.status==="loading",children:u.status==="loading"?"Refreshing":"Refresh"})]})]}),z&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",z]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:b.label}),"."]}),u.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),u.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u.error}),D&&d&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",d.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",d.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",d.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",d.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",d.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:j,role:"tab","data-active":h==="summary","aria-selected":h==="summary","aria-controls":E,onClick:()=>m("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:C,role:"tab","data-active":h==="correlations","aria-selected":h==="correlations","aria-controls":N,onClick:()=>m("correlations"),disabled:!M,children:"Correlations"})]}),h==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:E,role:"tabpanel","aria-labelledby":j,children:[d.warnings&&d.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>v(k=>!k),"aria-expanded":_,"aria-controls":w,children:_?"Hide warnings":`Show warnings (${d.warnings.length})`}),_&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:w,children:d.warnings.map((k,T)=>a.jsx("li",{children:k},`profiling-warning-${T}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:d.columns.map(k=>{const T=k.numeric_summary,A=!!T,O=Array.isArray(k.top_values)?k.top_values:[],R=Array.isArray(k.sample_values)?k.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${k.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:k.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:k.semantic_type??k.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${r(k.missing_percentage)} (${k.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:k.distinct_count!==null?k.distinct_count.toLocaleString():""})]})]}),A?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",s(T==null?void 0:T.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",s(T==null?void 0:T.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",s(T==null?void 0:T.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",s(T==null?void 0:T.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",s(T==null?void 0:T.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",s(T==null?void 0:T.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",s(T==null?void 0:T.percentile_75)]})]})]}):null,O.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:O.map((L,F)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(L.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[L.count.toLocaleString()," (",L.percentage.toFixed(1),"%)"]})]},`${k.name}-top-${F}`))})]}):null,R.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:R.slice(0,5).map((L,F)=>a.jsx("li",{children:n(L)},`${k.name}-sample-${F}`))})]}):null]},k.name)})})]}),h==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:N,role:"tabpanel","aria-labelledby":C,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),d.correlations&&d.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:d.correlations.map((k,T)=>{const A=Math.abs(k.coefficient);let O="low";A>=.85?O="extreme":A>=.7?O="strong":A>=.55&&(O="moderate");const R=k.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:k.column_a}),a.jsx("td",{children:k.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":O,"data-sign":R,children:k.coefficient.toFixed(2)})]},`profile-correlation-${T}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},lR=({title:e,isDataset:t,onClose:n,canResetNode:s=!1,onResetNode:r})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx("span",{className:`canvas-modal__title-glyph${t?" canvas-modal__title-glyph--dataset":""}`,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:t?a.jsx(D2,{size:24,strokeWidth:1.5}):a.jsx(q2,{size:24,strokeWidth:1.5})}),a.jsx("div",{children:a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e})})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[s&&r&&a.jsxs("button",{type:"button",className:"btn btn-outline-secondary",onClick:r,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(Xf,{size:16}),"Reset node"]}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(il,{size:24,strokeWidth:1.5})})]})]}),cR=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:s,canSave:r,onSave:i,isBusy:l,busyLabel:u,isSaving:d=!1,statusMessage:f})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsxs("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":l,children:[l&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:u??"Processing"})]}),!l&&f]}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsxs("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(Xf,{size:16}),"Reset node"]}),s&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>i({closeModal:!1}),disabled:!r||d,style:{display:"flex",alignItems:"center",gap:"0.5rem",minWidth:"180px",justifyContent:"center"},children:d?a.jsxs(a.Fragment,{children:[a.jsx(Gf,{size:16,className:"animate-spin"}),"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(i0,{size:16}),"Save and run changes"]})})]})]}),Js=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),ms=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},Bs=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return Js(t,n)},qw=e=>e==null||e===""?"":typeof e=="number"?Bs(e):String(e),uR=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},dR=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},Mr=({label:e,htmlFor:t,description:n,children:s,className:r=""})=>a.jsxs("div",{className:`canvas-modal__parameter-field ${r}`,children:[a.jsx("label",{htmlFor:t,className:"canvas-modal__parameter-label",children:e}),a.jsx("div",{className:"canvas-modal__parameter-control",children:s}),n&&a.jsx("p",{className:"canvas-modal__parameter-description",children:n})]}),Mp=({className:e="",...t})=>a.jsx("input",{type:"text",className:`canvas-modal__input ${e}`,...t}),yl=({className:e="",...t})=>a.jsx("input",{type:"number",className:`canvas-modal__input ${e}`,...t}),Jd=({className:e="",options:t,children:n,...s})=>a.jsxs("select",{className:`canvas-modal__select ${e}`,...s,children:[t.map(r=>a.jsx("option",{value:r.value,children:r.label},r.value)),n]}),vl=({label:e,fieldLabel:t,description:n,className:s="",...r})=>a.jsxs("div",{className:`canvas-modal__parameter-field ${s}`,children:[t&&a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:r.id,children:t})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",...r}),e]}),n&&a.jsx("p",{className:"canvas-modal__parameter-description",children:n})]}),mR=({className:e="",...t})=>a.jsx("input",{type:"range",className:`canvas-imputer__filter-range ${e}`,...t}),Vw=({className:e="",...t})=>a.jsx("textarea",{className:`canvas-modal__input ${e}`,...t}),em=({isOpen:e,onToggle:t,label:n="Advanced settings",description:s})=>a.jsxs("div",{className:"canvas-modal__advanced-toggle",children:[a.jsxs("button",{type:"button",className:"canvas-modal__advanced-button",onClick:t,"aria-expanded":e,children:[e?a.jsx(Yf,{size:16}):a.jsx(Wf,{size:16}),a.jsx("span",{children:n})]}),s&&!e&&a.jsx("span",{className:"canvas-modal__advanced-description",children:s})]}),hR=5,fR=4,pR=3,gR="_binned",Kw="Missing",_R=5,yR="ordinal",vR="quantile",xR=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],bR=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],Ap={equal_width:"Equal-width",equal_frequency:"Equal-frequency",custom:"Custom edges",kbins:"KBins (sklearn)"},wR=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],Fc=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],Yw=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",s=at(e==null?void 0:e.columns),r=(F,B,q,I)=>{const U=Number(F);if(!Number.isFinite(U))return B;const V=Math.round(U);return Math.max(q,Math.min(I,V))},i=r(e==null?void 0:e.equal_width_bins,hR,2,200),l=r(e==null?void 0:e.equal_frequency_bins,fR,2,200),u=r(e==null?void 0:e.precision,pR,0,8),d=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",f=!!((e==null?void 0:e.include_lowest)??!0),p=!!((e==null?void 0:e.drop_original)??!1),m=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||gR,_=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",v=["range","bin_index","ordinal","column_suffix"].includes(_)?_:"range",b=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",w=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",E=b==="label"&&w||Kw,N=r(e==null?void 0:e.kbins_n_bins,_R,2,200),j=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",C=["ordinal","onehot","onehot-dense"].includes(j)?j:yR,M=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",z=["uniform","quantile","kmeans"].includes(M)?M:vR,D=F=>{if(!Array.isArray(F))return[];const q=F.map(I=>{if(typeof I=="number")return I;if(I==null)return Number.NaN;const U=String(I).trim();return U?Number(U):Number.NaN}).filter(I=>Number.isFinite(I)).sort((I,U)=>I-U).filter((I,U,V)=>U===0||I!==V[U-1]);return q.length>=2?q:[]},k=F=>Array.isArray(F)?F.map(B=>String(B).trim()).filter(Boolean):typeof F=="string"?F.split(/[\,\n]/).map(B=>B.trim()).filter(Boolean):[],T=(F,B,q)=>{if(F==null)return null;const I=Number(F);if(!Number.isFinite(I))return null;const U=Math.round(I);return Math.max(B,Math.min(q,U))},A={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([F,B])=>{const q=String(F??"").trim();if(!q)return;const I=D(B);I.length>=2&&(A[q]=I)});const O={};e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([F,B])=>{const q=String(F??"").trim();if(!q)return;const I=k(B);I.length&&(O[q]=I)});const R={},L=e!=null&&e.column_strategies&&typeof e.column_strategies=="object"&&!Array.isArray(e.column_strategies)?e.column_strategies:e!=null&&e.column_overrides&&typeof e.column_overrides=="object"&&!Array.isArray(e.column_overrides)?e.column_overrides:null;return L&&Object.entries(L).forEach(([F,B])=>{const q=String(F??"").trim();if(!q||!B||typeof B!="object"||Array.isArray(B))return;const I=B,U={},V=typeof I.strategy=="string"?I.strategy.trim().toLowerCase():"";["equal_width","equal_frequency","custom","kbins"].includes(V)&&(U.strategy=V);const H=T(I.equal_width_bins,2,200);H!==null&&(U.equalWidthBins=H);const G=T(I.equal_frequency_bins,2,200);G!==null&&(U.equalFrequencyBins=G);const W=T(I.kbins_n_bins,2,200);W!==null&&(U.kbinsNBins=W);const J=typeof I.kbins_encode=="string"?I.kbins_encode.trim().toLowerCase():"";["ordinal","onehot","onehot-dense"].includes(J)&&(U.kbinsEncode=J);const ee=typeof I.kbins_strategy=="string"?I.kbins_strategy.trim().toLowerCase():"";["uniform","quantile","kmeans"].includes(ee)&&(U.kbinsStrategy=ee);const Z=D(I.custom_bins);Z.length>=2&&(U.customBins=Z);const K=k(I.custom_labels);K.length>0&&(U.customLabels=K),Object.keys(U).length>0&&(R[q]=U)}),{strategy:n,columns:s,equalWidthBins:i,equalFrequencyBins:l,includeLowest:f,precision:u,duplicates:d,outputSuffix:m,dropOriginal:p,labelFormat:v,missingStrategy:b,missingLabel:E,customBins:A,customLabels:O,columnStrategies:R,kbinsNBins:N,kbinsEncode:C,kbinsStrategy:z}},NR=(e,t,n,s=Ap)=>{if(!e.length)return null;const r=e.map(i=>{const l=t[i],u=(l==null?void 0:l.strategy)??null;if(!u)return i;const d=s[u]??u,f=[];u==="equal_width"&&(l!=null&&l.equalWidthBins)?f.push(`${l.equalWidthBins} bins`):u==="equal_frequency"&&(l!=null&&l.equalFrequencyBins)?f.push(`${l.equalFrequencyBins} bins`):u==="kbins"&&(l!=null&&l.kbinsNBins&&f.push(`${l.kbinsNBins} bins`),l!=null&&l.kbinsStrategy&&f.push(l.kbinsStrategy),l!=null&&l.kbinsEncode&&f.push(l.kbinsEncode));const p=f.length?` (${f.join(", ")})`:"";return`${i} -> ${d}${p}`});return n>e.length&&r.push(""),r.join(", ")},jR=({config:e,fieldIds:t,onIntegerChange:n,onBooleanToggle:s,onSuffixChange:r,onLabelFormatChange:i,onMissingStrategyChange:l,onMissingLabelChange:u,previewState:d,onPendingConfigurationWarning:f})=>{x.useEffect(()=>{var m,_;if((_=(m=d==null?void 0:d.data)==null?void 0:m.signals)!=null&&_.full_execution&&f){const v=At(d.data.signals.full_execution);v.length>0&&f(v)}},[d,f]);const[p,h]=x.useState(!1);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx(em,{isOpen:p,onToggle:()=>h(!p),label:"Advanced binning settings",description:"Configure output formatting, precision, and missing value handling"}),p&&a.jsxs("div",{style:{marginTop:"1rem"},children:[a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Global output & labeling"}),a.jsx("p",{className:"canvas-modal__note",children:"Applies to every selected column unless custom bins or labels override the defaults."}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsx(Mr,{label:"Output suffix",htmlFor:t.suffix,children:a.jsx(Mp,{id:t.suffix,value:e.outputSuffix,onChange:m=>r(m.target.value),placeholder:"e.g. _binned"})}),a.jsx(Mr,{label:"Label format",htmlFor:t.labelFormat,description:"Controls how new bin values are named when custom labels arent provided.",children:a.jsx(Jd,{id:t.labelFormat,value:e.labelFormat,onChange:m=>i(m.target.value??"range"),options:bR})}),a.jsx(Mr,{label:"Decimal precision",htmlFor:t.precision,description:"Sets rounding precision for interval labels.",children:a.jsx(yl,{id:t.precision,min:0,max:8,step:1,value:e.precision,onChange:m=>n("precision",m.target.value,0,8)})})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsx(vl,{id:t.includeLowest,label:"Include the minimum value in the first bin",checked:e.includeLowest,onChange:m=>s("include_lowest",m.target.checked)}),a.jsx(vl,{id:t.dropOriginal,label:"Remove source columns after binning",checked:e.dropOriginal,onChange:m=>s("drop_original",m.target.checked)})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:wR.map(m=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===m.value,onClick:()=>l(m.value),children:m.label},m.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:m=>u(m.target.value),placeholder:"e.g. Missing"})})]})]})]})]})},Ww=e=>Ap[e]??e.replace(/_/g," "),SR=e=>{switch(e){case"high":return"High confidence";case"medium":return"Medium confidence";case"low":return"Low confidence";default:return"Confidence unknown"}},ER=(e,t,n)=>{if(!e||typeof e!="object")return"No distribution summary";const s=[];typeof e.valid_count=="number"&&Number.isFinite(e.valid_count)&&s.push(`${t(e.valid_count)} valid rows`),typeof e.distinct_count=="number"&&Number.isFinite(e.distinct_count)&&s.push(`${t(e.distinct_count)} distinct values`);const r=typeof e.minimum=="number"&&Number.isFinite(e.minimum),i=typeof e.maximum=="number"&&Number.isFinite(e.maximum);if(r||i){const l=r?n(e.minimum):"",u=i?n(e.maximum):"";s.push(`Range ${l}  ${u}`)}return typeof e.skewness=="number"&&Number.isFinite(e.skewness)&&s.push(`Skew ${n(e.skewness)}`),s.length?s.join("  "):"No distribution summary"},CR=({hasSource:e,hasReachableSource:t,isFetching:n,error:s,relativeGeneratedAt:r,sampleSize:i,binningConfig:l,binningDefaultLabel:u,binningOverrideCount:d,binningOverrideSummary:f,recommendations:p,excludedColumns:h,numericColumnCount:m,canApplyAllNumeric:_,onApplyAllNumeric:v,onApplyStrategies:y,onClearOverrides:b,customEdgeDrafts:w,customLabelDrafts:E,onOverrideStrategyChange:N,onOverrideNumberChange:j,onOverrideKbinsEncodeChange:C,onOverrideKbinsStrategyChange:M,onOverrideClear:z,onCustomBinsChange:D,onCustomLabelsChange:k,onClearCustomColumn:T,formatMetricValue:A,formatNumericStat:O,previewState:R,onPendingConfigurationWarning:L,onPendingConfigurationCleared:F})=>{x.useEffect(()=>{var W,J;if((J=(W=R==null?void 0:R.data)==null?void 0:W.signals)!=null&&J.full_execution){const ee=At(R.data.signals.full_execution);ee.length>0?L==null||L(ee):F==null||F()}},[R,L,F]);const B=x.useMemo(()=>e?t?n?"Diagnostics are loading":s?"Diagnostics are unavailable at the moment.":m>0?`Detected ${m} numeric column${m===1?"":"s"} in the current sample.`:h.length>0?`Diagnostics skipped ${h.length} column${h.length===1?"":"s"} (see details).`:"No additional diagnostics were produced for the current sample.":"Connect this step to an upstream output to surface diagnostics.":"Select a dataset to surface diagnostics.",[s,h.length,t,e,n,m]),q=x.useMemo(()=>{const W=h.slice(0,6),J=Math.max(0,h.length-W.length);return{preview:W,remaining:J}},[h]),I=x.useMemo(()=>{const W=new Map;return p.forEach(J=>{const ee=typeof(J==null?void 0:J.column)=="string"?J.column.trim():"";ee&&W.set(ee,J)}),W},[p]),U=x.useMemo(()=>{const W=new Set;return l.columns.forEach(J=>{const ee=String(J??"").trim();ee&&W.add(ee)}),Object.keys(l.columnStrategies).forEach(J=>{const ee=String(J??"").trim();ee&&W.add(ee)}),p.forEach(J=>{const ee=typeof(J==null?void 0:J.column)=="string"?J.column.trim():"";ee&&W.add(ee)}),Array.from(W).sort((J,ee)=>J.localeCompare(ee))},[l.columnStrategies,l.columns,p]),V=(W,J)=>{var ee;return!W||Object.keys(W).length===0?"__default__":W.strategy?W.strategy:(ee=W.customBins)!=null&&ee.length?"custom":W.kbinsNBins||W.kbinsEncode||W.kbinsStrategy?"kbins":W.equalFrequencyBins?"equal_frequency":W.equalWidthBins?"equal_width":J},H=e&&t,G=W=>{var ee,Z;if(!W)return[];const J=[];return typeof W.equalWidthBins=="number"&&J.push(`${W.equalWidthBins} bins`),typeof W.equalFrequencyBins=="number"&&J.push(`${W.equalFrequencyBins} bins`),typeof W.kbinsNBins=="number"&&J.push(`${W.kbinsNBins} bins`),W.kbinsStrategy&&J.push(W.kbinsStrategy),W.kbinsEncode&&J.push(W.kbinsEncode),(ee=W.customBins)!=null&&ee.length&&J.push("Custom bins"),(Z=W.customLabels)!=null&&Z.length&&J.push("Custom labels"),J};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binning diagnostics"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("button",{type:"button",className:"btn btn-outline-secondary",onClick:b,disabled:!d,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(Cc,{size:14}),"Clear"]}),y&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:y,disabled:!p.length,children:"Quick apply"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:B}),a.jsxs("p",{className:"canvas-modal__note",children:["Default strategy ",a.jsx("strong",{children:u}),d>0?`  Overrides: ${d}${f?` (${f})`:""}`:"  No column overrides yet"]}),a.jsxs("div",{className:"canvas-modal__collapsible",children:[!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface binning insights and column diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),H&&a.jsxs(a.Fragment,{children:[r&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",r,i!==null?` on ${A(i)} row${i===1?"":"s"}.`:"."]}),v&&m>0&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:v,disabled:!_,children:`Add all numeric columns (${m})`})}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binning diagnostics"}),s&&!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s}),!s&&a.jsxs(a.Fragment,{children:[U.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested strategy"}),a.jsx("th",{scope:"col",children:"Configured strategy"}),a.jsx("th",{scope:"col",children:"Distribution highlights"})]})}),a.jsx("tbody",{children:U.map(W=>{var _t,Bt,$e,Ie,Be;const J=I.get(W)??null,ee=l.columnStrategies[W],Z=V(ee,l.strategy),K=Z==="__default__"?l.strategy:Z,X=(J==null?void 0:J.recommended_strategy)??null,Q=!!(X&&X!==K),ne=!!(ee&&Object.keys(ee).length),le=l.columns.includes(W),ce=J==null?void 0:J.recommended_bins,ie=typeof ce=="number"?ce:ce!=null?Number(ce):null,ge=typeof ie=="number"&&Number.isFinite(ie)&&ie>0?ie:null,Re=(ee==null?void 0:ee.equalWidthBins)??l.equalWidthBins,ze=(ee==null?void 0:ee.equalFrequencyBins)??l.equalFrequencyBins,me=(ee==null?void 0:ee.kbinsNBins)??l.kbinsNBins,xe=(ee==null?void 0:ee.kbinsEncode)??"__default__",Ce=(ee==null?void 0:ee.kbinsStrategy)??"__default__",Ae=["canvas-cast__row"];Q&&Ae.push("canvas-cast__row--attention"),ne&&Ae.push("canvas-cast__row--override"),le||Ae.push("canvas-cast__row--muted");const Ve=ER(J==null?void 0:J.stats,A,O),Se=((_t=J==null?void 0:J.reasons)==null?void 0:_t.filter(Ee=>Ee&&Ee.trim()))??[],We=(()=>{const Ee=G(ee),lt=Array.isArray(l.customBins[W])?l.customBins[W].length>=2:!1,Je=Array.isArray(l.customLabels[W])?l.customLabels[W].length>0:!1,Ue=[...Ee];return lt&&!Ue.includes("Custom bins")&&Ue.push("Custom bins"),Je&&!Ue.includes("Custom labels")&&Ue.push("Custom labels"),Ue})(),ht=Z==="__default__"?`Inheriting ${u}`:`Override  ${Ww(K)}${We.length?` (${We.join(", ")})`:""}`,ye=(J==null?void 0:J.dtype)??null,Fe=J?SR(J.confidence):null,Qe=Object.prototype.hasOwnProperty.call(w,W)?w[W]:((Bt=l.customBins[W])==null?void 0:Bt.join(", "))??"",tt=Object.prototype.hasOwnProperty.call(E,W)?E[W]:(($e=l.customLabels[W])==null?void 0:$e.join(", "))??"",xt=(((Ie=l.customBins[W])==null?void 0:Ie.length)??0)>=2||(((Be=l.customLabels[W])==null?void 0:Be.length)??0)>0;return a.jsxs("tr",{className:Ae.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:W}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[ye&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",ye]}),!le&&a.jsx("span",{className:"canvas-cast__muted",children:"Not currently in node"}),ne&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),Q&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--attention",children:"Needs review"})]})]})}),a.jsx("td",{children:a.jsx("div",{className:"canvas-cast__recommendation",children:J?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-cast__chip canvas-cast__chip--applied",children:Ww(J.recommended_strategy)}),a.jsxs("span",{className:"canvas-cast__recommendation-note",children:[ge!==null?`${ge} bin${ge===1?"":"s"}`:"Bins not provided",Fe?`  ${Fe}`:""]}),Se.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:Se.join("; ")})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:Z,onChange:Ee=>N(W,Ee.target.value,{recommendedBins:ge}),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",u,")"]}),xR.map(Ee=>a.jsx("option",{value:Ee.value,children:Ee.label},`${W}-${Ee.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:ht}),Z==="equal_width"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Re??"",onChange:Ee=>j(W,"equal_width_bins",Ee.target.value)})]})}),Z==="equal_frequency"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:ze??"",onChange:Ee=>j(W,"equal_frequency_bins",Ee.target.value)})]})}),Z==="kbins"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Max bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:me??"",onChange:Ee=>j(W,"kbins_n_bins",Ee.target.value)})]}),a.jsxs("label",{children:["Encode",a.jsxs("select",{value:xe,onChange:Ee=>C(W,Ee.target.value==="__default__"?null:Ee.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",l.kbinsEncode,")"]}),a.jsx("option",{value:"ordinal",children:"Ordinal"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})]}),a.jsxs("label",{children:["Strategy",a.jsxs("select",{value:Ce,onChange:Ee=>M(W,Ee.target.value==="__default__"?null:Ee.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",l.kbinsStrategy,")"]}),a.jsx("option",{value:"uniform",children:"Uniform"}),a.jsx("option",{value:"quantile",children:"Quantile"}),a.jsx("option",{value:"kmeans",children:"K-means"})]})]})]}),Z==="custom"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Custom edges",a.jsx("input",{type:"text",className:"canvas-modal__input",value:Qe,placeholder:"e.g. 0, 50, 100",onChange:Ee=>D(W,Ee.target.value)})]}),a.jsxs("label",{children:["Optional labels",a.jsx("input",{type:"text",className:"canvas-modal__input",value:tt,placeholder:"e.g. Low, Medium, High",onChange:Ee=>k(W,Ee.target.value)})]}),xt&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>T(W),children:"Clear custom edges"})]}),ne&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>z(W),children:"Clear"})]})}),a.jsx("td",{children:a.jsx("span",{children:Ve})})]},`binning-insight-${W}`)})})]})})}),!n&&U.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"No columns met the sampling requirements for binning recommendations."}),h.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",h.length," column",h.length===1?"":"s"," due to non-numeric values or limited variance",q.preview.length>0&&a.jsxs(a.Fragment,{children:[":"," ",q.preview.map(W=>`${W.column}${W.reason?` (${W.reason})`:""}`).join(", "),q.remaining>0?`,  (+${q.remaining} more)`:""]}),"."]})]})]})]})]})},kR=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:s,sampleSize:r,relativeGeneratedAt:i,error:l,onRefresh:u,canRefresh:d,previewState:f,onPendingConfigurationWarning:p})=>{x.useEffect(()=>{var m,_;if((_=(m=f==null?void 0:f.data)==null?void 0:m.signals)!=null&&_.full_execution&&p){const v=At(f.data.signals.full_execution);v.length>0&&p(v)}},[f,p]);const h=x.useMemo(()=>Fc.find(m=>m.value===t)??Fc[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:Fc.map(m=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":m.value===t,onClick:()=>n(m.value),disabled:s,children:m.label},m.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:u,disabled:s||!d,children:s?"Refreshing":"Refresh"})]})]}),r!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:h.label}),"."," ",h.value==="all"?`Summaries computed from the full dataset (${r.toLocaleString()} rows).`:`Summaries computed from ${r.toLocaleString()} sampled rows.`]}),i&&a.jsxs("p",{className:"canvas-modal__note",children:["Updated ",i]}),s&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!s&&l&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l}),!s&&!l&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(m=>{const _=m.topPercentage!==null?`${m.topPercentage.toFixed(1)}%`:null,v=m.topCount!==null?`${m.topCount.toLocaleString()}${_?`  ${_}`:""}`:_??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:m.column}),m.sourceColumn&&m.sourceColumn!==m.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:m.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:m.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:v})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:m.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:m.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:m.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:m.bins.map(y=>{const b=y.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",w=Math.min(100,Math.max(0,y.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:b,children:y.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${w}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:y.count.toLocaleString()}),a.jsxs("span",{children:[y.percentage.toFixed(1),"%"]})]})]},`${m.column}-${y.label}`)})}),m.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",m.bins.length," of ",m.totalBinCount," bins."]})]},`binned-card-${m.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},MR=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],AR=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],OR=[...MR,...AR],TR=[0,5,10,20,40,60],$R=["float","double","int","uint","long","short","byte","number","decimal"],LR=["bool","boolean"],zR=["object","string","category","datetime","date","time"],RR=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:zR.some(n=>t.includes(n))?!1:!!($R.some(n=>t.includes(n))||LR.some(n=>t.includes(n)))},Gw=e=>e!=="mode",Xw=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},Bc=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,s=Number(n);return{neighbors:Number.isFinite(s)?Math.max(1,Math.round(s)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,s=Number(n);return{max_iter:Number.isFinite(s)?Math.max(1,Math.round(s)):10}}},Qw=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",s=new Set(t);return e.map(r=>{if(!r||typeof r!="object")return null;const i=typeof r.method=="string"?r.method.trim().toLowerCase():n,l=s.has(i)?i:n;let u=[];Array.isArray(r.columns)?u=r.columns.map(h=>String(h).trim()).filter(Boolean):typeof r.columns=="string"&&(u=r.columns.split(",").map(h=>h.trim()).filter(Boolean));const d=r.options&&typeof r.options=="object"?r.options:{};let f;if(l==="knn"){const h=d.neighbors??r.neighbors,m=Number(h);f={neighbors:Number.isFinite(m)?Math.max(1,Math.round(m)):5}}else if(l==="regression"||l==="mice"){const h=d.max_iter??d.maxIter??r.max_iter??r.maxIter,m=Number(h);f={max_iter:Number.isFinite(m)?Math.max(1,Math.round(m)):10}}const p=Bc(l,f??Xw(l));return{method:l,columns:u,options:p}}).filter(r=>!!r)},DR=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),PR=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:s,methodOptions:r,missingFilter:i,missingFilterMax:l,missingFilterActive:u,filteredOptionCount:d,collapsedStrategies:f,onToggleStrategy:p,onRemoveStrategy:h,onAddStrategy:m,onMethodChange:_,onOptionNumberChange:v,onColumnsChange:y,onColumnToggle:b,onMissingFilterChange:w,formatMissingPercentage:E,formatNumericStat:N,formatModeStat:j,schemaDiagnostics:C,previewState:M,onPendingConfigurationWarning:z,onPendingConfigurationCleared:D})=>{x.useEffect(()=>{var R,L;if((L=(R=M==null?void 0:M.data)==null?void 0:R.signals)!=null&&L.full_execution){const F=At(M.data.signals.full_execution);F.length>0?z==null||z(F):D==null||D()}},[M,z,D]);const k=ve.useMemo(()=>{var R;return(R=C==null?void 0:C.entries)!=null&&R.length?new Map(C.entries.map(L=>[L.index,L])):new Map},[C]),T=Math.max(l,i||0),A=s.length>0,O=R=>{var F,B,q;const L=((F=r.find(I=>I.value===R.method))==null?void 0:F.label)??R.method;return R.method==="knn"&&((B=R.options)!=null&&B.neighbors)?`${L}  k=${R.options.neighbors}`:(R.method==="regression"||R.method==="mice")&&((q=R.options)!=null&&q.max_iter)?`${L}  ${R.options.max_iter} iter`:L};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:m,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(C==null?void 0:C.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:C.message}),s.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",d," of ",s.length," column",s.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx(mR,{id:"imputer-missing-filter",min:0,max:T,step:1,value:i,onChange:R=>w(Number(R.target.value))}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[i,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>w(0),disabled:!i,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:TR.map(R=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${i===R?" canvas-imputer__filter-button--active":""}`,onClick:()=>w(R),children:["",R,"%"]},`imputer-missing-preset-${R}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map((R,L)=>{var ee,Z,K;const F=R.columns.join(", "),B=Gw(R.method),q=s.filter(X=>{if(R.columns.includes(X.name))return!0;if(B&&!RR(X))return!1;const Q=typeof X.missingPercentage=="number"?X.missingPercentage:null;return Q!==null?Q<=0?!1:Q>=i:i===0}),I=O(R),U=R.columns.length?`${R.columns.length} column${R.columns.length===1?"":"s"}`:"No columns yet",V=f.has(L),H=q.filter(X=>!R.columns.includes(X.name)),G=k.get(L),W=(ee=G==null?void 0:G.details)!=null&&ee.length?G.details.map(X=>X.logical_family?`${X.name} (${X.logical_family})`:X.name).join(", "):"",J=()=>{if(!q.length)return;const X=[...R.columns];q.forEach(Q=>{X.includes(Q.name)||X.push(Q.name)}),y(L,X.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>p(L),"aria-expanded":!V,"aria-controls":`imputer-strategy-body-${L}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${V?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",L+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[I,"  ",U]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>h(L),"aria-label":`Remove strategy ${L+1}`,children:"Remove"})]}),!V&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${L}`,children:[a.jsx(Mr,{label:"Method",children:a.jsx(Jd,{value:R.method,onChange:X=>_(L,X.target.value??"mean"),options:r})}),R.method==="knn"&&a.jsx(Mr,{label:"Neighbors (k)",children:a.jsx(yl,{min:1,max:50,step:1,value:((Z=R.options)==null?void 0:Z.neighbors)??5,onChange:X=>v(L,"neighbors",X.target.value)})}),(R.method==="regression"||R.method==="mice")&&a.jsx(Mr,{label:"Max iterations",children:a.jsx(yl,{min:1,max:100,step:1,value:((K=R.options)==null?void 0:K.max_iter)??10,onChange:X=>v(L,"max_iter",X.target.value)})}),R.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),W&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",W,"."]}),q.length>0&&H.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:J,children:"Select all columns"}),q.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:q.map(X=>{const Q=R.columns.includes(X.name),ne=E(X.missingPercentage),le=typeof X.mean=="number",ce=typeof X.median=="number",ie=X.mode!==null&&X.mode!==void 0&&X.mode!=="",ge=le||ce||ie;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Q?" canvas-imputer__column-pill--selected":""}`,onClick:()=>b(L,X.name),"aria-pressed":Q,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:X.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",ne]}),X.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:X.dtype})]}),ge&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[le&&a.jsxs("span",{children:["Mean: ",N(X.mean)]}),ce&&a.jsxs("span",{children:["Median: ",N(X.median)]}),ie&&a.jsxs("span",{children:["Mode: ",j(X.mode)]})]})]},X.name)})}):a.jsx("p",{className:"canvas-modal__note",children:A?u?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${R.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:R.columns.length?R.columns.map(X=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:X},X)):a.jsx("span",{children:"No columns selected yet."})}),a.jsx(Mr,{label:"Manual columns (optional)",children:a.jsx(Mp,{value:F,onChange:X=>y(L,X.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${L}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},IR=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:s,scalingMethodOptions:r,scalingMethodDetailMap:i,scalingDefaultDetail:l,scalingAutoDetectEnabled:u,scalingSelectedCount:d,scalingDefaultLabel:f,scalingOverrideCount:p,scalingOverrideExampleSummary:h,scalingRecommendationRows:m,scalingHasRecommendations:_,scalingStatusMessage:v,scalingError:y,scalingSampleSize:b,relativeScalingGeneratedAt:w,formatMetricValue:E,formatNumericStat:N,formatMissingPercentage:j,onApplyAllRecommendations:C,onClearOverrides:M,onDefaultMethodChange:z,onAutoDetectToggle:D,onOverrideSelect:k,previewState:T,onPendingConfigurationWarning:A,onPendingConfigurationCleared:O})=>{x.useEffect(()=>{var L,F;if((F=(L=T==null?void 0:T.data)==null?void 0:L.signals)!=null&&F.full_execution){let q=At(T.data.signals.full_execution);u&&(q=q.filter(I=>!I.label.toLowerCase().includes("columns"))),q.length>0?A==null||A(q):O==null||O()}},[T,A,O,u]);const R=l??i.get(s.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:C,disabled:!_,children:"Apply recommendations"}),a.jsxs("button",{type:"button",className:"btn btn-outline-secondary",onClick:M,disabled:!p,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(Cc,{size:14}),"Clear overrides"]})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),w&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",w,b!==null?` on ${E(b)} row${b===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:r.map(L=>{const F=i.get(L.value)??null,B=L.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${B?" canvas-scaling__method-button--active":""}`,"aria-pressed":B,onClick:()=>z(L.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:L.label}),(F==null?void 0:F.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:F.description})]},L.value)})}),(R==null?void 0:R.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:R.description})]}),a.jsx(vl,{fieldLabel:"Auto-detect numeric columns",label:u?"Enabled":"Disabled",checked:u,onChange:L=>D(L.target.checked),description:"When enabled, recommended numeric features join this node automatically after each refresh."})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:f})," ",u?" Auto-detect on":" Auto-detect off",p>0?`  Overrides: ${p}${h?` (${h})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&y&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:y}),!n&&!y&&a.jsxs(a.Fragment,{children:[v&&a.jsx("p",{className:"canvas-modal__note",children:v}),m.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:m.map(L=>{const F=!L.isSkipped&&L.recommendedMethod!==L.currentMethod,B=["canvas-cast__row"];F&&B.push("canvas-cast__row--attention"),L.isOverrideApplied&&B.push("canvas-cast__row--override"),L.isSkipped&&B.push("canvas-cast__row--muted");const q=L.isSkipped?"__skip__":L.isOverrideApplied?L.currentMethod:"__default__",I=L.isOverrideApplied?`Override -> ${L.currentMethodLabel}`:L.isSkipped?"Skipped (column will not be scaled)":L.isSelected?`Inheriting ${f}`:"Pending inclusion",U=L.stats,V=[];typeof U.valid_count=="number"&&Number.isFinite(U.valid_count)&&V.push(`${E(U.valid_count)} valid rows`),typeof U.mean=="number"&&Number.isFinite(U.mean)&&V.push(`Mean ${N(U.mean)}`),typeof U.median=="number"&&Number.isFinite(U.median)&&V.push(`Median ${N(U.median)}`),typeof U.stddev=="number"&&Number.isFinite(U.stddev)&&V.push(` ${N(U.stddev)}`),typeof U.iqr=="number"&&Number.isFinite(U.iqr)&&V.push(`IQR ${N(U.iqr)}`);const H=typeof U.minimum=="number"&&Number.isFinite(U.minimum),G=typeof U.maximum=="number"&&Number.isFinite(U.maximum);if(H||G){const J=H?N(U.minimum):"",ee=G?N(U.maximum):"";V.push(`Range ${J}  ${ee}`)}typeof U.skewness=="number"&&Number.isFinite(U.skewness)&&V.push(`Skew ${N(U.skewness)}`),typeof U.outlier_ratio=="number"&&Number.isFinite(U.outlier_ratio)&&U.outlier_ratio>0&&V.push(`${j(U.outlier_ratio*100)} outliers`);const W=V.length?V.join("  "):null;return a.jsxs("tr",{className:B.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:L.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[L.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",L.dtype]}),L.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),L.isSelected&&!L.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),L.isSkipped&&!L.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),L.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${F?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:L.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:L.confidenceLabel}),L.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:L.reasons.join("; ")})]})}),a.jsx("td",{children:W?a.jsx("span",{children:W}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:q,onChange:J=>k(L.column,J.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",f,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),r.map(J=>a.jsx("option",{value:J.value,children:J.label},`${L.column}-${J.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:I})]})})]},`scaling-row-${L.column}`)})})]})})})]})]})},tm=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],FR="log",ya=e=>typeof e=="string"&&tm.includes(e),Zw=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",s=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const r=ya(s)?s:FR;return{column:n,method:r}}).filter(t=>!!t):[],Op=e=>{const t=new Set,n=[];return e.forEach(s=>{const r=`${s.column}__${s.method}`;t.has(r)||(t.add(r),n.push(s))}),n},Jw={left:"Left skew",right:"Right skew"},BR={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},HR=e=>{const t={...BR};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",r=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!s||!r||ya(s)&&(t[s]=r)}),t},UR=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:s,transformationMap:r})=>{const i=e==="recommended"?t.map(d=>d!=null&&d.column?d.column:null).filter(d=>!!d):n,l=new Set,u=[];return i.forEach(d=>{const f=typeof d=="string"?d.trim():"";if(!f||l.has(f))return;l.add(f);const p=s.get(f)??null,h=p?p.recommended_methods.filter(ya):[],m=h.length?h[0]:null,_=p!=null&&p.direction?Jw[p.direction]??p.direction:null,v=p!=null&&p.magnitude?`${p.magnitude.charAt(0).toUpperCase()}${p.magnitude.slice(1)}`:null,y=p&&typeof p.skewness=="number"&&Number.isFinite(p.skewness)?p.skewness:null,b=(p==null?void 0:p.summary)??null,w=r.get(f)??null;u.push({column:f,recommendedMethods:h,primaryMethod:m,directionLabel:_,magnitudeLabel:v,skewnessValue:y,summary:b,selectedMethod:w})}),u.sort((d,f)=>{const p=typeof d.skewnessValue=="number"?Math.abs(d.skewnessValue):-1/0,h=typeof f.skewnessValue=="number"?Math.abs(f.skewnessValue):-1/0;if(p!==h)return h-p;const m=!!d.primaryMethod,_=!!f.primaryMethod;return m!==_?m?-1:1:d.column.localeCompare(f.column)}),u},qR=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const s="no-recommendation",r=new Map;e.forEach(l=>{const u=l.primaryMethod??null,d=u??s,f=u?n(u):"No recommended action",p=r.get(d)??{key:d,label:f,method:u,rows:[]};p.rows.push(l),r.set(d,p)});const i=Array.from(r.values());return i.sort((l,u)=>{const d=m=>m?tm.indexOf(m):tm.length,f=d(l.method)-d(u.method);if(f!==0)return f;if(l.rows.length!==u.rows.length)return u.rows.length-l.rows.length;const p=l.label??"",h=u.label??"";return p.localeCompare(h)}),i},VR=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:s,skewnessError:r,skewnessViewMode:i,skewnessRecommendedCount:l,skewnessNumericCount:u,skewnessGroupByMethod:d,skewnessRows:f,skewnessTableGroups:p,hasSkewnessAutoRecommendations:h,skewnessTransformationsCount:m,isFetchingRecommendations:_,getSkewnessMethodLabel:v,getSkewnessMethodStatus:y,onApplyRecommendations:b,onViewModeChange:w,onGroupByToggle:E,onOverrideChange:N,onClearSelections:j,previewState:C,onPendingConfigurationWarning:M,onPendingConfigurationCleared:z})=>(x.useEffect(()=>{var D,k;if((k=(D=C==null?void 0:C.data)==null?void 0:D.signals)!=null&&k.full_execution){const T=At(C.data.signals.full_execution);T.length>0?M==null||M(T):z==null||z()}},[C,M,z]),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:b,disabled:n||!h,children:"Apply recommendations"})})]}),s!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",s.toFixed(2)," are surfaced below."]}),n&&f.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r}),(!n||f.length>0)&&!r&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="recommended",onClick:()=>w("recommended"),disabled:!l,children:["Recommended (",l,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="all",onClick:()=>w("all"),disabled:!u,children:["All numeric (",u,")"]})]}),a.jsx(vl,{label:"Group columns by recommended action",checked:d,onChange:D=>E(D.target.checked),className:"canvas-skewness__toggle"})]}),f.length===0?a.jsx("p",{className:"canvas-modal__note",children:i==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:p.map(D=>a.jsxs("div",{className:"canvas-skewness__group",children:[D.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:D.label}),a.jsxs("span",{children:[D.rows.length," column",D.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:D.rows.map(k=>{const T=[];k.directionLabel&&T.push(k.directionLabel),k.skewnessValue!==null&&T.push(`(${k.skewnessValue.toFixed(2)})`),k.magnitudeLabel&&T.push(` ${k.magnitudeLabel}`);const A=T.length?T.join(" "):"",O=k.selectedMethod??"",R=new Set(k.recommendedMethods),L=[{value:"",label:"No transform",status:null,reason:null}];k.recommendedMethods.forEach(q=>{const I=y(k.column,q);L.push({value:q,label:`${v(q)}${q===k.primaryMethod?" (recommended)":""}`,status:I,reason:(I==null?void 0:I.reason)??null})}),tm.forEach(q=>{if(R.has(q))return;const I=y(k.column,q);L.push({value:q,label:v(q),status:I,reason:(I==null?void 0:I.reason)??null})});const F=k.selectedMethod?y(k.column,k.selectedMethod):null,B=!k.selectedMethod&&k.primaryMethod?y(k.column,k.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${k.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:k.column}),k.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:k.summary})]})}),a.jsx("td",{children:k.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${k.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:k.primaryMethod?v(k.primaryMethod):v(k.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:A})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx(Jd,{value:O,onChange:q=>N(k.column,q.target.value),disabled:n||!t,options:[],children:L.map(q=>{var V;const I=q.reason?`${q.label} (caution: ${q.reason})`:q.label,U=((V=q.status)==null?void 0:V.status)??"ready";return a.jsx("option",{value:q.value,"data-status":U,children:I},`skewness-option-${k.column}-${q.value||"none"}`)})}),F&&F.status!=="ready"&&F.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",F.reason]}),!k.selectedMethod&&B&&B.status!=="ready"&&B.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",B.reason]})]})})]},`skewness-row-${k.column}`)})})]})})]},`skewness-group-${D.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:m?`${m} transformation${m===1?"":"s"} configured`:"No transformations configured yet."}),m>0&&a.jsxs("button",{type:"button",className:"btn btn-outline-secondary",onClick:j,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(Cc,{size:14}),"Clear selections"]})]})]})]})),KR=({counts:e,binEdges:t,className:n})=>{const s=x.useId(),r=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:r,"aria-hidden":"true"});const i=e.reduce((d,f)=>Math.max(d,f),0),l=i>0?i:1,u=100/e.length;return a.jsx("div",{className:r,role:"img","aria-label":"Histogram sparkline",style:{width:"100%",height:"100%",display:"flex"},children:a.jsxs("svg",{viewBox:"0 0 100 60",style:{width:"100%",height:"100%",overflow:"visible"},preserveAspectRatio:"none",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((d,f)=>{const p=d/l*52,h=f*u,m=58-p,_=Math.max(u-2,1);return a.jsx("rect",{x:h+1,y:m,width:_,height:p,rx:1.2,ry:1.2,fill:`url(#${s})`},`hist-bin-${f}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},YR=({skewnessThreshold:e,isFetchingSkewness:t,skewnessError:n,skewnessDistributionCards:s,skewnessDistributionView:r,setSkewnessDistributionView:i,onRefresh:l,canRefresh:u})=>{const d=(f,p,h)=>{const m=Math.max(0,f.sample_size||0),_=Math.max(0,f.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:p}),h?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:h}):null]}),a.jsx(KR,{counts:f.counts,binEdges:f.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Bs(f.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Bs(f.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Bs(f.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Bs(f.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Bs(f.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:m.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:_.toLocaleString()})]})]})]},p)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":r==="before",onClick:()=>i("before"),disabled:!s.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":r==="after",onClick:()=>i("after"),disabled:!s.length,children:"After"})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:t||!u,children:t?"Refreshing":"Refresh"})]})]}),e!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",e.toFixed(2)," are visualized below."]}),t&&s.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!t&&n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n}),(!t||s.length>0)&&!n&&(s.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:s.map(f=>{const p=f.distributionAfter,h=r==="before",m=r==="after"&&!!p,_=r==="after"&&!p,v=r==="before"?"Showing the original distribution returned by the skewness analysis.":p?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${f.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:f.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[f.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:f.directionLabel}),f.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:f.magnitudeLabel}),f.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",f.recommendedLabel]}),f.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",f.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:f.skewness!==null?Js(f.skewness,2):""})]})]}),f.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:f.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[h?d(f.distributionBefore,"Before transform"):null,m&&p?d(p,"After transform",f.appliedLabel):null,_?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",v]})]},`skewness-dist-${f.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]})},WR=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:s,flaggedColumnsInDataset:r,conflictCount:i}=t,l=s.length>0,u=e||"(no suffix)",d=r.slice(0,4),f=Math.max(r.length-d.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:s.length})," flag column",s.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:u}),"."]}),r.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",r.length," existing flag column",r.length===1?"":"s"," ","with this suffix",d.length>0?` (examples: ${d.join(", ")}${f>0?", ":""})`:"","."]}),i>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i," generated flag column",i===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),l?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:s.map(p=>{const h=[];p.conflicts.alreadyExists&&h.push("Already exists"),p.conflicts.duplicateFlag&&h.push("Duplicate name");const m=h.length>0,_=m?h.join("  "):"Ready",v=m?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",y=m?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:y,children:[a.jsx("th",{scope:"row",children:p.column}),a.jsx("td",{children:n(p.missingPercentage)}),a.jsx("td",{children:p.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:v,children:_})})]},`missing-indicator-${p.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},GR=({columnsParameter:e,suffixParameter:t,renderParameterField:n,previewState:s,onPendingConfigurationWarning:r,onPendingConfigurationCleared:i})=>(x.useEffect(()=>{var l,u;if((u=(l=s==null?void 0:s.data)==null?void 0:l.signals)!=null&&u.full_execution){const d=At(s.data.signals.full_execution);d.length>0?r==null||r(d):i==null||i()}},[s,r,i]),!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[e?n(e):null,t?n(t):null]})]})),eN=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],Tp="canonicalize_country_codes",XR=new Set(eN),QR=["string","object","text","category","mixed","varchar","char"],ZR=4,JR=6,ni=4,eD=3,tN=36,tD=5,$p={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},nN=eN.map(e=>{var t;return{value:e,label:((t=$p[e])==null?void 0:t.label)??e}}),nD=new Set(["true","1","yes","y","on"]),sD=new Set(["false","0","no","n","off"]),rD=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(nD.has(n))return!0;if(sD.has(n))return!1}return t},Lp=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Lp(e.split(",")):[],sN=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,s=Lp(n.columns),r=rD(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),i=sm(typeof n.mode=="string"?n.mode:void 0,t.mode);return!s.length&&!r?null:{mode:i,columns:s,autoDetect:r}},rN=(e,t)=>{const n={mode:t.mode,columns:Lp(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const r=sN(e,n);return r?[r]:[n]}const s=[];return e.forEach(r=>{const i=sN(r,n);i&&s.push(i)}),s.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):s},aD=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),oD=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),nm=e=>e.length<=tN?e:`${e.slice(0,tN-1)}...`,aN=e=>XR.has(e),oN=e=>{if(!e)return!1;const t=e.toLowerCase();return QR.some(n=>t.includes(n))},sm=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&aN(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&aN(s)?s:Tp},iD=e=>{const t=$p[e]??$p[Tp];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},lD=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:s})=>{const r=Array.from(new Set(at(e))),i=new Set(r),l=t.filter(p=>oN(n[p]??null)),u=l.filter(p=>!i.has(p)),d=r.filter(p=>!oN(n[p]??null)),f=typeof s=="boolean"?s:r.length===0;return{selectedColumns:r,nonTextSelected:d,autoDetectionActive:f,recommendedColumns:u,textColumnCount:l.length,textColumns:l}},cD=/[\n;,]+/,xl=(e,t)=>e.slice(0,t),rm=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[s,...r]=n,i=r.join(t);return[s,i]},uD=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],s=[],r=new Map;let i=0;const l=(p,h)=>{const m=String(p??"").trim(),_=String(h??"").trim();if(!m||!_){(m||_)&&n.push(`${m} => ${_}`.trim());return}const v=oD(m);if(!v){n.push(`${m} => ${_}`);return}r.has(v)?t.add(m):(r.set(v,_),s.length<ZR&&s.push(`${m} => ${_}`)),i+=1};if(typeof e=="string"){e.split(cD).forEach(v=>{const y=v.trim();if(y){if(y.includes("=>")){const b=rm(y,"=>");b?l(b[0],b[1]):n.push(y);return}if(y.includes(":")){const b=rm(y,":");b?l(b[0],b[1]):n.push(y);return}n.push(y)}});const h=Array.from(t),m=xl(h,ni),_=xl(n,ni);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:m,duplicateOverflow:Math.max(h.length-m.length,0),invalidEntries:_,invalidOverflow:Math.max(n.length-_.length,0)}}if(Array.isArray(e)){e.forEach(_=>{if(_){if(typeof _=="string"){const v=_.trim();if(!v)return;if(v.includes("=>")){const y=rm(v,"=>");y?l(y[0],y[1]):n.push(v)}else if(v.includes(":")){const y=rm(v,":");y?l(y[0],y[1]):n.push(v)}else n.push(v);return}if(typeof _=="object"){const{alias:v,replacement:y}=_;l(v,y);return}n.push(String(_))}});const p=Array.from(t),h=xl(p,ni),m=xl(n,ni);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:h,duplicateOverflow:Math.max(p.length-h.length,0),invalidEntries:m,invalidOverflow:Math.max(n.length-m.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([p,h])=>{l(p,h)});const u=Array.from(t),d=xl(u,ni),f=xl(n,ni);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:d,duplicateOverflow:Math.max(u.length-d.length,0),invalidEntries:f,invalidOverflow:Math.max(n.length-f.length,0)}},dD=e=>{const t=e.slice(0,JR);return{preview:t,remaining:Math.max(e.length-t.length,0)}},mD=e=>{const t=e.slice(0,ni);return{preview:t,remaining:Math.max(e.length-t.length,0)}},hD=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?nm(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?nm(t):null}try{const t=JSON.stringify(e);return t?nm(t):null}catch{return nm(String(e))}},fD=(e,t=eD)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([r,i])=>{const l=typeof r=="string"?r.trim():"";if(!l)return;const u=hD(i);if(!u)return;const d=n[l]??[];d.includes(u)||d.length>=t||(n[l]=[...d,u])})}),n},pD=(e,t,n=tD)=>{if(!t.length)return[];const s=[];for(const r of t){if(s.length>=n)break;const i=e[r];!i||!i.length||s.push({column:r,values:i,overflow:0})}return s},zp=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),iN=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],lN=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);iN.forEach(e=>{e.forEach(t=>lN.add(zp(t)))});const cN=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],uN=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);cN.forEach(e=>{e.forEach(t=>uN.add(zp(t)))});const gD=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],_D=/^[A-Za-z]{2,3}$/,yD=/[^0-9A-Za-z\s]/,vD=/[^0-9A-Za-z]+/,am={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:iN},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:cN},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:gD},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},xD=e=>{const t=[];return e.forEach(n=>{n.split(vD).filter(Boolean).forEach(r=>{t.push(r)})}),t},bD=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(s=>yD.test(s));const n=xD(t).map(s=>zp(s));return n.length?e==="canonicalize_country_codes"?n.some(s=>lN.has(s))||t.some(s=>_D.test(s.trim())):e==="normalize_boolean"?n.some(s=>uN.has(s)):!1:!1},dN=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},wD=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:r,sampleMap:i,modeOptions:l=nN,customPairSummary:u,customPairsParameter:d,collapsedStrategies:f,onToggleStrategy:p,onRemoveStrategy:h,onAddStrategy:m,onModeChange:_,onAutoDetectToggle:v,onColumnToggle:y,onColumnsChange:b,renderParameterField:w,previewState:E,onPendingConfigurationWarning:N,onPendingConfigurationCleared:j})=>{x.useEffect(()=>{var K,X;if((X=(K=E==null?void 0:E.data)==null?void 0:K.signals)!=null&&X.full_execution){const Q=At(E.data.signals.full_execution);Q.length>0?N==null||N(Q):j==null||j()}},[E,N,j]);const C=n.length>0,M=s.selectedColumns.length,z=x.useMemo(()=>dD(s.recommendedColumns),[s.recommendedColumns]),D=x.useMemo(()=>mD(s.nonTextSelected),[s.nonTextSelected]),k=x.useMemo(()=>pD(i,s.selectedColumns),[s.selectedColumns,i]),T=!e||!t,A=u.duplicates.length+u.duplicateOverflow,O=u.invalidEntries.length+u.invalidOverflow,R=u.duplicates.join(", "),L=u.invalidEntries.join(", "),F=x.useMemo(()=>n.some(K=>K.mode==="custom"),[n]),B=x.useMemo(()=>{const K=new Map;return n.forEach(X=>{X.columns.forEach(Q=>{const ne=Q.trim();ne&&K.set(ne,(K.get(ne)??0)+1)})}),K},[n]),[q,I]=x.useState(()=>new Set),U=x.useCallback(K=>{I(X=>{const Q=new Set(X);return Q.has(K)?Q.delete(K):Q.add(K),Q})},[]);x.useEffect(()=>{I(K=>{const X=new Set;return K.forEach(Q=>{Q<n.length&&X.add(Q)}),X.size===K.size?K:X})},[n.length]);const[V,H]=x.useState(()=>({index:null,mode:null})),G=x.useMemo(()=>{const K=new Map;return r.forEach(X=>{const Q=Array.isArray(X.samples)?X.samples:[],ne=Array.isArray(i[X.name])?i[X.name]:[],le=[...Q,...ne].map(ce=>String(ce??"").trim()).filter(ce=>ce.length>0);K.set(X.name,le.slice(0,12))}),K},[r,i]),W=x.useMemo(()=>{const K=new Map;return r.forEach(X=>{const Q=G.get(X.name)??[],ne=Q.length?Q:[X.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(le=>{bD(le,ne)&&(K.has(le)||K.set(le,new Set),K.get(le).add(X.name))})}),K},[r,G]);x.useEffect(()=>{if(V.index===null)return;const K=n[V.index];(!K||K.mode!==V.mode)&&H({index:null,mode:null})},[V.index,V.mode,n]);const J=x.useCallback((K,X)=>{H({index:K,mode:X})},[]),ee=x.useCallback(()=>{H({index:null,mode:null})},[]);let Z=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:m,children:"Add strategy"})})]}),s.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:M})," column",M===1?"":"s"," across all strategies."]}),k.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",k.map(K=>`${K.column} (${K.values.join(", ")})`).join("; "),"."]}),s.textColumnCount>0&&z.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",z.preview.join(", "),z.remaining>0?`, ... (${z.remaining} more)`:"","."]}),D.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[D.preview.join(", ")," ",D.preview.length===1?"is":"are"," not text-like.",D.remaining>0?` ${D.remaining} more column${D.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),T?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!C&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),C&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((K,X)=>{var ht;const Q=iD(K.mode),ne=((ht=l.find(ye=>ye.value===K.mode))==null?void 0:ht.label)??Q.label,le=K.columns.length,ce=le?`${le} column${le===1?"":"s"}`:K.autoDetect?"Auto-detecting columns":"No columns yet",ie=f.has(X),ge=q.has(X),Re=K.columns.join(", "),ze=W.get(K.mode)??new Set,me=K.mode==="custom"&&!!d&&!Z,xe=K.mode==="custom"&&!!d&&Z;me&&(Z=!0);const Ce=r.map(ye=>{const Fe=K.columns.includes(ye.name),Qe=ze.has(ye.name),tt=Fe?0:Qe?1:ye.isRecommended?2:ye.isTextLike?3:4;return{option:ye,priority:tt}}).sort((ye,Fe)=>ye.priority!==Fe.priority?ye.priority-Fe.priority:ye.option.name.localeCompare(Fe.option.name)).map(ye=>ye.option),Ae=ze.size>0,Ve=Ce.filter(ye=>K.columns.includes(ye.name)?!0:Ae?ze.has(ye.name):ye.isRecommended||ye.isTextLike),Se=new Set(Ve.map(ye=>ye.name)),We=Ce.filter(ye=>!Se.has(ye.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>p(X),"aria-expanded":!ie,"aria-controls":`alias-strategy-body-${X}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${ie?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",X+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[ne,K.autoDetect?"  auto-detect":"",ce?`  ${ce}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>h(X),"aria-label":`Remove alias strategy ${X+1}`,children:"Remove"})]}),!ie&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${X}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[l.map(ye=>{const Fe=ye.value===K.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${Fe?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":Fe,onClick:()=>_(X,ye.value),children:ye.label},ye.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>J(X,K.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:Q.guidance})]}),V.index===X&&V.mode===K.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:am[K.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:ee,children:"Close"})]}),a.jsx("p",{children:am[K.mode].description}),am[K.mode].preview&&a.jsx("ul",{children:am[K.mode].preview.map(([ye,Fe])=>a.jsxs("li",{children:[ye," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",Fe]},`${ye}-${Fe}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${X}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${X}-auto-detect`,type:"checkbox",checked:K.autoDetect,onChange:ye=>v(X,ye.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${X}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),r.length?a.jsxs(a.Fragment,{children:[ze.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",ne.toLowerCase()," entries."]}),Ve.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${X+1}`,children:Ve.map(ye=>{const Fe=K.columns.includes(ye.name),Qe=dN(ye.samples.length?ye.samples:i[ye.name]??[]),xt=(B.get(ye.name)??0)-(Fe?1:0)>0,_t=ze.has(ye.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Fe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>y(X,ye.name),"aria-pressed":Fe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ye.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ye.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ye.dtype}),ye.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!ye.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),_t&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),xt&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Qe&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Qe]})]},ye.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),We.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>U(X),"aria-expanded":ge,"aria-controls":`alias-strategy-${X}-other-columns`,children:ge?"Hide other columns":`Show other columns (${We.length})`}),ge&&a.jsx("div",{id:`alias-strategy-${X}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${X+1}`,children:We.map(ye=>{const Fe=K.columns.includes(ye.name),Qe=dN(ye.samples.length?ye.samples:i[ye.name]??[]),xt=(B.get(ye.name)??0)-(Fe?1:0)>0,_t=ze.has(ye.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Fe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>y(X,ye.name),"aria-pressed":Fe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ye.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ye.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ye.dtype}),!ye.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),_t&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),xt&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Qe&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Qe]})]},ye.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${K.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:K.columns.length?K.columns.map(ye=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:ye},ye)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${X}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${X}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:Re,onChange:ye=>b(X,ye.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),K.mode==="custom"&&d&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:me?w(d):xe?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${X}`)})}),u.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[u.totalPairs," custom pair",u.totalPairs===1?"":"s"," captured.",F?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",u.previewPairs.length>0?` Examples: ${u.previewPairs.join("; ")}${u.previewOverflow>0?"...":""}`:""]}),u.totalPairs===0&&F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),A>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",R?`: ${R}`:"",u.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),O>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",O," incomplete pair",O===1?"":"s",".",L?` Examples: ${L}${u.invalidOverflow>0?"...":""}`:""]})]})},om=["iso_date","iso_datetime","month_day_year","day_month_year"],ND="iso_date",jD=["date","time","timestamp","datetime"],SD=3,mN=36,Hc={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},Rp=om.map(e=>({value:e,label:Hc[e].label,guidance:Hc[e].guidance,example:Hc[e].example})),ED=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],hN=e=>e.length<=mN?e:`${e.slice(0,mN-1)}...`,fN=e=>{if(!e)return!1;const t=e.toLowerCase();return jD.some(n=>t.includes(n))},CD=e=>ED.some(t=>t.test(e)),pN=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&om.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&om.includes(s)?s:ND},kD=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s||!s.length)return;const r=s.length;let i=0;if(s.forEach(u=>{CD(u)&&(i+=1)}),!r)return;i/r>=.6&&i>=2&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},MD=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const r=Array.from(new Set(at(e)));r.sort((m,_)=>m.localeCompare(_));const i=new Set(r),l=t.filter(m=>fN(n[m]??null)),u=kD(s),d=new Set;l.forEach(m=>{i.has(m)||d.add(m)}),u.forEach(m=>{i.has(m)||d.add(m)});const f=Array.from(d);f.sort((m,_)=>m.localeCompare(_));const p=r.filter(m=>!(fN(n[m]??null)||u.includes(m))),h=u.slice().sort((m,_)=>m.localeCompare(_));return{selectedColumns:r,autoDetectionActive:r.length===0,recommendedColumns:f,nonDateSelected:p,dateColumnCount:l.length,sampleCandidateCount:u.length,sampleCandidates:h}},AD=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&om.includes(n)?n:t},OD=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},gN=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,s=e.map(r=>{if(!r||typeof r!="object")return null;const i=at(r.columns),l=Array.from(new Set(i.map(p=>p.trim()).filter(Boolean))).sort((p,h)=>p.localeCompare(h)),u=AD(r.mode,t.mode),d=OD(r.auto_detect??r.autoDetect??r.auto),f=`${u}|${l.join(",")}|${d?"auto":"manual"}`;return n.has(f)?null:(n.add(f),{mode:u,columns:l,autoDetect:d})}).filter(r=>!!r);return s.length?s:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},TD=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),$D=e=>{var t;return((t=Hc[e])==null?void 0:t.label)??Hc.iso_date.label},LD=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?hN(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?hN(t):null},zD=(e,t=SD)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([r,i])=>{const l=typeof r=="string"?r.trim():"";if(!l)return;const u=LD(i);if(!u)return;const d=n[l]??[];d.includes(u)||d.length>=t||(n[l]=[...d,u])})}),n},RD={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},_N=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},DD=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:r,sampleMap:i,collapsedStrategies:l,onToggleStrategy:u,onRemoveStrategy:d,onAddStrategy:f,onModeChange:p,onColumnToggle:h,onColumnsChange:m,onAutoDetectToggle:_,modeOptions:v=Rp,previewState:y,onPendingConfigurationWarning:b,onPendingConfigurationCleared:w})=>{x.useEffect(()=>{var A,O;if((O=(A=y==null?void 0:y.data)==null?void 0:A.signals)!=null&&O.full_execution){const R=At(y.data.signals.full_execution);R.length>0?b==null||b(R):w==null||w()}},[y,b,w]);const E=n.length>0,N=x.useMemo(()=>n.some(A=>A.autoDetect),[n]),[j,C]=x.useState(()=>new Set),M=x.useCallback(A=>{C(O=>{const R=new Set(O);return R.has(A)?R.delete(A):R.add(A),R})},[]);x.useEffect(()=>{C(A=>{const O=new Set;return A.forEach(R=>{R<n.length&&O.add(R)}),O.size===A.size?A:O})},[n.length]);const z=x.useMemo(()=>{const A=new Map;return n.forEach(O=>{O.columns.forEach(R=>{const L=R.trim();L&&A.set(L,(A.get(L)??0)+1)})}),A},[n]),D=x.useMemo(()=>{const A=s.recommendedColumns.slice(0,6),O=Math.max(s.recommendedColumns.length-A.length,0);return{preview:A,remaining:O}},[s.recommendedColumns]),k=x.useMemo(()=>{const A=s.nonDateSelected.slice(0,4),O=Math.max(s.nonDateSelected.length-A.length,0);return{preview:A,remaining:O}},[s.nonDateSelected]),T=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,children:"Add strategy"})})]}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),D.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",D.preview.join(", "),D.remaining>0?`,  (${D.remaining} more)`:"",".",N?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),s.sampleCandidates.length===0&&!D.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[k.preview.join(", ")," ",k.preview.length===1?"looks":"look"," non-date-like.",k.remaining>0?` ${k.remaining} more selected column${k.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),N&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",s.sampleCandidateCount||s.dateColumnCount," date-like columns that are not already assigned."]}),E?a.jsx("div",{className:"canvas-imputer__list",children:n.map((A,O)=>{var ee,Z;const R=((ee=v.find(K=>K.value===A.mode))==null?void 0:ee.label)??$D(A.mode),L=A.columns.length,F=L?`${L} column${L===1?"":"s"}`:A.autoDetect?"Auto-detecting columns":"No columns yet",B=l.has(O),q=A.columns.join(", "),I=`date-strategy-${O}-toggle`,U=`date-strategy-${O}-auto-detect`,V=r.map(K=>({option:K,priority:K.isRecommended?0:K.isSampleCandidate?1:2})).sort((K,X)=>K.priority!==X.priority?K.priority-X.priority:K.option.name.localeCompare(X.option.name)).map(K=>K.option),H=V.filter(K=>A.columns.includes(K.name)?!0:K.isRecommended||K.isSampleCandidate),G=new Set(H.map(K=>K.name)),W=V.filter(K=>!G.has(K.name)),J=j.has(O);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:I,className:"canvas-imputer__card-toggle",onClick:()=>u(O),"aria-expanded":!B,"aria-controls":`date-strategy-body-${O}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${B?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",O+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[R,A.autoDetect?"  auto-detect":"",F?`  ${F}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(O),"aria-label":`Remove date formatting strategy ${O+1}`,children:"Remove"})]}),!B&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${O}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${O}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${O}-mode`,value:A.mode,onChange:K=>p(O,K.target.value),children:v.map(K=>a.jsx("option",{value:K.value,children:K.label},K.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((Z=v.find(K=>K.value===A.mode))==null?void 0:Z.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:U,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:U,type:"checkbox",checked:A.autoDetect,onChange:K=>_(O,K.target.checked)}),a.jsx("label",{htmlFor:U,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),V.length?a.jsxs(a.Fragment,{children:[H.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:H.map(K=>{const X=A.columns.includes(K.name),Q=_N(K.samples.length?K.samples:i[K.name]??[]),le=(z.get(K.name)??0)-(X?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${X?" canvas-imputer__column-pill--selected":""}`,onClick:()=>h(O,K.name),"aria-pressed":X,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:K.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[K.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:K.dtype}),K.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!K.isRecommended&&K.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),le&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Q&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Q]})]},K.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),W.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>M(O),"aria-expanded":J,"aria-controls":`date-strategy-${O}-other-columns`,children:J?"Hide other columns":`Show other columns (${W.length})`}),J&&a.jsx("div",{id:`date-strategy-${O}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:W.map(K=>{const X=A.columns.includes(K.name),Q=_N(K.samples.length?K.samples:i[K.name]??[]),le=(z.get(K.name)??0)-(X?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${X?" canvas-imputer__column-pill--selected":""}`,onClick:()=>h(O,K.name),"aria-pressed":X,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:K.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[K.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:K.dtype}),le&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Q&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Q]})]},K.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${A.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:A.columns.length?A.columns.map(K=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:K},K)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${O}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${O}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:q,onChange:K=>m(O,K.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${O}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},yN=["both","leading","trailing"],vN="both",PD=["string","object","text","category","mixed","varchar","char"],ID=3,xN=36,bN=6,FD=4,BD=5,wN={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},HD=e=>e.length<=xN?e:`${e.slice(0,xN-1)}...`,NN=e=>{if(!e)return!1;const t=e.toLowerCase();return PD.some(n=>t.includes(n))},UD=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${HD(t)}'`},qD=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,VD=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&yN.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&yN.includes(s)?s:vN},KD=e=>{const t=wN[e]??wN[vN];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},YD=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s.length)return;const r=s.reduce((l,u)=>u.hasIssue?l+1:l,0);if(!r)return;const i=r/s.length;(r>=2||i>=.5)&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},WD=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const r=Array.from(new Set(at(e)));r.sort((h,m)=>h.localeCompare(m));const i=new Set(r),l=t.filter(h=>NN(n[h]??null)),u=YD(s),d=new Set;l.forEach(h=>{i.has(h)||d.add(h)}),u.forEach(h=>{i.has(h)||d.add(h)});const f=Array.from(d).sort((h,m)=>h.localeCompare(m)),p=r.filter(h=>!NN(n[h]??null));return{selectedColumns:r,autoDetectionActive:r.length===0,recommendedColumns:f,nonTextSelected:p,textColumnCount:l.length,whitespaceCandidateCount:u.length,whitespaceCandidates:u}},Dp=(e,t)=>e.slice(0,t),GD=e=>{const t=Dp(e,bN);return{preview:t,remaining:Math.max(e.length-t.length,0)}},XD=e=>{const t=Dp(e,FD);return{preview:t,remaining:Math.max(e.length-t.length,0)}},QD=e=>{const t=Dp(e,bN);return{preview:t,remaining:Math.max(e.length-t.length,0)}},ZD=(e,t=ID)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([r,i])=>{const l=typeof r=="string"?r.trim():"";if(!l)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=qD(u),f=UD(u),p=n[l]??[];p.find(h=>h.value===f)||p.length>=t||(n[l]=[...p,{value:f,hasIssue:d}])})}),n},JD=(e,t,n=BD)=>{if(!t.length)return[];const s=[];for(const r of t){if(s.length>=n)break;const i=e[r];!i||!i.length||s.push({column:r,values:i.map(l=>l.value),overflow:0})}return s},eP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},tP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:r,renderParameterField:i,columnSummary:l,modeDetails:u,sampleMap:d,previewState:f,onPendingConfigurationWarning:p,onPendingConfigurationCleared:h})=>{if(x.useEffect(()=>{var E,N;if((N=(E=f==null?void 0:f.data)==null?void 0:E.signals)!=null&&N.full_execution){const j=At(f.data.signals.full_execution);j.length>0?p==null||p(j):h==null||h()}},[f,p,h]),!n&&!s)return null;const m=l.selectedColumns.length,_=GD(l.recommendedColumns),v=XD(l.nonTextSelected),y=QD(l.whitespaceCandidates),b=JD(d,l.selectedColumns),w=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),l.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:m})," column",m===1?"":"s"," for trimming."]}),b.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",b.map(E=>`${E.column} (${E.values.join(", ")})`).join("; "),"."]}),y.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",y.preview.join(", "),y.remaining>0?`, ... (${y.remaining} more)`:"","."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[v.preview.join(", ")," ",v.preview.length===1?"is":"are"," not text-like.",v.remaining>0?` ${v.remaining} more column${v.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),w?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),r(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},jN=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],SN="keep_alphanumeric",nP=["string","object","text","category","mixed","varchar","char"],sP=3,EN=36,rP=6,aP=4,oP=5,CN={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},iP=e=>e.length<=EN?e:`${e.slice(0,EN-1)}...`,lP=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${iP(t)}'`},kN=e=>{if(!e)return!1;const t=e.toLowerCase();return nP.some(n=>t.includes(n))},cP=e=>/[^0-9A-Za-z\s]/.test(e),uP=e=>/[A-Za-z]/.test(e),dP=e=>/[0-9]/.test(e),mP=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&jN.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&jN.includes(s)?s:SN},hP=e=>{const t=CN[e]??CN[SN];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},fP=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([u,d])=>{if(!d.length)return;let f=0,p=0,h=0;d.forEach(m=>{m.hasSpecial&&(f+=1),m.hasDigits&&(p+=1),m.hasLetters&&(h+=1)}),f>0&&t.add(u),p>0&&h===0&&n.add(u),h>0&&p===0&&s.add(u)});const r=Array.from(t).sort((u,d)=>u.localeCompare(d)),i=Array.from(n).sort((u,d)=>u.localeCompare(d)),l=Array.from(s).sort((u,d)=>u.localeCompare(d));return{specialCandidates:r,digitsOnlyCandidates:i,lettersOnlyCandidates:l}},pP=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const r=Array.from(new Set(at(e)));r.sort((_,v)=>_.localeCompare(v));const i=new Set(r),l=t.filter(_=>kN(n[_]??null)),{specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:f}=fP(s),p=new Set;l.forEach(_=>{i.has(_)||p.add(_)}),u.forEach(_=>{i.has(_)||p.add(_)});const h=Array.from(p).sort((_,v)=>_.localeCompare(v)),m=r.filter(_=>!kN(n[_]??null));return{selectedColumns:r,autoDetectionActive:r.length===0,recommendedColumns:h,nonTextSelected:m,textColumnCount:l.length,specialCandidateCount:u.length,specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:f}},MN=(e,t)=>e.slice(0,t),gP=e=>{const t=MN(e,rP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},im=e=>{const t=MN(e,aP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},_P=(e,t=sP)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([r,i])=>{const l=typeof r=="string"?r.trim():"";if(!l)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=lP(u),f=cP(u),p={value:d,hasSpecial:f,hasDigits:dP(u),hasLetters:uP(u)},h=n[l]??[];h.find(m=>m.value===d)||h.length>=t||(n[l]=[...h,p])})}),n},yP=(e,t,n=oP)=>{if(!t.length)return[];const s=[];for(const r of t){if(s.length>=n)break;const i=e[r];!i||!i.length||s.push({column:r,values:i.map(l=>l.value),overflow:0})}return s},vP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},xP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,replacementParameter:r,renderMultiSelectField:i,renderParameterField:l,columnSummary:u,modeDetails:d,sampleMap:f,previewState:p,onPendingConfigurationWarning:h,onPendingConfigurationCleared:m})=>{if(x.useEffect(()=>{var C,M;if((M=(C=p==null?void 0:p.data)==null?void 0:C.signals)!=null&&M.full_execution){const z=At(p.data.signals.full_execution);z.length>0?h==null||h(z):m==null||m()}},[p,h,m]),!n&&!s&&!r)return null;const _=u.selectedColumns.length,v=gP(u.recommendedColumns),y=im(u.specialCandidates),b=im(u.digitsOnlyCandidates),w=im(u.lettersOnlyCandidates),E=im(u.nonTextSelected),N=yP(f,u.selectedColumns),j=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:_})," column",_===1?"":"s"," for cleanup."]}),N.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",N.map(C=>`${C.column} (${C.values.join(", ")})`).join("; "),"."]}),y.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",y.preview.join(", "),y.remaining>0?`, ... (${y.remaining} more)`:"","."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",b.preview.join(", "),b.remaining>0?`, ... (${b.remaining} more)`:"",". Consider `digits only` mode."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"",". Consider `letters only` mode."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"is":"are"," not text-like.",E.remaining>0?` ${E.remaining} more column${E.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),j?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),i(n)]}),(s||r)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?l(s):null,r?l(r):null]})]})},AN=["lower","upper","title","sentence"],ON="lower",bP=["string","object","text","category","mixed","varchar","char"],wP=3,TN=60,NP=6,jP=4,SP=5,$N={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},EP=e=>e.length<=TN?e:`${e.slice(0,TN-1)}...`,LN=e=>{if(!e)return!1;const t=e.toLowerCase();return bP.some(n=>t.includes(n))},Uc=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${EP(t)}'`},CP=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),kP=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),MP=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&AN.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&AN.includes(s)?s:ON},AP=e=>{const t=$N[e]??$N[ON];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},OP=(e,t)=>{const n=[];return Object.entries(e).forEach(([s,r])=>{if(!r.length)return;r.some(l=>{const u=l[t];return l.original!==u})&&n.push(s)}),n.sort((s,r)=>s.localeCompare(r)),n},TP=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s,mode:r})=>{const i=Array.from(new Set(at(e)));i.sort((m,_)=>m.localeCompare(_));const l=new Set(i),u=t.filter(m=>LN(n[m]??null)),d=OP(s,r),f=new Set;u.forEach(m=>{l.has(m)||f.add(m)}),d.forEach(m=>{l.has(m)||f.add(m)});const p=Array.from(f).sort((m,_)=>m.localeCompare(_)),h=i.filter(m=>!LN(n[m]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:p,nonTextSelected:h,textColumnCount:u.length,inconsistentColumns:d}},zN=(e,t)=>e.slice(0,t),$P=e=>{const t=zN(e,NP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},RN=e=>{const t=zN(e,jP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},LP=(e,t=wP)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([r,i])=>{const l=typeof r=="string"?r.trim():"";if(!l)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=Uc(u),f={original:d,lower:Uc(u.toLowerCase()),upper:Uc(u.toUpperCase()),title:Uc(CP(u)),sentence:Uc(kP(u))},p=n[l]??[];p.find(h=>h.original===d)||p.length>=t||(n[l]=[...p,f])})}),n},zP=(e,t,n,s=SP)=>{if(!t.length)return[];const r=[];for(const i of t){if(r.length>=s)break;const l=e[i];if(!l||!l.length)continue;const u=l.map(d=>`${d.original}  ${d[n]}`);r.push({column:i,values:u,overflow:0})}return r},RP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},DP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:r,renderParameterField:i,columnSummary:l,modeDetails:u,sampleMap:d,selectedMode:f,previewState:p,onPendingConfigurationWarning:h,onPendingConfigurationCleared:m})=>{if(x.useEffect(()=>{var N,j;if((j=(N=p==null?void 0:p.data)==null?void 0:N.signals)!=null&&j.full_execution){const C=At(p.data.signals.full_execution);C.length>0?h==null||h(C):m==null||m()}},[p,h,m]),!n&&!s)return null;const _=l.selectedColumns.length,v=$P(l.recommendedColumns),y=RN(l.inconsistentColumns),b=RN(l.nonTextSelected),w=zP(d,l.selectedColumns,f),E=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),l.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:_})," column",_===1?"":"s"," for case normalization."]}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",w.map(N=>`${N.column} (${N.values.join("; ")})`).join(" | "),"."]}),y.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",y.preview.join(", "),y.remaining>0?`, ... (${y.remaining} more)`:"","."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[b.preview.join(", ")," ",b.preview.length===1?"is":"are"," not text-like.",b.remaining>0?` ${b.remaining} more column${b.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),E?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),r(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},DN=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],PN="preset_digits_only",PP=["string","object","text","category","mixed","varchar","char"],IP=3,IN=60,FP=6,BP=4,HP=5,FN={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},UP=e=>e.length<=IN?e:`${e.slice(0,IN-1)}...`,qc=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${UP(t)}'`},BN=e=>{if(!e)return!1;const t=e.toLowerCase();return PP.some(n=>t.includes(n))},qP=e=>e.replace(/\s+/g," ").trim(),VP=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&DN.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&DN.includes(s)?s:PN},KP=e=>{const t=FN[e]??FN[PN];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},YP=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([i,l])=>{l.length&&l.forEach(u=>{u.hasDigits&&t.add(i),u.hasLetters&&n.add(i),u.hasWhitespaceRuns&&s.add(i)})});const r=i=>Array.from(i).sort((l,u)=>l.localeCompare(u));return{digits:r(t),letters:r(n),whitespace:r(s)}},WP=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const r=Array.from(new Set(at(e)));r.sort((_,v)=>_.localeCompare(v));const i=new Set(r),l=t.filter(_=>BN(n[_]??null)),{digits:u,letters:d,whitespace:f}=YP(s),p=new Set;l.forEach(_=>{i.has(_)||p.add(_)}),[...u,...d,...f].forEach(_=>{i.has(_)||p.add(_)});const h=Array.from(p).sort((_,v)=>_.localeCompare(v)),m=r.filter(_=>!BN(n[_]??null));return{selectedColumns:r,autoDetectionActive:r.length===0,recommendedColumns:h,nonTextSelected:m,textColumnCount:l.length,digitsCandidates:u,lettersCandidates:d,whitespaceCandidates:f}},HN=(e,t)=>e.slice(0,t),GP=e=>{const t=HN(e,FP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},lm=e=>{const t=HN(e,BP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},XP=(e,t=IP)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([r,i])=>{const l=typeof r=="string"?r.trim():"";if(!l)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=qc(u),f={original:d,presetDigits:qc(u.replace(/\D+/g,"")),presetLetters:qc(u.replace(/[^A-Za-z]+/g,"")),presetWhitespace:qc(qP(u)),hasDigits:/\d/.test(u),hasLetters:/[A-Za-z]/.test(u),hasWhitespaceRuns:/\s{2,}/.test(u)||/\t|\n|\r/.test(u)},p=n[l]??[];p.find(h=>h.original===d)||p.length>=t||(n[l]=[...p,f])})}),n},QP=(e,t,n)=>{const s=n??"",r=i=>i.length?i:"''";switch(t){case"preset_letters_only":return`${r(e.original)}  ${r(e.presetLetters)}`;case"preset_whitespace_collapse":return`${r(e.original)}  ${r(e.presetWhitespace)}`;case"custom":try{const i=new RegExp(s.split("|||")[0]??"",s.split("|||")[1]??""),l=qc(e.original.replace(i,s.split("|||")[2]??""));return`${r(e.original)}  ${r(l)}`}catch{return`${r(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${r(e.original)}  ${r(e.presetDigits)}`}},ZP=(e,t,n,s,r=HP)=>{if(!t.length)return[];const i=[];for(const l of t){if(i.length>=r)break;const u=e[l];if(!u||!u.length)continue;const d=u.map(f=>QP(f,n,s));i.push({column:l,values:d,overflow:0})}return i},JP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},eI=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",s=t[1]??"",r=t[2]??"";return!n.trim()&&!r.trim()?null:`Pattern: /${n||"(empty)"}/${s||"(none)"} Replacement: ${r||"''"}`},tI=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,patternParameter:r,replacementParameter:i,renderMultiSelectField:l,renderParameterField:u,columnSummary:d,modeDetails:f,sampleMap:p,selectedMode:h,replacementValue:m,previewState:_,onPendingConfigurationWarning:v,onPendingConfigurationCleared:y})=>{if(x.useEffect(()=>{var T,A;if((A=(T=_==null?void 0:_.data)==null?void 0:T.signals)!=null&&A.full_execution){const O=At(_.data.signals.full_execution);O.length>0?v==null||v(O):y==null||y()}},[_,v,y]),!n&&!s&&!r&&!i)return null;const b=d.selectedColumns.length,w=GP(d.recommendedColumns),E=lm(d.digitsCandidates),N=lm(d.lettersCandidates),j=lm(d.whitespaceCandidates),C=lm(d.nonTextSelected),M=eI(m),z=ZP(p,d.selectedColumns,h,m),D=!e||!t,k=h==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:f.label})," mode. ",f.guidance," Example: ",f.example,"."]}),M&&a.jsx("p",{className:"canvas-modal__note",children:M}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:b})," column",b===1?"":"s"," for regex cleanup."]}),z.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",z.map(T=>`${T.column} (${T.values.join("; ")})`).join(" | "),"."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",E.preview.join(", "),E.remaining>0?`, ... (${E.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"","."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[C.preview.join(", ")," ",C.preview.length===1?"is":"are"," not text-like.",C.remaining>0?` ${C.remaining} more column${C.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),k&&!M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),D?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),l(n)]}),(s||r||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,r?u(r):null,i?u(i):null]})]})},UN=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],qN="negative_to_nan",nI=["int","float","double","numeric","number","decimal","real","long"],sI=3,rI=6,aI=4,oI=5,VN={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},iI=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},lI=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},cI=e=>{if(!e)return!1;const t=e.toLowerCase();return nI.some(n=>t.includes(n))},uI=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&UN.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&UN.includes(s)?s:qN},dI=e=>{const t=VN[e]??VN[qN];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},mI=e=>{const t=new Set,n=new Set,s=new Set,r=new Set;Object.entries(e).forEach(([l,u])=>{u.forEach(d=>{d.isNegative&&t.add(l),d.isZero&&n.add(l),(d.numericValue<0||d.numericValue>100)&&s.add(l),(d.numericValue<0||d.numericValue>120)&&r.add(l)})});const i=l=>Array.from(l).sort((u,d)=>u.localeCompare(d));return{negative:i(t),zeros:i(n),percentage:i(s),age:i(r)}},hI=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const r=Array.from(new Set(at(e))).sort((v,y)=>v.localeCompare(y)),i=new Set(r),l=t.filter(v=>cI(n[v]??null)),u=new Set(l),{negative:d,zeros:f,percentage:p,age:h}=mI(s),m=new Set;l.forEach(v=>{i.has(v)||m.add(v)}),[...d,...f,...p,...h].forEach(v=>{i.has(v)||m.add(v)});const _=r.filter(v=>!u.has(v));return{selectedColumns:r,autoDetectionActive:r.length===0,recommendedColumns:Array.from(m).sort((v,y)=>v.localeCompare(y)),nonNumericSelected:_,numericColumnCount:l.length,negativeCandidates:d,zeroCandidates:f,percentageOutliers:p,ageOutliers:h}},fI=e=>{const t=e.slice(0,rI);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Vc=e=>{const t=e.slice(0,aI);return{preview:t,remaining:Math.max(e.length-t.length,0)}},pI=(e,t=sI)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([r,i])=>{const l=typeof r=="string"?r.trim():"";if(!l)return;const u=lI(i);if(u===null)return;const d=iI(String(i)),f={originalDisplay:d,numericValue:u,isNegative:u<0,isZero:Math.abs(u)<=1e-9},p=n[l]??[];p.find(h=>h.originalDisplay===d)||p.length>=t||(n[l]=[...p,f])})}),n},gI=0,_I=100,yI=0,vI=120,xI=(e,t,n,s)=>{switch(t){case"negative_to_nan":{const r=n??0;return e.numericValue<r?{flagged:!0,reason:`value < ${r}`}:s!==null&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const r=n??gI,i=s??_I;return e.numericValue<r?{flagged:!0,reason:`value < ${r}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"age_bounds":{const r=n??yI,i=s??vI;return e.numericValue<r?{flagged:!0,reason:`value < ${r}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"custom_range":default:{const r=n!=null,i=s!=null;return!r&&!i?{flagged:!1,reason:null}:r&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:i&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}}},bI=(e,t,n,s)=>{const{flagged:r,reason:i}=xI(e,t,n,s);return r?`${e.originalDisplay}  flagged (${i??"rule match"})`:`${e.originalDisplay}  ok`},wI=(e,t,n,s,r,i=oI)=>{if(!t.length)return[];const l=[];for(const u of t){if(l.length>=i)break;const d=e[u];!d||!d.length||l.push({column:u,values:d.map(f=>bI(f,n,s,r)),overflow:0})}return l},NI={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},jI=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const s=t===null?"-":String(t),r=n===null?"":String(n);return`Custom bounds active: [${s}, ${r}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const s=t??0;return n===null?`Negative-to-missing rule overrides values below ${s}.`:`Negative-to-missing rule overrides values < ${s} or > ${n}.`}return null},SI=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,minValueParameter:r,maxValueParameter:i,renderMultiSelectField:l,renderParameterField:u,columnSummary:d,modeDetails:f,sampleMap:p,selectedMode:h,minValue:m,maxValue:_,previewState:v,onPendingConfigurationWarning:y,onPendingConfigurationCleared:b})=>{if(x.useEffect(()=>{var R,L;if((L=(R=v==null?void 0:v.data)==null?void 0:R.signals)!=null&&L.full_execution){const F=At(v.data.signals.full_execution);F.length>0?y==null||y(F):b==null||b()}},[v,y,b]),!n&&!s&&!r&&!i)return null;const{selectedColumns:w,autoDetectionActive:E}=d,N=w.length,j=fI(d.recommendedColumns),C=Vc(d.negativeCandidates),M=Vc(d.zeroCandidates),z=Vc(d.percentageOutliers),D=Vc(d.ageOutliers),k=Vc(d.nonNumericSelected),T=wI(p,w,h,m,_),A=jI(h,m,_),O=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:f.label})," rule. ",f.guidance," Example: ",f.example,"."]}),A&&a.jsx("p",{className:"canvas-modal__note",children:A}),E?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:N})," column",N===1?"":"s"," for invalid value cleanup."]}),T.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",T.map(R=>`${R.column} (${R.values.join("; ")})`).join(" | "),"."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",C.preview.join(", "),C.remaining>0?`, ... (${C.remaining} more)`:"","."]}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",M.preview.join(", "),M.remaining>0?`, ... (${M.remaining} more)`:"","."]}),z.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",z.preview.join(", "),z.remaining>0?`, ... (${z.remaining} more)`:"","."]}),D.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",D.preview.join(", "),D.remaining>0?`, ... (${D.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[k.preview.join(", ")," ",k.preview.length===1?"is":"are"," not numeric-type columns.",k.remaining>0?` ${k.remaining} more column${k.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),O?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),l(n)]}),(s||r||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,r?u(r):null,i?u(i):null]})]})};let EI="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",KN=(e=21)=>{let t="",n=e|0;for(;n--;)t+=EI[Math.random()*64|0];return t};const YN=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],WN=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],Pp=[{value:"token_sort_ratio",label:"Token Sort  Same words, ignore order",description:"Split into words, sort alphabetically, then compare. Great when the same words appear in different order."},{value:"token_set_ratio",label:"Token Set  Unique words, ignore extras",description:"Focus on overlapping unique words and down-weight extras. Best when one string has additional words."},{value:"ratio",label:"Character Ratio  Raw string similarity",description:"Compare characters in order using edit distance. Sensitive to spelling differences."}],cm=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],CI=new Set(cm.map(e=>e.value)),Kc=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],Yc="UTC",um=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?um(e.split(",")):[]:[],GN=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(s=>{const r=Number(s);Number.isFinite(r)&&n.push(r)}),n}if(typeof e=="string")return GN(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},Ip=e=>{const t=Number(e);return Number.isFinite(t)?t:null},XN=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},kI=(e,t)=>{var s,r,i,l,u;if(typeof t!="string")return((s=Kc.find(d=>d.value===e))==null?void 0:s.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((i=YN.find(d=>d.value===n))==null?void 0:i.value)??"add":e==="stat"?((l=WN.find(d=>d.value===n))==null?void 0:l.value)??"mean":e==="similarity"?((u=Pp.find(d=>d.value===n))==null?void 0:u.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((r=Kc.find(d=>d.value===e))==null?void 0:r.defaultMethod)??""},MI=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},AI=e=>{const t=um(e);return t.length?t.filter(n=>CI.has(n)):["year","month","day"]},OI=e=>typeof e!="string"?Yc:e.trim()||Yc,QN=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,s)=>{if(!n||typeof n!="object")return;const r=n,i=MI(r.operation_type??r.type),l=r.operation_id??r.id??`feature_math_${s+1}`,u=typeof l=="string"&&l.trim()?l.trim():`feature_math_${s+1}`,d=kI(i,r.method),f=um(r.input_columns??r.inputs??r.inputColumns),p=um(r.secondary_columns??r.denominator??r.secondaryColumns),h=GN(r.constants),m=typeof r.output_column=="string"?r.output_column.trim():"",_=typeof r.output_prefix=="string"?r.output_prefix.trim():"",v=i==="datetime_extract"?AI(r.datetime_features):[],y=i==="datetime_extract"?OI(r.timezone):Yc,b=Ip(r.fillna),w=(()=>{const M=Ip(r.round??r.round_digits);return Number.isInteger(M??NaN),M})(),E=Ip(r.epsilon),N=i==="similarity"?XN(r.normalize,!1):!1,j=r.allow_overwrite===void 0?null:XN(r.allow_overwrite,!1),C=typeof r.description=="string"?r.description:void 0;t.push({id:u,type:i,method:d,inputColumns:f,secondaryColumns:p,constants:h,outputColumn:m,outputPrefix:_,datetimeFeatures:v,timezone:y,fillna:b,roundDigits:w,normalize:N,epsilon:E,allowOverwrite:j,description:C})}),t},TI=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||Yc):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},$I=e=>e.map(t=>TI(t)),LI={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},ZN=(e,t)=>{var r;const n=LI[e]??{};let s=`math_${e}_${KN(6)}`;for(;t.has(s);)s=`math_${e}_${KN(6)}`;return{id:s,type:e,method:n.method??((r=Kc.find(i=>i.value===e))==null?void 0:r.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:Yc,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},zI=(e,t)=>{const n=new Map;return t==null||t.forEach(s=>{s.operations.forEach(r=>{n.has(r.operation_id)||n.set(r.operation_id,r)})}),e.map((s,r)=>{const i=n.get(s.id),l=`${r+1}. ${s.type.replace("_"," ")}${s.method?`  ${s.method}`:""}`;return{id:s.id,label:l,status:i==null?void 0:i.status,message:(i==null?void 0:i.message)??void 0,outputColumns:(i==null?void 0:i.output_columns)??[]}})},JN=e=>e==="arithmetic"?YN:e==="stat"?WN:e==="similarity"?Pp:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],RI=e=>{const t=Pp.find(n=>n.value===e);return t!=null&&t.description?t.description:"Compare the input text columns using the selected similarity technique."},DI={applied:"Applied",skipped:"Skipped",failed:"Failed"},PI={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},II=new Set(cm.map(e=>e.value)),FI=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},ej=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],BI=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],HI=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",UI=({index:e,total:t,operation:n,summary:s,availableColumns:r,isCollapsed:i,onToggleCollapsed:l,onDuplicate:u,onRemove:d,onReorder:f,onChange:p})=>{var X;const h=x.useMemo(()=>JN(n.type),[n.type]),m=x.useMemo(()=>{var Q;return((Q=Kc.find(ne=>ne.value===n.type))==null?void 0:Q.label)??n.type},[n.type]),_=x.useMemo(()=>{var Q;return((Q=h.find(ne=>ne.value===n.method))==null?void 0:Q.label)??n.method},[h,n.method]),v=x.useMemo(()=>n.type==="similarity"?RI(n.method):"",[n.method,n.type]),[y,b]=x.useState(n.inputColumns.join(", ")),[w,E]=x.useState(n.secondaryColumns.join(", ")),[N,j]=x.useState(n.constants.join(", "));x.useEffect(()=>{b(n.inputColumns.join(", "))},[n.inputColumns]),x.useEffect(()=>{E(n.secondaryColumns.join(", "))},[n.secondaryColumns]),x.useEffect(()=>{j(n.constants.join(", "))},[n.constants]);const C=()=>{p(n.id,{inputColumns:ej(y)})},M=()=>{p(n.id,{secondaryColumns:ej(w)})},z=()=>{p(n.id,{constants:BI(N)})},D=`feature-math-toggle-${n.id}`,k=`feature-math-body-${n.id}`,T=`feature-math-input-columns-${n.id}`,A=`feature-math-secondary-columns-${n.id}`,O=s==null?void 0:s.status,R=O?a.jsx("span",{className:`canvas-cast__chip ${PI[O]??""}`,style:{marginLeft:"0.5rem"},children:DI[O]}):null,L=s!=null&&s.message?s.message.trim():"",F=HI(O),B=(X=s==null?void 0:s.outputColumns)!=null&&X.length?s.outputColumns.join(", "):"",q=FI(n.inputColumns),I=n.type==="ratio"||n.type==="similarity",U=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",V=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",H=n.type==="similarity",G=n.type==="datetime_extract",W=n.type==="stat"||n.type==="datetime_extract",J=x.useMemo(()=>{if(!r.length)return"";const Q=r.slice(0,6),ne=r.length-Q.length;return ne>0?`${Q.join(", ")}  (${ne} more)`:Q.join(", ")},[r]),ee=Q=>{if(!Q||!II.has(Q))return;const ne=new Set(n.datetimeFeatures);ne.has(Q)?ne.delete(Q):ne.add(Q),p(n.id,{datetimeFeatures:Array.from(ne)})},Z=Q=>ne=>{const le=ne.target.value;if(le===""){p(n.id,{[Q]:null});return}const ce=Number(le);Number.isFinite(ce)&&(Q==="roundDigits"?p(n.id,{roundDigits:Math.round(ce)}):Q==="fillna"?p(n.id,{fillna:ce}):p(n.id,{epsilon:ce}))},K=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:D,className:"canvas-imputer__card-toggle",onClick:()=>l(n.id),"aria-expanded":!i,"aria-controls":k,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${i?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[m,_?`  ${_}`:"",n.outputColumn?`   ${n.outputColumn}`:"",R]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",q]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!i&&a.jsxs("div",{className:"canvas-imputer__card-body",id:k,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>u(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>f(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>f(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),L&&a.jsx("p",{className:F,children:L}),B&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",B]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:Q=>p(n.id,{type:Q.target.value}),children:Kc.map(Q=>a.jsx("option",{value:Q.value,children:Q.label},Q.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:Q=>p(n.id,{method:Q.target.value}),children:h.map(Q=>a.jsx("option",{value:Q.value,children:Q.label},Q.value))})]}),n.type==="similarity"&&v&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:v}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:y,onChange:Q=>b(Q.target.value),onBlur:C,onKeyDown:Q=>{Q.key==="Enter"&&(Q.preventDefault(),C())},placeholder:"col_a, col_b",list:T}),a.jsx("datalist",{id:T,children:r.map(Q=>a.jsx("option",{value:Q},`${n.id}-input-option-${Q}`))}),J&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",J]})]}),I&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:w,onChange:Q=>E(Q.target.value),onBlur:M,onKeyDown:Q=>{Q.key==="Enter"&&(Q.preventDefault(),M())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:A}),a.jsx("datalist",{id:A,children:r.map(Q=>a.jsx("option",{value:Q},`${n.id}-secondary-option-${Q}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),U&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:N,onChange:Q=>j(Q.target.value),onBlur:z,onKeyDown:Q=>{Q.key==="Enter"&&(Q.preventDefault(),z())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:Q=>p(n.id,{outputColumn:Q.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),W&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:Q=>p(n.id,{outputPrefix:Q.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),V&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:Z("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:Z("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:Z("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),H&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:Q=>p(n.id,{normalize:Q.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),G&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:cm.map(Q=>{const ne=`feature-math-${n.id}-datetime-${Q.value}`,le=n.datetimeFeatures.includes(Q.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:ne,children:[a.jsx("input",{id:ne,type:"checkbox",checked:le,onChange:()=>ee(Q.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:Q.label})]},Q.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:Q=>p(n.id,{timezone:Q.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:K,onChange:Q=>{const ne=Q.target.value;ne==="inherit"?p(n.id,{allowOverwrite:null}):p(n.id,{allowOverwrite:ne==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},qI=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:s,onAddOperation:r,onDuplicateOperation:i,onRemoveOperation:l,onReorderOperation:u,onOperationChange:d,availableColumns:f,signals:p,previewStatus:h,previewState:m,errorHandlingParameter:_,allowOverwriteParameter:v,defaultTimezoneParameter:y,epsilonParameter:b,renderParameterField:w,onPendingConfigurationWarning:E,onPendingConfigurationCleared:N})=>{var A,O;x.useEffect(()=>{var L,F;if(!((F=(L=m==null?void 0:m.data)==null?void 0:L.signals)!=null&&F.full_execution)){N==null||N();return}const R=At(m.data.signals.full_execution);R.length>0?E==null||E(R):N==null||N()},[(O=(A=m==null?void 0:m.data)==null?void 0:A.signals)==null?void 0:O.full_execution,E,N]);const[j,C]=x.useState("arithmetic"),M=x.useMemo(()=>{const R=new Map;return t.forEach(L=>{R.set(L.id,L)}),R},[t]),z=x.useMemo(()=>p.length?p[p.length-1]:null,[p]),D=(z==null?void 0:z.warnings)??[],k=z&&z.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",T=()=>{r(j)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:T,children:"Add operation"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),h==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),z&&a.jsxs("p",{className:k,children:["Preview applied ",z.applied_operations," of ",z.total_operations," operation",z.total_operations===1?"":"s"," (",z.skipped_operations," skipped, ",z.failed_operations," failed)."]}),D.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:D.map((R,L)=>a.jsx("li",{children:R},`feature-math-warning-${L}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((R,L)=>a.jsx(UI,{index:L,total:e.length,operation:R,summary:M.get(R.id),availableColumns:f,isCollapsed:n.has(R.id),onToggleCollapsed:s,onDuplicate:i,onRemove:l,onReorder:u,onChange:d},R.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[_&&w(_),v&&w(v),y&&w(y),b&&w(b)]})]})},VI={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},KI={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},tj=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),YI=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:r,metadata:i,columnsParameter:l,autoDetectParameter:u,autoDetectValue:d,maxUniqueParameter:f,outputSuffixParameter:p,dropOriginalParameter:h,missingStrategyParameter:m,missingCodeParameter:_,selectedColumns:v,renderParameterField:y,onToggleColumn:b,onApplyRecommended:w,formatMissingPercentage:E,previewState:N,onPendingConfigurationWarning:j,onPendingConfigurationCleared:C})=>{var T,A;x.useEffect(()=>{var L,F;if(!((F=(L=N==null?void 0:N.data)==null?void 0:L.signals)!=null&&F.full_execution)){C==null||C();return}let R=At(N.data.signals.full_execution);d&&(R=R.filter(B=>!B.label.toLowerCase().includes("columns"))),v&&v.length>0&&(R=R.filter(B=>!B.label.toLowerCase().includes("columns"))),R.length>0?j==null||j(R):C==null||C()},[(A=(T=N==null?void 0:N.data)==null?void 0:T.signals)==null?void 0:A.full_execution,j,C,d,v]);const M=x.useMemo(()=>{if(!r.length)return[];const O=new Set;return r.forEach(R=>{R.status==="recommended"&&R.selectable&&O.add(R.column)}),Array.from(O)},[r]),z=x.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),D=r.length>0,k=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>w(M),disabled:!M.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((O,R)=>a.jsx("li",{children:O},`label-encoding-note-${R}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!D&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&D&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:r.map(O=>{const R=v.includes(O.column),L=VI[O.status],F=KI[O.status]??"canvas-cast__chip--muted",B=O.sample_values.length?O.sample_values.join(", "):"",q=O.unique_count!==void 0&&O.unique_count!==null?`${tj(O.unique_count)} (${tj(O.unique_percentage)}%)`:"",I=E(O.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",O.dtype]}),O.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:O.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",B]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:O.reason})]})}),a.jsx("td",{children:q}),a.jsx("td",{children:I}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${F}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>b(O.column),disabled:!O.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:O.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${O.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),f&&y(f),p&&y(p),h&&y(h),m&&y(m),_&&y(_)]}),l&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(l)]})]})},WI={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},GI={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},nj=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),XI=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:r,metadata:i,columnsParameter:l,targetColumnParameter:u,autoDetectParameter:d,autoDetectValue:f,maxCategoriesParameter:p,outputSuffixParameter:h,dropOriginalParameter:m,smoothingParameter:_,encodeMissingParameter:v,handleUnknownParameter:y,selectedColumns:b,renderParameterField:w,onToggleColumn:E,onApplyRecommended:N,formatMissingPercentage:j,previewState:C,onPendingConfigurationWarning:M,onPendingConfigurationCleared:z})=>{var O,R;x.useEffect(()=>{var B,q;if(!((q=(B=C==null?void 0:C.data)==null?void 0:B.signals)!=null&&q.full_execution)){z==null||z();return}let F=At(C.data.signals.full_execution);f&&(F=F.filter(I=>!I.label.toLowerCase().includes("columns"))),b&&b.length>0&&(F=F.filter(I=>!I.label.toLowerCase().includes("columns"))),F.length>0?M==null||M(F):z==null||z()},[(R=(O=C==null?void 0:C.data)==null?void 0:O.signals)==null?void 0:R.full_execution,M,z,f,b]);const D=x.useMemo(()=>{if(!r.length)return[];const L=new Set;return r.forEach(F=>{F.status==="recommended"&&F.selectable&&L.add(F.column)}),Array.from(L)},[r]),k=x.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),T=r.length>0,A=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>N(D),disabled:!D.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:k}),!u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((L,F)=>a.jsx("li",{children:L},`target-encoding-note-${F}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!T&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&T&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:r.map(L=>{const F=b.includes(L.column),B=WI[L.status],q=GI[L.status]??"canvas-cast__chip--muted",I=L.sample_values.length?L.sample_values.join(", "):"",U=L.unique_count!==void 0&&L.unique_count!==null?`${nj(L.unique_count)} (${nj(L.unique_percentage)}%)`:"",V=j(L.missing_percentage),H=L.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:L.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[L.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",L.dtype]}),L.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:L.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",I]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:L.reason})]})}),a.jsx("td",{children:U}),a.jsx("td",{children:V}),a.jsx("td",{children:H}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${q}`,children:B})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:F,onChange:()=>E(L.column),disabled:!L.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:L.selectable?F?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${L.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&w(u),d&&w(d),p&&w(p),h&&w(h),m&&w(m),_&&w(_),v&&w(v),y&&w(y)]}),l&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),w(l)]})]})},QI={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},ZI={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},sj=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),JI=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:r,metadata:i,columnsParameter:l,autoDetectParameter:u,autoDetectValue:d,maxCategoriesParameter:f,bucketsParameter:p,outputSuffixParameter:h,dropOriginalParameter:m,encodeMissingParameter:_,selectedColumns:v,renderParameterField:y,onToggleColumn:b,onApplyRecommended:w,formatMissingPercentage:E,previewState:N,onPendingConfigurationWarning:j,onPendingConfigurationCleared:C})=>{var A,O;x.useEffect(()=>{var F,B;if(!((B=(F=N==null?void 0:N.data)==null?void 0:F.signals)!=null&&B.full_execution)){C==null||C();return}let L=At(N.data.signals.full_execution);d&&(L=L.filter(q=>!q.label.toLowerCase().includes("columns"))),v&&v.length>0&&(L=L.filter(q=>!q.label.toLowerCase().includes("columns"))),L.length>0?j==null||j(L):C==null||C()},[(O=(A=N==null?void 0:N.data)==null?void 0:A.signals)==null?void 0:O.full_execution,j,C,d,v]);const M=x.useMemo(()=>{if(!r.length)return[];const R=new Set;return r.forEach(L=>{L.status==="recommended"&&L.selectable&&R.add(L.column)}),Array.from(R)},[r]),z=x.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),D=r.length>0,k=i.suggestedBucketDefault>0?`Default bucket suggestion: ${i.suggestedBucketDefault.toLocaleString()}.`:null,T=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>w(M),disabled:!M.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:k}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((R,L)=>a.jsx("li",{children:R},`hash-encoding-note-${L}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!D&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&D&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:r.map(R=>{const L=v.includes(R.column),F=QI[R.status],B=ZI[R.status]??"canvas-cast__chip--muted",q=R.sample_values.length?R.sample_values.join(", "):"",I=R.unique_count!==void 0&&R.unique_count!==null?`${sj(R.unique_count)} (${sj(R.unique_percentage)}%)`:"",U=E(R.missing_percentage),V=R.recommended_bucket_count?R.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:R.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[R.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",R.dtype]}),R.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:R.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",q]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:R.reason})]})}),a.jsx("td",{children:I}),a.jsx("td",{children:U}),a.jsx("td",{children:V}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${B}`,children:F})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:()=>b(R.column),disabled:!R.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:R.selectable?L?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${R.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),f&&y(f),p&&y(p),h&&y(h),m&&y(m),_&&y(_)]}),l&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(l)]})]})},e3=({columnsParameter:e,autoDetectParameter:t,autoDetectValue:n,degreeParameter:s,includeBiasParameter:r,interactionOnlyParameter:i,includeInputFeaturesParameter:l,outputPrefixParameter:u,renderParameterField:d,signal:f,previewState:p,onPendingConfigurationWarning:h,onPendingConfigurationCleared:m})=>{var z,D;x.useEffect(()=>{var A,O;if(!((O=(A=p==null?void 0:p.data)==null?void 0:A.signals)!=null&&O.full_execution)){m==null||m();return}let T=At(p.data.signals.full_execution);n&&(T=T.filter(R=>!R.label.toLowerCase().includes("columns"))),T.length>0?h==null||h(T):m==null||m()},[(D=(z=p==null?void 0:p.data)==null?void 0:z.signals)==null?void 0:D.full_execution,h,m,n]);const[_,v]=x.useState(!1),y=x.useMemo(()=>[e,t,s].filter(k=>!!k),[e,t,s]),b=x.useMemo(()=>[r,i,l,u].filter(k=>!!k),[r,i,l,u]),w=(f==null?void 0:f.generated_features)??[],E=(f==null?void 0:f.skipped_columns)??[],N=(f==null?void 0:f.filled_columns)??{},j=(f==null?void 0:f.notes)??[],C=(f==null?void 0:f.feature_count)??0,M=x.useMemo(()=>{const k=Object.entries(N);return k.length?k.map(([T,A])=>`${T} (${A.toLocaleString()} missing)`).join(", "):null},[N]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Polynomial feature settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),y.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:y.map(k=>d(k))}),b.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(em,{isOpen:_,onToggle:()=>v(!_),label:"Advanced polynomial settings",description:"Configure bias, interactions, and output naming"}),_&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:b.map(k=>d(k))})]}),E.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",E.join(", "),"."]}),M&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",M," before generating features."]}),C>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:w.map(k=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:k.column}),a.jsx("td",{children:k.expression||(k.terms.length?k.terms.join("  "):"1")}),a.jsx("td",{children:k.degree})]},`poly-feature-${k.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),j.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:j.map((k,T)=>a.jsx("li",{children:k},`polynomial-note-${T}`))})]})},rj=e=>!!e,Wc=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},t3=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},aj=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},n3=({columnsParameter:e,autoDetectParameter:t,autoDetectValue:n,targetColumnParameter:s,methodParameter:r,scoreFuncParameter:i,problemTypeParameter:l,kParameter:u,percentileParameter:d,alphaParameter:f,thresholdParameter:p,modeParameter:h,estimatorParameter:m,stepParameter:_,minFeaturesParameter:v,maxFeaturesParameter:y,dropUnselectedParameter:b,renderParameterField:w,signal:E,previewState:N,onPendingConfigurationWarning:j,onPendingConfigurationCleared:C})=>{var H,G;x.useEffect(()=>{var ee,Z;if(!((Z=(ee=N==null?void 0:N.data)==null?void 0:ee.signals)!=null&&Z.full_execution)){C==null||C();return}let J=At(N.data.signals.full_execution);n&&(J=J.filter(K=>!K.label.toLowerCase().includes("columns"))),J.length>0?j==null||j(J):C==null||C()},[(G=(H=N==null?void 0:N.data)==null?void 0:H.signals)==null?void 0:G.full_execution,j,C,n]);const[M,z]=x.useState(!1),D=x.useMemo(()=>[e,t,s,r,i,l].filter(rj),[e,t,s,r,i,l]),k=x.useMemo(()=>[u,d,f,p,h,m,_,v,y,b].filter(rj),[u,d,f,p,h,m,_,v,y,b]),T=(E==null?void 0:E.configured_columns)??[],A=(E==null?void 0:E.evaluated_columns)??[],O=(E==null?void 0:E.selected_columns)??[],R=(E==null?void 0:E.dropped_columns)??[],L=(E==null?void 0:E.feature_summaries)??[],F=(E==null?void 0:E.notes)??[],B=(E==null?void 0:E.drop_unselected)??!1,q=x.useMemo(()=>{if(!A.length&&!T.length)return null;if(A.length===T.length)return`Evaluated ${A.length.toLocaleString()} column(s).`;if(!T.length)return`Evaluated ${A.length.toLocaleString()} column(s) via auto-detect.`;const W=Math.max(A.length-T.length,0);return W>0?`Evaluated ${A.length.toLocaleString()} column(s) (${W.toLocaleString()} auto-detected).`:`Evaluated ${A.length.toLocaleString()} of ${T.length.toLocaleString()} configured column(s).`},[T,A]),I=x.useMemo(()=>{if(!E)return null;const W=[];return E.method&&W.push(`Method: ${E.method}`),E.score_func&&W.push(`Score: ${E.score_func}`),E.estimator&&W.push(`Estimator: ${E.estimator}`),E.problem_type&&E.problem_type!=="auto"&&W.push(`Problem: ${E.problem_type}`),E.target_column&&W.push(`Target: ${E.target_column}`),typeof E.k=="number"&&Number.isFinite(E.k)&&W.push(`k = ${E.k.toLocaleString()}`),typeof E.percentile=="number"&&Number.isFinite(E.percentile)&&W.push(`percentile = ${Wc(E.percentile,2)}`),typeof E.alpha=="number"&&Number.isFinite(E.alpha)&&W.push(`alpha = ${Wc(E.alpha,4)}`),E.threshold!==null&&E.threshold!==void 0&&Number.isFinite(E.threshold)&&W.push(`threshold = ${Wc(E.threshold,4)}`),E.auto_detect&&W.push("Auto-detect enabled"),W.length?W.join("  "):null},[E]),U=x.useMemo(()=>aj(O),[O]),V=x.useMemo(()=>aj(R),[R]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Feature selection settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),I&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:I}),q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:q}),D.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:D.map(W=>w(W))}),k.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(em,{isOpen:M,onToggle:()=>z(!M),label:"Advanced tuning",description:"Configure thresholds, percentiles, and estimator settings"}),M&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:k.map(W=>w(W))})]}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:B?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),O.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",O.length.toLocaleString()," column(s): ",U]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),R.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",R.length.toLocaleString()," column(s): ",V]}),L.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:L.map(W=>{const J=["canvas-cast__row"];return W.selected||J.push("canvas-cast__row--muted"),a.jsxs("tr",{className:J.join(" "),children:[a.jsx("th",{scope:"row",children:W.column}),a.jsx("td",{children:Wc(W.score)}),a.jsx("td",{children:t3(W.p_value)}),a.jsx("td",{children:W.rank??""}),a.jsx("td",{children:Wc(W.importance,4)}),a.jsx("td",{children:W.selected?"Selected":"Dropped"}),a.jsx("td",{children:W.note??""})]},`feature-selection-summary-${W.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),F.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:F.map((W,J)=>a.jsx("li",{children:W},`feature-selection-note-${J}`))})]})},s3={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},r3={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},oj=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),a3=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:r,metadata:i,columnsParameter:l,autoDetectParameter:u,autoDetectValue:d,maxCategoriesParameter:f,outputSuffixParameter:p,dropOriginalParameter:h,encodeMissingParameter:m,handleUnknownParameter:_,unknownValueParameter:v,selectedColumns:y,renderParameterField:b,onToggleColumn:w,onApplyRecommended:E,formatMissingPercentage:N,previewState:j,onPendingConfigurationWarning:C,onPendingConfigurationCleared:M})=>{var A,O;x.useEffect(()=>{var F,B;if(!((B=(F=j==null?void 0:j.data)==null?void 0:F.signals)!=null&&B.full_execution)){M==null||M();return}let L=At(j.data.signals.full_execution);d&&(L=L.filter(q=>!q.label.toLowerCase().includes("columns"))),y&&y.length>0&&(L=L.filter(q=>!q.label.toLowerCase().includes("columns"))),L.length>0?C==null||C(L):M==null||M()},[(O=(A=j==null?void 0:j.data)==null?void 0:A.signals)==null?void 0:O.full_execution,C,M,d,y]);const z=x.useMemo(()=>{if(!r.length)return[];const R=new Set;return r.forEach(L=>{L.status==="recommended"&&L.selectable&&R.add(L.column)}),Array.from(R)},[r]),D=x.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),k=r.length>0,T=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(z),disabled:!z.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:D}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((R,L)=>a.jsx("li",{children:R},`ordinal-encoding-note-${L}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!k&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&k&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:r.map(R=>{const L=y.includes(R.column),F=s3[R.status],B=r3[R.status]??"canvas-cast__chip--muted",q=R.sample_values.length?R.sample_values.join(", "):"",I=R.unique_count!==void 0&&R.unique_count!==null?`${oj(R.unique_count)} (${oj(R.unique_percentage)}%)`:"",U=N(R.missing_percentage),V=R.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:R.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[R.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",R.dtype]}),R.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:R.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",q]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:R.reason})]})}),a.jsx("td",{children:I}),a.jsx("td",{children:U}),a.jsx("td",{children:V}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${B}`,children:F})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:()=>w(R.column),disabled:!R.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:R.selectable?L?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${R.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&b(u),f&&b(f),p&&b(p),h&&b(h),m&&b(m),_&&b(_),v&&b(v)]}),l&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),b(l)]})]})},o3={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},i3={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},ij=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),l3=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:r,metadata:i,columnsParameter:l,autoDetectParameter:u,autoDetectValue:d,maxCategoriesParameter:f,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:m,prefixSeparatorParameter:_,selectedColumns:v,renderParameterField:y,onToggleColumn:b,onApplyRecommended:w,formatMissingPercentage:E,previewState:N,onPendingConfigurationWarning:j,onPendingConfigurationCleared:C})=>{var T,A;x.useEffect(()=>{var L,F;if(!((F=(L=N==null?void 0:N.data)==null?void 0:L.signals)!=null&&F.full_execution)){C==null||C();return}let R=At(N.data.signals.full_execution);d&&(R=R.filter(B=>!B.label.toLowerCase().includes("columns"))),v&&v.length>0&&(R=R.filter(B=>!B.label.toLowerCase().includes("columns"))),R.length>0?j==null||j(R):C==null||C()},[(A=(T=N==null?void 0:N.data)==null?void 0:T.signals)==null?void 0:A.full_execution,j,C,d,v]);const M=x.useMemo(()=>{if(!r.length)return[];const O=new Set;return r.forEach(R=>{R.status==="recommended"&&R.selectable&&O.add(R.column)}),Array.from(O)},[r]),z=x.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),D=r.length>0,k=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>w(M),disabled:!M.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),i.autoDetectDefault&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((O,R)=>a.jsx("li",{children:O},`dummy-note-${R}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!D&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&D&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:r.map(O=>{const R=v.includes(O.column),L=o3[O.status],F=i3[O.status]??"canvas-cast__chip--muted",B=O.sample_values.length?O.sample_values.join(", "):"",q=O.unique_count!==void 0&&O.unique_count!==null?`${ij(O.unique_count)} (${ij(O.unique_percentage)}%)`:"",I=E(O.missing_percentage),U=O.estimated_dummy_columns?O.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",O.dtype]}),O.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:O.text_category}),O.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",B]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:O.reason})]})}),a.jsx("td",{children:q}),a.jsx("td",{children:I}),a.jsx("td",{children:U}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${F}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>b(O.column),disabled:!O.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:O.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${O.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),f&&y(f),p&&y(p),h&&y(h),m&&y(m),_&&y(_)]}),l&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(l)]})]})},c3={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},u3={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},lj=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),d3=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:r,metadata:i,columnsParameter:l,autoDetectParameter:u,autoDetectValue:d,maxCategoriesParameter:f,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:m,prefixSeparatorParameter:_,selectedColumns:v,renderParameterField:y,onToggleColumn:b,onApplyRecommended:w,formatMissingPercentage:E,previewState:N,onPendingConfigurationWarning:j,onPendingConfigurationCleared:C})=>{var T,A;x.useEffect(()=>{var L,F;if(!((F=(L=N==null?void 0:N.data)==null?void 0:L.signals)!=null&&F.full_execution)){C==null||C();return}let R=At(N.data.signals.full_execution);d&&(R=R.filter(B=>!B.label.toLowerCase().includes("columns"))),v&&v.length>0&&(R=R.filter(B=>!B.label.toLowerCase().includes("columns"))),R.length>0?j==null||j(R):C==null||C()},[(A=(T=N==null?void 0:N.data)==null?void 0:T.signals)==null?void 0:A.full_execution,j,C,d,v]);const M=x.useMemo(()=>{if(!r.length)return[];const O=new Set;return r.forEach(R=>{R.status==="recommended"&&R.selectable&&O.add(R.column)}),Array.from(O)},[r]),z=x.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),D=r.length>0,k=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>w(M),disabled:!M.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((O,R)=>a.jsx("li",{children:O},`one-hot-note-${R}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!D&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&D&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:r.map(O=>{const R=v.includes(O.column),L=c3[O.status],F=u3[O.status]??"canvas-cast__chip--muted",B=O.sample_values.length?O.sample_values.join(", "):"",q=O.unique_count!==void 0&&O.unique_count!==null?`${lj(O.unique_count)} (${lj(O.unique_percentage)}%)`:"",I=E(O.missing_percentage),U=O.estimated_dummy_columns?O.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",O.dtype]}),O.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:O.text_category}),O.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",B]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:O.reason})]})}),a.jsx("td",{children:q}),a.jsx("td",{children:I}),a.jsx("td",{children:U}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${F}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>b(O.column),disabled:!O.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:O.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${O.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),f&&y(f),p&&y(p),h&&y(h),m&&y(m),_&&y(_)]}),l&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(l)]})]})},cj={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},m3=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},uj=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},h3=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(s=>s&&s.split===t)??null:null,Fp=(e,t)=>{const n=h3(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const s=cj[n.action]??n.action,r=uj(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:s}),r&&a.jsx("span",{className:"canvas-cast__muted",children:r})]})},f3=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(s=>s&&!["train","test","validation"].includes(s.split));return t.length&&t.map(s=>{const r=s.label||s.split,i=cj[s.action]??s.action,l=uj(s.rows??null);return l?`${r}: ${i} (${l})`:`${r}: ${i}`}).join("; ")||null},p3=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,g3=({signal:e,previewStatus:t,previewState:n,hasSource:s,hasReachableSource:r,onRefreshPreview:i,onPendingConfigurationWarning:l,onPendingConfigurationCleared:u})=>{const d=x.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),f=(e==null?void 0:e.total_transformers)??d.length,p=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],h=t==="loading",m=f?`Tracking ${f.toLocaleString()} transformer${f===1?"":"s"}.`:null,_=h||!s||!r;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:_,children:h?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),m&&a.jsx("p",{className:"canvas-modal__note",children:m}),!s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),s&&!r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),p.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:p.map((v,y)=>a.jsx("li",{children:v},`transformer-audit-note-${y}`))}),h&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!h&&t==="error"&&s&&r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!h&&s&&r&&!d.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!h&&d.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:d.map((v,y)=>{const b=v.storage_key??`${v.transformer_name}-${v.column_name??"all"}-${y}`,w=f3(v),E=v.source_node_label||v.source_node_id||"",N=m3(v.updated_at??v.created_at??null),j=v.column_name??"",C=p3(v);return a.jsxs(ve.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:E})})}),a.jsx("td",{children:v.transformer_name}),a.jsx("td",{children:j}),a.jsx("td",{children:C||""}),a.jsx("td",{children:Fp(v,"train")}),a.jsx("td",{children:Fp(v,"test")}),a.jsx("td",{children:Fp(v,"validation")}),a.jsx("td",{children:N})]}),w&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",w]})})})]},b)})})]})})]})},_3=({parameters:e,renderParameterField:t,previewState:n,onPendingConfigurationWarning:s,onPendingConfigurationCleared:r})=>(x.useEffect(()=>{var i,l;if((l=(i=n==null?void 0:n.data)==null?void 0:i.signals)!=null&&l.full_execution){const u=At(n.data.signals.full_execution);u.length>0?s==null||s(u):r==null||r()}},[n,s,r]),e.length===0?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Data consistency settings"})}),a.jsx("div",{className:"canvas-modal__parameter-list",children:e.map(i=>t(i))})]})),Bp=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",y3=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},v3=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},x3=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:r,config:i,targetColumnParameter:l,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:f,onPendingConfigurationWarning:p,onPendingConfigurationCleared:h})=>{var ee,Z,K,X,Q,ne;x.useEffect(()=>{var ce,ie;if(!((ie=(ce=s.data)==null?void 0:ce.signals)!=null&&ie.full_execution)){h==null||h();return}const le=At(s.data.signals.full_execution);le.length>0?p==null||p(le):h==null||h()},[(Z=(ee=s.data)==null?void 0:ee.signals)==null?void 0:Z.full_execution,p,h]);const m=s.data,_=s.status,v=Array.isArray(m==null?void 0:m.applied_steps)?m.applied_steps:[],y=Array.isArray(m==null?void 0:m.columns)?m==null?void 0:m.columns:[],b=Array.isArray((K=m==null?void 0:m.signals)==null?void 0:K.feature_target_split)?(X=m==null?void 0:m.signals)==null?void 0:X.feature_target_split:[],w=v3(b,e),E=(i==null?void 0:i.targetColumn)??"",N=(w==null?void 0:w.target_column)??E,j=(i==null?void 0:i.featureColumns)??[],C=x.useMemo(()=>Array.isArray(m==null?void 0:m.column_stats)?m==null?void 0:m.column_stats:[],[m==null?void 0:m.column_stats]),M=x.useMemo(()=>{const le=new Map;return C.forEach(ce=>{ce!=null&&ce.name&&le.set(ce.name,ce)}),le},[C]),z=x.useMemo(()=>{var le;return(le=w==null?void 0:w.feature_columns)!=null&&le.length?w.feature_columns:j.length?j:N?y.filter(ce=>ce!==N):y.slice()},[w==null?void 0:w.feature_columns,j,y,N]),D=(w==null?void 0:w.auto_included_columns)??[],k=(w==null?void 0:w.missing_feature_columns)??[],T=(w==null?void 0:w.excluded_columns)??[],A=(w==null?void 0:w.target_missing_count)??0,O=typeof(w==null?void 0:w.target_missing_percentage)=="number"?w.target_missing_percentage:null,R=(w==null?void 0:w.target_dtype)??(N?((Q=M.get(N))==null?void 0:Q.dtype)??null:null),L=typeof((ne=m==null?void 0:m.metrics)==null?void 0:ne.row_count)=="number"?m.metrics.row_count:null,F=z.length,B=D.length,q=T.length,I=k.length,U=x.useMemo(()=>y3(v),[v]),V=x.useMemo(()=>{const le=[];if(le.push({label:"Target column",value:N||"Not set"}),le.push({label:"Feature columns",value:d(F)}),L!==null&&le.push({label:"Preview rows",value:d(L)}),B&&le.push({label:"Auto-selected features",value:d(B)}),I&&le.push({label:"Configured features missing",value:d(I)}),q&&le.push({label:"Excluded columns",value:d(q)}),A){const ce=d(A),ie=O!==null?f(O):null;le.push({label:"Target missing values",value:ie?`${ce} (${ie})`:ce})}return le},[B,q,F,d,f,I,L,N,A,O]),H=x.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),G=x.useMemo(()=>!t||!n?null:_==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,_,t]),W=x.useMemo(()=>N?_==="success"&&N&&!y.includes(N)?`Target column "${N}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[y,_,N]),J=!!t&&n&&_!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:r,disabled:!J,children:_==="loading"?"Refreshing...":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:H}),s.error&&_==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),G&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:G}),W&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:W}),I>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",Bp(k),"."]}),q>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",Bp(T),"."]}),B>0&&j.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",Bp(D),"."]}),U&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:U}),V.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:V.map(le=>a.jsxs("li",{children:[le.label,": ",a.jsx("strong",{children:le.value})]},`feature-target-summary-${le.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:l&&u(l)}),_==="success"&&F===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",R?a.jsx("strong",{children:R}):a.jsx("span",{children:"Unknown"}),A?` - Missing rows flagged for review: ${d(A)}.`:""]})]})},b3=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},va=e=>`${(e*100).toFixed(1)}%`,w3=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:r,config:i,parameters:l,renderParameterField:u,formatMetricValue:d,onPendingConfigurationWarning:f,onPendingConfigurationCleared:p})=>{var O,R,L,F;x.useEffect(()=>{var q,I;if(!((I=(q=s.data)==null?void 0:q.signals)!=null&&I.full_execution)){p==null||p();return}const B=At(s.data.signals.full_execution);B.length>0?f==null||f(B):p==null||p()},[(R=(O=s.data)==null?void 0:O.signals)==null?void 0:R.full_execution,f,p]);const h=s.data,m=s.status,_=Array.isArray((L=h==null?void 0:h.signals)==null?void 0:L.train_test_split)?(F=h==null?void 0:h.signals)==null?void 0:F.train_test_split:[],v=b3(_,e),y=(i==null?void 0:i.test_size)??.2,b=(i==null?void 0:i.validation_size)??0,w=i==null?void 0:i.random_state;i==null||i.shuffle;const E=(i==null?void 0:i.stratify)??!1,N=(i==null?void 0:i.target_column)??"",j=b>0,C=x.useMemo(()=>v?{trainSize:v.train_size??0,validationSize:v.validation_size??0,testSize:v.test_size??0,totalSize:v.total_size??0,trainRatio:v.train_size&&v.total_size?v.train_size/v.total_size:0,validationRatio:v.validation_ratio??0,testRatio:v.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-y-b,validationRatio:b,testRatio:y},[v,y,b]),M=l.find(B=>B.name==="test_size"),z=l.find(B=>B.name==="validation_size"),D=l.find(B=>B.name==="random_state"),k=l.find(B=>B.name==="shuffle"),T=l.find(B=>B.name==="stratify"),A=l.find(B=>B.name==="target_column");return a.jsxs("div",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Train/Test Split Configuration"})}),a.jsxs("div",{className:"node-settings__field-group",children:[M&&u(M),z&&u(z),D&&u(D),k&&u(k),T&&u(T),E&&A&&u(A)]}),m==="success"&&v&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:va(C.trainRatio)},title:`Training: ${C.trainSize} rows (${va(C.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),j&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:va(C.validationRatio)},title:`Validation: ${C.validationSize} rows (${va(C.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:va(C.testRatio)},title:`Test: ${C.testSize} rows (${va(C.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:d(C.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(C.trainSize,0)," (",va(C.trainRatio),")"]})]}),j&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(C.validationSize,0)," (",va(C.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(C.testSize,0)," (",va(C.testRatio),")"]})]}),E&&N&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:N})]}),w!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:w})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx("span",{className:"node-settings__warning-icon",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(ga,{size:16})}),"Connect this node to a data source to configure the split."]}),m==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),m==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},N3={classification:"Classification",regression:"Regression"},j3=e=>e==="numeric"||e==="integer",S3=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},Hp=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,E3=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},C3=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:s,config:r,targetColumnParameter:i,problemTypeParameter:l,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:f,schemaColumns:p})=>{var ee;const h=n.data,m=n.status,_=Array.isArray(h==null?void 0:h.applied_steps)?h.applied_steps:[],v=Array.isArray(h==null?void 0:h.column_stats)?h.column_stats:[],y=(h==null?void 0:h.metrics)??null,b=x.useMemo(()=>Array.isArray(h==null?void 0:h.columns)?h.columns.filter(Z=>typeof Z=="string"&&Z.trim().length>0):[],[h==null?void 0:h.columns]),w=x.useMemo(()=>{var Z;return p.length?p:Array.isArray((Z=h==null?void 0:h.schema)==null?void 0:Z.columns)?h.schema.columns:b.length>0?b.map(K=>({name:K,pandas_dtype:null,logical_family:"unknown",nullable:!0})):[]},[(ee=h==null?void 0:h.schema)==null?void 0:ee.columns,b,p]),E=x.useMemo(()=>{const Z=new Map;return w.forEach(K=>{K!=null&&K.name&&Z.set(K.name,K)}),Z},[w]),N=(r==null?void 0:r.targetColumn)??"",j=(r==null?void 0:r.problemType)??"classification",C=N?v.find(Z=>(Z==null?void 0:Z.name)===N)??null:null,z=!!(N?E.get(N)??null:null),D=x.useMemo(()=>{const Z=new Set;return v.forEach(K=>{K!=null&&K.name&&K.name!==N&&Z.add(K.name)}),w.forEach(K=>{K!=null&&K.name&&K.name!==N&&Z.add(K.name)}),Array.from(Z).sort()},[v,w,N]),k=x.useMemo(()=>D.filter(Z=>{const K=E.get(Z);if(K&&j3(K.logical_family))return!0;const X=v.find(Q=>Q.name===Z);return S3((X==null?void 0:X.dtype)??null)}),[v,D,E]),T=x.useMemo(()=>new Set(k),[k]),A=x.useMemo(()=>D.filter(Z=>!T.has(Z)),[D,T]),O=x.useMemo(()=>v.filter(Z=>(Z==null?void 0:Z.name)&&Z.name!==N&&(Z.missing_count??0)>0).map(Z=>Z.name),[v,N]),R=typeof(y==null?void 0:y.row_count)=="number"?y.row_count:null,L=typeof(C==null?void 0:C.distinct_count)=="number"&&Number.isFinite(C.distinct_count)?C.distinct_count:null,F=typeof(C==null?void 0:C.missing_count)=="number"?C.missing_count:0,B=typeof(C==null?void 0:C.missing_percentage)=="number"?C.missing_percentage:null,q=x.useMemo(()=>{const Z=[];return N?m!=="success"?Z:!C&&!z&&!D.length?(Z.push(`Target column "${N}" is not present in the preview output, and no feature columns were found.`),Z):(D.length||Z.push("Add at least one feature column in addition to the target before training."),C&&F>0&&Z.push(`Target column includes ${F} missing value${F===1?"":"s"}.`),j==="classification"&&C&&(L??0)<2&&Z.push("Classification tasks require at least two distinct target classes."),j==="regression"&&k.length===0&&Z.push("Regression tasks need at least one numeric feature column."),O.length>0&&Z.push(`Feature columns with missing values: ${Hp(O)}.`),R!==null&&R===0&&Z.push("Preview returned zero rows after upstream transformations."),Z):(Z.push("Set a target column to evaluate downstream modeling constraints."),Z)},[O,D.length,F,k.length,R,m,j,N,L,C,z]),I=x.useMemo(()=>N3[j],[j]),U=x.useMemo(()=>{const Z=[{label:"Problem type",value:I},{label:"Target column",value:N||"Not set"}];if(m==="success"){if(L!==null&&Z.push({label:"Target distinct values",value:d(L)}),C){const K=d(F),X=B!==null?f(B):null;Z.push({label:"Target missing values",value:X?`${K} (${X})`:K})}O.length>0&&Z.push({label:"Features with missing values",value:d(O.length)})}return Z},[I,O.length,d,f,F,m,N,L,B,C]),V=x.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),H=x.useMemo(()=>!e||!t?null:m==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,m,e]),G=x.useMemo(()=>E3(_),[_]),W=!!e&&t&&m!=="loading",J=x.useMemo(()=>!N||m!=="success"||q.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[m,q.length,N]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:!W,children:m==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),V&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:V}),n.error&&m==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:H}),q.map((Z,K)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Z},`train-model-issue-${K}`)),J&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:J}),G&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:G}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[i&&u(i),l&&u(l)]}),U.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:U.map(Z=>a.jsxs("li",{children:[Z.label,": ",a.jsx("strong",{children:Z.value})]},`train-model-summary-${Z.label}`))}),m==="success"&&O.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",Hp(O),"."]}),m==="success"&&j==="regression"&&A.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",Hp(A),". Consider encoding or casting them before training regression models."]})]})},dj=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?Js(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},k3=e=>e||"Unknown",M3=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},Xn=e=>{const t=M3(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const s=Math.round(n/60);if(s===1)return"1 hour ago";if(s<24)return`${s} hours ago`;const r=Math.round(s/24);return r===1?"1 day ago":`${r} days ago`},mj=e=>typeof e!="number"||!Number.isFinite(e)?"":Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3),A3=({presets:e,isOpen:t,onClose:n,onApply:s,activePresetId:r,fieldMetadata:i})=>{const[l,u]=x.useState(null);x.useEffect(()=>{var h;if(!t){u(null);return}l&&e.some(m=>m.id===l)||u(((h=e[0])==null?void 0:h.id)??null)},[t,e,l]),x.useEffect(()=>{if(!t)return;const h=m=>{m.key==="Escape"&&n()};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,n]);const d=x.useMemo(()=>l?e.find(h=>h.id===l)??e[0]??null:e[0]??null,[e,l]),f=x.useMemo(()=>!r||!d?!1:r===d.id,[r,d]),p=x.useMemo(()=>{var b,w;if(!t||!e.length)return null;const h=((b=d==null?void 0:d.modelType)==null?void 0:b.toLowerCase())==="logistic_regression"?(w=d==null?void 0:d.params)==null?void 0:w.solver:null,m=typeof h=="string"?h.trim().toLowerCase():null,_=m&&(m==="sag"||m==="saga")?"SAG/SAGA solvers require scaled features for stability.":null,v=d?Object.entries(d.params??{}).sort(([E],[N])=>E.localeCompare(N)).map(([E,N])=>{const j=i==null?void 0:i[E],C=A=>{var O;return(O=j==null?void 0:j.options)!=null&&O.length?j.options.find(R=>{const L=R.value;return A==null?L===null||typeof L=="string"&&L.trim().toLowerCase()==="none":typeof A=="string"&&typeof L=="string"?L===A?!0:L.trim().toLowerCase()===A.trim().toLowerCase():String(L)===String(A)})??null:null},M=A=>{if(A===null)return j!=null&&j.nullable?"None":"";if(A===void 0)return"";if(typeof A=="boolean")return A?"true":"false";if(typeof A=="number")return Number.isFinite(A)?A.toString():String(A);if(A&&typeof A=="object")try{return JSON.stringify(A)}catch{return"[object]"}return String(A??"")},z=A=>{var F;if(!A)return null;const O=A.value,R=(F=A.label)==null?void 0:F.trim(),L=M(O);return R&&L&&R!==L?`${R} (${L})`:R||L},D=()=>{if(j&&j.default!==void 0){const A=k(j.default,!1);if(A.text)return{text:A.text,note:"Using estimator default"}}return{text:"",note:"Using estimator default"}},k=(A,O=!0)=>{const R=C(A);return R?{text:z(R)??"",note:null}:Array.isArray(A)?A.length===0?O?D():{text:"",note:null}:{text:A.map(F=>k(F,!1)).map(F=>F.text).filter(Boolean).join(", "),note:null}:A===void 0||typeof A=="string"&&A.trim()===""?O?D():{text:"",note:null}:A===null?j!=null&&j.nullable?{text:"None",note:null}:O?D():{text:"",note:null}:{text:M(A),note:null}},T=k(N);return{key:E,label:(j==null?void 0:j.label)??E,description:(j==null?void 0:j.description)??null,value:T.text,note:T.note}}):[],y=d!=null&&d.finishedAt?Xn(d.finishedAt):null;return a.jsxs("div",{className:"canvas-modal best-param-modal",role:"dialog","aria-modal":"true",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:n}),a.jsxs("div",{className:"canvas-modal__panel best-param-modal__panel",role:"document",children:[a.jsxs("header",{className:"best-param-modal__header",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"best-param-modal__title",children:"Tuned Hyperparameter Presets"}),a.jsx("p",{className:"best-param-modal__subtitle",children:"Review hyperparameter sets discovered by recent tuning runs and apply them to the current model."})]}),a.jsx("button",{type:"button",className:"best-param-modal__close",onClick:n,children:"Close"})]}),a.jsxs("div",{className:"best-param-modal__layout",children:[a.jsx("aside",{className:"best-param-modal__list","aria-label":"Tuned presets",children:e.map(E=>{const N=E.id===(d==null?void 0:d.id),j=E.finishedAt?Xn(E.finishedAt):null;return a.jsxs("button",{type:"button",className:`best-param-modal__list-button${N?" best-param-modal__list-button--active":""}`,onClick:()=>u(E.id),children:[a.jsx("span",{className:"best-param-modal__list-title",children:E.label}),a.jsxs("span",{className:"best-param-modal__list-meta",children:[E.runNumber?`Run ${E.runNumber}`:"Tuning run",j?`  ${j}`:""]}),E.scoring&&a.jsxs("span",{className:"best-param-modal__list-score",children:[E.scoring,": ",mj(E.score)]}),E.targetColumn&&a.jsxs("span",{className:"best-param-modal__list-target",children:["Target: ",E.targetColumn]})]},E.id)})}),a.jsx("section",{className:"best-param-modal__details",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"best-param-modal__summary",children:[a.jsxs("div",{className:"best-param-modal__summary-main",children:[a.jsx("h4",{children:d.label}),a.jsxs("p",{children:[d.runNumber?`Run ${d.runNumber}`:"Tuning run",y?`  ${y}`:"",d.searchStrategy?`  ${d.searchStrategy}`:""]}),a.jsxs("p",{children:["Model: ",a.jsx("strong",{children:d.modelType}),d.targetColumn?a.jsxs(a.Fragment,{children:[" "," Target: ",a.jsx("strong",{children:d.targetColumn})]}):null,d.scoring?a.jsxs(a.Fragment,{children:[" "," ",d.scoring,": ",a.jsx("strong",{children:mj(d.score)})]}):null]})]}),a.jsx("div",{className:"best-param-modal__summary-actions",children:a.jsx("button",{type:"button",className:"best-param-modal__apply",onClick:()=>s(d),disabled:!v.length,children:f?"Already applied":"Apply preset"})})]}),d.description&&a.jsx("p",{className:"best-param-modal__note",children:d.description}),_&&a.jsxs("div",{className:"best-param-modal__notice best-param-modal__notice--warning",style:{padding:"0.4rem 0.75rem",fontSize:"0.8rem",margin:"0.5rem 0"},children:[a.jsx("strong",{children:"Tip:"})," ",_]}),a.jsx("div",{className:"best-param-modal__param-grid",role:"table",children:v.length?v.map(E=>a.jsxs("div",{className:"best-param-modal__param-row",role:"row",children:[a.jsxs("div",{className:"best-param-modal__param-name",role:"cell",children:[a.jsxs("div",{className:"best-param-modal__param-label",children:[E.label,E.label!==E.key&&a.jsx("span",{className:"best-param-modal__param-key",children:a.jsx("code",{children:E.key})})]}),E.description&&a.jsx("div",{className:"best-param-modal__param-description",children:E.description})]}),a.jsxs("div",{className:"best-param-modal__param-value",role:"cell",children:[a.jsx("code",{children:E.value}),E.note&&a.jsx("span",{className:"best-param-modal__param-note",children:E.note})]})]},E.key)):a.jsx("p",{className:"best-param-modal__empty",children:"No hyperparameters available for this preset."})})]}):a.jsx("p",{className:"best-param-modal__empty",children:"Select a tuning run to inspect its hyperparameters."})})]})]})]})},[r,f,i,t,s,n,e,d]);return p?iy.createPortal(p,document.body):null},O3=new Set(["scale_numeric_features","scaling","scale_numeric"]),T3=[/convergencewarning/i,/failed to converge/i,/did not converge/i,/optimizer failed to converge/i,/increase the number of iterations/i,/scale your features/i,/standardize your features/i,/consider scaling your (data|features)/i,/feature scaling is (recommended|required)/i],$3=["forest","tree","boost","xgboost","lightgbm","catboost","gradient","histgradient","bagging"],L3=["bayes","naive_bayes","gaussian_nb"],z3=e=>{const t=e.trim().toLowerCase();return t?$3.some(s=>t.includes(s))?{required:!1,reason:null}:L3.some(s=>t.includes(s))?{required:!1,reason:null}:t.includes("logistic")?{required:!0,reason:"logistic"}:t.includes("svm")||t.includes("svc")||t.includes("svr")?{required:!0,reason:"svm"}:t.includes("knn")||t.includes("nearest")?{required:!0,reason:"knn"}:t.includes("sgd")||t.includes("perceptron")?{required:!0,reason:"sgd"}:["linear","ridge","lasso","elastic","regression"].some(s=>t.includes(s))?{required:!0,reason:"linear"}:{required:!1,reason:null}:{required:!1,reason:null}},R3=(e,t)=>{const n=new Set;if(!e||!t)return n;const s=Array.isArray(e.edges)?e.edges:[],r=[t];for(;r.length;){const i=r.pop();if(i)for(const l of s){if(!l)continue;const u=typeof l.source=="string"?l.source.trim():"",d=typeof l.target=="string"?l.target.trim():"";!u||!d||d===i&&!n.has(u)&&(n.add(u),r.push(u))}}return n},D3=(e,t)=>{if(!e||!t)return!1;const n=R3(e,t);return n.size?(Array.isArray(e.nodes)?e.nodes:[]).some(r=>{var l;if(!r||typeof r.id!="string"||!n.has(r.id))return!1;const i=String(((l=r==null?void 0:r.data)==null?void 0:l.catalogType)??(r==null?void 0:r.type)??"").toLowerCase();return i?O3.has(i)?!0:i.includes("scale")&&i.includes("numeric"):!1}):!1},P3=(e,t)=>{const n=t.find(s=>(s==null?void 0:s.value)===e);return n!=null&&n.label?n.label:e.replace(/_/g," ").replace(/\s+/g," ").trim()},Up=(e,t=new Set,n=0)=>{if(e==null)return[];if(typeof e=="string")return[e];if(typeof e=="number"||typeof e=="boolean")return[];if(n>3)return[];if(Array.isArray(e)){if(!e.length)return[];const s=32,r=[];for(let i=0;i<e.length&&i<s;i+=1)r.push(...Up(e[i],t,n+1));return r}if(typeof e=="object"){if(t.has(e))return[];t.add(e);const s=Object.values(e);if(!s.length)return[];const r=32,i=[];for(let l=0;l<s.length&&l<r;l+=1)i.push(...Up(s[l],t,n+1));return i}return[]},bl=e=>{if(!e)return!1;const t=Up(e);return t.length?t.some(n=>T3.some(s=>s.test(n))):!1},Gc=e=>{var n,s,r,i,l,u,d,f,p,h,m,_,v,y;if(!e)return!1;const t=[e.error_message,e.warning_message,e.message,e.details,e.notes,e.status_reason,e.status_message,e.error,(n=e.metadata)==null?void 0:n.warnings,(s=e.metadata)==null?void 0:s.warning,(r=e.metadata)==null?void 0:r.notes,(i=e.metadata)==null?void 0:i.messages,(l=e.metadata)==null?void 0:l.message,(u=e.metadata)==null?void 0:u.errors,(d=e.metrics)==null?void 0:d.warnings,(f=e.metrics)==null?void 0:f.warning,(p=e.metrics)==null?void 0:p.messages,(h=e.metrics)==null?void 0:h.message,(m=e.job_metadata)==null?void 0:m.warnings,(_=e.job_metadata)==null?void 0:_.warning,(v=e.job_metadata)==null?void 0:v.messages,(y=e.job_metadata)==null?void 0:y.notes];for(const b of t)if(bl(b))return!0;return!!(bl(e.metadata)||bl(e.metrics))},I3=(e,t,n)=>{const s=t||"This model";switch(e){case"logistic":return{headline:`${s} needs scaled numeric features`,summary:'Standardize numeric inputs before launching jobs to keep the logistic solver stable and avoid repeated "scale your features" warnings.',details:["Insert a Scale numeric features step before this node or reuse an upstream scaler.","StandardScaler works for most datasets; RobustScaler can help when outliers dominate.","Once scaling is in place, re-run tuning or training so the solver converges cleanly."]};case"svm":return{headline:`${s} is sensitive to feature scale`,summary:"Support Vector Machines depend on distance calculations. Keep numeric features on comparable scales to preserve margin geometry.",details:["Add the Scale numeric features step upstream of this node.","Try StandardScaler or MinMaxScaler depending on the kernel and expected ranges.","Retrain after scaling to refresh support vectors and hyperparameters."]};case"knn":return{headline:`${s} uses distance-based comparisons`,summary:"k-NN models weigh distances directly, so unscaled columns dominate neighbors. Scale numeric fields to keep votes balanced.",details:["Drop in a Scale numeric features step before launching jobs.","MinMaxScaler keeps features in [0, 1]; StandardScaler works when values are roughly normal.","Requeue jobs after scaling so neighbor search reflects the new feature space."]};case"sgd":return{headline:`${s} benefits from normalized inputs`,summary:"Stochastic gradient models converge faster and produce steadier coefficients when numeric inputs share a common scale.",details:["Insert a Scale numeric features node prior to this step.","StandardScaler plus optional RobustScaler for heavy-tailed features keeps gradients stable.","Re-run jobs after scaling to avoid exploding or vanishing updates."]};default:return{headline:`${s} prefers standardized numeric features`,summary:n==="regression"?"Linear regression families rely on comparable feature magnitudes. Scaling keeps coefficients well-conditioned and improves R stability.":"Linear classification models respond better when numeric inputs share a common scale. Scaling prevents any single column from dominating the loss.",details:["Add the Scale numeric features step ahead of this node or reuse an existing scaler.","StandardScaler is a safe default; RobustScaler helps when outliers skew distributions.","Re-launch jobs once scaling is applied so coefficients represent the standardized space."]}}},hj=({graph:e,nodeId:t,modelType:n,problemType:s,modelTypeOptions:r,enabled:i})=>x.useMemo(()=>{if(!i||!n||!n.trim()||D3(e,t))return null;const l=n.trim().toLowerCase(),{required:u,reason:d}=z3(l);if(!u||!d)return null;const f=P3(n,r);return I3(d,f,s)},[i,e,n,r,t,s]),F3={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},wl={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},qp=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([s,r])=>{t.has(s)&&(n[s]=r)}),n},fj=(e,t)=>{if(e===t||typeof e=="number"&&typeof t=="number"&&Number.isNaN(e)&&Number.isNaN(t))return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length!==t.length?!1:e.every((n,s)=>fj(n,t[s]));if(e&&t&&typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1},B3=(e,t,n)=>{if(!e)return{};const s={};return Object.entries(e).forEach(([r,i])=>{if(!t.has(r)||i===""||i===null||i===void 0)return;const l=n==null?void 0:n[r];let u=i;if(l){if(typeof u=="string"){const d=u.trim();if(!d)return;l.type==="select"&&(u=d)}if(l.name==="multi_class"&&typeof u=="string"){const d=u.trim().toLowerCase();if(d==="auto")return;(d==="ovr"||d==="multinomial")&&(u=d)}if(l.default!==void 0){if(typeof l.default=="string"&&typeof u=="string"){const d=l.default.trim(),f=u.trim();if(d===f)return}else if(fj(l.default,u))return}}s[r]=u}),s},pj=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Xc=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},H3=e=>{if(!e)return wl.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return wl.regression;if(t.includes("classifier")||t.includes("classification"))return wl.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?wl.regression:n==="classification"?wl.classification:wl.fallback},U3=e=>{var i,l,u;if(!e)return null;const t=[],n=(l=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:l.mean;pj(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const s=[e.test,e.validation,e.train];for(const d of s)pj(d)&&t.push({dataset:d,labelPrefix:""});const r=H3(e);for(const d of t)for(const f of r){const p=d.dataset[f];if(typeof p=="number"&&Number.isFinite(p))return{label:d.labelPrefix?`${d.labelPrefix}${f}`:f,value:p}}for(const d of t)for(const[f,p]of Object.entries(d.dataset))if(typeof p=="number"&&Number.isFinite(p))return{label:d.labelPrefix?`${d.labelPrefix}${f}`:f,value:p};return null},Vp=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",q3=({jobs:e})=>{const[t,n]=x.useState({key:"created_at",direction:"desc"}),s=x.useMemo(()=>e.map(f=>{var p,h;return f.problem_type||((p=f.metadata)==null?void 0:p.problem_type)||((h=f.metadata)==null?void 0:h.resolved_problem_type)}).filter(Boolean).some(f=>String(f).toLowerCase()==="regression")?"regression":"classification",[e]),r=x.useMemo(()=>{let d=[];s==="regression"?d=[{key:"r2",label:"R"},{key:"rmse",label:"RMSE"},{key:"mae",label:"MAE"},{key:"mse",label:"MSE"}]:d=[{key:"accuracy",label:"Accuracy"},{key:"f1",label:"F1"},{key:"f1_weighted",label:"F1 (Weighted)"},{key:"precision",label:"Precision"},{key:"precision_weighted",label:"Precision (Weighted)"},{key:"recall",label:"Recall"},{key:"recall_weighted",label:"Recall (Weighted)"},{key:"roc_auc",label:"AUC"},{key:"roc_auc_weighted",label:"AUC (Weighted)"}];const f=d.filter(_=>e.some(v=>{const y=v.metrics||{};return(w=>{var N,j,C;if(y[w]!==void 0)return y[w];const E=[y.test,y.validation,y.train];for(const M of E)if(M&&typeof M=="object"&&M[w]!==void 0)return M[w];if(((C=(j=(N=y.cross_validation)==null?void 0:N.metrics)==null?void 0:j.mean)==null?void 0:C[w])!==void 0)return y.cross_validation.metrics.mean[w]})(_.key)!==void 0})),p=f.some(_=>_.key==="f1"),h=f.some(_=>_.key==="precision"),m=f.some(_=>_.key==="recall");return f.filter(_=>!(_.key==="f1_weighted"&&p&&!e.some(y=>{var N,j;const b=y.metrics||{},w=b.f1_weighted!==void 0||((N=b.test)==null?void 0:N.f1_weighted)!==void 0,E=b.f1!==void 0||((j=b.test)==null?void 0:j.f1)!==void 0;return w&&!E})||_.key==="precision_weighted"&&h&&!e.some(y=>{var N,j;const b=y.metrics||{},w=b.precision_weighted!==void 0||((N=b.test)==null?void 0:N.precision_weighted)!==void 0,E=b.precision!==void 0||((j=b.test)==null?void 0:j.precision)!==void 0;return w&&!E})||_.key==="recall_weighted"&&m&&!e.some(y=>{var N,j;const b=y.metrics||{},w=b.recall_weighted!==void 0||((N=b.test)==null?void 0:N.recall_weighted)!==void 0,E=b.recall!==void 0||((j=b.test)==null?void 0:j.recall)!==void 0;return w&&!E})))},[s,e]),i=x.useMemo(()=>{const d=[...e];return d.sort((f,p)=>{let h,m;if(t.key==="created_at")h=f.created_at?new Date(f.created_at).getTime():0,m=p.created_at?new Date(p.created_at).getTime():0;else if(t.key==="model_type")h=f.model_type||"",m=p.model_type||"";else if(t.key==="status")h=f.status||"",m=p.status||"";else{const _=f.metrics||{},v=p.metrics||{},y=(b,w)=>{if(b[w]!==void 0)return b[w];if(w==="f1_weighted")return b.f1;if(w==="precision_weighted")return b.precision;if(w==="recall_weighted")return b.recall};h=y(_,t.key)??-1/0,m=y(v,t.key)??-1/0}return h<m?t.direction==="asc"?-1:1:h>m?t.direction==="asc"?1:-1:0}),d},[e,t]),l=d=>{n(f=>({key:d,direction:f.key===d&&f.direction==="desc"?"asc":"desc"}))},u=d=>t.key!==d?a.jsx("span",{style:{opacity:.3},children:""}):t.direction==="asc"?"":"";return e.length===0?a.jsx("div",{style:{padding:"2rem",textAlign:"center",color:"rgba(148, 163, 184, 0.8)"},children:"No training jobs available for comparison."}):a.jsx("div",{className:"canvas-table-container",style:{overflowX:"auto"},children:a.jsxs("table",{className:"canvas-table",style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsxs("th",{onClick:()=>l("model_type"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem",color:"#e2e8f0",fontWeight:600},children:["Model ",u("model_type")]}),a.jsx("th",{style:{textAlign:"left",padding:"0.75rem",color:"#e2e8f0",fontWeight:600},children:"Target"}),a.jsxs("th",{onClick:()=>l("status"),style:{cursor:"pointer",textAlign:"left",padding:"0.75rem",color:"#e2e8f0",fontWeight:600},children:["Status ",u("status")]}),r.map(d=>a.jsxs("th",{onClick:()=>l(d.key),style:{cursor:"pointer",textAlign:"right",padding:"0.75rem",color:"#e2e8f0",fontWeight:600},children:[d.label," ",u(d.key)]},d.key)),a.jsxs("th",{onClick:()=>l("created_at"),style:{cursor:"pointer",textAlign:"right",padding:"0.75rem",color:"#e2e8f0",fontWeight:600},children:["Created ",u("created_at")]})]})}),a.jsx("tbody",{children:i.map(d=>{var m;const f=d.metrics||{},p=d.status==="succeeded",h=_=>{var y,b,w;if(f[_]!==void 0)return f[_];const v=[f.test,f.validation,f.train];for(const E of v)if(E&&typeof E=="object"&&E[_]!==void 0)return E[_];if(((w=(b=(y=f.cross_validation)==null?void 0:y.metrics)==null?void 0:b.mean)==null?void 0:w[_])!==void 0)return f.cross_validation.metrics.mean[_]};return a.jsxs("tr",{style:{borderTop:"1px solid rgba(148, 163, 184, 0.1)"},children:[a.jsxs("td",{style:{padding:"0.75rem"},children:[a.jsx("div",{style:{fontWeight:500,color:"#e2e8f0"},children:d.model_type.replace(/_/g," ")}),a.jsxs("div",{style:{fontSize:"0.75rem",color:"rgba(148, 163, 184, 0.7)"},children:["ID: ",d.id.slice(0,8)]})]}),a.jsx("td",{style:{padding:"0.75rem",color:"#e2e8f0"},children:((m=d.metadata)==null?void 0:m.target_column)||""}),a.jsx("td",{style:{padding:"0.75rem"},children:a.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,background:d.status==="succeeded"?"rgba(34, 197, 94, 0.15)":d.status==="failed"?"rgba(239, 68, 68, 0.15)":"rgba(59, 130, 246, 0.15)",color:d.status==="succeeded"?"#4ade80":d.status==="failed"?"#f87171":"#60a5fa"},children:d.status})}),r.map(_=>{let v=h(_.key);v===void 0&&(_.key==="f1_weighted"?v=h("f1"):_.key==="precision_weighted"?v=h("precision"):_.key==="recall_weighted"?v=h("recall"):_.key==="roc_auc"&&(v=h("roc_auc_weighted")));const y=v!=null;return a.jsx("td",{style:{padding:"0.75rem",textAlign:"right"},children:p&&y?a.jsx("span",{style:{fontFamily:"monospace",color:"#e2e8f0"},children:Vp(v)}):a.jsx("span",{style:{color:"rgba(148, 163, 184, 0.3)"},children:""})},_.key)}),a.jsx("td",{style:{padding:"0.75rem",textAlign:"right",color:"rgba(148, 163, 184, 0.8)"},children:d.created_at?Xn(d.created_at):""})]},d.id)})})]})})},V3=({jobs:e,isLoading:t,hiddenJobCount:n,onRefresh:s,pipelineId:r,createJobError:i,jobsError:l,tuningJobsError:u,lastCreatedJob:d,lastCreatedJobCount:f,isTuningJobsLoading:p})=>{const[h,m]=x.useState("list"),_=Ka(),v=Wi({mutationFn:Lw,onSuccess:()=>{_.invalidateQueries({queryKey:["training-jobs"]})},onError:w=>{console.error("Failed to cancel job:",w),alert(w instanceof Error?w.message:"Failed to cancel job")}}),y=w=>{confirm("Are you sure you want to cancel this training job?")&&v.mutate(w)},b=w=>{var F,B,q,I;const E=U3(w.metrics??null),N=w.updated_at?Xn(w.updated_at):null,j=w.updated_at||w.created_at,C=j?N??new Date(j).toLocaleString():null,M=F3[w.status]??w.status,z=(w.problem_type||((F=w.metadata)==null?void 0:F.resolved_problem_type)||((B=w.metadata)==null?void 0:B.problem_type)||"").toString(),D=((q=w.metadata)==null?void 0:q.cross_validation)??null,k=((I=w.metrics)==null?void 0:I.cross_validation)??null,T=typeof w.error_message=="string"?w.error_message.trim():"",A=[];if(A.push(`Model ${w.model_type}`),z&&A.push(z.charAt(0).toUpperCase()+z.slice(1)),D!=null&&D.enabled){const U=String(D.strategy??"auto"),V=U==="stratified_kfold"?"Stratified KFold":U==="kfold"?"KFold":"Auto CV",H=typeof D.folds=="number"?`${D.folds} folds`:"CV enabled";if(A.push(`${V} (${H})`),(k==null?void 0:k.status)==="skipped"){const G=String((k==null?void 0:k.reason)??"unknown reason").replace(/_/g," ");A.push(`CV skipped (${G})`)}}else if((k==null?void 0:k.status)==="skipped"){const U=String((k==null?void 0:k.reason)??"unknown reason").replace(/_/g," ");A.push(`CV skipped (${U})`)}if(E&&A.push(`${E.label}: ${Vp(E.value)}`),w.status==="failed"&&T){const U=T.replace(/\s+/g," ");A.push(`Error: ${U}`)}C&&A.push(`Updated ${C}`);const O=w.status==="running"||w.status==="queued",R=w.progress??0,L=w.current_step;return a.jsxs("li",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[a.jsxs("span",{children:[a.jsxs("strong",{children:["v",w.version]}),"  ",M]}),O&&a.jsx("button",{type:"button",onClick:U=>{U.stopPropagation(),y(w.id)},disabled:v.isPending,title:"Cancel this job (may not be immediate on Windows)",style:{padding:"2px 8px",fontSize:"0.75rem",fontWeight:500,color:"#b91c1c",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:"4px",cursor:"pointer"},children:"Cancel"})]}),O&&a.jsxs("span",{style:{fontSize:"0.85em",color:"#666"},children:[R,"% ",L?` ${L}`:""]})]}),O&&a.jsx("div",{style:{width:"100%",height:"4px",backgroundColor:"#eee",borderRadius:"2px",overflow:"hidden"},children:a.jsx("div",{style:{width:`${R}%`,height:"100%",background:"linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%)",transition:"width 0.3s ease"}})}),a.jsx("div",{style:{fontSize:"0.9em",color:"#666"},children:A.length>0?A.join("  "):""})]},w.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{style:{display:"flex",gap:"0.25rem",marginRight:"0.75rem"},children:[a.jsx("button",{type:"button",className:`btn ${h==="list"?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>m("list"),style:{padding:"0.25rem 0.75rem",fontSize:"0.8rem"},children:"List"}),a.jsx("button",{type:"button",className:`btn ${h==="compare"?"btn-secondary":"btn-outline-secondary"}`,onClick:()=>m("compare"),style:{padding:"0.25rem 0.75rem",fontSize:"0.8rem"},children:"Compare"})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:t,children:t?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),r&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:r})]}),i instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i.message}),l&&!(i instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l.message||"Unable to load training jobs."}),u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u.message||"Unable to load tuning jobs."}),d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:f>1?a.jsxs("span",{children:["Queued ",f," training jobs. Latest job ",d.id," (version ",d.version,")."]}):a.jsxs("span",{children:["Training job ",d.id," queued (version ",d.version,")."]})}),p&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),n>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:n===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${n} training jobs use a different problem type. Switch the problem type to view them.`}),!t&&e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),e.length>0&&(h==="list"?a.jsx("ul",{className:"canvas-modal__note-list",children:e.map(b)}):a.jsx(q3,{jobs:e}))]})},K3=({modelType:e,showAdvanced:t,hyperparamFields:n,hyperparamValues:s,onHyperparamChange:r,onToggleAdvanced:i,isLoading:l,error:u,primaryPreset:d,latestTuningJob:f,applyStatus:p,onApplyBestParams:h,onBrowsePresets:m,applyButtonDisabled:_,browsePresetsDisabled:v,latestTuningRunNumber:y,latestTuningRelative:b,primaryPresetRelative:w,primaryPresetScoreLabel:E,applyStatusColor:N,renderParameterField:j,hyperparametersParameter:C})=>{const M=z=>{var T;const D=s[z.name]??z.default,k=`hyperparam-${z.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:k,className:"canvas-modal__parameter-label",children:[z.label,z.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:z.description})]}),z.type==="number"&&a.jsx("input",{id:k,type:"number",className:"canvas-modal__parameter-input",value:D??"",onChange:A=>{const O=A.target.value;if(O===""&&z.nullable)r(z.name,null);else{const R=parseFloat(O);isNaN(R)||r(z.name,R)}},min:z.min,max:z.max,step:z.step,placeholder:z.nullable?"Empty = default":""}),z.type==="select"&&a.jsx("select",{id:k,className:"canvas-modal__parameter-select",value:D??"",onChange:A=>r(z.name,A.target.value),children:(T=z.options)==null?void 0:T.map(A=>a.jsx("option",{value:String(A.value),children:A.label},String(A.value)))}),z.type==="boolean"&&a.jsx("input",{id:k,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!D,onChange:A=>r(z.name,A.target.checked)}),z.type==="text"&&a.jsx("input",{id:k,type:"text",className:"canvas-modal__parameter-input",value:D??"",onChange:A=>r(z.name,A.target.value),placeholder:z.nullable?"Empty = default":""})]},z.name)};return!e&&C?a.jsx(a.Fragment,{children:j(C)}):!e||n.length===0?null:a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:t?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),(d||f)&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:d?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:d.modelType}),d.runNumber?` (run ${d.runNumber})`:"",w?`  ${w}`:"",d.targetColumn?`  Target: ${d.targetColumn}`:"",E?`  ${E}`:""]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",y||"N/A",b?`  ${b}`:"",f!=null&&f.model_type&&f.model_type!==e?` targeted ${f.model_type}.`:" did not produce reusable parameters for this configuration yet."]})}),p&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:N},children:p.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",onClick:h,disabled:_,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:_?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:_?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:_?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:_?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:_?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply tuned params"}),a.jsx("button",{type:"button",onClick:m,disabled:v,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:v?"rgba(148, 163, 184, 0.55)":"rgba(168, 85, 247, 0.95)",background:v?"rgba(15, 23, 42, 0.35)":"rgba(76, 29, 149, 0.18)",border:v?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(168, 85, 247, 0.45)",borderRadius:"4px",cursor:v?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"150px"},children:"Browse tuned params"})]})]})}),l&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),u&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",u.message]}),n.length>0&&a.jsxs(a.Fragment,{children:[a.jsx(em,{isOpen:t,onToggle:i,label:"Advanced Hyperparameters",description:e?`Configure ${e.replace(/_/g," ")} hyperparameters. Leave empty to use recommended defaults.`:"Configure model hyperparameters."}),t&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"0.5rem"},children:n.map(M)})]})]})},Y3=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:r,cvConfig:i,draftConfigState:l,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:f,hyperparametersParameter:p,cvEnabledParameter:h,cvStrategyParameter:m,cvFoldsParameter:_,cvShuffleParameter:v,cvRandomStateParameter:y,cvRefitStrategyParameter:b,onSaveDraftConfig:w,onUpdateNodeData:E,currentStatus:N,currentProgress:j})=>{var Ks,Os,Nt,vs;const C=Ka(),[M,z]=x.useState(null),[D,k]=x.useState(null),[T,A]=x.useState(null),[O,R]=x.useState(0),[L,F]=x.useState({}),[B,q]=x.useState(!1),I=x.useRef(!1),[U,V]=x.useState(null),[H,G]=x.useState(!1),[W,J]=x.useState(!1),[ee,Z]=x.useState(null),[K,X]=x.useState(null),[Q,ne]=x.useState(!1),le=((s==null?void 0:s.targetColumn)??"").trim(),ce=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",ie=((r==null?void 0:r.modelType)??"").trim(),ge=(r==null?void 0:r.hyperparameters)??null,Re=(r==null?void 0:r.hyperparametersError)??null,ze=!!(i!=null&&i.enabled),me=(i==null?void 0:i.strategy)??"auto",xe=typeof(i==null?void 0:i.folds)=="number"?i.folds:0,Ce=!!(i!=null&&i.shuffle),Ae=(i==null?void 0:i.randomState)??null,Ve=(i==null?void 0:i.refitStrategy)??"train_plus_validation",Se=x.useMemo(()=>d?f.length?{...d,options:f}:d:null,[f,d]),We=Is({queryKey:["model-hyperparameters",ie],queryFn:()=>Qd(ie),enabled:!!ie,staleTime:5*60*1e3}),ht=Is({queryKey:["best-hyperparameters",ie,U,t],queryFn:()=>Iw(ie,{pipelineId:U||void 0,datasetSourceId:t||void 0}),enabled:!!(ie&&t),staleTime:30*1e3,retry:1}),ye=((Ks=We.data)==null?void 0:Ks.fields)??[],Fe=((Os=We.data)==null?void 0:Os.defaults)??{},Qe=x.useMemo(()=>ye.length?new Set(ye.map(de=>de.name)):new Set,[ye]),tt=x.useMemo(()=>ye.length?ye.reduce((de,be)=>(be!=null&&be.name&&(de[be.name]=be),de),{}):{},[ye]),xt=x.useMemo(()=>{if(!ie||!ge||Qe.size===0)return null;const de=qp(ge,Qe);return Object.keys(de).length>0?de:null},[Qe,ge,ie]);x.useEffect(()=>{F({}),q(!1),I.current=!1},[ie]),x.useEffect(()=>{xt&&(F(de=>{const be=Object.keys(de),qe=Object.keys(xt);return be.length===qe.length&&qe.every(Le=>Object.is(de[Le],xt[Le]))?de:xt}),I.current||(q(!0),I.current=!0))},[xt]),x.useEffect(()=>{if(!ie||xt||Qe.size===0||!Fe||Object.keys(Fe).length===0)return;const de=qp(Fe,Qe);Object.keys(de).length!==0&&F(be=>Object.keys(be).length>0?be:de)},[Qe,xt,Fe,ie]);const _t=x.useMemo(()=>{if(Qe.size===0)return null;const de=B3(L,Qe,tt);return Object.keys(de).length>0?de:null},[Qe,L]),Bt=x.useCallback(()=>{q(de=>{const be=!de;return be&&(I.current=!0),be})},[]),$e=x.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),Ie=x.useMemo(()=>{if(!$e)return null;if(!l||Object.keys(l).length===0)return $e;const de=Xc($e);return!de||!Array.isArray(de.nodes)||(de.nodes=de.nodes.map(be=>{if(!be||be.id!==e)return be;const qe=(be==null?void 0:be.data)??{},Le={...(qe==null?void 0:qe.config)??{},...l};return{...be,data:{...qe,config:Le,isConfigured:!0}}})),de},[l,$e,e]);x.useEffect(()=>{let de=!1;return!t||!$e?(V(null),()=>{de=!0}):(ti(t,$e).then(be=>{de||V(be)}).catch(()=>{de||V(null)}),()=>{de=!0})},[$e,t]),x.useEffect(()=>{let de=!1;k(null);const be=Ie??$e;return!t||!be?(z(null),()=>{de=!0}):(ti(t,be).then(qe=>{de||z(qe)}).catch(qe=>{de||(k((qe==null?void 0:qe.message)??"Unable to compute pipeline ID"),z(null))}),()=>{de=!0})},[$e,Ie,t]),x.useEffect(()=>{if(!M||!U){G(!1);return}G(M!==U)},[M,U]);const Be=x.useMemo(()=>["feature-canvas","training-jobs",t??"none",M??"pending",e],[e,M,t]),Ee=x.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",M??"pending",e],[e,M,t]),lt=!!(t&&e),Je=Is({queryKey:Ee,queryFn:async()=>{var be;const de={datasetSourceId:t||void 0,limit:5};if(M){const qe=await ei({...de,pipelineId:M});if((((be=qe==null?void 0:qe.jobs)==null?void 0:be.length)??0)>0)return qe}return ei(de)},enabled:lt,retry:(de,be)=>be.message.includes("Sign in")?!1:de<2,refetchInterval:de=>{const be=de.state.data;return((be==null?void 0:be.jobs)??[]).some(Le=>Le.status==="queued"||Le.status==="running")?5e3:!1}}),Ue=Is({queryKey:Be,queryFn:async()=>{var be;const de={datasetSourceId:t||void 0,nodeId:e,limit:5};if(M){const qe=await Jo({...de,pipelineId:M});if((((be=qe==null?void 0:qe.jobs)==null?void 0:be.length)??0)>0)return qe}return Jo(de)},enabled:lt,retry:(de,be)=>be.message.includes("Sign in")?!1:de<2,refetchInterval:de=>{const be=de.state.data;return((be==null?void 0:be.jobs)??[]).some(Le=>Le.status==="queued"||Le.status==="running")?1e3:!1}}),{mutateAsync:Rt,isPending:Yt,error:bt}=Wi({mutationFn:$w,onSuccess:de=>{const be=Array.isArray(de.jobs)?de.jobs.length:0,qe=be>0?de.jobs[0]:null;A(qe),R(be),C.invalidateQueries({queryKey:Be}),qe&&E&&E(e,{backgroundExecutionStatus:"loading"})}});x.useEffect(()=>{var Lt;if(!Ue.data||!E)return;const de=Ue.data.jobs??[];if(de.length===0)return;const be=de[0],qe=(Lt=be.status)==null?void 0:Lt.toLowerCase();let gt="idle";qe==="running"||qe==="queued"?gt="loading":qe==="succeeded"?gt="success":(qe==="failed"||qe==="cancelled")&&(gt="error");const Le=typeof be.progress=="number"?be.progress:void 0;(gt!==N||Le!==void 0&&Le!==j)&&E(e,{backgroundExecutionStatus:gt,progress:Le})},[Ue.data,E,e,N,j]);const Ot=Je.error,Pt=Je.isLoading||Je.isFetching,wt=((Nt=Je.data)==null?void 0:Nt.jobs)??[],pt=ht.data,rn=x.useCallback(de=>{if(!de)return null;const be=Object.keys(de);if(be.length===0)return null;if(Qe.size===0)return{params:de,hasUnmapped:!1};const qe=qp(de,Qe),gt=Object.keys(qe);return gt.length>0?{params:qe,hasUnmapped:gt.length!==be.length}:{params:de,hasUnmapped:!0}},[Qe]),Jt=x.useMemo(()=>wt.length?wt.filter(de=>de.status==="succeeded"):[],[wt]),tn=x.useMemo(()=>{if(!ie)return[];const de=[],be=new Set,qe=le?le.trim().toLowerCase():"",gt=Le=>!qe||!Le?!0:Le.trim().toLowerCase()===qe;if(pt!=null&&pt.available&&pt.best_params&&(!pt.model_type||pt.model_type===ie)){const Le=rn(pt.best_params);if(Le){const Lt=pt.job_id??null;if(!Lt||!be.has(Lt)){const Tt=["Most recent tuned run"];pt.run_number&&Tt.push(`#${pt.run_number}`);const an=`best-api-${Lt??ie}`;de.push({id:an,label:Tt.join(" "),source:"best-api",modelType:pt.model_type??ie,params:Le.params,jobId:Lt,nodeId:pt.node_id??null,runNumber:pt.run_number??null,score:pt.best_score??null,scoring:pt.scoring??null,finishedAt:pt.finished_at??null,searchStrategy:pt.search_strategy??null,nIterations:pt.n_iterations??null,targetColumn:le||null,pipelineId:pt.pipeline_id??null,datasetSourceId:t??null,description:Le.hasUnmapped?"Includes parameters outside the current template. They will be stored as custom overrides.":null}),Lt&&be.add(Lt)}}}return Jt.forEach(Le=>{var sr,Tn,qn,Ys,$n;if(!Le.best_params||Le.model_type!==ie||t&&Le.dataset_source_id&&Le.dataset_source_id!==t||be.has(Le.id))return;const Lt=rn(Le.best_params);if(!Lt)return;const Tt=typeof((sr=Le.metadata)==null?void 0:sr.target_column)=="string"?Le.metadata.target_column:typeof((Tn=Le.metadata)==null?void 0:Tn.targetColumn)=="string"?Le.metadata.targetColumn:null;if(!gt(Tt))return;const an=`job-${Le.id}`,hn=(()=>{var Qr;const rs=typeof((Qr=Le.metadata)==null?void 0:Qr.label)=="string"?Le.metadata.label.trim():"";return rs||(Le.run_number?`Run ${Le.run_number}`:`Job ${Le.id.slice(0,6)}`)})(),Ct=typeof((qn=Le.metadata)==null?void 0:qn.scoring)=="string"?Le.metadata.scoring:typeof((Ys=Le.metrics)==null?void 0:Ys.scoring)=="string"?Le.metrics.scoring:null,On=typeof(($n=Le.metadata)==null?void 0:$n.n_iterations)=="number"?Le.metadata.n_iterations:null;de.push({id:an,label:hn,source:"tuning-job",modelType:Le.model_type,params:Lt.params,jobId:Le.id,nodeId:Le.node_id,runNumber:Le.run_number??null,score:Le.best_score??null,scoring:Ct,finishedAt:Le.updated_at??Le.created_at??null,searchStrategy:Le.search_strategy??null,nIterations:On,targetColumn:Tt??(le||null),pipelineId:Le.pipeline_id??null,datasetSourceId:Le.dataset_source_id??null,description:Lt.hasUnmapped?"Some tuned parameters fall outside the current template and will be saved as custom overrides.":null}),be.add(Le.id)}),de.sort((Le,Lt)=>{const Tt=Le.finishedAt?Date.parse(Le.finishedAt):0,an=Lt.finishedAt?Date.parse(Lt.finishedAt):0;return Tt!==an?an-Tt:(Lt.runNumber??0)-(Le.runNumber??0)}),de},[pt,rn,ie,t,le,Jt]),Pe=tn[0]??null,Wt=tn.length>0,mn=!Pe,Fn=!Wt,Gt=x.useMemo(()=>Jt.length?Jt.slice().sort((de,be)=>{const qe=Date.parse(de.updated_at||de.created_at||"0");return Date.parse(be.updated_at||be.created_at||"0")-qe})[0]:wt.length?wt.slice().sort((de,be)=>{const qe=Date.parse(de.updated_at||de.created_at||"0");return Date.parse(be.updated_at||be.created_at||"0")-qe})[0]:null,[Jt,wt]),jt=Gt&&(Gt.updated_at||Gt.created_at)||null,Bn=jt?Xn(jt):null,ts=(Gt==null?void 0:Gt.run_number)??null,Hn=Pe!=null&&Pe.finishedAt?Xn(Pe.finishedAt):null,Sn=Pe&&Pe.scoring&&typeof Pe.score=="number"&&Number.isFinite(Pe.score)?`${Pe.scoring}: ${Vp(Pe.score)}`:null;x.useEffect(()=>{if(!tn.length){ee&&Z(null),(K==null?void 0:K.tone)==="success"&&X(null);return}ee&&!tn.some(de=>de.id===ee)&&(Z(null),X(null))},[K,tn,ee]);const Un=x.useCallback((de,be)=>{if(!de||Object.keys(de.params??{}).length===0){X({message:"Selected preset does not include any hyperparameters to apply.",tone:"warning"});return}F(()=>Xc(de.params)),q(!0),I.current=!0,Z(de.id),X({message:be??`Applied tuned parameters from ${de.label}.`,tone:"success"})},[F,q,X,Z]),ns=x.useCallback(()=>{if(!Pe){const be=Gt&&Gt.model_type&&Gt.model_type!==ie?`Latest tuning run targeted ${Gt.model_type}. Switch the model template to reuse its parameters.`:"No tuning job results available to apply.";X({message:be,tone:"warning"});return}const de=Pe.runNumber?`Applied tuned parameters from run ${Pe.runNumber}.`:`Applied tuned parameters from ${Pe.label}.`;Un(Pe,de)},[Un,Gt,ie,Pe,X]),cn=x.useMemo(()=>{if(!K)return"rgba(148, 163, 184, 0.75)";switch(K.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[K]),Mn=x.useMemo(()=>{const de=[];return t||de.push("Select a dataset before launching training jobs."),(!$e||!$e.nodes.length)&&de.push("Connect this node to an upstream pipeline before training."),le||de.push("Set a target column in the Train model readiness section."),ie||de.push("Choose a model type before enqueuing training jobs."),ze&&xe<2&&de.push("Cross-validation requires at least 2 folds."),D&&de.push(D),Re&&de.push(Re),de},[ze,xe,$e,Re,ie,D,t,le]),Mt=((vs=Ue.data)==null?void 0:vs.jobs)??[],An=x.useMemo(()=>{if(!Mt.length)return Mt;const de=ce==null?void 0:ce.toLowerCase();return Mt.filter(be=>{if(!de)return!0;const qe=(()=>{var an,hn,Ct,On;const Le=typeof be.problem_type=="string"?be.problem_type:null,Lt=typeof((an=be.metadata)==null?void 0:an.problem_type)=="string"?(hn=be.metadata)==null?void 0:hn.problem_type:null,Tt=typeof((Ct=be.metadata)==null?void 0:Ct.resolved_problem_type)=="string"?(On=be.metadata)==null?void 0:On.resolved_problem_type:null;return(Le||Tt||Lt||"").toLowerCase()})();if(qe)return qe===de;const gt=String(be.model_type||"").toLowerCase();return de==="regression"?gt.includes("regress"):de==="classification"?gt.includes("classif"):!0})},[Mt,ce]),hs=x.useMemo(()=>!!(bt instanceof Error&&bl(bt.message)||T&&Gc(T)||Mt.some(de=>Gc(de))||wt.some(de=>Gc(de))),[bt,Mt,T,wt]),Qn=hj({graph:n,nodeId:e,modelType:ie,problemType:ce,modelTypeOptions:f,enabled:hs});x.useEffect(()=>{Qn||ne(!1)},[Qn]);const qs=Math.max(Mt.length-An.length,0),Vs=Ue.isLoading||Ue.isFetching,As=Ue.error,en=Mn.length>0||!M||!t||!$e||Yt,et=x.useCallback((de,be)=>{F(qe=>({...qe,[de]:be}))},[]);x.useCallback(de=>{var gt;const be=L[de.name]??de.default,qe=`hyperparam-${e}-${de.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:qe,className:"canvas-modal__parameter-label",children:[de.label,de.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:de.description})]}),de.type==="number"&&a.jsx("input",{id:qe,type:"number",className:"canvas-modal__parameter-input",value:be??"",onChange:Le=>{const Lt=Le.target.value;if(Lt===""&&de.nullable)et(de.name,null);else{const Tt=parseFloat(Lt);isNaN(Tt)||et(de.name,Tt)}},min:de.min,max:de.max,step:de.step,placeholder:de.nullable?"Empty = default":""}),de.type==="select"&&a.jsx("select",{id:qe,className:"canvas-modal__parameter-select",value:be??"",onChange:Le=>et(de.name,Le.target.value),children:(gt=de.options)==null?void 0:gt.map(Le=>a.jsx("option",{value:String(Le.value),children:Le.label},String(Le.value)))}),de.type==="boolean"&&a.jsx("input",{id:qe,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!be,onChange:Le=>et(de.name,Le.target.checked)}),de.type==="text"&&a.jsx("input",{id:qe,type:"text",className:"canvas-modal__parameter-input",value:be??"",onChange:Le=>et(de.name,Le.target.value),placeholder:de.nullable?"Empty = default":""})]},de.name)},[L,et,e]);const Qt=x.useCallback(async()=>{if(!M||!t||!ie)return;if(H&&w){try{const Tt=w({closeModal:!1});Tt&&typeof Tt.then=="function"&&await Tt,G(!1)}catch{}await new Promise(Tt=>setTimeout(Tt,100))}const de=Ie??$e;if(!de)return;const be={};le&&(be.target_column=le),be.problem_type=ce,be.cross_validation={enabled:ze,strategy:me,folds:xe,shuffle:Ce,random_state:Ae,refit_strategy:Ve};const qe=Object.keys(be).length?be:void 0,gt=Xc(de);gt&&Array.isArray(gt.nodes)&&(gt.nodes=gt.nodes.map(Tt=>{if(!Tt||Tt.id!==e)return Tt;const an=(Tt==null?void 0:Tt.data)??{},hn=(an==null?void 0:an.config)??{},Ct=l?{...hn,...l}:hn;return{...Tt,data:{...an,config:Ct,isConfigured:!0}}}));const Le=ie?[ie]:[],Lt={dataset_source_id:t,pipeline_id:M,node_id:e,model_type:ie||void 0,model_types:Le.length?Le:void 0,hyperparameters:B&&_t?Xc(_t):void 0,metadata:qe,job_metadata:qe,run_training:!0,graph:gt??Xc(de),target_node_id:e};try{await Rt(Lt)}catch{}},[ze,xe,Ae,Ve,Ce,me,l,Rt,$e,Ie,H,ie,e,w,M,ce,_t,B,t,le]),ss=x.useCallback(()=>{lt&&Ue.refetch()},[lt,Ue]);return a.jsxs(a.Fragment,{children:[a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Model Training"})}),a.jsx("p",{className:"canvas-modal__note",children:"Configure and launch training jobs."}),M&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:M})]}),H&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0",display:"flex",alignItems:"start",gap:"0.5rem"},children:[a.jsx(ga,{size:16,style:{marginTop:"2px",flexShrink:0}}),a.jsxs("span",{children:[a.jsx("strong",{children:"Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]})]}),Mn.map((de,be)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:de},`training-prereq-${be}`)),bt instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:bt.message}),As&&!(bt instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:As.message||"Unable to load training jobs."}),Ot&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Ot.message||"Unable to load tuning jobs."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:O>1?a.jsxs("span",{children:["Queued ",O," training jobs. Latest job ",T.id," (version ",T.version,")."]}):a.jsxs("span",{children:["Training job ",T.id," queued (version ",T.version,")."]})}),Pt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Se&&u(Se),h&&u(h),ze&&a.jsxs(a.Fragment,{children:[m&&u(m),_&&u(_),v&&u(v),y&&u(y),b&&u(b)]}),a.jsx(K3,{modelType:ie,showAdvanced:B,hyperparamFields:ye,hyperparamValues:L,onHyperparamChange:et,onToggleAdvanced:Bt,isLoading:We.isLoading,error:We.error,primaryPreset:Pe,latestTuningJob:Gt,applyStatus:K,onApplyBestParams:ns,onBrowsePresets:()=>J(!0),applyButtonDisabled:mn,browsePresetsDisabled:Fn,latestTuningRunNumber:ts,latestTuningRelative:Bn,primaryPresetRelative:Hn,primaryPresetScoreLabel:Sn,applyStatusColor:cn,renderParameterField:u,hyperparametersParameter:p})]}),ze&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",xe," folds before refitting on"," ",Ve==="train_plus_validation"?"training plus validation data.":"training data only."]}),Qn&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"start"},children:[a.jsx(ga,{size:16,style:{marginTop:"2px",flexShrink:0}}),a.jsxs("div",{children:[a.jsx("strong",{children:Qn.headline}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:Qn.summary})]})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>ne(de=>!de),style:{whiteSpace:"nowrap"},children:Q?"Hide tips":"Show tips"})]}),Q&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:Qn.details.map((de,be)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:de},`scaling-tip-${be}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Qt,disabled:en,children:Yt?"Queuing":"Launch training job"})}),a.jsx(A3,{presets:tn,isOpen:W,onClose:()=>J(!1),onApply:de=>{Un(de),J(!1)},activePresetId:ee,fieldMetadata:tt})]}),a.jsx(V3,{jobs:An,isLoading:Vs,hiddenJobCount:qs,onRefresh:ss,pipelineId:M,createJobError:bt instanceof Error?bt:null,jobsError:As,tuningJobsError:Ot,lastCreatedJob:T,lastCreatedJobCount:O,isTuningJobsLoading:Pt})]})},W3=new Set(["true","1","yes","on"]),G3=new Set(["false","0","no","off"]),X3=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],gj=new Set(["true","1","yes","y","on","t"]),_j=new Set(["false","0","no","n","off","f"]),si=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(W3.has(t))return!0;if(G3.has(t))return!1}return null},Nl=e=>{if(!(!e||typeof e!="object")){for(const t of X3)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},dm=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},Kp=e=>Array.isArray(e)?e.map(t=>Kp(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=Kp(e[n]),t),{}):e,Qc=e=>e===void 0?"":JSON.stringify(Kp(e)),yj=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},Q3=(e,t)=>{const n=[],s=h=>{n.includes(h)||n.push(h)},r=(e??"").toLowerCase();if(!t.length)return n;const i=t.filter(h=>h!=null);if(!i.length)return n;const l=i.reduce((h,m)=>{if(typeof m=="number"&&Number.isFinite(m))return h+1;if(typeof m=="string"){const _=m.trim();if(!_)return h;const v=Number(_);if(!Number.isNaN(v)&&Number.isFinite(v))return h+1}return h},0),u=i.reduce((h,m)=>{const _=String(m).trim().toLowerCase();return _&&(gj.has(_)||_j.has(_))?h+1:h},0),d=(()=>{const h=new Set;return i.forEach(m=>{h.add(String(m).trim().toLowerCase())}),h.size})(),f=l/i.length,p=u/i.length;if(r.includes("object")||r.includes("string"))return p>=.7&&s("boolean"),f>=.7&&s("float64"),d>0&&d<=20&&s("category"),n;if(r.includes("float")){const h=i.reduce((m,_)=>{if(typeof _=="number")return Number.isInteger(_)?m+1:m;if(typeof _=="string"){const v=_.trim();if(!v)return m;const y=Number(v);if(!Number.isNaN(y)&&Number.isFinite(y)&&Number.isInteger(y))return m+1}return m},0);return p>=.8&&s("boolean"),i.length>0&&h/i.length>=.9&&s("Int64"),n}return r.includes("int")&&p>=.7&&s("boolean"),n},mm=[{value:"train",label:"Train",accent:"train"},{value:"test",label:"Test",accent:"test"},{value:"validation",label:"Validation",accent:"validation"}],hm={train:0,test:1,validation:2},Z3=["train","test","validation"],Yp=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],Zc=e=>{const t=new Set(mm.map(r=>r.value)),n=[];e.forEach(r=>{if(r){if(r==="training"&&(r="train"),r==="valid"||r==="val"){n.push("validation");return}t.has(r)&&n.push(r)}});const s=new Set;return n.filter(r=>s.has(r)?!1:(s.add(r),!0)).sort((r,i)=>hm[r]-hm[i])},J3=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},Wp=(e,t)=>{const n=si(e);return n===null?t:n},vj=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},xj=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},bj=e=>{const t=mm.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},eF=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},tF=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${eF(e.status)}`);const n=Xn(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},fm=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,wj=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,s])=>{typeof s=="number"&&Number.isFinite(s)&&t.push({key:n,value:s})}),t.sort((n,s)=>n.key.localeCompare(s.key)),t},Nj=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},nF=({nodeId:e,sourceId:t,graph:n,config:s,setConfigState:r,renderParameterField:i,formatMetricValue:l,connectedSplitHandles:u})=>{var ze;const d=Ka(),f=x.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),p=x.useMemo(()=>{if(!f)return[];const me=new Map;f.nodes.forEach(Ce=>{Ce!=null&&Ce.id&&me.set(Ce.id,Ce)});const xe=new Set;return f.edges.forEach(Ce=>{var Ve;if(!Ce||Ce.target!==e)return;const Ae=me.get(Ce.source);((Ve=Ae==null?void 0:Ae.data)==null?void 0:Ve.catalogType)==="train_model_draft"&&xe.add(Ae.id)}),xe.size>0?Array.from(xe):f.nodes.filter(Ce=>{var Ae;return((Ae=Ce==null?void 0:Ce.data)==null?void 0:Ae.catalogType)==="train_model_draft"}).map(Ce=>Ce.id)},[f,e]),h=x.useMemo(()=>p.length?p.slice().sort().join("|"):"all",[p]),[m,_]=x.useState(null),[v,y]=x.useState(null);x.useEffect(()=>{let me=!1;return y(null),!t||!f?(_(null),()=>{me=!0}):(ti(t,f).then(xe=>{me||_(xe)}).catch(xe=>{me||(y((xe==null?void 0:xe.message)??"Unable to compute pipeline signature."),_(null))}),()=>{me=!0})},[f,t]);const b=x.useMemo(()=>{const me=s==null?void 0:s.training_job_id;return typeof me=="string"?me.trim():typeof me=="number"?String(me):""},[s==null?void 0:s.training_job_id]),w=x.useMemo(()=>Zc(Yp(s==null?void 0:s.splits)),[s==null?void 0:s.splits]),E=x.useMemo(()=>w.length?w:Z3,[w]);x.useEffect(()=>{u&&r(me=>{const xe=me??{},Ce=Zc(Yp(xe.splits)),Ae=Ce.filter(Se=>u[Se]!==!1);if(Ae.length===Ce.length&&Ae.every((Se,We)=>Se===Ce[We]))return me;const Ve={...xe};return Ae.length?Ve.splits=Ae:delete Ve.splits,Ve})},[u,r]);const N=x.useMemo(()=>u?E.filter(me=>u[me]!==!1):E,[u,E]),j=x.useMemo(()=>u?mm.filter(me=>u[me.value]===!1).map(me=>me.label):[],[u]),C=x.useMemo(()=>{if(!j.length)return"";if(j.length===1)return j[0];if(j.length===2)return`${j[0]} and ${j[1]}`;const me=j[j.length-1];return`${j.slice(0,-1).join(", ")}, and ${me}`},[j]),M=N.length>0,z=Wp(s==null?void 0:s.include_confusion,!0),D=Wp(s==null?void 0:s.include_curves,!0),k=Wp(s==null?void 0:s.include_residuals,!0),T=vj(s==null?void 0:s.max_curve_points,500),A=vj(s==null?void 0:s.max_scatter_points,750),O=typeof(s==null?void 0:s.last_evaluated_at)=="string"?s.last_evaluated_at:null,[R,L]=x.useState(null),[F,B]=x.useState("details"),q=x.useRef(!1);x.useEffect(()=>{L(null),q.current=!1},[b]),x.useEffect(()=>{B("details")},[R==null?void 0:R.job_id]);const I=x.useMemo(()=>["feature-canvas","model-evaluation",t??"none",m??"pending",h],[m,t,h]),U=Is({queryKey:I,queryFn:async()=>{const me={datasetSourceId:t||void 0,limit:50},xe=new Map,Ce=[];let Ae=null;const Ve=ye=>{Array.isArray(ye)&&ye.forEach(Fe=>{Fe&&!xe.has(Fe.id)&&xe.set(Fe.id,Fe)})},Se=async ye=>{try{const Fe=await Jo(ye);return Ve(Fe==null?void 0:Fe.jobs),Fe}catch(Fe){return Fe instanceof Error&&Ce.push(Fe),null}};if(m&&await Se({...me,pipelineId:m}),p.length&&await Promise.all(p.map(ye=>Se({...me,nodeId:ye}))),Ae=await Se(me),!xe.size){if(Ae)return Ae;if(Ce.length)throw Ce[0];return{jobs:[],total:0}}const We=Array.from(xe.values());We.sort((ye,Fe)=>xj(Fe.updated_at??Fe.created_at)-xj(ye.updated_at??ye.created_at));const ht=(Ae==null?void 0:Ae.total)??We.length;return{jobs:We,total:ht}},enabled:!!t,staleTime:30*1e3,retry:(me,xe)=>xe.message.includes("Sign in")?!1:me<2,refetchInterval:me=>{const xe=me.state.data;return((xe==null?void 0:xe.jobs)??[]).some(Ve=>Ve.status==="queued"||Ve.status==="running")?5e3:!1}}),V=((ze=U.data)==null?void 0:ze.jobs)??[],H=x.useMemo(()=>{const me=new Map;return V.forEach(xe=>{me.set(xe.id,xe)}),me},[V]),G=x.useMemo(()=>V.filter(me=>me.status==="succeeded"),[V]),W=x.useMemo(()=>G.map(me=>({value:me.id,label:tF(me)})),[G]),J=b?H.get(b)??null:null,ee=Is({queryKey:["feature-canvas","training-job",b||"none"],queryFn:()=>zw(b),enabled:!!b,staleTime:30*1e3});x.useEffect(()=>{var ye,Fe;const me=ee.data;if(!me)return;const xe=(ye=me.metrics)==null?void 0:ye.evaluation;if(!xe||typeof xe!="object")return;const Ce=xe.splits;if(!Ce||typeof Ce!="object")return;const Ae={};Object.entries(Ce).forEach(([Qe,tt])=>{tt&&typeof tt=="object"&&(Ae[Qe]=tt)});const Ve=typeof xe.generated_at=="string"?xe.generated_at:O??me.updated_at??me.created_at??new Date().toISOString(),Se=xe.problem_type==="regression"?"regression":"classification",We={job_id:me.id,pipeline_id:me.pipeline_id,node_id:me.node_id,generated_at:Ve,problem_type:Se,target_column:xe.target_column??((Fe=me.metadata)==null?void 0:Fe.target_column)??null,splits:Ae};L(We),Ve&&Ve!==O&&r(Qe=>({...Qe??{},last_evaluated_at:Ve}));const ht=Zc(Object.keys(Ae));ht.length&&!q.current&&!J3(w,ht)&&r(Qe=>({...Qe??{},splits:ht}))},[ee.data,O,r,w]);const Z=Wi({mutationFn:async me=>{if(!b)throw new Error("Select a training job before running evaluation.");return Rw(b,me)},onSuccess:me=>{L(me),r(xe=>({...xe??{},training_job_id:b,splits:me.splits?Object.keys(me.splits):N,include_confusion:z,include_curves:D,include_residuals:k,max_curve_points:T,max_scatter_points:A,last_evaluated_at:me.generated_at})),d.invalidateQueries({queryKey:["feature-canvas","training-job",b]})}}),K=x.useCallback(me=>{const xe=me.target.value;Z.reset(),r(Ce=>{const Ae={...Ce??{}};return xe?Ae.training_job_id=xe:delete Ae.training_job_id,Ae})},[Z,r]),X=x.useCallback(me=>{u&&u[me]===!1||(Z.reset(),q.current=!0,r(xe=>{const Ce=Zc(Yp(xe==null?void 0:xe.splits)),Ae=Ce.includes(me);let Ve;if(Ae){if(Ce.length<=1)return xe??{};Ve=Ce.filter(Se=>Se!==me)}else Ve=Zc([...Ce,me]);return{...xe??{},splits:Ve}}))},[u,Z,r]),Q=x.useCallback((me,xe)=>{Z.reset(),r(Ce=>({...Ce??{},[me]:xe}))},[Z,r]),ne=x.useCallback(()=>{if(!b)return;const me={splits:N,include_confusion:z,include_curves:D,include_residuals:k,max_curve_points:D?T:void 0,max_scatter_points:k?A:void 0};Z.mutate(me)},[Z,z,D,k,T,A,b,N]),le=R?Xn(R.generated_at):O?Xn(O):null,ce=x.useMemo(()=>R?Object.entries(R.splits).sort((me,xe)=>{const[Ce]=me,[Ae]=xe,Ve=hm[Ce]??99,Se=hm[Ae]??99;return Ve-Se}):[],[R]),ie=x.useMemo(()=>{if(!R||!ce.length)return null;const me=ce.map(([Ce,Ae])=>{const Ve=wj(Ae.metrics).reduce((Se,We)=>(Se[We.key]=We.value,Se),{});return{key:Ce,label:bj(Ce),rowCount:typeof Ae.row_count=="number"?Ae.row_count:null,metrics:Ve}}),xe=Array.from(new Set(me.flatMap(Ce=>Object.keys(Ce.metrics)))).sort((Ce,Ae)=>Ce.localeCompare(Ae));return{splits:me,metricKeys:xe}},[ce,R]),ge=x.useMemo(()=>ie?ie.splits.length<=1?"Connect at least two splits to compare results.":ie.metricKeys.length?null:"No numeric metrics available for comparison yet.":"Run an evaluation to compare metrics.",[ie]);x.useEffect(()=>{F==="comparison"&&ge&&B("details")},[F,ge]);const Re=x.useCallback(me=>{me==="comparison"&&ge||B(me)},[ge]);return a.jsxs("div",{className:"canvas-modal__section node-settings__evaluation",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:le&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",le]})})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:b,onChange:K,disabled:U.isLoading||U.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),W.map(me=>a.jsx("option",{value:me.value,children:me.label},me.value))]}),U.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),U.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:U.error.message}),!U.isLoading&&!W.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),v&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:v})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:mm.map(me=>{const xe=u?u[me.value]!==!1:!0,Ce=xe&&N.includes(me.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${me.accent} ${Ce?"evaluation-chip--active":""}`,"aria-disabled":!xe,title:xe?void 0:`${me.label} split is not connected`,style:xe?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:Ce,disabled:!xe,onChange:()=>X(me.value)}),a.jsx("span",{children:me.label})]},me.value)})}),j.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",C," split",j.length>1?"s":""," to enable diagnostics."]}),!M&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a train, validation, or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:z,onChange:me=>Q("include_confusion",me.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:D,onChange:me=>Q("include_curves",me.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:k,onChange:me=>Q("include_residuals",me.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:ne,disabled:!b||Z.isPending||!M,children:Z.isPending?"Running":"Run evaluation"}),J&&J.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!M&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),Z.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:Z.error.message}),Z.isSuccess&&R&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",Xn(R.generated_at),"."]}),ee.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:ee.error.message})]}),R?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:R.problem_type==="regression"?"Regression":"Classification"})]}),R.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:R.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:Xn(R.generated_at)??R.generated_at})]})]}),a.jsxs("div",{className:"evaluation-tabs",role:"tablist","aria-label":"Evaluation views",children:[a.jsx("button",{type:"button",className:`evaluation-tab ${F==="details"?"evaluation-tab--active":""}`,role:"tab","aria-selected":F==="details",onClick:()=>Re("details"),children:"Split details"}),a.jsx("button",{type:"button",className:`evaluation-tab ${F==="comparison"?"evaluation-tab--active":""}`,role:"tab","aria-selected":F==="comparison","aria-disabled":!!ge,disabled:!!ge,title:ge??void 0,onClick:()=>Re("comparison"),children:"Split comparison"})]}),F==="comparison"&&ie?a.jsx(sF,{comparison:ie,formatMetricValue:l}):ce.map(([me,xe])=>a.jsx(rF,{splitKey:me,payload:xe,problemType:R.problem_type,formatMetricValue:l},me))]}):a.jsx("div",{className:"evaluation-placeholder",children:b?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},sF=({comparison:e,formatMetricValue:t})=>e.metricKeys.length?a.jsx("section",{className:"evaluation-comparison",children:a.jsx("div",{className:"evaluation-comparison__table-wrapper",children:a.jsxs("table",{className:"evaluation-comparison__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Metric"}),e.splits.map(n=>a.jsx("th",{children:n.label},n.key))]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"evaluation-comparison__row evaluation-comparison__row--muted",children:[a.jsx("td",{children:"Rows evaluated"}),e.splits.map(n=>a.jsx("td",{children:typeof n.rowCount=="number"?n.rowCount.toLocaleString():""},`${n.key}-rows`))]}),e.metricKeys.map(n=>a.jsxs("tr",{className:"evaluation-comparison__row",children:[a.jsx("td",{children:n}),e.splits.map(s=>a.jsx("td",{children:typeof s.metrics[n]=="number"?t(s.metrics[n]):""},`${s.key}-${n}`))]},n))]})]})})}):a.jsx("div",{className:"evaluation-placeholder",children:a.jsx("p",{children:"No numeric metrics were reported across splits for comparison."})}),rF=({splitKey:e,payload:t,problemType:n,formatMetricValue:s})=>{const r=wj(t.metrics),i=r.length>0,l=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[bj(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),i?a.jsx("div",{className:"evaluation-metrics__grid",children:r.map(u=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:u.key}),a.jsx("span",{className:"evaluation-metrics__value",children:s(u.value)})]},u.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(aF,{matrix:t.confusion_matrix,formatMetricValue:s}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(u=>a.jsx(oF,{curve:u,formatMetricValue:s},`roc-${u.label}`)),t.pr_curves.map(u=>a.jsx(iF,{curve:u,formatMetricValue:s},`pr-${u.label}`))]}),n==="regression"&&t.residuals&&a.jsx(cF,{residuals:t.residuals,formatMetricValue:s})]}),l.length>0&&a.jsx("ul",{className:"evaluation-notes",children:l.map((u,d)=>a.jsx("li",{children:u},`${e}-note-${d}`))})]})},aF=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],s=Array.isArray(e.totals)?e.totals:[],r=Array.isArray(e.normalized)?e.normalized:[],i=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),i!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",Nj(i,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((l,u)=>a.jsx("th",{children:l},`pred-${u}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((l,u)=>{const d=r[u]??[],f=s[u]??l.reduce((p,h)=>p+h,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[u]??`Class ${u}`}),l.map((p,h)=>{const m=typeof d[h]=="number"?d[h]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:p}),m!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:Nj(m,t)})]},`cell-${u}-${h}`)}),a.jsx("td",{children:f})]},`row-${u}`)})})]})]})},oF=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,s=240,r=28,i=n-r*2,l=s-r*2,u=e.fpr.map((d,f)=>{const p=r+fm(d)*i,h=s-r-fm(e.tpr[f])*l;return`${f===0?"M":"L"}${p} ${h}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:r,y:r,width:i,height:l,className:"evaluation-chart__frame"}),a.jsx("line",{x1:r,y1:s-r,x2:n-r,y2:r,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:r,y1:r,x2:r,y2:s-r,className:"evaluation-chart__axis"}),a.jsx("line",{x1:r,y1:s-r,x2:n-r,y2:s-r,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},iF=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,s=240,r=28,i=n-r*2,l=s-r*2,u=e.recall.map((d,f)=>{const p=r+fm(d)*i,h=s-r-fm(e.precision[f])*l;return`${f===0?"M":"L"}${p} ${h}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:r,y:r,width:i,height:l,className:"evaluation-chart__frame"}),a.jsx("line",{x1:r,y1:r,x2:r,y2:s-r,className:"evaluation-chart__axis"}),a.jsx("line",{x1:r,y1:s-r,x2:n-r,y2:s-r,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},lF={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},cF=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(s=>typeof s[1]=="number"&&Number.isFinite(s[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([s,r])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:lF[s]??s}),a.jsx("span",{className:"evaluation-summary__value",children:t(r)})]},s))}),a.jsx(uF,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx(dF,{points:e.scatter})]})},uF=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const s=t.reduce((r,i)=>Math.max(r,i),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((r,i)=>{const l=r/s*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${r} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${l}%`}})},`bin-${i}`)})})},dF=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,s=36,r=e.map(m=>m.actual),i=e.map(m=>m.predicted),l=Math.min(...r,...i),u=Math.max(...r,...i),d=u-l||1,f=m=>(m-l)/d,p=m=>s+f(m)*(t-s*2),h=m=>n-s-f(m)*(n-s*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:s,y:s,width:t-s*2,height:n-s*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:s,y1:n-s,x2:t-s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:s,y1:s,x2:s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:p(l),y1:h(l),x2:p(u),y2:h(u),className:"evaluation-curve__baseline"}),e.map((m,_)=>a.jsx("circle",{cx:p(m.actual),cy:h(m.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${_}`))]})})},mF={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},jl={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score","f1","precision","recall"],regression:["rmse","mae","r2","mape","mse"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc","f1","precision","recall"]},jj=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted","f1","precision","recall"],Sj=["rmse","mae","r2","mape","mse"],Ej=new Set(["rmse","mae","mape","mse"]),Cj={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},er=e=>!!e&&typeof e=="object"&&!Array.isArray(e),hF=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},Gp=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",fF=e=>{if(!e)return jl.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return jl.regression;if(t.includes("class")||t.includes("classification"))return jl.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?jl.regression:n==="classification"?jl.classification:jl.fallback},pF=e=>{var r,i,l;if(!er(e))return null;const t=[],n=(i=(r=e==null?void 0:e.cross_validation)==null?void 0:r.metrics)==null?void 0:i.mean;er(n)&&((l=e==null?void 0:e.cross_validation)==null?void 0:l.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),er(e.test)&&t.push({values:e.test,labelPrefix:""}),er(e.validation)&&t.push({values:e.validation,labelPrefix:""}),er(e.train)&&t.push({values:e.train,labelPrefix:""});const s=fF(e);for(const u of t)for(const d of s){const f=u.values[d];if(typeof f=="number"&&Number.isFinite(f))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:f}}for(const u of t)for(const[d,f]of Object.entries(u.values))if(typeof f=="number"&&Number.isFinite(f))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:f};return null},gF=e=>{var n,s;if(!er(e))return{label:null,values:{}};if(er(e.test))return{label:"Test",values:e.test};if(er(e.validation))return{label:"Validation",values:e.validation};const t=(s=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:s.mean;return er(t)?{label:"CV mean",values:t}:er(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},kj=e=>{if(!e)return"Unknown model";const t=e.trim();return Cj[t]?Cj[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},_F=e=>{var i,l;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const u of n)if(typeof u=="string"){const d=u.trim().toLowerCase();if(d==="classification"||d==="regression")return d}const s=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(s.includes("classifier")||s.includes("classification"))return"classification";if(s.includes("regress")||s.includes("regression"))return"regression";const r=e.metrics;if(er(r)){const u=new Set,d=m=>{er(m)&&Object.keys(m).forEach(_=>u.add(_.toLowerCase()))};d(r.test),d(r.validation),d(r.train);const f=(l=(i=r==null?void 0:r.cross_validation)==null?void 0:i.metrics)==null?void 0:l.mean;er(f)&&d(f);const p=jj.some(m=>u.has(m)),h=Sj.some(m=>u.has(m));if(p&&!h)return"classification";if(h&&!p)return"regression"}return"unknown"},yF=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:_F(t),modelLabel:kj(t.model_type),primaryMetric:pF(n),metricBucket:gF(n)}}),Mj=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return Ej.has(t)||Ej.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},vF=({nodeId:e,sourceId:t,graph:n,parameters:s,config:r,renderParameterField:i})=>{var J;const l=x.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),u=x.useMemo(()=>{if(!l)return[];const ee=new Map;l.nodes.forEach(X=>{X&&X.id&&ee.set(X.id,X)});const Z=new Set;return l.edges.forEach(X=>{var ne;if(!X||X.target!==e)return;const Q=ee.get(X.source);((ne=Q==null?void 0:Q.data)==null?void 0:ne.catalogType)==="train_model_draft"&&Z.add(Q.id)}),Z.size>0?Array.from(Z):l.nodes.filter(X=>{var Q;return((Q=X==null?void 0:X.data)==null?void 0:Q.catalogType)==="train_model_draft"}).map(X=>X.id)},[l,e]),d=x.useMemo(()=>u.length?u.slice().sort().join("|"):"all",[u]),[f,p]=x.useState(null),[h,m]=x.useState(null);x.useEffect(()=>{let ee=!1;return m(null),!t||!l?(p(null),()=>{ee=!0}):(ti(t,l).then(Z=>{ee||p(Z)}).catch(Z=>{ee||(m((Z==null?void 0:Z.message)??"Unable to compute pipeline ID"),p(null))}),()=>{ee=!0})},[l,t]);const _=hF(r==null?void 0:r.show_non_success,!0),v=x.useMemo(()=>["feature-canvas","model-registry",t??"none",f??"pending",d,_?"all-statuses":"succeeded"],[f,_,t,d]),y=Is({queryKey:v,queryFn:async()=>{const ee={datasetSourceId:t||void 0,limit:50},Z=new Map,K=[];let X=null;const Q=ie=>{!Array.isArray(ie)||!ie.length||ie.forEach(ge=>{ge&&!Z.has(ge.id)&&Z.set(ge.id,ge)})},ne=async ie=>{try{const ge=await Jo(ie);return Q(ge==null?void 0:ge.jobs),ge}catch(ge){return ge instanceof Error&&K.push(ge),null}};if(f&&await ne({...ee,pipelineId:f}),u.length===1){const[ie]=u;await ne({...ee,nodeId:ie})}if(X=await ne(ee),!Z.size){if(X)return X;if(K.length)throw K[0];return{jobs:[],total:0}}const le=Array.from(Z.values()),ce=(X==null?void 0:X.total)??le.length;return{jobs:le,total:ce}},enabled:!!t,staleTime:30*1e3,retry:(ee,Z)=>Z.message.includes("Sign in")?!1:ee<2,refetchInterval:ee=>{const Z=ee.state.data;return((Z==null?void 0:Z.jobs)??[]).some(Q=>Q.status==="queued"||Q.status==="running")?5e3:!1}}),b=((J=y.data)==null?void 0:J.jobs)??[],w=x.useMemo(()=>{if(!b.length)return[];if(!u.length)return b;const ee=b.filter(Z=>u.includes(Z.node_id));return ee.length?ee:b},[b,u]),E=x.useMemo(()=>yF(w),[w]),N=x.useMemo(()=>_?E:E.filter(ee=>ee.job.status==="succeeded"),[E,_]),j=x.useMemo(()=>N.filter(ee=>ee.problemType==="classification"),[N]),C=x.useMemo(()=>N.filter(ee=>ee.problemType==="regression"),[N]),M=x.useMemo(()=>!j.length&&!C.length?"classification":j.length?C.length?j.length>=C.length?"classification":"regression":"classification":"regression",[j.length,C.length]),z=typeof(r==null?void 0:r.default_problem_type)=="string"?r.default_problem_type.trim().toLowerCase():"auto",D=z==="classification"||z==="regression"?z:M,[k,T]=x.useState(D);x.useEffect(()=>{T(D)},[D]);const A=k==="classification"?j:C,O=x.useMemo(()=>{const ee=new Map;return A.forEach(Z=>{const K=Z.job.model_type,X=ee.get(K)??{label:Z.modelLabel,count:0};X.count+=1,ee.set(K,X)}),Array.from(ee.entries()).map(([Z,K])=>({value:Z,label:K.label,count:K.count})).sort((Z,K)=>Z.label.localeCompare(K.label))},[A]),R=typeof(r==null?void 0:r.default_method)=="string"?r.default_method.trim().toLowerCase():"",[L,F]=x.useState("all");x.useEffect(()=>{if(!O.length){F("all");return}const ee=O.find(Z=>Z.value.toLowerCase()===R);F(ee?ee.value:"all")},[R,O,k]);const B=x.useMemo(()=>L==="all"?A:A.filter(ee=>ee.job.model_type===L),[L,A]),q=x.useMemo(()=>B.slice().sort((ee,Z)=>{if(Z.job.version!==ee.job.version)return Z.job.version-ee.job.version;const K=Date.parse(ee.job.updated_at??ee.job.created_at??"");return Date.parse(Z.job.updated_at??Z.job.created_at??"")-K}),[B]),I=x.useMemo(()=>{if(!A.length)return[];const ee=new Map;A.forEach(K=>{const X=K.job.model_type,Q=ee.get(X)??[];Q.push(K),ee.set(X,Q)});const Z=[];return ee.forEach((K,X)=>{const Q=K.reduce((ne,le)=>{const ce=Mj(le.primaryMetric);if(ce===null)return ne;if(!ne)return le;const ie=Mj(ne.primaryMetric);return ie===null||ce>ie?le:ne},null);Z.push({modelType:X,label:kj(X),bestJob:Q})}),Z.sort((K,X)=>K.label.localeCompare(X.label))},[A]),U=x.useMemo(()=>s.filter(ee=>["default_problem_type","show_non_success"].includes(ee.name)),[s]),V=k==="classification"?jj:Sj,H=y.isLoading||y.isFetching,G=y.error??null,W=q.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),f&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",f]})]}),h&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:h}),!u.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),U.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:U.map(ee=>a.jsx(ve.Fragment,{children:i(ee)},ee.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(ee=>a.jsxs("button",{type:"button",role:"tab","data-active":k===ee,className:"model-registry__tab",onClick:()=>T(ee),disabled:ee==="classification"&&!j.length||ee==="regression"&&!C.length,children:[ee==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:ee==="classification"?j.length:C.length})]},ee))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":L==="all",onClick:()=>F("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:A.length})]}),O.map(ee=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":L===ee.value,onClick:()=>F(ee.value),children:[ee.label,a.jsx("span",{className:"model-registry__method-count",children:ee.count})]},ee.value))]})]}),I.length>0&&a.jsx("div",{className:"model-registry__summary",children:I.map(ee=>{const Z=ee.bestJob,K=Z!=null&&Z.primaryMetric?Z.primaryMetric.label:null,X=Z!=null&&Z.primaryMetric?Gp(Z.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:ee.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[K||"No metrics",K&&a.jsx("strong",{children:X})]}),(Z==null?void 0:Z.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",Z.job.version]})]},ee.modelType)})}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),G&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:G.message}),!H&&!G&&!W&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),W&&a.jsx("div",{className:"model-registry__table-wrapper",style:{overflowX:"auto"},children:a.jsxs("table",{className:"model-registry__table",style:{width:"100%",borderCollapse:"collapse",fontSize:"0.85rem"},children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"left",color:"#e2e8f0",fontWeight:600},children:"Version"}),a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"left",color:"#e2e8f0",fontWeight:600},children:"Status"}),a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"left",color:"#e2e8f0",fontWeight:600},children:"Model"}),a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"left",color:"#e2e8f0",fontWeight:600},children:"Target"}),a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"right",color:"#e2e8f0",fontWeight:600},children:"Primary metric"}),V.map(ee=>a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"right",color:"#e2e8f0",fontWeight:600},children:ee.replace(/_/g," ")},ee)),a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"left",color:"#e2e8f0",fontWeight:600},children:"Evaluated"}),a.jsx("th",{scope:"col",style:{padding:"0.75rem",textAlign:"right",color:"#e2e8f0",fontWeight:600},children:"Updated"})]})}),a.jsx("tbody",{children:q.map(ee=>{var ce;const{job:Z,primaryMetric:K,metricBucket:X}=ee,Q=X.values||{},ne=X.label??"",le=Z.updated_at??Z.created_at??null;return a.jsxs("tr",{style:{borderTop:"1px solid rgba(148, 163, 184, 0.1)"},children:[a.jsxs("td",{style:{padding:"0.75rem",color:"rgba(148, 163, 184, 0.8)"},children:["v",Z.version]}),a.jsx("td",{style:{padding:"0.75rem"},children:a.jsx("span",{style:{display:"inline-block",padding:"0.15rem 0.5rem",borderRadius:"4px",fontSize:"0.75rem",fontWeight:500,background:Z.status==="succeeded"?"rgba(34, 197, 94, 0.15)":Z.status==="failed"?"rgba(239, 68, 68, 0.15)":"rgba(59, 130, 246, 0.15)",color:Z.status==="succeeded"?"#4ade80":Z.status==="failed"?"#f87171":"#60a5fa"},children:mF[Z.status]})}),a.jsx("td",{style:{padding:"0.75rem",fontWeight:500,color:"#e2e8f0"},children:ee.modelLabel}),a.jsx("td",{style:{padding:"0.75rem",color:"rgba(148, 163, 184, 0.8)"},children:((ce=Z.metadata)==null?void 0:ce.target_column)||""}),a.jsx("td",{style:{padding:"0.75rem",textAlign:"right"},children:K?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",style:{marginRight:"0.5rem",color:"rgba(148, 163, 184, 0.6)",fontSize:"0.75rem"},children:K.label}),a.jsx("span",{className:"model-registry__metric-value",style:{fontFamily:"monospace",color:"#e2e8f0",fontWeight:600},children:Gp(K.value)})]}):a.jsx("span",{style:{color:"rgba(148, 163, 184, 0.3)"},children:""})}),V.map(ie=>{const ge=Q[ie],Re=typeof ge=="number"&&Number.isFinite(ge);return a.jsx("td",{style:{padding:"0.75rem",textAlign:"right"},children:Re?a.jsx("span",{style:{fontFamily:"monospace",color:"#e2e8f0"},children:Gp(ge)}):a.jsx("span",{style:{color:"rgba(148, 163, 184, 0.3)"},children:""})},`${Z.id}-${ie}`)}),a.jsx("td",{style:{padding:"0.75rem",color:"rgba(148, 163, 184, 0.8)"},children:ne}),a.jsx("td",{style:{padding:"0.75rem",textAlign:"right",color:"rgba(148, 163, 184, 0.8)"},children:le?Xn(le)??le:""})]},Z.id)})})]})})]})},xF={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},ri="__tuning_strategies",ai="__active_tuning_strategy_id",oi="__expanded_tuning_strategy_ids",Xp=["random","grid","halving","optuna"],pm=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const s=n.toLowerCase();if(t&&t.length>0){const i=t.find(l=>l.toLowerCase()===s);if(i)return i}const r=Xp.find(i=>i.toLowerCase()===s);return r||n},Ar=e=>!!e&&typeof e=="object"&&!Array.isArray(e),ys=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},to=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return Ar(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return Ar(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},Qp=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,s])=>{if(n){if(Array.isArray(s)){const r=s.filter(i=>i!=null);r.length>0&&(t[n]=r.map(i=>ys(i)));return}s==null||s===""||(t[n]=[ys(s)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},bF=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",wF=new Set(["train","test","validation"]),Aj=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const s=n.trim().toLowerCase();wF.has(s)&&t.add(s)}}),Array.from(t)},Zp=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,r])=>{t.has(s)&&(n[s]=r)}),n},Jp=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,r])=>{if(t.has(s)){if(Array.isArray(r)){const i=r.map(l=>ys(l)).filter(l=>l!=null&&l!=="");i.length>0&&(n[s]=i);return}r!=null&&r!==""&&(n[s]=[ys(r)])}}),n},NF=(e,t)=>{const n=t.split(/[\n,]+/).map(d=>d.trim()).filter(d=>d.length>0);if(n.length===0)return{values:[],error:null};const s=[],r=[],i=Array.isArray(e.options)?new Set(e.options.map(d=>d.value)):null;n.forEach(d=>{if(e.type==="number"){const f=Number(d);Number.isFinite(f)?s.push(f):r.push(d);return}if(e.type==="boolean"){const f=d.toLowerCase();if(["true","1","yes","y"].includes(f)){s.push(!0);return}if(["false","0","no","n"].includes(f)){s.push(!1);return}r.push(d);return}if(e.type==="select"){if(i&&!i.has(d)){r.push(d);return}s.push(d);return}s.push(d)});const l=[],u=new Set;if(s.forEach(d=>{const f=typeof d=="object"?JSON.stringify(d):String(d);u.has(f)||(u.add(f),l.push(d))}),r.length>0){const d=r.slice(0,3).join(", "),f=r.length>3?"":"";return{values:l,error:`Invalid value${r.length>1?"s":""}: ${d}${f}`}}return{values:l,error:null}},Oj=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),gm=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},_m=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},Jc=(e,t,n)=>{let s=e;return typeof t=="number"&&Number.isFinite(t)&&(s=Math.max(s,t)),typeof n=="number"&&Number.isFinite(n)&&(s=Math.min(s,n)),s},jF=(e,t)=>{const n={},s=e.find(d=>(d==null?void 0:d.name)==="solver"),r=e.find(d=>(d==null?void 0:d.name)==="penalty"),i=!!(s&&r&&Array.isArray(s.options)&&s.options.some(d=>(d==null?void 0:d.value)==="liblinear")&&Array.isArray(r.options)&&r.options.some(d=>(d==null?void 0:d.value)==="elasticnet")),l=new Set(["lbfgs","saga"]),u=new Set(["l2","none"]);return e.forEach(d=>{if(!(d!=null&&d.name))return;const f=new Map,p=_=>{if(_==null||typeof _=="number"&&!Number.isFinite(_))return;const v=typeof _=="object"?JSON.stringify(_):`${typeof _}:${String(_)}`;f.has(v)||f.set(v,ys(_))},h=t==null?void 0:t[d.name];if(i&&d.name==="solver")(Array.isArray(d.options)?d.options:[]).forEach(v=>{v!=null&&v.value&&l.has(String(v.value))&&p(v.value)}),!f.size&&typeof h=="string"&&l.has(h)&&p(h),f.size||l.forEach(v=>p(v));else if(i&&d.name==="penalty")(Array.isArray(d.options)?d.options:[]).forEach(v=>{v!=null&&v.value&&u.has(String(v.value))&&p(v.value)}),!f.size&&typeof h=="string"&&u.has(h)&&p(h),f.size||u.forEach(v=>p(v));else if(d.type==="number"){const _=_m(h),v=_m(d.min),y=_m(d.max);if(v!==null&&p(v),_!==null&&p(Jc(_,v,y)),y!==null&&p(y),f.size<=1&&_!==null){const b=_m(d.step);b!==null&&b>0?(p(Jc(_+b,v,y)),p(Jc(_-b,v,y))):(p(Jc(_*1.5,v,y)),p(Jc(_*.5,v,y)))}}else d.type==="boolean"?(p(!0),p(!1),typeof h=="boolean"&&p(h)):(d.type==="select"&&(d.options??[]).slice(0,6).forEach(_=>{(_==null?void 0:_.value)!==void 0&&p(_.value)}),typeof h=="string"&&h.trim().length&&p(h.trim()));const m=Array.from(f.values());m.length>0&&(n[d.name]=m)}),n},SF={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},eg=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,eu=e=>{if(!Ar(e))return{};const t=ys(e);return Ar(t)?(delete t[ri],delete t[ai],delete t[oi],t):{}},Sl=e=>eu(e),EF=(e,t,n)=>({id:eg(),label:e,config:Sl(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),no=e=>`Strategy ${e}`,Tj=e=>Ar(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},$j=e=>Ar(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const s=e[n];return t[n]=s===null?null:String(s),t},{}):{},CF=e=>{if(!Ar(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,ri)&&(t[ri]=ys(e[ri])),Object.prototype.hasOwnProperty.call(e,ai)&&(t[ai]=e[ai]),Object.prototype.hasOwnProperty.call(e,oi)&&(t[oi]=ys(e[oi])),t},kF=()=>({strategies:[],activeId:null,expandedIds:[]}),tg=e=>{var d;const t=kF();if(!Ar(e))return t;const n=e[ri];if(Array.isArray(n)){const f=new Set;n.forEach(p=>{if(!Ar(p))return;let h=typeof p.id=="string"?p.id.trim():"";(!h||f.has(h))&&(h=eg()),f.add(h);const m=typeof p.label=="string"?p.label.trim():"",_=m.length?m:no(t.strategies.length+1),v=Ar(p.config)?p.config:{},y={id:h,label:_,config:eu(v),searchSpaceTexts:Tj(p.searchSpaceTexts),searchSpaceFieldErrors:$j(p.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!p.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!p.searchSpaceManuallyCleared};t.strategies.push(y)})}const s=new Set(t.strategies.map(f=>f.id)),r=e[ai],i=typeof r=="string"?r.trim():"";t.activeId=i&&s.has(i)?i:((d=t.strategies[0])==null?void 0:d.id)??null;const l=e[oi],u=Array.isArray(l)?l.map(f=>typeof f=="string"?f.trim():"").filter(f=>!!f&&s.has(f)):[];return t.activeId&&!u.includes(t.activeId)&&u.push(t.activeId),t.expandedIds=Array.from(new Set(u)).sort(),t},Lj=e=>({id:e.id,label:e.label,config:Sl(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),MF=(e,t,n)=>{var u;const s=e.map((d,f)=>({id:typeof d.id=="string"&&d.id.trim().length?d.id:eg(),label:typeof d.label=="string"&&d.label.trim().length?d.label:no(f+1),config:eu(d.config),searchSpaceTexts:Tj(d.searchSpaceTexts),searchSpaceFieldErrors:$j(d.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!d.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!d.searchSpaceManuallyCleared})),r=new Set(s.map(d=>d.id)),i=typeof t=="string"&&r.has(t)?t:((u=s[0])==null?void 0:u.id)??null,l=Array.from(n??new Set).filter(d=>r.has(d));return i&&!l.includes(i)&&l.push(i),{strategies:s,activeId:i,expandedIds:Array.from(new Set(l)).sort()}},zj=(e,t)=>{var n;return t&&e.some(s=>s.id===t)?t:((n=e[0])==null?void 0:n.id)??""},Rj=(e,t)=>{const n=new Set(e.map(r=>r.id)),s=t.filter(r=>n.has(r));return!s.length&&e[0]&&s.push(e[0].id),new Set(s)},ym=e=>Qc(e),Dj=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const r of n)if(e[r]!==t[r])return!1;return!0},AF=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:r,cvConfig:i,draftConfigState:l,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:f,searchStrategyParameter:p,searchIterationsParameter:h,searchRandomStateParameter:m,scoringMetricParameter:_,setDraftConfigState:v,onSaveDraftConfig:y,onUpdateNodeData:b,currentStatus:w,currentProgress:E})=>{var yt,St,zr,or;const N=Ka(),j=Wi({mutationFn:Pw,onSuccess:()=>{N.invalidateQueries({queryKey:["hyperparameter-tuning-jobs"]})},onError:te=>{console.error("Failed to cancel job:",te),alert(te instanceof Error?te.message:"Failed to cancel job")}}),C=te=>{confirm("Are you sure you want to cancel this tuning job?")&&j.mutate(te)},[M,z]=x.useState(null),[D,k]=x.useState(null),[T,A]=x.useState(null),[O,R]=x.useState(0),[L,F]=x.useState(null),[B,q]=x.useState(!1),[I,U]=x.useState(null),[V,H]=x.useState(!1),G=((s==null?void 0:s.targetColumn)??"").trim(),W=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",J=(d==null?void 0:d.name)??"model_type",ee=(p==null?void 0:p.name)??"search_strategy",Z=(h==null?void 0:h.name)??"search_iterations",K=(m==null?void 0:m.name)??"search_random_state",X=(_==null?void 0:_.name)??"scoring_metric",Q=l==null?void 0:l[J],ne=typeof Q=="string"&&Q.trim().length?Q.trim():((r==null?void 0:r.modelType)??"").trim(),le=Is({queryKey:["model-hyperparameters",ne],queryFn:()=>Qd(ne),enabled:!!ne,staleTime:5*60*1e3}),ce=((yt=le.data)==null?void 0:yt.fields)??[],ie=((St=le.data)==null?void 0:St.defaults)??{},ge=x.useMemo(()=>{if(!ce.length)return new Set;const te=new Set;return ce.forEach(_e=>{_e!=null&&_e.name&&te.add(_e.name)}),te},[ce]),Re=!!(i!=null&&i.enabled),ze=(i==null?void 0:i.strategy)??"auto",me=typeof(i==null?void 0:i.folds)=="number"?i.folds:5,xe=!!(i!=null&&i.shuffle),Ce=(i==null?void 0:i.randomState)??null,Ae=x.useMemo(()=>{const te=[];return((p==null?void 0:p.options)??[]).forEach(_e=>{if(!_e||typeof _e.value!="string")return;const fe=_e.value.trim();if(!fe.length)return;const De=fe.toLowerCase();te.some(Me=>Me.toLowerCase()===De)||te.push(fe)}),te},[p]),Ve=x.useMemo(()=>Ae.length>0?[...Ae]:[...Xp],[Ae]),Se=pm(p==null?void 0:p.default,Ae),ht=pm(l==null?void 0:l[ee],Ae)??Se??Ve[0]??Xp[0],ye=l==null?void 0:l[Z];let Fe=null;if(typeof ye=="number"&&Number.isFinite(ye))Fe=Math.max(1,Math.floor(ye));else if(typeof ye=="string"){const te=Number(ye.trim());Number.isFinite(te)&&te>0&&(Fe=Math.max(1,Math.floor(te)))}const Qe=l==null?void 0:l[K];let tt=null;if(typeof Qe=="number"&&Number.isFinite(Qe))tt=Math.trunc(Qe);else if(typeof Qe=="string"){const te=Number(Qe.trim());Number.isFinite(te)&&(tt=Math.trunc(te))}const xt=typeof(h==null?void 0:h.default)=="number"&&Number.isFinite(h.default)?Math.max(1,Math.floor(h.default)):null,_t=typeof(m==null?void 0:m.default)=="number"&&Number.isFinite(m.default)?Math.trunc(m.default):null,Bt=typeof(l==null?void 0:l[X])=="string"?String(l[X]).trim():"",$e=Bt.length?Bt:null,Ie=x.useMemo(()=>to(l==null?void 0:l.baseline_hyperparameters),[l==null?void 0:l.baseline_hyperparameters]),Be=x.useMemo(()=>to(l==null?void 0:l.search_space),[l==null?void 0:l.search_space]),Ee=x.useMemo(()=>Qp(Be.value),[Be.value]),lt=Ie.value,Je=Ie.error,Ue=Ee.value,Rt=Be.error??Ee.error,Yt=x.useMemo(()=>Zp(lt,ge),[ge,lt]),bt=x.useMemo(()=>Jp(Ue,ge),[ge,Ue]),Ot=x.useMemo(()=>Object.keys(Yt).length,[Yt]),Pt=x.useMemo(()=>Object.keys(bt).length,[bt]),wt=Pt>0,[pt,rn]=x.useState({}),[Jt,tn]=x.useState({}),[Pe,Wt]=x.useState(!1),[mn,Fn]=x.useState(!1),Gt=x.useRef(null);if(!Gt.current){const te=tg(l);let De=te.strategies.length>0?te.strategies.map(Lj):[];const Me=zj(De,te.activeId),we=Rj(De,te.expandedIds);Me&&!we.has(Me)&&De.length&&we.add(Me);const ft=ym(te);Gt.current={strategies:De,activeId:Me,expanded:we,signature:ft}}const[jt,Bn]=x.useState(()=>Gt.current?Gt.current.strategies:[]),[ts,Hn]=x.useState(()=>new Set(Gt.current?Array.from(Gt.current.expanded):[])),[Sn,Un]=x.useState(()=>{var te;return((te=Gt.current)==null?void 0:te.activeId)??""}),ns=x.useRef(((zr=Gt.current)==null?void 0:zr.signature)??""),cn=x.useRef(null),Mn=x.useRef(null),Mt=x.useMemo(()=>jt.length?jt.find(_e=>_e.id===Sn)??jt[0]:null,[Sn,jt]),An=x.useMemo(()=>tg(l),[l]),hs=x.useMemo(()=>ym(An),[An]);x.useEffect(()=>{if(hs===ns.current)return;const te=An.strategies.length?An.strategies.map(Lj):[],_e=zj(te,An.activeId),fe=Rj(te,An.expandedIds);_e&&!fe.has(_e)&&te.length&&fe.add(_e),cn.current=null,Bn(te),Un(_e),Hn(fe),ns.current=hs},[hs,An,l]),x.useEffect(()=>{if(!jt.length)return;jt.some(_e=>_e.id===Sn)||Un(jt[0].id)},[Sn,jt]),x.useEffect(()=>{const te=MF(jt,Sn,ts),_e=ym(te);ns.current!==_e&&v(fe=>{const De=tg(fe),Me=ym(De);if(Me===_e)return ns.current=Me,fe??{};const we=fe?{...fe}:{};return te.strategies.length?we[ri]=te.strategies.map(ft=>({...ft,config:ys(ft.config),searchSpaceTexts:{...ft.searchSpaceTexts},searchSpaceFieldErrors:{...ft.searchSpaceFieldErrors}})):delete we[ri],te.activeId?we[ai]=te.activeId:delete we[ai],te.expandedIds.length?we[oi]=[...te.expandedIds]:delete we[oi],ns.current=_e,we})},[Sn,ts,v,jt]),x.useEffect(()=>{if(!Mt||cn.current===Mt.id)return;cn.current=Mt.id;const te=Sl(Mt.config);v(fe=>({...CF(fe),...te})),rn(Mt.searchSpaceTexts??{}),tn(Mt.searchSpaceFieldErrors??{}),Wt(Mt.hasAutoFilledSearchSpace??!1),Fn(Mt.searchSpaceManuallyCleared??!1);const _e=typeof(te==null?void 0:te[J])=="string"?String(te[J]):(r==null?void 0:r.modelType)??"";Mn.current=_e},[Mt,J,r==null?void 0:r.modelType,v]),x.useEffect(()=>{if(!Mt)return;const te=Sl(l),_e=JSON.stringify(te)!==JSON.stringify(Mt.config??{}),fe=!Dj(pt,Mt.searchSpaceTexts),De=!Dj(Jt,Mt.searchSpaceFieldErrors),Me=Mt.hasAutoFilledSearchSpace!==Pe,we=Mt.searchSpaceManuallyCleared!==mn;!_e&&!fe&&!De&&!Me&&!we||Bn(ft=>ft.map(st=>st.id!==Mt.id?st:{...st,config:te,searchSpaceTexts:{...pt},searchSpaceFieldErrors:{...Jt},hasAutoFilledSearchSpace:Pe,searchSpaceManuallyCleared:mn}))},[Mt,l,Pe,Jt,mn,pt]);const Qn=x.useCallback(()=>{const te=jt.length+1,_e=Sl(l),fe=new Set;jt.forEach(st=>{var dt;const Te=pm((dt=st.config)==null?void 0:dt[ee],Ve);Te&&fe.add(Te)});const De=Ve.find(st=>!fe.has(st))??ht,Me=ys(_e),we=Ar(Me)?Me:{};if(we[ee]=De,De==="random"||De==="optuna"){const st=Fe!==null?Fe:xt;st!==null?we[Z]=st:delete we[Z];const Te=tt!==null?tt:_t;Te!==null?we[K]=Te:delete we[K]}else delete we[Z],delete we[K];const ft=EF(no(te),we,{searchSpaceTexts:{...pt},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:Pe,searchSpaceManuallyCleared:mn});Bn(st=>[...st,ft]),Hn(st=>new Set([...st,ft.id])),cn.current=null,Un(ft.id)},[Ve,l,Pe,Fe,xt,tt,_t,mn,pt,ht,ee,Z,K,Bn,Un,Hn,jt]),qs=x.useCallback(te=>{Hn(_e=>{const fe=new Set(_e);return fe.has(te)?fe.delete(te):fe.add(te),fe})},[]),Vs=x.useCallback(te=>{!te||te===Sn||(cn.current=null,Un(te),Hn(_e=>{const fe=new Set(_e);return fe.add(te),fe}))},[Sn]),As=x.useCallback(te=>{let _e=null;Bn(fe=>{if(fe.length<=1)return fe;const De=fe.filter(we=>we.id!==te);if(!De.length)return fe;const Me=De.map((we,ft)=>({...we,label:no(ft+1)}));if(te===Sn){cn.current=null;const we=Me[0].id;_e=we,Un(we)}return Me}),Hn(fe=>{const De=new Set(fe);return De.delete(te),_e&&De.add(_e),De})},[Sn]),en=x.useMemo(()=>jt.map((te,_e)=>{var Kn,$s;const fe=te.config??{},De=fe==null?void 0:fe[J],Me=typeof De=="string"?De.trim():"",we=((Kn=f.find(yn=>yn.value===Me))==null?void 0:Kn.label)??Me,ft=fe==null?void 0:fe[ee],st=typeof ft=="string"?ft.trim():"",Te=($s=((p==null?void 0:p.options)??[]).find(yn=>yn.value===st))==null?void 0:$s.label,dt=fe==null?void 0:fe[X],ot=typeof dt=="string"?dt.trim():"",Vn=to(fe==null?void 0:fe.baseline_hyperparameters).error,fn=to(fe==null?void 0:fe.search_space),as=Qp(fn.value),pr=as.value?Object.keys(as.value).length:0,ir=as.value?Object.values(as.value).reduce((yn,Ls)=>yn+(Array.isArray(Ls)?Ls.length:0),0):0,lr=Vn!==null||Object.values(te.searchSpaceFieldErrors).some(yn=>!!yn);return{id:te.id,label:te.label||no(_e+1),modelLabel:we||"Select model",searchStrategyLabel:Te??(st||"Random search"),scoringLabel:ot||"Estimator default",parameterCount:pr,candidateCount:ir,hasErrors:lr}}),[f,J,X,p,ee,jt]);x.useEffect(()=>{const te=Mn.current;if(te===null){Mn.current=ne;return}te!==ne&&(Mn.current=ne,rn({}),tn({}),Wt(!1),Fn(!1))},[ne]),x.useEffect(()=>{!ne||!ce.length||rn(te=>{const _e={...te};let fe=!1;return ce.forEach(De=>{if(Jt[De.name])return;const Me=bt[De.name],we=Array.isArray(Me)&&Me.length>0?Me.map(ft=>Oj(De,ft)).join(", "):"";_e[De.name]!==we&&(_e[De.name]=we,fe=!0)}),fe?_e:te})},[bt,ce,ne,Jt]),x.useEffect(()=>{if(!ne||!ce.length||mn)return;if(wt){Pe||Wt(!0);return}if(Pe)return;const te=jF(ce,ie);Object.keys(te).length&&(Wt(!0),tn({}),rn(()=>{const _e={};return ce.forEach(fe=>{if(!te[fe.name])return;const De=te[fe.name].map(Me=>Oj(fe,Me)).filter(Me=>Me.length>0).join(", ");_e[fe.name]=De}),_e}),v(_e=>{const fe=_e?{..._e}:{};return fe.search_space=te,fe}))},[Pe,ie,ce,ne,wt,mn,v]);const[et,Qt]=x.useState($e??"");x.useEffect(()=>{Qt($e??"")},[$e]);const ss=x.useMemo(()=>SF[W==="regression"?"regression":"classification"],[W]),Ks=(_==null?void 0:_.label)??"Scoring metric",Os=(_==null?void 0:_.description)??"Pick the evaluation metric used to rank candidates.",Nt=x.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),vs=x.useMemo(()=>Object.values(Jt).some(te=>!!te),[Jt]),de=x.useCallback((te,_e)=>{ge.has(te)&&v(fe=>{const De={...fe},Me=to(fe==null?void 0:fe.baseline_hyperparameters).value??{},ft={...Zp(Me,ge)};return _e===void 0?delete ft[te]:ft[te]=_e,Object.keys(ft).length>0?De.baseline_hyperparameters=ft:delete De.baseline_hyperparameters,De})},[ge,v]),be=x.useCallback((te,_e)=>{rn(Me=>({...Me,[te.name]:_e}));const{values:fe,error:De}=NF(te,_e);tn(Me=>({...Me,[te.name]:De})),!De&&v(Me=>{const we={...Me},ft=to(Me==null?void 0:Me.search_space).value??{},Te={...Jp(ft,ge)};return fe.length>0?Te[te.name]=fe.map(dt=>ys(dt)):delete Te[te.name],Object.keys(Te).length>0?we.search_space=Te:delete we.search_space,we})},[ge,v]),qe=x.useCallback(te=>{de(te,void 0)},[de]),gt=x.useCallback(()=>{v(te=>{if(!te||!te.baseline_hyperparameters)return te??{};const _e={...te};return delete _e.baseline_hyperparameters,_e})},[v]),Le=x.useCallback(()=>{Fn(!0),Wt(!0),rn({}),tn({}),v(te=>{if(!te||!te.search_space)return te??{};const _e={...te};return delete _e.search_space,_e})},[v]),Lt=x.useCallback(te=>{Qt(te);const _e=te.trim();v(fe=>{const De={...fe};return _e.length>0?De.scoring_metric=_e:delete De.scoring_metric,De})},[v]),Tt=x.useCallback(te=>{if(!(te!=null&&te.name)||!ge.has(te.name))return null;const _e=`baseline-${e}-${te.name}`,fe=Yt[te.name],De=fe!==void 0,Me=ie==null?void 0:ie[te.name],we=te.label??te.name,ft=te.description,st=Me!==void 0?`Default: ${gm(Me)}`:"Default: estimator setting";let Te;if(te.type==="number"){const dt=typeof fe=="number"?String(fe):"";Te=a.jsx("input",{id:_e,type:"number",className:"canvas-modal__parameter-input",value:dt,onChange:ot=>{const zt=ot.target.value;if(!zt.length){qe(te.name);return}const Vn=Number(zt);Number.isFinite(Vn)&&de(te.name,Vn)},min:te.min,max:te.max,step:te.step,placeholder:"Leave blank to use default"})}else if(te.type==="select"){const dt=De?String(fe):"";Te=a.jsxs("select",{id:_e,className:"canvas-modal__parameter-select",value:dt,onChange:ot=>{const zt=ot.target.value;if(!zt.length){qe(te.name);return}de(te.name,zt)},children:[a.jsx("option",{value:"",children:"Use default"}),(te.options??[]).map(ot=>a.jsx("option",{value:String(ot.value),children:ot.label},String(ot.value)))]})}else if(te.type==="boolean"){const dt=De?fe?"true":"false":"";Te=a.jsxs("select",{id:_e,className:"canvas-modal__parameter-select",value:dt,onChange:ot=>{const zt=ot.target.value;if(!zt.length){qe(te.name);return}de(te.name,zt==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const dt=typeof fe=="string"?fe:"";Te=a.jsx("input",{id:_e,type:"text",className:"canvas-modal__parameter-input",value:dt,onChange:ot=>{const zt=ot.target.value;if(!zt.length){qe(te.name);return}de(te.name,zt)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:_e,className:"canvas-modal__parameter-label",children:[we,ft&&a.jsx("span",{className:"canvas-modal__parameter-description",children:ft})]}),Te,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:De?`Override: ${gm(fe)}`:st})})]},te.name)},[ge,Yt,ie,e,de]),an=x.useCallback(te=>{if(!(te!=null&&te.name)||!ge.has(te.name))return null;const _e=`search-${e}-${te.name}`,fe=pt[te.name]??"",De=bt[te.name],Me=Array.isArray(De)?De.length:0,we=Jt[te.name],ft=ie==null?void 0:ie[te.name],st=te.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":te.type==="boolean"?"Enter true/false values, separated by commas or new lines":te.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",Te=Array.isArray(De)?De.slice(0,3).map(dt=>gm(dt)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:_e,className:"canvas-modal__parameter-label",children:[te.label??te.name,te.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:te.description})]}),a.jsx("textarea",{id:_e,className:"canvas-modal__parameter-input",rows:3,value:fe,onChange:dt=>be(te,dt.target.value),placeholder:st,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Me>0?`Configured ${Me} value${Me===1?"":"s"}${Te?` (${Te}${Me>3?"":""})`:""}`:`Default: ${gm(ft)}`})}),we&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:we})]},te.name)},[ge,bt,be,ie,e,Jt,pt]),hn=x.useMemo(()=>{if(!wt)return{parameterCount:0,candidateProduct:null};const te=Object.values(bt),_e=te.length;let fe=null;if(te.length>0){let De=1,Me=!1;te.forEach(we=>{De*=Math.max(we.length,1),(!Number.isFinite(De)||De>1e6)&&(Me=!0)}),fe=Me?null:De}return{parameterCount:_e,candidateProduct:fe}},[bt,wt]),Ct=x.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),On=x.useCallback(te=>{if(!Ct)return null;const _e=ys(Ct);if(!_e||!Array.isArray(_e.nodes))return Ct;const fe=eu(te),De=Object.keys(fe).length>0;return _e.nodes=_e.nodes.map(Me=>{if(!Me||Me.id!==e)return Me;const we=(Me==null?void 0:Me.data)??{},ft=(we==null?void 0:we.config)??{},st=eu(ft),Te=De?{...st,...fe}:st;return{...Me,data:{...we,config:Te,isConfigured:!0}}}),_e},[Ct,e]),sr=x.useMemo(()=>{const te=On(l);return te||Ct},[l,Ct,On]),Tn=x.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const te=n.nodes,_e=n.edges;return(()=>{var ft;const we=te.find(st=>(st==null?void 0:st.id)===e);return we?Aj((ft=we==null?void 0:we.data)==null?void 0:ft.connectedSplits):[]})().includes("validation")||_e.some(we=>!we||(typeof we.target=="string"?we.target:null)!==e?!1:(typeof we.sourceHandle=="string"?we.sourceHandle.toLowerCase():"").includes("validation"))?!0:_e.some(we=>{var ot;if(!we||(typeof we.target=="string"?we.target:null)!==e)return!1;const st=typeof we.source=="string"?we.source:null;if(!st)return!1;const Te=te.find(zt=>(zt==null?void 0:zt.id)===st);return Te?Aj((ot=Te==null?void 0:Te.data)==null?void 0:ot.activeSplits).includes("validation"):!1})?!1:null},[n,e]);x.useEffect(()=>{let te=!1;return!t||!Ct?(F(null),()=>{te=!0}):(ti(t,Ct).then(_e=>{te||F(_e)}).catch(()=>{te||F(null)}),()=>{te=!0})},[Ct,t]),x.useEffect(()=>{let te=!1;k(null);const _e=sr??Ct;return!t||!_e?(z(null),()=>{te=!0}):(ti(t,_e).then(fe=>{te||z(fe)}).catch(fe=>{te||(k((fe==null?void 0:fe.message)??"Unable to compute pipeline ID"),z(null))}),()=>{te=!0})},[Ct,sr,t]),x.useEffect(()=>{if(!M||!L){q(!1);return}q(M!==L)},[M,L]);const qn=!!(t&&e),Ys=x.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",M??"pending",e],[e,M,t]),$n=Is({queryKey:Ys,queryFn:async()=>{var _e;const te={datasetSourceId:t||void 0,nodeId:e,limit:5};if(M){const fe=await ei({...te,pipelineId:M});if((((_e=fe==null?void 0:fe.jobs)==null?void 0:_e.length)??0)>0)return fe}return ei(te)},enabled:qn,retry:(te,_e)=>_e.message.includes("Sign in")?!1:te<2,refetchInterval:te=>{const _e=te.state.data;return((_e==null?void 0:_e.jobs)??[]).some(Me=>Me.status==="queued"||Me.status==="running")?1e3:!1}}),{mutateAsync:rs,isPending:Qr,error:Ts}=Wi({mutationFn:Dw,onSuccess:te=>{const _e=Array.isArray(te.jobs)?te.jobs.length:0,fe=_e>0?te.jobs[0]:null;A(fe),R(_e),N.invalidateQueries({queryKey:Ys}),fe&&b&&b(e,{backgroundExecutionStatus:"loading"})}});x.useEffect(()=>{var we;if(!$n.data||!b)return;const te=$n.data.jobs??[];if(te.length===0)return;const _e=te[0],fe=(we=_e.status)==null?void 0:we.toLowerCase();let De="idle";fe==="running"||fe==="queued"?De="loading":fe==="succeeded"?De="success":(fe==="failed"||fe==="cancelled")&&(De="error");const Me=typeof _e.progress=="number"?_e.progress:void 0;(De!==w||Me!==void 0&&Me!==E)&&b(e,{backgroundExecutionStatus:De,progress:Me})},[$n.data,b,e,w,E]);const It=x.useMemo(()=>{const te=[];return t||te.push("Select a dataset before launching tuning jobs."),(!Ct||!Ct.nodes.length)&&te.push("Connect this node to an upstream pipeline before tuning."),G||te.push("Set a target column before tuning."),Tn===!1&&te.push("Connect the validation split to this node to enable tuning."),ne||te.push("Choose a model type before enqueuing tuning jobs."),jt.length===0&&te.push("Add a tuning strategy before launching tuning jobs."),wt||te.push("Define at least one hyperparameter in the search space."),Je&&te.push(Je),Rt&&te.push(Rt),vs&&te.push("Resolve invalid candidate values in the search space."),(ht==="random"||ht==="optuna")&&!Fe&&te.push("Provide the maximum iterations for random or Optuna search."),Re&&me<2&&te.push("Cross-validation requires at least 2 folds."),D&&te.push(D),te},[Je,Re,me,Ct,wt,vs,ne,D,Fe,Rt,ht,t,G,Tn,jt.length]),$r=((or=$n.data)==null?void 0:or.jobs)??[],Zr=$n.isLoading||$n.isFetching,Ca=$n.error,Il=x.useMemo(()=>!!(Ts instanceof Error&&bl(Ts.message)||I&&bl(I)||T&&Gc(T)||$r.some(te=>Gc(te))),[I,Ts,T,$r]),Lr=hj({graph:n,nodeId:e,modelType:ne,problemType:W,modelTypeOptions:f,enabled:Il});x.useEffect(()=>{Lr||H(!1)},[Lr]);const Fl=It.length>0||vs||!M||!t||!Ct||jt.length===0||!wt||Qr,Jr=x.useMemo(()=>d?f.length?{...d,options:f}:d:null,[f,d]),ea=x.useCallback(async()=>{if(!M||!t||!Ct||jt.length===0)return;if(y){try{const Me=y({closeModal:!1});q(!1),Me&&typeof Me.then=="function"&&await Me}catch{}await new Promise(Me=>setTimeout(Me,100))}const te=async()=>{const Me=[],we=[],ft=async st=>{if(!st)return new Set;if(st===ne)return ge;const Te=["model-hyperparameters",st],dt=N.getQueryData(Te),ot=zt=>{const Vn=new Set;return(zt??[]).forEach(fn=>{fn!=null&&fn.name&&Vn.add(fn.name)}),Vn};if(dt)return ot(dt.fields);try{const zt=await N.fetchQuery({queryKey:Te,queryFn:()=>Qd(st)});return ot(zt==null?void 0:zt.fields)}catch{return new Set}};for(let st=0;st<jt.length;st+=1){const Te=jt[st],dt=Te.label||no(st+1),ot=Sl(Te.config),zt=ot==null?void 0:ot[J],Vn=typeof zt=="string"&&zt.trim().length?zt.trim():ne;if(!Vn){we.push(`${dt} is missing a model selection.`);continue}const fn=pm(ot==null?void 0:ot[ee],Ve)??Se??"random",as=await ft(Vn),ir=to(ot==null?void 0:ot.baseline_hyperparameters).value??{},lr=as.size>0?Zp(ir,as):ys(ir),Kn=to(ot==null?void 0:ot.search_space);if(Kn.error){we.push(`${dt} has invalid search space: ${Kn.error}`);continue}const $s=Qp(Kn.value);if($s.error){we.push(`${dt} has invalid search space: ${$s.error}`);continue}const yn=$s.value??{},Ls=as.size>0?Jp(yn,as):ys(yn);if(!Ls||Object.keys(Ls).length===0){we.push(`${dt} requires at least one hyperparameter in the search space.`);continue}if(Object.values(Te.searchSpaceFieldErrors??{}).some(En=>!!En)){we.push(`${dt} has search space entries that need attention.`);continue}const ta=Object.keys(Ls).length;let Rr=null;if(ta>0){let En=1,xs=!1;Object.values(Ls).forEach(zs=>{const mu=Array.isArray(zs)?zs.length:0;En*=Math.max(mu,1),(!Number.isFinite(En)||En>1e6)&&(xs=!0)}),Rr=xs?null:En}const _i=ot==null?void 0:ot[X],os=typeof _i=="string"?_i.trim():"",gr=os.length?os:null,yi=()=>{const En=ot==null?void 0:ot[Z];let xs=null;if(typeof En=="number"&&Number.isFinite(En))xs=Math.max(1,Math.floor(En));else if(typeof En=="string"){const zs=Number(En.trim());Number.isFinite(zs)&&zs>0&&(xs=Math.max(1,Math.floor(zs)))}return xs===null&&(fn==="random"||fn==="optuna")?xt!==null?xt:null:xs},ka=()=>{const En=ot==null?void 0:ot[K];let xs=null;if(typeof En=="number"&&Number.isFinite(En))xs=Math.trunc(En);else if(typeof En=="string"){const zs=Number(En.trim());Number.isFinite(zs)&&(xs=Math.trunc(zs))}return xs===null&&(fn==="random"||fn==="optuna")?_t!==null?_t:null:xs},vi=yi(),Ma=ka(),Ln={};G&&(Ln.target_column=G),Ln.problem_type=W,Ln.strategy_id=Te.id,Ln.strategy_label=dt,Ln.strategy_index=st+1,Ln.search_strategy=fn,vi!==null&&(fn==="random"||fn==="optuna")&&(Ln.max_iterations=vi),gr&&(Ln.scoring_metric=gr),Ma!==null&&(Ln.random_state=Ma),Ln.search_space_keys=Object.keys(Ls),ta>0&&(Ln.search_space_parameters=ta),Rr!==null&&(Ln.search_space_candidates=Rr),Ln.cross_validation={enabled:Re,strategy:ze,folds:me,shuffle:xe,random_state:Ce};const na=On(ot)??Ct;if(!na){we.push(`Unable to build pipeline graph for ${dt}.`);continue}const po=lr&&Object.keys(lr).length>0?ys(lr):void 0,Bl=ys(Ls),xi={dataset_source_id:t,pipeline_id:M,node_id:e,model_type:Vn,model_types:[Vn],search_strategy:fn,search_space:Bl,baseline_hyperparameters:po,n_iterations:fn==="random"||fn==="optuna"?vi??void 0:void 0,scoring:gr??void 0,random_state:Ma??void 0,cross_validation:{enabled:Re,strategy:ze,folds:me,shuffle:xe,random_state:Ce},metadata:Ln,job_metadata:Ln,run_tuning:!0,graph:na,target_node_id:e};Me.push({payload:xi,label:dt})}return{plans:Me,issues:we}};U(null);const{plans:_e,issues:fe}=await te();if(!_e.length){fe.length&&U(fe.join(" "));return}const De=[];for(const{payload:Me}of _e)try{const we=await rs(Me);Array.isArray(we==null?void 0:we.jobs)&&we.jobs.length&&De.push(...we.jobs)}catch(we){we instanceof Error&&we.message?U(we.message):U("Failed to enqueue one or more tuning jobs.");return}if(De.length){const Me=De[De.length-1];A(Me),R(De.length)}},[ge,Re,me,Ce,xe,ze,rs,Ct,On,ne,J,e,y,Se,N,M,W,X,xt,Z,_t,K,ee,U,q,t,jt,G]),rr=x.useCallback(()=>{qn&&$n.refetch()},[qn,$n]),ar=te=>{var pr,ir,lr,Kn,$s;const _e=xF[te.status]??te.status,De=(((pr=f.find(yn=>yn.value===te.model_type))==null?void 0:pr.label)??te.model_type??"").trim(),Me=(()=>{switch(te.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"halving_random":return"Successive halving (randomized)";case"optuna":return"Optuna search";default:return"Random search"}})(),we=te.updated_at?Xn(te.updated_at):null,ft=te.updated_at||te.created_at,st=ft?we??new Date(ft).toLocaleString():null,Te=typeof te.error_message=="string"?te.error_message.trim():"",dt=[];De&&dt.push(`Model ${De}`),dt.push(Me),Array.isArray(te.results)&&te.results.length>0&&dt.push(`${te.results.length} candidates`);const ot=typeof te.best_score=="number"&&Number.isFinite(te.best_score)?te.best_score:typeof((ir=te.metrics)==null?void 0:ir.best_score)=="number"?te.metrics.best_score:null;ot!==null&&dt.push(`Best score ${bF(ot)}`);const zt=String(((lr=te.metrics)==null?void 0:lr.scoring)??((Kn=te.metrics)==null?void 0:Kn.scorer)??(($s=te.metadata)==null?void 0:$s.scoring_metric)??"").trim();if(zt&&dt.push(`Scoring ${zt}`),te.status==="failed"&&Te){const yn=Te.replace(/\s+/g," ");dt.push(`Error: ${yn}`)}st&&dt.push(`Updated ${st}`);const Vn=te.status==="running"||te.status==="queued",fn=te.progress??0,as=te.current_step;return a.jsxs("li",{style:{display:"flex",flexDirection:"column",gap:"4px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[a.jsxs("span",{children:[a.jsxs("strong",{children:["Run ",te.run_number]}),"  ",_e]}),Vn&&a.jsx("button",{type:"button",onClick:yn=>{yn.stopPropagation(),C(te.id)},disabled:j.isPending,title:"Cancel this job (may not be immediate on Windows)",style:{padding:"2px 8px",fontSize:"0.75rem",fontWeight:500,color:"#b91c1c",background:"#fee2e2",border:"1px solid #fca5a5",borderRadius:"4px",cursor:"pointer"},children:"Cancel"})]}),Vn&&a.jsxs("span",{style:{fontSize:"0.85em",color:"#666"},children:[fn,"% ",as?` ${as}`:""]})]}),Vn&&a.jsx("div",{style:{width:"100%",height:"4px",backgroundColor:"#eee",borderRadius:"2px",overflow:"hidden"},children:a.jsx("div",{style:{width:`${fn}%`,height:"100%",background:"linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%)",transition:"width 0.3s ease"}})}),a.jsx("div",{style:{fontSize:"0.9em",color:"#666"},children:dt.length?dt.join("  "):""})]},te.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Qn,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:rr,disabled:!qn||Zr,children:Zr?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),M&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:M})]}),B&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0",display:"flex",alignItems:"start",gap:"0.5rem"},children:[a.jsx(ga,{size:16,style:{marginTop:"2px",flexShrink:0}}),a.jsxs("span",{children:[a.jsx("strong",{children:"Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]})]}),It.map((te,_e)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:te},`tuning-prereq-${_e}`)),Ts instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Ts.message}),I&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:I}),Ca&&!(Ts instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Ca.message||"Unable to load tuning jobs."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:O>1?a.jsxs("span",{children:["Queued ",O," tuning jobs. Latest job ",T.id," (run ",T.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",T.id," queued (run ",T.run_number,")."]})}),wt&&hn.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",hn.parameterCount," hyperparameter",hn.parameterCount===1?"":"s",hn.candidateProduct!==null?`  up to ${hn.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsxs("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:[jt.length===0&&a.jsx("p",{style:{margin:"0",padding:"1rem 1.25rem",border:"1px dashed rgba(148, 163, 184, 0.4)",borderRadius:"6px",color:"rgba(148, 163, 184, 0.85)",background:"rgba(15, 23, 42, 0.35)"},children:'No tuning strategies configured yet. Use "Add strategy" to define your search plan.'}),jt.map((te,_e)=>{const fe=en[_e],De=!!(Mt&&Mt.id===te.id),Me=ts.has(te.id),we=[];if(fe!=null&&fe.modelLabel&&we.push(fe.modelLabel),fe!=null&&fe.searchStrategyLabel&&we.push(fe.searchStrategyLabel),fe!=null&&fe.scoringLabel&&we.push(`Scoring ${fe.scoringLabel}`),fe!=null&&fe.parameterCount){const st=fe.candidateCount?`${fe.parameterCount} param${fe.parameterCount===1?"":"s"}  ${fe.candidateCount} candidate${fe.candidateCount===1?"":"s"}`:`${fe.parameterCount} param${fe.parameterCount===1?"":"s"}`;we.push(st)}else we.includes("Needs attention")||we.push("No search values");fe!=null&&fe.hasErrors&&we.push("Needs attention");const ft=we.length>0?we.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{qs(te.id),De||Vs(te.id)},"aria-expanded":Me,"aria-controls":`tuning-strategy-body-${te.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${Me?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(fe==null?void 0:fe.label)??no(_e+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:ft})]})]}),jt.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>As(te.id),"aria-label":`Remove ${(fe==null?void 0:fe.label)??no(_e+1)}`,children:"Remove"})]}),Me&&De&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${te.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Jr&&u(Jr),p&&u(p),(ht==="random"||ht==="optuna")&&h&&u(h),(ht==="random"||ht==="optuna")&&m&&u(m)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:Ks}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Os}),a.jsxs("div",{id:Nt,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:et||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[ss.map(st=>a.jsx("button",{type:"button",onClick:()=>Lt(st.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:et===st.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:et===st.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:st.label},st.value)),a.jsx("button",{type:"button",onClick:()=>Lt(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),ne&&ce.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Ot>0?`${Ot} override${Ot===1?"":"s"} configured`:"Using template defaults"}),Ot>0&&a.jsx("button",{type:"button",onClick:gt,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),Je&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Je}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:ce.map(Tt)})]}),ne&&ce.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Pt>0?`${Pt} parameter${Pt===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:Le,disabled:Pt===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Pt===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:Pt===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:Pt===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),Rt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Rt}),vs&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:ce.map(an)})]})]})]},te.id)})]}),Re&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",me," folds before reporting aggregate metrics."]}),Lr&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"start"},children:[a.jsx(ga,{size:16,style:{marginTop:"2px",flexShrink:0}}),a.jsxs("div",{children:[a.jsx("strong",{children:Lr.headline}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:Lr.summary})]})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>H(te=>!te),style:{whiteSpace:"nowrap"},children:V?"Hide tips":"Show tips"})]}),V&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:Lr.details.map((te,_e)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:te},`tuning-scaling-tip-${_e}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:ea,disabled:Fl,children:Qr?"Queuing":"Launch tuning job"})}),Zr&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!Zr&&$r.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),$r.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:$r.map(ar)})]})},ng={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},OF=(e,t)=>{if(e==null||e==="")return ng[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return ng[t].auto;const s=Math.max(Math.min(e,1),0),r=s*100,i=s.toFixed(s>=.1||s===0?2:3),l=t==="undersampling"?"majority":"majority baseline";return`${i} ratio (${r.toFixed(1)}% of ${l})`}const n=e.trim().toLowerCase();return ng[t][n]??n},TF=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let s=e.length-1;s>=0;s-=1){const r=e[s];if(typeof r!="string")continue;const i=r.toLowerCase();if(n.some(l=>i.includes(l)))return r}return null},$F=(e,t)=>t?"Missing":e.length?e:"Empty string",LF=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:r,config:i,methodParameter:l,targetColumnParameter:u,samplingStrategyParameter:d,randomStateParameter:f,replacementParameter:p,kNeighborsParameter:h,renderParameterField:m,formatMetricValue:_,formatMissingPercentage:v,schemaGuard:y,onPendingConfigurationWarning:b,onPendingConfigurationCleared:w})=>{var W,J,ee;x.useEffect(()=>{var K,X;if(!((X=(K=s.data)==null?void 0:K.signals)!=null&&X.full_execution)){w==null||w();return}const Z=At(s.data.signals.full_execution);Z.length>0?b==null||b(Z):w==null||w()},[(J=(W=s.data)==null?void 0:W.signals)==null?void 0:J.full_execution,b,w]);const E=s.data,N=s.status,j=Array.isArray(E==null?void 0:E.applied_steps)?E==null?void 0:E.applied_steps:[],C=x.useMemo(()=>TF(j,e),[j,e]),M=(i==null?void 0:i.targetColumn)??"",z=(i==null?void 0:i.method)||(typeof(l==null?void 0:l.default)=="string"?l.default:""),D=x.useMemo(()=>{const Z=Array.isArray(l==null?void 0:l.options)?l==null?void 0:l.options:[];if(z){const K=Z.find(X=>X.value===z);return K!=null&&K.label?K.label:z.replace(/_/g," ")}return Z.length>0?Z[0].label??Z[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[z,l==null?void 0:l.options,e]),k=x.useMemo(()=>OF(i==null?void 0:i.samplingStrategy,e),[i==null?void 0:i.samplingStrategy,e]),T=x.useMemo(()=>(i==null?void 0:i.randomState)===null||(i==null?void 0:i.randomState)===void 0?"Not set":Number.isFinite(i.randomState)?String(i.randomState):"Not set",[i==null?void 0:i.randomState]),A=x.useMemo(()=>{if(e!=="oversampling")return null;const Z=i==null?void 0:i.kNeighbors;if(typeof Z=="number"&&Number.isFinite(Z))return String(Math.max(1,Math.round(Z)));if(h&&typeof h.default=="number"){const K=h.default;if(Number.isFinite(K))return String(Math.max(1,Math.round(K)))}return"Default"},[i==null?void 0:i.kNeighbors,h,e]),O=(i==null?void 0:i.replacement)===null||(i==null?void 0:i.replacement)===void 0?null:i.replacement?"With replacement":"Without replacement",R=x.useMemo(()=>{if(N!=="success"||!E||!M)return{rows:[],total:0,truncated:!1};const Z=Array.isArray(E.sample_rows)?E.sample_rows:[];if(!Z.length)return{rows:[],total:0,truncated:!1};const K=new Map;Z.forEach(ge=>{if(!ge||typeof ge!="object")return;const Re=ge[M],ze=Re==null,me=ze?"__missing__":String(Re),xe=$F(ze?"":me,ze),Ce=K.get(me);Ce?Ce.count+=1:K.set(me,{label:xe,count:1,percentage:0,isMissing:ze})});const X=Array.from(K.values()).sort((ge,Re)=>Re.count-ge.count),Q=X.reduce((ge,Re)=>ge+Re.count,0),ne=8,le=X.length>ne;return{rows:(le?X.slice(0,ne):X).map(ge=>({...ge,percentage:Q>0?ge.count/Q*100:0})),total:Q,truncated:le}},[E,N,M]),L=((ee=E==null?void 0:E.metrics)==null?void 0:ee.row_count)??null,F=!!t&&n&&N!=="loading"&&!(y!=null&&y.blocked),B=x.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),q=x.useMemo(()=>!(y!=null&&y.blocked)||!y.details.length?"":y.details.map(Z=>Z.logical_family?`${Z.name} (${Z.logical_family})`:Z.name).join(", "),[y]),I=!M,U=!!M&&Array.isArray(E==null?void 0:E.columns)&&!(E!=null&&E.columns.includes(M)),V=e==="undersampling"?"Class undersampling":"Class oversampling",H=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",G=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:V}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:r,disabled:!F,children:N==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:H}),B&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:B}),I&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",G,"."]}),(y==null?void 0:y.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[y.message,q&&a.jsxs(a.Fragment,{children:[" ","Columns: ",q,"."]})]}),N==="error"&&s.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),U&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",M," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:C}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:D})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:k})]}),e==="oversampling"&&A&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:A})]}),O&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:O})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:T})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[l&&m(l),d&&m(d),e==="oversampling"&&h&&m(h),f&&m(f),p&&m(p)]}),u&&a.jsx("div",{className:"canvas-modal__parameter-list",children:m(u)}),M&&N==="success"&&!U&&(R.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:R.rows.map(Z=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:Z.label}),a.jsx("td",{children:_(Z.count)}),a.jsx("td",{children:v(Z.percentage)})]},`resampling-class-${Z.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",_(R.total)," row",R.total===1?"":"s"," from the preview.",R.truncated?" Showing top classes by frequency.":""]}),L!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",_(L),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},zF=["int","float","double","numeric","number"],Pj=e=>{if(!e)return!1;const t=e.toLowerCase();return zF.some(n=>t.includes(n))},RF=({catalogFlags:e,skewnessData:t,skewnessTransformations:n,availableColumns:s,previewColumns:r,columnTypeMap:i,updateSkewnessTransformations:l})=>{const{isSkewnessNode:u,isSkewnessDistributionNode:d}=e,f=u||d,[p,h]=x.useState("recommended"),[m,_]=x.useState(!1),[v,y]=x.useState("before"),b=n.length,w=x.useMemo(()=>t!=null&&t.methods?[...t.methods]:[],[t==null?void 0:t.methods]),E=x.useMemo(()=>HR(w),[w]),N=x.useMemo(()=>t!=null&&t.columns?[...t.columns]:[],[t==null?void 0:t.columns]),j=x.useMemo(()=>{const V=new Map;return N.forEach(H=>{H&&H.column&&V.set(H.column,H)}),V},[N]),C=x.useMemo(()=>{const V=new Set;return N.forEach(H=>{H!=null&&H.column&&V.add(H.column)}),s.forEach(H=>{H&&Pj(i[H]??null)&&V.add(H)}),r.forEach(H=>{const G=typeof H=="string"?H.trim():"";G&&Pj(i[G]??null)&&V.add(G)}),Array.from(V).sort((H,G)=>H.localeCompare(G))},[s,r,N,i]);x.useEffect(()=>{p==="recommended"&&N.length===0&&C.length>0&&h("all")},[C.length,N.length,p]);const M=(t==null?void 0:t.skewness_threshold)??null,z=x.useCallback(V=>E[V]??V,[E]),D=x.useCallback((V,H)=>{const G=j.get(V);return!G||!G.method_status?{status:"ready",reason:void 0}:G.method_status[H]??{status:"ready",reason:void 0}},[j]),k=x.useCallback(()=>{const V=N.map(H=>{if(!H||!H.column)return null;const G=Array.isArray(H.recommended_methods)?H.recommended_methods.find(ya):void 0;return G?{column:H.column,method:G}:null}).filter(H=>!!H);V.length&&l(H=>{const G=new Map;return H.forEach(W=>{const J=typeof W.column=="string"?W.column.trim():"";J&&ya(W.method)&&G.set(J,W.method)}),V.forEach(W=>{const J=typeof W.column=="string"?W.column.trim():"";J&&G.set(J,W.method)}),Array.from(G.entries()).map(([W,J])=>({column:W,method:J}))})},[N,l]),T=x.useMemo(()=>{const V=new Map;return n.forEach(H=>{const G=typeof H.column=="string"?H.column.trim():"";!G||V.has(G)||V.set(G,H.method)}),V},[n]),A=x.useCallback((V,H)=>{const G=typeof V=="string"?V.trim():"";G&&l(W=>{const J=W.filter(ee=>ee.column!==G);return H?[...J,{column:G,method:H}]:J})},[l]),O=x.useCallback((V,H)=>{if(V){if(!H){A(V,null);return}ya(H)&&A(V,H)}},[A]),R=x.useCallback(()=>{l(()=>[])},[l]),L=N.length,F=x.useMemo(()=>N.some(V=>V&&typeof V.column=="string"&&Array.isArray(V.recommended_methods)&&V.recommended_methods.some(ya)),[N]),B=C.length,q=x.useMemo(()=>UR({viewMode:p,recommendations:N,columnOptions:C,recommendationMap:j,transformationMap:T}),[p,N,C,j,T]),I=x.useMemo(()=>f?N.map(V=>{var ne;if(!V||!V.column)return null;const H=V.distribution_before??V.distribution??null;if(!H||!Array.isArray(H.bin_edges)||!Array.isArray(H.counts)||H.counts.length===0||H.bin_edges.length!==H.counts.length+1)return null;let G=V.distribution_after??null;G&&(!Array.isArray(G.bin_edges)||!Array.isArray(G.counts)||G.counts.length===0||G.bin_edges.length!==G.counts.length+1)&&(G=null);const W=((ne=V.recommended_methods)==null?void 0:ne.find(ya))??null,J=V.magnitude?`${V.magnitude.charAt(0).toUpperCase()}${V.magnitude.slice(1)}`:null,ee=V.direction?Jw[V.direction]??V.direction:null,Z=V.applied_method&&ya(V.applied_method)?V.applied_method:null,K=T.get(V.column)??null,X=Z??K??null,Q=X?z(X):null;return{column:V.column,skewness:typeof V.skewness=="number"?V.skewness:null,magnitudeLabel:J,directionLabel:ee,summary:V.summary??null,recommendedLabel:Q?null:W?z(W):null,appliedLabel:Q,distributionBefore:H,distributionAfter:G}}).filter(V=>!!V).sort((V,H)=>{const G=V.skewness!==null?Math.abs(V.skewness):-1/0,W=H.skewness!==null?Math.abs(H.skewness):-1/0;return G!==W?W-G:V.column.localeCompare(H.column)}):[],[z,f,N,T]),U=x.useMemo(()=>qR(q,m,z),[q,m,z]);return{state:{threshold:M,viewMode:p,groupByMethod:m,distributionView:v,recommendedCount:L,numericCount:B,transformationsCount:b,hasAutoRecommendations:F,rows:q,tableGroups:U,distributionCards:I},handlers:{setViewMode:h,setGroupByMethod:_,setDistributionView:y,getMethodLabel:z,getMethodStatus:D,applyRecommendations:k,handleOverrideChange:O,clearTransformations:R}}},DF=({catalogFlags:e,imputerStrategies:t,availableColumns:n,columnMissingMap:s,previewColumns:r,previewColumnStats:i,nodeColumns:l,imputerMissingFilter:u})=>{const{isImputerNode:d}=e,f=x.useMemo(()=>{if(!d)return[];const _=r.length?new Set(r.map(j=>typeof j=="string"?j.trim():"").filter(j=>j.length>0)):null,v=new Set;t.forEach(j=>{j.columns.forEach(C=>{const M=typeof C=="string"?C.trim():"";M&&v.add(M)})}),at(l).forEach(j=>{j&&v.add(j)});const y=j=>!_||_.size===0?!1:!_.has(j)&&!v.has(j),b=new Map,w=(j,C)=>{const M=typeof j=="string"?j.trim():"";if(!M||y(M))return;const z=b.get(M)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};C&&(typeof C.missingPercentage=="number"&&!Number.isNaN(C.missingPercentage)&&(z.missingPercentage=Math.max(0,C.missingPercentage)),C.dtype!==void 0&&(z.dtype=C.dtype),typeof C.mean=="number"&&!Number.isNaN(C.mean)&&(z.mean=C.mean),typeof C.median=="number"&&!Number.isNaN(C.median)&&(z.median=C.median),C.mode!==void 0&&C.mode!==null&&C.mode!==""&&(z.mode=C.mode)),b.set(M,z)};n.forEach(j=>{const C=Object.prototype.hasOwnProperty.call(s,j)?s[j]:null;w(j,{missingPercentage:typeof C=="number"?C:null})}),(Array.isArray(i)?i:[]).forEach(j=>{!j||!j.name||w(j.name,{missingPercentage:typeof j.missing_percentage=="number"?j.missing_percentage:null,dtype:j.dtype??null,mean:typeof j.mean=="number"?j.mean:null,median:typeof j.median=="number"?j.median:null,mode:j.mode??null})}),at(l).forEach(j=>w(j)),t.forEach(j=>{j.columns.forEach(C=>w(C))});const N=Array.from(b.entries()).map(([j,C])=>({name:j,missingPercentage:typeof C.missingPercentage=="number"&&!Number.isNaN(C.missingPercentage)?Math.max(0,C.missingPercentage):null,dtype:C.dtype??null,mean:typeof C.mean=="number"&&!Number.isNaN(C.mean)?C.mean:null,median:typeof C.median=="number"&&!Number.isNaN(C.median)?C.median:null,mode:C.mode!==void 0&&C.mode!==null&&C.mode!==""?C.mode:null}));return N.sort((j,C)=>{const M=typeof j.missingPercentage=="number",z=typeof C.missingPercentage=="number";return M&&z&&j.missingPercentage!==C.missingPercentage?C.missingPercentage-j.missingPercentage:M!==z?M?-1:1:j.name.localeCompare(C.name)}),N},[n,s,t,l,i,r,d]),p=x.useMemo(()=>{if(!f.length)return 100;const _=f.reduce((y,b)=>{const w=typeof b.missingPercentage=="number"?b.missingPercentage:0;return w>y?w:y},0),v=Math.ceil(_/5)*5;return Math.max(100,v||0)},[f]),h=x.useMemo(()=>f.length?f.reduce((_,v)=>{const y=typeof v.missingPercentage=="number"?v.missingPercentage:null;return y!==null?y<=0?_:y>=u?_+1:_:u===0?_+1:_},0):0,[f,u]),m=u>0;return{imputerColumnOptions:f,imputerMissingSliderMax:p,imputerFilteredOptionCount:h,imputerMissingFilterActive:m}},PF=({suggestedThreshold:e,thresholdParameterName:t,configState:n,handleParameterChange:s})=>{const r=x.useMemo(()=>{if(e===null||Number.isNaN(Number(e)))return null;const d=Number(e);return Math.round(d*10)/10},[e]),i=x.useMemo(()=>{if(t===null||r===null)return!1;const d=Number(n==null?void 0:n[t]);return!Number.isNaN(d)&&d===r},[n,r,t]),l=r!==null&&!i,u=x.useCallback(()=>{r===null||!t||s(t,r)},[s,r,t]);return{normalizedSuggestedThreshold:r,thresholdMatchesSuggestion:i,canApplySuggestedThreshold:l,handleApplySuggestedThreshold:u}},IF=({catalogFlags:e,skewnessData:t,skewnessTransformations:n,availableColumns:s,previewColumns:r,columnTypeMap:i,updateSkewnessTransformations:l,imputerStrategies:u,columnMissingMap:d,previewColumnStats:f,nodeColumns:p,imputerMissingFilter:h,suggestedThreshold:m,thresholdParameterName:_,configState:v,handleParameterChange:y})=>{const b=RF({catalogFlags:e,skewnessData:t,skewnessTransformations:n,availableColumns:s,previewColumns:r,columnTypeMap:i,updateSkewnessTransformations:l}),w=DF({catalogFlags:e,imputerStrategies:u,availableColumns:s,columnMissingMap:d,previewColumns:r,previewColumnStats:f,nodeColumns:p,imputerMissingFilter:h}),E=PF({suggestedThreshold:m,thresholdParameterName:_,configState:v,handleParameterChange:y});return{skewness:b,imputationConfiguration:w,thresholdRecommendations:E}},FF=({graphSnapshot:e,nodeId:t,catalogFlags:n})=>{const{isDataset:s}=n,r=x.useMemo(()=>{if(!e)return null;const m=Array.isArray(e.nodes)?e.nodes:[],_=Array.isArray(e.edges)?e.edges:[];return{nodes:m,edges:_}},[e]),i=x.useMemo(()=>e&&Array.isArray(e.nodes)?e.nodes:[],[e]),l=x.useMemo(()=>e&&Array.isArray(e.edges)?e.edges:[],[e]),u=i.length,d=x.useMemo(()=>{if(!t||!l.length)return[];const m=new Set,_=[t];for(;_.length;){const y=_.pop();y&&l.forEach(b=>{const w=b&&typeof b.source=="string"?b.source.trim():"",E=b&&typeof b.target=="string"?b.target.trim():"";!w||!E||E===y&&!m.has(w)&&(m.add(w),_.push(w))})}const v=Array.from(m);return v.sort(),v},[l,t]),f=x.useMemo(()=>{var v,y,b,w,E;if(!d.length)return"";let m="",_="";for(const N of d){const j=i.find(M=>(M==null?void 0:M.id)===N);if(!j)continue;const C=String(((v=j==null?void 0:j.data)==null?void 0:v.catalogType)??"").toLowerCase().trim();if(C==="feature_target_split"){const M=(b=(y=j==null?void 0:j.data)==null?void 0:y.config)==null?void 0:b.target_column;typeof M=="string"&&M.trim()&&(m=M.trim())}else if(C==="train_test_split"){const M=(E=(w=j==null?void 0:j.data)==null?void 0:w.config)==null?void 0:E.target_column;typeof M=="string"&&M.trim()&&(_=M.trim())}}return m||_||""},[i,d]),p=x.useMemo(()=>{const m=new Set;return i.forEach(_=>{if(!_)return;const v=typeof _.id=="string"?_.id.trim():String((_==null?void 0:_.id)??"").trim();if(!v)return;const y=(_==null?void 0:_.data)??{};(v==="dataset-source"||(y==null?void 0:y.isDataset)===!0||(y==null?void 0:y.catalogType)==="dataset")&&m.add(v)}),m.size||m.add("dataset-source"),Array.from(m)},[i]),h=x.useMemo(()=>{if(!t)return!1;if(s)return!0;if(!l.length)return p.includes(t);const m=new Map;l.forEach(y=>{const b=y==null?void 0:y.source,w=y==null?void 0:y.target,E=typeof b=="string"?b.trim():String(b??"").trim(),N=typeof w=="string"?w.trim():String(w??"").trim();if(!E||!N)return;const j=m.get(E);j?j.push(N):m.set(E,[N])});const _=new Set,v=[...p];for(;v.length;){const y=v.pop();if(!y||_.has(y))continue;_.add(y);const b=m.get(y);b&&b.forEach(w=>{w&&!_.has(w)&&v.push(w)})}return _.has(t)},[p,l,s,t]);return{graphContext:r,graphNodes:i,graphEdges:l,graphNodeCount:u,upstreamNodeIds:d,upstreamTargetColumn:f,hasReachableSource:h}},BF=({configState:e,setConfigState:t,catalogFlags:n,upstreamTargetColumn:s,nodeId:r,modelTypeOptions:i})=>{const{isFeatureTargetSplitNode:l,isTrainTestSplitNode:u,isTrainModelDraftNode:d,isHyperparameterTuningNode:f,isClassOversamplingNode:p,isClassUndersamplingNode:h}=n,m=h||p,_=d||f,v=x.useMemo(()=>{if(!l)return null;const k=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",T=at(e==null?void 0:e.feature_columns).map(A=>typeof A=="string"?A.trim():"").filter(A=>!!A);return{targetColumn:k,featureColumns:T}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,l]),y=x.useMemo(()=>{if(!u)return null;const k=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,T=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,A=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,O=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,R=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,L=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:k,validation_size:T,random_state:A,shuffle:O,stratify:R,target_column:L}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,u]),b=x.useMemo(()=>{if(!m)return null;const k=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",T=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",A=e==null?void 0:e.sampling_strategy;let O=null;if(typeof A=="number"&&Number.isFinite(A))O=A;else if(typeof A=="string"){const q=A.trim();O=q||null}else A===null&&(O=null);const R=e==null?void 0:e.random_state;let L=null;if(typeof R=="number"&&Number.isFinite(R))L=R;else if(typeof R=="string"){const q=Number(R);L=Number.isFinite(q)?q:null}let F=null;if(h){const q=e==null?void 0:e.replacement;F=typeof q=="boolean"?q:typeof q=="string"?q.trim().toLowerCase()==="true":!!q}let B=null;if(p){const q=e==null?void 0:e.k_neighbors;if(typeof q=="number"&&Number.isFinite(q))B=Math.max(1,Math.round(q));else if(typeof q=="string"){const I=Number(q);Number.isFinite(I)&&(B=Math.max(1,Math.round(I)))}}return{method:k,targetColumn:T,samplingStrategy:O,randomState:L,replacement:F,kNeighbors:B}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,p,m,h]),w=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",E=w==="regression"?"regression":"classification",N=x.useMemo(()=>Array.isArray(i)?i.filter(k=>k&&typeof k.value=="string"):[],[i]),j=x.useMemo(()=>{const k={classification:[],regression:[]};return N.forEach(T=>{var O;const A=String(((O=T==null?void 0:T.metadata)==null?void 0:O.problem_type)??"").trim().toLowerCase();A==="regression"?k.regression.push(T):A==="classification"?k.classification.push(T):(k.classification.push(T),k.regression.push(T))}),k},[N]),C=x.useMemo(()=>{if(!N.length)return[];const k=E==="regression"?j.regression:j.classification;return k.length>0?k:N},[N,j,E]),M=x.useMemo(()=>_?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:E}:null,[e==null?void 0:e.target_column,_,E]),z=x.useMemo(()=>{if(!_)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const k=(e==null?void 0:e.cv_enabled)===void 0?!!f:!!e.cv_enabled,T=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",A=["auto","kfold","stratified_kfold"].includes(T)?T:"auto",O=Number(e==null?void 0:e.cv_folds),R=Number.isFinite(O)&&O>=2?Math.floor(O):5,L=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let F=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))F=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const I=Number(e.cv_random_state.trim());F=Number.isFinite(I)?Math.trunc(I):null}const q=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:k,strategy:A,folds:R,shuffle:L,randomState:F,refitStrategy:q}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,f,_]);x.useEffect(()=>{_&&w!==E&&t(k=>({...k,problem_type:E}))},[_,E,w,t]),x.useEffect(()=>{var O;if(!_||!C.length)return;const k=new Set(C.map(R=>R.value)),T=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if(T&&k.has(T))return;const A=((O=C[0])==null?void 0:O.value)??"";A&&t(R=>{const L=typeof(R==null?void 0:R.model_type)=="string"?R.model_type.trim():"";return L&&k.has(L)||L===A?R:{...R,model_type:A}})},[e==null?void 0:e.model_type,C,_,t]);const D=x.useMemo(()=>{if(!_)return null;const k=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",T=e==null?void 0:e.hyperparameters;let A=null,O=null;if(T&&typeof T=="string"){const R=T.trim();if(R.length)try{const L=JSON.parse(R);L&&typeof L=="object"&&!Array.isArray(L)?A=L:O="Hyperparameters JSON must be an object."}catch{O="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else T&&typeof T=="object"&&!Array.isArray(T)&&(A=T);return{modelType:k||null,hyperparameters:A,hyperparametersError:O}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,_]);return x.useEffect(()=>{(u||d||f)&&s&&(u&&(e==null?void 0:e.stratify)!==!0||t(k=>(typeof(k==null?void 0:k.target_column)=="string"?k.target_column.trim():"")?k:{...k,target_column:s}))},[e==null?void 0:e.stratify,f,d,u,r,t,s]),{featureTargetSplitConfig:v,trainTestSplitConfig:y,resamplingConfig:b,trainModelDraftConfig:M,trainModelRuntimeConfig:D,trainModelCVConfig:z,filteredModelTypeOptions:C}},HF=({nodeId:e,sourceId:t,configState:n,upstreamNodeIds:s,graphNodes:r})=>{const i=x.useMemo(()=>{if(!s.length)return{};const u={};return s.forEach(d=>{var h;const f=r.find(m=>m&&typeof m.id=="string"&&m.id===d);if(!f)return;const p=((h=f==null?void 0:f.data)==null?void 0:h.config)??null;u[d]=p}),u},[r,s]),l=x.useMemo(()=>Qc({sourceId:t??null,nodeId:e||null,config:n,upstreamIds:s,upstreamConfig:i}),[n,e,t,i,s]);return{upstreamConfigFingerprints:i,previewSignature:l}},UF=({cachedPreviewSchema:e,catalogFlags:t,resamplingTargetColumn:n,imputerStrategies:s})=>{const{isClassOversamplingNode:r,isImputerNode:i}=t,l=x.useMemo(()=>(e==null?void 0:e.columns)??[],[e]),u=x.useMemo(()=>{if(!r||!l.length||!n)return null;const p=new Set(["numeric","integer","boolean"]),h=l.filter(m=>m&&m.name!==n).filter(m=>!p.has(String(m.logical_family??"unknown"))).map(m=>({name:m.name,logical_family:String(m.logical_family??"unknown")}));return h.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:h.map(m=>m.name),details:h}:null},[l,r,n]),d=x.useMemo(()=>{if(!i||!l.length||!s.length)return null;const p=new Set(["numeric","integer"]),h=new Map(l.map(_=>[_.name,_])),m=[];return s.forEach((_,v)=>{if(!Gw(_.method)||!Array.isArray(_.columns)||!_.columns.length)return;const y=_.columns.map(b=>h.get(b)).filter(b=>!!b).filter(b=>!p.has(String(b.logical_family??"unknown"))).map(b=>({name:b.name,logical_family:String(b.logical_family??"unknown")}));y.length&&m.push({index:v,columns:y.map(b=>b.name),details:y})}),m.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:m}:null},[l,s,i]),f=!!(u!=null&&u.blocked||d!=null&&d.blocked);return{cachedSchemaColumns:l,oversamplingSchemaGuard:u,imputationSchemaDiagnostics:d,skipPreview:f}},qF=(e,t,n,s,r)=>{e([]),t({}),n({}),s({}),r("")},VF=({requiresColumnCatalog:e,catalogFlags:t,nodeId:n,sourceId:s,hasReachableSource:r})=>{const{isImputerNode:i}=t,[l,u]=x.useState([]),[d,f]=x.useState(""),[p,h]=x.useState({}),[m,_]=x.useState({}),[v,y]=x.useState({}),[b,w]=x.useState(0);x.useEffect(()=>{!e&&!i||s&&r||qF(u,h,_,y,f)},[r,i,e,s]),x.useEffect(()=>{w(0)},[i,n]);const E=x.useMemo(()=>d.trim().toLowerCase(),[d]),N=x.useMemo(()=>E?l.filter(j=>j.toLowerCase().includes(E)):l,[l,E]);return{availableColumns:l,setAvailableColumns:u,columnSearch:d,setColumnSearch:f,columnMissingMap:p,setColumnMissingMap:h,columnTypeMap:m,setColumnTypeMap:_,columnSuggestions:v,setColumnSuggestions:y,imputerMissingFilter:b,setImputerMissingFilter:w,normalizedColumnSearch:E,filteredColumnOptions:N}},KF=({graphSnapshot:e,nodeId:t,catalogFlags:n,configState:s,setConfigState:r,nodeParams:i,sourceId:l,requiresColumnCatalog:u,imputerStrategies:d})=>{var C;const f=FF({graphSnapshot:e,nodeId:t,catalogFlags:n}),{graphNodes:p,upstreamNodeIds:h,upstreamTargetColumn:m,hasReachableSource:_}=f,v=BF({configState:s,setConfigState:r,catalogFlags:n,upstreamTargetColumn:m,nodeId:t,modelTypeOptions:((C=i.trainModel.modelType)==null?void 0:C.options)??null}),{resamplingConfig:y}=v,b=HF({nodeId:t,sourceId:l,configState:s,upstreamNodeIds:h,graphNodes:p}),[w,E]=x.useState(null),N=UF({cachedPreviewSchema:w,catalogFlags:n,resamplingTargetColumn:(y==null?void 0:y.targetColumn)??null,imputerStrategies:d}),j=VF({requiresColumnCatalog:u,catalogFlags:n,nodeId:t,sourceId:l,hasReachableSource:_});return{graphTopology:f,modelingConfig:v,previewSignatureResult:b,cachedPreviewSchema:w,setCachedPreviewSchema:E,schemaDiagnostics:N,columnCatalogState:j}},YF=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:r})=>{var i;x.useEffect(()=>{var p;const l=Array.isArray((p=e.data)==null?void 0:p.column_stats)?e.data.column_stats:[],u=e.status;if(!l.length){if(u==="loading")return;s(h=>Object.keys(h).length?{}:h),r(h=>Object.keys(h).length?{}:h);return}const d={},f={};l.forEach(h=>{if(!h||!h.name)return;const m=String(h.name).trim();if(!m||n&&m.endsWith(n))return;const _=typeof h.dtype=="string"?h.dtype:null;_&&(d[m]=_);const v=t.map(b=>b&&Object.prototype.hasOwnProperty.call(b,m)?b[m]:void 0),y=Q3(_,v);y.length&&(f[m]=y)}),s(h=>{const m=Object.entries(h),_=Object.entries(d);return m.length===_.length&&m.every(([v,y])=>Object.prototype.hasOwnProperty.call(d,v)&&d[v]===y)?h:d}),r(h=>{const m=Object.keys(h),_=Object.keys(f);return m.length===_.length&&m.every(v=>{if(!Object.prototype.hasOwnProperty.call(f,v))return!1;const y=h[v]??[],b=f[v]??[];return yj(y,b)})?h:f})},[n,t,(i=e.data)==null?void 0:i.column_stats,e.status,r,s])},WF=({previewState:e,activeFlagSuffix:t,hasReachableSource:n,requiresColumnCatalog:s,nodeColumns:r,selectedColumns:i,setAvailableColumns:l,setColumnMissingMap:u})=>{var d,f;x.useEffect(()=>{var y,b;if(!s||!n)return;const p=new Set;(Array.isArray((y=e.data)==null?void 0:y.columns)?e.data.columns:[]).forEach(w=>{const E=typeof w=="string"?w.trim():"";E&&(t&&E.endsWith(t)||p.add(E))});const m=Array.isArray((b=e.data)==null?void 0:b.column_stats)?e.data.column_stats:[],_={};if(m.forEach(w=>{if(!w||!w.name)return;const E=String(w.name).trim();if(!E||t&&E.endsWith(t))return;p.add(E);const N=Number(w.missing_percentage);!Number.isNaN(N)&&N>=0&&(_[E]=N)}),at(r).forEach(w=>{w&&!(t&&w.endsWith(t))&&p.add(w)}),i.forEach(w=>{w&&!(t&&w.endsWith(t))&&p.add(w)}),p.size===0)return;const v=Array.from(p).sort((w,E)=>w.localeCompare(E));l(w=>yj(w,v)?w:v),Object.keys(_).length>0&&u(w=>({...w,..._}))},[t,n,r,(d=e.data)==null?void 0:d.column_stats,(f=e.data)==null?void 0:f.columns,s,i,l,u])},GF=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:r,hasReachableSource:i,requiresColumnCatalog:l,nodeColumns:u,selectedColumns:d,setAvailableColumns:f,setColumnMissingMap:p})=>{YF({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:r}),WF({previewState:e,activeFlagSuffix:n,hasReachableSource:i,requiresColumnCatalog:l,nodeColumns:u,selectedColumns:d,setAvailableColumns:f,setColumnMissingMap:p})},tr=["standard","robust","minmax","maxabs"],ii={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},Ij={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},Fj=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],Bj=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=Fj(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",r=tr.includes(s)?s:"standard",i={},l=t.column_methods;l&&typeof l=="object"&&!Array.isArray(l)&&Object.entries(l).forEach(([f,p])=>{const h=String(f??"").trim(),m=typeof p=="string"?p.trim().toLowerCase():"";h&&tr.includes(m)&&(i[h]=m)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=Fj(t.skipped_columns);return{columns:n,defaultMethod:r,columnMethods:i,autoDetect:u,skippedColumns:d}},XF=e=>{const t={...ii};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,r=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&tr.includes(s)&&r&&(t[s]=r)}),t},QF=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&tr.includes(s)&&t.set(s,n)}),t},ZF=e=>tr.map(t=>({value:t,label:e[t]??ii[t]??t})),JF=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:s,scalingSkippedColumns:r,scalingExcludedColumns:i})=>{if(!e.length)return[];const l=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const f=u.recommended_method,p=n[f]??ii[f]??f,h=Array.isArray(u.fallback_methods)?u.fallback_methods.filter(M=>tr.includes(M)).map(M=>{const z=M;return n[z]??ii[z]??z}):[],m=u.confidence??"medium",_=Ij[m]??Ij.medium,y=t.columnMethods[d]??null,b=y??t.defaultMethod,w=n[b]??ii[b]??b,E=i.has(d),N=r.has(d),j=s.has(d),C=u.stats;l.push({column:d,dtype:u.dtype??null,recommendedMethod:f,recommendedLabel:p,confidence:m,confidenceLabel:_,reasons:Array.isArray(u.reasons)?u.reasons:[],fallbackLabels:h,stats:C,hasMissing:!!u.has_missing,currentOverride:y,currentMethod:b,currentMethodLabel:w,isOverrideApplied:y!==null,isSelected:j,isExcluded:E,isSkipped:N})}),l.sort((u,d)=>u.column.localeCompare(d.column)),l},e5=(e,t,n,s)=>{if(!e.length)return null;const r=e.map(i=>{const l=t[i],u=l?n[l]??ii[l]??l:null;return u?`${i} -> ${u}`:i});return s>e.length&&r.push(""),r.join(", ")},vm=e=>String(e??"").trim(),t5=({catalogFlags:e,setConfigState:t,binningExcludedColumns:n,scalingExcludedColumns:s,availableColumns:r,recommendations:i})=>{const{isBinningNode:l,isScalingNode:u}=e,d=x.useCallback((y,b,w)=>{const E=vm(y);E&&t(N=>{const j=N.manual_bounds&&typeof N.manual_bounds=="object"&&!Array.isArray(N.manual_bounds)?{...N.manual_bounds}:{},C=j[E]&&typeof j[E]=="object"?{...j[E]}:{lower:null,upper:null};if(w==="")b==="lower"?C.lower=null:C.upper=null;else{const D=Number(w);if(!Number.isFinite(D))return N;b==="lower"?C.lower=D:C.upper=D}const M=C.lower??null,z=C.upper??null;return M===null&&z===null?delete j[E]:j[E]={lower:M,upper:z},{...N,manual_bounds:j}})},[t]),f=x.useCallback(y=>{const b=vm(y);b&&t(w=>{const E=w.manual_bounds&&typeof w.manual_bounds=="object"&&!Array.isArray(w.manual_bounds)?w.manual_bounds:null;if(!E||!Object.prototype.hasOwnProperty.call(E,b))return w;const N={...E};return delete N[b],{...w,manual_bounds:N}})},[t]),p=x.useCallback(y=>{const b=vm(y);b&&t(w=>{const E=at(w.columns),N=E.includes(b),j=N?E.filter(D=>D!==b):[...E,b];let C=!1,M=w.manual_bounds;N&&M&&typeof M=="object"&&!Array.isArray(M)&&Object.prototype.hasOwnProperty.call(M,b)&&(M={...M},delete M[b],C=!0);const z={...w,columns:j};if(C&&(z.manual_bounds=M),l){const D=new Set(j);if(w.custom_bins&&typeof w.custom_bins=="object"&&!Array.isArray(w.custom_bins)){const k={};Object.entries(w.custom_bins).forEach(([T,A])=>{D.has(T)&&Array.isArray(A)&&A.length&&(k[T]=[...A])}),Object.keys(k).length?z.custom_bins=k:"custom_bins"in z&&delete z.custom_bins}else"custom_bins"in z&&delete z.custom_bins;if(w.custom_labels&&typeof w.custom_labels=="object"&&!Array.isArray(w.custom_labels)){const k={};Object.entries(w.custom_labels).forEach(([T,A])=>{D.has(T)&&Array.isArray(A)&&A.length&&(k[T]=A.map(O=>String(O)))}),Object.keys(k).length?z.custom_labels=k:"custom_labels"in z&&delete z.custom_labels}else"custom_labels"in z&&delete z.custom_labels;if(w.column_overrides&&typeof w.column_overrides=="object"&&!Array.isArray(w.column_overrides)){const k={};Object.entries(w.column_overrides).forEach(([T,A])=>{D.has(T)&&A&&typeof A=="object"&&!Array.isArray(A)&&(k[T]={...A})}),Object.keys(k).length?(z.column_overrides=k,z.column_strategies=k):("column_overrides"in z&&delete z.column_overrides,"column_strategies"in z&&delete z.column_strategies)}else"column_overrides"in z&&delete z.column_overrides,"column_strategies"in z&&delete z.column_strategies}if(u){let D=null;w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)&&(D={},Object.entries(w.column_methods).forEach(([k,T])=>{const A=typeof T=="string"?T.trim():null;!A||!tr.includes(A)||N&&k===b||(D[k]=A)})),D&&Object.keys(D).length?z.column_methods=D:N&&Object.prototype.hasOwnProperty.call(z,"column_methods")&&delete z.column_methods}return z})},[l,u,t]),h=x.useCallback(()=>{i.length&&t(y=>{const b=new Set(at(y.columns));return i.forEach(w=>{w!=null&&w.name&&b.add(String(w.name))}),{...y,columns:Array.from(b)}})},[i,t]),m=x.useCallback(()=>{r.length&&t(y=>{const b=new Set(at(y.columns));return r.filter(E=>l?!n.has(E):u?!s.has(E):!0).forEach(E=>b.add(E)),{...y,columns:Array.from(b).sort((E,N)=>E.localeCompare(N))}})},[r,n,l,u,s,t]),_=x.useCallback(()=>{t(y=>{const b={...y,columns:[]};return y!=null&&y.manual_bounds&&typeof y.manual_bounds=="object"&&!Array.isArray(y.manual_bounds)&&Object.keys(y.manual_bounds).length&&(b.manual_bounds={}),l&&("custom_bins"in b&&delete b.custom_bins,"custom_labels"in b&&delete b.custom_labels,"column_overrides"in b&&delete b.column_overrides,"column_strategies"in b&&delete b.column_strategies),u&&"column_methods"in b&&delete b.column_methods,b})},[l,u,t]),v=x.useCallback(y=>{const b=vm(y);b&&t(w=>{const E=at(w.columns);if(!E.includes(b))return w;const N=E.filter(z=>z!==b);let j=!1,C=w.manual_bounds;C&&typeof C=="object"&&!Array.isArray(C)&&Object.prototype.hasOwnProperty.call(C,b)&&(C={...C},delete C[b],j=!0);const M={...w,columns:N};if(j&&(M.manual_bounds=C),l){if(w.custom_bins&&typeof w.custom_bins=="object"&&!Array.isArray(w.custom_bins)){const z={};Object.entries(w.custom_bins).forEach(([D,k])=>{D!==b&&Array.isArray(k)&&k.length&&(z[D]=[...k])}),Object.keys(z).length?M.custom_bins=z:"custom_bins"in M&&delete M.custom_bins}else"custom_bins"in M&&delete M.custom_bins;if(w.custom_labels&&typeof w.custom_labels=="object"&&!Array.isArray(w.custom_labels)){const z={};Object.entries(w.custom_labels).forEach(([D,k])=>{D!==b&&Array.isArray(k)&&k.length&&(z[D]=k.map(T=>String(T)))}),Object.keys(z).length?M.custom_labels=z:"custom_labels"in M&&delete M.custom_labels}else"custom_labels"in M&&delete M.custom_labels;if(w.column_overrides&&typeof w.column_overrides=="object"&&!Array.isArray(w.column_overrides)){const z={};Object.entries(w.column_overrides).forEach(([D,k])=>{D!==b&&k&&typeof k=="object"&&!Array.isArray(k)&&(z[D]={...k})}),Object.keys(z).length?(M.column_overrides=z,M.column_strategies=z):("column_overrides"in M&&delete M.column_overrides,"column_strategies"in M&&delete M.column_strategies)}else"column_overrides"in M&&delete M.column_overrides,"column_strategies"in M&&delete M.column_strategies}if(u)if(w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)){const z={};Object.entries(w.column_methods).forEach(([D,k])=>{const T=typeof k=="string"?k.trim():null;!T||!tr.includes(T)||D!==b&&(z[D]=T)}),Object.keys(z).length?M.column_methods=z:Object.prototype.hasOwnProperty.call(M,"column_methods")&&delete M.column_methods}else Object.prototype.hasOwnProperty.call(M,"column_methods")&&delete M.column_methods;return M})},[l,u,t]);return{handleManualBoundChange:d,handleClearManualBound:f,handleToggleColumn:p,handleApplyAllRecommended:h,handleSelectAllColumns:m,handleClearColumns:_,handleRemoveColumn:v}},Hj=28,Uj=320,n5=170,qj="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",Vj="Drop columns",Kj=new Set(["transformer_audit"]),so="__pending_confirmation__",s5=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],r5=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],xm=e=>e&&typeof e=="object"&&!Array.isArray(e),tu=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},bm=e=>typeof e=="string"&&Kj.has(e),wm=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",s=!Kj.has(n),r=l=>(s?l[so]=!0:delete l[so],l);if(t==null)return r({});const i=tu(t);if(!xm(i))return r(i&&typeof i=="object"?i:{});switch(Object.entries(i).forEach(([l,u])=>{Array.isArray(u)?s5.some(f=>f.test(l))&&(i[l]=[]):xm(u)&&r5.some(f=>f.test(l))&&(i[l]={})}),"auto_detect"in i&&(i.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.column_methods=xm(i.column_methods)?i.column_methods:{},i.skipped_columns=Array.isArray(i.skipped_columns)?i.skipped_columns:[],i.default_method=typeof i.default_method=="string"&&i.default_method.trim()?i.default_method:"standard";break;case"polynomial_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.auto_detect=!!i.auto_detect,i.include_bias=!!i.include_bias,i.interaction_only=!!i.interaction_only,i.include_input_features=!!i.include_input_features,i.degree=typeof i.degree=="number"&&Number.isFinite(i.degree)?i.degree:2,i.output_prefix=typeof i.output_prefix=="string"&&i.output_prefix.trim()?i.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in i&&(i.missing_threshold=null),i.columns=Array.isArray(i.columns)?i.columns:[];break;case"drop_missing_rows":"missing_threshold"in i&&(i.missing_threshold=null),"drop_if_any_missing"in i&&(i.drop_if_any_missing=!1);break;case"outlier_removal":i.method="manual",i.columns=Array.isArray(i.columns)?i.columns:[],i.manual_bounds=xm(i.manual_bounds)?i.manual_bounds:{};break;case"missing_value_indicator":i.columns=Array.isArray(i.columns)?i.columns:[];break;case"remove_duplicates":if(i.columns=Array.isArray(i.columns)?i.columns:[],typeof i.keep=="string"){const l=i.keep.trim().toLowerCase();i.keep=l==="last"||l==="none"?l:"first"}else i.keep="first";break}return r(i)},a5=(e,t)=>t==="drop_missing_columns"||e===qj?Vj:e,o5=e=>Array.isArray(e)?e.map(t=>({...t})):[],i5=({configState:e,catalogFlags:t,nodeId:n,onUpdateConfig:s,onClose:r,sourceId:i,graphSnapshot:l,onUpdateNodeData:u,setConfigState:d,canResetNode:f,defaultConfigTemplate:p,onResetConfig:h,onPendingConfigurationWarning:m,onPendingConfigurationCleared:_})=>{const{isBinningNode:v,isScalingNode:y,isInspectionNode:b,isTrainModelDraftNode:w,isHyperparameterTuningNode:E}=t,N=x.useRef(null),j=x.useCallback(k=>{if(!k)return"idle";const T=(k.job_status??k.status??"").toLowerCase();return T?T==="succeeded"?At(k).length>0?"error":"success":T==="failed"||T==="skipped"||T==="cancelled"?"error":T==="running"||T==="queued"||T==="deferred"?"loading":"idle":"idle"},[]),C=x.useCallback(k=>{var q;if((q=N.current)==null||q.call(N),!k){_==null||_();return}const T=i;if(!T||!n)return;const A=At(k);A.length?m==null||m(A):_==null||_();const O=T;if(j(k)!=="loading")return;const L=k.job_id;if(!L)return;let F=!1;const B=async I=>{const U=typeof I=="number"&&I>0?I*1e3:5e3;if(await new Promise(V=>setTimeout(V,U)),!F)try{const V=await Tw(O,L),H=j(V);u==null||u(n,{backgroundExecutionStatus:H});const G=At(V);G.length?m==null||m(G):_==null||_(),H==="loading"&&B((V==null?void 0:V.poll_after_seconds)??null)}catch(V){console.warn("Failed to poll full dataset execution status:",V),u==null||u(n,{backgroundExecutionStatus:"error"})}};B(k.poll_after_seconds??null),N.current=()=>{F=!0}},[j,n,_,m,u,i]),M=x.useCallback((k,T,A)=>{if(!k)return null;const O=dm(A);return O&&typeof O=="object"&&delete O[so],{nodes:Array.isArray(k.nodes)?k.nodes.map(L=>{if(!L||L.id!==T)return L;const F={...L.data??{},config:O,isConfigured:!0};return{...L,data:F}}):k.nodes,edges:Array.isArray(k.edges)?[...k.edges]:k.edges}},[]),z=x.useCallback(k=>{if(!n)return;let T=dm(e);if(v){const O=Yw(T);T={...T,strategy:O.strategy,columns:O.columns,equal_width_bins:O.equalWidthBins,equal_frequency_bins:O.equalFrequencyBins,include_lowest:O.includeLowest,precision:O.precision,duplicates:O.duplicates,output_suffix:O.outputSuffix,drop_original:O.dropOriginal,label_format:O.labelFormat,missing_strategy:O.missingStrategy},O.missingStrategy==="label"?T.missing_label=O.missingLabel:Object.prototype.hasOwnProperty.call(T,"missing_label")&&delete T.missing_label,Object.keys(O.customBins).length?T.custom_bins=O.customBins:Object.prototype.hasOwnProperty.call(T,"custom_bins")&&delete T.custom_bins,Object.keys(O.customLabels).length?T.custom_labels=O.customLabels:Object.prototype.hasOwnProperty.call(T,"custom_labels")&&delete T.custom_labels}if(y){const O=Bj(T);T={...T,columns:O.columns,default_method:O.defaultMethod,auto_detect:O.autoDetect,skipped_columns:O.skippedColumns},Object.keys(O.columnMethods).length>0?T.column_methods=O.columnMethods:Object.prototype.hasOwnProperty.call(T,"column_methods")&&delete T.column_methods}s(n,T),(k==null?void 0:k.closeModal)!==!1&&r();const A=M(l,n,T);i&&A&&!b&&!w&&!E&&(u==null||u(n,{backgroundExecutionStatus:"loading"}),Ow({dataset_source_id:i,graph:{nodes:A.nodes||[],edges:A.edges||[]}}).then(O=>{var B;const R=(B=O==null?void 0:O.signals)==null?void 0:B.full_execution,L=j(R);u==null||u(n,{backgroundExecutionStatus:L});const F=At(R);F.length?m==null||m(F):_==null||_(),C(R)}).catch(O=>{u==null||u(n,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",O)}))},[e,l,v,b,y,n,r,s,u,i,M]),D=x.useCallback(()=>{if(!f||!n)return;const k=dm(p??{});d(k),h==null||h(n,k)},[f,p,n,h,d]);return{handleSave:z,handleResetNode:D}},l5=({setConfigState:e,imputationMethodValues:t,imputationMethodOptions:n,imputerStrategyCount:s,setCollapsedStrategies:r,setImputerMissingFilter:i})=>{const l=x.useCallback(y=>{e(b=>{const w=Qw(b==null?void 0:b.strategies,t),E=y(w).map(N=>({...N,options:Bc(N.method,N.options)}));return{...b,strategies:DR(E)}})},[t,e]),u=x.useCallback(()=>{var w;const y=s,b=((w=n[0])==null?void 0:w.value)??"mean";l(E=>[...E,{method:b,columns:[],options:Bc(b,Xw(b))}]),r(E=>{const N=new Set(E);return N.delete(y),N})},[n,s,l,r]),d=x.useCallback(y=>{l(b=>b.filter((w,E)=>E!==y)),r(b=>{const w=new Set;return b.forEach(E=>{E!==y&&w.add(E>y?E-1:E)}),w})},[l,r]),f=x.useCallback(y=>{r(b=>{const w=new Set(b);return w.has(y)?w.delete(y):w.add(y),w})},[r]),p=x.useCallback((y,b)=>{l(w=>w.map((E,N)=>N===y?{...E,method:b,options:Bc(b,E.options)}:E))},[l]),h=x.useCallback((y,b,w)=>{l(E=>E.map((N,j)=>{if(j!==y)return N;const C={...N.options??{}};if(w==="")delete C[b];else{const M=Number(w);if(!Number.isFinite(M))return N;C[b]=M}return{...N,options:Bc(N.method,C)}}))},[l]),m=x.useCallback((y,b)=>{const w=b.split(",").map(E=>E.trim()).filter(Boolean);l(E=>E.map((N,j)=>j===y?{...N,columns:w}:N))},[l]),_=x.useCallback((y,b)=>{const w=b.trim();w&&l(E=>E.map((N,j)=>{if(j!==y)return N;const M=N.columns.includes(w)?N.columns.filter(z=>z!==w):[...N.columns,w];return M.sort((z,D)=>z.localeCompare(D)),{...N,columns:M}}))},[l]),v=x.useCallback(y=>{i(y)},[i]);return{updateImputerStrategies:l,handleAddImputerStrategy:u,handleRemoveImputerStrategy:d,toggleImputerStrategySection:f,handleImputerMethodChange:p,handleImputerOptionNumberChange:h,handleImputerColumnsChange:m,handleImputerColumnToggle:_,handleImputerMissingFilterChange:v}},c5=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,aliasColumnSummary:r,aliasStrategyCount:i})=>{var y;const{isReplaceAliasesNode:l}=e,u=x.useCallback(b=>{l&&n(w=>{var O,R,L,F,B,q,I,U,V;if(!l)return w;const E=at((w==null?void 0:w.columns)??((R=(O=t==null?void 0:t.data)==null?void 0:O.config)==null?void 0:R.columns)),N=sm(w==null?void 0:w.mode,(F=(L=t==null?void 0:t.data)==null?void 0:L.config)==null?void 0:F.mode),j=(()=>{var W;const H=Nl(w);if(H!==void 0){const J=si(H);if(J!==null)return J}const G=Nl((W=t==null?void 0:t.data)==null?void 0:W.config);if(G!==void 0){const J=si(G);if(J!==null)return J}return E.length===0})(),C=(w==null?void 0:w.alias_strategies)??(w==null?void 0:w.strategies)??((q=(B=t==null?void 0:t.data)==null?void 0:B.config)==null?void 0:q.alias_strategies)??((U=(I=t==null?void 0:t.data)==null?void 0:I.config)==null?void 0:U.strategies),M=rN(C,{mode:N,columns:E,autoDetect:j}),z=b(M).map(H=>({mode:sm(H.mode,N),columns:Array.from(new Set(H.columns.map(G=>G.trim()).filter(Boolean))).sort((G,W)=>G.localeCompare(W)),autoDetect:!!H.autoDetect})),D=aD(z),k=Array.from(new Set(z.flatMap(H=>H.columns))).sort((H,G)=>H.localeCompare(G)),T=((V=z[0])==null?void 0:V.mode)??N,A=z.length?z.some(H=>H.autoDetect):j;return{...w,alias_strategies:D,columns:k,mode:T,auto_detect:A}})},[l,(y=t==null?void 0:t.data)==null?void 0:y.config,n]),d=x.useCallback(()=>{if(!l)return;const b=i;u(w=>{var M;const E=new Set;w.forEach(z=>{z.columns.forEach(D=>{const k=D.trim();k&&E.add(k)})});const N=r.recommendedColumns.find(z=>!E.has(z)),C={mode:w.length?w[w.length-1].mode:((M=nN[0])==null?void 0:M.value)??Tp,columns:N?[N]:[],autoDetect:!N};return[...w,C]}),s(w=>{const E=new Set(w);return E.delete(b),E})},[r.recommendedColumns,i,l,s,u]),f=x.useCallback(b=>{u(w=>w.filter((E,N)=>N!==b)),s(w=>{const E=new Set;return w.forEach(N=>{N!==b&&E.add(N>b?N-1:N)}),E})},[s,u]),p=x.useCallback(b=>{s(w=>{const E=new Set(w);return E.has(b)?E.delete(b):E.add(b),E})},[s]),h=x.useCallback((b,w)=>{u(E=>E.map((N,j)=>j===b?{...N,mode:w}:N))},[u]),m=x.useCallback((b,w)=>{const E=w.trim();E&&u(N=>N.map((j,C)=>{if(C!==b)return j;const z=j.columns.includes(E)?j.columns.filter(D=>D!==E):[...j.columns,E];return z.sort((D,k)=>D.localeCompare(k)),{...j,columns:z}}))},[u]),_=x.useCallback((b,w)=>{const E=w.split(",").map(j=>j.trim()).filter(Boolean),N=Array.from(new Set(E)).sort((j,C)=>j.localeCompare(C));u(j=>j.map((C,M)=>M===b?{...C,columns:N}:C))},[u]),v=x.useCallback((b,w)=>{u(E=>E.map((N,j)=>j===b?{...N,autoDetect:w}:N))},[u]);return{updateAliasStrategies:u,handleAddAliasStrategy:d,handleRemoveAliasStrategy:f,toggleAliasStrategySection:p,handleAliasModeChange:h,handleAliasColumnToggle:m,handleAliasColumnsChange:_,handleAliasAutoDetectToggle:v}},u5=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,dateStrategies:r,standardizeDatesColumnSummary:i,standardizeDatesMode:l})=>{var b,w,E,N,j,C;const{isStandardizeDatesNode:u}=e,d=x.useCallback(M=>{n(z=>{var B,q,I,U,V,H,G;if(!u)return z;const D=at((z==null?void 0:z.columns)??((q=(B=t==null?void 0:t.data)==null?void 0:B.config)==null?void 0:q.columns)),k=pN(z==null?void 0:z.mode,(U=(I=t==null?void 0:t.data)==null?void 0:I.config)==null?void 0:U.mode),T=D.length===0,A=gN((z==null?void 0:z.format_strategies)??((H=(V=t==null?void 0:t.data)==null?void 0:V.config)==null?void 0:H.format_strategies),{columns:D,mode:k,autoDetect:T}),O=M(A),R=TD(O),L=Array.from(new Set(O.flatMap(W=>W.columns.map(J=>J.trim()).filter(Boolean)))).sort((W,J)=>W.localeCompare(J)),F=((G=O[0])==null?void 0:G.mode)??k;return{...z,format_strategies:R,columns:L,mode:F}})},[u,(w=(b=t==null?void 0:t.data)==null?void 0:b.config)==null?void 0:w.columns,(N=(E=t==null?void 0:t.data)==null?void 0:E.config)==null?void 0:N.format_strategies,(C=(j=t==null?void 0:t.data)==null?void 0:j.config)==null?void 0:C.mode,n]),f=x.useCallback(()=>{const M=r.length;d(z=>{var O;const D=new Set;z.forEach(R=>{R.columns.forEach(L=>{const F=L.trim();F&&D.add(F)})});const k=i.recommendedColumns.find(R=>!D.has(R)),A={mode:z.length?z[z.length-1].mode:((O=Rp[0])==null?void 0:O.value)??l,columns:k?[k]:[],autoDetect:!k};return[...z,A]}),s(z=>{const D=new Set(z);return D.delete(M),D})},[r.length,s,i.recommendedColumns,l,d]),p=x.useCallback(M=>{d(z=>z.filter((D,k)=>k!==M)),s(z=>{const D=new Set;return z.forEach(k=>{k!==M&&D.add(k>M?k-1:k)}),D})},[s,d]),h=x.useCallback(M=>{s(z=>{const D=new Set(z);return D.has(M)?D.delete(M):D.add(M),D})},[s]),m=x.useCallback((M,z)=>{d(D=>D.map((k,T)=>T===M?{...k,mode:z}:k))},[d]),_=x.useCallback((M,z)=>{const D=z.split(",").map(k=>k.trim()).filter(Boolean).sort((k,T)=>k.localeCompare(T));d(k=>k.map((T,A)=>A===M?{...T,columns:D}:T))},[d]),v=x.useCallback((M,z)=>{const D=z.trim();D&&d(k=>k.map((T,A)=>{if(A!==M)return T;const R=T.columns.includes(D)?T.columns.filter(L=>L!==D):[...T.columns,D];return R.sort((L,F)=>L.localeCompare(F)),{...T,columns:R}}))},[d]),y=x.useCallback((M,z)=>{d(D=>D.map((k,T)=>T===M?{...k,autoDetect:z}:k))},[d]);return{updateDateStrategies:d,handleAddDateStrategy:f,handleRemoveDateStrategy:p,toggleDateStrategySection:h,handleDateStrategyModeChange:m,handleDateStrategyColumnsChange:_,handleDateStrategyColumnToggle:v,handleDateStrategyAutoDetectToggle:y}},d5=new Set(cm.map(e=>e.value)),nu=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),Yj=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),Wj=e=>{const n=nu(e).filter(s=>d5.has(s));return n.length?n:["year","month","day"]},su=e=>e==null?null:Number.isFinite(e)?e:null,Gj=e=>{const t=su(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},Xj=e=>typeof e!="string"?"UTC":e.trim()||"UTC",m5=({catalogFlags:e,setConfigState:t,setCollapsedFeatureMath:n})=>{const{isFeatureMathNode:s}=e,r=x.useCallback(h=>{t(m=>{if(!s)return m;const _=m&&typeof m=="object"&&!Array.isArray(m)?{...m}:{},v=QN(Array.isArray(m==null?void 0:m.operations)?m.operations:[]),y=h(v);return _.operations=$I(y),_})},[s,t]),i=x.useCallback(h=>{if(!s)return;let m="";r(_=>{const v=new Set(_.map(b=>b.id)),y=ZN(h,v);return m=y.id,[..._,y]}),m&&n(_=>{const v=new Set(_);return v.delete(m),v})},[s,n,r]),l=x.useCallback(h=>{if(!s)return;let m="";r(_=>{const v=_.findIndex(j=>j.id===h);if(v===-1)return _;const y=_[v],b=new Set(_.map(j=>j.id)),w=ZN(y.type,b);m=w.id;const E={...y,id:w.id,inputColumns:[...y.inputColumns],secondaryColumns:[...y.secondaryColumns],constants:[...y.constants],datetimeFeatures:[...y.datetimeFeatures],outputColumn:y.outputColumn?`${y.outputColumn}_copy`:""},N=[..._];return N.splice(v+1,0,E),N}),m&&n(_=>{const v=new Set(_);return v.delete(m),v})},[s,n,r]),u=x.useCallback(h=>{s&&(r(m=>m.filter(_=>_.id!==h)),n(m=>{const _=new Set(m);return _.delete(h),_}))},[s,n,r]),d=x.useCallback((h,m)=>{s&&r(_=>{const v=_.findIndex(E=>E.id===h);if(v===-1)return _;const y=m==="up"?v-1:v+1;if(y<0||y>=_.length)return _;const b=[..._],[w]=b.splice(v,1);return b.splice(y,0,w),b})},[s,r]),f=x.useCallback(h=>{n(m=>{const _=new Set(m);return _.has(h)?_.delete(h):_.add(h),_})},[n]),p=x.useCallback((h,m)=>{s&&r(_=>_.map(v=>{if(v.id!==h)return v;let y={...v};if(m.type&&(y.type=m.type),m.method!==void 0&&(y.method=m.method),m.inputColumns!==void 0&&(y.inputColumns=nu(m.inputColumns)),m.secondaryColumns!==void 0&&(y.secondaryColumns=nu(m.secondaryColumns)),m.constants!==void 0&&(y.constants=Yj(m.constants)),m.outputColumn!==void 0&&(y.outputColumn=m.outputColumn.trim()),m.outputPrefix!==void 0&&(y.outputPrefix=m.outputPrefix.trim()),m.datetimeFeatures!==void 0&&(y.datetimeFeatures=Wj(m.datetimeFeatures)),m.timezone!==void 0&&(y.timezone=Xj(m.timezone)),m.fillna!==void 0&&(y.fillna=su(m.fillna)),m.roundDigits!==void 0&&(y.roundDigits=Gj(m.roundDigits)),m.normalize!==void 0&&(y.normalize=m.normalize),m.epsilon!==void 0&&(y.epsilon=su(m.epsilon)),m.allowOverwrite!==void 0&&(y.allowOverwrite=m.allowOverwrite),m.description!==void 0){const E=typeof m.description=="string"?m.description.trim():"";y.description=E||void 0}const b=y.type,w=JN(b);return w.length?new Set(w.map(N=>N.value)).has(y.method)||(y.method=w[0].value):b==="ratio"?y.method="ratio":b==="datetime_extract"&&(y.method="datetime_extract"),y.inputColumns=nu(y.inputColumns),b==="ratio"||b==="similarity"?y.secondaryColumns=nu(y.secondaryColumns):y.secondaryColumns=[],y.constants=Yj(y.constants),y.fillna=su(y.fillna),y.roundDigits=Gj(y.roundDigits),y.epsilon=su(y.epsilon),b==="datetime_extract"?(y.datetimeFeatures=Wj(y.datetimeFeatures),y.timezone=Xj(y.timezone)):(y.datetimeFeatures=[],y.timezone="UTC"),b!=="similarity"?y.normalize=!1:y.normalize=!!y.normalize,typeof y.allowOverwrite!="boolean"&&(y.allowOverwrite=null),y.outputColumn=y.outputColumn.trim(),y.outputPrefix=y.outputPrefix.trim(),y}))},[s,r]);return{updateFeatureMathOperations:r,handleAddFeatureMathOperation:i,handleDuplicateFeatureMathOperation:l,handleRemoveFeatureMathOperation:u,handleReorderFeatureMathOperation:d,handleToggleFeatureMathOperation:f,handleFeatureMathOperationChange:p}},h5=({catalogFlags:e,setConfigState:t,binningExcludedColumns:n,scalingExcludedColumns:s,availableColumns:r,recommendations:i,nodeId:l,onUpdateConfig:u,onClose:d,sourceId:f,graphSnapshot:p,onUpdateNodeData:h,canResetNode:m,defaultConfigTemplate:_,onResetConfig:v,imputationMethodValues:y,imputationMethodOptions:b,imputerStrategyCount:w,setCollapsedStrategies:E,setImputerMissingFilter:N,node:j,aliasColumnSummary:C,aliasStrategyCount:M,dateStrategies:z,standardizeDatesColumnSummary:D,standardizeDatesMode:k,setCollapsedFeatureMath:T,configState:A,onPendingConfigurationWarning:O,onPendingConfigurationCleared:R})=>{const L=t5({catalogFlags:e,setConfigState:t,binningExcludedColumns:n,scalingExcludedColumns:s,availableColumns:r,recommendations:i}),F=i5({configState:A,catalogFlags:e,nodeId:l,onUpdateConfig:u,onClose:d,sourceId:f,graphSnapshot:p,onUpdateNodeData:h,setConfigState:t,canResetNode:m,defaultConfigTemplate:_,onResetConfig:v,onPendingConfigurationWarning:O,onPendingConfigurationCleared:R}),B=l5({setConfigState:t,imputationMethodValues:y,imputationMethodOptions:b,imputerStrategyCount:w,setCollapsedStrategies:E,setImputerMissingFilter:N}),q=c5({catalogFlags:e,node:j,setConfigState:t,setCollapsedStrategies:E,aliasColumnSummary:C,aliasStrategyCount:M}),I=u5({catalogFlags:e,node:j,setConfigState:t,setCollapsedStrategies:E,dateStrategies:z,standardizeDatesColumnSummary:D,standardizeDatesMode:k}),U=m5({catalogFlags:e,setConfigState:t,setCollapsedFeatureMath:T});return{columnSelectionHandlers:L,nodeSaveHandlers:F,imputationStrategyHandlers:B,aliasStrategyHandlers:q,dateStrategyHandlers:I,featureMathHandlers:U}},f5=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:r,columnTypeMap:i,setAvailableColumns:l,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:f,setColumnSuggestions:p})=>{const[h,m]=x.useState([]),[_,v]=x.useState(null),[y,b]=x.useState([]),[w,E]=x.useState(null),[N,j]=x.useState(!1),[C,M]=x.useState(null),[z,D]=x.useState(null),[k,T]=x.useState(0),A=x.useRef(i);x.useEffect(()=>{A.current=i},[i]),x.useEffect(()=>{let B=!0;const q=I=>{b([]),E(I??null),M(null),D(null),j(!1),m([]),v(null),l([]),u(""),d({}),f({}),p({})};return e?t?r?(j(!0),E(null),Cp(t,{graph:s,targetNodeId:n??null}).then(I=>{if(!B)return;const U=Array.isArray(I==null?void 0:I.candidates)?I.candidates:[];b(U),M((I==null?void 0:I.generated_at)??null),D(typeof(I==null?void 0:I.suggested_threshold)=="number"?Number(I.suggested_threshold):null);const V=Array.isArray(I==null?void 0:I.available_filters)?I.available_filters:[];m(V),v(J=>J&&V.some(ee=>ee.id===J)?J:null);const H={};I&&typeof I=="object"&&(I!=null&&I.column_missing_map)&&typeof I.column_missing_map=="object"&&Object.entries(I.column_missing_map).forEach(([J,ee])=>{const Z=String(J??"").trim();if(!Z)return;const K=Number(ee);Number.isFinite(K)&&(H[Z]=Number(K))});const G=new Set;Array.isArray(I==null?void 0:I.all_columns)&&I.all_columns.forEach(J=>{const ee=String(J??"").trim();ee&&G.add(ee)}),Object.keys(A.current??{}).forEach(J=>G.add(J));const W=Array.from(G).sort((J,ee)=>J.localeCompare(ee));W.forEach(J=>{Object.prototype.hasOwnProperty.call(H,J)||(H[J]=0)}),l(W),u(""),d(H),f(J=>{const ee=I==null?void 0:I.column_type_map;if(!ee||typeof ee!="object")return J;const Z={...J};return Object.entries(ee).forEach(([K,X])=>{const Q=String(K??"").trim();if(!Q)return;const ne=String(X??"").trim();Z[Q]=ne||J[Q]||""}),Z}),p(J=>{const ee=I==null?void 0:I.column_recommendations;if(!ee||typeof ee!="object")return J;const Z={};return Object.entries(ee).forEach(([K,X])=>{const Q=String(K??"").trim();if(!Q)return;const ne=Array.isArray(X)?X.map(le=>String(le??"").trim()).filter(Boolean):[];Z[Q]=ne}),Z})}).catch(I=>{B&&q((I==null?void 0:I.message)??"Unable to load recommendations")}).finally(()=>{B&&j(!1)}),()=>{B=!1}):(q("Connect this step to an upstream output to load recommendations."),()=>{B=!1}):(q(),()=>{B=!1}):(q(),()=>{B=!1})},[A,s,e,r,n,k,l,d,u,p,f,t]);const O=x.useCallback(()=>{!e||!t||!r||T(B=>B+1)},[e,r,t]),R=x.useMemo(()=>{const B=new Map;return h.forEach(q=>{q!=null&&q.id&&B.set(q.id,q.label)}),B},[h]),L=x.useCallback(B=>B?R.has(B)?R.get(B)??null:B.split("_").filter(Boolean).map(I=>I.charAt(0).toUpperCase()+I.slice(1)).join(" ")||B:null,[R]),F=x.useMemo(()=>_?y.filter(B=>Array.isArray(B==null?void 0:B.signals)&&B.signals.includes(_)):y,[_,y]);return{hasDropColumnSource:e,availableFilters:h,activeFilterId:_,setActiveFilterId:v,recommendations:y,filteredRecommendations:F,formatSignalName:L,isFetchingRecommendations:N,recommendationsError:w,recommendationsGeneratedAt:C,suggestedThreshold:z,refreshRecommendations:O}},p5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r,setAvailableColumns:i,setColumnMissingMap:l})=>{const{isImputerNode:u}=e,d=u,[f,p]=x.useState(!1),[h,m]=x.useState(null),[_,v]=x.useState(0),y=x.useCallback(()=>{!d||!t||!n||v(b=>b+1)},[n,d,t]);return x.useEffect(()=>{let b=!0;return d?t?n?(p(!0),m(null),Cp(t,{graph:s,targetNodeId:r}).then(w=>{if(!b)return;const E={};w&&typeof w=="object"&&(w!=null&&w.column_missing_map)&&typeof w.column_missing_map=="object"&&Object.entries(w.column_missing_map).forEach(([C,M])=>{const z=String(C??"").trim();if(!z)return;const D=Number(M);Number.isNaN(D)||D<0||(E[z]=Number(D))});const N=new Set;Array.isArray(w==null?void 0:w.all_columns)&&w.all_columns.forEach(C=>{const M=String(C??"").trim();M&&N.add(M)}),Object.keys(E).forEach(C=>N.add(C));const j=Array.from(N).sort((C,M)=>C.localeCompare(M));j.forEach(C=>{Object.prototype.hasOwnProperty.call(E,C)||(E[C]=0)}),j.length&&i(j),Object.keys(E).length&&l(C=>({...C,...E}))}).catch(w=>{b&&m((w==null?void 0:w.message)??"Unable to load column metrics.")}).finally(()=>{b&&p(!1)}),()=>{b=!1}):(m("Connect this step to an upstream output to load column metrics."),p(!1),()=>{b=!1}):(m("Select a dataset to load column metrics."),p(!1),()=>{b=!1}):()=>{b=!1}},[s,n,_,i,l,d,t,r]),{isFetching:f,error:h,refreshDropColumnRecommendations:y}},sg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},g5=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},rg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],_5=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=g5(t.status),r=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,l=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,p=rg(t.sample_values),h=typeof t.score=="number"?t.score:0,m=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:s,reason:r,dtype:i,unique_count:l,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:p,score:h,selectable:m}}).filter(t=>!!t),y5=e=>{if(!e||typeof e!="object")return{...sg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,r=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,l=rg(e.high_cardinality_columns),u=rg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:r,autoDetectDefault:i,highCardinalityColumns:l,notes:u}},v5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isLabelEncodingNode:i}=e,[l,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,_]=x.useState({...sg}),[v,y]=x.useState(0);x.useEffect(()=>{let N=!0;const j=C=>{h([]),_({...sg}),u(!1),f(C??null)};return i?t?n?(u(!0),f(null),hw(t,{graph:s??null,targetNodeId:r??null}).then(C=>{N&&(h(_5(C)),_(y5(C)))}).catch(C=>{if(!N)return;const M=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load label encoding suggestions";j(M)}).finally(()=>{N&&u(!1)}),()=>{N=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{N=!1}):(j(),()=>{N=!1}):(j(),()=>{N=!1})},[s,n,i,v,t,r]);const b=x.useCallback(()=>{!i||!t||!n||y(N=>N+1)},[n,i,t]),w=x.useMemo(()=>m,[m]),E=x.useMemo(()=>p,[p]);return{isFetching:l,error:d,suggestions:E,metadata:w,refresh:b}},ag={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},x5=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},og=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],b5=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=x5(t.status),r=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,l=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,p=og(t.sample_values),h=typeof t.score=="number"?t.score:0,m=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:r,dtype:i,unique_count:l,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:p,score:h,selectable:m,recommended_use_global_fallback:_}}).filter(t=>!!t),w5=e=>{if(!e||typeof e!="object")return{...ag};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,r=Number(e.recommended_count??0)||0,i=!!e.enable_global_fallback_default,l=og(e.high_cardinality_columns),u=og(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:r,autoDetectDefault:d,enableGlobalFallbackDefault:i,highCardinalityColumns:l,notes:u}},N5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isTargetEncodingNode:i}=e,[l,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,_]=x.useState({...ag}),[v,y]=x.useState(0);x.useEffect(()=>{let N=!0;const j=C=>{h([]),_({...ag}),u(!1),f(C??null)};return i?t?n?(u(!0),f(null),pw(t,{graph:s??null,targetNodeId:r??null}).then(C=>{N&&(h(b5(C)),_(w5(C)))}).catch(C=>{if(!N)return;const M=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load target encoding suggestions";j(M)}).finally(()=>{N&&u(!1)}),()=>{N=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{N=!1}):(j(),()=>{N=!1}):(j(),()=>{N=!1})},[s,n,i,v,t,r]);const b=x.useCallback(()=>{!i||!t||!n||y(N=>N+1)},[n,i,t]),w=x.useMemo(()=>m,[m]),E=x.useMemo(()=>p,[p]);return{isFetching:l,error:d,suggestions:E,metadata:w,refresh:b}},Nm={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},j5=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},ig=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],S5=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=j5(t.status),r=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,l=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,p=ig(t.sample_values),h=typeof t.score=="number"?t.score:0,m=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:s,reason:r,dtype:i,unique_count:l,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:p,score:h,selectable:m,recommended_bucket_count:_}}).filter(t=>!!t),E5=e=>{if(!e||typeof e!="object")return{...Nm};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,r=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,l=Number(e.suggested_bucket_default??0)||0,u=ig(e.high_cardinality_columns),d=ig(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:r,autoDetectDefault:i,suggestedBucketDefault:l,highCardinalityColumns:u,notes:d}},C5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isHashEncodingNode:i}=e,[l,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,_]=x.useState({...Nm}),[v,y]=x.useState(0),b=x.useCallback(N=>{h([]),_({...Nm}),u(!1),f(N??null)},[]);x.useEffect(()=>{let N=!0;return i?t?n?(u(!0),f(null),gw(t,{graph:s??null,targetNodeId:r??null}).then(j=>{N&&(h(S5(j)),_(E5(j)))}).catch(j=>{N&&(h([]),_({...Nm}),f(j!=null&&j.message?String(j.message):"Unable to load hash encoding suggestions"))}).finally(()=>{N&&u(!1)}),()=>{N=!1}):(b("Connect this node to the dataset input to load suggestions."),()=>{N=!1}):(b(),()=>{N=!1}):(b(),()=>{N=!1})},[s,n,i,b,t,r,v]);const w=x.useCallback(()=>{y(N=>N+1)},[]);return x.useMemo(()=>({isFetching:l,error:d,suggestions:p,metadata:m,refresh:w}),[d,l,m,w,p])},lg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},k5=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},cg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],M5=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=k5(t.status),r=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,l=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,p=cg(t.sample_values),h=typeof t.score=="number"?t.score:0,m=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:r,dtype:i,unique_count:l,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:p,score:h,selectable:m,recommended_handle_unknown:_}}).filter(t=>!!t),A5=e=>{if(!e||typeof e!="object")return{...lg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,r=Number(e.recommended_count??0)||0,i=!!e.enable_unknown_default,l=cg(e.high_cardinality_columns),u=cg(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:r,autoDetectDefault:d,enableUnknownDefault:i,highCardinalityColumns:l,notes:u}},O5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isOrdinalEncodingNode:i}=e,[l,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,_]=x.useState({...lg}),[v,y]=x.useState(0);x.useEffect(()=>{let N=!0;const j=C=>{h([]),_({...lg}),u(!1),f(C??null)};return i?t?n?(u(!0),f(null),fw(t,{graph:s??null,targetNodeId:r??null}).then(C=>{N&&(h(M5(C)),_(A5(C)))}).catch(C=>{if(!N)return;const M=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load ordinal encoding suggestions";j(M)}).finally(()=>{N&&u(!1)}),()=>{N=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{N=!1}):(j(),()=>{N=!1}):(j(),()=>{N=!1})},[s,n,i,v,t,r]);const b=x.useCallback(()=>{!i||!t||!n||y(N=>N+1)},[n,i,t]),w=x.useMemo(()=>m,[m]),E=x.useMemo(()=>p,[p]);return{isFetching:l,error:d,suggestions:E,metadata:w,refresh:b}},ug={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},T5=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},dg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],$5=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=T5(t.status),r=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,l=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,p=dg(t.sample_values),h=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,m=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0,v=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:s,reason:r,dtype:i,unique_count:l,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:p,estimated_dummy_columns:h,score:m,selectable:_,recommended_drop_first:v}}).filter(t=>!!t),L5=e=>{if(!e||typeof e!="object")return{...ug};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,r=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,l=dg(e.high_cardinality_columns),u=dg(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:r,cautionedCount:i,highCardinalityColumns:l,notes:u,autoDetectDefault:d}},z5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isDummyEncodingNode:i}=e,[l,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,_]=x.useState({...ug}),[v,y]=x.useState(0);x.useEffect(()=>{let N=!0;const j=C=>{h([]),_({...ug}),u(!1),f(C??null)};return i?t?n?(u(!0),f(null),yw(t,{graph:s??null,targetNodeId:r??null}).then(C=>{N&&(h($5(C)),_(L5(C)))}).catch(C=>{if(!N)return;const M=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load dummy encoding suggestions";j(M)}).finally(()=>{N&&u(!1)}),()=>{N=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{N=!1}):(j(),()=>{N=!1}):(j(),()=>{N=!1})},[s,n,i,v,t,r]);const b=x.useCallback(()=>{!i||!t||!n||y(N=>N+1)},[n,i,t]),w=x.useMemo(()=>m,[m]),E=x.useMemo(()=>p,[p]);return{isFetching:l,error:d,suggestions:E,metadata:w,refresh:b}},mg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},R5=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},hg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],D5=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=R5(t.status),r=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,l=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,p=hg(t.sample_values),h=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,m=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0,v=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:s,reason:r,dtype:i,unique_count:l,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:p,estimated_dummy_columns:h,score:m,selectable:_,recommended_drop_first:v}}).filter(t=>!!t),P5=e=>{if(!e||typeof e!="object")return{...mg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,r=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,l=hg(e.high_cardinality_columns),u=hg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:r,cautionedCount:i,highCardinalityColumns:l,notes:u}},I5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isOneHotEncodingNode:i}=e,[l,u]=x.useState(!1),[d,f]=x.useState(null),[p,h]=x.useState([]),[m,_]=x.useState({...mg}),[v,y]=x.useState(0);x.useEffect(()=>{let N=!0;const j=C=>{h([]),_({...mg}),u(!1),f(C??null)};return i?t?n?(u(!0),f(null),_w(t,{graph:s??null,targetNodeId:r??null}).then(C=>{N&&(h(D5(C)),_(P5(C)))}).catch(C=>{if(!N)return;const M=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load one-hot encoding suggestions";j(M)}).finally(()=>{N&&u(!1)}),()=>{N=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{N=!1}):(j(),()=>{N=!1}):(j(),()=>{N=!1})},[s,n,i,v,t,r]);const b=x.useCallback(()=>{!i||!t||!n||y(N=>N+1)},[n,i,t]),w=x.useMemo(()=>m,[m]),E=x.useMemo(()=>p,[p]);return{isFetching:l,error:d,suggestions:E,metadata:w,refresh:b}},F5=({catalogFlags:e,enableGlobalFallbackDefault:t,encodeMissing:n,handleUnknown:s,setConfigState:r,nodeChangeVersion:i})=>{const{isTargetEncodingNode:l}=e,u=x.useRef(!1);x.useEffect(()=>{u.current=!1},[i]),x.useEffect(()=>{if(!l||!t||u.current)return;const d=typeof n=="boolean"?n:null,f=typeof s=="string"?s.trim().toLowerCase():"";if(d===!0&&f==="global_mean"){u.current=!0;return}r(p=>{const h=typeof(p==null?void 0:p.encode_missing)=="boolean"?p.encode_missing:null,m=typeof(p==null?void 0:p.handle_unknown)=="string"?p.handle_unknown.trim().toLowerCase():"";if(h===!0&&m==="global_mean")return u.current=!0,p;const _={...p};return h!==!0&&(_.encode_missing=!0),m!=="global_mean"&&(_.handle_unknown="global_mean"),u.current=!0,_})},[n,s,l,t,r])},B5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,node:r,configState:i,setConfigState:l,nodeChangeVersion:u})=>{const{isLabelEncodingNode:d,isTargetEncodingNode:f,isHashEncodingNode:p,isOrdinalEncodingNode:h,isDummyEncodingNode:m,isOneHotEncodingNode:_}=e,v=(r==null?void 0:r.id)??null,{isFetching:y,error:b,suggestions:w,metadata:E}=v5({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:v}),{isFetching:N,error:j,suggestions:C,metadata:M}=N5({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:v});F5({catalogFlags:e,enableGlobalFallbackDefault:M.enableGlobalFallbackDefault,encodeMissing:i==null?void 0:i.encode_missing,handleUnknown:i==null?void 0:i.handle_unknown,setConfigState:l,nodeChangeVersion:u});const{isFetching:z,error:D,suggestions:k,metadata:T}=C5({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:v}),{isFetching:A,error:O,suggestions:R,metadata:L}=O5({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:v}),{isFetching:F,error:B,suggestions:q,metadata:I}=z5({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:v}),{isFetching:U,error:V,suggestions:H,metadata:G}=I5({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:v});x.useEffect(()=>{d&&(i!=null&&i.auto_detect)&&E.autoDetectDefault&&l(Q=>({...Q,columns:E.autoDetectDefault}))},[i==null?void 0:i.auto_detect,d,E.autoDetectDefault,l]),x.useEffect(()=>{f&&(i!=null&&i.auto_detect)&&M.autoDetectDefault&&l(Q=>({...Q,columns:M.autoDetectDefault}))},[i==null?void 0:i.auto_detect,f,l,M.autoDetectDefault]),x.useEffect(()=>{p&&(i!=null&&i.auto_detect)&&T.autoDetectDefault&&l(Q=>({...Q,columns:T.autoDetectDefault}))},[i==null?void 0:i.auto_detect,T.autoDetectDefault,p,l]),x.useEffect(()=>{p&&T.suggestedBucketDefault&&l(Q=>({...Q,n_buckets:T.suggestedBucketDefault}))},[T.suggestedBucketDefault,p,l]),x.useEffect(()=>{f&&M.enableGlobalFallbackDefault&&l(Q=>{const ne={};return Q.encode_missing===void 0&&(ne.encode_missing=!0),Q.handle_unknown===void 0&&(ne.handle_unknown="value"),Object.keys(ne).length>0?{...Q,...ne}:Q})},[i==null?void 0:i.encode_missing,i==null?void 0:i.handle_unknown,f,l,M.enableGlobalFallbackDefault]),x.useEffect(()=>{h&&(i!=null&&i.auto_detect)&&L.autoDetectDefault&&l(Q=>({...Q,columns:L.autoDetectDefault}))},[i==null?void 0:i.auto_detect,h,L.autoDetectDefault,l]),x.useEffect(()=>{h&&L.enableUnknownDefault&&l(Q=>Q.handle_unknown===void 0?{...Q,handle_unknown:"use_encoded_value",unknown_value:-1}:Q)},[i==null?void 0:i.handle_unknown,h,L.enableUnknownDefault,l]),x.useEffect(()=>{m&&(i!=null&&i.auto_detect)&&I.autoDetectDefault&&l(Q=>({...Q,columns:I.autoDetectDefault}))},[i==null?void 0:i.auto_detect,I.autoDetectDefault,m,l]);const W=x.useCallback(Q=>{l(ne=>({...ne,columns:Q}))},[l]),J=x.useCallback(Q=>{l(ne=>({...ne,columns:Q}))},[l]),ee=x.useCallback(Q=>{l(ne=>({...ne,columns:Q}))},[l]),Z=x.useCallback(Q=>{l(ne=>({...ne,columns:Q}))},[l]),K=x.useCallback(Q=>{l(ne=>({...ne,columns:Q}))},[l]),X=x.useCallback(Q=>{l(ne=>({...ne,columns:Q}))},[l]);return{labelEncoding:{isFetching:y,error:b,suggestions:w,metadata:E,handleApplyRecommended:W},targetEncoding:{isFetching:N,error:j,suggestions:C,metadata:M,handleApplyRecommended:J},hashEncoding:{isFetching:z,error:D,suggestions:k,metadata:T,handleApplyRecommended:ee},ordinalEncoding:{isFetching:A,error:O,suggestions:R,metadata:L,handleApplyRecommended:Z},dummyEncoding:{isFetching:F,error:B,suggestions:q,metadata:I,handleApplyRecommended:K},oneHotEncoding:{isFetching:U,error:V,suggestions:H,metadata:G,handleApplyRecommended:X}}},H5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isOutlierNode:i}=e,[l,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(!1),[m,_]=x.useState(0),v=x.useCallback(()=>{_(y=>y+1)},[]);return x.useEffect(()=>{let y=!0;return i?t?n?(h(!0),f(null),vw(t,{graph:s,targetNodeId:r}).then(b=>{y&&u(b??null)}).catch(b=>{y&&(u(null),f((b==null?void 0:b.message)??"Unable to load outlier insights"))}).finally(()=>{y&&h(!1)}),()=>{y=!1}):(u(null),f("Connect this step to an upstream output to load outlier insights."),h(!1),()=>{y=!1}):(u(null),f("Select a dataset to load outlier insights."),h(!1),()=>{y=!1}):(u(null),f(null),h(!1),()=>{y=!1})},[s,n,i,m,t,r]),{outlierData:l,outlierError:d,isFetchingOutliers:p,refreshOutliers:v}},U5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isScalingNode:i}=e,[l,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(!1),[m,_]=x.useState(0),v=x.useCallback(()=>{_(y=>y+1)},[]);return x.useEffect(()=>{let y=!0;return i?t?n?(h(!0),f(null),bw(t,{graph:s,targetNodeId:r}).then(b=>{y&&u(b??null)}).catch(b=>{y&&(u(null),f((b==null?void 0:b.message)??"Unable to load scaling insights"))}).finally(()=>{y&&h(!1)}),()=>{y=!1}):(u(null),f("Connect this step to an upstream output to load scaling insights."),h(!1),()=>{y=!1}):(u(null),f("Select a dataset to load scaling insights."),h(!1),()=>{y=!1}):(u(null),f(null),h(!1),()=>{y=!1})},[s,n,i,m,t,r]),{scalingData:l,scalingError:d,isFetchingScaling:p,refreshScaling:v}},q5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r})=>{const{isBinningNode:i}=e,[l,u]=x.useState(null),[d,f]=x.useState(null),[p,h]=x.useState(!1),[m,_]=x.useState(0),v=x.useCallback(()=>{_(y=>y+1)},[]);return x.useEffect(()=>{let y=!0;return i?t?n?(h(!0),f(null),ww(t,{graph:s,targetNodeId:r}).then(b=>{y&&u(b??null)}).catch(b=>{y&&(u(null),f((b==null?void 0:b.message)??"Unable to load binning insights"))}).finally(()=>{y&&h(!1)}),()=>{y=!1}):(u(null),f("Connect this step to an upstream output to analyse numeric columns."),h(!1),()=>{y=!1}):(u(null),f("Select a dataset to load binning insights."),h(!1),()=>{y=!1}):(u(null),f(null),h(!1),()=>{y=!1})},[s,n,i,m,t,r]),{binningData:l,binningError:d,isFetchingBinning:p,refreshBinning:v}},V5=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:r,samplePreset:i})=>{const{isBinnedDistributionNode:l}=e,[u,d]=x.useState(null),[f,p]=x.useState(null),[h,m]=x.useState(!1),[_,v]=x.useState(0),y=x.useCallback(()=>{v(b=>b+1)},[]);return x.useEffect(()=>{let b=!0;if(!l)return d(null),p(null),m(!1),()=>{b=!1};if(!t)return d(null),p("Select a dataset to load binned column distributions."),m(!1),()=>{b=!1};if(!n)return d(null),p("Connect this step to an upstream output to load binned column distributions."),m(!1),()=>{b=!1};m(!0),p(null);const w=Fc.find(N=>N.value===i)??Fc[0],E=w.value==="all"?"all":Number(w.value);return Nw(t,{sampleSize:E,graph:s,targetNodeId:r}).then(N=>{b&&d(N??null)}).catch(N=>{b&&(d(null),p((N==null?void 0:N.message)??"Unable to load binned column distributions"))}).finally(()=>{b&&m(!1)}),()=>{b=!1}},[s,n,l,_,i,t,r]),{binnedDistributionData:u,binnedDistributionError:f,isFetchingBinnedDistribution:h,refreshBinnedDistribution:y}},K5=({catalogFlags:e,sourceId:t,graphContext:n,targetNodeId:s,transformations:r})=>{const{isSkewnessNode:i,isSkewnessDistributionNode:l}=e,u=i||l,[d,f]=x.useState(null),[p,h]=x.useState(null),[m,_]=x.useState(!1),[v,y]=x.useState(0),b=x.useRef(null),w=x.useCallback(()=>{y(E=>E+1)},[]);return x.useEffect(()=>{let E=!0;return u?t?(b.current&&clearTimeout(b.current),b.current=setTimeout(()=>{if(!E)return;_(!0),h(null);let N;r.length>0&&(N=r.map(j=>({column:j.column,method:j.method}))),xw(t,{transformations:N,graph:n,targetNodeId:s}).then(j=>{E&&f(j??null)}).catch(j=>{E&&(f(null),h((j==null?void 0:j.message)??"Unable to load skewness insights"))}).finally(()=>{E&&_(!1)})},300),()=>{E=!1,b.current&&clearTimeout(b.current)}):(f(null),h("Select a dataset to load skewness insights."),_(!1),b.current&&(clearTimeout(b.current),b.current=null),()=>{E=!1}):(f(null),h(null),_(!1),b.current&&(clearTimeout(b.current),b.current=null),()=>{E=!1})},[n,v,u,t,s,r]),{skewnessData:d,skewnessError:p,isFetchingSkewness:m,refreshSkewness:w}},Y5="_was_missing",W5=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const s=typeof t=="string"?t.trim():"";return s||Y5},G5=(e,t)=>{const n=typeof e=="string"?e.trim():"",s=typeof t=="string"?t:"";return!n||!s?!1:n.endsWith(s)},X5=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:s})=>{const r=typeof s=="string"?s:"",i=at(t),l=new Set(i),u=Array.from(new Set(at(e))),d=[];if(u.forEach(h=>{const m=`${h}${r}`,_=n[h],v=typeof _=="number"&&Number.isFinite(_)?Math.max(0,_):null;d.push({column:h,missingPercentage:v,flagColumn:m,conflicts:{alreadyExists:l.has(m),duplicateFlag:!1}})}),d.length>0){const h=new Map;d.forEach(m=>{h.set(m.flagColumn,(h.get(m.flagColumn)??0)+1)}),d.forEach(m=>{m.conflicts.duplicateFlag=(h.get(m.flagColumn)??0)>1})}d.sort((h,m)=>{const _=h.missingPercentage,v=m.missingPercentage,y=typeof _=="number",b=typeof v=="number";return y&&b&&_!==v?v-_:y!==b?y?-1:1:h.column.localeCompare(m.column)});const f=r?Array.from(new Set(i.filter(h=>G5(h,r)))):[],p=d.reduce((h,m)=>m.conflicts.alreadyExists||m.conflicts.duplicateFlag?h+1:h,0);return{rows:d,flaggedColumnsInDataset:f,conflictCount:p}},Q5=({catalogFlags:e,configState:t,node:n,availableColumns:s,columnMissingMap:r})=>{var f,p;const{isMissingIndicatorNode:i}=e,l=x.useMemo(()=>{var h,m;return i?W5(t==null?void 0:t.flag_suffix,(m=(h=n==null?void 0:n.data)==null?void 0:h.config)==null?void 0:m.flag_suffix):""},[t==null?void 0:t.flag_suffix,i,(p=(f=n==null?void 0:n.data)==null?void 0:f.config)==null?void 0:p.flag_suffix]),u=x.useMemo(()=>i?at(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,i]),d=x.useMemo(()=>i?X5({selectedColumns:u,availableColumns:s,columnMissingMap:r,suffix:l}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[l,s,r,i,u]);return{activeFlagSuffix:l,missingIndicatorColumns:u,missingIndicatorInsights:d}},Qj={enabled:!1,explicit:!1},Z5={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},J5={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},e4={},t4=[],n4=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i})=>{const{isReplaceAliasesNode:l}=e,u=x.useMemo(()=>{if(!l)return Qj;const b=Nl(t);if(b!==void 0)return{enabled:!!si(b),explicit:!0};if(n&&typeof n=="object"){const w=Nl(n);if(w!==void 0)return{enabled:!!si(w),explicit:!0}}return Qj},[t,l,n]),d=x.useMemo(()=>{if(!l)return[];const b=at((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),w=sm(l?t==null?void 0:t.mode:void 0,l?n==null?void 0:n.mode:void 0),E=(()=>{const j=Nl(t);if(j!==void 0){const C=si(j);if(C!==null)return C}if(n&&typeof n=="object"){const C=Nl(n);if(C!==void 0){const M=si(C);if(M!==null)return M}}return b.length===0})(),N=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return rN(N,{mode:w,columns:b,autoDetect:E})},[t,l,n]),f=x.useMemo(()=>l?d.length?Array.from(new Set(d.flatMap(b=>b.columns.map(w=>w.trim()).filter(Boolean)))).sort((b,w)=>b.localeCompare(w)):at(t==null?void 0:t.columns):[],[d,t==null?void 0:t.columns,l]),p=x.useMemo(()=>l?d.length?d.some(b=>b.autoDetect):u.explicit?u.enabled:f.length===0:!1,[u.enabled,u.explicit,f.length,d,l]),h=x.useMemo(()=>{if(l)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,l]),m=x.useMemo(()=>l?fD(i):e4,[l,i]),_=x.useMemo(()=>l?lD({selectedColumns:f,availableColumns:s,columnTypeMap:r,autoDetectEnabled:p}):Z5,[p,f,s,r,l]),v=x.useMemo(()=>l?uD(h):J5,[l,h]),y=x.useMemo(()=>{if(!l)return t4;const b=new Set(_.recommendedColumns),w=new Set(_.textColumns);return s.map(E=>{const N=r[E]??null,j=m[E]??[];return{name:E,dtype:N,samples:j.slice(0,3),isRecommended:b.has(E),isTextLike:w.has(E)}})},[_.recommendedColumns,_.textColumns,m,s,r,l]);return{aliasAutoDetectMeta:u,aliasStrategies:d,aliasStrategyCount:d.length,aliasSelectedColumns:f,aliasAutoDetectEnabled:p,replaceAliasesCustomPairsValue:h,aliasColumnSummary:_,aliasCustomPairSummary:v,aliasSampleMap:m,aliasColumnOptions:y}},s4=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i})=>{const{isTrimWhitespaceNode:l,isRemoveSpecialCharsNode:u,isRegexCleanupNode:d,isNormalizeTextCaseNode:f}=e,p=x.useMemo(()=>VD(l?t==null?void 0:t.mode:void 0,l?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,l,n==null?void 0:n.mode]),h=x.useMemo(()=>l?at(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,l]),m=x.useMemo(()=>l?ZD(i):{},[l,i]),_=x.useMemo(()=>l?WD({selectedColumns:h,availableColumns:s,columnTypeMap:r,sampleMap:m}):eP,[s,r,l,h,m]),v=x.useMemo(()=>KD(p),[p]),y=x.useMemo(()=>mP(u?t==null?void 0:t.mode:void 0,u?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,u,n==null?void 0:n.mode]),b=x.useMemo(()=>u?at(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,u]),w=x.useMemo(()=>u?_P(i):{},[u,i]),E=x.useMemo(()=>u?pP({selectedColumns:b,availableColumns:s,columnTypeMap:r,sampleMap:w}):vP,[s,r,u,b,w]),N=x.useMemo(()=>hP(y),[y]),j=x.useMemo(()=>VP(d?t==null?void 0:t.mode:void 0,d?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,d,n==null?void 0:n.mode]),C=x.useMemo(()=>d?at(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,d]),M=x.useMemo(()=>d?XP(i):{},[d,i]),z=x.useMemo(()=>d?WP({selectedColumns:C,availableColumns:s,columnTypeMap:r,sampleMap:M}):JP,[s,r,d,C,M]),D=x.useMemo(()=>KP(j),[j]),k=x.useMemo(()=>{if(!d)return null;const F=(t==null?void 0:t.replacement)??(n==null?void 0:n.replacement)??null;return typeof F=="string"?F:null},[t==null?void 0:t.replacement,d,n==null?void 0:n.replacement]),T=x.useMemo(()=>MP(f?t==null?void 0:t.mode:void 0,f?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,f,n==null?void 0:n.mode]),A=x.useMemo(()=>f?at(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,f]),O=x.useMemo(()=>f?LP(i):{},[f,i]),R=x.useMemo(()=>f?TP({selectedColumns:A,availableColumns:s,columnTypeMap:r,sampleMap:O,mode:T}):RP,[s,r,f,A,T,O]),L=x.useMemo(()=>AP(T),[T]);return{trimWhitespace:{columnSummary:_,sampleMap:m,modeDetails:v},removeSpecial:{columnSummary:E,sampleMap:w,modeDetails:N,selectedMode:y},regexCleanup:{columnSummary:z,sampleMap:M,modeDetails:D,selectedMode:j,replacementValue:k},normalizeCase:{columnSummary:R,sampleMap:O,modeDetails:L,selectedMode:T}}},r4={},a4=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i})=>{const{isReplaceInvalidValuesNode:l}=e,u=x.useMemo(()=>uI(l?t==null?void 0:t.mode:void 0,l?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,l,n==null?void 0:n.mode]),d=x.useMemo(()=>l?at(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,l]),f=x.useMemo(()=>{if(!l)return null;const v=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),y=Number(v);return Number.isFinite(y)?y:null},[t==null?void 0:t.min_value,l,n==null?void 0:n.min_value]),p=x.useMemo(()=>{if(!l)return null;const v=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),y=Number(v);return Number.isFinite(y)?y:null},[t==null?void 0:t.max_value,l,n==null?void 0:n.max_value]),h=x.useMemo(()=>l?pI(i):r4,[l,i]),m=x.useMemo(()=>l?hI({selectedColumns:d,availableColumns:s,columnTypeMap:r,sampleMap:h}):NI,[s,r,l,h,d]),_=x.useMemo(()=>dI(u),[u]);return{selectedColumns:d,selectedMode:u,modeDetails:_,sampleMap:h,columnSummary:m,minValue:f,maxValue:p}},o4={},i4=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i})=>{const{isStandardizeDatesNode:l}=e,u=x.useMemo(()=>pN(l?t==null?void 0:t.mode:void 0,l?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,l,n==null?void 0:n.mode]),d=x.useMemo(()=>l?at((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,l,n==null?void 0:n.columns]),f=x.useMemo(()=>{if(!l)return[];const y={columns:d,mode:u,autoDetect:d.length===0};return gN((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),y)},[t==null?void 0:t.format_strategies,l,d,n==null?void 0:n.format_strategies,u]),p=x.useMemo(()=>{if(!l)return[];const y=new Set;return f.forEach(b=>{b.columns.forEach(w=>{const E=w.trim();E&&y.add(E)})}),Array.from(y).sort((b,w)=>b.localeCompare(w))},[l,f]),h=x.useMemo(()=>f.some(y=>y.autoDetect),[f]),m=x.useMemo(()=>l?zD(i):o4,[l,i]),_=x.useMemo(()=>{if(!l)return RD;const y=MD({selectedColumns:p,availableColumns:s,columnTypeMap:r,sampleMap:m});return h?{...y,autoDetectionActive:!0}:y},[s,r,h,l,m,p]),v=x.useMemo(()=>{if(!l)return[];const y=new Set(_.recommendedColumns),b=new Set(_.sampleCandidates);return s.map(w=>{const E=r[w]??null,N=m[w]??[];return{name:w,dtype:E,samples:N.slice(0,3),isRecommended:y.has(w),isSampleCandidate:b.has(w)}})},[s,_,r,l,m]);return{selectedMode:u,strategies:f,sampleMap:m,columnSummary:_,columnOptions:v}},l4=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i})=>{const{isReplaceAliasesNode:l,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isRegexCleanupNode:f,isNormalizeTextCaseNode:p,isReplaceInvalidValuesNode:h,isStandardizeDatesNode:m}=e,{aliasAutoDetectMeta:_,aliasStrategies:v,aliasStrategyCount:y,aliasSelectedColumns:b,aliasAutoDetectEnabled:w,replaceAliasesCustomPairsValue:E,aliasColumnSummary:N,aliasCustomPairSummary:j,aliasSampleMap:C,aliasColumnOptions:M}=n4({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i}),{trimWhitespace:z,removeSpecial:D,regexCleanup:k,normalizeCase:T}=s4({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i}),{selectedMode:A,modeDetails:O,sampleMap:R,columnSummary:L,minValue:F,maxValue:B}=a4({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i}),{selectedMode:q,strategies:I,sampleMap:U,columnSummary:V,columnOptions:H}=i4({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:r,previewSampleRows:i});return{alias:{autoDetectMeta:_,strategies:v,strategyCount:y,selectedColumns:b,autoDetectEnabled:w,customPairsValue:E,columnSummary:N,customPairSummary:j,sampleMap:C,columnOptions:M},trimWhitespace:z,removeSpecial:D,regexCleanup:k,normalizeCase:T,replaceInvalid:{mode:A,modeDetails:O,sampleMap:R,columnSummary:L,minValue:F,maxValue:B},standardizeDates:{mode:q,strategies:I,sampleMap:U,columnSummary:V,columnOptions:H}}},c4=["int","float","double","decimal","number","numeric","long","short"],u4=["datetime","date","time","timestamp"],d4=["object","string","text","category","categorical","char"],m4=({catalogFlags:e,availableColumns:t,columnTypeMap:n,previewSampleRows:s})=>{const{isBinningNode:r,isScalingNode:i,isOutlierNode:l}=e,u=r||i||l,d=x.useMemo(()=>{if(!u)return{excluded:new Set,reasons:new Map};const f=new Set,p=new Map;return t.forEach(h=>{const m=(n[h]??"").toLowerCase(),_=c4.some(C=>m.includes(C)),v=u4.some(C=>m.includes(C)),y=d4.some(C=>m.includes(C));if(m.includes("bool")){f.add(h),p.set(h,"Boolean dtype");return}if((v||y)&&!_){f.add(h),p.set(h,"Non-numeric dtype");return}const b=s.map(C=>C&&Object.prototype.hasOwnProperty.call(C,h)?C[h]:void 0).filter(C=>C!=null);if(!b.length){_||(f.add(h),p.set(h,"No numeric samples"));return}let w=!0,E=!1,N=!1;const j=new Set;for(const C of b){if(typeof C=="boolean"){j.add(C?"1":"0");continue}if(typeof C=="number"){if(!Number.isFinite(C)){w=!1;break}E=!0,Math.abs(C)<1e-9?j.add("0"):Math.abs(C-1)<1e-9?j.add("1"):N=!0;continue}if(typeof C=="string"){const M=C.trim();if(!M)continue;const z=M.toLowerCase();if(gj.has(z)){j.add("1");continue}if(_j.has(z)){j.add("0");continue}const D=Number(M);if(!Number.isNaN(D)&&Number.isFinite(D)){E=!0,Math.abs(D)<1e-9?j.add("0"):Math.abs(D-1)<1e-9?j.add("1"):N=!0;continue}w=!1;break}w=!1;break}if(!w||!E&&!_){f.add(h),p.set(h,"Non-numeric values");return}!N&&j.size>0&&Array.from(j).every(M=>M==="0"||M==="1")&&(f.add(h),p.set(h,"Binary/bool-like values"))}),{excluded:f,reasons:p}},[t,n,s,u]);return{numericExcludedColumns:d.excluded,numericExclusionReasons:d.reasons}},h4=({catalogFlags:e,configState:t,numericExcludedColumns:n,scalingData:s})=>{const{isScalingNode:r}=e,i=x.useMemo(()=>Bj(t),[t]),l=x.useMemo(()=>new Set(i.skippedColumns),[i.skippedColumns]),u=x.useMemo(()=>r?n:new Set,[r,n]),d=x.useMemo(()=>r?new Set(i.columns):new Set,[r,i.columns]),f=x.useMemo(()=>new Set(Object.keys(i.columnMethods)),[i.columnMethods]),p=x.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(R=>!!(R&&R.column)):[],[s==null?void 0:s.columns]),h=x.useMemo(()=>XF(s==null?void 0:s.methods),[s==null?void 0:s.methods]),m=x.useMemo(()=>QF(s==null?void 0:s.methods),[s==null?void 0:s.methods]),_=x.useMemo(()=>JF({recommendations:p,scalingConfig:i,scalingMethodLabelMap:h,scalingSelectedSet:d,scalingSkippedColumns:l,scalingExcludedColumns:u}),[p,i,h,d,l,u]),v=x.useMemo(()=>Array.from(f).sort((R,L)=>R.localeCompare(L)),[f]),y=x.useMemo(()=>v.slice(0,4),[v]),b=_.length,w=f.size,E=d.size,N=i.autoDetect,j=x.useMemo(()=>m.get(i.defaultMethod)??null,[i.defaultMethod,m]),C=x.useMemo(()=>{const R=i.defaultMethod;return h[R]??ii[R]??R},[i.defaultMethod,h]),M=b>0,z=x.useMemo(()=>_.filter(R=>!R.isSkipped&&!R.isExcluded&&R.isSelected&&R.recommendedMethod!==R.currentMethod).length,[_]),D=x.useMemo(()=>_.filter(R=>R.isSelected&&!R.isSkipped&&!R.isExcluded).length,[_]),k=x.useMemo(()=>_.filter(R=>R.isSkipped&&!R.isExcluded).length,[_]),T=x.useMemo(()=>_.length?z>0?`${z} column${z===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:D>0?"All configured columns align with the recommended scalers.":k>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[z,D,_,k]),A=x.useMemo(()=>ZF(h),[h]),O=x.useMemo(()=>e5(y,i.columnMethods,h,w),[y,i.columnMethods,h,w]);return{scalingConfig:i,scalingExcludedColumns:u,scalingMethodDetailMap:m,scalingMethodOptions:A,scalingRecommendations:p,scalingRecommendationRows:_,scalingSelectedCount:E,scalingOverrideCount:w,scalingDefaultDetail:j,scalingDefaultLabel:C,scalingAutoDetectEnabled:N,scalingHasRecommendations:M,scalingStatusMessage:T,scalingOverrideExampleSummary:O}},nr=["iqr","zscore","elliptic_envelope","winsorize","manual"],El={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},jm={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},ro={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Sm=(e,{min:t,max:n}={})=>{const s=typeof e=="number"?e:Number(e);if(!Number.isFinite(s))return null;let r=s;return typeof t=="number"&&Number.isFinite(t)&&r<t&&(r=t),typeof n=="number"&&Number.isFinite(n)&&r>n&&(r=n),r},Zj=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const s=String(n??"").trim();s&&t.push(s)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,s)=>n.localeCompare(s))},f4=e=>{const t={iqr:{...ro.iqr},zscore:{...ro.zscore},elliptic_envelope:{...ro.elliptic_envelope},winsorize:{...ro.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,s])=>{const r=n.trim().toLowerCase();if(!nr.includes(r))return;const i=t[r]??{};if(!(!s||typeof s!="object"||Array.isArray(s))){if(Object.entries(s).forEach(([l,u])=>{const d=l.trim().toLowerCase();if(!jm[r].includes(d))return;let f={};d==="threshold"?f={min:.1}:d==="multiplier"?f={min:.1}:(d==="lower_percentile"||d==="upper_percentile")&&(f={min:0,max:100});const p=Sm(u,f);p!==null&&(i[d]=p)}),r==="winsorize"){const l=Sm(i.lower_percentile,{min:0,max:100}),u=Sm(i.upper_percentile,{min:0,max:100});typeof l=="number"&&typeof u=="number"&&l>=u?(i.lower_percentile=ro.winsorize.lower_percentile,i.upper_percentile=ro.winsorize.upper_percentile):(typeof l=="number"&&(i.lower_percentile=l),typeof u=="number"&&(i.upper_percentile=u))}t[r]=i}}),t},p4=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,s])=>{const r=String(n??"").trim();if(!r||!s||typeof s!="object"||Array.isArray(s))return;const i={};Object.entries(s).forEach(([l,u])=>{const d=l.trim().toLowerCase();if(!Object.values(jm).some(m=>m.includes(d)))return;let p={};d==="threshold"?p={min:.1}:d==="multiplier"?p={min:.1}:d==="contamination"?p={min:1e-4,max:.49}:(d==="lower_percentile"||d==="upper_percentile")&&(p={min:0,max:100});const h=Sm(u,p);h!==null&&(i[d]=h)}),Object.keys(i).length&&(t[r]=i)}),t},g4=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=Zj(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",r=nr.includes(s)?s:"iqr",i={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([p,h])=>{const m=String(p??"").trim(),_=typeof h=="string"?h.trim().toLowerCase():"";m&&nr.includes(_)&&(i[m]=_)});const l=typeof t.auto_detect=="boolean"?t.auto_detect:!0,u=Zj(t.skipped_columns),d=f4(t.method_parameters),f=p4(t.column_parameters);return{columns:n,defaultMethod:r,columnMethods:i,autoDetect:l,skippedColumns:u,methodParameters:d,columnParameters:f}},_4=e=>{const t={...El};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,r=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&r&&nr.includes(s)&&(t[s]=r)}),t},y4=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&nr.includes(s)&&t.set(s,n)}),t},v4=e=>nr.map(t=>({value:t,label:e[t]??El[t]??t})),x4=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:s,skippedColumns:r,excludedColumns:i})=>{if(!e.length)return[];const l=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const f={};Array.isArray(u==null?void 0:u.method_summaries)&&u.method_summaries.forEach(N=>{const j=N==null?void 0:N.method;j&&nr.includes(j)&&(f[j]=N)});const p=u!=null&&u.recommended_method&&nr.includes(u.recommended_method)?u.recommended_method:null,h=p?n[p]??El[p]??p:null,m=t.columnMethods[d]??null,_=m??t.defaultMethod,v=n[_]??El[_]??_,y=r.has(d),b=i.has(d),w=s.has(d),E=!!(u!=null&&u.has_missing);l.push({column:d,dtype:typeof(u==null?void 0:u.dtype)=="string"?u.dtype:null,stats:(u==null?void 0:u.stats)??{},recommendedMethod:p,recommendedLabel:h,recommendedReason:typeof(u==null?void 0:u.recommended_reason)=="string"?u.recommended_reason:null,methodSummaries:f,currentOverride:m,currentMethod:_,currentMethodLabel:v,isOverrideApplied:m!==null,isSelected:w,isSkipped:y,isExcluded:b,hasMissing:E})}),l.sort((u,d)=>u.column.localeCompare(d.column)),l},b4=(e,t,n,s)=>{if(!e.length)return null;const r=e.map(i=>{const l=t[i],u=l?n[l]??El[l]??l:null;return u?`${i} -> ${u}`:i});return s>e.length&&r.push(""),r.join(", ")},w4=({catalogFlags:e,configState:t,numericExcludedColumns:n,outlierData:s})=>{const{isOutlierNode:r}=e,i=x.useMemo(()=>g4(t),[t]),l=x.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(R=>!!(R&&R.column)):[],[s==null?void 0:s.columns]),u=x.useMemo(()=>new Set(i.skippedColumns),[i.skippedColumns]),d=x.useMemo(()=>r?new Set(i.columns):new Set,[r,i.columns]),f=x.useMemo(()=>{if(!r||!n.size)return new Set;const R=new Set;i.columns.forEach(F=>{const B=String(F??"").trim();B&&R.add(B)}),l.forEach(F=>{const B=String((F==null?void 0:F.column)??"").trim();B&&R.add(B)});const L=new Set;return n.forEach(F=>{R.has(F)||L.add(F)}),L},[r,n,i.columns,l]),p=x.useMemo(()=>new Set(Object.keys(i.columnMethods)),[i.columnMethods]),h=x.useMemo(()=>_4(s==null?void 0:s.methods),[s==null?void 0:s.methods]),m=x.useMemo(()=>y4(s==null?void 0:s.methods),[s==null?void 0:s.methods]),_=x.useMemo(()=>x4({insights:l,outlierConfig:i,labelMap:h,selectedColumns:d,skippedColumns:u,excludedColumns:f}),[l,i,h,d,u,f]),v=x.useMemo(()=>v4(h),[h]),y=x.useMemo(()=>Array.from(p).sort((R,L)=>R.localeCompare(L)),[p]),b=x.useMemo(()=>y.slice(0,4),[y]),w=d.size,E=p.size,N=x.useMemo(()=>Object.keys(i.columnParameters).length,[i.columnParameters]),j=i.autoDetect,C=x.useMemo(()=>m.get(i.defaultMethod)??null,[i.defaultMethod,m]),M=x.useMemo(()=>{const R=i.defaultMethod;return h[R]??El[R]??R},[i.defaultMethod,h]),z=_.length>0,D=x.useMemo(()=>_.filter(R=>R.isSkipped||R.isExcluded||!R.isSelected||!R.recommendedMethod?!1:R.recommendedMethod!==R.currentMethod).length,[_]),k=x.useMemo(()=>_.filter(R=>R.isSelected&&!R.isSkipped&&!R.isExcluded).length,[_]),T=x.useMemo(()=>_.filter(R=>R.isSkipped&&!R.isExcluded).length,[_]),A=x.useMemo(()=>_.length?D>0?`${D} column${D===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:k>0?"All configured columns align with the recommended outlier handling strategies.":T>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[D,k,_,T]),O=x.useMemo(()=>b4(b,i.columnMethods,h,E),[b,i.columnMethods,h,E]);return{outlierConfig:i,outlierExcludedColumns:f,outlierMethodLabelMap:h,outlierMethodDetailMap:m,outlierMethodOptions:v,outlierRecommendations:l,outlierRecommendationRows:_,outlierSelectedCount:w,outlierOverrideCount:E,outlierParameterOverrideCount:N,outlierDefaultDetail:C,outlierDefaultLabel:M,outlierAutoDetectEnabled:j,outlierHasRecommendations:z,outlierStatusMessage:A,outlierOverrideExampleSummary:O}},N4=({configState:e,nodeId:t})=>{const n=x.useMemo(()=>Yw(e),[e]),s=n.columns.length,r=Ap[n.strategy]??n.strategy,i=x.useMemo(()=>Object.keys(n.columnStrategies).map(v=>v.trim()).filter(Boolean).sort((v,y)=>v.localeCompare(y)),[n.columnStrategies]),l=i.length,u=x.useMemo(()=>{if(!i.length)return null;const v=i.slice(0,4);return NR(v,n.columnStrategies,l)},[n.columnStrategies,i,l]),d=x.useMemo(()=>`binning-${t||"node"}`,[t]),f=x.useMemo(()=>({equalWidth:`${d}-equal-width-bins`,equalFrequency:`${d}-equal-frequency-bins`,precision:`${d}-precision`,suffix:`${d}-suffix`,missingLabel:`${d}-missing-label`,includeLowest:`${d}-include-lowest`,dropOriginal:`${d}-drop-original`,labelFormat:`${d}-label-format`,duplicates:`${d}-duplicates`,kbinsNBins:`${d}-kbins-n-bins`,kbinsEncode:`${d}-kbins-encode`,kbinsStrategy:`${d}-kbins-strategy`}),[d]),[p,h]=x.useState({}),[m,_]=x.useState({});return x.useEffect(()=>{h(v=>{const y=new Set,b={...v};return n.columns.forEach(w=>{const E=String(w??"").trim();if(!E||(y.add(E),Object.prototype.hasOwnProperty.call(b,E)))return;const N=n.customBins[E]??[];b[E]=N.length>=2?N.join(", "):""}),Object.keys(b).forEach(w=>{y.has(w)||delete b[w]}),b})},[n.columns,n.customBins]),x.useEffect(()=>{_(v=>{const y=new Set,b={...v};return n.columns.forEach(w=>{const E=String(w??"").trim();if(!E||(y.add(E),Object.prototype.hasOwnProperty.call(b,E)))return;const N=n.customLabels[E]??[];b[E]=N.length>0?N.join(", "):""}),Object.keys(b).forEach(w=>{y.has(w)||delete b[w]}),b})},[n.columns,n.customLabels]),{binningConfig:n,binningSelectedCount:s,binningDefaultLabel:r,binningOverrideColumns:i,binningOverrideCount:l,binningOverrideSummary:u,fieldIds:f,customEdgeDrafts:p,setCustomEdgeDrafts:h,customLabelDrafts:m,setCustomLabelDrafts:_}},j4=({setConfigState:e,setBinningCustomEdgeDrafts:t,setBinningCustomLabelDrafts:n,binningConfig:s,binningInsightsRecommendations:r,binningAllNumericColumns:i})=>{const l=x.useCallback((k,T,A,O)=>{e(R=>{const L=typeof(R==null?void 0:R[k])=="number"&&Number.isFinite(R[k])?R[k]:void 0;if(T===""){if(L===void 0)return R;const q={...R};return delete q[k],q}const F=Number(T);if(!Number.isFinite(F))return R;const B=Math.min(Math.max(Math.round(F),A),O);return L===B?R:{...R,[k]:B}})},[e]),u=x.useCallback((k,T)=>{e(A=>!!(A!=null&&A[k])===T?A:{...A,[k]:T})},[e]),d=x.useCallback(k=>{const T=k.trim();e(A=>{const O=typeof(A==null?void 0:A.output_suffix)=="string"?A.output_suffix:"";if(!T){if(!O)return A;const R={...A};return delete R.output_suffix,R}return O===T?A:{...A,output_suffix:T}})},[e]),f=x.useCallback(k=>{e(T=>{const A=typeof(T==null?void 0:T.label_format)=="string"?T.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(A)?A:"range")===k?T:{...T,label_format:k}})},[e]),p=x.useCallback(k=>{e(T=>{if(((T==null?void 0:T.missing_strategy)==="label"?"label":"keep")===k)return T;const O={...T,missing_strategy:k};return k!=="label"&&Object.prototype.hasOwnProperty.call(O,"missing_label")&&delete O.missing_label,O})},[e]),h=x.useCallback(k=>{const T=k.trim();e(A=>{const O=typeof(A==null?void 0:A.missing_label)=="string"?A.missing_label:"";if(!T){if(!O)return A;const R={...A};return delete R.missing_label,R}return O===T?A:{...A,missing_label:T}})},[e]),m=x.useCallback((k,T)=>{const A=String(k??"").trim();A&&(t(O=>({...O,[A]:T})),e(O=>{const R=O==null?void 0:O.custom_bins,L=R&&typeof R=="object"&&!Array.isArray(R)?R:{},F=Array.isArray(L[A])?L[A]:void 0,q=T.split(/[,\n]/).map(H=>H.trim()).filter(Boolean).map(H=>Number(H)).filter(H=>Number.isFinite(H)).sort((H,G)=>H-G).filter((H,G,W)=>G===0||H!==W[G-1]),I=q.length>=2;if(I&&F&&F.length===q.length&&F.every((H,G)=>H===q[G])||!I&&!F)return O;const U={...O},V={...L};return I?V[A]=q:delete V[A],Object.keys(V).length>0?U.custom_bins=V:delete U.custom_bins,U}))},[t,e]),_=x.useCallback((k,T)=>{const A=String(k??"").trim();A&&(n(O=>({...O,[A]:T})),e(O=>{const R=O==null?void 0:O.custom_labels,L=R&&typeof R=="object"&&!Array.isArray(R)?R:{},F=Array.isArray(L[A])?L[A]:void 0,B=T.split(/[,\n]/).map(U=>U.trim()).filter(Boolean);if(B.length>0&&F&&F.length===B.length&&F.every((U,V)=>U===B[V])||B.length===0&&!F)return O;const q={...O},I={...L};return B.length>0?I[A]=B:delete I[A],Object.keys(I).length>0?q.custom_labels=I:delete q.custom_labels,q}))},[n,e]),v=x.useCallback(k=>{const T=String(k??"").trim();T&&(t(A=>{if(!Object.prototype.hasOwnProperty.call(A,T))return A;const O={...A};return delete O[T],O}),n(A=>{if(!Object.prototype.hasOwnProperty.call(A,T))return A;const O={...A};return delete O[T],O}),e(A=>{let O=!1;const R={...A};if(A!=null&&A.custom_bins&&typeof A.custom_bins=="object"&&!Array.isArray(A.custom_bins)&&Object.prototype.hasOwnProperty.call(A.custom_bins,T)){const L={...A.custom_bins};delete L[T],Object.keys(L).length>0?R.custom_bins=L:delete R.custom_bins,O=!0}if(A!=null&&A.custom_labels&&typeof A.custom_labels=="object"&&!Array.isArray(A.custom_labels)&&Object.prototype.hasOwnProperty.call(A.custom_labels,T)){const L={...A.custom_labels};delete L[T],Object.keys(L).length>0?R.custom_labels=L:delete R.custom_labels,O=!0}return O?R:A}))},[t,n,e]),y=x.useCallback((k,T)=>{const A=String(k??"").trim();A&&e(O=>{const L={...O!=null&&O.column_strategies&&typeof O.column_strategies=="object"&&!Array.isArray(O.column_strategies)?O.column_strategies:O!=null&&O.column_overrides&&typeof O.column_overrides=="object"&&!Array.isArray(O.column_overrides)?O.column_overrides:{}},F=L[A],B=F&&typeof F=="object"&&!Array.isArray(F)?{...F}:{},q=T(B),I=!!(q&&Object.keys(q).length);I?L[A]=q:delete L[A];const U={...O};if(I){const V=new Set(at(O==null?void 0:O.columns));V.has(A)||(V.add(A),U.columns=Array.from(V).sort((H,G)=>H.localeCompare(G)))}return Object.keys(L).length?(U.column_overrides=L,U.column_strategies=L):(Object.prototype.hasOwnProperty.call(U,"column_overrides")&&delete U.column_overrides,Object.prototype.hasOwnProperty.call(U,"column_strategies")&&delete U.column_strategies),U})},[e]),b=x.useCallback((k,T,A)=>{const O=String(k??"").trim();if(!O)return;if(T==="__default__"){v(O),y(O,()=>null);return}const R=Number.isFinite(A==null?void 0:A.recommendedBins)?Math.round(A.recommendedBins):null;y(O,L=>{const F={...L};F.strategy=T;const B=q=>Math.min(200,Math.max(2,Math.round(R??q)));return T==="equal_width"?(F.equal_width_bins=B(s.equalWidthBins),delete F.equal_frequency_bins,delete F.kbins_n_bins,delete F.kbins_encode,delete F.kbins_strategy):T==="equal_frequency"?(F.equal_frequency_bins=B(s.equalFrequencyBins),delete F.equal_width_bins,delete F.kbins_n_bins,delete F.kbins_encode,delete F.kbins_strategy):T==="kbins"?(F.kbins_n_bins=B(s.kbinsNBins),F.kbins_encode=s.kbinsEncode,F.kbins_strategy=s.kbinsStrategy,delete F.equal_width_bins,delete F.equal_frequency_bins):T==="custom"&&(delete F.equal_width_bins,delete F.equal_frequency_bins,delete F.kbins_n_bins,delete F.kbins_encode,delete F.kbins_strategy),Object.keys(F).length?F:null}),T!=="custom"&&v(O)},[s.equalFrequencyBins,s.equalWidthBins,s.kbinsEncode,s.kbinsNBins,s.kbinsStrategy,v,y]),w=x.useCallback((k,T,A)=>{const O=String(k??"").trim();O&&(y(O,R=>{const L={...R};if(!A.trim())delete L[T];else{const F=Number(A);if(!Number.isFinite(F))return R;const B=Math.min(200,Math.max(2,Math.round(F)));L[T]=B,T==="equal_width_bins"?(L.strategy="equal_width",delete L.equal_frequency_bins,delete L.kbins_n_bins,delete L.kbins_encode,delete L.kbins_strategy):T==="equal_frequency_bins"?(L.strategy="equal_frequency",delete L.equal_width_bins,delete L.kbins_n_bins,delete L.kbins_encode,delete L.kbins_strategy):T==="kbins_n_bins"&&(L.strategy="kbins",delete L.equal_width_bins,delete L.equal_frequency_bins)}return Object.keys(L).length?L:null}),v(O))},[v,y]),E=x.useCallback((k,T)=>{const A=String(k??"").trim();A&&y(A,O=>{const R={...O};return T?(R.strategy="kbins",R.kbins_encode=T):delete R.kbins_encode,Object.keys(R).length?R:null})},[y]),N=x.useCallback((k,T)=>{const A=String(k??"").trim();A&&y(A,O=>{const R={...O};return T?(R.strategy="kbins",R.kbins_strategy=T):delete R.kbins_strategy,Object.keys(R).length?R:null})},[y]),j=x.useCallback(k=>{const T=String(k??"").trim();T&&(v(T),y(T,()=>null))},[v,y]),C=x.useCallback(()=>{e(k=>{if(!((k==null?void 0:k.column_strategies)&&typeof k.column_strategies=="object"&&!Array.isArray(k.column_strategies)&&Object.keys(k.column_strategies).length>0||(k==null?void 0:k.column_overrides)&&typeof k.column_overrides=="object"&&!Array.isArray(k.column_overrides)&&Object.keys(k.column_overrides).length>0))return k;const A={...k};return Object.prototype.hasOwnProperty.call(A,"column_overrides")&&delete A.column_overrides,Object.prototype.hasOwnProperty.call(A,"column_strategies")&&delete A.column_strategies,A})},[e]),M=x.useCallback(()=>{r.length&&r.forEach(k=>{const T=typeof(k==null?void 0:k.column)=="string"?k.column.trim():"";if(!T)return;const A=k.recommended_strategy??"equal_width";b(T,A,{recommendedBins:Number.isFinite(k==null?void 0:k.recommended_bins)?k.recommended_bins:null})})},[r,b]),z=x.useCallback(k=>{if(!k)return;const T=[];for(const A of k){const O=typeof A=="string"?A.trim():"";O&&T.push(O)}T.length&&e(A=>{const O=A&&typeof A=="object"?A:{},R=new Set(at(O.columns));let L=!1;if(T.forEach(B=>{R.has(B)||(R.add(B),L=!0)}),!L)return A;const F={...O};return F.columns=Array.from(R).sort((B,q)=>B.localeCompare(q)),F})},[e]),D=x.useCallback(()=>{i.length&&z(i)},[i,z]);return{handleBinningIntegerChange:l,handleBinningBooleanToggle:u,handleBinningSuffixChange:d,handleBinningLabelFormatChange:f,handleBinningMissingStrategyChange:p,handleBinningMissingLabelChange:h,handleBinningCustomBinsChange:m,handleBinningCustomLabelsChange:_,handleBinningClearCustomColumn:v,updateBinningColumnOverride:y,handleBinningOverrideStrategyChange:b,handleBinningOverrideNumberChange:w,handleBinningOverrideKbinsEncodeChange:E,handleBinningOverrideKbinsStrategyChange:N,handleBinningClearOverride:j,handleBinningClearOverrides:C,handleBinningApplyStrategies:M,handleBinningApplyColumns:z,handleApplyAllBinningNumeric:D}},S4=({setConfigState:e,outlierRecommendationRows:t,outlierExcludedColumns:n,outlierConfig:s})=>{const r=x.useCallback(v=>{nr.includes(v)&&e(y=>(y==null?void 0:y.default_method)===v?y:{...y,default_method:v})},[e]),i=x.useCallback(v=>{e(y=>(typeof(y==null?void 0:y.auto_detect)=="boolean"?y.auto_detect:!0)===v?y:{...y,auto_detect:v})},[e]),l=x.useCallback((v,y)=>{const b=String(v??"").trim();b&&e(w=>{if(!w||typeof w!="object")return w;const E=at(w.columns),N=new Set(E),j=w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)?{...w.column_methods}:{};let C=!1;if(y){if(!nr.includes(y))return w;j[b]!==y&&(j[b]=y,C=!0),N.has(b)||(N.add(b),C=!0)}else Object.prototype.hasOwnProperty.call(j,b)&&(delete j[b],C=!0);if(!C)return w;const M={...w};return M.columns=Array.from(N).sort((z,D)=>z.localeCompare(D)),Object.keys(j).length?M.column_methods=j:Object.prototype.hasOwnProperty.call(M,"column_methods")&&delete M.column_methods,M})},[e]),u=x.useCallback(()=>{e(v=>{if(!v||typeof v!="object")return v;const y=v.column_methods&&typeof v.column_methods=="object"&&!Array.isArray(v.column_methods)&&Object.keys(v.column_methods).length>0,b=v.column_parameters&&typeof v.column_parameters=="object"&&!Array.isArray(v.column_parameters)&&Object.keys(v.column_parameters).length>0;if(!y&&!b)return v;const w={...v};return y&&delete w.column_methods,b&&delete w.column_parameters,w})},[e]),d=x.useCallback(()=>{t.length&&e(v=>{if(!v||typeof v!="object")return v;const y=new Set(at(v.columns)),b=new Set(at(v.skipped_columns)),w=v.column_methods&&typeof v.column_methods=="object"&&!Array.isArray(v.column_methods)?{...v.column_methods}:{},E=v.column_parameters&&typeof v.column_parameters=="object"&&!Array.isArray(v.column_parameters)?{...v.column_parameters}:{};let N=!1;if(t.forEach(C=>{if(!C||C.isExcluded||!C.recommendedMethod)return;const M=String(C.column??"").trim();if(!M||n.has(M))return;const z=C.recommendedMethod;nr.includes(z)&&(b.has(M)&&(b.delete(M),N=!0),y.has(M)||(y.add(M),N=!0),z===s.defaultMethod?Object.prototype.hasOwnProperty.call(w,M)&&(delete w[M],N=!0):w[M]!==z&&(w[M]=z,N=!0),Object.prototype.hasOwnProperty.call(E,M)&&(delete E[M],N=!0))}),!N)return v;const j={...v,columns:Array.from(y).sort((C,M)=>C.localeCompare(M))};return b.size?j.skipped_columns=Array.from(b).sort((C,M)=>C.localeCompare(M)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,Object.keys(w).length?j.column_methods=w:Object.prototype.hasOwnProperty.call(j,"column_methods")&&delete j.column_methods,Object.keys(E).length?j.column_parameters=E:Object.prototype.hasOwnProperty.call(j,"column_parameters")&&delete j.column_parameters,j})},[s.defaultMethod,n,t,e]),f=x.useCallback(v=>{const y=String(v??"").trim();y&&e(b=>{if(!b||typeof b!="object")return b;const w=at(b.columns),E=w.filter(O=>O!==y),N=new Set(at(b.skipped_columns)),j=N.size;N.add(y);const C=j!==N.size,M=b.column_methods&&typeof b.column_methods=="object"&&!Array.isArray(b.column_methods)?{...b.column_methods}:{},z=Object.prototype.hasOwnProperty.call(M,y);z&&delete M[y];const D=b.column_parameters&&typeof b.column_parameters=="object"&&!Array.isArray(b.column_parameters)?{...b.column_parameters}:{},k=Object.prototype.hasOwnProperty.call(D,y);if(k&&delete D[y],!(E.length!==w.length)&&!C&&!z&&!k)return b;const A={...b,columns:E.sort((O,R)=>O.localeCompare(R)),skipped_columns:Array.from(N).sort((O,R)=>O.localeCompare(R))};return Object.keys(M).length?A.column_methods=M:Object.prototype.hasOwnProperty.call(A,"column_methods")&&delete A.column_methods,Object.keys(D).length?A.column_parameters=D:Object.prototype.hasOwnProperty.call(A,"column_parameters")&&delete A.column_parameters,A})},[e]),p=x.useCallback(v=>{const y=String(v??"").trim();y&&e(b=>{if(!b||typeof b!="object")return b;const w=at(b.skipped_columns);if(!w.includes(y))return b;const E=w.filter(C=>C!==y),N=new Set(at(b.columns));N.has(y)||N.add(y);const j={...b,columns:Array.from(N).sort((C,M)=>C.localeCompare(M))};return E.length?j.skipped_columns=E.sort((C,M)=>C.localeCompare(M)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,j})},[e]),h=x.useCallback((v,y)=>{if(y==="__skip__"){f(v);return}if(y==="__default__"){p(v),l(v,null);return}nr.includes(y)&&(p(v),l(v,y))},[f,p,l]),m=x.useCallback((v,y,b)=>{const w=String(y??"").trim().toLowerCase();e(E=>{if(!E||typeof E!="object")return E;const N=E.method_parameters&&typeof E.method_parameters=="object"&&!Array.isArray(E.method_parameters)?{...E.method_parameters}:{},j={...N[v]??{}},C=typeof b=="number"&&Number.isFinite(b)?b:null;let M=!1;if(C===null?Object.prototype.hasOwnProperty.call(j,w)&&(delete j[w],M=!0):j[w]!==C&&(j[w]=C,M=!0),!M)return E;if(Object.keys(j).length?N[v]=j:delete N[v],!Object.keys(N).length){const z={...E};return Object.prototype.hasOwnProperty.call(z,"method_parameters")&&delete z.method_parameters,z}return{...E,method_parameters:N}})},[e]),_=x.useCallback((v,y,b)=>{const w=String(v??"").trim();if(!w)return;const E=String(y??"").trim().toLowerCase();e(N=>{if(!N||typeof N!="object")return N;const j=N.column_parameters&&typeof N.column_parameters=="object"&&!Array.isArray(N.column_parameters)?{...N.column_parameters}:{},C={...j[w]??{}},M=typeof b=="number"&&Number.isFinite(b)?b:null;let z=!1;if(M===null?Object.prototype.hasOwnProperty.call(C,E)&&(delete C[E],z=!0):C[E]!==M&&(C[E]=M,z=!0),!z)return N;if(Object.keys(C).length?j[w]=C:delete j[w],!Object.keys(j).length){const D={...N};return Object.prototype.hasOwnProperty.call(D,"column_parameters")&&delete D.column_parameters,D}return{...N,column_parameters:j}})},[e]);return{handleOutlierDefaultMethodChange:r,handleOutlierAutoDetectToggle:i,setOutlierColumnMethod:l,handleOutlierClearOverrides:u,handleOutlierApplyAllRecommendations:d,handleOutlierSkipColumn:f,handleOutlierUnskipColumn:p,handleOutlierOverrideSelect:h,handleOutlierMethodParameterChange:m,handleOutlierColumnParameterChange:_}},E4=({setConfigState:e,scalingRecommendations:t})=>{const n=x.useCallback(p=>{tr.includes(p)&&e(h=>(h==null?void 0:h.default_method)===p?h:{...h,default_method:p})},[e]),s=x.useCallback(p=>{e(h=>(typeof(h==null?void 0:h.auto_detect)=="boolean"?h.auto_detect:!0)===p?h:{...h,auto_detect:p})},[e]),r=x.useCallback((p,h)=>{const m=String(p??"").trim();m&&e(_=>{const v=at(_.columns),y=v.includes(m),b=_.column_methods&&typeof _.column_methods=="object"&&!Array.isArray(_.column_methods)?{..._.column_methods}:{};if(h){if(!tr.includes(h))return _;const N=(b[m]??null)!==h,j=!y;if(!N&&!j)return _;b[m]=h;const C=j?[...v,m].sort((M,z)=>M.localeCompare(z)):v;return{..._,columns:C,column_methods:b}}if(!Object.prototype.hasOwnProperty.call(b,m))return _;if(delete b[m],Object.keys(b).length)return{..._,column_methods:b};const w={..._};return Object.prototype.hasOwnProperty.call(w,"column_methods")&&delete w.column_methods,w})},[e]),i=x.useCallback(()=>{e(p=>{if(!p.column_methods||typeof p.column_methods!="object"||Array.isArray(p.column_methods)||!Object.keys(p.column_methods).length)return p;const h={...p};return delete h.column_methods,h})},[e]),l=x.useCallback(()=>{t.length&&e(p=>{const h=at(p.columns),m=new Set(h),_=new Set(at(p.skipped_columns)),v=p.column_methods&&typeof p.column_methods=="object"&&!Array.isArray(p.column_methods)?{...p.column_methods}:{};let y=!1;if(t.forEach(w=>{const E=String(w.column??"").trim(),N=w.recommended_method;!E||!tr.includes(N)||_.has(E)||(v[E]!==N&&(v[E]=N,y=!0),m.has(E)||(m.add(E),y=!0))}),!y)return p;const b=Array.from(m).sort((w,E)=>w.localeCompare(E));return{...p,columns:b,column_methods:v}})},[t,e]),u=x.useCallback(p=>{const h=String(p??"").trim();h&&e(m=>{const _=at(m.columns),v=_.filter(j=>j!==h),y=new Set(at(m.skipped_columns)),b=y.size;y.add(h);const w=y.size!==b,E=m.column_methods&&typeof m.column_methods=="object"&&!Array.isArray(m.column_methods)?{...m.column_methods}:{},N=Object.prototype.hasOwnProperty.call(E,h);return N&&delete E[h],!w&&v.length===_.length&&!N?m:{...m,columns:v.sort((j,C)=>j.localeCompare(C)),column_methods:E,skipped_columns:Array.from(y).sort((j,C)=>j.localeCompare(C))}})},[e]),d=x.useCallback(p=>{const h=String(p??"").trim();h&&e(m=>{const _=at(m.skipped_columns);if(!_.includes(h))return m;const v=new Set(_);v.delete(h);const y=new Set(at(m.columns));return y.has(h)||y.add(h),{...m,columns:Array.from(y).sort((w,E)=>w.localeCompare(E)),skipped_columns:Array.from(v).sort((w,E)=>w.localeCompare(E))}})},[e]),f=x.useCallback((p,h)=>{if(h==="__skip__"){u(p);return}if(h==="__default__"){d(p),r(p,null);return}tr.includes(h)&&(d(p),r(p,h))},[u,d,r]);return{handleScalingDefaultMethodChange:n,handleScalingAutoDetectToggle:s,setScalingColumnMethod:r,handleScalingClearOverrides:i,handleScalingApplyAllRecommendations:l,handleScalingSkipColumn:u,handleScalingUnskipColumn:d,handleScalingOverrideSelect:f}},C4=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},k4=({catalogFlags:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:s,availableColumns:r,recommendedColumns:i})=>{const{isBinningNode:l}=e,u=x.useMemo(()=>{if(!i)return null;const h=new Set;for(const m of i){const _=typeof m=="string"?m.trim():"";_&&h.add(_)}return h.size>0?h:null},[i]),d=x.useMemo(()=>{if(!Array.isArray(n)||!n.length)return null;const h=new Set;return n.forEach(m=>{const _=typeof m=="string"?m.trim():"";_&&h.add(_)}),h.size>0?h:null},[n]),f=x.useMemo(()=>{if(!l)return new Set;if(!t.size||!u&&!d)return t;const h=new Set;return t.forEach(m=>{u!=null&&u.has(m)||d!=null&&d.has(m)||h.add(m)}),h},[l,t,u,d]),p=x.useMemo(()=>{if(!l||!s.length)return{};const h={};return r.forEach(m=>{if(f.has(m))return;let _=null,v=null;const y=new Set;if(s.forEach(b=>{if(!b||!Object.prototype.hasOwnProperty.call(b,m))return;const w=C4(b[m]);w!==null&&((_===null||w<_)&&(_=w),(v===null||w>v)&&(v=w),y.size<=1e3&&y.add(w))}),_!==null||v!==null){const b=y.size>0?y.size:null;h[m]={min:_,max:v,distinct:b}}}),h},[r,f,l,s]);return{binningExcludedColumns:f,binningColumnPreviewMap:p,manualBoundColumns:[],manualRangeFallbackMap:{}}},M4=({catalogFlags:e,scalingExcludedColumns:t,binningExcludedColumns:n,outlierExcludedColumns:s,setConfigState:r})=>{const{isScalingNode:i,isBinningNode:l,isOutlierNode:u}=e;x.useEffect(()=>{!i||t.size===0||r(d=>{if(!d||typeof d!="object")return d;const f=at(d.columns);if(!f.length)return d;const p=f.filter(m=>!t.has(m));if(p.length===f.length||!p.length)return d;const h={...d,columns:p};if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const m={};let _=!1;Object.entries(d.column_methods).forEach(([v,y])=>{const b=String(v??"").trim();if(!b)return;if(t.has(b)){_=!0;return}const w=typeof y=="string"?y.trim():null;w&&tr.includes(w)&&(m[b]=w)}),_?Object.keys(m).length?h.column_methods=m:h.column_methods={}:h.column_methods=d.column_methods}return h})},[i,t,r]),x.useEffect(()=>{!l||n.size===0||r(d=>{if(!d||typeof d!="object")return d;const f=at(d.columns);if(!f.length)return d;const p=f.filter(_=>!n.has(_));if(p.length===f.length)return d;const h=new Set(f.filter(_=>n.has(_))),m={...d,columns:p};if(d.custom_bins&&typeof d.custom_bins=="object"&&!Array.isArray(d.custom_bins)){const _={};Object.entries(d.custom_bins).forEach(([v,y])=>{!h.has(v)&&Array.isArray(y)&&y.length&&(_[v]=[...y])}),Object.keys(_).length?m.custom_bins=_:Object.prototype.hasOwnProperty.call(m,"custom_bins")&&delete m.custom_bins}if(d.custom_labels&&typeof d.custom_labels=="object"&&!Array.isArray(d.custom_labels)){const _={};Object.entries(d.custom_labels).forEach(([v,y])=>{!h.has(v)&&Array.isArray(y)&&y.length&&(_[v]=y.map(b=>String(b)))}),Object.keys(_).length?m.custom_labels=_:Object.prototype.hasOwnProperty.call(m,"custom_labels")&&delete m.custom_labels}return m})},[n,l,r]),x.useEffect(()=>{!u||s.size===0||r(d=>{if(!d||typeof d!="object")return d;const f=at(d.columns),p=f.filter(N=>!s.has(N)),h=p.length!==f.length,m=at(d.skipped_columns),_=m.filter(N=>!s.has(N)),v=_.length!==m.length,y=N=>N??{...d};let b=null;h&&(b=y(b),b.columns=p.sort((N,j)=>N.localeCompare(j))),v&&(b=y(b),_.length?b.skipped_columns=_.sort((N,j)=>N.localeCompare(j)):Object.prototype.hasOwnProperty.call(b,"skipped_columns")&&delete b.skipped_columns);let w=!1;if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const N={};Object.entries(d.column_methods).forEach(([j,C])=>{const M=String(j??"").trim();if(!M||s.has(M)){w=!0;return}const z=typeof C=="string"?C.trim():null;z&&nr.includes(z)?N[M]=z:w=!0}),w&&(b=y(b),Object.keys(N).length?b.column_methods=N:Object.prototype.hasOwnProperty.call(b,"column_methods")&&delete b.column_methods)}let E=!1;if(d.column_parameters&&typeof d.column_parameters=="object"&&!Array.isArray(d.column_parameters)){const N={};Object.entries(d.column_parameters).forEach(([j,C])=>{const M=String(j??"").trim();if(!M||s.has(M)){E=!0;return}if(!C||typeof C!="object"||Array.isArray(C)){E=!0;return}N[M]={...C}}),E&&(b=y(b),Object.keys(N).length?b.column_parameters=N:Object.prototype.hasOwnProperty.call(b,"column_parameters")&&delete b.column_parameters)}return b||d})},[u,s,r])},A4=({catalogFlags:e,configState:t,setConfigState:n,nodeId:s,numericExcludedColumns:r,scalingData:i,outlierData:l,binningData:u,availableColumns:d,previewSampleRows:f})=>{const{isScalingNode:p,isOutlierNode:h,isBinningNode:m}=e,{scalingConfig:_,scalingExcludedColumns:v,scalingMethodDetailMap:y,scalingMethodOptions:b,scalingRecommendations:w,scalingRecommendationRows:E,scalingSelectedCount:N,scalingOverrideCount:j,scalingDefaultDetail:C,scalingDefaultLabel:M,scalingAutoDetectEnabled:z,scalingHasRecommendations:D,scalingStatusMessage:k,scalingOverrideExampleSummary:T}=h4({catalogFlags:e,configState:t,numericExcludedColumns:r,scalingData:i}),{outlierConfig:A,outlierExcludedColumns:O,outlierMethodLabelMap:R,outlierMethodDetailMap:L,outlierMethodOptions:F,outlierRecommendations:B,outlierRecommendationRows:q,outlierSelectedCount:I,outlierOverrideCount:U,outlierParameterOverrideCount:V,outlierDefaultDetail:H,outlierDefaultLabel:G,outlierAutoDetectEnabled:W,outlierHasRecommendations:J,outlierStatusMessage:ee,outlierOverrideExampleSummary:Z}=w4({catalogFlags:e,configState:t,numericExcludedColumns:r,outlierData:l}),K=typeof(l==null?void 0:l.sample_size)=="number"?l.sample_size:null,X=null,Q=U>0||V>0,ne=x.useMemo(()=>U>0?Z:V>0?`${V} column${V===1?"":"s"} with parameter overrides`:null,[U,V,Z]),{binningConfig:le,binningSelectedCount:ce,binningDefaultLabel:ie,binningOverrideColumns:ge,binningOverrideCount:Re,binningOverrideSummary:ze,fieldIds:me,customEdgeDrafts:xe,setCustomEdgeDrafts:Ce,customLabelDrafts:Ae,setCustomLabelDrafts:Ve}=N4({configState:t,nodeId:s}),Se=x.useMemo(()=>p?_.columns:m?le.columns:h?A.columns:at(t==null?void 0:t.columns),[le.columns,t,m,h,p,A.columns,_.columns]),We=x.useMemo(()=>{const en=u==null?void 0:u.columns;return Array.isArray(en)?en.filter(et=>!et||typeof et.column!="string"?!1:!!et.column.trim()):[]},[u==null?void 0:u.columns]),ht=x.useMemo(()=>{if(!We.length)return new Set;const en=new Set;return We.forEach(et=>{const Qt=typeof et.column=="string"?et.column.trim():"";Qt&&en.add(Qt)}),en},[We]),ye=x.useMemo(()=>{if(!m)return[];const en=new Set;return d.forEach(et=>{if(r.has(et))return;const Qt=et.trim();Qt&&en.add(Qt)}),We.forEach(et=>{const Qt=typeof et.column=="string"?et.column.trim():"";Qt&&(!r.has(Qt)||ht.has(Qt))&&en.add(Qt)}),Se.forEach(et=>{const Qt=typeof et=="string"?et.trim():"";Qt&&(!r.has(Qt)||ht.has(Qt))&&en.add(Qt)}),Array.from(en).sort((et,Qt)=>et.localeCompare(Qt))},[d,We,ht,m,r,Se]),Fe=x.useMemo(()=>!m||!ye.length?[]:ye.filter(en=>!Se.includes(en)),[ye,m,Se]),Qe=Fe.length>0,{handleBinningIntegerChange:tt,handleBinningBooleanToggle:xt,handleBinningSuffixChange:_t,handleBinningLabelFormatChange:Bt,handleBinningMissingStrategyChange:$e,handleBinningMissingLabelChange:Ie,handleBinningCustomBinsChange:Be,handleBinningCustomLabelsChange:Ee,handleBinningClearCustomColumn:lt,updateBinningColumnOverride:Je,handleBinningOverrideStrategyChange:Ue,handleBinningOverrideNumberChange:Rt,handleBinningOverrideKbinsEncodeChange:Yt,handleBinningOverrideKbinsStrategyChange:bt,handleBinningClearOverride:Ot,handleBinningClearOverrides:Pt,handleBinningApplyStrategies:wt,handleBinningApplyColumns:pt,handleApplyAllBinningNumeric:rn}=j4({setConfigState:n,setBinningCustomEdgeDrafts:Ce,setBinningCustomLabelDrafts:Ve,binningConfig:le,binningInsightsRecommendations:We,binningAllNumericColumns:ye}),{handleOutlierDefaultMethodChange:Jt,handleOutlierAutoDetectToggle:tn,setOutlierColumnMethod:Pe,handleOutlierClearOverrides:Wt,handleOutlierApplyAllRecommendations:mn,handleOutlierSkipColumn:Fn,handleOutlierUnskipColumn:Gt,handleOutlierOverrideSelect:jt,handleOutlierMethodParameterChange:Bn,handleOutlierColumnParameterChange:ts}=S4({setConfigState:n,outlierRecommendationRows:q,outlierExcludedColumns:O,outlierConfig:A}),{handleScalingDefaultMethodChange:Hn,handleScalingAutoDetectToggle:Sn,setScalingColumnMethod:Un,handleScalingClearOverrides:ns,handleScalingApplyAllRecommendations:cn,handleScalingSkipColumn:Mn,handleScalingUnskipColumn:Mt,handleScalingOverrideSelect:An}=E4({setConfigState:n,scalingRecommendations:w}),{binningExcludedColumns:hs,binningColumnPreviewMap:Qn,manualBoundColumns:qs,manualRangeFallbackMap:Vs}=k4({catalogFlags:e,numericExcludedColumns:r,selectedColumns:Se,previewSampleRows:f,availableColumns:d,recommendedColumns:ht}),As=x.useMemo(()=>{const en=u==null?void 0:u.excluded_columns;return Array.isArray(en)?en.filter(et=>!et||typeof et.column!="string"?!1:!!et.column.trim()):[]},[u==null?void 0:u.excluded_columns]);return M4({catalogFlags:e,scalingExcludedColumns:v,binningExcludedColumns:hs,outlierExcludedColumns:O,setConfigState:n}),{scaling:{config:_,state:{excludedColumns:v,methodDetailMap:y,methodOptions:b,recommendations:w,recommendationRows:E,selectedCount:N,overrideCount:j,defaultDetail:C,defaultLabel:M,autoDetectEnabled:z,hasRecommendations:D,statusMessage:k,overrideExampleSummary:T},handlers:{handleDefaultMethodChange:Hn,handleAutoDetectToggle:Sn,setColumnMethod:Un,handleClearOverrides:ns,handleApplyAllRecommendations:cn,handleSkipColumn:Mn,handleUnskipColumn:Mt,handleOverrideSelect:An}},outlier:{config:A,state:{excludedColumns:O,methodLabelMap:R,methodDetailMap:L,methodOptions:F,recommendations:B,recommendationRows:q,selectedCount:I,overrideCount:U,parameterOverrideCount:V,defaultDetail:H,defaultLabel:G,autoDetectEnabled:W,hasRecommendations:J,statusMessage:ee,overrideExampleSummary:Z,sampleSize:K,relativeGeneratedAt:X,hasOverrides:Q,overrideSummaryDisplay:ne},handlers:{handleDefaultMethodChange:Jt,handleAutoDetectToggle:tn,setColumnMethod:Pe,handleClearOverrides:Wt,handleApplyAllRecommendations:mn,handleSkipColumn:Fn,handleUnskipColumn:Gt,handleOverrideSelect:jt,handleMethodParameterChange:Bn,handleColumnParameterChange:ts}},binning:{config:le,state:{selectedCount:ce,defaultLabel:ie,overrideColumns:ge,overrideCount:Re,overrideSummary:ze,fieldIds:me,customEdgeDrafts:xe,customLabelDrafts:Ae,insightsRecommendations:We,recommendedColumnSet:ht,allNumericColumns:ye,numericColumnsNotSelected:Fe,canApplyAllNumeric:Qe,excludedColumns:hs,columnPreviewMap:Qn,manualBoundColumns:qs,manualRangeFallbackMap:Vs,insightsExcludedColumns:As},handlers:{setCustomEdgeDrafts:Ce,setCustomLabelDrafts:Ve,handleIntegerChange:tt,handleBooleanToggle:xt,handleSuffixChange:_t,handleLabelFormatChange:Bt,handleMissingStrategyChange:$e,handleMissingLabelChange:Ie,handleCustomBinsChange:Be,handleCustomLabelsChange:Ee,handleClearCustomColumn:lt,updateColumnOverride:Je,handleOverrideStrategyChange:Ue,handleOverrideNumberChange:Rt,handleOverrideKbinsEncodeChange:Yt,handleOverrideKbinsStrategyChange:bt,handleClearOverride:Ot,handleClearOverrides:Pt,handleApplyStrategies:wt,handleApplyColumns:pt,handleApplyAllNumeric:rn}},selectedColumns:Se}},O4=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},T4=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),$4=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),Jj=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return x.useMemo(()=>{const s=O4(e),r=t==="data_preview",i=t==="dataset_profile",l=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",u=t==="missing_value_indicator",d=t==="replace_aliases_typos",f=t==="trim_whitespace",p=t==="remove_special_characters",h=t==="replace_invalid_values",m=t==="regex_replace_fix",_=t==="normalize_text_case",v=t==="standardize_date_formats",y=t==="label_encoding",b=t==="target_encoding",w=t==="hash_encoding",E=t==="train_model_draft",N=t==="model_evaluation",j=t==="model_registry_overview",C=t==="hyperparameter_tuning",M=t==="feature_target_split",z=t==="train_test_split",D=t==="class_undersampling",k=t==="class_oversampling",T=t==="ordinal_encoding",A=t==="dummy_encoding",O=t==="one_hot_encoding",R=t==="feature_math",L=t==="cast_column_types",F=t==="binning_discretization",B=t==="scale_numeric_features",q=t==="polynomial_features",I=t==="feature_selection",U=t==="transformer_audit",V=t==="outlier_removal",H=t==="skewness_transform",G=t==="skewness_distribution",W=t==="binned_distribution",J=$4.has(t),ee=T4.has(t),Z=t==="remove_duplicates",K=t==="drop_missing_columns",X=t==="drop_missing_rows";return{catalogType:t,isDataset:s,isImputerNode:l,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:f,isRemoveSpecialCharsNode:p,isReplaceInvalidValuesNode:h,isRegexCleanupNode:m,isNormalizeTextCaseNode:_,isStandardizeDatesNode:v,isLabelEncodingNode:y,isTargetEncodingNode:b,isHashEncodingNode:w,isTrainModelDraftNode:E,isModelEvaluationNode:N,isModelRegistryNode:j,isHyperparameterTuningNode:C,isFeatureTargetSplitNode:M,isTrainTestSplitNode:z,isClassUndersamplingNode:D,isClassOversamplingNode:k,isOrdinalEncodingNode:T,isDummyEncodingNode:A,isOneHotEncodingNode:O,isFeatureMathNode:R,isCastNode:L,isBinningNode:F,isScalingNode:B,isPolynomialFeaturesNode:q,isFeatureSelectionNode:I,isTransformerAuditNode:U,isOutlierNode:V,isSkewnessNode:H,isSkewnessDistributionNode:G,isBinnedDistributionNode:W,isDataConsistencyNode:J,isInspectionNode:ee,isRemoveDuplicatesNode:Z,isDropMissingColumnsNode:K,isDropMissingRowsNode:X,isDropMissingNode:K||X,isPreviewNode:r,isDatasetProfileNode:i}},[t,e])},L4=({node:e,nodeId:t,configState:n,setConfigState:s})=>{const{isRemoveDuplicatesNode:r}=Jj(e),i=`${t||"node"}-remove-duplicates-keep`,l=x.useMemo(()=>{if(!r)return dw;const d=typeof(n==null?void 0:n.keep)=="string"?n.keep.trim().toLowerCase():"";return d==="last"||d==="none"?d:dw},[n==null?void 0:n.keep,r]),u=x.useCallback(d=>{s(f=>({...f,keep:d}))},[s]);return{removeDuplicatesKeepSelectId:i,removeDuplicatesKeep:l,handleRemoveDuplicatesKeepChange:u}},z4=({catalogFlags:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:r,columnTypeMap:i,setAvailableColumns:l,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:f,setColumnSuggestions:p,dropColumnParameter:h,node:m,configState:_,setConfigState:v,nodeChangeVersion:y,binnedSamplePreset:b,skewnessTransformations:w,availableColumns:E,columnMissingMap:N,previewSampleRows:j})=>{var I;const M=f5({hasDropColumnSource:!!h,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:r,columnTypeMap:i,setAvailableColumns:l,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:f,setColumnSuggestions:p});p5({catalogFlags:e,sourceId:t,hasReachableSource:r,graphContext:s,targetNodeId:(m==null?void 0:m.id)??null,setAvailableColumns:l,setColumnMissingMap:d});const z=B5({catalogFlags:e,sourceId:t,hasReachableSource:r,graphContext:s,node:m,configState:_,setConfigState:v,nodeChangeVersion:y}),D=H5({catalogFlags:e,sourceId:t,hasReachableSource:r,graphContext:s,targetNodeId:n||null}),k=U5({catalogFlags:e,sourceId:t,hasReachableSource:r,graphContext:s,targetNodeId:(m==null?void 0:m.id)??null}),T=q5({catalogFlags:e,sourceId:t,hasReachableSource:r,graphContext:s,targetNodeId:(m==null?void 0:m.id)??null}),A=V5({catalogFlags:e,sourceId:t,hasReachableSource:r,graphContext:s,targetNodeId:(m==null?void 0:m.id)??null,samplePreset:b}),O=K5({catalogFlags:e,sourceId:t,graphContext:s,targetNodeId:(m==null?void 0:m.id)??null,transformations:w}),R=Q5({catalogFlags:e,configState:_,node:m,availableColumns:E,columnMissingMap:N}),L=l4({catalogFlags:e,configState:_,nodeConfig:((I=m==null?void 0:m.data)==null?void 0:I.config)??null,availableColumns:E,columnTypeMap:i,previewSampleRows:j}),F=m4({catalogFlags:e,availableColumns:E,columnTypeMap:i,previewSampleRows:j}),B=A4({catalogFlags:e,configState:_,setConfigState:v,nodeId:n,numericExcludedColumns:F.numericExcludedColumns,scalingData:k.scalingData,outlierData:D.outlierData,binningData:T.binningData,availableColumns:E,previewSampleRows:j}),q=L4({node:m,nodeId:n,configState:_,setConfigState:v});return{dropMissingColumns:M,encodingRecommendations:z,outlierRecommendations:D,scalingInsights:k,binningInsights:T,binnedDistribution:A,skewnessInsights:O,missingIndicatorState:R,dataCleaningState:L,numericColumnAnalysis:F,numericAnalysisState:B,removeDuplicatesState:q}},ru={status:"idle",data:null,error:null},R4=1e3,D4=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:s,catalogFlags:r,targetNodeId:i,previewSignature:l,skipPreview:u=!1,requestPreviewRows:d,includeSignals:f})=>{const{isPreviewNode:p}=r,[h,m]=x.useState(ru),[_,v]=x.useState(0),y=x.useRef(null),b=x.useRef(-1),w=x.useCallback(()=>{v(E=>E+1)},[]);return x.useEffect(()=>{if(!e){m(ru),y.current=null,b.current=-1;return}if(u)return;if(!t){m(p?{status:"error",data:null,error:"Select a dataset to generate previews."}:ru);return}if(!n){m(p?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:ru);return}if(!s)return;const E=(()=>{const k=Array.isArray(s.nodes)?s.nodes.map(A=>A&&typeof A.id=="string"?A.id:null).filter(A=>!!A).sort():[],T=Array.isArray(s.edges)?s.edges.map(A=>{const O=A&&typeof A.source=="string"?A.source.trim():"",R=A&&typeof A.target=="string"?A.target.trim():"";return O&&R?`${O}->${R}`:null}).filter(A=>!!A).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:i??null,nodeIds:k,edgePairs:T})})(),N=l??E,j=N!==y.current;if(!(b.current!==_)&&!j)return;y.current=N,b.current=_;let M=!0;m(k=>({status:"loading",data:k.data??null,error:null}));const z=d??p,D={dataset_source_id:t,graph:{nodes:s.nodes,edges:s.edges}};return z&&(D.sample_size=R4),Aw(D).then(k=>{M&&m({status:"success",data:k,error:null})}).catch(k=>{M&&m(p?{status:"error",data:null,error:(k==null?void 0:k.message)??"Unable to generate preview."}:ru)}),()=>{M=!1}},[n,s,p,u,l,_,e,t,i]),{previewState:h,refreshPreview:w}},P4=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:r,nodeId:i,previewSignature:l,skipPreview:u,catalogFlags:d,cachedPreviewSchema:f,setCachedPreviewSchema:p})=>{var k;const{isPreviewNode:h,isFeatureMathNode:m,isPolynomialFeaturesNode:_,isFeatureSelectionNode:v,isTrainTestSplitNode:y,isOutlierNode:b,isTransformerAuditNode:w,isCastNode:E}=d,N=x.useMemo(()=>!(!e||!t||!n),[t,e,n]),j=x.useMemo(()=>!e||!s||!n?!1:t>0,[t,e,n,s]),C=x.useMemo(()=>h||m||_||v||y||b||w,[m,v,b,_,h,y,w]),{previewState:M,refreshPreview:z}=D4({shouldFetchPreview:N,sourceId:s,canTriggerPreview:j,graphSnapshot:e,catalogFlags:d,targetNodeId:(r==null?void 0:r.id)??null,previewSignature:l,skipPreview:u,requestPreviewRows:h||E,includeSignals:C});x.useEffect(()=>{var A;const T=((A=M.data)==null?void 0:A.schema)??null;T&&p(O=>O!=null&&O.signature&&T.signature&&O.signature===T.signature?O:T)},[(k=M.data)==null?void 0:k.schema]),x.useEffect(()=>{p(null)},[s]),x.useEffect(()=>{p(null)},[l]);const D=x.useCallback(()=>{p(null)},[]);return{previewState:M,refreshPreview:z,cachedPreviewSchema:f,clearCachedPreviewSchema:D,canTriggerPreview:j}},I4=({previewState:e,nodeId:t,catalogFlags:n})=>{var _,v,y,b,w,E,N,j,C,M;const{isFeatureMathNode:s,isPolynomialFeaturesNode:r,isFeatureSelectionNode:i,isOutlierNode:l,isTransformerAuditNode:u}=n,d=x.useMemo(()=>{var D,k;if(!s)return[];const z=(k=(D=e.data)==null?void 0:D.signals)==null?void 0:k.feature_math;return Array.isArray(z)?z:[]},[s,(v=(_=e.data)==null?void 0:_.signals)==null?void 0:v.feature_math]),f=x.useMemo(()=>{var k,T;if(!r)return null;const z=(T=(k=e.data)==null?void 0:k.signals)==null?void 0:T.polynomial_features;return!Array.isArray(z)||z.length===0?null:(t?z.find(A=>A&&typeof A.node_id=="string"&&A.node_id===t):null)??z[0]??null},[r,t,(b=(y=e.data)==null?void 0:y.signals)==null?void 0:b.polynomial_features]),p=x.useMemo(()=>{var k,T;if(!i)return null;const z=(T=(k=e.data)==null?void 0:k.signals)==null?void 0:T.feature_selection;return!Array.isArray(z)||z.length===0?null:(t?z.find(A=>A&&typeof A.node_id=="string"&&A.node_id===t):null)??z[0]??null},[i,t,(E=(w=e.data)==null?void 0:w.signals)==null?void 0:E.feature_selection]),h=x.useMemo(()=>{var k,T;if(!l)return null;const z=(T=(k=e.data)==null?void 0:k.signals)==null?void 0:T.outlier_removal;return!Array.isArray(z)||!z.length?null:t?z.find(A=>A&&A.node_id===t)??z[z.length-1]??null:z[z.length-1]??null},[l,t,(j=(N=e.data)==null?void 0:N.signals)==null?void 0:j.outlier_removal]),m=x.useMemo(()=>{var k,T;if(!u)return null;const z=(T=(k=e.data)==null?void 0:k.signals)==null?void 0:T.transformer_audit;return!Array.isArray(z)||!z.length?null:t?z.find(A=>A&&A.node_id===t)??z[z.length-1]??null:z[z.length-1]??null},[u,t,(M=(C=e.data)==null?void 0:C.signals)==null?void 0:M.transformer_audit]);return{featureMathSignals:d,polynomialSignal:f,featureSelectionSignal:p,outlierPreviewSignal:h,transformerAuditSignal:m}},F4=({catalogFlags:e,featureSelectionSignal:t,upstreamTargetColumn:n,setConfigState:s})=>{const{isFeatureSelectionNode:r}=e;x.useEffect(()=>{if(!r)return;const i=typeof(t==null?void 0:t.target_column)=="string"?t.target_column.trim():"",l=typeof n=="string"?n.trim():"",u=i||l;u&&s(d=>(typeof(d==null?void 0:d.target_column)=="string"?d.target_column.trim():"")?d:{...d,target_column:u})},[t==null?void 0:t.target_column,r,s,n]),x.useEffect(()=>{if(!r)return;const i=typeof(t==null?void 0:t.k)=="number"&&Number.isFinite(t.k)?Math.max(0,Math.trunc(t.k)):null,l=Array.isArray(t==null?void 0:t.selected_columns)?t.selected_columns.length:null,u=i??l??null;u===null||u<=0||s(d=>{const f=d==null?void 0:d.k;let p=null;if(typeof f=="number"&&Number.isFinite(f))p=Math.trunc(f);else if(typeof f=="string"){const h=Number(f);Number.isFinite(h)&&(p=Math.trunc(h))}return p!==null&&p<=u?d:{...d,k:u}})},[t==null?void 0:t.k,t==null?void 0:t.selected_columns,r,s])},B4=(e,t,n)=>{const{isFeatureMathNode:s}=e,[r,i]=x.useState(()=>new Set),l=x.useMemo(()=>s?QN((t==null?void 0:t.operations)??[]):[],[t==null?void 0:t.operations,s]),u=x.useMemo(()=>s?zI(l,n):[],[l,n,s]);return x.useEffect(()=>{if(!s){i(()=>new Set);return}i(d=>{if(!d.size)return d;const f=new Set(l.map(h=>h.id)),p=new Set;return d.forEach(h=>{f.has(h)&&p.add(h)}),p.size===d.size?d:p})},[l,s]),{featureMathOperations:l,featureMathSummaries:u,collapsedFeatureMath:r,setCollapsedFeatureMath:i}},H4=e=>{var r,i,l;const t=x.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.columns;return Array.isArray(u)?u.filter(f=>typeof f=="string"):[]},[(r=e.data)==null?void 0:r.columns]),n=x.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.column_stats;return Array.isArray(u)?u:[]},[(i=e.data)==null?void 0:i.column_stats]),s=x.useMemo(()=>{var u;return Array.isArray((u=e.data)==null?void 0:u.sample_rows)?e.data.sample_rows:[]},[(l=e.data)==null?void 0:l.sample_rows]);return{previewColumns:t,previewColumnStats:n,previewSampleRows:s}},U4=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:r,nodeId:i,previewSignature:l,skipPreview:u,cachedPreviewSchema:d,setCachedPreviewSchema:f,catalogFlags:p,upstreamTargetColumn:h,setConfigState:m,configState:_})=>{const v=P4({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:r,nodeId:i,previewSignature:l,skipPreview:u,cachedPreviewSchema:d,setCachedPreviewSchema:f,catalogFlags:p}),{previewState:y}=v,b=I4({previewState:y,nodeId:i,catalogFlags:p}),{featureSelectionSignal:w,featureMathSignals:E}=b;F4({catalogFlags:p,featureSelectionSignal:w,upstreamTargetColumn:h??"",setConfigState:m});const N=B4(p,_,E),j=H4(y);return{nodePreview:v,previewSignals:b,featureMathState:N,previewData:j}},q4=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:s,recommendations:r,filteredRecommendations:i,isFetchingRecommendations:l,recommendationsError:u,relativeGeneratedAt:d,formatSignalName:f,formatMissingPercentage:p,getPriorityClass:h,getPriorityLabel:m,handleToggleColumn:_,selectedColumns:v})=>{const y=b=>{if(!(b!=null&&b.name))return null;const w=String(b.name),E=v.includes(w),N=h(b.priority),j=m(b.priority),C=Array.isArray(b==null?void 0:b.signals)?b.signals.map(M=>f(M)).filter(M=>!!M):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:E,onChange:()=>_(w)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:w}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[b.missing_percentage!==void 0&&b.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${p(b.missing_percentage)}`}),N&&j&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${N}`,children:j})]}),C.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:C.map(M=>a.jsx("span",{className:"canvas-modal__signal-badge",children:M},`${w}-${M}`))}),b.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:b.reason})]})]},w)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>s(null),children:["All reasons (",r.length,")"]}),t.map(b=>{const w=n===b.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${w?" canvas-modal__filter-button--active":""}`,onClick:()=>s(E=>E===b.id?null:b.id),title:b.description??void 0,children:[b.label," (",b.count,")"]},b.id)})]}),l&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!l&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!l&&!u&&a.jsxs(a.Fragment,{children:[d&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",d,"."]}),i.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:i.map(b=>y(b))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},V4=({parameter:e,previewStateStatus:t,isBinningNode:n,isScalingNode:s,binningAllNumericColumns:r,binningRecommendedColumnSet:i,selectedColumns:l,availableColumns:u,scalingExcludedColumns:d,normalizedColumnSearch:f,filteredColumnOptions:p,binningExcludedColumns:h,selectionCount:m,isCastNode:_,columnSuggestions:v,sourceId:y,isFetchingRecommendations:b,hasReachableSource:w,refreshRecommendations:E,availableFilters:N,activeFilterId:j,setActiveFilterId:C,recommendations:M,filteredRecommendations:z,recommendationsError:D,relativeGeneratedAt:k,formatSignalName:T,handleToggleColumn:A,handleRemoveColumn:O,handleApplyAllRecommended:R,handleBinningApplyColumns:L,handleSelectAllColumns:F,handleClearColumns:B,columnSearch:q,setColumnSearch:I,columnMissingMap:U,columnTypeMap:V,binningColumnPreviewMap:H,isImputerNode:G,showRecommendations:W})=>{var Ve;const J=((Ve=e==null?void 0:e.source)==null?void 0:Ve.type)==="drop_column_recommendations",ee=!J,Z=ee&&t==="loading",K=n&&e.name==="columns",X=s&&e.name==="columns",Q=(()=>{if(!K)return[];const Se=[...r];return i.size>0&&i.forEach(We=>{Se.includes(We)||Se.push(We)}),l.forEach(We=>{We&&!Se.includes(We)&&Se.push(We)}),Se})(),ne=K?Q:X?u.filter(Se=>!d.has(Se)):u,le=K?f?Q.filter(Se=>Se.toLowerCase().includes(f)):Q:X?p.filter(Se=>!d.has(Se)):p,ce=K?l.filter(Se=>!h.has(Se)).length:X?l.filter(Se=>!d.has(Se)).length:m,ie=ee&&ne.length>0&&ce>=ne.length,ge=J||G,Re=new Set(ne),ze=_&&ee?Object.entries(v).filter(([Se,We])=>Re.has(Se)&&We.length>0).map(([Se,We])=>`${Se}: ${We.join(", ")}`).slice(0,4):[],me=K?Array.from(h).slice(0,4):[],xe=X?Array.from(d).slice(0,4):[],Ce=K&&i.size>0,Ae=Ce?Array.from(i).some(Se=>!l.includes(Se)):!1;return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),J&&y&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:E,disabled:b||!w,children:b?"Refreshing":"Refresh suggestions"})})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),ze.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",ze.join("; ")]}),K&&h.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",h.size," non-numeric column",h.size===1?"":"s",me.length?` (examples: ${me.join(", ")}${h.size>me.length?", ":""})`:""," binning only supports numeric inputs."]}),X&&d.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",d.size," non-numeric column",d.size===1?"":"s",xe.length?` (examples: ${xe.join(", ")}${d.size>xe.length?", ":""})`:""," scaling only supports numeric inputs."]}),J&&a.jsx(q4,{sourceId:y,availableFilters:N,activeFilterId:j,setActiveFilterId:C,recommendations:M,filteredRecommendations:z,isFetchingRecommendations:b,recommendationsError:D,relativeGeneratedAt:k,formatSignalName:T,formatMissingPercentage:ms,getPriorityClass:uR,getPriorityLabel:dR,handleToggleColumn:A,selectedColumns:l}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:ce})]}),ce>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:l.map(Se=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[Se,a.jsx("button",{type:"button",onClick:()=>O(Se),"aria-label":`Remove ${Se}`,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(il,{size:12})})]},Se))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[J&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:R,disabled:!M.length,children:"Use all recommendations"}),Ce&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>L(i),disabled:!Ae,children:"Add recommended columns"}),ee&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:F,disabled:!ne.length||ie,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:B,disabled:!m,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:q,onChange:Se=>I(Se.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:le.length?le.map(Se=>{const We=l.includes(Se),ht=Object.prototype.hasOwnProperty.call(U,Se)?U[Se]:void 0,ye=ms(typeof ht=="number"?ht:null),Fe=V[Se]??null,Qe=v[Se]??[],tt=K?H[Se]:void 0,xt=!!(tt&&(tt.min!==null&&tt.min!==void 0||tt.max!==null&&tt.max!==void 0)),_t=K?(tt==null?void 0:tt.distinct)??null:null,Bt=K&&_t!==null&&Number.isFinite(_t),$e=Bt?_t:null,Ie=!K,Be=Ie||ge||xt||Bt,Ee=Ie&&Qe.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${We?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:We,onChange:()=>A(Se)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:Se}),Be&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Ie&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",k3(Fe)]}),ge&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",ye]}),xt&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[K?"Sample range":"Range",":"," ",tt&&tt.min!==null&&tt.min!==void 0?Bs(tt.min):""," ",""," ",tt&&tt.max!==null&&tt.max!==void 0?Bs(tt.max):""]}),Bt&&$e!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",Js($e)]})]}),Ee&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",Qe.join(", ")]})]})]},Se)}):a.jsx("p",{className:"canvas-modal__note",children:u.length?K&&ne.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":Z?"Loading column catalog":y?w?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},e.name)},K4=({parameter:e,nodeId:t,configState:n,handleNumberChange:s,handleBooleanChange:r,handleTextChange:i,thresholdParameterName:l,normalizedSuggestedThreshold:u,showRecommendations:d,canApplySuggestedThreshold:f,thresholdMatchesSuggestion:p,handleApplySuggestedThreshold:h,renderMultiSelect:m})=>{var y;if(!(e!=null&&e.name))return null;if(e.type==="multi_select")return a.jsx(a.Fragment,{children:m(e)});if(e.type==="number"){const b=`node-${t}-${e.name}`,w=n==null?void 0:n[e.name],E=typeof w=="number"?w:w??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:b,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx(yl,{id:b,value:E,min:e.min!==void 0?e.min:void 0,max:e.max!==void 0?e.max:void 0,step:e.step!==void 0?e.step:"any",onChange:N=>s(e.name,N.target.value)}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),l===e.name&&u!==null&&d&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:ms(u)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:h,disabled:!f,children:p?"Applied":"Apply suggestion"})]})]},e.name)}if(e.type==="boolean"){const b=`node-${t}-${e.name}`,w=!!(n!=null&&n[e.name]);return a.jsx(vl,{id:b,label:w?"Enabled":"Disabled",fieldLabel:e.label,description:e.description,checked:w,onChange:E=>r(e.name,E.target.checked)},e.name)}if(e.type==="select"){const b=`node-${t}-${e.name}`,w=Array.isArray(e.options)?e.options:[],E=n==null?void 0:n[e.name],N=typeof e.default=="string"?e.default:((y=w.find(C=>C&&typeof C.value=="string"))==null?void 0:y.value)??"",j=typeof E=="string"&&E.trim().length?E:N;return a.jsx(Mr,{label:e.label,htmlFor:b,description:e.description,children:a.jsx(Jd,{id:b,value:j,onChange:C=>i(e.name,C.target.value),options:[],children:w.map(C=>a.jsx("option",{value:C.value,title:C.description??void 0,children:C.label??C.value},C.value))})},e.name)}if(e.type==="textarea"){const b=`node-${t}-${e.name}`;if(e.name==="hyperparameters"){let E="",N=n==null?void 0:n[e.name];if(typeof N=="string"&&N.trim())try{const j=JSON.parse(N);j&&typeof j=="object"&&!Array.isArray(j)?E=Object.entries(j).map(([C,M])=>`${C}: ${JSON.stringify(M)}`).join(`
`):E=N}catch{E=N}else N&&typeof N=="object"&&!Array.isArray(N)&&(E=Object.entries(N).map(([j,C])=>`${j}: ${JSON.stringify(C)}`).join(`
`));return a.jsx(Mr,{label:e.label,htmlFor:b,description:e.description||"Enter parameters as key: value pairs (one per line)",children:a.jsx(Vw,{id:b,className:"canvas-modal__input--wide",value:E,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:j=>{const M=j.target.value.split(`
`).filter(D=>D.trim()),z={};for(const D of M){const k=D.indexOf(":");if(k===-1)continue;const T=D.substring(0,k).trim(),A=D.substring(k+1).trim();if(T)try{z[T]=JSON.parse(A)}catch{z[T]=A}}i(e.name,JSON.stringify(z,null,2))},rows:6})},e.name)}const w=typeof(n==null?void 0:n[e.name])=="string"?n==null?void 0:n[e.name]:"";return a.jsx(Mr,{label:e.label,htmlFor:b,description:e.description,children:a.jsx(Vw,{id:b,className:"canvas-modal__input--wide",value:w,placeholder:e.placeholder??"",onChange:E=>i(e.name,E.target.value),rows:4})},e.name)}const _=`node-${t}-${e.name}`,v=(n==null?void 0:n[e.name])??"";return a.jsx(Mr,{label:e.label,htmlFor:_,description:e.description,children:a.jsx(Mp,{id:_,className:"canvas-modal__input--wide",value:v,placeholder:e.placeholder??"",onChange:b=>i(e.name,b.target.value)})},e.name)},Y4=({nodeId:e,catalogFlags:t,configState:n,previewState:s,binning:r,scaling:i,selectedColumns:l,availableColumns:u,filteredColumnOptions:d,normalizedColumnSearch:f,columnSearch:p,setColumnSearch:h,columnSuggestions:m,columnMissingMap:_,columnTypeMap:v,sourceId:y,hasReachableSource:b,recommendationsState:w,columnSelectionHandlers:E,parameterHandlers:N,thresholdRecommendations:j,numericExcludedColumns:C,selectionCount:M})=>{const{isBinningNode:z,isScalingNode:D,isCastNode:k,isImputerNode:T}=t,A=x.useCallback(R=>a.jsx(V4,{parameter:R,previewStateStatus:s.status,isBinningNode:z,isScalingNode:D,binningAllNumericColumns:r.state.allNumericColumns,binningRecommendedColumnSet:r.state.recommendedColumnSet,selectedColumns:l,availableColumns:u,scalingExcludedColumns:i.state.excludedColumns,normalizedColumnSearch:f,filteredColumnOptions:d,binningExcludedColumns:r.state.excludedColumns,selectionCount:M,isCastNode:k,columnSuggestions:m,sourceId:y,isFetchingRecommendations:w.isFetching,hasReachableSource:b,refreshRecommendations:w.refresh,availableFilters:w.availableFilters,activeFilterId:w.activeFilterId,setActiveFilterId:w.setActiveFilterId,recommendations:w.recommendations,filteredRecommendations:w.filteredRecommendations,recommendationsError:w.error,relativeGeneratedAt:w.relativeGeneratedAt,formatSignalName:w.formatSignalName,handleToggleColumn:E.handleToggleColumn,handleRemoveColumn:E.handleRemoveColumn,handleApplyAllRecommended:E.handleApplyAllRecommended,handleBinningApplyColumns:r.handlers.handleApplyColumns,handleSelectAllColumns:E.handleSelectAllColumns,handleClearColumns:E.handleClearColumns,columnSearch:p,setColumnSearch:h,columnMissingMap:_,columnTypeMap:v,binningColumnPreviewMap:r.state.columnPreviewMap,isImputerNode:T,showRecommendations:w.show}),[w.activeFilterId,u,w.availableFilters,_,p,m,v,r.state.allNumericColumns,C,d,w.filteredRecommendations,w.formatSignalName,E.handleApplyAllRecommended,r.handlers.handleApplyColumns,E.handleClearColumns,E.handleRemoveColumn,E.handleSelectAllColumns,E.handleToggleColumn,b,k,w.isFetching,z,r.state.recommendedColumnSet,r.state.columnPreviewMap,T,D,r.state.excludedColumns,s.status,w.recommendations,w.error,w.relativeGeneratedAt,l,M,w.setActiveFilterId,h,i.state.excludedColumns,w.show,y,w.refresh,f]),O=x.useCallback(R=>a.jsx(K4,{parameter:R,nodeId:e,configState:n,handleNumberChange:N.handleNumberChange,handleBooleanChange:N.handleBooleanChange,handleTextChange:N.handleTextChange,thresholdParameterName:j.thresholdParameterName,normalizedSuggestedThreshold:j.normalizedSuggestedThreshold,showRecommendations:w.show,canApplySuggestedThreshold:j.canApplySuggestedThreshold,thresholdMatchesSuggestion:j.thresholdMatchesSuggestion,handleApplySuggestedThreshold:j.handleApplySuggestedThreshold,renderMultiSelect:A}),[j.canApplySuggestedThreshold,n,j.handleApplySuggestedThreshold,N.handleBooleanChange,N.handleNumberChange,N.handleTextChange,e,j.normalizedSuggestedThreshold,A,w.show,j.thresholdMatchesSuggestion,j.thresholdParameterName]);return{renderMultiSelectField:A,renderParameterField:O}},W4=(e,t)=>{const n=x.useMemo(()=>{var p,h,m,_,v,y;const r=[],i=((p=e==null?void 0:e.data)==null?void 0:p.label)||(t==null?void 0:t.label);i&&r.push({label:"Label",value:String(i)});const l=((h=e==null?void 0:e.data)==null?void 0:h.description)||(t==null?void 0:t.description);l&&r.push({label:"Description",value:String(l)});const u=((m=e==null?void 0:e.data)==null?void 0:m.category)||(t==null?void 0:t.category);u&&r.push({label:"Category",value:String(u)}),(_=e==null?void 0:e.data)!=null&&_.catalogType&&r.push({label:"Node type",value:String(e.data.catalogType)});const d=((v=e==null?void 0:e.data)==null?void 0:v.inputs)||(t==null?void 0:t.inputs);d&&Array.isArray(d)&&d.length&&r.push({label:"Inputs",value:d.join(", ")});const f=((y=e==null?void 0:e.data)==null?void 0:y.outputs)||(t==null?void 0:t.outputs);return f&&Array.isArray(f)&&f.length&&r.push({label:"Outputs",value:f.join(", ")}),r},[e,t]),s=x.useMemo(()=>{var i;const r=((i=e==null?void 0:e.data)==null?void 0:i.label)??(t==null?void 0:t.label)??(e==null?void 0:e.id);return typeof r=="string"&&r.trim()?r:`Node ${(e==null?void 0:e.id)??""}`},[e,t]);return{metadata:n,title:s}},e1=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},G4=(e,t)=>{var _;const n=typeof(e==null?void 0:e.id)=="string"?e.id:"",s=x.useMemo(()=>{var b;const v=(b=e==null?void 0:e.data)==null?void 0:b.connectionInfo;if(!v)return null;const y=w=>Array.isArray(w)?w.map(E=>({...E})):[];return{inputs:y(v.inputs),outputs:y(v.outputs)}},[e]),r=x.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const v=t.edges.filter(y=>(y==null?void 0:y.target)===n).map(y=>e1(n,y==null?void 0:y.targetHandle)).filter(y=>!!y);return new Set(v)},[t,n]),i=x.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const v=t.edges.filter(y=>(y==null?void 0:y.source)===n).map(y=>e1(n,y==null?void 0:y.sourceHandle)).filter(y=>!!y);return new Set(v)},[t,n]),l=((_=e==null?void 0:e.data)==null?void 0:_.hasRequiredConnections)!==!1,u=x.useMemo(()=>{var v;return(v=s==null?void 0:s.inputs)!=null&&v.length?s.inputs.filter(y=>y.required!==!1):[]},[s==null?void 0:s.inputs]),d=x.useMemo(()=>u.length?u.filter(v=>!r.has(v.key)):[],[r,u]),f=l&&d.length===0,p=x.useMemo(()=>{if(!f)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[f]),h=f?void 0:!0,m=x.useMemo(()=>{if(!(s!=null&&s.inputs)||s.inputs.length===0)return;let v=!1;const y={};return s.inputs.forEach(b=>{if(!Array.isArray(b.accepts)||b.accepts.length===0)return;const w=r.has(b.key);b.accepts.forEach(E=>{(E==="train"||E==="validation"||E==="test")&&(y[E]=w,v=!0)})}),v?y:void 0},[s==null?void 0:s.inputs,r]);return{connectionInfo:s,connectedHandleKeys:r,connectedOutputHandleKeys:i,evaluationSplitConnectivity:m,connectionReady:f,gatedSectionStyle:p,gatedAriaDisabled:h}},X4=e=>x.useMemo(()=>{const t=new Map;return e.forEach(n=>{n!=null&&n.name&&t.set(n.name,n)}),n=>t.get(n)??null},[e]),Q4=(e,t)=>{const n=x.useMemo(()=>{var f;const u=(f=e==null?void 0:e.data)==null?void 0:f.parameters;let d=[];return Array.isArray(u)&&u.length>0?d=u:t!=null&&t.parameters&&(d=t.parameters),d.filter(p=>!!(p!=null&&p.name)).map(p=>({...p}))},[e,t]),s=X4(n),r=x.useCallback((u,d)=>u?s(d):null,[s]),i=x.useMemo(()=>n.some(u=>{var d;return(u==null?void 0:u.type)==="multi_select"&&((d=u==null?void 0:u.source)==null?void 0:d.type)!=="drop_column_recommendations"}),[n]),l=x.useMemo(()=>n.find(u=>{var d;return((d=u==null?void 0:u.source)==null?void 0:d.type)==="drop_column_recommendations"})??null,[n]);return{parameters:n,getParameter:s,getParameterIf:r,requiresColumnCatalog:i,dropColumnParameter:l}},Z4=({isResetAvailable:e=!1,defaultConfigTemplate:t,catalogFlags:n})=>{const{isDataset:s,isScalingNode:r,isBinningNode:i,isBinnedDistributionNode:l,isSkewnessDistributionNode:u,isFeatureMathNode:d,isFeatureTargetSplitNode:f,isTrainTestSplitNode:p,isModelEvaluationNode:h,isHashEncodingNode:m,isPolynomialFeaturesNode:_,isFeatureSelectionNode:v,isDataConsistencyNode:y,isTrainModelDraftNode:b,isHyperparameterTuningNode:w,isClassUndersamplingNode:E,isClassOversamplingNode:N,isLabelEncodingNode:j,isTargetEncodingNode:C,isDummyEncodingNode:M,isOneHotEncodingNode:z,isOrdinalEncodingNode:D,isImputerNode:k,isMissingIndicatorNode:T,isReplaceAliasesNode:A,isTrimWhitespaceNode:O,isRemoveSpecialCharsNode:R,isReplaceInvalidValuesNode:L,isRegexCleanupNode:F,isNormalizeTextCaseNode:B,isStandardizeDatesNode:q,isCastNode:I,isRemoveDuplicatesNode:U,isDropMissingNode:V,isOutlierNode:H}=n,G=x.useMemo(()=>!!(e&&!s&&t),[t,s,e]),ee=[d,f,p,h,m,_,v,y,b,w,E||N,j,C,M,z,D,k,T,A,O,R,L,F,B,q,I,U,V,H].some(Boolean),Z=l||u;return{canResetNode:G,headerCanResetNode:G&&!(Z||r||i||ee),footerCanResetNode:G&&!Z}},J4=({node:e})=>{var h;const t=typeof(e==null?void 0:e.id)=="string"?e.id:void 0,n=x.useMemo(()=>{var _;const m=dm(((_=e==null?void 0:e.data)==null?void 0:_.config)??{});return!m||typeof m!="object"||Array.isArray(m)?{}:((!m.column_overrides||typeof m.column_overrides!="object"||Array.isArray(m.column_overrides))&&(m.column_overrides={}),m)},[e==null?void 0:e.id,(h=e==null?void 0:e.data)==null?void 0:h.config]),[s,r]=x.useState(n),[i,l]=x.useState(0),u=x.useRef(t);x.useEffect(()=>{u.current!==t&&(u.current=t,r(n),l(m=>m+1))},[t]);const d=x.useMemo(()=>Qc(n),[n]),f=x.useMemo(()=>Qc(s),[s]),p=x.useCallback(()=>{r(n)},[n]);return{initialConfig:n,configState:s,setConfigState:r,stableInitialConfig:d,stableCurrentConfig:f,nodeChangeVersion:i,resetToInitialConfig:p}},eB=({setConfigState:e})=>{const t=x.useCallback((l,u)=>{l&&e(d=>{const f={...d};return u===void 0?delete f[l]:f[l]=u,f})},[e]),n=x.useCallback((l,u)=>{if(!l)return;if(u===""){t(l,void 0);return}const d=Number(u);Number.isNaN(d)||t(l,d)},[t]),s=x.useCallback((l,u)=>{if(!l)return;if(u===""){t(l,void 0);return}const d=Number(u);if(!Number.isFinite(d))return;const f=Math.min(Math.max(d,0),100);t(l,f)},[t]),r=x.useCallback((l,u)=>{t(l,u)},[t]),i=x.useCallback((l,u)=>{t(l,u)},[t]);return{handleParameterChange:t,handleNumberChange:n,handlePercentileChange:s,handleBooleanChange:r,handleTextChange:i}},tB=(e,t)=>{const n=(s,r)=>s?e(r):null;return x.useMemo(()=>{const{isBinningNode:s,isScalingNode:r,isRemoveDuplicatesNode:i,isReplaceAliasesNode:l,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isReplaceInvalidValuesNode:f,isRegexCleanupNode:p,isNormalizeTextCaseNode:h,isLabelEncodingNode:m,isHashEncodingNode:_,isPolynomialFeaturesNode:v,isFeatureSelectionNode:y,isFeatureMathNode:b,isClassUndersamplingNode:w,isClassOversamplingNode:E,isFeatureTargetSplitNode:N,isTrainModelDraftNode:j,isHyperparameterTuningNode:C,isTargetEncodingNode:M,isOrdinalEncodingNode:z,isDummyEncodingNode:D,isOneHotEncodingNode:k,isMissingIndicatorNode:T,isDropMissingRowsNode:A,isDropMissingColumnsNode:O}=t,R=w||E,L=j||C;return{binning:{columns:n(s,"columns")},scaling:{columns:n(r,"columns"),defaultMethod:n(r,"default_method"),autoDetect:n(r,"auto_detect")},removeDuplicates:{columns:n(i,"columns"),keep:n(i,"keep")},replaceAliases:{customPairs:n(l,"custom_pairs")},trimWhitespace:{columns:n(u,"columns"),mode:n(u,"mode")},removeSpecial:{columns:n(d,"columns"),mode:n(d,"mode"),replacement:n(d,"replacement")},replaceInvalid:{columns:n(f,"columns"),mode:n(f,"mode"),minValue:n(f,"min_value"),maxValue:n(f,"max_value")},regexCleanup:{columns:n(p,"columns"),mode:n(p,"mode"),pattern:n(p,"pattern"),replacement:n(p,"replacement")},normalizeCase:{columns:n(h,"columns"),mode:n(h,"mode")},labelEncoding:{columns:m?e("columns"):null,autoDetect:m?e("auto_detect"):null,maxUnique:m?e("max_unique_values"):null,outputSuffix:m?e("output_suffix"):null,dropOriginal:m?e("drop_original"):null,missingStrategy:m?e("missing_strategy"):null,missingCode:m?e("missing_code"):null},hashEncoding:{columns:_?e("columns"):null,autoDetect:_?e("auto_detect"):null,maxCategories:_?e("max_categories"):null,buckets:_?e("n_buckets"):null,outputSuffix:_?e("output_suffix"):null,dropOriginal:_?e("drop_original"):null,encodeMissing:_?e("encode_missing"):null},polynomial:{columns:n(v,"columns"),autoDetect:n(v,"auto_detect"),degree:n(v,"degree"),includeBias:n(v,"include_bias"),interactionOnly:n(v,"interaction_only"),includeInputFeatures:n(v,"include_input_features"),outputPrefix:n(v,"output_prefix")},featureSelection:{columns:n(y,"columns"),autoDetect:n(y,"auto_detect"),targetColumn:n(y,"target_column"),method:n(y,"method"),scoreFunc:n(y,"score_func"),problemType:n(y,"problem_type"),k:n(y,"k"),percentile:n(y,"percentile"),alpha:n(y,"alpha"),threshold:n(y,"threshold"),mode:n(y,"mode"),estimator:n(y,"estimator"),step:n(y,"step"),minFeatures:n(y,"min_features"),maxFeatures:n(y,"max_features"),dropUnselected:n(y,"drop_unselected")},featureMath:{errorHandling:n(b,"error_handling"),allowOverwrite:n(b,"allow_overwrite"),defaultTimezone:n(b,"default_timezone"),epsilon:n(b,"epsilon")},resampling:{method:n(R,"method"),targetColumn:n(R,"target_column"),samplingStrategy:n(R,"sampling_strategy"),randomState:n(R,"random_state"),kNeighbors:n(E,"k_neighbors"),replacement:n(w,"replacement")},featureTargetSplit:{targetColumn:n(N,"target_column")},trainModel:{targetColumn:n(L,"target_column"),problemType:n(L,"problem_type"),modelType:n(L,"model_type"),hyperparameters:n(j,"hyperparameters"),cvEnabled:n(L,"cv_enabled"),cvStrategy:n(L,"cv_strategy"),cvFolds:n(L,"cv_folds"),cvShuffle:n(L,"cv_shuffle"),cvRandomState:n(L,"cv_random_state"),cvRefitStrategy:n(j,"cv_refit_strategy")},hyperparameterTuning:{searchStrategy:n(C,"search_strategy"),searchIterations:n(C,"search_iterations"),searchRandomState:n(C,"search_random_state"),scoringMetric:n(C,"scoring_metric")},targetEncoding:{columns:M?e("columns"):null,targetColumn:M?e("target_column"):null,autoDetect:M?e("auto_detect"):null,maxCategories:M?e("max_categories"):null,outputSuffix:M?e("output_suffix"):null,dropOriginal:M?e("drop_original"):null,smoothing:M?e("smoothing"):null,encodeMissing:M?e("encode_missing"):null,handleUnknown:M?e("handle_unknown"):null},ordinalEncoding:{columns:z?e("columns"):null,autoDetect:z?e("auto_detect"):null,maxCategories:z?e("max_categories"):null,outputSuffix:z?e("output_suffix"):null,dropOriginal:z?e("drop_original"):null,encodeMissing:z?e("encode_missing"):null,handleUnknown:z?e("handle_unknown"):null,unknownValue:z?e("unknown_value"):null},dummyEncoding:{columns:D?e("columns"):null,autoDetect:D?e("auto_detect"):null,maxCategories:D?e("max_categories"):null,dropFirst:D?e("drop_first"):null,includeMissing:D?e("include_missing"):null,dropOriginal:D?e("drop_original"):null,prefixSeparator:D?e("prefix_separator"):null},oneHotEncoding:{columns:k?e("columns"):null,autoDetect:k?e("auto_detect"):null,maxCategories:k?e("max_categories"):null,dropFirst:k?e("drop_first"):null,includeMissing:k?e("include_missing"):null,dropOriginal:k?e("drop_original"):null,prefixSeparator:k?e("prefix_separator"):null},missingIndicator:{columns:n(T,"columns"),suffix:n(T,"flag_suffix")},dropRows:{any:n(A,"drop_if_any_missing")},dropMissing:{threshold:n(O||A,"missing_threshold")}}},[t,e])},nB=(e,t)=>{const{isBinningNode:n,isCastNode:s,isDropMissingColumnsNode:r,isDropMissingRowsNode:i,isImputerNode:l,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:f,isRemoveSpecialCharsNode:p,isReplaceInvalidValuesNode:h,isRegexCleanupNode:m,isNormalizeTextCaseNode:_,isStandardizeDatesNode:v,isScalingNode:y,isClassUndersamplingNode:b,isClassOversamplingNode:w,isTrainModelDraftNode:E,isLabelEncodingNode:N,isOrdinalEncodingNode:j,isDummyEncodingNode:C,isOneHotEncodingNode:M,isRemoveDuplicatesNode:z,isSkewnessNode:D,isFeatureTargetSplitNode:k}=t;return x.useMemo(()=>{let T=e;return T=T.filter(A=>{var O;return((O=A==null?void 0:A.source)==null?void 0:O.type)!=="drop_column_recommendations"}),(r||i)&&(T=T.filter(A=>A.name!=="missing_threshold")),i&&(T=T.filter(A=>A.name!=="drop_if_any_missing")),l&&(T=T.filter(A=>A.name!=="strategies")),D&&(T=T.filter(A=>A.name!=="transformations")),s&&(T=T.filter(A=>A.name!=="columns")),n&&(T=T.filter(A=>A.name!=="columns")),y&&(T=T.filter(A=>!["columns","default_method","auto_detect"].includes(A.name))),z&&(T=T.filter(A=>A.name!=="columns"&&A.name!=="keep")),u&&(T=T.filter(A=>A.name!=="columns"&&A.name!=="flag_suffix")),d&&(T=T.filter(A=>!["columns","mode","custom_pairs"].includes(A.name))),f&&(T=T.filter(A=>!["columns","mode"].includes(A.name))),p&&(T=T.filter(A=>!["columns","mode","replacement"].includes(A.name))),h&&(T=T.filter(A=>!["columns","mode","min_value","max_value"].includes(A.name))),m&&(T=T.filter(A=>!["columns","mode","pattern","replacement"].includes(A.name))),_&&(T=T.filter(A=>!["columns","mode"].includes(A.name))),v&&(T=T.filter(A=>!["columns","mode"].includes(A.name))),b&&(T=T.filter(A=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(A.name))),w&&(T=T.filter(A=>!["method","target_column","sampling_strategy","random_state"].includes(A.name))),E&&(T=T.filter(A=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(A.name))),k&&(T=T.filter(A=>A.name!=="target_column")),N&&(T=T.filter(A=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(A.name))),j&&(T=T.filter(A=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(A.name))),C&&(T=T.filter(A=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(A.name))),M&&(T=T.filter(A=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(A.name))),T},[e,n,s,r,i,l,u,d,f,p,h,m,_,v,y,b,w,E,N,j,C,M,z,D,k])},sB=e=>{const t=x.useMemo(()=>OR,[]),n=x.useMemo(()=>t.map(i=>i.value),[t]),s=x.useMemo(()=>Qw(e==null?void 0:e.strategies,n),[e==null?void 0:e.strategies,n]),r=s.length;return{imputationMethodOptions:t,imputationMethodValues:n,imputerStrategies:s,imputerStrategyCount:r}},rB=(e,t)=>{const n=x.useMemo(()=>Op(Zw(e==null?void 0:e.transformations)),[e==null?void 0:e.transformations]),s=x.useCallback(r=>{t(i=>{const l=Op(Zw(i==null?void 0:i.transformations)),u=Op(r(l));return{...i,transformations:u.map(d=>({...d}))}})},[t]);return{skewnessTransformations:n,updateSkewnessTransformations:s}},aB=()=>{const{data:e=[],isLoading:t,error:n}=Is({queryKey:["feature-canvas","node-catalog"],queryFn:Ep,staleTime:3e5}),s=x.useMemo(()=>{const r=new Map;return e.forEach(i=>{i&&typeof i.type=="string"&&i.type.trim()&&r.set(i.type,i)}),r},[e]);return{nodeCatalog:e,catalogEntryMap:s,isLoading:t,error:n}},oB={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},iB=({node:e,graphSnapshot:t,isResetAvailable:n,defaultConfigTemplate:s})=>{const r=G4(e,t),i=Jj(e),{catalogType:l,isDataset:u,isClassUndersamplingNode:d,isClassOversamplingNode:f,isDataConsistencyNode:p,isSkewnessNode:h,isSkewnessDistributionNode:m}=i,_=u,v=d||f,{catalogEntryMap:y}=aB(),b=x.useMemo(()=>l?y.get(l):null,[l,y]),{metadata:w,title:E}=W4(e,b),{parameters:N,getParameter:j,requiresColumnCatalog:C,dropColumnParameter:M}=Q4(e,b),z=x.useMemo(()=>oB[l]??null,[l]),D=typeof(e==null?void 0:e.id)=="string"?e.id:"",k=Z4({isResetAvailable:n,defaultConfigTemplate:s,catalogFlags:i}),T=tB(j,i),A=nB(N,i),O=x.useMemo(()=>p?A:[],[A,p]),R=h||m,L=J4({node:e}),{setConfigState:F,configState:B}=L,q=eB({setConfigState:F}),I=sB(B),U=rB(B,F);return{metadata:w,title:E,connectionReadiness:r,catalogFlags:i,datasetBadge:_,isClassResamplingNode:v,parameters:N,getParameter:j,requiresColumnCatalog:C,dropColumnParameter:M,dataConsistencyHint:z,nodeId:D,resetPermissions:k,nodeParams:T,filteredParameters:A,dataConsistencyParameters:O,shouldLoadSkewnessInsights:R,configStateResult:L,parameterHandlers:q,imputationStrategiesResult:I,skewnessStateResult:U,catalogEntry:b}},Em=e=>{const t=Number(e);return Number.isFinite(t)?Math.max(0,Math.round(t)):null},lB=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:r})=>{const i=x.useMemo(()=>Xn(e??null),[e]),l=x.useMemo(()=>Xn((t==null?void 0:t.generated_at)??null),[t==null?void 0:t.generated_at]),u=x.useMemo(()=>Xn((n==null?void 0:n.generated_at)??null),[n==null?void 0:n.generated_at]),d=x.useMemo(()=>Xn((s==null?void 0:s.generated_at)??null),[s==null?void 0:s.generated_at]),f=x.useMemo(()=>Xn((r==null?void 0:r.generated_at)??null),[r==null?void 0:r.generated_at]),p=x.useMemo(()=>Em((t==null?void 0:t.sample_size)??null),[t==null?void 0:t.sample_size]),h=x.useMemo(()=>Em((n==null?void 0:n.sample_size)??null),[n==null?void 0:n.sample_size]),m=x.useMemo(()=>Em((s==null?void 0:s.sample_size)??null),[s==null?void 0:s.sample_size]),_=x.useMemo(()=>Em((r==null?void 0:r.sample_size)??null),[r==null?void 0:r.sample_size]);return{relativeGeneratedAt:i,relativeScalingGeneratedAt:l,relativeBinningGeneratedAt:u,relativeBinnedGeneratedAt:d,relativeOutlierGeneratedAt:f,scalingSampleSize:p,binningSampleSize:h,binnedSampleSize:m,outlierSampleSize:_}},cB=({isProfileLoading:e,isPreviewLoading:t,isFetchingScaling:n,isFetchingBinning:s,isFetchingHashEncoding:r,isFetchingBinnedDistribution:i,isFetchingRecommendations:l,catalogFlags:u})=>{const{isPreviewNode:d}=u,f=x.useMemo(()=>e||t||n||s||r||i||l,[i,s,r,n,l,t,e]),p=x.useMemo(()=>e?"Generating dataset profile":n?"Loading scaling insights":s?"Loading binning insights":r?"Loading hash encoding insights":i?"Computing binned distributions":l?"Fetching column recommendations":t?d?"Loading dataset preview":"Analyzing node outputs":null,[i,s,r,l,n,t,d,e]);return{hasActiveAsyncWork:f,busyLabel:p,footerBusyLabel:p??(f?"Processing":null)}},uB=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:r,isProfileLoading:i,isPreviewLoading:l,isFetchingScaling:u,isFetchingBinning:d,isFetchingHashEncoding:f,isFetchingBinnedDistribution:p,isFetchingRecommendations:h,catalogFlags:m})=>{const _=lB({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:r}),v=cB({isProfileLoading:i,isPreviewLoading:l,isFetchingScaling:u,isFetchingBinning:d,isFetchingHashEncoding:f,isFetchingBinnedDistribution:p,isFetchingRecommendations:h,catalogFlags:m});return{insightSummaries:_,asyncBusyLabel:v}},dB=({catalogFlags:e,binnedDistributionData:t})=>{const{isBinnedDistributionNode:n}=e;return x.useMemo(()=>{if(!n)return[];const r=(Array.isArray(t==null?void 0:t.columns)?t==null?void 0:t.columns:[]).map(i=>{if(!i||!i.column)return null;const l=Number(i.total_rows),u=Number.isFinite(l)?Math.max(0,Math.round(l)):0;if(u<=0)return null;const f=(Array.isArray(i.bins)?i.bins:[]).map(k=>{if(!k)return null;const A=(typeof k.label=="string"?k.label.trim():String(k.label??""))||(k.is_missing?"Missing":"Unlabeled bin"),O=Number(k.count);if(!Number.isFinite(O))return null;const R=Math.max(0,Math.round(O)),L=Number(k.percentage),F=Number.isFinite(L)?Math.min(100,Math.max(0,L)):0,B=Number(F.toFixed(2));return{label:A,count:R,percentage:B,isMissing:!!k.is_missing}}).filter(k=>!!k);if(!f.length)return null;f.sort((k,T)=>k.isMissing!==T.isMissing?k.isMissing?1:-1:k.count!==T.count?T.count-k.count:k.label.localeCompare(T.label));const p=f.length,h=12,m=p>h,_=m?f.slice(0,h):f,v=Number(i.missing_rows),y=Number.isFinite(v)?Math.max(0,Math.round(v)):0,b=Number(i.distinct_bins),w=Number.isFinite(b)?Math.max(0,Math.round(b)):f.length,E=i.top_label;let N=typeof E=="string"?E.trim()||null:E??null;const j=Number(i.top_count);let C=Number.isFinite(j)?Math.max(0,Math.round(j)):null;const M=Number(i.top_percentage);let z=Number.isFinite(M)?Number(Math.min(100,Math.max(0,M)).toFixed(2)):null;(N===null||C===null||z===null)&&_.length&&(N=_[0].label,C=_[0].count,z=_[0].percentage);const D=typeof i.source_column=="string"?i.source_column.trim()||null:i.source_column??null;return{column:i.column,sourceColumn:D,totalRows:u,missingRows:y,distinctBins:w,topLabel:N,topCount:C,topPercentage:z,bins:_,hasMoreBins:m,totalBinCount:p}}).filter(i=>!!i);return r.sort((i,l)=>{const u=(l.topCount??0)-(i.topCount??0);return u!==0?u:i.column.localeCompare(l.column)}),r},[t,n])},t1=e=>e.map(t=>t.label.toLowerCase()).join("|"),mB=e=>{const t=new Set,n=[];return e.forEach(s=>{var l;const r=s.label.trim();if(!r)return;const i=r.toLowerCase();t.has(i)||(t.add(i),n.push({label:r,reason:((l=s.reason)==null?void 0:l.trim())||null}))}),n},hB=()=>{const[e,t]=x.useState(null),n=x.useRef(null),s=x.useCallback(d=>{const f=mB(d);if(!f.length)return;const p=t1(f);n.current&&n.current===p||t({details:f,issuedAt:Date.now()})},[]),r=x.useCallback(()=>{t(d=>(d&&(n.current=t1(d.details)),null))},[]),i=x.useCallback(()=>{n.current=null,t(null)},[]);return{pendingToastDetails:(e==null?void 0:e.details)??[],isPendingToastVisible:!!e,showPendingToast:s,dismissPendingToast:r,clearPendingToast:i}},fB=({node:e,graphContext:t,hasReachableSource:n,sourceId:s,formatRelativeTime:r,catalogFlags:i})=>{const{isDatasetProfileNode:l}=i,u=x.useMemo(()=>t?Qc(t):"",[t]),d=oR({node:e,isDatasetProfileNode:l,sourceId:s,hasReachableSource:n,graphContext:t,profilingGraphSignature:u,formatRelativeTime:r}),{profileState:f}=d;return{datasetProfileController:d,profileState:f}},pB=(e,t)=>{var r;const n=(r=e==null?void 0:e.parameter_help)==null?void 0:r[t];if(n)return n;const s=t.replace(/_/g," ").trim();return s.charAt(0).toUpperCase()+s.slice(1)},gB=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},_B=(e,t,n,s,r)=>{var f;const i=n[s]??{};if(Object.prototype.hasOwnProperty.call(i,t)){const p=i[t];if(typeof p=="number"&&Number.isFinite(p))return{value:p,fallback:null}}const u=(r[e]??{})[t];return typeof u=="number"&&Number.isFinite(u)?{value:"",fallback:u}:{value:"",fallback:((f=ro[e])==null?void 0:f[t])??null??null}},n1=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",s1={lower_percentile:"%",upper_percentile:"%"},yB=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:s,outlierMethodOptions:r,outlierMethodDetailMap:i,outlierDefaultDetail:l,outlierAutoDetectEnabled:u,outlierSelectedCount:d,outlierDefaultLabel:f,outlierOverrideCount:p,outlierParameterOverrideCount:h,outlierOverrideExampleSummary:m,outlierHasOverrides:_,outlierRecommendationRows:v,outlierHasRecommendations:y,outlierStatusMessage:b,outlierError:w,outlierSampleSize:E,relativeOutlierGeneratedAt:N,outlierPreviewSignal:j,formatMetricValue:C,formatNumericStat:M,onApplyAllRecommendations:z,onClearOverrides:D,onDefaultMethodChange:k,onAutoDetectToggle:T,onOverrideSelect:A,onMethodParameterChange:O,onColumnParameterChange:R,previewState:L,onPendingConfigurationWarning:F,onPendingConfigurationCleared:B})=>{x.useEffect(()=>{var I,U;if((U=(I=L==null?void 0:L.data)==null?void 0:I.signals)!=null&&U.full_execution){let H=At(L.data.signals.full_execution);u&&(H=H.filter(G=>!G.label.toLowerCase().includes("columns"))),H.length>0?F==null||F(H):B==null||B()}},[L,F,B,u]);const q=gB(j);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:z,disabled:!y,children:"Apply recommendations"}),a.jsxs("button",{type:"button",className:"btn btn-outline-secondary",onClick:D,disabled:!_,style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(Cc,{size:14}),"Clear overrides"]})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),N&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",N,E!==null?` on ${C(E)} row${E===1?"":"s"}.`:"."]}),!N&&E!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",C(E)," row",E===1?"":"s","."]}),q&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",q]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:r.map(I=>{const U=i.get(I.value)??null,V=I.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${V?" canvas-scaling__method-button--active":""}`,"aria-pressed":V,onClick:()=>k(I.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:I.label}),(U==null?void 0:U.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:U.description})]},I.value)})}),(l==null?void 0:l.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:l.description})]}),a.jsx(vl,{fieldLabel:"Auto-detect numeric columns",label:u?"Enabled":"Disabled",checked:u,onChange:I=>T(I.target.checked),description:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]}),(()=>{const I=s.defaultMethod,U=jm[I]??[];if(!U.length)return null;const V=i.get(I)??null;return a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for the selected strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:a.jsx("article",{className:"canvas-outlier__method-card",children:a.jsx("div",{className:"canvas-outlier__parameter-list",children:U.map(H=>{var J,ee;const G=((J=s.methodParameters[I])==null?void 0:J[H])??null,W=s1[H]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:pB(V,H)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx(yl,{className:"canvas-outlier__method-input-field",value:typeof G=="number"&&Number.isFinite(G)?G:"",placeholder:n1(((ee=ro[I])==null?void 0:ee[H])??null),onChange:Z=>{const K=Z.target.value;if(K==="")O(I,H,null);else{const X=Number(K);O(I,H,Number.isFinite(X)?X:null)}}}),W&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:W})]})]},`${I}-${H}`)})})})})]})})(),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s","  Default method"," ",a.jsx("strong",{children:f})," ",u?" Auto-detect on":" Auto-detect off",(()=>{if(!(p+h))return"  No overrides yet";const U=[];return p>0&&U.push(m?`${p} method override${p===1?"":"s"} (${m})`:`${p} method override${p===1?"":"s"}`),h>0&&U.push(`${h} parameter override${h===1?"":"s"}`),`  Overrides: ${U.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&w&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:w}),!n&&!w&&a.jsxs(a.Fragment,{children:[b&&a.jsx("p",{className:"canvas-modal__note",children:b}),v.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:v.map(I=>{const U=!I.isSkipped&&!I.isExcluded&&I.recommendedMethod&&I.recommendedMethod!==I.currentMethod,V=["canvas-cast__row"];U&&V.push("canvas-cast__row--attention"),I.isOverrideApplied&&V.push("canvas-cast__row--override"),I.isSkipped&&V.push("canvas-cast__row--muted");const H=I.isSkipped?"__skip__":I.isOverrideApplied?I.currentMethod:"__default__",G=I.isOverrideApplied?`Override -> ${I.currentMethodLabel}`:I.isSkipped?"Skipped (column will not be altered)":I.isSelected?`Inheriting ${f}`:"Pending inclusion",W=I.stats,J=[];typeof W.valid_count=="number"&&Number.isFinite(W.valid_count)&&J.push(`${C(W.valid_count)} valid rows`);const ee=typeof W.minimum=="number"&&Number.isFinite(W.minimum),Z=typeof W.maximum=="number"&&Number.isFinite(W.maximum);if(ee||Z){const ce=ee?M(W.minimum):"",ie=Z?M(W.maximum):"";J.push(`Range ${ce}  ${ie}`)}typeof W.mean=="number"&&Number.isFinite(W.mean)&&J.push(`Mean ${M(W.mean)}`),typeof W.median=="number"&&Number.isFinite(W.median)&&J.push(`Median ${M(W.median)}`),typeof W.stddev=="number"&&Number.isFinite(W.stddev)&&J.push(` ${M(W.stddev)}`);const K=J.length?J.join("  "):null,X=!I.recommendedMethod||!I.recommendedLabel?I.recommendedReason||"No outlier risk detected":I.recommendedReason?`${I.recommendedLabel}  ${I.recommendedReason}`:I.recommendedLabel,Q=s.columnParameters,ne=s.methodParameters,le=jm[I.currentMethod]??[];return a.jsxs("tr",{className:V.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:I.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[I.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",I.dtype]}),I.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),I.isSelected&&!I.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),I.isSkipped&&!I.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),I.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),I.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[I.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${U?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:I.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),X&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:X})]})}),a.jsx("td",{children:K?a.jsx("span",{children:K}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:H,onChange:ce=>A(I.column,ce.target.value),disabled:I.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",f,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),r.map(ce=>a.jsx("option",{value:ce.value,children:ce.label},`${I.column}-${ce.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:G}),le.length>0&&!I.isExcluded&&!I.isSkipped&&a.jsx("div",{className:"canvas-outlier__parameters",children:le.map(ce=>{const{value:ie,fallback:ge}=_B(I.currentMethod,ce,Q,I.column,ne),Re=s1[ce]??"";return a.jsxs("label",{children:[a.jsx("span",{children:ce.replace(/_/g," ")}),a.jsx(yl,{value:ie,placeholder:n1(ge),onChange:ze=>{const me=ze.target.value;if(me==="")R(I.column,ce,null);else{const xe=Number(me);R(I.column,ce,Number.isFinite(xe)?xe:null)}}}),Re&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:Re})]},`${I.column}-${I.currentMethod}-${ce}`)})})]})})]},`outlier-row-${I.column}`)})})]})})})]})]})},vB=({connectionInfo:e,connectedInputHandles:t,connectedOutputHandles:n,connectionReady:s})=>e?a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:s?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",style:{display:"flex",alignItems:"start",gap:"0.5rem"},children:[a.jsx("span",{style:{marginTop:"2px"},children:s?a.jsx(Kf,{size:16}):a.jsx(ga,{size:16})}),a.jsxs("span",{children:[a.jsx("strong",{children:s?"Ready to execute.":"Missing required connections."})," ",s?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]})]}),e.inputs&&e.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:e.inputs.map(r=>{const i=t.has(r.key),l=r.required!==!1;return a.jsxs("li",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[i?a.jsx(Kf,{size:14}):l?a.jsx(ga,{size:14}):a.jsx(z2,{size:14}),a.jsx("span",{children:r.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":l?"Missing":"Optional"})]},`inputs-${r.key}`)})})]}),e.outputs&&e.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:e.outputs.map(r=>{const i=n.has(r.key),l=r.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:r.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":l?"Unlinked":"Optional"})]},`outputs-${r.key}`)})})]})]}):null,r1=e=>!e||typeof e!="string"?"":e.replace(/\s+/g," ").trim().toLowerCase(),xB=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:s,sourceId:r,graphSnapshot:i,onResetConfig:l,defaultConfigTemplate:u,isResetAvailable:d=!1,onPendingConfigurationUpdate:f,onPendingConfigurationCleared:p,onHighlightPendingNodes:h,pendingConfigurationDetails:m})=>{var zi,Tu,yr,Ri,Zl,$u,th;const{metadata:_,title:v,connectionReadiness:y,catalogFlags:b,datasetBadge:w,isClassResamplingNode:E,parameters:N,requiresColumnCatalog:j,dropColumnParameter:C,dataConsistencyHint:M,nodeId:z,resetPermissions:D,nodeParams:k,dataConsistencyParameters:T,configStateResult:A,parameterHandlers:O,imputationStrategiesResult:R,skewnessStateResult:L}=iB({node:e,graphSnapshot:i??null,isResetAvailable:d,defaultConfigTemplate:u}),{connectionInfo:F,connectedHandleKeys:B,connectedOutputHandleKeys:q,evaluationSplitConnectivity:I,connectionReady:U,gatedSectionStyle:V,gatedAriaDisabled:H}=y,{catalogType:G,isDataset:W,isImputerNode:J,isMissingIndicatorNode:ee,isReplaceAliasesNode:Z,isTrimWhitespaceNode:K,isRemoveSpecialCharsNode:X,isReplaceInvalidValuesNode:Q,isRegexCleanupNode:ne,isNormalizeTextCaseNode:le,isStandardizeDatesNode:ce,isLabelEncodingNode:ie,isTargetEncodingNode:ge,isHashEncodingNode:Re,isFeatureTargetSplitNode:ze,isTrainTestSplitNode:me,isTrainModelDraftNode:xe,isModelEvaluationNode:Ce,isModelRegistryNode:Ae,isHyperparameterTuningNode:Ve,isClassUndersamplingNode:Se,isClassOversamplingNode:We,isOrdinalEncodingNode:ht,isDummyEncodingNode:ye,isOneHotEncodingNode:Fe,isFeatureMathNode:Qe,isCastNode:tt,isBinningNode:xt,isScalingNode:_t,isPolynomialFeaturesNode:Bt,isFeatureSelectionNode:$e,isTransformerAuditNode:Ie,isOutlierNode:Be,isSkewnessNode:Ee,isSkewnessDistributionNode:lt,isBinnedDistributionNode:Je,isDataConsistencyNode:Ue,isInspectionNode:Rt,isRemoveDuplicatesNode:Yt,isDropMissingColumnsNode:bt,isDropMissingRowsNode:Ot,isDropMissingNode:Pt,isPreviewNode:wt,isDatasetProfileNode:pt}=b,{canResetNode:rn,headerCanResetNode:Jt,footerCanResetNode:tn}=D,{configState:Pe,setConfigState:Wt,stableInitialConfig:mn,stableCurrentConfig:Fn,nodeChangeVersion:Gt}=A,{handleParameterChange:jt,handleNumberChange:Bn,handlePercentileChange:ts,handleBooleanChange:Hn,handleTextChange:Sn}=O,Un=x.useMemo(()=>Ae?Pe?{...Pe}:{}:null,[Pe,Ae]),{imputationMethodOptions:ns,imputationMethodValues:cn,imputerStrategies:Mn,imputerStrategyCount:Mt}=R,{skewnessTransformations:An,updateSkewnessTransformations:hs}=L,{graphTopology:Qn,modelingConfig:qs,previewSignatureResult:Vs,cachedPreviewSchema:As,setCachedPreviewSchema:en,schemaDiagnostics:et,columnCatalogState:Qt}=KF({graphSnapshot:i??null,nodeId:z,catalogFlags:b,configState:Pe,setConfigState:Wt,nodeParams:k,sourceId:r,requiresColumnCatalog:j,imputerStrategies:Mn}),{graphContext:ss,graphNodeCount:Ks,upstreamTargetColumn:Os,hasReachableSource:Nt}=Qn,{featureTargetSplitConfig:vs,trainTestSplitConfig:de,resamplingConfig:be,trainModelDraftConfig:qe,trainModelRuntimeConfig:gt,trainModelCVConfig:Le,filteredModelTypeOptions:Lt}=qs,{upstreamConfigFingerprints:Tt,previewSignature:an}=Vs,{cachedSchemaColumns:hn,oversamplingSchemaGuard:Ct,imputationSchemaDiagnostics:On,skipPreview:sr}=et,{availableColumns:Tn,setAvailableColumns:qn,columnSearch:Ys,setColumnSearch:$n,columnMissingMap:rs,setColumnMissingMap:Qr,columnTypeMap:Ts,setColumnTypeMap:It,columnSuggestions:$r,setColumnSuggestions:Zr,imputerMissingFilter:Ca,setImputerMissingFilter:Il,normalizedColumnSearch:Lr,filteredColumnOptions:Fl}=Qt,Jr=x.useMemo(()=>{const mt=(e==null?void 0:e.data)??{},fs=[],un=Yn=>{typeof Yn=="string"&&Yn.trim()&&fs.push(Yn)};return un(v),un(mt==null?void 0:mt.label),un(mt==null?void 0:mt.title),un(mt==null?void 0:mt.name),un(mt==null?void 0:mt.displayName),un(mt==null?void 0:mt.display_label),_==null||_.forEach(Yn=>{un(Yn==null?void 0:Yn.value)}),un(mt==null?void 0:mt.catalogType),un(mt==null?void 0:mt.type),typeof(e==null?void 0:e.id)=="string"&&un(e.id),new Set(fs.map(Yn=>r1(Yn)).filter(Boolean))},[_,e,v]),ea=x.useMemo(()=>!(m!=null&&m.length)||!Jr.size?[]:m.filter(mt=>Jr.has(r1(mt.label))),[m,Jr]),rr=x.useCallback(mt=>{var Yn,ko;const fs=((Yn=mt==null?void 0:mt.label)==null?void 0:Yn.trim())??"",un=((ko=mt==null?void 0:mt.reason)==null?void 0:ko.trim())??"";return fs&&un?`${fs}: ${un}`:fs?`${fs} still needs configuration.`:un||"Additional configuration required."},[]),ar=x.useMemo(()=>{if(wt||!ea.length)return null;const[mt,...fs]=ea,un=rr(mt);if(!fs.length)return un;const Yn=fs.length;return`${un} (+${Yn} more ${Yn===1?"node":"nodes"}).`},[rr,wt,ea]),yt=x.useCallback(mt=>{mt!=null&&mt.length&&(f==null||f(mt))},[f]),St=x.useCallback(()=>{p==null||p()},[p]),[zr,or]=x.useState("500"),[te,_e]=x.useState(()=>new Set);x.useEffect(()=>{_e(new Set)},[mn]),x.useEffect(()=>{r&&(p==null||p())},[r,p]);const{datasetProfileController:fe,profileState:De}=fB({node:e,graphContext:ss,hasReachableSource:Nt,sourceId:r,formatRelativeTime:Xn,catalogFlags:b}),{nodePreview:Me,previewSignals:we,featureMathState:ft,previewData:st}=U4({graphSnapshot:i??null,graphNodeCount:Ks,hasReachableSource:Nt,sourceId:r,node:e,nodeId:z,previewSignature:an,skipPreview:sr,cachedPreviewSchema:As,setCachedPreviewSchema:en,catalogFlags:b,upstreamTargetColumn:Os,setConfigState:Wt,configState:Pe}),{previewState:Te,refreshPreview:dt,clearCachedPreviewSchema:ot,canTriggerPreview:zt}=Me,{featureMathSignals:Vn,polynomialSignal:fn,featureSelectionSignal:as,outlierPreviewSignal:pr,transformerAuditSignal:ir}=we,{featureMathOperations:lr,featureMathSummaries:Kn,collapsedFeatureMath:$s,setCollapsedFeatureMath:yn}=ft,{previewColumns:Ls,previewColumnStats:ta,previewSampleRows:Rr}=st,{dropMissingColumns:_i,encodingRecommendations:os,outlierRecommendations:gr,scalingInsights:yi,binningInsights:ka,binnedDistribution:vi,skewnessInsights:Ma,missingIndicatorState:Ln,dataCleaningState:na,numericColumnAnalysis:po,numericAnalysisState:Bl,removeDuplicatesState:xi}=z4({catalogFlags:b,sourceId:r,nodeId:z,graphContext:ss,hasReachableSource:Nt,columnTypeMap:Ts,setAvailableColumns:qn,setColumnSearch:$n,setColumnMissingMap:Qr,setColumnTypeMap:It,setColumnSuggestions:Zr,dropColumnParameter:C,node:e,configState:Pe,setConfigState:Wt,nodeChangeVersion:Gt,binnedSamplePreset:zr,skewnessTransformations:An,availableColumns:Tn,columnMissingMap:rs,previewSampleRows:Rr}),{hasDropColumnSource:En,availableFilters:xs,activeFilterId:zs,setActiveFilterId:mu,recommendations:Mm,filteredRecommendations:yg,formatSignalName:vg,isFetchingRecommendations:hu,recommendationsError:Am,recommendationsGeneratedAt:xg,suggestedThreshold:bg,refreshRecommendations:wg}=_i,{labelEncoding:bi,targetEncoding:Aa,hashEncoding:go,ordinalEncoding:wi,dummyEncoding:Ni,oneHotEncoding:_o}=os,{outlierData:Ng,outlierError:jg,isFetchingOutliers:Sg,refreshOutliers:Om}=gr,{scalingData:Eg,scalingError:Cg,isFetchingScaling:Tm,refreshScaling:Hl}=yi,{binningData:ji,binningError:kg,isFetchingBinning:fu,refreshBinning:pu}=ka,Oa=x.useCallback(()=>{ot(),dt(),_t&&Hl(),xt&&pu(),Be&&Om()},[xt,Be,_t,pu,Om,ot,dt,Hl]),{binnedDistributionData:gu,binnedDistributionError:$m,isFetchingBinnedDistribution:Ta,refreshBinnedDistribution:Lm}=vi,{skewnessData:Mg,skewnessError:zm,isFetchingSkewness:_u,refreshSkewness:Rm}=Ma,{activeFlagSuffix:yo,missingIndicatorColumns:Ul,missingIndicatorInsights:Ag}=Ln,ql=!!r&&Nt,Og=x.useMemo(()=>{var mt;return at((mt=e==null?void 0:e.data)==null?void 0:mt.columns)},[(zi=e==null?void 0:e.data)==null?void 0:zi.columns]),{alias:sa,trimWhitespace:Si,removeSpecial:Ei,regexCleanup:vo,normalizeCase:Ci,replaceInvalid:$a,standardizeDates:La}=na,{numericExcludedColumns:Tg}=po,{scaling:zn,outlier:vn,binning:Ut,selectedColumns:xn}=Bl;GF({previewState:Te,previewSampleRows:Rr,activeFlagSuffix:yo??"",setColumnTypeMap:It,setColumnSuggestions:Zr,hasReachableSource:Nt,requiresColumnCatalog:j,nodeColumns:Og,selectedColumns:xn,setAvailableColumns:qn,setColumnMissingMap:Qr});const xo=((Tu=k.dropMissing.threshold)==null?void 0:Tu.name)??null,{skewness:bn,imputationConfiguration:Dm,thresholdRecommendations:Pm}=IF({catalogFlags:b,skewnessData:Mg,skewnessTransformations:An,availableColumns:Tn,previewColumns:Ls,columnTypeMap:Ts,updateSkewnessTransformations:hs,imputerStrategies:Mn,columnMissingMap:rs,previewColumnStats:ta,nodeColumns:(yr=e==null?void 0:e.data)==null?void 0:yr.columns,imputerMissingFilter:Ca,suggestedThreshold:bg,thresholdParameterName:xo,configState:Pe,handleParameterChange:jt}),{imputerColumnOptions:Im,imputerMissingSliderMax:yu,imputerFilteredOptionCount:$g,imputerMissingFilterActive:Lg}=Dm,{normalizedSuggestedThreshold:bo,thresholdMatchesSuggestion:vu,canApplySuggestedThreshold:ki,handleApplySuggestedThreshold:xu}=Pm,Fm=Ot&&!!(k.dropMissing.threshold||k.dropRows.any),{columnSelectionHandlers:Vl,nodeSaveHandlers:wo,imputationStrategyHandlers:bu,aliasStrategyHandlers:Bm,dateStrategyHandlers:Kl,featureMathHandlers:Hm}=h5({catalogFlags:b,setConfigState:Wt,binningExcludedColumns:Ut.state.excludedColumns,scalingExcludedColumns:zn.state.excludedColumns,availableColumns:Tn,recommendations:Mm,nodeId:z,onUpdateConfig:n,onClose:t,sourceId:r??null,graphSnapshot:i??null,onUpdateNodeData:s,canResetNode:rn,defaultConfigTemplate:u,onResetConfig:l,imputationMethodValues:cn,imputationMethodOptions:ns,imputerStrategyCount:Mt,setCollapsedStrategies:_e,setImputerMissingFilter:Il,node:e,aliasColumnSummary:sa.columnSummary,aliasStrategyCount:sa.strategyCount,dateStrategies:La.strategies,standardizeDatesColumnSummary:La.columnSummary,standardizeDatesMode:La.mode,setCollapsedFeatureMath:yn,configState:Pe,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),{handleManualBoundChange:zg,handleClearManualBound:Rg,handleToggleColumn:ra,handleApplyAllRecommended:Um,handleSelectAllColumns:qm,handleClearColumns:aa,handleRemoveColumn:wu}=Vl,{handleSave:Mi,handleResetNode:Vm}=wo,Dg=xn.length,Ai=En&&!!r&&Nt,Km=!w&&!Rt,Ym=Km&&mn!==Fn,Wm=De.status==="loading",on=Te.status==="loading",{insightSummaries:Nu,asyncBusyLabel:Yl}=uB({recommendationsGeneratedAt:xg,scalingData:Eg,binningData:ji,binnedDistributionData:gu,outlierData:Ng,isProfileLoading:Wm,isPreviewLoading:on,isFetchingScaling:Tm,isFetchingBinning:fu,isFetchingHashEncoding:go.isFetching,isFetchingBinnedDistribution:Ta,isFetchingRecommendations:hu,catalogFlags:b}),{relativeGeneratedAt:Oi,relativeScalingGeneratedAt:Gm,relativeBinningGeneratedAt:ju,relativeBinnedGeneratedAt:Ti,relativeOutlierGeneratedAt:Wl,scalingSampleSize:No,binningSampleSize:Xm,binnedSampleSize:Pg,outlierSampleSize:Ig}=Nu,{hasActiveAsyncWork:Qm,busyLabel:Su,footerBusyLabel:Gl}=Yl,{updateImputerStrategies:Zm,handleAddImputerStrategy:Eu,handleRemoveImputerStrategy:Cu,toggleImputerStrategySection:ku,handleImputerMethodChange:Fg,handleImputerOptionNumberChange:Jm,handleImputerColumnsChange:Bg,handleImputerColumnToggle:Hg,handleImputerMissingFilterChange:Mu}=bu,{updateAliasStrategies:za,handleAddAliasStrategy:eh,handleRemoveAliasStrategy:jo,toggleAliasStrategySection:_r,handleAliasModeChange:$i,handleAliasColumnToggle:Dr,handleAliasColumnsChange:Au,handleAliasAutoDetectToggle:Ug}=Bm,{updateDateStrategies:k1,handleAddDateStrategy:Ra,handleRemoveDateStrategy:Li,toggleDateStrategySection:So,handleDateStrategyModeChange:Xl,handleDateStrategyColumnsChange:Ou,handleDateStrategyColumnToggle:Eo,handleDateStrategyAutoDetectToggle:oa}=Kl,{updateFeatureMathOperations:ln,handleAddFeatureMathOperation:nn,handleDuplicateFeatureMathOperation:ia,handleRemoveFeatureMathOperation:is,handleReorderFeatureMathOperation:bs,handleToggleFeatureMathOperation:Da,handleFeatureMathOperationChange:Co}=Hm,ws=x.useCallback(()=>{r&&Lm()},[Lm,r]),Ql=dB({catalogFlags:b,binnedDistributionData:gu}),{renderMultiSelectField:la,renderParameterField:Zt}=Y4({nodeId:z,catalogFlags:b,configState:Pe,previewState:Te,binning:Ut,scaling:zn,selectedColumns:xn,availableColumns:Tn,filteredColumnOptions:Fl,normalizedColumnSearch:Lr,columnSearch:Ys,setColumnSearch:$n,columnSuggestions:$r,columnMissingMap:rs,columnTypeMap:Ts,sourceId:r,hasReachableSource:Nt,recommendationsState:{isFetching:hu,availableFilters:xs,activeFilterId:zs,setActiveFilterId:mu,recommendations:Mm,filteredRecommendations:yg,error:Am,relativeGeneratedAt:Oi,formatSignalName:vg,refresh:wg,show:Ai},columnSelectionHandlers:{handleToggleColumn:ra,handleRemoveColumn:wu,handleApplyAllRecommended:Um,handleSelectAllColumns:qm,handleClearColumns:aa},parameterHandlers:{handleNumberChange:Bn,handleBooleanChange:Hn,handleTextChange:Sn},thresholdRecommendations:{thresholdParameterName:xo,normalizedSuggestedThreshold:bo,canApplySuggestedThreshold:ki,thresholdMatchesSuggestion:vu,handleApplySuggestedThreshold:xu},numericExcludedColumns:Tg,selectionCount:Dg});return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(lR,{title:v,isDataset:w,onClose:t,canResetNode:Jt,onResetNode:Vm}),a.jsxs("div",{className:"canvas-modal__body",children:[F&&a.jsx(vB,{connectionInfo:F,connectedInputHandles:B,connectedOutputHandles:q,connectionReady:U}),Fm&&a.jsx(Pz,{thresholdParameter:k.dropMissing.threshold??null,dropIfAnyParameter:k.dropRows.any,dropIfAnyValue:Pe==null?void 0:Pe.drop_if_any_missing,suppressWarnings:!!C,renderParameterField:Zt,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),C&&a.jsx(Dz,{thresholdParameter:k.dropMissing.threshold??null,dropColumnParameter:C,dropIfAnyValue:Pe==null?void 0:Pe.drop_if_any_missing,selectedColumns:xn,renderParameterField:Zt,renderMultiSelectField:la,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),ee&&a.jsxs(a.Fragment,{children:[a.jsx(WR,{suffix:yo,insights:Ag,formatMissingPercentage:ms}),a.jsx(GR,{columnsParameter:k.missingIndicator.columns,suffixParameter:k.missingIndicator.suffix,renderParameterField:Zt,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St})]}),wt&&a.jsx(aR,{previewState:Te,datasetSourceId:r??null,canTriggerPreview:zt,onRefresh:Oa,formatCellValue:dj,formatMetricValue:Js,formatMissingPercentage:ms,formatNumericStat:Bs,formatModeStat:qw,nodeId:e==null?void 0:e.id,onUpdateNodeData:s,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),a.jsx(iR,{isDatasetProfileNode:pt,controller:fe,formatCellValue:dj,formatNumericStat:Bs,formatMissingPercentage:ms,previewState:Te,onPendingConfigurationWarning:yt}),M&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",style:{display:"flex",alignItems:"start",gap:"0.5rem"},children:[a.jsx(P2,{size:16,style:{marginTop:"2px",flexShrink:0}}),a.jsxs("span",{children:[a.jsxs("strong",{children:[M.title,"."]})," ",M.body]})]})}),K&&a.jsx(tP,{sourceId:r,hasReachableSource:Nt,columnsParameter:k.trimWhitespace.columns,modeParameter:k.trimWhitespace.mode,renderMultiSelectField:la,renderParameterField:Zt,columnSummary:Si.columnSummary,modeDetails:Si.modeDetails,sampleMap:Si.sampleMap,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),X&&a.jsx(xP,{sourceId:r,hasReachableSource:Nt,columnsParameter:k.removeSpecial.columns,modeParameter:k.removeSpecial.mode,replacementParameter:k.removeSpecial.replacement,renderMultiSelectField:la,renderParameterField:Zt,columnSummary:Ei.columnSummary,modeDetails:Ei.modeDetails,sampleMap:Ei.sampleMap,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Q&&a.jsx(SI,{sourceId:r,hasReachableSource:Nt,columnsParameter:k.replaceInvalid.columns,modeParameter:k.replaceInvalid.mode,minValueParameter:k.replaceInvalid.minValue,maxValueParameter:k.replaceInvalid.maxValue,renderMultiSelectField:la,renderParameterField:Zt,columnSummary:$a.columnSummary,modeDetails:$a.modeDetails,sampleMap:$a.sampleMap,selectedMode:$a.mode,minValue:$a.minValue,maxValue:$a.maxValue,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),ne&&a.jsx(tI,{sourceId:r,hasReachableSource:Nt,columnsParameter:k.regexCleanup.columns,modeParameter:k.regexCleanup.mode,patternParameter:k.regexCleanup.pattern,replacementParameter:k.regexCleanup.replacement,renderMultiSelectField:la,renderParameterField:Zt,columnSummary:vo.columnSummary,modeDetails:vo.modeDetails,sampleMap:vo.sampleMap,selectedMode:vo.selectedMode,replacementValue:vo.replacementValue,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),le&&a.jsx(DP,{sourceId:r,hasReachableSource:Nt,columnsParameter:k.normalizeCase.columns,modeParameter:k.normalizeCase.mode,renderMultiSelectField:la,renderParameterField:Zt,columnSummary:Ci.columnSummary,modeDetails:Ci.modeDetails,sampleMap:Ci.sampleMap,selectedMode:Ci.selectedMode,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Qe&&a.jsx(qI,{operations:lr,summaries:Kn,collapsed:$s,onToggleCollapsed:Da,onAddOperation:nn,onDuplicateOperation:ia,onRemoveOperation:is,onReorderOperation:bs,onOperationChange:Co,availableColumns:Tn,signals:Vn,previewStatus:Te.status,errorHandlingParameter:k.featureMath.errorHandling,allowOverwriteParameter:k.featureMath.allowOverwrite,defaultTimezoneParameter:k.featureMath.defaultTimezone,epsilonParameter:k.featureMath.epsilon,renderParameterField:Zt,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),ht&&a.jsx(a3,{sourceId:r,hasReachableSource:Nt,isFetching:wi.isFetching,error:wi.error,suggestions:wi.suggestions,metadata:wi.metadata,columnsParameter:k.ordinalEncoding.columns,autoDetectParameter:k.ordinalEncoding.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,maxCategoriesParameter:k.ordinalEncoding.maxCategories,outputSuffixParameter:k.ordinalEncoding.outputSuffix,dropOriginalParameter:k.ordinalEncoding.dropOriginal,encodeMissingParameter:k.ordinalEncoding.encodeMissing,handleUnknownParameter:k.ordinalEncoding.handleUnknown,unknownValueParameter:k.ordinalEncoding.unknownValue,selectedColumns:xn,renderParameterField:Zt,onToggleColumn:ra,onApplyRecommended:wi.handleApplyRecommended,formatMissingPercentage:ms,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),ge&&a.jsx(XI,{sourceId:r,hasReachableSource:Nt,isFetching:Aa.isFetching,error:Aa.error,suggestions:Aa.suggestions,metadata:Aa.metadata,columnsParameter:k.targetEncoding.columns,targetColumnParameter:k.targetEncoding.targetColumn,autoDetectParameter:k.targetEncoding.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,maxCategoriesParameter:k.targetEncoding.maxCategories,outputSuffixParameter:k.targetEncoding.outputSuffix,dropOriginalParameter:k.targetEncoding.dropOriginal,smoothingParameter:k.targetEncoding.smoothing,encodeMissingParameter:k.targetEncoding.encodeMissing,handleUnknownParameter:k.targetEncoding.handleUnknown,selectedColumns:xn,renderParameterField:Zt,onToggleColumn:ra,onApplyRecommended:Aa.handleApplyRecommended,formatMissingPercentage:ms,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),ye&&a.jsx(l3,{sourceId:r,hasReachableSource:Nt,isFetching:Ni.isFetching,error:Ni.error,suggestions:Ni.suggestions,metadata:Ni.metadata,columnsParameter:k.dummyEncoding.columns,autoDetectParameter:k.dummyEncoding.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,maxCategoriesParameter:k.dummyEncoding.maxCategories,dropFirstParameter:k.dummyEncoding.dropFirst,includeMissingParameter:k.dummyEncoding.includeMissing,dropOriginalParameter:k.dummyEncoding.dropOriginal,prefixSeparatorParameter:k.dummyEncoding.prefixSeparator,selectedColumns:xn,renderParameterField:Zt,onToggleColumn:ra,onApplyRecommended:Ni.handleApplyRecommended,formatMissingPercentage:ms,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Fe&&a.jsx(d3,{sourceId:r,hasReachableSource:Nt,isFetching:_o.isFetching,error:_o.error,suggestions:_o.suggestions,metadata:_o.metadata,columnsParameter:k.oneHotEncoding.columns,autoDetectParameter:k.oneHotEncoding.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,maxCategoriesParameter:k.oneHotEncoding.maxCategories,dropFirstParameter:k.oneHotEncoding.dropFirst,includeMissingParameter:k.oneHotEncoding.includeMissing,dropOriginalParameter:k.oneHotEncoding.dropOriginal,prefixSeparatorParameter:k.oneHotEncoding.prefixSeparator,selectedColumns:xn,renderParameterField:Zt,onToggleColumn:ra,onApplyRecommended:_o.handleApplyRecommended,formatMissingPercentage:ms,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),ze&&a.jsx(x3,{nodeId:z,sourceId:r,hasReachableSource:Nt,previewState:Te,onRefreshPreview:Oa,config:vs,targetColumnParameter:k.featureTargetSplit.targetColumn,renderParameterField:Zt,formatMetricValue:Js,formatMissingPercentage:ms,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),me&&a.jsx(w3,{nodeId:z,sourceId:r,hasReachableSource:Nt,previewState:Te,onRefreshPreview:Oa,config:de,parameters:N,renderParameterField:Zt,formatMetricValue:Js,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),E&&a.jsx(LF,{mode:We?"oversampling":"undersampling",sourceId:r,hasReachableSource:Nt,previewState:Te,onRefreshPreview:Oa,config:be,methodParameter:k.resampling.method,targetColumnParameter:k.resampling.targetColumn,samplingStrategyParameter:k.resampling.samplingStrategy,randomStateParameter:k.resampling.randomState,kNeighborsParameter:We?k.resampling.kNeighbors:null,replacementParameter:Se?k.resampling.replacement:null,renderParameterField:Zt,formatMetricValue:Js,formatMissingPercentage:ms,schemaGuard:Ct,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),(xe||Ve)&&a.jsx(C3,{sourceId:r,hasReachableSource:Nt,previewState:Te,onRefreshPreview:Oa,config:qe,targetColumnParameter:k.trainModel.targetColumn,problemTypeParameter:k.trainModel.problemType,renderParameterField:Zt,formatMetricValue:Js,formatMissingPercentage:ms,schemaColumns:hn}),xe&&a.jsx("div",{style:V,"aria-disabled":H,children:a.jsx(Y3,{nodeId:z,sourceId:r,graph:ss,config:qe,runtimeConfig:gt,cvConfig:Le,draftConfigState:Pe,renderParameterField:Zt,modelTypeParameter:k.trainModel.modelType,modelTypeOptions:Lt,hyperparametersParameter:k.trainModel.hyperparameters,cvEnabledParameter:k.trainModel.cvEnabled,cvStrategyParameter:k.trainModel.cvStrategy,cvFoldsParameter:k.trainModel.cvFolds,cvShuffleParameter:k.trainModel.cvShuffle,cvRandomStateParameter:k.trainModel.cvRandomState,cvRefitStrategyParameter:k.trainModel.cvRefitStrategy,onSaveDraftConfig:Mi,onUpdateNodeData:s,currentStatus:(Ri=e==null?void 0:e.data)==null?void 0:Ri.backgroundExecutionStatus,currentProgress:(Zl=e==null?void 0:e.data)==null?void 0:Zl.progress})}),Ce&&a.jsx("div",{style:V,"aria-disabled":H,children:a.jsx(nF,{nodeId:z,sourceId:r,graph:ss,config:Pe,setConfigState:Wt,renderParameterField:Zt,formatMetricValue:Js,connectedSplitHandles:I})}),Ae&&a.jsx("div",{style:V,"aria-disabled":H,children:a.jsx(vF,{nodeId:z,sourceId:r,graph:ss,parameters:N,config:Un,renderParameterField:Zt})}),Ve&&a.jsx("div",{style:V,"aria-disabled":H,children:a.jsx(AF,{nodeId:z,sourceId:r,graph:ss,config:qe,runtimeConfig:gt,cvConfig:Le,draftConfigState:Pe,renderParameterField:Zt,modelTypeParameter:k.trainModel.modelType,modelTypeOptions:Lt,searchStrategyParameter:k.hyperparameterTuning.searchStrategy,searchIterationsParameter:k.hyperparameterTuning.searchIterations,searchRandomStateParameter:k.hyperparameterTuning.searchRandomState,scoringMetricParameter:k.hyperparameterTuning.scoringMetric,setDraftConfigState:Wt,onSaveDraftConfig:Mi,onUpdateNodeData:s,currentStatus:($u=e==null?void 0:e.data)==null?void 0:$u.backgroundExecutionStatus,currentProgress:(th=e==null?void 0:e.data)==null?void 0:th.progress})}),ie&&a.jsx(YI,{sourceId:r,hasReachableSource:Nt,isFetching:bi.isFetching,error:bi.error,suggestions:bi.suggestions,metadata:bi.metadata,columnsParameter:k.labelEncoding.columns,autoDetectParameter:k.labelEncoding.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,maxUniqueParameter:k.labelEncoding.maxUnique,outputSuffixParameter:k.labelEncoding.outputSuffix,dropOriginalParameter:k.labelEncoding.dropOriginal,missingStrategyParameter:k.labelEncoding.missingStrategy,missingCodeParameter:k.labelEncoding.missingCode,selectedColumns:xn,renderParameterField:Zt,onToggleColumn:ra,onApplyRecommended:bi.handleApplyRecommended,formatMissingPercentage:ms,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Re&&a.jsx(JI,{sourceId:r,hasReachableSource:Nt,isFetching:go.isFetching,error:go.error,suggestions:go.suggestions,metadata:go.metadata,columnsParameter:k.hashEncoding.columns,autoDetectParameter:k.hashEncoding.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,maxCategoriesParameter:k.hashEncoding.maxCategories,bucketsParameter:k.hashEncoding.buckets,outputSuffixParameter:k.hashEncoding.outputSuffix,dropOriginalParameter:k.hashEncoding.dropOriginal,encodeMissingParameter:k.hashEncoding.encodeMissing,selectedColumns:xn,renderParameterField:Zt,onToggleColumn:ra,onApplyRecommended:go.handleApplyRecommended,formatMissingPercentage:ms,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Bt&&a.jsx(e3,{columnsParameter:k.polynomial.columns,autoDetectParameter:k.polynomial.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,degreeParameter:k.polynomial.degree,includeBiasParameter:k.polynomial.includeBias,interactionOnlyParameter:k.polynomial.interactionOnly,includeInputFeaturesParameter:k.polynomial.includeInputFeatures,outputPrefixParameter:k.polynomial.outputPrefix,renderParameterField:Zt,signal:fn,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),$e&&a.jsx(n3,{columnsParameter:k.featureSelection.columns,autoDetectParameter:k.featureSelection.autoDetect,autoDetectValue:Pe==null?void 0:Pe.auto_detect,targetColumnParameter:k.featureSelection.targetColumn,methodParameter:k.featureSelection.method,scoreFuncParameter:k.featureSelection.scoreFunc,problemTypeParameter:k.featureSelection.problemType,kParameter:k.featureSelection.k,percentileParameter:k.featureSelection.percentile,alphaParameter:k.featureSelection.alpha,thresholdParameter:k.featureSelection.threshold,modeParameter:k.featureSelection.mode,estimatorParameter:k.featureSelection.estimator,stepParameter:k.featureSelection.step,minFeaturesParameter:k.featureSelection.minFeatures,maxFeaturesParameter:k.featureSelection.maxFeatures,dropUnselectedParameter:k.featureSelection.dropUnselected,renderParameterField:Zt,signal:as,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),ce&&a.jsx(DD,{hasSource:!!r,hasReachableSource:Nt,strategies:La.strategies,columnSummary:La.columnSummary,columnOptions:La.columnOptions,sampleMap:La.sampleMap,collapsedStrategies:te,onToggleStrategy:So,onRemoveStrategy:Li,onAddStrategy:Ra,onModeChange:Xl,onColumnToggle:Eo,onColumnsChange:Ou,onAutoDetectToggle:oa,modeOptions:Rp,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Z&&a.jsx(wD,{hasSource:!!r,hasReachableSource:Nt,strategies:sa.strategies,columnSummary:sa.columnSummary,columnOptions:sa.columnOptions,sampleMap:sa.sampleMap,customPairSummary:sa.customPairSummary,customPairsParameter:k.replaceAliases.customPairs,collapsedStrategies:te,onToggleStrategy:_r,onRemoveStrategy:jo,onAddStrategy:eh,onModeChange:$i,onAutoDetectToggle:Ug,onColumnToggle:Dr,onColumnsChange:Au,renderParameterField:Zt,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),J&&a.jsx(PR,{hasSource:!!r,hasReachableSource:Nt,strategies:Mn,columnOptions:Im,methodOptions:ns,missingFilter:Ca,missingFilterMax:yu,missingFilterActive:Lg,filteredOptionCount:$g,collapsedStrategies:te,onToggleStrategy:ku,onRemoveStrategy:Cu,onAddStrategy:Eu,onMethodChange:Fg,onOptionNumberChange:Jm,onColumnsChange:Bg,onColumnToggle:Hg,onMissingFilterChange:Mu,formatMissingPercentage:ms,formatNumericStat:Bs,formatModeStat:qw,schemaDiagnostics:On,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),tt&&a.jsx(Hz,{configState:Pe,setConfigState:Wt,availableColumns:Tn,columnTypeMap:Ts,columnSuggestions:$r,selectedColumns:xn,previewColumns:Ls,previewStatus:Te.status,previewState:Te,sourceId:r,hasReachableSource:Nt,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Be&&a.jsx(yB,{sourceId:r,hasReachableSource:Nt,isFetchingOutliers:Sg,outlierConfig:vn.config,outlierMethodOptions:vn.state.methodOptions,outlierMethodDetailMap:vn.state.methodDetailMap,outlierDefaultDetail:vn.state.defaultDetail,outlierAutoDetectEnabled:vn.state.autoDetectEnabled,outlierSelectedCount:vn.state.selectedCount,outlierDefaultLabel:vn.state.defaultLabel,outlierOverrideCount:vn.state.overrideCount,outlierParameterOverrideCount:vn.state.parameterOverrideCount,outlierOverrideExampleSummary:vn.state.overrideExampleSummary,outlierHasOverrides:vn.state.hasOverrides,outlierRecommendationRows:vn.state.recommendationRows,outlierHasRecommendations:vn.state.hasRecommendations,outlierStatusMessage:vn.state.statusMessage,outlierError:jg,outlierSampleSize:Ig,relativeOutlierGeneratedAt:Wl,outlierPreviewSignal:pr,formatMetricValue:Js,formatNumericStat:Bs,onApplyAllRecommendations:vn.handlers.handleApplyAllRecommendations,onClearOverrides:vn.handlers.handleClearOverrides,onDefaultMethodChange:vn.handlers.handleDefaultMethodChange,onAutoDetectToggle:vn.handlers.handleAutoDetectToggle,onOverrideSelect:vn.handlers.handleOverrideSelect,onMethodParameterChange:vn.handlers.handleMethodParameterChange,onColumnParameterChange:vn.handlers.handleColumnParameterChange,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),_t&&a.jsx(IR,{sourceId:r,hasReachableSource:Nt,isFetchingScaling:Tm,scalingConfig:zn.config,scalingMethodOptions:zn.state.methodOptions,scalingMethodDetailMap:zn.state.methodDetailMap,scalingDefaultDetail:zn.state.defaultDetail,scalingAutoDetectEnabled:zn.state.autoDetectEnabled,scalingSelectedCount:zn.state.selectedCount,scalingDefaultLabel:zn.state.defaultLabel,scalingOverrideCount:zn.state.overrideCount,scalingOverrideExampleSummary:zn.state.overrideExampleSummary,scalingRecommendationRows:zn.state.recommendationRows,scalingHasRecommendations:zn.state.hasRecommendations,scalingStatusMessage:zn.state.statusMessage,scalingError:Cg,scalingSampleSize:No,relativeScalingGeneratedAt:Gm,formatMetricValue:Js,formatNumericStat:Bs,formatMissingPercentage:ms,onApplyAllRecommendations:zn.handlers.handleApplyAllRecommendations,onClearOverrides:zn.handlers.handleClearOverrides,onDefaultMethodChange:zn.handlers.handleDefaultMethodChange,onAutoDetectToggle:zn.handlers.handleAutoDetectToggle,onOverrideSelect:zn.handlers.handleOverrideSelect,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),xt&&a.jsxs(a.Fragment,{children:[a.jsx(CR,{hasSource:!!r,hasReachableSource:Nt,isFetching:fu,error:kg,relativeGeneratedAt:ju,sampleSize:Xm,binningConfig:Ut.config,binningDefaultLabel:Ut.state.defaultLabel,binningOverrideCount:Ut.state.overrideCount,binningOverrideSummary:Ut.state.overrideSummary,recommendations:Ut.state.insightsRecommendations,excludedColumns:Ut.state.insightsExcludedColumns,numericColumnCount:Ut.state.allNumericColumns.length,canApplyAllNumeric:Ut.state.canApplyAllNumeric,onApplyAllNumeric:Ut.handlers.handleApplyAllNumeric,onApplyStrategies:Ut.handlers.handleApplyStrategies,onClearOverrides:Ut.handlers.handleClearOverrides,customEdgeDrafts:Ut.state.customEdgeDrafts,customLabelDrafts:Ut.state.customLabelDrafts,onOverrideStrategyChange:Ut.handlers.handleOverrideStrategyChange,onOverrideNumberChange:Ut.handlers.handleOverrideNumberChange,onOverrideKbinsEncodeChange:Ut.handlers.handleOverrideKbinsEncodeChange,onOverrideKbinsStrategyChange:Ut.handlers.handleOverrideKbinsStrategyChange,onOverrideClear:Ut.handlers.handleClearOverride,onCustomBinsChange:Ut.handlers.handleCustomBinsChange,onCustomLabelsChange:Ut.handlers.handleCustomLabelsChange,onClearCustomColumn:Ut.handlers.handleClearCustomColumn,formatMetricValue:Js,formatNumericStat:Bs,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),a.jsx(jR,{config:Ut.config,fieldIds:Ut.state.fieldIds,onIntegerChange:Ut.handlers.handleIntegerChange,onBooleanToggle:Ut.handlers.handleBooleanToggle,onSuffixChange:Ut.handlers.handleSuffixChange,onLabelFormatChange:Ut.handlers.handleLabelFormatChange,onMissingStrategyChange:Ut.handlers.handleMissingStrategyChange,onMissingLabelChange:Ut.handlers.handleMissingLabelChange,previewState:Te,onPendingConfigurationWarning:yt})]}),Ee&&a.jsx(VR,{sourceId:r,hasReachableSource:Nt,isFetchingSkewness:_u,skewnessThreshold:bn.state.threshold,skewnessError:zm,skewnessViewMode:bn.state.viewMode,skewnessRecommendedCount:bn.state.recommendedCount,skewnessNumericCount:bn.state.numericCount,skewnessGroupByMethod:bn.state.groupByMethod,skewnessRows:bn.state.rows,skewnessTableGroups:bn.state.tableGroups,hasSkewnessAutoRecommendations:bn.state.hasAutoRecommendations,skewnessTransformationsCount:bn.state.transformationsCount,isFetchingRecommendations:hu,getSkewnessMethodLabel:bn.handlers.getMethodLabel,getSkewnessMethodStatus:bn.handlers.getMethodStatus,onApplyRecommendations:bn.handlers.applyRecommendations,onViewModeChange:bn.handlers.setViewMode,onGroupByToggle:bn.handlers.setGroupByMethod,onOverrideChange:bn.handlers.handleOverrideChange,onClearSelections:bn.handlers.clearTransformations,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),lt&&a.jsx(YR,{skewnessThreshold:bn.state.threshold,isFetchingSkewness:_u,skewnessError:zm,skewnessDistributionCards:bn.state.distributionCards,skewnessDistributionView:bn.state.distributionView,setSkewnessDistributionView:bn.handlers.setDistributionView,onRefresh:Rm,canRefresh:ql}),Je&&a.jsx(kR,{cards:Ql,selectedPreset:zr,onSelectPreset:mt=>or(mt),isFetching:Ta,sampleSize:Pg,relativeGeneratedAt:Ti,error:$m,onRefresh:ws,canRefresh:!!r,previewState:Te,onPendingConfigurationWarning:yt}),Yt&&a.jsx(Fz,{sourceId:r,hasReachableSource:Nt,removeDuplicatesColumnsParameter:k.removeDuplicates.columns,removeDuplicatesKeepParameter:k.removeDuplicates.keep,renderMultiSelectField:la,removeDuplicatesKeepSelectId:xi.removeDuplicatesKeepSelectId,removeDuplicatesKeep:xi.removeDuplicatesKeep,onKeepChange:xi.handleRemoveDuplicatesKeepChange,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Ue&&a.jsx(_3,{parameters:T,renderParameterField:Zt,previewState:Te,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St}),Ie&&a.jsx(g3,{signal:ir,previewStatus:Te.status,previewState:Te,hasSource:!!r,hasReachableSource:Nt,onRefreshPreview:Oa,onPendingConfigurationWarning:yt,onPendingConfigurationCleared:St})]}),a.jsx(cR,{onClose:t,canResetNode:tn,onResetNode:Vm,showSaveButton:Km,canSave:Ym,onSave:Mi,isBusy:Qm,busyLabel:Gl,statusMessage:ar?a.jsxs("span",{className:"canvas-modal__footer-hint",children:[a.jsx("strong",{children:"Pending:"})," ",ar]}):null})]})]})},a1=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],xa=a1.map(e=>e.key),bB=a1.reduce((e,t)=>({...e,[t.key]:t.label}),{}),wB=e=>typeof e=="string"&&xa.includes(e),ba=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{wB(n)&&t.add(n)}),xa.filter(n=>t.has(n))},o1=(e,t)=>{const n=ba(e),s=ba(t);return n.length!==s.length?!1:n.every((r,i)=>r===s[i])},i1=e=>!e||typeof e!="string"?null:xa.find(t=>e.endsWith(`-${t}`))??null,l1=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},NB={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},au={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"train-in",label:"Train Split",position:20,required:!1,accepts:["train"]},{key:"test-in",label:"Test Split",position:40,required:!1,accepts:["test"]},{key:"validation-in",label:"Validation Split",position:60,required:!1,accepts:["validation"]},{key:"models-in",label:"Model",position:80,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},c1=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:l1(t,n),jB=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,SB=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,u1=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},EB=e=>({width:`${Hj}px`,height:`${Hj}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),CB=({id:e,data:t,selected:n})=>{var T;const s=(t==null?void 0:t.label)??e,r=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),i=(t==null?void 0:t.isRemovable)??!r,l=(t==null?void 0:t.catalogType)==="train_test_split",u=r?"Primary dataset input":void 0,d=(t==null?void 0:t.description)??u,p=(t==null?void 0:t.catalogType)==="drop_missing_columns"||d===qj?Vj:d,h=(t==null?void 0:t.backgroundExecutionStatus)??"idle",_=!((t==null?void 0:t.hasRequiredConnections)??!0),v=(t==null?void 0:t.catalogType)??"",y=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(v),b=["hyperparameter_tuning","train_model_draft"].includes(v),w=(t==null?void 0:t.pendingWarningReason)??null,E=!!(t!=null&&t.pendingWarningActive),N=!!(t!=null&&t.pendingHighlight),j=w??"This node still needs configuration.",C=["feature-node",n?"feature-node--selected":"",r?"feature-node--dataset":"",E?"feature-node--pending-warning":"",N?"feature-node--pending-highlight":""].filter(Boolean).join(" "),M=x.useCallback(A=>{var O;A.stopPropagation(),(O=t==null?void 0:t.onRemoveNode)==null||O.call(t,e)},[t,e]),z=x.useMemo(()=>{if(r)return[];const A=(t==null?void 0:t.catalogType)??"",O=A?au[A]:void 0;if(O!=null&&O.inputs&&O.inputs.length){const R=O.inputs.length;return O.inputs.map((L,F)=>({position:He.Left,id:`${e}-${L.key}`,label:jB(L),style:{top:c1(L,F,R)}}))}return[{position:He.Left,id:`${e}-target`},{position:He.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,r]),D=x.useMemo(()=>{if(r)return[{position:He.Left,id:`${e}-source-left`},{position:He.Right,id:`${e}-source`},{position:He.Top,id:`${e}-source-top`},{position:He.Bottom,id:`${e}-source-bottom`}];const A=(t==null?void 0:t.catalogType)??"",O=A?au[A]:void 0;if(O!=null&&O.outputs&&O.outputs.length){const F=O.outputs.length;return O.outputs.map((B,q)=>({position:He.Right,id:`${e}-${B.key}`,label:B.label,style:{top:c1(B,q,F)}}))}const R=l?xa:ba((t==null?void 0:t.activeSplits)??[]),L=ba((t==null?void 0:t.connectedSplits)??[]);if(R.length){const F=R.length;return R.map((B,q)=>({position:He.Right,id:`${e}-${B}`,style:{top:l1(q,F)},label:(()=>{var U;const I=bB[B];if(l){if(B==="validation"&&!(Number(((U=t==null?void 0:t.config)==null?void 0:U.validation_size)??0)>0))return`${I} (disabled)`;if(!L.includes(B))return`${I} (not set)`}return I})()}))}return[{position:He.Right,id:`${e}-source`},{position:He.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(T=t==null?void 0:t.config)==null?void 0:T.validation_size,e,r,l]),k=x.useCallback((A,O)=>{const{position:R,id:L,style:F,label:B}=A,q=L.includes("-train")||L.includes("-test")||L.includes("-validation");return a.jsxs(ve.Fragment,{children:[a.jsx(Sc,{type:O,position:R,id:L,className:`feature-node__handle feature-node__handle--${O}`,style:{...EB(O),...F??{},...q?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),B&&O==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(F==null?void 0:F.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:B}),B&&O==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(F==null?void 0:F.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:B})]},L)},[]);return a.jsxs("div",{className:C,children:[z.map(A=>k(A,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:s})]}),a.jsxs("div",{className:"feature-node__controls",children:[E&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--pending",title:j,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:"!"}),_&&y&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)",display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(ga,{size:12})}),h==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:b?"Training in progress...":"Loading full dataset in background...",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:b?typeof(t==null?void 0:t.progress)=="number"?a.jsxs("span",{style:{fontSize:"0.6rem",fontWeight:"bold",color:"#3b82f6"},children:[Math.round(t.progress),"%"]}):a.jsx(R2,{size:12}):a.jsx(Gf,{size:12,className:"feature-node__spinner"})}),h==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(Kf,{size:12})}),h==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(L2,{size:12})}),i&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:M,title:"Remove node",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(il,{size:12})})]})]}),p&&a.jsx("p",{className:"feature-node__description",children:p}),b&&h==="loading"&&a.jsxs("p",{className:"feature-node__description",style:{color:"#3b82f6",fontWeight:500,marginTop:"4px",display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx(Gf,{size:10,className:"feature-node__spinner"}),"Training..."]}),E&&a.jsx("p",{className:"feature-node__pending-hint",children:j}),D.map(A=>k(A,"source"))]})},kB=({details:e,onDismiss:t,onHighlight:n})=>{var p;if(!e.length)return null;const s=e.map(h=>h.label),r=s[0],i=s[1],l=s.length-2;let u="";s.length===1?u=r:s.length===2?u=`${r} and ${i}`:l>0&&(u=`${r}, ${i} and ${l} other ${l===1?"node":"nodes"}`);const d=((p=e.find(h=>h.reason))==null?void 0:p.reason)??null,f=d?`${d}${e.length>1?"":""}`:"Review highlighted nodes and save their settings.";return a.jsxs("div",{className:"pending-toast",role:"status","aria-live":"polite",children:[a.jsx("div",{className:"pending-toast__icon","aria-hidden":"true",children:"!"}),a.jsxs("div",{className:"pending-toast__body",children:[a.jsx("div",{className:"pending-toast__title",children:"Finish node configuration"}),a.jsx("div",{className:"pending-toast__subtitle",children:u||"At least one node still needs configuration."}),f&&a.jsx("div",{className:"pending-toast__hint",children:f}),a.jsxs("div",{className:"pending-toast__actions",children:[n&&a.jsx("button",{type:"button",className:"pending-toast__button",onClick:()=>n(s),children:"Highlight nodes"}),a.jsx("button",{type:"button",className:"pending-toast__button pending-toast__button--ghost",onClick:t,children:"Dismiss"})]})]})]})},MB=({details:e,onDismiss:t,onHighlight:n})=>{const[s,r]=x.useState(!0),i=x.useMemo(()=>(e.length<=1,"Issue in Node"),[e.length]);return e.length?a.jsx("div",{className:"pending-dock","data-collapsed":s?"true":"false",children:s?a.jsxs("button",{type:"button",className:"pending-dock__toggle",onClick:()=>r(!1),"aria-label":"Expand pending configuration reminder",children:[a.jsx(ga,{size:16,"aria-hidden":"true"}),a.jsx("span",{children:i})]}):a.jsxs("div",{className:"pending-dock__panel",children:[a.jsxs("div",{className:"pending-dock__panel-header",children:[a.jsx("span",{className:"pending-dock__panel-label",children:"Pending configuration"}),a.jsx("button",{type:"button",className:"pending-dock__collapse",onClick:()=>r(!0),"aria-label":"Minimize reminder",children:a.jsx(F2,{size:16,"aria-hidden":"true"})})]}),a.jsx(kB,{details:e,onDismiss:t,onHighlight:l=>{r(!0),n==null||n(l)}})]})}):null},AB=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],OB=[],TB=e=>({...e,data:{...e.data??{}}}),Cm=()=>AB.map(e=>TB(e)),$B=()=>OB.map(e=>({...e})),LB=12,zB=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},RB=(e,t,n)=>{if(!t||typeof t.project!="function"||!n)return;const s=n.getBoundingClientRect(),r=t.project({x:s.width/2,y:s.height/2});if(!r)return;const i=e.filter(h=>h.id!=="dataset-source").length,l=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],u=i%l.length,d=Math.floor(i/l.length),f=l[u],p=d+1;return{x:r.x+f.x*p,y:r.y+f.y*p}},DB=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),d1=(e,t)=>{if(!e)return!1;if(DB.has(e))return!0;const n=t==null?void 0:t.get(e);return n?(typeof n.category=="string"?n.category.toLowerCase():"").includes("preprocess"):!1},m1=(e,t)=>{var j,C,M,z,D,k;const{handleOpenSettings:n,handleRemoveNode:s,catalogEntryMap:r}=t,i=e.data??{},l=i.isDataset??e.id==="dataset-source",u={...e.style??{}},d=i.catalogType??i.type??e.id;let p=Array.isArray(i.parameters)?i.parameters:null;if((!p||p.length===0)&&typeof d=="string"){const T=r.get(d)??null;(j=T==null?void 0:T.parameters)!=null&&j.length&&(p=T.parameters)}const h=o5(p);let m;if(h.length||i.config&&typeof i.config=="object"){const T=tu(i.config);h.forEach(A=>{A!=null&&A.name&&T[A.name]===void 0&&A.default!==void 0&&(Array.isArray(A.default)?T[A.name]=[...A.default]:A.type==="boolean"?T[A.name]=!!A.default:T[A.name]=A.default)}),m=T}u.width||(u.width=l?Uj+20:Uj),u.minHeight||(u.minHeight=n5),u.padding||(u.padding=12),u.borderRadius||(u.borderRadius=16),u.boxSizing=u.boxSizing??"border-box",u.whiteSpace=u.whiteSpace??"pre-line",u.background||(u.background=l?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),u.border||(u.border=l?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),u.boxShadow||(u.boxShadow=l?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),u.color||(u.color=l?"#e0f2fe":"#e2e8f0"),u.fontWeight||(u.fontWeight=l?600:500);const _=a5(i.description,d),v=bm(d),y=m??(i.config&&typeof i.config=="object"?tu(i.config):void 0);y&&typeof y=="object"&&v&&delete y[so];const b={...i,label:i.label??e.id,description:_,isDataset:l,isRemovable:i.isRemovable??!l,isConfigured:l||i.isConfigured===!0?!0:i.config&&typeof i.config=="object"?v?!0:!i.config[so]:!1,inputs:Array.isArray(i.inputs)?[...i.inputs]:i.inputs,outputs:Array.isArray(i.outputs)?[...i.outputs]:i.outputs,category:i.category,parameters:h,config:y,catalogType:d,onRemoveNode:s,onOpenSettings:n},w=typeof d=="string"?au[d]:void 0;if(w){const T=((C=w.inputs)==null?void 0:C.map(O=>SB(O)))??[],A=((M=w.outputs)==null?void 0:M.map(O=>O.label))??[];T.length?b.inputs=T:delete b.inputs,A.length?b.outputs=A:delete b.outputs,b.connectionInfo={inputs:((z=w.inputs)==null?void 0:z.map(O=>({...O})))??[],outputs:((D=w.outputs)==null?void 0:D.map(O=>({...O})))??[]}}else(!b.inputs||b.inputs.length===0)&&delete b.inputs,(!b.outputs||b.outputs.length===0)&&delete b.outputs,delete b.connectionInfo;const E=ba(b.activeSplits);E.length?b.activeSplits=E:delete b.activeSplits;const N=ba(b.connectedSplits);return N.length?b.connectedSplits=N:delete b.connectedSplits,d==="train_test_split"&&(b.activeSplits=[...xa],N.length||delete b.connectedSplits),(k=b.parameters)!=null&&k.length||delete b.parameters,b.config===void 0&&delete b.config,{...e,type:"featureNode",position:e.position??{x:0,y:0},data:b,style:u}},PB=(e,t,n,s,r)=>{const i=(e==null?void 0:e.label)??(e==null?void 0:e.type)??s,l=typeof i=="string"&&i.trim()?i:s,u=wm(e),d=bm((e==null?void 0:e.type)??null);return m1({id:t,type:"featureNode",position:n,data:{label:l,description:e==null?void 0:e.description,inputs:e==null?void 0:e.inputs,outputs:e==null?void 0:e.outputs,category:e==null?void 0:e.category,parameters:e==null?void 0:e.parameters,config:u,catalogType:e==null?void 0:e.type,isConfigured:!!d}},r)},IB=(e,t)=>{const n=e.map(r=>{const{data:i,...l}=r,u=i?{...i}:void 0;return u&&(delete u.onRemoveNode,delete u.onOpenSettings),JSON.parse(JSON.stringify({...l,data:u}))}),s=t.map(r=>JSON.parse(JSON.stringify(r)));return{nodes:n,edges:s}},FB=e=>{const[t,n]=x.useState(e??null),[s,r]=x.useState(null),i=Is({queryKey:["feature-canvas","datasets"],queryFn:()=>mw(12),staleTime:5*60*1e3}),l=i.data??[],u=x.useMemo(()=>l.filter(_=>_.is_owned),[l]),d=x.useMemo(()=>l.map(_=>({value:_.source_id,label:_.name,isOwned:_.is_owned})),[l]),f=u.length,p=l.length>0,h=p;x.useEffect(()=>{if(t&&l.length>0){const _=l.find(v=>v.source_id===t);_&&r(_)}},[t,l]);const m=i.isError?"Unable to load datasets":null;return{datasets:l,ownedDatasets:u,selectedDataset:s,setSelectedDataset:r,activeSourceId:t,setActiveSourceId:n,datasetOptions:d,canSelectDatasets:h,hasDatasets:p,ownedDatasetsCount:f,isDatasetLoading:i.isLoading,datasetErrorMessage:m}},BB=({sourceId:e,setIsDirty:t,setSaveFeedback:n,isHydratingRef:s})=>{const r=FB(e),{datasets:i,setActiveSourceId:l,setSelectedDataset:u}=r,d=x.useCallback(f=>{const p=i.find(h=>h.source_id===f)??null;if(!p){n({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(p.is_owned===!1){n({message:"Only owned datasets can be selected.",tone:"error"});return}s.current?(l(f),u(p)):(l(f),u(p),t(!0))},[i,l,u,t,n,s]);return{...r,handleDatasetSelection:d}},HB=({nodes:e,setEdges:t,scheduleNodeInternalsUpdate:n})=>{const s=x.useCallback(i=>{var _,v;const{source:l,target:u,sourceHandle:d,targetHandle:f}=i;if(!l||!u||!f||l===u)return!1;const p=e.find(y=>y.id===u);if(!p)return!1;const h=((_=p==null?void 0:p.data)==null?void 0:_.catalogType)??"",m=h?au[h]:void 0;if((v=m==null?void 0:m.inputs)!=null&&v.length){const y=u1(u,f);if(!y)return!1;const b=m.inputs.find(w=>w.key===y);return!b||!d?!1:b.accepts&&b.accepts.length>0?b.accepts.some(w=>{const E=NB[w];return E?E(d):!1}):!0}return!0},[e]),r=x.useCallback(i=>{t(u=>zv({...i,type:"animatedEdge",animated:!0},u));const l=[i.source,i.target].filter(u=>!!u);l.length&&n(l)},[n,t]);return{isValidConnection:s,onConnect:r}},UB=({setNodes:e,setEdges:t,setSelectedNodeId:n,setIsSettingsModalOpen:s,catalogEntryMapRef:r,handleOpenSettings:i,reactFlowInstanceRef:l,canvasViewportRef:u,scheduleFitView:d})=>{const f=x.useRef(0),p=x.useCallback(N=>{N!=="dataset-source"&&(e(j=>j.filter(C=>C.id!==N)),t(j=>j.filter(C=>C.source!==N&&C.target!==N)),n(j=>j===N?(s(!1),null):j))},[t,s,e,n]),h=x.useCallback(N=>m1(N,{handleOpenSettings:i,handleRemoveNode:p,catalogEntryMap:r.current}),[r,i,p]),m=x.useCallback(N=>{const j=N.reduce((C,M)=>{if(typeof M.id=="string"&&M.id.startsWith("node-")){const z=Number(M.id.replace("node-",""));if(!Number.isNaN(z))return Math.max(C,z)}return C},0);j>f.current&&(f.current=j)},[]),_=x.useCallback((N,j)=>{const C=f.current+1,M=`node-${C}`;f.current=C;const z=j??{x:160+(C-1)%4*220,y:40+Math.floor((C-1)/4)*160};return h(PB(N??null,M,z,`Step ${C}`,{handleOpenSettings:i,handleRemoveNode:p,catalogEntryMap:r.current}))},[r,i,p,h]),v=x.useCallback(N=>{e(j=>{const C=RB(j,l.current,u.current),M=_(N,C);return[...j,M]}),d()},[u,_,l,d,e]),y=x.useCallback((N,j)=>{e(C=>C.map(M=>{if(M.id!==N)return M;const z=tu(j);z&&typeof z=="object"&&delete z[so];const D={...M.data??{},config:z,isConfigured:!0};return h({...M,data:D})}))},[h,e]),b=x.useCallback((N,j)=>{e(C=>C.map(M=>{if(M.id!==N)return M;const z={...M.data??{},...j};return h({...M,data:z})}))},[h,e]),w=x.useCallback((N,j)=>{e(C=>C.map(M=>{var A;if(M.id!==N)return M;const z=(A=M==null?void 0:M.data)==null?void 0:A.catalogType,D=z?r.current.get(z)??null:null,k=j&&typeof j=="object"?tu(j):wm(D??null),T={...M.data??{},config:k,isConfigured:!1,backgroundExecutionStatus:"idle"};return h({...M,data:T})}))},[r,h,e]),E=x.useCallback(()=>{e(N=>N.map(j=>{var k,T;if(!d1((k=j==null?void 0:j.data)==null?void 0:k.catalogType,r.current))return j;const C=(T=j==null?void 0:j.data)==null?void 0:T.catalogType,M=C?r.current.get(C)??null:null,z=wm(M??null),D={...j.data??{},config:z,isConfigured:!1,backgroundExecutionStatus:"idle"};return h({...j,data:D})}))},[r,h,e]);return{registerNode:h,createNode:_,handleAddNode:v,handleRemoveNode:p,handleUpdateNodeConfig:y,handleUpdateNodeData:b,handleResetNodeConfig:w,handleResetAllNodes:E,updateNodeCounter:m}},qB=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),VB=e=>{var n;const t=e?au[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(s=>s.required!==!1).map(s=>s.key):[]},KB=(e,t,n)=>{const s=VB(t);if(s.length===0)return!0;const r=n.filter(l=>l.target===e),i=new Set(r.map(l=>u1(e,l.targetHandle)).filter(l=>!!l));return s.every(l=>i.has(l))},YB=(e,t)=>{const n=new Map,s=new Set;e.forEach(d=>{var p;const f=(p=d==null?void 0:d.data)==null?void 0:p.catalogType;if(f&&qB.has(f)){s.add(d.id);return}f==="train_test_split"&&n.set(d.id,new Set(xa))});let r=!0,i=0;const l=e.length*3;for(;r&&i<l;)r=!1,i++,t.forEach(d=>{if(s.has(d.source)||s.has(d.target))return;const f=n.get(d.source),p=i1(d.sourceHandle);if(!f||f.size===0)return;n.has(d.target)||n.set(d.target,new Set);const h=n.get(d.target),m=h.size;p?f.has(p)&&h.add(p):f.forEach(_=>h.add(_)),h.size>m&&(r=!0)});const u=new Map;return n.forEach((d,f)=>{!d.size||s.has(f)||u.set(f,xa.filter(p=>d.has(p)))}),u},WB=e=>{const t=new Map;e.forEach(s=>{const r=i1(s.sourceHandle);r&&(t.has(s.source)||t.set(s.source,new Set),t.get(s.source).add(r))});const n=new Map;return t.forEach((s,r)=>{n.set(r,xa.filter(i=>s.has(i)))}),n},GB=({edges:e,setNodes:t,scheduleNodeInternalsUpdate:n})=>{x.useEffect(()=>{const s=[];t(r=>{const i=YB(r,e),l=WB(e);let u=!1;const d=r.map(f=>{var M,z,D,k,T;const h=((M=f==null?void 0:f.data)==null?void 0:M.catalogType)==="train_test_split"?[...xa]:i.get(f.id)??[],m=ba((z=f.data)==null?void 0:z.activeSplits),_=ba(l.get(f.id)),v=ba((D=f.data)==null?void 0:D.connectedSplits),y=((k=f==null?void 0:f.data)==null?void 0:k.catalogType)??"",b=KB(f.id,y,e),w=((T=f.data)==null?void 0:T.hasRequiredConnections)??!0,E=!o1(m,h),N=!o1(v,_);if(!E&&!N&&!(b!==w))return f;const C={...f.data,hasRequiredConnections:b};return h.length?C.activeSplits=h:delete C.activeSplits,_.length?C.connectedSplits=_:delete C.connectedSplits,(E||N)&&s.push(f.id),u=!0,{...f,data:C}});return u?d:r}),s.length&&n(s)},[e,n,t])},h1=(e,t)=>({nodes:JSON.parse(JSON.stringify(e??[])),edges:JSON.parse(JSON.stringify(t??[]))}),f1=e=>Array.isArray(e)?e.some(t=>(t==null?void 0:t.id)&&t.id!=="dataset-source"):!1,p1=e=>Array.isArray(e)?e.length>0:!1,XB=({setIsDirty:e,setSaveFeedback:t,isHydratingRef:n})=>{const s=x.useRef({nodes:[],edges:[]}),[r,i]=x.useState(!1),l=x.useCallback((d,f)=>{const p=h1(d,f);s.current=p;const h=f1(p.nodes),m=p1(p.edges);return i(h||m),{hasCustomNodes:h,hasEdges:m}},[]),u=x.useCallback((d,f)=>{const p=h1(d,f),h=s.current,m=JSON.stringify(h.nodes??[])===JSON.stringify(p.nodes??[])&&JSON.stringify(h.edges??[])===JSON.stringify(p.edges??[]);s.current=p;const _=f1(p.nodes),v=p1(p.edges);i(_||v),!(n.current||m)&&(e(!0),t(null))},[n,e,t]);return{graphSnapshotRef:s,canClearCanvas:r,handleGraphChange:u,applyHydratedSnapshot:l}},QB=({canvasShellRef:e,canClearCanvas:t,setSaveFeedback:n})=>x.useCallback(()=>{var s;t&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((s=e.current)==null||s.clearGraph(),n(r=>(r==null?void 0:r.tone)==="error"?r:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[e,t,n]),ZB=({activeSourceId:e,isDirty:t,setSaveFeedback:n,pipelineQueryKey:s,pendingHistoryIdRef:r,isHydratingRef:i,historyLimit:l=LB})=>{var p;const u=Ka(),d=Is({queryKey:["feature-canvas","pipeline-history",e],queryFn:()=>Cw(e,l),enabled:!!e,staleTime:30*1e3,retry:1}),f=x.useCallback(h=>{if(!(h!=null&&h.graph)){n({message:"Selected revision is missing pipeline data.",tone:"error"});return}t&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(r.current=h.id??null,i.current=!0,n({message:`Loading revision ${h.name??`#${h.id}`}`,tone:"info"}),u.setQueryData(s,h))},[t,i,r,s,u,n]);return{historyItems:d.data??[],isHistoryLoading:d.isLoading||d.isFetching,historyErrorMessage:d.error?((p=d.error)==null?void 0:p.message)??"Unable to load history":null,refetchHistory:d.refetch,handleHistorySelection:f}},g1=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},fg=e=>{const t=g1(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},pg=e=>{const t=g1(e);if(!t)return null;const n=t.getTime(),s=Date.now()-n,r=Math.round(s/6e4);if(r<1)return"just now";if(r===1)return"1 minute ago";if(r<60)return`${r} minutes ago`;const i=Math.round(r/60);if(i===1)return"1 hour ago";if(i<24)return`${i} hours ago`;const l=Math.round(i/24);if(l===1)return"1 day ago";if(l<7)return`${l} days ago`;const u=Math.round(l/7);return u===1?"1 week ago":`${u} weeks ago`},JB=({applyHydratedSnapshot:e,selectedDataset:t,activeSourceId:n,setActivePipelineId:s,setActivePipelineName:r,setActivePipelineUpdatedAt:i,setIsDirty:l,setSaveFeedback:u,pendingHistoryIdRef:d,isHydratingRef:f})=>{const p=x.useCallback(m=>{const{nodes:_,edges:v,pipeline:y,context:b}=m,{hasCustomNodes:w}=e(_,v),E=(y==null?void 0:y.id)??null;if(s(E),r((y==null?void 0:y.name)??null),i((y==null?void 0:y.updated_at)??null),b==="stored"&&y)if(d.current===y.id){const j=pg(y.updated_at)??fg(y.updated_at);u({message:`Saved revision ${y.name??`#${y.id}`} (${j})`,tone:"info"}),d.current=null}else f.current&&u(N=>(N==null?void 0:N.tone)==="error"?N:w?{message:"Loaded saved pipeline",tone:"info"}:N);else b==="sample"?(d.current=null,u(N=>(N==null?void 0:N.tone)==="error"||w?N:{message:`Showing starter pipeline for ${(t==null?void 0:t.name)??(t==null?void 0:t.source_id)??n??"demo dataset"}`,tone:"info"})):b==="reset"?d.current=null:y||(d.current=null,u(N=>(N==null?void 0:N.tone)==="error"?N:null));f.current&&l(!1),y&&d.current&&d.current!==y.id&&(d.current=null),f.current=!1},[n,e,d,t,s,r,i,l,u,f]),h=x.useCallback(m=>{u({message:(m==null?void 0:m.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[u]);return{handlePipelineHydrated:p,handlePipelineError:h}},e8=({sourceId:e,datasetDisplayLabel:t,registerNode:n,prepareNodes:s,setNodes:r,setEdges:i,updateNodeCounter:l,scheduleFitView:u,onPipelineHydrated:d,onPipelineError:f})=>{const p=x.useRef(!1),h=Is({queryKey:["feature-canvas","pipeline",e],queryFn:()=>Sw(e),enabled:!!e,staleTime:60*1e3,retry:1});return x.useEffect(()=>{const m=`Dataset input
(${t})`;if(!e){if(p.current)r(_=>{let v=!1;const y=_.map(b=>{var E;return b.id!=="dataset-source"||(((E=b==null?void 0:b.data)==null?void 0:E.label)??"")===m?b:(v=!0,n({...b,data:{...b.data??{},label:m,isDataset:!0,isRemovable:!1}}))});return v?y:_});else{const _=zB(t),v=s(_.nodes);p.current=!0,r(v),i(_.edges),l(v),u(),d==null||d({nodes:v,edges:_.edges,pipeline:null,context:"sample"})}return}if(p.current=!1,h.isLoading){r(_=>_.map(v=>v.id==="dataset-source"?n({...v,data:{...v.data??{},label:m,isDataset:!0,isRemovable:!1}}):v));return}if(h.isError){const _=h.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",_),f==null||f(_);const v=Cm().map(b=>b.id==="dataset-source"?{...b,data:{...b.data??{},label:m,isDataset:!0,isRemovable:!1}}:b),y=s(v);r(y),i([]),l(y),u(),d==null||d({nodes:y,edges:[],pipeline:null,context:"reset"});return}if(h.data){const _=h.data.graph??{},v=Array.isArray(_==null?void 0:_.nodes)&&_.nodes.length?_.nodes:Cm(),y=s(v),w=(Array.isArray(_==null?void 0:_.edges)?_.edges:[]).map(E=>{var T;const N=E==null?void 0:E.type,j=!N||N==="smoothstep"||N==="default"?"animatedEdge":N,C=E==null?void 0:E.source,M=E==null?void 0:E.target,z=y.find(A=>A.id===M),D=(E==null?void 0:E.sourceHandle)??(C?`${C}-source`:void 0),k=(E==null?void 0:E.targetHandle)??((T=z==null?void 0:z.data)!=null&&T.isDataset?void 0:M?`${M}-target`:void 0);return{...E,animated:(E==null?void 0:E.animated)??!0,type:j,sourceHandle:D,targetHandle:k}});r(y),i(w),l(y),u(),d==null||d({nodes:y,edges:w,pipeline:h.data??null,context:"stored"});return}if(h.isFetched&&!h.data){const _=Cm().map(y=>y.id==="dataset-source"?{...y,data:{...y.data??{},label:m,isDataset:!0,isRemovable:!1}}:y),v=s(_);r(v),i([]),l(v),u(),d==null||d({nodes:v,edges:[],pipeline:null,context:"sample"})}},[t,d,f,h.data,h.error,h.isError,h.isFetched,h.isLoading,s,n,u,i,r,e,l]),{isPipelineLoading:h.isLoading||h.isFetching}},t8=({queryClient:e,setSaveFeedback:t,setIsDirty:n,setActivePipelineId:s,setActivePipelineName:r,setActivePipelineUpdatedAt:i,pendingHistoryIdRef:l})=>{const{mutate:u,isPending:d}=Wi({mutationFn:async({sourceId:f,payload:p})=>Ew(f,p),onSuccess:(f,p)=>{t({message:"Draft saved successfully.",tone:"success"}),n(!1),s(f.id??null),r(f.name??null),i(f.updated_at??null),l.current=f.id??null,e.setQueryData(["feature-canvas","pipeline",p.sourceId],f),e.invalidateQueries({queryKey:["feature-canvas","pipeline-history",p.sourceId],exact:!1})},onError:f=>{t({message:(f==null?void 0:f.message)??"Failed to save pipeline.",tone:"error"})}});return{triggerSave:u,isSaving:d}},km=e=>!e||!e.length?"":e.join(", "),n8=({nodes:e,onAddNode:t})=>{const[n,s]=x.useState(""),[r,i]=x.useState([]),l=n.trim().toLowerCase(),u=x.useMemo(()=>l?e.filter(m=>{const _=[m.label,m.type,m.description];return m.category&&_.push(m.category),m.tags&&m.tags.length&&_.push(m.tags.join(" ")),_.some(v=>v==null?void 0:v.toLowerCase().includes(l))}):e,[e,l]),d=x.useMemo(()=>{const m=new Map;return u.forEach(_=>{var b;const v=((b=_.category)==null?void 0:b.trim())||"Other",y=m.get(v)??[];y.push(_),m.set(v,y)}),Array.from(m.entries()).sort(([_],[v])=>_.localeCompare(v)).map(([_,v])=>({category:_,entries:v.sort((y,b)=>(y.label||y.type).localeCompare(b.label||b.type))}))},[u]);x.useEffect(()=>{if(!l){i([]);return}i(m=>{const _=new Set(m);let v=!1;return d.forEach(({category:y})=>{_.has(y)||(_.add(y),v=!0)}),v?Array.from(_):m})},[d,l]);const f=m=>{i(_=>{const v=new Set(_);return v.has(m)?v.delete(m):v.add(m),Array.from(v)})},p=u.length,h=p>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem"},children:[a.jsx(I2,{size:20,className:"text-muted"}),a.jsx("h3",{style:{margin:0},children:"Available steps"})]}),a.jsxs("div",{className:"feature-canvas-sidebar__search",style:{position:"relative",display:"flex",alignItems:"center"},children:[a.jsx(U2,{size:16,style:{position:"absolute",left:"12px",color:"#9ca3af",pointerEvents:"none"}}),a.jsx("input",{type:"search",value:n,onChange:m=>s(m.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps",style:{paddingLeft:"36px"}}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>s(""),"aria-label":"Clear search",style:{display:"flex",alignItems:"center",justifyContent:"center",right:"8px"},children:a.jsx(il,{size:14})})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",p," ",p===1?"step":"steps",l?` matching ${n.trim()}`:""]})]}),h?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:d.map(({category:m,entries:_})=>{const v=r.includes(m);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>f(m),"aria-expanded":v,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:m.charAt(0).toUpperCase()+m.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[_.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":v,style:{display:"flex",alignItems:"center"},children:v?a.jsx(Yf,{size:14}):a.jsx(Wf,{size:14})})]})]}),v&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:_.map(y=>{var b,w;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(y),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:y.label||y.type}),y.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:y.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(b=y.inputs)!=null&&b.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${km(y.inputs)}`,children:["In: ",km(y.inputs)]}):null,(w=y.outputs)!=null&&w.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${km(y.outputs)}`,children:["Out: ",km(y.outputs)]}):null,y.parameters&&y.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",style:{display:"flex",alignItems:"center",gap:"4px"},children:[a.jsx(V2,{size:12}),y.parameters.length," param",y.parameters.length>1?"s":""]}):null]})]})},y.type)})})]},m)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})},s8=({nodeCatalog:e,isCatalogLoading:t,catalogErrorMessage:n,handleAddNode:s})=>({sidebarContent:x.useMemo(()=>t?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):n?a.jsx("p",{className:"text-danger",children:n}):e.length?a.jsx(n8,{nodes:e,onAddNode:s}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[n,s,t,e])}),r8=()=>{var p;const[e,t]=x.useState(!1),n=x.useRef(new Map),s=Is({queryKey:["feature-canvas","node-catalog"],queryFn:Ep,staleTime:5*60*1e3}),r=s.data??[],i=s.isLoading||s.isFetching,l=s.error?((p=s.error)==null?void 0:p.message)??"Unable to load node catalog":null;x.useEffect(()=>{const h=new Map;r.forEach(m=>{m&&typeof m.type=="string"&&m.type.trim()&&h.set(m.type,m)}),n.current=h},[r]);const u=x.useCallback(()=>t(!0),[]),d=x.useCallback(()=>t(!1),[]),f=x.useCallback(()=>t(h=>!h),[]);return{nodeCatalog:r,catalogEntryMapRef:n,isCatalogOpen:e,openCatalog:u,closeCatalog:d,toggleCatalog:f,isCatalogLoading:i,catalogErrorMessage:l}},a8=e=>e==="success"?"":e==="error"?"":"",o8=e=>e==="error"?"text-danger":e==="success"?"text-success":"text-muted",i8=()=>{const[e,t]=x.useState(null);x.useEffect(()=>{if(!e||e.tone==="error"||typeof window>"u")return;const r=window.setTimeout(()=>t(null),e.tone==="success"?4e3:2500);return()=>window.clearTimeout(r)},[e]);const n=x.useMemo(()=>a8(e==null?void 0:e.tone),[e]),s=x.useMemo(()=>o8(e==null?void 0:e.tone),[e]);return{saveFeedback:e,setSaveFeedback:t,feedbackIcon:n,feedbackClass:s}},l8=(e=!0)=>{const[t,n]=x.useState(e),s=x.useCallback(()=>{n(r=>!r)},[]);return{isSidepanelExpanded:t,handleToggleSidepanel:s}},c8=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:r,canSelectDatasets:i,datasetOptions:l,selectedDataset:u,activeSourceId:d,canClearCanvas:f,onDatasetSelection:p,onClearCanvas:h,onRefreshHistory:m,onSaveClick:_,isHistoryLoading:v,historyErrorMessage:y,historyItems:b,activePipelineId:w,isDirty:E,isSaving:N,saveFeedback:j,feedbackIcon:C,feedbackClass:M,onSelectHistory:z})=>({sidepanelProps:{activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:r,canSelectDatasets:i,datasetOptions:l,selectedDataset:u,activeSourceId:d,canClearCanvas:f,onDatasetSelection:p,onClearCanvas:h,onRefreshHistory:m,onSaveClick:_,isHistoryLoading:v,historyErrorMessage:y,historyItems:b,activePipelineId:w,isDirty:E,isSaveDisabled:!d||N,saveButtonLabel:N?"Saving":E?"Save draft*":"Save draft",saveFeedback:j,feedbackIcon:C,feedbackClass:M,onSelectHistory:z}}),u8=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const r=Math.abs(n-e),i=Math.max(64,Math.min(r*.45,240)),l=Number.isFinite(i)?i:100,u=n>=e?1:-1,d=e+u*l,f=t,p=n-u*l;return`M ${e},${t} C ${d},${f} ${p},${s} ${n},${s}`},d8=({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:r,targetPosition:i})=>{const l=u8(e,t,n,s),u="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:u,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:s,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:l,fill:"none",stroke:`url(#${u})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:l,fill:"none",stroke:`url(#${u})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:s,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},m8=({nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:r,onEdgesChange:i,onConnect:l,isValidConnection:u,onNodeClick:d,reactFlowInstanceRef:f,canvasViewportRef:p,handleResetAllNodes:h,openCatalog:m})=>a.jsxs("div",{className:"canvas-stage__viewport",ref:p,children:[a.jsxs(n0,{style:{width:"100%",height:"100%"},nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:r,onEdgesChange:i,onConnect:l,isValidConnection:u,onNodeClick:d,onInit:_=>{f.current=_,requestAnimationFrame(()=>_.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:Yo.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:d8,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(eO,{position:"bottom-left"}),a.jsx(aO,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:h,"aria-label":"Reset preprocessing nodes",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(Xf,{size:20})}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:m,"aria-label":"Open node catalog",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(B2,{size:24})})]}),ou=e=>!e||typeof e!="string"?"":e.replace(/\s+/g," ").trim().toLowerCase(),h8=x.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:s,onPipelineError:r},i)=>{const l=x.useMemo(()=>({featureNode:CB}),[]),u=x.useMemo(()=>({animatedEdge:Oz}),[]),[d,f,p]=C2(Cm().map($e=>({...$e,type:"featureNode"}))),[h,m,_]=k2($B()),[v,y]=x.useState(null),[b,w]=x.useState(!1),[E,N]=x.useState([]),[j,C]=x.useState([]),{pendingToastDetails:M,isPendingToastVisible:z,showPendingToast:D,dismissPendingToast:k,clearPendingToast:T}=hB(),A=x.useRef(null),O=x.useRef(null),R=x.useRef(!1),L=t??e??"Demo dataset",F=iO(),{nodeCatalog:B,catalogEntryMapRef:q,isCatalogOpen:I,openCatalog:U,closeCatalog:V,isCatalogLoading:H,catalogErrorMessage:G}=r8(),W=x.useCallback($e=>{const Ie=(Array.isArray($e)?$e:[$e]).filter(Boolean);if(!Ie.length)return;const Be=Array.from(new Set(Ie));requestAnimationFrame(()=>{requestAnimationFrame(()=>{Be.forEach(Ee=>{F(Ee)})})})},[F]);GB({edges:h,setNodes:f,scheduleNodeInternalsUpdate:W});const J=x.useMemo(()=>d.find($e=>$e.id===v)??null,[d,v]),ee=x.useMemo(()=>IB(d,h),[h,d]),Z=x.useCallback($e=>{y($e),w(!0)},[]),K=x.useCallback(()=>{w(!1),y(null)},[]),X=x.useCallback($e=>{N($e)},[]),Q=x.useCallback(()=>{N([]),C([])},[]),ne=x.useCallback($e=>{const Ie=Array.from(new Set($e.map(Be=>ou(Be)).filter(Be=>!!Be)));Ie.length&&(w(!1),y(null),C(Ie),requestAnimationFrame(()=>{var Ee,lt;const Be=d.filter(Je=>{const Ue=Je.data??{};return[typeof Ue.label=="string"?Ue.label:null,typeof Ue.title=="string"?Ue.title:null,typeof Ue.name=="string"?Ue.name:null,typeof Ue.displayName=="string"?Ue.displayName:null,typeof Ue.display_label=="string"?Ue.display_label:null,typeof Ue.catalogType=="string"?Ue.catalogType:null,typeof Ue.type=="string"?Ue.type:null,Je.id].some(Yt=>{const bt=ou(Yt);return bt&&Ie.includes(bt)})});Be.length?(Ee=A.current)==null||Ee.fitView({nodes:Be,padding:.35,duration:400}):(lt=A.current)==null||lt.fitView({padding:.3,duration:350})}))},[d,A]),le=x.useCallback(()=>{R.current=!0},[]);x.useEffect(()=>{R.current&&(R.current=!1,requestAnimationFrame(()=>{var $e;($e=A.current)==null||$e.fitView({padding:.25,duration:350})}))},[h,d]),x.useEffect(()=>{if(!j.length)return;const $e=setTimeout(()=>{C([])},4e3);return()=>clearTimeout($e)},[j]),x.useEffect(()=>{if(!E.length){T();return}D(E)},[E,D,T]),x.useEffect(()=>{if(!E.length){C(Ie=>Ie.length?[]:Ie);return}const $e=new Set(E.map(Ie=>ou(Ie.label)).filter(Ie=>!!Ie));C(Ie=>{if(!Ie.length)return Ie;const Be=Ie.filter(Ee=>$e.has(Ee));return Be.length===Ie.length?Ie:Be})},[E]);const{registerNode:ce,handleAddNode:ie,handleUpdateNodeConfig:ge,handleUpdateNodeData:Re,handleResetNodeConfig:ze,handleResetAllNodes:me,updateNodeCounter:xe}=UB({setNodes:f,setEdges:m,setSelectedNodeId:y,setIsSettingsModalOpen:w,catalogEntryMapRef:q,handleOpenSettings:Z,reactFlowInstanceRef:A,canvasViewportRef:O,scheduleFitView:le});x.useEffect(()=>{xe(d)},[d,xe]),x.useEffect(()=>{const $e=d.filter(Be=>{var Je,Ue;const Ee=(Je=Be.data)==null?void 0:Je.backgroundExecutionStatus,lt=(Ue=Be.data)==null?void 0:Ue.catalogType;return Ee==="loading"&&(lt==="train_model_draft"||lt==="hyperparameter_tuning")});if($e.length===0)return;const Ie=setTimeout(async()=>{const Be=new Map;await Promise.all($e.map(async Ee=>{var lt,Je,Ue,Rt;try{const Yt=(lt=Ee.data)==null?void 0:lt.catalogType;let bt=null;if(Yt==="train_model_draft"?bt=(Je=(await Jo({datasetSourceId:e||void 0,nodeId:Ee.id,limit:1})).jobs)==null?void 0:Je[0]:Yt==="hyperparameter_tuning"&&(bt=(Ue=(await ei({datasetSourceId:e||void 0,nodeId:Ee.id,limit:1})).jobs)==null?void 0:Ue[0]),bt){const Ot=(Rt=bt.status)==null?void 0:Rt.toLowerCase();let Pt="idle";Ot==="running"||Ot==="queued"?Pt="loading":Ot==="succeeded"?Pt="success":(Ot==="failed"||Ot==="cancelled")&&(Pt="error");const wt=typeof bt.progress=="number"?bt.progress:void 0;Be.set(Ee.id,{backgroundExecutionStatus:Pt,progress:wt})}}catch{}})),Be.size>0&&f(Ee=>Ee.map(lt=>{if(Be.has(lt.id)){const Je=Be.get(lt.id),Ue=lt.data||{};if(Ue.backgroundExecutionStatus!==Je.backgroundExecutionStatus||Ue.progress!==Je.progress)return{...lt,data:{...Ue,...Je}}}return lt}))},1e3);return()=>clearTimeout(Ie)},[d,e,f]);const Ce=x.useCallback($e=>$e.map(Ie=>{const Be={...Ie.data??{}};Ie.id==="dataset-source"&&(Be.label=`Dataset input
(${L})`,Be.isDataset=!0,Be.isRemovable=!1,Be.isConfigured=!0);const Ee=Be.catalogType??Be.type??Ie.id;return Be.config&&typeof Be.config=="object"&&bm(Ee)&&delete Be.config[so],Be.isConfigured===void 0&&(Be.config&&typeof Be.config=="object"?Be.isConfigured=bm(Ee)?!0:!Be.config[so]:Be.isConfigured=!0),ce({...Ie,data:Be})}),[L,ce]),{isPipelineLoading:Ae}=e8({sourceId:e,datasetDisplayLabel:L,registerNode:ce,prepareNodes:Ce,setNodes:f,setEdges:m,updateNodeCounter:xe,scheduleFitView:le,onPipelineHydrated:s,onPipelineError:r}),[Ve,Se]=x.useState(!1);x.useEffect(()=>{Se(!1)},[e]),x.useEffect(()=>{if(Ae||Ve||!e||d.length===0||!d.some(Ee=>Ee.id!=="dataset-source")&&d.length>1)return;const Ie=d.filter(Ee=>{var Je;const lt=(Je=Ee.data)==null?void 0:Je.catalogType;return lt==="train_model_draft"||lt==="hyperparameter_tuning"});if(Ie.length===0){Se(!0);return}(async()=>{const Ee=new Map;await Promise.all(Ie.map(async lt=>{var Je,Ue,Rt,Yt,bt;try{const Ot=(Je=lt.data)==null?void 0:Je.catalogType;let Pt=null;if(Ot==="train_model_draft"?Pt=(Ue=(await Jo({datasetSourceId:e||void 0,nodeId:lt.id,limit:1})).jobs)==null?void 0:Ue[0]:Ot==="hyperparameter_tuning"&&(Pt=(Rt=(await ei({datasetSourceId:e||void 0,nodeId:lt.id,limit:1})).jobs)==null?void 0:Rt[0]),Pt){const wt=(Yt=Pt.status)==null?void 0:Yt.toLowerCase();let pt="idle";wt==="running"||wt==="queued"?pt="loading":wt==="succeeded"?pt="success":(wt==="failed"||wt==="cancelled")&&(pt="error");const rn=typeof Pt.progress=="number"?Pt.progress:void 0;(pt==="loading"||pt!==((bt=lt.data)==null?void 0:bt.backgroundExecutionStatus))&&Ee.set(lt.id,{backgroundExecutionStatus:pt,progress:rn})}}catch{}})),Ee.size>0&&f(lt=>lt.map(Je=>{if(Ee.has(Je.id)){const Ue=Ee.get(Je.id);return{...Je,data:{...Je.data||{},...Ue}}}return Je})),Se(!0)})()},[Ae,Ve,e,d,f]);const We=x.useCallback(()=>{f($e=>{const Ie=$e.find(Ee=>Ee.id==="dataset-source");return[ce(Ie?{...Ie,data:{...Ie.data??{},label:`Dataset input
(${L})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${L})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),m([]),y(null),w(!1),le()},[L,ce,le,m,f,y,w]);x.useImperativeHandle(i,()=>({openCatalog:U,closeCatalog:V,clearGraph:We}),[We,V,U]);const{isValidConnection:ht,onConnect:ye}=HB({nodes:d,setEdges:m,scheduleNodeInternalsUpdate:W});x.useEffect(()=>{n==null||n(d,h)},[h,d,n]);const Fe=x.useMemo(()=>{var Be;if(!J)return null;const $e=(Be=J==null?void 0:J.data)==null?void 0:Be.catalogType;if(!$e)return null;const Ie=q.current.get($e);return Ie?wm(Ie):null},[J]),Qe=x.useMemo(()=>{var Ie,Be;if(!J||(Ie=J.data)!=null&&Ie.isDataset)return!1;const $e=(Be=J==null?void 0:J.data)==null?void 0:Be.catalogType;return d1(typeof $e=="string"?$e:null,q.current)},[J]),{sidebarContent:tt}=s8({nodeCatalog:B,isCatalogLoading:H,catalogErrorMessage:G,handleAddNode:ie}),xt=x.useCallback(($e,Ie)=>{Z(Ie.id)},[Z]),_t=x.useMemo(()=>{const $e=new Map;return E.forEach(({label:Ie,reason:Be})=>{const Ee=ou(Ie);Ee&&$e.set(Ee,Be??null)}),$e},[E]),Bt=x.useMemo(()=>new Set(j),[j]);return x.useEffect(()=>{if(!_t.size&&!Bt.size){f($e=>{let Ie=!1;const Be=$e.map(Ee=>{var Ue,Rt;const lt=!!((Ue=Ee.data)!=null&&Ue.pendingWarningActive),Je=!!((Rt=Ee.data)!=null&&Rt.pendingHighlight);return!lt&&!Je?Ee:(Ie=!0,{...Ee,data:{...Ee.data??{},pendingWarningActive:!1,pendingWarningReason:null,pendingHighlight:!1}})});return Ie?Be:$e});return}f($e=>{let Ie=!1;const Be=$e.map(Ee=>{var wt,pt,rn,Jt,tn,Pe,Wt;const Je=[typeof((wt=Ee.data)==null?void 0:wt.label)=="string"?(pt=Ee.data)==null?void 0:pt.label:null,typeof((rn=Ee.data)==null?void 0:rn.title)=="string"?(Jt=Ee.data)==null?void 0:Jt.title:null,Ee.id].map(mn=>ou(mn)).find(Boolean)??"",Ue=Je?_t.has(Je):!1,Rt=Ue&&Je?_t.get(Je)??null:null,Yt=Je?Bt.has(Je):!1,bt=((tn=Ee.data)==null?void 0:tn.pendingWarningReason)??null,Ot=!!((Pe=Ee.data)!=null&&Pe.pendingHighlight),Pt=!!((Wt=Ee.data)!=null&&Wt.pendingWarningActive);return bt===Rt&&Ot===Yt&&Pt===Ue?Ee:(Ie=!0,{...Ee,data:{...Ee.data??{},pendingWarningActive:Ue,pendingWarningReason:Rt,pendingHighlight:Yt}})});return Ie?Be:$e})},[Bt,_t,f]),a.jsxs("div",{className:"canvas-stage","data-pipeline-loading":Ae?"true":"false","aria-busy":Ae,children:[a.jsx(m8,{nodes:d,edges:h,nodeTypes:l,edgeTypes:u,onNodesChange:p,onEdgesChange:_,onConnect:ye,isValidConnection:ht,onNodeClick:xt,reactFlowInstanceRef:A,canvasViewportRef:O,handleResetAllNodes:me,openCatalog:U}),a.jsxs("div",{className:`canvas-drawer${I?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:V,"aria-label":"Close catalog",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(il,{size:20})})]}),a.jsx("div",{className:"canvas-drawer__body",children:tt})]}),I&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:V}),b&&J&&a.jsx(xB,{node:J,sourceId:e??null,graphSnapshot:ee,onClose:K,onUpdateConfig:ge,onUpdateNodeData:Re,onResetConfig:ze,defaultConfigTemplate:Fe,isResetAvailable:Qe,onPendingConfigurationUpdate:X,onPendingConfigurationCleared:Q,onHighlightPendingNodes:ne,pendingConfigurationDetails:E}),z&&M.length>0&&a.jsx(MB,{details:M,onDismiss:k,onHighlight:ne})]})}),f8=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:r,canSelectDatasets:i,datasetOptions:l,selectedDataset:u,activeSourceId:d,canClearCanvas:f,onDatasetSelection:p,onClearCanvas:h,onRefreshHistory:m,onSaveClick:_,isHistoryLoading:v,historyErrorMessage:y,historyItems:b,activePipelineId:w,isDirty:E,isSaveDisabled:N,saveButtonLabel:j,saveFeedback:C,feedbackIcon:M,feedbackClass:z,onSelectHistory:D})=>{const k=d?(u==null?void 0:u.name)??d:null;return a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),e&&a.jsx("span",{className:"canvas-sidepanel__meta",children:pg(e)??fg(e)})]}),t?a.jsx("p",{className:"text-danger",children:t}):r?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:d??"",onChange:T=>p(T.target.value),disabled:n||!i,"aria-label":"Select dataset",children:l.map(T=>a.jsx("option",{value:T.value,disabled:!T.isOwned,children:`${T.label}${T.isOwned?"":" (locked)"}`},T.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),n&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!n&&!s&&!t&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:u.description}),k&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:k})]}),!i&&r>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:h,disabled:!f,"aria-label":"Clean all nodes",title:f?"Remove all nodes and edges from the canvas":"Nothing to clean yet",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[a.jsx(Cc,{size:16}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:m,disabled:v||!d,"aria-label":"Refresh history",title:"Refresh history",style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(H2,{size:16})}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:_,disabled:N,"aria-label":j,title:j,style:{display:"flex",alignItems:"center",justifyContent:"center"},children:a.jsx(i0,{size:16})})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:v?a.jsx("p",{className:"text-muted",children:"Loading history"}):y?a.jsx("p",{className:"text-danger",children:y}):b.length?b.map(T=>{const O=pg(T.updated_at)??fg(T.updated_at),R=T.id===w,L=R&&!E;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${R?" canvas-sidepanel__history-item--active":""}`,onClick:()=>D(T),disabled:L,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:T.name||`Pipeline #${T.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:O}),R&&E&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},T.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),C&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${z}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:M}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:C.message})]})]})},p8=e=>{const t=e==null?void 0:e.type;return!t||t==="smoothstep"||t==="default"?"animatedEdge":t},g8=({snapshot:e,selectedDataset:t,activeSourceId:n})=>{const s=e.nodes??[],r=e.edges??[];return{name:t!=null&&t.name?`Draft pipeline for ${t.name}`:`Draft pipeline for ${n}`,graph:{nodes:s,edges:r.map(i=>({...i,animated:(i==null?void 0:i.animated)??!0,type:p8(i)}))},metadata:{lastClientSave:new Date().toISOString(),nodeCount:s.length,edgeCount:r.length}}},_8=({sourceId:e})=>{const t=Ka(),n=x.useRef(null),s=x.useRef(!0),{isSidepanelExpanded:r,handleToggleSidepanel:i}=l8(!0),[l,u]=x.useState(!1),{saveFeedback:d,setSaveFeedback:f,feedbackIcon:p,feedbackClass:h}=i8(),{selectedDataset:m,activeSourceId:_,datasetOptions:v,canSelectDatasets:y,hasDatasets:b,ownedDatasetsCount:w,isDatasetLoading:E,datasetErrorMessage:N,handleDatasetSelection:j}=BB({sourceId:e,setIsDirty:u,setSaveFeedback:f,isHydratingRef:s}),[C,M]=x.useState(null),[z,D]=x.useState(null),[k,T]=x.useState(null),A=x.useMemo(()=>["feature-canvas","pipeline",_],[_]),O=x.useRef(null),{graphSnapshotRef:R,canClearCanvas:L,handleGraphChange:F,applyHydratedSnapshot:B}=XB({setIsDirty:u,setSaveFeedback:f,isHydratingRef:s}),q=QB({canvasShellRef:n,canClearCanvas:L,setSaveFeedback:f}),{historyItems:I,isHistoryLoading:U,historyErrorMessage:V,refetchHistory:H,handleHistorySelection:G}=ZB({activeSourceId:_,isDirty:l,setSaveFeedback:f,pipelineQueryKey:A,pendingHistoryIdRef:O,isHydratingRef:s}),{triggerSave:W,isSaving:J}=t8({queryClient:t,setSaveFeedback:f,setIsDirty:u,setActivePipelineId:M,setActivePipelineName:T,setActivePipelineUpdatedAt:D,pendingHistoryIdRef:O}),{handlePipelineHydrated:ee,handlePipelineError:Z}=JB({applyHydratedSnapshot:B,selectedDataset:m,activeSourceId:_,setActivePipelineId:M,setActivePipelineName:T,setActivePipelineUpdatedAt:D,setIsDirty:u,setSaveFeedback:f,pendingHistoryIdRef:O,isHydratingRef:s}),K=x.useCallback(()=>{if(!_){f({message:"Select a dataset before saving.",tone:"error"});return}const Q=R.current;if(!Q.nodes||!Q.nodes.length){f({message:"Add nodes to the canvas before saving.",tone:"error"});return}const ne=g8({snapshot:Q,selectedDataset:m,activeSourceId:_});f({message:"Saving draft",tone:"info"}),W({sourceId:_,payload:ne})},[_,m==null?void 0:m.name,W]),{sidepanelProps:X}=c8({activePipelineUpdatedAt:z,datasetErrorMessage:N,isDatasetLoading:E,hasDatasets:b,ownedDatasetsCount:w,canSelectDatasets:y,datasetOptions:v,selectedDataset:m,activeSourceId:_,canClearCanvas:L,onDatasetSelection:j,onClearCanvas:q,onRefreshHistory:()=>{H()},onSaveClick:K,isHistoryLoading:U,historyErrorMessage:V,historyItems:I,activePipelineId:C,isDirty:l,isSaving:J,saveFeedback:d,feedbackIcon:p,feedbackClass:h,onSelectHistory:G});return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":r?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:i,"aria-label":r?"Collapse details panel":"Expand details panel","aria-expanded":r,"aria-controls":"feature-canvas-sidepanel",children:r?"":""}),!r&&d&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${h}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:p}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:d.message})]}),r&&a.jsx(f8,{...X}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(s0,{children:a.jsx(h8,{ref:n,sourceId:_,datasetName:(m==null?void 0:m.name)??(m==null?void 0:m.source_id)??null,onGraphChange:F,onPipelineHydrated:ee,onPipelineError:Z})})})]})},y8=new $E,gg=document.getElementById("ml-workflow-root");if(!gg)throw new Error("ML workflow root element not found");const v8=Dh.createRoot(gg),x8=gg.getAttribute("data-source-id")||void 0;v8.render(a.jsx(ve.StrictMode,{children:a.jsx(LE,{client:y8,children:a.jsx(_8,{sourceId:x8})})}))})();
//# sourceMappingURL=feature-canvas.js.map
