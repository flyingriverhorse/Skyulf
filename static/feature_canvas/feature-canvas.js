var nj=$n=>{throw TypeError($n)};var V_=($n,Vn,Wn)=>Vn.has($n)||nj("Cannot "+Wn);var me=($n,Vn,Wn)=>(V_($n,Vn,"read from private field"),Wn?Wn.call($n):Vn.get($n)),ht=($n,Vn,Wn)=>Vn.has($n)?nj("Cannot add the same private member more than once"):Vn instanceof WeakSet?Vn.add($n):Vn.set($n,Wn),et=($n,Vn,Wn,Bi)=>(V_($n,Vn,"write to private field"),Bi?Bi.call($n,Wn):Vn.set($n,Wn),Wn),Rt=($n,Vn,Wn)=>(V_($n,Vn,"access private method"),Wn);var wp=($n,Vn,Wn,Bi)=>({set _(Dt){et($n,Vn,Dt,Wn)},get _(){return me($n,Vn,Bi)}});(function(){"use strict";var ei,g_,Vw,il,ti,Tc,Ww,$c,ni,Lc,Kw,ll,Yw,cl,Dc,Dr,ul,cs,$d,dl,na,Vo,Qw,Js,qt,Ld,Rs,ml,zc,uo,si,Dd,Rc,Fc,fl,hl,ri,Ic,Zt,qm,W_,K_,Y_,Q_,G_,X_,J_,sj,Gw,zd,Pa,Fs,pl,Ta,Ii,Xw,mo,sa,Rd,Jw,fo,ai,Zs,ho,po,jp,Z_,Zw,$a,ej,Ln,oi,ii,Bc,Uc,li,qc,Hc,tj;function $n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Vn={exports:{}},Wn={},Bi={exports:{}},Dt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ev;function rj(){if(ev)return Dt;ev=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),_=Symbol.iterator;function v(H){return H===null||typeof H!="object"?null:(H=_&&H[_]||H["@@iterator"],typeof H=="function"?H:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},x=Object.assign,S={};function E(H,Q,ee){this.props=H,this.context=Q,this.refs=S,this.updater=ee||w}E.prototype.isReactComponent={},E.prototype.setState=function(H,Q){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,Q,"setState")},E.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function A(){}A.prototype=E.prototype;function P(H,Q,ee){this.props=H,this.context=Q,this.refs=S,this.updater=ee||w}var T=P.prototype=new A;T.constructor=P,x(T,E.prototype),T.isPureReactComponent=!0;var j=Array.isArray,O=Object.prototype.hasOwnProperty,k={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function $(H,Q,ee){var G,V={},Z=null,de=null;if(Q!=null)for(G in Q.ref!==void 0&&(de=Q.ref),Q.key!==void 0&&(Z=""+Q.key),Q)O.call(Q,G)&&!D.hasOwnProperty(G)&&(V[G]=Q[G]);var pe=arguments.length-2;if(pe===1)V.children=ee;else if(1<pe){for(var le=Array(pe),ge=0;ge<pe;ge++)le[ge]=arguments[ge+2];V.children=le}if(H&&H.defaultProps)for(G in pe=H.defaultProps,pe)V[G]===void 0&&(V[G]=pe[G]);return{$$typeof:e,type:H,key:Z,ref:de,props:V,_owner:k.current}}function B(H,Q){return{$$typeof:e,type:H.type,key:Q,ref:H.ref,props:H.props,_owner:H._owner}}function q(H){return typeof H=="object"&&H!==null&&H.$$typeof===e}function K(H){var Q={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ee){return Q[ee]})}var ne=/\/+/g;function ue(H,Q){return typeof H=="object"&&H!==null&&H.key!=null?K(""+H.key):Q.toString(36)}function z(H,Q,ee,G,V){var Z=typeof H;(Z==="undefined"||Z==="boolean")&&(H=null);var de=!1;if(H===null)de=!0;else switch(Z){case"string":case"number":de=!0;break;case"object":switch(H.$$typeof){case e:case t:de=!0}}if(de)return de=H,V=V(de),H=G===""?"."+ue(de,0):G,j(V)?(ee="",H!=null&&(ee=H.replace(ne,"$&/")+"/"),z(V,Q,ee,"",function(ge){return ge})):V!=null&&(q(V)&&(V=B(V,ee+(!V.key||de&&de.key===V.key?"":(""+V.key).replace(ne,"$&/")+"/")+H)),Q.push(V)),1;if(de=0,G=G===""?".":G+":",j(H))for(var pe=0;pe<H.length;pe++){Z=H[pe];var le=G+ue(Z,pe);de+=z(Z,Q,ee,le,V)}else if(le=v(H),typeof le=="function")for(H=le.call(H),pe=0;!(Z=H.next()).done;)Z=Z.value,le=G+ue(Z,pe++),de+=z(Z,Q,ee,le,V);else if(Z==="object")throw Q=String(H),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.");return de}function X(H,Q,ee){if(H==null)return H;var G=[],V=0;return z(H,G,"","",function(Z){return Q.call(ee,Z,V++)}),G}function Y(H){if(H._status===-1){var Q=H._result;Q=Q(),Q.then(function(ee){(H._status===0||H._status===-1)&&(H._status=1,H._result=ee)},function(ee){(H._status===0||H._status===-1)&&(H._status=2,H._result=ee)}),H._status===-1&&(H._status=0,H._result=Q)}if(H._status===1)return H._result.default;throw H._result}var W={current:null},F={transition:null},te={ReactCurrentDispatcher:W,ReactCurrentBatchConfig:F,ReactCurrentOwner:k};function U(){throw Error("act(...) is not supported in production builds of React.")}return Dt.Children={map:X,forEach:function(H,Q,ee){X(H,function(){Q.apply(this,arguments)},ee)},count:function(H){var Q=0;return X(H,function(){Q++}),Q},toArray:function(H){return X(H,function(Q){return Q})||[]},only:function(H){if(!q(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Dt.Component=E,Dt.Fragment=n,Dt.Profiler=i,Dt.PureComponent=P,Dt.StrictMode=r,Dt.Suspense=m,Dt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=te,Dt.act=U,Dt.cloneElement=function(H,Q,ee){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var G=x({},H.props),V=H.key,Z=H.ref,de=H._owner;if(Q!=null){if(Q.ref!==void 0&&(Z=Q.ref,de=k.current),Q.key!==void 0&&(V=""+Q.key),H.type&&H.type.defaultProps)var pe=H.type.defaultProps;for(le in Q)O.call(Q,le)&&!D.hasOwnProperty(le)&&(G[le]=Q[le]===void 0&&pe!==void 0?pe[le]:Q[le])}var le=arguments.length-2;if(le===1)G.children=ee;else if(1<le){pe=Array(le);for(var ge=0;ge<le;ge++)pe[ge]=arguments[ge+2];G.children=pe}return{$$typeof:e,type:H.type,key:V,ref:Z,props:G,_owner:de}},Dt.createContext=function(H){return H={$$typeof:u,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:l,_context:H},H.Consumer=H},Dt.createElement=$,Dt.createFactory=function(H){var Q=$.bind(null,H);return Q.type=H,Q},Dt.createRef=function(){return{current:null}},Dt.forwardRef=function(H){return{$$typeof:d,render:H}},Dt.isValidElement=q,Dt.lazy=function(H){return{$$typeof:p,_payload:{_status:-1,_result:H},_init:Y}},Dt.memo=function(H,Q){return{$$typeof:y,type:H,compare:Q===void 0?null:Q}},Dt.startTransition=function(H){var Q=F.transition;F.transition={};try{H()}finally{F.transition=Q}},Dt.unstable_act=U,Dt.useCallback=function(H,Q){return W.current.useCallback(H,Q)},Dt.useContext=function(H){return W.current.useContext(H)},Dt.useDebugValue=function(){},Dt.useDeferredValue=function(H){return W.current.useDeferredValue(H)},Dt.useEffect=function(H,Q){return W.current.useEffect(H,Q)},Dt.useId=function(){return W.current.useId()},Dt.useImperativeHandle=function(H,Q,ee){return W.current.useImperativeHandle(H,Q,ee)},Dt.useInsertionEffect=function(H,Q){return W.current.useInsertionEffect(H,Q)},Dt.useLayoutEffect=function(H,Q){return W.current.useLayoutEffect(H,Q)},Dt.useMemo=function(H,Q){return W.current.useMemo(H,Q)},Dt.useReducer=function(H,Q,ee){return W.current.useReducer(H,Q,ee)},Dt.useRef=function(H){return W.current.useRef(H)},Dt.useState=function(H){return W.current.useState(H)},Dt.useSyncExternalStore=function(H,Q,ee){return W.current.useSyncExternalStore(H,Q,ee)},Dt.useTransition=function(){return W.current.useTransition()},Dt.version="18.3.1",Dt}Bi.exports=rj();var f=Bi.exports;const Ae=$n(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var tv;function aj(){if(tv)return Wn;tv=1;var e=f,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(d,m,y){var p,_={},v=null,w=null;y!==void 0&&(v=""+y),m.key!==void 0&&(v=""+m.key),m.ref!==void 0&&(w=m.ref);for(p in m)r.call(m,p)&&!l.hasOwnProperty(p)&&(_[p]=m[p]);if(d&&d.defaultProps)for(p in m=d.defaultProps,m)_[p]===void 0&&(_[p]=m[p]);return{$$typeof:t,type:d,key:v,ref:w,props:_,_owner:i.current}}return Wn.Fragment=n,Wn.jsx=u,Wn.jsxs=u,Wn}Vn.exports=aj();var a=Vn.exports,Np={},nv={exports:{}},Ks={},Sp={exports:{}},Cp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv;function oj(){return sv||(sv=1,function(e){function t(F,te){var U=F.length;F.push(te);e:for(;0<U;){var H=U-1>>>1,Q=F[H];if(0<i(Q,te))F[H]=te,F[U]=Q,U=H;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var te=F[0],U=F.pop();if(U!==te){F[0]=U;e:for(var H=0,Q=F.length,ee=Q>>>1;H<ee;){var G=2*(H+1)-1,V=F[G],Z=G+1,de=F[Z];if(0>i(V,U))Z<Q&&0>i(de,V)?(F[H]=de,F[Z]=U,H=Z):(F[H]=V,F[G]=U,H=G);else if(Z<Q&&0>i(de,U))F[H]=de,F[Z]=U,H=Z;else break e}}return te}function i(F,te){var U=F.sortIndex-te.sortIndex;return U!==0?U:F.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var m=[],y=[],p=1,_=null,v=3,w=!1,x=!1,S=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(F){for(var te=n(y);te!==null;){if(te.callback===null)r(y);else if(te.startTime<=F)r(y),te.sortIndex=te.expirationTime,t(m,te);else break;te=n(y)}}function j(F){if(S=!1,T(F),!x)if(n(m)!==null)x=!0,Y(O);else{var te=n(y);te!==null&&W(j,te.startTime-F)}}function O(F,te){x=!1,S&&(S=!1,A($),$=-1),w=!0;var U=v;try{for(T(te),_=n(m);_!==null&&(!(_.expirationTime>te)||F&&!K());){var H=_.callback;if(typeof H=="function"){_.callback=null,v=_.priorityLevel;var Q=H(_.expirationTime<=te);te=e.unstable_now(),typeof Q=="function"?_.callback=Q:_===n(m)&&r(m),T(te)}else r(m);_=n(m)}if(_!==null)var ee=!0;else{var G=n(y);G!==null&&W(j,G.startTime-te),ee=!1}return ee}finally{_=null,v=U,w=!1}}var k=!1,D=null,$=-1,B=5,q=-1;function K(){return!(e.unstable_now()-q<B)}function ne(){if(D!==null){var F=e.unstable_now();q=F;var te=!0;try{te=D(!0,F)}finally{te?ue():(k=!1,D=null)}}else k=!1}var ue;if(typeof P=="function")ue=function(){P(ne)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,X=z.port2;z.port1.onmessage=ne,ue=function(){X.postMessage(null)}}else ue=function(){E(ne,0)};function Y(F){D=F,k||(k=!0,ue())}function W(F,te){$=E(function(){F(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(F){F.callback=null},e.unstable_continueExecution=function(){x||w||(x=!0,Y(O))},e.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<F?Math.floor(1e3/F):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return n(m)},e.unstable_next=function(F){switch(v){case 1:case 2:case 3:var te=3;break;default:te=v}var U=v;v=te;try{return F()}finally{v=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(F,te){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var U=v;v=F;try{return te()}finally{v=U}},e.unstable_scheduleCallback=function(F,te,U){var H=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?H+U:H):U=H,F){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=U+Q,F={id:p++,callback:te,priorityLevel:F,startTime:U,expirationTime:Q,sortIndex:-1},U>H?(F.sortIndex=U,t(y,F),n(m)===null&&F===n(y)&&(S?(A($),$=-1):S=!0,W(j,U-H))):(F.sortIndex=Q,t(m,F),x||w||(x=!0,Y(O))),F},e.unstable_shouldYield=K,e.unstable_wrapCallback=function(F){var te=v;return function(){var U=v;v=te;try{return F.apply(this,arguments)}finally{v=U}}}}(Cp)),Cp}var rv;function ij(){return rv||(rv=1,Sp.exports=oj()),Sp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var av;function lj(){if(av)return Ks;av=1;var e=f,t=ij();function n(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function l(s,o){u(s,o),u(s+"Capture",o)}function u(s,o){for(i[s]=o,s=0;s<o.length;s++)r.add(o[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},_={};function v(s){return m.call(_,s)?!0:m.call(p,s)?!1:y.test(s)?_[s]=!0:(p[s]=!0,!1)}function w(s,o,c,h){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function x(s,o,c,h){if(o===null||typeof o>"u"||w(s,o,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function S(s,o,c,h,b,C,R){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=b,this.mustUseProperty=c,this.propertyName=s,this.type=o,this.sanitizeURL=C,this.removeEmptyString=R}var E={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){E[s]=new S(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var o=s[0];E[o]=new S(o,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){E[s]=new S(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){E[s]=new S(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){E[s]=new S(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){E[s]=new S(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){E[s]=new S(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){E[s]=new S(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){E[s]=new S(s,5,!1,s.toLowerCase(),null,!1,!1)});var A=/[\-:]([a-z])/g;function P(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var o=s.replace(A,P);E[o]=new S(o,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var o=s.replace(A,P);E[o]=new S(o,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var o=s.replace(A,P);E[o]=new S(o,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){E[s]=new S(s,1,!1,s.toLowerCase(),null,!1,!1)}),E.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){E[s]=new S(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,o,c,h){var b=E.hasOwnProperty(o)?E[o]:null;(b!==null?b.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(x(o,c,b,h)&&(c=null),h||b===null?v(o)&&(c===null?s.removeAttribute(o):s.setAttribute(o,""+c)):b.mustUseProperty?s[b.propertyName]=c===null?b.type===3?!1:"":c:(o=b.attributeName,h=b.attributeNamespace,c===null?s.removeAttribute(o):(b=b.type,c=b===3||b===4&&c===!0?"":""+c,h?s.setAttributeNS(h,o,c):s.setAttribute(o,c))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,O=Symbol.for("react.element"),k=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),q=Symbol.for("react.provider"),K=Symbol.for("react.context"),ne=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),X=Symbol.for("react.memo"),Y=Symbol.for("react.lazy"),W=Symbol.for("react.offscreen"),F=Symbol.iterator;function te(s){return s===null||typeof s!="object"?null:(s=F&&s[F]||s["@@iterator"],typeof s=="function"?s:null)}var U=Object.assign,H;function Q(s){if(H===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);H=o&&o[1]||""}return`
`+H+s}var ee=!1;function G(s,o){if(!s||ee)return"";ee=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(Ne){var h=Ne}Reflect.construct(s,[],o)}else{try{o.call()}catch(Ne){h=Ne}s.call(o.prototype)}else{try{throw Error()}catch(Ne){h=Ne}s()}}catch(Ne){if(Ne&&h&&typeof Ne.stack=="string"){for(var b=Ne.stack.split(`
`),C=h.stack.split(`
`),R=b.length-1,re=C.length-1;1<=R&&0<=re&&b[R]!==C[re];)re--;for(;1<=R&&0<=re;R--,re--)if(b[R]!==C[re]){if(R!==1||re!==1)do if(R--,re--,0>re||b[R]!==C[re]){var fe=`
`+b[R].replace(" at new "," at ");return s.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",s.displayName)),fe}while(1<=R&&0<=re);break}}}finally{ee=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?Q(s):""}function V(s){switch(s.tag){case 5:return Q(s.type);case 16:return Q("Lazy");case 13:return Q("Suspense");case 19:return Q("SuspenseList");case 0:case 2:case 15:return s=G(s.type,!1),s;case 11:return s=G(s.type.render,!1),s;case 1:return s=G(s.type,!0),s;default:return""}}function Z(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case k:return"Portal";case B:return"Profiler";case $:return"StrictMode";case ue:return"Suspense";case z:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case K:return(s.displayName||"Context")+".Consumer";case q:return(s._context.displayName||"Context")+".Provider";case ne:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case X:return o=s.displayName||null,o!==null?o:Z(s.type)||"Memo";case Y:o=s._payload,s=s._init;try{return Z(s(o))}catch{}}return null}function de(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Z(o);case 8:return o===$?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function pe(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function le(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function ge(s){var o=le(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),h=""+s[o];if(!s.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var b=c.get,C=c.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return b.call(this)},set:function(R){h=""+R,C.call(this,R)}}),Object.defineProperty(s,o,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(R){h=""+R},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function He(s){s._valueTracker||(s._valueTracker=ge(s))}function lt(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return s&&(h=le(s)?s.checked?"true":"false":s.value),s=h,s!==c?(o.setValue(s),!0):!1}function Ye(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Se(s,o){var c=o.checked;return U({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??s._wrapperState.initialChecked})}function Re(s,o){var c=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;c=pe(o.value!=null?o.value:c),s._wrapperState={initialChecked:h,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Ce(s,o){o=o.checked,o!=null&&T(s,"checked",o,!1)}function Fe(s,o){Ce(s,o);var c=pe(o.value),h=o.type;if(c!=null)h==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+c):s.value!==""+c&&(s.value=""+c);else if(h==="submit"||h==="reset"){s.removeAttribute("value");return}o.hasOwnProperty("value")?Ke(s,o.type,c):o.hasOwnProperty("defaultValue")&&Ke(s,o.type,pe(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(s.defaultChecked=!!o.defaultChecked)}function Ve(s,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+s._wrapperState.initialValue,c||o===s.value||(s.value=o),s.defaultValue=o}c=s.name,c!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,c!==""&&(s.name=c)}function Ke(s,o,c){(o!=="number"||Ye(s.ownerDocument)!==s)&&(c==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+c&&(s.defaultValue=""+c))}var tt=Array.isArray;function J(s,o,c,h){if(s=s.options,o){o={};for(var b=0;b<c.length;b++)o["$"+c[b]]=!0;for(c=0;c<s.length;c++)b=o.hasOwnProperty("$"+s[c].value),s[c].selected!==b&&(s[c].selected=b),b&&h&&(s[c].defaultSelected=!0)}else{for(c=""+pe(c),o=null,b=0;b<s.length;b++){if(s[b].value===c){s[b].selected=!0,h&&(s[b].defaultSelected=!0);return}o!==null||s[b].disabled||(o=s[b])}o!==null&&(o.selected=!0)}}function Pe(s,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return U({},o,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function $e(s,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(n(92));if(tt(c)){if(1<c.length)throw Error(n(93));c=c[0]}o=c}o==null&&(o=""),c=o}s._wrapperState={initialValue:pe(c)}}function rt(s,o){var c=pe(o.value),h=pe(o.defaultValue);c!=null&&(c=""+c,c!==s.value&&(s.value=c),o.defaultValue==null&&s.defaultValue!==c&&(s.defaultValue=c)),h!=null&&(s.defaultValue=""+h)}function wt(s){var o=s.textContent;o===s._wrapperState.initialValue&&o!==""&&o!==null&&(s.value=o)}function en(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ye(s,o){return s==null||s==="http://www.w3.org/1999/xhtml"?en(o):s==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var we,ke=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,h,b){MSApp.execUnsafeLocalFunction(function(){return s(o,c,h,b)})}:s}(function(s,o){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=o;else{for(we=we||document.createElement("div"),we.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=we.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;o.firstChild;)s.appendChild(o.firstChild)}});function Oe(s,o){if(o){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=o;return}}s.textContent=o}var Xe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ie=["Webkit","ms","Moz","O"];Object.keys(Xe).forEach(function(s){Ie.forEach(function(o){o=o+s.charAt(0).toUpperCase()+s.substring(1),Xe[o]=Xe[s]})});function nt(s,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||Xe.hasOwnProperty(s)&&Xe[s]?(""+o).trim():o+"px"}function xt(s,o){s=s.style;for(var c in o)if(o.hasOwnProperty(c)){var h=c.indexOf("--")===0,b=nt(c,o[c],h);c==="float"&&(c="cssFloat"),h?s.setProperty(c,b):s[c]=b}}var Ot=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ft(s,o){if(o){if(Ot[s]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,s));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function dt(s,o){if(s.indexOf("-")===-1)return typeof o.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=null;function gt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var kt=null,vn=null,Jt=null;function Mn(s){if(s=Hr(s)){if(typeof kt!="function")throw Error(n(280));var o=s.stateNode;o&&(o=hu(o),kt(s.stateNode,s.type,o))}}function Yn(s){vn?Jt?Jt.push(s):Jt=[s]:vn=s}function yn(){if(vn){var s=vn,o=Jt;if(Jt=vn=null,Mn(s),o)for(s=0;s<o.length;s++)Mn(o[s])}}function $t(s,o){return s(o)}function Lt(){}var xn=!1;function Ut(s,o,c){if(xn)return s(o,c);xn=!0;try{return $t(s,o,c)}finally{xn=!1,(vn!==null||Jt!==null)&&(Lt(),yn())}}function Pt(s,o){var c=s.stateNode;if(c===null)return null;var h=hu(c);if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var mn=!1;if(d)try{var ns={};Object.defineProperty(ns,"passive",{get:function(){mn=!0}}),window.addEventListener("test",ns,ns),window.removeEventListener("test",ns,ns)}catch{mn=!1}function er(s,o,c,h,b,C,R,re,fe){var Ne=Array.prototype.slice.call(arguments,3);try{o.apply(c,Ne)}catch(ze){this.onError(ze)}}var An=!1,us=null,Kt=!1,Qn=null,zr={onError:function(s){An=!0,us=s}};function go(s,o,c,h,b,C,R,re,fe){An=!1,us=null,er.apply(zr,arguments)}function tr(s,o,c,h,b,C,R,re,fe){if(go.apply(this,arguments),An){if(An){var Ne=us;An=!1,us=null}else throw Error(n(198));Kt||(Kt=!0,Qn=Ne)}}function Is(s){var o=s,c=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,o.flags&4098&&(c=o.return),s=o.return;while(s)}return o.tag===3?c:null}function La(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function Da(s){if(Is(s)!==s)throw Error(n(188))}function ra(s){var o=s.alternate;if(!o){if(o=Is(s),o===null)throw Error(n(188));return o!==s?null:s}for(var c=s,h=o;;){var b=c.return;if(b===null)break;var C=b.alternate;if(C===null){if(h=b.return,h!==null){c=h;continue}break}if(b.child===C.child){for(C=b.child;C;){if(C===c)return Da(b),s;if(C===h)return Da(b),o;C=C.sibling}throw Error(n(188))}if(c.return!==h.return)c=b,h=C;else{for(var R=!1,re=b.child;re;){if(re===c){R=!0,c=b,h=C;break}if(re===h){R=!0,h=b,c=C;break}re=re.sibling}if(!R){for(re=C.child;re;){if(re===c){R=!0,c=C,h=b;break}if(re===h){R=!0,h=C,c=b;break}re=re.sibling}if(!R)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:o}function Rr(s){return s=ra(s),s!==null?aa(s):null}function aa(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=aa(s);if(o!==null)return o;s=s.sibling}return null}var oa=t.unstable_scheduleCallback,ia=t.unstable_cancelCallback,Ee=t.unstable_shouldYield,Qe=t.unstable_requestPaint,Je=t.unstable_now,un=t.unstable_getCurrentPriorityLevel,At=t.unstable_ImmediatePriority,ds=t.unstable_UserBlockingPriority,tn=t.unstable_NormalPriority,En=t.unstable_LowPriority,gn=t.unstable_IdlePriority,ss=null,Vt=null;function fn(s){if(Vt&&typeof Vt.onCommitFiberRoot=="function")try{Vt.onCommitFiberRoot(ss,s,void 0,(s.current.flags&128)===128)}catch{}}var On=Math.clz32?Math.clz32:bs,la=Math.log,Fr=Math.LN2;function bs(s){return s>>>=0,s===0?32:31-(la(s)/Fr|0)|0}var Sr=64,xs=4194304;function nr(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function Ir(s,o){var c=s.pendingLanes;if(c===0)return 0;var h=0,b=s.suspendedLanes,C=s.pingedLanes,R=c&268435455;if(R!==0){var re=R&~b;re!==0?h=nr(re):(C&=R,C!==0&&(h=nr(C)))}else R=c&~b,R!==0?h=nr(R):C!==0&&(h=nr(C));if(h===0)return 0;if(o!==0&&o!==h&&!(o&b)&&(b=h&-h,C=o&-o,b>=C||b===16&&(C&4194240)!==0))return o;if(h&4&&(h|=c&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=h;0<o;)c=31-On(o),b=1<<c,h|=s[c],o&=~b;return h}function _o(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ca(s,o){for(var c=s.suspendedLanes,h=s.pingedLanes,b=s.expirationTimes,C=s.pendingLanes;0<C;){var R=31-On(C),re=1<<R,fe=b[R];fe===-1?(!(re&c)||re&h)&&(b[R]=_o(re,o)):fe<=o&&(s.expiredLanes|=re),C&=~re}}function ua(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function da(){var s=Sr;return Sr<<=1,!(Sr&4194240)&&(Sr=64),s}function ci(s){for(var o=[],c=0;31>c;c++)o.push(s);return o}function vo(s,o,c){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-On(o),s[o]=c}function Vc(s,o){var c=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var h=s.eventTimes;for(s=s.expirationTimes;0<c;){var b=31-On(c),C=1<<b;o[b]=0,h[b]=-1,s[b]=-1,c&=~C}}function gl(s,o){var c=s.entangledLanes|=o;for(s=s.entanglements;c;){var h=31-On(c),b=1<<h;b&o|s[h]&o&&(s[h]|=o),c&=~b}}var Yt=0;function Wc(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var _l,ui,vl,yl,oe,Me=!1,je=[],Ge=null,qe=null,Le=null,_t=new Map,it=new Map,jt=[],Et="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nt(s,o){switch(s){case"focusin":case"focusout":Ge=null;break;case"dragenter":case"dragleave":qe=null;break;case"mouseover":case"mouseout":Le=null;break;case"pointerover":case"pointerout":_t.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":it.delete(o.pointerId)}}function It(s,o,c,h,b,C){return s===null||s.nativeEvent!==C?(s={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:C,targetContainers:[b]},o!==null&&(o=Hr(o),o!==null&&ui(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,b!==null&&o.indexOf(b)===-1&&o.push(b),s)}function rs(s,o,c,h,b){switch(o){case"focusin":return Ge=It(Ge,s,o,c,h,b),!0;case"dragenter":return qe=It(qe,s,o,c,h,b),!0;case"mouseover":return Le=It(Le,s,o,c,h,b),!0;case"pointerover":var C=b.pointerId;return _t.set(C,It(_t.get(C)||null,s,o,c,h,b)),!0;case"gotpointercapture":return C=b.pointerId,it.set(C,It(it.get(C)||null,s,o,c,h,b)),!0}return!1}function wn(s){var o=Wa(s.target);if(o!==null){var c=Is(o);if(c!==null){if(o=c.tag,o===13){if(o=La(c),o!==null){s.blockedOn=o,oe(s.priority,function(){vl(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function as(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var c=di(s.domEventName,s.eventSystemFlags,o[0],s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);Tt=h,c.target.dispatchEvent(h),Tt=null}else return o=Hr(c),o!==null&&ui(o),s.blockedOn=c,!1;o.shift()}return!0}function za(s,o,c){as(s)&&c.delete(o)}function ma(){Me=!1,Ge!==null&&as(Ge)&&(Ge=null),qe!==null&&as(qe)&&(qe=null),Le!==null&&as(Le)&&(Le=null),_t.forEach(za),it.forEach(za)}function ws(s,o){s.blockedOn===o&&(s.blockedOn=null,Me||(Me=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,ma)))}function sr(s){function o(b){return ws(b,s)}if(0<je.length){ws(je[0],s);for(var c=1;c<je.length;c++){var h=je[c];h.blockedOn===s&&(h.blockedOn=null)}}for(Ge!==null&&ws(Ge,s),qe!==null&&ws(qe,s),Le!==null&&ws(Le,s),_t.forEach(o),it.forEach(o),c=0;c<jt.length;c++)h=jt[c],h.blockedOn===s&&(h.blockedOn=null);for(;0<jt.length&&(c=jt[0],c.blockedOn===null);)wn(c),c.blockedOn===null&&jt.shift()}var Bs=j.ReactCurrentBatchConfig,js=!0;function Cr(s,o,c,h){var b=Yt,C=Bs.transition;Bs.transition=null;try{Yt=1,yo(s,o,c,h)}finally{Yt=b,Bs.transition=C}}function bl(s,o,c,h){var b=Yt,C=Bs.transition;Bs.transition=null;try{Yt=4,yo(s,o,c,h)}finally{Yt=b,Bs.transition=C}}function yo(s,o,c,h){if(js){var b=di(s,o,c,h);if(b===null)ms(s,o,h,bo,c),Nt(s,h);else if(rs(b,s,o,c,h))h.stopPropagation();else if(Nt(s,h),o&4&&-1<Et.indexOf(s)){for(;b!==null;){var C=Hr(b);if(C!==null&&_l(C),C=di(s,o,c,h),C===null&&ms(s,o,h,bo,c),C===b)break;b=C}b!==null&&h.stopPropagation()}else ms(s,o,h,null,c)}}var bo=null;function di(s,o,c,h){if(bo=null,s=gt(h),s=Wa(s),s!==null)if(o=Is(s),o===null)s=null;else if(c=o.tag,c===13){if(s=La(o),s!==null)return s;s=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null);return bo=s,null}function mi(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(un()){case At:return 1;case ds:return 4;case tn:case En:return 16;case gn:return 536870912;default:return 16}default:return 16}}var Br=null,xl=null,Ra=null;function fi(){if(Ra)return Ra;var s,o=xl,c=o.length,h,b="value"in Br?Br.value:Br.textContent,C=b.length;for(s=0;s<c&&o[s]===b[s];s++);var R=c-s;for(h=1;h<=R&&o[c-h]===b[C-h];h++);return Ra=b.slice(s,1<h?1-h:void 0)}function Dn(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function xo(){return!0}function Kc(){return!1}function Ns(s){function o(c,h,b,C,R){this._reactName=c,this._targetInst=b,this.type=h,this.nativeEvent=C,this.target=R,this.currentTarget=null;for(var re in s)s.hasOwnProperty(re)&&(c=s[re],this[re]=c?c(C):C[re]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?xo:Kc,this.isPropagationStopped=Kc,this}return U(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=xo)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=xo)},persist:function(){},isPersistent:xo}),o}var Fa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},kn=Ns(Fa),Gn=U({},Fa,{view:0,detail:0}),Er=Ns(Gn),wl,Fd,jl,Yc=U({},Gn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ia,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==jl&&(jl&&s.type==="mousemove"?(wl=s.screenX-jl.screenX,Fd=s.screenY-jl.screenY):Fd=wl=0,jl=s),wl)},movementY:function(s){return"movementY"in s?s.movementY:Fd}}),Qc=Ns(Yc),Id=U({},Yc,{dataTransfer:0}),Gc=Ns(Id),Bd=U({},Gn,{relatedTarget:0}),Xc=Ns(Bd),th=U({},Fa,{animationName:0,elapsedTime:0,pseudoElement:0}),nh=Ns(th),sh=U({},Fa,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Jc=Ns(sh),_e=U({},Fa,{data:0}),Be=Ns(_e),fa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},__={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function v_(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=__[s])?!!o[s]:!1}function Ia(){return v_}var ah=U({},Gn,{key:function(s){if(s.key){var o=fa[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Dn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?rh[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ia,charCode:function(s){return s.type==="keypress"?Dn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Dn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),oh=Ns(ah),Pn=U({},Yc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ba=Ns(Pn),hi=U({},Gn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ia}),Zc=Ns(hi),Ua=U({},Fa,{propertyName:0,elapsedTime:0,pseudoElement:0}),y_=Ns(Ua),b_=U({},Yc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),x_=Ns(b_),wo=[9,13,27,32],Nl=d&&"CompositionEvent"in window,pi=null;d&&"documentMode"in document&&(pi=document.documentMode);var ih=d&&"TextEvent"in window&&!pi,Ud=d&&(!Nl||pi&&8<pi&&11>=pi),gi=" ",qd=!1;function Hd(s,o){switch(s){case"keyup":return wo.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Sl(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var ha=!1;function jo(s,o){switch(s){case"compositionend":return Sl(o);case"keypress":return o.which!==32?null:(qd=!0,gi);case"textInput":return s=o.data,s===gi&&qd?null:s;default:return null}}function Vd(s,o){if(ha)return s==="compositionend"||!Nl&&Hd(s,o)?(s=fi(),Ra=xl=Br=null,ha=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Ud&&o.locale!=="ko"?null:o.data;default:return null}}var vt={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cl(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!vt[s.type]:o==="textarea"}function El(s,o,c,h){Yn(h),o=ir(o,"onChange"),0<o.length&&(c=new kn("onChange","change",null,c,h),s.push({event:c,listeners:o}))}var kl=null,nn=null;function eu(s){fh(s,0)}function No(s){var o=Xn(s);if(lt(o))return s}function tu(s,o){if(s==="change")return o}var So=!1;if(d){var _i;if(d){var rr="oninput"in document;if(!rr){var Ml=document.createElement("div");Ml.setAttribute("oninput","return;"),rr=typeof Ml.oninput=="function"}_i=rr}else _i=!1;So=_i&&(!document.documentMode||9<document.documentMode)}function Al(){kl&&(kl.detachEvent("onpropertychange",Ol),nn=kl=null)}function Ol(s){if(s.propertyName==="value"&&No(nn)){var o=[];El(o,nn,s,gt(s)),Ut(eu,o)}}function lh(s,o,c){s==="focusin"?(Al(),kl=o,nn=c,kl.attachEvent("onpropertychange",Ol)):s==="focusout"&&Al()}function Wd(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return No(nn)}function w_(s,o){if(s==="click")return No(o)}function j_(s,o){if(s==="input"||s==="change")return No(o)}function ch(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var ar=typeof Object.is=="function"?Object.is:ch;function vi(s,o){if(ar(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var c=Object.keys(s),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var b=c[h];if(!m.call(o,b)||!ar(s[b],o[b]))return!1}return!0}function Co(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function Kd(s,o){var c=Co(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=o&&h>=o)return{node:c,offset:o-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Co(c)}}function Yd(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Yd(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function pa(){for(var s=window,o=Ye();o instanceof s.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)s=o.contentWindow;else break;o=Ye(s.document)}return o}function nu(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function N_(s){var o=pa(),c=s.focusedElem,h=s.selectionRange;if(o!==c&&c&&c.ownerDocument&&Yd(c.ownerDocument.documentElement,c)){if(h!==null&&nu(c)){if(o=h.start,s=h.end,s===void 0&&(s=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(s,c.value.length);else if(s=(o=c.ownerDocument||document)&&o.defaultView||window,s.getSelection){s=s.getSelection();var b=c.textContent.length,C=Math.min(h.start,b);h=h.end===void 0?C:Math.min(h.end,b),!s.extend&&C>h&&(b=h,h=C,C=b),b=Kd(c,C);var R=Kd(c,h);b&&R&&(s.rangeCount!==1||s.anchorNode!==b.node||s.anchorOffset!==b.offset||s.focusNode!==R.node||s.focusOffset!==R.offset)&&(o=o.createRange(),o.setStart(b.node,b.offset),s.removeAllRanges(),C>h?(s.addRange(o),s.extend(R.node,R.offset)):(o.setEnd(R.node,R.offset),s.addRange(o)))}}for(o=[],s=c;s=s.parentNode;)s.nodeType===1&&o.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)s=o[c],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var su=d&&"documentMode"in document&&11>=document.documentMode,Eo=null,Qd=null,Pl=null,Gd=!1;function ru(s,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Gd||Eo==null||Eo!==Ye(h)||(h=Eo,"selectionStart"in h&&nu(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Pl&&vi(Pl,h)||(Pl=h,h=ir(Qd,"onSelect"),0<h.length&&(o=new kn("onSelect","select",null,o,c),s.push({event:o,listeners:h}),o.target=Eo)))}function au(s,o){var c={};return c[s.toLowerCase()]=o.toLowerCase(),c["Webkit"+s]="webkit"+o,c["Moz"+s]="moz"+o,c}var yi={animationend:au("Animation","AnimationEnd"),animationiteration:au("Animation","AnimationIteration"),animationstart:au("Animation","AnimationStart"),transitionend:au("Transition","TransitionEnd")},Tl={},qa={};d&&(qa=document.createElement("div").style,"AnimationEvent"in window||(delete yi.animationend.animation,delete yi.animationiteration.animation,delete yi.animationstart.animation),"TransitionEvent"in window||delete yi.transitionend.transition);function ko(s){if(Tl[s])return Tl[s];if(!yi[s])return s;var o=yi[s],c;for(c in o)if(o.hasOwnProperty(c)&&c in qa)return Tl[s]=o[c];return s}var uh=ko("animationend"),ou=ko("animationiteration"),bi=ko("animationstart"),dh=ko("transitionend"),mh=new Map,iu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function or(s,o){mh.set(s,o),l(o,[s])}for(var Xd=0;Xd<iu.length;Xd++){var Jd=iu[Xd],Zd=Jd.toLowerCase(),em=Jd[0].toUpperCase()+Jd.slice(1);or(Zd,"on"+em)}or(uh,"onAnimationEnd"),or(ou,"onAnimationIteration"),or(bi,"onAnimationStart"),or("dblclick","onDoubleClick"),or("focusin","onFocus"),or("focusout","onBlur"),or(dh,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),S_=new Set("cancel close invalid load scroll toggle".split(" ").concat($l));function lu(s,o,c){var h=s.type||"unknown-event";s.currentTarget=c,tr(h,o,void 0,s),s.currentTarget=null}function fh(s,o){o=(o&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],b=h.event;h=h.listeners;e:{var C=void 0;if(o)for(var R=h.length-1;0<=R;R--){var re=h[R],fe=re.instance,Ne=re.currentTarget;if(re=re.listener,fe!==C&&b.isPropagationStopped())break e;lu(b,re,Ne),C=fe}else for(R=0;R<h.length;R++){if(re=h[R],fe=re.instance,Ne=re.currentTarget,re=re.listener,fe!==C&&b.isPropagationStopped())break e;lu(b,re,Ne),C=fe}}}if(Kt)throw s=Qn,Kt=!1,Qn=null,s}function sn(s,o){var c=o[zn];c===void 0&&(c=o[zn]=new Set);var h=s+"__bubble";c.has(h)||(uu(o,s,2,!1),c.add(h))}function cu(s,o,c){var h=0;o&&(h|=4),uu(c,s,h,o)}var Ll="_reactListening"+Math.random().toString(36).slice(2);function Dl(s){if(!s[Ll]){s[Ll]=!0,r.forEach(function(c){c!=="selectionchange"&&(S_.has(c)||cu(c,!1,s),cu(c,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Ll]||(o[Ll]=!0,cu("selectionchange",!1,o))}}function uu(s,o,c,h){switch(mi(o)){case 1:var b=Cr;break;case 4:b=bl;break;default:b=yo}c=b.bind(null,o,c,s),b=void 0,!mn||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(b=!0),h?b!==void 0?s.addEventListener(o,c,{capture:!0,passive:b}):s.addEventListener(o,c,!0):b!==void 0?s.addEventListener(o,c,{passive:b}):s.addEventListener(o,c,!1)}function ms(s,o,c,h,b){var C=h;if(!(o&1)&&!(o&2)&&h!==null)e:for(;;){if(h===null)return;var R=h.tag;if(R===3||R===4){var re=h.stateNode.containerInfo;if(re===b||re.nodeType===8&&re.parentNode===b)break;if(R===4)for(R=h.return;R!==null;){var fe=R.tag;if((fe===3||fe===4)&&(fe=R.stateNode.containerInfo,fe===b||fe.nodeType===8&&fe.parentNode===b))return;R=R.return}for(;re!==null;){if(R=Wa(re),R===null)return;if(fe=R.tag,fe===5||fe===6){h=C=R;continue e}re=re.parentNode}}h=h.return}Ut(function(){var Ne=C,ze=gt(c),Ue=[];e:{var De=mh.get(s);if(De!==void 0){var st=kn,ot=s;switch(s){case"keypress":if(Dn(c)===0)break e;case"keydown":case"keyup":st=oh;break;case"focusin":ot="focus",st=Xc;break;case"focusout":ot="blur",st=Xc;break;case"beforeblur":case"afterblur":st=Xc;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":st=Qc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":st=Gc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":st=Zc;break;case uh:case ou:case bi:st=nh;break;case dh:st=y_;break;case"scroll":st=Er;break;case"wheel":st=x_;break;case"copy":case"cut":case"paste":st=Jc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":st=Ba}var ut=(o&4)!==0,Hn=!ut&&s==="scroll",ve=ut?De!==null?De+"Capture":null:De;ut=[];for(var he=Ne,xe;he!==null;){xe=he;var We=xe.stateNode;if(xe.tag===5&&We!==null&&(xe=We,ve!==null&&(We=Pt(he,ve),We!=null&&ut.push(zl(he,We,xe)))),Hn)break;he=he.return}0<ut.length&&(De=new st(De,ot,null,c,ze),Ue.push({event:De,listeners:ut}))}}if(!(o&7)){e:{if(De=s==="mouseover"||s==="pointerover",st=s==="mouseout"||s==="pointerout",De&&c!==Tt&&(ot=c.relatedTarget||c.fromElement)&&(Wa(ot)||ot[qr]))break e;if((st||De)&&(De=ze.window===ze?ze:(De=ze.ownerDocument)?De.defaultView||De.parentWindow:window,st?(ot=c.relatedTarget||c.toElement,st=Ne,ot=ot?Wa(ot):null,ot!==null&&(Hn=Is(ot),ot!==Hn||ot.tag!==5&&ot.tag!==6)&&(ot=null)):(st=null,ot=Ne),st!==ot)){if(ut=Qc,We="onMouseLeave",ve="onMouseEnter",he="mouse",(s==="pointerout"||s==="pointerover")&&(ut=Ba,We="onPointerLeave",ve="onPointerEnter",he="pointer"),Hn=st==null?De:Xn(st),xe=ot==null?De:Xn(ot),De=new ut(We,he+"leave",st,c,ze),De.target=Hn,De.relatedTarget=xe,We=null,Wa(ze)===Ne&&(ut=new ut(ve,he+"enter",ot,c,ze),ut.target=xe,ut.relatedTarget=Hn,We=ut),Hn=We,st&&ot)t:{for(ut=st,ve=ot,he=0,xe=ut;xe;xe=kr(xe))he++;for(xe=0,We=ve;We;We=kr(We))xe++;for(;0<he-xe;)ut=kr(ut),he--;for(;0<xe-he;)ve=kr(ve),xe--;for(;he--;){if(ut===ve||ve!==null&&ut===ve.alternate)break t;ut=kr(ut),ve=kr(ve)}ut=null}else ut=null;st!==null&&tm(Ue,De,st,ut,!1),ot!==null&&Hn!==null&&tm(Ue,Hn,ot,ut,!0)}}e:{if(De=Ne?Xn(Ne):window,st=De.nodeName&&De.nodeName.toLowerCase(),st==="select"||st==="input"&&De.type==="file")var ft=tu;else if(Cl(De))if(So)ft=j_;else{ft=Wd;var yt=lh}else(st=De.nodeName)&&st.toLowerCase()==="input"&&(De.type==="checkbox"||De.type==="radio")&&(ft=w_);if(ft&&(ft=ft(s,Ne))){El(Ue,ft,c,ze);break e}yt&&yt(s,De,Ne),s==="focusout"&&(yt=De._wrapperState)&&yt.controlled&&De.type==="number"&&Ke(De,"number",De.value)}switch(yt=Ne?Xn(Ne):window,s){case"focusin":(Cl(yt)||yt.contentEditable==="true")&&(Eo=yt,Qd=Ne,Pl=null);break;case"focusout":Pl=Qd=Eo=null;break;case"mousedown":Gd=!0;break;case"contextmenu":case"mouseup":case"dragend":Gd=!1,ru(Ue,c,ze);break;case"selectionchange":if(su)break;case"keydown":case"keyup":ru(Ue,c,ze)}var bt;if(Nl)e:{switch(s){case"compositionstart":var Ct="onCompositionStart";break e;case"compositionend":Ct="onCompositionEnd";break e;case"compositionupdate":Ct="onCompositionUpdate";break e}Ct=void 0}else ha?Hd(s,c)&&(Ct="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Ct="onCompositionStart");Ct&&(Ud&&c.locale!=="ko"&&(ha||Ct!=="onCompositionStart"?Ct==="onCompositionEnd"&&ha&&(bt=fi()):(Br=ze,xl="value"in Br?Br.value:Br.textContent,ha=!0)),yt=ir(Ne,Ct),0<yt.length&&(Ct=new Be(Ct,s,null,c,ze),Ue.push({event:Ct,listeners:yt}),bt?Ct.data=bt:(bt=Sl(c),bt!==null&&(Ct.data=bt)))),(bt=ih?jo(s,c):Vd(s,c))&&(Ne=ir(Ne,"onBeforeInput"),0<Ne.length&&(ze=new Be("onBeforeInput","beforeinput",null,c,ze),Ue.push({event:ze,listeners:Ne}),ze.data=bt))}fh(Ue,o)})}function zl(s,o,c){return{instance:s,listener:o,currentTarget:c}}function ir(s,o){for(var c=o+"Capture",h=[];s!==null;){var b=s,C=b.stateNode;b.tag===5&&C!==null&&(b=C,C=Pt(s,c),C!=null&&h.unshift(zl(s,C,b)),C=Pt(s,o),C!=null&&h.push(zl(s,C,b))),s=s.return}return h}function kr(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function tm(s,o,c,h,b){for(var C=o._reactName,R=[];c!==null&&c!==h;){var re=c,fe=re.alternate,Ne=re.stateNode;if(fe!==null&&fe===h)break;re.tag===5&&Ne!==null&&(re=Ne,b?(fe=Pt(c,C),fe!=null&&R.unshift(zl(c,fe,re))):b||(fe=Pt(c,C),fe!=null&&R.push(zl(c,fe,re)))),c=c.return}R.length!==0&&s.push({event:o,listeners:R})}var C_=/\r\n?/g,hh=/\u0000|\uFFFD/g;function ph(s){return(typeof s=="string"?s:""+s).replace(C_,`
`).replace(hh,"")}function du(s,o,c){if(o=ph(o),ph(s)!==o&&c)throw Error(n(425))}function Rl(){}var nm=null,Mt=null;function mu(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Fl=typeof setTimeout=="function"?setTimeout:void 0,E_=typeof clearTimeout=="function"?clearTimeout:void 0,gh=typeof Promise=="function"?Promise:void 0,k_=typeof queueMicrotask=="function"?queueMicrotask:typeof gh<"u"?function(s){return gh.resolve(null).then(s).catch(Il)}:Fl;function Il(s){setTimeout(function(){throw s})}function sm(s,o){var c=o,h=0;do{var b=c.nextSibling;if(s.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(h===0){s.removeChild(b),sr(o);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=b}while(c);sr(o)}function Ha(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return s}function rm(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return s;o--}else c==="/$"&&o++}s=s.previousSibling}return null}var lr=Math.random().toString(36).slice(2),Ur="__reactFiber$"+lr,Va="__reactProps$"+lr,qr="__reactContainer$"+lr,zn="__reactEvents$"+lr,M_="__reactListeners$"+lr,fu="__reactHandles$"+lr;function Wa(s){var o=s[Ur];if(o)return o;for(var c=s.parentNode;c;){if(o=c[qr]||c[Ur]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(s=rm(s);s!==null;){if(c=s[Ur])return c;s=rm(s)}return o}s=c,c=s.parentNode}return null}function Hr(s){return s=s[Ur]||s[qr],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Xn(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(n(33))}function hu(s){return s[Va]||null}var xi=[],Mo=-1;function Ka(s){return{current:s}}function rn(s){0>Mo||(s.current=xi[Mo],xi[Mo]=null,Mo--)}function Gt(s,o){Mo++,xi[Mo]=s.current,s.current=o}var Vr={},fs=Ka(Vr),an=Ka(!1),Ya=Vr;function wi(s,o){var c=s.type.contextTypes;if(!c)return Vr;var h=s.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var b={},C;for(C in c)b[C]=o[C];return h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=b),b}function Tn(s){return s=s.childContextTypes,s!=null}function pu(){rn(an),rn(fs)}function am(s,o,c){if(fs.current!==Vr)throw Error(n(168));Gt(fs,o),Gt(an,c)}function gu(s,o,c){var h=s.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var b in h)if(!(b in o))throw Error(n(108,de(s)||"Unknown",b));return U({},c,h)}function _u(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Vr,Ya=fs.current,Gt(fs,s),Gt(an,an.current),!0}function _h(s,o,c){var h=s.stateNode;if(!h)throw Error(n(169));c?(s=gu(s,o,Ya),h.__reactInternalMemoizedMergedChildContext=s,rn(an),rn(fs),Gt(fs,s)):rn(an),Gt(an,c)}var ga=null,vu=!1,om=!1;function vh(s){ga===null?ga=[s]:ga.push(s)}function A_(s){vu=!0,vh(s)}function Qa(){if(!om&&ga!==null){om=!0;var s=0,o=Yt;try{var c=ga;for(Yt=1;s<c.length;s++){var h=c[s];do h=h(!0);while(h!==null)}ga=null,vu=!1}catch(b){throw ga!==null&&(ga=ga.slice(s+1)),oa(At,Qa),b}finally{Yt=o,om=!1}}return null}var ji=[],Ni=0,yu=null,bu=0,cr=[],ur=0,Ao=null,_a=1,va="";function Oo(s,o){ji[Ni++]=bu,ji[Ni++]=yu,yu=s,bu=o}function yh(s,o,c){cr[ur++]=_a,cr[ur++]=va,cr[ur++]=Ao,Ao=s;var h=_a;s=va;var b=32-On(h)-1;h&=~(1<<b),c+=1;var C=32-On(o)+b;if(30<C){var R=b-b%5;C=(h&(1<<R)-1).toString(32),h>>=R,b-=R,_a=1<<32-On(o)+b|c<<b|h,va=C+s}else _a=1<<C|c<<b|h,va=s}function im(s){s.return!==null&&(Oo(s,1),yh(s,1,0))}function lm(s){for(;s===yu;)yu=ji[--Ni],ji[Ni]=null,bu=ji[--Ni],ji[Ni]=null;for(;s===Ao;)Ao=cr[--ur],cr[ur]=null,va=cr[--ur],cr[ur]=null,_a=cr[--ur],cr[ur]=null}var Us=null,qs=null,bn=!1,dr=null;function xu(s,o){var c=ae(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=s,o=s.deletions,o===null?(s.deletions=[c],s.flags|=16):o.push(c)}function bh(s,o){switch(s.tag){case 5:var c=s.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(s.stateNode=o,Us=s,qs=Ha(o.firstChild),!0):!1;case 6:return o=s.pendingProps===""||o.nodeType!==3?null:o,o!==null?(s.stateNode=o,Us=s,qs=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=Ao!==null?{id:_a,overflow:va}:null,s.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=ae(18,null,null,0),c.stateNode=o,c.return=s,s.child=c,Us=s,qs=null,!0):!1;default:return!1}}function Bl(s){return(s.mode&1)!==0&&(s.flags&128)===0}function cm(s){if(bn){var o=qs;if(o){var c=o;if(!bh(s,o)){if(Bl(s))throw Error(n(418));o=Ha(c.nextSibling);var h=Us;o&&bh(s,o)?xu(h,c):(s.flags=s.flags&-4097|2,bn=!1,Us=s)}}else{if(Bl(s))throw Error(n(418));s.flags=s.flags&-4097|2,bn=!1,Us=s}}}function xh(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;Us=s}function Mr(s){if(s!==Us)return!1;if(!bn)return xh(s),bn=!0,!1;var o;if((o=s.tag!==3)&&!(o=s.tag!==5)&&(o=s.type,o=o!=="head"&&o!=="body"&&!mu(s.type,s.memoizedProps)),o&&(o=qs)){if(Bl(s))throw wu(),Error(n(418));for(;o;)xu(s,o),o=Ha(o.nextSibling)}if(xh(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"){if(o===0){qs=Ha(s.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}s=s.nextSibling}qs=null}}else qs=Us?Ha(s.stateNode.nextSibling):null;return!0}function wu(){for(var s=qs;s;)s=Ha(s.nextSibling)}function os(){qs=Us=null,bn=!1}function um(s){dr===null?dr=[s]:dr.push(s)}var O_=j.ReactCurrentBatchConfig;function Po(s,o,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(n(309));var h=c.stateNode}if(!h)throw Error(n(147,s));var b=h,C=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===C?o.ref:(o=function(R){var re=b.refs;R===null?delete re[C]:re[C]=R},o._stringRef=C,o)}if(typeof s!="string")throw Error(n(284));if(!c._owner)throw Error(n(290,s))}return s}function ju(s,o){throw s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function wh(s){var o=s._init;return o(s._payload)}function jh(s){function o(ve,he){if(s){var xe=ve.deletions;xe===null?(ve.deletions=[he],ve.flags|=16):xe.push(he)}}function c(ve,he){if(!s)return null;for(;he!==null;)o(ve,he),he=he.sibling;return null}function h(ve,he){for(ve=new Map;he!==null;)he.key!==null?ve.set(he.key,he):ve.set(he.index,he),he=he.sibling;return ve}function b(ve,he){return ve=be(ve,he),ve.index=0,ve.sibling=null,ve}function C(ve,he,xe){return ve.index=xe,s?(xe=ve.alternate,xe!==null?(xe=xe.index,xe<he?(ve.flags|=2,he):xe):(ve.flags|=2,he)):(ve.flags|=1048576,he)}function R(ve){return s&&ve.alternate===null&&(ve.flags|=2),ve}function re(ve,he,xe,We){return he===null||he.tag!==6?(he=zt(xe,ve.mode,We),he.return=ve,he):(he=b(he,xe),he.return=ve,he)}function fe(ve,he,xe,We){var ft=xe.type;return ft===D?ze(ve,he,xe.props.children,We,xe.key):he!==null&&(he.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===Y&&wh(ft)===he.type)?(We=b(he,xe.props),We.ref=Po(ve,he,xe),We.return=ve,We):(We=Te(xe.type,xe.key,xe.props,null,ve.mode,We),We.ref=Po(ve,he,xe),We.return=ve,We)}function Ne(ve,he,xe,We){return he===null||he.tag!==4||he.stateNode.containerInfo!==xe.containerInfo||he.stateNode.implementation!==xe.implementation?(he=_n(xe,ve.mode,We),he.return=ve,he):(he=b(he,xe.children||[]),he.return=ve,he)}function ze(ve,he,xe,We,ft){return he===null||he.tag!==7?(he=ct(xe,ve.mode,We,ft),he.return=ve,he):(he=b(he,xe),he.return=ve,he)}function Ue(ve,he,xe){if(typeof he=="string"&&he!==""||typeof he=="number")return he=zt(""+he,ve.mode,xe),he.return=ve,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case O:return xe=Te(he.type,he.key,he.props,null,ve.mode,xe),xe.ref=Po(ve,null,he),xe.return=ve,xe;case k:return he=_n(he,ve.mode,xe),he.return=ve,he;case Y:var We=he._init;return Ue(ve,We(he._payload),xe)}if(tt(he)||te(he))return he=ct(he,ve.mode,xe,null),he.return=ve,he;ju(ve,he)}return null}function De(ve,he,xe,We){var ft=he!==null?he.key:null;if(typeof xe=="string"&&xe!==""||typeof xe=="number")return ft!==null?null:re(ve,he,""+xe,We);if(typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case O:return xe.key===ft?fe(ve,he,xe,We):null;case k:return xe.key===ft?Ne(ve,he,xe,We):null;case Y:return ft=xe._init,De(ve,he,ft(xe._payload),We)}if(tt(xe)||te(xe))return ft!==null?null:ze(ve,he,xe,We,null);ju(ve,xe)}return null}function st(ve,he,xe,We,ft){if(typeof We=="string"&&We!==""||typeof We=="number")return ve=ve.get(xe)||null,re(he,ve,""+We,ft);if(typeof We=="object"&&We!==null){switch(We.$$typeof){case O:return ve=ve.get(We.key===null?xe:We.key)||null,fe(he,ve,We,ft);case k:return ve=ve.get(We.key===null?xe:We.key)||null,Ne(he,ve,We,ft);case Y:var yt=We._init;return st(ve,he,xe,yt(We._payload),ft)}if(tt(We)||te(We))return ve=ve.get(xe)||null,ze(he,ve,We,ft,null);ju(he,We)}return null}function ot(ve,he,xe,We){for(var ft=null,yt=null,bt=he,Ct=he=0,_s=null;bt!==null&&Ct<xe.length;Ct++){bt.index>Ct?(_s=bt,bt=null):_s=bt.sibling;var Xt=De(ve,bt,xe[Ct],We);if(Xt===null){bt===null&&(bt=_s);break}s&&bt&&Xt.alternate===null&&o(ve,bt),he=C(Xt,he,Ct),yt===null?ft=Xt:yt.sibling=Xt,yt=Xt,bt=_s}if(Ct===xe.length)return c(ve,bt),bn&&Oo(ve,Ct),ft;if(bt===null){for(;Ct<xe.length;Ct++)bt=Ue(ve,xe[Ct],We),bt!==null&&(he=C(bt,he,Ct),yt===null?ft=bt:yt.sibling=bt,yt=bt);return bn&&Oo(ve,Ct),ft}for(bt=h(ve,bt);Ct<xe.length;Ct++)_s=st(bt,ve,Ct,xe[Ct],We),_s!==null&&(s&&_s.alternate!==null&&bt.delete(_s.key===null?Ct:_s.key),he=C(_s,he,Ct),yt===null?ft=_s:yt.sibling=_s,yt=_s);return s&&bt.forEach(function(Fi){return o(ve,Fi)}),bn&&Oo(ve,Ct),ft}function ut(ve,he,xe,We){var ft=te(xe);if(typeof ft!="function")throw Error(n(150));if(xe=ft.call(xe),xe==null)throw Error(n(151));for(var yt=ft=null,bt=he,Ct=he=0,_s=null,Xt=xe.next();bt!==null&&!Xt.done;Ct++,Xt=xe.next()){bt.index>Ct?(_s=bt,bt=null):_s=bt.sibling;var Fi=De(ve,bt,Xt.value,We);if(Fi===null){bt===null&&(bt=_s);break}s&&bt&&Fi.alternate===null&&o(ve,bt),he=C(Fi,he,Ct),yt===null?ft=Fi:yt.sibling=Fi,yt=Fi,bt=_s}if(Xt.done)return c(ve,bt),bn&&Oo(ve,Ct),ft;if(bt===null){for(;!Xt.done;Ct++,Xt=xe.next())Xt=Ue(ve,Xt.value,We),Xt!==null&&(he=C(Xt,he,Ct),yt===null?ft=Xt:yt.sibling=Xt,yt=Xt);return bn&&Oo(ve,Ct),ft}for(bt=h(ve,bt);!Xt.done;Ct++,Xt=xe.next())Xt=st(bt,ve,Ct,Xt.value,We),Xt!==null&&(s&&Xt.alternate!==null&&bt.delete(Xt.key===null?Ct:Xt.key),he=C(Xt,he,Ct),yt===null?ft=Xt:yt.sibling=Xt,yt=Xt);return s&&bt.forEach(function(SL){return o(ve,SL)}),bn&&Oo(ve,Ct),ft}function Hn(ve,he,xe,We){if(typeof xe=="object"&&xe!==null&&xe.type===D&&xe.key===null&&(xe=xe.props.children),typeof xe=="object"&&xe!==null){switch(xe.$$typeof){case O:e:{for(var ft=xe.key,yt=he;yt!==null;){if(yt.key===ft){if(ft=xe.type,ft===D){if(yt.tag===7){c(ve,yt.sibling),he=b(yt,xe.props.children),he.return=ve,ve=he;break e}}else if(yt.elementType===ft||typeof ft=="object"&&ft!==null&&ft.$$typeof===Y&&wh(ft)===yt.type){c(ve,yt.sibling),he=b(yt,xe.props),he.ref=Po(ve,yt,xe),he.return=ve,ve=he;break e}c(ve,yt);break}else o(ve,yt);yt=yt.sibling}xe.type===D?(he=ct(xe.props.children,ve.mode,We,xe.key),he.return=ve,ve=he):(We=Te(xe.type,xe.key,xe.props,null,ve.mode,We),We.ref=Po(ve,he,xe),We.return=ve,ve=We)}return R(ve);case k:e:{for(yt=xe.key;he!==null;){if(he.key===yt)if(he.tag===4&&he.stateNode.containerInfo===xe.containerInfo&&he.stateNode.implementation===xe.implementation){c(ve,he.sibling),he=b(he,xe.children||[]),he.return=ve,ve=he;break e}else{c(ve,he);break}else o(ve,he);he=he.sibling}he=_n(xe,ve.mode,We),he.return=ve,ve=he}return R(ve);case Y:return yt=xe._init,Hn(ve,he,yt(xe._payload),We)}if(tt(xe))return ot(ve,he,xe,We);if(te(xe))return ut(ve,he,xe,We);ju(ve,xe)}return typeof xe=="string"&&xe!==""||typeof xe=="number"?(xe=""+xe,he!==null&&he.tag===6?(c(ve,he.sibling),he=b(he,xe),he.return=ve,ve=he):(c(ve,he),he=zt(xe,ve.mode,We),he.return=ve,ve=he),R(ve)):c(ve,he)}return Hn}var Si=jh(!0),Nh=jh(!1),Nu=Ka(null),Su=null,Ci=null,dm=null;function To(){dm=Ci=Su=null}function Ul(s){var o=Nu.current;rn(Nu),s._currentValue=o}function mm(s,o,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===c)break;s=s.return}}function Ei(s,o){Su=s,dm=Ci=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&o&&(As=!0),s.firstContext=null)}function Ss(s){var o=s._currentValue;if(dm!==s)if(s={context:s,memoizedValue:o,next:null},Ci===null){if(Su===null)throw Error(n(308));Ci=s,Su.dependencies={lanes:0,firstContext:s}}else Ci=Ci.next=s;return o}var $o=null;function ki(s){$o===null?$o=[s]:$o.push(s)}function Lo(s,o,c,h){var b=o.interleaved;return b===null?(c.next=c,ki(o)):(c.next=b.next,b.next=c),o.interleaved=c,ya(s,h)}function ya(s,o){s.lanes|=o;var c=s.alternate;for(c!==null&&(c.lanes|=o),c=s,s=s.return;s!==null;)s.childLanes|=o,c=s.alternate,c!==null&&(c.childLanes|=o),c=s,s=s.return;return c.tag===3?c.stateNode:null}var Ga=!1;function fm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Sh(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function ba(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function xa(s,o,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,Ht&2){var b=h.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),h.pending=o,ya(s,c)}return b=h.interleaved,b===null?(o.next=o,ki(h)):(o.next=b.next,b.next=o),h.interleaved=o,ya(s,c)}function Cu(s,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var h=o.lanes;h&=s.pendingLanes,c|=h,o.lanes=c,gl(s,c)}}function Ch(s,o){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var b=null,C=null;if(c=c.firstBaseUpdate,c!==null){do{var R={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};C===null?b=C=R:C=C.next=R,c=c.next}while(c!==null);C===null?b=C=o:C=C.next=o}else b=C=o;c={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:C,shared:h.shared,effects:h.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=o:s.next=o,c.lastBaseUpdate=o}function Eu(s,o,c,h){var b=s.updateQueue;Ga=!1;var C=b.firstBaseUpdate,R=b.lastBaseUpdate,re=b.shared.pending;if(re!==null){b.shared.pending=null;var fe=re,Ne=fe.next;fe.next=null,R===null?C=Ne:R.next=Ne,R=fe;var ze=s.alternate;ze!==null&&(ze=ze.updateQueue,re=ze.lastBaseUpdate,re!==R&&(re===null?ze.firstBaseUpdate=Ne:re.next=Ne,ze.lastBaseUpdate=fe))}if(C!==null){var Ue=b.baseState;R=0,ze=Ne=fe=null,re=C;do{var De=re.lane,st=re.eventTime;if((h&De)===De){ze!==null&&(ze=ze.next={eventTime:st,lane:0,tag:re.tag,payload:re.payload,callback:re.callback,next:null});e:{var ot=s,ut=re;switch(De=o,st=c,ut.tag){case 1:if(ot=ut.payload,typeof ot=="function"){Ue=ot.call(st,Ue,De);break e}Ue=ot;break e;case 3:ot.flags=ot.flags&-65537|128;case 0:if(ot=ut.payload,De=typeof ot=="function"?ot.call(st,Ue,De):ot,De==null)break e;Ue=U({},Ue,De);break e;case 2:Ga=!0}}re.callback!==null&&re.lane!==0&&(s.flags|=64,De=b.effects,De===null?b.effects=[re]:De.push(re))}else st={eventTime:st,lane:De,tag:re.tag,payload:re.payload,callback:re.callback,next:null},ze===null?(Ne=ze=st,fe=Ue):ze=ze.next=st,R|=De;if(re=re.next,re===null){if(re=b.shared.pending,re===null)break;De=re,re=De.next,De.next=null,b.lastBaseUpdate=De,b.shared.pending=null}}while(!0);if(ze===null&&(fe=Ue),b.baseState=fe,b.firstBaseUpdate=Ne,b.lastBaseUpdate=ze,o=b.shared.interleaved,o!==null){b=o;do R|=b.lane,b=b.next;while(b!==o)}else C===null&&(b.shared.lanes=0);Bo|=R,s.lanes=R,s.memoizedState=Ue}}function Eh(s,o,c){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var h=s[o],b=h.callback;if(b!==null){if(h.callback=null,h=c,typeof b!="function")throw Error(n(191,b));b.call(h)}}}var Jn={},Wr=Ka(Jn),ql=Ka(Jn),Hl=Ka(Jn);function Do(s){if(s===Jn)throw Error(n(174));return s}function hm(s,o){switch(Gt(Hl,o),Gt(ql,s),Gt(Wr,Jn),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ye(null,"");break;default:s=s===8?o.parentNode:o,o=s.namespaceURI||null,s=s.tagName,o=ye(o,s)}rn(Wr),Gt(Wr,o)}function zo(){rn(Wr),rn(ql),rn(Hl)}function kh(s){Do(Hl.current);var o=Do(Wr.current),c=ye(o,s.type);o!==c&&(Gt(ql,s),Gt(Wr,c))}function ku(s){ql.current===s&&(rn(Wr),rn(ql))}var jn=Ka(0);function hn(s){for(var o=s;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Ar=[];function mr(){for(var s=0;s<Ar.length;s++)Ar[s]._workInProgressVersionPrimary=null;Ar.length=0}var fr=j.ReactCurrentDispatcher,Mh=j.ReactCurrentBatchConfig,Ro=0,Nn=null,on=null,Un=null,Mu=!1,Vl=!1,Wl=0,Mi=0;function Zn(){throw Error(n(321))}function pm(s,o){if(o===null)return!1;for(var c=0;c<o.length&&c<s.length;c++)if(!ar(s[c],o[c]))return!1;return!0}function Kl(s,o,c,h,b,C){if(Ro=C,Nn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,fr.current=s===null||s.memoizedState===null?T_:$_,s=c(h,b),Vl){C=0;do{if(Vl=!1,Wl=0,25<=C)throw Error(n(301));C+=1,Un=on=null,o.updateQueue=null,fr.current=L_,s=c(h,b)}while(Vl)}if(fr.current=$u,o=on!==null&&on.next!==null,Ro=0,Un=on=Nn=null,Mu=!1,o)throw Error(n(300));return s}function gm(){var s=Wl!==0;return Wl=0,s}function Kr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?Nn.memoizedState=Un=s:Un=Un.next=s,Un}function hr(){if(on===null){var s=Nn.alternate;s=s!==null?s.memoizedState:null}else s=on.next;var o=Un===null?Nn.memoizedState:Un.next;if(o!==null)Un=o,on=s;else{if(s===null)throw Error(n(310));on=s,s={memoizedState:on.memoizedState,baseState:on.baseState,baseQueue:on.baseQueue,queue:on.queue,next:null},Un===null?Nn.memoizedState=Un=s:Un=Un.next=s}return Un}function Yl(s,o){return typeof o=="function"?o(s):o}function Xa(s){var o=hr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=on,b=h.baseQueue,C=c.pending;if(C!==null){if(b!==null){var R=b.next;b.next=C.next,C.next=R}h.baseQueue=b=C,c.pending=null}if(b!==null){C=b.next,h=h.baseState;var re=R=null,fe=null,Ne=C;do{var ze=Ne.lane;if((Ro&ze)===ze)fe!==null&&(fe=fe.next={lane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),h=Ne.hasEagerState?Ne.eagerState:s(h,Ne.action);else{var Ue={lane:ze,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null};fe===null?(re=fe=Ue,R=h):fe=fe.next=Ue,Nn.lanes|=ze,Bo|=ze}Ne=Ne.next}while(Ne!==null&&Ne!==C);fe===null?R=h:fe.next=re,ar(h,o.memoizedState)||(As=!0),o.memoizedState=h,o.baseState=R,o.baseQueue=fe,c.lastRenderedState=h}if(s=c.interleaved,s!==null){b=s;do C=b.lane,Nn.lanes|=C,Bo|=C,b=b.next;while(b!==s)}else b===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function Au(s){var o=hr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=c.dispatch,b=c.pending,C=o.memoizedState;if(b!==null){c.pending=null;var R=b=b.next;do C=s(C,R.action),R=R.next;while(R!==b);ar(C,o.memoizedState)||(As=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),c.lastRenderedState=C}return[C,h]}function Ah(){}function Oh(s,o){var c=Nn,h=hr(),b=o(),C=!ar(h.memoizedState,b);if(C&&(h.memoizedState=b,As=!0),h=h.queue,_m($h.bind(null,c,h,s),[s]),h.getSnapshot!==o||C||Un!==null&&Un.memoizedState.tag&1){if(c.flags|=2048,Ql(9,Th.bind(null,c,h,b,o),void 0,null),dn===null)throw Error(n(349));Ro&30||Ph(c,o,b)}return b}function Ph(s,o,c){s.flags|=16384,s={getSnapshot:o,value:c},o=Nn.updateQueue,o===null?(o={lastEffect:null,stores:null},Nn.updateQueue=o,o.stores=[s]):(c=o.stores,c===null?o.stores=[s]:c.push(s))}function Th(s,o,c,h){o.value=c,o.getSnapshot=h,Lh(o)&&Fo(s)}function $h(s,o,c){return c(function(){Lh(o)&&Fo(s)})}function Lh(s){var o=s.getSnapshot;s=s.value;try{var c=o();return!ar(s,c)}catch{return!0}}function Fo(s){var o=ya(s,1);o!==null&&_r(o,s,1,-1)}function Dh(s){var o=Kr();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Yl,lastRenderedState:s},o.queue=s,s=s.dispatch=P_.bind(null,Nn,s),[o.memoizedState,s]}function Ql(s,o,c,h){return s={tag:s,create:o,destroy:c,deps:h,next:null},o=Nn.updateQueue,o===null?(o={lastEffect:null,stores:null},Nn.updateQueue=o,o.lastEffect=s.next=s):(c=o.lastEffect,c===null?o.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,o.lastEffect=s)),s}function zh(){return hr().memoizedState}function Ou(s,o,c,h){var b=Kr();Nn.flags|=s,b.memoizedState=Ql(1|o,c,void 0,h===void 0?null:h)}function Pu(s,o,c,h){var b=hr();h=h===void 0?null:h;var C=void 0;if(on!==null){var R=on.memoizedState;if(C=R.destroy,h!==null&&pm(h,R.deps)){b.memoizedState=Ql(o,c,C,h);return}}Nn.flags|=s,b.memoizedState=Ql(1|o,c,C,h)}function Rh(s,o){return Ou(8390656,8,s,o)}function _m(s,o){return Pu(2048,8,s,o)}function Fh(s,o){return Pu(4,2,s,o)}function Ih(s,o){return Pu(4,4,s,o)}function Ja(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function wa(s,o,c){return c=c!=null?c.concat([s]):null,Pu(4,4,Ja.bind(null,o,s),c)}function pr(){}function Tu(s,o){var c=hr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&pm(o,h[1])?h[0]:(c.memoizedState=[s,o],s)}function Bh(s,o){var c=hr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&pm(o,h[1])?h[0]:(s=s(),c.memoizedState=[s,o],s)}function Hs(s,o,c){return Ro&21?(ar(c,o)||(c=da(),Nn.lanes|=c,Bo|=c,s.baseState=!0),o):(s.baseState&&(s.baseState=!1,As=!0),s.memoizedState=c)}function Uh(s,o){var c=Yt;Yt=c!==0&&4>c?c:4,s(!0);var h=Mh.transition;Mh.transition={};try{s(!1),o()}finally{Yt=c,Mh.transition=h}}function vm(){return hr().memoizedState}function Gl(s,o,c){var h=Sa(s);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},qh(s))Hh(o,c);else if(c=Lo(s,o,c,h),c!==null){var b=gs();_r(c,s,h,b),Vh(c,o,h)}}function P_(s,o,c){var h=Sa(s),b={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(qh(s))Hh(o,b);else{var C=s.alternate;if(s.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var R=o.lastRenderedState,re=C(R,c);if(b.hasEagerState=!0,b.eagerState=re,ar(re,R)){var fe=o.interleaved;fe===null?(b.next=b,ki(o)):(b.next=fe.next,fe.next=b),o.interleaved=b;return}}catch{}finally{}c=Lo(s,o,b,h),c!==null&&(b=gs(),_r(c,s,h,b),Vh(c,o,h))}}function qh(s){var o=s.alternate;return s===Nn||o!==null&&o===Nn}function Hh(s,o){Vl=Mu=!0;var c=s.pending;c===null?o.next=o:(o.next=c.next,c.next=o),s.pending=o}function Vh(s,o,c){if(c&4194240){var h=o.lanes;h&=s.pendingLanes,c|=h,o.lanes=c,gl(s,c)}}var $u={readContext:Ss,useCallback:Zn,useContext:Zn,useEffect:Zn,useImperativeHandle:Zn,useInsertionEffect:Zn,useLayoutEffect:Zn,useMemo:Zn,useReducer:Zn,useRef:Zn,useState:Zn,useDebugValue:Zn,useDeferredValue:Zn,useTransition:Zn,useMutableSource:Zn,useSyncExternalStore:Zn,useId:Zn,unstable_isNewReconciler:!1},T_={readContext:Ss,useCallback:function(s,o){return Kr().memoizedState=[s,o===void 0?null:o],s},useContext:Ss,useEffect:Rh,useImperativeHandle:function(s,o,c){return c=c!=null?c.concat([s]):null,Ou(4194308,4,Ja.bind(null,o,s),c)},useLayoutEffect:function(s,o){return Ou(4194308,4,s,o)},useInsertionEffect:function(s,o){return Ou(4,2,s,o)},useMemo:function(s,o){var c=Kr();return o=o===void 0?null:o,s=s(),c.memoizedState=[s,o],s},useReducer:function(s,o,c){var h=Kr();return o=c!==void 0?c(o):o,h.memoizedState=h.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},h.queue=s,s=s.dispatch=Gl.bind(null,Nn,s),[h.memoizedState,s]},useRef:function(s){var o=Kr();return s={current:s},o.memoizedState=s},useState:Dh,useDebugValue:pr,useDeferredValue:function(s){return Kr().memoizedState=s},useTransition:function(){var s=Dh(!1),o=s[0];return s=Uh.bind(null,s[1]),Kr().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,c){var h=Nn,b=Kr();if(bn){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),dn===null)throw Error(n(349));Ro&30||Ph(h,o,c)}b.memoizedState=c;var C={value:c,getSnapshot:o};return b.queue=C,Rh($h.bind(null,h,C,s),[s]),h.flags|=2048,Ql(9,Th.bind(null,h,C,c,o),void 0,null),c},useId:function(){var s=Kr(),o=dn.identifierPrefix;if(bn){var c=va,h=_a;c=(h&~(1<<32-On(h)-1)).toString(32)+c,o=":"+o+"R"+c,c=Wl++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=Mi++,o=":"+o+"r"+c.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},$_={readContext:Ss,useCallback:Tu,useContext:Ss,useEffect:_m,useImperativeHandle:wa,useInsertionEffect:Fh,useLayoutEffect:Ih,useMemo:Bh,useReducer:Xa,useRef:zh,useState:function(){return Xa(Yl)},useDebugValue:pr,useDeferredValue:function(s){var o=hr();return Hs(o,on.memoizedState,s)},useTransition:function(){var s=Xa(Yl)[0],o=hr().memoizedState;return[s,o]},useMutableSource:Ah,useSyncExternalStore:Oh,useId:vm,unstable_isNewReconciler:!1},L_={readContext:Ss,useCallback:Tu,useContext:Ss,useEffect:_m,useImperativeHandle:wa,useInsertionEffect:Fh,useLayoutEffect:Ih,useMemo:Bh,useReducer:Au,useRef:zh,useState:function(){return Au(Yl)},useDebugValue:pr,useDeferredValue:function(s){var o=hr();return on===null?o.memoizedState=s:Hs(o,on.memoizedState,s)},useTransition:function(){var s=Au(Yl)[0],o=hr().memoizedState;return[s,o]},useMutableSource:Ah,useSyncExternalStore:Oh,useId:vm,unstable_isNewReconciler:!1};function es(s,o){if(s&&s.defaultProps){o=U({},o),s=s.defaultProps;for(var c in s)o[c]===void 0&&(o[c]=s[c]);return o}return o}function Vs(s,o,c,h){o=s.memoizedState,c=c(h,o),c=c==null?o:U({},o,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var Ai={isMounted:function(s){return(s=s._reactInternals)?Is(s)===s:!1},enqueueSetState:function(s,o,c){s=s._reactInternals;var h=gs(),b=Sa(s),C=ba(h,b);C.payload=o,c!=null&&(C.callback=c),o=xa(s,C,b),o!==null&&(_r(o,s,b,h),Cu(o,s,b))},enqueueReplaceState:function(s,o,c){s=s._reactInternals;var h=gs(),b=Sa(s),C=ba(h,b);C.tag=1,C.payload=o,c!=null&&(C.callback=c),o=xa(s,C,b),o!==null&&(_r(o,s,b,h),Cu(o,s,b))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var c=gs(),h=Sa(s),b=ba(c,h);b.tag=2,o!=null&&(b.callback=o),o=xa(s,b,h),o!==null&&(_r(o,s,h,c),Cu(o,s,h))}};function Wh(s,o,c,h,b,C,R){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,C,R):o.prototype&&o.prototype.isPureReactComponent?!vi(c,h)||!vi(b,C):!0}function Kh(s,o,c){var h=!1,b=Vr,C=o.contextType;return typeof C=="object"&&C!==null?C=Ss(C):(b=Tn(o)?Ya:fs.current,h=o.contextTypes,C=(h=h!=null)?wi(s,b):Vr),o=new o(c,C),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Ai,s.stateNode=o,o._reactInternals=s,h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=b,s.__reactInternalMemoizedMaskedChildContext=C),o}function Yh(s,o,c,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==s&&Ai.enqueueReplaceState(o,o.state,null)}function ym(s,o,c,h){var b=s.stateNode;b.props=c,b.state=s.memoizedState,b.refs={},fm(s);var C=o.contextType;typeof C=="object"&&C!==null?b.context=Ss(C):(C=Tn(o)?Ya:fs.current,b.context=wi(s,C)),b.state=s.memoizedState,C=o.getDerivedStateFromProps,typeof C=="function"&&(Vs(s,o,C,c),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(o=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),o!==b.state&&Ai.enqueueReplaceState(b,b.state,null),Eu(s,c,b,h),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308)}function Oi(s,o){try{var c="",h=o;do c+=V(h),h=h.return;while(h);var b=c}catch(C){b=`
Error generating stack: `+C.message+`
`+C.stack}return{value:s,source:o,stack:b,digest:null}}function bm(s,o,c){return{value:s,source:null,stack:c??null,digest:o??null}}function Pi(s,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var D_=typeof WeakMap=="function"?WeakMap:Map;function Yr(s,o,c){c=ba(-1,c),c.tag=3,c.payload={element:null};var h=o.value;return c.callback=function(){Qt||(Qt=!0,$m=h),Pi(s,o)},c}function xm(s,o,c){c=ba(-1,c),c.tag=3;var h=s.type.getDerivedStateFromError;if(typeof h=="function"){var b=o.value;c.payload=function(){return h(b)},c.callback=function(){Pi(s,o)}}var C=s.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(c.callback=function(){Pi(s,o),typeof h!="function"&&(ja===null?ja=new Set([this]):ja.add(this));var R=o.stack;this.componentDidCatch(o.value,{componentStack:R!==null?R:""})}),c}function Qh(s,o,c){var h=s.pingCache;if(h===null){h=s.pingCache=new D_;var b=new Set;h.set(o,b)}else b=h.get(o),b===void 0&&(b=new Set,h.set(o,b));b.has(c)||(b.add(c),s=bp.bind(null,s,o,c),o.then(s,s))}function Gh(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function Xh(s,o,c,h,b){return s.mode&1?(s.flags|=65536,s.lanes=b,s):(s===o?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=ba(-1,1),o.tag=2,xa(c,o,1))),c.lanes|=1),s)}var z_=j.ReactCurrentOwner,As=!1;function Cs(s,o,c,h){o.child=s===null?Nh(o,null,c,h):Si(o,s.child,c,h)}function wm(s,o,c,h,b){c=c.render;var C=o.ref;return Ei(o,b),h=Kl(s,o,c,h,C,b),c=gm(),s!==null&&!As?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,Qr(s,o,b)):(bn&&c&&im(o),o.flags|=1,Cs(s,o,h,b),o.child)}function Jh(s,o,c,h,b){if(s===null){var C=c.type;return typeof C=="function"&&!ce(C)&&C.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=C,Zh(s,o,C,h,b)):(s=Te(c.type,null,h,o,o.mode,b),s.ref=o.ref,s.return=o,o.child=s)}if(C=s.child,!(s.lanes&b)){var R=C.memoizedProps;if(c=c.compare,c=c!==null?c:vi,c(R,h)&&s.ref===o.ref)return Qr(s,o,b)}return o.flags|=1,s=be(C,h),s.ref=o.ref,s.return=o,o.child=s}function Zh(s,o,c,h,b){if(s!==null){var C=s.memoizedProps;if(vi(C,h)&&s.ref===o.ref)if(As=!1,o.pendingProps=h=C,(s.lanes&b)!==0)s.flags&131072&&(As=!0);else return o.lanes=s.lanes,Qr(s,o,b)}return jm(s,o,c,h,b)}function Lu(s,o,c){var h=o.pendingProps,b=h.children,C=s!==null?s.memoizedState:null;if(h.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gt(Li,Ws),Ws|=c;else{if(!(c&1073741824))return s=C!==null?C.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,Gt(Li,Ws),Ws|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=C!==null?C.baseLanes:c,Gt(Li,Ws),Ws|=h}else C!==null?(h=C.baseLanes|c,o.memoizedState=null):h=c,Gt(Li,Ws),Ws|=h;return Cs(s,o,b,c),o.child}function ep(s,o){var c=o.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function jm(s,o,c,h,b){var C=Tn(c)?Ya:fs.current;return C=wi(o,C),Ei(o,b),c=Kl(s,o,c,h,C,b),h=gm(),s!==null&&!As?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,Qr(s,o,b)):(bn&&h&&im(o),o.flags|=1,Cs(s,o,c,b),o.child)}function Nm(s,o,c,h,b){if(Tn(c)){var C=!0;_u(o)}else C=!1;if(Ei(o,b),o.stateNode===null)ec(s,o),Kh(o,c,h),ym(o,c,h,b),h=!0;else if(s===null){var R=o.stateNode,re=o.memoizedProps;R.props=re;var fe=R.context,Ne=c.contextType;typeof Ne=="object"&&Ne!==null?Ne=Ss(Ne):(Ne=Tn(c)?Ya:fs.current,Ne=wi(o,Ne));var ze=c.getDerivedStateFromProps,Ue=typeof ze=="function"||typeof R.getSnapshotBeforeUpdate=="function";Ue||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(re!==h||fe!==Ne)&&Yh(o,R,h,Ne),Ga=!1;var De=o.memoizedState;R.state=De,Eu(o,h,R,b),fe=o.memoizedState,re!==h||De!==fe||an.current||Ga?(typeof ze=="function"&&(Vs(o,c,ze,h),fe=o.memoizedState),(re=Ga||Wh(o,c,re,h,De,fe,Ne))?(Ue||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount()),typeof R.componentDidMount=="function"&&(o.flags|=4194308)):(typeof R.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=fe),R.props=h,R.state=fe,R.context=Ne,h=re):(typeof R.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{R=o.stateNode,Sh(s,o),re=o.memoizedProps,Ne=o.type===o.elementType?re:es(o.type,re),R.props=Ne,Ue=o.pendingProps,De=R.context,fe=c.contextType,typeof fe=="object"&&fe!==null?fe=Ss(fe):(fe=Tn(c)?Ya:fs.current,fe=wi(o,fe));var st=c.getDerivedStateFromProps;(ze=typeof st=="function"||typeof R.getSnapshotBeforeUpdate=="function")||typeof R.UNSAFE_componentWillReceiveProps!="function"&&typeof R.componentWillReceiveProps!="function"||(re!==Ue||De!==fe)&&Yh(o,R,h,fe),Ga=!1,De=o.memoizedState,R.state=De,Eu(o,h,R,b);var ot=o.memoizedState;re!==Ue||De!==ot||an.current||Ga?(typeof st=="function"&&(Vs(o,c,st,h),ot=o.memoizedState),(Ne=Ga||Wh(o,c,Ne,h,De,ot,fe)||!1)?(ze||typeof R.UNSAFE_componentWillUpdate!="function"&&typeof R.componentWillUpdate!="function"||(typeof R.componentWillUpdate=="function"&&R.componentWillUpdate(h,ot,fe),typeof R.UNSAFE_componentWillUpdate=="function"&&R.UNSAFE_componentWillUpdate(h,ot,fe)),typeof R.componentDidUpdate=="function"&&(o.flags|=4),typeof R.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof R.componentDidUpdate!="function"||re===s.memoizedProps&&De===s.memoizedState||(o.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||re===s.memoizedProps&&De===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=ot),R.props=h,R.state=ot,R.context=fe,h=Ne):(typeof R.componentDidUpdate!="function"||re===s.memoizedProps&&De===s.memoizedState||(o.flags|=4),typeof R.getSnapshotBeforeUpdate!="function"||re===s.memoizedProps&&De===s.memoizedState||(o.flags|=1024),h=!1)}return Xl(s,o,c,h,C,b)}function Xl(s,o,c,h,b,C){ep(s,o);var R=(o.flags&128)!==0;if(!h&&!R)return b&&_h(o,c,!1),Qr(s,o,C);h=o.stateNode,z_.current=o;var re=R&&typeof c.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,s!==null&&R?(o.child=Si(o,s.child,null,C),o.child=Si(o,null,re,C)):Cs(s,o,re,C),o.memoizedState=h.state,b&&_h(o,c,!0),o.child}function tp(s){var o=s.stateNode;o.pendingContext?am(s,o.pendingContext,o.pendingContext!==o.context):o.context&&am(s,o.context,!1),hm(s,o.containerInfo)}function np(s,o,c,h,b){return os(),um(b),o.flags|=256,Cs(s,o,c,h),o.child}var Sm={dehydrated:null,treeContext:null,retryLane:0};function Cm(s){return{baseLanes:s,cachePool:null,transitions:null}}function sp(s,o,c){var h=o.pendingProps,b=jn.current,C=!1,R=(o.flags&128)!==0,re;if((re=R)||(re=s!==null&&s.memoizedState===null?!1:(b&2)!==0),re?(C=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(b|=1),Gt(jn,b&1),s===null)return cm(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(o.mode&1?s.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(R=h.children,s=h.fallback,C?(h=o.mode,C=o.child,R={mode:"hidden",children:R},!(h&1)&&C!==null?(C.childLanes=0,C.pendingProps=R):C=pt(R,h,0,null),s=ct(s,h,c,null),C.return=o,s.return=o,C.sibling=s,o.child=C,o.child.memoizedState=Cm(c),o.memoizedState=Sm,s):Jl(o,R));if(b=s.memoizedState,b!==null&&(re=b.dehydrated,re!==null))return R_(s,o,R,h,re,b,c);if(C){C=h.fallback,R=o.mode,b=s.child,re=b.sibling;var fe={mode:"hidden",children:h.children};return!(R&1)&&o.child!==b?(h=o.child,h.childLanes=0,h.pendingProps=fe,o.deletions=null):(h=be(b,fe),h.subtreeFlags=b.subtreeFlags&14680064),re!==null?C=be(re,C):(C=ct(C,R,c,null),C.flags|=2),C.return=o,h.return=o,h.sibling=C,o.child=h,h=C,C=o.child,R=s.child.memoizedState,R=R===null?Cm(c):{baseLanes:R.baseLanes|c,cachePool:null,transitions:R.transitions},C.memoizedState=R,C.childLanes=s.childLanes&~c,o.memoizedState=Sm,h}return C=s.child,s=C.sibling,h=be(C,{mode:"visible",children:h.children}),!(o.mode&1)&&(h.lanes=c),h.return=o,h.sibling=null,s!==null&&(c=o.deletions,c===null?(o.deletions=[s],o.flags|=16):c.push(s)),o.child=h,o.memoizedState=null,h}function Jl(s,o){return o=pt({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function Du(s,o,c,h){return h!==null&&um(h),Si(o,s.child,null,c),s=Jl(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function R_(s,o,c,h,b,C,R){if(c)return o.flags&256?(o.flags&=-257,h=bm(Error(n(422))),Du(s,o,R,h)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(C=h.fallback,b=o.mode,h=pt({mode:"visible",children:h.children},b,0,null),C=ct(C,b,R,null),C.flags|=2,h.return=o,C.return=o,h.sibling=C,o.child=h,o.mode&1&&Si(o,s.child,null,R),o.child.memoizedState=Cm(R),o.memoizedState=Sm,C);if(!(o.mode&1))return Du(s,o,R,null);if(b.data==="$!"){if(h=b.nextSibling&&b.nextSibling.dataset,h)var re=h.dgst;return h=re,C=Error(n(419)),h=bm(C,h,void 0),Du(s,o,R,h)}if(re=(R&s.childLanes)!==0,As||re){if(h=dn,h!==null){switch(R&-R){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=b&(h.suspendedLanes|R)?0:b,b!==0&&b!==C.retryLane&&(C.retryLane=b,ya(s,b),_r(h,s,b,-1))}return Wu(),h=bm(Error(n(421))),Du(s,o,R,h)}return b.data==="$?"?(o.flags|=128,o.child=s.child,o=N.bind(null,s),b._reactRetry=o,null):(s=C.treeContext,qs=Ha(b.nextSibling),Us=o,bn=!0,dr=null,s!==null&&(cr[ur++]=_a,cr[ur++]=va,cr[ur++]=Ao,_a=s.id,va=s.overflow,Ao=o),o=Jl(o,h.children),o.flags|=4096,o)}function Em(s,o,c){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),mm(s.return,o,c)}function Zl(s,o,c,h,b){var C=s.memoizedState;C===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:b}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=h,C.tail=c,C.tailMode=b)}function rp(s,o,c){var h=o.pendingProps,b=h.revealOrder,C=h.tail;if(Cs(s,o,h.children,c),h=jn.current,h&2)h=h&1|2,o.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Em(s,c,o);else if(s.tag===19)Em(s,c,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}if(Gt(jn,h),!(o.mode&1))o.memoizedState=null;else switch(b){case"forwards":for(c=o.child,b=null;c!==null;)s=c.alternate,s!==null&&hn(s)===null&&(b=c),c=c.sibling;c=b,c===null?(b=o.child,o.child=null):(b=c.sibling,c.sibling=null),Zl(o,!1,b,c,C);break;case"backwards":for(c=null,b=o.child,o.child=null;b!==null;){if(s=b.alternate,s!==null&&hn(s)===null){o.child=b;break}s=b.sibling,b.sibling=c,c=b,b=s}Zl(o,!0,c,null,C);break;case"together":Zl(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ec(s,o){!(o.mode&1)&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function Qr(s,o,c){if(s!==null&&(o.dependencies=s.dependencies),Bo|=o.lanes,!(c&o.childLanes))return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,c=be(s,s.pendingProps),o.child=c,c.return=o;s.sibling!==null;)s=s.sibling,c=c.sibling=be(s,s.pendingProps),c.return=o;c.sibling=null}return o.child}function ap(s,o,c){switch(o.tag){case 3:tp(o),os();break;case 5:kh(o);break;case 1:Tn(o.type)&&_u(o);break;case 4:hm(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,b=o.memoizedProps.value;Gt(Nu,h._currentValue),h._currentValue=b;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(Gt(jn,jn.current&1),o.flags|=128,null):c&o.child.childLanes?sp(s,o,c):(Gt(jn,jn.current&1),s=Qr(s,o,c),s!==null?s.sibling:null);Gt(jn,jn.current&1);break;case 19:if(h=(c&o.childLanes)!==0,s.flags&128){if(h)return rp(s,o,c);o.flags|=128}if(b=o.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Gt(jn,jn.current),h)break;return null;case 22:case 23:return o.lanes=0,Lu(s,o,c)}return Qr(s,o,c)}var Or,tc,km,zu;Or=function(s,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)s.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},tc=function(){},km=function(s,o,c,h){var b=s.memoizedProps;if(b!==h){s=o.stateNode,Do(Wr.current);var C=null;switch(c){case"input":b=Se(s,b),h=Se(s,h),C=[];break;case"select":b=U({},b,{value:void 0}),h=U({},h,{value:void 0}),C=[];break;case"textarea":b=Pe(s,b),h=Pe(s,h),C=[];break;default:typeof b.onClick!="function"&&typeof h.onClick=="function"&&(s.onclick=Rl)}Ft(c,h);var R;c=null;for(Ne in b)if(!h.hasOwnProperty(Ne)&&b.hasOwnProperty(Ne)&&b[Ne]!=null)if(Ne==="style"){var re=b[Ne];for(R in re)re.hasOwnProperty(R)&&(c||(c={}),c[R]="")}else Ne!=="dangerouslySetInnerHTML"&&Ne!=="children"&&Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&Ne!=="autoFocus"&&(i.hasOwnProperty(Ne)?C||(C=[]):(C=C||[]).push(Ne,null));for(Ne in h){var fe=h[Ne];if(re=b!=null?b[Ne]:void 0,h.hasOwnProperty(Ne)&&fe!==re&&(fe!=null||re!=null))if(Ne==="style")if(re){for(R in re)!re.hasOwnProperty(R)||fe&&fe.hasOwnProperty(R)||(c||(c={}),c[R]="");for(R in fe)fe.hasOwnProperty(R)&&re[R]!==fe[R]&&(c||(c={}),c[R]=fe[R])}else c||(C||(C=[]),C.push(Ne,c)),c=fe;else Ne==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,re=re?re.__html:void 0,fe!=null&&re!==fe&&(C=C||[]).push(Ne,fe)):Ne==="children"?typeof fe!="string"&&typeof fe!="number"||(C=C||[]).push(Ne,""+fe):Ne!=="suppressContentEditableWarning"&&Ne!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ne)?(fe!=null&&Ne==="onScroll"&&sn("scroll",s),C||re===fe||(C=[])):(C=C||[]).push(Ne,fe))}c&&(C=C||[]).push("style",c);var Ne=C;(o.updateQueue=Ne)&&(o.flags|=4)}},zu=function(s,o,c,h){c!==h&&(o.flags|=4)};function Ti(s,o){if(!bn)switch(s.tailMode){case"hidden":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function hs(s){var o=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(o)for(var b=s.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags&14680064,h|=b.flags&14680064,b.return=s,b=b.sibling;else for(b=s.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=s,b=b.sibling;return s.subtreeFlags|=h,s.childLanes=c,o}function F_(s,o,c){var h=o.pendingProps;switch(lm(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hs(o),null;case 1:return Tn(o.type)&&pu(),hs(o),null;case 3:return h=o.stateNode,zo(),rn(an),rn(fs),mr(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Mr(o)?o.flags|=4:s===null||s.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,dr!==null&&(qu(dr),dr=null))),tc(s,o),hs(o),null;case 5:ku(o);var b=Do(Hl.current);if(c=o.type,s!==null&&o.stateNode!=null)km(s,o,c,h,b),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(n(166));return hs(o),null}if(s=Do(Wr.current),Mr(o)){h=o.stateNode,c=o.type;var C=o.memoizedProps;switch(h[Ur]=o,h[Va]=C,s=(o.mode&1)!==0,c){case"dialog":sn("cancel",h),sn("close",h);break;case"iframe":case"object":case"embed":sn("load",h);break;case"video":case"audio":for(b=0;b<$l.length;b++)sn($l[b],h);break;case"source":sn("error",h);break;case"img":case"image":case"link":sn("error",h),sn("load",h);break;case"details":sn("toggle",h);break;case"input":Re(h,C),sn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!C.multiple},sn("invalid",h);break;case"textarea":$e(h,C),sn("invalid",h)}Ft(c,C),b=null;for(var R in C)if(C.hasOwnProperty(R)){var re=C[R];R==="children"?typeof re=="string"?h.textContent!==re&&(C.suppressHydrationWarning!==!0&&du(h.textContent,re,s),b=["children",re]):typeof re=="number"&&h.textContent!==""+re&&(C.suppressHydrationWarning!==!0&&du(h.textContent,re,s),b=["children",""+re]):i.hasOwnProperty(R)&&re!=null&&R==="onScroll"&&sn("scroll",h)}switch(c){case"input":He(h),Ve(h,C,!0);break;case"textarea":He(h),wt(h);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(h.onclick=Rl)}h=b,o.updateQueue=h,h!==null&&(o.flags|=4)}else{R=b.nodeType===9?b:b.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=en(c)),s==="http://www.w3.org/1999/xhtml"?c==="script"?(s=R.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof h.is=="string"?s=R.createElement(c,{is:h.is}):(s=R.createElement(c),c==="select"&&(R=s,h.multiple?R.multiple=!0:h.size&&(R.size=h.size))):s=R.createElementNS(s,c),s[Ur]=o,s[Va]=h,Or(s,o,!1,!1),o.stateNode=s;e:{switch(R=dt(c,h),c){case"dialog":sn("cancel",s),sn("close",s),b=h;break;case"iframe":case"object":case"embed":sn("load",s),b=h;break;case"video":case"audio":for(b=0;b<$l.length;b++)sn($l[b],s);b=h;break;case"source":sn("error",s),b=h;break;case"img":case"image":case"link":sn("error",s),sn("load",s),b=h;break;case"details":sn("toggle",s),b=h;break;case"input":Re(s,h),b=Se(s,h),sn("invalid",s);break;case"option":b=h;break;case"select":s._wrapperState={wasMultiple:!!h.multiple},b=U({},h,{value:void 0}),sn("invalid",s);break;case"textarea":$e(s,h),b=Pe(s,h),sn("invalid",s);break;default:b=h}Ft(c,b),re=b;for(C in re)if(re.hasOwnProperty(C)){var fe=re[C];C==="style"?xt(s,fe):C==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,fe!=null&&ke(s,fe)):C==="children"?typeof fe=="string"?(c!=="textarea"||fe!=="")&&Oe(s,fe):typeof fe=="number"&&Oe(s,""+fe):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(i.hasOwnProperty(C)?fe!=null&&C==="onScroll"&&sn("scroll",s):fe!=null&&T(s,C,fe,R))}switch(c){case"input":He(s),Ve(s,h,!1);break;case"textarea":He(s),wt(s);break;case"option":h.value!=null&&s.setAttribute("value",""+pe(h.value));break;case"select":s.multiple=!!h.multiple,C=h.value,C!=null?J(s,!!h.multiple,C,!1):h.defaultValue!=null&&J(s,!!h.multiple,h.defaultValue,!0);break;default:typeof b.onClick=="function"&&(s.onclick=Rl)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return hs(o),null;case 6:if(s&&o.stateNode!=null)zu(s,o,s.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(n(166));if(c=Do(Hl.current),Do(Wr.current),Mr(o)){if(h=o.stateNode,c=o.memoizedProps,h[Ur]=o,(C=h.nodeValue!==c)&&(s=Us,s!==null))switch(s.tag){case 3:du(h.nodeValue,c,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&du(h.nodeValue,c,(s.mode&1)!==0)}C&&(o.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[Ur]=o,o.stateNode=h}return hs(o),null;case 13:if(rn(jn),h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(bn&&qs!==null&&o.mode&1&&!(o.flags&128))wu(),os(),o.flags|=98560,C=!1;else if(C=Mr(o),h!==null&&h.dehydrated!==null){if(s===null){if(!C)throw Error(n(318));if(C=o.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(n(317));C[Ur]=o}else os(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;hs(o),C=!1}else dr!==null&&(qu(dr),dr=null),C=!0;if(!C)return o.flags&65536?o:null}return o.flags&128?(o.lanes=c,o):(h=h!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(o.child.flags|=8192,o.mode&1&&(s===null||jn.current&1?qn===0&&(qn=3):Wu())),o.updateQueue!==null&&(o.flags|=4),hs(o),null);case 4:return zo(),tc(s,o),s===null&&Dl(o.stateNode.containerInfo),hs(o),null;case 10:return Ul(o.type._context),hs(o),null;case 17:return Tn(o.type)&&pu(),hs(o),null;case 19:if(rn(jn),C=o.memoizedState,C===null)return hs(o),null;if(h=(o.flags&128)!==0,R=C.rendering,R===null)if(h)Ti(C,!1);else{if(qn!==0||s!==null&&s.flags&128)for(s=o.child;s!==null;){if(R=hn(s),R!==null){for(o.flags|=128,Ti(C,!1),h=R.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=c,c=o.child;c!==null;)C=c,s=h,C.flags&=14680066,R=C.alternate,R===null?(C.childLanes=0,C.lanes=s,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=R.childLanes,C.lanes=R.lanes,C.child=R.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=R.memoizedProps,C.memoizedState=R.memoizedState,C.updateQueue=R.updateQueue,C.type=R.type,s=R.dependencies,C.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),c=c.sibling;return Gt(jn,jn.current&1|2),o.child}s=s.sibling}C.tail!==null&&Je()>Di&&(o.flags|=128,h=!0,Ti(C,!1),o.lanes=4194304)}else{if(!h)if(s=hn(R),s!==null){if(o.flags|=128,h=!0,c=s.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),Ti(C,!0),C.tail===null&&C.tailMode==="hidden"&&!R.alternate&&!bn)return hs(o),null}else 2*Je()-C.renderingStartTime>Di&&c!==1073741824&&(o.flags|=128,h=!0,Ti(C,!1),o.lanes=4194304);C.isBackwards?(R.sibling=o.child,o.child=R):(c=C.last,c!==null?c.sibling=R:o.child=R,C.last=R)}return C.tail!==null?(o=C.tail,C.rendering=o,C.tail=o.sibling,C.renderingStartTime=Je(),o.sibling=null,c=jn.current,Gt(jn,h?c&1|2:c&1),o):(hs(o),null);case 22:case 23:return Vu(),h=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(o.flags|=8192),h&&o.mode&1?Ws&1073741824&&(hs(o),o.subtreeFlags&6&&(o.flags|=8192)):hs(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function I_(s,o){switch(lm(o),o.tag){case 1:return Tn(o.type)&&pu(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return zo(),rn(an),rn(fs),mr(),s=o.flags,s&65536&&!(s&128)?(o.flags=s&-65537|128,o):null;case 5:return ku(o),null;case 13:if(rn(jn),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));os()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return rn(jn),null;case 4:return zo(),null;case 10:return Ul(o.type._context),null;case 22:case 23:return Vu(),null;case 24:return null;default:return null}}var nc=!1,ps=!1,op=typeof WeakSet=="function"?WeakSet:Set,at=null;function Io(s,o){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){Sn(s,o,h)}else c.current=null}function Mm(s,o,c){try{c()}catch(h){Sn(s,o,h)}}var Ru=!1;function ip(s,o){if(nm=js,s=pa(),nu(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var b=h.anchorOffset,C=h.focusNode;h=h.focusOffset;try{c.nodeType,C.nodeType}catch{c=null;break e}var R=0,re=-1,fe=-1,Ne=0,ze=0,Ue=s,De=null;t:for(;;){for(var st;Ue!==c||b!==0&&Ue.nodeType!==3||(re=R+b),Ue!==C||h!==0&&Ue.nodeType!==3||(fe=R+h),Ue.nodeType===3&&(R+=Ue.nodeValue.length),(st=Ue.firstChild)!==null;)De=Ue,Ue=st;for(;;){if(Ue===s)break t;if(De===c&&++Ne===b&&(re=R),De===C&&++ze===h&&(fe=R),(st=Ue.nextSibling)!==null)break;Ue=De,De=Ue.parentNode}Ue=st}c=re===-1||fe===-1?null:{start:re,end:fe}}else c=null}c=c||{start:0,end:0}}else c=null;for(Mt={focusedElem:s,selectionRange:c},js=!1,at=o;at!==null;)if(o=at,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,at=s;else for(;at!==null;){o=at;try{var ot=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ot!==null){var ut=ot.memoizedProps,Hn=ot.memoizedState,ve=o.stateNode,he=ve.getSnapshotBeforeUpdate(o.elementType===o.type?ut:es(o.type,ut),Hn);ve.__reactInternalSnapshotBeforeUpdate=he}break;case 3:var xe=o.stateNode.containerInfo;xe.nodeType===1?xe.textContent="":xe.nodeType===9&&xe.documentElement&&xe.removeChild(xe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(We){Sn(o,o.return,We)}if(s=o.sibling,s!==null){s.return=o.return,at=s;break}at=o.return}return ot=Ru,Ru=!1,ot}function sc(s,o,c){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var b=h=h.next;do{if((b.tag&s)===s){var C=b.destroy;b.destroy=void 0,C!==void 0&&Mm(o,c,C)}b=b.next}while(b!==h)}}function $i(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&s)===s){var h=c.create;c.destroy=h()}c=c.next}while(c!==o)}}function rc(s){var o=s.ref;if(o!==null){var c=s.stateNode;switch(s.tag){case 5:s=c;break;default:s=c}typeof o=="function"?o(s):o.current=s}}function Am(s){var o=s.alternate;o!==null&&(s.alternate=null,Am(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&(delete o[Ur],delete o[Va],delete o[zn],delete o[M_],delete o[fu])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function B_(s){return s.tag===5||s.tag===3||s.tag===4}function lp(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||B_(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Os(s,o,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(s,o):c.insertBefore(s,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(s,c)):(o=c,o.appendChild(s)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Rl));else if(h!==4&&(s=s.child,s!==null))for(Os(s,o,c),s=s.sibling;s!==null;)Os(s,o,c),s=s.sibling}function Ps(s,o,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?c.insertBefore(s,o):c.appendChild(s);else if(h!==4&&(s=s.child,s!==null))for(Ps(s,o,c),s=s.sibling;s!==null;)Ps(s,o,c),s=s.sibling}var ln=null,Pr=!1;function Za(s,o,c){for(c=c.child;c!==null;)cp(s,o,c),c=c.sibling}function cp(s,o,c){if(Vt&&typeof Vt.onCommitFiberUnmount=="function")try{Vt.onCommitFiberUnmount(ss,c)}catch{}switch(c.tag){case 5:ps||Io(c,o);case 6:var h=ln,b=Pr;ln=null,Za(s,o,c),ln=h,Pr=b,ln!==null&&(Pr?(s=ln,c=c.stateNode,s.nodeType===8?s.parentNode.removeChild(c):s.removeChild(c)):ln.removeChild(c.stateNode));break;case 18:ln!==null&&(Pr?(s=ln,c=c.stateNode,s.nodeType===8?sm(s.parentNode,c):s.nodeType===1&&sm(s,c),sr(s)):sm(ln,c.stateNode));break;case 4:h=ln,b=Pr,ln=c.stateNode.containerInfo,Pr=!0,Za(s,o,c),ln=h,Pr=b;break;case 0:case 11:case 14:case 15:if(!ps&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){b=h=h.next;do{var C=b,R=C.destroy;C=C.tag,R!==void 0&&(C&2||C&4)&&Mm(c,o,R),b=b.next}while(b!==h)}Za(s,o,c);break;case 1:if(!ps&&(Io(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(re){Sn(c,o,re)}Za(s,o,c);break;case 21:Za(s,o,c);break;case 22:c.mode&1?(ps=(h=ps)||c.memoizedState!==null,Za(s,o,c),ps=h):Za(s,o,c);break;default:Za(s,o,c)}}function up(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new op),o.forEach(function(h){var b=M.bind(null,s,h);c.has(h)||(c.add(h),h.then(b,b))})}}function Tr(s,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var b=c[h];try{var C=s,R=o,re=R;e:for(;re!==null;){switch(re.tag){case 5:ln=re.stateNode,Pr=!1;break e;case 3:ln=re.stateNode.containerInfo,Pr=!0;break e;case 4:ln=re.stateNode.containerInfo,Pr=!0;break e}re=re.return}if(ln===null)throw Error(n(160));cp(C,R,b),ln=null,Pr=!1;var fe=b.alternate;fe!==null&&(fe.return=null),b.return=null}catch(Ne){Sn(b,o,Ne)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)dp(o,s),o=o.sibling}function dp(s,o){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Tr(o,s),Gr(s),h&4){try{sc(3,s,s.return),$i(3,s)}catch(ut){Sn(s,s.return,ut)}try{sc(5,s,s.return)}catch(ut){Sn(s,s.return,ut)}}break;case 1:Tr(o,s),Gr(s),h&512&&c!==null&&Io(c,c.return);break;case 5:if(Tr(o,s),Gr(s),h&512&&c!==null&&Io(c,c.return),s.flags&32){var b=s.stateNode;try{Oe(b,"")}catch(ut){Sn(s,s.return,ut)}}if(h&4&&(b=s.stateNode,b!=null)){var C=s.memoizedProps,R=c!==null?c.memoizedProps:C,re=s.type,fe=s.updateQueue;if(s.updateQueue=null,fe!==null)try{re==="input"&&C.type==="radio"&&C.name!=null&&Ce(b,C),dt(re,R);var Ne=dt(re,C);for(R=0;R<fe.length;R+=2){var ze=fe[R],Ue=fe[R+1];ze==="style"?xt(b,Ue):ze==="dangerouslySetInnerHTML"?ke(b,Ue):ze==="children"?Oe(b,Ue):T(b,ze,Ue,Ne)}switch(re){case"input":Fe(b,C);break;case"textarea":rt(b,C);break;case"select":var De=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!C.multiple;var st=C.value;st!=null?J(b,!!C.multiple,st,!1):De!==!!C.multiple&&(C.defaultValue!=null?J(b,!!C.multiple,C.defaultValue,!0):J(b,!!C.multiple,C.multiple?[]:"",!1))}b[Va]=C}catch(ut){Sn(s,s.return,ut)}}break;case 6:if(Tr(o,s),Gr(s),h&4){if(s.stateNode===null)throw Error(n(162));b=s.stateNode,C=s.memoizedProps;try{b.nodeValue=C}catch(ut){Sn(s,s.return,ut)}}break;case 3:if(Tr(o,s),Gr(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{sr(o.containerInfo)}catch(ut){Sn(s,s.return,ut)}break;case 4:Tr(o,s),Gr(s);break;case 13:Tr(o,s),Gr(s),b=s.child,b.flags&8192&&(C=b.memoizedState!==null,b.stateNode.isHidden=C,!C||b.alternate!==null&&b.alternate.memoizedState!==null||(Tm=Je())),h&4&&up(s);break;case 22:if(ze=c!==null&&c.memoizedState!==null,s.mode&1?(ps=(Ne=ps)||ze,Tr(o,s),ps=Ne):Tr(o,s),Gr(s),h&8192){if(Ne=s.memoizedState!==null,(s.stateNode.isHidden=Ne)&&!ze&&s.mode&1)for(at=s,ze=s.child;ze!==null;){for(Ue=at=ze;at!==null;){switch(De=at,st=De.child,De.tag){case 0:case 11:case 14:case 15:sc(4,De,De.return);break;case 1:Io(De,De.return);var ot=De.stateNode;if(typeof ot.componentWillUnmount=="function"){h=De,c=De.return;try{o=h,ot.props=o.memoizedProps,ot.state=o.memoizedState,ot.componentWillUnmount()}catch(ut){Sn(h,c,ut)}}break;case 5:Io(De,De.return);break;case 22:if(De.memoizedState!==null){hp(Ue);continue}}st!==null?(st.return=De,at=st):hp(Ue)}ze=ze.sibling}e:for(ze=null,Ue=s;;){if(Ue.tag===5){if(ze===null){ze=Ue;try{b=Ue.stateNode,Ne?(C=b.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(re=Ue.stateNode,fe=Ue.memoizedProps.style,R=fe!=null&&fe.hasOwnProperty("display")?fe.display:null,re.style.display=nt("display",R))}catch(ut){Sn(s,s.return,ut)}}}else if(Ue.tag===6){if(ze===null)try{Ue.stateNode.nodeValue=Ne?"":Ue.memoizedProps}catch(ut){Sn(s,s.return,ut)}}else if((Ue.tag!==22&&Ue.tag!==23||Ue.memoizedState===null||Ue===s)&&Ue.child!==null){Ue.child.return=Ue,Ue=Ue.child;continue}if(Ue===s)break e;for(;Ue.sibling===null;){if(Ue.return===null||Ue.return===s)break e;ze===Ue&&(ze=null),Ue=Ue.return}ze===Ue&&(ze=null),Ue.sibling.return=Ue.return,Ue=Ue.sibling}}break;case 19:Tr(o,s),Gr(s),h&4&&up(s);break;case 21:break;default:Tr(o,s),Gr(s)}}function Gr(s){var o=s.flags;if(o&2){try{e:{for(var c=s.return;c!==null;){if(B_(c)){var h=c;break e}c=c.return}throw Error(n(160))}switch(h.tag){case 5:var b=h.stateNode;h.flags&32&&(Oe(b,""),h.flags&=-33);var C=lp(s);Ps(s,C,b);break;case 3:case 4:var R=h.stateNode.containerInfo,re=lp(s);Os(s,re,R);break;default:throw Error(n(161))}}catch(fe){Sn(s,s.return,fe)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function U_(s,o,c){at=s,mp(s)}function mp(s,o,c){for(var h=(s.mode&1)!==0;at!==null;){var b=at,C=b.child;if(b.tag===22&&h){var R=b.memoizedState!==null||nc;if(!R){var re=b.alternate,fe=re!==null&&re.memoizedState!==null||ps;re=nc;var Ne=ps;if(nc=R,(ps=fe)&&!Ne)for(at=b;at!==null;)R=at,fe=R.child,R.tag===22&&R.memoizedState!==null?pp(b):fe!==null?(fe.return=R,at=fe):pp(b);for(;C!==null;)at=C,mp(C),C=C.sibling;at=b,nc=re,ps=Ne}fp(s)}else b.subtreeFlags&8772&&C!==null?(C.return=b,at=C):fp(s)}}function fp(s){for(;at!==null;){var o=at;if(o.flags&8772){var c=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:ps||$i(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!ps)if(c===null)h.componentDidMount();else{var b=o.elementType===o.type?c.memoizedProps:es(o.type,c.memoizedProps);h.componentDidUpdate(b,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var C=o.updateQueue;C!==null&&Eh(o,C,h);break;case 3:var R=o.updateQueue;if(R!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}Eh(o,R,c)}break;case 5:var re=o.stateNode;if(c===null&&o.flags&4){c=re;var fe=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":fe.autoFocus&&c.focus();break;case"img":fe.src&&(c.src=fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var Ne=o.alternate;if(Ne!==null){var ze=Ne.memoizedState;if(ze!==null){var Ue=ze.dehydrated;Ue!==null&&sr(Ue)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ps||o.flags&512&&rc(o)}catch(De){Sn(o,o.return,De)}}if(o===s){at=null;break}if(c=o.sibling,c!==null){c.return=o.return,at=c;break}at=o.return}}function hp(s){for(;at!==null;){var o=at;if(o===s){at=null;break}var c=o.sibling;if(c!==null){c.return=o.return,at=c;break}at=o.return}}function pp(s){for(;at!==null;){var o=at;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{$i(4,o)}catch(fe){Sn(o,c,fe)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var b=o.return;try{h.componentDidMount()}catch(fe){Sn(o,b,fe)}}var C=o.return;try{rc(o)}catch(fe){Sn(o,C,fe)}break;case 5:var R=o.return;try{rc(o)}catch(fe){Sn(o,R,fe)}}}catch(fe){Sn(o,o.return,fe)}if(o===s){at=null;break}var re=o.sibling;if(re!==null){re.return=o.return,at=re;break}at=o.return}}var q_=Math.ceil,Fu=j.ReactCurrentDispatcher,Om=j.ReactCurrentOwner,gr=j.ReactCurrentBatchConfig,Ht=0,dn=null,Rn=null,is=0,Ws=0,Li=Ka(0),qn=0,ac=null,Bo=0,Iu=0,Pm=0,oc=null,Ts=null,Tm=0,Di=1/0,ls=null,Qt=!1,$m=null,ja=null,ic=!1,Na=null,lc=0,zi=0,Bu=null,cc=-1,uc=0;function gs(){return Ht&6?Je():cc!==-1?cc:cc=Je()}function Sa(s){return s.mode&1?Ht&2&&is!==0?is&-is:O_.transition!==null?(uc===0&&(uc=da()),uc):(s=Yt,s!==0||(s=window.event,s=s===void 0?16:mi(s.type)),s):1}function _r(s,o,c,h){if(50<zi)throw zi=0,Bu=null,Error(n(185));vo(s,c,h),(!(Ht&2)||s!==dn)&&(s===dn&&(!(Ht&2)&&(Iu|=c),qn===4&&Ca(s,is)),Es(s,h),c===1&&Ht===0&&!(o.mode&1)&&(Di=Je()+500,vu&&Qa()))}function Es(s,o){var c=s.callbackNode;ca(s,o);var h=Ir(s,s===dn?is:0);if(h===0)c!==null&&ia(c),s.callbackNode=null,s.callbackPriority=0;else if(o=h&-h,s.callbackPriority!==o){if(c!=null&&ia(c),o===1)s.tag===0?A_(Dm.bind(null,s)):vh(Dm.bind(null,s)),k_(function(){!(Ht&6)&&Qa()}),c=null;else{switch(Wc(h)){case 1:c=At;break;case 4:c=ds;break;case 16:c=tn;break;case 536870912:c=gn;break;default:c=tn}c=I(c,Lm.bind(null,s))}s.callbackPriority=o,s.callbackNode=c}}function Lm(s,o){if(cc=-1,uc=0,Ht&6)throw Error(n(327));var c=s.callbackNode;if(Uo()&&s.callbackNode!==c)return null;var h=Ir(s,s===dn?is:0);if(h===0)return null;if(h&30||h&s.expiredLanes||o)o=dc(s,h);else{o=h;var b=Ht;Ht|=2;var C=Rm();(dn!==s||is!==o)&&(ls=null,Di=Je()+500,to(s,o));do try{vp();break}catch(re){zm(s,re)}while(!0);To(),Fu.current=C,Ht=b,Rn!==null?o=0:(dn=null,is=0,o=qn)}if(o!==0){if(o===2&&(b=ua(s),b!==0&&(h=b,o=Uu(s,b))),o===1)throw c=ac,to(s,0),Ca(s,h),Es(s,Je()),c;if(o===6)Ca(s,h);else{if(b=s.current.alternate,!(h&30)&&!gp(b)&&(o=dc(s,h),o===2&&(C=ua(s),C!==0&&(h=C,o=Uu(s,C))),o===1))throw c=ac,to(s,0),Ca(s,h),Es(s,Je()),c;switch(s.finishedWork=b,s.finishedLanes=h,o){case 0:case 1:throw Error(n(345));case 2:no(s,Ts,ls);break;case 3:if(Ca(s,h),(h&130023424)===h&&(o=Tm+500-Je(),10<o)){if(Ir(s,0)!==0)break;if(b=s.suspendedLanes,(b&h)!==h){gs(),s.pingedLanes|=s.suspendedLanes&b;break}s.timeoutHandle=Fl(no.bind(null,s,Ts,ls),o);break}no(s,Ts,ls);break;case 4:if(Ca(s,h),(h&4194240)===h)break;for(o=s.eventTimes,b=-1;0<h;){var R=31-On(h);C=1<<R,R=o[R],R>b&&(b=R),h&=~C}if(h=b,h=Je()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*q_(h/1960))-h,10<h){s.timeoutHandle=Fl(no.bind(null,s,Ts,ls),h);break}no(s,Ts,ls);break;case 5:no(s,Ts,ls);break;default:throw Error(n(329))}}}return Es(s,Je()),s.callbackNode===c?Lm.bind(null,s):null}function Uu(s,o){var c=oc;return s.current.memoizedState.isDehydrated&&(to(s,o).flags|=256),s=dc(s,o),s!==2&&(o=Ts,Ts=c,o!==null&&qu(o)),s}function qu(s){Ts===null?Ts=s:Ts.push.apply(Ts,s)}function gp(s){for(var o=s;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var b=c[h],C=b.getSnapshot;b=b.value;try{if(!ar(C(),b))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ca(s,o){for(o&=~Pm,o&=~Iu,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var c=31-On(o),h=1<<c;s[c]=-1,o&=~h}}function Dm(s){if(Ht&6)throw Error(n(327));Uo();var o=Ir(s,0);if(!(o&1))return Es(s,Je()),null;var c=dc(s,o);if(s.tag!==0&&c===2){var h=ua(s);h!==0&&(o=h,c=Uu(s,h))}if(c===1)throw c=ac,to(s,0),Ca(s,o),Es(s,Je()),c;if(c===6)throw Error(n(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,no(s,Ts,ls),Es(s,Je()),null}function Hu(s,o){var c=Ht;Ht|=1;try{return s(o)}finally{Ht=c,Ht===0&&(Di=Je()+500,vu&&Qa())}}function eo(s){Na!==null&&Na.tag===0&&!(Ht&6)&&Uo();var o=Ht;Ht|=1;var c=gr.transition,h=Yt;try{if(gr.transition=null,Yt=1,s)return s()}finally{Yt=h,gr.transition=c,Ht=o,!(Ht&6)&&Qa()}}function Vu(){Ws=Li.current,rn(Li)}function to(s,o){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==-1&&(s.timeoutHandle=-1,E_(c)),Rn!==null)for(c=Rn.return;c!==null;){var h=c;switch(lm(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&pu();break;case 3:zo(),rn(an),rn(fs),mr();break;case 5:ku(h);break;case 4:zo();break;case 13:rn(jn);break;case 19:rn(jn);break;case 10:Ul(h.type._context);break;case 22:case 23:Vu()}c=c.return}if(dn=s,Rn=s=be(s.current,null),is=Ws=o,qn=0,ac=null,Pm=Iu=Bo=0,Ts=oc=null,$o!==null){for(o=0;o<$o.length;o++)if(c=$o[o],h=c.interleaved,h!==null){c.interleaved=null;var b=h.next,C=c.pending;if(C!==null){var R=C.next;C.next=b,h.next=R}c.pending=h}$o=null}return s}function zm(s,o){do{var c=Rn;try{if(To(),fr.current=$u,Mu){for(var h=Nn.memoizedState;h!==null;){var b=h.queue;b!==null&&(b.pending=null),h=h.next}Mu=!1}if(Ro=0,Un=on=Nn=null,Vl=!1,Wl=0,Om.current=null,c===null||c.return===null){qn=1,ac=o,Rn=null;break}e:{var C=s,R=c.return,re=c,fe=o;if(o=is,re.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var Ne=fe,ze=re,Ue=ze.tag;if(!(ze.mode&1)&&(Ue===0||Ue===11||Ue===15)){var De=ze.alternate;De?(ze.updateQueue=De.updateQueue,ze.memoizedState=De.memoizedState,ze.lanes=De.lanes):(ze.updateQueue=null,ze.memoizedState=null)}var st=Gh(R);if(st!==null){st.flags&=-257,Xh(st,R,re,C,o),st.mode&1&&Qh(C,Ne,o),o=st,fe=Ne;var ot=o.updateQueue;if(ot===null){var ut=new Set;ut.add(fe),o.updateQueue=ut}else ot.add(fe);break e}else{if(!(o&1)){Qh(C,Ne,o),Wu();break e}fe=Error(n(426))}}else if(bn&&re.mode&1){var Hn=Gh(R);if(Hn!==null){!(Hn.flags&65536)&&(Hn.flags|=256),Xh(Hn,R,re,C,o),um(Oi(fe,re));break e}}C=fe=Oi(fe,re),qn!==4&&(qn=2),oc===null?oc=[C]:oc.push(C),C=R;do{switch(C.tag){case 3:C.flags|=65536,o&=-o,C.lanes|=o;var ve=Yr(C,fe,o);Ch(C,ve);break e;case 1:re=fe;var he=C.type,xe=C.stateNode;if(!(C.flags&128)&&(typeof he.getDerivedStateFromError=="function"||xe!==null&&typeof xe.componentDidCatch=="function"&&(ja===null||!ja.has(xe)))){C.flags|=65536,o&=-o,C.lanes|=o;var We=xm(C,re,o);Ch(C,We);break e}}C=C.return}while(C!==null)}Im(c)}catch(ft){o=ft,Rn===c&&c!==null&&(Rn=c=c.return);continue}break}while(!0)}function Rm(){var s=Fu.current;return Fu.current=$u,s===null?$u:s}function Wu(){(qn===0||qn===3||qn===2)&&(qn=4),dn===null||!(Bo&268435455)&&!(Iu&268435455)||Ca(dn,is)}function dc(s,o){var c=Ht;Ht|=2;var h=Rm();(dn!==s||is!==o)&&(ls=null,to(s,o));do try{_p();break}catch(b){zm(s,b)}while(!0);if(To(),Ht=c,Fu.current=h,Rn!==null)throw Error(n(261));return dn=null,is=0,qn}function _p(){for(;Rn!==null;)Fm(Rn)}function vp(){for(;Rn!==null&&!Ee();)Fm(Rn)}function Fm(s){var o=L(s.alternate,s,Ws);s.memoizedProps=s.pendingProps,o===null?Im(s):Rn=o,Om.current=null}function Im(s){var o=s;do{var c=o.alternate;if(s=o.return,o.flags&32768){if(c=I_(c,o),c!==null){c.flags&=32767,Rn=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{qn=6,Rn=null;return}}else if(c=F_(c,o,Ws),c!==null){Rn=c;return}if(o=o.sibling,o!==null){Rn=o;return}Rn=o=s}while(o!==null);qn===0&&(qn=5)}function no(s,o,c){var h=Yt,b=gr.transition;try{gr.transition=null,Yt=1,yp(s,o,c,h)}finally{gr.transition=b,Yt=h}return null}function yp(s,o,c,h){do Uo();while(Na!==null);if(Ht&6)throw Error(n(327));c=s.finishedWork;var b=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(n(177));s.callbackNode=null,s.callbackPriority=0;var C=c.lanes|c.childLanes;if(Vc(s,C),s===dn&&(Rn=dn=null,is=0),!(c.subtreeFlags&2064)&&!(c.flags&2064)||ic||(ic=!0,I(tn,function(){return Uo(),null})),C=(c.flags&15990)!==0,c.subtreeFlags&15990||C){C=gr.transition,gr.transition=null;var R=Yt;Yt=1;var re=Ht;Ht|=4,Om.current=null,ip(s,c),dp(c,s),N_(Mt),js=!!nm,Mt=nm=null,s.current=c,U_(c),Qe(),Ht=re,Yt=R,gr.transition=C}else s.current=c;if(ic&&(ic=!1,Na=s,lc=b),C=s.pendingLanes,C===0&&(ja=null),fn(c.stateNode),Es(s,Je()),o!==null)for(h=s.onRecoverableError,c=0;c<o.length;c++)b=o[c],h(b.value,{componentStack:b.stack,digest:b.digest});if(Qt)throw Qt=!1,s=$m,$m=null,s;return lc&1&&s.tag!==0&&Uo(),C=s.pendingLanes,C&1?s===Bu?zi++:(zi=0,Bu=s):zi=0,Qa(),null}function Uo(){if(Na!==null){var s=Wc(lc),o=gr.transition,c=Yt;try{if(gr.transition=null,Yt=16>s?16:s,Na===null)var h=!1;else{if(s=Na,Na=null,lc=0,Ht&6)throw Error(n(331));var b=Ht;for(Ht|=4,at=s.current;at!==null;){var C=at,R=C.child;if(at.flags&16){var re=C.deletions;if(re!==null){for(var fe=0;fe<re.length;fe++){var Ne=re[fe];for(at=Ne;at!==null;){var ze=at;switch(ze.tag){case 0:case 11:case 15:sc(8,ze,C)}var Ue=ze.child;if(Ue!==null)Ue.return=ze,at=Ue;else for(;at!==null;){ze=at;var De=ze.sibling,st=ze.return;if(Am(ze),ze===Ne){at=null;break}if(De!==null){De.return=st,at=De;break}at=st}}}var ot=C.alternate;if(ot!==null){var ut=ot.child;if(ut!==null){ot.child=null;do{var Hn=ut.sibling;ut.sibling=null,ut=Hn}while(ut!==null)}}at=C}}if(C.subtreeFlags&2064&&R!==null)R.return=C,at=R;else e:for(;at!==null;){if(C=at,C.flags&2048)switch(C.tag){case 0:case 11:case 15:sc(9,C,C.return)}var ve=C.sibling;if(ve!==null){ve.return=C.return,at=ve;break e}at=C.return}}var he=s.current;for(at=he;at!==null;){R=at;var xe=R.child;if(R.subtreeFlags&2064&&xe!==null)xe.return=R,at=xe;else e:for(R=he;at!==null;){if(re=at,re.flags&2048)try{switch(re.tag){case 0:case 11:case 15:$i(9,re)}}catch(ft){Sn(re,re.return,ft)}if(re===R){at=null;break e}var We=re.sibling;if(We!==null){We.return=re.return,at=We;break e}at=re.return}}if(Ht=b,Qa(),Vt&&typeof Vt.onPostCommitFiberRoot=="function")try{Vt.onPostCommitFiberRoot(ss,s)}catch{}h=!0}return h}finally{Yt=c,gr.transition=o}}return!1}function Bm(s,o,c){o=Oi(c,o),o=Yr(s,o,1),s=xa(s,o,1),o=gs(),s!==null&&(vo(s,1,o),Es(s,o))}function Sn(s,o,c){if(s.tag===3)Bm(s,s,c);else for(;o!==null;){if(o.tag===3){Bm(o,s,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ja===null||!ja.has(h))){s=Oi(c,s),s=xm(o,s,1),o=xa(o,s,1),s=gs(),o!==null&&(vo(o,1,s),Es(o,s));break}}o=o.return}}function bp(s,o,c){var h=s.pingCache;h!==null&&h.delete(o),o=gs(),s.pingedLanes|=s.suspendedLanes&c,dn===s&&(is&c)===c&&(qn===4||qn===3&&(is&130023424)===is&&500>Je()-Tm?to(s,0):Pm|=c),Es(s,o)}function g(s,o){o===0&&(s.mode&1?(o=xs,xs<<=1,!(xs&130023424)&&(xs=4194304)):o=1);var c=gs();s=ya(s,o),s!==null&&(vo(s,o,c),Es(s,c))}function N(s){var o=s.memoizedState,c=0;o!==null&&(c=o.retryLane),g(s,c)}function M(s,o){var c=0;switch(s.tag){case 13:var h=s.stateNode,b=s.memoizedState;b!==null&&(c=b.retryLane);break;case 19:h=s.stateNode;break;default:throw Error(n(314))}h!==null&&h.delete(o),g(s,c)}var L;L=function(s,o,c){if(s!==null)if(s.memoizedProps!==o.pendingProps||an.current)As=!0;else{if(!(s.lanes&c)&&!(o.flags&128))return As=!1,ap(s,o,c);As=!!(s.flags&131072)}else As=!1,bn&&o.flags&1048576&&yh(o,bu,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;ec(s,o),s=o.pendingProps;var b=wi(o,fs.current);Ei(o,c),b=Kl(null,o,h,s,b,c);var C=gm();return o.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Tn(h)?(C=!0,_u(o)):C=!1,o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,fm(o),b.updater=Ai,o.stateNode=b,b._reactInternals=o,ym(o,h,s,c),o=Xl(null,o,h,!0,C,c)):(o.tag=0,bn&&C&&im(o),Cs(null,o,b,c),o=o.child),o;case 16:h=o.elementType;e:{switch(ec(s,o),s=o.pendingProps,b=h._init,h=b(h._payload),o.type=h,b=o.tag=ie(h),s=es(h,s),b){case 0:o=jm(null,o,h,s,c);break e;case 1:o=Nm(null,o,h,s,c);break e;case 11:o=wm(null,o,h,s,c);break e;case 14:o=Jh(null,o,h,es(h.type,s),c);break e}throw Error(n(306,h,""))}return o;case 0:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:es(h,b),jm(s,o,h,b,c);case 1:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:es(h,b),Nm(s,o,h,b,c);case 3:e:{if(tp(o),s===null)throw Error(n(387));h=o.pendingProps,C=o.memoizedState,b=C.element,Sh(s,o),Eu(o,h,null,c);var R=o.memoizedState;if(h=R.element,C.isDehydrated)if(C={element:h,isDehydrated:!1,cache:R.cache,pendingSuspenseBoundaries:R.pendingSuspenseBoundaries,transitions:R.transitions},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){b=Oi(Error(n(423)),o),o=np(s,o,h,c,b);break e}else if(h!==b){b=Oi(Error(n(424)),o),o=np(s,o,h,c,b);break e}else for(qs=Ha(o.stateNode.containerInfo.firstChild),Us=o,bn=!0,dr=null,c=Nh(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(os(),h===b){o=Qr(s,o,c);break e}Cs(s,o,h,c)}o=o.child}return o;case 5:return kh(o),s===null&&cm(o),h=o.type,b=o.pendingProps,C=s!==null?s.memoizedProps:null,R=b.children,mu(h,b)?R=null:C!==null&&mu(h,C)&&(o.flags|=32),ep(s,o),Cs(s,o,R,c),o.child;case 6:return s===null&&cm(o),null;case 13:return sp(s,o,c);case 4:return hm(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=Si(o,null,h,c):Cs(s,o,h,c),o.child;case 11:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:es(h,b),wm(s,o,h,b,c);case 7:return Cs(s,o,o.pendingProps,c),o.child;case 8:return Cs(s,o,o.pendingProps.children,c),o.child;case 12:return Cs(s,o,o.pendingProps.children,c),o.child;case 10:e:{if(h=o.type._context,b=o.pendingProps,C=o.memoizedProps,R=b.value,Gt(Nu,h._currentValue),h._currentValue=R,C!==null)if(ar(C.value,R)){if(C.children===b.children&&!an.current){o=Qr(s,o,c);break e}}else for(C=o.child,C!==null&&(C.return=o);C!==null;){var re=C.dependencies;if(re!==null){R=C.child;for(var fe=re.firstContext;fe!==null;){if(fe.context===h){if(C.tag===1){fe=ba(-1,c&-c),fe.tag=2;var Ne=C.updateQueue;if(Ne!==null){Ne=Ne.shared;var ze=Ne.pending;ze===null?fe.next=fe:(fe.next=ze.next,ze.next=fe),Ne.pending=fe}}C.lanes|=c,fe=C.alternate,fe!==null&&(fe.lanes|=c),mm(C.return,c,o),re.lanes|=c;break}fe=fe.next}}else if(C.tag===10)R=C.type===o.type?null:C.child;else if(C.tag===18){if(R=C.return,R===null)throw Error(n(341));R.lanes|=c,re=R.alternate,re!==null&&(re.lanes|=c),mm(R,c,o),R=C.sibling}else R=C.child;if(R!==null)R.return=C;else for(R=C;R!==null;){if(R===o){R=null;break}if(C=R.sibling,C!==null){C.return=R.return,R=C;break}R=R.return}C=R}Cs(s,o,b.children,c),o=o.child}return o;case 9:return b=o.type,h=o.pendingProps.children,Ei(o,c),b=Ss(b),h=h(b),o.flags|=1,Cs(s,o,h,c),o.child;case 14:return h=o.type,b=es(h,o.pendingProps),b=es(h.type,b),Jh(s,o,h,b,c);case 15:return Zh(s,o,o.type,o.pendingProps,c);case 17:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:es(h,b),ec(s,o),o.tag=1,Tn(h)?(s=!0,_u(o)):s=!1,Ei(o,c),Kh(o,h,b),ym(o,h,b,c),Xl(null,o,h,!0,s,c);case 19:return rp(s,o,c);case 22:return Lu(s,o,c)}throw Error(n(156,o.tag))};function I(s,o){return oa(s,o)}function se(s,o,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ae(s,o,c,h){return new se(s,o,c,h)}function ce(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ie(s){if(typeof s=="function")return ce(s)?1:0;if(s!=null){if(s=s.$$typeof,s===ne)return 11;if(s===X)return 14}return 2}function be(s,o){var c=s.alternate;return c===null?(c=ae(s.tag,o,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=o,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,o=s.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function Te(s,o,c,h,b,C){var R=2;if(h=s,typeof s=="function")ce(s)&&(R=1);else if(typeof s=="string")R=5;else e:switch(s){case D:return ct(c.children,b,C,o);case $:R=8,b|=8;break;case B:return s=ae(12,c,o,b|2),s.elementType=B,s.lanes=C,s;case ue:return s=ae(13,c,o,b),s.elementType=ue,s.lanes=C,s;case z:return s=ae(19,c,o,b),s.elementType=z,s.lanes=C,s;case W:return pt(c,b,C,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case q:R=10;break e;case K:R=9;break e;case ne:R=11;break e;case X:R=14;break e;case Y:R=16,h=null;break e}throw Error(n(130,s==null?s:typeof s,""))}return o=ae(R,c,o,b),o.elementType=s,o.type=h,o.lanes=C,o}function ct(s,o,c,h){return s=ae(7,s,h,o),s.lanes=c,s}function pt(s,o,c,h){return s=ae(22,s,h,o),s.elementType=W,s.lanes=c,s.stateNode={isHidden:!1},s}function zt(s,o,c){return s=ae(6,s,null,o),s.lanes=c,s}function _n(s,o,c){return o=ae(4,s.children!==null?s.children:[],s.key,o),o.lanes=c,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function Fn(s,o,c,h,b){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ci(0),this.expirationTimes=ci(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ci(0),this.identifierPrefix=h,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function $s(s,o,c,h,b,C,R,re,fe){return s=new Fn(s,o,c,re,fe),o===1?(o=1,C===!0&&(o|=8)):o=0,C=ae(3,null,null,o),s.current=C,C.stateNode=s,C.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},fm(C),s}function $r(s,o,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:h==null?null:""+h,children:s,containerInfo:o,implementation:c}}function Ls(s){if(!s)return Vr;s=s._reactInternals;e:{if(Is(s)!==s||s.tag!==1)throw Error(n(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Tn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(s.tag===1){var c=s.type;if(Tn(c))return gu(s,c,o)}return o}function St(s,o,c,h,b,C,R,re,fe){return s=$s(c,h,!0,s,b,C,R,re,fe),s.context=Ls(null),c=s.current,h=gs(),b=Sa(c),C=ba(h,b),C.callback=o??null,xa(c,C,b),s.current.lanes=b,vo(s,b,h),Es(s,h),s}function Cn(s,o,c,h){var b=o.current,C=gs(),R=Sa(b);return c=Ls(c),o.context===null?o.context=c:o.pendingContext=c,o=ba(C,R),o.payload={element:s},h=h===void 0?null:h,h!==null&&(o.callback=h),s=xa(b,o,R),s!==null&&(_r(s,b,R,C),Cu(s,b,R)),R}function In(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function cn(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<o?c:o}}function Ds(s,o){cn(s,o),(s=s.alternate)&&cn(s,o)}function Xr(){return null}var Bn=typeof reportError=="function"?reportError:function(s){console.error(s)};function Ri(s){this._internalRoot=s}Ea.prototype.render=Ri.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));Cn(s,o,null,null)},Ea.prototype.unmount=Ri.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;eo(function(){Cn(null,s,null,null)}),o[qr]=null}};function Ea(s){this._internalRoot=s}Ea.prototype.unstable_scheduleHydration=function(s){if(s){var o=yl();s={blockedOn:null,target:s,priority:o};for(var c=0;c<jt.length&&o!==0&&o<jt[c].priority;c++);jt.splice(c,0,s),c===0&&wn(s)}};function qo(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function Ho(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Ku(){}function H_(s,o,c,h,b){if(b){if(typeof h=="function"){var C=h;h=function(){var Ne=In(R);C.call(Ne)}}var R=St(o,h,s,0,null,!1,!1,"",Ku);return s._reactRootContainer=R,s[qr]=R.current,Dl(s.nodeType===8?s.parentNode:s),eo(),R}for(;b=s.lastChild;)s.removeChild(b);if(typeof h=="function"){var re=h;h=function(){var Ne=In(fe);re.call(Ne)}}var fe=$s(s,0,!1,null,null,!1,!1,"",Ku);return s._reactRootContainer=fe,s[qr]=fe.current,Dl(s.nodeType===8?s.parentNode:s),eo(function(){Cn(o,fe,c,h)}),fe}function Yu(s,o,c,h,b){var C=c._reactRootContainer;if(C){var R=C;if(typeof b=="function"){var re=b;b=function(){var fe=In(R);re.call(fe)}}Cn(o,R,s,b)}else R=H_(c,o,s,b,h);return In(R)}_l=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var c=nr(o.pendingLanes);c!==0&&(gl(o,c|1),Es(o,Je()),!(Ht&6)&&(Di=Je()+500,Qa()))}break;case 13:eo(function(){var h=ya(s,1);if(h!==null){var b=gs();_r(h,s,1,b)}}),Ds(s,1)}},ui=function(s){if(s.tag===13){var o=ya(s,134217728);if(o!==null){var c=gs();_r(o,s,134217728,c)}Ds(s,134217728)}},vl=function(s){if(s.tag===13){var o=Sa(s),c=ya(s,o);if(c!==null){var h=gs();_r(c,s,o,h)}Ds(s,o)}},yl=function(){return Yt},oe=function(s,o){var c=Yt;try{return Yt=s,o()}finally{Yt=c}},kt=function(s,o,c){switch(o){case"input":if(Fe(s,c),o=c.name,c.type==="radio"&&o!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==s&&h.form===s.form){var b=hu(h);if(!b)throw Error(n(90));lt(h),Fe(h,b)}}}break;case"textarea":rt(s,c);break;case"select":o=c.value,o!=null&&J(s,!!c.multiple,o,!1)}},$t=Hu,Lt=eo;var jL={usingClientEntryPoint:!1,Events:[Hr,Xn,hu,Yn,yn,Hu]},Um={findFiberByHostInstance:Wa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},NL={bundleType:Um.bundleType,version:Um.version,rendererPackageName:Um.rendererPackageName,rendererConfig:Um.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=Rr(s),s===null?null:s.stateNode},findFiberByHostInstance:Um.findFiberByHostInstance||Xr,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xp.isDisabled&&xp.supportsFiber)try{ss=xp.inject(NL),Vt=xp}catch{}}return Ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jL,Ks.createPortal=function(s,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qo(o))throw Error(n(200));return $r(s,o,null,c)},Ks.createRoot=function(s,o){if(!qo(s))throw Error(n(299));var c=!1,h="",b=Bn;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=$s(s,1,!1,null,null,c,!1,h,b),s[qr]=o.current,Dl(s.nodeType===8?s.parentNode:s),new Ri(o)},Ks.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=Rr(o),s=s===null?null:s.stateNode,s},Ks.flushSync=function(s){return eo(s)},Ks.hydrate=function(s,o,c){if(!Ho(o))throw Error(n(200));return Yu(null,s,o,!0,c)},Ks.hydrateRoot=function(s,o,c){if(!qo(s))throw Error(n(405));var h=c!=null&&c.hydratedSources||null,b=!1,C="",R=Bn;if(c!=null&&(c.unstable_strictMode===!0&&(b=!0),c.identifierPrefix!==void 0&&(C=c.identifierPrefix),c.onRecoverableError!==void 0&&(R=c.onRecoverableError)),o=St(o,null,s,1,c??null,b,!1,C,R),s[qr]=o.current,Dl(s),h)for(s=0;s<h.length;s++)c=h[s],b=c._getVersion,b=b(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,b]:o.mutableSourceEagerHydrationData.push(c,b);return new Ea(o)},Ks.render=function(s,o,c){if(!Ho(o))throw Error(n(200));return Yu(null,s,o,!1,c)},Ks.unmountComponentAtNode=function(s){if(!Ho(s))throw Error(n(40));return s._reactRootContainer?(eo(function(){Yu(null,null,s,!1,function(){s._reactRootContainer=null,s[qr]=null})}),!0):!1},Ks.unstable_batchedUpdates=Hu,Ks.unstable_renderSubtreeIntoContainer=function(s,o,c,h){if(!Ho(c))throw Error(n(200));if(s==null||s._reactInternals===void 0)throw Error(n(38));return Yu(s,o,c,!1,h)},Ks.version="18.3.1-next-f1338f8080-20240426",Ks}function ov(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ov)}catch(e){console.error(e)}}ov(),nv.exports=lj();var cj=nv.exports,iv=cj;Np.createRoot=iv.createRoot,Np.hydrateRoot=iv.hydrateRoot;var mc=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},uj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},dj=(Vw=class{constructor(){ht(this,ei,uj);ht(this,g_,!1)}setTimeoutProvider(e){et(this,ei,e)}setTimeout(e,t){return me(this,ei).setTimeout(e,t)}clearTimeout(e){me(this,ei).clearTimeout(e)}setInterval(e,t){return me(this,ei).setInterval(e,t)}clearInterval(e){me(this,ei).clearInterval(e)}},ei=new WeakMap,g_=new WeakMap,Vw),Ui=new dj;function mj(e){setTimeout(e,0)}var qi=typeof window>"u"||"Deno"in globalThis;function zs(){}function fj(e,t){return typeof e=="function"?e(t):e}function Ep(e){return typeof e=="number"&&e>=0&&e!==1/0}function lv(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Wo(e,t){return typeof e=="function"?e(t):e}function Lr(e,t){return typeof e=="function"?e(t):e}function cv(e,t){const{type:n="all",exact:r,fetchStatus:i,predicate:l,queryKey:u,stale:d}=e;if(u){if(r){if(t.queryHash!==kp(u,t.options))return!1}else if(!Qu(t.queryKey,u))return!1}if(n!=="all"){const m=t.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof d=="boolean"&&t.isStale()!==d||i&&i!==t.state.fetchStatus||l&&!l(t))}function uv(e,t){const{exact:n,status:r,predicate:i,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(n){if(Hi(t.options.mutationKey)!==Hi(l))return!1}else if(!Qu(t.options.mutationKey,l))return!1}return!(r&&t.state.status!==r||i&&!i(t))}function kp(e,t){return((t==null?void 0:t.queryKeyHashFn)||Hi)(e)}function Hi(e){return JSON.stringify(e,(t,n)=>Mp(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Qu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Qu(e[n],t[n])):!1}var hj=Object.prototype.hasOwnProperty;function dv(e,t){if(e===t)return e;const n=mv(e)&&mv(t);if(!n&&!(Mp(e)&&Mp(t)))return t;const i=(n?e:Object.keys(e)).length,l=n?t:Object.keys(t),u=l.length,d=n?new Array(u):{};let m=0;for(let y=0;y<u;y++){const p=n?y:l[y],_=e[p],v=t[p];if(_===v){d[p]=_,(n?y<i:hj.call(e,p))&&m++;continue}if(_===null||v===null||typeof _!="object"||typeof v!="object"){d[p]=v;continue}const w=dv(_,v);d[p]=w,w===_&&m++}return i===u&&m===i?e:d}function Hm(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function mv(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Mp(e){if(!fv(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!fv(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function fv(e){return Object.prototype.toString.call(e)==="[object Object]"}function pj(e){return new Promise(t=>{Ui.setTimeout(t,e)})}function Ap(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?dv(e,t):t}function gj(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function _j(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var Op=Symbol();function hv(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Op?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function pv(e,t){return typeof e=="function"?e(...t):!!e}var vj=(Ww=class extends mc{constructor(){super();ht(this,il);ht(this,ti);ht(this,Tc);et(this,Tc,t=>{if(!qi&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){me(this,ti)||this.setEventListener(me(this,Tc))}onUnsubscribe(){var t;this.hasListeners()||((t=me(this,ti))==null||t.call(this),et(this,ti,void 0))}setEventListener(t){var n;et(this,Tc,t),(n=me(this,ti))==null||n.call(this),et(this,ti,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){me(this,il)!==t&&(et(this,il,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof me(this,il)=="boolean"?me(this,il):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},il=new WeakMap,ti=new WeakMap,Tc=new WeakMap,Ww),Pp=new vj;function Tp(){let e,t;const n=new Promise((i,l)=>{e=i,t=l});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),e(i)},n.reject=i=>{r({status:"rejected",reason:i}),t(i)},n}var yj=mj;function bj(){let e=[],t=0,n=d=>{d()},r=d=>{d()},i=yj;const l=d=>{t?e.push(d):i(()=>{n(d)})},u=()=>{const d=e;e=[],d.length&&i(()=>{r(()=>{d.forEach(m=>{n(m)})})})};return{batch:d=>{let m;t++;try{m=d()}finally{t--,t||u()}return m},batchCalls:d=>(...m)=>{l(()=>{d(...m)})},schedule:l,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{i=d}}}var ts=bj(),xj=(Kw=class extends mc{constructor(){super();ht(this,$c,!0);ht(this,ni);ht(this,Lc);et(this,Lc,t=>{if(!qi&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){me(this,ni)||this.setEventListener(me(this,Lc))}onUnsubscribe(){var t;this.hasListeners()||((t=me(this,ni))==null||t.call(this),et(this,ni,void 0))}setEventListener(t){var n;et(this,Lc,t),(n=me(this,ni))==null||n.call(this),et(this,ni,t(this.setOnline.bind(this)))}setOnline(t){me(this,$c)!==t&&(et(this,$c,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return me(this,$c)}},$c=new WeakMap,ni=new WeakMap,Lc=new WeakMap,Kw),Vm=new xj;function wj(e){return Math.min(1e3*2**e,3e4)}function gv(e){return(e??"online")==="online"?Vm.isOnline():!0}var $p=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function _v(e){let t=!1,n=0,r;const i=Tp(),l=()=>i.status!=="pending",u=S=>{var E;if(!l()){const A=new $p(S);v(A),(E=e.onCancel)==null||E.call(e,A)}},d=()=>{t=!0},m=()=>{t=!1},y=()=>Pp.isFocused()&&(e.networkMode==="always"||Vm.isOnline())&&e.canRun(),p=()=>gv(e.networkMode)&&e.canRun(),_=S=>{l()||(r==null||r(),i.resolve(S))},v=S=>{l()||(r==null||r(),i.reject(S))},w=()=>new Promise(S=>{var E;r=A=>{(l()||y())&&S(A)},(E=e.onPause)==null||E.call(e)}).then(()=>{var S;r=void 0,l()||(S=e.onContinue)==null||S.call(e)}),x=()=>{if(l())return;let S;const E=n===0?e.initialPromise:void 0;try{S=E??e.fn()}catch(A){S=Promise.reject(A)}Promise.resolve(S).then(_).catch(A=>{var k;if(l())return;const P=e.retry??(qi?0:3),T=e.retryDelay??wj,j=typeof T=="function"?T(n,A):T,O=P===!0||typeof P=="number"&&n<P||typeof P=="function"&&P(n,A);if(t||!O){v(A);return}n++,(k=e.onFail)==null||k.call(e,n,A),pj(j).then(()=>y()?void 0:w()).then(()=>{t?v(A):x()})})};return{promise:i,status:()=>i.status,cancel:u,continue:()=>(r==null||r(),i),cancelRetry:d,continueRetry:m,canStart:p,start:()=>(p()?x():w().then(x),i)}}var vv=(Yw=class{constructor(){ht(this,ll)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Ep(this.gcTime)&&et(this,ll,Ui.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(qi?1/0:5*60*1e3))}clearGcTimeout(){me(this,ll)&&(Ui.clearTimeout(me(this,ll)),et(this,ll,void 0))}},ll=new WeakMap,Yw),jj={NODE_ENV:"production"},Nj=(Qw=class extends vv{constructor(t){super();ht(this,na);ht(this,cl);ht(this,Dc);ht(this,Dr);ht(this,ul);ht(this,cs);ht(this,$d);ht(this,dl);et(this,dl,!1),et(this,$d,t.defaultOptions),this.setOptions(t.options),this.observers=[],et(this,ul,t.client),et(this,Dr,me(this,ul).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,et(this,cl,bv(this.options)),this.state=t.state??me(this,cl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=me(this,cs))==null?void 0:t.promise}setOptions(t){if(this.options={...me(this,$d),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=bv(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),et(this,cl,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&me(this,Dr).remove(this)}setData(t,n){const r=Ap(this.state.data,t,this.options);return Rt(this,na,Vo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Rt(this,na,Vo).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,i;const n=(r=me(this,cs))==null?void 0:r.promise;return(i=me(this,cs))==null||i.cancel(t),n?n.then(zs).catch(zs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(me(this,cl))}isActive(){return this.observers.some(t=>Lr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Op||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Wo(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!lv(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=me(this,cs))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=me(this,cs))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),me(this,Dr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(me(this,cs)&&(me(this,dl)?me(this,cs).cancel({revert:!0}):me(this,cs).cancelRetry()),this.scheduleGc()),me(this,Dr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Rt(this,na,Vo).call(this,{type:"invalidate"})}async fetch(t,n){var m,y,p,_,v,w,x,S,E,A,P,T;if(this.state.fetchStatus!=="idle"&&((m=me(this,cs))==null?void 0:m.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(me(this,cs))return me(this,cs).continueRetry(),me(this,cs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(O=>O.options.queryFn);j&&this.setOptions(j.options)}const r=new AbortController,i=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(et(this,dl,!0),r.signal)})},l=()=>{const j=hv(this.options,n),k=(()=>{const D={client:me(this,ul),queryKey:this.queryKey,meta:this.meta};return i(D),D})();return et(this,dl,!1),this.options.persister?this.options.persister(j,k,this):j(k)},d=(()=>{const j={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:me(this,ul),state:this.state,fetchFn:l};return i(j),j})();(y=this.options.behavior)==null||y.onFetch(d,this),et(this,Dc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=d.fetchOptions)==null?void 0:p.meta))&&Rt(this,na,Vo).call(this,{type:"fetch",meta:(_=d.fetchOptions)==null?void 0:_.meta}),et(this,cs,_v({initialPromise:n==null?void 0:n.initialPromise,fn:d.fetchFn,onCancel:j=>{j instanceof $p&&j.revert&&this.setState({...me(this,Dc),fetchStatus:"idle"}),r.abort()},onFail:(j,O)=>{Rt(this,na,Vo).call(this,{type:"failed",failureCount:j,error:O})},onPause:()=>{Rt(this,na,Vo).call(this,{type:"pause"})},onContinue:()=>{Rt(this,na,Vo).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const j=await me(this,cs).start();if(j===void 0)throw jj.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(j),(w=(v=me(this,Dr).config).onSuccess)==null||w.call(v,j,this),(S=(x=me(this,Dr).config).onSettled)==null||S.call(x,j,this.state.error,this),j}catch(j){if(j instanceof $p){if(j.silent)return me(this,cs).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw Rt(this,na,Vo).call(this,{type:"error",error:j}),(A=(E=me(this,Dr).config).onError)==null||A.call(E,j,this),(T=(P=me(this,Dr).config).onSettled)==null||T.call(P,this.state.data,j,this),j}finally{this.scheduleGc()}}},cl=new WeakMap,Dc=new WeakMap,Dr=new WeakMap,ul=new WeakMap,cs=new WeakMap,$d=new WeakMap,dl=new WeakMap,na=new WeakSet,Vo=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...yv(r.data,this.options),fetchMeta:t.meta??null};case"success":const i={...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return et(this,Dc,t.manual?i:void 0),i;case"error":const l=t.error;return{...r,error:l,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ts.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),me(this,Dr).notify({query:this,type:"updated",action:t})})},Qw);function yv(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:gv(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function bv(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Sj=(Gw=class extends mc{constructor(t,n){super();ht(this,Zt);ht(this,Js);ht(this,qt);ht(this,Ld);ht(this,Rs);ht(this,ml);ht(this,zc);ht(this,uo);ht(this,si);ht(this,Dd);ht(this,Rc);ht(this,Fc);ht(this,fl);ht(this,hl);ht(this,ri);ht(this,Ic,new Set);this.options=n,et(this,Js,t),et(this,si,null),et(this,uo,Tp()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(me(this,qt).addObserver(this),xv(me(this,qt),this.options)?Rt(this,Zt,qm).call(this):this.updateResult(),Rt(this,Zt,Q_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Lp(me(this,qt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Lp(me(this,qt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Rt(this,Zt,G_).call(this),Rt(this,Zt,X_).call(this),me(this,qt).removeObserver(this)}setOptions(t){const n=this.options,r=me(this,qt);if(this.options=me(this,Js).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Lr(this.options.enabled,me(this,qt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Rt(this,Zt,J_).call(this),me(this,qt).setOptions(this.options),n._defaulted&&!Hm(this.options,n)&&me(this,Js).getQueryCache().notify({type:"observerOptionsUpdated",query:me(this,qt),observer:this});const i=this.hasListeners();i&&wv(me(this,qt),r,this.options,n)&&Rt(this,Zt,qm).call(this),this.updateResult(),i&&(me(this,qt)!==r||Lr(this.options.enabled,me(this,qt))!==Lr(n.enabled,me(this,qt))||Wo(this.options.staleTime,me(this,qt))!==Wo(n.staleTime,me(this,qt)))&&Rt(this,Zt,W_).call(this);const l=Rt(this,Zt,K_).call(this);i&&(me(this,qt)!==r||Lr(this.options.enabled,me(this,qt))!==Lr(n.enabled,me(this,qt))||l!==me(this,ri))&&Rt(this,Zt,Y_).call(this,l)}getOptimisticResult(t){const n=me(this,Js).getQueryCache().build(me(this,Js),t),r=this.createResult(n,t);return Ej(this,r)&&(et(this,Rs,r),et(this,zc,this.options),et(this,ml,me(this,qt).state)),r}getCurrentResult(){return me(this,Rs)}trackResult(t,n){return new Proxy(t,{get:(r,i)=>(this.trackProp(i),n==null||n(i),i==="promise"&&!this.options.experimental_prefetchInRender&&me(this,uo).status==="pending"&&me(this,uo).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(r,i))})}trackProp(t){me(this,Ic).add(t)}getCurrentQuery(){return me(this,qt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=me(this,Js).defaultQueryOptions(t),r=me(this,Js).getQueryCache().build(me(this,Js),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return Rt(this,Zt,qm).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),me(this,Rs)))}createResult(t,n){var B;const r=me(this,qt),i=this.options,l=me(this,Rs),u=me(this,ml),d=me(this,zc),y=t!==r?t.state:me(this,Ld),{state:p}=t;let _={...p},v=!1,w;if(n._optimisticResults){const q=this.hasListeners(),K=!q&&xv(t,n),ne=q&&wv(t,r,n,i);(K||ne)&&(_={..._,...yv(p.data,t.options)}),n._optimisticResults==="isRestoring"&&(_.fetchStatus="idle")}let{error:x,errorUpdatedAt:S,status:E}=_;w=_.data;let A=!1;if(n.placeholderData!==void 0&&w===void 0&&E==="pending"){let q;l!=null&&l.isPlaceholderData&&n.placeholderData===(d==null?void 0:d.placeholderData)?(q=l.data,A=!0):q=typeof n.placeholderData=="function"?n.placeholderData((B=me(this,Fc))==null?void 0:B.state.data,me(this,Fc)):n.placeholderData,q!==void 0&&(E="success",w=Ap(l==null?void 0:l.data,q,n),v=!0)}if(n.select&&w!==void 0&&!A)if(l&&w===(u==null?void 0:u.data)&&n.select===me(this,Dd))w=me(this,Rc);else try{et(this,Dd,n.select),w=n.select(w),w=Ap(l==null?void 0:l.data,w,n),et(this,Rc,w),et(this,si,null)}catch(q){et(this,si,q)}me(this,si)&&(x=me(this,si),w=me(this,Rc),S=Date.now(),E="error");const P=_.fetchStatus==="fetching",T=E==="pending",j=E==="error",O=T&&P,k=w!==void 0,$={status:E,fetchStatus:_.fetchStatus,isPending:T,isSuccess:E==="success",isError:j,isInitialLoading:O,isLoading:O,data:w,dataUpdatedAt:_.dataUpdatedAt,error:x,errorUpdatedAt:S,failureCount:_.fetchFailureCount,failureReason:_.fetchFailureReason,errorUpdateCount:_.errorUpdateCount,isFetched:_.dataUpdateCount>0||_.errorUpdateCount>0,isFetchedAfterMount:_.dataUpdateCount>y.dataUpdateCount||_.errorUpdateCount>y.errorUpdateCount,isFetching:P,isRefetching:P&&!T,isLoadingError:j&&!k,isPaused:_.fetchStatus==="paused",isPlaceholderData:v,isRefetchError:j&&k,isStale:Dp(t,n),refetch:this.refetch,promise:me(this,uo),isEnabled:Lr(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const q=ue=>{$.status==="error"?ue.reject($.error):$.data!==void 0&&ue.resolve($.data)},K=()=>{const ue=et(this,uo,$.promise=Tp());q(ue)},ne=me(this,uo);switch(ne.status){case"pending":t.queryHash===r.queryHash&&q(ne);break;case"fulfilled":($.status==="error"||$.data!==ne.value)&&K();break;case"rejected":($.status!=="error"||$.error!==ne.reason)&&K();break}}return $}updateResult(){const t=me(this,Rs),n=this.createResult(me(this,qt),this.options);if(et(this,ml,me(this,qt).state),et(this,zc,this.options),me(this,ml).data!==void 0&&et(this,Fc,me(this,qt)),Hm(n,t))return;et(this,Rs,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,l=typeof i=="function"?i():i;if(l==="all"||!l&&!me(this,Ic).size)return!0;const u=new Set(l??me(this,Ic));return this.options.throwOnError&&u.add("error"),Object.keys(me(this,Rs)).some(d=>{const m=d;return me(this,Rs)[m]!==t[m]&&u.has(m)})};Rt(this,Zt,sj).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Rt(this,Zt,Q_).call(this)}},Js=new WeakMap,qt=new WeakMap,Ld=new WeakMap,Rs=new WeakMap,ml=new WeakMap,zc=new WeakMap,uo=new WeakMap,si=new WeakMap,Dd=new WeakMap,Rc=new WeakMap,Fc=new WeakMap,fl=new WeakMap,hl=new WeakMap,ri=new WeakMap,Ic=new WeakMap,Zt=new WeakSet,qm=function(t){Rt(this,Zt,J_).call(this);let n=me(this,qt).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(zs)),n},W_=function(){Rt(this,Zt,G_).call(this);const t=Wo(this.options.staleTime,me(this,qt));if(qi||me(this,Rs).isStale||!Ep(t))return;const r=lv(me(this,Rs).dataUpdatedAt,t)+1;et(this,fl,Ui.setTimeout(()=>{me(this,Rs).isStale||this.updateResult()},r))},K_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(me(this,qt)):this.options.refetchInterval)??!1},Y_=function(t){Rt(this,Zt,X_).call(this),et(this,ri,t),!(qi||Lr(this.options.enabled,me(this,qt))===!1||!Ep(me(this,ri))||me(this,ri)===0)&&et(this,hl,Ui.setInterval(()=>{(this.options.refetchIntervalInBackground||Pp.isFocused())&&Rt(this,Zt,qm).call(this)},me(this,ri)))},Q_=function(){Rt(this,Zt,W_).call(this),Rt(this,Zt,Y_).call(this,Rt(this,Zt,K_).call(this))},G_=function(){me(this,fl)&&(Ui.clearTimeout(me(this,fl)),et(this,fl,void 0))},X_=function(){me(this,hl)&&(Ui.clearInterval(me(this,hl)),et(this,hl,void 0))},J_=function(){const t=me(this,Js).getQueryCache().build(me(this,Js),this.options);if(t===me(this,qt))return;const n=me(this,qt);et(this,qt,t),et(this,Ld,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},sj=function(t){ts.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(me(this,Rs))}),me(this,Js).getQueryCache().notify({query:me(this,qt),type:"observerResultsUpdated"})})},Gw);function Cj(e,t){return Lr(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function xv(e,t){return Cj(e,t)||e.state.data!==void 0&&Lp(e,t,t.refetchOnMount)}function Lp(e,t,n){if(Lr(t.enabled,e)!==!1&&Wo(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&Dp(e,t)}return!1}function wv(e,t,n,r){return(e!==t||Lr(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Dp(e,n)}function Dp(e,t){return Lr(t.enabled,e)!==!1&&e.isStaleByTime(Wo(t.staleTime,e))}function Ej(e,t){return!Hm(e.getCurrentResult(),t)}function jv(e){return{onFetch:(t,n)=>{var p,_,v,w,x;const r=t.options,i=(v=(_=(p=t.fetchOptions)==null?void 0:p.meta)==null?void 0:_.fetchMore)==null?void 0:v.direction,l=((w=t.state.data)==null?void 0:w.pages)||[],u=((x=t.state.data)==null?void 0:x.pageParams)||[];let d={pages:[],pageParams:[]},m=0;const y=async()=>{let S=!1;const E=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(t.signal.aborted?S=!0:t.signal.addEventListener("abort",()=>{S=!0}),t.signal)})},A=hv(t.options,t.fetchOptions),P=async(T,j,O)=>{if(S)return Promise.reject();if(j==null&&T.pages.length)return Promise.resolve(T);const D=(()=>{const K={client:t.client,queryKey:t.queryKey,pageParam:j,direction:O?"backward":"forward",meta:t.options.meta};return E(K),K})(),$=await A(D),{maxPages:B}=t.options,q=O?_j:gj;return{pages:q(T.pages,$,B),pageParams:q(T.pageParams,j,B)}};if(i&&l.length){const T=i==="backward",j=T?kj:Nv,O={pages:l,pageParams:u},k=j(r,O);d=await P(O,k,T)}else{const T=e??l.length;do{const j=m===0?u[0]??r.initialPageParam:Nv(r,d);if(m>0&&j==null)break;d=await P(d,j),m++}while(m<T)}return d};t.options.persister?t.fetchFn=()=>{var S,E;return(E=(S=t.options).persister)==null?void 0:E.call(S,y,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=y}}}function Nv(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function kj(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var Mj=(Xw=class extends vv{constructor(t){super();ht(this,Ta);ht(this,zd);ht(this,Pa);ht(this,Fs);ht(this,pl);et(this,zd,t.client),this.mutationId=t.mutationId,et(this,Fs,t.mutationCache),et(this,Pa,[]),this.state=t.state||Sv(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){me(this,Pa).includes(t)||(me(this,Pa).push(t),this.clearGcTimeout(),me(this,Fs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){et(this,Pa,me(this,Pa).filter(n=>n!==t)),this.scheduleGc(),me(this,Fs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){me(this,Pa).length||(this.state.status==="pending"?this.scheduleGc():me(this,Fs).remove(this))}continue(){var t;return((t=me(this,pl))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var u,d,m,y,p,_,v,w,x,S,E,A,P,T,j,O,k,D,$,B;const n=()=>{Rt(this,Ta,Ii).call(this,{type:"continue"})},r={client:me(this,zd),meta:this.options.meta,mutationKey:this.options.mutationKey};et(this,pl,_v({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(q,K)=>{Rt(this,Ta,Ii).call(this,{type:"failed",failureCount:q,error:K})},onPause:()=>{Rt(this,Ta,Ii).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>me(this,Fs).canRun(this)}));const i=this.state.status==="pending",l=!me(this,pl).canStart();try{if(i)n();else{Rt(this,Ta,Ii).call(this,{type:"pending",variables:t,isPaused:l}),await((d=(u=me(this,Fs).config).onMutate)==null?void 0:d.call(u,t,this,r));const K=await((y=(m=this.options).onMutate)==null?void 0:y.call(m,t,r));K!==this.state.context&&Rt(this,Ta,Ii).call(this,{type:"pending",context:K,variables:t,isPaused:l})}const q=await me(this,pl).start();return await((_=(p=me(this,Fs).config).onSuccess)==null?void 0:_.call(p,q,t,this.state.context,this,r)),await((w=(v=this.options).onSuccess)==null?void 0:w.call(v,q,t,this.state.context,r)),await((S=(x=me(this,Fs).config).onSettled)==null?void 0:S.call(x,q,null,this.state.variables,this.state.context,this,r)),await((A=(E=this.options).onSettled)==null?void 0:A.call(E,q,null,t,this.state.context,r)),Rt(this,Ta,Ii).call(this,{type:"success",data:q}),q}catch(q){try{throw await((T=(P=me(this,Fs).config).onError)==null?void 0:T.call(P,q,t,this.state.context,this,r)),await((O=(j=this.options).onError)==null?void 0:O.call(j,q,t,this.state.context,r)),await((D=(k=me(this,Fs).config).onSettled)==null?void 0:D.call(k,void 0,q,this.state.variables,this.state.context,this,r)),await((B=($=this.options).onSettled)==null?void 0:B.call($,void 0,q,t,this.state.context,r)),q}finally{Rt(this,Ta,Ii).call(this,{type:"error",error:q})}}finally{me(this,Fs).runNext(this)}}},zd=new WeakMap,Pa=new WeakMap,Fs=new WeakMap,pl=new WeakMap,Ta=new WeakSet,Ii=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ts.batch(()=>{me(this,Pa).forEach(r=>{r.onMutationUpdate(t)}),me(this,Fs).notify({mutation:this,type:"updated",action:t})})},Xw);function Sv(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Aj=(Jw=class extends mc{constructor(t={}){super();ht(this,mo);ht(this,sa);ht(this,Rd);this.config=t,et(this,mo,new Set),et(this,sa,new Map),et(this,Rd,0)}build(t,n,r){const i=new Mj({client:t,mutationCache:this,mutationId:++wp(this,Rd)._,options:t.defaultMutationOptions(n),state:r});return this.add(i),i}add(t){me(this,mo).add(t);const n=Wm(t);if(typeof n=="string"){const r=me(this,sa).get(n);r?r.push(t):me(this,sa).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(me(this,mo).delete(t)){const n=Wm(t);if(typeof n=="string"){const r=me(this,sa).get(n);if(r)if(r.length>1){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}else r[0]===t&&me(this,sa).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Wm(t);if(typeof n=="string"){const r=me(this,sa).get(n),i=r==null?void 0:r.find(l=>l.state.status==="pending");return!i||i===t}else return!0}runNext(t){var r;const n=Wm(t);if(typeof n=="string"){const i=(r=me(this,sa).get(n))==null?void 0:r.find(l=>l!==t&&l.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ts.batch(()=>{me(this,mo).forEach(t=>{this.notify({type:"removed",mutation:t})}),me(this,mo).clear(),me(this,sa).clear()})}getAll(){return Array.from(me(this,mo))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>uv(n,r))}findAll(t={}){return this.getAll().filter(n=>uv(t,n))}notify(t){ts.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ts.batch(()=>Promise.all(t.map(n=>n.continue().catch(zs))))}},mo=new WeakMap,sa=new WeakMap,Rd=new WeakMap,Jw);function Wm(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Oj=(Zw=class extends mc{constructor(t,n){super();ht(this,po);ht(this,fo);ht(this,ai);ht(this,Zs);ht(this,ho);et(this,fo,t),this.setOptions(n),this.bindMethods(),Rt(this,po,jp).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const n=this.options;this.options=me(this,fo).defaultMutationOptions(t),Hm(this.options,n)||me(this,fo).getMutationCache().notify({type:"observerOptionsUpdated",mutation:me(this,Zs),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Hi(n.mutationKey)!==Hi(this.options.mutationKey)?this.reset():((r=me(this,Zs))==null?void 0:r.state.status)==="pending"&&me(this,Zs).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=me(this,Zs))==null||t.removeObserver(this)}onMutationUpdate(t){Rt(this,po,jp).call(this),Rt(this,po,Z_).call(this,t)}getCurrentResult(){return me(this,ai)}reset(){var t;(t=me(this,Zs))==null||t.removeObserver(this),et(this,Zs,void 0),Rt(this,po,jp).call(this),Rt(this,po,Z_).call(this)}mutate(t,n){var r;return et(this,ho,n),(r=me(this,Zs))==null||r.removeObserver(this),et(this,Zs,me(this,fo).getMutationCache().build(me(this,fo),this.options)),me(this,Zs).addObserver(this),me(this,Zs).execute(t)}},fo=new WeakMap,ai=new WeakMap,Zs=new WeakMap,ho=new WeakMap,po=new WeakSet,jp=function(){var n;const t=((n=me(this,Zs))==null?void 0:n.state)??Sv();et(this,ai,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Z_=function(t){ts.batch(()=>{var n,r,i,l,u,d,m,y;if(me(this,ho)&&this.hasListeners()){const p=me(this,ai).variables,_=me(this,ai).context,v={client:me(this,fo),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((r=(n=me(this,ho)).onSuccess)==null||r.call(n,t.data,p,_,v),(l=(i=me(this,ho)).onSettled)==null||l.call(i,t.data,null,p,_,v)):(t==null?void 0:t.type)==="error"&&((d=(u=me(this,ho)).onError)==null||d.call(u,t.error,p,_,v),(y=(m=me(this,ho)).onSettled)==null||y.call(m,void 0,t.error,p,_,v))}this.listeners.forEach(p=>{p(me(this,ai))})})},Zw),Pj=(ej=class extends mc{constructor(t={}){super();ht(this,$a);this.config=t,et(this,$a,new Map)}build(t,n,r){const i=n.queryKey,l=n.queryHash??kp(i,n);let u=this.get(l);return u||(u=new Nj({client:t,queryKey:i,queryHash:l,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(i)}),this.add(u)),u}add(t){me(this,$a).has(t.queryHash)||(me(this,$a).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=me(this,$a).get(t.queryHash);n&&(t.destroy(),n===t&&me(this,$a).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ts.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return me(this,$a).get(t)}getAll(){return[...me(this,$a).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>cv(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>cv(t,r)):n}notify(t){ts.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ts.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ts.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},$a=new WeakMap,ej),Tj=(tj=class{constructor(e={}){ht(this,Ln);ht(this,oi);ht(this,ii);ht(this,Bc);ht(this,Uc);ht(this,li);ht(this,qc);ht(this,Hc);et(this,Ln,e.queryCache||new Pj),et(this,oi,e.mutationCache||new Aj),et(this,ii,e.defaultOptions||{}),et(this,Bc,new Map),et(this,Uc,new Map),et(this,li,0)}mount(){wp(this,li)._++,me(this,li)===1&&(et(this,qc,Pp.subscribe(async e=>{e&&(await this.resumePausedMutations(),me(this,Ln).onFocus())})),et(this,Hc,Vm.subscribe(async e=>{e&&(await this.resumePausedMutations(),me(this,Ln).onOnline())})))}unmount(){var e,t;wp(this,li)._--,me(this,li)===0&&((e=me(this,qc))==null||e.call(this),et(this,qc,void 0),(t=me(this,Hc))==null||t.call(this),et(this,Hc,void 0))}isFetching(e){return me(this,Ln).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return me(this,oi).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=me(this,Ln).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=me(this,Ln).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Wo(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return me(this,Ln).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),i=me(this,Ln).get(r.queryHash),l=i==null?void 0:i.state.data,u=fj(t,l);if(u!==void 0)return me(this,Ln).build(this,r).setData(u,{...n,manual:!0})}setQueriesData(e,t,n){return ts.batch(()=>me(this,Ln).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=me(this,Ln).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=me(this,Ln);ts.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=me(this,Ln);return ts.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ts.batch(()=>me(this,Ln).findAll(e).map(i=>i.cancel(n)));return Promise.all(r).then(zs).catch(zs)}invalidateQueries(e,t={}){return ts.batch(()=>(me(this,Ln).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ts.batch(()=>me(this,Ln).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let l=i.fetch(void 0,n);return n.throwOnError||(l=l.catch(zs)),i.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(r).then(zs)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=me(this,Ln).build(this,t);return n.isStaleByTime(Wo(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(zs).catch(zs)}fetchInfiniteQuery(e){return e.behavior=jv(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(zs).catch(zs)}ensureInfiniteQueryData(e){return e.behavior=jv(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Vm.isOnline()?me(this,oi).resumePausedMutations():Promise.resolve()}getQueryCache(){return me(this,Ln)}getMutationCache(){return me(this,oi)}getDefaultOptions(){return me(this,ii)}setDefaultOptions(e){et(this,ii,e)}setQueryDefaults(e,t){me(this,Bc).set(Hi(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...me(this,Bc).values()],n={};return t.forEach(r=>{Qu(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){me(this,Uc).set(Hi(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...me(this,Uc).values()],n={};return t.forEach(r=>{Qu(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...me(this,ii).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=kp(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Op&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...me(this,ii).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){me(this,Ln).clear(),me(this,oi).clear()}},Ln=new WeakMap,oi=new WeakMap,ii=new WeakMap,Bc=new WeakMap,Uc=new WeakMap,li=new WeakMap,qc=new WeakMap,Hc=new WeakMap,tj),Cv=f.createContext(void 0),fc=e=>{const t=f.useContext(Cv);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},$j=({client:e,children:t})=>(f.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(Cv.Provider,{value:e,children:t})),Ev=f.createContext(!1),Lj=()=>f.useContext(Ev);Ev.Provider;function Dj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var zj=f.createContext(Dj()),Rj=()=>f.useContext(zj),Fj=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Ij=e=>{f.useEffect(()=>{e.clearReset()},[e])},Bj=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&e.data===void 0||pv(n,[e.error,r])),Uj=e=>{if(e.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...i)=>n(r(...i)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},qj=(e,t)=>e.isLoading&&e.isFetching&&!t,Hj=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,kv=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Vj(e,t,n){var _,v,w,x,S;const r=Lj(),i=Rj(),l=fc(),u=l.defaultQueryOptions(e);(v=(_=l.getDefaultOptions().queries)==null?void 0:_._experimental_beforeQuery)==null||v.call(_,u),u._optimisticResults=r?"isRestoring":"optimistic",Uj(u),Fj(u,i),Ij(i);const d=!l.getQueryCache().get(u.queryHash),[m]=f.useState(()=>new t(l,u)),y=m.getOptimisticResult(u),p=!r&&e.subscribed!==!1;if(f.useSyncExternalStore(f.useCallback(E=>{const A=p?m.subscribe(ts.batchCalls(E)):zs;return m.updateResult(),A},[m,p]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),f.useEffect(()=>{m.setOptions(u)},[u,m]),Hj(u,y))throw kv(u,m,i);if(Bj({result:y,errorResetBoundary:i,throwOnError:u.throwOnError,query:l.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw y.error;if((x=(w=l.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||x.call(w,u,y),u.experimental_prefetchInRender&&!qi&&qj(y,r)){const E=d?kv(u,m,i):(S=l.getQueryCache().get(u.queryHash))==null?void 0:S.promise;E==null||E.catch(zs).finally(()=>{m.updateResult()})}return u.notifyOnChangeProps?y:m.trackResult(y)}function vr(e,t){return Vj(e,Sj)}function Km(e,t){const n=fc(),[r]=f.useState(()=>new Oj(n,e));f.useEffect(()=>{r.setOptions(e)},[r,e]);const i=f.useSyncExternalStore(f.useCallback(u=>r.subscribe(ts.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),l=f.useCallback((u,d)=>{r.mutate(u,d).catch(zs)},[r]);if(i.error&&pv(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}function Wj(e){let t;const n=new Set,r=(y,p)=>{const _=typeof y=="function"?y(t):y;if(_!==t){const v=t;t=p?_:Object.assign({},t,_),n.forEach(w=>w(t,v))}},i=()=>t,l=(y,p=i,_=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let v=p(t);function w(){const x=p(t);if(!_(v,x)){const S=v;y(v=x,S)}}return n.add(w),()=>n.delete(w)},m={setState:r,getState:i,subscribe:(y,p,_)=>p||_?l(y,p,_):(n.add(y),()=>n.delete(y)),destroy:()=>n.clear()};return t=e(r,i,m),m}const Mv=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?f.useEffect:f.useLayoutEffect;function Kj(e){const t=typeof e=="function"?Wj(e):e,n=(r=t.getState,i=Object.is)=>{const[,l]=f.useReducer(E=>E+1,0),u=t.getState(),d=f.useRef(u),m=f.useRef(r),y=f.useRef(i),p=f.useRef(!1),_=f.useRef();_.current===void 0&&(_.current=r(u));let v,w=!1;(d.current!==u||m.current!==r||y.current!==i||p.current)&&(v=r(u),w=!i(_.current,v)),Mv(()=>{w&&(_.current=v),d.current=u,m.current=r,y.current=i,p.current=!1});const x=f.useRef(u);Mv(()=>{const E=()=>{try{const P=t.getState(),T=m.current(P);y.current(_.current,T)||(d.current=P,_.current=T,l())}catch{p.current=!0,l()}},A=t.subscribe(E);return t.getState()!==x.current&&E(),A},[]);const S=w?v:_.current;return f.useDebugValue(S),S};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const i=r.length<=0;return{value:r.shift(),done:i}}}},n}function Yj(){const e=f.createContext(void 0);return{Provider:({initialStore:i,createStore:l,children:u})=>{const d=f.useRef();return d.current||(i&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),l||(l=()=>i)),d.current=l()),f.createElement(e.Provider,{value:d.current},u)},useStore:(i,l=Object.is)=>{const u=f.useContext(e);if(!u)throw new Error("Seems like you have not used zustand provider as an ancestor.");return u(i,l)},useStoreApi:()=>{const i=f.useContext(e);if(!i)throw new Error("Seems like you have not used zustand provider as an ancestor.");return f.useMemo(()=>({getState:i.getState,setState:i.setState,subscribe:i.subscribe,destroy:i.destroy}),[i])}}}var Qj={value:()=>{}};function Ym(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Qm(n)}function Qm(e){this._=e}function Gj(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Qm.prototype=Ym.prototype={constructor:Qm,on:function(e,t){var n=this._,r=Gj(e+"",n),i,l=-1,u=r.length;if(arguments.length<2){for(;++l<u;)if((i=(e=r[l]).type)&&(i=Xj(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<u;)if(i=(e=r[l]).type)n[i]=Av(n[i],e.name,t);else if(t==null)for(i in n)n[i]=Av(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Qm(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,l;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],r=0,i=l.length;r<i;++r)l[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],i=0,l=r.length;i<l;++i)r[i].value.apply(t,n)}};function Xj(e,t){for(var n=0,r=e.length,i;n<r;++n)if((i=e[n]).name===t)return i.value}function Av(e,t,n){for(var r=0,i=e.length;r<i;++r)if(e[r].name===t){e[r]=Qj,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var zp="http://www.w3.org/1999/xhtml";const Ov={svg:"http://www.w3.org/2000/svg",xhtml:zp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Gm(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ov.hasOwnProperty(t)?{space:Ov[t],local:e}:e}function Jj(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===zp&&t.documentElement.namespaceURI===zp?t.createElement(e):t.createElementNS(n,e)}}function Zj(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Pv(e){var t=Gm(e);return(t.local?Zj:Jj)(t)}function eN(){}function Rp(e){return e==null?eN:function(){return this.querySelector(e)}}function tN(e){typeof e!="function"&&(e=Rp(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var l=t[i],u=l.length,d=r[i]=new Array(u),m,y,p=0;p<u;++p)(m=l[p])&&(y=e.call(m,m.__data__,p,l))&&("__data__"in m&&(y.__data__=m.__data__),d[p]=y);return new yr(r,this._parents)}function nN(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function sN(){return[]}function Tv(e){return e==null?sN:function(){return this.querySelectorAll(e)}}function rN(e){return function(){return nN(e.apply(this,arguments))}}function aN(e){typeof e=="function"?e=rN(e):e=Tv(e);for(var t=this._groups,n=t.length,r=[],i=[],l=0;l<n;++l)for(var u=t[l],d=u.length,m,y=0;y<d;++y)(m=u[y])&&(r.push(e.call(m,m.__data__,y,u)),i.push(m));return new yr(r,i)}function $v(e){return function(){return this.matches(e)}}function Lv(e){return function(t){return t.matches(e)}}var oN=Array.prototype.find;function iN(e){return function(){return oN.call(this.children,e)}}function lN(){return this.firstElementChild}function cN(e){return this.select(e==null?lN:iN(typeof e=="function"?e:Lv(e)))}var uN=Array.prototype.filter;function dN(){return Array.from(this.children)}function mN(e){return function(){return uN.call(this.children,e)}}function fN(e){return this.selectAll(e==null?dN:mN(typeof e=="function"?e:Lv(e)))}function hN(e){typeof e!="function"&&(e=$v(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var l=t[i],u=l.length,d=r[i]=[],m,y=0;y<u;++y)(m=l[y])&&e.call(m,m.__data__,y,l)&&d.push(m);return new yr(r,this._parents)}function Dv(e){return new Array(e.length)}function pN(){return new yr(this._enter||this._groups.map(Dv),this._parents)}function Xm(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Xm.prototype={constructor:Xm,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function gN(e){return function(){return e}}function _N(e,t,n,r,i,l){for(var u=0,d,m=t.length,y=l.length;u<y;++u)(d=t[u])?(d.__data__=l[u],r[u]=d):n[u]=new Xm(e,l[u]);for(;u<m;++u)(d=t[u])&&(i[u]=d)}function vN(e,t,n,r,i,l,u){var d,m,y=new Map,p=t.length,_=l.length,v=new Array(p),w;for(d=0;d<p;++d)(m=t[d])&&(v[d]=w=u.call(m,m.__data__,d,t)+"",y.has(w)?i[d]=m:y.set(w,m));for(d=0;d<_;++d)w=u.call(e,l[d],d,l)+"",(m=y.get(w))?(r[d]=m,m.__data__=l[d],y.delete(w)):n[d]=new Xm(e,l[d]);for(d=0;d<p;++d)(m=t[d])&&y.get(v[d])===m&&(i[d]=m)}function yN(e){return e.__data__}function bN(e,t){if(!arguments.length)return Array.from(this,yN);var n=t?vN:_N,r=this._parents,i=this._groups;typeof e!="function"&&(e=gN(e));for(var l=i.length,u=new Array(l),d=new Array(l),m=new Array(l),y=0;y<l;++y){var p=r[y],_=i[y],v=_.length,w=xN(e.call(p,p&&p.__data__,y,r)),x=w.length,S=d[y]=new Array(x),E=u[y]=new Array(x),A=m[y]=new Array(v);n(p,_,S,E,A,w,t);for(var P=0,T=0,j,O;P<x;++P)if(j=S[P]){for(P>=T&&(T=P+1);!(O=E[T])&&++T<x;);j._next=O||null}}return u=new yr(u,r),u._enter=d,u._exit=m,u}function xN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wN(){return new yr(this._exit||this._groups.map(Dv),this._parents)}function jN(e,t,n){var r=this.enter(),i=this,l=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?l.remove():n(l),r&&i?r.merge(i).order():i}function NN(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,i=n.length,l=r.length,u=Math.min(i,l),d=new Array(i),m=0;m<u;++m)for(var y=n[m],p=r[m],_=y.length,v=d[m]=new Array(_),w,x=0;x<_;++x)(w=y[x]||p[x])&&(v[x]=w);for(;m<i;++m)d[m]=n[m];return new yr(d,this._parents)}function SN(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],i=r.length-1,l=r[i],u;--i>=0;)(u=r[i])&&(l&&u.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(u,l),l=u);return this}function CN(e){e||(e=EN);function t(_,v){return _&&v?e(_.__data__,v.__data__):!_-!v}for(var n=this._groups,r=n.length,i=new Array(r),l=0;l<r;++l){for(var u=n[l],d=u.length,m=i[l]=new Array(d),y,p=0;p<d;++p)(y=u[p])&&(m[p]=y);m.sort(t)}return new yr(i,this._parents).order()}function EN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function kN(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function MN(){return Array.from(this)}function AN(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,l=r.length;i<l;++i){var u=r[i];if(u)return u}return null}function ON(){let e=0;for(const t of this)++e;return e}function PN(){return!this.node()}function TN(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var i=t[n],l=0,u=i.length,d;l<u;++l)(d=i[l])&&e.call(d,d.__data__,l,i);return this}function $N(e){return function(){this.removeAttribute(e)}}function LN(e){return function(){this.removeAttributeNS(e.space,e.local)}}function DN(e,t){return function(){this.setAttribute(e,t)}}function zN(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function RN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function FN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function IN(e,t){var n=Gm(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?LN:$N:typeof t=="function"?n.local?FN:RN:n.local?zN:DN)(n,t))}function zv(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function BN(e){return function(){this.style.removeProperty(e)}}function UN(e,t,n){return function(){this.style.setProperty(e,t,n)}}function qN(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function HN(e,t,n){return arguments.length>1?this.each((t==null?BN:typeof t=="function"?qN:UN)(e,t,n??"")):hc(this.node(),e)}function hc(e,t){return e.style.getPropertyValue(t)||zv(e).getComputedStyle(e,null).getPropertyValue(t)}function VN(e){return function(){delete this[e]}}function WN(e,t){return function(){this[e]=t}}function KN(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function YN(e,t){return arguments.length>1?this.each((t==null?VN:typeof t=="function"?KN:WN)(e,t)):this.node()[e]}function Rv(e){return e.trim().split(/^|\s+/)}function Fp(e){return e.classList||new Fv(e)}function Fv(e){this._node=e,this._names=Rv(e.getAttribute("class")||"")}Fv.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Iv(e,t){for(var n=Fp(e),r=-1,i=t.length;++r<i;)n.add(t[r])}function Bv(e,t){for(var n=Fp(e),r=-1,i=t.length;++r<i;)n.remove(t[r])}function QN(e){return function(){Iv(this,e)}}function GN(e){return function(){Bv(this,e)}}function XN(e,t){return function(){(t.apply(this,arguments)?Iv:Bv)(this,e)}}function JN(e,t){var n=Rv(e+"");if(arguments.length<2){for(var r=Fp(this.node()),i=-1,l=n.length;++i<l;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?XN:t?QN:GN)(n,t))}function ZN(){this.textContent=""}function eS(e){return function(){this.textContent=e}}function tS(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function nS(e){return arguments.length?this.each(e==null?ZN:(typeof e=="function"?tS:eS)(e)):this.node().textContent}function sS(){this.innerHTML=""}function rS(e){return function(){this.innerHTML=e}}function aS(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function oS(e){return arguments.length?this.each(e==null?sS:(typeof e=="function"?aS:rS)(e)):this.node().innerHTML}function iS(){this.nextSibling&&this.parentNode.appendChild(this)}function lS(){return this.each(iS)}function cS(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function uS(){return this.each(cS)}function dS(e){var t=typeof e=="function"?e:Pv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function mS(){return null}function fS(e,t){var n=typeof e=="function"?e:Pv(e),r=t==null?mS:typeof t=="function"?t:Rp(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function hS(){var e=this.parentNode;e&&e.removeChild(this)}function pS(){return this.each(hS)}function gS(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function _S(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function vS(e){return this.select(e?_S:gS)}function yS(e){return arguments.length?this.property("__data__",e):this.node().__data__}function bS(e){return function(t){e.call(this,t,this.__data__)}}function xS(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function wS(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,i=t.length,l;n<i;++n)l=t[n],(!e.type||l.type===e.type)&&l.name===e.name?this.removeEventListener(l.type,l.listener,l.options):t[++r]=l;++r?t.length=r:delete this.__on}}}function jS(e,t,n){return function(){var r=this.__on,i,l=bS(t);if(r){for(var u=0,d=r.length;u<d;++u)if((i=r[u]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=l,i.options=n),i.value=t;return}}this.addEventListener(e.type,l,n),i={type:e.type,name:e.name,value:t,listener:l,options:n},r?r.push(i):this.__on=[i]}}function NS(e,t,n){var r=xS(e+""),i,l=r.length,u;if(arguments.length<2){var d=this.node().__on;if(d){for(var m=0,y=d.length,p;m<y;++m)for(i=0,p=d[m];i<l;++i)if((u=r[i]).type===p.type&&u.name===p.name)return p.value}return}for(d=t?jS:wS,i=0;i<l;++i)this.each(d(r[i],t,n));return this}function Uv(e,t,n){var r=zv(e),i=r.CustomEvent;typeof i=="function"?i=new i(t,n):(i=r.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function SS(e,t){return function(){return Uv(this,e,t)}}function CS(e,t){return function(){return Uv(this,e,t.apply(this,arguments))}}function ES(e,t){return this.each((typeof t=="function"?CS:SS)(e,t))}function*kS(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],i=0,l=r.length,u;i<l;++i)(u=r[i])&&(yield u)}var qv=[null];function yr(e,t){this._groups=e,this._parents=t}function Gu(){return new yr([[document.documentElement]],qv)}function MS(){return this}yr.prototype=Gu.prototype={constructor:yr,select:tN,selectAll:aN,selectChild:cN,selectChildren:fN,filter:hN,data:bN,enter:pN,exit:wN,join:jN,merge:NN,selection:MS,order:SN,sort:CN,call:kN,nodes:MN,node:AN,size:ON,empty:PN,each:TN,attr:IN,style:HN,property:YN,classed:JN,text:nS,html:oS,raise:lS,lower:uS,append:dS,insert:fS,remove:pS,clone:vS,datum:yS,on:NS,dispatch:ES,[Symbol.iterator]:kS};function Jr(e){return typeof e=="string"?new yr([[document.querySelector(e)]],[document.documentElement]):new yr([[e]],qv)}function AS(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ka(e,t){if(e=AS(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const OS={passive:!1},Xu={capture:!0,passive:!1};function Ip(e){e.stopImmediatePropagation()}function pc(e){e.preventDefault(),e.stopImmediatePropagation()}function Hv(e){var t=e.document.documentElement,n=Jr(e).on("dragstart.drag",pc,Xu);"onselectstart"in t?n.on("selectstart.drag",pc,Xu):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Vv(e,t){var n=e.document.documentElement,r=Jr(e).on("dragstart.drag",null);t&&(r.on("click.drag",pc,Xu),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Jm=e=>()=>e;function Bp(e,{sourceEvent:t,subject:n,target:r,identifier:i,active:l,x:u,y:d,dx:m,dy:y,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:m,enumerable:!0,configurable:!0},dy:{value:y,enumerable:!0,configurable:!0},_:{value:p}})}Bp.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function PS(e){return!e.ctrlKey&&!e.button}function TS(){return this.parentNode}function $S(e,t){return t??{x:e.x,y:e.y}}function LS(){return navigator.maxTouchPoints||"ontouchstart"in this}function DS(){var e=PS,t=TS,n=$S,r=LS,i={},l=Ym("start","drag","end"),u=0,d,m,y,p,_=0;function v(j){j.on("mousedown.drag",w).filter(r).on("touchstart.drag",E).on("touchmove.drag",A,OS).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function w(j,O){if(!(p||!e.call(this,j,O))){var k=T(this,t.call(this,j,O),j,O,"mouse");k&&(Jr(j.view).on("mousemove.drag",x,Xu).on("mouseup.drag",S,Xu),Hv(j.view),Ip(j),y=!1,d=j.clientX,m=j.clientY,k("start",j))}}function x(j){if(pc(j),!y){var O=j.clientX-d,k=j.clientY-m;y=O*O+k*k>_}i.mouse("drag",j)}function S(j){Jr(j.view).on("mousemove.drag mouseup.drag",null),Vv(j.view,y),pc(j),i.mouse("end",j)}function E(j,O){if(e.call(this,j,O)){var k=j.changedTouches,D=t.call(this,j,O),$=k.length,B,q;for(B=0;B<$;++B)(q=T(this,D,j,O,k[B].identifier,k[B]))&&(Ip(j),q("start",j,k[B]))}}function A(j){var O=j.changedTouches,k=O.length,D,$;for(D=0;D<k;++D)($=i[O[D].identifier])&&(pc(j),$("drag",j,O[D]))}function P(j){var O=j.changedTouches,k=O.length,D,$;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),D=0;D<k;++D)($=i[O[D].identifier])&&(Ip(j),$("end",j,O[D]))}function T(j,O,k,D,$,B){var q=l.copy(),K=ka(B||k,O),ne,ue,z;if((z=n.call(j,new Bp("beforestart",{sourceEvent:k,target:v,identifier:$,active:u,x:K[0],y:K[1],dx:0,dy:0,dispatch:q}),D))!=null)return ne=z.x-K[0]||0,ue=z.y-K[1]||0,function X(Y,W,F){var te=K,U;switch(Y){case"start":i[$]=X,U=u++;break;case"end":delete i[$],--u;case"drag":K=ka(F||W,O),U=u;break}q.call(Y,j,new Bp(Y,{sourceEvent:W,subject:z,target:v,identifier:$,active:U,x:K[0]+ne,y:K[1]+ue,dx:K[0]-te[0],dy:K[1]-te[1],dispatch:q}),D)}}return v.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Jm(!!j),v):e},v.container=function(j){return arguments.length?(t=typeof j=="function"?j:Jm(j),v):t},v.subject=function(j){return arguments.length?(n=typeof j=="function"?j:Jm(j),v):n},v.touchable=function(j){return arguments.length?(r=typeof j=="function"?j:Jm(!!j),v):r},v.on=function(){var j=l.on.apply(l,arguments);return j===l?v:j},v.clickDistance=function(j){return arguments.length?(_=(j=+j)*j,v):Math.sqrt(_)},v}function Up(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Wv(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Ju(){}var Zu=.7,Zm=1/Zu,gc="\\s*([+-]?\\d+)\\s*",ed="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ma="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zS=/^#([0-9a-f]{3,8})$/,RS=new RegExp(`^rgb\\(${gc},${gc},${gc}\\)$`),FS=new RegExp(`^rgb\\(${Ma},${Ma},${Ma}\\)$`),IS=new RegExp(`^rgba\\(${gc},${gc},${gc},${ed}\\)$`),BS=new RegExp(`^rgba\\(${Ma},${Ma},${Ma},${ed}\\)$`),US=new RegExp(`^hsl\\(${ed},${Ma},${Ma}\\)$`),qS=new RegExp(`^hsla\\(${ed},${Ma},${Ma},${ed}\\)$`),Kv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Up(Ju,td,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Yv,formatHex:Yv,formatHex8:HS,formatHsl:VS,formatRgb:Qv,toString:Qv});function Yv(){return this.rgb().formatHex()}function HS(){return this.rgb().formatHex8()}function VS(){return ey(this).formatHsl()}function Qv(){return this.rgb().formatRgb()}function td(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=zS.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Gv(t):n===3?new Ys(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ef(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ef(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=RS.exec(e))?new Ys(t[1],t[2],t[3],1):(t=FS.exec(e))?new Ys(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=IS.exec(e))?ef(t[1],t[2],t[3],t[4]):(t=BS.exec(e))?ef(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=US.exec(e))?Zv(t[1],t[2]/100,t[3]/100,1):(t=qS.exec(e))?Zv(t[1],t[2]/100,t[3]/100,t[4]):Kv.hasOwnProperty(e)?Gv(Kv[e]):e==="transparent"?new Ys(NaN,NaN,NaN,0):null}function Gv(e){return new Ys(e>>16&255,e>>8&255,e&255,1)}function ef(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ys(e,t,n,r)}function WS(e){return e instanceof Ju||(e=td(e)),e?(e=e.rgb(),new Ys(e.r,e.g,e.b,e.opacity)):new Ys}function qp(e,t,n,r){return arguments.length===1?WS(e):new Ys(e,t,n,r??1)}function Ys(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Up(Ys,qp,Wv(Ju,{brighter(e){return e=e==null?Zm:Math.pow(Zm,e),new Ys(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Zu:Math.pow(Zu,e),new Ys(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ys(Vi(this.r),Vi(this.g),Vi(this.b),tf(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Xv,formatHex:Xv,formatHex8:KS,formatRgb:Jv,toString:Jv}));function Xv(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}`}function KS(){return`#${Wi(this.r)}${Wi(this.g)}${Wi(this.b)}${Wi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Jv(){const e=tf(this.opacity);return`${e===1?"rgb(":"rgba("}${Vi(this.r)}, ${Vi(this.g)}, ${Vi(this.b)}${e===1?")":`, ${e})`}`}function tf(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Vi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Wi(e){return e=Vi(e),(e<16?"0":"")+e.toString(16)}function Zv(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Zr(e,t,n,r)}function ey(e){if(e instanceof Zr)return new Zr(e.h,e.s,e.l,e.opacity);if(e instanceof Ju||(e=td(e)),!e)return new Zr;if(e instanceof Zr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,i=Math.min(t,n,r),l=Math.max(t,n,r),u=NaN,d=l-i,m=(l+i)/2;return d?(t===l?u=(n-r)/d+(n<r)*6:n===l?u=(r-t)/d+2:u=(t-n)/d+4,d/=m<.5?l+i:2-l-i,u*=60):d=m>0&&m<1?0:u,new Zr(u,d,m,e.opacity)}function YS(e,t,n,r){return arguments.length===1?ey(e):new Zr(e,t,n,r??1)}function Zr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Up(Zr,YS,Wv(Ju,{brighter(e){return e=e==null?Zm:Math.pow(Zm,e),new Zr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Zu:Math.pow(Zu,e),new Zr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,i=2*n-r;return new Ys(Hp(e>=240?e-240:e+120,i,r),Hp(e,i,r),Hp(e<120?e+240:e-120,i,r),this.opacity)},clamp(){return new Zr(ty(this.h),nf(this.s),nf(this.l),tf(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=tf(this.opacity);return`${e===1?"hsl(":"hsla("}${ty(this.h)}, ${nf(this.s)*100}%, ${nf(this.l)*100}%${e===1?")":`, ${e})`}`}}));function ty(e){return e=(e||0)%360,e<0?e+360:e}function nf(e){return Math.max(0,Math.min(1,e||0))}function Hp(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const ny=e=>()=>e;function QS(e,t){return function(n){return e+n*t}}function GS(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function XS(e){return(e=+e)==1?sy:function(t,n){return n-t?GS(t,n,e):ny(isNaN(t)?n:t)}}function sy(e,t){var n=t-e;return n?QS(e,n):ny(isNaN(e)?t:e)}const ry=function e(t){var n=XS(t);function r(i,l){var u=n((i=qp(i)).r,(l=qp(l)).r),d=n(i.g,l.g),m=n(i.b,l.b),y=sy(i.opacity,l.opacity);return function(p){return i.r=u(p),i.g=d(p),i.b=m(p),i.opacity=y(p),i+""}}return r.gamma=e,r}(1);function Ko(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Vp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Wp=new RegExp(Vp.source,"g");function JS(e){return function(){return e}}function ZS(e){return function(t){return e(t)+""}}function eC(e,t){var n=Vp.lastIndex=Wp.lastIndex=0,r,i,l,u=-1,d=[],m=[];for(e=e+"",t=t+"";(r=Vp.exec(e))&&(i=Wp.exec(t));)(l=i.index)>n&&(l=t.slice(n,l),d[u]?d[u]+=l:d[++u]=l),(r=r[0])===(i=i[0])?d[u]?d[u]+=i:d[++u]=i:(d[++u]=null,m.push({i:u,x:Ko(r,i)})),n=Wp.lastIndex;return n<t.length&&(l=t.slice(n),d[u]?d[u]+=l:d[++u]=l),d.length<2?m[0]?ZS(m[0].x):JS(t):(t=m.length,function(y){for(var p=0,_;p<t;++p)d[(_=m[p]).i]=_.x(y);return d.join("")})}var ay=180/Math.PI,Kp={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function oy(e,t,n,r,i,l){var u,d,m;return(u=Math.sqrt(e*e+t*t))&&(e/=u,t/=u),(m=e*n+t*r)&&(n-=e*m,r-=t*m),(d=Math.sqrt(n*n+r*r))&&(n/=d,r/=d,m/=d),e*r<t*n&&(e=-e,t=-t,m=-m,u=-u),{translateX:i,translateY:l,rotate:Math.atan2(t,e)*ay,skewX:Math.atan(m)*ay,scaleX:u,scaleY:d}}var sf;function tC(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Kp:oy(t.a,t.b,t.c,t.d,t.e,t.f)}function nC(e){return e==null||(sf||(sf=document.createElementNS("http://www.w3.org/2000/svg","g")),sf.setAttribute("transform",e),!(e=sf.transform.baseVal.consolidate()))?Kp:(e=e.matrix,oy(e.a,e.b,e.c,e.d,e.e,e.f))}function iy(e,t,n,r){function i(y){return y.length?y.pop()+" ":""}function l(y,p,_,v,w,x){if(y!==_||p!==v){var S=w.push("translate(",null,t,null,n);x.push({i:S-4,x:Ko(y,_)},{i:S-2,x:Ko(p,v)})}else(_||v)&&w.push("translate("+_+t+v+n)}function u(y,p,_,v){y!==p?(y-p>180?p+=360:p-y>180&&(y+=360),v.push({i:_.push(i(_)+"rotate(",null,r)-2,x:Ko(y,p)})):p&&_.push(i(_)+"rotate("+p+r)}function d(y,p,_,v){y!==p?v.push({i:_.push(i(_)+"skewX(",null,r)-2,x:Ko(y,p)}):p&&_.push(i(_)+"skewX("+p+r)}function m(y,p,_,v,w,x){if(y!==_||p!==v){var S=w.push(i(w)+"scale(",null,",",null,")");x.push({i:S-4,x:Ko(y,_)},{i:S-2,x:Ko(p,v)})}else(_!==1||v!==1)&&w.push(i(w)+"scale("+_+","+v+")")}return function(y,p){var _=[],v=[];return y=e(y),p=e(p),l(y.translateX,y.translateY,p.translateX,p.translateY,_,v),u(y.rotate,p.rotate,_,v),d(y.skewX,p.skewX,_,v),m(y.scaleX,y.scaleY,p.scaleX,p.scaleY,_,v),y=p=null,function(w){for(var x=-1,S=v.length,E;++x<S;)_[(E=v[x]).i]=E.x(w);return _.join("")}}}var sC=iy(tC,"px, ","px)","deg)"),rC=iy(nC,", ",")",")"),aC=1e-12;function ly(e){return((e=Math.exp(e))+1/e)/2}function oC(e){return((e=Math.exp(e))-1/e)/2}function iC(e){return((e=Math.exp(2*e))-1)/(e+1)}const lC=function e(t,n,r){function i(l,u){var d=l[0],m=l[1],y=l[2],p=u[0],_=u[1],v=u[2],w=p-d,x=_-m,S=w*w+x*x,E,A;if(S<aC)A=Math.log(v/y)/t,E=function(D){return[d+D*w,m+D*x,y*Math.exp(t*D*A)]};else{var P=Math.sqrt(S),T=(v*v-y*y+r*S)/(2*y*n*P),j=(v*v-y*y-r*S)/(2*v*n*P),O=Math.log(Math.sqrt(T*T+1)-T),k=Math.log(Math.sqrt(j*j+1)-j);A=(k-O)/t,E=function(D){var $=D*A,B=ly(O),q=y/(n*P)*(B*iC(t*$+O)-oC(O));return[d+q*w,m+q*x,y*B/ly(t*$+O)]}}return E.duration=A*1e3*t/Math.SQRT2,E}return i.rho=function(l){var u=Math.max(.001,+l),d=u*u,m=d*d;return e(u,d,m)},i}(Math.SQRT2,2,4);var _c=0,nd=0,sd=0,cy=1e3,rf,rd,af=0,Ki=0,of=0,ad=typeof performance=="object"&&performance.now?performance:Date,uy=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Yp(){return Ki||(uy(cC),Ki=ad.now()+of)}function cC(){Ki=0}function lf(){this._call=this._time=this._next=null}lf.prototype=dy.prototype={constructor:lf,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Yp():+n)+(t==null?0:+t),!this._next&&rd!==this&&(rd?rd._next=this:rf=this,rd=this),this._call=e,this._time=n,Qp()},stop:function(){this._call&&(this._call=null,this._time=1/0,Qp())}};function dy(e,t,n){var r=new lf;return r.restart(e,t,n),r}function uC(){Yp(),++_c;for(var e=rf,t;e;)(t=Ki-e._time)>=0&&e._call.call(void 0,t),e=e._next;--_c}function my(){Ki=(af=ad.now())+of,_c=nd=0;try{uC()}finally{_c=0,mC(),Ki=0}}function dC(){var e=ad.now(),t=e-af;t>cy&&(of-=t,af=e)}function mC(){for(var e,t=rf,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:rf=n);rd=e,Qp(r)}function Qp(e){if(!_c){nd&&(nd=clearTimeout(nd));var t=e-Ki;t>24?(e<1/0&&(nd=setTimeout(my,e-ad.now()-of)),sd&&(sd=clearInterval(sd))):(sd||(af=ad.now(),sd=setInterval(dC,cy)),_c=1,uy(my))}}function fy(e,t,n){var r=new lf;return t=t==null?0:+t,r.restart(i=>{r.stop(),e(i+t)},t,n),r}var fC=Ym("start","end","cancel","interrupt"),hC=[],hy=0,py=1,Gp=2,cf=3,gy=4,Xp=5,uf=6;function df(e,t,n,r,i,l){var u=e.__transition;if(!u)e.__transition={};else if(n in u)return;pC(e,n,{name:t,index:r,group:i,on:fC,tween:hC,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:hy})}function Jp(e,t){var n=ea(e,t);if(n.state>hy)throw new Error("too late; already scheduled");return n}function Aa(e,t){var n=ea(e,t);if(n.state>cf)throw new Error("too late; already running");return n}function ea(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function pC(e,t,n){var r=e.__transition,i;r[t]=n,n.timer=dy(l,0,n.time);function l(y){n.state=py,n.timer.restart(u,n.delay,n.time),n.delay<=y&&u(y-n.delay)}function u(y){var p,_,v,w;if(n.state!==py)return m();for(p in r)if(w=r[p],w.name===n.name){if(w.state===cf)return fy(u);w.state===gy?(w.state=uf,w.timer.stop(),w.on.call("interrupt",e,e.__data__,w.index,w.group),delete r[p]):+p<t&&(w.state=uf,w.timer.stop(),w.on.call("cancel",e,e.__data__,w.index,w.group),delete r[p])}if(fy(function(){n.state===cf&&(n.state=gy,n.timer.restart(d,n.delay,n.time),d(y))}),n.state=Gp,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Gp){for(n.state=cf,i=new Array(v=n.tween.length),p=0,_=-1;p<v;++p)(w=n.tween[p].value.call(e,e.__data__,n.index,n.group))&&(i[++_]=w);i.length=_+1}}function d(y){for(var p=y<n.duration?n.ease.call(null,y/n.duration):(n.timer.restart(m),n.state=Xp,1),_=-1,v=i.length;++_<v;)i[_].call(e,p);n.state===Xp&&(n.on.call("end",e,e.__data__,n.index,n.group),m())}function m(){n.state=uf,n.timer.stop(),delete r[t];for(var y in r)return;delete e.__transition}}function mf(e,t){var n=e.__transition,r,i,l=!0,u;if(n){t=t==null?null:t+"";for(u in n){if((r=n[u]).name!==t){l=!1;continue}i=r.state>Gp&&r.state<Xp,r.state=uf,r.timer.stop(),r.on.call(i?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[u]}l&&delete e.__transition}}function gC(e){return this.each(function(){mf(this,e)})}function _C(e,t){var n,r;return function(){var i=Aa(this,e),l=i.tween;if(l!==n){r=n=l;for(var u=0,d=r.length;u<d;++u)if(r[u].name===t){r=r.slice(),r.splice(u,1);break}}i.tween=r}}function vC(e,t,n){var r,i;if(typeof n!="function")throw new Error;return function(){var l=Aa(this,e),u=l.tween;if(u!==r){i=(r=u).slice();for(var d={name:t,value:n},m=0,y=i.length;m<y;++m)if(i[m].name===t){i[m]=d;break}m===y&&i.push(d)}l.tween=i}}function yC(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ea(this.node(),n).tween,i=0,l=r.length,u;i<l;++i)if((u=r[i]).name===e)return u.value;return null}return this.each((t==null?_C:vC)(n,e,t))}function Zp(e,t,n){var r=e._id;return e.each(function(){var i=Aa(this,r);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return ea(i,r).value[t]}}function _y(e,t){var n;return(typeof t=="number"?Ko:t instanceof td?ry:(n=td(t))?(t=n,ry):eC)(e,t)}function bC(e){return function(){this.removeAttribute(e)}}function xC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wC(e,t,n){var r,i=n+"",l;return function(){var u=this.getAttribute(e);return u===i?null:u===r?l:l=t(r=u,n)}}function jC(e,t,n){var r,i=n+"",l;return function(){var u=this.getAttributeNS(e.space,e.local);return u===i?null:u===r?l:l=t(r=u,n)}}function NC(e,t,n){var r,i,l;return function(){var u,d=n(this),m;return d==null?void this.removeAttribute(e):(u=this.getAttribute(e),m=d+"",u===m?null:u===r&&m===i?l:(i=m,l=t(r=u,d)))}}function SC(e,t,n){var r,i,l;return function(){var u,d=n(this),m;return d==null?void this.removeAttributeNS(e.space,e.local):(u=this.getAttributeNS(e.space,e.local),m=d+"",u===m?null:u===r&&m===i?l:(i=m,l=t(r=u,d)))}}function CC(e,t){var n=Gm(e),r=n==="transform"?rC:_y;return this.attrTween(e,typeof t=="function"?(n.local?SC:NC)(n,r,Zp(this,"attr."+e,t)):t==null?(n.local?xC:bC)(n):(n.local?jC:wC)(n,r,t))}function EC(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function kC(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function MC(e,t){var n,r;function i(){var l=t.apply(this,arguments);return l!==r&&(n=(r=l)&&kC(e,l)),n}return i._value=t,i}function AC(e,t){var n,r;function i(){var l=t.apply(this,arguments);return l!==r&&(n=(r=l)&&EC(e,l)),n}return i._value=t,i}function OC(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Gm(e);return this.tween(n,(r.local?MC:AC)(r,t))}function PC(e,t){return function(){Jp(this,e).delay=+t.apply(this,arguments)}}function TC(e,t){return t=+t,function(){Jp(this,e).delay=t}}function $C(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?PC:TC)(t,e)):ea(this.node(),t).delay}function LC(e,t){return function(){Aa(this,e).duration=+t.apply(this,arguments)}}function DC(e,t){return t=+t,function(){Aa(this,e).duration=t}}function zC(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?LC:DC)(t,e)):ea(this.node(),t).duration}function RC(e,t){if(typeof t!="function")throw new Error;return function(){Aa(this,e).ease=t}}function FC(e){var t=this._id;return arguments.length?this.each(RC(t,e)):ea(this.node(),t).ease}function IC(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Aa(this,e).ease=n}}function BC(e){if(typeof e!="function")throw new Error;return this.each(IC(this._id,e))}function UC(e){typeof e!="function"&&(e=$v(e));for(var t=this._groups,n=t.length,r=new Array(n),i=0;i<n;++i)for(var l=t[i],u=l.length,d=r[i]=[],m,y=0;y<u;++y)(m=l[y])&&e.call(m,m.__data__,y,l)&&d.push(m);return new so(r,this._parents,this._name,this._id)}function qC(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,i=n.length,l=Math.min(r,i),u=new Array(r),d=0;d<l;++d)for(var m=t[d],y=n[d],p=m.length,_=u[d]=new Array(p),v,w=0;w<p;++w)(v=m[w]||y[w])&&(_[w]=v);for(;d<r;++d)u[d]=t[d];return new so(u,this._parents,this._name,this._id)}function HC(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function VC(e,t,n){var r,i,l=HC(t)?Jp:Aa;return function(){var u=l(this,e),d=u.on;d!==r&&(i=(r=d).copy()).on(t,n),u.on=i}}function WC(e,t){var n=this._id;return arguments.length<2?ea(this.node(),n).on.on(e):this.each(VC(n,e,t))}function KC(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function YC(){return this.on("end.remove",KC(this._id))}function QC(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Rp(e));for(var r=this._groups,i=r.length,l=new Array(i),u=0;u<i;++u)for(var d=r[u],m=d.length,y=l[u]=new Array(m),p,_,v=0;v<m;++v)(p=d[v])&&(_=e.call(p,p.__data__,v,d))&&("__data__"in p&&(_.__data__=p.__data__),y[v]=_,df(y[v],t,n,v,y,ea(p,n)));return new so(l,this._parents,t,n)}function GC(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Tv(e));for(var r=this._groups,i=r.length,l=[],u=[],d=0;d<i;++d)for(var m=r[d],y=m.length,p,_=0;_<y;++_)if(p=m[_]){for(var v=e.call(p,p.__data__,_,m),w,x=ea(p,n),S=0,E=v.length;S<E;++S)(w=v[S])&&df(w,t,n,S,v,x);l.push(v),u.push(p)}return new so(l,u,t,n)}var XC=Gu.prototype.constructor;function JC(){return new XC(this._groups,this._parents)}function ZC(e,t){var n,r,i;return function(){var l=hc(this,e),u=(this.style.removeProperty(e),hc(this,e));return l===u?null:l===n&&u===r?i:i=t(n=l,r=u)}}function vy(e){return function(){this.style.removeProperty(e)}}function eE(e,t,n){var r,i=n+"",l;return function(){var u=hc(this,e);return u===i?null:u===r?l:l=t(r=u,n)}}function tE(e,t,n){var r,i,l;return function(){var u=hc(this,e),d=n(this),m=d+"";return d==null&&(m=d=(this.style.removeProperty(e),hc(this,e))),u===m?null:u===r&&m===i?l:(i=m,l=t(r=u,d))}}function nE(e,t){var n,r,i,l="style."+t,u="end."+l,d;return function(){var m=Aa(this,e),y=m.on,p=m.value[l]==null?d||(d=vy(t)):void 0;(y!==n||i!==p)&&(r=(n=y).copy()).on(u,i=p),m.on=r}}function sE(e,t,n){var r=(e+="")=="transform"?sC:_y;return t==null?this.styleTween(e,ZC(e,r)).on("end.style."+e,vy(e)):typeof t=="function"?this.styleTween(e,tE(e,r,Zp(this,"style."+e,t))).each(nE(this._id,e)):this.styleTween(e,eE(e,r,t),n).on("end.style."+e,null)}function rE(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function aE(e,t,n){var r,i;function l(){var u=t.apply(this,arguments);return u!==i&&(r=(i=u)&&rE(e,u,n)),r}return l._value=t,l}function oE(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,aE(e,t,n??""))}function iE(e){return function(){this.textContent=e}}function lE(e){return function(){var t=e(this);this.textContent=t??""}}function cE(e){return this.tween("text",typeof e=="function"?lE(Zp(this,"text",e)):iE(e==null?"":e+""))}function uE(e){return function(t){this.textContent=e.call(this,t)}}function dE(e){var t,n;function r(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&uE(i)),t}return r._value=e,r}function mE(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,dE(e))}function fE(){for(var e=this._name,t=this._id,n=yy(),r=this._groups,i=r.length,l=0;l<i;++l)for(var u=r[l],d=u.length,m,y=0;y<d;++y)if(m=u[y]){var p=ea(m,t);df(m,e,n,y,u,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new so(r,this._parents,e,n)}function hE(){var e,t,n=this,r=n._id,i=n.size();return new Promise(function(l,u){var d={value:u},m={value:function(){--i===0&&l()}};n.each(function(){var y=Aa(this,r),p=y.on;p!==e&&(t=(e=p).copy(),t._.cancel.push(d),t._.interrupt.push(d),t._.end.push(m)),y.on=t}),i===0&&l()})}var pE=0;function so(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function yy(){return++pE}var ro=Gu.prototype;so.prototype={constructor:so,select:QC,selectAll:GC,selectChild:ro.selectChild,selectChildren:ro.selectChildren,filter:UC,merge:qC,selection:JC,transition:fE,call:ro.call,nodes:ro.nodes,node:ro.node,size:ro.size,empty:ro.empty,each:ro.each,on:WC,attr:CC,attrTween:OC,style:sE,styleTween:oE,text:cE,textTween:mE,remove:YC,tween:yC,delay:$C,duration:zC,ease:FC,easeVarying:BC,end:hE,[Symbol.iterator]:ro[Symbol.iterator]};function gE(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var _E={time:null,delay:0,duration:250,ease:gE};function vE(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function yE(e){var t,n;e instanceof so?(t=e._id,e=e._name):(t=yy(),(n=_E).time=Yp(),e=e==null?null:e+"");for(var r=this._groups,i=r.length,l=0;l<i;++l)for(var u=r[l],d=u.length,m,y=0;y<d;++y)(m=u[y])&&df(m,e,t,y,u,n||vE(m,t));return new so(r,this._parents,e,t)}Gu.prototype.interrupt=gC,Gu.prototype.transition=yE;const ff=e=>()=>e;function bE(e,{sourceEvent:t,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function ao(e,t,n){this.k=e,this.x=t,this.y=n}ao.prototype={constructor:ao,scale:function(e){return e===1?this:new ao(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new ao(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Yi=new ao(1,0,0);ao.prototype;function eg(e){e.stopImmediatePropagation()}function od(e){e.preventDefault(),e.stopImmediatePropagation()}function xE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function wE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function by(){return this.__zoom||Yi}function jE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function NE(){return navigator.maxTouchPoints||"ontouchstart"in this}function SE(e,t,n){var r=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],l=e.invertY(t[0][1])-n[0][1],u=e.invertY(t[1][1])-n[1][1];return e.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),u>l?(l+u)/2:Math.min(0,l)||Math.max(0,u))}function CE(){var e=xE,t=wE,n=SE,r=jE,i=NE,l=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],d=250,m=lC,y=Ym("start","zoom","end"),p,_,v,w=500,x=150,S=0,E=10;function A(z){z.property("__zoom",by).on("wheel.zoom",$,{passive:!1}).on("mousedown.zoom",B).on("dblclick.zoom",q).filter(i).on("touchstart.zoom",K).on("touchmove.zoom",ne).on("touchend.zoom touchcancel.zoom",ue).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}A.transform=function(z,X,Y,W){var F=z.selection?z.selection():z;F.property("__zoom",by),z!==F?O(z,X,Y,W):F.interrupt().each(function(){k(this,arguments).event(W).start().zoom(null,typeof X=="function"?X.apply(this,arguments):X).end()})},A.scaleBy=function(z,X,Y,W){A.scaleTo(z,function(){var F=this.__zoom.k,te=typeof X=="function"?X.apply(this,arguments):X;return F*te},Y,W)},A.scaleTo=function(z,X,Y,W){A.transform(z,function(){var F=t.apply(this,arguments),te=this.__zoom,U=Y==null?j(F):typeof Y=="function"?Y.apply(this,arguments):Y,H=te.invert(U),Q=typeof X=="function"?X.apply(this,arguments):X;return n(T(P(te,Q),U,H),F,u)},Y,W)},A.translateBy=function(z,X,Y,W){A.transform(z,function(){return n(this.__zoom.translate(typeof X=="function"?X.apply(this,arguments):X,typeof Y=="function"?Y.apply(this,arguments):Y),t.apply(this,arguments),u)},null,W)},A.translateTo=function(z,X,Y,W,F){A.transform(z,function(){var te=t.apply(this,arguments),U=this.__zoom,H=W==null?j(te):typeof W=="function"?W.apply(this,arguments):W;return n(Yi.translate(H[0],H[1]).scale(U.k).translate(typeof X=="function"?-X.apply(this,arguments):-X,typeof Y=="function"?-Y.apply(this,arguments):-Y),te,u)},W,F)};function P(z,X){return X=Math.max(l[0],Math.min(l[1],X)),X===z.k?z:new ao(X,z.x,z.y)}function T(z,X,Y){var W=X[0]-Y[0]*z.k,F=X[1]-Y[1]*z.k;return W===z.x&&F===z.y?z:new ao(z.k,W,F)}function j(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function O(z,X,Y,W){z.on("start.zoom",function(){k(this,arguments).event(W).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(W).end()}).tween("zoom",function(){var F=this,te=arguments,U=k(F,te).event(W),H=t.apply(F,te),Q=Y==null?j(H):typeof Y=="function"?Y.apply(F,te):Y,ee=Math.max(H[1][0]-H[0][0],H[1][1]-H[0][1]),G=F.__zoom,V=typeof X=="function"?X.apply(F,te):X,Z=m(G.invert(Q).concat(ee/G.k),V.invert(Q).concat(ee/V.k));return function(de){if(de===1)de=V;else{var pe=Z(de),le=ee/pe[2];de=new ao(le,Q[0]-pe[0]*le,Q[1]-pe[1]*le)}U.zoom(null,de)}})}function k(z,X,Y){return!Y&&z.__zooming||new D(z,X)}function D(z,X){this.that=z,this.args=X,this.active=0,this.sourceEvent=null,this.extent=t.apply(z,X),this.taps=0}D.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,X){return this.mouse&&z!=="mouse"&&(this.mouse[1]=X.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=X.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=X.invert(this.touch1[0])),this.that.__zoom=X,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var X=Jr(this.that).datum();y.call(z,this.that,new bE(z,{sourceEvent:this.sourceEvent,target:A,transform:this.that.__zoom,dispatch:y}),X)}};function $(z,...X){if(!e.apply(this,arguments))return;var Y=k(this,X).event(z),W=this.__zoom,F=Math.max(l[0],Math.min(l[1],W.k*Math.pow(2,r.apply(this,arguments)))),te=ka(z);if(Y.wheel)(Y.mouse[0][0]!==te[0]||Y.mouse[0][1]!==te[1])&&(Y.mouse[1]=W.invert(Y.mouse[0]=te)),clearTimeout(Y.wheel);else{if(W.k===F)return;Y.mouse=[te,W.invert(te)],mf(this),Y.start()}od(z),Y.wheel=setTimeout(U,x),Y.zoom("mouse",n(T(P(W,F),Y.mouse[0],Y.mouse[1]),Y.extent,u));function U(){Y.wheel=null,Y.end()}}function B(z,...X){if(v||!e.apply(this,arguments))return;var Y=z.currentTarget,W=k(this,X,!0).event(z),F=Jr(z.view).on("mousemove.zoom",Q,!0).on("mouseup.zoom",ee,!0),te=ka(z,Y),U=z.clientX,H=z.clientY;Hv(z.view),eg(z),W.mouse=[te,this.__zoom.invert(te)],mf(this),W.start();function Q(G){if(od(G),!W.moved){var V=G.clientX-U,Z=G.clientY-H;W.moved=V*V+Z*Z>S}W.event(G).zoom("mouse",n(T(W.that.__zoom,W.mouse[0]=ka(G,Y),W.mouse[1]),W.extent,u))}function ee(G){F.on("mousemove.zoom mouseup.zoom",null),Vv(G.view,W.moved),od(G),W.event(G).end()}}function q(z,...X){if(e.apply(this,arguments)){var Y=this.__zoom,W=ka(z.changedTouches?z.changedTouches[0]:z,this),F=Y.invert(W),te=Y.k*(z.shiftKey?.5:2),U=n(T(P(Y,te),W,F),t.apply(this,X),u);od(z),d>0?Jr(this).transition().duration(d).call(O,U,W,z):Jr(this).call(A.transform,U,W,z)}}function K(z,...X){if(e.apply(this,arguments)){var Y=z.touches,W=Y.length,F=k(this,X,z.changedTouches.length===W).event(z),te,U,H,Q;for(eg(z),U=0;U<W;++U)H=Y[U],Q=ka(H,this),Q=[Q,this.__zoom.invert(Q),H.identifier],F.touch0?!F.touch1&&F.touch0[2]!==Q[2]&&(F.touch1=Q,F.taps=0):(F.touch0=Q,te=!0,F.taps=1+!!p);p&&(p=clearTimeout(p)),te&&(F.taps<2&&(_=Q[0],p=setTimeout(function(){p=null},w)),mf(this),F.start())}}function ne(z,...X){if(this.__zooming){var Y=k(this,X).event(z),W=z.changedTouches,F=W.length,te,U,H,Q;for(od(z),te=0;te<F;++te)U=W[te],H=ka(U,this),Y.touch0&&Y.touch0[2]===U.identifier?Y.touch0[0]=H:Y.touch1&&Y.touch1[2]===U.identifier&&(Y.touch1[0]=H);if(U=Y.that.__zoom,Y.touch1){var ee=Y.touch0[0],G=Y.touch0[1],V=Y.touch1[0],Z=Y.touch1[1],de=(de=V[0]-ee[0])*de+(de=V[1]-ee[1])*de,pe=(pe=Z[0]-G[0])*pe+(pe=Z[1]-G[1])*pe;U=P(U,Math.sqrt(de/pe)),H=[(ee[0]+V[0])/2,(ee[1]+V[1])/2],Q=[(G[0]+Z[0])/2,(G[1]+Z[1])/2]}else if(Y.touch0)H=Y.touch0[0],Q=Y.touch0[1];else return;Y.zoom("touch",n(T(U,H,Q),Y.extent,u))}}function ue(z,...X){if(this.__zooming){var Y=k(this,X).event(z),W=z.changedTouches,F=W.length,te,U;for(eg(z),v&&clearTimeout(v),v=setTimeout(function(){v=null},w),te=0;te<F;++te)U=W[te],Y.touch0&&Y.touch0[2]===U.identifier?delete Y.touch0:Y.touch1&&Y.touch1[2]===U.identifier&&delete Y.touch1;if(Y.touch1&&!Y.touch0&&(Y.touch0=Y.touch1,delete Y.touch1),Y.touch0)Y.touch0[1]=this.__zoom.invert(Y.touch0[0]);else if(Y.end(),Y.taps===2&&(U=ka(U,this),Math.hypot(_[0]-U[0],_[1]-U[1])<E)){var H=Jr(this).on("dblclick.zoom");H&&H.apply(this,arguments)}}}return A.wheelDelta=function(z){return arguments.length?(r=typeof z=="function"?z:ff(+z),A):r},A.filter=function(z){return arguments.length?(e=typeof z=="function"?z:ff(!!z),A):e},A.touchable=function(z){return arguments.length?(i=typeof z=="function"?z:ff(!!z),A):i},A.extent=function(z){return arguments.length?(t=typeof z=="function"?z:ff([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),A):t},A.scaleExtent=function(z){return arguments.length?(l[0]=+z[0],l[1]=+z[1],A):[l[0],l[1]]},A.translateExtent=function(z){return arguments.length?(u[0][0]=+z[0][0],u[1][0]=+z[1][0],u[0][1]=+z[0][1],u[1][1]=+z[1][1],A):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},A.constrain=function(z){return arguments.length?(n=z,A):n},A.duration=function(z){return arguments.length?(d=+z,A):d},A.interpolate=function(z){return arguments.length?(m=z,A):m},A.on=function(){var z=y.on.apply(y,arguments);return z===y?A:z},A.clickDistance=function(z){return arguments.length?(S=(z=+z)*z,A):Math.sqrt(S)},A.tapDistance=function(z){return arguments.length?(E=+z,A):E},A}function Wt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tg(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xy(e,t){if(e){if(typeof e=="string")return tg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tg(e,t)}}function EE(e){if(Array.isArray(e))return e}function kE(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],i=!0,l=!1,u,d;try{for(n=n.call(e);!(i=(u=n.next()).done)&&(r.push(u.value),!(t&&r.length===t));i=!0);}catch(m){l=!0,d=m}finally{try{!i&&n.return!=null&&n.return()}finally{if(l)throw d}}return r}}function ME(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Bt(e,t){return EE(e)||kE(e,t)||xy(e,t)||ME()}var Qi;(function(e){e.Strict="strict",e.Loose="loose"})(Qi||(Qi={}));var vc;(function(e){e.Lines="lines",e.Dots="dots"})(vc||(vc={}));var yc;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(yc||(yc={}));var Yo;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Yo||(Yo={}));var hf;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(hf||(hf={}));var Ze;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Ze||(Ze={}));var ng=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},bc=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),r)},wy=function(t,n){return{x:bc(t.x,n[0][0],n[1][0]),y:bc(t.y,n[0][1],n[1][1])}},jy=function(t){var n,r;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((r=window)===null||r===void 0?void 0:r.document)},AE=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},pf=function(t){var n=t.x,r=t.y,i=t.width,l=t.height;return{x:n,y:r,x2:n+i,y2:r+l}},OE=function(t){var n=t.x,r=t.y,i=t.x2,l=t.y2;return{x:n,y:r,width:i-n,height:l-r}},Ny=function(t){return!isNaN(t)&&isFinite(t)},vs=Symbol("internals");function Sy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function id(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sy(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Cy(e,t){var n=e.find(function(y){return y.id===t.parentNode});if(n){var r=t.position.x+t.width-n.width,i=t.position.y+t.height-n.height;if(r>0||i>0||t.position.x<0||t.position.y<0){var l,u;if(n.style=id({},n.style)||{},n.style.width=(l=n.style.width)!==null&&l!==void 0?l:n.width,n.style.height=(u=n.style.height)!==null&&u!==void 0?u:n.height,r>0&&(n.style.width+=r),i>0&&(n.style.height+=i),t.position.x<0){var d=Math.abs(t.position.x);n.position.x=n.position.x-d,n.style.width+=d,t.position.x=0}if(t.position.y<0){var m=Math.abs(t.position.y);n.position.y=n.position.y-m,n.style.height+=m,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function Ey(e,t){if(e.some(function(r){return r.type==="reset"}))return e.filter(function(r){return r.type==="reset"}).map(function(r){return r.item});var n=e.filter(function(r){return r.type==="add"}).map(function(r){return r.item});return t.reduce(function(r,i){var l=e.find(function(m){return m.id===i.id});if(l)switch(l.type){case"select":return r.push(id(id({},i),{},{selected:l.selected})),r;case"position":{var u=id({},i);return typeof l.position<"u"&&(u.position=l.position),typeof l.positionAbsolute<"u"&&(u.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(u.dragging=l.dragging),u.expandParent&&Cy(r,u),r.push(u),r}case"dimensions":{var d=id({},i);return typeof l.dimensions<"u"&&(d.width=l.dimensions.width,d.height=l.dimensions.height),d.expandParent&&Cy(r,d),r.push(d),r}case"remove":return r}return r.push(i),r},n)}function ky(e,t){return Ey(e,t)}function PE(e,t){return Ey(e,t)}var Qo=function(t,n){return{id:t,type:"select",selected:n}};function xc(e,t){return e.reduce(function(n,r){var i=t.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(Qo(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(Qo(r.id,!1))),n},[])}function My(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Ay(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?My(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):My(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Oy=function(t,n,r){var i=n.querySelectorAll(t);if(!i||!i.length)return null;var l=Array.from(i),u=n.getBoundingClientRect();return l.map(function(d){var m=d.getBoundingClientRect();return Ay({id:d.getAttribute("data-handleid"),position:d.getAttribute("data-handlepos"),x:(m.left-u.left)/r,y:(m.top-u.top)/r},ng(d))})};function ld(e,t,n){return n===void 0?n:function(r){var i=t().nodeInternals.get(e);n(r,Ay({},i))}}function Py(e){var t=e.id,n=e.store,r=n.getState(),i=r.addSelectedNodes,l=r.unselectNodesAndEdges,u=r.multiSelectionActive,d=r.nodeInternals,m=d.get(t);n.setState({nodesSelectionActive:!1}),m.selected?m.selected&&u&&l({nodes:[m]}):i([t])}function Ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function cd(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ty(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ty(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var TE=function(t){return"id"in t&&"source"in t&&"target"in t},$E=function(t){var n=t.source,r=t.sourceHandle,i=t.target,l=t.targetHandle;return"reactflow__edge-".concat(n).concat(r||"","-").concat(i).concat(l||"")},sg=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var r=n?"".concat(n,"__"):"";return"".concat(r).concat(Object.keys(t).sort().map(function(i){return"".concat(i,"=").concat(t[i])}).join("&"))},LE=function(t,n){return n.some(function(r){return r.source===t.source&&r.target===t.target&&(r.sourceHandle===t.sourceHandle||!r.sourceHandle&&!t.sourceHandle)&&(r.targetHandle===t.targetHandle||!r.targetHandle&&!t.targetHandle)})},$y=function(t,n){if(!t.source||!t.target)return n;var r;return TE(t)?r=cd({},t):r=cd(cd({},t),{},{id:$E(t)}),LE(r,n)?n:n.concat(r)},Ly=function(t,n,r,i){var l=t.x,u=t.y,d=Bt(n,3),m=d[0],y=d[1],p=d[2],_=Bt(i,2),v=_[0],w=_[1],x={x:(l-m)/p,y:(u-y)/p};return r?{x:v*Math.round(x.x/v),y:w*Math.round(x.y/w)}:x},rg=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(r,i){var l=i.positionAbsolute,u=i.position,d=i.width,m=i.height;return AE(r,pf({x:l?l.x:u.x,y:l?l.y:u.y,width:d||0,height:m||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return OE(n)},Dy=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],i=Bt(r,3),l=i[0],u=i[1],d=i[2],m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,p=pf({x:(n.x-l)/d,y:(n.y-u)/d,width:n.width/d,height:n.height/d}),_=[];return t.forEach(function(v){var w=v.positionAbsolute,x=v.width,S=v.height,E=v.selectable,A=E===void 0?!0:E;if(y&&!A)return!1;var P=pf(cd(cd({},w),{},{width:x||0,height:S||0})),T=Math.max(0,Math.min(p.x2,P.x2)-Math.max(p.x,P.x)),j=Math.max(0,Math.min(p.y2,P.y2)-Math.max(p.y,P.y)),O=Math.ceil(T*j),k=typeof x>"u"||typeof S>"u"||x===null||S===null,D=m&&O>0,$=(x||0)*(S||0),B=k||D||O>=$;B&&_.push(v)}),_},zy=function(t,n){var r=t.map(function(i){return i.id});return n.filter(function(i){return r.includes(i.source)||r.includes(i.target)})},Ry=function(t,n,r,i,l){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,d=n/(t.width*(1+u)),m=r/(t.height*(1+u)),y=Math.min(d,m),p=bc(y,i,l),_=t.x+t.width/2,v=t.y+t.height/2,w=n/2-_*p,x=r/2-v*p;return[w,x,p]},Gi=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function Fy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function wc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fy(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Iy(e,t,n,r){var i,l,u,d,m,y,p,_,v,w,x,S;if(!e.parentNode)return r;var E=t.get(e.parentNode);return Iy(E,t,n,{x:((i=r.x)!==null&&i!==void 0?i:0)+((l=(u=E.position)===null||u===void 0?void 0:u.x)!==null&&l!==void 0?l:0),y:((d=r.y)!==null&&d!==void 0?d:0)+((m=(y=E.position)===null||y===void 0?void 0:y.y)!==null&&m!==void 0?m:0),z:((p=(_=E[vs])===null||_===void 0?void 0:_.z)!==null&&p!==void 0?p:0)>((v=r.z)!==null&&v!==void 0?v:0)?(w=(x=E[vs])===null||x===void 0?void 0:x.z)!==null&&w!==void 0?w:0:(S=r.z)!==null&&S!==void 0?S:0})}function ag(e,t){var n=new Map,r={};return e.forEach(function(i){var l,u=Ny(i.zIndex)?i.zIndex:i.selected?1e3:0,d=t.get(i.id),m=wc(wc({width:d==null?void 0:d.width,height:d==null?void 0:d.height},i),{},{positionAbsolute:{x:i.position.x,y:i.position.y}});i.parentNode&&(m.parentNode=i.parentNode,r[i.parentNode]=!0),Object.defineProperty(m,vs,{enumerable:!1,value:{handleBounds:d==null||(l=d[vs])===null||l===void 0?void 0:l.handleBounds,z:u}}),n.set(i.id,m)}),n.forEach(function(i){if(i.parentNode&&!n.has(i.parentNode))throw new Error("Parent node ".concat(i.parentNode," not found"));if(i.parentNode||r[i.id]){var l,u,d=Iy(i,n,r,wc(wc({},i.position),{},{z:(l=(u=i[vs])===null||u===void 0?void 0:u.z)!==null&&l!==void 0?l:0})),m=d.x,y=d.y,p=d.z;i.positionAbsolute={x:m,y},i[vs].z=p,r[i.id]&&(i[vs].isParent=!0)}}),n}function By(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),r=n.nodeInternals,i=n.width,l=n.height,u=n.minZoom,d=n.maxZoom,m=n.d3Zoom,y=n.d3Selection,p=n.fitViewOnInitDone,_=n.fitViewOnInit;if((t.initial&&!p&&_||!t.initial)&&m&&y){var v=Array.from(r.values()).filter(function($){return t.includeHiddenNodes?$.width&&$.height:!$.hidden}),w=v.every(function($){return $.width&&$.height});if(v.length>0&&w){var x,S,E,A=rg(v),P=Ry(A,i,l,(x=t.minZoom)!==null&&x!==void 0?x:u,(S=t.maxZoom)!==null&&S!==void 0?S:d,(E=t.padding)!==null&&E!==void 0?E:.1),T=Bt(P,3),j=T[0],O=T[1],k=T[2],D=Yi.translate(j,O).scale(k);return typeof t.duration=="number"&&t.duration>0?m.transform(Gi(y,t.duration),D):m.transform(y,D),!0}}return!1}function DE(e,t){return e.forEach(function(n){var r=t.get(n.id);if(r){var i;t.set(r.id,wc(wc({},r),{},(i={},Wt(i,vs,r[vs]),Wt(i,"selected",n.selected),i)))}}),new Map(t)}function zE(e,t){return t.map(function(n){var r=e.find(function(i){return i.id===n.id});return r&&(n.selected=r.selected),n})}function gf(e){var t=e.changedNodes,n=e.changedEdges,r=e.get,i=e.set,l=r(),u=l.nodeInternals,d=l.edges,m=l.onNodesChange,y=l.onEdgesChange,p=l.hasDefaultNodes,_=l.hasDefaultEdges;t!=null&&t.length&&(p&&i({nodeInternals:DE(t,u)}),m==null||m(t)),n!=null&&n.length&&(_&&i({edges:zE(n,d)}),y==null||y(n))}var og=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Uy={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:og,nodeExtent:og,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:Qi.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Oa(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qy(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var ig=Yj(),Hy=ig.Provider,Kn=ig.useStore,ks=ig.useStoreApi,Vy=function(){return Kj(function(t,n){return Oa(Oa({},Uy),{},{setNodes:function(i){t({nodeInternals:ag(i,n().nodeInternals)})},setEdges:function(i){var l=n(),u=l.defaultEdgeOptions,d=u===void 0?{}:u;t({edges:i.map(function(m){return Oa(Oa({},d),m)})})},setDefaultNodesAndEdges:function(i,l){var u=typeof i<"u",d=typeof l<"u",m=u?ag(i,new Map):new Map,y=d?l:[];t({nodeInternals:m,edges:y,hasDefaultNodes:u,hasDefaultEdges:d})},updateNodeDimensions:function(i){var l=n(),u=l.onNodesChange,d=l.nodeInternals,m=l.fitViewOnInit,y=l.fitViewOnInitDone,p=l.fitViewOnInitOptions,_=l.domNode,v=_==null?void 0:_.querySelector(".react-flow__viewport");if(v){var w=window.getComputedStyle(v),x=new window.DOMMatrixReadOnly(w.transform),S=x.m22,E=i.reduce(function(P,T){var j=d.get(T.id);if(j){var O=ng(T.nodeElement),k=!!(O.width&&O.height&&(j.width!==O.width||j.height!==O.height||T.forceUpdate));k&&(d.set(j.id,Oa(Oa({},j),{},Wt({},vs,Oa(Oa({},j[vs]),{},{handleBounds:{source:Oy(".source",T.nodeElement,S),target:Oy(".target",T.nodeElement,S)}})),O)),P.push({id:j.id,type:"dimensions",dimensions:O}))}return P},[]),A=y||m&&!y&&By(n,Oa({initial:!0},p));t({nodeInternals:new Map(d),fitViewOnInitDone:A}),(E==null?void 0:E.length)>0&&(u==null||u(E))}},updateNodePositions:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=n(),m=d.onNodesChange,y=d.nodeInternals,p=d.hasDefaultNodes;if(p||m){var _=i.map(function(x){var S={id:x.id,type:"position",dragging:u};return l&&(S.positionAbsolute=x.positionAbsolute,S.position=x.position),S});if(_!=null&&_.length){if(p){var v=ky(_,Array.from(y.values())),w=ag(v,y);t({nodeInternals:w})}m==null||m(_)}}},addSelectedNodes:function(i){var l=n(),u=l.multiSelectionActive,d=l.nodeInternals,m=l.edges,y,p=null;u?y=i.map(function(_){return Qo(_,!0)}):(y=xc(Array.from(d.values()),i),p=xc(m,[])),gf({changedNodes:y,changedEdges:p,get:n,set:t})},addSelectedEdges:function(i){var l=n(),u=l.multiSelectionActive,d=l.edges,m=l.nodeInternals,y,p=null;u?y=i.map(function(_){return Qo(_,!0)}):(y=xc(d,i),p=xc(Array.from(m.values()),[])),gf({changedNodes:p,changedEdges:y,get:n,set:t})},unselectNodesAndEdges:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=i.nodes,u=i.edges,d=n(),m=d.nodeInternals,y=d.edges,p=l||Array.from(m.values()),_=u||y,v=p.map(function(x){return x.selected=!1,Qo(x.id,!1)}),w=_.map(function(x){return Qo(x.id,!1)});gf({changedNodes:v,changedEdges:w,get:n,set:t})},setMinZoom:function(i){var l=n(),u=l.d3Zoom,d=l.maxZoom;u==null||u.scaleExtent([i,d]),t({minZoom:i})},setMaxZoom:function(i){var l=n(),u=l.d3Zoom,d=l.minZoom;u==null||u.scaleExtent([d,i]),t({maxZoom:i})},setTranslateExtent:function(i){var l=n(),u=l.d3Zoom;u==null||u.translateExtent(i),t({translateExtent:i})},resetSelectedElements:function(){var i=n(),l=i.nodeInternals,u=i.edges,d=Array.from(l.values()),m=d.filter(function(p){return p.selected}).map(function(p){return Qo(p.id,!1)}),y=u.filter(function(p){return p.selected}).map(function(p){return Qo(p.id,!1)});gf({changedNodes:m,changedEdges:y,get:n,set:t})},setNodeExtent:function(i){var l=n(),u=l.nodeInternals;u.forEach(function(d){d.positionAbsolute=wy(d.position,i)}),t({nodeExtent:i,nodeInternals:new Map(u)})},reset:function(){return t(Oa({},Uy))}})})};function br(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=br(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function xr(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}function RE(e){if(Array.isArray(e))return tg(e)}function FE(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function IE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xi(e){return RE(e)||FE(e)||xy(e)||IE()}var BE={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},UE=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},qE=function(){var t=ks(),n=Kn(UE,xr),r=n.d3Zoom,i=n.d3Selection,l=f.useMemo(function(){return i&&r?{zoomIn:function(d){return r.scaleBy(Gi(i,d==null?void 0:d.duration),1.2)},zoomOut:function(d){return r.scaleBy(Gi(i,d==null?void 0:d.duration),1/1.2)},zoomTo:function(d,m){return r.scaleTo(Gi(i,m==null?void 0:m.duration),d)},getZoom:function(){return t.getState().transform[2]},setViewport:function(d,m){var y,p,_,v=Bt(t.getState().transform,3),w=v[0],x=v[1],S=v[2],E=Yi.translate((y=d.x)!==null&&y!==void 0?y:w,(p=d.y)!==null&&p!==void 0?p:x).scale((_=d.zoom)!==null&&_!==void 0?_:S);r.transform(Gi(i,m==null?void 0:m.duration),E)},getViewport:function(){var d=Bt(t.getState().transform,3),m=d[0],y=d[1],p=d[2];return{x:m,y,zoom:p}},fitView:function(d){return By(t.getState,d)},setCenter:function(d,m,y){var p=t.getState(),_=p.width,v=p.height,w=p.maxZoom,x=typeof(y==null?void 0:y.zoom)<"u"?y.zoom:w,S=_/2-d*x,E=v/2-m*x,A=Yi.translate(S,E).scale(x);r.transform(Gi(i,y==null?void 0:y.duration),A)},fitBounds:function(d,m){var y,p=t.getState(),_=p.width,v=p.height,w=p.minZoom,x=p.maxZoom,S=Ry(d,_,v,w,x,(y=m==null?void 0:m.padding)!==null&&y!==void 0?y:.1),E=Bt(S,3),A=E[0],P=E[1],T=E[2],j=Yi.translate(A,P).scale(T);r.transform(Gi(i,m==null?void 0:m.duration),j)},project:function(d){var m=t.getState(),y=m.transform,p=m.snapToGrid,_=m.snapGrid;return Ly(d,y,p,_)},viewportInitialized:!0}:BE},[r,i]);return l};function Wy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function jc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Wy(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lg(){var e=qE(),t=ks(),n=f.useCallback(function(){var _=t.getState(),v=_.nodeInternals,w=Array.from(v.values());return w.map(function(x){return jc({},x)})},[]),r=f.useCallback(function(_){var v=t.getState(),w=v.nodeInternals;return w.get(_)},[]),i=f.useCallback(function(){var _=t.getState(),v=_.edges,w=v===void 0?[]:v;return w.map(function(x){return jc({},x)})},[]),l=f.useCallback(function(_){var v=t.getState(),w=v.edges,x=w===void 0?[]:w;return x.find(function(S){return S.id===_})},[]),u=f.useCallback(function(_){var v=t.getState(),w=v.nodeInternals,x=v.setNodes,S=v.hasDefaultNodes,E=v.onNodesChange,A=Array.from(w.values()),P=typeof _=="function"?_(A):_;if(S)x(P);else if(E){var T=P.length===0?A.map(function(j){return{type:"remove",id:j.id}}):P.map(function(j){return{item:j,type:"reset"}});E(T)}},[]),d=f.useCallback(function(_){var v=t.getState(),w=v.edges,x=w===void 0?[]:w,S=v.setEdges,E=v.hasDefaultEdges,A=v.onEdgesChange,P=typeof _=="function"?_(x):_;if(E)S(P);else if(A){var T=P.length===0?x.map(function(j){return{type:"remove",id:j.id}}):P.map(function(j){return{item:j,type:"reset"}});A(T)}},[]),m=f.useCallback(function(_){var v=Array.isArray(_)?_:[_],w=t.getState(),x=w.nodeInternals,S=w.setNodes,E=w.hasDefaultNodes,A=w.onNodesChange;if(E){var P=Array.from(x.values()),T=[].concat(P,Xi(v));S(T)}else if(A){var j=v.map(function(O){return{item:O,type:"add"}});A(j)}},[]),y=f.useCallback(function(_){var v=Array.isArray(_)?_:[_],w=t.getState(),x=w.edges,S=x===void 0?[]:x,E=w.setEdges,A=w.hasDefaultEdges,P=w.onEdgesChange;if(A)E([].concat(Xi(S),Xi(v)));else if(P){var T=v.map(function(j){return{item:j,type:"add"}});P(T)}},[]),p=f.useCallback(function(){var _=t.getState(),v=_.nodeInternals,w=_.edges,x=w===void 0?[]:w,S=_.transform,E=Array.from(v.values()),A=Bt(S,3),P=A[0],T=A[1],j=A[2];return{nodes:E.map(function(O){return jc({},O)}),edges:x.map(function(O){return jc({},O)}),viewport:{x:P,y:T,zoom:j}}},[]);return f.useMemo(function(){return jc(jc({},e),{},{getNodes:n,getNode:r,getEdges:i,getEdge:l,setNodes:u,setEdges:d,addNodes:m,addEdges:y,toObject:p})},[e,n,r,i,l,u,d,m,y,p])}function HE(e,t){if(e==null)return{};var n={},r=Object.keys(e),i,l;for(l=0;l<r.length;l++)i=r[l],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function _f(e,t){if(e==null)return{};var n=HE(e,t),r,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)r=l[i],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function VE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Ae.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function WE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},Ae.createElement("path",{d:"M0 0h32v4.2H0z"}))}function KE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},Ae.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function YE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Ae.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function QE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Ae.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var GE=["children","className"];function Ky(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function XE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ky(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ky(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var vf=function(t){var n=t.children,r=t.className,i=_f(t,GE);return Ae.createElement("button",XE({type:"button",className:br(["react-flow__controls-button",r])},i),n)},JE=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},Yy=function(t){var n=t.style,r=t.showZoom,i=r===void 0?!0:r,l=t.showFitView,u=l===void 0?!0:l,d=t.showInteractive,m=d===void 0?!0:d,y=t.fitViewOptions,p=t.onZoomIn,_=t.onZoomOut,v=t.onFitView,w=t.onInteractiveChange,x=t.className,S=t.children,E=ks(),A=f.useState(!1),P=Bt(A,2),T=P[0],j=P[1],O=Kn(JE),k=lg(),D=k.zoomIn,$=k.zoomOut,B=k.fitView;if(f.useEffect(function(){j(!0)},[]),!T)return null;var q=function(){D==null||D(),p==null||p()},K=function(){$==null||$(),_==null||_()},ne=function(){B==null||B(y),v==null||v()},ue=function(){E.setState({nodesDraggable:!O,nodesConnectable:!O,elementsSelectable:!O}),w==null||w(!O)};return Ae.createElement("div",{className:br(["react-flow__controls",x]),style:n},i&&Ae.createElement(Ae.Fragment,null,Ae.createElement(vf,{onClick:q,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},Ae.createElement(VE,null)),Ae.createElement(vf,{onClick:K,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},Ae.createElement(WE,null))),u&&Ae.createElement(vf,{className:"react-flow__controls-fitview",onClick:ne,title:"fit view","aria-label":"fit view"},Ae.createElement(KE,null)),m&&Ae.createElement(vf,{className:"react-flow__controls-interactive",onClick:ue,title:"toggle interactivity","aria-label":"toggle interactivity"},O?Ae.createElement(QE,null):Ae.createElement(YE,null)),S)};Yy.displayName="Controls";var ZE=f.memo(Yy),ek=function(t,n,r){return Ae.createElement("path",{stroke:r,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},tk=function(t,n){return Ae.createElement("circle",{cx:t,cy:t,r:t,fill:n})},yf;function Qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Gy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qy(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var nk=(yf={},Wt(yf,vc.Dots,"#81818a"),Wt(yf,vc.Lines,"#eee"),yf),sk=function(t){return t.transform},Xy=function(t){var n=t.variant,r=n===void 0?vc.Dots:n,i=t.gap,l=i===void 0?15:i,u=t.size,d=u===void 0?.4:u,m=t.color,y=t.style,p=t.className,_=f.useRef(null),v=f.useState(null),w=Bt(v,2),x=w[0],S=w[1],E=Kn(sk),A=Bt(E,3),P=A[0],T=A[1],j=A[2];f.useEffect(function(){var K=document.querySelectorAll(".react-flow__background"),ne=Array.from(K).findIndex(function(ue){return ue===_.current});S("pattern-".concat(ne))},[]);var O=l*j||1,k=P%O,D=T%O,$=r===vc.Lines,B=m||nk[r],q=$?ek(O,d,B):tk(d*j,B);return Ae.createElement("svg",{className:br(["react-flow__background","react-flow__container",p]),style:Gy(Gy({},y),{},{width:"100%",height:"100%"}),ref:_},x&&Ae.createElement(Ae.Fragment,null,Ae.createElement("pattern",{id:x,x:k,y:D,width:O,height:O,patternUnits:"userSpaceOnUse"},q),Ae.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(x,")")})))};Xy.displayName="Background";var rk=f.memo(Xy),ak=function(t){return t.updateNodeDimensions};function ok(){var e=ks(),t=Kn(ak);return f.useCallback(function(n){var r,i=(r=e.getState().domNode)===null||r===void 0?void 0:r.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));i&&requestAnimationFrame(function(){return t([{id:n,nodeElement:i,forceUpdate:!0}])})},[])}var ik=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function lk(e){var t=e.proOptions,n=e.position,r=n===void 0?"bottom-right":n;if(t!=null&&t.account&&ik.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var i="".concat(r).split("-");return Ae.createElement("div",{className:br(["react-flow__attribution"].concat(Xi(i))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},Ae.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var ck=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function Jy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function uk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Jy(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Jy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var dk=function(t){var n=t.x,r=t.y,i=t.label,l=t.labelStyle,u=l===void 0?{}:l,d=t.labelShowBg,m=d===void 0?!0:d,y=t.labelBgStyle,p=y===void 0?{}:y,_=t.labelBgPadding,v=_===void 0?[2,4]:_,w=t.labelBgBorderRadius,x=w===void 0?2:w,S=t.children,E=t.className,A=_f(t,ck),P=f.useRef(null),T=f.useState({x:0,y:0,width:0,height:0}),j=Bt(T,2),O=j[0],k=j[1],D=br(["react-flow__edge-textwrapper",E]);return f.useEffect(function(){if(P.current){var $=P.current.getBBox();k({x:$.x,y:$.y,width:$.width,height:$.height})}},[i]),typeof i>"u"||!i?null:Ae.createElement("g",uk({transform:"translate(".concat(n-O.width/2," ").concat(r-O.height/2,")"),className:D},A),m&&Ae.createElement("rect",{width:O.width+2*v[0],x:-v[0],y:-v[1],height:O.height+2*v[1],className:"react-flow__edge-textbg",style:p,rx:x,ry:x}),Ae.createElement("text",{className:"react-flow__edge-text",y:O.height/2,dy:"0.3em",ref:P,style:u},i),S)},mk=f.memo(dk),bf=function(e){var t=e.path,n=e.centerX,r=e.centerY,i=e.label,l=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,m=e.labelBgPadding,y=e.labelBgBorderRadius,p=e.style,_=e.markerEnd,v=e.markerStart,w=i?Ae.createElement(mk,{x:n,y:r,label:i,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:m,labelBgBorderRadius:y}):null;return Ae.createElement(Ae.Fragment,null,Ae.createElement("path",{style:p,d:t,className:"react-flow__edge-path",markerEnd:_,markerStart:v}),w)};function xf(e){var t=e.pos,n=e.x1,r=e.y1,i=e.x2,l=e.y2,u,d;switch(t){case Ze.Left:case Ze.Right:u=.5*(n+i),d=r;break;case Ze.Top:case Ze.Bottom:u=n,d=.5*(r+l);break}return[u,d]}function Zy(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,i=r===void 0?Ze.Bottom:r,l=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Ze.Top:d,y=xf({pos:i,x1:t,y1:n,x2:l,y2:u}),p=Bt(y,2),_=p[0],v=p[1],w=xf({pos:m,x1:l,y1:u,x2:t,y2:n}),x=Bt(w,2),S=x[0],E=x[1];return"M".concat(t,",").concat(n," C").concat(_,",").concat(v," ").concat(S,",").concat(E," ").concat(l,",").concat(u)}function fk(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,i=r===void 0?Ze.Bottom:r,l=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Ze.Top:d,y=xf({pos:i,x1:t,y1:n,x2:l,y2:u}),p=Bt(y,2),_=p[0],v=p[1],w=xf({pos:m,x1:l,y1:u,x2:t,y2:n}),x=Bt(w,2),S=x[0],E=x[1],A=t*.125+_*.375+S*.375+l*.125,P=n*.125+v*.375+E*.375+u*.125,T=Math.abs(A-t),j=Math.abs(P-n);return[A,P,T,j]}var eb=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,i=e.targetY,l=e.sourcePosition,u=l===void 0?Ze.Bottom:l,d=e.targetPosition,m=d===void 0?Ze.Top:d,y=e.label,p=e.labelStyle,_=e.labelShowBg,v=e.labelBgStyle,w=e.labelBgPadding,x=e.labelBgBorderRadius,S=e.style,E=e.markerEnd,A=e.markerStart,P={sourceX:t,sourceY:n,sourcePosition:u,targetX:r,targetY:i,targetPosition:m},T=Zy(P),j=fk(P),O=Bt(j,2),k=O[0],D=O[1];return Ae.createElement(bf,{path:T,centerX:k,centerY:D,label:y,labelStyle:p,labelShowBg:_,labelBgStyle:v,labelBgPadding:w,labelBgBorderRadius:x,style:S,markerEnd:E,markerStart:A})});function tb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function hk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var nb=[Ze.Left,Ze.Right],sb=function(t){var n=t.sourceX,r=t.sourceY,i=t.targetX,l=t.targetY,u=t.sourcePosition,d=u===void 0?Ze.Bottom:u,m=t.targetPosition,y=m===void 0?Ze.Top:m,p=nb.includes(d),_=nb.includes(y),v=p&&!_||_&&!p;if(v){var w=p?Math.abs(i-n):0,x=n>i?n-w:n+w,S=p?0:Math.abs(l-r),E=r<l?r+S:r-S;return[x,E,w,S]}var A=Math.abs(i-n)/2,P=i<n?i+A:i-A,T=Math.abs(l-r)/2,j=l<r?l+T:l-T;return[P,j,A,T]};function ud(e,t,n){return n===void 0?n:function(r){var i=t().edges.find(function(l){return l.id===e});n(r,hk({},i))}}var cg=function(t,n,r){return"L ".concat(t,",").concat(n-r,"Q ").concat(t,",").concat(n," ").concat(t+r,",").concat(n)},ug=function(t,n,r){return"L ".concat(t+r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-r)},dg=function(t,n,r){return"L ".concat(t,",").concat(n-r,"Q ").concat(t,",").concat(n," ").concat(t-r,",").concat(n)},mg=function(t,n,r){return"L ".concat(t-r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-r)},fg=function(t,n,r){return"L ".concat(t+r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+r)},hg=function(t,n,r){return"L ".concat(t,",").concat(n+r,"Q ").concat(t,",").concat(n," ").concat(t+r,",").concat(n)},pg=function(t,n,r){return"L ".concat(t,",").concat(n+r,"Q ").concat(t,",").concat(n," ").concat(t-r,",").concat(n)},gg=function(t,n,r){return"L ".concat(t-r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+r)};function _g(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,i=r===void 0?Ze.Bottom:r,l=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Ze.Top:d,y=e.borderRadius,p=y===void 0?5:y,_=e.centerX,v=e.centerY,w=sb({sourceX:t,sourceY:n,targetX:l,targetY:u}),x=Bt(w,4),S=x[0],E=x[1],A=x[2],P=x[3],T=Math.min(p,Math.abs(l-t)),j=Math.min(p,Math.abs(u-n)),O=Math.min(T,j,A,P),k=[Ze.Left,Ze.Right],D=typeof _<"u"?_:S,$=typeof v<"u"?v:E,B=null,q=null;return t<=l?(B=n<=u?cg(t,$,O):hg(t,$,O),q=n<=u?gg(l,$,O):mg(l,$,O)):(B=n<u?dg(t,$,O):pg(t,$,O),q=n<u?fg(l,$,O):ug(l,$,O)),k.includes(i)&&k.includes(m)?t<=l?(B=n<=u?gg(D,n,O):mg(D,n,O),q=n<=u?cg(D,u,O):hg(D,u,O)):(i===Ze.Right&&m===Ze.Left||i===Ze.Left&&m===Ze.Right||i===Ze.Left&&m===Ze.Left)&&(B=n<=u?fg(D,n,O):ug(D,n,O),q=n<=u?dg(D,u,O):pg(D,u,O)):k.includes(i)&&!k.includes(m)?(t<=l?B=n<=u?gg(l,n,O):mg(l,n,O):B=n<=u?fg(l,n,O):ug(l,n,O),q=""):!k.includes(i)&&k.includes(m)&&(t<=l?B=n<=u?cg(t,u,O):hg(t,u,O):B=n<=u?dg(t,u,O):pg(t,u,O),q=""),"M ".concat(t,",").concat(n).concat(B).concat(q,"L ").concat(l,",").concat(u)}var vg=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,i=e.targetY,l=e.label,u=e.labelStyle,d=e.labelShowBg,m=e.labelBgStyle,y=e.labelBgPadding,p=e.labelBgBorderRadius,_=e.style,v=e.sourcePosition,w=v===void 0?Ze.Bottom:v,x=e.targetPosition,S=x===void 0?Ze.Top:x,E=e.markerEnd,A=e.markerStart,P=e.borderRadius,T=P===void 0?5:P,j=sb({sourceX:t,sourceY:n,targetX:r,targetY:i,sourcePosition:w,targetPosition:S}),O=Bt(j,2),k=O[0],D=O[1],$=_g({sourceX:t,sourceY:n,sourcePosition:w,targetX:r,targetY:i,targetPosition:S,borderRadius:T});return Ae.createElement(bf,{path:$,centerX:k,centerY:D,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:p,style:_,markerEnd:E,markerStart:A})});function rb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ab(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var ob=f.memo(function(e){return Ae.createElement(vg,ab(ab({},e),{},{borderRadius:0}))}),ib=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,i=e.targetY,l=e.label,u=e.labelStyle,d=e.labelShowBg,m=e.labelBgStyle,y=e.labelBgPadding,p=e.labelBgBorderRadius,_=e.style,v=e.markerEnd,w=e.markerStart,x=Math.abs(i-n)/2,S=i<n?i+x:i-x,E=Math.abs(r-t)/2,A=r<t?r+E:r-E,P="M ".concat(t,",").concat(n,"L ").concat(r,",").concat(i);return Ae.createElement(bf,{path:P,centerX:A,centerY:S,label:l,labelStyle:u,labelShowBg:d,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:p,style:_,markerEnd:v,markerStart:w})});function wf(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function jf(e){var t=e.pos,n=e.x1,r=e.y1,i=e.x2,l=e.y2,u=e.c,d,m;switch(t){case Ze.Left:d=n-wf(n-i,u),m=r;break;case Ze.Right:d=n+wf(i-n,u),m=r;break;case Ze.Top:d=n,m=r-wf(r-l,u);break;case Ze.Bottom:d=n,m=r+wf(l-r,u);break}return[d,m]}function lb(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,i=r===void 0?Ze.Bottom:r,l=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Ze.Top:d,y=e.curvature,p=y===void 0?.25:y,_=jf({pos:i,x1:t,y1:n,x2:l,y2:u,c:p}),v=Bt(_,2),w=v[0],x=v[1],S=jf({pos:m,x1:l,y1:u,x2:t,y2:n,c:p}),E=Bt(S,2),A=E[0],P=E[1];return"M".concat(t,",").concat(n," C").concat(w,",").concat(x," ").concat(A,",").concat(P," ").concat(l,",").concat(u)}function pk(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,i=r===void 0?Ze.Bottom:r,l=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Ze.Top:d,y=e.curvature,p=y===void 0?.25:y,_=jf({pos:i,x1:t,y1:n,x2:l,y2:u,c:p}),v=Bt(_,2),w=v[0],x=v[1],S=jf({pos:m,x1:l,y1:u,x2:t,y2:n,c:p}),E=Bt(S,2),A=E[0],P=E[1],T=t*.125+w*.375+A*.375+l*.125,j=n*.125+x*.375+P*.375+u*.125,O=Math.abs(T-t),k=Math.abs(j-n);return[T,j,O,k]}var yg=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,i=e.targetY,l=e.sourcePosition,u=l===void 0?Ze.Bottom:l,d=e.targetPosition,m=d===void 0?Ze.Top:d,y=e.label,p=e.labelStyle,_=e.labelShowBg,v=e.labelBgStyle,w=e.labelBgPadding,x=e.labelBgBorderRadius,S=e.style,E=e.markerEnd,A=e.markerStart,P=e.curvature,T={sourceX:t,sourceY:n,sourcePosition:u,targetX:r,targetY:i,targetPosition:m,curvature:P},j=lb(T),O=pk(T),k=Bt(O,2),D=k[0],$=k[1];return Ae.createElement(bf,{path:j,centerX:D,centerY:$,label:y,labelStyle:p,labelShowBg:_,labelBgStyle:v,labelBgPadding:w,labelBgBorderRadius:x,style:S,markerEnd:E,markerStart:A})}),bg=f.createContext(null),gk=bg.Provider;bg.Consumer;function xg(e,t,n,r,i,l,u){var d=u.elementFromPoint(e.clientX,e.clientY),m=(d==null?void 0:d.classList.contains("target"))||!1,y=(d==null?void 0:d.classList.contains("source"))||!1,p={elementBelow:d,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(d&&(m||y)){p.isHoveringHandle=!0;var _=d.getAttribute("data-nodeid"),v=d.getAttribute("data-handleid"),w=n?{source:_,sourceHandle:v,target:r,targetHandle:i}:{source:r,sourceHandle:i,target:_,targetHandle:v};p.connection=w;var x=t===Qi.Strict?n&&y||!n&&m:!0;x&&(p.isValid=l(w))}return p}function wg(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function cb(e){var t=e.event,n=e.handleId,r=e.nodeId,i=e.onConnect,l=e.isTarget,u=e.getState,d=e.setState,m=e.isValidConnection,y=e.elementEdgeUpdaterType,p=e.onEdgeUpdateEnd,_=t.target.closest(".react-flow"),v=jy(t.target);if(!v)return;var w=v.elementFromPoint(t.clientX,t.clientY),x=w==null?void 0:w.classList.contains("target"),S=w==null?void 0:w.classList.contains("source");if(!_||!x&&!S&&!y)return;var E=u(),A=E.onConnectStart,P=E.connectionMode,T=y||(x?"target":"source"),j=_.getBoundingClientRect(),O;d({connectionPosition:{x:t.clientX-j.left,y:t.clientY-j.top},connectionNodeId:r,connectionHandleId:n,connectionHandleType:T}),A==null||A(t,{nodeId:r,handleId:n,handleType:T});function k($){d({connectionPosition:{x:$.clientX-j.left,y:$.clientY-j.top}});var B=xg($,P,l,r,n,m,v),q=B.connection,K=B.elementBelow,ne=B.isValid,ue=B.isHoveringHandle;if(!ue)return wg(O);q.source!==q.target&&K&&(wg(O),O=K,K.classList.add("react-flow__handle-connecting"),K.classList.toggle("react-flow__handle-valid",ne))}function D($){var B=u(),q=B.onConnectStop,K=B.onConnectEnd,ne=xg($,P,l,r,n,m,v),ue=ne.connection,z=ne.isValid;q==null||q($),z&&(i==null||i(ue)),K==null||K($),y&&p&&p($),wg(O),d({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),v.removeEventListener("mousemove",k),v.removeEventListener("mouseup",D)}v.addEventListener("mousemove",k),v.addEventListener("mouseup",D)}var _k=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function ub(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function jg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ub(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ub(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var vk=function(){return!0},yk=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},db=f.forwardRef(function(e,t){var n=e.type,r=n===void 0?"source":n,i=e.position,l=i===void 0?Ze.Top:i,u=e.isValidConnection,d=u===void 0?vk:u,m=e.isConnectable,y=m===void 0?!0:m,p=e.id,_=e.onConnect,v=e.children,w=e.className,x=e.onMouseDown,S=_f(e,_k),E=ks(),A=f.useContext(bg),P=Kn(yk,xr),T=P.connectionStartHandle,j=P.connectOnClick,O=p||null,k=r==="target",D=function(K){var ne=E.getState(),ue=ne.defaultEdgeOptions,z=ne.onConnect,X=ne.hasDefaultEdges,Y=jg(jg({},ue),K);if(X){var W=E.getState(),F=W.edges;E.setState({edges:$y(Y,F)})}z==null||z(Y),_==null||_(Y)},$=function(K){K.button===0&&cb({event:K,handleId:O,nodeId:A,onConnect:D,isTarget:k,getState:E.getState,setState:E.setState,isValidConnection:d}),x==null||x(K)},B=function(K){var ne=E.getState(),ue=ne.onClickConnectStart,z=ne.onClickConnectStop,X=ne.onClickConnectEnd,Y=ne.connectionMode;if(!T){ue==null||ue(K,{nodeId:A,handleId:O,handleType:r}),E.setState({connectionStartHandle:{nodeId:A,type:r,handleId:O}});return}var W=jy(K.target),F=xg(K,Y,T.type==="target",T.nodeId,T.handleId||null,d,W),te=F.connection,U=F.isValid;z==null||z(K),U&&D(te),X==null||X(K),E.setState({connectionStartHandle:null})};return Ae.createElement("div",jg({"data-handleid":O,"data-nodeid":A,"data-handlepos":l,className:br(["react-flow__handle","react-flow__handle-".concat(l),"nodrag",w,{source:!k,target:k,connectable:y,connecting:(T==null?void 0:T.nodeId)===A&&(T==null?void 0:T.handleId)===O&&(T==null?void 0:T.type)===r}]),onMouseDown:$,onClick:j?B:void 0,ref:t},S),v)});db.displayName="Handle";var dd=f.memo(db),mb=function(t){var n=t.data,r=t.isConnectable,i=t.targetPosition,l=i===void 0?Ze.Top:i,u=t.sourcePosition,d=u===void 0?Ze.Bottom:u;return Ae.createElement(Ae.Fragment,null,Ae.createElement(dd,{type:"target",position:l,isConnectable:r}),n==null?void 0:n.label,Ae.createElement(dd,{type:"source",position:d,isConnectable:r}))};mb.displayName="DefaultNode";var Ng=f.memo(mb),fb=function(t){var n=t.data,r=t.isConnectable,i=t.sourcePosition,l=i===void 0?Ze.Bottom:i;return Ae.createElement(Ae.Fragment,null,n==null?void 0:n.label,Ae.createElement(dd,{type:"source",position:l,isConnectable:r}))};fb.displayName="InputNode";var hb=f.memo(fb),pb=function(t){var n=t.data,r=t.isConnectable,i=t.targetPosition,l=i===void 0?Ze.Top:i;return Ae.createElement(Ae.Fragment,null,Ae.createElement(dd,{type:"target",position:l,isConnectable:r}),n==null?void 0:n.label)};pb.displayName="OutputNode";var gb=f.memo(pb),bk=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},xk=function(t,n){var r=t.selectedNodes.map(function(d){return d.id}),i=n.selectedNodes.map(function(d){return d.id}),l=t.selectedEdges.map(function(d){return d.id}),u=n.selectedEdges.map(function(d){return d.id});return xr(r,i)&&xr(l,u)};function wk(e){var t=e.onSelectionChange,n=Kn(bk,xk),r=n.selectedNodes,i=n.selectedEdges;return f.useEffect(function(){t({nodes:r,edges:i})},[r,i]),null}var jk=f.memo(wk),Nk=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function Go(e,t){f.useEffect(function(){typeof e<"u"&&t(e)},[e])}function pn(e,t,n){f.useEffect(function(){typeof t<"u"&&n(Wt({},e,t))},[t])}var Sk=function(t){var n=t.nodes,r=t.edges,i=t.defaultNodes,l=t.defaultEdges,u=t.onConnect,d=t.onConnectStart,m=t.onConnectStop,y=t.onConnectEnd,p=t.onClickConnectStart,_=t.onClickConnectStop,v=t.onClickConnectEnd,w=t.nodesDraggable,x=t.nodesConnectable,S=t.minZoom,E=t.maxZoom,A=t.nodeExtent,P=t.onNodesChange,T=t.onEdgesChange,j=t.elementsSelectable,O=t.connectionMode,k=t.snapGrid,D=t.snapToGrid,$=t.translateExtent,B=t.connectOnClick,q=t.defaultEdgeOptions,K=t.fitView,ne=t.fitViewOptions,ue=t.onNodesDelete,z=t.onEdgesDelete,X=t.onNodeDrag,Y=t.onNodeDragStart,W=t.onNodeDragStop,F=t.onSelectionDrag,te=t.onSelectionDragStart,U=t.onSelectionDragStop,H=Kn(Nk,xr),Q=H.setNodes,ee=H.setEdges,G=H.setDefaultNodesAndEdges,V=H.setMinZoom,Z=H.setMaxZoom,de=H.setTranslateExtent,pe=H.setNodeExtent,le=H.reset,ge=ks();return f.useEffect(function(){return G(i,l),function(){le()}},[]),pn("defaultEdgeOptions",q,ge.setState),pn("connectionMode",O,ge.setState),pn("onConnect",u,ge.setState),pn("onConnectStart",d,ge.setState),pn("onConnectStop",m,ge.setState),pn("onConnectEnd",y,ge.setState),pn("onClickConnectStart",p,ge.setState),pn("onClickConnectStop",_,ge.setState),pn("onClickConnectEnd",v,ge.setState),pn("nodesDraggable",w,ge.setState),pn("nodesConnectable",x,ge.setState),pn("elementsSelectable",j,ge.setState),pn("snapToGrid",D,ge.setState),pn("snapGrid",k,ge.setState),pn("onNodesChange",P,ge.setState),pn("onEdgesChange",T,ge.setState),pn("connectOnClick",B,ge.setState),pn("fitViewOnInit",K,ge.setState),pn("fitViewOnInitOptions",ne,ge.setState),pn("onNodesDelete",ue,ge.setState),pn("onEdgesDelete",z,ge.setState),pn("onNodeDrag",X,ge.setState),pn("onNodeDragStart",Y,ge.setState),pn("onNodeDragStop",W,ge.setState),pn("onSelectionDrag",F,ge.setState),pn("onSelectionDragStart",te,ge.setState),pn("onSelectionDragStop",U,ge.setState),Go(n,Q),Go(r,ee),Go(i,Q),Go(l,ee),Go(S,V),Go(E,Z),Go($,de),Go(A,pe),null},Ck=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",Ek=Ck,kk=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",Mk=kk,Ak=function(t,n,r){return r===Ze.Left?t-n:r===Ze.Right?t+n:t},Ok=function(t,n,r){return r===Ze.Top?t-n:r===Ze.Bottom?t+n:t},_b=function(t){var n=t.className,r=t.position,i=t.centerX,l=t.centerY,u=t.radius,d=u===void 0?10:u;return Ae.createElement("circle",{className:br(["react-flow__edgeupdater",n]),cx:Ak(i,d,r),cy:Ok(l,d,r),r:d,stroke:"transparent",fill:"transparent"})},Nc=function(e){var t=function(r){var i=r.id,l=r.className,u=r.type,d=r.data,m=r.onClick,y=r.onEdgeDoubleClick,p=r.selected,_=r.animated,v=r.label,w=r.labelStyle,x=r.labelShowBg,S=r.labelBgStyle,E=r.labelBgPadding,A=r.labelBgBorderRadius,P=r.style,T=r.source,j=r.target,O=r.sourceX,k=r.sourceY,D=r.targetX,$=r.targetY,B=r.sourcePosition,q=r.targetPosition,K=r.elementsSelectable,ne=r.hidden,ue=r.sourceHandleId,z=r.targetHandleId,X=r.onContextMenu,Y=r.onMouseEnter,W=r.onMouseMove,F=r.onMouseLeave,te=r.edgeUpdaterRadius,U=r.onEdgeUpdate,H=r.onEdgeUpdateStart,Q=r.onEdgeUpdateEnd,ee=r.markerEnd,G=r.markerStart,V=r.rfId,Z=f.useState(!1),de=Bt(Z,2),pe=de[0],le=de[1],ge=ks(),He=function(we){var ke=ge.getState(),Oe=ke.edges,Xe=ke.addSelectedEdges,Ie=Oe.find(function(nt){return nt.id===i});K&&(ge.setState({nodesSelectionActive:!1}),Xe([i])),m==null||m(we,Ie)},lt=ud(i,ge.getState,y),Ye=ud(i,ge.getState,X),Se=ud(i,ge.getState,Y),Re=ud(i,ge.getState,W),Ce=ud(i,ge.getState,F),Fe=function(we,ke){var Oe=ke?j:T,Xe=(ke?z:ue)||null,Ie=ke?"target":"source",nt=function(){return!0},xt=ke,Ot=ge.getState().edges.find(function(Tt){return Tt.id===i});H==null||H(we,Ot,Ie);var Ft=Q?function(Tt){return Q(Tt,Ot,Ie)}:void 0,dt=function(gt){return U==null?void 0:U(Ot,gt)};cb({event:we,handleId:Xe,nodeId:Oe,onConnect:dt,isTarget:xt,getState:ge.getState,setState:ge.setState,isValidConnection:nt,elementEdgeUpdaterType:Ie,onEdgeUpdateEnd:Ft})},Ve=function(we){return Fe(we,!0)},Ke=function(we){return Fe(we,!1)},tt=function(){return le(!0)},J=function(){return le(!1)},Pe=f.useMemo(function(){return"url(#".concat(sg(G,V),")")},[G,V]),$e=f.useMemo(function(){return"url(#".concat(sg(ee,V),")")},[ee,V]);if(ne)return null;var rt=!K&&!m,wt=typeof U<"u",en=br(["react-flow__edge","react-flow__edge-".concat(u),l,{selected:p,animated:_,inactive:rt,updating:pe}]);return Ae.createElement("g",{className:en,onClick:He,onDoubleClick:lt,onContextMenu:Ye,onMouseEnter:Se,onMouseMove:Re,onMouseLeave:Ce},Ae.createElement(e,{id:i,source:T,target:j,selected:p,animated:_,label:v,labelStyle:w,labelShowBg:x,labelBgStyle:S,labelBgPadding:E,labelBgBorderRadius:A,data:d,style:P,sourceX:O,sourceY:k,targetX:D,targetY:$,sourcePosition:B,targetPosition:q,sourceHandleId:ue,targetHandleId:z,markerStart:Pe,markerEnd:$e,"data-testid":"rf__edge-".concat(i)}),wt&&Ae.createElement("g",{onMouseDown:Ve,onMouseEnter:tt,onMouseOut:J},Ae.createElement(_b,{position:B,centerX:O,centerY:k,radius:te})),wt&&Ae.createElement("g",{onMouseDown:Ke,onMouseEnter:tt,onMouseOut:J},Ae.createElement(_b,{position:q,centerX:D,centerY:$,radius:te})))};return t.displayName="EdgeWrapper",f.memo(t)};function vb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function yb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Pk(e){var t={default:Nc(e.default||yg),straight:Nc(e.bezier||ib),step:Nc(e.step||ob),smoothstep:Nc(e.step||vg),simplebezier:Nc(e.simplebezier||eb)},n={},r=Object.keys(e).filter(function(i){return!["default","bezier"].includes(i)}).reduce(function(i,l){return i[l]=Nc(e[l]||yg),i},n);return yb(yb({},t),r)}function bb(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,l=(n==null?void 0:n.width)||t.width,u=(n==null?void 0:n.height)||t.height;switch(e){case Ze.Top:return{x:r+l/2,y:i};case Ze.Right:return{x:r+l,y:i+u/2};case Ze.Bottom:return{x:r+l/2,y:i+u};case Ze.Left:return{x:r,y:i+u/2}}}function xb(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(r){return r.id===t})),typeof n>"u"?null:n}var Tk=function(t,n,r,i,l,u){var d=bb(r,t,n),m=bb(u,i,l);return{sourceX:d.x,sourceY:d.y,targetX:m.x,targetY:m.y}};function $k(e){var t=e.sourcePos,n=e.targetPos,r=e.sourceWidth,i=e.sourceHeight,l=e.targetWidth,u=e.targetHeight,d=e.width,m=e.height,y=e.transform,p={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+r,n.x+l),y2:Math.max(t.y+i,n.y+u)};p.x===p.x2&&(p.x2+=1),p.y===p.y2&&(p.y2+=1);var _=pf({x:(0-y[0])/y[2],y:(0-y[1])/y[2],width:d/y[2],height:m/y[2]}),v=Math.max(0,Math.min(_.x2,p.x2)-Math.max(_.x,p.x)),w=Math.max(0,Math.min(_.y2,p.y2)-Math.max(_.y,p.y)),x=Math.ceil(v*w);return x>0}function wb(e,t){var n,r,i,l,u,d=e.get(t),m=(d==null||(n=d[vs])===null||n===void 0?void 0:n.handleBounds)||null,y=!d||!m||!d.width||!d.height||typeof((r=d.positionAbsolute)===null||r===void 0?void 0:r.x)>"u"||typeof((i=d.positionAbsolute)===null||i===void 0?void 0:i.y)>"u";return[{x:(d==null||(l=d.positionAbsolute)===null||l===void 0?void 0:l.x)||0,y:(d==null||(u=d.positionAbsolute)===null||u===void 0?void 0:u.y)||0,width:(d==null?void 0:d.width)||0,height:(d==null?void 0:d.height)||0},m,!y]}var Lk=typeof document<"u"?document:null,Nf=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:Lk},n=f.useState(!1),r=Bt(n,2),i=r[0],l=r[1],u=f.useRef(new Set([])),d=f.useMemo(function(){if(e!==null){var _=Array.isArray(e)?e:[e],v=_.filter(function(x){return typeof x=="string"}).map(function(x){return x.split("+")}),w=v.reduce(function(x,S){return x.concat.apply(x,Xi(S))},[]);return[v,w]}return[[],[]]},[e]),m=Bt(d,2),y=m[0],p=m[1];return f.useEffect(function(){if(e!==null){var _,v,w=function(A){if(Sb(A))return!1;var P=Nb(A.code,p);u.current.add(A[P]),jb(y,u.current,!1)&&(A.preventDefault(),l(!0))},x=function(A){if(Sb(A))return!1;var P=Nb(A.code,p);jb(y,u.current,!0)?(l(!1),u.current.clear()):u.current.delete(A[P])},S=function(){u.current.clear(),l(!1)};return t==null||(_=t.target)===null||_===void 0||_.addEventListener("keydown",w),t==null||(v=t.target)===null||v===void 0||v.addEventListener("keyup",x),window.addEventListener("blur",S),function(){var E,A;t==null||(E=t.target)===null||E===void 0||E.removeEventListener("keydown",w),t==null||(A=t.target)===null||A===void 0||A.removeEventListener("keyup",x),window.removeEventListener("blur",S)}}},[e,l]),i};function jb(e,t,n){return e.filter(function(r){return n||r.length===t.size}).some(function(r){return r.every(function(i){return t.has(i)})})}function Nb(e,t){return t.includes(e)?"code":"key"}function Sb(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var Dk=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},zk=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,r=ks(),i=Kn(Dk,xr),l=i.onNodesChange,u=i.onEdgesChange,d=Nf(t),m=Nf(n);f.useEffect(function(){var y=r.getState(),p=y.nodeInternals,_=y.edges,v=y.hasDefaultNodes,w=y.hasDefaultEdges,x=y.onNodesDelete,S=y.onEdgesDelete,E=Array.from(p.values()),A=E.reduce(function($,B){return(!B.selected&&B.parentNode&&$.find(function(q){return q.id===B.parentNode})||B.selected)&&$.push(B),$},[]),P=_.filter(function($){return $.selected});if(d&&(A||P)){var T=zy(A,_),j=[].concat(Xi(P),Xi(T)),O=j.reduce(function($,B){return $.includes(B.id)||$.push(B.id),$},[]);if((w||v)&&(w&&r.setState({edges:_.filter(function($){return!O.includes($.id)})}),v&&(A.forEach(function($){p.delete($.id)}),r.setState({nodeInternals:new Map(p)}))),O.length>0&&(S==null||S(j),u)){var k=O.map(function($){return{id:$,type:"remove"}});u(k)}if(A.length>0&&(x==null||x(A),l)){var D=A.map(function($){return{id:$.id,type:"remove"}});l(D)}r.setState({nodesSelectionActive:!1})}},[d,l,u]),f.useEffect(function(){r.setState({multiSelectionActive:m})},[m])};function Rk(e){var t=ks();f.useEffect(function(){var n,r=function(){if(e.current){var l=ng(e.current);t.setState({width:l.width||500,height:l.height||500})}};return r(),window.onresize=r,e.current&&(n=new ResizeObserver(function(){return r()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var Fk=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},Sg=function(t){return{x:t.x,y:t.y,zoom:t.k}},Sf=function(t,n){return t.target.closest(".".concat(n))},Ik=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},Bk=function(t){var n=t.onMove,r=t.onMoveStart,i=t.onMoveEnd,l=t.zoomOnScroll,u=l===void 0?!0:l,d=t.zoomOnPinch,m=d===void 0?!0:d,y=t.panOnScroll,p=y===void 0?!1:y,_=t.panOnScrollSpeed,v=_===void 0?.5:_,w=t.panOnScrollMode,x=w===void 0?yc.Free:w,S=t.zoomOnDoubleClick,E=S===void 0?!0:S,A=t.selectionKeyPressed,P=t.elementsSelectable,T=t.panOnDrag,j=T===void 0?!0:T,O=t.translateExtent,k=t.minZoom,D=t.maxZoom,$=t.defaultZoom,B=$===void 0?1:$,q=t.defaultPosition,K=q===void 0?[0,0]:q,ne=t.zoomActivationKeyCode,ue=t.preventScrolling,z=ue===void 0?!0:ue,X=t.children,Y=t.noWheelClassName,W=t.noPanClassName,F=ks(),te=f.useRef(!1),U=f.useRef(null),H=f.useRef({x:0,y:0,zoom:0}),Q=Kn(Ik,xr),ee=Q.d3Zoom,G=Q.d3Selection,V=Q.d3ZoomHandler,Z=Nf(ne);return Rk(U),f.useEffect(function(){if(U.current){var de,pe=CE().scaleExtent([k,D]).translateExtent(O),le=Jr(U.current).call(pe),ge=bc(K[0],O[0][0],O[1][0]),He=bc(K[1],O[0][1],O[1][1]),lt=bc(B,k,D),Ye=Yi.translate(ge,He).scale(lt);pe.transform(le,Ye),F.setState({d3Zoom:pe,d3Selection:le,d3ZoomHandler:le.on("wheel.zoom"),transform:[ge,He,lt],domNode:(de=le.node())===null||de===void 0?void 0:de.closest(".react-flow")})}},[]),f.useEffect(function(){G&&ee&&(p&&!Z?G.on("wheel",function(de){if(Sf(de,Y))return!1;de.preventDefault(),de.stopImmediatePropagation();var pe=G.property("__zoom").k||1;if(de.ctrlKey&&m){var le=ka(de),ge=-de.deltaY*(de.deltaMode===1?.05:de.deltaMode?1:.002)*10,He=pe*Math.pow(2,ge);ee.scaleTo(G,He,le);return}var lt=de.deltaMode===1?20:1,Ye=x===yc.Vertical?0:de.deltaX*lt,Se=x===yc.Horizontal?0:de.deltaY*lt;ee.translateBy(G,-(Ye/pe)*v,-(Se/pe)*v)}).on("wheel.zoom",null):typeof V<"u"&&G.on("wheel",function(de){if(!z||Sf(de,Y))return null;de.preventDefault()}).on("wheel.zoom",V))},[p,x,G,ee,V,Z,m,z,Y]),f.useEffect(function(){ee&&(A&&!te.current?ee.on("zoom",null):A||ee.on("zoom",function(de){if(F.setState({transform:[de.transform.x,de.transform.y,de.transform.k]}),n){var pe=Sg(de.transform);n(de.sourceEvent,pe)}}))},[A,ee,n]),f.useEffect(function(){ee&&ee.on("start",function(de){if(te.current=!0,r){var pe=Sg(de.transform);H.current=pe,r(de.sourceEvent,pe)}})},[ee,r]),f.useEffect(function(){ee&&ee.on("end",function(de){if(te.current=!1,i&&Fk(H.current,de.transform)){var pe=Sg(de.transform);H.current=pe,i(de.sourceEvent,pe)}})},[ee,i]),f.useEffect(function(){ee&&ee.filter(function(de){var pe=Z||u,le=m&&de.ctrlKey;return!j&&!pe&&!p&&!E&&!m||A||!E&&de.type==="dblclick"||Sf(de,Y)&&de.type==="wheel"||Sf(de,W)&&de.type!=="wheel"||!m&&de.ctrlKey&&de.type==="wheel"||!pe&&!p&&!le&&de.type==="wheel"||!j&&(de.type==="mousedown"||de.type==="touchstart")?!1:(!de.ctrlKey||de.type==="wheel")&&!de.button})},[ee,u,m,p,E,j,A,P,Z]),Ae.createElement("div",{className:"react-flow__renderer react-flow__container",ref:U},X)};function Cb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Eb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function kb(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var Uk=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},Mb={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},qk=f.memo(function(e){var t=e.selectionKeyPressed,n=ks(),r=f.useRef(0),i=f.useRef(0),l=f.useRef(),u=f.useState(Mb),d=Bt(u,2),m=d[0],y=d[1],p=Kn(Uk,xr),_=p.userSelectionActive,v=p.elementsSelectable,w=_||t;if(!v||!w)return null;var x=function(){y(Mb),n.setState({userSelectionActive:!1}),r.current=0,i.current=0},S=function(j){var O=j.target.closest(".react-flow");l.current=O.getBoundingClientRect();var k=kb(j,l.current);y({width:0,height:0,startX:k.x,startY:k.y,x:k.x,y:k.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},E=function(j){var O,k;if(!(!t||!m.draw||!l.current)){var D=kb(j,l.current),$=(O=m.startX)!==null&&O!==void 0?O:0,B=(k=m.startY)!==null&&k!==void 0?k:0,q=Eb(Eb({},m),{},{x:D.x<$?D.x:$,y:D.y<B?D.y:B,width:Math.abs(D.x-$),height:Math.abs(D.y-B)}),K=n.getState(),ne=K.nodeInternals,ue=K.edges,z=K.transform,X=K.onNodesChange,Y=K.onEdgesChange,W=Array.from(ne.values()),F=Dy(ne,q,z,!1,!0),te=zy(F,ue).map(function(ee){return ee.id}),U=F.map(function(ee){return ee.id});if(r.current!==U.length){r.current=U.length;var H=xc(W,U);H.length&&(X==null||X(H))}if(i.current!==te.length){i.current=te.length;var Q=xc(ue,te);Q.length&&(Y==null||Y(Q))}y(q)}},A=function(){n.setState({nodesSelectionActive:r.current>0}),x()},P=function(){n.setState({nodesSelectionActive:!1}),x()};return Ae.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:S,onMouseMove:E,onMouseUp:A,onMouseLeave:P},m.draw&&Ae.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:m.width,height:m.height,transform:"translate(".concat(m.x,"px, ").concat(m.y,"px)")}}))});function Ab(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Ob(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ab(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ab(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Pb(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:Pb(n,t):!1}function Tb(e,t,n){var r=e;do{var i;if((i=r)!==null&&i!==void 0&&i.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Hk(e,t,n){return Array.from(e.values()).filter(function(r){return(r.selected||r.id===n)&&(!r.parentNode||!Pb(r,e))}).map(function(r){var i,l,u,d;return{id:r.id,position:r.position||{x:0,y:0},positionAbsolute:r.positionAbsolute||{x:0,y:0},distance:{x:t.x-((i=(l=r.positionAbsolute)===null||l===void 0?void 0:l.x)!==null&&i!==void 0?i:0),y:t.y-((u=(d=r.positionAbsolute)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0)},delta:{x:0,y:0},extent:r.extent,parentNode:r.parentNode,width:r.width,height:r.height}})}function Vk(e,t,n,r,i,l){var u=Bt(r,2),d=u[0],m=u[1],y=e.extent||l,p={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(p.x=d*Math.round(p.x/d),p.y=m*Math.round(p.y/m)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var _=i.get(e.parentNode);y=_!=null&&_.positionAbsolute&&_!==null&&_!==void 0&&_.width&&_!==null&&_!==void 0&&_.height?[[_.positionAbsolute.x,_.positionAbsolute.y],[_.positionAbsolute.x+_.width-e.width,_.positionAbsolute.y+_.height-e.height]]:y}else y=l;else if(e.extent&&e.parentNode){var v,w,x,S,E=i.get(e.parentNode),A=(v=E==null||(w=E.positionAbsolute)===null||w===void 0?void 0:w.x)!==null&&v!==void 0?v:0,P=(x=E==null||(S=E.positionAbsolute)===null||S===void 0?void 0:S.y)!==null&&x!==void 0?x:0;y=[[e.extent[0][0]+A,e.extent[0][1]+P],[e.extent[1][0]+A,e.extent[1][1]+P]]}var T={x:0,y:0};if(e.parentNode){var j,O,k,D,$=i.get(e.parentNode);T={x:(j=$==null||(O=$.positionAbsolute)===null||O===void 0?void 0:O.x)!==null&&j!==void 0?j:0,y:(k=$==null||(D=$.positionAbsolute)===null||D===void 0?void 0:D.y)!==null&&k!==void 0?k:0}}return e.positionAbsolute=y?wy(p,y):p,e.position={x:e.positionAbsolute.x-T.x,y:e.positionAbsolute.y-T.y},e}function Cg(e){var t=e.nodeId,n=e.dragItems,r=e.nodeInternals,i=n.map(function(l){var u=r.get(l.id);return Ob(Ob({},u),{},{position:l.position,positionAbsolute:l.positionAbsolute})});return[t?i.find(function(l){return l.id===t}):i[0],i]}function Eg(e){return function(t,n,r){return e==null?void 0:e(t,r)}}function $b(e){var t=e.nodeRef,n=e.disabled,r=n===void 0?!1:n,i=e.noDragClassName,l=e.handleSelector,u=e.nodeId,d=e.isSelectable,m=e.selectNodesOnDrag,y=f.useState(!1),p=Bt(y,2),_=p[0],v=p[1],w=ks(),x=f.useRef(),S=f.useRef({x:null,y:null}),E=f.useCallback(function(A){var P=A.sourceEvent,T=w.getState(),j=T.transform,O=T.snapGrid,k=T.snapToGrid,D=P.touches?P.touches[0].clientX:P.clientX,$=P.touches?P.touches[0].clientY:P.clientY,B=Ly({x:D,y:$},j,k,O);return B},[]);return f.useEffect(function(){if(t!=null&&t.current){var A=Jr(t.current);if(r)A.on(".drag",null);else{var P=DS().on("start",function(T){var j=w.getState(),O=j.nodeInternals,k=j.multiSelectionActive,D=j.unselectNodesAndEdges,$=j.onNodeDragStart,B=j.onSelectionDragStart,q=u?$:Eg(B);if(!m&&!k&&u){var K;(K=O.get(u))!==null&&K!==void 0&&K.selected||D()}u&&d&&m&&Py({id:u,store:w});var ne=E(T);if(S.current=ne,x.current=Hk(O,ne,u),q&&x.current){var ue=Cg({nodeId:u,dragItems:x.current,nodeInternals:O}),z=Bt(ue,2),X=z[0],Y=z[1];q(T.sourceEvent,X,Y)}}).on("drag",function(T){var j=w.getState(),O=j.updateNodePositions,k=j.snapToGrid,D=j.snapGrid,$=j.nodeInternals,B=j.nodeExtent,q=j.onNodeDrag,K=j.onSelectionDrag,ne=E(T);if((S.current.x!==ne.x||S.current.y!==ne.y)&&x.current){S.current=ne,x.current=x.current.map(function(F){return Vk(F,ne,k,D,$,B)});var ue=u?q:Eg(K);if(O(x.current,!0,!0),v(!0),ue){var z=Cg({nodeId:u,dragItems:x.current,nodeInternals:$}),X=Bt(z,2),Y=X[0],W=X[1];ue(T.sourceEvent,Y,W)}}T.on("end",function(F){if(v(!1),x.current){var te=w.getState(),U=te.updateNodePositions,H=te.nodeInternals,Q=te.onNodeDragStop,ee=te.onSelectionDragStop,G=u?Q:Eg(ee);if(U(x.current,!1,!1),G){var V=Cg({nodeId:u,dragItems:x.current,nodeInternals:H}),Z=Bt(V,2),de=Z[0],pe=Z[1];G(F.sourceEvent,de,pe)}}})}).filter(function(T){var j=T.target,O=!T.button&&(!i||!Tb(j,".".concat(i),t))&&(!l||Tb(j,l,t));return O});return A.call(P),function(){A.on(".drag",null)}}}},[t,r,i,l,d,w,u,m,E]),_}function Lb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Wk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Kk=function(t){return Wk({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},rg(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},Yk=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(r){return r.selected});return rg(n)};function Qk(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,r=ks(),i=Kn(Kk,xr),l=i.transformString,u=i.userSelectionActive,d=Kn(Yk,xr),m=d.width,y=d.height,p=d.x,_=d.y,v=f.useRef(null);if($b({nodeRef:v}),u||!m||!y)return null;var w=t?function(x){var S=Array.from(r.getState().nodeInternals.values()).filter(function(E){return E.selected});t(x,S)}:void 0;return Ae.createElement("div",{className:br(["react-flow__nodesselection","react-flow__container",n]),style:{transform:l}},Ae.createElement("div",{ref:v,className:"react-flow__nodesselection-rect",onContextMenu:w,style:{width:m,height:y,top:_,left:p}}))}var Gk=f.memo(Qk),Xk=function(t){return t.nodesSelectionActive},Db=function(t){var n=t.children,r=t.onPaneClick,i=t.onPaneContextMenu,l=t.onPaneScroll,u=t.deleteKeyCode,d=t.onMove,m=t.onMoveStart,y=t.onMoveEnd,p=t.selectionKeyCode,_=t.multiSelectionKeyCode,v=t.zoomActivationKeyCode,w=t.elementsSelectable,x=t.zoomOnScroll,S=t.zoomOnPinch,E=t.panOnScroll,A=t.panOnScrollSpeed,P=t.panOnScrollMode,T=t.zoomOnDoubleClick,j=t.panOnDrag,O=t.translateExtent,k=t.minZoom,D=t.maxZoom,$=t.defaultZoom,B=t.defaultPosition,q=t.preventScrolling,K=t.onSelectionContextMenu,ne=t.noWheelClassName,ue=t.noPanClassName,z=ks(),X=Kn(Xk),Y=Nf(p);zk({deleteKeyCode:u,multiSelectionKeyCode:_});var W=function(H){r==null||r(H),z.getState().resetSelectedElements(),z.setState({nodesSelectionActive:!1})},F=i?function(U){return i(U)}:void 0,te=l?function(U){return l(U)}:void 0;return Ae.createElement(Bk,{onMove:d,onMoveStart:m,onMoveEnd:y,selectionKeyPressed:Y,elementsSelectable:w,zoomOnScroll:x,zoomOnPinch:S,panOnScroll:E,panOnScrollSpeed:A,panOnScrollMode:P,zoomOnDoubleClick:T,panOnDrag:j,translateExtent:O,minZoom:k,maxZoom:D,defaultZoom:$,defaultPosition:B,zoomActivationKeyCode:v,preventScrolling:q,noWheelClassName:ne,noPanClassName:ue},n,Ae.createElement(qk,{selectionKeyPressed:Y}),X&&Ae.createElement(Gk,{onSelectionContextMenu:K,noPanClassName:ue}),Ae.createElement("div",{className:"react-flow__pane react-flow__container",onClick:W,onContextMenu:F,onWheel:te}))};Db.displayName="FlowRenderer";var Jk=f.memo(Db);function Zk(e){var t=Kn(f.useCallback(function(n){return e?Dy(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var e1=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},zb=function(t){var n=Kn(e1,xr),r=n.nodesDraggable,i=n.nodesConnectable,l=n.elementsSelectable,u=n.updateNodeDimensions,d=Zk(t.onlyRenderVisibleElements),m=f.useRef(),y=f.useMemo(function(){if(typeof ResizeObserver>"u")return null;var p=new ResizeObserver(function(_){var v=_.map(function(w){return{id:w.target.getAttribute("data-id"),nodeElement:w.target,forceUpdate:!0}});u(v)});return m.current=p,p},[]);return f.useEffect(function(){return function(){var p;m==null||(p=m.current)===null||p===void 0||p.disconnect()}},[]),Ae.createElement("div",{className:"react-flow__nodes react-flow__container"},d.map(function(p){var _,v,w,x,S,E,A,P=p.type||"default";t.nodeTypes[P]||(P="default");var T=t.nodeTypes[P]||t.nodeTypes.default,j=!!(p.draggable||r&&typeof p.draggable>"u"),O=!!(p.selectable||l&&typeof p.selectable>"u"),k=!!(p.connectable||i&&typeof p.connectable>"u");return Ae.createElement(T,{key:p.id,id:p.id,className:p.className,style:p.style,type:P,data:p.data,sourcePosition:p.sourcePosition||Ze.Bottom,targetPosition:p.targetPosition||Ze.Top,hidden:p.hidden,xPos:(_=(v=p.positionAbsolute)===null||v===void 0?void 0:v.x)!==null&&_!==void 0?_:0,yPos:(w=(x=p.positionAbsolute)===null||x===void 0?void 0:x.y)!==null&&w!==void 0?w:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!p.selected,isDraggable:j,isSelectable:O,isConnectable:k,resizeObserver:y,dragHandle:p.dragHandle,zIndex:(S=(E=p[vs])===null||E===void 0?void 0:E.z)!==null&&S!==void 0?S:0,isParent:!!((A=p[vs])!==null&&A!==void 0&&A.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!p.width&&!!p.height})}))};zb.displayName="NodeRenderer";var t1=f.memo(zb),Sc;function Rb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Fb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var n1=(Sc={},Wt(Sc,Ze.Left,Ze.Right),Wt(Sc,Ze.Right,Ze.Left),Wt(Sc,Ze.Top,Ze.Bottom),Wt(Sc,Ze.Bottom,Ze.Top),Sc),s1=function(e){var t,n,r,i,l,u=e.connectionNodeId,d=e.connectionHandleType,m=e.connectionLineStyle,y=e.connectionLineType,p=y===void 0?Yo.Bezier:y,_=e.isConnectable,v=e.CustomConnectionLineComponent,w=Kn(f.useCallback(function(te){return{fromNode:te.nodeInternals.get(u),handleId:te.connectionHandleId,toX:(te.connectionPosition.x-te.transform[0])/te.transform[2],toY:(te.connectionPosition.y-te.transform[1])/te.transform[2]}},[u]),xr),x=w.fromNode,S=w.handleId,E=w.toX,A=w.toY,P=x==null||(t=x[vs])===null||t===void 0?void 0:t.handleBounds;if(!x||!_||!(P!=null&&P[d]))return null;var T=P[d],j=S?T.find(function(te){return te.id===S}):T[0],O=j?j.x+j.width/2:((n=x==null?void 0:x.width)!==null&&n!==void 0?n:0)/2,k=j?j.y+j.height/2:(r=x==null?void 0:x.height)!==null&&r!==void 0?r:0,D=((x==null||(i=x.positionAbsolute)===null||i===void 0?void 0:i.x)||0)+O,$=((x==null||(l=x.positionAbsolute)===null||l===void 0?void 0:l.y)||0)+k,B=j==null?void 0:j.position;if(!B)return null;var q=n1[B],K,ne,ue,z,X,Y;switch(d){case"source":K=D,ne=$,ue=B,z=E,X=A,Y=q;break;case"target":K=E,ne=A,ue=q,z=D,X=$,Y=B;break}if(v)return Ae.createElement("g",{className:"react-flow__connection"},Ae.createElement(v,{connectionLineType:p,connectionLineStyle:m,fromNode:x,fromHandle:j,fromX:D,fromY:$,toX:E,toY:A,fromPosition:B,toPosition:q,sourcePosition:ue,targetPosition:Y,sourceNode:x,sourceHandle:j,targetX:z,targetY:X,sourceX:K,sourceY:ne}));var W="",F={sourceX:K,sourceY:ne,sourcePosition:ue,targetX:z,targetY:X,targetPosition:Y};return p===Yo.Bezier?W=lb(F):p===Yo.Step?W=_g(Fb(Fb({},F),{},{borderRadius:0})):p===Yo.SmoothStep?W=_g(F):p===Yo.SimpleBezier?W=Zy(F):W="M".concat(K,",").concat(ne," ").concat(z,",").concat(X),Ae.createElement("g",{className:"react-flow__connection"},Ae.createElement("path",{d:W,className:"react-flow__connection-path",style:m}))};function kg(e){"@babel/helpers - typeof";return kg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kg(e)}var Cf,r1=function(t){var n=t.color,r=n===void 0?"none":n,i=t.strokeWidth,l=i===void 0?1:i;return Ae.createElement("polyline",{stroke:r,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:l,fill:"none",points:"-5,-4 0,0 -5,4"})},a1=function(t){var n=t.color,r=n===void 0?"none":n,i=t.strokeWidth,l=i===void 0?1:i;return Ae.createElement("polyline",{stroke:r,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:l,fill:r,points:"-5,-4 0,0 -5,4 -5,-4"})},Ib=(Cf={},Wt(Cf,hf.Arrow,r1),Wt(Cf,hf.ArrowClosed,a1),Cf);function o1(e){var t=f.useMemo(function(){var n=Ib.hasOwnProperty(e);return n?Ib[e]:function(){return null}},[e]);return t}function Bb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function i1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Bb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var l1=function(t){var n=t.id,r=t.type,i=t.color,l=t.width,u=l===void 0?12.5:l,d=t.height,m=d===void 0?12.5:d,y=t.markerUnits,p=y===void 0?"strokeWidth":y,_=t.strokeWidth,v=t.orient,w=v===void 0?"auto":v,x=o1(r);return Ae.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(u),markerHeight:"".concat(m),viewBox:"-10 -10 20 20",markerUnits:p,orient:w,refX:"0",refY:"0"},Ae.createElement(x,{color:i,strokeWidth:_}))},c1=function(t){var n=t.defaultColor,r=t.rfId;return function(i){var l=[];return i.edges.reduce(function(u,d){return[d.markerStart,d.markerEnd].forEach(function(m){if(m&&kg(m)==="object"){var y=sg(m,r);l.includes(y)||(u.push(i1({id:y,color:m.color||n},m)),l.push(y))}}),u},[]).sort(function(u,d){return u.id.localeCompare(d.id)})}},Ub=function(t){var n=t.defaultColor,r=t.rfId,i=Kn(f.useCallback(c1({defaultColor:n,rfId:r}),[n,r]),function(l,u){return!(l.length!==u.length||l.some(function(d,m){return d.id!==u[m].id}))});return Ae.createElement("defs",null,i.map(function(l){return Ae.createElement(l1,{id:l.id,key:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient})}))};Ub.displayName="MarkerDefinitions";var u1=f.memo(Ub),d1=[{level:0,isMaxLevel:!0,edges:[]}];function m1(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=-1,i=e.reduce(function(u,d){var m=Ny(d.zIndex),y=m?d.zIndex:0;if(n){var p,_,v,w;y=m?d.zIndex:Math.max(((p=t.get(d.source))===null||p===void 0||(_=p[vs])===null||_===void 0?void 0:_.z)||0,((v=t.get(d.target))===null||v===void 0||(w=v[vs])===null||w===void 0?void 0:w.z)||0)}return u[y]?u[y].push(d):u[y]=[d],r=y>r?y:r,u},{}),l=Object.entries(i).map(function(u){var d=Bt(u,2),m=d[0],y=d[1],p=+m;return{edges:y,level:p,isMaxLevel:p===r}});return l.length===0?d1:l}function f1(e,t,n){var r=Kn(f.useCallback(function(i){return e?i.edges.filter(function(l){var u=t.get(l.source),d=t.get(l.target);return(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&(d==null?void 0:d.width)&&(d==null?void 0:d.height)&&$k({sourcePos:u.positionAbsolute||{x:0,y:0},targetPos:d.positionAbsolute||{x:0,y:0},sourceWidth:u.width,sourceHeight:u.height,targetWidth:d.width,targetHeight:d.height,width:i.width,height:i.height,transform:i.transform})}):i.edges},[e,t]));return m1(r,t,n)}var h1=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},qb=function(t){var n=Kn(h1,xr),r=n.connectionNodeId,i=n.connectionHandleType,l=n.nodesConnectable,u=n.elementsSelectable,d=n.width,m=n.height,y=n.connectionMode,p=n.nodeInternals,_=f1(t.onlyRenderVisibleElements,p,t.elevateEdgesOnSelect);if(!d)return null;var v=t.connectionLineType,w=t.defaultMarkerColor,x=t.connectionLineStyle,S=t.connectionLineComponent,E=t.connectionLineContainerStyle,A=r&&i;return Ae.createElement(Ae.Fragment,null,_.map(function(P){var T=P.level,j=P.edges,O=P.isMaxLevel;return Ae.createElement("svg",{key:T,style:{zIndex:T},width:d,height:m,className:"react-flow__edges react-flow__container"},O&&Ae.createElement(u1,{defaultColor:w,rfId:t.rfId}),Ae.createElement("g",null,j.map(function(k){var D=wb(p,k.source),$=Bt(D,3),B=$[0],q=$[1],K=$[2],ne=wb(p,k.target),ue=Bt(ne,3),z=ue[0],X=ue[1],Y=ue[2];if(!K||!Y)return null;var W=k.type||"default";t.edgeTypes[W]||(console.warn('[React Flow]: Edge type "'.concat(W,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),W="default");var F=t.edgeTypes[W]||t.edgeTypes.default,te=y===Qi.Strict?X.target:X.target||X.source,U=xb(q.source,k.sourceHandle||null),H=xb(te,k.targetHandle||null),Q=(U==null?void 0:U.position)||Ze.Bottom,ee=(H==null?void 0:H.position)||Ze.Top;if(!U||!H)return null;var G=Tk(B,U,Q,z,H,ee),V=G.sourceX,Z=G.sourceY,de=G.targetX,pe=G.targetY;return Ae.createElement(F,{key:k.id,id:k.id,className:br([k.className,t.noPanClassName]),type:W,data:k.data,selected:!!k.selected,animated:!!k.animated,hidden:!!k.hidden,label:k.label,labelStyle:k.labelStyle,labelShowBg:k.labelShowBg,labelBgStyle:k.labelBgStyle,labelBgPadding:k.labelBgPadding,labelBgBorderRadius:k.labelBgBorderRadius,style:k.style,source:k.source,target:k.target,sourceHandleId:k.sourceHandle,targetHandleId:k.targetHandle,markerEnd:k.markerEnd,markerStart:k.markerStart,sourceX:V,sourceY:Z,targetX:de,targetY:pe,sourcePosition:Q,targetPosition:ee,elementsSelectable:u,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),A&&Ae.createElement("svg",{style:E,width:d,height:m,className:"react-flow__edges react-flow__connectionline react-flow__container"},Ae.createElement(s1,{connectionNodeId:r,connectionHandleType:i,connectionLineStyle:x,connectionLineType:v,isConnectable:l,CustomConnectionLineComponent:S})))};qb.displayName="EdgeRenderer";var p1=f.memo(qb),g1=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function _1(e){var t=e.children,n=Kn(g1);return Ae.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function v1(e){var t=lg(),n=f.useRef(!1);f.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var Hb=function(t){var n=t.nodeTypes,r=t.edgeTypes,i=t.onMove,l=t.onMoveStart,u=t.onMoveEnd,d=t.onInit,m=t.onNodeClick,y=t.onEdgeClick,p=t.onNodeDoubleClick,_=t.onEdgeDoubleClick,v=t.onNodeMouseEnter,w=t.onNodeMouseMove,x=t.onNodeMouseLeave,S=t.onNodeContextMenu,E=t.onSelectionContextMenu,A=t.connectionLineType,P=t.connectionLineStyle,T=t.connectionLineComponent,j=t.connectionLineContainerStyle,O=t.selectionKeyCode,k=t.multiSelectionKeyCode,D=t.zoomActivationKeyCode,$=t.deleteKeyCode,B=t.onlyRenderVisibleElements,q=t.elementsSelectable,K=t.selectNodesOnDrag,ne=t.translateExtent,ue=t.minZoom,z=t.maxZoom,X=t.defaultZoom,Y=t.defaultPosition,W=t.preventScrolling,F=t.defaultMarkerColor,te=t.zoomOnScroll,U=t.zoomOnPinch,H=t.panOnScroll,Q=t.panOnScrollSpeed,ee=t.panOnScrollMode,G=t.zoomOnDoubleClick,V=t.panOnDrag,Z=t.onPaneClick,de=t.onPaneScroll,pe=t.onPaneContextMenu,le=t.onEdgeUpdate,ge=t.onEdgeContextMenu,He=t.onEdgeMouseEnter,lt=t.onEdgeMouseMove,Ye=t.onEdgeMouseLeave,Se=t.edgeUpdaterRadius,Re=t.onEdgeUpdateStart,Ce=t.onEdgeUpdateEnd,Fe=t.noDragClassName,Ve=t.noWheelClassName,Ke=t.noPanClassName,tt=t.elevateEdgesOnSelect,J=t.id;return v1(d),Ae.createElement(Jk,{onPaneClick:Z,onPaneContextMenu:pe,onPaneScroll:de,deleteKeyCode:$,selectionKeyCode:O,multiSelectionKeyCode:k,zoomActivationKeyCode:D,elementsSelectable:q,onMove:i,onMoveStart:l,onMoveEnd:u,zoomOnScroll:te,zoomOnPinch:U,zoomOnDoubleClick:G,panOnScroll:H,panOnScrollSpeed:Q,panOnScrollMode:ee,panOnDrag:V,translateExtent:ne,minZoom:ue,maxZoom:z,defaultZoom:X,defaultPosition:Y,onSelectionContextMenu:E,preventScrolling:W,noDragClassName:Fe,noWheelClassName:Ve,noPanClassName:Ke},Ae.createElement(_1,null,Ae.createElement(p1,{edgeTypes:r,onEdgeClick:y,onEdgeDoubleClick:_,connectionLineType:A,connectionLineStyle:P,connectionLineComponent:T,connectionLineContainerStyle:j,onEdgeUpdate:le,onlyRenderVisibleElements:B,onEdgeContextMenu:ge,onEdgeMouseEnter:He,onEdgeMouseMove:lt,onEdgeMouseLeave:Ye,onEdgeUpdateStart:Re,onEdgeUpdateEnd:Ce,edgeUpdaterRadius:Se,defaultMarkerColor:F,noPanClassName:Ke,elevateEdgesOnSelect:!!tt,rfId:J}),Ae.createElement(t1,{nodeTypes:n,onNodeClick:m,onNodeDoubleClick:p,onNodeMouseEnter:v,onNodeMouseMove:w,onNodeMouseLeave:x,onNodeContextMenu:S,selectNodesOnDrag:K,onlyRenderVisibleElements:B,noPanClassName:Ke,noDragClassName:Fe})))};Hb.displayName="GraphView";var y1=f.memo(Hb),Vb=function(){return null};Vb.displayName="GroupNode";function Wb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Kb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Wb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var md=function(e){var t=function(r){var i=r.id,l=r.type,u=r.data,d=r.xPos,m=r.yPos,y=r.selected,p=r.onClick,_=r.onMouseEnter,v=r.onMouseMove,w=r.onMouseLeave,x=r.onContextMenu,S=r.onDoubleClick,E=r.style,A=r.className,P=r.isDraggable,T=r.isSelectable,j=r.isConnectable,O=r.selectNodesOnDrag,k=r.sourcePosition,D=r.targetPosition,$=r.hidden,B=r.resizeObserver,q=r.dragHandle,K=r.zIndex,ne=r.isParent,ue=r.noPanClassName,z=r.noDragClassName,X=r.initialized,Y=ks(),W=f.useRef(null),F=f.useRef(k),te=f.useRef(D),U=f.useRef(l),H=T||P||p||_||v||w,Q=ld(i,Y.getState,_),ee=ld(i,Y.getState,v),G=ld(i,Y.getState,w),V=ld(i,Y.getState,x),Z=ld(i,Y.getState,S),de=function(ge){if(T&&(!O||!P)&&Py({id:i,store:Y}),p){var He=Y.getState().nodeInternals.get(i);p(ge,Kb({},He))}};f.useEffect(function(){if(W.current&&!$){var le=W.current;return B==null||B.observe(le),function(){return B==null?void 0:B.unobserve(le)}}},[$]),f.useEffect(function(){var le=U.current!==l,ge=F.current!==k,He=te.current!==D;W.current&&(le||ge||He)&&(le&&(U.current=l),ge&&(F.current=k),He&&(te.current=D),Y.getState().updateNodeDimensions([{id:i,nodeElement:W.current,forceUpdate:!0}]))},[i,l,k,D]);var pe=$b({nodeRef:W,disabled:$||!P,noDragClassName:z,handleSelector:q,nodeId:i,isSelectable:T,selectNodesOnDrag:O});return $?null:Ae.createElement("div",{className:br(["react-flow__node","react-flow__node-".concat(l),ue,A,{selected:y,selectable:T,parent:ne}]),ref:W,style:Kb({zIndex:K,transform:"translate(".concat(d,"px,").concat(m,"px)"),pointerEvents:H?"all":"none",visibility:X?"visible":"hidden"},E),onMouseEnter:Q,onMouseMove:ee,onMouseLeave:G,onContextMenu:V,onClick:de,onDoubleClick:Z,"data-testid":"rf__node-".concat(i),"data-id":i},Ae.createElement(gk,{value:i},Ae.createElement(e,{id:i,data:u,type:l,xPos:d,yPos:m,selected:y,isConnectable:j,sourcePosition:k,targetPosition:D,dragging:pe,dragHandle:q,zIndex:K})))};return t.displayName="NodeWrapper",f.memo(t)};function Yb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function Qb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function b1(e){var t={input:md(e.input||hb),default:md(e.default||Ng),output:md(e.output||gb),group:md(e.group||Vb)},n={},r=Object.keys(e).filter(function(i){return!["input","default","output","group"].includes(i)}).reduce(function(i,l){return i[l]=md(e[l]||Ng),i},n);return Qb(Qb({},t),r)}function Gb(e,t){f.useRef(null);var n=f.useMemo(function(){return t(e)},[e]);return n}function Xb(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var Jb=function(t){var n=t.children,r=!0;try{ks()}catch{r=!1}return r?Ae.createElement(Ae.Fragment,null,n):Ae.createElement(Hy,{createStore:Vy},n)};Jb.displayName="ReactFlowWrapper";var x1=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function Zb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,r)}return n}function ex(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zb(Object(n),!0).forEach(function(r){Wt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}Xb(Ek),Xb(Mk);var w1={input:hb,default:Ng,output:gb},j1={default:yg,straight:ib,step:ob,smoothstep:vg,simplebezier:eb},N1=[15,15],S1=[0,0],tx=f.forwardRef(function(e,t){var n=e.nodes,r=e.edges,i=e.defaultNodes,l=e.defaultEdges,u=e.className,d=e.nodeTypes,m=d===void 0?w1:d,y=e.edgeTypes,p=y===void 0?j1:y,_=e.onNodeClick,v=e.onEdgeClick,w=e.onInit,x=e.onMove,S=e.onMoveStart,E=e.onMoveEnd,A=e.onConnect,P=e.onConnectStart,T=e.onConnectStop,j=e.onConnectEnd,O=e.onClickConnectStart,k=e.onClickConnectStop,D=e.onClickConnectEnd,$=e.onNodeMouseEnter,B=e.onNodeMouseMove,q=e.onNodeMouseLeave,K=e.onNodeContextMenu,ne=e.onNodeDoubleClick,ue=e.onNodeDragStart,z=e.onNodeDrag,X=e.onNodeDragStop,Y=e.onNodesDelete,W=e.onEdgesDelete,F=e.onSelectionChange,te=e.onSelectionDragStart,U=e.onSelectionDrag,H=e.onSelectionDragStop,Q=e.onSelectionContextMenu,ee=e.connectionMode,G=ee===void 0?Qi.Strict:ee,V=e.connectionLineType,Z=V===void 0?Yo.Bezier:V,de=e.connectionLineStyle,pe=e.connectionLineComponent,le=e.connectionLineContainerStyle,ge=e.deleteKeyCode,He=ge===void 0?"Backspace":ge,lt=e.selectionKeyCode,Ye=lt===void 0?"Shift":lt,Se=e.multiSelectionKeyCode,Re=Se===void 0?"Meta":Se,Ce=e.zoomActivationKeyCode,Fe=Ce===void 0?"Meta":Ce,Ve=e.snapToGrid,Ke=Ve===void 0?!1:Ve,tt=e.snapGrid,J=tt===void 0?N1:tt,Pe=e.onlyRenderVisibleElements,$e=Pe===void 0?!1:Pe,rt=e.selectNodesOnDrag,wt=rt===void 0?!0:rt,en=e.nodesDraggable,ye=e.nodesConnectable,we=e.elementsSelectable,ke=e.minZoom,Oe=ke===void 0?.5:ke,Xe=e.maxZoom,Ie=Xe===void 0?2:Xe,nt=e.defaultZoom,xt=nt===void 0?1:nt,Ot=e.defaultPosition,Ft=Ot===void 0?S1:Ot,dt=e.translateExtent,Tt=dt===void 0?og:dt,gt=e.preventScrolling,kt=gt===void 0?!0:gt,vn=e.nodeExtent,Jt=e.defaultMarkerColor,Mn=Jt===void 0?"#b1b1b7":Jt,Yn=e.zoomOnScroll,yn=Yn===void 0?!0:Yn,$t=e.zoomOnPinch,Lt=$t===void 0?!0:$t,xn=e.panOnScroll,Ut=xn===void 0?!1:xn,Pt=e.panOnScrollSpeed,mn=Pt===void 0?.5:Pt,ns=e.panOnScrollMode,er=ns===void 0?yc.Free:ns,An=e.zoomOnDoubleClick,us=An===void 0?!0:An,Kt=e.panOnDrag,Qn=Kt===void 0?!0:Kt,zr=e.onPaneClick,go=e.onPaneScroll,tr=e.onPaneContextMenu,Is=e.children,La=e.onEdgeUpdate,Da=e.onEdgeContextMenu,ra=e.onEdgeDoubleClick,Rr=e.onEdgeMouseEnter,aa=e.onEdgeMouseMove,oa=e.onEdgeMouseLeave,ia=e.onEdgeUpdateStart,Ee=e.onEdgeUpdateEnd,Qe=e.edgeUpdaterRadius,Je=Qe===void 0?10:Qe,un=e.onNodesChange,At=e.onEdgesChange,ds=e.noDragClassName,tn=ds===void 0?"nodrag":ds,En=e.noWheelClassName,gn=En===void 0?"nowheel":En,ss=e.noPanClassName,Vt=ss===void 0?"nopan":ss,fn=e.fitView,On=fn===void 0?!1:fn,la=e.fitViewOptions,Fr=e.connectOnClick,bs=Fr===void 0?!0:Fr,Sr=e.attributionPosition,xs=e.proOptions,nr=e.defaultEdgeOptions,Ir=e.elevateEdgesOnSelect,_o=Ir===void 0?!1:Ir,ca=_f(e,x1),ua=Gb(m,b1),da=Gb(p,Pk);return Ae.createElement("div",ex(ex({},ca),{},{ref:t,className:br(["react-flow",u])}),Ae.createElement(Jb,null,Ae.createElement(y1,{onInit:w,onMove:x,onMoveStart:S,onMoveEnd:E,onNodeClick:_,onEdgeClick:v,onNodeMouseEnter:$,onNodeMouseMove:B,onNodeMouseLeave:q,onNodeContextMenu:K,onNodeDoubleClick:ne,nodeTypes:ua,edgeTypes:da,connectionLineType:Z,connectionLineStyle:de,connectionLineComponent:pe,connectionLineContainerStyle:le,selectionKeyCode:Ye,deleteKeyCode:He,multiSelectionKeyCode:Re,zoomActivationKeyCode:Fe,onlyRenderVisibleElements:$e,selectNodesOnDrag:wt,translateExtent:Tt,minZoom:Oe,maxZoom:Ie,defaultZoom:xt,defaultPosition:Ft,preventScrolling:kt,zoomOnScroll:yn,zoomOnPinch:Lt,zoomOnDoubleClick:us,panOnScroll:Ut,panOnScrollSpeed:mn,panOnScrollMode:er,panOnDrag:Qn,onPaneClick:zr,onPaneScroll:go,onPaneContextMenu:tr,onSelectionContextMenu:Q,onEdgeUpdate:La,onEdgeContextMenu:Da,onEdgeDoubleClick:ra,onEdgeMouseEnter:Rr,onEdgeMouseMove:aa,onEdgeMouseLeave:oa,onEdgeUpdateStart:ia,onEdgeUpdateEnd:Ee,edgeUpdaterRadius:Je,defaultMarkerColor:Mn,noDragClassName:tn,noWheelClassName:gn,noPanClassName:Vt,elevateEdgesOnSelect:_o,id:ca==null?void 0:ca.id}),Ae.createElement(Sk,{nodes:n,edges:r,defaultNodes:i,defaultEdges:l,onConnect:A,onConnectStart:P,onConnectStop:T,onConnectEnd:j,onClickConnectStart:O,onClickConnectStop:k,onClickConnectEnd:D,nodesDraggable:en,nodesConnectable:ye,elementsSelectable:we,minZoom:Oe,maxZoom:Ie,nodeExtent:vn,onNodesChange:un,onEdgesChange:At,snapToGrid:Ke,snapGrid:J,connectionMode:G,translateExtent:Tt,connectOnClick:bs,defaultEdgeOptions:nr,fitView:On,fitViewOptions:la,onNodesDelete:Y,onEdgesDelete:W,onNodeDragStart:ue,onNodeDrag:z,onNodeDragStop:X,onSelectionDrag:U,onSelectionDragStart:te,onSelectionDragStop:H}),F&&Ae.createElement(jk,{onSelectionChange:F}),Is,Ae.createElement(lk,{proOptions:xs,position:Sr})))});tx.displayName="ReactFlow";var nx=function(t){var n=t.children;return Ae.createElement(Hy,{createStore:Vy},n)};nx.displayName="ReactFlowProvider";function sx(e){return function(t){var n=f.useState(t),r=Bt(n,2),i=r[0],l=r[1],u=f.useCallback(function(d){return l(function(m){return e(d,m)})},[]);return[i,l,u]}}var C1=sx(ky),E1=sx(PE);const k1=e=>Number.isFinite(e),Ef=e=>Math.round(e*100)/100,M1=(e,t,n,r)=>{if(e===n&&t===r)return`M ${e},${t}`;const i=Math.abs(n-e),l=Math.abs(r-t),u=Math.sqrt(i*i+l*l),d=Math.max(80,Math.min(u*.4,280)),m=Number.isFinite(d)?d:120,y=n>=e?1:-1,p=Math.min(Math.abs(r-t)*.2,50),_=e+y*m,v=t+(r>t?p:-p),w=n-y*m,x=r-(r>t?p:-p);return`M ${e},${t} C ${_},${v} ${w},${x} ${n},${r}`},A1=({id:e,sourceX:t,sourceY:n,targetX:r,targetY:i,markerEnd:l,style:u})=>{const{setEdges:d}=lg(),[m,y]=f.useState(!1),p=f.useCallback(()=>{y(!0)},[]),_=f.useCallback(()=>{y(!1)},[]),v=f.useMemo(()=>[t,n,r,i].every(q=>k1(q))?{sourceX:Ef(t),sourceY:Ef(n),targetX:Ef(r),targetY:Ef(i)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:r,targetY:i}),null),[t,n,r,i,e]),w=f.useMemo(()=>{if(!v)return null;const{sourceX:q,sourceY:K,targetX:ne,targetY:ue}=v;return M1(q,K,ne,ue)},[v]),x=f.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!v||!w)return null;const{sourceX:S,sourceY:E,targetX:A,targetY:P}=v,T=(S+A)/2,j=(E+P)/2,O=32,k=T-O/2,D=j-O/2,$=`animated-edge${m?" animated-edge--hovered":""}`,B=`canvas-edge-remove${m?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:$,onMouseEnter:p,onMouseLeave:_,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:x,gradientUnits:"userSpaceOnUse",x1:S,y1:E,x2:A,y2:P,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:w,fill:"none",stroke:"transparent",strokeWidth:20,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${x})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${x})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:l,className:"animated-edge__base",style:{...u,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${x})`,strokeWidth:m?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:B,x:k,y:D,width:O,height:O,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:q=>{q.stopPropagation(),d(K=>K.filter(ne=>ne.id!==e))},"aria-label":"Remove connection",children:""})})})]})},O1=(e,t,n,r)=>{if(e===n&&t===r)return`M ${e},${t}`;const i=Math.abs(n-e),l=Math.max(64,Math.min(i*.45,240)),u=Number.isFinite(l)?l:100,d=n>=e?1:-1,m=e+d*u,y=t,p=n-d*u;return`M ${e},${t} C ${m},${y} ${p},${r} ${n},${r}`},P1=({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:i,targetPosition:l})=>{const u=O1(e,t,n,r),d="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:d,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:r,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:u,fill:"none",stroke:`url(#${d})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:u,fill:"none",stroke:`url(#${d})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:r,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},kf=e=>!e||!e.length?"":e.join(", "),T1=({nodes:e,onAddNode:t})=>{const[n,r]=f.useState(""),[i,l]=f.useState([]),u=n.trim().toLowerCase(),d=f.useMemo(()=>u?e.filter(v=>{const w=[v.label,v.type,v.description];return v.category&&w.push(v.category),v.tags&&v.tags.length&&w.push(v.tags.join(" ")),w.some(x=>x==null?void 0:x.toLowerCase().includes(u))}):e,[e,u]),m=f.useMemo(()=>{const v=new Map;return d.forEach(w=>{var E;const x=((E=w.category)==null?void 0:E.trim())||"Other",S=v.get(x)??[];S.push(w),v.set(x,S)}),Array.from(v.entries()).sort(([w],[x])=>w.localeCompare(x)).map(([w,x])=>({category:w,entries:x.sort((S,E)=>(S.label||S.type).localeCompare(E.label||E.type))}))},[d]);f.useEffect(()=>{if(!u){l([]);return}l(v=>{const w=new Set(v);let x=!1;return m.forEach(({category:S})=>{w.has(S)||(w.add(S),x=!0)}),x?Array.from(w):v})},[m,u]);const y=v=>{l(w=>{const x=new Set(w);return x.has(v)?x.delete(v):x.add(v),Array.from(x)})},p=d.length,_=p>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsx("h3",{children:"Available steps"}),a.jsxs("div",{className:"feature-canvas-sidebar__search",children:[a.jsx("input",{type:"search",value:n,onChange:v=>r(v.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps"}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>r(""),"aria-label":"Clear search",children:""})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",p," ",p===1?"step":"steps",u?` matching ${n.trim()}`:""]})]}),_?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:m.map(({category:v,entries:w})=>{const x=i.includes(v);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>y(v),"aria-expanded":x,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:v.charAt(0).toUpperCase()+v.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[w.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":x,children:""})]})]}),x&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:w.map(S=>{var E,A;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(S),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:S.label||S.type}),S.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:S.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(E=S.inputs)!=null&&E.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${kf(S.inputs)}`,children:["In: ",kf(S.inputs)]}):null,(A=S.outputs)!=null&&A.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${kf(S.outputs)}`,children:["Out: ",kf(S.outputs)]}):null,S.parameters&&S.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",children:[S.parameters.length," param",S.parameters.length>1?"s":""]}):null]})]})},S.type)})})]},v)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})};async function rx(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function Mg(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load column drop recommendations");return u.json()}async function ax(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load label encoding recommendations");return u.json()}async function ox(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load ordinal encoding suggestions");return u.json()}async function ix(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load target encoding recommendations");return u.json()}async function lx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load hash encoding recommendations");return u.json()}async function cx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load one-hot encoding recommendations");return u.json()}async function ux(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load dummy encoding recommendations");return u.json()}async function dx(e,t={}){const{sampleSize:n=500,transformations:r,graph:i,targetNodeId:l}=t,u={dataset_source_id:e,sample_size:n};Array.isArray(r)?r.length>0&&(u.transformations=JSON.stringify(r)):r&&typeof r=="object"&&Object.keys(r).length>0&&(u.transformations=JSON.stringify(r)),i&&Array.isArray(i.nodes)&&Array.isArray(i.edges)&&(u.graph={nodes:i.nodes,edges:i.edges}),l&&(u.target_node_id=l);const d=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok)throw new Error("Failed to load skewness recommendations");return d.json()}async function mx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load scaling recommendations");return u.json()}async function fx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(l.graph={nodes:r.nodes,edges:r.edges}),i&&(l.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/binning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!u.ok)throw new Error("Failed to load binning recommendations");return u.json()}async function hx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,u={dataset_source_id:e,sample_size:l};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(u.graph={nodes:r.nodes,edges:r.edges}),i&&(u.target_node_id=i);const d=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok)throw new Error("Failed to load outlier recommendations");return d.json()}async function px(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,u={dataset_source_id:e,sample_size:l};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(u.graph={nodes:r.nodes,edges:r.edges}),i&&(u.target_node_id=i);const d=await fetch("/ml-workflow/api/analytics/binned-distribution",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok){let m="Failed to load binned column distributions";try{const y=await d.clone().json(),p=typeof(y==null?void 0:y.detail)=="string"&&y.detail.trim()?y.detail.trim():typeof(y==null?void 0:y.error)=="string"&&y.error.trim()?y.error.trim():typeof(y==null?void 0:y.message)=="string"&&y.message.trim()?y.message.trim():null;p&&(m=p)}catch{try{const p=(await d.text()).trim();p&&(m=p)}catch{}}throw new Error(m)}return d.json()}async function gx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:i}=t,l=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,u=new URLSearchParams({dataset_source_id:e,sample_size:String(l)});r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&u.set("graph",JSON.stringify({nodes:r.nodes,edges:r.edges})),i&&u.set("target_node_id",i);const d=await fetch(`/ml-workflow/api/analytics/quick-profile?${u.toString()}`);if(!d.ok){let m="Failed to generate dataset profile";try{const y=await d.clone().json(),p=typeof(y==null?void 0:y.detail)=="string"&&y.detail.trim()?y.detail.trim():typeof(y==null?void 0:y.error)=="string"&&y.error.trim()?y.error.trim():typeof(y==null?void 0:y.message)=="string"&&y.message.trim()?y.message.trim():null;p&&(m=p)}catch{try{const p=(await d.text()).trim();p&&(m=p)}catch{}}throw new Error(m)}return d.json()}async function $1(e,t={}){const{config:n,sampleSize:r,graph:i,targetNodeId:l}=t,u={dataset_source_id:e,sample_size:r==="all"?0:typeof r=="number"&&Number.isFinite(r)?r:300};if(n&&typeof n=="object"){const m=(v,w)=>{const x=Number(v);return Number.isFinite(x)?x<0?0:x>100?100:x:w},y=v=>{if(!v||typeof v!="object")return{};const w={};return Object.entries(v).forEach(([x,S])=>{const E=String(x??"").trim();if(!E)return;let A=null,P=null;if(S&&typeof S=="object"){const T=S.lower??S.min??S.minimum??null,j=S.upper??S.max??S.maximum??null,O=Number(T);Number.isFinite(O)&&(A=O);const k=Number(j);Number.isFinite(k)&&(P=k)}if(!(A===null&&P===null)){if(A!==null&&P!==null&&A>P){const T=A;A=P,P=T}w[E]={lower:A,upper:P}}}),w},p=m(n.lower_percentile,5),_=m(n.upper_percentile,95);u.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:p,upper_percentile:_<=p?Math.min(p+1,100):_,manual_bounds:y(n.manual_bounds)}}i&&Array.isArray(i.nodes)&&Array.isArray(i.edges)&&(u.graph={nodes:i.nodes,edges:i.edges}),l&&(u.target_node_id=l);const d=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok){const m=await d.text();throw new Error(m||"Failed to load outlier diagnostics")}return d.json()}async function _x(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function vx(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function yx(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function bx(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}async function xx(e,t={}){const{offset:n,limit:r,mode:i}=t,l=new URLSearchParams;typeof n=="number"&&Number.isFinite(n)&&l.set("offset",String(n)),typeof r=="number"&&Number.isFinite(r)&&l.set("limit",String(r)),i&&l.set("mode",i);const u=l.toString(),d=`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/preview/rows${u?`?${u}`:""}`,m=await fetch(d);if(!m.ok){const y=await m.text();throw new Error(y||"Failed to load preview rows")}return m.json()}async function wx(e){const t=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(n||"Failed to load pipeline preview")}return t.json()}const Ag=e=>{if(Array.isArray(e))return e.map(t=>Ag(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(r=>{n[r]=Ag(e[r])}),n}return e},L1=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),D1=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return L1(n)},z1=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],r=t.map(l=>{let u=null;if(l&&l.data&&typeof l.data=="object"){const d=l.data.config;if(d!==void 0)try{u=JSON.parse(JSON.stringify(d))}catch{u=d}}return{id:l&&Object.prototype.hasOwnProperty.call(l,"id")?l.id??null:null,type:l&&Object.prototype.hasOwnProperty.call(l,"type")?l.type??null:null,catalogType:l&&l.data&&Object.prototype.hasOwnProperty.call(l.data,"catalogType")?l.data.catalogType??null:null,config:u}}).sort((l,u)=>{const d=typeof l.id=="string"?l.id:String(l.id??""),m=typeof u.id=="string"?u.id:String(u.id??"");return d.localeCompare(m)}),i=n.map(l=>({source:l&&Object.prototype.hasOwnProperty.call(l,"source")?l.source??null:null,target:l&&Object.prototype.hasOwnProperty.call(l,"target")?l.target??null:null,sourceHandle:l&&Object.prototype.hasOwnProperty.call(l,"sourceHandle")?l.sourceHandle??null:null,targetHandle:l&&Object.prototype.hasOwnProperty.call(l,"targetHandle")?l.targetHandle??null:null})).sort((l,u)=>{const d=String(l.source??"").localeCompare(String(u.source??""));return d!==0?d:String(l.target??"").localeCompare(String(u.target??""))});return{nodes:r,edges:i}};async function Ji(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=z1(t),r=JSON.stringify(Ag(n)),i=await D1(r);return`${e}_${i.slice(0,8)}`}async function jx(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const r=await t.text();throw new Error(r||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const r=n.jobs,i=typeof n.total=="number"?n.total:r.length;return{jobs:r,total:i}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function Nx(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function fd(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),r=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!r.ok){if(r.status===401||r.status===403)throw new Error("Sign in to view training jobs.");const i=await r.text();throw new Error(i||"Failed to load training jobs")}return r.json()}async function Sx(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const r=await n.text();throw new Error(r||"Failed to evaluate model")}return n.json()}async function Cx(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const r=await t.text();throw new Error(r||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const r=n.jobs,i=typeof n.total=="number"?n.total:r.length;return{jobs:r,total:i}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function R1(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function hd(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),r=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!r.ok){if(r.status===401||r.status===403)throw new Error("Sign in to view tuning jobs.");const i=await r.text();throw new Error(i||"Failed to load tuning jobs")}return r.json()}async function Ex(e){const t={...e,sample_size:0},n=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const r=await n.text();throw new Error(r||"Failed to trigger full dataset execution")}return n.json()}async function Mf(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function kx(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const r=n.toString(),i=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${r?`?${r}`:""}`,{credentials:"include"});if(!i.ok){if(i.status===404)throw new Error(`Model type '${e}' not found`);const l=await i.text();throw new Error(l||"Failed to fetch best hyperparameters")}return i.json()}async function F1(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/full-execution/${encodeURIComponent(t)}`);if(!n.ok){const r=await n.text();throw new Error(r||"Failed to fetch full execution status")}return n.json()}const I1=Object.freeze(Object.defineProperty({__proto__:null,createHyperparameterTuningJob:Cx,createTrainingJob:jx,evaluateTrainingJob:Sx,fetchBestHyperparameters:kx,fetchBinnedDistribution:px,fetchBinningRecommendations:fx,fetchDatasets:_x,fetchDropColumnRecommendations:Mg,fetchDummyEncodingRecommendations:ux,fetchFullExecutionStatus:F1,fetchHashEncodingRecommendations:lx,fetchHyperparameterTuningJob:R1,fetchHyperparameterTuningJobs:hd,fetchLabelEncodingRecommendations:ax,fetchModelHyperparameters:Mf,fetchNodeCatalog:rx,fetchOneHotEncodingRecommendations:cx,fetchOrdinalEncodingRecommendations:ox,fetchOutlierDiagnostics:$1,fetchOutlierRecommendations:hx,fetchPipeline:vx,fetchPipelineHistory:bx,fetchPipelinePreview:wx,fetchPipelinePreviewRows:xx,fetchQuickProfile:gx,fetchScalingRecommendations:mx,fetchSkewnessRecommendations:dx,fetchTargetEncodingRecommendations:ix,fetchTrainingJob:Nx,fetchTrainingJobs:fd,generatePipelineId:Ji,savePipeline:yx,triggerFullDatasetExecution:Ex},Symbol.toStringTag,{value:"Module"})),B1=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:r,hasReachableSource:i,columnTypeMap:l,setAvailableColumns:u,setColumnSearch:d,setColumnMissingMap:m,setColumnTypeMap:y,setColumnSuggestions:p})=>{const[_,v]=f.useState([]),[w,x]=f.useState(null),[S,E]=f.useState([]),[A,P]=f.useState(null),[T,j]=f.useState(!1),[O,k]=f.useState(null),[D,$]=f.useState(null),[B,q]=f.useState(0),K=f.useRef(l);f.useEffect(()=>{K.current=l},[l]),f.useEffect(()=>{let Y=!0;const W=F=>{E([]),P(F??null),k(null),$(null),j(!1),v([]),x(null),u([]),d(""),m({}),y({}),p({})};return e?t?i?(j(!0),P(null),Mg(t,{graph:r,targetNodeId:n??null}).then(F=>{if(!Y)return;const te=Array.isArray(F==null?void 0:F.candidates)?F.candidates:[];E(te),k((F==null?void 0:F.generated_at)??null),$(typeof(F==null?void 0:F.suggested_threshold)=="number"?Number(F.suggested_threshold):null);const U=Array.isArray(F==null?void 0:F.available_filters)?F.available_filters:[];v(U),x(G=>G&&U.some(V=>V.id===G)?G:null);const H={};F&&typeof F=="object"&&(F!=null&&F.column_missing_map)&&typeof F.column_missing_map=="object"&&Object.entries(F.column_missing_map).forEach(([G,V])=>{const Z=String(G??"").trim();if(!Z)return;const de=Number(V);Number.isFinite(de)&&(H[Z]=Number(de))});const Q=new Set;Array.isArray(F==null?void 0:F.all_columns)&&F.all_columns.forEach(G=>{const V=String(G??"").trim();V&&Q.add(V)}),Object.keys(K.current??{}).forEach(G=>Q.add(G));const ee=Array.from(Q).sort((G,V)=>G.localeCompare(V));ee.forEach(G=>{Object.prototype.hasOwnProperty.call(H,G)||(H[G]=0)}),u(ee),d(""),m(H),y(G=>{const V=F==null?void 0:F.column_type_map;if(!V||typeof V!="object")return G;const Z={...G};return Object.entries(V).forEach(([de,pe])=>{const le=String(de??"").trim();if(!le)return;const ge=String(pe??"").trim();Z[le]=ge||G[le]||""}),Z}),p(G=>{const V=F==null?void 0:F.column_recommendations;if(!V||typeof V!="object")return G;const Z={};return Object.entries(V).forEach(([de,pe])=>{const le=String(de??"").trim();if(!le)return;const ge=Array.isArray(pe)?pe.map(He=>String(He??"").trim()).filter(Boolean):[];Z[le]=ge}),Z})}).catch(F=>{Y&&W((F==null?void 0:F.message)??"Unable to load recommendations")}).finally(()=>{Y&&j(!1)}),()=>{Y=!1}):(W("Connect this step to an upstream output to load recommendations."),()=>{Y=!1}):(W(),()=>{Y=!1}):(W(),()=>{Y=!1})},[K,r,e,i,n,B,u,m,d,p,y,t]);const ne=f.useCallback(()=>{!e||!t||!i||q(Y=>Y+1)},[e,i,t]),ue=f.useMemo(()=>{const Y=new Map;return _.forEach(W=>{W!=null&&W.id&&Y.set(W.id,W.label)}),Y},[_]),z=f.useCallback(Y=>Y?ue.has(Y)?ue.get(Y)??null:Y.split("_").filter(Boolean).map(F=>F.charAt(0).toUpperCase()+F.slice(1)).join(" ")||Y:null,[ue]),X=f.useMemo(()=>w?S.filter(Y=>Array.isArray(Y==null?void 0:Y.signals)&&Y.signals.includes(w)):S,[w,S]);return{hasDropColumnSource:e,availableFilters:_,activeFilterId:w,setActiveFilterId:x,recommendations:S,filteredRecommendations:X,formatSignalName:z,isFetchingRecommendations:T,recommendationsError:A,recommendationsGeneratedAt:O,suggestedThreshold:D,refreshRecommendations:ne}},U1=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:r,recommendations:i,filteredRecommendations:l,isFetchingRecommendations:u,recommendationsError:d,relativeGeneratedAt:m,formatSignalName:y,formatMissingPercentage:p,getPriorityClass:_,getPriorityLabel:v,handleToggleColumn:w,selectedColumns:x})=>{const S=E=>{if(!(E!=null&&E.name))return null;const A=String(E.name),P=x.includes(A),T=_(E.priority),j=v(E.priority),O=Array.isArray(E==null?void 0:E.signals)?E.signals.map(k=>y(k)).filter(k=>!!k):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:()=>w(A)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:A}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[E.missing_percentage!==void 0&&E.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${p(E.missing_percentage)}`}),T&&j&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${T}`,children:j})]}),O.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:O.map(k=>a.jsx("span",{className:"canvas-modal__signal-badge",children:k},`${A}-${k}`))}),E.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:E.reason})]})]},A)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>r(null),children:["All reasons (",i.length,")"]}),t.map(E=>{const A=n===E.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${A?" canvas-modal__filter-button--active":""}`,onClick:()=>r(P=>P===E.id?null:E.id),title:E.description??void 0,children:[E.label," (",E.count,")"]},E.id)})]}),u&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!u&&d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:d}),!u&&!d&&a.jsxs(a.Fragment,{children:[m&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",m,"."]}),l.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:l.map(E=>S(E))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},q1=({thresholdParameter:e,dropIfAnyParameter:t,renderParameterField:n})=>!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&n(e),t&&n(t)]}),H1="first",V1=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],W1=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:r,renderMultiSelectField:i,removeDuplicatesKeepSelectId:l,removeDuplicatesKeep:u,onKeepChange:d})=>{if(!n&&!r)return null;const m=y=>{const p=y.target.value;d(p==="last"||p==="none"?p:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),i(n)]}),r&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:l,className:"canvas-modal__parameter-label",children:r.label??"Keep strategy"}),r.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:r.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:l,value:u,onChange:m,children:V1.map(y=>a.jsx("option",{value:y.value,children:y.label},y.value))})})]})]})},mt=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],K1=["float64","Int64","boolean","string","category","datetime64[ns]","object"],Y1=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:r,columnSuggestions:i,selectedColumns:l,previewColumns:u,previewStatus:d,sourceId:m,hasReachableSource:y})=>{const p=f.useMemo(()=>{const j=e==null?void 0:e.column_overrides;if(!j||typeof j!="object"||Array.isArray(j))return{};const O={};return Object.entries(j).forEach(([k,D])=>{const $=String(k??"").trim();if(!$||typeof D!="string")return;const B=D.trim();B&&(O[$]=B)}),O},[e==null?void 0:e.column_overrides]),_=f.useMemo(()=>{const j=e==null?void 0:e.target_dtype;return typeof j=="string"?j.trim():""},[e==null?void 0:e.target_dtype]),v=f.useMemo(()=>{const j=new Set;return n.forEach(k=>j.add(k)),Object.keys(r).forEach(k=>j.add(k)),Object.keys(i).forEach(k=>j.add(k)),Object.keys(p).forEach(k=>j.add(k)),l.forEach(k=>j.add(k)),u.forEach(k=>{typeof k=="string"&&j.add(k)}),Array.from(j).sort((k,D)=>k.localeCompare(D)).map(k=>{const D=r[k]??"Unknown",$=i[k]??[],B=$.length?$[0]:null,q=Object.prototype.hasOwnProperty.call(p,k),K=q?p[k]:null,ne=typeof K=="string"?K.trim():"",ue=q?ne:_,z=new Set;ue&&z.add(ue),$.forEach(U=>z.add(U)),D&&D!=="Unknown"&&z.add(D),_&&z.add(_),K1.forEach(U=>z.add(U));const X=ue??"",Y=!!(B&&B!==X),W=!!(B&&B===X),F=l.includes(k),te=Array.from(z).sort((U,H)=>U.localeCompare(H));return{column:k,originalType:D,recommended:B,currentTarget:ue,suggestions:$,options:te,hasRecommendationGap:Y,hasOverride:q,usesDefaultTarget:!q,isRecommendationApplied:W,isSelected:F}})},[n,_,p,i,r,u,l]),w=f.useMemo(()=>{const j=v.filter(D=>D.hasRecommendationGap),O=v.filter(D=>!D.hasRecommendationGap),k=[];return j.length&&k.push({key:"needs-attention",label:"Needs attention",rows:j}),O.length&&k.push({key:"all-columns",label:j.length?"Other columns":"All columns",rows:O}),k},[v]),x=f.useMemo(()=>v.filter(j=>j.hasRecommendationGap).length,[v]),S=f.useMemo(()=>x>0,[x]),E=f.useMemo(()=>v.filter(j=>j.isSelected).length,[v]),A=f.useCallback((j,O)=>{const k=j.trim();k&&t(D=>{const $=D.column_overrides&&typeof D.column_overrides=="object"&&!Array.isArray(D.column_overrides)?{...D.column_overrides}:{},B=typeof O=="string"?O.trim():"",q=new Set(mt(D.columns)),K=new Set(mt(D.skipped_columns)),ne=K.delete(k);B?($[k]=B,q.add(k)):delete $[k];const ue={...D,columns:Array.from(q).sort((z,X)=>z.localeCompare(X)),column_overrides:$};return ne&&(ue.skipped_columns=Array.from(K).sort((z,X)=>z.localeCompare(X))),ue})},[t]),P=f.useCallback(()=>{const j=Object.entries(i).filter(([,O])=>O.length>0);j.length&&t(O=>{const k=new Set(mt(O.columns)),D=O.column_overrides&&typeof O.column_overrides=="object"&&!Array.isArray(O.column_overrides)?{...O.column_overrides}:{};return j.forEach(([$,B])=>{const q=$.trim();q&&(k.add(q),B.length&&(D[q]=B[0]))}),{...O,columns:Array.from(k).sort(($,B)=>$.localeCompare(B)),column_overrides:D}})},[i,t]),T=f.useCallback((j,O)=>{O==="__default__"?A(j,null):A(j,O)},[A]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:P,disabled:!S,children:"Apply recommendations"})})]}),!m&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),m&&!y&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),_?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:_}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),v.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",v.length," column",v.length===1?"":"s","  ",E," mapped in node selection."]}),S?a.jsxs("p",{className:"canvas-modal__note",children:[x," column",x===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):v.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),d==="loading"&&!v.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),v.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:w.map(j=>a.jsxs("div",{className:"canvas-cast__group",children:[j.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:j.label}),a.jsxs("span",{children:[j.rows.length," column",j.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:j.rows.map(O=>{const k=["canvas-cast__row"];O.hasRecommendationGap&&k.push("canvas-cast__row--attention"),O.hasOverride&&k.push("canvas-cast__row--override");const D=O.hasOverride?O.currentTarget||"":"__default__",$=O.isRecommendationApplied,B=O.suggestions.slice(1,4),q=O.hasOverride?O.currentTarget?`Override  ${O.currentTarget}`:"Override cleared (uses original dtype)":_?`Inheriting ${_}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:k.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),O.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!O.isSelected&&!O.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:O.originalType})}),a.jsx("td",{children:O.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${O.hasRecommendationGap?" canvas-cast__chip--attention":""}${$?" canvas-cast__chip--applied":""}`,children:O.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:$?"Aligned with target":"Not applied yet"}),B.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",B.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:D,onChange:K=>T(O.column,K.target.value),children:[a.jsx("option",{value:"__default__",children:_?`Inherit global (${_})`:"No override (use original)"}),O.options.map(K=>a.jsx("option",{value:K,children:K},`${O.column}-${K}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:q})]})})]},`cast-row-${O.column}`)})})]})})]},`cast-group-${j.key}`))})]})},pd=100,Q1=12,G1={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},Mx={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},X1={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details."},J1={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},Z1=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},eM=e=>{if(!e)return"";const t=X1[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},Ax=(e,t)=>{if(!e)return null;const n=e.job_status??null,r=Z1(n??e.status??null),i=Mx[n??e.status??r]??Mx[r],l=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,u=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let d=`Full dataset run: ${i}`;r==="running"&&l&&u?d=`Full dataset run: In progress (${l}/${u})`:r==="running"&&l?d=`Full dataset run: In progress (${l} rows)`:r==="succeeded"&&l?d=`Full dataset run: Completed (${l} rows)`:r==="succeeded"&&u&&(d=`Full dataset run: Completed (${u} rows)`);const m=[],y=[],p=n?J1[n]??n:null;if(n==="running"?l&&u?m.push(`Processed ${l} of ${u} rows.`):l?m.push(`Processed ${l} rows.`):u&&m.push(`Processing ${u} rows.`):l?m.push(`Processed ${l} rows.`):u&&m.push(`Total rows ${u}.`),e.reason&&m.push(e.reason),p&&y.push({label:"Background job",value:p}),e.job_id&&y.push({label:"Background job ID",value:e.job_id}),u&&y.push({label:"Dataset rows",value:u}),l&&r!=="queued"&&r!=="skipped"&&y.push({label:"Processed rows",value:l}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&y.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const w=new Date(e.last_updated).toLocaleString();y.push({label:"Last updated",value:w})}catch{y.push({label:"Last updated",value:String(e.last_updated)})}const _=Array.isArray(e.warnings)?e.warnings.map(eM).map(w=>w.trim()).filter(Boolean):[];let v=null;switch(r){case"queued":v=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":v=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(l){const w=e.processed_rows===1?"":"s";v=`Full dataset run processed ${l} row${w}.`}else u?v=`Full dataset run completed (${u} rows).`:v="Full dataset run completed.";break;case"failed":v=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":v="Full dataset run cancelled.";break;case"skipped":v=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":v=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:v=null;break}return{label:d,tone:r,details:m,metadata:y,warnings:_,stepLabel:v,isActive:n==="queued"||n==="running"}},Ox=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),tM=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const r=e.split(":",2)[1]??"";return r?`Preview mode "${r}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=G1[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},nM=({preview:e,columns:t,rows:n,tableNote:r,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:u,formatNumericStat:d,formatModeStat:m,fullExecutionStepLabel:y,fullExecutionWarnings:p})=>{const _=e==null?void 0:e.metrics,v=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],w=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],x=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let S=x;const E=y||null;if(E){const j=x.findIndex(O=>typeof O=="string"&&O.toLowerCase().startsWith("full dataset run"));j>=0?S=[...x.slice(0,j),E,...x.slice(j+1)]:x.includes(E)||(S=[...x,E])}const A=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],P=w.reduce((j,O)=>(O&&typeof O.index=="number"&&(j[O.index]=typeof O.missing_percentage=="number"?O.missing_percentage:0),j),{}),T=A.slice(0,Q1);return a.jsxs("div",{className:"canvas-preview",children:[_&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(_.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(_.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(_.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(_.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(_.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(_.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:_.requested_sample_size===0?"Full dataset":l(_.requested_sample_size)})]})]}),S.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:S.map((j,O)=>a.jsx("li",{children:j},`${j}-${O}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(j=>a.jsx("th",{children:j},j))})}),a.jsx("tbody",{children:n.map((j,O)=>a.jsx("tr",{children:t.map(k=>a.jsx("td",{children:i(j==null?void 0:j[k])},`${O}-${k}`))},`row-${O}`))})]}),r?a.jsx("p",{className:"canvas-modal__note",children:r}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),w.length>0&&T.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:T.map((j,O)=>{const k=P[O]??0,D=k%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",O+1]}),a.jsxs("strong",{children:[l(k,D),"%"]})]},`row-missing-${O}`)})})]}),v.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:v.map(j=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:j.name}),j.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",j.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",u(j.missing_percentage)," (",l(j.missing_count),")"]}),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",d(j.mean)]}),typeof j.median=="number"&&!Number.isNaN(j.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",d(j.median)]}),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",m(j.mode)]}),typeof j.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",l(j.distinct_count)]})]},j.name))})]}),p&&p.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:p.map((j,O)=>a.jsx("li",{children:j},`${j}-${O}`))})]})]})},sM=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:r,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:u,formatNumericStat:d,formatModeStat:m})=>{var W,F,te,U,H;const[y,p]=f.useState(()=>Ox()),[_,v]=f.useState(null),[w,x]=f.useState(!1),S=e.status==="loading",E=S||!n,A=f.useMemo(()=>{var ee;const Q=(ee=e.data)==null?void 0:ee.columns;return Array.isArray(Q)?Q.filter(G=>typeof G=="string"):[]},[(W=e.data)==null?void 0:W.columns]),P=f.useMemo(()=>{var Q;return Array.isArray((Q=e.data)==null?void 0:Q.sample_rows)?e.data.sample_rows.slice(0,pd):[]},[(F=e.data)==null?void 0:F.sample_rows]),T=P.length,j=Array.isArray((te=e.data)==null?void 0:te.sample_rows)?e.data.sample_rows.length:0,O=(U=e.data)==null?void 0:U.metrics,k=f.useMemo(()=>O?j>T||typeof O.total_rows=="number"&&O.total_rows>j:!1,[O,T,j]);f.useEffect(()=>{var ee;if(e.status!=="success"||!e.data){p(G=>G.status==="idle"?G:Ox()),v(null);return}const Q=Ax((ee=e.data.signals)==null?void 0:ee.full_execution,l);v(Q),p({status:"ready",columns:[...A],rows:[...P],nextOffset:T,hasMore:k,totalRows:typeof(O==null?void 0:O.total_rows)=="number"?O.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[A,P,T,k,l,O==null?void 0:O.total_rows,e.data,e.status]),f.useEffect(()=>{var V,Z;if(!_||!_.isActive)return;const Q=(Z=(V=e.data)==null?void 0:V.signals)==null?void 0:Z.full_execution;if(!Q||!Q.job_id||!t)return;const ee=typeof Q.poll_after_seconds=="number"&&Q.poll_after_seconds>0?Q.poll_after_seconds*1e3:5e3,G=setTimeout(()=>{Promise.resolve().then(()=>I1).then(de=>de.fetchFullExecutionStatus(t,Q.job_id)).then(de=>{const pe=Ax(de,l);v(pe),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(de=>{console.error("Failed to poll background job status:",de)})},ee);return()=>clearTimeout(G)},[_,t,l,e.data]);const D=y.columns.length>0?y.columns:A,$=y.rows.length>0?y.rows:P,B=y.totalRows??(typeof(O==null?void 0:O.total_rows)=="number"?O.total_rows:null),q=y.status==="idle"?k:y.hasMore,K=y.status==="loading",ne=$.length,ue=f.useMemo(()=>{if(!ne)return null;const Q=l(ne);if(B!==null&&B>=0){const ee=l(B),G=`Loaded ${Q} of ${ee} rows.`;return q&&ne<B?`${G} Load more rows to continue.`:!q&&ne<B?`${G} Preview limited by backend settings.`:G}return q?`Loaded ${Q} rows. Additional rows available.`:`Loaded ${Q} rows.`},[q,l,ne,B]),z=f.useMemo(()=>(y.status==="idle"?[]:y.samplingAdjustments).map(tM).map(ee=>ee.trim()).filter(Boolean),[y.samplingAdjustments,y.status]),X=y.status==="idle"?!1:y.largeDataset,Y=f.useCallback(()=>{var V;if(!t||!q||y.status==="loading")return;const Q=y.rows.length>0?y.rows:P,ee=y.status==="idle"?Q.length:y.nextOffset??Q.length,G=Array.isArray((V=e.data)==null?void 0:V.sample_rows)?e.data.sample_rows:[];if(ee<G.length){const Z=G.slice(ee,ee+pd),de=Q.concat(Z),pe=ee+Z.length,le=pe<G.length||typeof(O==null?void 0:O.total_rows)=="number"&&O.total_rows>G.length;p({status:"ready",columns:y.columns.length>0?y.columns:A,rows:de,nextOffset:le?pe:null,hasMore:le,totalRows:typeof(O==null?void 0:O.total_rows)=="number"?O.total_rows:null,samplingAdjustments:y.samplingAdjustments,largeDataset:y.largeDataset,error:null});return}p(Z=>({...Z,status:"loading",error:null})),xx(t,{offset:ee,limit:pd}).then(Z=>{p(de=>{const pe=de.rows.length>0?de.rows:Q,le=Array.isArray(Z.columns)&&Z.columns.length>0?Z.columns.map(tt=>String(tt)):de.columns.length>0?de.columns:A,ge=typeof Z.offset=="number"&&Z.offset>=0?Z.offset:0,He=Array.isArray(Z.rows)?Z.rows:[],lt=ge<=pe.length?pe.slice(0,ge):pe.slice(),Ye=ge<=pe.length?lt.concat(He):pe.concat(He),Se=He.length,Re=!!Z.has_more,Ce=typeof Z.next_offset=="number"?Z.next_offset:Re?ge+Se:null,Fe=typeof Z.total_rows=="number"?Z.total_rows:null,Ve=Re?null:Ye.length,Ke=Fe!==null?Fe:de.totalRows!==null?de.totalRows:Ve;return{status:"ready",columns:[...le],rows:Ye,nextOffset:Ce,hasMore:Re,totalRows:Ke,samplingAdjustments:Array.isArray(Z.sampling_adjustments)?Z.sampling_adjustments:[],largeDataset:!!Z.large_dataset,error:null}})}).catch(Z=>{p(de=>({...de,status:"error",error:(Z==null?void 0:Z.message)??"Unable to load additional rows."}))})},[A,P,t,q,y,(H=e.data)==null?void 0:H.sample_rows,O]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),_&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${_.tone}`,role:"status","aria-live":_.isActive?"polite":"off",title:_.details.length>0?_.details.join(" "):void 0,children:_.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:r,disabled:E,children:S?"Refreshing":"Refresh"})})]}),_&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[_.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:_.details.map((Q,ee)=>a.jsx("li",{children:Q},`${Q}-${ee}`))}),_.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>x(!w),"aria-expanded":w,children:[w?"":""," ",w?"Hide":"Show"," job details"]}),w&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:_.metadata.map((Q,ee)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:Q.label}),a.jsx("dd",{children:Q.value})]},`${Q.label}-${Q.value}-${ee}`))})]})]}),S&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(nM,{preview:e.data,columns:D,rows:$,tableNote:ue,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:u,formatNumericStat:d,formatModeStat:m,fullExecutionStepLabel:(_==null?void 0:_.stepLabel)??null,fullExecutionWarnings:(_==null?void 0:_.warnings)??[]}),y.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:y.error}),X&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",l(pd)," rows to stay responsive."]}),z.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:z.map((Q,ee)=>a.jsx("li",{children:Q},`${Q}-${ee}`))})]}),q&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Y,disabled:K,children:K?"Loading rows":`Load next ${l(pd)} rows`})}),!q&&!S&&B!==null&&ne>=B&&ne>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},Cc=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],rM=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:r,graphContext:i,profilingGraphSignature:l,formatRelativeTime:u})=>{var Y;const[d,m]=f.useState({status:"idle",data:null,error:null}),[y,p]=f.useState(0),[_,v]=f.useState({}),[w,x]=f.useState("500"),[S,E]=f.useState("summary"),[A,P]=f.useState(!1),T=f.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${w}::${l}`,[t,e==null?void 0:e.id,l,w,n]),j=f.useMemo(()=>T?_[T]??null:null,[_,T]);f.useEffect(()=>{x("500"),m({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),f.useEffect(()=>{if(!t){m({status:"idle",data:null,error:null});return}if(!n){m({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!r){m({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(j){m({status:"success",data:j,error:null});return}let W=!0;m({status:"loading",data:null,error:null});const F=Cc.find(U=>U.value===w)??Cc[1]??Cc[0],te=F.value==="all"?"all":Number(F.value);return gx(n,{sampleSize:te,graph:i,targetNodeId:(e==null?void 0:e.id)??null}).then(U=>{W&&(T&&U&&v(H=>({...H,[T]:U})),m({status:"success",data:U??null,error:null}))}).catch(U=>{W&&m({status:"error",data:null,error:(U==null?void 0:U.message)??"Unable to generate dataset profile"})}),()=>{W=!1}},[j,i,r,t,e==null?void 0:e.id,y,T,w,n]);const O=d.data,k=(O==null?void 0:O.generated_at)??null,D=((Y=O==null?void 0:O.correlations)==null?void 0:Y.length)??0;f.useEffect(()=>{P(!1),E("summary")},[t,k]),f.useEffect(()=>{S==="correlations"&&D===0&&E("summary")},[S,D]);const $=f.useCallback(()=>{T&&v(W=>{if(!Object.prototype.hasOwnProperty.call(W,T))return W;const F={...W};return delete F[T],F}),p(W=>W+1)},[T]),B=f.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),q=f.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),K=f.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),ne=f.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),ue=f.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),z=f.useMemo(()=>Cc.find(W=>W.value===w)??Cc[0],[w]),X=f.useMemo(()=>u((O==null?void 0:O.generated_at)??null),[u,O==null?void 0:O.generated_at]);return{profileState:d,profileData:O,profilingSamplePreset:w,setProfilingSamplePreset:x,profilingActiveTab:S,setProfilingActiveTab:E,isProfilingWarningsOpen:A,setIsProfilingWarningsOpen:P,handleRefreshDatasetProfile:$,activeProfilingSamplePreset:z,profilingWarningsListId:B,profilingSummaryPanelId:q,profilingCorrelationsPanelId:K,profilingSummaryTabId:ne,profilingCorrelationsTabId:ue,profilingCorrelationCount:D,relativeProfilingGeneratedAt:X}},aM=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:r,formatMissingPercentage:i})=>{if(!e)return null;const{profileState:l,profileData:u,profilingSamplePreset:d,setProfilingSamplePreset:m,profilingActiveTab:y,setProfilingActiveTab:p,isProfilingWarningsOpen:_,setIsProfilingWarningsOpen:v,handleRefreshDatasetProfile:w,activeProfilingSamplePreset:x,profilingWarningsListId:S,profilingSummaryPanelId:E,profilingCorrelationsPanelId:A,profilingSummaryTabId:P,profilingCorrelationsTabId:T,profilingCorrelationCount:j,relativeProfilingGeneratedAt:O}=t,k=l.status==="success"&&!!u;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:Cc.map(D=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":D.value===d,onClick:()=>m(D.value),disabled:l.status==="loading",children:D.label},D.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:w,disabled:l.status==="loading",children:l.status==="loading"?"Refreshing":"Refresh"})]})]}),O&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",O]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:x.label}),"."]}),l.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),l.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l.error}),k&&u&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",u.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",u.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",u.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",u.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",u.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:P,role:"tab","data-active":y==="summary","aria-selected":y==="summary","aria-controls":E,onClick:()=>p("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:T,role:"tab","data-active":y==="correlations","aria-selected":y==="correlations","aria-controls":A,onClick:()=>p("correlations"),disabled:!j,children:"Correlations"})]}),y==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:E,role:"tabpanel","aria-labelledby":P,children:[u.warnings&&u.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>v(D=>!D),"aria-expanded":_,"aria-controls":S,children:_?"Hide warnings":`Show warnings (${u.warnings.length})`}),_&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:S,children:u.warnings.map((D,$)=>a.jsx("li",{children:D},`profiling-warning-${$}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:u.columns.map(D=>{const $=D.numeric_summary,B=!!$,q=Array.isArray(D.top_values)?D.top_values:[],K=Array.isArray(D.sample_values)?D.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${D.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:D.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:D.semantic_type??D.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${i(D.missing_percentage)} (${D.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:D.distinct_count!==null?D.distinct_count.toLocaleString():""})]})]}),B?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",r($==null?void 0:$.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",r($==null?void 0:$.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",r($==null?void 0:$.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",r($==null?void 0:$.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",r($==null?void 0:$.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",r($==null?void 0:$.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",r($==null?void 0:$.percentile_75)]})]})]}):null,q.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:q.map((ne,ue)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(ne.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[ne.count.toLocaleString()," (",ne.percentage.toFixed(1),"%)"]})]},`${D.name}-top-${ue}`))})]}):null,K.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:K.slice(0,5).map((ne,ue)=>a.jsx("li",{children:n(ne)},`${D.name}-sample-${ue}`))})]}):null]},D.name)})})]}),y==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:A,role:"tabpanel","aria-labelledby":T,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),u.correlations&&u.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:u.correlations.map((D,$)=>{const B=Math.abs(D.coefficient);let q="low";B>=.85?q="extreme":B>=.7?q="strong":B>=.55&&(q="moderate");const K=D.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:D.column_a}),a.jsx("td",{children:D.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":q,"data-sign":K,children:D.coefficient.toFixed(2)})]},`profile-correlation-${$}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},oM=({type:e})=>a.jsx("span",{"aria-hidden":"true",className:`canvas-modal__title-glyph${e==="dataset"?" canvas-modal__title-glyph--dataset":""}`,children:e==="dataset"?"":""}),iM=({title:e,isDataset:t,onClose:n,canResetNode:r=!1,onResetNode:i})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx(oM,{type:t?"dataset":"default"}),a.jsxs("div",{children:[a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e}),a.jsx("p",{className:"canvas-modal__subtitle",children:t?"Configure how this dataset feeds the pipeline.":"Adjust parameters to control this transformation."})]})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[r&&i&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,children:"Reset node"}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",children:""})]})]}),lM=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:r,canSave:i,onSave:l,isBusy:u,busyLabel:d})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsx("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":u,children:u&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:d??"Processing"})]})}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,children:"Reset node"}),r&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:l,disabled:!i,children:"Save changes"})]})]}),wr=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),ys=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},Qs=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return wr(t,n)},Px=e=>e==null||e===""?"":typeof e=="number"?Qs(e):String(e),cM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},uM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},dM=5,mM=4,fM=3,hM="_binned",Tx="Missing",pM=5,gM="ordinal",_M="quantile",vM=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],yM=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],Og={equal_width:"Equal-width",equal_frequency:"Equal-frequency",custom:"Custom edges",kbins:"KBins (sklearn)"},bM=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],gd=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],$x=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",r=mt(e==null?void 0:e.columns),i=(X,Y,W,F)=>{const te=Number(X);if(!Number.isFinite(te))return Y;const U=Math.round(te);return Math.max(W,Math.min(F,U))},l=i(e==null?void 0:e.equal_width_bins,dM,2,200),u=i(e==null?void 0:e.equal_frequency_bins,mM,2,200),d=i(e==null?void 0:e.precision,fM,0,8),m=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",y=!!((e==null?void 0:e.include_lowest)??!0),p=!!((e==null?void 0:e.drop_original)??!1),v=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||hM,w=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",x=["range","bin_index","ordinal","column_suffix"].includes(w)?w:"range",E=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",A=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",P=E==="label"&&A||Tx,T=i(e==null?void 0:e.kbins_n_bins,pM,2,200),j=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",O=["ordinal","onehot","onehot-dense"].includes(j)?j:gM,k=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",D=["uniform","quantile","kmeans"].includes(k)?k:_M,$=X=>{if(!Array.isArray(X))return[];const W=X.map(F=>{if(typeof F=="number")return F;if(F==null)return Number.NaN;const te=String(F).trim();return te?Number(te):Number.NaN}).filter(F=>Number.isFinite(F)).sort((F,te)=>F-te).filter((F,te,U)=>te===0||F!==U[te-1]);return W.length>=2?W:[]},B=X=>Array.isArray(X)?X.map(Y=>String(Y).trim()).filter(Boolean):typeof X=="string"?X.split(/[\,\n]/).map(Y=>Y.trim()).filter(Boolean):[],q=(X,Y,W)=>{if(X==null)return null;const F=Number(X);if(!Number.isFinite(F))return null;const te=Math.round(F);return Math.max(Y,Math.min(W,te))},K={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([X,Y])=>{const W=String(X??"").trim();if(!W)return;const F=$(Y);F.length>=2&&(K[W]=F)});const ne={};e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([X,Y])=>{const W=String(X??"").trim();if(!W)return;const F=B(Y);F.length&&(ne[W]=F)});const ue={},z=e!=null&&e.column_strategies&&typeof e.column_strategies=="object"&&!Array.isArray(e.column_strategies)?e.column_strategies:e!=null&&e.column_overrides&&typeof e.column_overrides=="object"&&!Array.isArray(e.column_overrides)?e.column_overrides:null;return z&&Object.entries(z).forEach(([X,Y])=>{const W=String(X??"").trim();if(!W||!Y||typeof Y!="object"||Array.isArray(Y))return;const F=Y,te={},U=typeof F.strategy=="string"?F.strategy.trim().toLowerCase():"";["equal_width","equal_frequency","custom","kbins"].includes(U)&&(te.strategy=U);const H=q(F.equal_width_bins,2,200);H!==null&&(te.equalWidthBins=H);const Q=q(F.equal_frequency_bins,2,200);Q!==null&&(te.equalFrequencyBins=Q);const ee=q(F.kbins_n_bins,2,200);ee!==null&&(te.kbinsNBins=ee);const G=typeof F.kbins_encode=="string"?F.kbins_encode.trim().toLowerCase():"";["ordinal","onehot","onehot-dense"].includes(G)&&(te.kbinsEncode=G);const V=typeof F.kbins_strategy=="string"?F.kbins_strategy.trim().toLowerCase():"";["uniform","quantile","kmeans"].includes(V)&&(te.kbinsStrategy=V);const Z=$(F.custom_bins);Z.length>=2&&(te.customBins=Z);const de=B(F.custom_labels);de.length>0&&(te.customLabels=de),Object.keys(te).length>0&&(ue[W]=te)}),{strategy:n,columns:r,equalWidthBins:l,equalFrequencyBins:u,includeLowest:y,precision:d,duplicates:m,outputSuffix:v,dropOriginal:p,labelFormat:x,missingStrategy:E,missingLabel:P,customBins:K,customLabels:ne,columnStrategies:ue,kbinsNBins:T,kbinsEncode:O,kbinsStrategy:D}},xM=(e,t,n,r=Og)=>{if(!e.length)return null;const i=e.map(l=>{const u=t[l],d=(u==null?void 0:u.strategy)??null;if(!d)return l;const m=r[d]??d,y=[];d==="equal_width"&&(u!=null&&u.equalWidthBins)?y.push(`${u.equalWidthBins} bins`):d==="equal_frequency"&&(u!=null&&u.equalFrequencyBins)?y.push(`${u.equalFrequencyBins} bins`):d==="kbins"&&(u!=null&&u.kbinsNBins&&y.push(`${u.kbinsNBins} bins`),u!=null&&u.kbinsStrategy&&y.push(u.kbinsStrategy),u!=null&&u.kbinsEncode&&y.push(u.kbinsEncode));const p=y.length?` (${y.join(", ")})`:"";return`${l} -> ${m}${p}`});return n>e.length&&i.push(""),i.join(", ")},wM=({config:e,fieldIds:t,onIntegerChange:n,onBooleanToggle:r,onSuffixChange:i,onLabelFormatChange:l,onMissingStrategyChange:u,onMissingLabelChange:d})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Global output & labeling"}),a.jsx("p",{className:"canvas-modal__note",children:"Applies to every selected column unless custom bins or labels override the defaults."}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.suffix,className:"canvas-modal__parameter-label",children:"Output suffix"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.suffix,type:"text",className:"canvas-modal__input",value:e.outputSuffix,onChange:m=>i(m.target.value),placeholder:"e.g. _binned"})})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.labelFormat,className:"canvas-modal__parameter-label",children:"Label format"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:t.labelFormat,value:e.labelFormat,onChange:m=>l(m.target.value??"range"),children:yM.map(m=>a.jsx("option",{value:m.value,children:m.label},m.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Controls how new bin values are named when custom labels arent provided."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.precision,className:"canvas-modal__parameter-label",children:"Decimal precision"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.precision,type:"number",className:"canvas-modal__input",min:0,max:8,step:1,value:e.precision,onChange:m=>n("precision",m.target.value,0,8)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Sets rounding precision for interval labels."})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.includeLowest,children:"Include lowest edge"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.includeLowest,type:"checkbox",checked:e.includeLowest,onChange:m=>r("include_lowest",m.target.checked)}),"Include the minimum value in the first bin"]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.dropOriginal,children:"Drop original columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.dropOriginal,type:"checkbox",checked:e.dropOriginal,onChange:m=>r("drop_original",m.target.checked)}),"Remove source columns after binning"]})]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:bM.map(m=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===m.value,onClick:()=>u(m.value),children:m.label},m.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:m=>d(m.target.value),placeholder:"e.g. Missing"})})]})]})]}),Lx=e=>Og[e]??e.replace(/_/g," "),jM=e=>{switch(e){case"high":return"High confidence";case"medium":return"Medium confidence";case"low":return"Low confidence";default:return"Confidence unknown"}},NM=(e,t,n)=>{if(!e||typeof e!="object")return"No distribution summary";const r=[];typeof e.valid_count=="number"&&Number.isFinite(e.valid_count)&&r.push(`${t(e.valid_count)} valid rows`),typeof e.distinct_count=="number"&&Number.isFinite(e.distinct_count)&&r.push(`${t(e.distinct_count)} distinct values`);const i=typeof e.minimum=="number"&&Number.isFinite(e.minimum),l=typeof e.maximum=="number"&&Number.isFinite(e.maximum);if(i||l){const u=i?n(e.minimum):"",d=l?n(e.maximum):"";r.push(`Range ${u}  ${d}`)}return typeof e.skewness=="number"&&Number.isFinite(e.skewness)&&r.push(`Skew ${n(e.skewness)}`),r.length?r.join("  "):"No distribution summary"},SM=({hasSource:e,hasReachableSource:t,isFetching:n,error:r,relativeGeneratedAt:i,sampleSize:l,binningConfig:u,binningDefaultLabel:d,binningOverrideCount:m,binningOverrideSummary:y,recommendations:p,excludedColumns:_,numericColumnCount:v,canApplyAllNumeric:w,onApplyAllNumeric:x,onApplyStrategies:S,onClearOverrides:E,customEdgeDrafts:A,customLabelDrafts:P,onOverrideStrategyChange:T,onOverrideNumberChange:j,onOverrideKbinsEncodeChange:O,onOverrideKbinsStrategyChange:k,onOverrideClear:D,onCustomBinsChange:$,onCustomLabelsChange:B,onClearCustomColumn:q,formatMetricValue:K,formatNumericStat:ne})=>{const ue=f.useMemo(()=>e?t?n?"Diagnostics are loading":r?"Diagnostics are unavailable at the moment.":v>0?`Detected ${v} numeric column${v===1?"":"s"} in the current sample.`:_.length>0?`Diagnostics skipped ${_.length} column${_.length===1?"":"s"} (see details).`:"No additional diagnostics were produced for the current sample.":"Connect this step to an upstream output to surface diagnostics.":"Select a dataset to surface diagnostics.",[r,_.length,t,e,n,v]),z=f.useMemo(()=>{const U=_.slice(0,6),H=Math.max(0,_.length-U.length);return{preview:U,remaining:H}},[_]),X=f.useMemo(()=>{const U=new Map;return p.forEach(H=>{const Q=typeof(H==null?void 0:H.column)=="string"?H.column.trim():"";Q&&U.set(Q,H)}),U},[p]),Y=f.useMemo(()=>{const U=new Set;return u.columns.forEach(H=>{const Q=String(H??"").trim();Q&&U.add(Q)}),Object.keys(u.columnStrategies).forEach(H=>{const Q=String(H??"").trim();Q&&U.add(Q)}),p.forEach(H=>{const Q=typeof(H==null?void 0:H.column)=="string"?H.column.trim():"";Q&&U.add(Q)}),Array.from(U).sort((H,Q)=>H.localeCompare(Q))},[u.columnStrategies,u.columns,p]),W=(U,H)=>{var Q;return!U||Object.keys(U).length===0?"__default__":U.strategy?U.strategy:(Q=U.customBins)!=null&&Q.length?"custom":U.kbinsNBins||U.kbinsEncode||U.kbinsStrategy?"kbins":U.equalFrequencyBins?"equal_frequency":U.equalWidthBins?"equal_width":H},F=e&&t,te=U=>{var Q,ee;if(!U)return[];const H=[];return typeof U.equalWidthBins=="number"&&H.push(`${U.equalWidthBins} bins`),typeof U.equalFrequencyBins=="number"&&H.push(`${U.equalFrequencyBins} bins`),typeof U.kbinsNBins=="number"&&H.push(`${U.kbinsNBins} bins`),U.kbinsStrategy&&H.push(U.kbinsStrategy),U.kbinsEncode&&H.push(U.kbinsEncode),(Q=U.customBins)!=null&&Q.length&&H.push("Custom bins"),(ee=U.customLabels)!=null&&ee.length&&H.push("Custom labels"),H};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binning diagnostics"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:E,disabled:!m,children:"Clear"}),S&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:S,disabled:!p.length,children:"Quick apply"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:ue}),a.jsxs("p",{className:"canvas-modal__note",children:["Default strategy ",a.jsx("strong",{children:d}),m>0?`  Overrides: ${m}${y?` (${y})`:""}`:"  No column overrides yet"]}),a.jsxs("div",{className:"canvas-modal__collapsible",children:[!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface binning insights and column diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),F&&a.jsxs(a.Fragment,{children:[i&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",i,l!==null?` on ${K(l)} row${l===1?"":"s"}.`:"."]}),x&&v>0&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:x,disabled:!w,children:`Add all numeric columns (${v})`})}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binning diagnostics"}),r&&!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r}),!r&&a.jsxs(a.Fragment,{children:[Y.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested strategy"}),a.jsx("th",{scope:"col",children:"Configured strategy"}),a.jsx("th",{scope:"col",children:"Distribution highlights"})]})}),a.jsx("tbody",{children:Y.map(U=>{var ye,we,ke,Oe,Xe;const H=X.get(U)??null,Q=u.columnStrategies[U],ee=W(Q,u.strategy),G=ee==="__default__"?u.strategy:ee,V=(H==null?void 0:H.recommended_strategy)??null,Z=!!(V&&V!==G),de=!!(Q&&Object.keys(Q).length),pe=u.columns.includes(U),le=H==null?void 0:H.recommended_bins,ge=typeof le=="number"?le:le!=null?Number(le):null,He=typeof ge=="number"&&Number.isFinite(ge)&&ge>0?ge:null,lt=(Q==null?void 0:Q.equalWidthBins)??u.equalWidthBins,Ye=(Q==null?void 0:Q.equalFrequencyBins)??u.equalFrequencyBins,Se=(Q==null?void 0:Q.kbinsNBins)??u.kbinsNBins,Re=(Q==null?void 0:Q.kbinsEncode)??"__default__",Ce=(Q==null?void 0:Q.kbinsStrategy)??"__default__",Fe=["canvas-cast__row"];Z&&Fe.push("canvas-cast__row--attention"),de&&Fe.push("canvas-cast__row--override"),pe||Fe.push("canvas-cast__row--muted");const Ve=NM(H==null?void 0:H.stats,K,ne),Ke=((ye=H==null?void 0:H.reasons)==null?void 0:ye.filter(Ie=>Ie&&Ie.trim()))??[],tt=(()=>{const Ie=te(Q),nt=Array.isArray(u.customBins[U])?u.customBins[U].length>=2:!1,xt=Array.isArray(u.customLabels[U])?u.customLabels[U].length>0:!1,Ot=[...Ie];return nt&&!Ot.includes("Custom bins")&&Ot.push("Custom bins"),xt&&!Ot.includes("Custom labels")&&Ot.push("Custom labels"),Ot})(),J=ee==="__default__"?`Inheriting ${d}`:`Override  ${Lx(G)}${tt.length?` (${tt.join(", ")})`:""}`,Pe=(H==null?void 0:H.dtype)??null,$e=H?jM(H.confidence):null,rt=Object.prototype.hasOwnProperty.call(A,U)?A[U]:((we=u.customBins[U])==null?void 0:we.join(", "))??"",wt=Object.prototype.hasOwnProperty.call(P,U)?P[U]:((ke=u.customLabels[U])==null?void 0:ke.join(", "))??"",en=(((Oe=u.customBins[U])==null?void 0:Oe.length)??0)>=2||(((Xe=u.customLabels[U])==null?void 0:Xe.length)??0)>0;return a.jsxs("tr",{className:Fe.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:U}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[Pe&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",Pe]}),!pe&&a.jsx("span",{className:"canvas-cast__muted",children:"Not currently in node"}),de&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),Z&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--attention",children:"Needs review"})]})]})}),a.jsx("td",{children:a.jsx("div",{className:"canvas-cast__recommendation",children:H?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-cast__chip canvas-cast__chip--applied",children:Lx(H.recommended_strategy)}),a.jsxs("span",{className:"canvas-cast__recommendation-note",children:[He!==null?`${He} bin${He===1?"":"s"}`:"Bins not provided",$e?`  ${$e}`:""]}),Ke.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:Ke.join("; ")})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:ee,onChange:Ie=>T(U,Ie.target.value,{recommendedBins:He}),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",d,")"]}),vM.map(Ie=>a.jsx("option",{value:Ie.value,children:Ie.label},`${U}-${Ie.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:J}),ee==="equal_width"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:lt??"",onChange:Ie=>j(U,"equal_width_bins",Ie.target.value)})]})}),ee==="equal_frequency"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Ye??"",onChange:Ie=>j(U,"equal_frequency_bins",Ie.target.value)})]})}),ee==="kbins"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Max bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Se??"",onChange:Ie=>j(U,"kbins_n_bins",Ie.target.value)})]}),a.jsxs("label",{children:["Encode",a.jsxs("select",{value:Re,onChange:Ie=>O(U,Ie.target.value==="__default__"?null:Ie.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",u.kbinsEncode,")"]}),a.jsx("option",{value:"ordinal",children:"Ordinal"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})]}),a.jsxs("label",{children:["Strategy",a.jsxs("select",{value:Ce,onChange:Ie=>k(U,Ie.target.value==="__default__"?null:Ie.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",u.kbinsStrategy,")"]}),a.jsx("option",{value:"uniform",children:"Uniform"}),a.jsx("option",{value:"quantile",children:"Quantile"}),a.jsx("option",{value:"kmeans",children:"K-means"})]})]})]}),ee==="custom"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Custom edges",a.jsx("input",{type:"text",className:"canvas-modal__input",value:rt,placeholder:"e.g. 0, 50, 100",onChange:Ie=>$(U,Ie.target.value)})]}),a.jsxs("label",{children:["Optional labels",a.jsx("input",{type:"text",className:"canvas-modal__input",value:wt,placeholder:"e.g. Low, Medium, High",onChange:Ie=>B(U,Ie.target.value)})]}),en&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>q(U),children:"Clear custom edges"})]}),de&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>D(U),children:"Clear"})]})}),a.jsx("td",{children:a.jsx("span",{children:Ve})})]},`binning-insight-${U}`)})})]})})}),!n&&Y.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"No columns met the sampling requirements for binning recommendations."}),_.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",_.length," column",_.length===1?"":"s"," due to non-numeric values or limited variance",z.preview.length>0&&a.jsxs(a.Fragment,{children:[":"," ",z.preview.map(U=>`${U.column}${U.reason?` (${U.reason})`:""}`).join(", "),z.remaining>0?`,  (+${z.remaining} more)`:""]}),"."]})]})]})]})]})},CM=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:r,sampleSize:i,relativeGeneratedAt:l,error:u,onRefresh:d,canRefresh:m})=>{const y=f.useMemo(()=>gd.find(p=>p.value===t)??gd[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:gd.map(p=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":p.value===t,onClick:()=>n(p.value),disabled:r,children:p.label},p.value))})]}),l&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",l]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:d,disabled:r||!m,children:r?"Refreshing":"Refresh"})]})]}),i!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:y.label}),"."," ",y.value==="all"?`Summaries computed from the full dataset (${i.toLocaleString()} rows).`:`Summaries computed from ${i.toLocaleString()} sampled rows.`]}),r&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!r&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!r&&!u&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(p=>{const _=p.topPercentage!==null?`${p.topPercentage.toFixed(1)}%`:null,v=p.topCount!==null?`${p.topCount.toLocaleString()}${_?`  ${_}`:""}`:_??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:p.column}),p.sourceColumn&&p.sourceColumn!==p.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:p.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:p.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:v})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:p.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:p.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:p.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:p.bins.map(w=>{const x=w.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",S=Math.min(100,Math.max(0,w.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:x,children:w.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${S}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:w.count.toLocaleString()}),a.jsxs("span",{children:[w.percentage.toFixed(1),"%"]})]})]},`${p.column}-${w.label}`)})}),p.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",p.bins.length," of ",p.totalBinCount," bins."]})]},`binned-card-${p.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},EM=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],kM=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],MM=[...EM,...kM],AM=[0,5,10,20,40,60],OM=["float","double","int","uint","long","short","byte","number","decimal"],PM=["bool","boolean"],TM=["object","string","category","datetime","date","time"],$M=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:TM.some(n=>t.includes(n))?!1:!!(OM.some(n=>t.includes(n))||PM.some(n=>t.includes(n)))},Dx=e=>e!=="mode",zx=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},_d=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,r=Number(n);return{neighbors:Number.isFinite(r)?Math.max(1,Math.round(r)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,r=Number(n);return{max_iter:Number.isFinite(r)?Math.max(1,Math.round(r)):10}}},Rx=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",r=new Set(t);return e.map(i=>{if(!i||typeof i!="object")return null;const l=typeof i.method=="string"?i.method.trim().toLowerCase():n,u=r.has(l)?l:n;let d=[];Array.isArray(i.columns)?d=i.columns.map(_=>String(_).trim()).filter(Boolean):typeof i.columns=="string"&&(d=i.columns.split(",").map(_=>_.trim()).filter(Boolean));const m=i.options&&typeof i.options=="object"?i.options:{};let y;if(u==="knn"){const _=m.neighbors??i.neighbors,v=Number(_);y={neighbors:Number.isFinite(v)?Math.max(1,Math.round(v)):5}}else if(u==="regression"||u==="mice"){const _=m.max_iter??m.maxIter??i.max_iter??i.maxIter,v=Number(_);y={max_iter:Number.isFinite(v)?Math.max(1,Math.round(v)):10}}const p=_d(u,y??zx(u));return{method:u,columns:d,options:p}}).filter(i=>!!i)},LM=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),DM=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:r,methodOptions:i,missingFilter:l,missingFilterMax:u,missingFilterActive:d,filteredOptionCount:m,collapsedStrategies:y,onToggleStrategy:p,onRemoveStrategy:_,onAddStrategy:v,onMethodChange:w,onOptionNumberChange:x,onColumnsChange:S,onColumnToggle:E,onMissingFilterChange:A,formatMissingPercentage:P,formatNumericStat:T,formatModeStat:j,schemaDiagnostics:O})=>{const k=Ae.useMemo(()=>{var q;return(q=O==null?void 0:O.entries)!=null&&q.length?new Map(O.entries.map(K=>[K.index,K])):new Map},[O]),D=Math.max(u,l||0),$=r.length>0,B=q=>{var ne,ue,z;const K=((ne=i.find(X=>X.value===q.method))==null?void 0:ne.label)??q.method;return q.method==="knn"&&((ue=q.options)!=null&&ue.neighbors)?`${K}  k=${q.options.neighbors}`:(q.method==="regression"||q.method==="mice")&&((z=q.options)!=null&&z.max_iter)?`${K}  ${q.options.max_iter} iter`:K};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:v,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(O==null?void 0:O.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:O.message}),r.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",m," of ",r.length," column",r.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx("input",{id:"imputer-missing-filter",type:"range",min:0,max:D,step:1,value:l,onChange:q=>A(Number(q.target.value)),className:"canvas-imputer__filter-range"}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[l,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>A(0),disabled:!l,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:AM.map(q=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${l===q?" canvas-imputer__filter-button--active":""}`,onClick:()=>A(q),children:["",q,"%"]},`imputer-missing-preset-${q}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map((q,K)=>{var Q,ee,G;const ne=q.columns.join(", "),ue=Dx(q.method),z=r.filter(V=>{if(q.columns.includes(V.name))return!0;if(ue&&!$M(V))return!1;const Z=typeof V.missingPercentage=="number"?V.missingPercentage:null;return Z!==null?Z<=0?!1:Z>=l:l===0}),X=B(q),Y=q.columns.length?`${q.columns.length} column${q.columns.length===1?"":"s"}`:"No columns yet",W=y.has(K),F=z.filter(V=>!q.columns.includes(V.name)),te=k.get(K),U=(Q=te==null?void 0:te.details)!=null&&Q.length?te.details.map(V=>V.logical_family?`${V.name} (${V.logical_family})`:V.name).join(", "):"",H=()=>{if(!z.length)return;const V=[...q.columns];z.forEach(Z=>{V.includes(Z.name)||V.push(Z.name)}),S(K,V.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>p(K),"aria-expanded":!W,"aria-controls":`imputer-strategy-body-${K}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${W?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",K+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[X,"  ",Y]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>_(K),"aria-label":`Remove strategy ${K+1}`,children:"Remove"})]}),!W&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${K}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Method"}),a.jsx("select",{value:q.method,onChange:V=>w(K,V.target.value??"mean"),children:i.map(V=>a.jsx("option",{value:V.value,children:V.label},V.value))})]}),q.method==="knn"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Neighbors (k)"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:50,step:1,value:((ee=q.options)==null?void 0:ee.neighbors)??5,onChange:V=>x(K,"neighbors",V.target.value)})]}),(q.method==="regression"||q.method==="mice")&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Max iterations"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:100,step:1,value:((G=q.options)==null?void 0:G.max_iter)??10,onChange:V=>x(K,"max_iter",V.target.value)})]}),q.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),U&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",U,"."]}),z.length>0&&F.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:H,children:"Select all columns"}),z.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:z.map(V=>{const Z=q.columns.includes(V.name),de=P(V.missingPercentage),pe=typeof V.mean=="number",le=typeof V.median=="number",ge=V.mode!==null&&V.mode!==void 0&&V.mode!=="",He=pe||le||ge;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Z?" canvas-imputer__column-pill--selected":""}`,onClick:()=>E(K,V.name),"aria-pressed":Z,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:V.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",de]}),V.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:V.dtype})]}),He&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[pe&&a.jsxs("span",{children:["Mean: ",T(V.mean)]}),le&&a.jsxs("span",{children:["Median: ",T(V.median)]}),ge&&a.jsxs("span",{children:["Mode: ",j(V.mode)]})]})]},V.name)})}):a.jsx("p",{className:"canvas-modal__note",children:$?d?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${q.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:q.columns.length?q.columns.map(V=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:V},V)):a.jsx("span",{children:"No columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Manual columns (optional)"}),a.jsx("input",{type:"text",className:"canvas-imputer__columns-input",value:ne,onChange:V=>S(K,V.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${K}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},jr=["standard","robust","minmax","maxabs"],Zi={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},Fx={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},Ix=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],Bx=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=Ix(t.columns),r=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",i=jr.includes(r)?r:"standard",l={},u=t.column_methods;u&&typeof u=="object"&&!Array.isArray(u)&&Object.entries(u).forEach(([y,p])=>{const _=String(y??"").trim(),v=typeof p=="string"?p.trim().toLowerCase():"";_&&jr.includes(v)&&(l[_]=v)});const d=typeof t.auto_detect=="boolean"?t.auto_detect:!0,m=Ix(t.skipped_columns);return{columns:n,defaultMethod:i,columnMethods:l,autoDetect:d,skippedColumns:m}},zM=e=>{const t={...Zi};return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";r&&jr.includes(r)&&i&&(t[r]=i)}),t},RM=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;r&&jr.includes(r)&&t.set(r,n)}),t},FM=e=>jr.map(t=>({value:t,label:e[t]??Zi[t]??t})),IM=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:r,scalingSkippedColumns:i,scalingExcludedColumns:l})=>{if(!e.length)return[];const u=[];return e.forEach(d=>{const m=String((d==null?void 0:d.column)??"").trim();if(!m)return;const y=d.recommended_method,p=n[y]??Zi[y]??y,_=Array.isArray(d.fallback_methods)?d.fallback_methods.filter(k=>jr.includes(k)).map(k=>{const D=k;return n[D]??Zi[D]??D}):[],v=d.confidence??"medium",w=Fx[v]??Fx.medium,S=t.columnMethods[m]??null,E=S??t.defaultMethod,A=n[E]??Zi[E]??E,P=l.has(m),T=i.has(m),j=r.has(m),O=d.stats;u.push({column:m,dtype:d.dtype??null,recommendedMethod:y,recommendedLabel:p,confidence:v,confidenceLabel:w,reasons:Array.isArray(d.reasons)?d.reasons:[],fallbackLabels:_,stats:O,hasMissing:!!d.has_missing,currentOverride:S,currentMethod:E,currentMethodLabel:A,isOverrideApplied:S!==null,isSelected:j,isExcluded:P,isSkipped:T})}),u.sort((d,m)=>d.column.localeCompare(m.column)),u},BM=(e,t,n,r)=>{if(!e.length)return null;const i=e.map(l=>{const u=t[l],d=u?n[u]??Zi[u]??u:null;return d?`${l} -> ${d}`:l});return r>e.length&&i.push(""),i.join(", ")},UM=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:r,scalingMethodOptions:i,scalingMethodDetailMap:l,scalingDefaultDetail:u,scalingAutoDetectEnabled:d,scalingSelectedCount:m,scalingDefaultLabel:y,scalingOverrideCount:p,scalingOverrideExampleSummary:_,scalingRecommendationRows:v,scalingHasRecommendations:w,scalingStatusMessage:x,scalingError:S,scalingSampleSize:E,relativeScalingGeneratedAt:A,formatMetricValue:P,formatNumericStat:T,formatMissingPercentage:j,onApplyAllRecommendations:O,onClearOverrides:k,onDefaultMethodChange:D,onAutoDetectToggle:$,onOverrideSelect:B})=>{const q=u??l.get(r.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:O,disabled:!w,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:k,disabled:!p,children:"Clear overrides"})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),A&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",A,E!==null?` on ${P(E)} row${E===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:i.map(K=>{const ne=l.get(K.value)??null,ue=K.value===r.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${ue?" canvas-scaling__method-button--active":""}`,"aria-pressed":ue,onClick:()=>D(K.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:K.label}),(ne==null?void 0:ne.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:ne.description})]},K.value)})}),(q==null?void 0:q.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:q.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:K=>$(K.target.checked)}),a.jsx("span",{children:d?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"When enabled, recommended numeric features join this node automatically after each refresh."})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:m})," column",m===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:y})," ",d?" Auto-detect on":" Auto-detect off",p>0?`  Overrides: ${p}${_?` (${_})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&S&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:S}),!n&&!S&&a.jsxs(a.Fragment,{children:[x&&a.jsx("p",{className:"canvas-modal__note",children:x}),v.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:v.map(K=>{const ne=!K.isSkipped&&K.recommendedMethod!==K.currentMethod,ue=["canvas-cast__row"];ne&&ue.push("canvas-cast__row--attention"),K.isOverrideApplied&&ue.push("canvas-cast__row--override"),K.isSkipped&&ue.push("canvas-cast__row--muted");const z=K.isSkipped?"__skip__":K.isOverrideApplied?K.currentMethod:"__default__",X=K.isOverrideApplied?`Override -> ${K.currentMethodLabel}`:K.isSkipped?"Skipped (column will not be scaled)":K.isSelected?`Inheriting ${y}`:"Pending inclusion",Y=K.stats,W=[];typeof Y.valid_count=="number"&&Number.isFinite(Y.valid_count)&&W.push(`${P(Y.valid_count)} valid rows`),typeof Y.mean=="number"&&Number.isFinite(Y.mean)&&W.push(`Mean ${T(Y.mean)}`),typeof Y.median=="number"&&Number.isFinite(Y.median)&&W.push(`Median ${T(Y.median)}`),typeof Y.stddev=="number"&&Number.isFinite(Y.stddev)&&W.push(` ${T(Y.stddev)}`),typeof Y.iqr=="number"&&Number.isFinite(Y.iqr)&&W.push(`IQR ${T(Y.iqr)}`);const F=typeof Y.minimum=="number"&&Number.isFinite(Y.minimum),te=typeof Y.maximum=="number"&&Number.isFinite(Y.maximum);if(F||te){const H=F?T(Y.minimum):"",Q=te?T(Y.maximum):"";W.push(`Range ${H}  ${Q}`)}typeof Y.skewness=="number"&&Number.isFinite(Y.skewness)&&W.push(`Skew ${T(Y.skewness)}`),typeof Y.outlier_ratio=="number"&&Number.isFinite(Y.outlier_ratio)&&Y.outlier_ratio>0&&W.push(`${j(Y.outlier_ratio*100)} outliers`);const U=W.length?W.join("  "):null;return a.jsxs("tr",{className:ue.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:K.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[K.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",K.dtype]}),K.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),K.isSelected&&!K.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),K.isSkipped&&!K.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),K.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${ne?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:K.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:K.confidenceLabel}),K.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:K.reasons.join("; ")})]})}),a.jsx("td",{children:U?a.jsx("span",{children:U}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:z,onChange:H=>B(K.column,H.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",y,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),i.map(H=>a.jsx("option",{value:H.value,children:H.label},`${K.column}-${H.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:X})]})})]},`scaling-row-${K.column}`)})})]})})})]})]})},Af=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],qM="log",oo=e=>typeof e=="string"&&Af.includes(e),Ux=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",r=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const i=oo(r)?r:qM;return{column:n,method:i}}).filter(t=>!!t):[],Pg=e=>{const t=new Set,n=[];return e.forEach(r=>{const i=`${r.column}__${r.method}`;t.has(i)||(t.add(i),n.push(r))}),n},qx={left:"Left skew",right:"Right skew"},HM={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},VM=e=>{const t={...HM};return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!r||!i||oo(r)&&(t[r]=i)}),t},WM=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:r,transformationMap:i})=>{const l=e==="recommended"?t.map(m=>m!=null&&m.column?m.column:null).filter(m=>!!m):n,u=new Set,d=[];return l.forEach(m=>{const y=typeof m=="string"?m.trim():"";if(!y||u.has(y))return;u.add(y);const p=r.get(y)??null,_=p?p.recommended_methods.filter(oo):[],v=_.length?_[0]:null,w=p!=null&&p.direction?qx[p.direction]??p.direction:null,x=p!=null&&p.magnitude?`${p.magnitude.charAt(0).toUpperCase()}${p.magnitude.slice(1)}`:null,S=p&&typeof p.skewness=="number"&&Number.isFinite(p.skewness)?p.skewness:null,E=(p==null?void 0:p.summary)??null,A=i.get(y)??null;d.push({column:y,recommendedMethods:_,primaryMethod:v,directionLabel:w,magnitudeLabel:x,skewnessValue:S,summary:E,selectedMethod:A})}),d.sort((m,y)=>{const p=typeof m.skewnessValue=="number"?Math.abs(m.skewnessValue):-1/0,_=typeof y.skewnessValue=="number"?Math.abs(y.skewnessValue):-1/0;if(p!==_)return _-p;const v=!!m.primaryMethod,w=!!y.primaryMethod;return v!==w?v?-1:1:m.column.localeCompare(y.column)}),d},KM=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const r="no-recommendation",i=new Map;e.forEach(u=>{const d=u.primaryMethod??null,m=d??r,y=d?n(d):"No recommended action",p=i.get(m)??{key:m,label:y,method:d,rows:[]};p.rows.push(u),i.set(m,p)});const l=Array.from(i.values());return l.sort((u,d)=>{const m=v=>v?Af.indexOf(v):Af.length,y=m(u.method)-m(d.method);if(y!==0)return y;if(u.rows.length!==d.rows.length)return d.rows.length-u.rows.length;const p=u.label??"",_=d.label??"";return p.localeCompare(_)}),l},YM=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:r,skewnessError:i,skewnessViewMode:l,skewnessRecommendedCount:u,skewnessNumericCount:d,skewnessGroupByMethod:m,skewnessRows:y,skewnessTableGroups:p,hasSkewnessAutoRecommendations:_,skewnessTransformationsCount:v,isFetchingRecommendations:w,getSkewnessMethodLabel:x,getSkewnessMethodStatus:S,onApplyRecommendations:E,onViewModeChange:A,onGroupByToggle:P,onOverrideChange:T,onClearSelections:j})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:E,disabled:w||!_,children:"Apply recommendations"})})]}),r!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",r.toFixed(2)," are surfaced below."]}),n&&y.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&i&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i}),(!n||y.length>0)&&!i&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="recommended",onClick:()=>A("recommended"),disabled:!u,children:["Recommended (",u,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="all",onClick:()=>A("all"),disabled:!d,children:["All numeric (",d,")"]})]}),a.jsxs("label",{className:"canvas-skewness__toggle",children:[a.jsx("input",{type:"checkbox",checked:m,onChange:O=>P(O.target.checked)}),"Group columns by recommended action"]})]}),y.length===0?a.jsx("p",{className:"canvas-modal__note",children:l==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:p.map(O=>a.jsxs("div",{className:"canvas-skewness__group",children:[O.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:O.label}),a.jsxs("span",{children:[O.rows.length," column",O.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:O.rows.map(k=>{const D=[];k.directionLabel&&D.push(k.directionLabel),k.skewnessValue!==null&&D.push(`(${k.skewnessValue.toFixed(2)})`),k.magnitudeLabel&&D.push(` ${k.magnitudeLabel}`);const $=D.length?D.join(" "):"",B=k.selectedMethod??"",q=new Set(k.recommendedMethods),K=[{value:"",label:"No transform",status:null,reason:null}];k.recommendedMethods.forEach(z=>{const X=S(k.column,z);K.push({value:z,label:`${x(z)}${z===k.primaryMethod?" (recommended)":""}`,status:X,reason:(X==null?void 0:X.reason)??null})}),Af.forEach(z=>{if(q.has(z))return;const X=S(k.column,z);K.push({value:z,label:x(z),status:X,reason:(X==null?void 0:X.reason)??null})});const ne=k.selectedMethod?S(k.column,k.selectedMethod):null,ue=!k.selectedMethod&&k.primaryMethod?S(k.column,k.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${k.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:k.column}),k.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:k.summary})]})}),a.jsx("td",{children:k.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${k.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:k.primaryMethod?x(k.primaryMethod):x(k.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:$})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx("select",{value:B,onChange:z=>T(k.column,z.target.value),disabled:w||!t,children:K.map(z=>{var W;const X=z.reason?`${z.label} (caution: ${z.reason})`:z.label,Y=((W=z.status)==null?void 0:W.status)??"ready";return a.jsx("option",{value:z.value,"data-status":Y,children:X},`skewness-option-${k.column}-${z.value||"none"}`)})}),ne&&ne.status!=="ready"&&ne.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",ne.reason]}),!k.selectedMethod&&ue&&ue.status!=="ready"&&ue.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",ue.reason]})]})})]},`skewness-row-${k.column}`)})})]})})]},`skewness-group-${O.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:v?`${v} transformation${v===1?"":"s"} configured`:"No transformations configured yet."}),v>0&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:j,children:"Clear selections"})]})]})]}),QM="_was_missing",GM=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const r=typeof t=="string"?t.trim():"";return r||QM},XM=(e,t)=>{const n=typeof e=="string"?e.trim():"",r=typeof t=="string"?t:"";return!n||!r?!1:n.endsWith(r)},JM=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:r})=>{const i=typeof r=="string"?r:"",l=mt(t),u=new Set(l),d=Array.from(new Set(mt(e))),m=[];if(d.forEach(_=>{const v=`${_}${i}`,w=n[_],x=typeof w=="number"&&Number.isFinite(w)?Math.max(0,w):null;m.push({column:_,missingPercentage:x,flagColumn:v,conflicts:{alreadyExists:u.has(v),duplicateFlag:!1}})}),m.length>0){const _=new Map;m.forEach(v=>{_.set(v.flagColumn,(_.get(v.flagColumn)??0)+1)}),m.forEach(v=>{v.conflicts.duplicateFlag=(_.get(v.flagColumn)??0)>1})}m.sort((_,v)=>{const w=_.missingPercentage,x=v.missingPercentage,S=typeof w=="number",E=typeof x=="number";return S&&E&&w!==x?x-w:S!==E?S?-1:1:_.column.localeCompare(v.column)});const y=i?Array.from(new Set(l.filter(_=>XM(_,i)))):[],p=m.reduce((_,v)=>v.conflicts.alreadyExists||v.conflicts.duplicateFlag?_+1:_,0);return{rows:m,flaggedColumnsInDataset:y,conflictCount:p}},ZM=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:r,flaggedColumnsInDataset:i,conflictCount:l}=t,u=r.length>0,d=e||"(no suffix)",m=i.slice(0,4),y=Math.max(i.length-m.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:r.length})," flag column",r.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:d}),"."]}),i.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",i.length," existing flag column",i.length===1?"":"s"," ","with this suffix",m.length>0?` (examples: ${m.join(", ")}${y>0?", ":""})`:"","."]}),l>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l," generated flag column",l===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),u?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:r.map(p=>{const _=[];p.conflicts.alreadyExists&&_.push("Already exists"),p.conflicts.duplicateFlag&&_.push("Duplicate name");const v=_.length>0,w=v?_.join("  "):"Ready",x=v?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",S=v?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:S,children:[a.jsx("th",{scope:"row",children:p.column}),a.jsx("td",{children:n(p.missingPercentage)}),a.jsx("td",{children:p.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:x,children:w})})]},`missing-indicator-${p.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},Hx=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],Tg="canonicalize_country_codes",eA=new Set(Hx),tA=["string","object","text","category","mixed","varchar","char"],nA=4,sA=6,el=4,rA=3,Vx=36,aA=5,$g={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},Wx=Hx.map(e=>{var t;return{value:e,label:((t=$g[e])==null?void 0:t.label)??e}}),oA=new Set(["true","1","yes","y","on"]),iA=new Set(["false","0","no","n","off"]),lA=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(oA.has(n))return!0;if(iA.has(n))return!1}return t},Lg=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Lg(e.split(",")):[],Kx=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,r=Lg(n.columns),i=lA(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),l=Pf(typeof n.mode=="string"?n.mode:void 0,t.mode);return!r.length&&!i?null:{mode:l,columns:r,autoDetect:i}},Yx=(e,t)=>{const n={mode:t.mode,columns:Lg(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const i=Kx(e,n);return i?[i]:[n]}const r=[];return e.forEach(i=>{const l=Kx(i,n);l&&r.push(l)}),r.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):r},cA=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),uA=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),Of=e=>e.length<=Vx?e:`${e.slice(0,Vx-1)}...`,Qx=e=>eA.has(e),Gx=e=>{if(!e)return!1;const t=e.toLowerCase();return tA.some(n=>t.includes(n))},Pf=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Qx(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&Qx(r)?r:Tg},dA=e=>{const t=$g[e]??$g[Tg];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},mA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:r})=>{const i=Array.from(new Set(mt(e))),l=new Set(i),u=t.filter(p=>Gx(n[p]??null)),d=u.filter(p=>!l.has(p)),m=i.filter(p=>!Gx(n[p]??null)),y=typeof r=="boolean"?r:i.length===0;return{selectedColumns:i,nonTextSelected:m,autoDetectionActive:y,recommendedColumns:d,textColumnCount:u.length,textColumns:u}},fA=/[\n;,]+/,Ec=(e,t)=>e.slice(0,t),Tf=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[r,...i]=n,l=i.join(t);return[r,l]},hA=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],r=[],i=new Map;let l=0;const u=(p,_)=>{const v=String(p??"").trim(),w=String(_??"").trim();if(!v||!w){(v||w)&&n.push(`${v} => ${w}`.trim());return}const x=uA(v);if(!x){n.push(`${v} => ${w}`);return}i.has(x)?t.add(v):(i.set(x,w),r.length<nA&&r.push(`${v} => ${w}`)),l+=1};if(typeof e=="string"){e.split(fA).forEach(x=>{const S=x.trim();if(S){if(S.includes("=>")){const E=Tf(S,"=>");E?u(E[0],E[1]):n.push(S);return}if(S.includes(":")){const E=Tf(S,":");E?u(E[0],E[1]):n.push(S);return}n.push(S)}});const _=Array.from(t),v=Ec(_,el),w=Ec(n,el);return{totalPairs:l,previewPairs:r,previewOverflow:Math.max(l-r.length,0),duplicates:v,duplicateOverflow:Math.max(_.length-v.length,0),invalidEntries:w,invalidOverflow:Math.max(n.length-w.length,0)}}if(Array.isArray(e)){e.forEach(w=>{if(w){if(typeof w=="string"){const x=w.trim();if(!x)return;if(x.includes("=>")){const S=Tf(x,"=>");S?u(S[0],S[1]):n.push(x)}else if(x.includes(":")){const S=Tf(x,":");S?u(S[0],S[1]):n.push(x)}else n.push(x);return}if(typeof w=="object"){const{alias:x,replacement:S}=w;u(x,S);return}n.push(String(w))}});const p=Array.from(t),_=Ec(p,el),v=Ec(n,el);return{totalPairs:l,previewPairs:r,previewOverflow:Math.max(l-r.length,0),duplicates:_,duplicateOverflow:Math.max(p.length-_.length,0),invalidEntries:v,invalidOverflow:Math.max(n.length-v.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([p,_])=>{u(p,_)});const d=Array.from(t),m=Ec(d,el),y=Ec(n,el);return{totalPairs:l,previewPairs:r,previewOverflow:Math.max(l-r.length,0),duplicates:m,duplicateOverflow:Math.max(d.length-m.length,0),invalidEntries:y,invalidOverflow:Math.max(n.length-y.length,0)}},pA=e=>{const t=e.slice(0,sA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},gA=e=>{const t=e.slice(0,el);return{preview:t,remaining:Math.max(e.length-t.length,0)}},_A=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Of(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?Of(t):null}try{const t=JSON.stringify(e);return t?Of(t):null}catch{return Of(String(e))}},vA=(e,t=rA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([i,l])=>{const u=typeof i=="string"?i.trim():"";if(!u)return;const d=_A(l);if(!d)return;const m=n[u]??[];m.includes(d)||m.length>=t||(n[u]=[...m,d])})}),n},yA=(e,t,n=aA)=>{if(!t.length)return[];const r=[];for(const i of t){if(r.length>=n)break;const l=e[i];!l||!l.length||r.push({column:i,values:l,overflow:0})}return r},Dg=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),Xx=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],Jx=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);Xx.forEach(e=>{e.forEach(t=>Jx.add(Dg(t)))});const Zx=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],e0=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);Zx.forEach(e=>{e.forEach(t=>e0.add(Dg(t)))});const bA=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],xA=/^[A-Za-z]{2,3}$/,wA=/[^0-9A-Za-z\s]/,jA=/[^0-9A-Za-z]+/,$f={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:Xx},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:Zx},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:bA},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},NA=e=>{const t=[];return e.forEach(n=>{n.split(jA).filter(Boolean).forEach(i=>{t.push(i)})}),t},SA=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(r=>wA.test(r));const n=NA(t).map(r=>Dg(r));return n.length?e==="canonicalize_country_codes"?n.some(r=>Jx.has(r))||t.some(r=>xA.test(r.trim())):e==="normalize_boolean"?n.some(r=>e0.has(r)):!1:!1},t0=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},CA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:r,columnOptions:i,sampleMap:l,modeOptions:u=Wx,customPairSummary:d,customPairsParameter:m,collapsedStrategies:y,onToggleStrategy:p,onRemoveStrategy:_,onAddStrategy:v,onModeChange:w,onAutoDetectToggle:x,onColumnToggle:S,onColumnsChange:E,renderParameterField:A})=>{const P=n.length>0,T=r.selectedColumns.length,j=f.useMemo(()=>pA(r.recommendedColumns),[r.recommendedColumns]),O=f.useMemo(()=>gA(r.nonTextSelected),[r.nonTextSelected]),k=f.useMemo(()=>yA(l,r.selectedColumns),[r.selectedColumns,l]),D=!e||!t,$=d.duplicates.length+d.duplicateOverflow,B=d.invalidEntries.length+d.invalidOverflow,q=d.duplicates.join(", "),K=d.invalidEntries.join(", "),ne=f.useMemo(()=>n.some(G=>G.mode==="custom"),[n]),ue=f.useMemo(()=>{const G=new Map;return n.forEach(V=>{V.columns.forEach(Z=>{const de=Z.trim();de&&G.set(de,(G.get(de)??0)+1)})}),G},[n]),[z,X]=f.useState(()=>new Set),Y=f.useCallback(G=>{X(V=>{const Z=new Set(V);return Z.has(G)?Z.delete(G):Z.add(G),Z})},[]);f.useEffect(()=>{X(G=>{const V=new Set;return G.forEach(Z=>{Z<n.length&&V.add(Z)}),V.size===G.size?G:V})},[n.length]);const[W,F]=f.useState(()=>({index:null,mode:null})),te=f.useMemo(()=>{const G=new Map;return i.forEach(V=>{const Z=Array.isArray(V.samples)?V.samples:[],de=Array.isArray(l[V.name])?l[V.name]:[],pe=[...Z,...de].map(le=>String(le??"").trim()).filter(le=>le.length>0);G.set(V.name,pe.slice(0,12))}),G},[i,l]),U=f.useMemo(()=>{const G=new Map;return i.forEach(V=>{const Z=te.get(V.name)??[],de=Z.length?Z:[V.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(pe=>{SA(pe,de)&&(G.has(pe)||G.set(pe,new Set),G.get(pe).add(V.name))})}),G},[i,te]);f.useEffect(()=>{if(W.index===null)return;const G=n[W.index];(!G||G.mode!==W.mode)&&F({index:null,mode:null})},[W.index,W.mode,n]);const H=f.useCallback((G,V)=>{F({index:G,mode:V})},[]),Q=f.useCallback(()=>{F({index:null,mode:null})},[]);let ee=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:v,children:"Add strategy"})})]}),r.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:T})," column",T===1?"":"s"," across all strategies."]}),k.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",k.map(G=>`${G.column} (${G.values.join(", ")})`).join("; "),"."]}),r.textColumnCount>0&&j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),O.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[O.preview.join(", ")," ",O.preview.length===1?"is":"are"," not text-like.",O.remaining>0?` ${O.remaining} more column${O.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),D?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!P&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),P&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((G,V)=>{var J;const Z=dA(G.mode),de=((J=u.find(Pe=>Pe.value===G.mode))==null?void 0:J.label)??Z.label,pe=G.columns.length,le=pe?`${pe} column${pe===1?"":"s"}`:G.autoDetect?"Auto-detecting columns":"No columns yet",ge=y.has(V),He=z.has(V),lt=G.columns.join(", "),Ye=U.get(G.mode)??new Set,Se=G.mode==="custom"&&!!m&&!ee,Re=G.mode==="custom"&&!!m&&ee;Se&&(ee=!0);const Ce=i.map(Pe=>{const $e=G.columns.includes(Pe.name),rt=Ye.has(Pe.name),wt=$e?0:rt?1:Pe.isRecommended?2:Pe.isTextLike?3:4;return{option:Pe,priority:wt}}).sort((Pe,$e)=>Pe.priority!==$e.priority?Pe.priority-$e.priority:Pe.option.name.localeCompare($e.option.name)).map(Pe=>Pe.option),Fe=Ye.size>0,Ve=Ce.filter(Pe=>G.columns.includes(Pe.name)?!0:Fe?Ye.has(Pe.name):Pe.isRecommended||Pe.isTextLike),Ke=new Set(Ve.map(Pe=>Pe.name)),tt=Ce.filter(Pe=>!Ke.has(Pe.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>p(V),"aria-expanded":!ge,"aria-controls":`alias-strategy-body-${V}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${ge?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",V+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[de,G.autoDetect?"  auto-detect":"",le?`  ${le}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>_(V),"aria-label":`Remove alias strategy ${V+1}`,children:"Remove"})]}),!ge&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${V}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[u.map(Pe=>{const $e=Pe.value===G.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${$e?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":$e,onClick:()=>w(V,Pe.value),children:Pe.label},Pe.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>H(V,G.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:Z.guidance})]}),W.index===V&&W.mode===G.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:$f[G.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:Q,children:"Close"})]}),a.jsx("p",{children:$f[G.mode].description}),$f[G.mode].preview&&a.jsx("ul",{children:$f[G.mode].preview.map(([Pe,$e])=>a.jsxs("li",{children:[Pe," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",$e]},`${Pe}-${$e}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${V}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${V}-auto-detect`,type:"checkbox",checked:G.autoDetect,onChange:Pe=>x(V,Pe.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${V}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),i.length?a.jsxs(a.Fragment,{children:[Ye.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",de.toLowerCase()," entries."]}),Ve.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${V+1}`,children:Ve.map(Pe=>{const $e=G.columns.includes(Pe.name),rt=t0(Pe.samples.length?Pe.samples:l[Pe.name]??[]),en=(ue.get(Pe.name)??0)-($e?1:0)>0,ye=Ye.has(Pe.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${$e?" canvas-imputer__column-pill--selected":""}`,onClick:()=>S(V,Pe.name),"aria-pressed":$e,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Pe.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Pe.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Pe.dtype}),Pe.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!Pe.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),ye&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),en&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),rt&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",rt]})]},Pe.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),tt.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>Y(V),"aria-expanded":He,"aria-controls":`alias-strategy-${V}-other-columns`,children:He?"Hide other columns":`Show other columns (${tt.length})`}),He&&a.jsx("div",{id:`alias-strategy-${V}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${V+1}`,children:tt.map(Pe=>{const $e=G.columns.includes(Pe.name),rt=t0(Pe.samples.length?Pe.samples:l[Pe.name]??[]),en=(ue.get(Pe.name)??0)-($e?1:0)>0,ye=Ye.has(Pe.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${$e?" canvas-imputer__column-pill--selected":""}`,onClick:()=>S(V,Pe.name),"aria-pressed":$e,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Pe.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Pe.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Pe.dtype}),!Pe.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),ye&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),en&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),rt&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",rt]})]},Pe.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${G.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:G.columns.length?G.columns.map(Pe=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:Pe},Pe)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${V}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${V}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:lt,onChange:Pe=>E(V,Pe.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),G.mode==="custom"&&m&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Se?A(m):Re?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${V}`)})}),d.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[d.totalPairs," custom pair",d.totalPairs===1?"":"s"," captured.",ne?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",d.previewPairs.length>0?` Examples: ${d.previewPairs.join("; ")}${d.previewOverflow>0?"...":""}`:""]}),d.totalPairs===0&&ne&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),$>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",q?`: ${q}`:"",d.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),B>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",B," incomplete pair",B===1?"":"s",".",K?` Examples: ${K}${d.invalidOverflow>0?"...":""}`:""]})]})},Lf=["iso_date","iso_datetime","month_day_year","day_month_year"],EA="iso_date",kA=["date","time","timestamp","datetime"],MA=3,n0=36,vd={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},zg=Lf.map(e=>({value:e,label:vd[e].label,guidance:vd[e].guidance,example:vd[e].example})),AA=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],s0=e=>e.length<=n0?e:`${e.slice(0,n0-1)}...`,r0=e=>{if(!e)return!1;const t=e.toLowerCase();return kA.some(n=>t.includes(n))},OA=e=>AA.some(t=>t.test(e)),a0=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Lf.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&Lf.includes(r)?r:EA},PA=e=>{const t=[];return Object.entries(e).forEach(([n,r])=>{if(!r||!r.length)return;const i=r.length;let l=0;if(r.forEach(d=>{OA(d)&&(l+=1)}),!i)return;l/i>=.6&&l>=2&&t.push(n)}),t.sort((n,r)=>n.localeCompare(r)),t},TA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const i=Array.from(new Set(mt(e)));i.sort((v,w)=>v.localeCompare(w));const l=new Set(i),u=t.filter(v=>r0(n[v]??null)),d=PA(r),m=new Set;u.forEach(v=>{l.has(v)||m.add(v)}),d.forEach(v=>{l.has(v)||m.add(v)});const y=Array.from(m);y.sort((v,w)=>v.localeCompare(w));const p=i.filter(v=>!(r0(n[v]??null)||d.includes(v))),_=d.slice().sort((v,w)=>v.localeCompare(w));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:y,nonDateSelected:p,dateColumnCount:u.length,sampleCandidateCount:d.length,sampleCandidates:_}},$A=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&Lf.includes(n)?n:t},LA=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},o0=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,r=e.map(i=>{if(!i||typeof i!="object")return null;const l=mt(i.columns),u=Array.from(new Set(l.map(p=>p.trim()).filter(Boolean))).sort((p,_)=>p.localeCompare(_)),d=$A(i.mode,t.mode),m=LA(i.auto_detect??i.autoDetect??i.auto),y=`${d}|${u.join(",")}|${m?"auto":"manual"}`;return n.has(y)?null:(n.add(y),{mode:d,columns:u,autoDetect:m})}).filter(i=>!!i);return r.length?r:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},DA=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),zA=e=>{var t;return((t=vd[e])==null?void 0:t.label)??vd.iso_date.label},RA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?s0(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?s0(t):null},FA=(e,t=MA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([i,l])=>{const u=typeof i=="string"?i.trim():"";if(!u)return;const d=RA(l);if(!d)return;const m=n[u]??[];m.includes(d)||m.length>=t||(n[u]=[...m,d])})}),n},IA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},i0=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},BA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:r,columnOptions:i,sampleMap:l,collapsedStrategies:u,onToggleStrategy:d,onRemoveStrategy:m,onAddStrategy:y,onModeChange:p,onColumnToggle:_,onColumnsChange:v,onAutoDetectToggle:w,modeOptions:x=zg})=>{const S=n.length>0,E=f.useMemo(()=>n.some($=>$.autoDetect),[n]),[A,P]=f.useState(()=>new Set),T=f.useCallback($=>{P(B=>{const q=new Set(B);return q.has($)?q.delete($):q.add($),q})},[]);f.useEffect(()=>{P($=>{const B=new Set;return $.forEach(q=>{q<n.length&&B.add(q)}),B.size===$.size?$:B})},[n.length]);const j=f.useMemo(()=>{const $=new Map;return n.forEach(B=>{B.columns.forEach(q=>{const K=q.trim();K&&$.set(K,($.get(K)??0)+1)})}),$},[n]),O=f.useMemo(()=>{const $=r.recommendedColumns.slice(0,6),B=Math.max(r.recommendedColumns.length-$.length,0);return{preview:$,remaining:B}},[r.recommendedColumns]),k=f.useMemo(()=>{const $=r.nonDateSelected.slice(0,4),B=Math.max(r.nonDateSelected.length-$.length,0);return{preview:$,remaining:B}},[r.nonDateSelected]),D=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:y,children:"Add strategy"})})]}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),O.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",O.preview.join(", "),O.remaining>0?`,  (${O.remaining} more)`:"",".",E?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),r.sampleCandidates.length===0&&!O.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[k.preview.join(", ")," ",k.preview.length===1?"looks":"look"," non-date-like.",k.remaining>0?` ${k.remaining} more selected column${k.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),E&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",r.sampleCandidateCount||r.dateColumnCount," date-like columns that are not already assigned."]}),S?a.jsx("div",{className:"canvas-imputer__list",children:n.map(($,B)=>{var Q,ee;const q=((Q=x.find(G=>G.value===$.mode))==null?void 0:Q.label)??zA($.mode),K=$.columns.length,ne=K?`${K} column${K===1?"":"s"}`:$.autoDetect?"Auto-detecting columns":"No columns yet",ue=u.has(B),z=$.columns.join(", "),X=`date-strategy-${B}-toggle`,Y=`date-strategy-${B}-auto-detect`,W=i.map(G=>({option:G,priority:G.isRecommended?0:G.isSampleCandidate?1:2})).sort((G,V)=>G.priority!==V.priority?G.priority-V.priority:G.option.name.localeCompare(V.option.name)).map(G=>G.option),F=W.filter(G=>$.columns.includes(G.name)?!0:G.isRecommended||G.isSampleCandidate),te=new Set(F.map(G=>G.name)),U=W.filter(G=>!te.has(G.name)),H=A.has(B);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:X,className:"canvas-imputer__card-toggle",onClick:()=>d(B),"aria-expanded":!ue,"aria-controls":`date-strategy-body-${B}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${ue?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",B+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[q,$.autoDetect?"  auto-detect":"",ne?`  ${ne}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>m(B),"aria-label":`Remove date formatting strategy ${B+1}`,children:"Remove"})]}),!ue&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${B}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${B}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${B}-mode`,value:$.mode,onChange:G=>p(B,G.target.value),children:x.map(G=>a.jsx("option",{value:G.value,children:G.label},G.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((ee=x.find(G=>G.value===$.mode))==null?void 0:ee.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:Y,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:Y,type:"checkbox",checked:$.autoDetect,onChange:G=>w(B,G.target.checked)}),a.jsx("label",{htmlFor:Y,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),W.length?a.jsxs(a.Fragment,{children:[F.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:F.map(G=>{const V=$.columns.includes(G.name),Z=i0(G.samples.length?G.samples:l[G.name]??[]),pe=(j.get(G.name)??0)-(V?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${V?" canvas-imputer__column-pill--selected":""}`,onClick:()=>_(B,G.name),"aria-pressed":V,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:G.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[G.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:G.dtype}),G.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!G.isRecommended&&G.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),pe&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Z&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Z]})]},G.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),U.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>T(B),"aria-expanded":H,"aria-controls":`date-strategy-${B}-other-columns`,children:H?"Hide other columns":`Show other columns (${U.length})`}),H&&a.jsx("div",{id:`date-strategy-${B}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:U.map(G=>{const V=$.columns.includes(G.name),Z=i0(G.samples.length?G.samples:l[G.name]??[]),pe=(j.get(G.name)??0)-(V?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${V?" canvas-imputer__column-pill--selected":""}`,onClick:()=>_(B,G.name),"aria-pressed":V,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:G.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[G.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:G.dtype}),pe&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Z&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Z]})]},G.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${$.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:$.columns.length?$.columns.map(G=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:G},G)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${B}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${B}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:z,onChange:G=>v(B,G.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${B}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},l0=["both","leading","trailing"],c0="both",UA=["string","object","text","category","mixed","varchar","char"],qA=3,u0=36,d0=6,HA=4,VA=5,m0={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},WA=e=>e.length<=u0?e:`${e.slice(0,u0-1)}...`,f0=e=>{if(!e)return!1;const t=e.toLowerCase();return UA.some(n=>t.includes(n))},KA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${WA(t)}'`},YA=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,QA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&l0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&l0.includes(r)?r:c0},GA=e=>{const t=m0[e]??m0[c0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},XA=e=>{const t=[];return Object.entries(e).forEach(([n,r])=>{if(!r.length)return;const i=r.reduce((u,d)=>d.hasIssue?u+1:u,0);if(!i)return;const l=i/r.length;(i>=2||l>=.5)&&t.push(n)}),t.sort((n,r)=>n.localeCompare(r)),t},JA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const i=Array.from(new Set(mt(e)));i.sort((_,v)=>_.localeCompare(v));const l=new Set(i),u=t.filter(_=>f0(n[_]??null)),d=XA(r),m=new Set;u.forEach(_=>{l.has(_)||m.add(_)}),d.forEach(_=>{l.has(_)||m.add(_)});const y=Array.from(m).sort((_,v)=>_.localeCompare(v)),p=i.filter(_=>!f0(n[_]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:y,nonTextSelected:p,textColumnCount:u.length,whitespaceCandidateCount:d.length,whitespaceCandidates:d}},Rg=(e,t)=>e.slice(0,t),ZA=e=>{const t=Rg(e,d0);return{preview:t,remaining:Math.max(e.length-t.length,0)}},eO=e=>{const t=Rg(e,HA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},tO=e=>{const t=Rg(e,d0);return{preview:t,remaining:Math.max(e.length-t.length,0)}},nO=(e,t=qA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([i,l])=>{const u=typeof i=="string"?i.trim():"";if(!u)return;let d="";if(l==null)d="";else if(typeof l=="string")d=l;else if(typeof l=="number"||typeof l=="boolean")d=String(l);else try{d=JSON.stringify(l)}catch{d=String(l)}if(!d.length)return;const m=YA(d),y=KA(d),p=n[u]??[];p.find(_=>_.value===y)||p.length>=t||(n[u]=[...p,{value:y,hasIssue:m}])})}),n},sO=(e,t,n=VA)=>{if(!t.length)return[];const r=[];for(const i of t){if(r.length>=n)break;const l=e[i];!l||!l.length||r.push({column:i,values:l.map(u=>u.value),overflow:0})}return r},rO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},aO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,renderMultiSelectField:i,renderParameterField:l,columnSummary:u,modeDetails:d,sampleMap:m})=>{if(!n&&!r)return null;const y=u.selectedColumns.length,p=ZA(u.recommendedColumns),_=eO(u.nonTextSelected),v=tO(u.whitespaceCandidates),w=sO(m,u.selectedColumns),x=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:y})," column",y===1?"":"s"," for trimming."]}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",w.map(S=>`${S.column} (${S.values.join(", ")})`).join("; "),"."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),p.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",p.preview.join(", "),p.remaining>0?`, ... (${p.remaining} more)`:"","."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[_.preview.join(", ")," ",_.preview.length===1?"is":"are"," not text-like.",_.remaining>0?` ${_.remaining} more column${_.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),x?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),i(n)]}),r&&a.jsx("div",{className:"canvas-modal__parameter-list",children:l(r)})]})},h0=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],p0="keep_alphanumeric",oO=["string","object","text","category","mixed","varchar","char"],iO=3,g0=36,lO=6,cO=4,uO=5,_0={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},dO=e=>e.length<=g0?e:`${e.slice(0,g0-1)}...`,mO=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${dO(t)}'`},v0=e=>{if(!e)return!1;const t=e.toLowerCase();return oO.some(n=>t.includes(n))},fO=e=>/[^0-9A-Za-z\s]/.test(e),hO=e=>/[A-Za-z]/.test(e),pO=e=>/[0-9]/.test(e),gO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&h0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&h0.includes(r)?r:p0},_O=e=>{const t=_0[e]??_0[p0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},vO=e=>{const t=new Set,n=new Set,r=new Set;Object.entries(e).forEach(([d,m])=>{if(!m.length)return;let y=0,p=0,_=0;m.forEach(v=>{v.hasSpecial&&(y+=1),v.hasDigits&&(p+=1),v.hasLetters&&(_+=1)}),y>0&&t.add(d),p>0&&_===0&&n.add(d),_>0&&p===0&&r.add(d)});const i=Array.from(t).sort((d,m)=>d.localeCompare(m)),l=Array.from(n).sort((d,m)=>d.localeCompare(m)),u=Array.from(r).sort((d,m)=>d.localeCompare(m));return{specialCandidates:i,digitsOnlyCandidates:l,lettersOnlyCandidates:u}},yO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const i=Array.from(new Set(mt(e)));i.sort((w,x)=>w.localeCompare(x));const l=new Set(i),u=t.filter(w=>v0(n[w]??null)),{specialCandidates:d,digitsOnlyCandidates:m,lettersOnlyCandidates:y}=vO(r),p=new Set;u.forEach(w=>{l.has(w)||p.add(w)}),d.forEach(w=>{l.has(w)||p.add(w)});const _=Array.from(p).sort((w,x)=>w.localeCompare(x)),v=i.filter(w=>!v0(n[w]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:_,nonTextSelected:v,textColumnCount:u.length,specialCandidateCount:d.length,specialCandidates:d,digitsOnlyCandidates:m,lettersOnlyCandidates:y}},y0=(e,t)=>e.slice(0,t),bO=e=>{const t=y0(e,lO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Df=e=>{const t=y0(e,cO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},xO=(e,t=iO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([i,l])=>{const u=typeof i=="string"?i.trim():"";if(!u)return;let d="";if(l==null)d="";else if(typeof l=="string")d=l;else if(typeof l=="number"||typeof l=="boolean")d=String(l);else try{d=JSON.stringify(l)}catch{d=String(l)}if(!d.length)return;const m=mO(d),y=fO(d),p={value:m,hasSpecial:y,hasDigits:pO(d),hasLetters:hO(d)},_=n[u]??[];_.find(v=>v.value===m)||_.length>=t||(n[u]=[..._,p])})}),n},wO=(e,t,n=uO)=>{if(!t.length)return[];const r=[];for(const i of t){if(r.length>=n)break;const l=e[i];!l||!l.length||r.push({column:i,values:l.map(u=>u.value),overflow:0})}return r},jO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},NO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,replacementParameter:i,renderMultiSelectField:l,renderParameterField:u,columnSummary:d,modeDetails:m,sampleMap:y})=>{if(!n&&!r&&!i)return null;const p=d.selectedColumns.length,_=bO(d.recommendedColumns),v=Df(d.specialCandidates),w=Df(d.digitsOnlyCandidates),x=Df(d.lettersOnlyCandidates),S=Df(d.nonTextSelected),E=wO(y,d.selectedColumns),A=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:m.label})," mode. ",m.guidance," Example: ",m.example,"."]}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for cleanup."]}),E.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",E.map(P=>`${P.column} (${P.values.join(", ")})`).join("; "),"."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"",". Consider `digits only` mode."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"",". Consider `letters only` mode."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.preview.join(", ")," ",S.preview.length===1?"is":"are"," not text-like.",S.remaining>0?` ${S.remaining} more column${S.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),A?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),l(n)]}),(r||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[r?u(r):null,i?u(i):null]})]})},b0=["lower","upper","title","sentence"],x0="lower",SO=["string","object","text","category","mixed","varchar","char"],CO=3,w0=60,EO=6,kO=4,MO=5,j0={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},AO=e=>e.length<=w0?e:`${e.slice(0,w0-1)}...`,N0=e=>{if(!e)return!1;const t=e.toLowerCase();return SO.some(n=>t.includes(n))},yd=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${AO(t)}'`},OO=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),PO=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),TO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&b0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&b0.includes(r)?r:x0},$O=e=>{const t=j0[e]??j0[x0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},LO=(e,t)=>{const n=[];return Object.entries(e).forEach(([r,i])=>{if(!i.length)return;i.some(u=>{const d=u[t];return u.original!==d})&&n.push(r)}),n.sort((r,i)=>r.localeCompare(i)),n},DO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r,mode:i})=>{const l=Array.from(new Set(mt(e)));l.sort((v,w)=>v.localeCompare(w));const u=new Set(l),d=t.filter(v=>N0(n[v]??null)),m=LO(r,i),y=new Set;d.forEach(v=>{u.has(v)||y.add(v)}),m.forEach(v=>{u.has(v)||y.add(v)});const p=Array.from(y).sort((v,w)=>v.localeCompare(w)),_=l.filter(v=>!N0(n[v]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:p,nonTextSelected:_,textColumnCount:d.length,inconsistentColumns:m}},S0=(e,t)=>e.slice(0,t),zO=e=>{const t=S0(e,EO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},C0=e=>{const t=S0(e,kO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},RO=(e,t=CO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([i,l])=>{const u=typeof i=="string"?i.trim():"";if(!u)return;let d="";if(l==null)d="";else if(typeof l=="string")d=l;else if(typeof l=="number"||typeof l=="boolean")d=String(l);else try{d=JSON.stringify(l)}catch{d=String(l)}if(!d.length)return;const m=yd(d),y={original:m,lower:yd(d.toLowerCase()),upper:yd(d.toUpperCase()),title:yd(OO(d)),sentence:yd(PO(d))},p=n[u]??[];p.find(_=>_.original===m)||p.length>=t||(n[u]=[...p,y])})}),n},FO=(e,t,n,r=MO)=>{if(!t.length)return[];const i=[];for(const l of t){if(i.length>=r)break;const u=e[l];if(!u||!u.length)continue;const d=u.map(m=>`${m.original}  ${m[n]}`);i.push({column:l,values:d,overflow:0})}return i},IO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},BO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,renderMultiSelectField:i,renderParameterField:l,columnSummary:u,modeDetails:d,sampleMap:m,selectedMode:y})=>{if(!n&&!r)return null;const p=u.selectedColumns.length,_=zO(u.recommendedColumns),v=C0(u.inconsistentColumns),w=C0(u.nonTextSelected),x=FO(m,u.selectedColumns,y),S=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for case normalization."]}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",x.map(E=>`${E.column} (${E.values.join("; ")})`).join(" | "),"."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[w.preview.join(", ")," ",w.preview.length===1?"is":"are"," not text-like.",w.remaining>0?` ${w.remaining} more column${w.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),S?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),i(n)]}),r&&a.jsx("div",{className:"canvas-modal__parameter-list",children:l(r)})]})},E0=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],k0="preset_digits_only",UO=["string","object","text","category","mixed","varchar","char"],qO=3,M0=60,HO=6,VO=4,WO=5,A0={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},KO=e=>e.length<=M0?e:`${e.slice(0,M0-1)}...`,bd=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${KO(t)}'`},O0=e=>{if(!e)return!1;const t=e.toLowerCase();return UO.some(n=>t.includes(n))},YO=e=>e.replace(/\s+/g," ").trim(),QO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&E0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&E0.includes(r)?r:k0},GO=e=>{const t=A0[e]??A0[k0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},XO=e=>{const t=new Set,n=new Set,r=new Set;Object.entries(e).forEach(([l,u])=>{u.length&&u.forEach(d=>{d.hasDigits&&t.add(l),d.hasLetters&&n.add(l),d.hasWhitespaceRuns&&r.add(l)})});const i=l=>Array.from(l).sort((u,d)=>u.localeCompare(d));return{digits:i(t),letters:i(n),whitespace:i(r)}},JO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const i=Array.from(new Set(mt(e)));i.sort((w,x)=>w.localeCompare(x));const l=new Set(i),u=t.filter(w=>O0(n[w]??null)),{digits:d,letters:m,whitespace:y}=XO(r),p=new Set;u.forEach(w=>{l.has(w)||p.add(w)}),[...d,...m,...y].forEach(w=>{l.has(w)||p.add(w)});const _=Array.from(p).sort((w,x)=>w.localeCompare(x)),v=i.filter(w=>!O0(n[w]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:_,nonTextSelected:v,textColumnCount:u.length,digitsCandidates:d,lettersCandidates:m,whitespaceCandidates:y}},P0=(e,t)=>e.slice(0,t),ZO=e=>{const t=P0(e,HO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},zf=e=>{const t=P0(e,VO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},eP=(e,t=qO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([i,l])=>{const u=typeof i=="string"?i.trim():"";if(!u)return;let d="";if(l==null)d="";else if(typeof l=="string")d=l;else if(typeof l=="number"||typeof l=="boolean")d=String(l);else try{d=JSON.stringify(l)}catch{d=String(l)}if(!d.length)return;const m=bd(d),y={original:m,presetDigits:bd(d.replace(/\D+/g,"")),presetLetters:bd(d.replace(/[^A-Za-z]+/g,"")),presetWhitespace:bd(YO(d)),hasDigits:/\d/.test(d),hasLetters:/[A-Za-z]/.test(d),hasWhitespaceRuns:/\s{2,}/.test(d)||/\t|\n|\r/.test(d)},p=n[u]??[];p.find(_=>_.original===m)||p.length>=t||(n[u]=[...p,y])})}),n},tP=(e,t,n)=>{const r=n??"",i=l=>l.length?l:"''";switch(t){case"preset_letters_only":return`${i(e.original)}  ${i(e.presetLetters)}`;case"preset_whitespace_collapse":return`${i(e.original)}  ${i(e.presetWhitespace)}`;case"custom":try{const l=new RegExp(r.split("|||")[0]??"",r.split("|||")[1]??""),u=bd(e.original.replace(l,r.split("|||")[2]??""));return`${i(e.original)}  ${i(u)}`}catch{return`${i(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${i(e.original)}  ${i(e.presetDigits)}`}},nP=(e,t,n,r,i=WO)=>{if(!t.length)return[];const l=[];for(const u of t){if(l.length>=i)break;const d=e[u];if(!d||!d.length)continue;const m=d.map(y=>tP(y,n,r));l.push({column:u,values:m,overflow:0})}return l},sP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},rP=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",r=t[1]??"",i=t[2]??"";return!n.trim()&&!i.trim()?null:`Pattern: /${n||"(empty)"}/${r||"(none)"} Replacement: ${i||"''"}`},aP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,patternParameter:i,replacementParameter:l,renderMultiSelectField:u,renderParameterField:d,columnSummary:m,modeDetails:y,sampleMap:p,selectedMode:_,replacementValue:v})=>{if(!n&&!r&&!i&&!l)return null;const w=m.selectedColumns.length,x=ZO(m.recommendedColumns),S=zf(m.digitsCandidates),E=zf(m.lettersCandidates),A=zf(m.whitespaceCandidates),P=zf(m.nonTextSelected),T=rP(v),j=nP(p,m.selectedColumns,_,v),O=!e||!t,k=_==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:y.label})," mode. ",y.guidance," Example: ",y.example,"."]}),T&&a.jsx("p",{className:"canvas-modal__note",children:T}),m.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:w})," column",w===1?"":"s"," for regex cleanup."]}),j.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",j.map(D=>`${D.column} (${D.values.join("; ")})`).join(" | "),"."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",S.preview.join(", "),S.remaining>0?`, ... (${S.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",E.preview.join(", "),E.remaining>0?`, ... (${E.remaining} more)`:"","."]}),A.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",A.preview.join(", "),A.remaining>0?`, ... (${A.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"","."]}),P.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[P.preview.join(", ")," ",P.preview.length===1?"is":"are"," not text-like.",P.remaining>0?` ${P.remaining} more column${P.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),k&&!T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),O?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),u(n)]}),(r||i||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[r?d(r):null,i?d(i):null,l?d(l):null]})]})},T0=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],$0="negative_to_nan",oP=["int","float","double","numeric","number","decimal","real","long"],iP=3,lP=6,cP=4,uP=5,L0={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},dP=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},mP=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},fP=e=>{if(!e)return!1;const t=e.toLowerCase();return oP.some(n=>t.includes(n))},hP=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&T0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&T0.includes(r)?r:$0},pP=e=>{const t=L0[e]??L0[$0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},gP=e=>{const t=new Set,n=new Set,r=new Set,i=new Set;Object.entries(e).forEach(([u,d])=>{d.forEach(m=>{m.isNegative&&t.add(u),m.isZero&&n.add(u),(m.numericValue<0||m.numericValue>100)&&r.add(u),(m.numericValue<0||m.numericValue>120)&&i.add(u)})});const l=u=>Array.from(u).sort((d,m)=>d.localeCompare(m));return{negative:l(t),zeros:l(n),percentage:l(r),age:l(i)}},_P=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const i=Array.from(new Set(mt(e))).sort((x,S)=>x.localeCompare(S)),l=new Set(i),u=t.filter(x=>fP(n[x]??null)),d=new Set(u),{negative:m,zeros:y,percentage:p,age:_}=gP(r),v=new Set;u.forEach(x=>{l.has(x)||v.add(x)}),[...m,...y,...p,..._].forEach(x=>{l.has(x)||v.add(x)});const w=i.filter(x=>!d.has(x));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:Array.from(v).sort((x,S)=>x.localeCompare(S)),nonNumericSelected:w,numericColumnCount:u.length,negativeCandidates:m,zeroCandidates:y,percentageOutliers:p,ageOutliers:_}},vP=e=>{const t=e.slice(0,lP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},xd=e=>{const t=e.slice(0,cP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},yP=(e,t=iP)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([i,l])=>{const u=typeof i=="string"?i.trim():"";if(!u)return;const d=mP(l);if(d===null)return;const m=dP(String(l)),y={originalDisplay:m,numericValue:d,isNegative:d<0,isZero:Math.abs(d)<=1e-9},p=n[u]??[];p.find(_=>_.originalDisplay===m)||p.length>=t||(n[u]=[...p,y])})}),n},bP=0,xP=100,wP=0,jP=120,NP=(e,t,n,r)=>{switch(t){case"negative_to_nan":{const i=n??0;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:r!==null&&e.numericValue>r?{flagged:!0,reason:`value > ${r}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const i=n??bP,l=r??xP;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:e.numericValue>l?{flagged:!0,reason:`value > ${l}`}:{flagged:!1,reason:null}}case"age_bounds":{const i=n??wP,l=r??jP;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:e.numericValue>l?{flagged:!0,reason:`value > ${l}`}:{flagged:!1,reason:null}}case"custom_range":default:{const i=n!=null,l=r!=null;return!i&&!l?{flagged:!1,reason:null}:i&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:l&&e.numericValue>r?{flagged:!0,reason:`value > ${r}`}:{flagged:!1,reason:null}}}},SP=(e,t,n,r)=>{const{flagged:i,reason:l}=NP(e,t,n,r);return i?`${e.originalDisplay}  flagged (${l??"rule match"})`:`${e.originalDisplay}  ok`},CP=(e,t,n,r,i,l=uP)=>{if(!t.length)return[];const u=[];for(const d of t){if(u.length>=l)break;const m=e[d];!m||!m.length||u.push({column:d,values:m.map(y=>SP(y,n,r,i)),overflow:0})}return u},EP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},kP=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const r=t===null?"-":String(t),i=n===null?"":String(n);return`Custom bounds active: [${r}, ${i}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const r=t??0;return n===null?`Negative-to-missing rule overrides values below ${r}.`:`Negative-to-missing rule overrides values < ${r} or > ${n}.`}return null},MP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,minValueParameter:i,maxValueParameter:l,renderMultiSelectField:u,renderParameterField:d,columnSummary:m,modeDetails:y,sampleMap:p,selectedMode:_,minValue:v,maxValue:w})=>{if(!n&&!r&&!i&&!l)return null;const{selectedColumns:x,autoDetectionActive:S}=m,E=x.length,A=vP(m.recommendedColumns),P=xd(m.negativeCandidates),T=xd(m.zeroCandidates),j=xd(m.percentageOutliers),O=xd(m.ageOutliers),k=xd(m.nonNumericSelected),D=CP(p,x,_,v,w),$=kP(_,v,w),B=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:y.label})," rule. ",y.guidance," Example: ",y.example,"."]}),$&&a.jsx("p",{className:"canvas-modal__note",children:$}),S?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:E})," column",E===1?"":"s"," for invalid value cleanup."]}),D.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",D.map(q=>`${q.column} (${q.values.join("; ")})`).join(" | "),"."]}),P.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",P.preview.join(", "),P.remaining>0?`, ... (${P.remaining} more)`:"","."]}),T.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",T.preview.join(", "),T.remaining>0?`, ... (${T.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),O.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",O.preview.join(", "),O.remaining>0?`, ... (${O.remaining} more)`:"","."]}),A.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",A.preview.join(", "),A.remaining>0?`, ... (${A.remaining} more)`:"","."]}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[k.preview.join(", ")," ",k.preview.length===1?"is":"are"," not numeric-type columns.",k.remaining>0?` ${k.remaining} more column${k.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),B?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),u(n)]}),(r||i||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[r?d(r):null,i?d(i):null,l?d(l):null]})]})};let AP="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",D0=(e=21)=>{let t="",n=e|0;for(;n--;)t+=AP[Math.random()*64|0];return t};const z0=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],R0=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],Fg=[{value:"token_sort_ratio",label:"Token Sort  Same words, ignore order",description:"Split into words, sort alphabetically, then compare. Great when the same words appear in different order."},{value:"token_set_ratio",label:"Token Set  Unique words, ignore extras",description:"Focus on overlapping unique words and down-weight extras. Best when one string has additional words."},{value:"ratio",label:"Character Ratio  Raw string similarity",description:"Compare characters in order using edit distance. Sensitive to spelling differences."}],Rf=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],OP=new Set(Rf.map(e=>e.value)),kc=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],wd="UTC",Ff=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Ff(e.split(",")):[]:[],F0=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(r=>{const i=Number(r);Number.isFinite(i)&&n.push(i)}),n}if(typeof e=="string")return F0(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},Ig=e=>{const t=Number(e);return Number.isFinite(t)?t:null},I0=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},PP=(e,t)=>{var r,i,l,u,d;if(typeof t!="string")return((r=kc.find(m=>m.value===e))==null?void 0:r.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((l=z0.find(m=>m.value===n))==null?void 0:l.value)??"add":e==="stat"?((u=R0.find(m=>m.value===n))==null?void 0:u.value)??"mean":e==="similarity"?((d=Fg.find(m=>m.value===n))==null?void 0:d.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((i=kc.find(m=>m.value===e))==null?void 0:i.defaultMethod)??""},TP=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},$P=e=>{const t=Ff(e);return t.length?t.filter(n=>OP.has(n)):["year","month","day"]},LP=e=>typeof e!="string"?wd:e.trim()||wd,B0=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,r)=>{if(!n||typeof n!="object")return;const i=n,l=TP(i.operation_type??i.type),u=i.operation_id??i.id??`feature_math_${r+1}`,d=typeof u=="string"&&u.trim()?u.trim():`feature_math_${r+1}`,m=PP(l,i.method),y=Ff(i.input_columns??i.inputs??i.inputColumns),p=Ff(i.secondary_columns??i.denominator??i.secondaryColumns),_=F0(i.constants),v=typeof i.output_column=="string"?i.output_column.trim():"",w=typeof i.output_prefix=="string"?i.output_prefix.trim():"",x=l==="datetime_extract"?$P(i.datetime_features):[],S=l==="datetime_extract"?LP(i.timezone):wd,E=Ig(i.fillna),A=(()=>{const k=Ig(i.round??i.round_digits);return Number.isInteger(k??NaN),k})(),P=Ig(i.epsilon),T=l==="similarity"?I0(i.normalize,!1):!1,j=i.allow_overwrite===void 0?null:I0(i.allow_overwrite,!1),O=typeof i.description=="string"?i.description:void 0;t.push({id:d,type:l,method:m,inputColumns:y,secondaryColumns:p,constants:_,outputColumn:v,outputPrefix:w,datetimeFeatures:x,timezone:S,fillna:E,roundDigits:A,normalize:T,epsilon:P,allowOverwrite:j,description:O})}),t},DP=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||wd):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},zP=e=>e.map(t=>DP(t)),RP={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},U0=(e,t)=>{var i;const n=RP[e]??{};let r=`math_${e}_${D0(6)}`;for(;t.has(r);)r=`math_${e}_${D0(6)}`;return{id:r,type:e,method:n.method??((i=kc.find(l=>l.value===e))==null?void 0:i.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:wd,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},FP=(e,t)=>{const n=new Map;return t==null||t.forEach(r=>{r.operations.forEach(i=>{n.has(i.operation_id)||n.set(i.operation_id,i)})}),e.map((r,i)=>{const l=n.get(r.id),u=`${i+1}. ${r.type.replace("_"," ")}${r.method?`  ${r.method}`:""}`;return{id:r.id,label:u,status:l==null?void 0:l.status,message:(l==null?void 0:l.message)??void 0,outputColumns:(l==null?void 0:l.output_columns)??[]}})},q0=e=>e==="arithmetic"?z0:e==="stat"?R0:e==="similarity"?Fg:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],IP=e=>{const t=Fg.find(n=>n.value===e);return t!=null&&t.description?t.description:"Compare the input text columns using the selected similarity technique."},BP={applied:"Applied",skipped:"Skipped",failed:"Failed"},UP={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},qP=new Set(Rf.map(e=>e.value)),HP=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),r=e.length-n.length;return r>0?`${n.join(", ")}  (${r} more)`:n.join(", ")},H0=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],VP=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],WP=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",KP=({index:e,total:t,operation:n,summary:r,availableColumns:i,isCollapsed:l,onToggleCollapsed:u,onDuplicate:d,onRemove:m,onReorder:y,onChange:p})=>{var pe;const _=f.useMemo(()=>q0(n.type),[n.type]),v=f.useMemo(()=>{var le;return((le=kc.find(ge=>ge.value===n.type))==null?void 0:le.label)??n.type},[n.type]),w=f.useMemo(()=>{var le;return((le=_.find(ge=>ge.value===n.method))==null?void 0:le.label)??n.method},[_,n.method]),x=f.useMemo(()=>n.type==="similarity"?IP(n.method):"",[n.method,n.type]),[S,E]=f.useState(n.inputColumns.join(", ")),[A,P]=f.useState(n.secondaryColumns.join(", ")),[T,j]=f.useState(n.constants.join(", "));f.useEffect(()=>{E(n.inputColumns.join(", "))},[n.inputColumns]),f.useEffect(()=>{P(n.secondaryColumns.join(", "))},[n.secondaryColumns]),f.useEffect(()=>{j(n.constants.join(", "))},[n.constants]);const O=()=>{p(n.id,{inputColumns:H0(S)})},k=()=>{p(n.id,{secondaryColumns:H0(A)})},D=()=>{p(n.id,{constants:VP(T)})},$=`feature-math-toggle-${n.id}`,B=`feature-math-body-${n.id}`,q=`feature-math-input-columns-${n.id}`,K=`feature-math-secondary-columns-${n.id}`,ne=r==null?void 0:r.status,ue=ne?a.jsx("span",{className:`canvas-cast__chip ${UP[ne]??""}`,style:{marginLeft:"0.5rem"},children:BP[ne]}):null,z=r!=null&&r.message?r.message.trim():"",X=WP(ne),Y=(pe=r==null?void 0:r.outputColumns)!=null&&pe.length?r.outputColumns.join(", "):"",W=HP(n.inputColumns),F=n.type==="ratio"||n.type==="similarity",te=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",U=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",H=n.type==="similarity",Q=n.type==="datetime_extract",ee=n.type==="stat"||n.type==="datetime_extract",G=f.useMemo(()=>{if(!i.length)return"";const le=i.slice(0,6),ge=i.length-le.length;return ge>0?`${le.join(", ")}  (${ge} more)`:le.join(", ")},[i]),V=le=>{if(!le||!qP.has(le))return;const ge=new Set(n.datetimeFeatures);ge.has(le)?ge.delete(le):ge.add(le),p(n.id,{datetimeFeatures:Array.from(ge)})},Z=le=>ge=>{const He=ge.target.value;if(He===""){p(n.id,{[le]:null});return}const lt=Number(He);Number.isFinite(lt)&&(le==="roundDigits"?p(n.id,{roundDigits:Math.round(lt)}):le==="fillna"?p(n.id,{fillna:lt}):p(n.id,{epsilon:lt}))},de=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:$,className:"canvas-imputer__card-toggle",onClick:()=>u(n.id),"aria-expanded":!l,"aria-controls":B,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${l?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[v,w?`  ${w}`:"",n.outputColumn?`   ${n.outputColumn}`:"",ue]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",W]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>m(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!l&&a.jsxs("div",{className:"canvas-imputer__card-body",id:B,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>d(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>y(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>y(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),z&&a.jsx("p",{className:X,children:z}),Y&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",Y]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:le=>p(n.id,{type:le.target.value}),children:kc.map(le=>a.jsx("option",{value:le.value,children:le.label},le.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:le=>p(n.id,{method:le.target.value}),children:_.map(le=>a.jsx("option",{value:le.value,children:le.label},le.value))})]}),n.type==="similarity"&&x&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:x}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:S,onChange:le=>E(le.target.value),onBlur:O,onKeyDown:le=>{le.key==="Enter"&&(le.preventDefault(),O())},placeholder:"col_a, col_b",list:q}),a.jsx("datalist",{id:q,children:i.map(le=>a.jsx("option",{value:le},`${n.id}-input-option-${le}`))}),G&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",G]})]}),F&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:A,onChange:le=>P(le.target.value),onBlur:k,onKeyDown:le=>{le.key==="Enter"&&(le.preventDefault(),k())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:K}),a.jsx("datalist",{id:K,children:i.map(le=>a.jsx("option",{value:le},`${n.id}-secondary-option-${le}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),te&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:T,onChange:le=>j(le.target.value),onBlur:D,onKeyDown:le=>{le.key==="Enter"&&(le.preventDefault(),D())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:le=>p(n.id,{outputColumn:le.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),ee&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:le=>p(n.id,{outputPrefix:le.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:Z("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:Z("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:Z("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),H&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:le=>p(n.id,{normalize:le.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),Q&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:Rf.map(le=>{const ge=`feature-math-${n.id}-datetime-${le.value}`,He=n.datetimeFeatures.includes(le.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:ge,children:[a.jsx("input",{id:ge,type:"checkbox",checked:He,onChange:()=>V(le.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:le.label})]},le.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:le=>p(n.id,{timezone:le.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:de,onChange:le=>{const ge=le.target.value;ge==="inherit"?p(n.id,{allowOverwrite:null}):p(n.id,{allowOverwrite:ge==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},YP=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:r,onAddOperation:i,onDuplicateOperation:l,onRemoveOperation:u,onReorderOperation:d,onOperationChange:m,availableColumns:y,signals:p,previewStatus:_,errorHandlingParameter:v,allowOverwriteParameter:w,defaultTimezoneParameter:x,epsilonParameter:S,renderParameterField:E,canResetNode:A=!1,onResetNode:P})=>{const[T,j]=f.useState("arithmetic"),O=f.useMemo(()=>{const q=new Map;return t.forEach(K=>{q.set(K.id,K)}),q},[t]),k=f.useMemo(()=>p.length?p[p.length-1]:null,[p]),D=(k==null?void 0:k.warnings)??[],$=k&&k.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",B=()=>{i(T)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("select",{value:T,onChange:q=>j(q.target.value),children:kc.map(q=>a.jsx("option",{value:q.value,children:q.label},q.value))}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:B,children:"Add operation"}),A&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:P,disabled:!P,children:"Reset node"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),_==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),k&&a.jsxs("p",{className:$,children:["Preview applied ",k.applied_operations," of ",k.total_operations," operation",k.total_operations===1?"":"s"," (",k.skipped_operations," skipped, ",k.failed_operations," failed)."]}),D.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:D.map((q,K)=>a.jsx("li",{children:q},`feature-math-warning-${K}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((q,K)=>a.jsx(KP,{index:K,total:e.length,operation:q,summary:O.get(q.id),availableColumns:y,isCollapsed:n.has(q.id),onToggleCollapsed:r,onDuplicate:l,onRemove:u,onReorder:d,onChange:m},q.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[v&&E(v),w&&E(w),x&&E(x),S&&E(S)]})]})},QP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},GP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},V0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),XP=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:i,metadata:l,columnsParameter:u,autoDetectParameter:d,maxUniqueParameter:m,outputSuffixParameter:y,dropOriginalParameter:p,missingStrategyParameter:_,missingCodeParameter:v,selectedColumns:w,renderParameterField:x,onToggleColumn:S,onApplyRecommended:E,formatMissingPercentage:A})=>{const P=f.useMemo(()=>{if(!i.length)return[];const k=new Set;return i.forEach(D=>{D.status==="recommended"&&D.selectable&&k.add(D.column)}),Array.from(k)},[i]),T=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),j=i.length>0,O=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(P),disabled:!P.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:T}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((k,D)=>a.jsx("li",{children:k},`label-encoding-note-${D}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(k=>{const D=w.includes(k.column),$=QP[k.status],B=GP[k.status]??"canvas-cast__chip--muted",q=k.sample_values.length?k.sample_values.join(", "):"",K=k.unique_count!==void 0&&k.unique_count!==null?`${V0(k.unique_count)} (${V0(k.unique_percentage)}%)`:"",ne=A(k.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:k.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[k.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",k.dtype]}),k.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:k.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",q]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:k.reason})]})}),a.jsx("td",{children:K}),a.jsx("td",{children:ne}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${B}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:D,onChange:()=>S(k.column),disabled:!k.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:k.selectable?D?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${k.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&x(d),m&&x(m),y&&x(y),p&&x(p),_&&x(_),v&&x(v)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(u)]})]})},JP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},ZP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},W0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),eT=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:i,metadata:l,columnsParameter:u,targetColumnParameter:d,autoDetectParameter:m,maxCategoriesParameter:y,outputSuffixParameter:p,dropOriginalParameter:_,smoothingParameter:v,encodeMissingParameter:w,handleUnknownParameter:x,selectedColumns:S,renderParameterField:E,onToggleColumn:A,onApplyRecommended:P,formatMissingPercentage:T})=>{const j=f.useMemo(()=>{if(!i.length)return[];const $=new Set;return i.forEach(B=>{B.status==="recommended"&&B.selectable&&$.add(B.column)}),Array.from($)},[i]),O=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),k=i.length>0,D=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>P(j),disabled:!j.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:O}),!d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map(($,B)=>a.jsx("li",{children:$},`target-encoding-note-${B}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!k&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&k&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map($=>{const B=S.includes($.column),q=JP[$.status],K=ZP[$.status]??"canvas-cast__chip--muted",ne=$.sample_values.length?$.sample_values.join(", "):"",ue=$.unique_count!==void 0&&$.unique_count!==null?`${W0($.unique_count)} (${W0($.unique_percentage)}%)`:"",z=T($.missing_percentage),X=$.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:$.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[$.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",$.dtype]}),$.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:$.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",ne]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:$.reason})]})}),a.jsx("td",{children:ue}),a.jsx("td",{children:z}),a.jsx("td",{children:X}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${K}`,children:q})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:B,onChange:()=>A($.column),disabled:!$.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:$.selectable?B?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${$.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&E(d),m&&E(m),y&&E(y),p&&E(p),_&&E(_),v&&E(v),w&&E(w),x&&E(x)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),E(u)]})]})},tT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},nT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},K0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),sT=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:i,metadata:l,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,bucketsParameter:y,outputSuffixParameter:p,dropOriginalParameter:_,encodeMissingParameter:v,selectedColumns:w,renderParameterField:x,onToggleColumn:S,onApplyRecommended:E,canResetNode:A=!1,onResetNode:P,formatMissingPercentage:T})=>{const j=f.useMemo(()=>{if(!i.length)return[];const B=new Set;return i.forEach(q=>{q.status==="recommended"&&q.selectable&&B.add(q.column)}),Array.from(B)},[i]),O=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),k=i.length>0,D=l.suggestedBucketDefault>0?`Default bucket suggestion: ${l.suggestedBucketDefault.toLocaleString()}.`:null,$=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(j),disabled:!j.length,children:"Add recommended"}),A&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:P,disabled:!P,children:"Reset node"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:O}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:D}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((B,q)=>a.jsx("li",{children:B},`hash-encoding-note-${q}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!k&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&k&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(B=>{const q=w.includes(B.column),K=tT[B.status],ne=nT[B.status]??"canvas-cast__chip--muted",ue=B.sample_values.length?B.sample_values.join(", "):"",z=B.unique_count!==void 0&&B.unique_count!==null?`${K0(B.unique_count)} (${K0(B.unique_percentage)}%)`:"",X=T(B.missing_percentage),Y=B.recommended_bucket_count?B.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:B.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[B.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",B.dtype]}),B.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:B.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",ue]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:B.reason})]})}),a.jsx("td",{children:z}),a.jsx("td",{children:X}),a.jsx("td",{children:Y}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${ne}`,children:K})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:q,onChange:()=>S(B.column),disabled:!B.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:B.selectable?q?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${B.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&x(d),m&&x(m),y&&x(y),p&&x(p),_&&x(_),v&&x(v)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(u)]})]})},rT=({columnsParameter:e,autoDetectParameter:t,degreeParameter:n,includeBiasParameter:r,interactionOnlyParameter:i,includeInputFeaturesParameter:l,outputPrefixParameter:u,renderParameterField:d,signal:m,canResetNode:y=!1,onResetNode:p})=>{const _=f.useMemo(()=>[e,t,n,r,i,l,u].filter(P=>!!P),[e,t,n,r,i,l,u]),v=(m==null?void 0:m.generated_features)??[],w=(m==null?void 0:m.skipped_columns)??[],x=(m==null?void 0:m.filled_columns)??{},S=(m==null?void 0:m.notes)??[],E=(m==null?void 0:m.feature_count)??0,A=f.useMemo(()=>{const P=Object.entries(x);return P.length?P.map(([T,j])=>`${T} (${j.toLocaleString()} missing)`).join(", "):null},[x]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Polynomial feature settings"}),y&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:p,disabled:!p,children:"Reset node"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),_.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:_.map(P=>d(P))}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",w.join(", "),"."]}),A&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",A," before generating features."]}),E>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:v.map(P=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:P.column}),a.jsx("td",{children:P.expression||(P.terms.length?P.terms.join("  "):"1")}),a.jsx("td",{children:P.degree})]},`poly-feature-${P.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),S.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:S.map((P,T)=>a.jsx("li",{children:P},`polynomial-note-${T}`))})]})},Y0=e=>!!e,jd=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},aT=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},Q0=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),r=e.length-n.length;return r>0?`${n.join(", ")}  (${r} more)`:n.join(", ")},oT=({columnsParameter:e,autoDetectParameter:t,targetColumnParameter:n,methodParameter:r,scoreFuncParameter:i,problemTypeParameter:l,kParameter:u,percentileParameter:d,alphaParameter:m,thresholdParameter:y,modeParameter:p,estimatorParameter:_,stepParameter:v,minFeaturesParameter:w,maxFeaturesParameter:x,dropUnselectedParameter:S,renderParameterField:E,signal:A,canResetNode:P=!1,onResetNode:T})=>{const j=f.useMemo(()=>[e,t,n,r,i,l].filter(Y0),[e,t,n,r,i,l]),O=f.useMemo(()=>[u,d,m,y,p,_,v,w,x,S].filter(Y0),[u,d,m,y,p,_,v,w,x,S]),k=(A==null?void 0:A.configured_columns)??[],D=(A==null?void 0:A.evaluated_columns)??[],$=(A==null?void 0:A.selected_columns)??[],B=(A==null?void 0:A.dropped_columns)??[],q=(A==null?void 0:A.feature_summaries)??[],K=(A==null?void 0:A.notes)??[],ne=(A==null?void 0:A.drop_unselected)??!1,ue=f.useMemo(()=>{if(!D.length&&!k.length)return null;if(D.length===k.length)return`Evaluated ${D.length.toLocaleString()} column(s).`;if(!k.length)return`Evaluated ${D.length.toLocaleString()} column(s) via auto-detect.`;const W=Math.max(D.length-k.length,0);return W>0?`Evaluated ${D.length.toLocaleString()} column(s) (${W.toLocaleString()} auto-detected).`:`Evaluated ${D.length.toLocaleString()} of ${k.length.toLocaleString()} configured column(s).`},[k,D]),z=f.useMemo(()=>{if(!A)return null;const W=[];return A.method&&W.push(`Method: ${A.method}`),A.score_func&&W.push(`Score: ${A.score_func}`),A.estimator&&W.push(`Estimator: ${A.estimator}`),A.problem_type&&A.problem_type!=="auto"&&W.push(`Problem: ${A.problem_type}`),A.target_column&&W.push(`Target: ${A.target_column}`),typeof A.k=="number"&&Number.isFinite(A.k)&&W.push(`k = ${A.k.toLocaleString()}`),typeof A.percentile=="number"&&Number.isFinite(A.percentile)&&W.push(`percentile = ${jd(A.percentile,2)}`),typeof A.alpha=="number"&&Number.isFinite(A.alpha)&&W.push(`alpha = ${jd(A.alpha,4)}`),A.threshold!==null&&A.threshold!==void 0&&Number.isFinite(A.threshold)&&W.push(`threshold = ${jd(A.threshold,4)}`),A.auto_detect&&W.push("Auto-detect enabled"),W.length?W.join("  "):null},[A]),X=f.useMemo(()=>Q0($),[$]),Y=f.useMemo(()=>Q0(B),[B]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature selection settings"}),P&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:T,disabled:!T,children:"Reset node"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:z}),ue&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:ue}),j.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:j.map(W=>E(W))}),O.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:O.map(W=>E(W))}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:ne?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),$.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",$.length.toLocaleString()," column(s): ",X]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),B.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",B.length.toLocaleString()," column(s): ",Y]}),q.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:q.map(W=>{const F=["canvas-cast__row"];return W.selected||F.push("canvas-cast__row--muted"),a.jsxs("tr",{className:F.join(" "),children:[a.jsx("th",{scope:"row",children:W.column}),a.jsx("td",{children:jd(W.score)}),a.jsx("td",{children:aT(W.p_value)}),a.jsx("td",{children:W.rank??""}),a.jsx("td",{children:jd(W.importance,4)}),a.jsx("td",{children:W.selected?"Selected":"Dropped"}),a.jsx("td",{children:W.note??""})]},`feature-selection-summary-${W.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),K.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:K.map((W,F)=>a.jsx("li",{children:W},`feature-selection-note-${F}`))})]})},iT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},lT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},G0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),cT=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:i,metadata:l,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,outputSuffixParameter:y,dropOriginalParameter:p,encodeMissingParameter:_,handleUnknownParameter:v,unknownValueParameter:w,selectedColumns:x,renderParameterField:S,onToggleColumn:E,onApplyRecommended:A,formatMissingPercentage:P})=>{const T=f.useMemo(()=>{if(!i.length)return[];const D=new Set;return i.forEach($=>{$.status==="recommended"&&$.selectable&&D.add($.column)}),Array.from(D)},[i]),j=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),O=i.length>0,k=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>A(T),disabled:!T.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),j&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:j}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((D,$)=>a.jsx("li",{children:D},`ordinal-encoding-note-${$}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!O&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&O&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(D=>{const $=x.includes(D.column),B=iT[D.status],q=lT[D.status]??"canvas-cast__chip--muted",K=D.sample_values.length?D.sample_values.join(", "):"",ne=D.unique_count!==void 0&&D.unique_count!==null?`${G0(D.unique_count)} (${G0(D.unique_percentage)}%)`:"",ue=P(D.missing_percentage),z=D.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:D.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[D.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",D.dtype]}),D.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:D.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",K]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:D.reason})]})}),a.jsx("td",{children:ne}),a.jsx("td",{children:ue}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${q}`,children:B})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>E(D.column),disabled:!D.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:D.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${D.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&S(d),m&&S(m),y&&S(y),p&&S(p),_&&S(_),v&&S(v),w&&S(w)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),S(u)]})]})},uT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},dT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},X0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),mT=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:i,metadata:l,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,dropFirstParameter:y,includeMissingParameter:p,dropOriginalParameter:_,prefixSeparatorParameter:v,selectedColumns:w,renderParameterField:x,onToggleColumn:S,onApplyRecommended:E,formatMissingPercentage:A})=>{const P=f.useMemo(()=>{if(!i.length)return[];const k=new Set;return i.forEach(D=>{D.status==="recommended"&&D.selectable&&k.add(D.column)}),Array.from(k)},[i]),T=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),j=i.length>0,O=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(P),disabled:!P.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:T}),l.autoDetectDefault&&d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l.cautionedCount," column",l.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((k,D)=>a.jsx("li",{children:k},`dummy-note-${D}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(k=>{const D=w.includes(k.column),$=uT[k.status],B=dT[k.status]??"canvas-cast__chip--muted",q=k.sample_values.length?k.sample_values.join(", "):"",K=k.unique_count!==void 0&&k.unique_count!==null?`${X0(k.unique_count)} (${X0(k.unique_percentage)}%)`:"",ne=A(k.missing_percentage),ue=k.estimated_dummy_columns?k.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:k.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[k.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",k.dtype]}),k.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:k.text_category}),k.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",q]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:k.reason})]})}),a.jsx("td",{children:K}),a.jsx("td",{children:ne}),a.jsx("td",{children:ue}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${B}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:D,onChange:()=>S(k.column),disabled:!k.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:k.selectable?D?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${k.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&x(d),m&&x(m),y&&x(y),p&&x(p),_&&x(_),v&&x(v)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(u)]})]})},fT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},hT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},J0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),pT=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:i,metadata:l,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,dropFirstParameter:y,includeMissingParameter:p,dropOriginalParameter:_,prefixSeparatorParameter:v,selectedColumns:w,renderParameterField:x,onToggleColumn:S,onApplyRecommended:E,formatMissingPercentage:A})=>{const P=f.useMemo(()=>{if(!i.length)return[];const k=new Set;return i.forEach(D=>{D.status==="recommended"&&D.selectable&&k.add(D.column)}),Array.from(k)},[i]),T=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),j=i.length>0,O=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(P),disabled:!P.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:T}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l.cautionedCount," column",l.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((k,D)=>a.jsx("li",{children:k},`one-hot-note-${D}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(k=>{const D=w.includes(k.column),$=fT[k.status],B=hT[k.status]??"canvas-cast__chip--muted",q=k.sample_values.length?k.sample_values.join(", "):"",K=k.unique_count!==void 0&&k.unique_count!==null?`${J0(k.unique_count)} (${J0(k.unique_percentage)}%)`:"",ne=A(k.missing_percentage),ue=k.estimated_dummy_columns?k.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:k.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[k.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",k.dtype]}),k.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:k.text_category}),k.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",q]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:k.reason})]})}),a.jsx("td",{children:K}),a.jsx("td",{children:ne}),a.jsx("td",{children:ue}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${B}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:D,onChange:()=>S(k.column),disabled:!k.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:k.selectable?D?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${k.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&x(d),m&&x(m),y&&x(y),p&&x(p),_&&x(_),v&&x(v)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(u)]})]})},Z0={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},gT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},ew=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},_T=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(r=>r&&r.split===t)??null:null,Bg=(e,t)=>{const n=_T(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const r=Z0[n.action]??n.action,i=ew(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:r}),i&&a.jsx("span",{className:"canvas-cast__muted",children:i})]})},vT=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(r=>r&&!["train","test","validation"].includes(r.split));return t.length&&t.map(r=>{const i=r.label||r.split,l=Z0[r.action]??r.action,u=ew(r.rows??null);return u?`${i}: ${l} (${u})`:`${i}: ${l}`}).join("; ")||null},yT=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,bT=({signal:e,previewStatus:t,hasSource:n,hasReachableSource:r,onRefreshPreview:i})=>{const l=f.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),u=(e==null?void 0:e.total_transformers)??l.length,d=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],m=t==="loading",y=u?`Tracking ${u.toLocaleString()} transformer${u===1?"":"s"}.`:null,p=m||!n||!r;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:p,children:m?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),y&&a.jsx("p",{className:"canvas-modal__note",children:y}),!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),n&&!r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),d.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:d.map((_,v)=>a.jsx("li",{children:_},`transformer-audit-note-${v}`))}),m&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!m&&t==="error"&&n&&r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!m&&n&&r&&!l.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!m&&l.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:l.map((_,v)=>{const w=_.storage_key??`${_.transformer_name}-${_.column_name??"all"}-${v}`,x=vT(_),S=_.source_node_label||_.source_node_id||"",E=gT(_.updated_at??_.created_at??null),A=_.column_name??"",P=yT(_);return a.jsxs(Ae.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:S})})}),a.jsx("td",{children:_.transformer_name}),a.jsx("td",{children:A}),a.jsx("td",{children:P||""}),a.jsx("td",{children:Bg(_,"train")}),a.jsx("td",{children:Bg(_,"test")}),a.jsx("td",{children:Bg(_,"validation")}),a.jsx("td",{children:E})]}),x&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",x]})})})]},w)})})]})})]})},Ug=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",xT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},wT=(e,t)=>{if(!e.length)return null;const n=e.filter(r=>!(r!=null&&r.node_id)||r.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},jT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:r,onRefreshPreview:i,config:l,targetColumnParameter:u,renderParameterField:d,formatMetricValue:m,formatMissingPercentage:y,canResetNode:p,onResetNode:_})=>{var V,Z,de,pe;const v=r.data,w=r.status,x=Array.isArray(v==null?void 0:v.applied_steps)?v.applied_steps:[],S=Array.isArray(v==null?void 0:v.columns)?v==null?void 0:v.columns:[],E=Array.isArray((V=v==null?void 0:v.signals)==null?void 0:V.feature_target_split)?(Z=v==null?void 0:v.signals)==null?void 0:Z.feature_target_split:[],A=wT(E,e),P=(l==null?void 0:l.targetColumn)??"",T=(A==null?void 0:A.target_column)??P,j=(l==null?void 0:l.featureColumns)??[],O=f.useMemo(()=>Array.isArray(v==null?void 0:v.column_stats)?v==null?void 0:v.column_stats:[],[v==null?void 0:v.column_stats]),k=f.useMemo(()=>{const le=new Map;return O.forEach(ge=>{ge!=null&&ge.name&&le.set(ge.name,ge)}),le},[O]),D=f.useMemo(()=>{var le;return(le=A==null?void 0:A.feature_columns)!=null&&le.length?A.feature_columns:j.length?j:T?S.filter(ge=>ge!==T):S.slice()},[A==null?void 0:A.feature_columns,j,S,T]),$=(A==null?void 0:A.auto_included_columns)??[],B=(A==null?void 0:A.missing_feature_columns)??[],q=(A==null?void 0:A.excluded_columns)??[],K=(A==null?void 0:A.target_missing_count)??0,ne=typeof(A==null?void 0:A.target_missing_percentage)=="number"?A.target_missing_percentage:null,ue=(A==null?void 0:A.target_dtype)??(T?((de=k.get(T))==null?void 0:de.dtype)??null:null),z=typeof((pe=v==null?void 0:v.metrics)==null?void 0:pe.row_count)=="number"?v.metrics.row_count:null,X=D.length,Y=$.length,W=q.length,F=B.length,te=f.useMemo(()=>xT(x),[x]),U=f.useMemo(()=>{const le=[];if(le.push({label:"Target column",value:T||"Not set"}),le.push({label:"Feature columns",value:m(X)}),z!==null&&le.push({label:"Preview rows",value:m(z)}),Y&&le.push({label:"Auto-selected features",value:m(Y)}),F&&le.push({label:"Configured features missing",value:m(F)}),W&&le.push({label:"Excluded columns",value:m(W)}),K){const ge=m(K),He=ne!==null?y(ne):null;le.push({label:"Target missing values",value:He?`${ge} (${He})`:ge})}return le},[Y,W,X,m,y,F,z,T,K,ne]),H=f.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),Q=f.useMemo(()=>!t||!n?null:w==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,w,t]),ee=f.useMemo(()=>T?w==="success"&&T&&!S.includes(T)?`Target column "${T}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[S,w,T]),G=!!t&&n&&w!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[p&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:_,disabled:!_,children:"Reset node"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:!G,children:w==="loading"?"Refreshing...":"Refresh preview"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:H}),r.error&&w==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r.error}),Q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:Q}),ee&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:ee}),F>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",Ug(B),"."]}),W>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",Ug(q),"."]}),Y>0&&j.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",Ug($),"."]}),te&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:te}),U.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:U.map(le=>a.jsxs("li",{children:[le.label,": ",a.jsx("strong",{children:le.value})]},`feature-target-summary-${le.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:u&&d(u)}),w==="success"&&X===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),T&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",ue?a.jsx("strong",{children:ue}):a.jsx("span",{children:"Unknown"}),K?` - Missing rows flagged for review: ${m(K)}.`:""]})]})},NT=(e,t)=>{if(!e.length)return null;const n=e.filter(r=>!(r!=null&&r.node_id)||r.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},io=e=>`${(e*100).toFixed(1)}%`,ST=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:r,onRefreshPreview:i,config:l,parameters:u,renderParameterField:d,formatMetricValue:m,canResetNode:y,onResetNode:p})=>{var ne,ue;const _=r.data,v=r.status,w=Array.isArray((ne=_==null?void 0:_.signals)==null?void 0:ne.train_test_split)?(ue=_==null?void 0:_.signals)==null?void 0:ue.train_test_split:[],x=NT(w,e),S=(l==null?void 0:l.test_size)??.2,E=(l==null?void 0:l.validation_size)??0,A=l==null?void 0:l.random_state;l==null||l.shuffle;const P=(l==null?void 0:l.stratify)??!1,T=(l==null?void 0:l.target_column)??"",j=E>0,O=f.useMemo(()=>x?{trainSize:x.train_size??0,validationSize:x.validation_size??0,testSize:x.test_size??0,totalSize:x.total_size??0,trainRatio:x.train_size&&x.total_size?x.train_size/x.total_size:0,validationRatio:x.validation_ratio??0,testRatio:x.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-S-E,validationRatio:E,testRatio:S},[x,S,E]),k=u.find(z=>z.name==="test_size"),D=u.find(z=>z.name==="validation_size"),$=u.find(z=>z.name==="random_state"),B=u.find(z=>z.name==="shuffle"),q=u.find(z=>z.name==="stratify"),K=u.find(z=>z.name==="target_column");return a.jsxs("div",{className:"node-settings__section",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Train/Test Split Configuration"}),y&&p&&a.jsx("button",{type:"button",onClick:p,className:"node-settings__reset-button",title:"Reset node configuration",children:"Reset"})]}),a.jsxs("div",{className:"node-settings__field-group",children:[k&&d(k),D&&d(D),$&&d($),B&&d(B),q&&d(q),P&&K&&d(K)]}),v==="success"&&x&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:io(O.trainRatio)},title:`Training: ${O.trainSize} rows (${io(O.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),j&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:io(O.validationRatio)},title:`Validation: ${O.validationSize} rows (${io(O.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:io(O.testRatio)},title:`Test: ${O.testSize} rows (${io(O.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:m(O.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[m(O.trainSize,0)," (",io(O.trainRatio),")"]})]}),j&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[m(O.validationSize,0)," (",io(O.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[m(O.testSize,0)," (",io(O.testRatio),")"]})]}),P&&T&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:T})]}),A!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:A})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",children:[a.jsx("span",{className:"node-settings__warning-icon",children:""}),"Connect this node to a data source to configure the split."]}),v==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),v==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},CT={classification:"Classification",regression:"Regression"},ET=e=>e==="numeric"||e==="integer",kT=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},qg=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,MT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},AT=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:r,config:i,targetColumnParameter:l,problemTypeParameter:u,renderParameterField:d,formatMetricValue:m,formatMissingPercentage:y,schemaColumns:p})=>{var Q;const _=n.data,v=n.status,w=Array.isArray(_==null?void 0:_.applied_steps)?_.applied_steps:[],x=Array.isArray(_==null?void 0:_.column_stats)?_.column_stats:[],S=(_==null?void 0:_.metrics)??null,E=f.useMemo(()=>{var ee;return p.length?p:Array.isArray((ee=_==null?void 0:_.schema)==null?void 0:ee.columns)?_.schema.columns:[]},[(Q=_==null?void 0:_.schema)==null?void 0:Q.columns,p]),A=f.useMemo(()=>{const ee=new Map;return E.forEach(G=>{G!=null&&G.name&&ee.set(G.name,G)}),ee},[E]),P=(i==null?void 0:i.targetColumn)??"",T=(i==null?void 0:i.problemType)??"classification",j=P?x.find(ee=>(ee==null?void 0:ee.name)===P)??null:null;P&&A.get(P);const O=f.useMemo(()=>{const ee=new Set;return x.forEach(G=>{G!=null&&G.name&&G.name!==P&&ee.add(G.name)}),E.forEach(G=>{G!=null&&G.name&&G.name!==P&&ee.add(G.name)}),Array.from(ee).sort()},[x,E,P]),k=f.useMemo(()=>O.filter(ee=>{const G=A.get(ee);if(G&&ET(G.logical_family))return!0;const V=x.find(Z=>Z.name===ee);return kT((V==null?void 0:V.dtype)??null)}),[x,O,A]),D=f.useMemo(()=>new Set(k),[k]),$=f.useMemo(()=>O.filter(ee=>!D.has(ee)),[O,D]),B=f.useMemo(()=>x.filter(ee=>(ee==null?void 0:ee.name)&&ee.name!==P&&(ee.missing_count??0)>0).map(ee=>ee.name),[x,P]),q=typeof(S==null?void 0:S.row_count)=="number"?S.row_count:null,K=typeof(j==null?void 0:j.distinct_count)=="number"&&Number.isFinite(j.distinct_count)?j.distinct_count:null,ne=typeof(j==null?void 0:j.missing_count)=="number"?j.missing_count:0,ue=typeof(j==null?void 0:j.missing_percentage)=="number"?j.missing_percentage:null,z=f.useMemo(()=>{const ee=[];return P?v!=="success"?ee:!j&&!O.length?(ee.push(`Target column "${P}" is not present in the preview output, and no feature columns were found.`),ee):(O.length||ee.push("Add at least one feature column in addition to the target before training."),j&&ne>0&&ee.push(`Target column includes ${ne} missing value${ne===1?"":"s"}.`),T==="classification"&&j&&(K??0)<2&&ee.push("Classification tasks require at least two distinct target classes."),T==="regression"&&k.length===0&&ee.push("Regression tasks need at least one numeric feature column."),B.length>0&&ee.push(`Feature columns with missing values: ${qg(B)}.`),q!==null&&q===0&&ee.push("Preview returned zero rows after upstream transformations."),ee):(ee.push("Set a target column to evaluate downstream modeling constraints."),ee)},[B,O.length,ne,k.length,q,v,T,P,K,j]),X=f.useMemo(()=>CT[T],[T]),Y=f.useMemo(()=>{const ee=[{label:"Problem type",value:X},{label:"Target column",value:P||"Not set"}];if(v==="success"){if(q!==null&&ee.push({label:"Preview rows",value:m(q)}),ee.push({label:"Feature columns",value:m(O.length)}),ee.push({label:"Numeric features",value:m(k.length)}),ee.push({label:"Non-numeric features",value:m($.length)}),K!==null&&ee.push({label:"Target distinct values",value:m(K)}),j){const G=m(ne),V=ue!==null?y(ue):null;ee.push({label:"Target missing values",value:V?`${G} (${V})`:G})}B.length>0&&ee.push({label:"Features with missing values",value:m(B.length)})}return ee},[X,B.length,O.length,m,y,ne,$.length,k.length,q,v,P,K,ue,j]),W=f.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),F=f.useMemo(()=>!e||!t?null:v==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,v,e]),te=f.useMemo(()=>MT(w),[w]),U=!!e&&t&&v!=="loading",H=f.useMemo(()=>!P||v!=="success"||z.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[v,z.length,P]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:r,disabled:!U,children:v==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),W&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:W}),n.error&&v==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:F}),z.map((ee,G)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:ee},`train-model-issue-${G}`)),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:H}),te&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:te}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[l&&d(l),u&&d(u)]}),Y.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Y.map(ee=>a.jsxs("li",{children:[ee.label,": ",a.jsx("strong",{children:ee.value})]},`train-model-summary-${ee.label}`))}),v==="success"&&B.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",qg(B),"."]}),v==="success"&&T==="regression"&&$.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",qg($),". Consider encoding or casting them before training regression models."]})]})},tw=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?wr(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},OT=e=>e||"Unknown",PT=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},Gs=e=>{const t=PT(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const r=Math.round(n/60);if(r===1)return"1 hour ago";if(r<24)return`${r} hours ago`;const i=Math.round(r/24);return i===1?"1 day ago":`${i} days ago`},TT={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},Mc={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},If=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([r,i])=>{t.has(r)&&(n[r]=i)}),n},$T=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([r,i])=>{t.has(r)&&(i===""||i===null||i===void 0||(n[r]=i))}),n},nw=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Nd=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},LT=e=>{if(!e)return Mc.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return Mc.regression;if(t.includes("classifier")||t.includes("classification"))return Mc.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?Mc.regression:n==="classification"?Mc.classification:Mc.fallback},DT=e=>{var l,u,d;if(!e)return null;const t=[],n=(u=(l=e==null?void 0:e.cross_validation)==null?void 0:l.metrics)==null?void 0:u.mean;nw(n)&&((d=e==null?void 0:e.cross_validation)==null?void 0:d.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const r=[e.test,e.validation,e.train];for(const m of r)nw(m)&&t.push({dataset:m,labelPrefix:""});const i=LT(e);for(const m of t)for(const y of i){const p=m.dataset[y];if(typeof p=="number"&&Number.isFinite(p))return{label:m.labelPrefix?`${m.labelPrefix}${y}`:y,value:p}}for(const m of t)for(const[y,p]of Object.entries(m.dataset))if(typeof p=="number"&&Number.isFinite(p))return{label:m.labelPrefix?`${m.labelPrefix}${y}`:y,value:p};return null},zT=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",RT=({nodeId:e,sourceId:t,graph:n,config:r,runtimeConfig:i,cvConfig:l,draftConfigState:u,renderParameterField:d,modelTypeParameter:m,modelTypeOptions:y,hyperparametersParameter:p,cvEnabledParameter:_,cvStrategyParameter:v,cvFoldsParameter:w,cvShuffleParameter:x,cvRandomStateParameter:S,cvRefitStrategyParameter:E,onSaveDraftConfig:A})=>{var Rr,aa,oa,ia;const P=fc(),[T,j]=f.useState(null),[O,k]=f.useState(null),[D,$]=f.useState(null),[B,q]=f.useState(0),[K,ne]=f.useState({}),[ue,z]=f.useState(!1),X=f.useRef(!1),[Y,W]=f.useState(null),[F,te]=f.useState(!1),[U,H]=f.useState(null),[Q,ee]=f.useState(null),G=((r==null?void 0:r.targetColumn)??"").trim(),V=(r==null?void 0:r.problemType)==="regression"?"regression":"classification",Z=((i==null?void 0:i.modelType)??"").trim(),de=(i==null?void 0:i.hyperparameters)??null,pe=(i==null?void 0:i.hyperparametersError)??null,le=!!(l!=null&&l.enabled),ge=(l==null?void 0:l.strategy)??"auto",He=typeof(l==null?void 0:l.folds)=="number"?l.folds:0,lt=!!(l!=null&&l.shuffle),Ye=(l==null?void 0:l.randomState)??null,Se=(l==null?void 0:l.refitStrategy)??"train_plus_validation",Re=f.useMemo(()=>m?y.length?{...m,options:y}:m:null,[y,m]),Ce=vr({queryKey:["model-hyperparameters",Z],queryFn:()=>Mf(Z),enabled:!!Z,staleTime:5*60*1e3}),Fe=vr({queryKey:["best-hyperparameters",Z,Y,t],queryFn:()=>kx(Z,{pipelineId:Y||void 0,datasetSourceId:t||void 0}),enabled:!!(Z&&t),staleTime:30*1e3,retry:1}),Ve=((Rr=Ce.data)==null?void 0:Rr.fields)??[],Ke=((aa=Ce.data)==null?void 0:aa.defaults)??{},tt=f.useMemo(()=>Ve.length?new Set(Ve.map(Ee=>Ee.name)):new Set,[Ve]),J=f.useMemo(()=>{if(!Z||!de||tt.size===0)return null;const Ee=If(de,tt);return Object.keys(Ee).length>0?Ee:null},[tt,de,Z]);f.useEffect(()=>{ne({}),z(!1),X.current=!1},[Z]),f.useEffect(()=>{J&&(ne(Ee=>{const Qe=Object.keys(Ee),Je=Object.keys(J);return Qe.length===Je.length&&Je.every(At=>Object.is(Ee[At],J[At]))?Ee:J}),X.current||(z(!0),X.current=!0))},[J]),f.useEffect(()=>{if(!Z||J||tt.size===0||!Ke||Object.keys(Ke).length===0)return;const Ee=If(Ke,tt);Object.keys(Ee).length!==0&&ne(Qe=>Object.keys(Qe).length>0?Qe:Ee)},[tt,J,Ke,Z]);const Pe=f.useMemo(()=>{if(tt.size===0)return null;const Ee=$T(K,tt);return Object.keys(Ee).length>0?Ee:null},[tt,K]),$e=f.useCallback(()=>{z(Ee=>{const Qe=!Ee;return Qe&&(X.current=!0),Qe})},[]),rt=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),wt=f.useMemo(()=>{if(!rt)return null;if(!u||Object.keys(u).length===0)return rt;const Ee=Nd(rt);return!Ee||!Array.isArray(Ee.nodes)||(Ee.nodes=Ee.nodes.map(Qe=>{if(!Qe||Qe.id!==e)return Qe;const Je=(Qe==null?void 0:Qe.data)??{},At={...(Je==null?void 0:Je.config)??{},...u};return{...Qe,data:{...Je,config:At,isConfigured:!0}}})),Ee},[u,rt,e]);f.useEffect(()=>{let Ee=!1;return!t||!rt?(W(null),()=>{Ee=!0}):(Ji(t,rt).then(Qe=>{Ee||W(Qe)}).catch(()=>{Ee||W(null)}),()=>{Ee=!0})},[rt,t]),f.useEffect(()=>{let Ee=!1;k(null);const Qe=wt??rt;return!t||!Qe?(j(null),()=>{Ee=!0}):(Ji(t,Qe).then(Je=>{Ee||j(Je)}).catch(Je=>{Ee||(k((Je==null?void 0:Je.message)??"Unable to compute pipeline ID"),j(null))}),()=>{Ee=!0})},[rt,wt,t]),f.useEffect(()=>{if(!T||!Y){te(!1);return}te(T!==Y)},[T,Y]);const en=f.useMemo(()=>["feature-canvas","training-jobs",t??"none",T??"pending",e],[e,T,t]),ye=f.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",T??"pending",e],[e,T,t]),we=!!(t&&e),ke=vr({queryKey:ye,queryFn:async()=>{var Qe;const Ee={datasetSourceId:t||void 0,nodeId:e,limit:5};if(T){const Je=await hd({...Ee,pipelineId:T});if((((Qe=Je==null?void 0:Je.jobs)==null?void 0:Qe.length)??0)>0)return Je}return hd(Ee)},enabled:we,retry:(Ee,Qe)=>Qe.message.includes("Sign in")?!1:Ee<2,refetchInterval:Ee=>{const Qe=Ee.state.data;return((Qe==null?void 0:Qe.jobs)??[]).some(At=>At.status==="queued"||At.status==="running")?5e3:!1}}),Oe=vr({queryKey:en,queryFn:async()=>{var Qe;const Ee={datasetSourceId:t||void 0,nodeId:e,limit:5};if(T){const Je=await fd({...Ee,pipelineId:T});if((((Qe=Je==null?void 0:Je.jobs)==null?void 0:Qe.length)??0)>0)return Je}return fd(Ee)},enabled:we,retry:(Ee,Qe)=>Qe.message.includes("Sign in")?!1:Ee<2,refetchInterval:Ee=>{const Qe=Ee.state.data;return((Qe==null?void 0:Qe.jobs)??[]).some(At=>At.status==="queued"||At.status==="running")?5e3:!1}}),{mutateAsync:Xe,isPending:Ie,error:nt}=Km({mutationFn:jx,onSuccess:Ee=>{const Qe=Array.isArray(Ee.jobs)?Ee.jobs.length:0,Je=Qe>0?Ee.jobs[0]:null;$(Je),q(Qe),P.invalidateQueries({queryKey:en})}}),xt=ke.error,Ot=ke.isLoading||ke.isFetching,Ft=((oa=ke.data)==null?void 0:oa.jobs)??[],dt=Fe.data,Tt=!!(dt!=null&&dt.available&&(dt!=null&&dt.best_params)),gt=f.useMemo(()=>{if(!Tt||!(dt!=null&&dt.best_params)||tt.size===0)return null;const Ee=If(dt.best_params,tt);return Object.keys(Ee).length?Ee:null},[tt,dt,Tt]),kt=f.useMemo(()=>{if(!Ft.length)return null;const Ee=Ft.filter(Qe=>Qe.status==="succeeded");return Ee.length?Ee.slice().sort((Qe,Je)=>{const un=Date.parse(Qe.updated_at||Qe.created_at||"0");return Date.parse(Je.updated_at||Je.created_at||"0")-un})[0]:null},[Ft]),vn=f.useMemo(()=>{if(!kt||!kt.best_params||tt.size===0)return null;const Ee=If(kt.best_params,tt);return Object.keys(Ee).length?Ee:null},[tt,kt]),Jt=gt||vn,Mn=!!(Z&&(dt!=null&&dt.available&&(dt==null?void 0:dt.model_type)===Z||kt&&kt.model_type===Z)),yn=!!!(Jt&&Mn),$t=dt!=null&&dt.available?dt:kt,Lt=$t?"finished_at"in $t?$t.finished_at:"updated_at"in $t?$t.updated_at||$t.created_at:null:null,xn=Lt?Gs(Lt):null,Ut=$t&&"run_number"in $t?$t.run_number:null,Pt=$t?"job_id"in $t?$t.job_id:"id"in $t?$t.id:null:null;f.useEffect(()=>{if(!Pt){H(null),ee(null);return}U&&Pt!==U&&ee(null)},[U,Pt]);const mn=f.useCallback(()=>{if(!kt){ee({message:"No tuning job results available to apply.",tone:"warning"});return}if(!vn){ee({message:"Latest tuning run did not produce compatible hyperparameters for this model template.",tone:"warning"});return}if(!Mn){ee({message:`Latest tuning run targeted ${kt.model_type}. Switch the model template to apply its parameters.`,tone:"warning"});return}ne(()=>Nd(Jt)),z(!0),X.current=!0,H(Pt||""),ee({message:`Applied best parameters from tuning run${Ut?` ${Ut}`:""}.`,tone:"success"})},[Jt,dt,kt,Pt,Ut,Mn]),ns=f.useMemo(()=>{if(!Q)return"rgba(148, 163, 184, 0.75)";switch(Q.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[Q]),er=f.useMemo(()=>{const Ee=[];return t||Ee.push("Select a dataset before launching training jobs."),(!rt||!rt.nodes.length)&&Ee.push("Connect this node to an upstream pipeline before training."),G||Ee.push("Set a target column in the Train model readiness section."),Z||Ee.push("Choose a model type before enqueuing training jobs."),le&&He<2&&Ee.push("Cross-validation requires at least 2 folds."),O&&Ee.push(O),pe&&Ee.push(pe),Ee},[le,He,rt,pe,Z,O,t,G]),An=((ia=Oe.data)==null?void 0:ia.jobs)??[],us=f.useMemo(()=>{if(!An.length)return An;const Ee=V==null?void 0:V.toLowerCase();return An.filter(Qe=>{if(!Ee)return!0;const Je=(()=>{var En,gn,ss,Vt;const At=typeof Qe.problem_type=="string"?Qe.problem_type:null,ds=typeof((En=Qe.metadata)==null?void 0:En.problem_type)=="string"?(gn=Qe.metadata)==null?void 0:gn.problem_type:null,tn=typeof((ss=Qe.metadata)==null?void 0:ss.resolved_problem_type)=="string"?(Vt=Qe.metadata)==null?void 0:Vt.resolved_problem_type:null;return(At||tn||ds||"").toLowerCase()})();if(Je)return Je===Ee;const un=String(Qe.model_type||"").toLowerCase();return Ee==="regression"?un.includes("regress"):Ee==="classification"?un.includes("classif"):!0})},[An,V]),Kt=Math.max(An.length-us.length,0),Qn=Oe.isLoading||Oe.isFetching,zr=Oe.error,go=er.length>0||!T||!t||!rt||Ie,tr=f.useCallback((Ee,Qe)=>{ne(Je=>({...Je,[Ee]:Qe}))},[]),Is=f.useCallback(Ee=>{var un;const Qe=K[Ee.name]??Ee.default,Je=`hyperparam-${e}-${Ee.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Je,className:"canvas-modal__parameter-label",children:[Ee.label,Ee.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:Ee.description})]}),Ee.type==="number"&&a.jsx("input",{id:Je,type:"number",className:"canvas-modal__parameter-input",value:Qe??"",onChange:At=>{const ds=At.target.value;if(ds===""&&Ee.nullable)tr(Ee.name,null);else{const tn=parseFloat(ds);isNaN(tn)||tr(Ee.name,tn)}},min:Ee.min,max:Ee.max,step:Ee.step,placeholder:Ee.nullable?"Empty = default":""}),Ee.type==="select"&&a.jsx("select",{id:Je,className:"canvas-modal__parameter-select",value:Qe??"",onChange:At=>tr(Ee.name,At.target.value),children:(un=Ee.options)==null?void 0:un.map(At=>a.jsx("option",{value:At.value,children:At.label},At.value))}),Ee.type==="boolean"&&a.jsx("input",{id:Je,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!Qe,onChange:At=>tr(Ee.name,At.target.checked)}),Ee.type==="text"&&a.jsx("input",{id:Je,type:"text",className:"canvas-modal__parameter-input",value:Qe??"",onChange:At=>tr(Ee.name,At.target.value),placeholder:Ee.nullable?"Empty = default":""})]},Ee.name)},[K,tr,e]),La=f.useCallback(async()=>{if(!T||!t||!Z)return;F&&A&&(A(),await new Promise(tn=>setTimeout(tn,100)));const Ee=wt??rt;if(!Ee)return;const Qe={};G&&(Qe.target_column=G),Qe.problem_type=V,Qe.cross_validation={enabled:le,strategy:ge,folds:He,shuffle:lt,random_state:Ye,refit_strategy:Se};const Je=Object.keys(Qe).length?Qe:void 0,un=Nd(Ee);un&&Array.isArray(un.nodes)&&(un.nodes=un.nodes.map(tn=>{if(!tn||tn.id!==e)return tn;const En=(tn==null?void 0:tn.data)??{},gn=(En==null?void 0:En.config)??{},ss=u?{...gn,...u}:gn;return{...tn,data:{...En,config:ss,isConfigured:!0}}}));const At=Z?[Z]:[],ds={dataset_source_id:t,pipeline_id:T,node_id:e,model_type:Z||void 0,model_types:At.length?At:void 0,hyperparameters:ue&&Pe?Nd(Pe):void 0,metadata:Je,job_metadata:Je,run_training:!0,graph:un??Nd(Ee),target_node_id:e};try{await Xe(ds)}catch{}},[le,He,Ye,Se,lt,ge,u,Xe,rt,wt,F,Z,e,A,T,V,Pe,ue,t,G]),Da=f.useCallback(()=>{we&&Oe.refetch()},[we,Oe]),ra=Ee=>{var fn,On,la,Fr;const Qe=DT(Ee.metrics??null),Je=Ee.updated_at?Gs(Ee.updated_at):null,un=Ee.updated_at||Ee.created_at,At=un?Je??new Date(un).toLocaleString():null,ds=TT[Ee.status]??Ee.status,tn=(Ee.problem_type||((fn=Ee.metadata)==null?void 0:fn.resolved_problem_type)||((On=Ee.metadata)==null?void 0:On.problem_type)||"").toString(),En=((la=Ee.metadata)==null?void 0:la.cross_validation)??null,gn=((Fr=Ee.metrics)==null?void 0:Fr.cross_validation)??null,ss=typeof Ee.error_message=="string"?Ee.error_message.trim():"",Vt=[];if(Vt.push(`Model ${Ee.model_type}`),tn&&Vt.push(tn.charAt(0).toUpperCase()+tn.slice(1)),En!=null&&En.enabled){const bs=String(En.strategy??"auto"),Sr=bs==="stratified_kfold"?"Stratified KFold":bs==="kfold"?"KFold":"Auto CV",xs=typeof En.folds=="number"?`${En.folds} folds`:"CV enabled";if(Vt.push(`${Sr} (${xs})`),(gn==null?void 0:gn.status)==="skipped"){const nr=String((gn==null?void 0:gn.reason)??"unknown reason").replace(/_/g," ");Vt.push(`CV skipped (${nr})`)}}else if((gn==null?void 0:gn.status)==="skipped"){const bs=String((gn==null?void 0:gn.reason)??"unknown reason").replace(/_/g," ");Vt.push(`CV skipped (${bs})`)}if(Qe&&Vt.push(`${Qe.label}: ${zT(Qe.value)}`),Ee.status==="failed"&&ss){const bs=ss.replace(/\s+/g," ");Vt.push(`Error: ${bs}`)}return At&&Vt.push(`Updated ${At}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["v",Ee.version]}),"  ",ds,Vt.length>0?`  ${Vt.join("  ")}`:""]},Ee.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Da,disabled:!we||Qn,children:Qn?"Refreshing":"Refresh jobs"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),T&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:T})]}),F&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]}),er.map((Ee,Qe)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Ee},`training-prereq-${Qe}`)),nt instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:nt.message}),zr&&!(nt instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:zr.message||"Unable to load training jobs."}),xt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:xt.message||"Unable to load tuning jobs."}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:B>1?a.jsxs("span",{children:["Queued ",B," training jobs. Latest job ",D.id," (version ",D.version,")."]}):a.jsxs("span",{children:["Training job ",D.id," queued (version ",D.version,")."]})}),Ot&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Re&&d(Re),_&&d(_),le&&a.jsxs(a.Fragment,{children:[v&&d(v),w&&d(w),x&&d(x),S&&d(S),E&&d(E)]}),Z&&Ve.length>0&&a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:ue?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),$t&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:Tt?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:Z}),Ut&&` (run ${Ut})`,xn&&`  ${xn}`]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",Ut||"N/A",xn?`  ${xn}`:"",Mn?" matches the current model template.":$t&&"model_type"in $t?` targeted ${$t.model_type}.`:kt?` targeted ${kt.model_type}.`:""]})}),Q&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:ns},children:Q.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[$t&&a.jsx("button",{type:"button",onClick:mn,disabled:yn,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:yn?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:yn?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:yn?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:yn?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:yn?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply best params"}),a.jsx("button",{type:"button",onClick:$e,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:ue?"#fff":"rgba(148, 163, 184, 0.85)",background:ue?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(15, 23, 42, 0.6)",border:ue?"none":"1px solid rgba(148, 163, 184, 0.45)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:ue?"0 4px 12px rgba(118, 75, 162, 0.25)":"none"},onMouseEnter:Ee=>{ue?Ee.currentTarget.style.boxShadow="0 6px 16px rgba(118, 75, 162, 0.35)":(Ee.currentTarget.style.borderColor="rgba(148, 163, 184, 0.65)",Ee.currentTarget.style.background="rgba(15, 23, 42, 0.8)")},onMouseLeave:Ee=>{ue?Ee.currentTarget.style.boxShadow="0 4px 12px rgba(118, 75, 162, 0.25)":(Ee.currentTarget.style.borderColor="rgba(148, 163, 184, 0.45)",Ee.currentTarget.style.background="rgba(15, 23, 42, 0.6)")},children:ue?" Advanced":"Default"})]})]})}),Z&&Ce.isLoading&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),Z&&Ce.error&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",Ce.error.message]}),Z&&ue&&Ve.length>0&&a.jsxs("div",{style:{gridColumn:"1 / -1",padding:"1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginTop:"0.5rem"},children:[a.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid rgba(102, 126, 234, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600",color:"#e2e8f0"},children:"Advanced Hyperparameters"}),a.jsxs("p",{style:{margin:"0",fontSize:"0.875rem",color:"rgba(148, 163, 184, 0.85)",lineHeight:"1.5"},children:["Configure ",Z.replace(/_/g," ")," hyperparameters. Leave empty to use recommended defaults."]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:Ve.map(Is)})]}),!Z&&p&&d(p)]}),le&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",He," folds before refitting on"," ",Se==="train_plus_validation"?"training plus validation data.":"training data only."]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:La,disabled:go,children:Ie?"Queuing":"Launch training job"})}),Qn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),Kt>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:Kt===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${Kt} training jobs use a different problem type. Switch the problem type to view them.`}),!Qn&&us.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),us.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:us.map(ra)})]})},FT=new Set(["true","1","yes","on"]),IT=new Set(["false","0","no","off"]),BT=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],sw=new Set(["true","1","yes","y","on","t"]),rw=new Set(["false","0","no","n","off","f"]),tl=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(FT.has(t))return!0;if(IT.has(t))return!1}return null},Ac=e=>{if(!(!e||typeof e!="object")){for(const t of BT)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},Hg=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},Vg=e=>Array.isArray(e)?e.map(t=>Vg(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=Vg(e[n]),t),{}):e,Sd=e=>e===void 0?"":JSON.stringify(Vg(e)),aw=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},UT=(e,t)=>{const n=[],r=_=>{n.includes(_)||n.push(_)},i=(e??"").toLowerCase();if(!t.length)return n;const l=t.filter(_=>_!=null);if(!l.length)return n;const u=l.reduce((_,v)=>{if(typeof v=="number"&&Number.isFinite(v))return _+1;if(typeof v=="string"){const w=v.trim();if(!w)return _;const x=Number(w);if(!Number.isNaN(x)&&Number.isFinite(x))return _+1}return _},0),d=l.reduce((_,v)=>{const w=String(v).trim().toLowerCase();return w&&(sw.has(w)||rw.has(w))?_+1:_},0),m=(()=>{const _=new Set;return l.forEach(v=>{_.add(String(v).trim().toLowerCase())}),_.size})(),y=u/l.length,p=d/l.length;if(i.includes("object")||i.includes("string"))return p>=.7&&r("boolean"),y>=.7&&r("float64"),m>0&&m<=20&&r("category"),n;if(i.includes("float")){const _=l.reduce((v,w)=>{if(typeof w=="number")return Number.isInteger(w)?v+1:v;if(typeof w=="string"){const x=w.trim();if(!x)return v;const S=Number(x);if(!Number.isNaN(S)&&Number.isFinite(S)&&Number.isInteger(S))return v+1}return v},0);return p>=.8&&r("boolean"),l.length>0&&_/l.length>=.9&&r("Int64"),n}return i.includes("int")&&p>=.7&&r("boolean"),n},Bf=[{value:"validation",label:"Validation",accent:"validation"},{value:"test",label:"Test",accent:"test"}],Uf={validation:0,test:1},qT=["validation","test"],Wg=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],Cd=e=>{const t=new Set(Bf.map(i=>i.value)),n=[];e.forEach(i=>{if(i&&!(i==="training"||i==="train")){if(i==="valid"||i==="val"){n.push("validation");return}t.has(i)&&n.push(i)}});const r=new Set;return n.filter(i=>r.has(i)?!1:(r.add(i),!0)).sort((i,l)=>Uf[i]-Uf[l])},HT=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},Kg=(e,t)=>{const n=tl(e);return n===null?t:n},ow=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},iw=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},VT=e=>{const t=Bf.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},WT=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},KT=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${WT(e.status)}`);const n=Gs(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},qf=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,YT=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,r])=>{typeof r=="number"&&Number.isFinite(r)&&t.push({key:n,value:r})}),t.sort((n,r)=>n.key.localeCompare(r.key)),t},lw=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},QT=({nodeId:e,sourceId:t,graph:n,config:r,setConfigState:i,renderParameterField:l,formatMetricValue:u,connectedSplitHandles:d,canResetNode:m=!1,onResetNode:y})=>{var Ye;const p=fc(),_=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),v=f.useMemo(()=>{if(!_)return[];const Se=new Map;_.nodes.forEach(Ce=>{Ce!=null&&Ce.id&&Se.set(Ce.id,Ce)});const Re=new Set;return _.edges.forEach(Ce=>{var Ve;if(!Ce||Ce.target!==e)return;const Fe=Se.get(Ce.source);((Ve=Fe==null?void 0:Fe.data)==null?void 0:Ve.catalogType)==="train_model_draft"&&Re.add(Fe.id)}),Re.size>0?Array.from(Re):_.nodes.filter(Ce=>{var Fe;return((Fe=Ce==null?void 0:Ce.data)==null?void 0:Fe.catalogType)==="train_model_draft"}).map(Ce=>Ce.id)},[_,e]),w=f.useMemo(()=>v.length?v.slice().sort().join("|"):"all",[v]),[x,S]=f.useState(null),[E,A]=f.useState(null);f.useEffect(()=>{let Se=!1;return A(null),!t||!_?(S(null),()=>{Se=!0}):(Ji(t,_).then(Re=>{Se||S(Re)}).catch(Re=>{Se||(A((Re==null?void 0:Re.message)??"Unable to compute pipeline signature."),S(null))}),()=>{Se=!0})},[_,t]);const P=f.useMemo(()=>{const Se=r==null?void 0:r.training_job_id;return typeof Se=="string"?Se.trim():typeof Se=="number"?String(Se):""},[r==null?void 0:r.training_job_id]),T=f.useMemo(()=>Cd(Wg(r==null?void 0:r.splits)),[r==null?void 0:r.splits]),j=f.useMemo(()=>T.length?T:qT,[T]);f.useEffect(()=>{d&&i(Se=>{const Re=Se??{},Ce=Cd(Wg(Re.splits)),Fe=Ce.filter(Ke=>d[Ke]!==!1);if(Fe.length===Ce.length&&Fe.every((Ke,tt)=>Ke===Ce[tt]))return Se;const Ve={...Re};return Fe.length?Ve.splits=Fe:delete Ve.splits,Ve})},[d,i]);const O=f.useMemo(()=>d?j.filter(Se=>d[Se]!==!1):j,[d,j]),k=f.useMemo(()=>d?Bf.filter(Se=>d[Se.value]===!1).map(Se=>Se.label):[],[d]),D=f.useMemo(()=>k.length?k.length===1?k[0]:`${k[0]} and ${k[1]}`:"",[k]),$=O.length>0,B=Kg(r==null?void 0:r.include_confusion,!0),q=Kg(r==null?void 0:r.include_curves,!0),K=Kg(r==null?void 0:r.include_residuals,!0),ne=ow(r==null?void 0:r.max_curve_points,500),ue=ow(r==null?void 0:r.max_scatter_points,750),z=typeof(r==null?void 0:r.last_evaluated_at)=="string"?r.last_evaluated_at:null,[X,Y]=f.useState(null),W=f.useRef(!1);f.useEffect(()=>{Y(null),W.current=!1},[P]);const F=f.useMemo(()=>["feature-canvas","model-evaluation",t??"none",x??"pending",w],[x,t,w]),te=vr({queryKey:F,queryFn:async()=>{const Se={datasetSourceId:t||void 0,limit:50},Re=new Map,Ce=[];let Fe=null;const Ve=Pe=>{Array.isArray(Pe)&&Pe.forEach($e=>{$e&&!Re.has($e.id)&&Re.set($e.id,$e)})},Ke=async Pe=>{try{const $e=await fd(Pe);return Ve($e==null?void 0:$e.jobs),$e}catch($e){return $e instanceof Error&&Ce.push($e),null}};if(x&&await Ke({...Se,pipelineId:x}),v.length&&await Promise.all(v.map(Pe=>Ke({...Se,nodeId:Pe}))),Fe=await Ke(Se),!Re.size){if(Fe)return Fe;if(Ce.length)throw Ce[0];return{jobs:[],total:0}}const tt=Array.from(Re.values());tt.sort((Pe,$e)=>iw($e.updated_at??$e.created_at)-iw(Pe.updated_at??Pe.created_at));const J=(Fe==null?void 0:Fe.total)??tt.length;return{jobs:tt,total:J}},enabled:!!t,staleTime:30*1e3,retry:(Se,Re)=>Re.message.includes("Sign in")?!1:Se<2,refetchInterval:Se=>{const Re=Se.state.data;return((Re==null?void 0:Re.jobs)??[]).some(Ve=>Ve.status==="queued"||Ve.status==="running")?5e3:!1}}),U=((Ye=te.data)==null?void 0:Ye.jobs)??[],H=f.useMemo(()=>{const Se=new Map;return U.forEach(Re=>{Se.set(Re.id,Re)}),Se},[U]),Q=f.useMemo(()=>U.filter(Se=>Se.status==="succeeded"),[U]),ee=f.useMemo(()=>Q.map(Se=>({value:Se.id,label:KT(Se)})),[Q]),G=P?H.get(P)??null:null,V=vr({queryKey:["feature-canvas","training-job",P||"none"],queryFn:()=>Nx(P),enabled:!!P,staleTime:30*1e3});f.useEffect(()=>{var Pe,$e;const Se=V.data;if(!Se)return;const Re=(Pe=Se.metrics)==null?void 0:Pe.evaluation;if(!Re||typeof Re!="object")return;const Ce=Re.splits;if(!Ce||typeof Ce!="object")return;const Fe={};Object.entries(Ce).forEach(([rt,wt])=>{wt&&typeof wt=="object"&&(Fe[rt]=wt)});const Ve=typeof Re.generated_at=="string"?Re.generated_at:z??Se.updated_at??Se.created_at??new Date().toISOString(),Ke=Re.problem_type==="regression"?"regression":"classification",tt={job_id:Se.id,pipeline_id:Se.pipeline_id,node_id:Se.node_id,generated_at:Ve,problem_type:Ke,target_column:Re.target_column??(($e=Se.metadata)==null?void 0:$e.target_column)??null,splits:Fe};Y(tt),Ve&&Ve!==z&&i(rt=>({...rt??{},last_evaluated_at:Ve}));const J=Cd(Object.keys(Fe));J.length&&!W.current&&!HT(T,J)&&i(rt=>({...rt??{},splits:J}))},[V.data,z,i,T]);const Z=Km({mutationFn:async Se=>{if(!P)throw new Error("Select a training job before running evaluation.");return Sx(P,Se)},onSuccess:Se=>{Y(Se),i(Re=>({...Re??{},training_job_id:P,splits:Se.splits?Object.keys(Se.splits):O,include_confusion:B,include_curves:q,include_residuals:K,max_curve_points:ne,max_scatter_points:ue,last_evaluated_at:Se.generated_at})),p.invalidateQueries({queryKey:["feature-canvas","training-job",P]})}}),de=f.useCallback(Se=>{const Re=Se.target.value;Z.reset(),i(Ce=>{const Fe={...Ce??{}};return Re?Fe.training_job_id=Re:delete Fe.training_job_id,Fe})},[Z,i]),pe=f.useCallback(Se=>{d&&d[Se]===!1||(Z.reset(),W.current=!0,i(Re=>{const Ce=Cd(Wg(Re==null?void 0:Re.splits)),Fe=Ce.includes(Se);let Ve;if(Fe){if(Ce.length<=1)return Re??{};Ve=Ce.filter(Ke=>Ke!==Se)}else Ve=Cd([...Ce,Se]);return{...Re??{},splits:Ve}}))},[d,Z,i]),le=f.useCallback((Se,Re)=>{Z.reset(),i(Ce=>({...Ce??{},[Se]:Re}))},[Z,i]),ge=f.useCallback(()=>{if(!P)return;const Se={splits:O,include_confusion:B,include_curves:q,include_residuals:K,max_curve_points:q?ne:void 0,max_scatter_points:K?ue:void 0};Z.mutate(Se)},[Z,B,q,K,ne,ue,P,O]),He=X?Gs(X.generated_at):z?Gs(z):null,lt=f.useMemo(()=>X?Object.entries(X.splits).sort((Se,Re)=>{const[Ce]=Se,[Fe]=Re,Ve=Uf[Ce]??99,Ke=Uf[Fe]??99;return Ve-Ke}):[],[X]);return a.jsxs("div",{className:"node-settings__section node-settings__evaluation",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[He&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",He]}),m&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:y,disabled:!y,title:"Reset evaluation node to defaults",children:"Reset node"})]})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:P,onChange:de,disabled:te.isLoading||te.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),ee.map(Se=>a.jsx("option",{value:Se.value,children:Se.label},Se.value))]}),te.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),te.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:te.error.message}),!te.isLoading&&!ee.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),E&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:E})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:Bf.map(Se=>{const Re=d?d[Se.value]!==!1:!0,Ce=Re&&O.includes(Se.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${Se.accent} ${Ce?"evaluation-chip--active":""}`,"aria-disabled":!Re,title:Re?void 0:`${Se.label} split is not connected`,style:Re?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:Ce,disabled:!Re,onChange:()=>pe(Se.value)}),a.jsx("span",{children:Se.label})]},Se.value)})}),k.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",D," split",k.length>1?"s":""," to enable diagnostics."]}),!$&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a validation or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:B,onChange:Se=>le("include_confusion",Se.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:q,onChange:Se=>le("include_curves",Se.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:K,onChange:Se=>le("include_residuals",Se.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:ge,disabled:!P||Z.isPending||!$,children:Z.isPending?"Running":"Run evaluation"}),G&&G.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!$&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),Z.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:Z.error.message}),Z.isSuccess&&X&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",Gs(X.generated_at),"."]}),V.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:V.error.message})]}),X?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:X.problem_type==="regression"?"Regression":"Classification"})]}),X.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:X.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:Gs(X.generated_at)??X.generated_at})]})]}),lt.map(([Se,Re])=>a.jsx(GT,{splitKey:Se,payload:Re,problemType:X.problem_type,formatMetricValue:u},Se))]}):a.jsx("div",{className:"evaluation-placeholder",children:P?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},GT=({splitKey:e,payload:t,problemType:n,formatMetricValue:r})=>{const i=YT(t.metrics),l=i.length>0,u=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[VT(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),l?a.jsx("div",{className:"evaluation-metrics__grid",children:i.map(d=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:d.key}),a.jsx("span",{className:"evaluation-metrics__value",children:r(d.value)})]},d.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(XT,{matrix:t.confusion_matrix,formatMetricValue:r}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(d=>a.jsx(JT,{curve:d,formatMetricValue:r},`roc-${d.label}`)),t.pr_curves.map(d=>a.jsx(ZT,{curve:d,formatMetricValue:r},`pr-${d.label}`))]}),n==="regression"&&t.residuals&&a.jsx(t2,{residuals:t.residuals,formatMetricValue:r})]}),u.length>0&&a.jsx("ul",{className:"evaluation-notes",children:u.map((d,m)=>a.jsx("li",{children:d},`${e}-note-${m}`))})]})},XT=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],r=Array.isArray(e.totals)?e.totals:[],i=Array.isArray(e.normalized)?e.normalized:[],l=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),l!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",lw(l,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((u,d)=>a.jsx("th",{children:u},`pred-${d}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((u,d)=>{const m=i[d]??[],y=r[d]??u.reduce((p,_)=>p+_,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[d]??`Class ${d}`}),u.map((p,_)=>{const v=typeof m[_]=="number"?m[_]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:p}),v!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:lw(v,t)})]},`cell-${d}-${_}`)}),a.jsx("td",{children:y})]},`row-${d}`)})})]})]})},JT=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,r=240,i=28,l=n-i*2,u=r-i*2,d=e.fpr.map((m,y)=>{const p=i+qf(m)*l,_=r-i-qf(e.tpr[y])*u;return`${y===0?"M":"L"}${p} ${_}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${r}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:i,y:i,width:l,height:u,className:"evaluation-chart__frame"}),a.jsx("line",{x1:i,y1:r-i,x2:n-i,y2:i,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:i,y1:i,x2:i,y2:r-i,className:"evaluation-chart__axis"}),a.jsx("line",{x1:i,y1:r-i,x2:n-i,y2:r-i,className:"evaluation-chart__axis"}),a.jsx("path",{d,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:r-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},ZT=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,r=240,i=28,l=n-i*2,u=r-i*2,d=e.recall.map((m,y)=>{const p=i+qf(m)*l,_=r-i-qf(e.precision[y])*u;return`${y===0?"M":"L"}${p} ${_}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${r}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:i,y:i,width:l,height:u,className:"evaluation-chart__frame"}),a.jsx("line",{x1:i,y1:i,x2:i,y2:r-i,className:"evaluation-chart__axis"}),a.jsx("line",{x1:i,y1:r-i,x2:n-i,y2:r-i,className:"evaluation-chart__axis"}),a.jsx("path",{d,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:r-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},e2={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},t2=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(r=>typeof r[1]=="number"&&Number.isFinite(r[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([r,i])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:e2[r]??r}),a.jsx("span",{className:"evaluation-summary__value",children:t(i)})]},r))}),a.jsx(n2,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx(s2,{points:e.scatter})]})},n2=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const r=t.reduce((i,l)=>Math.max(i,l),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((i,l)=>{const u=i/r*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${i} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${u}%`}})},`bin-${l}`)})})},s2=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,r=36,i=e.map(v=>v.actual),l=e.map(v=>v.predicted),u=Math.min(...i,...l),d=Math.max(...i,...l),m=d-u||1,y=v=>(v-u)/m,p=v=>r+y(v)*(t-r*2),_=v=>n-r-y(v)*(n-r*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:r,y:r,width:t-r*2,height:n-r*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:r,y1:n-r,x2:t-r,y2:n-r,className:"evaluation-chart__axis"}),a.jsx("line",{x1:r,y1:r,x2:r,y2:n-r,className:"evaluation-chart__axis"}),a.jsx("line",{x1:p(u),y1:_(u),x2:p(d),y2:_(d),className:"evaluation-curve__baseline"}),e.map((v,w)=>a.jsx("circle",{cx:p(v.actual),cy:_(v.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${w}`))]})})},r2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},a2={queued:"info",running:"info",succeeded:"success",failed:"danger",cancelled:"neutral"},Oc={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score"],regression:["rmse","mae","r2","mape"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},cw=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted"],uw=["rmse","mae","r2","mape"],dw=new Set(["rmse","mae","mape","mse"]),mw={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},Nr=e=>!!e&&typeof e=="object"&&!Array.isArray(e),o2=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},Yg=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",i2=e=>{if(!e)return Oc.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return Oc.regression;if(t.includes("class")||t.includes("classification"))return Oc.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?Oc.regression:n==="classification"?Oc.classification:Oc.fallback},l2=e=>{var i,l,u;if(!Nr(e))return null;const t=[],n=(l=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:l.mean;Nr(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),Nr(e.test)&&t.push({values:e.test,labelPrefix:""}),Nr(e.validation)&&t.push({values:e.validation,labelPrefix:""}),Nr(e.train)&&t.push({values:e.train,labelPrefix:""});const r=i2(e);for(const d of t)for(const m of r){const y=d.values[m];if(typeof y=="number"&&Number.isFinite(y))return{label:d.labelPrefix?`${d.labelPrefix}${m}`:m,value:y}}for(const d of t)for(const[m,y]of Object.entries(d.values))if(typeof y=="number"&&Number.isFinite(y))return{label:d.labelPrefix?`${d.labelPrefix}${m}`:m,value:y};return null},c2=e=>{var n,r;if(!Nr(e))return{label:null,values:{}};if(Nr(e.test))return{label:"Test",values:e.test};if(Nr(e.validation))return{label:"Validation",values:e.validation};const t=(r=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:r.mean;return Nr(t)?{label:"CV mean",values:t}:Nr(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},fw=e=>{if(!e)return"Unknown model";const t=e.trim();return mw[t]?mw[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},u2=e=>{var l,u;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const d of n)if(typeof d=="string"){const m=d.trim().toLowerCase();if(m==="classification"||m==="regression")return m}const r=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(r.includes("classifier")||r.includes("classification"))return"classification";if(r.includes("regress")||r.includes("regression"))return"regression";const i=e.metrics;if(Nr(i)){const d=new Set,m=v=>{Nr(v)&&Object.keys(v).forEach(w=>d.add(w.toLowerCase()))};m(i.test),m(i.validation),m(i.train);const y=(u=(l=i==null?void 0:i.cross_validation)==null?void 0:l.metrics)==null?void 0:u.mean;Nr(y)&&m(y);const p=cw.some(v=>d.has(v)),_=uw.some(v=>d.has(v));if(p&&!_)return"classification";if(_&&!p)return"regression"}return"unknown"},d2=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:u2(t),modelLabel:fw(t.model_type),primaryMetric:l2(n),metricBucket:c2(n)}}),hw=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return dw.has(t)||dw.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},m2=({nodeId:e,sourceId:t,graph:n,parameters:r,config:i,renderParameterField:l})=>{var G;const u=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),d=f.useMemo(()=>{if(!u)return[];const V=new Map;u.nodes.forEach(pe=>{pe&&pe.id&&V.set(pe.id,pe)});const Z=new Set;return u.edges.forEach(pe=>{var ge;if(!pe||pe.target!==e)return;const le=V.get(pe.source);((ge=le==null?void 0:le.data)==null?void 0:ge.catalogType)==="train_model_draft"&&Z.add(le.id)}),Z.size>0?Array.from(Z):u.nodes.filter(pe=>{var le;return((le=pe==null?void 0:pe.data)==null?void 0:le.catalogType)==="train_model_draft"}).map(pe=>pe.id)},[u,e]),m=f.useMemo(()=>d.length?d.slice().sort().join("|"):"all",[d]),[y,p]=f.useState(null),[_,v]=f.useState(null);f.useEffect(()=>{let V=!1;return v(null),!t||!u?(p(null),()=>{V=!0}):(Ji(t,u).then(Z=>{V||p(Z)}).catch(Z=>{V||(v((Z==null?void 0:Z.message)??"Unable to compute pipeline ID"),p(null))}),()=>{V=!0})},[u,t]);const w=o2(i==null?void 0:i.show_non_success,!0),x=f.useMemo(()=>["feature-canvas","model-registry",t??"none",y??"pending",m,w?"all-statuses":"succeeded"],[y,w,t,m]),S=vr({queryKey:x,queryFn:async()=>{const V={datasetSourceId:t||void 0,limit:50},Z=new Map,de=[];let pe=null;const le=Ye=>{!Array.isArray(Ye)||!Ye.length||Ye.forEach(Se=>{Se&&!Z.has(Se.id)&&Z.set(Se.id,Se)})},ge=async Ye=>{try{const Se=await fd(Ye);return le(Se==null?void 0:Se.jobs),Se}catch(Se){return Se instanceof Error&&de.push(Se),null}};if(y&&await ge({...V,pipelineId:y}),d.length===1){const[Ye]=d;await ge({...V,nodeId:Ye})}if(pe=await ge(V),!Z.size){if(pe)return pe;if(de.length)throw de[0];return{jobs:[],total:0}}const He=Array.from(Z.values()),lt=(pe==null?void 0:pe.total)??He.length;return{jobs:He,total:lt}},enabled:!!t,staleTime:30*1e3,retry:(V,Z)=>Z.message.includes("Sign in")?!1:V<2,refetchInterval:V=>{const Z=V.state.data;return((Z==null?void 0:Z.jobs)??[]).some(le=>le.status==="queued"||le.status==="running")?5e3:!1}}),E=((G=S.data)==null?void 0:G.jobs)??[],A=f.useMemo(()=>{if(!E.length)return[];if(!d.length)return E;const V=E.filter(Z=>d.includes(Z.node_id));return V.length?V:E},[E,d]),P=f.useMemo(()=>d2(A),[A]),T=f.useMemo(()=>w?P:P.filter(V=>V.job.status==="succeeded"),[P,w]),j=f.useMemo(()=>T.filter(V=>V.problemType==="classification"),[T]),O=f.useMemo(()=>T.filter(V=>V.problemType==="regression"),[T]),k=f.useMemo(()=>!j.length&&!O.length?"classification":j.length?O.length?j.length>=O.length?"classification":"regression":"classification":"regression",[j.length,O.length]),D=typeof(i==null?void 0:i.default_problem_type)=="string"?i.default_problem_type.trim().toLowerCase():"auto",$=D==="classification"||D==="regression"?D:k,[B,q]=f.useState($);f.useEffect(()=>{q($)},[$]);const K=B==="classification"?j:O,ne=f.useMemo(()=>{const V=new Map;return K.forEach(Z=>{const de=Z.job.model_type,pe=V.get(de)??{label:Z.modelLabel,count:0};pe.count+=1,V.set(de,pe)}),Array.from(V.entries()).map(([Z,de])=>({value:Z,label:de.label,count:de.count})).sort((Z,de)=>Z.label.localeCompare(de.label))},[K]),ue=typeof(i==null?void 0:i.default_method)=="string"?i.default_method.trim().toLowerCase():"",[z,X]=f.useState("all");f.useEffect(()=>{if(!ne.length){X("all");return}const V=ne.find(Z=>Z.value.toLowerCase()===ue);X(V?V.value:"all")},[ue,ne,B]);const Y=f.useMemo(()=>z==="all"?K:K.filter(V=>V.job.model_type===z),[z,K]),W=f.useMemo(()=>Y.slice().sort((V,Z)=>{if(Z.job.version!==V.job.version)return Z.job.version-V.job.version;const de=Date.parse(V.job.updated_at??V.job.created_at??"");return Date.parse(Z.job.updated_at??Z.job.created_at??"")-de}),[Y]),F=f.useMemo(()=>{if(!K.length)return[];const V=new Map;K.forEach(de=>{const pe=de.job.model_type,le=V.get(pe)??[];le.push(de),V.set(pe,le)});const Z=[];return V.forEach((de,pe)=>{const le=de.reduce((ge,He)=>{const lt=hw(He.primaryMetric);if(lt===null)return ge;if(!ge)return He;const Ye=hw(ge.primaryMetric);return Ye===null||lt>Ye?He:ge},null);Z.push({modelType:pe,label:fw(pe),bestJob:le})}),Z.sort((de,pe)=>de.label.localeCompare(pe.label))},[K]),te=f.useMemo(()=>r.filter(V=>["default_problem_type","show_non_success"].includes(V.name)),[r]),U=B==="classification"?cw:uw,H=S.isLoading||S.isFetching,Q=S.error??null,ee=W.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),y&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",y]})]}),_&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:_}),!d.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),te.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:te.map(V=>a.jsx(Ae.Fragment,{children:l(V)},V.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(V=>a.jsxs("button",{type:"button",role:"tab","data-active":B===V,className:"model-registry__tab",onClick:()=>q(V),disabled:V==="classification"&&!j.length||V==="regression"&&!O.length,children:[V==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:V==="classification"?j.length:O.length})]},V))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z==="all",onClick:()=>X("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:K.length})]}),ne.map(V=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z===V.value,onClick:()=>X(V.value),children:[V.label,a.jsx("span",{className:"model-registry__method-count",children:V.count})]},V.value))]})]}),F.length>0&&a.jsx("div",{className:"model-registry__summary",children:F.map(V=>{const Z=V.bestJob,de=Z!=null&&Z.primaryMetric?Z.primaryMetric.label:null,pe=Z!=null&&Z.primaryMetric?Yg(Z.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:V.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[de||"No metrics",de&&a.jsx("strong",{children:pe})]}),(Z==null?void 0:Z.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",Z.job.version]})]},V.modelType)})}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),Q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Q.message}),!H&&!Q&&!ee&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),ee&&a.jsx("div",{className:"model-registry__table-wrapper",children:a.jsxs("table",{className:"model-registry__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Version"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Model"}),a.jsx("th",{scope:"col",children:"Primary metric"}),U.map(V=>a.jsx("th",{scope:"col",children:V.replace(/_/g," ")},V)),a.jsx("th",{scope:"col",children:"Evaluated"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:W.map(V=>{const{job:Z,primaryMetric:de,metricBucket:pe}=V,le=pe.values||{},ge=pe.label??"",He=Z.updated_at??Z.created_at??null;return a.jsxs("tr",{children:[a.jsxs("td",{children:["v",Z.version]}),a.jsx("td",{children:a.jsx("span",{className:`model-registry__status model-registry__status--${a2[Z.status]}`,children:r2[Z.status]})}),a.jsx("td",{children:V.modelLabel}),a.jsx("td",{children:de?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",children:de.label}),a.jsx("span",{className:"model-registry__metric-value",children:Yg(de.value)})]}):""}),U.map(lt=>{const Ye=le[lt];return a.jsx("td",{children:typeof Ye=="number"&&Number.isFinite(Ye)?Yg(Ye):""},`${Z.id}-${lt}`)}),a.jsx("td",{children:ge}),a.jsx("td",{children:He?Gs(He)??He:""})]},Z.id)})})]})})]})},f2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},nl="__tuning_strategies",sl="__active_tuning_strategy_id",rl="__expanded_tuning_strategy_ids",Qg=["random","grid","halving","optuna"],Hf=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const r=n.toLowerCase();if(t&&t.length>0){const l=t.find(u=>u.toLowerCase()===r);if(l)return l}const i=Qg.find(l=>l.toLowerCase()===r);return i||n},ta=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Ms=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},Xo=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return ta(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return ta(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},Gg=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,r])=>{if(n){if(Array.isArray(r)){const i=r.filter(l=>l!=null);i.length>0&&(t[n]=i.map(l=>Ms(l)));return}r==null||r===""||(t[n]=[Ms(r)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},h2=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",p2=new Set(["train","test","validation"]),pw=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const r=n.trim().toLowerCase();p2.has(r)&&t.add(r)}}),Array.from(t)},Xg=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([r,i])=>{t.has(r)&&(n[r]=i)}),n},Jg=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([r,i])=>{if(t.has(r)){if(Array.isArray(i)){const l=i.map(u=>Ms(u)).filter(u=>u!=null&&u!=="");l.length>0&&(n[r]=l);return}i!=null&&i!==""&&(n[r]=[Ms(i)])}}),n},g2=(e,t)=>{const n=t.split(/[\n,]+/).map(m=>m.trim()).filter(m=>m.length>0);if(n.length===0)return{values:[],error:null};const r=[],i=[],l=Array.isArray(e.options)?new Set(e.options.map(m=>m.value)):null;n.forEach(m=>{if(e.type==="number"){const y=Number(m);Number.isFinite(y)?r.push(y):i.push(m);return}if(e.type==="boolean"){const y=m.toLowerCase();if(["true","1","yes","y"].includes(y)){r.push(!0);return}if(["false","0","no","n"].includes(y)){r.push(!1);return}i.push(m);return}if(e.type==="select"){if(l&&!l.has(m)){i.push(m);return}r.push(m);return}r.push(m)});const u=[],d=new Set;if(r.forEach(m=>{const y=typeof m=="object"?JSON.stringify(m):String(m);d.has(y)||(d.add(y),u.push(m))}),i.length>0){const m=i.slice(0,3).join(", "),y=i.length>3?"":"";return{values:u,error:`Invalid value${i.length>1?"s":""}: ${m}${y}`}}return{values:u,error:null}},gw=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),Vf=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},Wf=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},Ed=(e,t,n)=>{let r=e;return typeof t=="number"&&Number.isFinite(t)&&(r=Math.max(r,t)),typeof n=="number"&&Number.isFinite(n)&&(r=Math.min(r,n)),r},_2=(e,t)=>{const n={},r=e.find(m=>(m==null?void 0:m.name)==="solver"),i=e.find(m=>(m==null?void 0:m.name)==="penalty"),l=!!(r&&i&&Array.isArray(r.options)&&r.options.some(m=>(m==null?void 0:m.value)==="liblinear")&&Array.isArray(i.options)&&i.options.some(m=>(m==null?void 0:m.value)==="elasticnet")),u=new Set(["lbfgs","saga"]),d=new Set(["l2","none"]);return e.forEach(m=>{if(!(m!=null&&m.name))return;const y=new Map,p=w=>{if(w==null||typeof w=="number"&&!Number.isFinite(w))return;const x=typeof w=="object"?JSON.stringify(w):`${typeof w}:${String(w)}`;y.has(x)||y.set(x,Ms(w))},_=t==null?void 0:t[m.name];if(l&&m.name==="solver")(Array.isArray(m.options)?m.options:[]).forEach(x=>{x!=null&&x.value&&u.has(String(x.value))&&p(x.value)}),!y.size&&typeof _=="string"&&u.has(_)&&p(_),y.size||u.forEach(x=>p(x));else if(l&&m.name==="penalty")(Array.isArray(m.options)?m.options:[]).forEach(x=>{x!=null&&x.value&&d.has(String(x.value))&&p(x.value)}),!y.size&&typeof _=="string"&&d.has(_)&&p(_),y.size||d.forEach(x=>p(x));else if(m.type==="number"){const w=Wf(_),x=Wf(m.min),S=Wf(m.max);if(x!==null&&p(x),w!==null&&p(Ed(w,x,S)),S!==null&&p(S),y.size<=1&&w!==null){const E=Wf(m.step);E!==null&&E>0?(p(Ed(w+E,x,S)),p(Ed(w-E,x,S))):(p(Ed(w*1.5,x,S)),p(Ed(w*.5,x,S)))}}else m.type==="boolean"?(p(!0),p(!1),typeof _=="boolean"&&p(_)):(m.type==="select"&&(m.options??[]).slice(0,6).forEach(w=>{(w==null?void 0:w.value)!==void 0&&p(w.value)}),typeof _=="string"&&_.trim().length&&p(_.trim()));const v=Array.from(y.values());v.length>0&&(n[m.name]=v)}),n},v2={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},Zg=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,kd=e=>{if(!ta(e))return{};const t=Ms(e);return ta(t)?(delete t[nl],delete t[sl],delete t[rl],t):{}},Pc=e=>kd(e),y2=(e,t,n)=>({id:Zg(),label:e,config:Pc(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),Jo=e=>`Strategy ${e}`,_w=e=>ta(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},vw=e=>ta(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const r=e[n];return t[n]=r===null?null:String(r),t},{}):{},b2=e=>{if(!ta(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,nl)&&(t[nl]=Ms(e[nl])),Object.prototype.hasOwnProperty.call(e,sl)&&(t[sl]=e[sl]),Object.prototype.hasOwnProperty.call(e,rl)&&(t[rl]=Ms(e[rl])),t},x2=()=>({strategies:[],activeId:null,expandedIds:[]}),e_=e=>{var m;const t=x2();if(!ta(e))return t;const n=e[nl];if(Array.isArray(n)){const y=new Set;n.forEach(p=>{if(!ta(p))return;let _=typeof p.id=="string"?p.id.trim():"";(!_||y.has(_))&&(_=Zg()),y.add(_);const v=typeof p.label=="string"?p.label.trim():"",w=v.length?v:Jo(t.strategies.length+1),x=ta(p.config)?p.config:{},S={id:_,label:w,config:kd(x),searchSpaceTexts:_w(p.searchSpaceTexts),searchSpaceFieldErrors:vw(p.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!p.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!p.searchSpaceManuallyCleared};t.strategies.push(S)})}const r=new Set(t.strategies.map(y=>y.id)),i=e[sl],l=typeof i=="string"?i.trim():"";t.activeId=l&&r.has(l)?l:((m=t.strategies[0])==null?void 0:m.id)??null;const u=e[rl],d=Array.isArray(u)?u.map(y=>typeof y=="string"?y.trim():"").filter(y=>!!y&&r.has(y)):[];return t.activeId&&!d.includes(t.activeId)&&d.push(t.activeId),t.expandedIds=Array.from(new Set(d)).sort(),t},yw=e=>({id:e.id,label:e.label,config:Pc(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),w2=(e,t,n)=>{var d;const r=e.map((m,y)=>({id:typeof m.id=="string"&&m.id.trim().length?m.id:Zg(),label:typeof m.label=="string"&&m.label.trim().length?m.label:Jo(y+1),config:kd(m.config),searchSpaceTexts:_w(m.searchSpaceTexts),searchSpaceFieldErrors:vw(m.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!m.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!m.searchSpaceManuallyCleared})),i=new Set(r.map(m=>m.id)),l=typeof t=="string"&&i.has(t)?t:((d=r[0])==null?void 0:d.id)??null,u=Array.from(n??new Set).filter(m=>i.has(m));return l&&!u.includes(l)&&u.push(l),{strategies:r,activeId:l,expandedIds:Array.from(new Set(u)).sort()}},bw=(e,t)=>{var n;return t&&e.some(r=>r.id===t)?t:((n=e[0])==null?void 0:n.id)??""},xw=(e,t)=>{const n=new Set(e.map(i=>i.id)),r=t.filter(i=>n.has(i));return!r.length&&e[0]&&r.push(e[0].id),new Set(r)},Kf=e=>Sd(e),ww=(e,t)=>{const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0},j2=({nodeId:e,sourceId:t,graph:n,config:r,runtimeConfig:i,cvConfig:l,draftConfigState:u,renderParameterField:d,modelTypeParameter:m,modelTypeOptions:y,searchStrategyParameter:p,searchIterationsParameter:_,searchRandomStateParameter:v,scoringMetricParameter:w,setDraftConfigState:x,onSaveDraftConfig:S})=>{var _l,ui,vl,yl;const E=fc(),[A,P]=f.useState(null),[T,j]=f.useState(null),[O,k]=f.useState(null),[D,$]=f.useState(0),[B,q]=f.useState(null),[K,ne]=f.useState(!1),[ue,z]=f.useState(null),X=((r==null?void 0:r.targetColumn)??"").trim(),Y=(r==null?void 0:r.problemType)==="regression"?"regression":"classification",W=(m==null?void 0:m.name)??"model_type",F=(p==null?void 0:p.name)??"search_strategy",te=(_==null?void 0:_.name)??"search_iterations",U=(v==null?void 0:v.name)??"search_random_state",H=(w==null?void 0:w.name)??"scoring_metric",Q=u==null?void 0:u[W],ee=typeof Q=="string"&&Q.trim().length?Q.trim():((i==null?void 0:i.modelType)??"").trim(),G=vr({queryKey:["model-hyperparameters",ee],queryFn:()=>Mf(ee),enabled:!!ee,staleTime:5*60*1e3}),V=((_l=G.data)==null?void 0:_l.fields)??[],Z=((ui=G.data)==null?void 0:ui.defaults)??{},de=f.useMemo(()=>{if(!V.length)return new Set;const oe=new Set;return V.forEach(Me=>{Me!=null&&Me.name&&oe.add(Me.name)}),oe},[V]),pe=!!(l!=null&&l.enabled),le=(l==null?void 0:l.strategy)??"auto",ge=typeof(l==null?void 0:l.folds)=="number"?l.folds:5,He=!!(l!=null&&l.shuffle),lt=(l==null?void 0:l.randomState)??null,Ye=f.useMemo(()=>{const oe=[];return((p==null?void 0:p.options)??[]).forEach(Me=>{if(!Me||typeof Me.value!="string")return;const je=Me.value.trim();if(!je.length)return;const Ge=je.toLowerCase();oe.some(qe=>qe.toLowerCase()===Ge)||oe.push(je)}),oe},[p]),Se=f.useMemo(()=>Ye.length>0?[...Ye]:[...Qg],[Ye]),Re=Hf(p==null?void 0:p.default,Ye),Fe=Hf(u==null?void 0:u[F],Ye)??Re??Se[0]??Qg[0],Ve=u==null?void 0:u[te];let Ke=null;if(typeof Ve=="number"&&Number.isFinite(Ve))Ke=Math.max(1,Math.floor(Ve));else if(typeof Ve=="string"){const oe=Number(Ve.trim());Number.isFinite(oe)&&oe>0&&(Ke=Math.max(1,Math.floor(oe)))}const tt=u==null?void 0:u[U];let J=null;if(typeof tt=="number"&&Number.isFinite(tt))J=Math.trunc(tt);else if(typeof tt=="string"){const oe=Number(tt.trim());Number.isFinite(oe)&&(J=Math.trunc(oe))}const Pe=typeof(_==null?void 0:_.default)=="number"&&Number.isFinite(_.default)?Math.max(1,Math.floor(_.default)):null,$e=typeof(v==null?void 0:v.default)=="number"&&Number.isFinite(v.default)?Math.trunc(v.default):null,rt=typeof(u==null?void 0:u[H])=="string"?String(u[H]).trim():"",wt=rt.length?rt:null,en=f.useMemo(()=>Xo(u==null?void 0:u.baseline_hyperparameters),[u==null?void 0:u.baseline_hyperparameters]),ye=f.useMemo(()=>Xo(u==null?void 0:u.search_space),[u==null?void 0:u.search_space]),we=f.useMemo(()=>Gg(ye.value),[ye.value]),ke=en.value,Oe=en.error,Xe=we.value,Ie=ye.error??we.error,nt=f.useMemo(()=>Xg(ke,de),[de,ke]),xt=f.useMemo(()=>Jg(Xe,de),[de,Xe]),Ot=f.useMemo(()=>Object.keys(nt).length,[nt]),Ft=f.useMemo(()=>Object.keys(xt).length,[xt]),dt=Ft>0,[Tt,gt]=f.useState({}),[kt,vn]=f.useState({}),[Jt,Mn]=f.useState(!1),[Yn,yn]=f.useState(!1),$t=f.useRef(null);if(!$t.current){const oe=e_(u);let Ge=oe.strategies.length>0?oe.strategies.map(yw):[];const qe=bw(Ge,oe.activeId),Le=xw(Ge,oe.expandedIds);qe&&!Le.has(qe)&&Ge.length&&Le.add(qe);const _t=Kf(oe);$t.current={strategies:Ge,activeId:qe,expanded:Le,signature:_t}}const[Lt,xn]=f.useState(()=>$t.current?$t.current.strategies:[]),[Ut,Pt]=f.useState(()=>new Set($t.current?Array.from($t.current.expanded):[])),[mn,ns]=f.useState(()=>{var oe;return((oe=$t.current)==null?void 0:oe.activeId)??""}),er=f.useRef(((vl=$t.current)==null?void 0:vl.signature)??""),An=f.useRef(null),us=f.useRef(null),Kt=f.useMemo(()=>Lt.length?Lt.find(Me=>Me.id===mn)??Lt[0]:null,[mn,Lt]),Qn=f.useMemo(()=>e_(u),[u]),zr=f.useMemo(()=>Kf(Qn),[Qn]);f.useEffect(()=>{if(zr===er.current)return;const oe=Qn.strategies.length?Qn.strategies.map(yw):[],Me=bw(oe,Qn.activeId),je=xw(oe,Qn.expandedIds);Me&&!je.has(Me)&&oe.length&&je.add(Me),An.current=null,xn(oe),ns(Me),Pt(je),er.current=zr},[zr,Qn,u]),f.useEffect(()=>{if(!Lt.length)return;Lt.some(Me=>Me.id===mn)||ns(Lt[0].id)},[mn,Lt]),f.useEffect(()=>{const oe=w2(Lt,mn,Ut),Me=Kf(oe);er.current!==Me&&x(je=>{const Ge=e_(je),qe=Kf(Ge);if(qe===Me)return er.current=qe,je??{};const Le=je?{...je}:{};return oe.strategies.length?Le[nl]=oe.strategies.map(_t=>({..._t,config:Ms(_t.config),searchSpaceTexts:{..._t.searchSpaceTexts},searchSpaceFieldErrors:{..._t.searchSpaceFieldErrors}})):delete Le[nl],oe.activeId?Le[sl]=oe.activeId:delete Le[sl],oe.expandedIds.length?Le[rl]=[...oe.expandedIds]:delete Le[rl],er.current=Me,Le})},[mn,Ut,x,Lt]),f.useEffect(()=>{if(!Kt||An.current===Kt.id)return;An.current=Kt.id;const oe=Pc(Kt.config);x(je=>({...b2(je),...oe})),gt(Kt.searchSpaceTexts??{}),vn(Kt.searchSpaceFieldErrors??{}),Mn(Kt.hasAutoFilledSearchSpace??!1),yn(Kt.searchSpaceManuallyCleared??!1);const Me=typeof(oe==null?void 0:oe[W])=="string"?String(oe[W]):(i==null?void 0:i.modelType)??"";us.current=Me},[Kt,W,i==null?void 0:i.modelType,x]),f.useEffect(()=>{if(!Kt)return;const oe=Pc(u),Me=JSON.stringify(oe)!==JSON.stringify(Kt.config??{}),je=!ww(Tt,Kt.searchSpaceTexts),Ge=!ww(kt,Kt.searchSpaceFieldErrors),qe=Kt.hasAutoFilledSearchSpace!==Jt,Le=Kt.searchSpaceManuallyCleared!==Yn;!Me&&!je&&!Ge&&!qe&&!Le||xn(_t=>_t.map(it=>it.id!==Kt.id?it:{...it,config:oe,searchSpaceTexts:{...Tt},searchSpaceFieldErrors:{...kt},hasAutoFilledSearchSpace:Jt,searchSpaceManuallyCleared:Yn}))},[Kt,u,Jt,kt,Yn,Tt]);const go=f.useCallback(()=>{const oe=Lt.length+1,Me=Pc(u),je=new Set;Lt.forEach(it=>{var Et;const jt=Hf((Et=it.config)==null?void 0:Et[F],Se);jt&&je.add(jt)});const Ge=Se.find(it=>!je.has(it))??Fe,qe=Ms(Me),Le=ta(qe)?qe:{};if(Le[F]=Ge,Ge==="random"||Ge==="optuna"){const it=Ke!==null?Ke:Pe;it!==null?Le[te]=it:delete Le[te];const jt=J!==null?J:$e;jt!==null?Le[U]=jt:delete Le[U]}else delete Le[te],delete Le[U];const _t=y2(Jo(oe),Le,{searchSpaceTexts:{...Tt},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:Jt,searchSpaceManuallyCleared:Yn});xn(it=>[...it,_t]),Pt(it=>new Set([...it,_t.id])),An.current=null,ns(_t.id)},[Se,u,Jt,Ke,Pe,J,$e,Yn,Tt,Fe,F,te,U,xn,ns,Pt,Lt]),tr=f.useCallback(oe=>{Pt(Me=>{const je=new Set(Me);return je.has(oe)?je.delete(oe):je.add(oe),je})},[]),Is=f.useCallback(oe=>{!oe||oe===mn||(An.current=null,ns(oe),Pt(Me=>{const je=new Set(Me);return je.add(oe),je}))},[mn]),La=f.useCallback(oe=>{let Me=null;xn(je=>{if(je.length<=1)return je;const Ge=je.filter(Le=>Le.id!==oe);if(!Ge.length)return je;const qe=Ge.map((Le,_t)=>({...Le,label:Jo(_t+1)}));if(oe===mn){An.current=null;const Le=qe[0].id;Me=Le,ns(Le)}return qe}),Pt(je=>{const Ge=new Set(je);return Ge.delete(oe),Me&&Ge.add(Me),Ge})},[mn]),Da=f.useMemo(()=>Lt.map((oe,Me)=>{var sr,Bs;const je=oe.config??{},Ge=je==null?void 0:je[W],qe=typeof Ge=="string"?Ge.trim():"",Le=((sr=y.find(js=>js.value===qe))==null?void 0:sr.label)??qe,_t=je==null?void 0:je[F],it=typeof _t=="string"?_t.trim():"",jt=(Bs=((p==null?void 0:p.options)??[]).find(js=>js.value===it))==null?void 0:Bs.label,Et=je==null?void 0:je[H],Nt=typeof Et=="string"?Et.trim():"",rs=Xo(je==null?void 0:je.baseline_hyperparameters).error,wn=Xo(je==null?void 0:je.search_space),as=Gg(wn.value),za=as.value?Object.keys(as.value).length:0,ma=as.value?Object.values(as.value).reduce((js,Cr)=>js+(Array.isArray(Cr)?Cr.length:0),0):0,ws=rs!==null||Object.values(oe.searchSpaceFieldErrors).some(js=>!!js);return{id:oe.id,label:oe.label||Jo(Me+1),modelLabel:Le||"Select model",searchStrategyLabel:jt??(it||"Random search"),scoringLabel:Nt||"Estimator default",parameterCount:za,candidateCount:ma,hasErrors:ws}}),[y,W,H,p,F,Lt]);f.useEffect(()=>{const oe=us.current;if(oe===null){us.current=ee;return}oe!==ee&&(us.current=ee,gt({}),vn({}),Mn(!1),yn(!1))},[ee]),f.useEffect(()=>{!ee||!V.length||gt(oe=>{const Me={...oe};let je=!1;return V.forEach(Ge=>{if(kt[Ge.name])return;const qe=xt[Ge.name],Le=Array.isArray(qe)&&qe.length>0?qe.map(_t=>gw(Ge,_t)).join(", "):"";Me[Ge.name]!==Le&&(Me[Ge.name]=Le,je=!0)}),je?Me:oe})},[xt,V,ee,kt]),f.useEffect(()=>{if(!ee||!V.length||Yn)return;if(dt){Jt||Mn(!0);return}if(Jt)return;const oe=_2(V,Z);Object.keys(oe).length&&(Mn(!0),vn({}),gt(()=>{const Me={};return V.forEach(je=>{if(!oe[je.name])return;const Ge=oe[je.name].map(qe=>gw(je,qe)).filter(qe=>qe.length>0).join(", ");Me[je.name]=Ge}),Me}),x(Me=>{const je=Me?{...Me}:{};return je.search_space=oe,je}))},[Jt,Z,V,ee,dt,Yn,x]);const[ra,Rr]=f.useState(wt??"");f.useEffect(()=>{Rr(wt??"")},[wt]);const aa=f.useMemo(()=>v2[Y==="regression"?"regression":"classification"],[Y]),oa=(w==null?void 0:w.label)??"Scoring metric",ia=(w==null?void 0:w.description)??"Pick the evaluation metric used to rank candidates.",Ee=f.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),Qe=f.useMemo(()=>Object.values(kt).some(oe=>!!oe),[kt]),Je=f.useCallback((oe,Me)=>{de.has(oe)&&x(je=>{const Ge={...je},qe=Xo(je==null?void 0:je.baseline_hyperparameters).value??{},_t={...Xg(qe,de)};return Me===void 0?delete _t[oe]:_t[oe]=Me,Object.keys(_t).length>0?Ge.baseline_hyperparameters=_t:delete Ge.baseline_hyperparameters,Ge})},[de,x]),un=f.useCallback((oe,Me)=>{gt(qe=>({...qe,[oe.name]:Me}));const{values:je,error:Ge}=g2(oe,Me);vn(qe=>({...qe,[oe.name]:Ge})),!Ge&&x(qe=>{const Le={...qe},_t=Xo(qe==null?void 0:qe.search_space).value??{},jt={...Jg(_t,de)};return je.length>0?jt[oe.name]=je.map(Et=>Ms(Et)):delete jt[oe.name],Object.keys(jt).length>0?Le.search_space=jt:delete Le.search_space,Le})},[de,x]),At=f.useCallback(oe=>{Je(oe,void 0)},[Je]),ds=f.useCallback(()=>{x(oe=>{if(!oe||!oe.baseline_hyperparameters)return oe??{};const Me={...oe};return delete Me.baseline_hyperparameters,Me})},[x]),tn=f.useCallback(()=>{yn(!0),Mn(!0),gt({}),vn({}),x(oe=>{if(!oe||!oe.search_space)return oe??{};const Me={...oe};return delete Me.search_space,Me})},[x]),En=f.useCallback(oe=>{Rr(oe);const Me=oe.trim();x(je=>{const Ge={...je};return Me.length>0?Ge.scoring_metric=Me:delete Ge.scoring_metric,Ge})},[x]),gn=f.useCallback(oe=>{if(!(oe!=null&&oe.name)||!de.has(oe.name))return null;const Me=`baseline-${e}-${oe.name}`,je=nt[oe.name],Ge=je!==void 0,qe=Z==null?void 0:Z[oe.name],Le=oe.label??oe.name,_t=oe.description,it=qe!==void 0?`Default: ${Vf(qe)}`:"Default: estimator setting";let jt;if(oe.type==="number"){const Et=typeof je=="number"?String(je):"";jt=a.jsx("input",{id:Me,type:"number",className:"canvas-modal__parameter-input",value:Et,onChange:Nt=>{const It=Nt.target.value;if(!It.length){At(oe.name);return}const rs=Number(It);Number.isFinite(rs)&&Je(oe.name,rs)},min:oe.min,max:oe.max,step:oe.step,placeholder:"Leave blank to use default"})}else if(oe.type==="select"){const Et=Ge?String(je):"";jt=a.jsxs("select",{id:Me,className:"canvas-modal__parameter-select",value:Et,onChange:Nt=>{const It=Nt.target.value;if(!It.length){At(oe.name);return}Je(oe.name,It)},children:[a.jsx("option",{value:"",children:"Use default"}),(oe.options??[]).map(Nt=>a.jsx("option",{value:Nt.value,children:Nt.label},Nt.value))]})}else if(oe.type==="boolean"){const Et=Ge?je?"true":"false":"";jt=a.jsxs("select",{id:Me,className:"canvas-modal__parameter-select",value:Et,onChange:Nt=>{const It=Nt.target.value;if(!It.length){At(oe.name);return}Je(oe.name,It==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const Et=typeof je=="string"?je:"";jt=a.jsx("input",{id:Me,type:"text",className:"canvas-modal__parameter-input",value:Et,onChange:Nt=>{const It=Nt.target.value;if(!It.length){At(oe.name);return}Je(oe.name,It)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Me,className:"canvas-modal__parameter-label",children:[Le,_t&&a.jsx("span",{className:"canvas-modal__parameter-description",children:_t})]}),jt,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Ge?`Override: ${Vf(je)}`:it})})]},oe.name)},[de,nt,Z,e,Je]),ss=f.useCallback(oe=>{if(!(oe!=null&&oe.name)||!de.has(oe.name))return null;const Me=`search-${e}-${oe.name}`,je=Tt[oe.name]??"",Ge=xt[oe.name],qe=Array.isArray(Ge)?Ge.length:0,Le=kt[oe.name],_t=Z==null?void 0:Z[oe.name],it=oe.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":oe.type==="boolean"?"Enter true/false values, separated by commas or new lines":oe.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",jt=Array.isArray(Ge)?Ge.slice(0,3).map(Et=>Vf(Et)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Me,className:"canvas-modal__parameter-label",children:[oe.label??oe.name,oe.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:oe.description})]}),a.jsx("textarea",{id:Me,className:"canvas-modal__parameter-input",rows:3,value:je,onChange:Et=>un(oe,Et.target.value),placeholder:it,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:qe>0?`Configured ${qe} value${qe===1?"":"s"}${jt?` (${jt}${qe>3?"":""})`:""}`:`Default: ${Vf(_t)}`})}),Le&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:Le})]},oe.name)},[de,xt,un,Z,e,kt,Tt]),Vt=f.useMemo(()=>{if(!dt)return{parameterCount:0,candidateProduct:null};const oe=Object.values(xt),Me=oe.length;let je=null;if(oe.length>0){let Ge=1,qe=!1;oe.forEach(Le=>{Ge*=Math.max(Le.length,1),(!Number.isFinite(Ge)||Ge>1e6)&&(qe=!0)}),je=qe?null:Ge}return{parameterCount:Me,candidateProduct:je}},[xt,dt]),fn=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),On=f.useCallback(oe=>{if(!fn)return null;const Me=Ms(fn);if(!Me||!Array.isArray(Me.nodes))return fn;const je=kd(oe),Ge=Object.keys(je).length>0;return Me.nodes=Me.nodes.map(qe=>{if(!qe||qe.id!==e)return qe;const Le=(qe==null?void 0:qe.data)??{},_t=(Le==null?void 0:Le.config)??{},it=kd(_t),jt=Ge?{...it,...je}:it;return{...qe,data:{...Le,config:jt,isConfigured:!0}}}),Me},[fn,e]),la=f.useMemo(()=>{const oe=On(u);return oe||fn},[u,fn,On]),Fr=f.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const oe=n.nodes,Me=n.edges;return(()=>{var _t;const Le=oe.find(it=>(it==null?void 0:it.id)===e);return Le?pw((_t=Le==null?void 0:Le.data)==null?void 0:_t.connectedSplits):[]})().includes("validation")||Me.some(Le=>!Le||(typeof Le.target=="string"?Le.target:null)!==e?!1:(typeof Le.sourceHandle=="string"?Le.sourceHandle.toLowerCase():"").includes("validation"))?!0:Me.some(Le=>{var Nt;if(!Le||(typeof Le.target=="string"?Le.target:null)!==e)return!1;const it=typeof Le.source=="string"?Le.source:null;if(!it)return!1;const jt=oe.find(It=>(It==null?void 0:It.id)===it);return jt?pw((Nt=jt==null?void 0:jt.data)==null?void 0:Nt.activeSplits).includes("validation"):!1})?!1:null},[n,e]);f.useEffect(()=>{let oe=!1;return!t||!fn?(q(null),()=>{oe=!0}):(Ji(t,fn).then(Me=>{oe||q(Me)}).catch(()=>{oe||q(null)}),()=>{oe=!0})},[fn,t]),f.useEffect(()=>{let oe=!1;j(null);const Me=la??fn;return!t||!Me?(P(null),()=>{oe=!0}):(Ji(t,Me).then(je=>{oe||P(je)}).catch(je=>{oe||(j((je==null?void 0:je.message)??"Unable to compute pipeline ID"),P(null))}),()=>{oe=!0})},[fn,la,t]),f.useEffect(()=>{if(!A||!B){ne(!1);return}ne(A!==B)},[A,B]);const bs=!!(t&&e),Sr=f.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",A??"pending",e],[e,A,t]),xs=vr({queryKey:Sr,queryFn:async()=>{var Me;const oe={datasetSourceId:t||void 0,nodeId:e,limit:5};if(A){const je=await hd({...oe,pipelineId:A});if((((Me=je==null?void 0:je.jobs)==null?void 0:Me.length)??0)>0)return je}return hd(oe)},enabled:bs,retry:(oe,Me)=>Me.message.includes("Sign in")?!1:oe<2,refetchInterval:oe=>{const Me=oe.state.data;return((Me==null?void 0:Me.jobs)??[]).some(qe=>qe.status==="queued"||qe.status==="running")?5e3:!1}}),{mutateAsync:nr,isPending:Ir,error:_o}=Km({mutationFn:Cx,onSuccess:oe=>{const Me=Array.isArray(oe.jobs)?oe.jobs.length:0,je=Me>0?oe.jobs[0]:null;k(je),$(Me),E.invalidateQueries({queryKey:Sr})}}),ca=f.useMemo(()=>{const oe=[];return t||oe.push("Select a dataset before launching tuning jobs."),(!fn||!fn.nodes.length)&&oe.push("Connect this node to an upstream pipeline before tuning."),X||oe.push("Set a target column before tuning."),Fr===!1&&oe.push("Connect the validation split to this node to enable tuning."),ee||oe.push("Choose a model type before enqueuing tuning jobs."),Lt.length===0&&oe.push("Add a tuning strategy before launching tuning jobs."),dt||oe.push("Define at least one hyperparameter in the search space."),Oe&&oe.push(Oe),Ie&&oe.push(Ie),Qe&&oe.push("Resolve invalid candidate values in the search space."),(Fe==="random"||Fe==="optuna")&&!Ke&&oe.push("Provide the maximum iterations for random or Optuna search."),pe&&ge<2&&oe.push("Cross-validation requires at least 2 folds."),T&&oe.push(T),oe},[Oe,pe,ge,fn,dt,Qe,ee,T,Ke,Ie,Fe,t,X,Fr,Lt.length]),ua=((yl=xs.data)==null?void 0:yl.jobs)??[],da=xs.isLoading||xs.isFetching,ci=xs.error,vo=ca.length>0||Qe||!A||!t||!fn||Lt.length===0||!dt||Ir,Vc=f.useMemo(()=>m?y.length?{...m,options:y}:m:null,[y,m]),gl=f.useCallback(async()=>{if(!A||!t||!fn||Lt.length===0)return;if(S){try{const qe=S();ne(!1),qe&&typeof qe.then=="function"&&await qe}catch{}await new Promise(qe=>setTimeout(qe,100))}const oe=async()=>{const qe=[],Le=[],_t=async it=>{if(!it)return new Set;if(it===ee)return de;const jt=["model-hyperparameters",it],Et=E.getQueryData(jt),Nt=It=>{const rs=new Set;return(It??[]).forEach(wn=>{wn!=null&&wn.name&&rs.add(wn.name)}),rs};if(Et)return Nt(Et.fields);try{const It=await E.fetchQuery({queryKey:jt,queryFn:()=>Mf(it)});return Nt(It==null?void 0:It.fields)}catch{return new Set}};for(let it=0;it<Lt.length;it+=1){const jt=Lt[it],Et=jt.label||Jo(it+1),Nt=Pc(jt.config),It=Nt==null?void 0:Nt[W],rs=typeof It=="string"&&It.trim().length?It.trim():ee;if(!rs){Le.push(`${Et} is missing a model selection.`);continue}const wn=Hf(Nt==null?void 0:Nt[F],Se)??Re??"random",as=await _t(rs),ma=Xo(Nt==null?void 0:Nt.baseline_hyperparameters).value??{},ws=as.size>0?Xg(ma,as):Ms(ma),sr=Xo(Nt==null?void 0:Nt.search_space);if(sr.error){Le.push(`${Et} has invalid search space: ${sr.error}`);continue}const Bs=Gg(sr.value);if(Bs.error){Le.push(`${Et} has invalid search space: ${Bs.error}`);continue}const js=Bs.value??{},Cr=as.size>0?Jg(js,as):Ms(js);if(!Cr||Object.keys(Cr).length===0){Le.push(`${Et} requires at least one hyperparameter in the search space.`);continue}if(Object.values(jt.searchSpaceFieldErrors??{}).some(kn=>!!kn)){Le.push(`${Et} has search space entries that need attention.`);continue}const bl=Object.keys(Cr).length;let yo=null;if(bl>0){let kn=1,Gn=!1;Object.values(Cr).forEach(Er=>{const wl=Array.isArray(Er)?Er.length:0;kn*=Math.max(wl,1),(!Number.isFinite(kn)||kn>1e6)&&(Gn=!0)}),yo=Gn?null:kn}const bo=Nt==null?void 0:Nt[H],di=typeof bo=="string"?bo.trim():"",mi=di.length?di:null,Br=()=>{const kn=Nt==null?void 0:Nt[te];let Gn=null;if(typeof kn=="number"&&Number.isFinite(kn))Gn=Math.max(1,Math.floor(kn));else if(typeof kn=="string"){const Er=Number(kn.trim());Number.isFinite(Er)&&Er>0&&(Gn=Math.max(1,Math.floor(Er)))}return Gn===null&&(wn==="random"||wn==="optuna")?Pe!==null?Pe:null:Gn},xl=()=>{const kn=Nt==null?void 0:Nt[U];let Gn=null;if(typeof kn=="number"&&Number.isFinite(kn))Gn=Math.trunc(kn);else if(typeof kn=="string"){const Er=Number(kn.trim());Number.isFinite(Er)&&(Gn=Math.trunc(Er))}return Gn===null&&(wn==="random"||wn==="optuna")?$e!==null?$e:null:Gn},Ra=Br(),fi=xl(),Dn={};X&&(Dn.target_column=X),Dn.problem_type=Y,Dn.strategy_id=jt.id,Dn.strategy_label=Et,Dn.strategy_index=it+1,Dn.search_strategy=wn,Ra!==null&&(wn==="random"||wn==="optuna")&&(Dn.max_iterations=Ra),mi&&(Dn.scoring_metric=mi),fi!==null&&(Dn.random_state=fi),Dn.search_space_keys=Object.keys(Cr),bl>0&&(Dn.search_space_parameters=bl),yo!==null&&(Dn.search_space_candidates=yo),Dn.cross_validation={enabled:pe,strategy:le,folds:ge,shuffle:He,random_state:lt};const xo=On(Nt)??fn;if(!xo){Le.push(`Unable to build pipeline graph for ${Et}.`);continue}const Kc=ws&&Object.keys(ws).length>0?Ms(ws):void 0,Ns=Ms(Cr),Fa={dataset_source_id:t,pipeline_id:A,node_id:e,model_type:rs,model_types:[rs],search_strategy:wn,search_space:Ns,baseline_hyperparameters:Kc,n_iterations:wn==="random"||wn==="optuna"?Ra??void 0:void 0,scoring:mi??void 0,random_state:fi??void 0,cross_validation:{enabled:pe,strategy:le,folds:ge,shuffle:He,random_state:lt},metadata:Dn,job_metadata:Dn,run_tuning:!0,graph:xo,target_node_id:e};qe.push({payload:Fa,label:Et})}return{plans:qe,issues:Le}};z(null);const{plans:Me,issues:je}=await oe();if(!Me.length){je.length&&z(je.join(" "));return}const Ge=[];for(const{payload:qe}of Me)try{const Le=await nr(qe);Array.isArray(Le==null?void 0:Le.jobs)&&Le.jobs.length&&Ge.push(...Le.jobs)}catch(Le){Le instanceof Error&&Le.message?z(Le.message):z("Failed to enqueue one or more tuning jobs.");return}if(Ge.length){const qe=Ge[Ge.length-1];k(qe),$(Ge.length)}},[de,pe,ge,lt,He,le,nr,fn,On,ee,W,e,S,Re,E,A,Y,H,Pe,te,$e,U,F,z,ne,t,Lt,X]),Yt=f.useCallback(()=>{bs&&xs.refetch()},[bs,xs]),Wc=oe=>{var rs,wn,as,za,ma;const Me=f2[oe.status]??oe.status,Ge=(((rs=y.find(ws=>ws.value===oe.model_type))==null?void 0:rs.label)??oe.model_type??"").trim(),qe=(()=>{switch(oe.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"halving_random":return"Successive halving (randomized)";case"optuna":return"Optuna search";default:return"Random search"}})(),Le=oe.updated_at?Gs(oe.updated_at):null,_t=oe.updated_at||oe.created_at,it=_t?Le??new Date(_t).toLocaleString():null,jt=typeof oe.error_message=="string"?oe.error_message.trim():"",Et=[];Ge&&Et.push(`Model ${Ge}`),Et.push(qe),Array.isArray(oe.results)&&oe.results.length>0&&Et.push(`${oe.results.length} candidates`);const Nt=typeof oe.best_score=="number"&&Number.isFinite(oe.best_score)?oe.best_score:typeof((wn=oe.metrics)==null?void 0:wn.best_score)=="number"?oe.metrics.best_score:null;Nt!==null&&Et.push(`Best score ${h2(Nt)}`);const It=String(((as=oe.metrics)==null?void 0:as.scoring)??((za=oe.metrics)==null?void 0:za.scorer)??((ma=oe.metadata)==null?void 0:ma.scoring_metric)??"").trim();if(It&&Et.push(`Scoring ${It}`),oe.status==="failed"&&jt){const ws=jt.replace(/\s+/g," ");Et.push(`Error: ${ws}`)}return it&&Et.push(`Updated ${it}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["Run ",oe.run_number]}),"  ",Me,Et.length?`  ${Et.join("  ")}`:""]},oe.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:go,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Yt,disabled:!bs||da,children:da?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),A&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:A})]}),K&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]}),ca.map((oe,Me)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:oe},`tuning-prereq-${Me}`)),_o instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:_o.message}),ue&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:ue}),ci&&!(_o instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:ci.message||"Unable to load tuning jobs."}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:D>1?a.jsxs("span",{children:["Queued ",D," tuning jobs. Latest job ",O.id," (run ",O.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",O.id," queued (run ",O.run_number,")."]})}),dt&&Vt.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",Vt.parameterCount," hyperparameter",Vt.parameterCount===1?"":"s",Vt.candidateProduct!==null?`  up to ${Vt.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsxs("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:[Lt.length===0&&a.jsx("p",{style:{margin:"0",padding:"1rem 1.25rem",border:"1px dashed rgba(148, 163, 184, 0.4)",borderRadius:"6px",color:"rgba(148, 163, 184, 0.85)",background:"rgba(15, 23, 42, 0.35)"},children:'No tuning strategies configured yet. Use "Add strategy" to define your search plan.'}),Lt.map((oe,Me)=>{const je=Da[Me],Ge=!!(Kt&&Kt.id===oe.id),qe=Ut.has(oe.id),Le=[];if(je!=null&&je.modelLabel&&Le.push(je.modelLabel),je!=null&&je.searchStrategyLabel&&Le.push(je.searchStrategyLabel),je!=null&&je.scoringLabel&&Le.push(`Scoring ${je.scoringLabel}`),je!=null&&je.parameterCount){const it=je.candidateCount?`${je.parameterCount} param${je.parameterCount===1?"":"s"}  ${je.candidateCount} candidate${je.candidateCount===1?"":"s"}`:`${je.parameterCount} param${je.parameterCount===1?"":"s"}`;Le.push(it)}else Le.includes("Needs attention")||Le.push("No search values");je!=null&&je.hasErrors&&Le.push("Needs attention");const _t=Le.length>0?Le.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{tr(oe.id),Ge||Is(oe.id)},"aria-expanded":qe,"aria-controls":`tuning-strategy-body-${oe.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${qe?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(je==null?void 0:je.label)??Jo(Me+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:_t})]})]}),Lt.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>La(oe.id),"aria-label":`Remove ${(je==null?void 0:je.label)??Jo(Me+1)}`,children:"Remove"})]}),qe&&Ge&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${oe.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Vc&&d(Vc),p&&d(p),(Fe==="random"||Fe==="optuna")&&_&&d(_),(Fe==="random"||Fe==="optuna")&&v&&d(v)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:oa}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:ia}),a.jsxs("div",{id:Ee,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:ra||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[aa.map(it=>a.jsx("button",{type:"button",onClick:()=>En(it.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:ra===it.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:ra===it.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:it.label},it.value)),a.jsx("button",{type:"button",onClick:()=>En(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),ee&&V.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Ot>0?`${Ot} override${Ot===1?"":"s"} configured`:"Using template defaults"}),Ot>0&&a.jsx("button",{type:"button",onClick:ds,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),Oe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Oe}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:V.map(gn)})]}),ee&&V.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Ft>0?`${Ft} parameter${Ft===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:tn,disabled:Ft===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Ft===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:Ft===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:Ft===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),Ie&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Ie}),Qe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:V.map(ss)})]})]})]},oe.id)})]}),pe&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",ge," folds before reporting aggregate metrics."]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:gl,disabled:vo,children:Ir?"Queuing":"Launch tuning job"})}),da&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!da&&ua.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),ua.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:ua.map(Wc)})]})},t_={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},N2=(e,t)=>{if(e==null||e==="")return t_[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return t_[t].auto;const r=Math.max(Math.min(e,1),0),i=r*100,l=r.toFixed(r>=.1||r===0?2:3),u=t==="undersampling"?"majority":"majority baseline";return`${l} ratio (${i.toFixed(1)}% of ${u})`}const n=e.trim().toLowerCase();return t_[t][n]??n},S2=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let r=e.length-1;r>=0;r-=1){const i=e[r];if(typeof i!="string")continue;const l=i.toLowerCase();if(n.some(u=>l.includes(u)))return i}return null},C2=(e,t)=>t?"Missing":e.length?e:"Empty string",E2=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:r,onRefreshPreview:i,config:l,methodParameter:u,targetColumnParameter:d,samplingStrategyParameter:m,randomStateParameter:y,replacementParameter:p,kNeighborsParameter:_,renderParameterField:v,formatMetricValue:w,formatMissingPercentage:x,schemaGuard:S})=>{var H;const E=r.data,A=r.status,P=Array.isArray(E==null?void 0:E.applied_steps)?E==null?void 0:E.applied_steps:[],T=f.useMemo(()=>S2(P,e),[P,e]),j=(l==null?void 0:l.targetColumn)??"",O=(l==null?void 0:l.method)||(typeof(u==null?void 0:u.default)=="string"?u.default:""),k=f.useMemo(()=>{const Q=Array.isArray(u==null?void 0:u.options)?u==null?void 0:u.options:[];if(O){const ee=Q.find(G=>G.value===O);return ee!=null&&ee.label?ee.label:O.replace(/_/g," ")}return Q.length>0?Q[0].label??Q[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[O,u==null?void 0:u.options,e]),D=f.useMemo(()=>N2(l==null?void 0:l.samplingStrategy,e),[l==null?void 0:l.samplingStrategy,e]),$=f.useMemo(()=>(l==null?void 0:l.randomState)===null||(l==null?void 0:l.randomState)===void 0?"Not set":Number.isFinite(l.randomState)?String(l.randomState):"Not set",[l==null?void 0:l.randomState]),B=f.useMemo(()=>{if(e!=="oversampling")return null;const Q=l==null?void 0:l.kNeighbors;if(typeof Q=="number"&&Number.isFinite(Q))return String(Math.max(1,Math.round(Q)));if(_&&typeof _.default=="number"){const ee=_.default;if(Number.isFinite(ee))return String(Math.max(1,Math.round(ee)))}return"Default"},[l==null?void 0:l.kNeighbors,_,e]),q=(l==null?void 0:l.replacement)===null||(l==null?void 0:l.replacement)===void 0?null:l.replacement?"With replacement":"Without replacement",K=f.useMemo(()=>{if(A!=="success"||!E||!j)return{rows:[],total:0,truncated:!1};const Q=Array.isArray(E.sample_rows)?E.sample_rows:[];if(!Q.length)return{rows:[],total:0,truncated:!1};const ee=new Map;Q.forEach(ge=>{if(!ge||typeof ge!="object")return;const He=ge[j],lt=He==null,Ye=lt?"__missing__":String(He),Se=C2(lt?"":Ye,lt),Re=ee.get(Ye);Re?Re.count+=1:ee.set(Ye,{label:Se,count:1,percentage:0,isMissing:lt})});const G=Array.from(ee.values()).sort((ge,He)=>He.count-ge.count),V=G.reduce((ge,He)=>ge+He.count,0),Z=8,de=G.length>Z;return{rows:(de?G.slice(0,Z):G).map(ge=>({...ge,percentage:V>0?ge.count/V*100:0})),total:V,truncated:de}},[E,A,j]),ne=((H=E==null?void 0:E.metrics)==null?void 0:H.row_count)??null,ue=!!t&&n&&A!=="loading"&&!(S!=null&&S.blocked),z=f.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),X=f.useMemo(()=>!(S!=null&&S.blocked)||!S.details.length?"":S.details.map(Q=>Q.logical_family?`${Q.name} (${Q.logical_family})`:Q.name).join(", "),[S]),Y=!j,W=!!j&&Array.isArray(E==null?void 0:E.columns)&&!(E!=null&&E.columns.includes(j)),F=e==="undersampling"?"Class undersampling":"Class oversampling",te=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",U=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:F}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:!ue,children:A==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:te}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),Y&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",U,"."]}),(S==null?void 0:S.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.message,X&&a.jsxs(a.Fragment,{children:[" ","Columns: ",X,"."]})]}),A==="error"&&r.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r.error}),W&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",j," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:T}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:k})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:D})]}),e==="oversampling"&&B&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:B})]}),q&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:q})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:$})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&v(u),m&&v(m),e==="oversampling"&&_&&v(_),y&&v(y),p&&v(p)]}),d&&a.jsx("div",{className:"canvas-modal__parameter-list",children:v(d)}),j&&A==="success"&&!W&&(K.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:K.rows.map(Q=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:Q.label}),a.jsx("td",{children:w(Q.count)}),a.jsx("td",{children:x(Q.percentage)})]},`resampling-class-${Q.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",w(K.total)," row",K.total===1?"":"s"," from the preview.",K.truncated?" Showing top classes by frequency.":""]}),ne!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",w(ne),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},k2=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},M2=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),A2=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),O2=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return f.useMemo(()=>{const r=k2(e),i=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",l=t==="missing_value_indicator",u=t==="replace_aliases_typos",d=t==="trim_whitespace",m=t==="remove_special_characters",y=t==="replace_invalid_values",p=t==="regex_replace_fix",_=t==="normalize_text_case",v=t==="standardize_date_formats",w=t==="label_encoding",x=t==="target_encoding",S=t==="hash_encoding",E=t==="train_model_draft",A=t==="model_evaluation",P=t==="model_registry_overview",T=t==="hyperparameter_tuning",j=t==="feature_target_split",O=t==="train_test_split",k=t==="class_undersampling",D=t==="class_oversampling",$=t==="ordinal_encoding",B=t==="dummy_encoding",q=t==="one_hot_encoding",K=t==="feature_math",ne=t==="cast_column_types",ue=t==="binning_discretization",z=t==="scale_numeric_features",X=t==="polynomial_features",Y=t==="feature_selection",W=t==="transformer_audit",F=t==="outlier_removal",te=t==="skewness_transform",U=t==="skewness_distribution",H=t==="binned_distribution",Q=A2.has(t),ee=M2.has(t),G=t==="remove_duplicates",V=t==="drop_missing_columns",Z=t==="drop_missing_rows";return{catalogType:t,isDataset:r,isImputerNode:i,isMissingIndicatorNode:l,isReplaceAliasesNode:u,isTrimWhitespaceNode:d,isRemoveSpecialCharsNode:m,isReplaceInvalidValuesNode:y,isRegexCleanupNode:p,isNormalizeTextCaseNode:_,isStandardizeDatesNode:v,isLabelEncodingNode:w,isTargetEncodingNode:x,isHashEncodingNode:S,isTrainModelDraftNode:E,isModelEvaluationNode:A,isModelRegistryNode:P,isHyperparameterTuningNode:T,isFeatureTargetSplitNode:j,isTrainTestSplitNode:O,isClassUndersamplingNode:k,isClassOversamplingNode:D,isOrdinalEncodingNode:$,isDummyEncodingNode:B,isOneHotEncodingNode:q,isFeatureMathNode:K,isCastNode:ne,isBinningNode:ue,isScalingNode:z,isPolynomialFeaturesNode:X,isFeatureSelectionNode:Y,isTransformerAuditNode:W,isOutlierNode:F,isSkewnessNode:te,isSkewnessDistributionNode:U,isBinnedDistributionNode:H,isDataConsistencyNode:Q,isInspectionNode:ee,isRemoveDuplicatesNode:G,isDropMissingColumnsNode:V,isDropMissingRowsNode:Z,isDropMissingNode:V||Z}},[t,e])},P2=({isScalingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(null),[d,m]=f.useState(null),[y,p]=f.useState(!1),[_,v]=f.useState(0),w=f.useCallback(()=>{v(x=>x+1)},[]);return f.useEffect(()=>{let x=!0;return e?t?n?(p(!0),m(null),mx(t,{graph:r,targetNodeId:i}).then(S=>{x&&u(S??null)}).catch(S=>{x&&(u(null),m((S==null?void 0:S.message)??"Unable to load scaling insights"))}).finally(()=>{x&&p(!1)}),()=>{x=!1}):(u(null),m("Connect this step to an upstream output to load scaling insights."),p(!1),()=>{x=!1}):(u(null),m("Select a dataset to load scaling insights."),p(!1),()=>{x=!1}):(u(null),m(null),p(!1),()=>{x=!1})},[r,n,e,_,t,i]),{scalingData:l,scalingError:d,isFetchingScaling:y,refreshScaling:w}},T2=({isBinningNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(null),[d,m]=f.useState(null),[y,p]=f.useState(!1),[_,v]=f.useState(0),w=f.useCallback(()=>{v(x=>x+1)},[]);return f.useEffect(()=>{let x=!0;return e?t?n?(p(!0),m(null),fx(t,{graph:r,targetNodeId:i}).then(S=>{x&&u(S??null)}).catch(S=>{x&&(u(null),m((S==null?void 0:S.message)??"Unable to load binning insights"))}).finally(()=>{x&&p(!1)}),()=>{x=!1}):(u(null),m("Connect this step to an upstream output to analyse numeric columns."),p(!1),()=>{x=!1}):(u(null),m("Select a dataset to load binning insights."),p(!1),()=>{x=!1}):(u(null),m(null),p(!1),()=>{x=!1})},[r,n,e,_,t,i]),{binningData:l,binningError:d,isFetchingBinning:y,refreshBinning:w}},$2=({shouldLoad:e,sourceId:t,graphContext:n,targetNodeId:r,transformations:i})=>{const[l,u]=f.useState(null),[d,m]=f.useState(null),[y,p]=f.useState(!1),[_,v]=f.useState(0),w=f.useRef(null),x=f.useCallback(()=>{v(S=>S+1)},[]);return f.useEffect(()=>{let S=!0;return e?t?(w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{if(!S)return;p(!0),m(null);let E;i.length>0&&(E=i.map(A=>({column:A.column,method:A.method}))),dx(t,{transformations:E,graph:n,targetNodeId:r}).then(A=>{S&&u(A??null)}).catch(A=>{S&&(u(null),m((A==null?void 0:A.message)??"Unable to load skewness insights"))}).finally(()=>{S&&p(!1)})},300),()=>{S=!1,w.current&&clearTimeout(w.current)}):(u(null),m("Select a dataset to load skewness insights."),p(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{S=!1}):(u(null),m(null),p(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{S=!1})},[n,_,e,t,r,i]),{skewnessData:l,skewnessError:d,isFetchingSkewness:y,refreshSkewness:x}},L2=({isBinnedDistributionNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i,samplePreset:l})=>{const[u,d]=f.useState(null),[m,y]=f.useState(null),[p,_]=f.useState(!1),[v,w]=f.useState(0),x=f.useCallback(()=>{w(S=>S+1)},[]);return f.useEffect(()=>{let S=!0;if(!e)return d(null),y(null),_(!1),()=>{S=!1};if(!t)return d(null),y("Select a dataset to load binned column distributions."),_(!1),()=>{S=!1};if(!n)return d(null),y("Connect this step to an upstream output to load binned column distributions."),_(!1),()=>{S=!1};_(!0),y(null);const E=gd.find(P=>P.value===l)??gd[0],A=E.value==="all"?"all":Number(E.value);return px(t,{sampleSize:A,graph:r,targetNodeId:i}).then(P=>{S&&d(P??null)}).catch(P=>{S&&(d(null),y((P==null?void 0:P.message)??"Unable to load binned column distributions"))}).finally(()=>{S&&_(!1)}),()=>{S=!1}},[r,n,e,v,l,t,i]),{binnedDistributionData:u,binnedDistributionError:m,isFetchingBinnedDistribution:p,refreshBinnedDistribution:x}},Md={status:"idle",data:null,error:null},D2=1e3,z2=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:r,isPreviewNode:i,targetNodeId:l,previewSignature:u,skipPreview:d=!1,requestPreviewRows:m,includeSignals:y})=>{const[p,_]=f.useState(Md),[v,w]=f.useState(0),x=f.useRef(null),S=f.useRef(-1),E=f.useCallback(()=>{w(A=>A+1)},[]);return f.useEffect(()=>{if(!e){_(Md),x.current=null,S.current=-1;return}if(d)return;if(!t){_(i?{status:"error",data:null,error:"Select a dataset to generate previews."}:Md);return}if(!n){_(i?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:Md);return}if(!r)return;const A=(()=>{const B=Array.isArray(r.nodes)?r.nodes.map(K=>K&&typeof K.id=="string"?K.id:null).filter(K=>!!K).sort():[],q=Array.isArray(r.edges)?r.edges.map(K=>{const ne=K&&typeof K.source=="string"?K.source.trim():"",ue=K&&typeof K.target=="string"?K.target.trim():"";return ne&&ue?`${ne}->${ue}`:null}).filter(K=>!!K).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:l??null,nodeIds:B,edgePairs:q})})(),P=u??A,T=P!==x.current;if(!(S.current!==v)&&!T)return;x.current=P,S.current=v;let O=!0;_(B=>({status:"loading",data:B.data??null,error:null}));const k=m??i,D=y??k,$={dataset_source_id:t,graph:{nodes:r.nodes,edges:r.edges},target_node_id:l??void 0,include_preview_rows:k,include_signals:D};return k&&($.sample_size=D2),wx($).then(B=>{O&&_({status:"success",data:B,error:null})}).catch(B=>{O&&_(i?{status:"error",data:null,error:(B==null?void 0:B.message)??"Unable to generate preview."}:Md)}),()=>{O=!1}},[n,r,i,d,u,v,e,t,l]),{previewState:p,refreshPreview:E}},R2=({shouldLoad:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i,setAvailableColumns:l,setColumnMissingMap:u})=>{const[d,m]=f.useState(!1),[y,p]=f.useState(null),[_,v]=f.useState(0),w=f.useCallback(()=>{!e||!t||!n||v(x=>x+1)},[n,e,t]);return f.useEffect(()=>{let x=!0;return e?t?n?(m(!0),p(null),Mg(t,{graph:r,targetNodeId:i}).then(S=>{if(!x)return;const E={};S&&typeof S=="object"&&(S!=null&&S.column_missing_map)&&typeof S.column_missing_map=="object"&&Object.entries(S.column_missing_map).forEach(([T,j])=>{const O=String(T??"").trim();if(!O)return;const k=Number(j);Number.isNaN(k)||k<0||(E[O]=Number(k))});const A=new Set;Array.isArray(S==null?void 0:S.all_columns)&&S.all_columns.forEach(T=>{const j=String(T??"").trim();j&&A.add(j)}),Object.keys(E).forEach(T=>A.add(T));const P=Array.from(A).sort((T,j)=>T.localeCompare(j));P.forEach(T=>{Object.prototype.hasOwnProperty.call(E,T)||(E[T]=0)}),P.length&&l(P),Object.keys(E).length&&u(T=>({...T,...E}))}).catch(S=>{x&&p((S==null?void 0:S.message)??"Unable to load column metrics.")}).finally(()=>{x&&m(!1)}),()=>{x=!1}):(p("Connect this step to an upstream output to load column metrics."),m(!1),()=>{x=!1}):(p("Select a dataset to load column metrics."),m(!1),()=>{x=!1}):()=>{x=!1}},[r,n,_,l,u,e,t,i]),{isFetching:d,error:y,refreshDropColumnRecommendations:w}},jw={enabled:!1,explicit:!1},F2={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},I2={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},B2={},U2=[],q2=({isReplaceAliasesNode:e,configState:t,nodeConfig:n,availableColumns:r,columnTypeMap:i,previewSampleRows:l})=>{const u=f.useMemo(()=>{if(!e)return jw;const S=Ac(t);if(S!==void 0)return{enabled:!!tl(S),explicit:!0};if(n&&typeof n=="object"){const E=Ac(n);if(E!==void 0)return{enabled:!!tl(E),explicit:!0}}return jw},[t,e,n]),d=f.useMemo(()=>{if(!e)return[];const S=mt((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),E=Pf(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),A=(()=>{const T=Ac(t);if(T!==void 0){const j=tl(T);if(j!==null)return j}if(n&&typeof n=="object"){const j=Ac(n);if(j!==void 0){const O=tl(j);if(O!==null)return O}}return S.length===0})(),P=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return Yx(P,{mode:E,columns:S,autoDetect:A})},[t,e,n]),m=f.useMemo(()=>e?d.length?Array.from(new Set(d.flatMap(S=>S.columns.map(E=>E.trim()).filter(Boolean)))).sort((S,E)=>S.localeCompare(E)):mt(t==null?void 0:t.columns):[],[d,t==null?void 0:t.columns,e]),y=f.useMemo(()=>e?d.length?d.some(S=>S.autoDetect):u.explicit?u.enabled:m.length===0:!1,[u.enabled,u.explicit,m.length,d,e]),p=f.useMemo(()=>{if(e)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,e]),_=f.useMemo(()=>e?vA(l):B2,[e,l]),v=f.useMemo(()=>e?mA({selectedColumns:m,availableColumns:r,columnTypeMap:i,autoDetectEnabled:y}):F2,[y,m,r,i,e]),w=f.useMemo(()=>e?hA(p):I2,[e,p]),x=f.useMemo(()=>{if(!e)return U2;const S=new Set(v.recommendedColumns),E=new Set(v.textColumns);return r.map(A=>{const P=i[A]??null,T=_[A]??[];return{name:A,dtype:P,samples:T.slice(0,3),isRecommended:S.has(A),isTextLike:E.has(A)}})},[v.recommendedColumns,v.textColumns,_,r,i,e]);return{aliasAutoDetectMeta:u,aliasStrategies:d,aliasStrategyCount:d.length,aliasSelectedColumns:m,aliasAutoDetectEnabled:y,replaceAliasesCustomPairsValue:p,aliasColumnSummary:v,aliasCustomPairSummary:w,aliasSampleMap:_,aliasColumnOptions:x}},H2=({isOutlierNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(null),[d,m]=f.useState(null),[y,p]=f.useState(!1),[_,v]=f.useState(0),w=f.useCallback(()=>{v(x=>x+1)},[]);return f.useEffect(()=>{let x=!0;return e?t?n?(p(!0),m(null),hx(t,{graph:r,targetNodeId:i}).then(S=>{x&&u(S??null)}).catch(S=>{x&&(u(null),m((S==null?void 0:S.message)??"Unable to load outlier insights"))}).finally(()=>{x&&p(!1)}),()=>{x=!1}):(u(null),m("Connect this step to an upstream output to load outlier insights."),p(!1),()=>{x=!1}):(u(null),m("Select a dataset to load outlier insights."),p(!1),()=>{x=!1}):(u(null),m(null),p(!1),()=>{x=!1})},[r,n,e,_,t,i]),{outlierData:l,outlierError:d,isFetchingOutliers:y,refreshOutliers:w}},V2=["int","float","double","decimal","number","numeric","long","short"],W2=["datetime","date","time","timestamp"],K2=["object","string","text","category","categorical","char"],Y2=({shouldAnalyze:e,availableColumns:t,columnTypeMap:n,previewSampleRows:r})=>{const i=f.useMemo(()=>{if(!e)return{excluded:new Set,reasons:new Map};const l=new Set,u=new Map;return t.forEach(d=>{const m=(n[d]??"").toLowerCase(),y=V2.some(A=>m.includes(A)),p=W2.some(A=>m.includes(A)),_=K2.some(A=>m.includes(A));if(m.includes("bool")){l.add(d),u.set(d,"Boolean dtype");return}if((p||_)&&!y){l.add(d),u.set(d,"Non-numeric dtype");return}const v=r.map(A=>A&&Object.prototype.hasOwnProperty.call(A,d)?A[d]:void 0).filter(A=>A!=null);if(!v.length){y||(l.add(d),u.set(d,"No numeric samples"));return}let w=!0,x=!1,S=!1;const E=new Set;for(const A of v){if(typeof A=="boolean"){E.add(A?"1":"0");continue}if(typeof A=="number"){if(!Number.isFinite(A)){w=!1;break}x=!0,Math.abs(A)<1e-9?E.add("0"):Math.abs(A-1)<1e-9?E.add("1"):S=!0;continue}if(typeof A=="string"){const P=A.trim();if(!P)continue;const T=P.toLowerCase();if(sw.has(T)){E.add("1");continue}if(rw.has(T)){E.add("0");continue}const j=Number(P);if(!Number.isNaN(j)&&Number.isFinite(j)){x=!0,Math.abs(j)<1e-9?E.add("0"):Math.abs(j-1)<1e-9?E.add("1"):S=!0;continue}w=!1;break}w=!1;break}if(!w||!x&&!y){l.add(d),u.set(d,"Non-numeric values");return}!S&&E.size>0&&Array.from(E).every(P=>P==="0"||P==="1")&&(l.add(d),u.set(d,"Binary/bool-like values"))}),{excluded:l,reasons:u}},[t,n,r,e]);return{numericExcludedColumns:i.excluded,numericExclusionReasons:i.reasons}},Q2=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},G2=({isBinningNode:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:r,availableColumns:i,recommendedColumns:l})=>{const u=f.useMemo(()=>{if(!l)return null;const p=new Set;for(const _ of l){const v=typeof _=="string"?_.trim():"";v&&p.add(v)}return p.size>0?p:null},[l]),d=f.useMemo(()=>{if(!Array.isArray(n)||!n.length)return null;const p=new Set;return n.forEach(_=>{const v=typeof _=="string"?_.trim():"";v&&p.add(v)}),p.size>0?p:null},[n]),m=f.useMemo(()=>{if(!e)return new Set;if(!t.size||!u&&!d)return t;const p=new Set;return t.forEach(_=>{u!=null&&u.has(_)||d!=null&&d.has(_)||p.add(_)}),p},[e,t,u,d]),y=f.useMemo(()=>{if(!e||!r.length)return{};const p={};return i.forEach(_=>{if(m.has(_))return;let v=null,w=null;const x=new Set;if(r.forEach(S=>{if(!S||!Object.prototype.hasOwnProperty.call(S,_))return;const E=Q2(S[_]);E!==null&&((v===null||E<v)&&(v=E),(w===null||E>w)&&(w=E),x.size<=1e3&&x.add(E))}),v!==null||w!==null){const S=x.size>0?x.size:null;p[_]={min:v,max:w,distinct:S}}}),p},[i,m,e,r]);return{binningExcludedColumns:m,binningColumnPreviewMap:y,manualBoundColumns:[],manualRangeFallbackMap:{}}},Xs=["iqr","zscore","elliptic_envelope","winsorize","manual"],al={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},Yf={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},Zo={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Qf=(e,{min:t,max:n}={})=>{const r=typeof e=="number"?e:Number(e);if(!Number.isFinite(r))return null;let i=r;return typeof t=="number"&&Number.isFinite(t)&&i<t&&(i=t),typeof n=="number"&&Number.isFinite(n)&&i>n&&(i=n),i},Nw=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const r=String(n??"").trim();r&&t.push(r)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,r)=>n.localeCompare(r))},X2=e=>{const t={iqr:{...Zo.iqr},zscore:{...Zo.zscore},elliptic_envelope:{...Zo.elliptic_envelope},winsorize:{...Zo.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,r])=>{const i=n.trim().toLowerCase();if(!Xs.includes(i))return;const l=t[i]??{};if(!(!r||typeof r!="object"||Array.isArray(r))){if(Object.entries(r).forEach(([u,d])=>{const m=u.trim().toLowerCase();if(!Yf[i].includes(m))return;let y={};m==="threshold"?y={min:.1}:m==="multiplier"?y={min:.1}:(m==="lower_percentile"||m==="upper_percentile")&&(y={min:0,max:100});const p=Qf(d,y);p!==null&&(l[m]=p)}),i==="winsorize"){const u=Qf(l.lower_percentile,{min:0,max:100}),d=Qf(l.upper_percentile,{min:0,max:100});typeof u=="number"&&typeof d=="number"&&u>=d?(l.lower_percentile=Zo.winsorize.lower_percentile,l.upper_percentile=Zo.winsorize.upper_percentile):(typeof u=="number"&&(l.lower_percentile=u),typeof d=="number"&&(l.upper_percentile=d))}t[i]=l}}),t},J2=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,r])=>{const i=String(n??"").trim();if(!i||!r||typeof r!="object"||Array.isArray(r))return;const l={};Object.entries(r).forEach(([u,d])=>{const m=u.trim().toLowerCase();if(!Object.values(Yf).some(v=>v.includes(m)))return;let p={};m==="threshold"?p={min:.1}:m==="multiplier"?p={min:.1}:m==="contamination"?p={min:1e-4,max:.49}:(m==="lower_percentile"||m==="upper_percentile")&&(p={min:0,max:100});const _=Qf(d,p);_!==null&&(l[m]=_)}),Object.keys(l).length&&(t[i]=l)}),t},Z2=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=Nw(t.columns),r=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",i=Xs.includes(r)?r:"iqr",l={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([p,_])=>{const v=String(p??"").trim(),w=typeof _=="string"?_.trim().toLowerCase():"";v&&Xs.includes(w)&&(l[v]=w)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=Nw(t.skipped_columns),m=X2(t.method_parameters),y=J2(t.column_parameters);return{columns:n,defaultMethod:i,columnMethods:l,autoDetect:u,skippedColumns:d,methodParameters:m,columnParameters:y}},e$=e=>{const t={...al};return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";r&&i&&Xs.includes(r)&&(t[r]=i)}),t},t$=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;r&&Xs.includes(r)&&t.set(r,n)}),t},n$=e=>Xs.map(t=>({value:t,label:e[t]??al[t]??t})),s$=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:r,skippedColumns:i,excludedColumns:l})=>{if(!e.length)return[];const u=[];return e.forEach(d=>{const m=String((d==null?void 0:d.column)??"").trim();if(!m)return;const y={};Array.isArray(d==null?void 0:d.method_summaries)&&d.method_summaries.forEach(T=>{const j=T==null?void 0:T.method;j&&Xs.includes(j)&&(y[j]=T)});const p=d!=null&&d.recommended_method&&Xs.includes(d.recommended_method)?d.recommended_method:null,_=p?n[p]??al[p]??p:null,v=t.columnMethods[m]??null,w=v??t.defaultMethod,x=n[w]??al[w]??w,S=i.has(m),E=l.has(m),A=r.has(m),P=!!(d!=null&&d.has_missing);u.push({column:m,dtype:typeof(d==null?void 0:d.dtype)=="string"?d.dtype:null,stats:(d==null?void 0:d.stats)??{},recommendedMethod:p,recommendedLabel:_,recommendedReason:typeof(d==null?void 0:d.recommended_reason)=="string"?d.recommended_reason:null,methodSummaries:y,currentOverride:v,currentMethod:w,currentMethodLabel:x,isOverrideApplied:v!==null,isSelected:A,isSkipped:S,isExcluded:E,hasMissing:P})}),u.sort((d,m)=>d.column.localeCompare(m.column)),u},r$=(e,t,n,r)=>{if(!e.length)return null;const i=e.map(l=>{const u=t[l],d=u?n[u]??al[u]??u:null;return d?`${l} -> ${d}`:l});return r>e.length&&i.push(""),i.join(", ")},a$=({isScalingNode:e,isBinningNode:t,isOutlierNode:n,scalingExcludedColumns:r,binningExcludedColumns:i,outlierExcludedColumns:l,setConfigState:u})=>{f.useEffect(()=>{!e||r.size===0||u(d=>{if(!d||typeof d!="object")return d;const m=mt(d.columns);if(!m.length)return d;const y=m.filter(_=>!r.has(_));if(y.length===m.length||!y.length)return d;const p={...d,columns:y};if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const _={};let v=!1;Object.entries(d.column_methods).forEach(([w,x])=>{const S=String(w??"").trim();if(!S)return;if(r.has(S)){v=!0;return}const E=typeof x=="string"?x.trim():null;E&&jr.includes(E)&&(_[S]=E)}),v?Object.keys(_).length?p.column_methods=_:p.column_methods={}:p.column_methods=d.column_methods}return p})},[e,r,u]),f.useEffect(()=>{!t||i.size===0||u(d=>{if(!d||typeof d!="object")return d;const m=mt(d.columns);if(!m.length)return d;const y=m.filter(v=>!i.has(v));if(y.length===m.length)return d;const p=new Set(m.filter(v=>i.has(v))),_={...d,columns:y};if(d.custom_bins&&typeof d.custom_bins=="object"&&!Array.isArray(d.custom_bins)){const v={};Object.entries(d.custom_bins).forEach(([w,x])=>{!p.has(w)&&Array.isArray(x)&&x.length&&(v[w]=[...x])}),Object.keys(v).length?_.custom_bins=v:Object.prototype.hasOwnProperty.call(_,"custom_bins")&&delete _.custom_bins}if(d.custom_labels&&typeof d.custom_labels=="object"&&!Array.isArray(d.custom_labels)){const v={};Object.entries(d.custom_labels).forEach(([w,x])=>{!p.has(w)&&Array.isArray(x)&&x.length&&(v[w]=x.map(S=>String(S)))}),Object.keys(v).length?_.custom_labels=v:Object.prototype.hasOwnProperty.call(_,"custom_labels")&&delete _.custom_labels}return _})},[i,t,u]),f.useEffect(()=>{!n||l.size===0||u(d=>{if(!d||typeof d!="object")return d;const m=mt(d.columns),y=m.filter(P=>!l.has(P)),p=y.length!==m.length,_=mt(d.skipped_columns),v=_.filter(P=>!l.has(P)),w=v.length!==_.length,x=P=>P??{...d};let S=null;p&&(S=x(S),S.columns=y.sort((P,T)=>P.localeCompare(T))),w&&(S=x(S),v.length?S.skipped_columns=v.sort((P,T)=>P.localeCompare(T)):Object.prototype.hasOwnProperty.call(S,"skipped_columns")&&delete S.skipped_columns);let E=!1;if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const P={};Object.entries(d.column_methods).forEach(([T,j])=>{const O=String(T??"").trim();if(!O||l.has(O)){E=!0;return}const k=typeof j=="string"?j.trim():null;k&&Xs.includes(k)?P[O]=k:E=!0}),E&&(S=x(S),Object.keys(P).length?S.column_methods=P:Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods)}let A=!1;if(d.column_parameters&&typeof d.column_parameters=="object"&&!Array.isArray(d.column_parameters)){const P={};Object.entries(d.column_parameters).forEach(([T,j])=>{const O=String(T??"").trim();if(!O||l.has(O)){A=!0;return}if(!j||typeof j!="object"||Array.isArray(j)){A=!0;return}P[O]={...j}}),A&&(S=x(S),Object.keys(P).length?S.column_parameters=P:Object.prototype.hasOwnProperty.call(S,"column_parameters")&&delete S.column_parameters)}return S||d})},[n,l,u])},o$=({isTrimWhitespaceNode:e,isRemoveSpecialCharsNode:t,isRegexCleanupNode:n,isNormalizeTextCaseNode:r,configState:i,nodeConfig:l,availableColumns:u,columnTypeMap:d,previewSampleRows:m})=>{const y=f.useMemo(()=>QA(e?i==null?void 0:i.mode:void 0,e?l==null?void 0:l.mode:void 0),[i==null?void 0:i.mode,e,l==null?void 0:l.mode]),p=f.useMemo(()=>e?mt(i==null?void 0:i.columns):[],[i==null?void 0:i.columns,e]),_=f.useMemo(()=>e?nO(m):{},[e,m]),v=f.useMemo(()=>e?JA({selectedColumns:p,availableColumns:u,columnTypeMap:d,sampleMap:_}):rO,[u,d,e,p,_]),w=f.useMemo(()=>GA(y),[y]),x=f.useMemo(()=>gO(t?i==null?void 0:i.mode:void 0,t?l==null?void 0:l.mode:void 0),[i==null?void 0:i.mode,t,l==null?void 0:l.mode]),S=f.useMemo(()=>t?mt(i==null?void 0:i.columns):[],[i==null?void 0:i.columns,t]),E=f.useMemo(()=>t?xO(m):{},[t,m]),A=f.useMemo(()=>t?yO({selectedColumns:S,availableColumns:u,columnTypeMap:d,sampleMap:E}):jO,[u,d,t,S,E]),P=f.useMemo(()=>_O(x),[x]),T=f.useMemo(()=>QO(n?i==null?void 0:i.mode:void 0,n?l==null?void 0:l.mode:void 0),[i==null?void 0:i.mode,n,l==null?void 0:l.mode]),j=f.useMemo(()=>n?mt(i==null?void 0:i.columns):[],[i==null?void 0:i.columns,n]),O=f.useMemo(()=>n?eP(m):{},[n,m]),k=f.useMemo(()=>n?JO({selectedColumns:j,availableColumns:u,columnTypeMap:d,sampleMap:O}):sP,[u,d,n,j,O]),D=f.useMemo(()=>GO(T),[T]),$=f.useMemo(()=>{if(!n)return null;const z=(i==null?void 0:i.replacement)??(l==null?void 0:l.replacement)??null;return typeof z=="string"?z:null},[i==null?void 0:i.replacement,n,l==null?void 0:l.replacement]),B=f.useMemo(()=>TO(r?i==null?void 0:i.mode:void 0,r?l==null?void 0:l.mode:void 0),[i==null?void 0:i.mode,r,l==null?void 0:l.mode]),q=f.useMemo(()=>r?mt(i==null?void 0:i.columns):[],[i==null?void 0:i.columns,r]),K=f.useMemo(()=>r?RO(m):{},[r,m]),ne=f.useMemo(()=>r?DO({selectedColumns:q,availableColumns:u,columnTypeMap:d,sampleMap:K,mode:B}):IO,[u,d,r,q,B,K]),ue=f.useMemo(()=>$O(B),[B]);return{trimWhitespace:{columnSummary:v,sampleMap:_,modeDetails:w},removeSpecial:{columnSummary:A,sampleMap:E,modeDetails:P,selectedMode:x},regexCleanup:{columnSummary:k,sampleMap:O,modeDetails:D,selectedMode:T,replacementValue:$},normalizeCase:{columnSummary:ne,sampleMap:K,modeDetails:ue,selectedMode:B}}},i$={},l$=({isReplaceInvalidValuesNode:e,configState:t,nodeConfig:n,availableColumns:r,columnTypeMap:i,previewSampleRows:l})=>{const u=f.useMemo(()=>hP(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),d=f.useMemo(()=>e?mt(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,e]),m=f.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),x=Number(w);return Number.isFinite(x)?x:null},[t==null?void 0:t.min_value,e,n==null?void 0:n.min_value]),y=f.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),x=Number(w);return Number.isFinite(x)?x:null},[t==null?void 0:t.max_value,e,n==null?void 0:n.max_value]),p=f.useMemo(()=>e?yP(l):i$,[e,l]),_=f.useMemo(()=>e?_P({selectedColumns:d,availableColumns:r,columnTypeMap:i,sampleMap:p}):EP,[r,i,e,p,d]),v=f.useMemo(()=>pP(u),[u]);return{selectedColumns:d,selectedMode:u,modeDetails:v,sampleMap:p,columnSummary:_,minValue:m,maxValue:y}},c$={},u$=({isStandardizeDatesNode:e,configState:t,nodeConfig:n,availableColumns:r,columnTypeMap:i,previewSampleRows:l})=>{const u=f.useMemo(()=>a0(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),d=f.useMemo(()=>e?mt((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,e,n==null?void 0:n.columns]),m=f.useMemo(()=>{if(!e)return[];const x={columns:d,mode:u,autoDetect:d.length===0};return o0((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),x)},[t==null?void 0:t.format_strategies,e,d,n==null?void 0:n.format_strategies,u]),y=f.useMemo(()=>{if(!e)return[];const x=new Set;return m.forEach(S=>{S.columns.forEach(E=>{const A=E.trim();A&&x.add(A)})}),Array.from(x).sort((S,E)=>S.localeCompare(E))},[e,m]),p=f.useMemo(()=>m.some(x=>x.autoDetect),[m]),_=f.useMemo(()=>e?FA(l):c$,[e,l]),v=f.useMemo(()=>{if(!e)return IA;const x=TA({selectedColumns:y,availableColumns:r,columnTypeMap:i,sampleMap:_});return p?{...x,autoDetectionActive:!0}:x},[r,i,p,e,_,y]),w=f.useMemo(()=>{if(!e)return[];const x=new Set(v.recommendedColumns),S=new Set(v.sampleCandidates);return r.map(E=>{const A=i[E]??null,P=_[E]??[];return{name:E,dtype:A,samples:P.slice(0,3),isRecommended:x.has(E),isSampleCandidate:S.has(E)}})},[r,v,i,e,_]);return{selectedMode:u,strategies:m,sampleMap:_,columnSummary:v,columnOptions:w}},d$=({isScalingNode:e,configState:t,numericExcludedColumns:n,scalingData:r})=>{const i=f.useMemo(()=>Bx(t),[t]),l=f.useMemo(()=>new Set(i.skippedColumns),[i.skippedColumns]),u=f.useMemo(()=>e?n:new Set,[e,n]),d=f.useMemo(()=>e?new Set(i.columns):new Set,[e,i.columns]),m=f.useMemo(()=>new Set(Object.keys(i.columnMethods)),[i.columnMethods]),y=f.useMemo(()=>Array.isArray(r==null?void 0:r.columns)?r.columns.filter(ne=>!!(ne&&ne.column)):[],[r==null?void 0:r.columns]),p=f.useMemo(()=>zM(r==null?void 0:r.methods),[r==null?void 0:r.methods]),_=f.useMemo(()=>RM(r==null?void 0:r.methods),[r==null?void 0:r.methods]),v=f.useMemo(()=>IM({recommendations:y,scalingConfig:i,scalingMethodLabelMap:p,scalingSelectedSet:d,scalingSkippedColumns:l,scalingExcludedColumns:u}),[y,i,p,d,l,u]),w=f.useMemo(()=>Array.from(m).sort((ne,ue)=>ne.localeCompare(ue)),[m]),x=f.useMemo(()=>w.slice(0,4),[w]),S=v.length,E=m.size,A=d.size,P=i.autoDetect,T=f.useMemo(()=>_.get(i.defaultMethod)??null,[i.defaultMethod,_]),j=f.useMemo(()=>{const ne=i.defaultMethod;return p[ne]??Zi[ne]??ne},[i.defaultMethod,p]),O=S>0,k=f.useMemo(()=>v.filter(ne=>!ne.isSkipped&&!ne.isExcluded&&ne.isSelected&&ne.recommendedMethod!==ne.currentMethod).length,[v]),D=f.useMemo(()=>v.filter(ne=>ne.isSelected&&!ne.isSkipped&&!ne.isExcluded).length,[v]),$=f.useMemo(()=>v.filter(ne=>ne.isSkipped&&!ne.isExcluded).length,[v]),B=f.useMemo(()=>v.length?k>0?`${k} column${k===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:D>0?"All configured columns align with the recommended scalers.":$>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[k,D,v,$]),q=f.useMemo(()=>FM(p),[p]),K=f.useMemo(()=>BM(x,i.columnMethods,p,E),[x,i.columnMethods,p,E]);return{scalingConfig:i,scalingExcludedColumns:u,scalingMethodDetailMap:_,scalingMethodOptions:q,scalingRecommendations:y,scalingRecommendationRows:v,scalingSelectedCount:A,scalingOverrideCount:E,scalingDefaultDetail:T,scalingDefaultLabel:j,scalingAutoDetectEnabled:P,scalingHasRecommendations:O,scalingStatusMessage:B,scalingOverrideExampleSummary:K}},m$=({isOutlierNode:e,configState:t,numericExcludedColumns:n,outlierData:r})=>{const i=f.useMemo(()=>Z2(t),[t]),l=f.useMemo(()=>Array.isArray(r==null?void 0:r.columns)?r.columns.filter(ne=>!!(ne&&ne.column)):[],[r==null?void 0:r.columns]),u=f.useMemo(()=>new Set(i.skippedColumns),[i.skippedColumns]),d=f.useMemo(()=>e?new Set(i.columns):new Set,[e,i.columns]),m=f.useMemo(()=>{if(!e||!n.size)return new Set;const ne=new Set;i.columns.forEach(z=>{const X=String(z??"").trim();X&&ne.add(X)}),l.forEach(z=>{const X=String((z==null?void 0:z.column)??"").trim();X&&ne.add(X)});const ue=new Set;return n.forEach(z=>{ne.has(z)||ue.add(z)}),ue},[e,n,i.columns,l]),y=f.useMemo(()=>new Set(Object.keys(i.columnMethods)),[i.columnMethods]),p=f.useMemo(()=>e$(r==null?void 0:r.methods),[r==null?void 0:r.methods]),_=f.useMemo(()=>t$(r==null?void 0:r.methods),[r==null?void 0:r.methods]),v=f.useMemo(()=>s$({insights:l,outlierConfig:i,labelMap:p,selectedColumns:d,skippedColumns:u,excludedColumns:m}),[l,i,p,d,u,m]),w=f.useMemo(()=>n$(p),[p]),x=f.useMemo(()=>Array.from(y).sort((ne,ue)=>ne.localeCompare(ue)),[y]),S=f.useMemo(()=>x.slice(0,4),[x]),E=d.size,A=y.size,P=f.useMemo(()=>Object.keys(i.columnParameters).length,[i.columnParameters]),T=i.autoDetect,j=f.useMemo(()=>_.get(i.defaultMethod)??null,[i.defaultMethod,_]),O=f.useMemo(()=>{const ne=i.defaultMethod;return p[ne]??al[ne]??ne},[i.defaultMethod,p]),k=v.length>0,D=f.useMemo(()=>v.filter(ne=>ne.isSkipped||ne.isExcluded||!ne.isSelected||!ne.recommendedMethod?!1:ne.recommendedMethod!==ne.currentMethod).length,[v]),$=f.useMemo(()=>v.filter(ne=>ne.isSelected&&!ne.isSkipped&&!ne.isExcluded).length,[v]),B=f.useMemo(()=>v.filter(ne=>ne.isSkipped&&!ne.isExcluded).length,[v]),q=f.useMemo(()=>v.length?D>0?`${D} column${D===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:$>0?"All configured columns align with the recommended outlier handling strategies.":B>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[D,$,v,B]),K=f.useMemo(()=>r$(S,i.columnMethods,p,A),[S,i.columnMethods,p,A]);return{outlierConfig:i,outlierExcludedColumns:m,outlierMethodLabelMap:p,outlierMethodDetailMap:_,outlierMethodOptions:w,outlierRecommendations:l,outlierRecommendationRows:v,outlierSelectedCount:E,outlierOverrideCount:A,outlierParameterOverrideCount:P,outlierDefaultDetail:j,outlierDefaultLabel:O,outlierAutoDetectEnabled:T,outlierHasRecommendations:k,outlierStatusMessage:q,outlierOverrideExampleSummary:K}},f$=({configState:e,nodeId:t})=>{const n=f.useMemo(()=>$x(e),[e]),r=n.columns.length,i=Og[n.strategy]??n.strategy,l=f.useMemo(()=>Object.keys(n.columnStrategies).map(x=>x.trim()).filter(Boolean).sort((x,S)=>x.localeCompare(S)),[n.columnStrategies]),u=l.length,d=f.useMemo(()=>{if(!l.length)return null;const x=l.slice(0,4);return xM(x,n.columnStrategies,u)},[n.columnStrategies,l,u]),m=f.useMemo(()=>`binning-${t||"node"}`,[t]),y=f.useMemo(()=>({equalWidth:`${m}-equal-width-bins`,equalFrequency:`${m}-equal-frequency-bins`,precision:`${m}-precision`,suffix:`${m}-suffix`,missingLabel:`${m}-missing-label`,includeLowest:`${m}-include-lowest`,dropOriginal:`${m}-drop-original`,labelFormat:`${m}-label-format`,duplicates:`${m}-duplicates`,kbinsNBins:`${m}-kbins-n-bins`,kbinsEncode:`${m}-kbins-encode`,kbinsStrategy:`${m}-kbins-strategy`}),[m]),[p,_]=f.useState({}),[v,w]=f.useState({});return f.useEffect(()=>{_(x=>{const S=new Set,E={...x};return n.columns.forEach(A=>{const P=String(A??"").trim();if(!P||(S.add(P),Object.prototype.hasOwnProperty.call(E,P)))return;const T=n.customBins[P]??[];E[P]=T.length>=2?T.join(", "):""}),Object.keys(E).forEach(A=>{S.has(A)||delete E[A]}),E})},[n.columns,n.customBins]),f.useEffect(()=>{w(x=>{const S=new Set,E={...x};return n.columns.forEach(A=>{const P=String(A??"").trim();if(!P||(S.add(P),Object.prototype.hasOwnProperty.call(E,P)))return;const T=n.customLabels[P]??[];E[P]=T.length>0?T.join(", "):""}),Object.keys(E).forEach(A=>{S.has(A)||delete E[A]}),E})},[n.columns,n.customLabels]),{binningConfig:n,binningSelectedCount:r,binningDefaultLabel:i,binningOverrideColumns:l,binningOverrideCount:u,binningOverrideSummary:d,fieldIds:y,customEdgeDrafts:p,setCustomEdgeDrafts:_,customLabelDrafts:v,setCustomLabelDrafts:w}},h$=({isImputerNode:e,imputerStrategies:t,availableColumns:n,columnMissingMap:r,previewColumns:i,previewColumnStats:l,nodeColumns:u,imputerMissingFilter:d})=>{const m=f.useMemo(()=>{if(!e)return[];const v=i.length?new Set(i.map(T=>typeof T=="string"?T.trim():"").filter(T=>T.length>0)):null,w=new Set;t.forEach(T=>{T.columns.forEach(j=>{const O=typeof j=="string"?j.trim():"";O&&w.add(O)})}),mt(u).forEach(T=>{T&&w.add(T)});const x=T=>!v||v.size===0?!1:!v.has(T)&&!w.has(T),S=new Map,E=(T,j)=>{const O=typeof T=="string"?T.trim():"";if(!O||x(O))return;const k=S.get(O)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};j&&(typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)&&(k.missingPercentage=Math.max(0,j.missingPercentage)),j.dtype!==void 0&&(k.dtype=j.dtype),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&(k.mean=j.mean),typeof j.median=="number"&&!Number.isNaN(j.median)&&(k.median=j.median),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&(k.mode=j.mode)),S.set(O,k)};n.forEach(T=>{const j=Object.prototype.hasOwnProperty.call(r,T)?r[T]:null;E(T,{missingPercentage:typeof j=="number"?j:null})}),(Array.isArray(l)?l:[]).forEach(T=>{!T||!T.name||E(T.name,{missingPercentage:typeof T.missing_percentage=="number"?T.missing_percentage:null,dtype:T.dtype??null,mean:typeof T.mean=="number"?T.mean:null,median:typeof T.median=="number"?T.median:null,mode:T.mode??null})}),mt(u).forEach(T=>E(T)),t.forEach(T=>{T.columns.forEach(j=>E(j))});const P=Array.from(S.entries()).map(([T,j])=>({name:T,missingPercentage:typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)?Math.max(0,j.missingPercentage):null,dtype:j.dtype??null,mean:typeof j.mean=="number"&&!Number.isNaN(j.mean)?j.mean:null,median:typeof j.median=="number"&&!Number.isNaN(j.median)?j.median:null,mode:j.mode!==void 0&&j.mode!==null&&j.mode!==""?j.mode:null}));return P.sort((T,j)=>{const O=typeof T.missingPercentage=="number",k=typeof j.missingPercentage=="number";return O&&k&&T.missingPercentage!==j.missingPercentage?j.missingPercentage-T.missingPercentage:O!==k?O?-1:1:T.name.localeCompare(j.name)}),P},[n,r,t,u,l,i,e]),y=f.useMemo(()=>{if(!m.length)return 100;const v=m.reduce((x,S)=>{const E=typeof S.missingPercentage=="number"?S.missingPercentage:0;return E>x?E:x},0),w=Math.ceil(v/5)*5;return Math.max(100,w||0)},[m]),p=f.useMemo(()=>m.length?m.reduce((v,w)=>{const x=typeof w.missingPercentage=="number"?w.missingPercentage:null;return x!==null?x<=0?v:x>=d?v+1:v:d===0?v+1:v},0):0,[m,d]),_=d>0;return{imputerColumnOptions:m,imputerMissingSliderMax:y,imputerFilteredOptionCount:p,imputerMissingFilterActive:_}},p$=({configState:e,setConfigState:t,isFeatureTargetSplitNode:n,isTrainTestSplitNode:r,isTrainModelDraftNode:i,isHyperparameterTuningNode:l,isClassResamplingNode:u,isClassOversamplingNode:d,isClassUndersamplingNode:m,upstreamTargetColumn:y,nodeId:p,modelTypeOptions:_})=>{const v=i||l,w=f.useMemo(()=>{if(!n)return null;const $=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",B=mt(e==null?void 0:e.feature_columns).map(q=>typeof q=="string"?q.trim():"").filter(q=>!!q);return{targetColumn:$,featureColumns:B}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,n]),x=f.useMemo(()=>{if(!r)return null;const $=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,B=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,q=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,K=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,ne=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,ue=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:$,validation_size:B,random_state:q,shuffle:K,stratify:ne,target_column:ue}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,r]),S=f.useMemo(()=>{if(!u)return null;const $=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",B=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",q=e==null?void 0:e.sampling_strategy;let K=null;if(typeof q=="number"&&Number.isFinite(q))K=q;else if(typeof q=="string"){const Y=q.trim();K=Y||null}else q===null&&(K=null);const ne=e==null?void 0:e.random_state;let ue=null;if(typeof ne=="number"&&Number.isFinite(ne))ue=ne;else if(typeof ne=="string"){const Y=Number(ne);ue=Number.isFinite(Y)?Y:null}let z=null;if(m){const Y=e==null?void 0:e.replacement;z=typeof Y=="boolean"?Y:typeof Y=="string"?Y.trim().toLowerCase()==="true":!!Y}let X=null;if(d){const Y=e==null?void 0:e.k_neighbors;if(typeof Y=="number"&&Number.isFinite(Y))X=Math.max(1,Math.round(Y));else if(typeof Y=="string"){const W=Number(Y);Number.isFinite(W)&&(X=Math.max(1,Math.round(W)))}}return{method:$,targetColumn:B,samplingStrategy:K,randomState:ue,replacement:z,kNeighbors:X}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,d,u,m]),E=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",A=E==="regression"?"regression":"classification",P=f.useMemo(()=>Array.isArray(_)?_.filter($=>$&&typeof $.value=="string"):[],[_]),T=f.useMemo(()=>{const $={classification:[],regression:[]};return P.forEach(B=>{var K;const q=String(((K=B==null?void 0:B.metadata)==null?void 0:K.problem_type)??"").trim().toLowerCase();q==="regression"?$.regression.push(B):q==="classification"?$.classification.push(B):($.classification.push(B),$.regression.push(B))}),$},[P]),j=f.useMemo(()=>{if(!P.length)return[];const $=A==="regression"?T.regression:T.classification;return $.length>0?$:P},[P,T,A]),O=f.useMemo(()=>v?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:A}:null,[e==null?void 0:e.target_column,v,A]),k=f.useMemo(()=>{if(!v)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const $=(e==null?void 0:e.cv_enabled)===void 0?!!l:!!e.cv_enabled,B=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",q=["auto","kfold","stratified_kfold"].includes(B)?B:"auto",K=Number(e==null?void 0:e.cv_folds),ne=Number.isFinite(K)&&K>=2?Math.floor(K):5,ue=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let z=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))z=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const W=Number(e.cv_random_state.trim());z=Number.isFinite(W)?Math.trunc(W):null}const Y=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:$,strategy:q,folds:ne,shuffle:ue,randomState:z,refitStrategy:Y}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,l,v]);f.useEffect(()=>{v&&E!==A&&t($=>({...$,problem_type:A}))},[v,A,E,t]),f.useEffect(()=>{var K;if(!v||!j.length)return;const $=new Set(j.map(ne=>ne.value)),B=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if(B&&$.has(B))return;const q=((K=j[0])==null?void 0:K.value)??"";q&&t(ne=>{const ue=typeof(ne==null?void 0:ne.model_type)=="string"?ne.model_type.trim():"";return ue&&$.has(ue)||ue===q?ne:{...ne,model_type:q}})},[e==null?void 0:e.model_type,j,v,t]);const D=f.useMemo(()=>{if(!v)return null;const $=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",B=e==null?void 0:e.hyperparameters;let q=null,K=null;if(B&&typeof B=="string"){const ne=B.trim();if(ne.length)try{const ue=JSON.parse(ne);ue&&typeof ue=="object"&&!Array.isArray(ue)?q=ue:K="Hyperparameters JSON must be an object."}catch{K="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else B&&typeof B=="object"&&!Array.isArray(B)&&(q=B);return{modelType:$||null,hyperparameters:q,hyperparametersError:K}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,v]);return f.useEffect(()=>{(r||i)&&y&&(r&&(e==null?void 0:e.stratify)!==!0||t($=>(typeof($==null?void 0:$.target_column)=="string"?$.target_column.trim():"")?$:{...$,target_column:y}))},[e==null?void 0:e.stratify,i,r,p,t,y]),{featureTargetSplitConfig:w,trainTestSplitConfig:x,resamplingConfig:S,trainModelDraftConfig:O,trainModelRuntimeConfig:D,trainModelCVConfig:k,filteredModelTypeOptions:j}},g$=["int","float","double","numeric","number"],Sw=e=>{if(!e)return!1;const t=e.toLowerCase();return g$.some(n=>t.includes(n))},_$=({skewnessData:e,shouldLoadInsights:t,skewnessTransformations:n,availableColumns:r,previewColumns:i,columnTypeMap:l,updateSkewnessTransformations:u})=>{const[d,m]=f.useState("recommended"),[y,p]=f.useState(!1),[_,v]=f.useState("before"),w=n.length,x=f.useMemo(()=>e!=null&&e.methods?[...e.methods]:[],[e==null?void 0:e.methods]),S=f.useMemo(()=>VM(x),[x]),E=f.useMemo(()=>e!=null&&e.columns?[...e.columns]:[],[e==null?void 0:e.columns]),A=f.useMemo(()=>{const W=new Map;return E.forEach(F=>{F&&F.column&&W.set(F.column,F)}),W},[E]),P=f.useMemo(()=>{const W=new Set;return E.forEach(F=>{F!=null&&F.column&&W.add(F.column)}),r.forEach(F=>{F&&Sw(l[F]??null)&&W.add(F)}),i.forEach(F=>{const te=typeof F=="string"?F.trim():"";te&&Sw(l[te]??null)&&W.add(te)}),Array.from(W).sort((F,te)=>F.localeCompare(te))},[r,i,E,l]);f.useEffect(()=>{d==="recommended"&&E.length===0&&P.length>0&&m("all")},[P.length,E.length,d]);const T=(e==null?void 0:e.skewness_threshold)??null,j=f.useCallback(W=>S[W]??W,[S]),O=f.useCallback((W,F)=>{const te=A.get(W);return!te||!te.method_status?{status:"ready",reason:void 0}:te.method_status[F]??{status:"ready",reason:void 0}},[A]),k=f.useCallback(()=>{const W=E.map(F=>{if(!F||!F.column)return null;const te=Array.isArray(F.recommended_methods)?F.recommended_methods.find(oo):void 0;return te?{column:F.column,method:te}:null}).filter(F=>!!F);W.length&&u(F=>{const te=new Map;return F.forEach(U=>{const H=typeof U.column=="string"?U.column.trim():"";H&&oo(U.method)&&te.set(H,U.method)}),W.forEach(U=>{const H=typeof U.column=="string"?U.column.trim():"";H&&te.set(H,U.method)}),Array.from(te.entries()).map(([U,H])=>({column:U,method:H}))})},[E,u]),D=f.useMemo(()=>{const W=new Map;return n.forEach(F=>{const te=typeof F.column=="string"?F.column.trim():"";!te||W.has(te)||W.set(te,F.method)}),W},[n]),$=f.useCallback((W,F)=>{const te=typeof W=="string"?W.trim():"";te&&u(U=>{const H=U.filter(Q=>Q.column!==te);return F?[...H,{column:te,method:F}]:H})},[u]),B=f.useCallback((W,F)=>{if(W){if(!F){$(W,null);return}oo(F)&&$(W,F)}},[$]),q=f.useCallback(()=>{u(()=>[])},[u]),K=E.length,ne=f.useMemo(()=>E.some(W=>W&&typeof W.column=="string"&&Array.isArray(W.recommended_methods)&&W.recommended_methods.some(oo)),[E]),ue=P.length,z=f.useMemo(()=>WM({viewMode:d,recommendations:E,columnOptions:P,recommendationMap:A,transformationMap:D}),[d,E,P,A,D]),X=f.useMemo(()=>t?E.map(W=>{var de;if(!W||!W.column)return null;const F=W.distribution_before??W.distribution??null;if(!F||!Array.isArray(F.bin_edges)||!Array.isArray(F.counts)||F.counts.length===0||F.bin_edges.length!==F.counts.length+1)return null;let te=W.distribution_after??null;te&&(!Array.isArray(te.bin_edges)||!Array.isArray(te.counts)||te.counts.length===0||te.bin_edges.length!==te.counts.length+1)&&(te=null);const U=((de=W.recommended_methods)==null?void 0:de.find(oo))??null,H=W.magnitude?`${W.magnitude.charAt(0).toUpperCase()}${W.magnitude.slice(1)}`:null,Q=W.direction?qx[W.direction]??W.direction:null,ee=W.applied_method&&oo(W.applied_method)?W.applied_method:null,G=D.get(W.column)??null,V=ee??G??null,Z=V?j(V):null;return{column:W.column,skewness:typeof W.skewness=="number"?W.skewness:null,magnitudeLabel:H,directionLabel:Q,summary:W.summary??null,recommendedLabel:Z?null:U?j(U):null,appliedLabel:Z,distributionBefore:F,distributionAfter:te}}).filter(W=>!!W).sort((W,F)=>{const te=W.skewness!==null?Math.abs(W.skewness):-1/0,U=F.skewness!==null?Math.abs(F.skewness):-1/0;return te!==U?U-te:W.column.localeCompare(F.column)}):[],[j,t,E,D]),Y=f.useMemo(()=>KM(z,y,j),[z,y,j]);return{skewnessThreshold:T,skewnessViewMode:d,setSkewnessViewMode:m,skewnessGroupByMethod:y,setSkewnessGroupByMethod:p,skewnessDistributionView:_,setSkewnessDistributionView:v,skewnessRecommendedCount:K,skewnessNumericCount:ue,skewnessTransformationsCount:w,hasSkewnessAutoRecommendations:ne,skewnessRows:z,skewnessTableGroups:Y,skewnessDistributionCards:X,getSkewnessMethodLabel:j,getSkewnessMethodStatus:O,applySkewnessRecommendations:k,handleSkewnessOverrideChange:B,clearSkewnessTransformations:q}},n_={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},v$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},s_=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],y$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=v$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=s_(t.sample_values),_=typeof t.score=="number"?t.score:0,v=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:r,reason:i,dtype:l,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:_,selectable:v}}).filter(t=>!!t),b$=e=>{if(!e||typeof e!="object")return{...n_};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.auto_detect_default,u=s_(e.high_cardinality_columns),d=s_(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:i,autoDetectDefault:l,highCardinalityColumns:u,notes:d}},x$=({isLabelEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[_,v]=f.useState({...n_}),[w,x]=f.useState(0);f.useEffect(()=>{let P=!0;const T=j=>{p([]),v({...n_}),u(!1),m(j??null)};return e?t?n?(u(!0),m(null),ax(t,{graph:r??null,targetNodeId:i??null}).then(j=>{P&&(p(y$(j)),v(b$(j)))}).catch(j=>{if(!P)return;const O=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load label encoding suggestions";T(O)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,w,t,i]);const S=f.useCallback(()=>{!e||!t||!n||x(P=>P+1)},[n,e,t]),E=f.useMemo(()=>_,[_]),A=f.useMemo(()=>y,[y]);return{isFetching:l,error:d,suggestions:A,metadata:E,refresh:S}},r_={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},w$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},a_=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],j$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=w$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=a_(t.sample_values),_=typeof t.score=="number"?t.score:0,v=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:r,reason:i,dtype:l,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:_,selectable:v,recommended_use_global_fallback:w}}).filter(t=>!!t),N$=e=>{if(!e||typeof e!="object")return{...r_};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.enable_global_fallback_default,u=a_(e.high_cardinality_columns),d=a_(e.notes),m=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:i,autoDetectDefault:m,enableGlobalFallbackDefault:l,highCardinalityColumns:u,notes:d}},S$=({isTargetEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[_,v]=f.useState({...r_}),[w,x]=f.useState(0);f.useEffect(()=>{let P=!0;const T=j=>{p([]),v({...r_}),u(!1),m(j??null)};return e?t?n?(u(!0),m(null),ix(t,{graph:r??null,targetNodeId:i??null}).then(j=>{P&&(p(j$(j)),v(N$(j)))}).catch(j=>{if(!P)return;const O=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load target encoding suggestions";T(O)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,w,t,i]);const S=f.useCallback(()=>{!e||!t||!n||x(P=>P+1)},[n,e,t]),E=f.useMemo(()=>_,[_]),A=f.useMemo(()=>y,[y]);return{isFetching:l,error:d,suggestions:A,metadata:E,refresh:S}},Gf={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},C$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},o_=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],E$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=C$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=o_(t.sample_values),_=typeof t.score=="number"?t.score:0,v=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:r,reason:i,dtype:l,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:_,selectable:v,recommended_bucket_count:w}}).filter(t=>!!t),k$=e=>{if(!e||typeof e!="object")return{...Gf};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.auto_detect_default,u=Number(e.suggested_bucket_default??0)||0,d=o_(e.high_cardinality_columns),m=o_(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:i,autoDetectDefault:l,suggestedBucketDefault:u,highCardinalityColumns:d,notes:m}},M$=({isHashEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[_,v]=f.useState({...Gf}),[w,x]=f.useState(0),S=f.useCallback(P=>{p([]),v({...Gf}),u(!1),m(P??null)},[]);f.useEffect(()=>{let P=!0;return e?t?n?(u(!0),m(null),lx(t,{graph:r??null,targetNodeId:i??null}).then(T=>{P&&(p(E$(T)),v(k$(T)))}).catch(T=>{P&&(p([]),v({...Gf}),m(T!=null&&T.message?String(T.message):"Unable to load hash encoding suggestions"))}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(S("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(S(),()=>{P=!1}):(S(),()=>{P=!1})},[r,n,e,S,t,i,w]);const E=f.useCallback(()=>{x(P=>P+1)},[]);return f.useMemo(()=>({isFetching:l,error:d,suggestions:y,metadata:_,refresh:E}),[d,l,_,E,y])},i_={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},A$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},l_=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],O$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=A$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=l_(t.sample_values),_=typeof t.score=="number"?t.score:0,v=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:r,reason:i,dtype:l,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:_,selectable:v,recommended_handle_unknown:w}}).filter(t=>!!t),P$=e=>{if(!e||typeof e!="object")return{...i_};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.enable_unknown_default,u=l_(e.high_cardinality_columns),d=l_(e.notes),m=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:i,autoDetectDefault:m,enableUnknownDefault:l,highCardinalityColumns:u,notes:d}},T$=({isOrdinalEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[_,v]=f.useState({...i_}),[w,x]=f.useState(0);f.useEffect(()=>{let P=!0;const T=j=>{p([]),v({...i_}),u(!1),m(j??null)};return e?t?n?(u(!0),m(null),ox(t,{graph:r??null,targetNodeId:i??null}).then(j=>{P&&(p(O$(j)),v(P$(j)))}).catch(j=>{if(!P)return;const O=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load ordinal encoding suggestions";T(O)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,w,t,i]);const S=f.useCallback(()=>{!e||!t||!n||x(P=>P+1)},[n,e,t]),E=f.useMemo(()=>_,[_]),A=f.useMemo(()=>y,[y]);return{isFetching:l,error:d,suggestions:A,metadata:E,refresh:S}},c_={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},$$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},u_=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],L$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=$$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=u_(t.sample_values),_=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,v=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,x=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:r,reason:i,dtype:l,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,estimated_dummy_columns:_,score:v,selectable:w,recommended_drop_first:x}}).filter(t=>!!t),D$=e=>{if(!e||typeof e!="object")return{...c_};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=Number(e.cautioned_count??0)||0,u=u_(e.high_cardinality_columns),d=u_(e.notes),m=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:i,cautionedCount:l,highCardinalityColumns:u,notes:d,autoDetectDefault:m}},z$=({isDummyEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[_,v]=f.useState({...c_}),[w,x]=f.useState(0);f.useEffect(()=>{let P=!0;const T=j=>{p([]),v({...c_}),u(!1),m(j??null)};return e?t?n?(u(!0),m(null),ux(t,{graph:r??null,targetNodeId:i??null}).then(j=>{P&&(p(L$(j)),v(D$(j)))}).catch(j=>{if(!P)return;const O=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load dummy encoding suggestions";T(O)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,w,t,i]);const S=f.useCallback(()=>{!e||!t||!n||x(P=>P+1)},[n,e,t]),E=f.useMemo(()=>_,[_]),A=f.useMemo(()=>y,[y]);return{isFetching:l,error:d,suggestions:A,metadata:E,refresh:S}},d_={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},R$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},m_=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],F$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=R$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=m_(t.sample_values),_=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,v=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,x=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:r,reason:i,dtype:l,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,estimated_dummy_columns:_,score:v,selectable:w,recommended_drop_first:x}}).filter(t=>!!t),I$=e=>{if(!e||typeof e!="object")return{...d_};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=Number(e.cautioned_count??0)||0,u=m_(e.high_cardinality_columns),d=m_(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:i,cautionedCount:l,highCardinalityColumns:u,notes:d}},B$=({isOneHotEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:i})=>{const[l,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[_,v]=f.useState({...d_}),[w,x]=f.useState(0);f.useEffect(()=>{let P=!0;const T=j=>{p([]),v({...d_}),u(!1),m(j??null)};return e?t?n?(u(!0),m(null),cx(t,{graph:r??null,targetNodeId:i??null}).then(j=>{P&&(p(F$(j)),v(I$(j)))}).catch(j=>{if(!P)return;const O=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load one-hot encoding suggestions";T(O)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,w,t,i]);const S=f.useCallback(()=>{!e||!t||!n||x(P=>P+1)},[n,e,t]),E=f.useMemo(()=>_,[_]),A=f.useMemo(()=>y,[y]);return{isFetching:l,error:d,suggestions:A,metadata:E,refresh:S}},U$={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},q$=(e,t)=>{var i;const n=(i=e==null?void 0:e.parameter_help)==null?void 0:i[t];if(n)return n;const r=t.replace(/_/g," ").trim();return r.charAt(0).toUpperCase()+r.slice(1)},H$=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},V$=(e,t,n,r,i)=>{var y;const l=n[r]??{};if(Object.prototype.hasOwnProperty.call(l,t)){const p=l[t];if(typeof p=="number"&&Number.isFinite(p))return{value:p,fallback:null}}const d=(i[e]??{})[t];return typeof d=="number"&&Number.isFinite(d)?{value:"",fallback:d}:{value:"",fallback:((y=Zo[e])==null?void 0:y[t])??null??null}},Cw=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",Ew={lower_percentile:"%",upper_percentile:"%"},W$=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:r,outlierMethodOptions:i,outlierMethodDetailMap:l,outlierDefaultDetail:u,outlierAutoDetectEnabled:d,outlierSelectedCount:m,outlierDefaultLabel:y,outlierOverrideCount:p,outlierParameterOverrideCount:_,outlierOverrideExampleSummary:v,outlierHasOverrides:w,outlierRecommendationRows:x,outlierHasRecommendations:S,outlierStatusMessage:E,outlierError:A,outlierSampleSize:P,relativeOutlierGeneratedAt:T,outlierPreviewSignal:j,formatMetricValue:O,formatNumericStat:k,onApplyAllRecommendations:D,onClearOverrides:$,onDefaultMethodChange:B,onAutoDetectToggle:q,onOverrideSelect:K,onMethodParameterChange:ne,onColumnParameterChange:ue})=>{const z=H$(j);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:D,disabled:!S,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:$,disabled:!w,children:"Clear overrides"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),T&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",T,P!==null?` on ${O(P)} row${P===1?"":"s"}.`:"."]}),!T&&P!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",O(P)," row",P===1?"":"s","."]}),z&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",z]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:i.map(X=>{const Y=l.get(X.value)??null,W=X.value===r.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${W?" canvas-scaling__method-button--active":""}`,"aria-pressed":W,onClick:()=>B(X.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:X.label}),(Y==null?void 0:Y.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:Y.description})]},X.value)})}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:u.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:X=>q(X.target.checked)}),a.jsx("span",{children:d?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]})]}),a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for each strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:Xs.map(X=>{const Y=l.get(X)??null,W=Yf[X];if(!W.length)return null;const F=(Y==null?void 0:Y.label)??al[X]??X;return a.jsxs("article",{className:"canvas-outlier__method-card",children:[a.jsxs("header",{className:"canvas-outlier__method-header",children:[a.jsx("span",{className:"canvas-outlier__method-title",children:F}),(Y==null?void 0:Y.description)&&a.jsx("p",{className:"canvas-outlier__method-summary",children:Y.description})]}),a.jsx("div",{className:"canvas-outlier__parameter-list",children:W.map(te=>{var Q,ee;const U=((Q=r.methodParameters[X])==null?void 0:Q[te])??null,H=Ew[te]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:q$(Y,te)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx("input",{type:"number",className:"canvas-outlier__method-input-field",value:typeof U=="number"&&Number.isFinite(U)?U:"",placeholder:Cw(((ee=Zo[X])==null?void 0:ee[te])??null),onChange:G=>{const V=G.target.value;if(V==="")ne(X,te,null);else{const Z=Number(V);ne(X,te,Number.isFinite(Z)?Z:null)}}}),H&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:H})]})]},`${X}-${te}`)})})]},`outlier-method-${X}`)})})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:m})," column",m===1?"":"s","  Default method"," ",a.jsx("strong",{children:y})," ",d?" Auto-detect on":" Auto-detect off",(()=>{if(!(p+_))return"  No overrides yet";const Y=[];return p>0&&Y.push(v?`${p} method override${p===1?"":"s"} (${v})`:`${p} method override${p===1?"":"s"}`),_>0&&Y.push(`${_} parameter override${_===1?"":"s"}`),`  Overrides: ${Y.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&A&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:A}),!n&&!A&&a.jsxs(a.Fragment,{children:[E&&a.jsx("p",{className:"canvas-modal__note",children:E}),x.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:x.map(X=>{const Y=!X.isSkipped&&!X.isExcluded&&X.recommendedMethod&&X.recommendedMethod!==X.currentMethod,W=["canvas-cast__row"];Y&&W.push("canvas-cast__row--attention"),X.isOverrideApplied&&W.push("canvas-cast__row--override"),X.isSkipped&&W.push("canvas-cast__row--muted");const F=X.isSkipped?"__skip__":X.isOverrideApplied?X.currentMethod:"__default__",te=X.isOverrideApplied?`Override -> ${X.currentMethodLabel}`:X.isSkipped?"Skipped (column will not be altered)":X.isSelected?`Inheriting ${y}`:"Pending inclusion",U=X.stats,H=[];typeof U.valid_count=="number"&&Number.isFinite(U.valid_count)&&H.push(`${O(U.valid_count)} valid rows`);const Q=typeof U.minimum=="number"&&Number.isFinite(U.minimum),ee=typeof U.maximum=="number"&&Number.isFinite(U.maximum);if(Q||ee){const le=Q?k(U.minimum):"",ge=ee?k(U.maximum):"";H.push(`Range ${le}  ${ge}`)}typeof U.mean=="number"&&Number.isFinite(U.mean)&&H.push(`Mean ${k(U.mean)}`),typeof U.median=="number"&&Number.isFinite(U.median)&&H.push(`Median ${k(U.median)}`),typeof U.stddev=="number"&&Number.isFinite(U.stddev)&&H.push(` ${k(U.stddev)}`);const G=H.length?H.join("  "):null,V=!X.recommendedMethod||!X.recommendedLabel?X.recommendedReason||"No outlier risk detected":X.recommendedReason?`${X.recommendedLabel}  ${X.recommendedReason}`:X.recommendedLabel,Z=r.columnParameters,de=r.methodParameters,pe=Yf[X.currentMethod]??[];return a.jsxs("tr",{className:W.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:X.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[X.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",X.dtype]}),X.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),X.isSelected&&!X.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),X.isSkipped&&!X.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),X.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),X.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[X.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${Y?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:X.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),V&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:V})]})}),a.jsx("td",{children:G?a.jsx("span",{children:G}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:F,onChange:le=>K(X.column,le.target.value),disabled:X.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",y,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),i.map(le=>a.jsx("option",{value:le.value,children:le.label},`${X.column}-${le.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:te}),pe.length>0&&!X.isExcluded&&a.jsx("div",{className:"canvas-outlier__parameters",children:pe.map(le=>{const{value:ge,fallback:He}=V$(X.currentMethod,le,Z,X.column,de),lt=Ew[le]??"";return a.jsxs("label",{children:[a.jsx("span",{children:le.replace(/_/g," ")}),a.jsx("input",{type:"number",value:ge,placeholder:Cw(He),onChange:Ye=>{const Se=Ye.target.value;if(Se==="")ue(X.column,le,null);else{const Re=Number(Se);ue(X.column,le,Number.isFinite(Re)?Re:null)}}}),lt&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:lt})]},`${X.column}-${X.currentMethod}-${le}`)})})]})})]},`outlier-row-${X.column}`)})})]})})})]})]})},kw=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const r=t.split("-");return r.length>=2?r.slice(-2).join("-"):t},K$=({counts:e,binEdges:t,className:n})=>{const r=f.useId(),i=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:i,"aria-hidden":"true"});const l=e.reduce((m,y)=>Math.max(m,y),0),u=l>0?l:1,d=100/e.length;return a.jsx("div",{className:i,role:"img","aria-label":"Histogram sparkline",children:a.jsxs("svg",{viewBox:"0 0 100 60",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((m,y)=>{const p=m/u*52,_=y*d,v=58-p,w=Math.max(d-2,1);return a.jsx("rect",{x:_+1,y:v,width:w,height:p,rx:1.2,ry:1.2,fill:`url(#${r})`},`hist-bin-${y}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:r,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},Y$=new Set(Rf.map(e=>e.value)),Ad=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),Mw=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),Aw=e=>{const n=Ad(e).filter(r=>Y$.has(r));return n.length?n:["year","month","day"]},Od=e=>e==null?null:Number.isFinite(e)?e:null,Ow=e=>{const t=Od(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},Pw=e=>typeof e!="string"?"UTC":e.trim()||"UTC",Q$=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:r,sourceId:i,graphSnapshot:l,onResetConfig:u,defaultConfigTemplate:d,isResetAvailable:m=!1})=>{var ja,ic,Na,lc,zi,Bu,cc,uc,gs,Sa,_r,Es,Lm,Uu,qu,gp,Ca,Dm,Hu,eo,Vu,to,zm,Rm,Wu,dc,_p,vp,Fm,Im,no,yp,Uo,Bm,Sn,bp;const y=f.useMemo(()=>{var N,M,L,I,se,ae;const g=[];return(N=e==null?void 0:e.data)!=null&&N.label&&g.push({label:"Label",value:String(e.data.label)}),(M=e==null?void 0:e.data)!=null&&M.description&&g.push({label:"Description",value:String(e.data.description)}),(L=e==null?void 0:e.data)!=null&&L.category&&g.push({label:"Category",value:String(e.data.category)}),(I=e==null?void 0:e.data)!=null&&I.catalogType&&g.push({label:"Node type",value:String(e.data.catalogType)}),(se=e==null?void 0:e.data)!=null&&se.inputs&&Array.isArray(e.data.inputs)&&e.data.inputs.length&&g.push({label:"Inputs",value:e.data.inputs.join(", ")}),(ae=e==null?void 0:e.data)!=null&&ae.outputs&&Array.isArray(e.data.outputs)&&e.data.outputs.length&&g.push({label:"Outputs",value:e.data.outputs.join(", ")}),g},[e]),p=f.useMemo(()=>{var N;const g=((N=e==null?void 0:e.data)==null?void 0:N.label)??(e==null?void 0:e.id);return typeof g=="string"&&g.trim()?g:`Node ${(e==null?void 0:e.id)??""}`},[e]),{catalogType:_,isDataset:v,isImputerNode:w,isMissingIndicatorNode:x,isReplaceAliasesNode:S,isTrimWhitespaceNode:E,isRemoveSpecialCharsNode:A,isReplaceInvalidValuesNode:P,isRegexCleanupNode:T,isNormalizeTextCaseNode:j,isStandardizeDatesNode:O,isLabelEncodingNode:k,isTargetEncodingNode:D,isHashEncodingNode:$,isFeatureTargetSplitNode:B,isTrainTestSplitNode:q,isTrainModelDraftNode:K,isModelEvaluationNode:ne,isModelRegistryNode:ue,isHyperparameterTuningNode:z,isClassUndersamplingNode:X,isClassOversamplingNode:Y,isOrdinalEncodingNode:W,isDummyEncodingNode:F,isOneHotEncodingNode:te,isFeatureMathNode:U,isCastNode:H,isBinningNode:Q,isScalingNode:ee,isPolynomialFeaturesNode:G,isFeatureSelectionNode:V,isTransformerAuditNode:Z,isOutlierNode:de,isSkewnessNode:pe,isSkewnessDistributionNode:le,isBinnedDistributionNode:ge,isDataConsistencyNode:He,isInspectionNode:lt,isRemoveDuplicatesNode:Ye,isDropMissingColumnsNode:Se,isDropMissingRowsNode:Re,isDropMissingNode:Ce}=O2(e),Fe=v,Ve=X||Y,Ke=f.useMemo(()=>MM,[]),tt=f.useMemo(()=>Ke.map(g=>g.value),[Ke]),J=f.useMemo(()=>{var N;const g=(N=e==null?void 0:e.data)==null?void 0:N.parameters;return Array.isArray(g)?g.filter(M=>!!(M!=null&&M.name)).map(M=>({...M})):[]},[e]),Pe=f.useMemo(()=>U$[_]??null,[_]),$e=typeof(e==null?void 0:e.id)=="string"?e.id:"",rt=f.useMemo(()=>{var M;const g=(M=e==null?void 0:e.data)==null?void 0:M.connectionInfo;if(!g)return null;const N=L=>Array.isArray(L)?L.map(I=>({...I})):[];return{inputs:N(g.inputs),outputs:N(g.outputs)}},[e]),wt=((ja=e==null?void 0:e.data)==null?void 0:ja.hasRequiredConnections)!==!1,en=f.useMemo(()=>{if(!$e||!l||!Array.isArray(l.edges))return new Set;const g=l.edges.filter(N=>(N==null?void 0:N.target)===$e).map(N=>kw($e,N==null?void 0:N.targetHandle)).filter(N=>!!N);return new Set(g)},[l,$e]),ye=f.useMemo(()=>{if(!$e||!l||!Array.isArray(l.edges))return new Set;const g=l.edges.filter(N=>(N==null?void 0:N.source)===$e).map(N=>kw($e,N==null?void 0:N.sourceHandle)).filter(N=>!!N);return new Set(g)},[l,$e]),we=f.useMemo(()=>{if(!(rt!=null&&rt.inputs)||rt.inputs.length===0)return;let g=!1;const N={};return rt.inputs.forEach(M=>{if(!Array.isArray(M.accepts)||M.accepts.length===0)return;const L=en.has(M.key);M.accepts.forEach(I=>{(I==="validation"||I==="test")&&(N[I]=L,g=!0)})}),g?N:void 0},[rt==null?void 0:rt.inputs,en]),ke=f.useMemo(()=>{var g;return(g=rt==null?void 0:rt.inputs)!=null&&g.length?rt.inputs.filter(N=>N.required!==!1):[]},[rt==null?void 0:rt.inputs]),Oe=f.useMemo(()=>ke.length?ke.filter(g=>!en.has(g.key)):[],[en,ke]),Xe=wt&&Oe.length===0,Ie=f.useMemo(()=>{if(!Xe)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[Xe]),nt=Xe?void 0:!0,xt=f.useMemo(()=>!!(m&&!v&&d),[d,v,m]);f.useMemo(()=>Q?J.find(g=>g.name==="columns")??null:null,[Q,J]),f.useMemo(()=>ee?J.find(g=>g.name==="columns")??null:null,[ee,J]);const Ot=f.useMemo(()=>Ye?J.find(g=>g.name==="columns")??null:null,[Ye,J]),Ft=f.useMemo(()=>Ye?J.find(g=>g.name==="keep")??null:null,[Ye,J]),dt=f.useMemo(()=>S?J.find(g=>g.name==="custom_pairs")??null:null,[S,J]),Tt=f.useMemo(()=>E?J.find(g=>g.name==="columns")??null:null,[E,J]),gt=f.useMemo(()=>E?J.find(g=>g.name==="mode")??null:null,[E,J]),kt=f.useMemo(()=>A?J.find(g=>g.name==="columns")??null:null,[A,J]),vn=f.useMemo(()=>A?J.find(g=>g.name==="mode")??null:null,[A,J]),Jt=f.useMemo(()=>A?J.find(g=>g.name==="replacement")??null:null,[A,J]),Mn=f.useMemo(()=>P?J.find(g=>g.name==="columns")??null:null,[P,J]),Yn=f.useMemo(()=>P?J.find(g=>g.name==="mode")??null:null,[P,J]),yn=f.useMemo(()=>P?J.find(g=>g.name==="min_value")??null:null,[P,J]),$t=f.useMemo(()=>P?J.find(g=>g.name==="max_value")??null:null,[P,J]),Lt=f.useMemo(()=>T?J.find(g=>g.name==="columns")??null:null,[T,J]),xn=f.useMemo(()=>T?J.find(g=>g.name==="mode")??null:null,[T,J]),Ut=f.useMemo(()=>T?J.find(g=>g.name==="pattern")??null:null,[T,J]),Pt=f.useMemo(()=>T?J.find(g=>g.name==="replacement")??null:null,[T,J]),mn=f.useMemo(()=>j?J.find(g=>g.name==="columns")??null:null,[j,J]),ns=f.useMemo(()=>j?J.find(g=>g.name==="mode")??null:null,[j,J]),er=f.useMemo(()=>k?J.find(g=>g.name==="columns")??null:null,[k,J]),An=f.useMemo(()=>k?J.find(g=>g.name==="auto_detect")??null:null,[k,J]),us=f.useMemo(()=>k?J.find(g=>g.name==="max_unique_values")??null:null,[k,J]),Kt=f.useMemo(()=>k?J.find(g=>g.name==="output_suffix")??null:null,[k,J]),Qn=f.useMemo(()=>k?J.find(g=>g.name==="drop_original")??null:null,[k,J]),zr=f.useMemo(()=>k?J.find(g=>g.name==="missing_strategy")??null:null,[k,J]),go=f.useMemo(()=>k?J.find(g=>g.name==="missing_code")??null:null,[k,J]),tr=f.useMemo(()=>$?J.find(g=>g.name==="columns")??null:null,[$,J]),Is=f.useMemo(()=>$?J.find(g=>g.name==="auto_detect")??null:null,[$,J]),La=f.useMemo(()=>$?J.find(g=>g.name==="max_categories")??null:null,[$,J]),Da=f.useMemo(()=>$?J.find(g=>g.name==="n_buckets")??null:null,[$,J]),ra=f.useMemo(()=>$?J.find(g=>g.name==="output_suffix")??null:null,[$,J]),Rr=f.useMemo(()=>$?J.find(g=>g.name==="drop_original")??null:null,[$,J]),aa=f.useMemo(()=>$?J.find(g=>g.name==="encode_missing")??null:null,[$,J]),oa=f.useMemo(()=>G?J.find(g=>g.name==="columns")??null:null,[G,J]),ia=f.useMemo(()=>G?J.find(g=>g.name==="auto_detect")??null:null,[G,J]),Ee=f.useMemo(()=>G?J.find(g=>g.name==="degree")??null:null,[G,J]),Qe=f.useMemo(()=>G?J.find(g=>g.name==="include_bias")??null:null,[G,J]),Je=f.useMemo(()=>G?J.find(g=>g.name==="interaction_only")??null:null,[G,J]),un=f.useMemo(()=>G?J.find(g=>g.name==="include_input_features")??null:null,[G,J]),At=f.useMemo(()=>G?J.find(g=>g.name==="output_prefix")??null:null,[G,J]),ds=f.useMemo(()=>V?J.find(g=>g.name==="columns")??null:null,[V,J]),tn=f.useMemo(()=>V?J.find(g=>g.name==="auto_detect")??null:null,[V,J]),En=f.useMemo(()=>V?J.find(g=>g.name==="target_column")??null:null,[V,J]),gn=f.useMemo(()=>V?J.find(g=>g.name==="method")??null:null,[V,J]),ss=f.useMemo(()=>V?J.find(g=>g.name==="score_func")??null:null,[V,J]),Vt=f.useMemo(()=>V?J.find(g=>g.name==="problem_type")??null:null,[V,J]),fn=f.useMemo(()=>V?J.find(g=>g.name==="k")??null:null,[V,J]),On=f.useMemo(()=>V?J.find(g=>g.name==="percentile")??null:null,[V,J]),la=f.useMemo(()=>V?J.find(g=>g.name==="alpha")??null:null,[V,J]),Fr=f.useMemo(()=>V?J.find(g=>g.name==="threshold")??null:null,[V,J]),bs=f.useMemo(()=>V?J.find(g=>g.name==="mode")??null:null,[V,J]),Sr=f.useMemo(()=>V?J.find(g=>g.name==="estimator")??null:null,[V,J]),xs=f.useMemo(()=>V?J.find(g=>g.name==="step")??null:null,[V,J]),nr=f.useMemo(()=>V?J.find(g=>g.name==="min_features")??null:null,[V,J]),Ir=f.useMemo(()=>V?J.find(g=>g.name==="max_features")??null:null,[V,J]),_o=f.useMemo(()=>V?J.find(g=>g.name==="drop_unselected")??null:null,[V,J]),ca=f.useMemo(()=>U?J.find(g=>g.name==="error_handling")??null:null,[U,J]),ua=f.useMemo(()=>U?J.find(g=>g.name==="allow_overwrite")??null:null,[U,J]),da=f.useMemo(()=>U?J.find(g=>g.name==="default_timezone")??null:null,[U,J]),ci=f.useMemo(()=>U?J.find(g=>g.name==="epsilon")??null:null,[U,J]),vo=f.useMemo(()=>Ve?J.find(g=>g.name==="method")??null:null,[Ve,J]),Vc=f.useMemo(()=>Ve?J.find(g=>g.name==="target_column")??null:null,[Ve,J]),gl=f.useMemo(()=>Ve?J.find(g=>g.name==="sampling_strategy")??null:null,[Ve,J]),Yt=f.useMemo(()=>Ve?J.find(g=>g.name==="random_state")??null:null,[Ve,J]),Wc=f.useMemo(()=>Y?J.find(g=>g.name==="k_neighbors")??null:null,[Y,J]),_l=f.useMemo(()=>X?J.find(g=>g.name==="replacement")??null:null,[X,J]),ui=f.useMemo(()=>B?J.find(g=>g.name==="target_column")??null:null,[B,J]),vl=f.useMemo(()=>K||z?J.find(g=>g.name==="target_column")??null:null,[z,K,J]),yl=f.useMemo(()=>K||z?J.find(g=>g.name==="problem_type")??null:null,[z,K,J]),oe=f.useMemo(()=>K||z?J.find(g=>g.name==="model_type")??null:null,[z,K,J]),Me=f.useMemo(()=>K?J.find(g=>g.name==="hyperparameters")??null:null,[K,J]),je=f.useMemo(()=>z?J.find(g=>g.name==="search_strategy")??null:null,[z,J]),Ge=f.useMemo(()=>z?J.find(g=>g.name==="search_iterations")??null:null,[z,J]),qe=f.useMemo(()=>z?J.find(g=>g.name==="search_random_state")??null:null,[z,J]),Le=f.useMemo(()=>z?J.find(g=>g.name==="scoring_metric")??null:null,[z,J]),_t=f.useMemo(()=>K||z?J.find(g=>g.name==="cv_enabled")??null:null,[z,K,J]),it=f.useMemo(()=>K||z?J.find(g=>g.name==="cv_strategy")??null:null,[z,K,J]),jt=f.useMemo(()=>K||z?J.find(g=>g.name==="cv_folds")??null:null,[z,K,J]),Et=f.useMemo(()=>K||z?J.find(g=>g.name==="cv_shuffle")??null:null,[z,K,J]),Nt=f.useMemo(()=>K||z?J.find(g=>g.name==="cv_random_state")??null:null,[z,K,J]),It=f.useMemo(()=>K?J.find(g=>g.name==="cv_refit_strategy")??null:null,[K,J]),rs=f.useMemo(()=>D?J.find(g=>g.name==="columns")??null:null,[D,J]),wn=f.useMemo(()=>D?J.find(g=>g.name==="target_column")??null:null,[D,J]),as=f.useMemo(()=>D?J.find(g=>g.name==="auto_detect")??null:null,[D,J]),za=f.useMemo(()=>D?J.find(g=>g.name==="max_categories")??null:null,[D,J]),ma=f.useMemo(()=>D?J.find(g=>g.name==="output_suffix")??null:null,[D,J]),ws=f.useMemo(()=>D?J.find(g=>g.name==="drop_original")??null:null,[D,J]),sr=f.useMemo(()=>D?J.find(g=>g.name==="smoothing")??null:null,[D,J]),Bs=f.useMemo(()=>D?J.find(g=>g.name==="encode_missing")??null:null,[D,J]),js=f.useMemo(()=>D?J.find(g=>g.name==="handle_unknown")??null:null,[D,J]),Cr=f.useMemo(()=>W?J.find(g=>g.name==="columns")??null:null,[W,J]),bl=f.useMemo(()=>W?J.find(g=>g.name==="auto_detect")??null:null,[W,J]),yo=f.useMemo(()=>W?J.find(g=>g.name==="max_categories")??null:null,[W,J]),bo=f.useMemo(()=>W?J.find(g=>g.name==="output_suffix")??null:null,[W,J]),di=f.useMemo(()=>W?J.find(g=>g.name==="drop_original")??null:null,[W,J]),mi=f.useMemo(()=>W?J.find(g=>g.name==="encode_missing")??null:null,[W,J]),Br=f.useMemo(()=>W?J.find(g=>g.name==="handle_unknown")??null:null,[W,J]),xl=f.useMemo(()=>W?J.find(g=>g.name==="unknown_value")??null:null,[W,J]),Ra=f.useMemo(()=>F?J.find(g=>g.name==="columns")??null:null,[F,J]),fi=f.useMemo(()=>F?J.find(g=>g.name==="auto_detect")??null:null,[F,J]),Dn=f.useMemo(()=>F?J.find(g=>g.name==="max_categories")??null:null,[F,J]),xo=f.useMemo(()=>F?J.find(g=>g.name==="drop_first")??null:null,[F,J]),Kc=f.useMemo(()=>F?J.find(g=>g.name==="include_missing")??null:null,[F,J]),Ns=f.useMemo(()=>F?J.find(g=>g.name==="drop_original")??null:null,[F,J]),Fa=f.useMemo(()=>F?J.find(g=>g.name==="prefix_separator")??null:null,[F,J]),kn=f.useMemo(()=>te?J.find(g=>g.name==="columns")??null:null,[te,J]),Gn=f.useMemo(()=>te?J.find(g=>g.name==="auto_detect")??null:null,[te,J]),Er=f.useMemo(()=>te?J.find(g=>g.name==="max_categories")??null:null,[te,J]),wl=f.useMemo(()=>te?J.find(g=>g.name==="drop_first")??null:null,[te,J]),Fd=f.useMemo(()=>te?J.find(g=>g.name==="include_missing")??null:null,[te,J]),jl=f.useMemo(()=>te?J.find(g=>g.name==="drop_original")??null:null,[te,J]),Yc=f.useMemo(()=>te?J.find(g=>g.name==="prefix_separator")??null:null,[te,J]),Qc=f.useMemo(()=>x?J.find(g=>g.name==="columns")??null:null,[x,J]),Id=f.useMemo(()=>x?J.find(g=>g.name==="flag_suffix")??null:null,[x,J]);f.useMemo(()=>ee?J.find(g=>g.name==="default_method")??null:null,[ee,J]),f.useMemo(()=>ee?J.find(g=>g.name==="auto_detect")??null:null,[ee,J]);const Gc=f.useMemo(()=>J.some(g=>{var N;return(g==null?void 0:g.type)==="multi_select"&&((N=g==null?void 0:g.source)==null?void 0:N.type)!=="drop_column_recommendations"}),[J]),Bd=f.useMemo(()=>J.find(g=>{var N;return((N=g==null?void 0:g.source)==null?void 0:N.type)==="drop_column_recommendations"})??null,[J]),Xc=f.useMemo(()=>J.find(g=>g.name==="drop_if_any_missing")??null,[J]),th=f.useMemo(()=>{let g=J;return g=g.filter(N=>{var M;return((M=N==null?void 0:N.source)==null?void 0:M.type)!=="drop_column_recommendations"}),(Se||Re)&&(g=g.filter(N=>N.name!=="missing_threshold")),Re&&(g=g.filter(N=>N.name!=="drop_if_any_missing")),w&&(g=g.filter(N=>N.name!=="strategies")),pe&&(g=g.filter(N=>N.name!=="transformations")),H&&(g=g.filter(N=>N.name!=="column_overrides")),Q&&(g=g.filter(N=>N.name!=="columns")),ee&&(g=g.filter(N=>!["columns","default_method","auto_detect"].includes(N.name))),Ye&&(g=g.filter(N=>N.name!=="columns"&&N.name!=="keep")),x&&(g=g.filter(N=>N.name!=="columns"&&N.name!=="flag_suffix")),S&&(g=g.filter(N=>!["columns","mode","custom_pairs"].includes(N.name))),E&&(g=g.filter(N=>!["columns","mode"].includes(N.name))),A&&(g=g.filter(N=>!["columns","mode","replacement"].includes(N.name))),P&&(g=g.filter(N=>!["columns","mode","min_value","max_value"].includes(N.name))),T&&(g=g.filter(N=>!["columns","mode","pattern","replacement"].includes(N.name))),j&&(g=g.filter(N=>!["columns","mode"].includes(N.name))),O&&(g=g.filter(N=>!["columns","mode"].includes(N.name))),X&&(g=g.filter(N=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(N.name))),K&&(g=g.filter(N=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(N.name))),Y&&(g=g.filter(N=>!["method","target_column","sampling_strategy","random_state"].includes(N.name))),B&&(g=g.filter(N=>N.name!=="target_column")),k&&(g=g.filter(N=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(N.name))),W&&(g=g.filter(N=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(N.name))),F&&(g=g.filter(N=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(N.name))),te&&(g=g.filter(N=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(N.name))),g},[Q,H,Se,Re,w,x,S,E,A,P,T,j,O,X,Y,K,k,W,F,te,Ye,pe,B,J]),nh=f.useMemo(()=>He?th:[],[th,He]),sh=pe||le,Jc=f.useMemo(()=>{var N;const g=Hg(((N=e==null?void 0:e.data)==null?void 0:N.config)??{});return!g||typeof g!="object"||Array.isArray(g)?{}:((!g.column_overrides||typeof g.column_overrides!="object"||Array.isArray(g.column_overrides))&&(g.column_overrides={}),g)},[e==null?void 0:e.id,(ic=e==null?void 0:e.data)==null?void 0:ic.config]),[_e,Be]=f.useState(Jc),fa=f.useRef(!1),rh=f.useMemo(()=>Sd(Jc),[Jc]),__=f.useMemo(()=>Sd(_e),[_e]),v_=f.useMemo(()=>ue?_e?{..._e}:{}:null,[_e,ue]),Ia=f.useMemo(()=>Rx(_e==null?void 0:_e.strategies,tt),[_e==null?void 0:_e.strategies,tt]),ah=Ia.length,oh=f.useMemo(()=>Pg(Ux(_e==null?void 0:_e.transformations)),[_e==null?void 0:_e.transformations]),Pn=f.useMemo(()=>{if(!l)return null;const g=Array.isArray(l.nodes)?l.nodes:[],N=Array.isArray(l.edges)?l.edges:[];return{nodes:g,edges:N}},[l]),Ba=f.useMemo(()=>l&&Array.isArray(l.nodes)?l.nodes:[],[l]),hi=f.useMemo(()=>l&&Array.isArray(l.edges)?l.edges:[],[l]),Zc=Ba.length,Ua=f.useMemo(()=>{if(!$e||!hi.length)return[];const g=new Set,N=[$e];for(;N.length;){const L=N.pop();L&&hi.forEach(I=>{const se=I&&typeof I.source=="string"?I.source.trim():"",ae=I&&typeof I.target=="string"?I.target.trim():"";!se||!ae||ae===L&&!g.has(se)&&(g.add(se),N.push(se))})}const M=Array.from(g);return M.sort(),M},[hi,$e]),y_=f.useMemo(()=>{var M,L,I,se,ae;if(!Ua.length)return"";let g="",N="";for(const ce of Ua){const ie=Ba.find(Te=>(Te==null?void 0:Te.id)===ce);if(!ie)continue;const be=String(((M=ie==null?void 0:ie.data)==null?void 0:M.catalogType)??"").toLowerCase().trim();if(be==="feature_target_split"){const Te=(I=(L=ie==null?void 0:ie.data)==null?void 0:L.config)==null?void 0:I.target_column;typeof Te=="string"&&Te.trim()&&(g=Te.trim())}else if(be==="train_test_split"){const Te=(ae=(se=ie==null?void 0:ie.data)==null?void 0:se.config)==null?void 0:ae.target_column;typeof Te=="string"&&Te.trim()&&(N=Te.trim())}}return g||N||""},[Ba,Ua]),{featureTargetSplitConfig:b_,trainTestSplitConfig:x_,resamplingConfig:wo,trainModelDraftConfig:Nl,trainModelRuntimeConfig:pi,trainModelCVConfig:ih,filteredModelTypeOptions:Ud}=p$({configState:_e,setConfigState:Be,isFeatureTargetSplitNode:B,isTrainTestSplitNode:q,isTrainModelDraftNode:K,isHyperparameterTuningNode:z,isClassResamplingNode:Ve,isClassOversamplingNode:Y,isClassUndersamplingNode:X,upstreamTargetColumn:y_,nodeId:$e,modelTypeOptions:(oe==null?void 0:oe.options)??null}),gi=f.useMemo(()=>U?B0((_e==null?void 0:_e.operations)??[]):[],[_e==null?void 0:_e.operations,U]),qd=f.useMemo(()=>{if(!Ua.length)return{};const g={};return Ua.forEach(N=>{var I;const M=Ba.find(se=>se&&typeof se.id=="string"&&se.id===N);if(!M)return;const L=((I=M==null?void 0:M.data)==null?void 0:I.config)??null;g[N]=L}),g},[Ba,Ua]),Hd=f.useMemo(()=>Sd({sourceId:i??null,nodeId:$e||null,config:_e,upstreamIds:Ua,upstreamConfig:qd}),[_e,$e,i,qd,Ua]),[Sl,ha]=f.useState(null),jo=f.useMemo(()=>(Sl==null?void 0:Sl.columns)??[],[Sl]),Vd=f.useMemo(()=>{const g=new Set;return Ba.forEach(N=>{if(!N)return;const M=typeof N.id=="string"?N.id.trim():String((N==null?void 0:N.id)??"").trim();if(!M)return;const L=(N==null?void 0:N.data)??{};(M==="dataset-source"||(L==null?void 0:L.isDataset)===!0||(L==null?void 0:L.catalogType)==="dataset")&&g.add(M)}),g.size||g.add("dataset-source"),Array.from(g)},[Ba]),vt=f.useMemo(()=>{if(!$e)return!1;if(v)return!0;if(!hi.length)return Vd.includes($e);const g=new Map;hi.forEach(L=>{const I=L==null?void 0:L.source,se=L==null?void 0:L.target,ae=typeof I=="string"?I.trim():String(I??"").trim(),ce=typeof se=="string"?se.trim():String(se??"").trim();if(!ae||!ce)return;const ie=g.get(ae);ie?ie.push(ce):g.set(ae,[ce])});const N=new Set,M=[...Vd];for(;M.length;){const L=M.pop();if(!L||N.has(L))continue;N.add(L);const I=g.get(L);I&&I.forEach(se=>{se&&!N.has(se)&&M.push(se)})}return N.has($e)},[Vd,hi,v,$e]),Cl=f.useMemo(()=>{if(!Y||!jo.length)return null;const g=wo==null?void 0:wo.targetColumn;if(!g)return null;const N=new Set(["numeric","integer","boolean"]),M=jo.filter(L=>L&&L.name!==g).filter(L=>!N.has(String(L.logical_family??"unknown"))).map(L=>({name:L.name,logical_family:String(L.logical_family??"unknown")}));return M.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:M.map(L=>L.name),details:M}:null},[jo,Y,wo==null?void 0:wo.targetColumn]),El=f.useMemo(()=>{if(!w||!jo.length||!Ia.length)return null;const g=new Set(["numeric","integer"]),N=new Map(jo.map(L=>[L.name,L])),M=[];return Ia.forEach((L,I)=>{if(!Dx(L.method)||!Array.isArray(L.columns)||!L.columns.length)return;const se=L.columns.map(ae=>N.get(ae)).filter(ae=>!!ae).filter(ae=>!g.has(String(ae.logical_family??"unknown"))).map(ae=>({name:ae.name,logical_family:String(ae.logical_family??"unknown")}));se.length&&M.push({index:I,columns:se.map(ae=>ae.name),details:se})}),M.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:M}:null},[jo,Ia,w]),kl=!!(Cl!=null&&Cl.blocked||El!=null&&El.blocked),[nn,eu]=f.useState([]),[No,tu]=f.useState(""),[So,_i]=f.useState({}),[rr,Ml]=f.useState({}),[Al,Ol]=f.useState({}),[lh,Wd]=f.useState(0),w_=!!Bd,{hasDropColumnSource:j_,availableFilters:ch,activeFilterId:ar,setActiveFilterId:vi,recommendations:Co,filteredRecommendations:Kd,formatSignalName:Yd,isFetchingRecommendations:pa,recommendationsError:nu,recommendationsGeneratedAt:N_,suggestedThreshold:su,refreshRecommendations:Eo}=B1({hasDropColumnSource:w_,sourceId:i,nodeId:$e,graphContext:Pn,hasReachableSource:vt,columnTypeMap:rr,setAvailableColumns:eu,setColumnSearch:tu,setColumnMissingMap:_i,setColumnTypeMap:Ml,setColumnSuggestions:Ol});R2({shouldLoad:w,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null,setAvailableColumns:eu,setColumnMissingMap:_i});const{isFetching:Qd,error:Pl,suggestions:Gd,metadata:ru}=x$({isLabelEncodingNode:k,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:au,error:yi,suggestions:Tl,metadata:qa}=S$({isTargetEncodingNode:D,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:ko,error:uh,suggestions:ou,metadata:bi}=M$({isHashEncodingNode:$,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:dh,error:mh,suggestions:iu,metadata:or}=T$({isOrdinalEncodingNode:W,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:Xd,error:Jd,suggestions:Zd,metadata:em}=z$({isDummyEncodingNode:F,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:$l,error:S_,suggestions:lu,metadata:fh}=B$({isOneHotEncodingNode:te,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null});f.useEffect(()=>{k&&ru.autoDetectDefault&&(_e==null?void 0:_e.auto_detect)!==!0&&(_e==null?void 0:_e.auto_detect)!==!1&&Be(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[_e==null?void 0:_e.auto_detect,k,ru.autoDetectDefault,Be]),f.useEffect(()=>{D&&qa.autoDetectDefault&&(_e==null?void 0:_e.auto_detect)!==!0&&(_e==null?void 0:_e.auto_detect)!==!1&&Be(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[_e==null?void 0:_e.auto_detect,D,Be,qa.autoDetectDefault]),f.useEffect(()=>{$&&bi.autoDetectDefault&&(_e==null?void 0:_e.auto_detect)!==!0&&(_e==null?void 0:_e.auto_detect)!==!1&&Be(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[_e==null?void 0:_e.auto_detect,bi.autoDetectDefault,$,Be]),f.useEffect(()=>{if(!$)return;const g=bi.suggestedBucketDefault;if(!g||!Number.isFinite(g))return;const N=Math.max(2,Math.round(g));Be(M=>{if(!M||typeof M!="object"||Array.isArray(M))return M;const L=M.n_buckets;if(L!=null){const I=Number(L);if(Number.isFinite(I)&&Math.round(I)>0)return M}return{...M,n_buckets:N}})},[bi.suggestedBucketDefault,$,Be]),f.useEffect(()=>{if(!D||!qa.enableGlobalFallbackDefault)return;const g=typeof(_e==null?void 0:_e.encode_missing)=="boolean"?_e.encode_missing:null,N=typeof(_e==null?void 0:_e.handle_unknown)=="string"?_e.handle_unknown.trim().toLowerCase():"";g===!0&&N==="global_mean"||Be(M=>{const L=typeof(M==null?void 0:M.encode_missing)=="boolean"?M.encode_missing:null,I=typeof(M==null?void 0:M.handle_unknown)=="string"?M.handle_unknown.trim().toLowerCase():"";if(L===!0&&I==="global_mean")return M;const se={...M};return L!==!0&&(se.encode_missing=!0),I!=="global_mean"&&(se.handle_unknown="global_mean"),se})},[_e==null?void 0:_e.encode_missing,_e==null?void 0:_e.handle_unknown,D,Be,qa.enableGlobalFallbackDefault]),f.useEffect(()=>{W&&or.autoDetectDefault&&(_e==null?void 0:_e.auto_detect)!==!0&&(_e==null?void 0:_e.auto_detect)!==!1&&Be(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[_e==null?void 0:_e.auto_detect,W,or.autoDetectDefault,Be]),f.useEffect(()=>{!W||!or.enableUnknownDefault||typeof(_e==null?void 0:_e.handle_unknown)=="string"&&_e.handle_unknown.trim().toLowerCase()||Be(N=>(typeof(N==null?void 0:N.handle_unknown)=="string"?N.handle_unknown.trim().toLowerCase():"")?N:{...N,handle_unknown:"use_encoded_value"})},[_e==null?void 0:_e.handle_unknown,W,or.enableUnknownDefault,Be]),f.useEffect(()=>{F&&em.autoDetectDefault&&(_e==null?void 0:_e.auto_detect)!==!0&&(_e==null?void 0:_e.auto_detect)!==!1&&Be(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[_e==null?void 0:_e.auto_detect,em.autoDetectDefault,F,Be]),f.useEffect(()=>{!Gc&&!w||i&&vt||(eu([]),_i({}),Ml({}),Ol({}),tu(""))},[vt,w,Gc,i]);const sn=e==null?void 0:e.id,cu=f.useRef(sn);f.useEffect(()=>{cu.current!==sn&&(cu.current=sn,Be(Jc),fa.current=!1)},[sn]),f.useEffect(()=>{Wd(0)},[w,e==null?void 0:e.id]);const[Ll,Dl]=f.useState("500"),[uu,ms]=f.useState(()=>new Set),[zl,ir]=f.useState(()=>new Set);f.useEffect(()=>{ms(new Set)},[rh]),f.useEffect(()=>{if(!D){fa.current=!1;return}if(!qa.enableGlobalFallbackDefault||fa.current)return;const g=typeof(_e==null?void 0:_e.encode_missing)=="boolean"?_e.encode_missing:null,N=typeof(_e==null?void 0:_e.handle_unknown)=="string"?_e.handle_unknown.trim().toLowerCase():"";if(g===!0&&N==="global_mean"){fa.current=!0;return}Be(M=>{const L=typeof(M==null?void 0:M.encode_missing)=="boolean"?M.encode_missing:null,I=typeof(M==null?void 0:M.handle_unknown)=="string"?M.handle_unknown.trim().toLowerCase():"";if(L===!0&&I==="global_mean")return fa.current=!0,M;const se={...M};return L!==!0&&(se.encode_missing=!0),I!=="global_mean"&&(se.handle_unknown="global_mean"),fa.current=!0,se})},[_e==null?void 0:_e.encode_missing,_e==null?void 0:_e.handle_unknown,D,Be,qa.enableGlobalFallbackDefault]);const kr=f.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="data_preview"},[(Na=e==null?void 0:e.data)==null?void 0:Na.catalogType]),tm=f.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="dataset_profile"},[(lc=e==null?void 0:e.data)==null?void 0:lc.catalogType]),C_=f.useMemo(()=>Pn?Sd(Pn):"",[Pn]),hh=rM({node:e,isDatasetProfileNode:tm,sourceId:i,hasReachableSource:vt,graphContext:Pn,profilingGraphSignature:C_,formatRelativeTime:Gs}),{profileState:ph}=hh,du=f.useMemo(()=>!(!l||!Zc||!vt),[Zc,l,vt,i]),Rl=f.useMemo(()=>!l||!i||!vt?!1:Zc>0,[Zc,l,vt,i]),nm=kr||U||G||V||q||de||Z,{previewState:Mt,refreshPreview:mu}=z2({shouldFetchPreview:du,sourceId:i,canTriggerPreview:Rl,graphSnapshot:l??null,isPreviewNode:kr,targetNodeId:(e==null?void 0:e.id)??null,previewSignature:Hd,skipPreview:kl,requestPreviewRows:kr,includeSignals:nm}),Fl=f.useMemo(()=>{var N,M;if(!U)return[];const g=(M=(N=Mt.data)==null?void 0:N.signals)==null?void 0:M.feature_math;return Array.isArray(g)?g:[]},[U,(Bu=(zi=Mt.data)==null?void 0:zi.signals)==null?void 0:Bu.feature_math]),E_=f.useMemo(()=>{var M,L;if(!G)return null;const g=(L=(M=Mt.data)==null?void 0:M.signals)==null?void 0:L.polynomial_features;return!Array.isArray(g)||g.length===0?null:($e?g.find(I=>I&&typeof I.node_id=="string"&&I.node_id===$e):null)??g[0]??null},[G,$e,(uc=(cc=Mt.data)==null?void 0:cc.signals)==null?void 0:uc.polynomial_features]),gh=f.useMemo(()=>{var M,L;if(!V)return null;const g=(L=(M=Mt.data)==null?void 0:M.signals)==null?void 0:L.feature_selection;return!Array.isArray(g)||g.length===0?null:($e?g.find(I=>I&&typeof I.node_id=="string"&&I.node_id===$e):null)??g[0]??null},[V,$e,(Sa=(gs=Mt.data)==null?void 0:gs.signals)==null?void 0:Sa.feature_selection]),k_=f.useMemo(()=>U?FP(gi,Fl):[],[gi,Fl,U]);f.useEffect(()=>{if(!U){ir(()=>new Set);return}ir(g=>{if(!g.size)return g;const N=new Set(gi.map(L=>L.id)),M=new Set;return g.forEach(L=>{N.has(L)&&M.add(L)}),M.size===g.size?g:M})},[gi,U]);const{outlierData:Il,outlierError:sm,isFetchingOutliers:Ha,refreshOutliers:rm}=H2({isOutlierNode:de,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:$e||null}),{scalingData:lr,scalingError:Ur,isFetchingScaling:Va,refreshScaling:qr}=P2({isScalingNode:ee,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null}),{binningData:zn,binningError:M_,isFetchingBinning:fu,refreshBinning:Wa}=T2({isBinningNode:Q,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null}),Hr=f.useCallback(()=>{ha(null),mu(),ee&&qr(),Q&&Wa(),de&&rm()},[Q,de,ee,Wa,rm,mu,qr]);f.useEffect(()=>{var N;const g=((N=Mt.data)==null?void 0:N.schema)??null;g&&ha(M=>M!=null&&M.signature&&g.signature&&M.signature===g.signature?M:g)},[(_r=Mt.data)==null?void 0:_r.schema]),f.useEffect(()=>{ha(null)},[i]),f.useEffect(()=>{ha(null)},[Hd]);const{binnedDistributionData:Xn,binnedDistributionError:hu,isFetchingBinnedDistribution:xi,refreshBinnedDistribution:Mo}=L2({isBinnedDistributionNode:ge,sourceId:i,hasReachableSource:vt,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null,samplePreset:Ll}),{skewnessData:Ka,skewnessError:rn,isFetchingSkewness:Gt}=$2({shouldLoad:sh,sourceId:i,graphContext:Pn,targetNodeId:(e==null?void 0:e.id)??null,transformations:oh}),Vr=f.useMemo(()=>{var N;const g=(N=Mt.data)==null?void 0:N.columns;return Array.isArray(g)?g.filter(M=>typeof M=="string"):[]},[(Es=Mt.data)==null?void 0:Es.columns]),fs=f.useMemo(()=>{var N;const g=(N=Mt.data)==null?void 0:N.column_stats;return Array.isArray(g)?g:[]},[(Lm=Mt.data)==null?void 0:Lm.column_stats]),an=f.useMemo(()=>{var g,N;return x?GM(_e==null?void 0:_e.flag_suffix,(N=(g=e==null?void 0:e.data)==null?void 0:g.config)==null?void 0:N.flag_suffix):""},[_e==null?void 0:_e.flag_suffix,x,(qu=(Uu=e==null?void 0:e.data)==null?void 0:Uu.config)==null?void 0:qu.flag_suffix]),Ya=f.useMemo(()=>x?mt(_e==null?void 0:_e.columns):[],[_e==null?void 0:_e.columns,x]),wi=f.useMemo(()=>x?JM({selectedColumns:Ya,availableColumns:nn,columnMissingMap:So,suffix:an}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[an,nn,So,x,Ya]),Tn=f.useMemo(()=>{var g;return Array.isArray((g=Mt.data)==null?void 0:g.sample_rows)?Mt.data.sample_rows:[]},[(gp=Mt.data)==null?void 0:gp.sample_rows]),{aliasStrategies:pu,aliasStrategyCount:am,aliasColumnSummary:gu,aliasCustomPairSummary:_u,aliasSampleMap:_h,aliasColumnOptions:ga}=q2({isReplaceAliasesNode:S,configState:_e,nodeConfig:((Ca=e==null?void 0:e.data)==null?void 0:Ca.config)??null,availableColumns:nn,columnTypeMap:rr,previewSampleRows:Tn}),{trimWhitespace:{columnSummary:vu,sampleMap:om,modeDetails:vh},removeSpecial:{columnSummary:A_,sampleMap:Qa,modeDetails:ji},regexCleanup:{columnSummary:Ni,sampleMap:yu,modeDetails:bu,selectedMode:cr,replacementValue:ur},normalizeCase:{columnSummary:Ao,sampleMap:_a,modeDetails:va,selectedMode:Oo}}=o$({isTrimWhitespaceNode:E,isRemoveSpecialCharsNode:A,isRegexCleanupNode:T,isNormalizeTextCaseNode:j,configState:_e,nodeConfig:((Dm=e==null?void 0:e.data)==null?void 0:Dm.config)??null,availableColumns:nn,columnTypeMap:rr,previewSampleRows:Tn}),{selectedMode:yh,modeDetails:im,sampleMap:lm,columnSummary:Us,minValue:qs,maxValue:bn}=l$({isReplaceInvalidValuesNode:P,configState:_e,nodeConfig:((Hu=e==null?void 0:e.data)==null?void 0:Hu.config)??null,availableColumns:nn,columnTypeMap:rr,previewSampleRows:Tn}),{selectedMode:dr,strategies:xu,sampleMap:bh,columnSummary:Bl,columnOptions:cm}=u$({isStandardizeDatesNode:O,configState:_e,nodeConfig:((eo=e==null?void 0:e.data)==null?void 0:eo.config)??null,availableColumns:nn,columnTypeMap:rr,previewSampleRows:Tn}),xh=Q||ee||de,{numericExcludedColumns:Mr}=Y2({shouldAnalyze:xh,availableColumns:nn,columnTypeMap:rr,previewSampleRows:Tn}),{scalingConfig:wu,scalingExcludedColumns:os,scalingMethodDetailMap:um,scalingMethodOptions:O_,scalingRecommendations:Po,scalingRecommendationRows:ju,scalingSelectedCount:wh,scalingOverrideCount:jh,scalingDefaultDetail:Si,scalingDefaultLabel:Nh,scalingAutoDetectEnabled:Nu,scalingHasRecommendations:Su,scalingStatusMessage:Ci,scalingOverrideExampleSummary:dm}=d$({isScalingNode:ee,configState:_e,numericExcludedColumns:Mr,scalingData:lr}),{outlierConfig:To,outlierExcludedColumns:Ul,outlierMethodDetailMap:mm,outlierMethodOptions:Ei,outlierRecommendationRows:Ss,outlierSelectedCount:$o,outlierOverrideCount:ki,outlierParameterOverrideCount:Lo,outlierDefaultDetail:ya,outlierDefaultLabel:Ga,outlierAutoDetectEnabled:fm,outlierHasRecommendations:Sh,outlierStatusMessage:ba,outlierOverrideExampleSummary:xa}=m$({isOutlierNode:de,configState:_e,numericExcludedColumns:Mr,outlierData:Il}),Cu=typeof(Il==null?void 0:Il.sample_size)=="number"?Il.sample_size:null,Ch=null,Eu=ki>0||Lo>0,Eh=f.useMemo(()=>ki>0?xa:Lo>0?`${Lo} column${Lo===1?"":"s"} with parameter overrides`:null,[ki,Lo,xa]),{binningConfig:Jn,binningDefaultLabel:Wr,binningOverrideCount:ql,binningOverrideSummary:Hl,fieldIds:Do,customEdgeDrafts:hm,setCustomEdgeDrafts:zo,customLabelDrafts:kh,setCustomLabelDrafts:ku}=f$({configState:_e,nodeId:$e}),jn=`${$e||"node"}-remove-duplicates-keep`,hn=f.useMemo(()=>ee?wu.columns:Q?Jn.columns:de?To.columns:mt(_e==null?void 0:_e.columns),[Jn.columns,_e,Q,de,ee,To.columns,wu.columns]),Ar=f.useMemo(()=>{const g=zn==null?void 0:zn.columns;return Array.isArray(g)?g.filter(N=>!N||typeof N.column!="string"?!1:!!N.column.trim()):[]},[zn==null?void 0:zn.columns]),mr=f.useMemo(()=>{if(!Ar.length)return new Set;const g=new Set;return Ar.forEach(N=>{const M=typeof N.column=="string"?N.column.trim():"";M&&g.add(M)}),g},[Ar]),fr=f.useMemo(()=>{if(!Q)return[];const g=new Set;return nn.forEach(N=>{if(Mr.has(N))return;const M=N.trim();M&&g.add(M)}),Ar.forEach(N=>{const M=typeof N.column=="string"?N.column.trim():"";M&&(!Mr.has(M)||mr.has(M))&&g.add(M)}),hn.forEach(N=>{const M=typeof N=="string"?N.trim():"";M&&(!Mr.has(M)||mr.has(M))&&g.add(M)}),Array.from(g).sort((N,M)=>N.localeCompare(M))},[nn,Ar,mr,Q,Mr,hn]),Ro=f.useMemo(()=>!Q||!fr.length?[]:fr.filter(g=>!hn.includes(g)),[fr,Q,hn]).length>0,Nn=f.useMemo(()=>{const g=typeof(_e==null?void 0:_e.keep)=="string"?_e.keep.trim().toLowerCase():"";return g==="last"||g==="none"?g:H1},[_e==null?void 0:_e.keep]),{binningExcludedColumns:on,binningColumnPreviewMap:Un}=G2({isBinningNode:Q,numericExcludedColumns:Mr,selectedColumns:hn,previewSampleRows:Tn,availableColumns:nn,recommendedColumns:mr}),Mu=f.useMemo(()=>{const g=zn==null?void 0:zn.excluded_columns;return Array.isArray(g)?g.filter(N=>!N||typeof N.column!="string"?!1:!!N.column.trim()):[]},[zn==null?void 0:zn.excluded_columns]);a$({isScalingNode:ee,isBinningNode:Q,isOutlierNode:de,scalingExcludedColumns:os,binningExcludedColumns:on,outlierExcludedColumns:Ul,setConfigState:Be});const Vl=f.useMemo(()=>{var M,L;if(!de)return null;const g=(L=(M=Mt.data)==null?void 0:M.signals)==null?void 0:L.outlier_removal;return!Array.isArray(g)||!g.length?null:$e?g.find(I=>I&&I.node_id===$e)??g[g.length-1]??null:g[g.length-1]??null},[de,$e,(to=(Vu=Mt.data)==null?void 0:Vu.signals)==null?void 0:to.outlier_removal]),Wl=f.useMemo(()=>{var M,L;if(!Z)return null;const g=(L=(M=Mt.data)==null?void 0:M.signals)==null?void 0:L.transformer_audit;return!Array.isArray(g)||!g.length?null:$e?g.find(I=>I&&I.node_id===$e)??g[g.length-1]??null:g[g.length-1]??null},[Z,$e,(Rm=(zm=Mt.data)==null?void 0:zm.signals)==null?void 0:Rm.transformer_audit]);f.useEffect(()=>{var L;const g=Array.isArray((L=Mt.data)==null?void 0:L.column_stats)?Mt.data.column_stats:[];if(!g.length){if(Mt.status==="loading")return;Ml(I=>Object.keys(I).length?{}:I),Ol(I=>Object.keys(I).length?{}:I);return}const N={},M={};g.forEach(I=>{if(!I||!I.name)return;const se=String(I.name).trim();if(!se||an&&se.endsWith(an))return;const ae=typeof I.dtype=="string"?I.dtype:null;ae&&(N[se]=ae);const ce=Tn.map(be=>be&&Object.prototype.hasOwnProperty.call(be,se)?be[se]:void 0),ie=UT(ae,ce);ie.length&&(M[se]=ie)}),Ml(I=>{const se=Object.entries(I),ae=Object.entries(N);return se.length===ae.length&&se.every(([ce,ie])=>Object.prototype.hasOwnProperty.call(N,ce)&&N[ce]===ie)?I:N}),Ol(I=>{const se=Object.keys(I),ae=Object.keys(M);return se.length===ae.length&&se.every(ce=>{if(!Object.prototype.hasOwnProperty.call(M,ce))return!1;const ie=I[ce]??[],be=M[ce]??[];return aw(ie,be)})?I:M})},[an,Tn,(Wu=Mt.data)==null?void 0:Wu.column_stats,Mt.status]),f.useEffect(()=>{var se,ae,ce;if(!Gc||!vt)return;const g=new Set;(Array.isArray((se=Mt.data)==null?void 0:se.columns)?Mt.data.columns:[]).forEach(ie=>{const be=typeof ie=="string"?ie.trim():"";be&&(an&&be.endsWith(an)||g.add(be))});const M=Array.isArray((ae=Mt.data)==null?void 0:ae.column_stats)?Mt.data.column_stats:[],L={};if(M.forEach(ie=>{if(!ie||!ie.name)return;const be=String(ie.name).trim();if(!be||an&&be.endsWith(an))return;g.add(be);const Te=Number(ie.missing_percentage);!Number.isNaN(Te)&&Te>=0&&(L[be]=Te)}),mt((ce=e==null?void 0:e.data)==null?void 0:ce.columns).forEach(ie=>{ie&&!(an&&ie.endsWith(an))&&g.add(ie)}),hn.forEach(ie=>{ie&&!(an&&ie.endsWith(an))&&g.add(ie)}),g.size===0)return;const I=Array.from(g).sort((ie,be)=>ie.localeCompare(be));eu(ie=>aw(ie,I)?ie:I),Object.keys(L).length>0&&_i(ie=>({...ie,...L}))},[an,vt,(dc=e==null?void 0:e.data)==null?void 0:dc.columns,(_p=Mt.data)==null?void 0:_p.column_stats,(vp=Mt.data)==null?void 0:vp.columns,Gc,hn]);const Mi=f.useMemo(()=>No.trim().toLowerCase(),[No]),Zn=f.useMemo(()=>Mi?nn.filter(g=>g.toLowerCase().includes(Mi)):nn,[nn,Mi]),pm=f.useCallback(g=>{Be(N=>{const M=Pg(Ux(N==null?void 0:N.transformations)),L=Pg(g(M));return{...N,transformations:L.map(I=>({...I}))}})},[]),{skewnessThreshold:Kl,skewnessViewMode:gm,setSkewnessViewMode:Kr,skewnessGroupByMethod:hr,setSkewnessGroupByMethod:Yl,skewnessDistributionView:Xa,setSkewnessDistributionView:Au,skewnessRecommendedCount:Ah,skewnessNumericCount:Oh,skewnessTransformationsCount:Ph,hasSkewnessAutoRecommendations:Th,skewnessRows:$h,skewnessTableGroups:Lh,skewnessDistributionCards:Fo,getSkewnessMethodLabel:Dh,getSkewnessMethodStatus:Ql,applySkewnessRecommendations:zh,handleSkewnessOverrideChange:Ou,clearSkewnessTransformations:Pu}=_$({skewnessData:Ka,shouldLoadInsights:sh,skewnessTransformations:oh,availableColumns:nn,previewColumns:Vr,columnTypeMap:rr,updateSkewnessTransformations:pm}),{imputerColumnOptions:Rh,imputerMissingSliderMax:_m,imputerFilteredOptionCount:Fh,imputerMissingFilterActive:Ih}=h$({isImputerNode:w,imputerStrategies:Ia,availableColumns:nn,columnMissingMap:So,previewColumns:Vr,previewColumnStats:fs,nodeColumns:(Fm=e==null?void 0:e.data)==null?void 0:Fm.columns,imputerMissingFilter:lh}),Ja=f.useMemo(()=>J.find(g=>g.name==="missing_threshold"),[J]),wa=(Ja==null?void 0:Ja.name)??null,pr=f.useMemo(()=>{if(su===null||Number.isNaN(Number(su)))return null;const g=Number(su);return Math.round(g*10)/10},[su]),Tu=f.useMemo(()=>{if(wa===null||pr===null)return!1;const g=Number(_e==null?void 0:_e[wa]);return!Number.isNaN(g)&&g===pr},[_e,pr,wa]),Bh=Re&&!!(Ja||Xc),Hs=f.useCallback((g,N)=>{g&&Be(M=>{const L={...M};return N===void 0?delete L[g]:L[g]=N,L})},[]),Uh=f.useCallback((g,N)=>{if(!g)return;if(N===""){Hs(g,void 0);return}const M=Number(N);Number.isNaN(M)||Hs(g,M)},[Hs]);f.useCallback((g,N)=>{if(!g)return;if(N===""){Hs(g,void 0);return}const M=Number(N);if(!Number.isFinite(M))return;const L=Math.min(Math.max(M,0),100);Hs(g,L)},[Hs]),f.useCallback((g,N,M)=>{const L=String(g??"").trim();L&&Be(I=>{const se=I.manual_bounds&&typeof I.manual_bounds=="object"&&!Array.isArray(I.manual_bounds)?{...I.manual_bounds}:{},ae=se[L]&&typeof se[L]=="object"?{...se[L]}:{lower:null,upper:null};if(M==="")N==="lower"?ae.lower=null:ae.upper=null;else{const be=Number(M);if(!Number.isFinite(be))return I;N==="lower"?ae.lower=be:ae.upper=be}const ce=ae.lower??null,ie=ae.upper??null;return ce===null&&ie===null?delete se[L]:se[L]={lower:ce,upper:ie},{...I,manual_bounds:se}})},[]),f.useCallback(g=>{const N=String(g??"").trim();N&&Be(M=>{const L=M.manual_bounds&&typeof M.manual_bounds=="object"&&!Array.isArray(M.manual_bounds)?M.manual_bounds:null;if(!L||!Object.prototype.hasOwnProperty.call(L,N))return M;const I={...L};return delete I[N],{...M,manual_bounds:I}})},[]);const vm=f.useCallback((g,N)=>{Hs(g,N)},[Hs]),Gl=f.useCallback((g,N)=>{Hs(g,N)},[Hs]),P_=f.useCallback((g,N,M,L)=>{Be(I=>{const se=typeof(I==null?void 0:I[g])=="number"&&Number.isFinite(I[g])?I[g]:void 0;if(N===""){if(se===void 0)return I;const ie={...I};return delete ie[g],ie}const ae=Number(N);if(!Number.isFinite(ae))return I;const ce=Math.min(Math.max(Math.round(ae),M),L);return se===ce?I:{...I,[g]:ce}})},[]),qh=f.useCallback((g,N)=>{Be(M=>!!(M!=null&&M[g])===N?M:{...M,[g]:N})},[]),Hh=f.useCallback(g=>{const N=g.trim();Be(M=>{const L=typeof(M==null?void 0:M.output_suffix)=="string"?M.output_suffix:"";if(!N){if(!L)return M;const I={...M};return delete I.output_suffix,I}return L===N?M:{...M,output_suffix:N}})},[]),Vh=f.useCallback(g=>{Be(N=>{const M=typeof(N==null?void 0:N.label_format)=="string"?N.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(M)?M:"range")===g?N:{...N,label_format:g}})},[]),$u=f.useCallback(g=>{Be(N=>{if(((N==null?void 0:N.missing_strategy)==="label"?"label":"keep")===g)return N;const L={...N,missing_strategy:g};return g!=="label"&&Object.prototype.hasOwnProperty.call(L,"missing_label")&&delete L.missing_label,L})},[]),T_=f.useCallback(g=>{const N=g.trim();Be(M=>{const L=typeof(M==null?void 0:M.missing_label)=="string"?M.missing_label:"";if(!N){if(!L)return M;const I={...M};return delete I.missing_label,I}return L===N?M:{...M,missing_label:N}})},[]),$_=f.useCallback((g,N)=>{const M=String(g??"").trim();M&&(zo(L=>({...L,[M]:N})),Be(L=>{const I=L==null?void 0:L.custom_bins,se=I&&typeof I=="object"&&!Array.isArray(I)?I:{},ae=Array.isArray(se[M])?se[M]:void 0,ie=N.split(/[,\n]/).map(pt=>pt.trim()).filter(Boolean).map(pt=>Number(pt)).filter(pt=>Number.isFinite(pt)).sort((pt,zt)=>pt-zt).filter((pt,zt,_n)=>zt===0||pt!==_n[zt-1]),be=ie.length>=2;if(be&&ae&&ae.length===ie.length&&ae.every((pt,zt)=>pt===ie[zt])||!be&&!ae)return L;const Te={...L},ct={...se};return be?ct[M]=ie:delete ct[M],Object.keys(ct).length>0?Te.custom_bins=ct:delete Te.custom_bins,Te}))},[]),L_=f.useCallback((g,N)=>{const M=String(g??"").trim();M&&(ku(L=>({...L,[M]:N})),Be(L=>{const I=L==null?void 0:L.custom_labels,se=I&&typeof I=="object"&&!Array.isArray(I)?I:{},ae=Array.isArray(se[M])?se[M]:void 0,ce=N.split(/[,\n]/).map(Te=>Te.trim()).filter(Boolean);if(ce.length>0&&ae&&ae.length===ce.length&&ae.every((Te,ct)=>Te===ce[ct])||ce.length===0&&!ae)return L;const ie={...L},be={...se};return ce.length>0?be[M]=ce:delete be[M],Object.keys(be).length>0?ie.custom_labels=be:delete ie.custom_labels,ie}))},[]),es=f.useCallback(g=>{const N=String(g??"").trim();N&&(zo(M=>{if(!Object.prototype.hasOwnProperty.call(M,N))return M;const L={...M};return delete L[N],L}),ku(M=>{if(!Object.prototype.hasOwnProperty.call(M,N))return M;const L={...M};return delete L[N],L}),Be(M=>{let L=!1;const I={...M};if(M!=null&&M.custom_bins&&typeof M.custom_bins=="object"&&!Array.isArray(M.custom_bins)&&Object.prototype.hasOwnProperty.call(M.custom_bins,N)){const se={...M.custom_bins};delete se[N],Object.keys(se).length>0?I.custom_bins=se:delete I.custom_bins,L=!0}if(M!=null&&M.custom_labels&&typeof M.custom_labels=="object"&&!Array.isArray(M.custom_labels)&&Object.prototype.hasOwnProperty.call(M.custom_labels,N)){const se={...M.custom_labels};delete se[N],Object.keys(se).length>0?I.custom_labels=se:delete I.custom_labels,L=!0}return L?I:M}))},[]),Vs=f.useCallback((g,N)=>{const M=String(g??"").trim();M&&Be(L=>{const se={...L!=null&&L.column_strategies&&typeof L.column_strategies=="object"&&!Array.isArray(L.column_strategies)?L.column_strategies:L!=null&&L.column_overrides&&typeof L.column_overrides=="object"&&!Array.isArray(L.column_overrides)?L.column_overrides:{}},ae=se[M],ce=ae&&typeof ae=="object"&&!Array.isArray(ae)?{...ae}:{},ie=N(ce),be=!!(ie&&Object.keys(ie).length);be?se[M]=ie:delete se[M];const Te={...L};if(be){const ct=new Set(mt(L==null?void 0:L.columns));ct.has(M)||(ct.add(M),Te.columns=Array.from(ct).sort((pt,zt)=>pt.localeCompare(zt)))}return Object.keys(se).length?(Te.column_overrides=se,Te.column_strategies=se):(Object.prototype.hasOwnProperty.call(Te,"column_overrides")&&delete Te.column_overrides,Object.prototype.hasOwnProperty.call(Te,"column_strategies")&&delete Te.column_strategies),Te})},[Be]),Ai=f.useCallback((g,N,M)=>{const L=String(g??"").trim();if(!L)return;if(N==="__default__"){es(L),Vs(L,()=>null);return}const I=Number.isFinite(M==null?void 0:M.recommendedBins)?Math.round(M.recommendedBins):null;Vs(L,se=>{const ae={...se};ae.strategy=N;const ce=ie=>Math.min(200,Math.max(2,Math.round(I??ie)));return N==="equal_width"?(ae.equal_width_bins=ce(Jn.equalWidthBins),delete ae.equal_frequency_bins,delete ae.kbins_n_bins,delete ae.kbins_encode,delete ae.kbins_strategy):N==="equal_frequency"?(ae.equal_frequency_bins=ce(Jn.equalFrequencyBins),delete ae.equal_width_bins,delete ae.kbins_n_bins,delete ae.kbins_encode,delete ae.kbins_strategy):N==="kbins"?(ae.kbins_n_bins=ce(Jn.kbinsNBins),ae.kbins_encode=Jn.kbinsEncode,ae.kbins_strategy=Jn.kbinsStrategy,delete ae.equal_width_bins,delete ae.equal_frequency_bins):N==="custom"&&(delete ae.equal_width_bins,delete ae.equal_frequency_bins,delete ae.kbins_n_bins,delete ae.kbins_encode,delete ae.kbins_strategy),Object.keys(ae).length?ae:null}),N!=="custom"&&es(L)},[Jn.equalFrequencyBins,Jn.equalWidthBins,Jn.kbinsEncode,Jn.kbinsNBins,Jn.kbinsStrategy,es,Vs]),Wh=f.useCallback((g,N,M)=>{const L=String(g??"").trim();L&&(Vs(L,I=>{const se={...I};if(!M.trim())delete se[N];else{const ae=Number(M);if(!Number.isFinite(ae))return I;const ce=Math.min(200,Math.max(2,Math.round(ae)));se[N]=ce,N==="equal_width_bins"?(se.strategy="equal_width",delete se.equal_frequency_bins,delete se.kbins_n_bins,delete se.kbins_encode,delete se.kbins_strategy):N==="equal_frequency_bins"?(se.strategy="equal_frequency",delete se.equal_width_bins,delete se.kbins_n_bins,delete se.kbins_encode,delete se.kbins_strategy):N==="kbins_n_bins"&&(se.strategy="kbins",delete se.equal_width_bins,delete se.equal_frequency_bins)}return Object.keys(se).length?se:null}),es(L))},[es,Vs]),Kh=f.useCallback((g,N)=>{const M=String(g??"").trim();M&&Vs(M,L=>{const I={...L};return N?(I.strategy="kbins",I.kbins_encode=N):delete I.kbins_encode,Object.keys(I).length?I:null})},[Vs]),Yh=f.useCallback((g,N)=>{const M=String(g??"").trim();M&&Vs(M,L=>{const I={...L};return N?(I.strategy="kbins",I.kbins_strategy=N):delete I.kbins_strategy,Object.keys(I).length?I:null})},[Vs]),ym=f.useCallback(g=>{const N=String(g??"").trim();N&&(es(N),Vs(N,()=>null))},[es,Vs]),Oi=f.useCallback(()=>{Be(g=>{if(!((g==null?void 0:g.column_strategies)&&typeof g.column_strategies=="object"&&!Array.isArray(g.column_strategies)&&Object.keys(g.column_strategies).length>0||(g==null?void 0:g.column_overrides)&&typeof g.column_overrides=="object"&&!Array.isArray(g.column_overrides)&&Object.keys(g.column_overrides).length>0))return g;const M={...g};return Object.prototype.hasOwnProperty.call(M,"column_overrides")&&delete M.column_overrides,Object.prototype.hasOwnProperty.call(M,"column_strategies")&&delete M.column_strategies,M})},[Be]),bm=f.useCallback(()=>{Ar.length&&Ar.forEach(g=>{const N=typeof(g==null?void 0:g.column)=="string"?g.column.trim():"";if(!N)return;const M=g.recommended_strategy??"equal_width";Ai(N,M,{recommendedBins:Number.isFinite(g==null?void 0:g.recommended_bins)?g.recommended_bins:null})})},[Ar,Ai]),Pi=f.useCallback(g=>{if(!g)return;const N=[];for(const M of g){const L=typeof M=="string"?M.trim():"";L&&N.push(L)}N.length&&Be(M=>{const L=M&&typeof M=="object"?M:{},I=new Set(mt(L.columns));let se=!1;if(N.forEach(ce=>{I.has(ce)||(I.add(ce),se=!0)}),!se)return M;const ae={...L};return ae.columns=Array.from(I).sort((ce,ie)=>ce.localeCompare(ie)),ae})},[]),D_=f.useCallback(()=>{fr.length&&Pi(fr)},[fr,Pi]),Yr=f.useCallback(g=>{const N=String(g??"").trim();N&&Be(M=>{const L=mt(M.columns),I=L.includes(N),se=I?L.filter(be=>be!==N):[...L,N];let ae=!1,ce=M.manual_bounds;I&&ce&&typeof ce=="object"&&!Array.isArray(ce)&&Object.prototype.hasOwnProperty.call(ce,N)&&(ce={...ce},delete ce[N],ae=!0);const ie={...M,columns:se};if(ae&&(ie.manual_bounds=ce),Q){const be=new Set(se);if(M.custom_bins&&typeof M.custom_bins=="object"&&!Array.isArray(M.custom_bins)){const Te={};Object.entries(M.custom_bins).forEach(([ct,pt])=>{be.has(ct)&&Array.isArray(pt)&&pt.length&&(Te[ct]=[...pt])}),Object.keys(Te).length?ie.custom_bins=Te:"custom_bins"in ie&&delete ie.custom_bins}else"custom_bins"in ie&&delete ie.custom_bins;if(M.custom_labels&&typeof M.custom_labels=="object"&&!Array.isArray(M.custom_labels)){const Te={};Object.entries(M.custom_labels).forEach(([ct,pt])=>{be.has(ct)&&Array.isArray(pt)&&pt.length&&(Te[ct]=pt.map(zt=>String(zt)))}),Object.keys(Te).length?ie.custom_labels=Te:"custom_labels"in ie&&delete ie.custom_labels}else"custom_labels"in ie&&delete ie.custom_labels;if(M.column_overrides&&typeof M.column_overrides=="object"&&!Array.isArray(M.column_overrides)){const Te={};Object.entries(M.column_overrides).forEach(([ct,pt])=>{be.has(ct)&&pt&&typeof pt=="object"&&!Array.isArray(pt)&&(Te[ct]={...pt})}),Object.keys(Te).length?(ie.column_overrides=Te,ie.column_strategies=Te):("column_overrides"in ie&&delete ie.column_overrides,"column_strategies"in ie&&delete ie.column_strategies)}else"column_overrides"in ie&&delete ie.column_overrides,"column_strategies"in ie&&delete ie.column_strategies}if(ee){let be=null;M.column_methods&&typeof M.column_methods=="object"&&!Array.isArray(M.column_methods)&&(be={},Object.entries(M.column_methods).forEach(([Te,ct])=>{const pt=typeof ct=="string"?ct.trim():null;!pt||!jr.includes(pt)||I&&Te===N||(be[Te]=pt)})),be&&Object.keys(be).length?ie.column_methods=be:I&&Object.prototype.hasOwnProperty.call(ie,"column_methods")&&delete ie.column_methods}return ie})},[Q,ee]),xm=f.useCallback(()=>{Co.length&&Be(g=>{const N=new Set(mt(g.columns));return Co.forEach(M=>{M!=null&&M.name&&N.add(String(M.name))}),{...g,columns:Array.from(N)}})},[Co]),Qh=f.useCallback(g=>{g.length&&Be(N=>{const M=new Set(mt(N.columns));g.forEach(I=>{const se=String(I??"").trim();se&&M.add(se)});const L=Array.from(M).sort((I,se)=>I.localeCompare(se));return{...N,columns:L}})},[]),Gh=f.useCallback(g=>{g.length&&Be(N=>{const M=new Set(mt(N.columns));let L=!1;g.forEach(ae=>{const ce=String(ae??"").trim();if(ce&&(M.add(ce),!L)){const ie=Tl.find(be=>be.column===ce);ie!=null&&ie.recommended_use_global_fallback&&(L=!0)}});const I=Array.from(M).sort((ae,ce)=>ae.localeCompare(ce)),se={...N,columns:I};return L&&(fa.current=!0,se.encode_missing=!0,se.handle_unknown="global_mean"),se})},[Tl]),Xh=f.useCallback(g=>{g.length&&Be(N=>{const M=new Set(mt(N.columns));let L=0;g.forEach(ae=>{const ce=String(ae??"").trim();if(!ce)return;M.add(ce);const ie=ou.find(be=>be.column===ce);ie&&ie.recommended_bucket_count>L&&(L=ie.recommended_bucket_count)});const I=Array.from(M).sort((ae,ce)=>ae.localeCompare(ce)),se={...N,columns:I};if(L>0){const ae=Number(N==null?void 0:N.n_buckets);(!Number.isFinite(ae)||ae<=0)&&(se.n_buckets=L)}return se})},[ou]),z_=f.useCallback(g=>{g.length&&Be(N=>{const M=new Set(mt(N.columns));let L=!1,I=!1;g.forEach(ce=>{const ie=String(ce??"").trim();if(ie&&(M.add(ie),!L||!I)){const be=iu.find(Te=>Te.column===ie);be!=null&&be.recommended_handle_unknown&&(L=!0),((be==null?void 0:be.missing_percentage)??0)>0&&(I=!0)}});const se=Array.from(M).sort((ce,ie)=>ce.localeCompare(ie)),ae={...N,columns:se};return L&&(ae.handle_unknown="use_encoded_value"),I&&(ae.encode_missing=!0),ae})},[iu]),As=f.useCallback(g=>{g.length&&Be(N=>{const M=new Set(mt(N.columns));let L=(N==null?void 0:N.drop_first)===!0;g.forEach(ae=>{const ce=String(ae??"").trim();if(ce&&(M.add(ce),!L)){const ie=Zd.find(be=>be.column===ce);ie!=null&&ie.recommended_drop_first&&(L=!0)}});const I=Array.from(M).sort((ae,ce)=>ae.localeCompare(ce)),se={...N,columns:I};return L&&(se.drop_first=!0),se})},[Zd]),Cs=f.useCallback(g=>{g.length&&Be(N=>{const M=new Set(mt(N.columns));let L=!1;g.forEach(ae=>{const ce=String(ae??"").trim();if(ce&&(M.add(ce),!L)){const ie=lu.find(be=>be.column===ce);ie!=null&&ie.recommended_drop_first&&(L=!0)}});const I=Array.from(M).sort((ae,ce)=>ae.localeCompare(ce)),se={...N,columns:I};return L&&(se.drop_first=!0),se})},[lu]),wm=f.useCallback(()=>{nn.length&&Be(g=>{const N=new Set(mt(g.columns));return nn.filter(L=>Q?!on.has(L):ee?!os.has(L):!0).forEach(L=>N.add(L)),{...g,columns:Array.from(N).sort((L,I)=>L.localeCompare(I))}})},[nn,on,Q,ee,os]),Jh=f.useCallback(g=>{Xs.includes(g)&&Be(N=>(N==null?void 0:N.default_method)===g?N:{...N,default_method:g})},[Be]),Zh=f.useCallback(g=>{Be(N=>(typeof(N==null?void 0:N.auto_detect)=="boolean"?N.auto_detect:!0)===g?N:{...N,auto_detect:g})},[Be]),Lu=f.useCallback((g,N)=>{const M=String(g??"").trim();M&&Be(L=>{if(!L||typeof L!="object")return L;const I=mt(L.columns),se=new Set(I),ae=L.column_methods&&typeof L.column_methods=="object"&&!Array.isArray(L.column_methods)?{...L.column_methods}:{};let ce=!1;if(N){if(!Xs.includes(N))return L;ae[M]!==N&&(ae[M]=N,ce=!0),se.has(M)||(se.add(M),ce=!0)}else Object.prototype.hasOwnProperty.call(ae,M)&&(delete ae[M],ce=!0);if(!ce)return L;const ie={...L};return ie.columns=Array.from(se).sort((be,Te)=>be.localeCompare(Te)),Object.keys(ae).length?ie.column_methods=ae:Object.prototype.hasOwnProperty.call(ie,"column_methods")&&delete ie.column_methods,ie})},[Be]),ep=f.useCallback(()=>{Be(g=>{if(!g||typeof g!="object")return g;const N=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)&&Object.keys(g.column_methods).length>0,M=g.column_parameters&&typeof g.column_parameters=="object"&&!Array.isArray(g.column_parameters)&&Object.keys(g.column_parameters).length>0;if(!N&&!M)return g;const L={...g};return N&&delete L.column_methods,M&&delete L.column_parameters,L})},[Be]),jm=f.useCallback(()=>{Ss.length&&Be(g=>{if(!g||typeof g!="object")return g;const N=new Set(mt(g.columns)),M=new Set(mt(g.skipped_columns)),L=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{},I=g.column_parameters&&typeof g.column_parameters=="object"&&!Array.isArray(g.column_parameters)?{...g.column_parameters}:{};let se=!1;if(Ss.forEach(ce=>{if(!ce||ce.isExcluded||!ce.recommendedMethod)return;const ie=String(ce.column??"").trim();if(!ie||Ul.has(ie))return;const be=ce.recommendedMethod;Xs.includes(be)&&(M.has(ie)&&(M.delete(ie),se=!0),N.has(ie)||(N.add(ie),se=!0),be===To.defaultMethod?Object.prototype.hasOwnProperty.call(L,ie)&&(delete L[ie],se=!0):L[ie]!==be&&(L[ie]=be,se=!0),Object.prototype.hasOwnProperty.call(I,ie)&&(delete I[ie],se=!0))}),!se)return g;const ae={...g,columns:Array.from(N).sort((ce,ie)=>ce.localeCompare(ie))};return M.size?ae.skipped_columns=Array.from(M).sort((ce,ie)=>ce.localeCompare(ie)):Object.prototype.hasOwnProperty.call(ae,"skipped_columns")&&delete ae.skipped_columns,Object.keys(L).length?ae.column_methods=L:Object.prototype.hasOwnProperty.call(ae,"column_methods")&&delete ae.column_methods,Object.keys(I).length?ae.column_parameters=I:Object.prototype.hasOwnProperty.call(ae,"column_parameters")&&delete ae.column_parameters,ae})},[To.defaultMethod,Ul,Ss,Be]),Nm=f.useCallback(g=>{const N=String(g??"").trim();N&&Be(M=>{if(!M||typeof M!="object")return M;const L=mt(M.columns),I=L.filter(_n=>_n!==N),se=new Set(mt(M.skipped_columns)),ae=se.size;se.add(N);const ce=ae!==se.size,ie=M.column_methods&&typeof M.column_methods=="object"&&!Array.isArray(M.column_methods)?{...M.column_methods}:{},be=Object.prototype.hasOwnProperty.call(ie,N);be&&delete ie[N];const Te=M.column_parameters&&typeof M.column_parameters=="object"&&!Array.isArray(M.column_parameters)?{...M.column_parameters}:{},ct=Object.prototype.hasOwnProperty.call(Te,N);if(ct&&delete Te[N],!(I.length!==L.length)&&!ce&&!be&&!ct)return M;const zt={...M,columns:I.sort((_n,Fn)=>_n.localeCompare(Fn)),skipped_columns:Array.from(se).sort((_n,Fn)=>_n.localeCompare(Fn))};return Object.keys(ie).length?zt.column_methods=ie:Object.prototype.hasOwnProperty.call(zt,"column_methods")&&delete zt.column_methods,Object.keys(Te).length?zt.column_parameters=Te:Object.prototype.hasOwnProperty.call(zt,"column_parameters")&&delete zt.column_parameters,zt})},[Be]),Xl=f.useCallback(g=>{const N=String(g??"").trim();N&&Be(M=>{if(!M||typeof M!="object")return M;const L=mt(M.skipped_columns);if(!L.includes(N))return M;const I=L.filter(ce=>ce!==N),se=new Set(mt(M.columns));se.has(N)||se.add(N);const ae={...M,columns:Array.from(se).sort((ce,ie)=>ce.localeCompare(ie))};return I.length?ae.skipped_columns=I.sort((ce,ie)=>ce.localeCompare(ie)):Object.prototype.hasOwnProperty.call(ae,"skipped_columns")&&delete ae.skipped_columns,ae})},[Be]),tp=f.useCallback((g,N)=>{if(N==="__skip__"){Nm(g);return}if(N==="__default__"){Xl(g),Lu(g,null);return}Xs.includes(N)&&(Xl(g),Lu(g,N))},[Nm,Xl,Lu]),np=f.useCallback((g,N,M)=>{const L=String(N??"").trim().toLowerCase();Be(I=>{if(!I||typeof I!="object")return I;const se=I.method_parameters&&typeof I.method_parameters=="object"&&!Array.isArray(I.method_parameters)?{...I.method_parameters}:{},ae={...se[g]??{}},ce=typeof M=="number"&&Number.isFinite(M)?M:null;let ie=!1;if(ce===null?Object.prototype.hasOwnProperty.call(ae,L)&&(delete ae[L],ie=!0):ae[L]!==ce&&(ae[L]=ce,ie=!0),!ie)return I;if(Object.keys(ae).length?se[g]=ae:delete se[g],!Object.keys(se).length){const be={...I};return Object.prototype.hasOwnProperty.call(be,"method_parameters")&&delete be.method_parameters,be}return{...I,method_parameters:se}})},[Be]),Sm=f.useCallback((g,N,M)=>{const L=String(g??"").trim();if(!L)return;const I=String(N??"").trim().toLowerCase();Be(se=>{if(!se||typeof se!="object")return se;const ae=se.column_parameters&&typeof se.column_parameters=="object"&&!Array.isArray(se.column_parameters)?{...se.column_parameters}:{},ce={...ae[L]??{}},ie=typeof M=="number"&&Number.isFinite(M)?M:null;let be=!1;if(ie===null?Object.prototype.hasOwnProperty.call(ce,I)&&(delete ce[I],be=!0):ce[I]!==ie&&(ce[I]=ie,be=!0),!be)return se;if(Object.keys(ce).length?ae[L]=ce:delete ae[L],!Object.keys(ae).length){const Te={...se};return Object.prototype.hasOwnProperty.call(Te,"column_parameters")&&delete Te.column_parameters,Te}return{...se,column_parameters:ae}})},[Be]),Cm=f.useCallback(g=>{jr.includes(g)&&Be(N=>(N==null?void 0:N.default_method)===g?N:{...N,default_method:g})},[Be]),sp=f.useCallback(g=>{Be(N=>(typeof(N==null?void 0:N.auto_detect)=="boolean"?N.auto_detect:!0)===g?N:{...N,auto_detect:g})},[Be]),Jl=f.useCallback((g,N)=>{const M=String(g??"").trim();M&&Be(L=>{const I=mt(L.columns),se=I.includes(M),ae=L.column_methods&&typeof L.column_methods=="object"&&!Array.isArray(L.column_methods)?{...L.column_methods}:{};if(N){if(!jr.includes(N))return L;const be=(ae[M]??null)!==N,Te=!se;if(!be&&!Te)return L;ae[M]=N;const ct=Te?[...I,M].sort((pt,zt)=>pt.localeCompare(zt)):I;return{...L,columns:ct,column_methods:ae}}if(!Object.prototype.hasOwnProperty.call(ae,M))return L;if(delete ae[M],Object.keys(ae).length)return{...L,column_methods:ae};const ce={...L};return Object.prototype.hasOwnProperty.call(ce,"column_methods")&&delete ce.column_methods,ce})},[Be]),Du=f.useCallback(()=>{Be(g=>{if(!g.column_methods||typeof g.column_methods!="object"||Array.isArray(g.column_methods)||!Object.keys(g.column_methods).length)return g;const N={...g};return delete N.column_methods,N})},[Be]),R_=f.useCallback(()=>{Po.length&&Be(g=>{const N=mt(g.columns),M=new Set(N),L=new Set(mt(g.skipped_columns)),I=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{};let se=!1;if(Po.forEach(ce=>{const ie=String(ce.column??"").trim(),be=ce.recommended_method;!ie||!jr.includes(be)||L.has(ie)||(I[ie]!==be&&(I[ie]=be,se=!0),M.has(ie)||(M.add(ie),se=!0))}),!se)return g;const ae=Array.from(M).sort((ce,ie)=>ce.localeCompare(ie));return{...g,columns:ae,column_methods:I}})},[Po,Be]),Em=f.useCallback(g=>{const N=String(g??"").trim();N&&Be(M=>{const L=mt(M.columns),I=L.filter(Te=>Te!==N),se=new Set(mt(M.skipped_columns)),ae=se.size;se.add(N);const ce=se.size!==ae,ie=M.column_methods&&typeof M.column_methods=="object"&&!Array.isArray(M.column_methods)?{...M.column_methods}:{},be=Object.prototype.hasOwnProperty.call(ie,N);return be&&delete ie[N],!ce&&I.length===L.length&&!be?M:{...M,columns:I.sort((Te,ct)=>Te.localeCompare(ct)),column_methods:ie,skipped_columns:Array.from(se).sort((Te,ct)=>Te.localeCompare(ct))}})},[Be]),Zl=f.useCallback(g=>{const N=String(g??"").trim();N&&Be(M=>{const L=mt(M.skipped_columns);if(!L.includes(N))return M;const I=new Set(L);I.delete(N);const se=new Set(mt(M.columns));return se.has(N)||se.add(N),{...M,columns:Array.from(se).sort((ce,ie)=>ce.localeCompare(ie)),skipped_columns:Array.from(I).sort((ce,ie)=>ce.localeCompare(ie))}})},[Be]),rp=f.useCallback((g,N)=>{if(N==="__skip__"){Em(g);return}if(N==="__default__"){Zl(g),Jl(g,null);return}jr.includes(N)&&(Zl(g),Jl(g,N))},[Em,Zl,Jl]),ec=f.useCallback(()=>{Be(g=>{const N={...g,columns:[]};return g!=null&&g.manual_bounds&&typeof g.manual_bounds=="object"&&!Array.isArray(g.manual_bounds)&&Object.keys(g.manual_bounds).length&&(N.manual_bounds={}),Q&&("custom_bins"in N&&delete N.custom_bins,"custom_labels"in N&&delete N.custom_labels,"column_overrides"in N&&delete N.column_overrides,"column_strategies"in N&&delete N.column_strategies),ee&&"column_methods"in N&&delete N.column_methods,N})},[Q,ee]),Qr=f.useCallback(g=>{const N=String(g??"").trim();N&&Be(M=>{const L=mt(M.columns);if(!L.includes(N))return M;const I=L.filter(ie=>ie!==N);let se=!1,ae=M.manual_bounds;ae&&typeof ae=="object"&&!Array.isArray(ae)&&Object.prototype.hasOwnProperty.call(ae,N)&&(ae={...ae},delete ae[N],se=!0);const ce={...M,columns:I};if(se&&(ce.manual_bounds=ae),Q){if(M.custom_bins&&typeof M.custom_bins=="object"&&!Array.isArray(M.custom_bins)){const ie={};Object.entries(M.custom_bins).forEach(([be,Te])=>{be!==N&&Array.isArray(Te)&&Te.length&&(ie[be]=[...Te])}),Object.keys(ie).length?ce.custom_bins=ie:"custom_bins"in ce&&delete ce.custom_bins}else"custom_bins"in ce&&delete ce.custom_bins;if(M.custom_labels&&typeof M.custom_labels=="object"&&!Array.isArray(M.custom_labels)){const ie={};Object.entries(M.custom_labels).forEach(([be,Te])=>{be!==N&&Array.isArray(Te)&&Te.length&&(ie[be]=Te.map(ct=>String(ct)))}),Object.keys(ie).length?ce.custom_labels=ie:"custom_labels"in ce&&delete ce.custom_labels}else"custom_labels"in ce&&delete ce.custom_labels;if(M.column_overrides&&typeof M.column_overrides=="object"&&!Array.isArray(M.column_overrides)){const ie={};Object.entries(M.column_overrides).forEach(([be,Te])=>{be!==N&&Te&&typeof Te=="object"&&!Array.isArray(Te)&&(ie[be]={...Te})}),Object.keys(ie).length?(ce.column_overrides=ie,ce.column_strategies=ie):("column_overrides"in ce&&delete ce.column_overrides,"column_strategies"in ce&&delete ce.column_strategies)}else"column_overrides"in ce&&delete ce.column_overrides,"column_strategies"in ce&&delete ce.column_strategies}if(ee)if(M.column_methods&&typeof M.column_methods=="object"&&!Array.isArray(M.column_methods)){const ie={};Object.entries(M.column_methods).forEach(([be,Te])=>{const ct=typeof Te=="string"?Te.trim():null;!ct||!jr.includes(ct)||be!==N&&(ie[be]=ct)}),Object.keys(ie).length?ce.column_methods=ie:Object.prototype.hasOwnProperty.call(ce,"column_methods")&&delete ce.column_methods}else Object.prototype.hasOwnProperty.call(ce,"column_methods")&&delete ce.column_methods;return ce})},[Q,ee]),ap=f.useCallback(()=>{pr===null||!wa||Hs(wa,pr)},[Hs,pr,wa]),Or=f.useCallback(()=>{if(!xt||!$e)return;const g=Hg(d??{});D&&(fa.current=!1),Be(g),u==null||u($e,g)},[xt,d,D,$e,u,fa]),tc=f.useCallback(()=>{let g=Hg(_e);if(Q){const N=$x(g);g={...g,strategy:N.strategy,columns:N.columns,equal_width_bins:N.equalWidthBins,equal_frequency_bins:N.equalFrequencyBins,include_lowest:N.includeLowest,precision:N.precision,duplicates:N.duplicates,output_suffix:N.outputSuffix,drop_original:N.dropOriginal,label_format:N.labelFormat,missing_strategy:N.missingStrategy},N.missingStrategy==="label"?g.missing_label=N.missingLabel:Object.prototype.hasOwnProperty.call(g,"missing_label")&&delete g.missing_label,Object.keys(N.customBins).length?g.custom_bins=N.customBins:Object.prototype.hasOwnProperty.call(g,"custom_bins")&&delete g.custom_bins,Object.keys(N.customLabels).length?g.custom_labels=N.customLabels:Object.prototype.hasOwnProperty.call(g,"custom_labels")&&delete g.custom_labels}if(ee){const N=Bx(g);g={...g,columns:N.columns,default_method:N.defaultMethod,auto_detect:N.autoDetect,skipped_columns:N.skippedColumns},Object.keys(N.columnMethods).length>0?g.column_methods=N.columnMethods:Object.prototype.hasOwnProperty.call(g,"column_methods")&&delete g.column_methods}n(e.id,g),t(),i&&l&&!lt&&(r&&r(e.id,{backgroundExecutionStatus:"loading"}),Ex({dataset_source_id:i,graph:{nodes:l.nodes||[],edges:l.edges||[]},target_node_id:e.id}).then(()=>{r&&r(e.id,{backgroundExecutionStatus:"success"})}).catch(N=>{r&&r(e.id,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",N)}))},[_e,Q,e.id,t,n,r,i,l,lt]),km=pr!==null&&!Tu,zu=hn.length,Ti=Gs(N_),hs=Gs((lr==null?void 0:lr.generated_at)??null),F_=Gs((zn==null?void 0:zn.generated_at)??null),I_=Gs((Xn==null?void 0:Xn.generated_at)??null),nc=Number(lr==null?void 0:lr.sample_size),ps=Number.isFinite(nc)?Math.max(0,Math.round(nc)):null,op=Number(zn==null?void 0:zn.sample_size),at=Number.isFinite(op)?Math.max(0,Math.round(op)):null,Io=Number(Xn==null?void 0:Xn.sample_size),Mm=Number.isFinite(Io)?Math.max(0,Math.round(Io)):null,Ru=j_&&!!i&&vt,ip=!Fe&&!lt,sc=ip&&rh!==__,$i=ph.status==="loading",rc=Mt.status==="loading",Am=$i||rc||Va||fu||ko||xi||pa,lp=f.useMemo(()=>$i?"Generating dataset profile":Va?"Loading scaling insights":fu?"Loading binning insights":ko?"Loading hash encoding insights":xi?"Computing binned distributions":pa?"Fetching column recommendations":rc?kr?"Loading dataset preview":"Analyzing node outputs":null,[xi,pa,Va,fu,ko,Gt,rc,$i,kr])??(Am?"Processing":null),Os=f.useCallback(g=>{Be(N=>{const M=Rx(N==null?void 0:N.strategies,tt),L=g(M).map(I=>({...I,options:_d(I.method,I.options)}));return{...N,strategies:LM(L)}})},[tt]),Ps=f.useCallback(g=>{S&&Be(N=>{var pt,zt,_n,Fn,$s,$r,Ls,St,Cn;if(!S)return N;const M=mt((N==null?void 0:N.columns)??((zt=(pt=e==null?void 0:e.data)==null?void 0:pt.config)==null?void 0:zt.columns)),L=Pf(N==null?void 0:N.mode,(Fn=(_n=e==null?void 0:e.data)==null?void 0:_n.config)==null?void 0:Fn.mode),I=(()=>{var Ds;const In=Ac(N);if(In!==void 0){const Xr=tl(In);if(Xr!==null)return Xr}const cn=Ac((Ds=e==null?void 0:e.data)==null?void 0:Ds.config);if(cn!==void 0){const Xr=tl(cn);if(Xr!==null)return Xr}return M.length===0})(),se=(N==null?void 0:N.alias_strategies)??(N==null?void 0:N.strategies)??(($r=($s=e==null?void 0:e.data)==null?void 0:$s.config)==null?void 0:$r.alias_strategies)??((St=(Ls=e==null?void 0:e.data)==null?void 0:Ls.config)==null?void 0:St.strategies),ae=Yx(se,{mode:L,columns:M,autoDetect:I}),ce=g(ae).map(In=>({mode:Pf(In.mode,L),columns:Array.from(new Set(In.columns.map(cn=>cn.trim()).filter(Boolean))).sort((cn,Ds)=>cn.localeCompare(Ds)),autoDetect:!!In.autoDetect})),ie=cA(ce),be=Array.from(new Set(ce.flatMap(In=>In.columns))).sort((In,cn)=>In.localeCompare(cn)),Te=((Cn=ce[0])==null?void 0:Cn.mode)??L,ct=ce.length?ce.some(In=>In.autoDetect):I;return{...N,alias_strategies:ie,columns:be,mode:Te,auto_detect:ct}})},[S,(Im=e==null?void 0:e.data)==null?void 0:Im.config]),ln=f.useCallback(g=>{Be(N=>{var Te,ct,pt,zt,_n,Fn,$s;if(!O)return N;const M=mt((N==null?void 0:N.columns)??((ct=(Te=e==null?void 0:e.data)==null?void 0:Te.config)==null?void 0:ct.columns)),L=a0(N==null?void 0:N.mode,(zt=(pt=e==null?void 0:e.data)==null?void 0:pt.config)==null?void 0:zt.mode),I=M.length===0,se=o0((N==null?void 0:N.format_strategies)??((Fn=(_n=e==null?void 0:e.data)==null?void 0:_n.config)==null?void 0:Fn.format_strategies),{columns:M,mode:L,autoDetect:I}),ae=g(se),ce=DA(ae),ie=Array.from(new Set(ae.flatMap($r=>$r.columns.map(Ls=>Ls.trim()).filter(Boolean)))).sort(($r,Ls)=>$r.localeCompare(Ls)),be=(($s=ae[0])==null?void 0:$s.mode)??L;return{...N,format_strategies:ce,columns:ie,mode:be}})},[O,(yp=(no=e==null?void 0:e.data)==null?void 0:no.config)==null?void 0:yp.columns,(Bm=(Uo=e==null?void 0:e.data)==null?void 0:Uo.config)==null?void 0:Bm.format_strategies,(bp=(Sn=e==null?void 0:e.data)==null?void 0:Sn.config)==null?void 0:bp.mode]),Pr=f.useCallback(()=>{i&&Mo()},[Mo,i]),Za=f.useMemo(()=>{if(!ge)return[];const N=(Array.isArray(Xn==null?void 0:Xn.columns)?Xn==null?void 0:Xn.columns:[]).map(M=>{if(!M||!M.column)return null;const L=Number(M.total_rows),I=Number.isFinite(L)?Math.max(0,Math.round(L)):0;if(I<=0)return null;const ae=(Array.isArray(M.bins)?M.bins:[]).map(cn=>{if(!cn)return null;const Xr=(typeof cn.label=="string"?cn.label.trim():String(cn.label??""))||(cn.is_missing?"Missing":"Unlabeled bin"),Bn=Number(cn.count);if(!Number.isFinite(Bn))return null;const Ri=Math.max(0,Math.round(Bn)),Ea=Number(cn.percentage),qo=Number.isFinite(Ea)?Math.min(100,Math.max(0,Ea)):0,Ho=Number(qo.toFixed(2));return{label:Xr,count:Ri,percentage:Ho,isMissing:!!cn.is_missing}}).filter(cn=>!!cn);if(!ae.length)return null;ae.sort((cn,Ds)=>cn.isMissing!==Ds.isMissing?cn.isMissing?1:-1:cn.count!==Ds.count?Ds.count-cn.count:cn.label.localeCompare(Ds.label));const ce=ae.length,ie=12,be=ce>ie,Te=be?ae.slice(0,ie):ae,ct=Number(M.missing_rows),pt=Number.isFinite(ct)?Math.max(0,Math.round(ct)):0,zt=Number(M.distinct_bins),_n=Number.isFinite(zt)?Math.max(0,Math.round(zt)):ae.length,Fn=M.top_label;let $s=typeof Fn=="string"?Fn.trim()||null:Fn??null;const $r=Number(M.top_count);let Ls=Number.isFinite($r)?Math.max(0,Math.round($r)):null;const St=Number(M.top_percentage);let Cn=Number.isFinite(St)?Number(Math.min(100,Math.max(0,St)).toFixed(2)):null;($s===null||Ls===null||Cn===null)&&Te.length&&($s=Te[0].label,Ls=Te[0].count,Cn=Te[0].percentage);const In=typeof M.source_column=="string"?M.source_column.trim()||null:M.source_column??null;return{column:M.column,sourceColumn:In,totalRows:I,missingRows:pt,distinctBins:_n,topLabel:$s,topCount:Ls,topPercentage:Cn,bins:Te,hasMoreBins:be,totalBinCount:ce}}).filter(M=>!!M);return N.sort((M,L)=>{const I=(L.topCount??0)-(M.topCount??0);return I!==0?I:M.column.localeCompare(L.column)}),N},[Xn,ge]),cp=f.useCallback(()=>{var M;const g=ah,N=((M=Ke[0])==null?void 0:M.value)??"mean";Os(L=>[...L,{method:N,columns:[],options:_d(N,zx(N))}]),ms(L=>{const I=new Set(L);return I.delete(g),I})},[Ke,ah,Os]),up=f.useCallback(g=>{Os(N=>N.filter((M,L)=>L!==g)),ms(N=>{const M=new Set;return N.forEach(L=>{L!==g&&M.add(L>g?L-1:L)}),M})},[Os]),Tr=f.useCallback(g=>{ms(N=>{const M=new Set(N);return M.has(g)?M.delete(g):M.add(g),M})},[]),dp=f.useCallback((g,N)=>{Os(M=>M.map((L,I)=>I===g?{...L,method:N,options:_d(N,L.options)}:L))},[Os]),Gr=f.useCallback((g,N,M)=>{Os(L=>L.map((I,se)=>{if(se!==g)return I;const ae={...I.options??{}};if(M==="")delete ae[N];else{const ce=Number(M);if(!Number.isFinite(ce))return I;ae[N]=ce}return{...I,options:_d(I.method,ae)}}))},[Os]),U_=f.useCallback((g,N)=>{const M=N.split(",").map(L=>L.trim()).filter(Boolean);Os(L=>L.map((I,se)=>se===g?{...I,columns:M}:I))},[Os]),mp=f.useCallback((g,N)=>{const M=N.trim();M&&Os(L=>L.map((I,se)=>{if(se!==g)return I;const ce=I.columns.includes(M)?I.columns.filter(ie=>ie!==M):[...I.columns,M];return ce.sort((ie,be)=>ie.localeCompare(be)),{...I,columns:ce}}))},[Os]),fp=f.useCallback(g=>{Wd(g)},[Wd]),hp=f.useCallback(()=>{const g=xu.length;ln(N=>{var ae;const M=new Set;N.forEach(ce=>{ce.columns.forEach(ie=>{const be=ie.trim();be&&M.add(be)})});const L=Bl.recommendedColumns.find(ce=>!M.has(ce)),se={mode:N.length?N[N.length-1].mode:((ae=zg[0])==null?void 0:ae.value)??dr,columns:L?[L]:[],autoDetect:!L};return[...N,se]}),ms(N=>{const M=new Set(N);return M.delete(g),M})},[xu.length,ms,Bl.recommendedColumns,dr,ln]),pp=f.useCallback(g=>{ln(N=>N.filter((M,L)=>L!==g)),ms(N=>{const M=new Set;return N.forEach(L=>{L!==g&&M.add(L>g?L-1:L)}),M})},[ms,ln]),q_=f.useCallback(g=>{ms(N=>{const M=new Set(N);return M.has(g)?M.delete(g):M.add(g),M})},[]),Fu=f.useCallback((g,N)=>{ln(M=>M.map((L,I)=>I===g?{...L,mode:N}:L))},[ln]),Om=f.useCallback((g,N)=>{const M=N.split(",").map(L=>L.trim()).filter(Boolean).sort((L,I)=>L.localeCompare(I));ln(L=>L.map((I,se)=>se===g?{...I,columns:M}:I))},[ln]),gr=f.useCallback((g,N)=>{const M=N.trim();M&&ln(L=>L.map((I,se)=>{if(se!==g)return I;const ce=I.columns.includes(M)?I.columns.filter(ie=>ie!==M):[...I.columns,M];return ce.sort((ie,be)=>ie.localeCompare(be)),{...I,columns:ce}}))},[ln]),Ht=f.useCallback((g,N)=>{ln(M=>M.map((L,I)=>I===g?{...L,autoDetect:N}:L))},[ln]),dn=f.useCallback(g=>{Be(N=>{if(!U)return N;const M=N&&typeof N=="object"&&!Array.isArray(N)?{...N}:{},L=B0(Array.isArray(N==null?void 0:N.operations)?N.operations:[]),I=g(L);return M.operations=zP(I),M})},[U,Be]),Rn=f.useCallback(g=>{if(!U)return;let N="";dn(M=>{const L=new Set(M.map(se=>se.id)),I=U0(g,L);return N=I.id,[...M,I]}),N&&ir(M=>{const L=new Set(M);return L.delete(N),L})},[U,ir,dn]),is=f.useCallback(g=>{if(!U)return;let N="";dn(M=>{const L=M.findIndex(be=>be.id===g);if(L===-1)return M;const I=M[L],se=new Set(M.map(be=>be.id)),ae=U0(I.type,se);N=ae.id;const ce={...I,id:ae.id,inputColumns:[...I.inputColumns],secondaryColumns:[...I.secondaryColumns],constants:[...I.constants],datetimeFeatures:[...I.datetimeFeatures],outputColumn:I.outputColumn?`${I.outputColumn}_copy`:""},ie=[...M];return ie.splice(L+1,0,ce),ie}),N&&ir(M=>{const L=new Set(M);return L.delete(N),L})},[U,ir,dn]),Ws=f.useCallback(g=>{U&&(dn(N=>N.filter(M=>M.id!==g)),ir(N=>{const M=new Set(N);return M.delete(g),M}))},[U,ir,dn]),Li=f.useCallback((g,N)=>{U&&dn(M=>{const L=M.findIndex(ce=>ce.id===g);if(L===-1)return M;const I=N==="up"?L-1:L+1;if(I<0||I>=M.length)return M;const se=[...M],[ae]=se.splice(L,1);return se.splice(I,0,ae),se})},[U,dn]),qn=f.useCallback(g=>{ir(N=>{const M=new Set(N);return M.has(g)?M.delete(g):M.add(g),M})},[]),ac=f.useCallback((g,N)=>{U&&dn(M=>M.map(L=>{if(L.id!==g)return L;let I={...L};if(N.type&&(I.type=N.type),N.method!==void 0&&(I.method=N.method),N.inputColumns!==void 0&&(I.inputColumns=Ad(N.inputColumns)),N.secondaryColumns!==void 0&&(I.secondaryColumns=Ad(N.secondaryColumns)),N.constants!==void 0&&(I.constants=Mw(N.constants)),N.outputColumn!==void 0&&(I.outputColumn=N.outputColumn.trim()),N.outputPrefix!==void 0&&(I.outputPrefix=N.outputPrefix.trim()),N.datetimeFeatures!==void 0&&(I.datetimeFeatures=Aw(N.datetimeFeatures)),N.timezone!==void 0&&(I.timezone=Pw(N.timezone)),N.fillna!==void 0&&(I.fillna=Od(N.fillna)),N.roundDigits!==void 0&&(I.roundDigits=Ow(N.roundDigits)),N.normalize!==void 0&&(I.normalize=N.normalize),N.epsilon!==void 0&&(I.epsilon=Od(N.epsilon)),N.allowOverwrite!==void 0&&(I.allowOverwrite=N.allowOverwrite),N.description!==void 0){const ce=typeof N.description=="string"?N.description.trim():"";I.description=ce||void 0}const se=I.type,ae=q0(se);return ae.length?new Set(ae.map(ie=>ie.value)).has(I.method)||(I.method=ae[0].value):se==="ratio"?I.method="ratio":se==="datetime_extract"&&(I.method="datetime_extract"),I.inputColumns=Ad(I.inputColumns),se==="ratio"||se==="similarity"?I.secondaryColumns=Ad(I.secondaryColumns):I.secondaryColumns=[],I.constants=Mw(I.constants),I.fillna=Od(I.fillna),I.roundDigits=Ow(I.roundDigits),I.epsilon=Od(I.epsilon),se==="datetime_extract"?(I.datetimeFeatures=Aw(I.datetimeFeatures),I.timezone=Pw(I.timezone)):(I.datetimeFeatures=[],I.timezone="UTC"),se!=="similarity"?I.normalize=!1:I.normalize=!!I.normalize,typeof I.allowOverwrite!="boolean"&&(I.allowOverwrite=null),I.outputColumn=I.outputColumn.trim(),I.outputPrefix=I.outputPrefix.trim(),I}))},[U,dn]),Bo=f.useCallback(()=>{if(!S)return;const g=am;Ps(N=>{var ae;const M=new Set;N.forEach(ce=>{ce.columns.forEach(ie=>{const be=ie.trim();be&&M.add(be)})});const L=gu.recommendedColumns.find(ce=>!M.has(ce)),se={mode:N.length?N[N.length-1].mode:((ae=Wx[0])==null?void 0:ae.value)??Tg,columns:L?[L]:[],autoDetect:!L};return[...N,se]}),ms(N=>{const M=new Set(N);return M.delete(g),M})},[gu.recommendedColumns,am,S,ms,Ps]),Iu=f.useCallback(g=>{Ps(N=>N.filter((M,L)=>L!==g)),ms(N=>{const M=new Set;return N.forEach(L=>{L!==g&&M.add(L>g?L-1:L)}),M})},[ms,Ps]),Pm=f.useCallback(g=>{ms(N=>{const M=new Set(N);return M.has(g)?M.delete(g):M.add(g),M})},[]),oc=f.useCallback((g,N)=>{Ps(M=>M.map((L,I)=>I===g?{...L,mode:N}:L))},[Ps]),Ts=f.useCallback((g,N)=>{const M=N.trim();M&&Ps(L=>L.map((I,se)=>{if(se!==g)return I;const ce=I.columns.includes(M)?I.columns.filter(ie=>ie!==M):[...I.columns,M];return ce.sort((ie,be)=>ie.localeCompare(be)),{...I,columns:ce}}))},[Ps]),Tm=f.useCallback((g,N)=>{const M=N.split(",").map(I=>I.trim()).filter(Boolean),L=Array.from(new Set(M)).sort((I,se)=>I.localeCompare(se));Ps(I=>I.map((se,ae)=>ae===g?{...se,columns:L}:se))},[Ps]),Di=f.useCallback((g,N)=>{Ps(M=>M.map((L,I)=>I===g?{...L,autoDetect:N}:L))},[Ps]),ls=f.useCallback(g=>{var Ls;const N=((Ls=g==null?void 0:g.source)==null?void 0:Ls.type)==="drop_column_recommendations",M=!N,L=M&&Mt.status==="loading",I=Q&&g.name==="columns",se=ee&&g.name==="columns",ae=(()=>{if(!I)return[];const St=[...fr];return mr.size>0&&mr.forEach(Cn=>{St.includes(Cn)||St.push(Cn)}),hn.forEach(Cn=>{Cn&&!St.includes(Cn)&&St.push(Cn)}),St})(),ce=I?ae:se?nn.filter(St=>!os.has(St)):nn,ie=I?Mi?ae.filter(St=>St.toLowerCase().includes(Mi)):ae:se?Zn.filter(St=>!os.has(St)):Zn,be=I?hn.filter(St=>!on.has(St)).length:se?hn.filter(St=>!os.has(St)).length:zu,Te=M&&ce.length>0&&be>=ce.length,ct=N||w,pt=new Set(ce),zt=H&&M?Object.entries(Al).filter(([St,Cn])=>pt.has(St)&&Cn.length>0).map(([St,Cn])=>`${St}: ${Cn.join(", ")}`).slice(0,4):[],_n=I?Array.from(on).slice(0,4):[],Fn=se?Array.from(os).slice(0,4):[],$s=I&&mr.size>0,$r=$s?Array.from(mr).some(St=>!hn.includes(St)):!1;return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:g.label}),N&&i&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Eo,disabled:pa||!vt,children:pa?"Refreshing":"Refresh suggestions"})})]}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),zt.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",zt.join("; ")]}),I&&on.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",on.size," non-numeric column",on.size===1?"":"s",_n.length?` (examples: ${_n.join(", ")}${on.size>_n.length?", ":""})`:""," binning only supports numeric inputs."]}),se&&os.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",os.size," non-numeric column",os.size===1?"":"s",Fn.length?` (examples: ${Fn.join(", ")}${os.size>Fn.length?", ":""})`:""," scaling only supports numeric inputs."]}),N&&a.jsx(U1,{sourceId:i,availableFilters:ch,activeFilterId:ar,setActiveFilterId:vi,recommendations:Co,filteredRecommendations:Kd,isFetchingRecommendations:pa,recommendationsError:nu,relativeGeneratedAt:Ti,formatSignalName:Yd,formatMissingPercentage:ys,getPriorityClass:cM,getPriorityLabel:uM,handleToggleColumn:Yr,selectedColumns:hn}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:be})]}),be>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:hn.map(St=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[St,a.jsx("button",{type:"button",onClick:()=>Qr(St),"aria-label":`Remove ${St}`,children:""})]},St))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[N&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:xm,disabled:!Co.length,children:"Use all recommendations"}),$s&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>Pi(mr),disabled:!$r,children:"Add recommended columns"}),M&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:wm,disabled:!ce.length||Te,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:ec,disabled:!zu,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:No,onChange:St=>tu(St.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:ie.length?ie.map(St=>{const Cn=hn.includes(St),In=Object.prototype.hasOwnProperty.call(So,St)?So[St]:void 0,cn=ys(typeof In=="number"?In:null),Ds=rr[St]??null,Xr=Al[St]??[],Bn=I?Un[St]:void 0,Ri=!!(Bn&&(Bn.min!==null&&Bn.min!==void 0||Bn.max!==null&&Bn.max!==void 0)),Ea=I?(Bn==null?void 0:Bn.distinct)??null:null,qo=I&&Ea!==null&&Number.isFinite(Ea),Ho=qo?Ea:null,Ku=!I,H_=Ku||ct||Ri||qo,Yu=Ku&&Xr.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${Cn?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:Cn,onChange:()=>Yr(St)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:St}),H_&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Ku&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",OT(Ds)]}),ct&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",cn]}),Ri&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[I?"Sample range":"Range",":"," ",Bn&&Bn.min!==null&&Bn.min!==void 0?Qs(Bn.min):""," ",""," ",Bn&&Bn.max!==null&&Bn.max!==void 0?Qs(Bn.max):""]}),qo&&Ho!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",wr(Ho)]})]}),Yu&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",Xr.join(", ")]})]})]},St)}):a.jsx("p",{className:"canvas-modal__note",children:nn.length?I&&ce.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":L?"Loading column catalog":i?vt?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},g.name)},[ar,nn,ch,So,No,Al,rr,fr,Mr,Zn,Kd,Yd,xm,Pi,ec,Qr,wm,Yr,vt,H,pa,Q,mr,Un,w,ee,on,Mt.status,Co,nu,Ti,hn,zu,vi,tu,os,Ru,i,Eo,Mi]),Qt=f.useCallback(g=>{var L;if(!(g!=null&&g.name))return null;if(g.type==="multi_select")return ls(g);if(g.type==="number"){const I=`node-${e.id}-${g.name}`,se=_e==null?void 0:_e[g.name],ae=typeof se=="number"?se:se??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:I,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:g.label}),g.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:g.unit})]}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx("input",{id:I,type:"number",className:"canvas-modal__input",value:ae,min:g.min!==void 0?g.min:void 0,max:g.max!==void 0?g.max:void 0,step:g.step!==void 0?g.step:"any",onChange:ce=>Uh(g.name,ce.target.value)}),g.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:g.unit})]}),wa===g.name&&pr!==null&&Ru&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:ys(pr)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:ap,disabled:!km,children:Tu?"Applied":"Apply suggestion"})]})]},g.name)}if(g.type==="boolean"){const I=`node-${e.id}-${g.name}`,se=!!(_e!=null&&_e[g.name]);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:I,children:g.label})}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:I,type:"checkbox",checked:se,onChange:ae=>vm(g.name,ae.target.checked)}),a.jsx("span",{children:se?"Enabled":"Disabled"})]})]},g.name)}if(g.type==="select"){const I=`node-${e.id}-${g.name}`,se=Array.isArray(g.options)?g.options:[],ae=_e==null?void 0:_e[g.name],ce=typeof g.default=="string"?g.default:((L=se.find(be=>be&&typeof be.value=="string"))==null?void 0:L.value)??"",ie=typeof ae=="string"&&ae.trim().length?ae:ce;return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:I,className:"canvas-modal__parameter-label",children:g.label}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsx("select",{id:I,className:"canvas-modal__input",value:ie,onChange:be=>Gl(g.name,be.target.value),children:se.map(be=>a.jsx("option",{value:be.value,title:be.description??void 0,children:be.label??be.value},be.value))})]},g.name)}if(g.type==="textarea"){const I=`node-${e.id}-${g.name}`;if(g.name==="hyperparameters"){let ae="",ce=_e==null?void 0:_e[g.name];if(typeof ce=="string"&&ce.trim())try{const ie=JSON.parse(ce);ie&&typeof ie=="object"&&!Array.isArray(ie)?ae=Object.entries(ie).map(([be,Te])=>`${be}: ${JSON.stringify(Te)}`).join(`
`):ae=ce}catch{ae=ce}else ce&&typeof ce=="object"&&!Array.isArray(ce)&&(ae=Object.entries(ce).map(([ie,be])=>`${ie}: ${JSON.stringify(be)}`).join(`
`));return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:I,className:"canvas-modal__parameter-label",children:g.label}),a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description||"Enter parameters as key: value pairs (one per line)"}),a.jsx("textarea",{id:I,className:"canvas-modal__input canvas-modal__input--wide",value:ae,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:ie=>{const Te=ie.target.value.split(`
`).filter(pt=>pt.trim()),ct={};for(const pt of Te){const zt=pt.indexOf(":");if(zt===-1)continue;const _n=pt.substring(0,zt).trim(),Fn=pt.substring(zt+1).trim();if(_n)try{ct[_n]=JSON.parse(Fn)}catch{ct[_n]=Fn}}Gl(g.name,JSON.stringify(ct,null,2))},rows:6})]},g.name)}const se=typeof(_e==null?void 0:_e[g.name])=="string"?_e==null?void 0:_e[g.name]:"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:I,className:"canvas-modal__parameter-label",children:g.label}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsx("textarea",{id:I,className:"canvas-modal__input canvas-modal__input--wide",value:se,placeholder:g.placeholder??"",onChange:ae=>Gl(g.name,ae.target.value),rows:4})]},g.name)}const N=`node-${e.id}-${g.name}`,M=(_e==null?void 0:_e[g.name])??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:N,className:"canvas-modal__parameter-label",children:g.label}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsx("input",{id:N,type:"text",className:"canvas-modal__input canvas-modal__input--wide",value:M,placeholder:g.placeholder??"",onChange:I=>Gl(g.name,I.target.value)})]},g.name)},[km,_e,ap,vm,Uh,Gl,e.id,pr,ls,Ru,Tu,wa]),$m=f.useCallback(g=>{Be(N=>({...N,keep:g}))},[Be]);return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(iM,{title:p,isDataset:Fe,onClose:t,canResetNode:xt,onResetNode:Or}),a.jsxs("div",{className:"canvas-modal__body",children:[rt&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:Xe?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",children:[a.jsx("strong",{children:Xe?"Ready to execute.":"Missing required connections."})," ",Xe?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]}),rt.inputs&&rt.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:rt.inputs.map(g=>{const N=en.has(g.key),M=g.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:g.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:N?"Connected":M?"Missing":"Optional"})]},`inputs-${g.key}`)})})]}),rt.outputs&&rt.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:rt.outputs.map(g=>{const N=ye.has(g.key),M=g.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:g.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:N?"Connected":M?"Unlinked":"Optional"})]},`outputs-${g.key}`)})})]})]}),Bh&&a.jsx(q1,{thresholdParameter:Ja??null,dropIfAnyParameter:Xc,renderParameterField:Qt}),Bd&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),Ja&&Qt(Ja),ls(Bd)]}),x&&a.jsxs(a.Fragment,{children:[a.jsx(ZM,{suffix:an,insights:wi,formatMissingPercentage:ys}),(Qc||Id)&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[Qc?Qt(Qc):null,Id?Qt(Id):null]})]})]}),kr&&a.jsx(sM,{previewState:Mt,datasetSourceId:i??null,canTriggerPreview:Rl,onRefresh:Hr,formatCellValue:tw,formatMetricValue:wr,formatMissingPercentage:ys,formatNumericStat:Qs,formatModeStat:Px}),a.jsx(aM,{isDatasetProfileNode:tm,controller:hh,formatCellValue:tw,formatNumericStat:Qs,formatMissingPercentage:ys}),Pe&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",children:[a.jsxs("strong",{children:[Pe.title,"."]})," ",Pe.body]})}),E&&a.jsx(aO,{sourceId:i,hasReachableSource:vt,columnsParameter:Tt,modeParameter:gt,renderMultiSelectField:ls,renderParameterField:Qt,columnSummary:vu,modeDetails:vh,sampleMap:om}),A&&a.jsx(NO,{sourceId:i,hasReachableSource:vt,columnsParameter:kt,modeParameter:vn,replacementParameter:Jt,renderMultiSelectField:ls,renderParameterField:Qt,columnSummary:A_,modeDetails:ji,sampleMap:Qa}),P&&a.jsx(MP,{sourceId:i,hasReachableSource:vt,columnsParameter:Mn,modeParameter:Yn,minValueParameter:yn,maxValueParameter:$t,renderMultiSelectField:ls,renderParameterField:Qt,columnSummary:Us,modeDetails:im,sampleMap:lm,selectedMode:yh,minValue:qs,maxValue:bn}),T&&a.jsx(aP,{sourceId:i,hasReachableSource:vt,columnsParameter:Lt,modeParameter:xn,patternParameter:Ut,replacementParameter:Pt,renderMultiSelectField:ls,renderParameterField:Qt,columnSummary:Ni,modeDetails:bu,sampleMap:yu,selectedMode:cr,replacementValue:ur}),j&&a.jsx(BO,{sourceId:i,hasReachableSource:vt,columnsParameter:mn,modeParameter:ns,renderMultiSelectField:ls,renderParameterField:Qt,columnSummary:Ao,modeDetails:va,sampleMap:_a,selectedMode:Oo}),U&&a.jsx(YP,{operations:gi,summaries:k_,collapsed:zl,onToggleCollapsed:qn,onAddOperation:Rn,onDuplicateOperation:is,onRemoveOperation:Ws,onReorderOperation:Li,onOperationChange:ac,availableColumns:nn,signals:Fl,previewStatus:Mt.status,errorHandlingParameter:ca,allowOverwriteParameter:ua,defaultTimezoneParameter:da,epsilonParameter:ci,renderParameterField:Qt,canResetNode:xt,onResetNode:Or}),W&&a.jsx(cT,{sourceId:i,hasReachableSource:vt,isFetching:dh,error:mh,suggestions:iu,metadata:or,columnsParameter:Cr,autoDetectParameter:bl,maxCategoriesParameter:yo,outputSuffixParameter:bo,dropOriginalParameter:di,encodeMissingParameter:mi,handleUnknownParameter:Br,unknownValueParameter:xl,selectedColumns:hn,renderParameterField:Qt,onToggleColumn:Yr,onApplyRecommended:z_,formatMissingPercentage:ys}),D&&a.jsx(eT,{sourceId:i,hasReachableSource:vt,isFetching:au,error:yi,suggestions:Tl,metadata:qa,columnsParameter:rs,targetColumnParameter:wn,autoDetectParameter:as,maxCategoriesParameter:za,outputSuffixParameter:ma,dropOriginalParameter:ws,smoothingParameter:sr,encodeMissingParameter:Bs,handleUnknownParameter:js,selectedColumns:hn,renderParameterField:Qt,onToggleColumn:Yr,onApplyRecommended:Gh,formatMissingPercentage:ys}),F&&a.jsx(mT,{sourceId:i,hasReachableSource:vt,isFetching:Xd,error:Jd,suggestions:Zd,metadata:em,columnsParameter:Ra,autoDetectParameter:fi,maxCategoriesParameter:Dn,dropFirstParameter:xo,includeMissingParameter:Kc,dropOriginalParameter:Ns,prefixSeparatorParameter:Fa,selectedColumns:hn,renderParameterField:Qt,onToggleColumn:Yr,onApplyRecommended:As,formatMissingPercentage:ys}),te&&a.jsx(pT,{sourceId:i,hasReachableSource:vt,isFetching:$l,error:S_,suggestions:lu,metadata:fh,columnsParameter:kn,autoDetectParameter:Gn,maxCategoriesParameter:Er,dropFirstParameter:wl,includeMissingParameter:Fd,dropOriginalParameter:jl,prefixSeparatorParameter:Yc,selectedColumns:hn,renderParameterField:Qt,onToggleColumn:Yr,onApplyRecommended:Cs,formatMissingPercentage:ys}),B&&a.jsx(jT,{nodeId:$e,sourceId:i,hasReachableSource:vt,previewState:Mt,onRefreshPreview:Hr,config:b_,targetColumnParameter:ui,renderParameterField:Qt,formatMetricValue:wr,formatMissingPercentage:ys,canResetNode:xt,onResetNode:Or}),q&&a.jsx(ST,{nodeId:$e,sourceId:i,hasReachableSource:vt,previewState:Mt,onRefreshPreview:Hr,config:x_,parameters:J,renderParameterField:Qt,formatMetricValue:wr,canResetNode:xt,onResetNode:Or}),Ve&&a.jsx(E2,{mode:Y?"oversampling":"undersampling",sourceId:i,hasReachableSource:vt,previewState:Mt,onRefreshPreview:Hr,config:wo,methodParameter:vo,targetColumnParameter:Vc,samplingStrategyParameter:gl,randomStateParameter:Yt,kNeighborsParameter:Y?Wc:null,replacementParameter:X?_l:null,renderParameterField:Qt,formatMetricValue:wr,formatMissingPercentage:ys,schemaGuard:Cl}),(K||z)&&a.jsx(AT,{sourceId:i,hasReachableSource:vt,previewState:Mt,onRefreshPreview:Hr,config:Nl,targetColumnParameter:vl,problemTypeParameter:yl,renderParameterField:Qt,formatMetricValue:wr,formatMissingPercentage:ys,schemaColumns:jo}),K&&a.jsx("div",{style:Ie,"aria-disabled":nt,children:a.jsx(RT,{nodeId:$e,sourceId:i,graph:Pn,config:Nl,runtimeConfig:pi,cvConfig:ih,draftConfigState:_e,renderParameterField:Qt,modelTypeParameter:oe,modelTypeOptions:Ud,hyperparametersParameter:Me,cvEnabledParameter:_t,cvStrategyParameter:it,cvFoldsParameter:jt,cvShuffleParameter:Et,cvRandomStateParameter:Nt,cvRefitStrategyParameter:It,onSaveDraftConfig:tc})}),ne&&a.jsx("div",{style:Ie,"aria-disabled":nt,children:a.jsx(QT,{nodeId:$e,sourceId:i,graph:Pn,config:_e,setConfigState:Be,renderParameterField:Qt,formatMetricValue:wr,connectedSplitHandles:we,canResetNode:xt,onResetNode:Or})}),ue&&a.jsx("div",{style:Ie,"aria-disabled":nt,children:a.jsx(m2,{nodeId:$e,sourceId:i,graph:Pn,parameters:J,config:v_,renderParameterField:Qt})}),z&&a.jsx("div",{style:Ie,"aria-disabled":nt,children:a.jsx(j2,{nodeId:$e,sourceId:i,graph:Pn,config:Nl,runtimeConfig:pi,cvConfig:ih,draftConfigState:_e,renderParameterField:Qt,modelTypeParameter:oe,modelTypeOptions:Ud,searchStrategyParameter:je,searchIterationsParameter:Ge,searchRandomStateParameter:qe,scoringMetricParameter:Le,setDraftConfigState:Be,onSaveDraftConfig:tc})}),k&&a.jsx(XP,{sourceId:i,hasReachableSource:vt,isFetching:Qd,error:Pl,suggestions:Gd,metadata:ru,columnsParameter:er,autoDetectParameter:An,maxUniqueParameter:us,outputSuffixParameter:Kt,dropOriginalParameter:Qn,missingStrategyParameter:zr,missingCodeParameter:go,selectedColumns:hn,renderParameterField:Qt,onToggleColumn:Yr,onApplyRecommended:Qh,formatMissingPercentage:ys}),$&&a.jsx(sT,{sourceId:i,hasReachableSource:vt,isFetching:ko,error:uh,suggestions:ou,metadata:bi,columnsParameter:tr,autoDetectParameter:Is,maxCategoriesParameter:La,bucketsParameter:Da,outputSuffixParameter:ra,dropOriginalParameter:Rr,encodeMissingParameter:aa,selectedColumns:hn,renderParameterField:Qt,onToggleColumn:Yr,onApplyRecommended:Xh,canResetNode:xt,onResetNode:Or,formatMissingPercentage:ys}),G&&a.jsx(rT,{columnsParameter:oa,autoDetectParameter:ia,degreeParameter:Ee,includeBiasParameter:Qe,interactionOnlyParameter:Je,includeInputFeaturesParameter:un,outputPrefixParameter:At,renderParameterField:Qt,signal:E_,canResetNode:xt,onResetNode:Or}),V&&a.jsx(oT,{columnsParameter:ds,autoDetectParameter:tn,targetColumnParameter:En,methodParameter:gn,scoreFuncParameter:ss,problemTypeParameter:Vt,kParameter:fn,percentileParameter:On,alphaParameter:la,thresholdParameter:Fr,modeParameter:bs,estimatorParameter:Sr,stepParameter:xs,minFeaturesParameter:nr,maxFeaturesParameter:Ir,dropUnselectedParameter:_o,renderParameterField:Qt,signal:gh,canResetNode:xt,onResetNode:Or}),O&&a.jsx(BA,{hasSource:!!i,hasReachableSource:vt,strategies:xu,columnSummary:Bl,columnOptions:cm,sampleMap:bh,collapsedStrategies:uu,onToggleStrategy:q_,onRemoveStrategy:pp,onAddStrategy:hp,onModeChange:Fu,onColumnToggle:gr,onColumnsChange:Om,onAutoDetectToggle:Ht,modeOptions:zg}),S&&a.jsx(CA,{hasSource:!!i,hasReachableSource:vt,strategies:pu,columnSummary:gu,columnOptions:ga,sampleMap:_h,customPairSummary:_u,customPairsParameter:dt,collapsedStrategies:uu,onToggleStrategy:Pm,onRemoveStrategy:Iu,onAddStrategy:Bo,onModeChange:oc,onAutoDetectToggle:Di,onColumnToggle:Ts,onColumnsChange:Tm,renderParameterField:Qt}),w&&a.jsx(DM,{hasSource:!!i,hasReachableSource:vt,strategies:Ia,columnOptions:Rh,methodOptions:Ke,missingFilter:lh,missingFilterMax:_m,missingFilterActive:Ih,filteredOptionCount:Fh,collapsedStrategies:uu,onToggleStrategy:Tr,onRemoveStrategy:up,onAddStrategy:cp,onMethodChange:dp,onOptionNumberChange:Gr,onColumnsChange:U_,onColumnToggle:mp,onMissingFilterChange:fp,formatMissingPercentage:ys,formatNumericStat:Qs,formatModeStat:Px,schemaDiagnostics:El}),H&&a.jsx(Y1,{configState:_e,setConfigState:Be,availableColumns:nn,columnTypeMap:rr,columnSuggestions:Al,selectedColumns:hn,previewColumns:Vr,previewStatus:Mt.status,sourceId:i,hasReachableSource:vt}),de&&a.jsx(W$,{sourceId:i,hasReachableSource:vt,isFetchingOutliers:Ha,outlierConfig:To,outlierMethodOptions:Ei,outlierMethodDetailMap:mm,outlierDefaultDetail:ya,outlierAutoDetectEnabled:fm,outlierSelectedCount:$o,outlierDefaultLabel:Ga,outlierOverrideCount:ki,outlierParameterOverrideCount:Lo,outlierOverrideExampleSummary:Eh,outlierHasOverrides:Eu,outlierRecommendationRows:Ss,outlierHasRecommendations:Sh,outlierStatusMessage:ba,outlierError:sm,outlierSampleSize:Cu,relativeOutlierGeneratedAt:Ch,outlierPreviewSignal:Vl,formatMetricValue:wr,formatNumericStat:Qs,onApplyAllRecommendations:jm,onClearOverrides:ep,onDefaultMethodChange:Jh,onAutoDetectToggle:Zh,onOverrideSelect:tp,onMethodParameterChange:np,onColumnParameterChange:Sm}),ee&&a.jsx(UM,{sourceId:i,hasReachableSource:vt,isFetchingScaling:Va,scalingConfig:wu,scalingMethodOptions:O_,scalingMethodDetailMap:um,scalingDefaultDetail:Si,scalingAutoDetectEnabled:Nu,scalingSelectedCount:wh,scalingDefaultLabel:Nh,scalingOverrideCount:jh,scalingOverrideExampleSummary:dm,scalingRecommendationRows:ju,scalingHasRecommendations:Su,scalingStatusMessage:Ci,scalingError:Ur,scalingSampleSize:ps,relativeScalingGeneratedAt:hs,formatMetricValue:wr,formatNumericStat:Qs,formatMissingPercentage:ys,onApplyAllRecommendations:R_,onClearOverrides:Du,onDefaultMethodChange:Cm,onAutoDetectToggle:sp,onOverrideSelect:rp}),Q&&a.jsxs(a.Fragment,{children:[a.jsx(SM,{hasSource:!!i,hasReachableSource:vt,isFetching:fu,error:M_,relativeGeneratedAt:F_,sampleSize:at,binningConfig:Jn,binningDefaultLabel:Wr,binningOverrideCount:ql,binningOverrideSummary:Hl,recommendations:Ar,excludedColumns:Mu,numericColumnCount:fr.length,canApplyAllNumeric:Ro,onApplyAllNumeric:D_,onApplyStrategies:bm,onClearOverrides:Oi,customEdgeDrafts:hm,customLabelDrafts:kh,onOverrideStrategyChange:Ai,onOverrideNumberChange:Wh,onOverrideKbinsEncodeChange:Kh,onOverrideKbinsStrategyChange:Yh,onOverrideClear:ym,onCustomBinsChange:$_,onCustomLabelsChange:L_,onClearCustomColumn:es,formatMetricValue:wr,formatNumericStat:Qs}),a.jsx(wM,{config:Jn,fieldIds:Do,onIntegerChange:P_,onBooleanToggle:qh,onSuffixChange:Hh,onLabelFormatChange:Vh,onMissingStrategyChange:$u,onMissingLabelChange:T_})]}),pe&&a.jsx(YM,{sourceId:i,hasReachableSource:vt,isFetchingSkewness:Gt,skewnessThreshold:Kl,skewnessError:rn,skewnessViewMode:gm,skewnessRecommendedCount:Ah,skewnessNumericCount:Oh,skewnessGroupByMethod:hr,skewnessRows:$h,skewnessTableGroups:Lh,hasSkewnessAutoRecommendations:Th,skewnessTransformationsCount:Ph,isFetchingRecommendations:pa,getSkewnessMethodLabel:Dh,getSkewnessMethodStatus:Ql,onApplyRecommendations:zh,onViewModeChange:Kr,onGroupByToggle:Yl,onOverrideChange:Ou,onClearSelections:Pu}),le&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":Xa==="before",onClick:()=>Au("before"),disabled:!Fo.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":Xa==="after",onClick:()=>Au("after"),disabled:!Fo.length,children:"After"})]})})]}),Kl!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",Kl.toFixed(2)," are visualized below."]}),Gt&&Fo.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!Gt&&rn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:rn}),(!Gt||Fo.length>0)&&!rn&&(Fo.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:Fo.map(g=>{const N=(ce,ie,be)=>{const Te=Math.max(0,ce.sample_size||0),ct=Math.max(0,ce.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:ie}),be?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:be}):null]}),a.jsx(K$,{counts:ce.counts,binEdges:ce.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Qs(ce.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Qs(ce.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Qs(ce.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Qs(ce.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Qs(ce.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Te.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:ct.toLocaleString()})]})]})]},ie)},M=g.distributionAfter,L=Xa==="before",I=Xa==="after"&&!!M,se=Xa==="after"&&!M,ae=Xa==="before"?"Showing the original distribution returned by the skewness analysis.":M?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${g.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:g.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[g.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:g.directionLabel}),g.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:g.magnitudeLabel}),g.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",g.recommendedLabel]}),g.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",g.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:g.skewness!==null?wr(g.skewness,2):""})]})]}),g.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:g.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[L?N(g.distributionBefore,"Before transform"):null,I&&M?N(M,"After transform",g.appliedLabel):null,se?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",ae]})]},`skewness-dist-${g.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]}),ge&&a.jsx(CM,{cards:Za,selectedPreset:Ll,onSelectPreset:g=>Dl(g),isFetching:xi,sampleSize:Mm,relativeGeneratedAt:I_,error:hu,onRefresh:Pr,canRefresh:!!i}),Ye&&a.jsx(W1,{sourceId:i,hasReachableSource:vt,removeDuplicatesColumnsParameter:Ot,removeDuplicatesKeepParameter:Ft,renderMultiSelectField:ls,removeDuplicatesKeepSelectId:jn,removeDuplicatesKeep:Nn,onKeepChange:$m}),He&&nh.length>0&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Data consistency settings"}),xt&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Or,children:"Reset node"})})]}),a.jsx("div",{className:"canvas-modal__parameter-list",children:nh.map(g=>Qt(g))})]}),Z&&a.jsx(bT,{signal:Wl,previewStatus:Mt.status,hasSource:!!i,hasReachableSource:vt,onRefreshPreview:Hr}),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("h3",{children:"Node details"}),y.length?a.jsx("dl",{className:"canvas-modal__metadata",children:y.map((g,N)=>a.jsxs("div",{className:"canvas-modal__metadata-row",children:[a.jsx("dt",{children:g.label}),a.jsx("dd",{children:g.value})]},`${g.label}-${N}`))}):a.jsx("p",{className:"canvas-modal__empty",children:"No metadata available for this node."})]})]}),a.jsx(lM,{onClose:t,canResetNode:xt,onResetNode:Or,showSaveButton:ip,canSave:sc,onSave:tc,isBusy:Am,busyLabel:lp})]})]})},Tw=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],lo=Tw.map(e=>e.key),G$=Tw.reduce((e,t)=>({...e,[t.key]:t.label}),{}),X$=e=>typeof e=="string"&&lo.includes(e),$w=28,Lw=320,J$=170,Dw="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",zw="Drop columns",Pd=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},ol="__pending_confirmation__",Xf=e=>e&&typeof e=="object"&&!Array.isArray(e),Z$=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],eL=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],tL={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},Td={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"validation-in",label:"Validation Split",position:30,required:!1,accepts:["validation"]},{key:"test-in",label:"Test Split",position:50,required:!1,accepts:["test"]},{key:"models-in",label:"Model",position:70,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},co=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{X$(n)&&t.add(n)}),lo.filter(n=>t.has(n))},Rw=(e,t)=>{const n=co(e),r=co(t);return n.length!==r.length?!1:n.every((i,l)=>i===r[l])},Fw=e=>!e||typeof e!="string"?null:lo.find(t=>e.endsWith(`-${t}`))??null,Iw=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},Bw=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:Iw(t,n),nL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,sL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,Uw=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const r=t.split("-");return r.length>=2?r.slice(-2).join("-"):t},rL=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),aL=(e,t)=>{const n=new Map,r=new Set;e.forEach(m=>{var p;const y=(p=m==null?void 0:m.data)==null?void 0:p.catalogType;if(y&&rL.has(y)){r.add(m.id);return}y==="train_test_split"&&n.set(m.id,new Set(lo))});let i=!0,l=0;const u=e.length*3;for(;i&&l<u;)i=!1,l++,t.forEach(m=>{if(r.has(m.source)||r.has(m.target))return;const y=n.get(m.source),p=Fw(m.sourceHandle);if(!y||y.size===0)return;n.has(m.target)||n.set(m.target,new Set);const _=n.get(m.target),v=_.size;p?y.has(p)&&_.add(p):y.forEach(w=>_.add(w)),_.size>v&&(i=!0)});const d=new Map;return n.forEach((m,y)=>{!m.size||r.has(y)||d.set(y,lo.filter(p=>m.has(p)))}),d},oL=e=>{const t=new Map;e.forEach(r=>{const i=Fw(r.sourceHandle);i&&(t.has(r.source)||t.set(r.source,new Set),t.get(r.source).add(i))});const n=new Map;return t.forEach((r,i)=>{n.set(i,lo.filter(l=>r.has(l)))}),n},iL=e=>{var n;const t=e?Td[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(r=>r.required!==!1).map(r=>r.key):[]},lL=(e,t,n)=>{const r=iL(t);if(r.length===0)return!0;const i=n.filter(u=>u.target===e),l=new Set(i.map(u=>Uw(e,u.targetHandle)).filter(u=>!!u));return r.every(u=>l.has(u))},cL=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),qw=new Set(["transformer_audit"]),Jf=e=>typeof e=="string"&&qw.has(e),Zf=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",r=!qw.has(n),i=u=>(r?u[ol]=!0:delete u[ol],u);if(t==null)return i({});const l=Pd(t);if(!Xf(l))return i(l&&typeof l=="object"?l:{});switch(Object.entries(l).forEach(([u,d])=>{Array.isArray(d)?Z$.some(y=>y.test(u))&&(l[u]=[]):Xf(d)&&eL.some(y=>y.test(u))&&(l[u]={})}),"auto_detect"in l&&(l.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":l.columns=Array.isArray(l.columns)?l.columns:[],l.column_methods=Xf(l.column_methods)?l.column_methods:{},l.skipped_columns=Array.isArray(l.skipped_columns)?l.skipped_columns:[],l.default_method=typeof l.default_method=="string"&&l.default_method.trim()?l.default_method:"standard";break;case"polynomial_features":l.columns=Array.isArray(l.columns)?l.columns:[],l.auto_detect=!!l.auto_detect,l.include_bias=!!l.include_bias,l.interaction_only=!!l.interaction_only,l.include_input_features=!!l.include_input_features,l.degree=typeof l.degree=="number"&&Number.isFinite(l.degree)?l.degree:2,l.output_prefix=typeof l.output_prefix=="string"&&l.output_prefix.trim()?l.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in l&&(l.missing_threshold=null),l.columns=Array.isArray(l.columns)?l.columns:[];break;case"drop_missing_rows":"missing_threshold"in l&&(l.missing_threshold=null),"drop_if_any_missing"in l&&(l.drop_if_any_missing=!1);break;case"outlier_removal":l.method="manual",l.columns=Array.isArray(l.columns)?l.columns:[],l.manual_bounds=Xf(l.manual_bounds)?l.manual_bounds:{};break;case"missing_value_indicator":l.columns=Array.isArray(l.columns)?l.columns:[];break;case"remove_duplicates":if(l.columns=Array.isArray(l.columns)?l.columns:[],typeof l.keep=="string"){const u=l.keep.trim().toLowerCase();l.keep=u==="last"||u==="none"?u:"first"}else l.keep="first";break}return i(l)},uL=e=>({width:`${$w}px`,height:`${$w}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),dL=({id:e,data:t,selected:n})=>{var j;const r=(t==null?void 0:t.label)??e,i=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),l=(t==null?void 0:t.isRemovable)??!i,u=(t==null?void 0:t.catalogType)==="train_test_split",d=i?"Primary dataset input":void 0,m=(t==null?void 0:t.description)??d,p=(t==null?void 0:t.catalogType)==="drop_missing_columns"||m===Dw?zw:m,_=(t==null?void 0:t.backgroundExecutionStatus)??"idle",w=!((t==null?void 0:t.hasRequiredConnections)??!0),x=(t==null?void 0:t.catalogType)??"",S=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(x),E=f.useCallback(O=>{var k;O.stopPropagation(),(k=t==null?void 0:t.onRemoveNode)==null||k.call(t,e)},[t,e]),A=f.useMemo(()=>{if(i)return[];const O=(t==null?void 0:t.catalogType)??"",k=O?Td[O]:void 0;if(k!=null&&k.inputs&&k.inputs.length){const D=k.inputs.length;return k.inputs.map(($,B)=>({position:Ze.Left,id:`${e}-${$.key}`,label:nL($),style:{top:Bw($,B,D)}}))}return[{position:Ze.Left,id:`${e}-target`},{position:Ze.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,i]),P=f.useMemo(()=>{if(i)return[{position:Ze.Left,id:`${e}-source-left`},{position:Ze.Right,id:`${e}-source`},{position:Ze.Top,id:`${e}-source-top`},{position:Ze.Bottom,id:`${e}-source-bottom`}];const O=(t==null?void 0:t.catalogType)??"",k=O?Td[O]:void 0;if(k!=null&&k.outputs&&k.outputs.length){const B=k.outputs.length;return k.outputs.map((q,K)=>({position:Ze.Right,id:`${e}-${q.key}`,label:q.label,style:{top:Bw(q,K,B)}}))}const D=u?lo:co((t==null?void 0:t.activeSplits)??[]),$=co((t==null?void 0:t.connectedSplits)??[]);if(D.length){const B=D.length;return D.map((q,K)=>({position:Ze.Right,id:`${e}-${q}`,style:{top:Iw(K,B)},label:(()=>{var ue;const ne=G$[q];if(u){if(q==="validation"&&!(Number(((ue=t==null?void 0:t.config)==null?void 0:ue.validation_size)??0)>0))return`${ne} (disabled)`;if(!$.includes(q))return`${ne} (not set)`}return ne})()}))}return[{position:Ze.Right,id:`${e}-source`},{position:Ze.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(j=t==null?void 0:t.config)==null?void 0:j.validation_size,e,i,u]),T=f.useCallback((O,k)=>{const{position:D,id:$,style:B,label:q}=O,K=$.includes("-train")||$.includes("-test")||$.includes("-validation");return a.jsxs(Ae.Fragment,{children:[a.jsx(dd,{type:k,position:D,id:$,className:`feature-node__handle feature-node__handle--${k}`,style:{...uL(k),...B??{},...K?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),q&&k==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(B==null?void 0:B.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:q}),q&&k==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(B==null?void 0:B.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:q})]},$)},[]);return a.jsxs("div",{className:`feature-node${n?" feature-node--selected":""}${i?" feature-node--dataset":""}`,children:[A.map(O=>T(O,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:r})]}),a.jsxs("div",{className:"feature-node__controls",children:[w&&S&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)"},children:""}),_==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:"Loading full dataset in background...",children:a.jsx("svg",{className:"feature-node__spinner",viewBox:"0 0 24 24",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60",strokeDashoffset:"30",strokeLinecap:"round"})})}),_==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",children:""}),_==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",children:"!"}),l&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:E,title:"Remove node",children:""})]})]}),p&&a.jsx("p",{className:"feature-node__description",children:p}),P.map(O=>T(O,"source"))]})},mL=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],fL=[],hL=e=>({...e,data:{...e.data??{}}}),eh=()=>mL.map(e=>hL(e)),pL=()=>fL.map(e=>({...e})),gL=12,_L=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},Hw=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},f_=e=>{const t=Hw(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},h_=e=>{const t=Hw(e);if(!t)return null;const n=t.getTime(),r=Date.now()-n,i=Math.round(r/6e4);if(i<1)return"just now";if(i===1)return"1 minute ago";if(i<60)return`${i} minutes ago`;const l=Math.round(i/60);if(l===1)return"1 hour ago";if(l<24)return`${l} hours ago`;const u=Math.round(l/24);if(u===1)return"1 day ago";if(u<7)return`${u} days ago`;const d=Math.round(u/7);return d===1?"1 week ago":`${d} weeks ago`},vL=f.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:r,onPipelineError:i},l)=>{var en;const u=f.useMemo(()=>({featureNode:dL}),[]),d=f.useMemo(()=>({animatedEdge:A1}),[]),[m,y,p]=C1(eh().map(ye=>({...ye,type:"featureNode"}))),[_,v,w]=E1(pL()),x=f.useRef(!1),[S,E]=f.useState(!1),[A,P]=f.useState(null),[T,j]=f.useState(!1),O=f.useRef(0),k=f.useRef(null),D=f.useRef(null),$=f.useRef(!1),B=f.useRef(new Map),q=t??e??"Demo dataset",K=ok(),ne=f.useCallback(ye=>{const we=(Array.isArray(ye)?ye:[ye]).filter(Boolean);if(!we.length)return;const ke=Array.from(new Set(we));console.debug(" Scheduling node internals update for:",ke),requestAnimationFrame(()=>{requestAnimationFrame(()=>{ke.forEach(Oe=>{K(Oe)})})})},[K]),ue=f.useCallback(ye=>{const we=ye.reduce((ke,Oe)=>{if(typeof Oe.id=="string"&&Oe.id.startsWith("node-")){const Xe=Number(Oe.id.replace("node-",""));if(!Number.isNaN(Xe))return Math.max(ke,Xe)}return ke},0);we>O.current&&(O.current=we)},[]);f.useEffect(()=>{ue(m)},[m,ue]),f.useEffect(()=>{const ye=[];y(we=>{const ke=aL(we,_),Oe=oL(_);let Xe=!1;const Ie=we.map(nt=>{var $t,Lt,xn,Ut,Pt;const Ot=(($t=nt==null?void 0:nt.data)==null?void 0:$t.catalogType)==="train_test_split"?[...lo]:ke.get(nt.id)??[],Ft=co((Lt=nt.data)==null?void 0:Lt.activeSplits),dt=co(Oe.get(nt.id)),Tt=co((xn=nt.data)==null?void 0:xn.connectedSplits),gt=((Ut=nt==null?void 0:nt.data)==null?void 0:Ut.catalogType)??"",kt=lL(nt.id,gt,_),vn=((Pt=nt.data)==null?void 0:Pt.hasRequiredConnections)??!0,Jt=!Rw(Ft,Ot),Mn=!Rw(Tt,dt);if(!Jt&&!Mn&&!(kt!==vn))return nt;const yn={...nt.data,hasRequiredConnections:kt};return Ot.length?yn.activeSplits=Ot:delete yn.activeSplits,dt.length?yn.connectedSplits=dt:delete yn.connectedSplits,Xe=!0,(Jt||Mn)&&ye.push(nt.id),{...nt,data:yn}});return Xe?Ie:we}),ye.length&&ne(ye)},[_,ne,y]);const z=f.useMemo(()=>m.find(ye=>ye.id===A)??null,[m,A]),X=f.useMemo(()=>{const ye=m.map(ke=>{const{data:Oe,...Xe}=ke,Ie=Oe?{...Oe}:void 0;return Ie&&(delete Ie.onRemoveNode,delete Ie.onOpenSettings),JSON.parse(JSON.stringify({...Xe,data:Ie}))}),we=_.map(ke=>JSON.parse(JSON.stringify(ke)));return{nodes:ye,edges:we}},[_,m]),Y=f.useCallback(ye=>{P(ye),j(!0)},[]),W=f.useCallback(()=>{j(!1),P(null)},[]),F=f.useCallback(()=>{$.current=!0},[]);f.useEffect(()=>{$.current&&($.current=!1,requestAnimationFrame(()=>{var ye;(ye=k.current)==null||ye.fitView({padding:.25,duration:350})}))},[_,m]);const te=f.useCallback(ye=>{ye!=="dataset-source"&&(y(we=>we.filter(ke=>ke.id!==ye)),v(we=>we.filter(ke=>ke.source!==ye&&ke.target!==ye)),P(we=>we===ye?(j(!1),null):we))},[v,j,y]),U=f.useCallback(ye=>{var Mn,Yn,yn,$t,Lt,xn;const we=ye.data??{},ke=we.isDataset??ye.id==="dataset-source",Oe={...ye.style??{}},Xe=we.catalogType??we.type??ye.id;let nt=Array.isArray(we.parameters)?we.parameters:null;if((!nt||nt.length===0)&&typeof Xe=="string"){const Ut=B.current.get(Xe)??null;(Mn=Ut==null?void 0:Ut.parameters)!=null&&Mn.length&&(nt=Ut.parameters)}const xt=Array.isArray(nt)?nt.map(Ut=>({...Ut})):[];let Ot;if(xt.length||we.config&&typeof we.config=="object"){const Ut=Pd(we.config);xt.forEach(Pt=>{Pt!=null&&Pt.name&&Ut[Pt.name]===void 0&&Pt.default!==void 0&&(Array.isArray(Pt.default)?Ut[Pt.name]=[...Pt.default]:Pt.type==="boolean"?Ut[Pt.name]=!!Pt.default:Ut[Pt.name]=Pt.default)}),Ot=Ut}Oe.width||(Oe.width=ke?Lw+20:Lw),Oe.minHeight||(Oe.minHeight=J$),Oe.padding||(Oe.padding=12),Oe.borderRadius||(Oe.borderRadius=16),Oe.boxSizing=Oe.boxSizing??"border-box",Oe.whiteSpace=Oe.whiteSpace??"pre-line",Oe.background||(Oe.background=ke?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),Oe.border||(Oe.border=ke?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),Oe.boxShadow||(Oe.boxShadow=ke?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),Oe.color||(Oe.color=ke?"#e0f2fe":"#e2e8f0"),Oe.fontWeight||(Oe.fontWeight=ke?600:500);const Ft=Xe==="drop_missing_columns"||we.description===Dw?zw:we.description,dt=Jf(Xe),Tt=Ot??(we.config&&typeof we.config=="object"?Pd(we.config):void 0);Tt&&typeof Tt=="object"&&dt&&delete Tt[ol];const gt={...we,label:we.label??ye.id,description:Ft,isDataset:ke,isRemovable:we.isRemovable??!ke,isConfigured:ke||we.isConfigured===!0?!0:we.config&&typeof we.config=="object"?dt?!0:!we.config[ol]:!1,inputs:Array.isArray(we.inputs)?[...we.inputs]:we.inputs,outputs:Array.isArray(we.outputs)?[...we.outputs]:we.outputs,category:we.category,parameters:xt,config:Tt,catalogType:Xe,onRemoveNode:te,onOpenSettings:Y},kt=typeof Xe=="string"?Td[Xe]:void 0;if(kt){const Ut=((Yn=kt.inputs)==null?void 0:Yn.map(mn=>sL(mn)))??[],Pt=((yn=kt.outputs)==null?void 0:yn.map(mn=>mn.label))??[];Ut.length?gt.inputs=Ut:delete gt.inputs,Pt.length?gt.outputs=Pt:delete gt.outputs,gt.connectionInfo={inputs:(($t=kt.inputs)==null?void 0:$t.map(mn=>({...mn})))??[],outputs:((Lt=kt.outputs)==null?void 0:Lt.map(mn=>({...mn})))??[]}}else(!gt.inputs||gt.inputs.length===0)&&delete gt.inputs,(!gt.outputs||gt.outputs.length===0)&&delete gt.outputs,delete gt.connectionInfo;const vn=co(gt.activeSplits);vn.length?gt.activeSplits=vn:delete gt.activeSplits;const Jt=co(gt.connectedSplits);return Jt.length?gt.connectedSplits=Jt:delete gt.connectedSplits,Xe==="train_test_split"&&(gt.activeSplits=[...lo],Jt.length||delete gt.connectedSplits),(xn=gt.parameters)!=null&&xn.length||delete gt.parameters,gt.config===void 0&&delete gt.config,{...ye,type:"featureNode",position:ye.position??{x:0,y:0},data:gt,style:Oe}},[Y,te]),H=f.useCallback(()=>{y(ye=>{const we=ye.find(Oe=>Oe.id==="dataset-source");return[U(we?{...we,data:{...we.data??{},label:`Dataset input
(${q})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${q})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),v([]),P(null),j(!1),F()},[q,U,F,v,y,P,j]);f.useImperativeHandle(l,()=>({openCatalog:()=>E(!0),closeCatalog:()=>E(!1),clearGraph:H}),[H]);const Q=f.useCallback(ye=>ye.map(we=>{const ke={...we.data??{}};we.id==="dataset-source"&&(ke.label=`Dataset input
(${q})`,ke.isDataset=!0,ke.isRemovable=!1,ke.isConfigured=!0);const Oe=ke.catalogType??ke.type??we.id;return ke.config&&typeof ke.config=="object"&&Jf(Oe)&&delete ke.config[ol],ke.isConfigured===void 0&&(ke.config&&typeof ke.config=="object"?ke.isConfigured=Jf(Oe)?!0:!ke.config[ol]:ke.isConfigured=!0),U({...we,data:ke})}),[q,U]),ee=f.useCallback((ye,we)=>{const ke=O.current+1,Oe=`node-${ke}`;O.current=ke;const Xe=we??{x:160+(ke-1)%4*220,y:40+Math.floor((ke-1)/4)*160},Ie=`Step ${ke}`,nt=(ye==null?void 0:ye.label)??(ye==null?void 0:ye.type)??Ie,xt=typeof nt=="string"&&nt.trim()?nt:Ie,Ot=Zf(ye),Ft=Jf((ye==null?void 0:ye.type)??null);return U({id:Oe,type:"featureNode",position:Xe,data:{label:xt,description:ye==null?void 0:ye.description,inputs:ye==null?void 0:ye.inputs,outputs:ye==null?void 0:ye.outputs,category:ye==null?void 0:ye.category,parameters:ye==null?void 0:ye.parameters,config:Ot,catalogType:ye==null?void 0:ye.type,isConfigured:!!Ft}})},[U]),G=f.useCallback(ye=>{const we=k.current,ke=D.current;if(!we||typeof we.project!="function"||!ke)return;const Oe=ke.getBoundingClientRect(),Xe=we.project({x:Oe.width/2,y:Oe.height/2});if(!Xe)return;const Ie=ye.filter(Tt=>Tt.id!=="dataset-source").length,nt=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],xt=Ie%nt.length,Ot=Math.floor(Ie/nt.length),Ft=nt[xt],dt=Ot+1;return{x:Xe.x+Ft.x*dt,y:Xe.y+Ft.y*dt}},[]),V=vr({queryKey:["feature-canvas","node-catalog"],queryFn:rx,staleTime:5*60*1e3}),Z=V.data??[],de=V.isLoading||V.isFetching,pe=V.error?((en=V.error)==null?void 0:en.message)??"Unable to load node catalog":null,le=f.useMemo(()=>{const ye=new Map;return Z.forEach(we=>{we&&typeof we.type=="string"&&we.type.trim()&&ye.set(we.type,we)}),ye},[Z]);f.useEffect(()=>{B.current=le},[le]);const ge=f.useCallback(ye=>{if(!ye)return!1;if(cL.has(ye))return!0;const we=le.get(ye);return we?(typeof we.category=="string"?we.category.toLowerCase():"").includes("preprocess"):!1},[le]),He=f.useCallback(ye=>{var ke;if(!ye||ye.id==="dataset-source")return!1;const we=(ke=ye==null?void 0:ye.data)==null?void 0:ke.catalogType;return ge(typeof we=="string"?we:null)},[ge]),lt=f.useMemo(()=>m.some(ye=>He(ye)),[m,He]),Ye=vr({queryKey:["feature-canvas","pipeline",e],queryFn:()=>vx(e),enabled:!!e,staleTime:60*1e3,retry:1}),Se=Ye.isLoading||Ye.isFetching,Re=f.useCallback(ye=>{y(we=>{const ke=G(we),Oe=ee(ye,ke);return[...we,Oe]}),F()},[ee,G,F,y]),Ce=f.useCallback((ye,we)=>{y(ke=>ke.map(Oe=>{if(Oe.id!==ye)return Oe;const Xe=Pd(we);Xe&&typeof Xe=="object"&&delete Xe[ol];const Ie={...Oe.data??{},config:Xe,isConfigured:!0};return U({...Oe,data:Ie})}))},[U,y]),Fe=f.useCallback((ye,we)=>{y(ke=>ke.map(Oe=>{if(Oe.id!==ye)return Oe;const Xe={...Oe.data??{},...we};return U({...Oe,data:Xe})}))},[U,y]),Ve=f.useCallback((ye,we)=>{y(ke=>ke.map(Oe=>{var Ot;if(Oe.id!==ye)return Oe;const Xe=(Ot=Oe==null?void 0:Oe.data)==null?void 0:Ot.catalogType,Ie=Xe?le.get(Xe)??null:null,nt=we&&typeof we=="object"?Pd(we):Zf(Ie??null),xt={...Oe.data??{},config:nt,isConfigured:!1,backgroundExecutionStatus:"idle"};return U({...Oe,data:xt})}))},[le,U,y]),Ke=f.useCallback(()=>{lt&&(typeof window<"u"&&!window.confirm("Reset all preprocessing nodes to their default settings?")||y(ye=>ye.map(we=>{var nt;if(!He(we))return we;const ke=(nt=we==null?void 0:we.data)==null?void 0:nt.catalogType,Oe=ke?le.get(ke)??null:null,Xe=Zf(Oe??null),Ie={...we.data??{},config:Xe,isConfigured:!1,backgroundExecutionStatus:"idle"};return U({...we,data:Ie})})))},[le,lt,U,y,He]),tt=f.useCallback(ye=>{var Ot,Ft;const{source:we,target:ke,sourceHandle:Oe,targetHandle:Xe}=ye;if(!we||!ke||!Xe||we===ke)return!1;const Ie=m.find(dt=>dt.id===ke);if(!Ie)return!1;const nt=((Ot=Ie==null?void 0:Ie.data)==null?void 0:Ot.catalogType)??"",xt=nt?Td[nt]:void 0;if((Ft=xt==null?void 0:xt.inputs)!=null&&Ft.length){const dt=Uw(ke,Xe);if(!dt)return!1;const Tt=xt.inputs.find(gt=>gt.key===dt);return!Tt||!Oe?!1:Tt.accepts&&Tt.accepts.length>0?Tt.accepts.some(gt=>{const kt=tL[gt];return kt?kt(Oe):!1}):!0}return!0},[m]),J=f.useCallback(ye=>{v(ke=>$y({...ye,type:"animatedEdge",animated:!0},ke));const we=[ye.source,ye.target].filter(ke=>!!ke);we.length&&ne(we)},[ne,v]);f.useEffect(()=>{if(!e){const ye=`Dataset input
(${q})`;if(x.current)y(we=>{let ke=!1;const Oe=we.map(Xe=>{var nt;return Xe.id!=="dataset-source"||(((nt=Xe==null?void 0:Xe.data)==null?void 0:nt.label)??"")===ye?Xe:(ke=!0,U({...Xe,data:{...Xe.data??{},label:ye,isDataset:!0,isRemovable:!1}}))});return ke?Oe:we});else{const we=_L(q),ke=Q(we.nodes);x.current=!0,y(ke),v(we.edges),ue(ke),F(),r==null||r({nodes:ke,edges:we.edges,pipeline:null,context:"sample"})}return}if(x.current=!1,Ye.isLoading){const ye=`Dataset input
(${q})`;y(we=>we.map(ke=>ke.id==="dataset-source"?U({...ke,data:{...ke.data??{},label:ye,isDataset:!0,isRemovable:!1}}):ke));return}if(Ye.isError){const ye=Ye.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",ye),i==null||i(ye);const we=`Dataset input
(${q})`,ke=eh().map(Xe=>Xe.id==="dataset-source"?{...Xe,data:{...Xe.data??{},label:we,isDataset:!0,isRemovable:!1}}:Xe),Oe=Q(ke);y(Oe),v([]),ue(Oe),F(),r==null||r({nodes:Oe,edges:[],pipeline:null,context:"reset"});return}if(Ye.data){const ye=Ye.data.graph??{},we=Array.isArray(ye==null?void 0:ye.nodes)&&ye.nodes.length?ye.nodes:eh(),ke=Q(we),Xe=(Array.isArray(ye==null?void 0:ye.edges)?ye.edges:[]).map(Ie=>{var kt;const nt=Ie==null?void 0:Ie.type,xt=!nt||nt==="smoothstep"||nt==="default"?"animatedEdge":nt,Ot=Ie==null?void 0:Ie.source,Ft=Ie==null?void 0:Ie.target,dt=ke.find(vn=>vn.id===Ft),Tt=(Ie==null?void 0:Ie.sourceHandle)??(Ot?`${Ot}-source`:void 0),gt=(Ie==null?void 0:Ie.targetHandle)??((kt=dt==null?void 0:dt.data)!=null&&kt.isDataset?void 0:Ft?`${Ft}-target`:void 0);return{...Ie,animated:(Ie==null?void 0:Ie.animated)??!0,type:xt,sourceHandle:Tt,targetHandle:gt}});y(ke),v(Xe),ue(ke),F(),r==null||r({nodes:ke,edges:Xe,pipeline:Ye.data??null,context:"stored"});return}if(Ye.isFetched&&!Ye.data){const ye=`Dataset input
(${q})`,we=eh().map(Oe=>Oe.id==="dataset-source"?{...Oe,data:{...Oe.data??{},label:ye,isDataset:!0,isRemovable:!1}}:Oe),ke=Q(we);y(ke),v([]),ue(ke),F(),r==null||r({nodes:ke,edges:[],pipeline:null,context:"sample"})}},[q,r,i,Ye.data,Ye.error,Ye.isError,Ye.isFetched,Ye.isLoading,Q,U,F,v,y,e,ue]),f.useEffect(()=>{n==null||n(m,_)},[_,m,n]);const Pe=f.useMemo(()=>{var ke;if(!z)return null;const ye=(ke=z==null?void 0:z.data)==null?void 0:ke.catalogType;if(!ye)return null;const we=le.get(ye);return we?Zf(we):null},[le,z]),$e=f.useMemo(()=>{var we,ke;if(!z||(we=z.data)!=null&&we.isDataset)return!1;const ye=(ke=z==null?void 0:z.data)==null?void 0:ke.catalogType;return ge(typeof ye=="string"?ye:null)},[ge,z]),rt=f.useMemo(()=>de?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):pe?a.jsx("p",{className:"text-danger",children:pe}):Z.length?a.jsx(T1,{nodes:Z,onAddNode:Re}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[pe,Re,de,Z]),wt=f.useCallback((ye,we)=>{Y(we.id)},[Y]);return a.jsxs("div",{className:"canvas-stage",children:[a.jsxs("div",{className:"canvas-stage__viewport","data-pipeline-loading":Se?"true":"false","aria-busy":Se,ref:D,children:[a.jsxs(tx,{style:{width:"100%",height:"100%"},nodes:m,edges:_,nodeTypes:u,edgeTypes:d,onNodesChange:p,onEdgesChange:w,onConnect:J,isValidConnection:tt,onNodeClick:wt,onInit:ye=>{k.current=ye,requestAnimationFrame(()=>ye.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:Qi.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:P1,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(ZE,{position:"bottom-left"}),a.jsx(rk,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:Ke,disabled:!lt,"aria-label":"Reset preprocessing nodes",title:lt?"Reset all preprocessing nodes to defaults":"No preprocessing nodes to reset",children:""}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:()=>E(!0),"aria-label":"Open node catalog",children:"+"})]}),a.jsxs("div",{className:`canvas-drawer${S?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:()=>E(!1),"aria-label":"Close catalog",children:""})]}),a.jsx("div",{className:"canvas-drawer__body",children:rt})]}),S&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:()=>E(!1)}),T&&z&&a.jsx(Q$,{node:z,sourceId:e??null,graphSnapshot:X,onClose:W,onUpdateConfig:Ce,onUpdateNodeData:Fe,onResetConfig:Ve,defaultConfigTemplate:Pe,isResetAvailable:$e})]})}),yL=({sourceId:e})=>{var Se,Re;const t=fc(),n=f.useRef(null),[r,i]=f.useState(e??null),[l,u]=f.useState(null),[d,m]=f.useState(!0),[y,p]=f.useState(!1),[_,v]=f.useState(null),[w,x]=f.useState(null),[S,E]=f.useState(null),[A,P]=f.useState(null),[T,j]=f.useState(!1),O=f.useMemo(()=>["feature-canvas","pipeline",r],[r]),k=f.useRef(null),D=f.useRef({nodes:[],edges:[]}),$=f.useRef(!0),B=vr({queryKey:["feature-canvas","datasets"],queryFn:()=>_x(12),staleTime:5*60*1e3}),q=B.data??[],K=B.isLoading,ne=B.error?((Se=B.error)==null?void 0:Se.message)??"Unable to load datasets":null,ue=f.useMemo(()=>q.filter(Ce=>(Ce==null?void 0:Ce.is_owned)!==!1),[q]);f.useEffect(()=>{if(!q.length){u(null);return}if(r){const Fe=q.find(Ve=>Ve.source_id===r);if(Fe){u(Ve=>(Ve==null?void 0:Ve.id)===Fe.id?Ve:Fe);return}}const Ce=ue[0]??q[0];Ce&&(r||i(Ce.source_id??String(Ce.id)),u(Ce))},[r,q,ue]);const z=vr({queryKey:["feature-canvas","pipeline-history",r],queryFn:()=>bx(r,gL),enabled:!!r,staleTime:30*1e3,retry:1}),X=z.data??[],Y=z.isLoading||z.isFetching,W=z.error?((Re=z.error)==null?void 0:Re.message)??"Unable to load history":null,{mutate:F,isPending:te}=Km({mutationFn:async({sourceId:Ce,payload:Fe})=>yx(Ce,Fe),onSuccess:(Ce,Fe)=>{v({message:"Draft saved successfully.",tone:"success"}),p(!1),x(Ce.id??null),P(Ce.name??null),E(Ce.updated_at??null),k.current=Ce.id??null,t.setQueryData(["feature-canvas","pipeline",Fe.sourceId],Ce),t.invalidateQueries({queryKey:["feature-canvas","pipeline-history",Fe.sourceId],exact:!1})},onError:Ce=>{v({message:(Ce==null?void 0:Ce.message)??"Failed to save pipeline.",tone:"error"})}});f.useEffect(()=>{if(!_||_.tone==="error"||typeof window>"u")return;const Ce=window.setTimeout(()=>v(null),_.tone==="success"?4e3:2500);return()=>window.clearTimeout(Ce)},[_]);const U=f.useCallback((Ce,Fe)=>{const Ve={nodes:JSON.parse(JSON.stringify(Ce??[])),edges:JSON.parse(JSON.stringify(Fe??[]))},Ke=D.current,tt=JSON.stringify(Ke.nodes??[])===JSON.stringify(Ve.nodes??[])&&JSON.stringify(Ke.edges??[])===JSON.stringify(Ve.edges??[]);D.current=Ve;const J=Array.isArray(Ve.nodes)?Ve.nodes.some($e=>($e==null?void 0:$e.id)&&$e.id!=="dataset-source"):!1,Pe=Array.isArray(Ve.edges)?Ve.edges.length>0:!1;j(J||Pe),!($.current||tt)&&(p(!0),v(null))},[]),H=f.useCallback(Ce=>{const{nodes:Fe,edges:Ve,pipeline:Ke,context:tt}=Ce,J={nodes:JSON.parse(JSON.stringify(Fe??[])),edges:JSON.parse(JSON.stringify(Ve??[]))};D.current=J;const Pe=(J.nodes??[]).some(wt=>wt.id!=="dataset-source"),$e=Array.isArray(J.edges)?J.edges.length>0:!1;j(Pe||$e);const rt=(Ke==null?void 0:Ke.id)??null;if(x(rt),P((Ke==null?void 0:Ke.name)??null),E((Ke==null?void 0:Ke.updated_at)??null),tt==="stored"&&Ke)if(k.current===Ke.id){const en=h_(Ke.updated_at)??f_(Ke.updated_at);v({message:`Saved revision ${Ke.name??`#${Ke.id}`} (${en})`,tone:"info"}),k.current=null}else $.current&&v(wt=>(wt==null?void 0:wt.tone)==="error"?wt:Pe?{message:"Loaded saved pipeline",tone:"info"}:wt);else tt==="sample"?(k.current=null,v(wt=>(wt==null?void 0:wt.tone)==="error"||Pe?wt:{message:`Showing starter pipeline for ${(l==null?void 0:l.name)??(l==null?void 0:l.source_id)??r??"demo dataset"}`,tone:"info"})):tt==="reset"?k.current=null:Ke||(k.current=null,v(wt=>(wt==null?void 0:wt.tone)==="error"?wt:null));$.current&&p(!1),Ke&&k.current&&k.current!==Ke.id&&(k.current=null),$.current=!1},[r,l,j]),Q=f.useCallback(Ce=>{v({message:(Ce==null?void 0:Ce.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[]),ee=f.useCallback(Ce=>{if(!(Ce!=null&&Ce.graph)){v({message:"Selected revision is missing pipeline data.",tone:"error"});return}y&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(k.current=Ce.id??null,$.current=!0,v({message:`Loading revision ${Ce.name??`#${Ce.id}`}`,tone:"info"}),t.setQueryData(O,Ce))},[y,O,t]),G=f.useCallback(()=>{var Ve;if(!r){v({message:"Select a dataset before saving.",tone:"error"});return}const Ce=D.current;if(!Ce.nodes||!Ce.nodes.length){v({message:"Add nodes to the canvas before saving.",tone:"error"});return}const Fe={name:l!=null&&l.name?`Draft pipeline for ${l.name}`:`Draft pipeline for ${r}`,graph:{nodes:Ce.nodes,edges:(Ce.edges??[]).map(Ke=>{const tt=Ke==null?void 0:Ke.type,J=!tt||tt==="smoothstep"||tt==="default"?"animatedEdge":tt;return{...Ke,animated:(Ke==null?void 0:Ke.animated)??!0,type:J}})},metadata:{lastClientSave:new Date().toISOString(),nodeCount:Ce.nodes.length,edgeCount:((Ve=Ce.edges)==null?void 0:Ve.length)??0}};v({message:"Saving draft",tone:"info"}),F({sourceId:r,payload:Fe})},[r,l==null?void 0:l.name,F]),V=f.useCallback(()=>{var Ce;T&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((Ce=n.current)==null||Ce.clearGraph(),v(Fe=>(Fe==null?void 0:Fe.tone)==="error"?Fe:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[T,n,v]),Z=(_==null?void 0:_.tone)==="success"?"":(_==null?void 0:_.tone)==="error"?"":"",de=f.useCallback(()=>{m(Ce=>!Ce)},[]),pe=f.useCallback(Ce=>{const Fe=q.find(Ve=>Ve.source_id===Ce)??null;if(!Fe){v({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(Fe.is_owned===!1){v({message:"Only datasets you own can be selected.",tone:"error"});return}i(Ce),u(Fe),$.current=!0,p(!1),v(null)},[q]),le=te?"Saving":y?"Save draft*":"Save draft",ge=!r||te,He=_?_.tone==="error"?"text-danger":_.tone==="success"?"text-success":"text-muted":"text-muted",lt=q.map(Ce=>({value:Ce.source_id,label:Ce.name??Ce.source_id,isOwned:Ce.is_owned!==!1})),Ye=ue.length>1;return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":d?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:de,"aria-label":d?"Collapse details panel":"Expand details panel","aria-expanded":d,"aria-controls":"feature-canvas-sidepanel",children:d?"":""}),!d&&_&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${He}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:Z}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:_.message})]}),d&&a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),S&&a.jsx("span",{className:"canvas-sidepanel__meta",children:h_(S)??f_(S)})]}),ne?a.jsx("p",{className:"text-danger",children:ne}):ue.length?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:r??"",onChange:Ce=>pe(Ce.target.value),disabled:K||!Ye,"aria-label":"Select dataset",children:lt.map(Ce=>a.jsx("option",{value:Ce.value,disabled:!Ce.isOwned,children:`${Ce.label}${Ce.isOwned?"":" (locked)"}`},Ce.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),K&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!K&&!q.length&&!ne&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(l==null?void 0:l.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:l.description}),r&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:(l==null?void 0:l.name)??r})]}),!Ye&&ue.length>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:V,disabled:!T,"aria-label":"Clean all nodes",title:T?"Remove all nodes and edges from the canvas":"Nothing to clean yet",children:[a.jsx("span",{"aria-hidden":"true",children:""}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:()=>z.refetch(),disabled:Y||!r,"aria-label":"Refresh history",title:"Refresh history",children:""}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:G,disabled:ge,"aria-label":le,title:le,children:""})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:Y?a.jsx("p",{className:"text-muted",children:"Loading history"}):W?a.jsx("p",{className:"text-danger",children:W}):X.length?X.map(Ce=>{const Ve=h_(Ce.updated_at)??f_(Ce.updated_at),Ke=Ce.id===w,tt=Ke&&!y;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${Ke?" canvas-sidepanel__history-item--active":""}`,onClick:()=>ee(Ce),disabled:tt,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:Ce.name||`Pipeline #${Ce.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:Ve}),Ke&&y&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},Ce.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),_&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${He}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:Z}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:_.message})]})]}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(nx,{children:a.jsx(vL,{ref:n,sourceId:r,datasetName:(l==null?void 0:l.name)??(l==null?void 0:l.source_id)??null,onGraphChange:U,onPipelineHydrated:H,onPipelineError:Q})})})]})},bL=new Tj,p_=document.getElementById("ml-workflow-root");if(!p_)throw new Error("ML workflow root element not found");const xL=Np.createRoot(p_),wL=p_.getAttribute("data-source-id")||void 0;xL.render(a.jsx(Ae.StrictMode,{children:a.jsx($j,{client:bL,children:a.jsx(yL,{sourceId:wL})})}))})();
//# sourceMappingURL=feature-canvas.js.map
