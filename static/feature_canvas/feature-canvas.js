var ij=gn=>{throw TypeError(gn)};var k_=(gn,On,Pn)=>On.has(gn)||ij("Cannot "+Pn);var ne=(gn,On,Pn)=>(k_(gn,On,"read from private field"),Pn?Pn.call(gn):On.get(gn)),Je=(gn,On,Pn)=>On.has(gn)?ij("Cannot add the same private member more than once"):On instanceof WeakSet?On.add(gn):On.set(gn,Pn),Ie=(gn,On,Pn,el)=>(k_(gn,On,"write to private field"),el?el.call(gn,Pn):On.set(gn,Pn),Pn),Nt=(gn,On,Pn)=>(k_(gn,On,"access private method"),Pn);var Wf=(gn,On,Pn,el)=>({set _(wt){Ie(gn,On,wt,Pn)},get _(){return ne(gn,On,el)}});(function(){"use strict";var go,qg,Iw,xl,_o,Ai,Bw,Oi,vo,Pi,Uw,wl,qw,jl,Ti,Pr,Nl,Zn,vu,Cl,Qr,oo,Hw,Xs,Ot,yu,zs,Sl,$i,Pa,yo,bu,Li,zi,El,kl,bo,Di,Ht,Fd,M_,A_,O_,P_,T_,$_,L_,cj,Vw,xu,ha,Ds,Ml,fa,Zo,Ww,Ta,Xr,wu,Kw,$a,xo,Js,La,za,Kf,z_,Yw,pa,Gw,_n,wo,jo,Ri,Fi,No,Ii,Bi,Qw;function gn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var On={exports:{}},Pn={},el={exports:{}},wt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var D_;function uj(){if(D_)return wt;D_=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(F){return F===null||typeof F!="object"?null:(F=f&&F[f]||F["@@iterator"],typeof F=="function"?F:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function x(F,K,re){this.props=F,this.context=K,this.refs=b,this.updater=re||w}x.prototype.isReactComponent={},x.prototype.setState=function(F,K){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,K,"setState")},x.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function N(){}N.prototype=x.prototype;function E(F,K,re){this.props=F,this.context=K,this.refs=b,this.updater=re||w}var k=E.prototype=new N;k.constructor=E,y(k,x.prototype),k.isPureReactComponent=!0;var j=Array.isArray,S=Object.prototype.hasOwnProperty,M={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function T(F,K,re){var G,q={},Y=null,Q=null;if(K!=null)for(G in K.ref!==void 0&&(Q=K.ref),K.key!==void 0&&(Y=""+K.key),K)S.call(K,G)&&!$.hasOwnProperty(G)&&(q[G]=K[G]);var ee=arguments.length-2;if(ee===1)q.children=re;else if(1<ee){for(var J=Array(ee),se=0;se<ee;se++)J[se]=arguments[se+2];q.children=J}if(F&&F.defaultProps)for(G in ee=F.defaultProps,ee)q[G]===void 0&&(q[G]=ee[G]);return{$$typeof:e,type:F,key:Y,ref:Q,props:q,_owner:M.current}}function L(F,K){return{$$typeof:e,type:F.type,key:K,ref:F.ref,props:F.props,_owner:F._owner}}function P(F){return typeof F=="object"&&F!==null&&F.$$typeof===e}function O(F){var K={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(re){return K[re]})}var D=/\/+/g;function W(F,K){return typeof F=="object"&&F!==null&&F.key!=null?O(""+F.key):K.toString(36)}function z(F,K,re,G,q){var Y=typeof F;(Y==="undefined"||Y==="boolean")&&(F=null);var Q=!1;if(F===null)Q=!0;else switch(Y){case"string":case"number":Q=!0;break;case"object":switch(F.$$typeof){case e:case t:Q=!0}}if(Q)return Q=F,q=q(Q),F=G===""?"."+W(Q,0):G,j(q)?(re="",F!=null&&(re=F.replace(D,"$&/")+"/"),z(q,K,re,"",function(se){return se})):q!=null&&(P(q)&&(q=L(q,re+(!q.key||Q&&Q.key===q.key?"":(""+q.key).replace(D,"$&/")+"/")+F)),K.push(q)),1;if(Q=0,G=G===""?".":G+":",j(F))for(var ee=0;ee<F.length;ee++){Y=F[ee];var J=G+W(Y,ee);Q+=z(Y,K,re,J,q)}else if(J=g(F),typeof J=="function")for(F=J.call(F),ee=0;!(Y=F.next()).done;)Y=Y.value,J=G+W(Y,ee++),Q+=z(Y,K,re,J,q);else if(Y==="object")throw K=String(F),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return Q}function R(F,K,re){if(F==null)return F;var G=[],q=0;return z(F,G,"","",function(Y){return K.call(re,Y,q++)}),G}function U(F){if(F._status===-1){var K=F._result;K=K(),K.then(function(re){(F._status===0||F._status===-1)&&(F._status=1,F._result=re)},function(re){(F._status===0||F._status===-1)&&(F._status=2,F._result=re)}),F._status===-1&&(F._status=0,F._result=K)}if(F._status===1)return F._result.default;throw F._result}var V={current:null},B={transition:null},X={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:B,ReactCurrentOwner:M};function H(){throw Error("act(...) is not supported in production builds of React.")}return wt.Children={map:R,forEach:function(F,K,re){R(F,function(){K.apply(this,arguments)},re)},count:function(F){var K=0;return R(F,function(){K++}),K},toArray:function(F){return R(F,function(K){return K})||[]},only:function(F){if(!P(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},wt.Component=x,wt.Fragment=n,wt.Profiler=l,wt.PureComponent=E,wt.StrictMode=s,wt.Suspense=d,wt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,wt.act=H,wt.cloneElement=function(F,K,re){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var G=y({},F.props),q=F.key,Y=F.ref,Q=F._owner;if(K!=null){if(K.ref!==void 0&&(Y=K.ref,Q=M.current),K.key!==void 0&&(q=""+K.key),F.type&&F.type.defaultProps)var ee=F.type.defaultProps;for(J in K)S.call(K,J)&&!$.hasOwnProperty(J)&&(G[J]=K[J]===void 0&&ee!==void 0?ee[J]:K[J])}var J=arguments.length-2;if(J===1)G.children=re;else if(1<J){ee=Array(J);for(var se=0;se<J;se++)ee[se]=arguments[se+2];G.children=ee}return{$$typeof:e,type:F.type,key:q,ref:Y,props:G,_owner:Q}},wt.createContext=function(F){return F={$$typeof:c,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:i,_context:F},F.Consumer=F},wt.createElement=T,wt.createFactory=function(F){var K=T.bind(null,F);return K.type=F,K},wt.createRef=function(){return{current:null}},wt.forwardRef=function(F){return{$$typeof:u,render:F}},wt.isValidElement=P,wt.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:U}},wt.memo=function(F,K){return{$$typeof:p,type:F,compare:K===void 0?null:K}},wt.startTransition=function(F){var K=B.transition;B.transition={};try{F()}finally{B.transition=K}},wt.unstable_act=H,wt.useCallback=function(F,K){return V.current.useCallback(F,K)},wt.useContext=function(F){return V.current.useContext(F)},wt.useDebugValue=function(){},wt.useDeferredValue=function(F){return V.current.useDeferredValue(F)},wt.useEffect=function(F,K){return V.current.useEffect(F,K)},wt.useId=function(){return V.current.useId()},wt.useImperativeHandle=function(F,K,re){return V.current.useImperativeHandle(F,K,re)},wt.useInsertionEffect=function(F,K){return V.current.useInsertionEffect(F,K)},wt.useLayoutEffect=function(F,K){return V.current.useLayoutEffect(F,K)},wt.useMemo=function(F,K){return V.current.useMemo(F,K)},wt.useReducer=function(F,K,re){return V.current.useReducer(F,K,re)},wt.useRef=function(F){return V.current.useRef(F)},wt.useState=function(F){return V.current.useState(F)},wt.useSyncExternalStore=function(F,K,re){return V.current.useSyncExternalStore(F,K,re)},wt.useTransition=function(){return V.current.useTransition()},wt.version="18.3.1",wt}el.exports=uj();var v=el.exports;const be=gn(v);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function dj(){if(R_)return Pn;R_=1;var e=v,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(u,d,p){var h,f={},g=null,w=null;p!==void 0&&(g=""+p),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(w=d.ref);for(h in d)s.call(d,h)&&!i.hasOwnProperty(h)&&(f[h]=d[h]);if(u&&u.defaultProps)for(h in d=u.defaultProps,d)f[h]===void 0&&(f[h]=d[h]);return{$$typeof:t,type:u,key:g,ref:w,props:f,_owner:l.current}}return Pn.Fragment=n,Pn.jsx=c,Pn.jsxs=c,Pn}On.exports=dj();var a=On.exports,Yf={},F_={exports:{}},Ks={},Gf={exports:{}},Qf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_;function mj(){return I_||(I_=1,function(e){function t(B,X){var H=B.length;B.push(X);e:for(;0<H;){var F=H-1>>>1,K=B[F];if(0<l(K,X))B[F]=X,B[H]=K,H=F;else break e}}function n(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var X=B[0],H=B.pop();if(H!==X){B[0]=H;e:for(var F=0,K=B.length,re=K>>>1;F<re;){var G=2*(F+1)-1,q=B[G],Y=G+1,Q=B[Y];if(0>l(q,H))Y<K&&0>l(Q,q)?(B[F]=Q,B[Y]=H,F=Y):(B[F]=q,B[G]=H,F=G);else if(Y<K&&0>l(Q,H))B[F]=Q,B[Y]=H,F=Y;else break e}}return X}function l(B,X){var H=B.sortIndex-X.sortIndex;return H!==0?H:B.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],p=[],h=1,f=null,g=3,w=!1,y=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(B){for(var X=n(p);X!==null;){if(X.callback===null)s(p);else if(X.startTime<=B)s(p),X.sortIndex=X.expirationTime,t(d,X);else break;X=n(p)}}function j(B){if(b=!1,k(B),!y)if(n(d)!==null)y=!0,U(S);else{var X=n(p);X!==null&&V(j,X.startTime-B)}}function S(B,X){y=!1,b&&(b=!1,N(T),T=-1),w=!0;var H=g;try{for(k(X),f=n(d);f!==null&&(!(f.expirationTime>X)||B&&!O());){var F=f.callback;if(typeof F=="function"){f.callback=null,g=f.priorityLevel;var K=F(f.expirationTime<=X);X=e.unstable_now(),typeof K=="function"?f.callback=K:f===n(d)&&s(d),k(X)}else s(d);f=n(d)}if(f!==null)var re=!0;else{var G=n(p);G!==null&&V(j,G.startTime-X),re=!1}return re}finally{f=null,g=H,w=!1}}var M=!1,$=null,T=-1,L=5,P=-1;function O(){return!(e.unstable_now()-P<L)}function D(){if($!==null){var B=e.unstable_now();P=B;var X=!0;try{X=$(!0,B)}finally{X?W():(M=!1,$=null)}}else M=!1}var W;if(typeof E=="function")W=function(){E(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,R=z.port2;z.port1.onmessage=D,W=function(){R.postMessage(null)}}else W=function(){x(D,0)};function U(B){$=B,M||(M=!0,W())}function V(B,X){T=x(function(){B(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){y||w||(y=!0,U(S))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(B){switch(g){case 1:case 2:case 3:var X=3;break;default:X=g}var H=g;g=X;try{return B()}finally{g=H}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,X){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var H=g;g=B;try{return X()}finally{g=H}},e.unstable_scheduleCallback=function(B,X,H){var F=e.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?F+H:F):H=F,B){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=H+K,B={id:h++,callback:X,priorityLevel:B,startTime:H,expirationTime:K,sortIndex:-1},H>F?(B.sortIndex=H,t(p,B),n(d)===null&&B===n(p)&&(b?(N(T),T=-1):b=!0,V(j,H-F))):(B.sortIndex=K,t(d,B),y||w||(y=!0,U(S))),B},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(B){var X=g;return function(){var H=g;g=X;try{return B.apply(this,arguments)}finally{g=H}}}}(Qf)),Qf}var B_;function hj(){return B_||(B_=1,Gf.exports=mj()),Gf.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var U_;function fj(){if(U_)return Ks;U_=1;var e=v,t=hj();function n(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,m=1;m<arguments.length;m++)o+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,l={};function i(r,o){c(r,o),c(r+"Capture",o)}function c(r,o){for(l[r]=o,r=0;r<o.length;r++)s.add(o[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(r){return d.call(f,r)?!0:d.call(h,r)?!1:p.test(r)?f[r]=!0:(h[r]=!0,!1)}function w(r,o,m,_){if(m!==null&&m.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return _?!1:m!==null?!m.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function y(r,o,m,_){if(o===null||typeof o>"u"||w(r,o,m,_))return!0;if(_)return!1;if(m!==null)switch(m.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function b(r,o,m,_,C,A,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=_,this.attributeNamespace=C,this.mustUseProperty=m,this.propertyName=r,this.type=o,this.sanitizeURL=A,this.removeEmptyString=I}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){x[r]=new b(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];x[o]=new b(o,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){x[r]=new b(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){x[r]=new b(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){x[r]=new b(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){x[r]=new b(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){x[r]=new b(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){x[r]=new b(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){x[r]=new b(r,5,!1,r.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function E(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(N,E);x[o]=new b(o,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(N,E);x[o]=new b(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(N,E);x[o]=new b(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){x[r]=new b(r,1,!1,r.toLowerCase(),null,!1,!1)}),x.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){x[r]=new b(r,1,!1,r.toLowerCase(),null,!0,!0)});function k(r,o,m,_){var C=x.hasOwnProperty(o)?x[o]:null;(C!==null?C.type!==0:_||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(y(o,m,C,_)&&(m=null),_||C===null?g(o)&&(m===null?r.removeAttribute(o):r.setAttribute(o,""+m)):C.mustUseProperty?r[C.propertyName]=m===null?C.type===3?!1:"":m:(o=C.attributeName,_=C.attributeNamespace,m===null?r.removeAttribute(o):(C=C.type,m=C===3||C===4&&m===!0?"":""+m,_?r.setAttributeNS(_,o,m):r.setAttribute(o,m))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),M=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),O=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),B=Symbol.iterator;function X(r){return r===null||typeof r!="object"?null:(r=B&&r[B]||r["@@iterator"],typeof r=="function"?r:null)}var H=Object.assign,F;function K(r){if(F===void 0)try{throw Error()}catch(m){var o=m.stack.trim().match(/\n( *(at )?)/);F=o&&o[1]||""}return`
`+F+r}var re=!1;function G(r,o){if(!r||re)return"";re=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(fe){var _=fe}Reflect.construct(r,[],o)}else{try{o.call()}catch(fe){_=fe}r.call(o.prototype)}else{try{throw Error()}catch(fe){_=fe}r()}}catch(fe){if(fe&&_&&typeof fe.stack=="string"){for(var C=fe.stack.split(`
`),A=_.stack.split(`
`),I=C.length-1,te=A.length-1;1<=I&&0<=te&&C[I]!==A[te];)te--;for(;1<=I&&0<=te;I--,te--)if(C[I]!==A[te]){if(I!==1||te!==1)do if(I--,te--,0>te||C[I]!==A[te]){var ae=`
`+C[I].replace(" at new "," at ");return r.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",r.displayName)),ae}while(1<=I&&0<=te);break}}}finally{re=!1,Error.prepareStackTrace=m}return(r=r?r.displayName||r.name:"")?K(r):""}function q(r){switch(r.tag){case 5:return K(r.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return r=G(r.type,!1),r;case 11:return r=G(r.type.render,!1),r;case 1:return r=G(r.type,!0),r;default:return""}}function Y(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case $:return"Fragment";case M:return"Portal";case L:return"Profiler";case T:return"StrictMode";case W:return"Suspense";case z:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case O:return(r.displayName||"Context")+".Consumer";case P:return(r._context.displayName||"Context")+".Provider";case D:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case R:return o=r.displayName||null,o!==null?o:Y(r.type)||"Memo";case U:o=r._payload,r=r._init;try{return Y(r(o))}catch{}}return null}function Q(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(o);case 8:return o===T?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ee(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function J(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function se(r){var o=J(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),_=""+r[o];if(!r.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var C=m.get,A=m.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return C.call(this)},set:function(I){_=""+I,A.call(this,I)}}),Object.defineProperty(r,o,{enumerable:m.enumerable}),{getValue:function(){return _},setValue:function(I){_=""+I},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function ke(r){r._valueTracker||(r._valueTracker=se(r))}function Pe(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var m=o.getValue(),_="";return r&&(_=J(r)?r.checked?"true":"false":r.value),r=_,r!==m?(o.setValue(r),!0):!1}function De(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Be(r,o){var m=o.checked;return H({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??r._wrapperState.initialChecked})}function mt(r,o){var m=o.defaultValue==null?"":o.defaultValue,_=o.checked!=null?o.checked:o.defaultChecked;m=ee(o.value!=null?o.value:m),r._wrapperState={initialChecked:_,initialValue:m,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Ge(r,o){o=o.checked,o!=null&&k(r,"checked",o,!1)}function ue(r,o){Ge(r,o);var m=ee(o.value),_=o.type;if(m!=null)_==="number"?(m===0&&r.value===""||r.value!=m)&&(r.value=""+m):r.value!==""+m&&(r.value=""+m);else if(_==="submit"||_==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?Me(r,o.type,m):o.hasOwnProperty("defaultValue")&&Me(r,o.type,ee(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function ye(r,o,m){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var _=o.type;if(!(_!=="submit"&&_!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,m||o===r.value||(r.value=o),r.defaultValue=o}m=r.name,m!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,m!==""&&(r.name=m)}function Me(r,o,m){(o!=="number"||De(r.ownerDocument)!==r)&&(m==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+m&&(r.defaultValue=""+m))}var Le=Array.isArray;function Ve(r,o,m,_){if(r=r.options,o){o={};for(var C=0;C<m.length;C++)o["$"+m[C]]=!0;for(m=0;m<r.length;m++)C=o.hasOwnProperty("$"+r[m].value),r[m].selected!==C&&(r[m].selected=C),C&&_&&(r[m].defaultSelected=!0)}else{for(m=""+ee(m),o=null,C=0;C<r.length;C++){if(r[C].value===m){r[C].selected=!0,_&&(r[C].defaultSelected=!0);return}o!==null||r[C].disabled||(o=r[C])}o!==null&&(o.selected=!0)}}function ce(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return H({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Fe(r,o){var m=o.value;if(m==null){if(m=o.children,o=o.defaultValue,m!=null){if(o!=null)throw Error(n(92));if(Le(m)){if(1<m.length)throw Error(n(93));m=m[0]}o=m}o==null&&(o=""),m=o}r._wrapperState={initialValue:ee(m)}}function et(r,o){var m=ee(o.value),_=ee(o.defaultValue);m!=null&&(m=""+m,m!==r.value&&(r.value=m),o.defaultValue==null&&r.defaultValue!==m&&(r.defaultValue=m)),_!=null&&(r.defaultValue=""+_)}function it(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function at(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xt(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?at(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var ot,$e=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,m,_,C){MSApp.execUnsafeLocalFunction(function(){return r(o,m,_,C)})}:r}(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for(ot=ot||document.createElement("div"),ot.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=ot.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function je(r,o){if(o){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=o;return}}r.textContent=o}var Vt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tt=["Webkit","ms","Moz","O"];Object.keys(Vt).forEach(function(r){tt.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),Vt[o]=Vt[r]})});function Wt(r,o,m){return o==null||typeof o=="boolean"||o===""?"":m||typeof o!="number"||o===0||Vt.hasOwnProperty(r)&&Vt[r]?(""+o).trim():o+"px"}function ct(r,o){r=r.style;for(var m in o)if(o.hasOwnProperty(m)){var _=m.indexOf("--")===0,C=Wt(m,o[m],_);m==="float"&&(m="cssFloat"),_?r.setProperty(m,C):r[m]=C}}var Rt=H({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function mn(r,o){if(o){if(Rt[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function $n(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ft=null;function ln(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Hn=null,Gt=null,_t=null;function es(r){if(r=Fo(r)){if(typeof Hn!="function")throw Error(n(280));var o=r.stateNode;o&&(o=Yl(o),Hn(r.stateNode,r.type,o))}}function cn(r){Gt?_t?_t.push(r):_t=[r]:Gt=r}function En(){if(Gt){var r=Gt,o=_t;if(_t=Gt=null,es(r),o)for(r=0;r<o.length;r++)es(o[r])}}function yt(r,o){return r(o)}function Zs(){}var nn=!1;function jt(r,o,m){if(nn)return r(o,m);nn=!0;try{return yt(r,o,m)}finally{nn=!1,(Gt!==null||_t!==null)&&(Zs(),En())}}function kt(r,o){var m=r.stateNode;if(m===null)return null;var _=Yl(m);if(_===null)return null;m=_[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(_=!_.disabled)||(r=r.type,_=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!_;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(n(231,o,typeof m));return m}var Cs=!1;if(u)try{var vn={};Object.defineProperty(vn,"passive",{get:function(){Cs=!0}}),window.addEventListener("test",vn,vn),window.removeEventListener("test",vn,vn)}catch{Cs=!1}function Ln(r,o,m,_,C,A,I,te,ae){var fe=Array.prototype.slice.call(arguments,3);try{o.apply(m,fe)}catch(Se){this.onError(Se)}}var yn=!1,Vn=null,bn=!1,Ss=null,Yt={onError:function(r){yn=!0,Vn=r}};function ts(r,o,m,_,C,A,I,te,ae){yn=!1,Vn=null,Ln.apply(Yt,arguments)}function Wn(r,o,m,_,C,A,I,te,ae){if(ts.apply(this,arguments),yn){if(yn){var fe=Vn;yn=!1,Vn=null}else throw Error(n(198));bn||(bn=!0,Ss=fe)}}function zn(r){var o=r,m=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,o.flags&4098&&(m=o.return),r=o.return;while(r)}return o.tag===3?m:null}function Tr(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function fs(r){if(zn(r)!==r)throw Error(n(188))}function er(r){var o=r.alternate;if(!o){if(o=zn(r),o===null)throw Error(n(188));return o!==r?null:r}for(var m=r,_=o;;){var C=m.return;if(C===null)break;var A=C.alternate;if(A===null){if(_=C.return,_!==null){m=_;continue}break}if(C.child===A.child){for(A=C.child;A;){if(A===m)return fs(C),r;if(A===_)return fs(C),o;A=A.sibling}throw Error(n(188))}if(m.return!==_.return)m=C,_=A;else{for(var I=!1,te=C.child;te;){if(te===m){I=!0,m=C,_=A;break}if(te===_){I=!0,_=C,m=A;break}te=te.sibling}if(!I){for(te=A.child;te;){if(te===m){I=!0,m=A,_=C;break}if(te===_){I=!0,_=A,m=C;break}te=te.sibling}if(!I)throw Error(n(189))}}if(m.alternate!==_)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?r:o}function Rs(r){return r=er(r),r!==null?Fs(r):null}function Fs(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=Fs(r);if(o!==null)return o;r=r.sibling}return null}var yr=t.unstable_scheduleCallback,ps=t.unstable_cancelCallback,rn=t.unstable_shouldYield,It=t.unstable_requestPaint,ht=t.unstable_now,$r=t.unstable_getCurrentPriorityLevel,ns=t.unstable_ImmediatePriority,br=t.unstable_UserBlockingPriority,Es=t.unstable_NormalPriority,Jr=t.unstable_LowPriority,le=t.unstable_IdlePriority,xe=null,Ue=null;function $t(r){if(Ue&&typeof Ue.onCommitFiberRoot=="function")try{Ue.onCommitFiberRoot(xe,r,void 0,(r.current.flags&128)===128)}catch{}}var Ee=Math.clz32?Math.clz32:Kt,ut=Math.log,gt=Math.LN2;function Kt(r){return r>>>=0,r===0?32:31-(ut(r)/gt|0)|0}var Bt=64,hn=4194304;function Qt(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function xn(r,o){var m=r.pendingLanes;if(m===0)return 0;var _=0,C=r.suspendedLanes,A=r.pingedLanes,I=m&268435455;if(I!==0){var te=I&~C;te!==0?_=Qt(te):(A&=I,A!==0&&(_=Qt(A)))}else I=m&~C,I!==0?_=Qt(I):A!==0&&(_=Qt(A));if(_===0)return 0;if(o!==0&&o!==_&&!(o&C)&&(C=_&-_,A=o&-o,C>=A||C===16&&(A&4194240)!==0))return o;if(_&4&&(_|=m&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=_;0<o;)m=31-Ee(o),C=1<<m,_|=r[m],o&=~C;return _}function tr(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gs(r,o){for(var m=r.suspendedLanes,_=r.pingedLanes,C=r.expirationTimes,A=r.pendingLanes;0<A;){var I=31-Ee(A),te=1<<I,ae=C[I];ae===-1?(!(te&m)||te&_)&&(C[I]=tr(te,o)):ae<=o&&(r.expiredLanes|=te),A&=~te}}function Dn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Kn(){var r=Bt;return Bt<<=1,!(Bt&4194240)&&(Bt=64),r}function ks(r){for(var o=[],m=0;31>m;m++)o.push(r);return o}function _s(r,o,m){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-Ee(o),r[o]=m}function Co(r,o){var m=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var _=r.eventTimes;for(r=r.expirationTimes;0<m;){var C=31-Ee(m),A=1<<C;o[C]=0,_[C]=-1,r[C]=-1,m&=~A}}function Al(r,o){var m=r.entangledLanes|=o;for(r=r.entanglements;m;){var _=31-Ee(m),C=1<<_;C&o|r[_]&o&&(r[_]|=o),m&=~C}}var Ct=0;function Ui(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Ol,Pl,qi,Hi,Tl,So=!1,Ms=[],xr=null,Z=null,ge=null,he=new Map,ze=new Map,Oe=[],Ce="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function lt(r,o){switch(r){case"focusin":case"focusout":xr=null;break;case"dragenter":case"dragleave":Z=null;break;case"mouseover":case"mouseout":ge=null;break;case"pointerover":case"pointerout":he.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ze.delete(o.pointerId)}}function Ke(r,o,m,_,C,A){return r===null||r.nativeEvent!==A?(r={blockedOn:o,domEventName:m,eventSystemFlags:_,nativeEvent:A,targetContainers:[C]},o!==null&&(o=Fo(o),o!==null&&Pl(o)),r):(r.eventSystemFlags|=_,o=r.targetContainers,C!==null&&o.indexOf(C)===-1&&o.push(C),r)}function vt(r,o,m,_,C){switch(o){case"focusin":return xr=Ke(xr,r,o,m,_,C),!0;case"dragenter":return Z=Ke(Z,r,o,m,_,C),!0;case"mouseover":return ge=Ke(ge,r,o,m,_,C),!0;case"pointerover":var A=C.pointerId;return he.set(A,Ke(he.get(A)||null,r,o,m,_,C)),!0;case"gotpointercapture":return A=C.pointerId,ze.set(A,Ke(ze.get(A)||null,r,o,m,_,C)),!0}return!1}function ft(r){var o=qa(r.target);if(o!==null){var m=zn(o);if(m!==null){if(o=m.tag,o===13){if(o=Tr(m),o!==null){r.blockedOn=o,Tl(r.priority,function(){qi(m)});return}}else if(o===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function nt(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var m=Is(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(m===null){m=r.nativeEvent;var _=new m.constructor(m.type,m);Ft=_,m.target.dispatchEvent(_),Ft=null}else return o=Fo(m),o!==null&&Pl(o),r.blockedOn=m,!1;o.shift()}return!0}function Pt(r,o,m){nt(r)&&m.delete(o)}function Yn(){So=!1,xr!==null&&nt(xr)&&(xr=null),Z!==null&&nt(Z)&&(Z=null),ge!==null&&nt(ge)&&(ge=null),he.forEach(Pt),ze.forEach(Pt)}function Xt(r,o){r.blockedOn===o&&(r.blockedOn=null,So||(So=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Yn)))}function Rn(r){function o(C){return Xt(C,r)}if(0<Ms.length){Xt(Ms[0],r);for(var m=1;m<Ms.length;m++){var _=Ms[m];_.blockedOn===r&&(_.blockedOn=null)}}for(xr!==null&&Xt(xr,r),Z!==null&&Xt(Z,r),ge!==null&&Xt(ge,r),he.forEach(o),ze.forEach(o),m=0;m<Oe.length;m++)_=Oe[m],_.blockedOn===r&&(_.blockedOn=null);for(;0<Oe.length&&(m=Oe[0],m.blockedOn===null);)ft(m),m.blockedOn===null&&Oe.shift()}var nr=j.ReactCurrentBatchConfig,sr=!0;function wr(r,o,m,_){var C=Ct,A=nr.transition;nr.transition=null;try{Ct=1,Lr(r,o,m,_)}finally{Ct=C,nr.transition=A}}function ga(r,o,m,_){var C=Ct,A=nr.transition;nr.transition=null;try{Ct=4,Lr(r,o,m,_)}finally{Ct=C,nr.transition=A}}function Lr(r,o,m,_){if(sr){var C=Is(r,o,m,_);if(C===null)qu(r,o,_,vs,m),lt(r,_);else if(vt(C,r,o,m,_))_.stopPropagation();else if(lt(r,_),o&4&&-1<Ce.indexOf(r)){for(;C!==null;){var A=Fo(C);if(A!==null&&Ol(A),A=Is(r,o,m,_),A===null&&qu(r,o,_,vs,m),A===C)break;C=A}C!==null&&_.stopPropagation()}else qu(r,o,_,null,m)}}var vs=null;function Is(r,o,m,_){if(vs=null,r=ln(_),r=qa(r),r!==null)if(o=zn(r),o===null)r=null;else if(m=o.tag,m===13){if(r=Tr(o),r!==null)return r;r=null}else if(m===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return vs=r,null}function Eo(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($r()){case ns:return 1;case br:return 4;case Es:case Jr:return 16;case le:return 536870912;default:return 16}default:return 16}}var rr=null,ko=null,Da=null;function Mo(){if(Da)return Da;var r,o=ko,m=o.length,_,C="value"in rr?rr.value:rr.textContent,A=C.length;for(r=0;r<m&&o[r]===C[r];r++);var I=m-r;for(_=1;_<=I&&o[m-_]===C[A-_];_++);return Da=C.slice(r,1<_?1-_:void 0)}function Ao(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Oo(){return!0}function Po(){return!1}function Gn(r){function o(m,_,C,A,I){this._reactName=m,this._targetInst=C,this.type=_,this.nativeEvent=A,this.target=I,this.currentTarget=null;for(var te in r)r.hasOwnProperty(te)&&(m=r[te],this[te]=m?m(A):A[te]);return this.isDefaultPrevented=(A.defaultPrevented!=null?A.defaultPrevented:A.returnValue===!1)?Oo:Po,this.isPropagationStopped=Po,this}return H(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Oo)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Oo)},persist:function(){},isPersistent:Oo}),o}var un={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},To=Gn(un),Ra=H({},un,{view:0,detail:0}),ju=Gn(Ra),$l,dn,Fn,As=H({},Ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ku,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Fn&&(Fn&&r.type==="mousemove"?($l=r.screenX-Fn.screenX,dn=r.screenY-Fn.screenY):dn=$l=0,Fn=r),$l)},movementY:function(r){return"movementY"in r?r.movementY:dn}}),Vi=Gn(As),Hg=H({},As,{dataTransfer:0}),Vg=Gn(Hg),Wg=H({},Ra,{relatedTarget:0}),Nu=Gn(Wg),Cu=H({},un,{animationName:0,elapsedTime:0,pseudoElement:0}),Su=Gn(Cu),Qm=H({},un,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),Xm=Gn(Qm),Jm=H({},un,{data:0}),Eu=Gn(Jm),Xe={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},In={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Zm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Kg(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Zm[r])?!!o[r]:!1}function ku(){return Kg}var Yg=H({},Ra,{key:function(r){if(r.key){var o=Xe[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Ao(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?In[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ku,charCode:function(r){return r.type==="keypress"?Ao(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ao(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),eh=Gn(Yg),th=H({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mu=Gn(th),Gg=H({},Ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ku}),Wi=Gn(Gg),Qg=H({},un,{propertyName:0,elapsedTime:0,pseudoElement:0}),nh=Gn(Qg),Bs=H({},As,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),sh=Gn(Bs),Xg=[9,13,27,32],Fa=u&&"CompositionEvent"in window,$o=null;u&&"documentMode"in document&&($o=document.documentMode);var bt=u&&"TextEvent"in window&&!$o,rh=u&&(!Fa||$o&&8<$o&&11>=$o),ah=" ",Ll=!1;function Ki(r,o){switch(r){case"keyup":return Xg.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Au(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Ia=!1;function oh(r,o){switch(r){case"compositionend":return Au(o);case"keypress":return o.which!==32?null:(Ll=!0,ah);case"textInput":return r=o.data,r===ah&&Ll?null:r;default:return null}}function zl(r,o){if(Ia)return r==="compositionend"||!Fa&&Ki(r,o)?(r=Mo(),Da=ko=rr=null,Ia=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return rh&&o.locale!=="ko"?null:o.data;default:return null}}var lh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ih(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!lh[r.type]:o==="textarea"}function Ou(r,o,m,_){cn(_),o=tc(o,"onChange"),0<o.length&&(m=new To("onChange","change",null,m,_),r.push({event:m,listeners:o}))}var Dl=null,Rl=null;function Jg(r){wh(r,0)}function Yi(r){var o=Ha(r);if(Pe(o))return r}function Zg(r,o){if(r==="change")return o}var ss=!1;if(u){var Fl;if(u){var Lo="oninput"in document;if(!Lo){var Gi=document.createElement("div");Gi.setAttribute("oninput","return;"),Lo=typeof Gi.oninput=="function"}Fl=Lo}else Fl=!1;ss=Fl&&(!document.documentMode||9<document.documentMode)}function zo(){Dl&&(Dl.detachEvent("onpropertychange",Qi),Rl=Dl=null)}function Qi(r){if(r.propertyName==="value"&&Yi(Rl)){var o=[];Ou(o,Rl,r,ln(r)),jt(Jg,o)}}function Ba(r,o,m){r==="focusin"?(zo(),Dl=o,Rl=m,Dl.attachEvent("onpropertychange",Qi)):r==="focusout"&&zo()}function ch(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Yi(Rl)}function Pu(r,o){if(r==="click")return Yi(o)}function uh(r,o){if(r==="input"||r==="change")return Yi(o)}function dh(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var jr=typeof Object.is=="function"?Object.is:dh;function Il(r,o){if(jr(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var m=Object.keys(r),_=Object.keys(o);if(m.length!==_.length)return!1;for(_=0;_<m.length;_++){var C=m[_];if(!d.call(o,C)||!jr(r[C],o[C]))return!1}return!0}function mh(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Tu(r,o){var m=mh(r);r=0;for(var _;m;){if(m.nodeType===3){if(_=r+m.textContent.length,r<=o&&_>=o)return{node:m,offset:o-r};r=_}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=mh(m)}}function $u(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?$u(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function Lu(){for(var r=window,o=De();o instanceof r.HTMLIFrameElement;){try{var m=typeof o.contentWindow.location.href=="string"}catch{m=!1}if(m)r=o.contentWindow;else break;o=De(r.document)}return o}function Bl(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function hh(r){var o=Lu(),m=r.focusedElem,_=r.selectionRange;if(o!==m&&m&&m.ownerDocument&&$u(m.ownerDocument.documentElement,m)){if(_!==null&&Bl(m)){if(o=_.start,r=_.end,r===void 0&&(r=o),"selectionStart"in m)m.selectionStart=o,m.selectionEnd=Math.min(r,m.value.length);else if(r=(o=m.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var C=m.textContent.length,A=Math.min(_.start,C);_=_.end===void 0?A:Math.min(_.end,C),!r.extend&&A>_&&(C=_,_=A,A=C),C=Tu(m,A);var I=Tu(m,_);C&&I&&(r.rangeCount!==1||r.anchorNode!==C.node||r.anchorOffset!==C.offset||r.focusNode!==I.node||r.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(C.node,C.offset),r.removeAllRanges(),A>_?(r.addRange(o),r.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),r.addRange(o)))}}for(o=[],r=m;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<o.length;m++)r=o[m],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var fh=u&&"documentMode"in document&&11>=document.documentMode,Zr=null,Xi=null,Ul=null,zu=!1;function Du(r,o,m){var _=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;zu||Zr==null||Zr!==De(_)||(_=Zr,"selectionStart"in _&&Bl(_)?_={start:_.selectionStart,end:_.selectionEnd}:(_=(_.ownerDocument&&_.ownerDocument.defaultView||window).getSelection(),_={anchorNode:_.anchorNode,anchorOffset:_.anchorOffset,focusNode:_.focusNode,focusOffset:_.focusOffset}),Ul&&Il(Ul,_)||(Ul=_,_=tc(Xi,"onSelect"),0<_.length&&(o=new To("onSelect","select",null,o,m),r.push({event:o,listeners:_}),o.target=Zr)))}function Ji(r,o){var m={};return m[r.toLowerCase()]=o.toLowerCase(),m["Webkit"+r]="webkit"+o,m["Moz"+r]="moz"+o,m}var Do={animationend:Ji("Animation","AnimationEnd"),animationiteration:Ji("Animation","AnimationIteration"),animationstart:Ji("Animation","AnimationStart"),transitionend:Ji("Transition","TransitionEnd")},Ru={},ph={};u&&(ph=document.createElement("div").style,"AnimationEvent"in window||(delete Do.animationend.animation,delete Do.animationiteration.animation,delete Do.animationstart.animation),"TransitionEvent"in window||delete Do.transitionend.transition);function Zi(r){if(Ru[r])return Ru[r];if(!Do[r])return r;var o=Do[r],m;for(m in o)if(o.hasOwnProperty(m)&&m in ph)return Ru[r]=o[m];return r}var gh=Zi("animationend"),_h=Zi("animationiteration"),vh=Zi("animationstart"),Fu=Zi("transitionend"),yh=new Map,bh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function _a(r,o){yh.set(r,o),i(o,[r])}for(var Iu=0;Iu<bh.length;Iu++){var Bu=bh[Iu],e_=Bu.toLowerCase(),t_=Bu[0].toUpperCase()+Bu.slice(1);_a(e_,"on"+t_)}_a(gh,"onAnimationEnd"),_a(_h,"onAnimationIteration"),_a(vh,"onAnimationStart"),_a("dblclick","onDoubleClick"),_a("focusin","onFocus"),_a("focusout","onBlur"),_a(Fu,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ql="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),n_=new Set("cancel close invalid load scroll toggle".split(" ").concat(ql));function xh(r,o,m){var _=r.type||"unknown-event";r.currentTarget=m,Wn(_,o,void 0,r),r.currentTarget=null}function wh(r,o){o=(o&4)!==0;for(var m=0;m<r.length;m++){var _=r[m],C=_.event;_=_.listeners;e:{var A=void 0;if(o)for(var I=_.length-1;0<=I;I--){var te=_[I],ae=te.instance,fe=te.currentTarget;if(te=te.listener,ae!==A&&C.isPropagationStopped())break e;xh(C,te,fe),A=ae}else for(I=0;I<_.length;I++){if(te=_[I],ae=te.instance,fe=te.currentTarget,te=te.listener,ae!==A&&C.isPropagationStopped())break e;xh(C,te,fe),A=ae}}}if(bn)throw r=Ss,bn=!1,Ss=null,r}function Zt(r,o){var m=o[Ku];m===void 0&&(m=o[Ku]=new Set);var _=r+"__bubble";m.has(_)||(jh(o,r,2,!1),m.add(_))}function Uu(r,o,m){var _=0;o&&(_|=4),jh(m,r,_,o)}var ec="_reactListening"+Math.random().toString(36).slice(2);function Hl(r){if(!r[ec]){r[ec]=!0,s.forEach(function(m){m!=="selectionchange"&&(n_.has(m)||Uu(m,!1,r),Uu(m,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[ec]||(o[ec]=!0,Uu("selectionchange",!1,o))}}function jh(r,o,m,_){switch(Eo(o)){case 1:var C=wr;break;case 4:C=ga;break;default:C=Lr}m=C.bind(null,o,m,r),C=void 0,!Cs||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(C=!0),_?C!==void 0?r.addEventListener(o,m,{capture:!0,passive:C}):r.addEventListener(o,m,!0):C!==void 0?r.addEventListener(o,m,{passive:C}):r.addEventListener(o,m,!1)}function qu(r,o,m,_,C){var A=_;if(!(o&1)&&!(o&2)&&_!==null)e:for(;;){if(_===null)return;var I=_.tag;if(I===3||I===4){var te=_.stateNode.containerInfo;if(te===C||te.nodeType===8&&te.parentNode===C)break;if(I===4)for(I=_.return;I!==null;){var ae=I.tag;if((ae===3||ae===4)&&(ae=I.stateNode.containerInfo,ae===C||ae.nodeType===8&&ae.parentNode===C))return;I=I.return}for(;te!==null;){if(I=qa(te),I===null)return;if(ae=I.tag,ae===5||ae===6){_=A=I;continue e}te=te.parentNode}}_=_.return}jt(function(){var fe=A,Se=ln(m),Ae=[];e:{var Ne=yh.get(r);if(Ne!==void 0){var qe=To,We=r;switch(r){case"keypress":if(Ao(m)===0)break e;case"keydown":case"keyup":qe=eh;break;case"focusin":We="focus",qe=Nu;break;case"focusout":We="blur",qe=Nu;break;case"beforeblur":case"afterblur":qe=Nu;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":qe=Vi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":qe=Vg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":qe=Wi;break;case gh:case _h:case vh:qe=Su;break;case Fu:qe=nh;break;case"scroll":qe=ju;break;case"wheel":qe=sh;break;case"copy":case"cut":case"paste":qe=Xm;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":qe=Mu}var Ye=(o&4)!==0,An=!Ye&&r==="scroll",ie=Ye?Ne!==null?Ne+"Capture":null:Ne;Ye=[];for(var oe=fe,me;oe!==null;){me=oe;var Te=me.stateNode;if(me.tag===5&&Te!==null&&(me=Te,ie!==null&&(Te=kt(oe,ie),Te!=null&&Ye.push(Vl(oe,Te,me)))),An)break;oe=oe.return}0<Ye.length&&(Ne=new qe(Ne,We,null,m,Se),Ae.push({event:Ne,listeners:Ye}))}}if(!(o&7)){e:{if(Ne=r==="mouseover"||r==="pointerover",qe=r==="mouseout"||r==="pointerout",Ne&&m!==Ft&&(We=m.relatedTarget||m.fromElement)&&(qa(We)||We[ea]))break e;if((qe||Ne)&&(Ne=Se.window===Se?Se:(Ne=Se.ownerDocument)?Ne.defaultView||Ne.parentWindow:window,qe?(We=m.relatedTarget||m.toElement,qe=fe,We=We?qa(We):null,We!==null&&(An=zn(We),We!==An||We.tag!==5&&We.tag!==6)&&(We=null)):(qe=null,We=fe),qe!==We)){if(Ye=Vi,Te="onMouseLeave",ie="onMouseEnter",oe="mouse",(r==="pointerout"||r==="pointerover")&&(Ye=Mu,Te="onPointerLeave",ie="onPointerEnter",oe="pointer"),An=qe==null?Ne:Ha(qe),me=We==null?Ne:Ha(We),Ne=new Ye(Te,oe+"leave",qe,m,Se),Ne.target=An,Ne.relatedTarget=me,Te=null,qa(Se)===fe&&(Ye=new Ye(ie,oe+"enter",We,m,Se),Ye.target=me,Ye.relatedTarget=An,Te=Ye),An=Te,qe&&We)t:{for(Ye=qe,ie=We,oe=0,me=Ye;me;me=Ro(me))oe++;for(me=0,Te=ie;Te;Te=Ro(Te))me++;for(;0<oe-me;)Ye=Ro(Ye),oe--;for(;0<me-oe;)ie=Ro(ie),me--;for(;oe--;){if(Ye===ie||ie!==null&&Ye===ie.alternate)break t;Ye=Ro(Ye),ie=Ro(ie)}Ye=null}else Ye=null;qe!==null&&Nh(Ae,Ne,qe,Ye,!1),We!==null&&An!==null&&Nh(Ae,An,We,Ye,!0)}}e:{if(Ne=fe?Ha(fe):window,qe=Ne.nodeName&&Ne.nodeName.toLowerCase(),qe==="select"||qe==="input"&&Ne.type==="file")var Qe=Zg;else if(ih(Ne))if(ss)Qe=uh;else{Qe=ch;var st=Ba}else(qe=Ne.nodeName)&&qe.toLowerCase()==="input"&&(Ne.type==="checkbox"||Ne.type==="radio")&&(Qe=Pu);if(Qe&&(Qe=Qe(r,fe))){Ou(Ae,Qe,m,Se);break e}st&&st(r,Ne,fe),r==="focusout"&&(st=Ne._wrapperState)&&st.controlled&&Ne.type==="number"&&Me(Ne,"number",Ne.value)}switch(st=fe?Ha(fe):window,r){case"focusin":(ih(st)||st.contentEditable==="true")&&(Zr=st,Xi=fe,Ul=null);break;case"focusout":Ul=Xi=Zr=null;break;case"mousedown":zu=!0;break;case"contextmenu":case"mouseup":case"dragend":zu=!1,Du(Ae,m,Se);break;case"selectionchange":if(fh)break;case"keydown":case"keyup":Du(Ae,m,Se)}var rt;if(Fa)e:{switch(r){case"compositionstart":var pt="onCompositionStart";break e;case"compositionend":pt="onCompositionEnd";break e;case"compositionupdate":pt="onCompositionUpdate";break e}pt=void 0}else Ia?Ki(r,m)&&(pt="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(pt="onCompositionStart");pt&&(rh&&m.locale!=="ko"&&(Ia||pt!=="onCompositionStart"?pt==="onCompositionEnd"&&Ia&&(rt=Mo()):(rr=Se,ko="value"in rr?rr.value:rr.textContent,Ia=!0)),st=tc(fe,pt),0<st.length&&(pt=new Eu(pt,r,null,m,Se),Ae.push({event:pt,listeners:st}),rt?pt.data=rt:(rt=Au(m),rt!==null&&(pt.data=rt)))),(rt=bt?oh(r,m):zl(r,m))&&(fe=tc(fe,"onBeforeInput"),0<fe.length&&(Se=new Eu("onBeforeInput","beforeinput",null,m,Se),Ae.push({event:Se,listeners:fe}),Se.data=rt))}wh(Ae,o)})}function Vl(r,o,m){return{instance:r,listener:o,currentTarget:m}}function tc(r,o){for(var m=o+"Capture",_=[];r!==null;){var C=r,A=C.stateNode;C.tag===5&&A!==null&&(C=A,A=kt(r,m),A!=null&&_.unshift(Vl(r,A,C)),A=kt(r,o),A!=null&&_.push(Vl(r,A,C))),r=r.return}return _}function Ro(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function Nh(r,o,m,_,C){for(var A=o._reactName,I=[];m!==null&&m!==_;){var te=m,ae=te.alternate,fe=te.stateNode;if(ae!==null&&ae===_)break;te.tag===5&&fe!==null&&(te=fe,C?(ae=kt(m,A),ae!=null&&I.unshift(Vl(m,ae,te))):C||(ae=kt(m,A),ae!=null&&I.push(Vl(m,ae,te)))),m=m.return}I.length!==0&&r.push({event:o,listeners:I})}var Ch=/\r\n?/g,s_=/\u0000|\uFFFD/g;function nc(r){return(typeof r=="string"?r:""+r).replace(Ch,`
`).replace(s_,"")}function ys(r,o,m){if(o=nc(o),nc(r)!==o&&m)throw Error(n(425))}function sc(){}var Nr=null,Wl=null;function Hu(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Vu=typeof setTimeout=="function"?setTimeout:void 0,r_=typeof clearTimeout=="function"?clearTimeout:void 0,wn=typeof Promise=="function"?Promise:void 0,Sh=typeof queueMicrotask=="function"?queueMicrotask:typeof wn<"u"?function(r){return wn.resolve(null).then(r).catch(Eh)}:Vu;function Eh(r){setTimeout(function(){throw r})}function Wu(r,o){var m=o,_=0;do{var C=m.nextSibling;if(r.removeChild(m),C&&C.nodeType===8)if(m=C.data,m==="/$"){if(_===0){r.removeChild(C),Rn(o);return}_--}else m!=="$"&&m!=="$?"&&m!=="$!"||_++;m=C}while(m);Rn(o)}function zr(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function kh(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(o===0)return r;o--}else m==="/$"&&o++}r=r.previousSibling}return null}var Ua=Math.random().toString(36).slice(2),Dr="__reactFiber$"+Ua,Kl="__reactProps$"+Ua,ea="__reactContainer$"+Ua,Ku="__reactEvents$"+Ua,Mh="__reactListeners$"+Ua,Ah="__reactHandles$"+Ua;function qa(r){var o=r[Dr];if(o)return o;for(var m=r.parentNode;m;){if(o=m[ea]||m[Dr]){if(m=o.alternate,o.child!==null||m!==null&&m.child!==null)for(r=kh(r);r!==null;){if(m=r[Dr])return m;r=kh(r)}return o}r=m,m=r.parentNode}return null}function Fo(r){return r=r[Dr]||r[ea],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Ha(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function Yl(r){return r[Kl]||null}var Yu=[],Va=-1;function ta(r){return{current:r}}function Ut(r){0>Va||(r.current=Yu[Va],Yu[Va]=null,Va--)}function Tt(r,o){Va++,Yu[Va]=r.current,r.current=o}var va={},Qn=ta(va),bs=ta(!1),Wa=va;function Ka(r,o){var m=r.type.contextTypes;if(!m)return va;var _=r.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===o)return _.__reactInternalMemoizedMaskedChildContext;var C={},A;for(A in m)C[A]=o[A];return _&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=C),C}function xs(r){return r=r.childContextTypes,r!=null}function rc(){Ut(bs),Ut(Qn)}function ac(r,o,m){if(Qn.current!==va)throw Error(n(168));Tt(Qn,o),Tt(bs,m)}function Oh(r,o,m){var _=r.stateNode;if(o=o.childContextTypes,typeof _.getChildContext!="function")return m;_=_.getChildContext();for(var C in _)if(!(C in o))throw Error(n(108,Q(r)||"Unknown",C));return H({},m,_)}function Ya(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||va,Wa=Qn.current,Tt(Qn,r),Tt(bs,bs.current),!0}function Io(r,o,m){var _=r.stateNode;if(!_)throw Error(n(169));m?(r=Oh(r,o,Wa),_.__reactInternalMemoizedMergedChildContext=r,Ut(bs),Ut(Qn),Tt(Qn,r)):Ut(bs),Tt(bs,m)}var Rr=null,oc=!1,Gu=!1;function Ph(r){Rr===null?Rr=[r]:Rr.push(r)}function a_(r){oc=!0,Ph(r)}function na(){if(!Gu&&Rr!==null){Gu=!0;var r=0,o=Ct;try{var m=Rr;for(Ct=1;r<m.length;r++){var _=m[r];do _=_(!0);while(_!==null)}Rr=null,oc=!1}catch(C){throw Rr!==null&&(Rr=Rr.slice(r+1)),yr(ns,na),C}finally{Ct=o,Gu=!1}}return null}var ya=[],Bo=0,lc=null,ic=0,ar=[],or=0,Ga=null,sa=1,ra="";function Qa(r,o){ya[Bo++]=ic,ya[Bo++]=lc,lc=r,ic=o}function Th(r,o,m){ar[or++]=sa,ar[or++]=ra,ar[or++]=Ga,Ga=r;var _=sa;r=ra;var C=32-Ee(_)-1;_&=~(1<<C),m+=1;var A=32-Ee(o)+C;if(30<A){var I=C-C%5;A=(_&(1<<I)-1).toString(32),_>>=I,C-=I,sa=1<<32-Ee(o)+C|m<<C|_,ra=A+r}else sa=1<<A|m<<C|_,ra=r}function Qu(r){r.return!==null&&(Qa(r,1),Th(r,1,0))}function Xu(r){for(;r===lc;)lc=ya[--Bo],ya[Bo]=null,ic=ya[--Bo],ya[Bo]=null;for(;r===Ga;)Ga=ar[--or],ar[or]=null,ra=ar[--or],ar[or]=null,sa=ar[--or],ar[or]=null}var Us=null,qs=null,sn=!1,Cr=null;function $h(r,o){var m=Vr(5,null,null,0);m.elementType="DELETED",m.stateNode=o,m.return=r,o=r.deletions,o===null?(r.deletions=[m],r.flags|=16):o.push(m)}function Lh(r,o){switch(r.tag){case 5:var m=r.type;return o=o.nodeType!==1||m.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,Us=r,qs=zr(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,Us=r,qs=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(m=Ga!==null?{id:sa,overflow:ra}:null,r.memoizedState={dehydrated:o,treeContext:m,retryLane:1073741824},m=Vr(18,null,null,0),m.stateNode=o,m.return=r,r.child=m,Us=r,qs=null,!0):!1;default:return!1}}function Ju(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Zu(r){if(sn){var o=qs;if(o){var m=o;if(!Lh(r,o)){if(Ju(r))throw Error(n(418));o=zr(m.nextSibling);var _=Us;o&&Lh(r,o)?$h(_,m):(r.flags=r.flags&-4097|2,sn=!1,Us=r)}}else{if(Ju(r))throw Error(n(418));r.flags=r.flags&-4097|2,sn=!1,Us=r}}}function zh(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Us=r}function cc(r){if(r!==Us)return!1;if(!sn)return zh(r),sn=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!Hu(r.type,r.memoizedProps)),o&&(o=qs)){if(Ju(r))throw Dh(),Error(n(418));for(;o;)$h(r,o),o=zr(o.nextSibling)}if(zh(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="/$"){if(o===0){qs=zr(r.nextSibling);break e}o--}else m!=="$"&&m!=="$!"&&m!=="$?"||o++}r=r.nextSibling}qs=null}}else qs=Us?zr(r.stateNode.nextSibling):null;return!0}function Dh(){for(var r=qs;r;)r=zr(r.nextSibling)}function Uo(){qs=Us=null,sn=!1}function uc(r){Cr===null?Cr=[r]:Cr.push(r)}var ed=j.ReactCurrentBatchConfig;function Gl(r,o,m){if(r=m.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(n(309));var _=m.stateNode}if(!_)throw Error(n(147,r));var C=_,A=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===A?o.ref:(o=function(I){var te=C.refs;I===null?delete te[A]:te[A]=I},o._stringRef=A,o)}if(typeof r!="string")throw Error(n(284));if(!m._owner)throw Error(n(290,r))}return r}function qo(r,o){throw r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function Rh(r){var o=r._init;return o(r._payload)}function Fh(r){function o(ie,oe){if(r){var me=ie.deletions;me===null?(ie.deletions=[oe],ie.flags|=16):me.push(oe)}}function m(ie,oe){if(!r)return null;for(;oe!==null;)o(ie,oe),oe=oe.sibling;return null}function _(ie,oe){for(ie=new Map;oe!==null;)oe.key!==null?ie.set(oe.key,oe):ie.set(oe.index,oe),oe=oe.sibling;return ie}function C(ie,oe){return ie=Xo(ie,oe),ie.index=0,ie.sibling=null,ie}function A(ie,oe,me){return ie.index=me,r?(me=ie.alternate,me!==null?(me=me.index,me<oe?(ie.flags|=2,oe):me):(ie.flags|=2,oe)):(ie.flags|=1048576,oe)}function I(ie){return r&&ie.alternate===null&&(ie.flags|=2),ie}function te(ie,oe,me,Te){return oe===null||oe.tag!==6?(oe=w_(me,ie.mode,Te),oe.return=ie,oe):(oe=C(oe,me),oe.return=ie,oe)}function ae(ie,oe,me,Te){var Qe=me.type;return Qe===$?Se(ie,oe,me.props.children,Te,me.key):oe!==null&&(oe.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===U&&Rh(Qe)===oe.type)?(Te=C(oe,me.props),Te.ref=Gl(ie,oe,me),Te.return=ie,Te):(Te=Rf(me.type,me.key,me.props,null,ie.mode,Te),Te.ref=Gl(ie,oe,me),Te.return=ie,Te)}function fe(ie,oe,me,Te){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==me.containerInfo||oe.stateNode.implementation!==me.implementation?(oe=j_(me,ie.mode,Te),oe.return=ie,oe):(oe=C(oe,me.children||[]),oe.return=ie,oe)}function Se(ie,oe,me,Te,Qe){return oe===null||oe.tag!==7?(oe=ii(me,ie.mode,Te,Qe),oe.return=ie,oe):(oe=C(oe,me),oe.return=ie,oe)}function Ae(ie,oe,me){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=w_(""+oe,ie.mode,me),oe.return=ie,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case S:return me=Rf(oe.type,oe.key,oe.props,null,ie.mode,me),me.ref=Gl(ie,null,oe),me.return=ie,me;case M:return oe=j_(oe,ie.mode,me),oe.return=ie,oe;case U:var Te=oe._init;return Ae(ie,Te(oe._payload),me)}if(Le(oe)||X(oe))return oe=ii(oe,ie.mode,me,null),oe.return=ie,oe;qo(ie,oe)}return null}function Ne(ie,oe,me,Te){var Qe=oe!==null?oe.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return Qe!==null?null:te(ie,oe,""+me,Te);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case S:return me.key===Qe?ae(ie,oe,me,Te):null;case M:return me.key===Qe?fe(ie,oe,me,Te):null;case U:return Qe=me._init,Ne(ie,oe,Qe(me._payload),Te)}if(Le(me)||X(me))return Qe!==null?null:Se(ie,oe,me,Te,null);qo(ie,me)}return null}function qe(ie,oe,me,Te,Qe){if(typeof Te=="string"&&Te!==""||typeof Te=="number")return ie=ie.get(me)||null,te(oe,ie,""+Te,Qe);if(typeof Te=="object"&&Te!==null){switch(Te.$$typeof){case S:return ie=ie.get(Te.key===null?me:Te.key)||null,ae(oe,ie,Te,Qe);case M:return ie=ie.get(Te.key===null?me:Te.key)||null,fe(oe,ie,Te,Qe);case U:var st=Te._init;return qe(ie,oe,me,st(Te._payload),Qe)}if(Le(Te)||X(Te))return ie=ie.get(me)||null,Se(oe,ie,Te,Qe,null);qo(oe,Te)}return null}function We(ie,oe,me,Te){for(var Qe=null,st=null,rt=oe,pt=oe=0,us=null;rt!==null&&pt<me.length;pt++){rt.index>pt?(us=rt,rt=null):us=rt.sibling;var qt=Ne(ie,rt,me[pt],Te);if(qt===null){rt===null&&(rt=us);break}r&&rt&&qt.alternate===null&&o(ie,rt),oe=A(qt,oe,pt),st===null?Qe=qt:st.sibling=qt,st=qt,rt=us}if(pt===me.length)return m(ie,rt),sn&&Qa(ie,pt),Qe;if(rt===null){for(;pt<me.length;pt++)rt=Ae(ie,me[pt],Te),rt!==null&&(oe=A(rt,oe,pt),st===null?Qe=rt:st.sibling=rt,st=rt);return sn&&Qa(ie,pt),Qe}for(rt=_(ie,rt);pt<me.length;pt++)us=qe(rt,ie,pt,me[pt],Te),us!==null&&(r&&us.alternate!==null&&rt.delete(us.key===null?pt:us.key),oe=A(us,oe,pt),st===null?Qe=us:st.sibling=us,st=us);return r&&rt.forEach(function(Jo){return o(ie,Jo)}),sn&&Qa(ie,pt),Qe}function Ye(ie,oe,me,Te){var Qe=X(me);if(typeof Qe!="function")throw Error(n(150));if(me=Qe.call(me),me==null)throw Error(n(151));for(var st=Qe=null,rt=oe,pt=oe=0,us=null,qt=me.next();rt!==null&&!qt.done;pt++,qt=me.next()){rt.index>pt?(us=rt,rt=null):us=rt.sibling;var Jo=Ne(ie,rt,qt.value,Te);if(Jo===null){rt===null&&(rt=us);break}r&&rt&&Jo.alternate===null&&o(ie,rt),oe=A(Jo,oe,pt),st===null?Qe=Jo:st.sibling=Jo,st=Jo,rt=us}if(qt.done)return m(ie,rt),sn&&Qa(ie,pt),Qe;if(rt===null){for(;!qt.done;pt++,qt=me.next())qt=Ae(ie,qt.value,Te),qt!==null&&(oe=A(qt,oe,pt),st===null?Qe=qt:st.sibling=qt,st=qt);return sn&&Qa(ie,pt),Qe}for(rt=_(ie,rt);!qt.done;pt++,qt=me.next())qt=qe(rt,ie,pt,qt.value,Te),qt!==null&&(r&&qt.alternate!==null&&rt.delete(qt.key===null?pt:qt.key),oe=A(qt,oe,pt),st===null?Qe=qt:st.sibling=qt,st=qt);return r&&rt.forEach(function(rD){return o(ie,rD)}),sn&&Qa(ie,pt),Qe}function An(ie,oe,me,Te){if(typeof me=="object"&&me!==null&&me.type===$&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case S:e:{for(var Qe=me.key,st=oe;st!==null;){if(st.key===Qe){if(Qe=me.type,Qe===$){if(st.tag===7){m(ie,st.sibling),oe=C(st,me.props.children),oe.return=ie,ie=oe;break e}}else if(st.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===U&&Rh(Qe)===st.type){m(ie,st.sibling),oe=C(st,me.props),oe.ref=Gl(ie,st,me),oe.return=ie,ie=oe;break e}m(ie,st);break}else o(ie,st);st=st.sibling}me.type===$?(oe=ii(me.props.children,ie.mode,Te,me.key),oe.return=ie,ie=oe):(Te=Rf(me.type,me.key,me.props,null,ie.mode,Te),Te.ref=Gl(ie,oe,me),Te.return=ie,ie=Te)}return I(ie);case M:e:{for(st=me.key;oe!==null;){if(oe.key===st)if(oe.tag===4&&oe.stateNode.containerInfo===me.containerInfo&&oe.stateNode.implementation===me.implementation){m(ie,oe.sibling),oe=C(oe,me.children||[]),oe.return=ie,ie=oe;break e}else{m(ie,oe);break}else o(ie,oe);oe=oe.sibling}oe=j_(me,ie.mode,Te),oe.return=ie,ie=oe}return I(ie);case U:return st=me._init,An(ie,oe,st(me._payload),Te)}if(Le(me))return We(ie,oe,me,Te);if(X(me))return Ye(ie,oe,me,Te);qo(ie,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,oe!==null&&oe.tag===6?(m(ie,oe.sibling),oe=C(oe,me),oe.return=ie,ie=oe):(m(ie,oe),oe=w_(me,ie.mode,Te),oe.return=ie,ie=oe),I(ie)):m(ie,oe)}return An}var Xa=Fh(!0),Ih=Fh(!1),Ho=ta(null),dc=null,Vo=null,td=null;function nd(){td=Vo=dc=null}function sd(r){var o=Ho.current;Ut(Ho),r._currentValue=o}function rd(r,o,m){for(;r!==null;){var _=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,_!==null&&(_.childLanes|=o)):_!==null&&(_.childLanes&o)!==o&&(_.childLanes|=o),r===m)break;r=r.return}}function Wo(r,o){dc=r,td=Vo=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&o&&(as=!0),r.firstContext=null)}function lr(r){var o=r._currentValue;if(td!==r)if(r={context:r,memoizedValue:o,next:null},Vo===null){if(dc===null)throw Error(n(308));Vo=r,dc.dependencies={lanes:0,firstContext:r}}else Vo=Vo.next=r;return o}var Ja=null;function ad(r){Ja===null?Ja=[r]:Ja.push(r)}function Bh(r,o,m,_){var C=o.interleaved;return C===null?(m.next=m,ad(o)):(m.next=C.next,C.next=m),o.interleaved=m,aa(r,_)}function aa(r,o){r.lanes|=o;var m=r.alternate;for(m!==null&&(m.lanes|=o),m=r,r=r.return;r!==null;)r.childLanes|=o,m=r.alternate,m!==null&&(m.childLanes|=o),m=r,r=r.return;return m.tag===3?m.stateNode:null}var ba=!1;function od(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Uh(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function oa(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function xa(r,o,m){var _=r.updateQueue;if(_===null)return null;if(_=_.shared,Mt&2){var C=_.pending;return C===null?o.next=o:(o.next=C.next,C.next=o),_.pending=o,aa(r,m)}return C=_.interleaved,C===null?(o.next=o,ad(_)):(o.next=C.next,C.next=o),_.interleaved=o,aa(r,m)}function mc(r,o,m){if(o=o.updateQueue,o!==null&&(o=o.shared,(m&4194240)!==0)){var _=o.lanes;_&=r.pendingLanes,m|=_,o.lanes=m,Al(r,m)}}function qh(r,o){var m=r.updateQueue,_=r.alternate;if(_!==null&&(_=_.updateQueue,m===_)){var C=null,A=null;if(m=m.firstBaseUpdate,m!==null){do{var I={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};A===null?C=A=I:A=A.next=I,m=m.next}while(m!==null);A===null?C=A=o:A=A.next=o}else C=A=o;m={baseState:_.baseState,firstBaseUpdate:C,lastBaseUpdate:A,shared:_.shared,effects:_.effects},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=o:r.next=o,m.lastBaseUpdate=o}function hc(r,o,m,_){var C=r.updateQueue;ba=!1;var A=C.firstBaseUpdate,I=C.lastBaseUpdate,te=C.shared.pending;if(te!==null){C.shared.pending=null;var ae=te,fe=ae.next;ae.next=null,I===null?A=fe:I.next=fe,I=ae;var Se=r.alternate;Se!==null&&(Se=Se.updateQueue,te=Se.lastBaseUpdate,te!==I&&(te===null?Se.firstBaseUpdate=fe:te.next=fe,Se.lastBaseUpdate=ae))}if(A!==null){var Ae=C.baseState;I=0,Se=fe=ae=null,te=A;do{var Ne=te.lane,qe=te.eventTime;if((_&Ne)===Ne){Se!==null&&(Se=Se.next={eventTime:qe,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var We=r,Ye=te;switch(Ne=o,qe=m,Ye.tag){case 1:if(We=Ye.payload,typeof We=="function"){Ae=We.call(qe,Ae,Ne);break e}Ae=We;break e;case 3:We.flags=We.flags&-65537|128;case 0:if(We=Ye.payload,Ne=typeof We=="function"?We.call(qe,Ae,Ne):We,Ne==null)break e;Ae=H({},Ae,Ne);break e;case 2:ba=!0}}te.callback!==null&&te.lane!==0&&(r.flags|=64,Ne=C.effects,Ne===null?C.effects=[te]:Ne.push(te))}else qe={eventTime:qe,lane:Ne,tag:te.tag,payload:te.payload,callback:te.callback,next:null},Se===null?(fe=Se=qe,ae=Ae):Se=Se.next=qe,I|=Ne;if(te=te.next,te===null){if(te=C.shared.pending,te===null)break;Ne=te,te=Ne.next,Ne.next=null,C.lastBaseUpdate=Ne,C.shared.pending=null}}while(!0);if(Se===null&&(ae=Ae),C.baseState=ae,C.firstBaseUpdate=fe,C.lastBaseUpdate=Se,o=C.shared.interleaved,o!==null){C=o;do I|=C.lane,C=C.next;while(C!==o)}else A===null&&(C.shared.lanes=0);Na|=I,r.lanes=I,r.memoizedState=Ae}}function Hh(r,o,m){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var _=r[o],C=_.callback;if(C!==null){if(_.callback=null,_=m,typeof C!="function")throw Error(n(191,C));C.call(_)}}}var Ql={},Fr=ta(Ql),Xl=ta(Ql),Jl=ta(Ql);function Za(r){if(r===Ql)throw Error(n(174));return r}function ld(r,o){switch(Tt(Jl,o),Tt(Xl,r),Tt(Fr,Ql),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:xt(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=xt(o,r)}Ut(Fr),Tt(Fr,o)}function eo(){Ut(Fr),Ut(Xl),Ut(Jl)}function Vh(r){Za(Jl.current);var o=Za(Fr.current),m=xt(o,r.type);o!==m&&(Tt(Xl,r),Tt(Fr,m))}function id(r){Xl.current===r&&(Ut(Fr),Ut(Xl))}var an=ta(0);function fc(r){for(var o=r;o!==null;){if(o.tag===13){var m=o.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var cd=[];function ud(){for(var r=0;r<cd.length;r++)cd[r]._workInProgressVersionPrimary=null;cd.length=0}var Os=j.ReactCurrentDispatcher,dd=j.ReactCurrentBatchConfig,wa=0,en=null,kn=null,jn=null,Zl=!1,ei=!1,ti=0,o_=0;function rs(){throw Error(n(321))}function md(r,o){if(o===null)return!1;for(var m=0;m<o.length&&m<r.length;m++)if(!jr(r[m],o[m]))return!1;return!0}function hd(r,o,m,_,C,A){if(wa=A,en=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Os.current=r===null||r.memoizedState===null?c_:u_,r=m(_,C),ei){A=0;do{if(ei=!1,ti=0,25<=A)throw Error(n(301));A+=1,jn=kn=null,o.updateQueue=null,Os.current=d_,r=m(_,C)}while(ei)}if(Os.current=_c,o=kn!==null&&kn.next!==null,wa=0,jn=kn=en=null,Zl=!1,o)throw Error(n(300));return r}function fd(){var r=ti!==0;return ti=0,r}function Ir(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jn===null?en.memoizedState=jn=r:jn=jn.next=r,jn}function ir(){if(kn===null){var r=en.alternate;r=r!==null?r.memoizedState:null}else r=kn.next;var o=jn===null?en.memoizedState:jn.next;if(o!==null)jn=o,kn=r;else{if(r===null)throw Error(n(310));kn=r,r={memoizedState:kn.memoizedState,baseState:kn.baseState,baseQueue:kn.baseQueue,queue:kn.queue,next:null},jn===null?en.memoizedState=jn=r:jn=jn.next=r}return jn}function ni(r,o){return typeof o=="function"?o(r):o}function pd(r){var o=ir(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var _=kn,C=_.baseQueue,A=m.pending;if(A!==null){if(C!==null){var I=C.next;C.next=A.next,A.next=I}_.baseQueue=C=A,m.pending=null}if(C!==null){A=C.next,_=_.baseState;var te=I=null,ae=null,fe=A;do{var Se=fe.lane;if((wa&Se)===Se)ae!==null&&(ae=ae.next={lane:0,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null}),_=fe.hasEagerState?fe.eagerState:r(_,fe.action);else{var Ae={lane:Se,action:fe.action,hasEagerState:fe.hasEagerState,eagerState:fe.eagerState,next:null};ae===null?(te=ae=Ae,I=_):ae=ae.next=Ae,en.lanes|=Se,Na|=Se}fe=fe.next}while(fe!==null&&fe!==A);ae===null?I=_:ae.next=te,jr(_,o.memoizedState)||(as=!0),o.memoizedState=_,o.baseState=I,o.baseQueue=ae,m.lastRenderedState=_}if(r=m.interleaved,r!==null){C=r;do A=C.lane,en.lanes|=A,Na|=A,C=C.next;while(C!==r)}else C===null&&(m.lanes=0);return[o.memoizedState,m.dispatch]}function gd(r){var o=ir(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var _=m.dispatch,C=m.pending,A=o.memoizedState;if(C!==null){m.pending=null;var I=C=C.next;do A=r(A,I.action),I=I.next;while(I!==C);jr(A,o.memoizedState)||(as=!0),o.memoizedState=A,o.baseQueue===null&&(o.baseState=A),m.lastRenderedState=A}return[A,_]}function Wh(){}function Kh(r,o){var m=en,_=ir(),C=o(),A=!jr(_.memoizedState,C);if(A&&(_.memoizedState=C,as=!0),_=_.queue,_d(Qh.bind(null,m,_,r),[r]),_.getSnapshot!==o||A||jn!==null&&jn.memoizedState.tag&1){if(m.flags|=2048,si(9,Gh.bind(null,m,_,C,o),void 0,null),Mn===null)throw Error(n(349));wa&30||Yh(m,o,C)}return C}function Yh(r,o,m){r.flags|=16384,r={getSnapshot:o,value:m},o=en.updateQueue,o===null?(o={lastEffect:null,stores:null},en.updateQueue=o,o.stores=[r]):(m=o.stores,m===null?o.stores=[r]:m.push(r))}function Gh(r,o,m,_){o.value=m,o.getSnapshot=_,Xh(o)&&Jh(r)}function Qh(r,o,m){return m(function(){Xh(o)&&Jh(r)})}function Xh(r){var o=r.getSnapshot;r=r.value;try{var m=o();return!jr(r,m)}catch{return!0}}function Jh(r){var o=aa(r,1);o!==null&&Un(o,r,1,-1)}function Zh(r){var o=Ir();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ni,lastRenderedState:r},o.queue=r,r=r.dispatch=i_.bind(null,en,r),[o.memoizedState,r]}function si(r,o,m,_){return r={tag:r,create:o,destroy:m,deps:_,next:null},o=en.updateQueue,o===null?(o={lastEffect:null,stores:null},en.updateQueue=o,o.lastEffect=r.next=r):(m=o.lastEffect,m===null?o.lastEffect=r.next=r:(_=m.next,m.next=r,r.next=_,o.lastEffect=r)),r}function ef(){return ir().memoizedState}function pc(r,o,m,_){var C=Ir();en.flags|=r,C.memoizedState=si(1|o,m,void 0,_===void 0?null:_)}function gc(r,o,m,_){var C=ir();_=_===void 0?null:_;var A=void 0;if(kn!==null){var I=kn.memoizedState;if(A=I.destroy,_!==null&&md(_,I.deps)){C.memoizedState=si(o,m,A,_);return}}en.flags|=r,C.memoizedState=si(1|o,m,A,_)}function tf(r,o){return pc(8390656,8,r,o)}function _d(r,o){return gc(2048,8,r,o)}function nf(r,o){return gc(4,2,r,o)}function sf(r,o){return gc(4,4,r,o)}function rf(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function vd(r,o,m){return m=m!=null?m.concat([r]):null,gc(4,4,rf.bind(null,o,r),m)}function yd(){}function af(r,o){var m=ir();o=o===void 0?null:o;var _=m.memoizedState;return _!==null&&o!==null&&md(o,_[1])?_[0]:(m.memoizedState=[r,o],r)}function of(r,o){var m=ir();o=o===void 0?null:o;var _=m.memoizedState;return _!==null&&o!==null&&md(o,_[1])?_[0]:(r=r(),m.memoizedState=[r,o],r)}function lf(r,o,m){return wa&21?(jr(m,o)||(m=Kn(),en.lanes|=m,Na|=m,r.baseState=!0),o):(r.baseState&&(r.baseState=!1,as=!0),r.memoizedState=m)}function l_(r,o){var m=Ct;Ct=m!==0&&4>m?m:4,r(!0);var _=dd.transition;dd.transition={};try{r(!1),o()}finally{Ct=m,dd.transition=_}}function Ko(){return ir().memoizedState}function cf(r,o,m){var _=$s(r);if(m={lane:_,action:m,hasEagerState:!1,eagerState:null,next:null},bd(r))uf(o,m);else if(m=Bh(r,o,m,_),m!==null){var C=pn();Un(m,r,_,C),df(m,o,_)}}function i_(r,o,m){var _=$s(r),C={lane:_,action:m,hasEagerState:!1,eagerState:null,next:null};if(bd(r))uf(o,C);else{var A=r.alternate;if(r.lanes===0&&(A===null||A.lanes===0)&&(A=o.lastRenderedReducer,A!==null))try{var I=o.lastRenderedState,te=A(I,m);if(C.hasEagerState=!0,C.eagerState=te,jr(te,I)){var ae=o.interleaved;ae===null?(C.next=C,ad(o)):(C.next=ae.next,ae.next=C),o.interleaved=C;return}}catch{}finally{}m=Bh(r,o,C,_),m!==null&&(C=pn(),Un(m,r,_,C),df(m,o,_))}}function bd(r){var o=r.alternate;return r===en||o!==null&&o===en}function uf(r,o){ei=Zl=!0;var m=r.pending;m===null?o.next=o:(o.next=m.next,m.next=o),r.pending=o}function df(r,o,m){if(m&4194240){var _=o.lanes;_&=r.pendingLanes,m|=_,o.lanes=m,Al(r,m)}}var _c={readContext:lr,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useInsertionEffect:rs,useLayoutEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useMutableSource:rs,useSyncExternalStore:rs,useId:rs,unstable_isNewReconciler:!1},c_={readContext:lr,useCallback:function(r,o){return Ir().memoizedState=[r,o===void 0?null:o],r},useContext:lr,useEffect:tf,useImperativeHandle:function(r,o,m){return m=m!=null?m.concat([r]):null,pc(4194308,4,rf.bind(null,o,r),m)},useLayoutEffect:function(r,o){return pc(4194308,4,r,o)},useInsertionEffect:function(r,o){return pc(4,2,r,o)},useMemo:function(r,o){var m=Ir();return o=o===void 0?null:o,r=r(),m.memoizedState=[r,o],r},useReducer:function(r,o,m){var _=Ir();return o=m!==void 0?m(o):o,_.memoizedState=_.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},_.queue=r,r=r.dispatch=cf.bind(null,en,r),[_.memoizedState,r]},useRef:function(r){var o=Ir();return r={current:r},o.memoizedState=r},useState:Zh,useDebugValue:yd,useDeferredValue:function(r){return Ir().memoizedState=r},useTransition:function(){var r=Zh(!1),o=r[0];return r=l_.bind(null,r[1]),Ir().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,m){var _=en,C=Ir();if(sn){if(m===void 0)throw Error(n(407));m=m()}else{if(m=o(),Mn===null)throw Error(n(349));wa&30||Yh(_,o,m)}C.memoizedState=m;var A={value:m,getSnapshot:o};return C.queue=A,tf(Qh.bind(null,_,A,r),[r]),_.flags|=2048,si(9,Gh.bind(null,_,A,m,o),void 0,null),m},useId:function(){var r=Ir(),o=Mn.identifierPrefix;if(sn){var m=ra,_=sa;m=(_&~(1<<32-Ee(_)-1)).toString(32)+m,o=":"+o+"R"+m,m=ti++,0<m&&(o+="H"+m.toString(32)),o+=":"}else m=o_++,o=":"+o+"r"+m.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},u_={readContext:lr,useCallback:af,useContext:lr,useEffect:_d,useImperativeHandle:vd,useInsertionEffect:nf,useLayoutEffect:sf,useMemo:of,useReducer:pd,useRef:ef,useState:function(){return pd(ni)},useDebugValue:yd,useDeferredValue:function(r){var o=ir();return lf(o,kn.memoizedState,r)},useTransition:function(){var r=pd(ni)[0],o=ir().memoizedState;return[r,o]},useMutableSource:Wh,useSyncExternalStore:Kh,useId:Ko,unstable_isNewReconciler:!1},d_={readContext:lr,useCallback:af,useContext:lr,useEffect:_d,useImperativeHandle:vd,useInsertionEffect:nf,useLayoutEffect:sf,useMemo:of,useReducer:gd,useRef:ef,useState:function(){return gd(ni)},useDebugValue:yd,useDeferredValue:function(r){var o=ir();return kn===null?o.memoizedState=r:lf(o,kn.memoizedState,r)},useTransition:function(){var r=gd(ni)[0],o=ir().memoizedState;return[r,o]},useMutableSource:Wh,useSyncExternalStore:Kh,useId:Ko,unstable_isNewReconciler:!1};function Sr(r,o){if(r&&r.defaultProps){o=H({},o),r=r.defaultProps;for(var m in r)o[m]===void 0&&(o[m]=r[m]);return o}return o}function xd(r,o,m,_){o=r.memoizedState,m=m(_,o),m=m==null?o:H({},o,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var vc={isMounted:function(r){return(r=r._reactInternals)?zn(r)===r:!1},enqueueSetState:function(r,o,m){r=r._reactInternals;var _=pn(),C=$s(r),A=oa(_,C);A.payload=o,m!=null&&(A.callback=m),o=xa(r,A,C),o!==null&&(Un(o,r,C,_),mc(o,r,C))},enqueueReplaceState:function(r,o,m){r=r._reactInternals;var _=pn(),C=$s(r),A=oa(_,C);A.tag=1,A.payload=o,m!=null&&(A.callback=m),o=xa(r,A,C),o!==null&&(Un(o,r,C,_),mc(o,r,C))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var m=pn(),_=$s(r),C=oa(m,_);C.tag=2,o!=null&&(C.callback=o),o=xa(r,C,_),o!==null&&(Un(o,r,_,m),mc(o,r,_))}};function mf(r,o,m,_,C,A,I){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(_,A,I):o.prototype&&o.prototype.isPureReactComponent?!Il(m,_)||!Il(C,A):!0}function hf(r,o,m){var _=!1,C=va,A=o.contextType;return typeof A=="object"&&A!==null?A=lr(A):(C=xs(o)?Wa:Qn.current,_=o.contextTypes,A=(_=_!=null)?Ka(r,C):va),o=new o(m,A),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=vc,r.stateNode=o,o._reactInternals=r,_&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=C,r.__reactInternalMemoizedMaskedChildContext=A),o}function ff(r,o,m,_){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(m,_),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(m,_),o.state!==r&&vc.enqueueReplaceState(o,o.state,null)}function wd(r,o,m,_){var C=r.stateNode;C.props=m,C.state=r.memoizedState,C.refs={},od(r);var A=o.contextType;typeof A=="object"&&A!==null?C.context=lr(A):(A=xs(o)?Wa:Qn.current,C.context=Ka(r,A)),C.state=r.memoizedState,A=o.getDerivedStateFromProps,typeof A=="function"&&(xd(r,o,A,m),C.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(o=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),o!==C.state&&vc.enqueueReplaceState(C,C.state,null),hc(r,m,C,_),C.state=r.memoizedState),typeof C.componentDidMount=="function"&&(r.flags|=4194308)}function Yo(r,o){try{var m="",_=o;do m+=q(_),_=_.return;while(_);var C=m}catch(A){C=`
Error generating stack: `+A.message+`
`+A.stack}return{value:r,source:o,stack:C,digest:null}}function jd(r,o,m){return{value:r,source:null,stack:m??null,digest:o??null}}function Nd(r,o){try{console.error(o.value)}catch(m){setTimeout(function(){throw m})}}var m_=typeof WeakMap=="function"?WeakMap:Map;function pf(r,o,m){m=oa(-1,m),m.tag=3,m.payload={element:null};var _=o.value;return m.callback=function(){de||(de=!0,pe=_),Nd(r,o)},m}function gf(r,o,m){m=oa(-1,m),m.tag=3;var _=r.type.getDerivedStateFromError;if(typeof _=="function"){var C=o.value;m.payload=function(){return _(C)},m.callback=function(){Nd(r,o)}}var A=r.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(m.callback=function(){Nd(r,o),typeof _!="function"&&(we===null?we=new Set([this]):we.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),m}function _f(r,o,m){var _=r.pingCache;if(_===null){_=r.pingCache=new m_;var C=new Set;_.set(o,C)}else C=_.get(o),C===void 0&&(C=new Set,_.set(o,C));C.has(m)||(C.add(m),r=Kz.bind(null,r,o,m),o.then(r,r))}function vf(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function yf(r,o,m,_,C){return r.mode&1?(r.flags|=65536,r.lanes=C,r):(r===o?r.flags|=65536:(r.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(o=oa(-1,1),o.tag=2,xa(m,o,1))),m.lanes|=1),r)}var to=j.ReactCurrentOwner,as=!1;function os(r,o,m,_){o.child=r===null?Ih(o,null,m,_):Xa(o,r.child,m,_)}function Cd(r,o,m,_,C){m=m.render;var A=o.ref;return Wo(o,C),_=hd(r,o,m,_,A,C),m=fd(),r!==null&&!as?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~C,Br(r,o,C)):(sn&&m&&Qu(o),o.flags|=1,os(r,o,_,C),o.child)}function Sd(r,o,m,_,C){if(r===null){var A=m.type;return typeof A=="function"&&!x_(A)&&A.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(o.tag=15,o.type=A,Ed(r,o,A,_,C)):(r=Rf(m.type,null,_,o,o.mode,C),r.ref=o.ref,r.return=o,o.child=r)}if(A=r.child,!(r.lanes&C)){var I=A.memoizedProps;if(m=m.compare,m=m!==null?m:Il,m(I,_)&&r.ref===o.ref)return Br(r,o,C)}return o.flags|=1,r=Xo(A,_),r.ref=o.ref,r.return=o,o.child=r}function Ed(r,o,m,_,C){if(r!==null){var A=r.memoizedProps;if(Il(A,_)&&r.ref===o.ref)if(as=!1,o.pendingProps=_=A,(r.lanes&C)!==0)r.flags&131072&&(as=!0);else return o.lanes=r.lanes,Br(r,o,C)}return yc(r,o,m,_,C)}function bf(r,o,m){var _=o.pendingProps,C=_.children,A=r!==null?r.memoizedState:null;if(_.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Tt(so,Ts),Ts|=m;else{if(!(m&1073741824))return r=A!==null?A.baseLanes|m:m,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,Tt(so,Ts),Ts|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},_=A!==null?A.baseLanes:m,Tt(so,Ts),Ts|=_}else A!==null?(_=A.baseLanes|m,o.memoizedState=null):_=m,Tt(so,Ts),Ts|=_;return os(r,o,C,m),o.child}function la(r,o){var m=o.ref;(r===null&&m!==null||r!==null&&r.ref!==m)&&(o.flags|=512,o.flags|=2097152)}function yc(r,o,m,_,C){var A=xs(m)?Wa:Qn.current;return A=Ka(o,A),Wo(o,C),m=hd(r,o,m,_,A,C),_=fd(),r!==null&&!as?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~C,Br(r,o,C)):(sn&&_&&Qu(o),o.flags|=1,os(r,o,m,C),o.child)}function kd(r,o,m,_,C){if(xs(m)){var A=!0;Ya(o)}else A=!1;if(Wo(o,C),o.stateNode===null)no(r,o),hf(o,m,_),wd(o,m,_,C),_=!0;else if(r===null){var I=o.stateNode,te=o.memoizedProps;I.props=te;var ae=I.context,fe=m.contextType;typeof fe=="object"&&fe!==null?fe=lr(fe):(fe=xs(m)?Wa:Qn.current,fe=Ka(o,fe));var Se=m.getDerivedStateFromProps,Ae=typeof Se=="function"||typeof I.getSnapshotBeforeUpdate=="function";Ae||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(te!==_||ae!==fe)&&ff(o,I,_,fe),ba=!1;var Ne=o.memoizedState;I.state=Ne,hc(o,_,I,C),ae=o.memoizedState,te!==_||Ne!==ae||bs.current||ba?(typeof Se=="function"&&(xd(o,m,Se,_),ae=o.memoizedState),(te=ba||mf(o,m,te,_,Ne,ae,fe))?(Ae||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=_,o.memoizedState=ae),I.props=_,I.state=ae,I.context=fe,_=te):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),_=!1)}else{I=o.stateNode,Uh(r,o),te=o.memoizedProps,fe=o.type===o.elementType?te:Sr(o.type,te),I.props=fe,Ae=o.pendingProps,Ne=I.context,ae=m.contextType,typeof ae=="object"&&ae!==null?ae=lr(ae):(ae=xs(m)?Wa:Qn.current,ae=Ka(o,ae));var qe=m.getDerivedStateFromProps;(Se=typeof qe=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(te!==Ae||Ne!==ae)&&ff(o,I,_,ae),ba=!1,Ne=o.memoizedState,I.state=Ne,hc(o,_,I,C);var We=o.memoizedState;te!==Ae||Ne!==We||bs.current||ba?(typeof qe=="function"&&(xd(o,m,qe,_),We=o.memoizedState),(fe=ba||mf(o,m,fe,_,Ne,We,ae)||!1)?(Se||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(_,We,ae),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(_,We,ae)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||te===r.memoizedProps&&Ne===r.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||te===r.memoizedProps&&Ne===r.memoizedState||(o.flags|=1024),o.memoizedProps=_,o.memoizedState=We),I.props=_,I.state=We,I.context=ae,_=fe):(typeof I.componentDidUpdate!="function"||te===r.memoizedProps&&Ne===r.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||te===r.memoizedProps&&Ne===r.memoizedState||(o.flags|=1024),_=!1)}return bc(r,o,m,_,A,C)}function bc(r,o,m,_,C,A){la(r,o);var I=(o.flags&128)!==0;if(!_&&!I)return C&&Io(o,m,!1),Br(r,o,A);_=o.stateNode,to.current=o;var te=I&&typeof m.getDerivedStateFromError!="function"?null:_.render();return o.flags|=1,r!==null&&I?(o.child=Xa(o,r.child,null,A),o.child=Xa(o,null,te,A)):os(r,o,te,A),o.memoizedState=_.state,C&&Io(o,m,!0),o.child}function Md(r){var o=r.stateNode;o.pendingContext?ac(r,o.pendingContext,o.pendingContext!==o.context):o.context&&ac(r,o.context,!1),ld(r,o.containerInfo)}function xc(r,o,m,_,C){return Uo(),uc(C),o.flags|=256,os(r,o,m,_),o.child}var wc={dehydrated:null,treeContext:null,retryLane:0};function jc(r){return{baseLanes:r,cachePool:null,transitions:null}}function Ad(r,o,m){var _=o.pendingProps,C=an.current,A=!1,I=(o.flags&128)!==0,te;if((te=I)||(te=r!==null&&r.memoizedState===null?!1:(C&2)!==0),te?(A=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(C|=1),Tt(an,C&1),r===null)return Zu(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(o.mode&1?r.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(I=_.children,r=_.fallback,A?(_=o.mode,A=o.child,I={mode:"hidden",children:I},!(_&1)&&A!==null?(A.childLanes=0,A.pendingProps=I):A=Ff(I,_,0,null),r=ii(r,_,m,null),A.return=o,r.return=o,A.sibling=r,o.child=A,o.child.memoizedState=jc(m),o.memoizedState=wc,r):Od(o,I));if(C=r.memoizedState,C!==null&&(te=C.dehydrated,te!==null))return h_(r,o,I,_,te,C,m);if(A){A=_.fallback,I=o.mode,C=r.child,te=C.sibling;var ae={mode:"hidden",children:_.children};return!(I&1)&&o.child!==C?(_=o.child,_.childLanes=0,_.pendingProps=ae,o.deletions=null):(_=Xo(C,ae),_.subtreeFlags=C.subtreeFlags&14680064),te!==null?A=Xo(te,A):(A=ii(A,I,m,null),A.flags|=2),A.return=o,_.return=o,_.sibling=A,o.child=_,_=A,A=o.child,I=r.child.memoizedState,I=I===null?jc(m):{baseLanes:I.baseLanes|m,cachePool:null,transitions:I.transitions},A.memoizedState=I,A.childLanes=r.childLanes&~m,o.memoizedState=wc,_}return A=r.child,r=A.sibling,_=Xo(A,{mode:"visible",children:_.children}),!(o.mode&1)&&(_.lanes=m),_.return=o,_.sibling=null,r!==null&&(m=o.deletions,m===null?(o.deletions=[r],o.flags|=16):m.push(r)),o.child=_,o.memoizedState=null,_}function Od(r,o){return o=Ff({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function Nc(r,o,m,_){return _!==null&&uc(_),Xa(o,r.child,null,m),r=Od(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function h_(r,o,m,_,C,A,I){if(m)return o.flags&256?(o.flags&=-257,_=jd(Error(n(422))),Nc(r,o,I,_)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):(A=_.fallback,C=o.mode,_=Ff({mode:"visible",children:_.children},C,0,null),A=ii(A,C,I,null),A.flags|=2,_.return=o,A.return=o,_.sibling=A,o.child=_,o.mode&1&&Xa(o,r.child,null,I),o.child.memoizedState=jc(I),o.memoizedState=wc,A);if(!(o.mode&1))return Nc(r,o,I,null);if(C.data==="$!"){if(_=C.nextSibling&&C.nextSibling.dataset,_)var te=_.dgst;return _=te,A=Error(n(419)),_=jd(A,_,void 0),Nc(r,o,I,_)}if(te=(I&r.childLanes)!==0,as||te){if(_=Mn,_!==null){switch(I&-I){case 4:C=2;break;case 16:C=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:C=32;break;case 536870912:C=268435456;break;default:C=0}C=C&(_.suspendedLanes|I)?0:C,C!==0&&C!==A.retryLane&&(A.retryLane=C,aa(r,C),Un(_,r,C,-1))}return Mc(),_=jd(Error(n(421))),Nc(r,o,I,_)}return C.data==="$?"?(o.flags|=128,o.child=r.child,o=Yz.bind(null,r),C._reactRetry=o,null):(r=A.treeContext,qs=zr(C.nextSibling),Us=o,sn=!0,Cr=null,r!==null&&(ar[or++]=sa,ar[or++]=ra,ar[or++]=Ga,sa=r.id,ra=r.overflow,Ga=o),o=Od(o,_.children),o.flags|=4096,o)}function xf(r,o,m){r.lanes|=o;var _=r.alternate;_!==null&&(_.lanes|=o),rd(r.return,o,m)}function Pd(r,o,m,_,C){var A=r.memoizedState;A===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:_,tail:m,tailMode:C}:(A.isBackwards=o,A.rendering=null,A.renderingStartTime=0,A.last=_,A.tail=m,A.tailMode=C)}function wf(r,o,m){var _=o.pendingProps,C=_.revealOrder,A=_.tail;if(os(r,o,_.children,m),_=an.current,_&2)_=_&1|2,o.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&xf(r,m,o);else if(r.tag===19)xf(r,m,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}_&=1}if(Tt(an,_),!(o.mode&1))o.memoizedState=null;else switch(C){case"forwards":for(m=o.child,C=null;m!==null;)r=m.alternate,r!==null&&fc(r)===null&&(C=m),m=m.sibling;m=C,m===null?(C=o.child,o.child=null):(C=m.sibling,m.sibling=null),Pd(o,!1,C,m,A);break;case"backwards":for(m=null,C=o.child,o.child=null;C!==null;){if(r=C.alternate,r!==null&&fc(r)===null){o.child=C;break}r=C.sibling,C.sibling=m,m=C,C=r}Pd(o,!0,m,null,A);break;case"together":Pd(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function no(r,o){!(o.mode&1)&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function Br(r,o,m){if(r!==null&&(o.dependencies=r.dependencies),Na|=o.lanes,!(m&o.childLanes))return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,m=Xo(r,r.pendingProps),o.child=m,m.return=o;r.sibling!==null;)r=r.sibling,m=m.sibling=Xo(r,r.pendingProps),m.return=o;m.sibling=null}return o.child}function f_(r,o,m){switch(o.tag){case 3:Md(o),Uo();break;case 5:Vh(o);break;case 1:xs(o.type)&&Ya(o);break;case 4:ld(o,o.stateNode.containerInfo);break;case 10:var _=o.type._context,C=o.memoizedProps.value;Tt(Ho,_._currentValue),_._currentValue=C;break;case 13:if(_=o.memoizedState,_!==null)return _.dehydrated!==null?(Tt(an,an.current&1),o.flags|=128,null):m&o.child.childLanes?Ad(r,o,m):(Tt(an,an.current&1),r=Br(r,o,m),r!==null?r.sibling:null);Tt(an,an.current&1);break;case 19:if(_=(m&o.childLanes)!==0,r.flags&128){if(_)return wf(r,o,m);o.flags|=128}if(C=o.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Tt(an,an.current),_)break;return null;case 22:case 23:return o.lanes=0,bf(r,o,m)}return Br(r,o,m)}var jf,Td,Nf,Cf;jf=function(r,o){for(var m=o.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},Td=function(){},Nf=function(r,o,m,_){var C=r.memoizedProps;if(C!==_){r=o.stateNode,Za(Fr.current);var A=null;switch(m){case"input":C=Be(r,C),_=Be(r,_),A=[];break;case"select":C=H({},C,{value:void 0}),_=H({},_,{value:void 0}),A=[];break;case"textarea":C=ce(r,C),_=ce(r,_),A=[];break;default:typeof C.onClick!="function"&&typeof _.onClick=="function"&&(r.onclick=sc)}mn(m,_);var I;m=null;for(fe in C)if(!_.hasOwnProperty(fe)&&C.hasOwnProperty(fe)&&C[fe]!=null)if(fe==="style"){var te=C[fe];for(I in te)te.hasOwnProperty(I)&&(m||(m={}),m[I]="")}else fe!=="dangerouslySetInnerHTML"&&fe!=="children"&&fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&fe!=="autoFocus"&&(l.hasOwnProperty(fe)?A||(A=[]):(A=A||[]).push(fe,null));for(fe in _){var ae=_[fe];if(te=C!=null?C[fe]:void 0,_.hasOwnProperty(fe)&&ae!==te&&(ae!=null||te!=null))if(fe==="style")if(te){for(I in te)!te.hasOwnProperty(I)||ae&&ae.hasOwnProperty(I)||(m||(m={}),m[I]="");for(I in ae)ae.hasOwnProperty(I)&&te[I]!==ae[I]&&(m||(m={}),m[I]=ae[I])}else m||(A||(A=[]),A.push(fe,m)),m=ae;else fe==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,te=te?te.__html:void 0,ae!=null&&te!==ae&&(A=A||[]).push(fe,ae)):fe==="children"?typeof ae!="string"&&typeof ae!="number"||(A=A||[]).push(fe,""+ae):fe!=="suppressContentEditableWarning"&&fe!=="suppressHydrationWarning"&&(l.hasOwnProperty(fe)?(ae!=null&&fe==="onScroll"&&Zt("scroll",r),A||te===ae||(A=[])):(A=A||[]).push(fe,ae))}m&&(A=A||[]).push("style",m);var fe=A;(o.updateQueue=fe)&&(o.flags|=4)}},Cf=function(r,o,m,_){m!==_&&(o.flags|=4)};function ri(r,o){if(!sn)switch(r.tailMode){case"hidden":o=r.tail;for(var m=null;o!==null;)o.alternate!==null&&(m=o),o=o.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var _=null;m!==null;)m.alternate!==null&&(_=m),m=m.sibling;_===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:_.sibling=null}}function ls(r){var o=r.alternate!==null&&r.alternate.child===r.child,m=0,_=0;if(o)for(var C=r.child;C!==null;)m|=C.lanes|C.childLanes,_|=C.subtreeFlags&14680064,_|=C.flags&14680064,C.return=r,C=C.sibling;else for(C=r.child;C!==null;)m|=C.lanes|C.childLanes,_|=C.subtreeFlags,_|=C.flags,C.return=r,C=C.sibling;return r.subtreeFlags|=_,r.childLanes=m,o}function p_(r,o,m){var _=o.pendingProps;switch(Xu(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ls(o),null;case 1:return xs(o.type)&&rc(),ls(o),null;case 3:return _=o.stateNode,eo(),Ut(bs),Ut(Qn),ud(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(r===null||r.child===null)&&(cc(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Cr!==null&&(Ar(Cr),Cr=null))),Td(r,o),ls(o),null;case 5:id(o);var C=Za(Jl.current);if(m=o.type,r!==null&&o.stateNode!=null)Nf(r,o,m,_,C),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!_){if(o.stateNode===null)throw Error(n(166));return ls(o),null}if(r=Za(Fr.current),cc(o)){_=o.stateNode,m=o.type;var A=o.memoizedProps;switch(_[Dr]=o,_[Kl]=A,r=(o.mode&1)!==0,m){case"dialog":Zt("cancel",_),Zt("close",_);break;case"iframe":case"object":case"embed":Zt("load",_);break;case"video":case"audio":for(C=0;C<ql.length;C++)Zt(ql[C],_);break;case"source":Zt("error",_);break;case"img":case"image":case"link":Zt("error",_),Zt("load",_);break;case"details":Zt("toggle",_);break;case"input":mt(_,A),Zt("invalid",_);break;case"select":_._wrapperState={wasMultiple:!!A.multiple},Zt("invalid",_);break;case"textarea":Fe(_,A),Zt("invalid",_)}mn(m,A),C=null;for(var I in A)if(A.hasOwnProperty(I)){var te=A[I];I==="children"?typeof te=="string"?_.textContent!==te&&(A.suppressHydrationWarning!==!0&&ys(_.textContent,te,r),C=["children",te]):typeof te=="number"&&_.textContent!==""+te&&(A.suppressHydrationWarning!==!0&&ys(_.textContent,te,r),C=["children",""+te]):l.hasOwnProperty(I)&&te!=null&&I==="onScroll"&&Zt("scroll",_)}switch(m){case"input":ke(_),ye(_,A,!0);break;case"textarea":ke(_),it(_);break;case"select":case"option":break;default:typeof A.onClick=="function"&&(_.onclick=sc)}_=C,o.updateQueue=_,_!==null&&(o.flags|=4)}else{I=C.nodeType===9?C:C.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=at(m)),r==="http://www.w3.org/1999/xhtml"?m==="script"?(r=I.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof _.is=="string"?r=I.createElement(m,{is:_.is}):(r=I.createElement(m),m==="select"&&(I=r,_.multiple?I.multiple=!0:_.size&&(I.size=_.size))):r=I.createElementNS(r,m),r[Dr]=o,r[Kl]=_,jf(r,o,!1,!1),o.stateNode=r;e:{switch(I=$n(m,_),m){case"dialog":Zt("cancel",r),Zt("close",r),C=_;break;case"iframe":case"object":case"embed":Zt("load",r),C=_;break;case"video":case"audio":for(C=0;C<ql.length;C++)Zt(ql[C],r);C=_;break;case"source":Zt("error",r),C=_;break;case"img":case"image":case"link":Zt("error",r),Zt("load",r),C=_;break;case"details":Zt("toggle",r),C=_;break;case"input":mt(r,_),C=Be(r,_),Zt("invalid",r);break;case"option":C=_;break;case"select":r._wrapperState={wasMultiple:!!_.multiple},C=H({},_,{value:void 0}),Zt("invalid",r);break;case"textarea":Fe(r,_),C=ce(r,_),Zt("invalid",r);break;default:C=_}mn(m,C),te=C;for(A in te)if(te.hasOwnProperty(A)){var ae=te[A];A==="style"?ct(r,ae):A==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&$e(r,ae)):A==="children"?typeof ae=="string"?(m!=="textarea"||ae!=="")&&je(r,ae):typeof ae=="number"&&je(r,""+ae):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(l.hasOwnProperty(A)?ae!=null&&A==="onScroll"&&Zt("scroll",r):ae!=null&&k(r,A,ae,I))}switch(m){case"input":ke(r),ye(r,_,!1);break;case"textarea":ke(r),it(r);break;case"option":_.value!=null&&r.setAttribute("value",""+ee(_.value));break;case"select":r.multiple=!!_.multiple,A=_.value,A!=null?Ve(r,!!_.multiple,A,!1):_.defaultValue!=null&&Ve(r,!!_.multiple,_.defaultValue,!0);break;default:typeof C.onClick=="function"&&(r.onclick=sc)}switch(m){case"button":case"input":case"select":case"textarea":_=!!_.autoFocus;break e;case"img":_=!0;break e;default:_=!1}}_&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return ls(o),null;case 6:if(r&&o.stateNode!=null)Cf(r,o,r.memoizedProps,_);else{if(typeof _!="string"&&o.stateNode===null)throw Error(n(166));if(m=Za(Jl.current),Za(Fr.current),cc(o)){if(_=o.stateNode,m=o.memoizedProps,_[Dr]=o,(A=_.nodeValue!==m)&&(r=Us,r!==null))switch(r.tag){case 3:ys(_.nodeValue,m,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&ys(_.nodeValue,m,(r.mode&1)!==0)}A&&(o.flags|=4)}else _=(m.nodeType===9?m:m.ownerDocument).createTextNode(_),_[Dr]=o,o.stateNode=_}return ls(o),null;case 13:if(Ut(an),_=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(sn&&qs!==null&&o.mode&1&&!(o.flags&128))Dh(),Uo(),o.flags|=98560,A=!1;else if(A=cc(o),_!==null&&_.dehydrated!==null){if(r===null){if(!A)throw Error(n(318));if(A=o.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));A[Dr]=o}else Uo(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;ls(o),A=!1}else Cr!==null&&(Ar(Cr),Cr=null),A=!0;if(!A)return o.flags&65536?o:null}return o.flags&128?(o.lanes=m,o):(_=_!==null,_!==(r!==null&&r.memoizedState!==null)&&_&&(o.child.flags|=8192,o.mode&1&&(r===null||an.current&1?Nn===0&&(Nn=3):Mc())),o.updateQueue!==null&&(o.flags|=4),ls(o),null);case 4:return eo(),Td(r,o),r===null&&Hl(o.stateNode.containerInfo),ls(o),null;case 10:return sd(o.type._context),ls(o),null;case 17:return xs(o.type)&&rc(),ls(o),null;case 19:if(Ut(an),A=o.memoizedState,A===null)return ls(o),null;if(_=(o.flags&128)!==0,I=A.rendering,I===null)if(_)ri(A,!1);else{if(Nn!==0||r!==null&&r.flags&128)for(r=o.child;r!==null;){if(I=fc(r),I!==null){for(o.flags|=128,ri(A,!1),_=I.updateQueue,_!==null&&(o.updateQueue=_,o.flags|=4),o.subtreeFlags=0,_=m,m=o.child;m!==null;)A=m,r=_,A.flags&=14680066,I=A.alternate,I===null?(A.childLanes=0,A.lanes=r,A.child=null,A.subtreeFlags=0,A.memoizedProps=null,A.memoizedState=null,A.updateQueue=null,A.dependencies=null,A.stateNode=null):(A.childLanes=I.childLanes,A.lanes=I.lanes,A.child=I.child,A.subtreeFlags=0,A.deletions=null,A.memoizedProps=I.memoizedProps,A.memoizedState=I.memoizedState,A.updateQueue=I.updateQueue,A.type=I.type,r=I.dependencies,A.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),m=m.sibling;return Tt(an,an.current&1|2),o.child}r=r.sibling}A.tail!==null&&ht()>ro&&(o.flags|=128,_=!0,ri(A,!1),o.lanes=4194304)}else{if(!_)if(r=fc(I),r!==null){if(o.flags|=128,_=!0,m=r.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),ri(A,!0),A.tail===null&&A.tailMode==="hidden"&&!I.alternate&&!sn)return ls(o),null}else 2*ht()-A.renderingStartTime>ro&&m!==1073741824&&(o.flags|=128,_=!0,ri(A,!1),o.lanes=4194304);A.isBackwards?(I.sibling=o.child,o.child=I):(m=A.last,m!==null?m.sibling=I:o.child=I,A.last=I)}return A.tail!==null?(o=A.tail,A.rendering=o,A.tail=o.sibling,A.renderingStartTime=ht(),o.sibling=null,m=an.current,Tt(an,_?m&1|2:m&1),o):(ls(o),null);case 22:case 23:return dr(),_=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==_&&(o.flags|=8192),_&&o.mode&1?Ts&1073741824&&(ls(o),o.subtreeFlags&6&&(o.flags|=8192)):ls(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function g_(r,o){switch(Xu(o),o.tag){case 1:return xs(o.type)&&rc(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return eo(),Ut(bs),Ut(Qn),ud(),r=o.flags,r&65536&&!(r&128)?(o.flags=r&-65537|128,o):null;case 5:return id(o),null;case 13:if(Ut(an),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Uo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Ut(an),null;case 4:return eo(),null;case 10:return sd(o.type._context),null;case 22:case 23:return dr(),null;case 24:return null;default:return null}}var Cc=!1,is=!1,__=typeof WeakSet=="function"?WeakSet:Set,He=null;function Xn(r,o){var m=r.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(_){Sn(r,o,_)}else m.current=null}function Ps(r,o,m){try{m()}catch(_){Sn(r,o,_)}}var Sf=!1;function v_(r,o){if(Nr=sr,r=Lu(),Bl(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var _=m.getSelection&&m.getSelection();if(_&&_.rangeCount!==0){m=_.anchorNode;var C=_.anchorOffset,A=_.focusNode;_=_.focusOffset;try{m.nodeType,A.nodeType}catch{m=null;break e}var I=0,te=-1,ae=-1,fe=0,Se=0,Ae=r,Ne=null;t:for(;;){for(var qe;Ae!==m||C!==0&&Ae.nodeType!==3||(te=I+C),Ae!==A||_!==0&&Ae.nodeType!==3||(ae=I+_),Ae.nodeType===3&&(I+=Ae.nodeValue.length),(qe=Ae.firstChild)!==null;)Ne=Ae,Ae=qe;for(;;){if(Ae===r)break t;if(Ne===m&&++fe===C&&(te=I),Ne===A&&++Se===_&&(ae=I),(qe=Ae.nextSibling)!==null)break;Ae=Ne,Ne=Ae.parentNode}Ae=qe}m=te===-1||ae===-1?null:{start:te,end:ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(Wl={focusedElem:r,selectionRange:m},sr=!1,He=o;He!==null;)if(o=He,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,He=r;else for(;He!==null;){o=He;try{var We=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(We!==null){var Ye=We.memoizedProps,An=We.memoizedState,ie=o.stateNode,oe=ie.getSnapshotBeforeUpdate(o.elementType===o.type?Ye:Sr(o.type,Ye),An);ie.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var me=o.stateNode.containerInfo;me.nodeType===1?me.textContent="":me.nodeType===9&&me.documentElement&&me.removeChild(me.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Te){Sn(o,o.return,Te)}if(r=o.sibling,r!==null){r.return=o.return,He=r;break}He=o.return}return We=Sf,Sf=!1,We}function ai(r,o,m){var _=o.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var C=_=_.next;do{if((C.tag&r)===r){var A=C.destroy;C.destroy=void 0,A!==void 0&&Ps(o,m,A)}C=C.next}while(C!==_)}}function Sc(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var m=o=o.next;do{if((m.tag&r)===r){var _=m.create;m.destroy=_()}m=m.next}while(m!==o)}}function $d(r){var o=r.ref;if(o!==null){var m=r.stateNode;switch(r.tag){case 5:r=m;break;default:r=m}typeof o=="function"?o(r):o.current=r}}function Ef(r){var o=r.alternate;o!==null&&(r.alternate=null,Ef(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[Dr],delete o[Kl],delete o[Ku],delete o[Mh],delete o[Ah])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function kf(r){return r.tag===5||r.tag===3||r.tag===4}function Mf(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||kf(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Ld(r,o,m){var _=r.tag;if(_===5||_===6)r=r.stateNode,o?m.nodeType===8?m.parentNode.insertBefore(r,o):m.insertBefore(r,o):(m.nodeType===8?(o=m.parentNode,o.insertBefore(r,m)):(o=m,o.appendChild(r)),m=m._reactRootContainer,m!=null||o.onclick!==null||(o.onclick=sc));else if(_!==4&&(r=r.child,r!==null))for(Ld(r,o,m),r=r.sibling;r!==null;)Ld(r,o,m),r=r.sibling}function cr(r,o,m){var _=r.tag;if(_===5||_===6)r=r.stateNode,o?m.insertBefore(r,o):m.appendChild(r);else if(_!==4&&(r=r.child,r!==null))for(cr(r,o,m),r=r.sibling;r!==null;)cr(r,o,m),r=r.sibling}var Jn=null,Er=!1;function ja(r,o,m){for(m=m.child;m!==null;)Af(r,o,m),m=m.sibling}function Af(r,o,m){if(Ue&&typeof Ue.onCommitFiberUnmount=="function")try{Ue.onCommitFiberUnmount(xe,m)}catch{}switch(m.tag){case 5:is||Xn(m,o);case 6:var _=Jn,C=Er;Jn=null,ja(r,o,m),Jn=_,Er=C,Jn!==null&&(Er?(r=Jn,m=m.stateNode,r.nodeType===8?r.parentNode.removeChild(m):r.removeChild(m)):Jn.removeChild(m.stateNode));break;case 18:Jn!==null&&(Er?(r=Jn,m=m.stateNode,r.nodeType===8?Wu(r.parentNode,m):r.nodeType===1&&Wu(r,m),Rn(r)):Wu(Jn,m.stateNode));break;case 4:_=Jn,C=Er,Jn=m.stateNode.containerInfo,Er=!0,ja(r,o,m),Jn=_,Er=C;break;case 0:case 11:case 14:case 15:if(!is&&(_=m.updateQueue,_!==null&&(_=_.lastEffect,_!==null))){C=_=_.next;do{var A=C,I=A.destroy;A=A.tag,I!==void 0&&(A&2||A&4)&&Ps(m,o,I),C=C.next}while(C!==_)}ja(r,o,m);break;case 1:if(!is&&(Xn(m,o),_=m.stateNode,typeof _.componentWillUnmount=="function"))try{_.props=m.memoizedProps,_.state=m.memoizedState,_.componentWillUnmount()}catch(te){Sn(m,o,te)}ja(r,o,m);break;case 21:ja(r,o,m);break;case 22:m.mode&1?(is=(_=is)||m.memoizedState!==null,ja(r,o,m),is=_):ja(r,o,m);break;default:ja(r,o,m)}}function Of(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var m=r.stateNode;m===null&&(m=r.stateNode=new __),o.forEach(function(_){var C=Gz.bind(null,r,_);m.has(_)||(m.add(_),_.then(C,C))})}}function kr(r,o){var m=o.deletions;if(m!==null)for(var _=0;_<m.length;_++){var C=m[_];try{var A=r,I=o,te=I;e:for(;te!==null;){switch(te.tag){case 5:Jn=te.stateNode,Er=!1;break e;case 3:Jn=te.stateNode.containerInfo,Er=!0;break e;case 4:Jn=te.stateNode.containerInfo,Er=!0;break e}te=te.return}if(Jn===null)throw Error(n(160));Af(A,I,C),Jn=null,Er=!1;var ae=C.alternate;ae!==null&&(ae.return=null),C.return=null}catch(fe){Sn(C,o,fe)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Pf(o,r),o=o.sibling}function Pf(r,o){var m=r.alternate,_=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(kr(o,r),Ur(r),_&4){try{ai(3,r,r.return),Sc(3,r)}catch(Ye){Sn(r,r.return,Ye)}try{ai(5,r,r.return)}catch(Ye){Sn(r,r.return,Ye)}}break;case 1:kr(o,r),Ur(r),_&512&&m!==null&&Xn(m,m.return);break;case 5:if(kr(o,r),Ur(r),_&512&&m!==null&&Xn(m,m.return),r.flags&32){var C=r.stateNode;try{je(C,"")}catch(Ye){Sn(r,r.return,Ye)}}if(_&4&&(C=r.stateNode,C!=null)){var A=r.memoizedProps,I=m!==null?m.memoizedProps:A,te=r.type,ae=r.updateQueue;if(r.updateQueue=null,ae!==null)try{te==="input"&&A.type==="radio"&&A.name!=null&&Ge(C,A),$n(te,I);var fe=$n(te,A);for(I=0;I<ae.length;I+=2){var Se=ae[I],Ae=ae[I+1];Se==="style"?ct(C,Ae):Se==="dangerouslySetInnerHTML"?$e(C,Ae):Se==="children"?je(C,Ae):k(C,Se,Ae,fe)}switch(te){case"input":ue(C,A);break;case"textarea":et(C,A);break;case"select":var Ne=C._wrapperState.wasMultiple;C._wrapperState.wasMultiple=!!A.multiple;var qe=A.value;qe!=null?Ve(C,!!A.multiple,qe,!1):Ne!==!!A.multiple&&(A.defaultValue!=null?Ve(C,!!A.multiple,A.defaultValue,!0):Ve(C,!!A.multiple,A.multiple?[]:"",!1))}C[Kl]=A}catch(Ye){Sn(r,r.return,Ye)}}break;case 6:if(kr(o,r),Ur(r),_&4){if(r.stateNode===null)throw Error(n(162));C=r.stateNode,A=r.memoizedProps;try{C.nodeValue=A}catch(Ye){Sn(r,r.return,Ye)}}break;case 3:if(kr(o,r),Ur(r),_&4&&m!==null&&m.memoizedState.isDehydrated)try{Rn(o.containerInfo)}catch(Ye){Sn(r,r.return,Ye)}break;case 4:kr(o,r),Ur(r);break;case 13:kr(o,r),Ur(r),C=r.child,C.flags&8192&&(A=C.memoizedState!==null,C.stateNode.isHidden=A,!A||C.alternate!==null&&C.alternate.memoizedState!==null||(kc=ht())),_&4&&Of(r);break;case 22:if(Se=m!==null&&m.memoizedState!==null,r.mode&1?(is=(fe=is)||Se,kr(o,r),is=fe):kr(o,r),Ur(r),_&8192){if(fe=r.memoizedState!==null,(r.stateNode.isHidden=fe)&&!Se&&r.mode&1)for(He=r,Se=r.child;Se!==null;){for(Ae=He=Se;He!==null;){switch(Ne=He,qe=Ne.child,Ne.tag){case 0:case 11:case 14:case 15:ai(4,Ne,Ne.return);break;case 1:Xn(Ne,Ne.return);var We=Ne.stateNode;if(typeof We.componentWillUnmount=="function"){_=Ne,m=Ne.return;try{o=_,We.props=o.memoizedProps,We.state=o.memoizedState,We.componentWillUnmount()}catch(Ye){Sn(_,m,Ye)}}break;case 5:Xn(Ne,Ne.return);break;case 22:if(Ne.memoizedState!==null){Lf(Ae);continue}}qe!==null?(qe.return=Ne,He=qe):Lf(Ae)}Se=Se.sibling}e:for(Se=null,Ae=r;;){if(Ae.tag===5){if(Se===null){Se=Ae;try{C=Ae.stateNode,fe?(A=C.style,typeof A.setProperty=="function"?A.setProperty("display","none","important"):A.display="none"):(te=Ae.stateNode,ae=Ae.memoizedProps.style,I=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,te.style.display=Wt("display",I))}catch(Ye){Sn(r,r.return,Ye)}}}else if(Ae.tag===6){if(Se===null)try{Ae.stateNode.nodeValue=fe?"":Ae.memoizedProps}catch(Ye){Sn(r,r.return,Ye)}}else if((Ae.tag!==22&&Ae.tag!==23||Ae.memoizedState===null||Ae===r)&&Ae.child!==null){Ae.child.return=Ae,Ae=Ae.child;continue}if(Ae===r)break e;for(;Ae.sibling===null;){if(Ae.return===null||Ae.return===r)break e;Se===Ae&&(Se=null),Ae=Ae.return}Se===Ae&&(Se=null),Ae.sibling.return=Ae.return,Ae=Ae.sibling}}break;case 19:kr(o,r),Ur(r),_&4&&Of(r);break;case 21:break;default:kr(o,r),Ur(r)}}function Ur(r){var o=r.flags;if(o&2){try{e:{for(var m=r.return;m!==null;){if(kf(m)){var _=m;break e}m=m.return}throw Error(n(160))}switch(_.tag){case 5:var C=_.stateNode;_.flags&32&&(je(C,""),_.flags&=-33);var A=Mf(r);cr(r,A,C);break;case 3:case 4:var I=_.stateNode.containerInfo,te=Mf(r);Ld(r,te,I);break;default:throw Error(n(161))}}catch(ae){Sn(r,r.return,ae)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function y_(r,o,m){He=r,Tf(r)}function Tf(r,o,m){for(var _=(r.mode&1)!==0;He!==null;){var C=He,A=C.child;if(C.tag===22&&_){var I=C.memoizedState!==null||Cc;if(!I){var te=C.alternate,ae=te!==null&&te.memoizedState!==null||is;te=Cc;var fe=is;if(Cc=I,(is=ae)&&!fe)for(He=C;He!==null;)I=He,ae=I.child,I.tag===22&&I.memoizedState!==null?zf(C):ae!==null?(ae.return=I,He=ae):zf(C);for(;A!==null;)He=A,Tf(A),A=A.sibling;He=C,Cc=te,is=fe}$f(r)}else C.subtreeFlags&8772&&A!==null?(A.return=C,He=A):$f(r)}}function $f(r){for(;He!==null;){var o=He;if(o.flags&8772){var m=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:is||Sc(5,o);break;case 1:var _=o.stateNode;if(o.flags&4&&!is)if(m===null)_.componentDidMount();else{var C=o.elementType===o.type?m.memoizedProps:Sr(o.type,m.memoizedProps);_.componentDidUpdate(C,m.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var A=o.updateQueue;A!==null&&Hh(o,A,_);break;case 3:var I=o.updateQueue;if(I!==null){if(m=null,o.child!==null)switch(o.child.tag){case 5:m=o.child.stateNode;break;case 1:m=o.child.stateNode}Hh(o,I,m)}break;case 5:var te=o.stateNode;if(m===null&&o.flags&4){m=te;var ae=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&m.focus();break;case"img":ae.src&&(m.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var fe=o.alternate;if(fe!==null){var Se=fe.memoizedState;if(Se!==null){var Ae=Se.dehydrated;Ae!==null&&Rn(Ae)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}is||o.flags&512&&$d(o)}catch(Ne){Sn(o,o.return,Ne)}}if(o===r){He=null;break}if(m=o.sibling,m!==null){m.return=o.return,He=m;break}He=o.return}}function Lf(r){for(;He!==null;){var o=He;if(o===r){He=null;break}var m=o.sibling;if(m!==null){m.return=o.return,He=m;break}He=o.return}}function zf(r){for(;He!==null;){var o=He;try{switch(o.tag){case 0:case 11:case 15:var m=o.return;try{Sc(4,o)}catch(ae){Sn(o,m,ae)}break;case 1:var _=o.stateNode;if(typeof _.componentDidMount=="function"){var C=o.return;try{_.componentDidMount()}catch(ae){Sn(o,C,ae)}}var A=o.return;try{$d(o)}catch(ae){Sn(o,A,ae)}break;case 5:var I=o.return;try{$d(o)}catch(ae){Sn(o,I,ae)}}}catch(ae){Sn(o,o.return,ae)}if(o===r){He=null;break}var te=o.sibling;if(te!==null){te.return=o.return,He=te;break}He=o.return}}var ia=Math.ceil,zt=j.ReactCurrentDispatcher,zd=j.ReactCurrentOwner,Hs=j.ReactCurrentBatchConfig,Mt=0,Mn=null,fn=null,Bn=0,Ts=0,so=ta(0),Nn=0,Go=null,Na=0,oi=0,Ec=0,Qo=null,ws=null,kc=0,ro=1/0,ve=null,de=!1,pe=null,we=null,_e=!1,dt=null,At=0,St=0,tn=null,on=-1,Vs=0;function pn(){return Mt&6?ht():on!==-1?on:on=ht()}function $s(r){return r.mode&1?Mt&2&&Bn!==0?Bn&-Bn:ed.transition!==null?(Vs===0&&(Vs=Kn()),Vs):(r=Ct,r!==0||(r=window.event,r=r===void 0?16:Eo(r.type)),r):1}function Un(r,o,m,_){if(50<St)throw St=0,tn=null,Error(n(185));_s(r,m,_),(!(Mt&2)||r!==Mn)&&(r===Mn&&(!(Mt&2)&&(oi|=m),Nn===4&&ur(r,Bn)),Cn(r,_),m===1&&Mt===0&&!(o.mode&1)&&(ro=ht()+500,oc&&na()))}function Cn(r,o){var m=r.callbackNode;gs(r,o);var _=xn(r,r===Mn?Bn:0);if(_===0)m!==null&&ps(m),r.callbackNode=null,r.callbackPriority=0;else if(o=_&-_,r.callbackPriority!==o){if(m!=null&&ps(m),o===1)r.tag===0?a_(ao.bind(null,r)):Ph(ao.bind(null,r)),Sh(function(){!(Mt&6)&&na()}),m=null;else{switch(Ui(_)){case 1:m=ns;break;case 4:m=br;break;case 16:m=Es;break;case 536870912:m=le;break;default:m=Es}m=nj(m,qr.bind(null,r))}r.callbackPriority=o,r.callbackNode=m}}function qr(r,o){if(on=-1,Vs=0,Mt&6)throw Error(n(327));var m=r.callbackNode;if(Oc()&&r.callbackNode!==m)return null;var _=xn(r,r===Mn?Bn:0);if(_===0)return null;if(_&30||_&r.expiredLanes||o)o=Ac(r,_);else{o=_;var C=Mt;Mt|=2;var A=Df();(Mn!==r||Bn!==o)&&(ve=null,ro=ht()+500,Ws(r,o));do try{Vz();break}catch(te){Dd(r,te)}while(!0);nd(),zt.current=A,Mt=C,fn!==null?o=0:(Mn=null,Bn=0,o=Nn)}if(o!==0){if(o===2&&(C=Dn(r),C!==0&&(_=C,o=Mr(r,C))),o===1)throw m=Go,Ws(r,0),ur(r,_),Cn(r,ht()),m;if(o===6)ur(r,_);else{if(C=r.current.alternate,!(_&30)&&!Hr(C)&&(o=Ac(r,_),o===2&&(A=Dn(r),A!==0&&(_=A,o=Mr(r,A))),o===1))throw m=Go,Ws(r,0),ur(r,_),Cn(r,ht()),m;switch(r.finishedWork=C,r.finishedLanes=_,o){case 0:case 1:throw Error(n(345));case 2:li(r,ws,ve);break;case 3:if(ur(r,_),(_&130023424)===_&&(o=kc+500-ht(),10<o)){if(xn(r,0)!==0)break;if(C=r.suspendedLanes,(C&_)!==_){pn(),r.pingedLanes|=r.suspendedLanes&C;break}r.timeoutHandle=Vu(li.bind(null,r,ws,ve),o);break}li(r,ws,ve);break;case 4:if(ur(r,_),(_&4194240)===_)break;for(o=r.eventTimes,C=-1;0<_;){var I=31-Ee(_);A=1<<I,I=o[I],I>C&&(C=I),_&=~A}if(_=C,_=ht()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*ia(_/1960))-_,10<_){r.timeoutHandle=Vu(li.bind(null,r,ws,ve),_);break}li(r,ws,ve);break;case 5:li(r,ws,ve);break;default:throw Error(n(329))}}}return Cn(r,ht()),r.callbackNode===m?qr.bind(null,r):null}function Mr(r,o){var m=Qo;return r.current.memoizedState.isDehydrated&&(Ws(r,o).flags|=256),r=Ac(r,o),r!==2&&(o=ws,ws=m,o!==null&&Ar(o)),r}function Ar(r){ws===null?ws=r:ws.push.apply(ws,r)}function Hr(r){for(var o=r;;){if(o.flags&16384){var m=o.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var _=0;_<m.length;_++){var C=m[_],A=C.getSnapshot;C=C.value;try{if(!jr(A(),C))return!1}catch{return!1}}}if(m=o.child,o.subtreeFlags&16384&&m!==null)m.return=o,o=m;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ur(r,o){for(o&=~Ec,o&=~oi,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var m=31-Ee(o),_=1<<m;r[m]=-1,o&=~_}}function ao(r){if(Mt&6)throw Error(n(327));Oc();var o=xn(r,0);if(!(o&1))return Cn(r,ht()),null;var m=Ac(r,o);if(r.tag!==0&&m===2){var _=Dn(r);_!==0&&(o=_,m=Mr(r,_))}if(m===1)throw m=Go,Ws(r,0),ur(r,o),Cn(r,ht()),m;if(m===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,li(r,ws,ve),Cn(r,ht()),null}function cs(r,o){var m=Mt;Mt|=1;try{return r(o)}finally{Mt=m,Mt===0&&(ro=ht()+500,oc&&na())}}function Dt(r){dt!==null&&dt.tag===0&&!(Mt&6)&&Oc();var o=Mt;Mt|=1;var m=Hs.transition,_=Ct;try{if(Hs.transition=null,Ct=1,r)return r()}finally{Ct=_,Hs.transition=m,Mt=o,!(Mt&6)&&na()}}function dr(){Ts=so.current,Ut(so)}function Ws(r,o){r.finishedWork=null,r.finishedLanes=0;var m=r.timeoutHandle;if(m!==-1&&(r.timeoutHandle=-1,r_(m)),fn!==null)for(m=fn.return;m!==null;){var _=m;switch(Xu(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&rc();break;case 3:eo(),Ut(bs),Ut(Qn),ud();break;case 5:id(_);break;case 4:eo();break;case 13:Ut(an);break;case 19:Ut(an);break;case 10:sd(_.type._context);break;case 22:case 23:dr()}m=m.return}if(Mn=r,fn=r=Xo(r.current,null),Bn=Ts=o,Nn=0,Go=null,Ec=oi=Na=0,ws=Qo=null,Ja!==null){for(o=0;o<Ja.length;o++)if(m=Ja[o],_=m.interleaved,_!==null){m.interleaved=null;var C=_.next,A=m.pending;if(A!==null){var I=A.next;A.next=C,_.next=I}m.pending=_}Ja=null}return r}function Dd(r,o){do{var m=fn;try{if(nd(),Os.current=_c,Zl){for(var _=en.memoizedState;_!==null;){var C=_.queue;C!==null&&(C.pending=null),_=_.next}Zl=!1}if(wa=0,jn=kn=en=null,ei=!1,ti=0,zd.current=null,m===null||m.return===null){Nn=1,Go=o,fn=null;break}e:{var A=r,I=m.return,te=m,ae=o;if(o=Bn,te.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var fe=ae,Se=te,Ae=Se.tag;if(!(Se.mode&1)&&(Ae===0||Ae===11||Ae===15)){var Ne=Se.alternate;Ne?(Se.updateQueue=Ne.updateQueue,Se.memoizedState=Ne.memoizedState,Se.lanes=Ne.lanes):(Se.updateQueue=null,Se.memoizedState=null)}var qe=vf(I);if(qe!==null){qe.flags&=-257,yf(qe,I,te,A,o),qe.mode&1&&_f(A,fe,o),o=qe,ae=fe;var We=o.updateQueue;if(We===null){var Ye=new Set;Ye.add(ae),o.updateQueue=Ye}else We.add(ae);break e}else{if(!(o&1)){_f(A,fe,o),Mc();break e}ae=Error(n(426))}}else if(sn&&te.mode&1){var An=vf(I);if(An!==null){!(An.flags&65536)&&(An.flags|=256),yf(An,I,te,A,o),uc(Yo(ae,te));break e}}A=ae=Yo(ae,te),Nn!==4&&(Nn=2),Qo===null?Qo=[A]:Qo.push(A),A=I;do{switch(A.tag){case 3:A.flags|=65536,o&=-o,A.lanes|=o;var ie=pf(A,ae,o);qh(A,ie);break e;case 1:te=ae;var oe=A.type,me=A.stateNode;if(!(A.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(we===null||!we.has(me)))){A.flags|=65536,o&=-o,A.lanes|=o;var Te=gf(A,te,o);qh(A,Te);break e}}A=A.return}while(A!==null)}Jw(m)}catch(Qe){o=Qe,fn===m&&m!==null&&(fn=m=m.return);continue}break}while(!0)}function Df(){var r=zt.current;return zt.current=_c,r===null?_c:r}function Mc(){(Nn===0||Nn===3||Nn===2)&&(Nn=4),Mn===null||!(Na&268435455)&&!(oi&268435455)||ur(Mn,Bn)}function Ac(r,o){var m=Mt;Mt|=2;var _=Df();(Mn!==r||Bn!==o)&&(ve=null,Ws(r,o));do try{b_();break}catch(C){Dd(r,C)}while(!0);if(nd(),Mt=m,zt.current=_,fn!==null)throw Error(n(261));return Mn=null,Bn=0,Nn}function b_(){for(;fn!==null;)Xw(fn)}function Vz(){for(;fn!==null&&!rn();)Xw(fn)}function Xw(r){var o=tj(r.alternate,r,Ts);r.memoizedProps=r.pendingProps,o===null?Jw(r):fn=o,zd.current=null}function Jw(r){var o=r;do{var m=o.alternate;if(r=o.return,o.flags&32768){if(m=g_(m,o),m!==null){m.flags&=32767,fn=m;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Nn=6,fn=null;return}}else if(m=p_(m,o,Ts),m!==null){fn=m;return}if(o=o.sibling,o!==null){fn=o;return}fn=o=r}while(o!==null);Nn===0&&(Nn=5)}function li(r,o,m){var _=Ct,C=Hs.transition;try{Hs.transition=null,Ct=1,Wz(r,o,m,_)}finally{Hs.transition=C,Ct=_}return null}function Wz(r,o,m,_){do Oc();while(dt!==null);if(Mt&6)throw Error(n(327));m=r.finishedWork;var C=r.finishedLanes;if(m===null)return null;if(r.finishedWork=null,r.finishedLanes=0,m===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var A=m.lanes|m.childLanes;if(Co(r,A),r===Mn&&(fn=Mn=null,Bn=0),!(m.subtreeFlags&2064)&&!(m.flags&2064)||_e||(_e=!0,nj(Es,function(){return Oc(),null})),A=(m.flags&15990)!==0,m.subtreeFlags&15990||A){A=Hs.transition,Hs.transition=null;var I=Ct;Ct=1;var te=Mt;Mt|=4,zd.current=null,v_(r,m),Pf(m,r),hh(Wl),sr=!!Nr,Wl=Nr=null,r.current=m,y_(m),It(),Mt=te,Ct=I,Hs.transition=A}else r.current=m;if(_e&&(_e=!1,dt=r,At=C),A=r.pendingLanes,A===0&&(we=null),$t(m.stateNode),Cn(r,ht()),o!==null)for(_=r.onRecoverableError,m=0;m<o.length;m++)C=o[m],_(C.value,{componentStack:C.stack,digest:C.digest});if(de)throw de=!1,r=pe,pe=null,r;return At&1&&r.tag!==0&&Oc(),A=r.pendingLanes,A&1?r===tn?St++:(St=0,tn=r):St=0,na(),null}function Oc(){if(dt!==null){var r=Ui(At),o=Hs.transition,m=Ct;try{if(Hs.transition=null,Ct=16>r?16:r,dt===null)var _=!1;else{if(r=dt,dt=null,At=0,Mt&6)throw Error(n(331));var C=Mt;for(Mt|=4,He=r.current;He!==null;){var A=He,I=A.child;if(He.flags&16){var te=A.deletions;if(te!==null){for(var ae=0;ae<te.length;ae++){var fe=te[ae];for(He=fe;He!==null;){var Se=He;switch(Se.tag){case 0:case 11:case 15:ai(8,Se,A)}var Ae=Se.child;if(Ae!==null)Ae.return=Se,He=Ae;else for(;He!==null;){Se=He;var Ne=Se.sibling,qe=Se.return;if(Ef(Se),Se===fe){He=null;break}if(Ne!==null){Ne.return=qe,He=Ne;break}He=qe}}}var We=A.alternate;if(We!==null){var Ye=We.child;if(Ye!==null){We.child=null;do{var An=Ye.sibling;Ye.sibling=null,Ye=An}while(Ye!==null)}}He=A}}if(A.subtreeFlags&2064&&I!==null)I.return=A,He=I;else e:for(;He!==null;){if(A=He,A.flags&2048)switch(A.tag){case 0:case 11:case 15:ai(9,A,A.return)}var ie=A.sibling;if(ie!==null){ie.return=A.return,He=ie;break e}He=A.return}}var oe=r.current;for(He=oe;He!==null;){I=He;var me=I.child;if(I.subtreeFlags&2064&&me!==null)me.return=I,He=me;else e:for(I=oe;He!==null;){if(te=He,te.flags&2048)try{switch(te.tag){case 0:case 11:case 15:Sc(9,te)}}catch(Qe){Sn(te,te.return,Qe)}if(te===I){He=null;break e}var Te=te.sibling;if(Te!==null){Te.return=te.return,He=Te;break e}He=te.return}}if(Mt=C,na(),Ue&&typeof Ue.onPostCommitFiberRoot=="function")try{Ue.onPostCommitFiberRoot(xe,r)}catch{}_=!0}return _}finally{Ct=m,Hs.transition=o}}return!1}function Zw(r,o,m){o=Yo(m,o),o=pf(r,o,1),r=xa(r,o,1),o=pn(),r!==null&&(_s(r,1,o),Cn(r,o))}function Sn(r,o,m){if(r.tag===3)Zw(r,r,m);else for(;o!==null;){if(o.tag===3){Zw(o,r,m);break}else if(o.tag===1){var _=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(we===null||!we.has(_))){r=Yo(m,r),r=gf(o,r,1),o=xa(o,r,1),r=pn(),o!==null&&(_s(o,1,r),Cn(o,r));break}}o=o.return}}function Kz(r,o,m){var _=r.pingCache;_!==null&&_.delete(o),o=pn(),r.pingedLanes|=r.suspendedLanes&m,Mn===r&&(Bn&m)===m&&(Nn===4||Nn===3&&(Bn&130023424)===Bn&&500>ht()-kc?Ws(r,0):Ec|=m),Cn(r,o)}function ej(r,o){o===0&&(r.mode&1?(o=hn,hn<<=1,!(hn&130023424)&&(hn=4194304)):o=1);var m=pn();r=aa(r,o),r!==null&&(_s(r,o,m),Cn(r,m))}function Yz(r){var o=r.memoizedState,m=0;o!==null&&(m=o.retryLane),ej(r,m)}function Gz(r,o){var m=0;switch(r.tag){case 13:var _=r.stateNode,C=r.memoizedState;C!==null&&(m=C.retryLane);break;case 19:_=r.stateNode;break;default:throw Error(n(314))}_!==null&&_.delete(o),ej(r,m)}var tj;tj=function(r,o,m){if(r!==null)if(r.memoizedProps!==o.pendingProps||bs.current)as=!0;else{if(!(r.lanes&m)&&!(o.flags&128))return as=!1,f_(r,o,m);as=!!(r.flags&131072)}else as=!1,sn&&o.flags&1048576&&Th(o,ic,o.index);switch(o.lanes=0,o.tag){case 2:var _=o.type;no(r,o),r=o.pendingProps;var C=Ka(o,Qn.current);Wo(o,m),C=hd(null,o,_,r,C,m);var A=fd();return o.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,xs(_)?(A=!0,Ya(o)):A=!1,o.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,od(o),C.updater=vc,o.stateNode=C,C._reactInternals=o,wd(o,_,r,m),o=bc(null,o,_,!0,A,m)):(o.tag=0,sn&&A&&Qu(o),os(null,o,C,m),o=o.child),o;case 16:_=o.elementType;e:{switch(no(r,o),r=o.pendingProps,C=_._init,_=C(_._payload),o.type=_,C=o.tag=Xz(_),r=Sr(_,r),C){case 0:o=yc(null,o,_,r,m);break e;case 1:o=kd(null,o,_,r,m);break e;case 11:o=Cd(null,o,_,r,m);break e;case 14:o=Sd(null,o,_,Sr(_.type,r),m);break e}throw Error(n(306,_,""))}return o;case 0:return _=o.type,C=o.pendingProps,C=o.elementType===_?C:Sr(_,C),yc(r,o,_,C,m);case 1:return _=o.type,C=o.pendingProps,C=o.elementType===_?C:Sr(_,C),kd(r,o,_,C,m);case 3:e:{if(Md(o),r===null)throw Error(n(387));_=o.pendingProps,A=o.memoizedState,C=A.element,Uh(r,o),hc(o,_,null,m);var I=o.memoizedState;if(_=I.element,A.isDehydrated)if(A={element:_,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=A,o.memoizedState=A,o.flags&256){C=Yo(Error(n(423)),o),o=xc(r,o,_,m,C);break e}else if(_!==C){C=Yo(Error(n(424)),o),o=xc(r,o,_,m,C);break e}else for(qs=zr(o.stateNode.containerInfo.firstChild),Us=o,sn=!0,Cr=null,m=Ih(o,null,_,m),o.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(Uo(),_===C){o=Br(r,o,m);break e}os(r,o,_,m)}o=o.child}return o;case 5:return Vh(o),r===null&&Zu(o),_=o.type,C=o.pendingProps,A=r!==null?r.memoizedProps:null,I=C.children,Hu(_,C)?I=null:A!==null&&Hu(_,A)&&(o.flags|=32),la(r,o),os(r,o,I,m),o.child;case 6:return r===null&&Zu(o),null;case 13:return Ad(r,o,m);case 4:return ld(o,o.stateNode.containerInfo),_=o.pendingProps,r===null?o.child=Xa(o,null,_,m):os(r,o,_,m),o.child;case 11:return _=o.type,C=o.pendingProps,C=o.elementType===_?C:Sr(_,C),Cd(r,o,_,C,m);case 7:return os(r,o,o.pendingProps,m),o.child;case 8:return os(r,o,o.pendingProps.children,m),o.child;case 12:return os(r,o,o.pendingProps.children,m),o.child;case 10:e:{if(_=o.type._context,C=o.pendingProps,A=o.memoizedProps,I=C.value,Tt(Ho,_._currentValue),_._currentValue=I,A!==null)if(jr(A.value,I)){if(A.children===C.children&&!bs.current){o=Br(r,o,m);break e}}else for(A=o.child,A!==null&&(A.return=o);A!==null;){var te=A.dependencies;if(te!==null){I=A.child;for(var ae=te.firstContext;ae!==null;){if(ae.context===_){if(A.tag===1){ae=oa(-1,m&-m),ae.tag=2;var fe=A.updateQueue;if(fe!==null){fe=fe.shared;var Se=fe.pending;Se===null?ae.next=ae:(ae.next=Se.next,Se.next=ae),fe.pending=ae}}A.lanes|=m,ae=A.alternate,ae!==null&&(ae.lanes|=m),rd(A.return,m,o),te.lanes|=m;break}ae=ae.next}}else if(A.tag===10)I=A.type===o.type?null:A.child;else if(A.tag===18){if(I=A.return,I===null)throw Error(n(341));I.lanes|=m,te=I.alternate,te!==null&&(te.lanes|=m),rd(I,m,o),I=A.sibling}else I=A.child;if(I!==null)I.return=A;else for(I=A;I!==null;){if(I===o){I=null;break}if(A=I.sibling,A!==null){A.return=I.return,I=A;break}I=I.return}A=I}os(r,o,C.children,m),o=o.child}return o;case 9:return C=o.type,_=o.pendingProps.children,Wo(o,m),C=lr(C),_=_(C),o.flags|=1,os(r,o,_,m),o.child;case 14:return _=o.type,C=Sr(_,o.pendingProps),C=Sr(_.type,C),Sd(r,o,_,C,m);case 15:return Ed(r,o,o.type,o.pendingProps,m);case 17:return _=o.type,C=o.pendingProps,C=o.elementType===_?C:Sr(_,C),no(r,o),o.tag=1,xs(_)?(r=!0,Ya(o)):r=!1,Wo(o,m),hf(o,_,C),wd(o,_,C,m),bc(null,o,_,!0,r,m);case 19:return wf(r,o,m);case 22:return bf(r,o,m)}throw Error(n(156,o.tag))};function nj(r,o){return yr(r,o)}function Qz(r,o,m,_){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vr(r,o,m,_){return new Qz(r,o,m,_)}function x_(r){return r=r.prototype,!(!r||!r.isReactComponent)}function Xz(r){if(typeof r=="function")return x_(r)?1:0;if(r!=null){if(r=r.$$typeof,r===D)return 11;if(r===R)return 14}return 2}function Xo(r,o){var m=r.alternate;return m===null?(m=Vr(r.tag,o,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=o,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&14680064,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,o=r.dependencies,m.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m}function Rf(r,o,m,_,C,A){var I=2;if(_=r,typeof r=="function")x_(r)&&(I=1);else if(typeof r=="string")I=5;else e:switch(r){case $:return ii(m.children,C,A,o);case T:I=8,C|=8;break;case L:return r=Vr(12,m,o,C|2),r.elementType=L,r.lanes=A,r;case W:return r=Vr(13,m,o,C),r.elementType=W,r.lanes=A,r;case z:return r=Vr(19,m,o,C),r.elementType=z,r.lanes=A,r;case V:return Ff(m,C,A,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case P:I=10;break e;case O:I=9;break e;case D:I=11;break e;case R:I=14;break e;case U:I=16,_=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return o=Vr(I,m,o,C),o.elementType=r,o.type=_,o.lanes=A,o}function ii(r,o,m,_){return r=Vr(7,r,_,o),r.lanes=m,r}function Ff(r,o,m,_){return r=Vr(22,r,_,o),r.elementType=V,r.lanes=m,r.stateNode={isHidden:!1},r}function w_(r,o,m){return r=Vr(6,r,null,o),r.lanes=m,r}function j_(r,o,m){return o=Vr(4,r.children!==null?r.children:[],r.key,o),o.lanes=m,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function Jz(r,o,m,_,C){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ks(0),this.expirationTimes=ks(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ks(0),this.identifierPrefix=_,this.onRecoverableError=C,this.mutableSourceEagerHydrationData=null}function N_(r,o,m,_,C,A,I,te,ae){return r=new Jz(r,o,m,te,ae),o===1?(o=1,A===!0&&(o|=8)):o=0,A=Vr(3,null,null,o),r.current=A,A.stateNode=r,A.memoizedState={element:_,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},od(A),r}function Zz(r,o,m){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:_==null?null:""+_,children:r,containerInfo:o,implementation:m}}function sj(r){if(!r)return va;r=r._reactInternals;e:{if(zn(r)!==r||r.tag!==1)throw Error(n(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(xs(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(r.tag===1){var m=r.type;if(xs(m))return Oh(r,m,o)}return o}function rj(r,o,m,_,C,A,I,te,ae){return r=N_(m,_,!0,r,C,A,I,te,ae),r.context=sj(null),m=r.current,_=pn(),C=$s(m),A=oa(_,C),A.callback=o??null,xa(m,A,C),r.current.lanes=C,_s(r,C,_),Cn(r,_),r}function If(r,o,m,_){var C=o.current,A=pn(),I=$s(C);return m=sj(m),o.context===null?o.context=m:o.pendingContext=m,o=oa(A,I),o.payload={element:r},_=_===void 0?null:_,_!==null&&(o.callback=_),r=xa(C,o,I),r!==null&&(Un(r,C,I,A),mc(r,C,I)),I}function Bf(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function aj(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<o?m:o}}function C_(r,o){aj(r,o),(r=r.alternate)&&aj(r,o)}function eD(){return null}var oj=typeof reportError=="function"?reportError:function(r){console.error(r)};function S_(r){this._internalRoot=r}Uf.prototype.render=S_.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));If(r,o,null,null)},Uf.prototype.unmount=S_.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;Dt(function(){If(null,r,null,null)}),o[ea]=null}};function Uf(r){this._internalRoot=r}Uf.prototype.unstable_scheduleHydration=function(r){if(r){var o=Hi();r={blockedOn:null,target:r,priority:o};for(var m=0;m<Oe.length&&o!==0&&o<Oe[m].priority;m++);Oe.splice(m,0,r),m===0&&ft(r)}};function E_(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function qf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function lj(){}function tD(r,o,m,_,C){if(C){if(typeof _=="function"){var A=_;_=function(){var fe=Bf(I);A.call(fe)}}var I=rj(o,_,r,0,null,!1,!1,"",lj);return r._reactRootContainer=I,r[ea]=I.current,Hl(r.nodeType===8?r.parentNode:r),Dt(),I}for(;C=r.lastChild;)r.removeChild(C);if(typeof _=="function"){var te=_;_=function(){var fe=Bf(ae);te.call(fe)}}var ae=N_(r,0,!1,null,null,!1,!1,"",lj);return r._reactRootContainer=ae,r[ea]=ae.current,Hl(r.nodeType===8?r.parentNode:r),Dt(function(){If(o,ae,m,_)}),ae}function Hf(r,o,m,_,C){var A=m._reactRootContainer;if(A){var I=A;if(typeof C=="function"){var te=C;C=function(){var ae=Bf(I);te.call(ae)}}If(o,I,r,C)}else I=tD(m,o,r,C,_);return Bf(I)}Ol=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var m=Qt(o.pendingLanes);m!==0&&(Al(o,m|1),Cn(o,ht()),!(Mt&6)&&(ro=ht()+500,na()))}break;case 13:Dt(function(){var _=aa(r,1);if(_!==null){var C=pn();Un(_,r,1,C)}}),C_(r,1)}},Pl=function(r){if(r.tag===13){var o=aa(r,134217728);if(o!==null){var m=pn();Un(o,r,134217728,m)}C_(r,134217728)}},qi=function(r){if(r.tag===13){var o=$s(r),m=aa(r,o);if(m!==null){var _=pn();Un(m,r,o,_)}C_(r,o)}},Hi=function(){return Ct},Tl=function(r,o){var m=Ct;try{return Ct=r,o()}finally{Ct=m}},Hn=function(r,o,m){switch(o){case"input":if(ue(r,m),o=m.name,m.type==="radio"&&o!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<m.length;o++){var _=m[o];if(_!==r&&_.form===r.form){var C=Yl(_);if(!C)throw Error(n(90));Pe(_),ue(_,C)}}}break;case"textarea":et(r,m);break;case"select":o=m.value,o!=null&&Ve(r,!!m.multiple,o,!1)}},yt=cs,Zs=Dt;var nD={usingClientEntryPoint:!1,Events:[Fo,Ha,Yl,cn,En,cs]},Rd={findFiberByHostInstance:qa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sD={bundleType:Rd.bundleType,version:Rd.version,rendererPackageName:Rd.rendererPackageName,rendererConfig:Rd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Rs(r),r===null?null:r.stateNode},findFiberByHostInstance:Rd.findFiberByHostInstance||eD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vf.isDisabled&&Vf.supportsFiber)try{xe=Vf.inject(sD),Ue=Vf}catch{}}return Ks.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nD,Ks.createPortal=function(r,o){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!E_(o))throw Error(n(200));return Zz(r,o,null,m)},Ks.createRoot=function(r,o){if(!E_(r))throw Error(n(299));var m=!1,_="",C=oj;return o!=null&&(o.unstable_strictMode===!0&&(m=!0),o.identifierPrefix!==void 0&&(_=o.identifierPrefix),o.onRecoverableError!==void 0&&(C=o.onRecoverableError)),o=N_(r,1,!1,null,null,m,!1,_,C),r[ea]=o.current,Hl(r.nodeType===8?r.parentNode:r),new S_(o)},Ks.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=Rs(o),r=r===null?null:r.stateNode,r},Ks.flushSync=function(r){return Dt(r)},Ks.hydrate=function(r,o,m){if(!qf(o))throw Error(n(200));return Hf(null,r,o,!0,m)},Ks.hydrateRoot=function(r,o,m){if(!E_(r))throw Error(n(405));var _=m!=null&&m.hydratedSources||null,C=!1,A="",I=oj;if(m!=null&&(m.unstable_strictMode===!0&&(C=!0),m.identifierPrefix!==void 0&&(A=m.identifierPrefix),m.onRecoverableError!==void 0&&(I=m.onRecoverableError)),o=rj(o,null,r,1,m??null,C,!1,A,I),r[ea]=o.current,Hl(r),_)for(r=0;r<_.length;r++)m=_[r],C=m._getVersion,C=C(m._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[m,C]:o.mutableSourceEagerHydrationData.push(m,C);return new Uf(o)},Ks.render=function(r,o,m){if(!qf(o))throw Error(n(200));return Hf(null,r,o,!1,m)},Ks.unmountComponentAtNode=function(r){if(!qf(r))throw Error(n(40));return r._reactRootContainer?(Dt(function(){Hf(null,null,r,!1,function(){r._reactRootContainer=null,r[ea]=null})}),!0):!1},Ks.unstable_batchedUpdates=cs,Ks.unstable_renderSubtreeIntoContainer=function(r,o,m,_){if(!qf(m))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return Hf(r,o,m,!1,_)},Ks.version="18.3.1-next-f1338f8080-20240426",Ks}function q_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(q_)}catch(e){console.error(e)}}q_(),F_.exports=fj();var H_=F_.exports,V_=H_;Yf.createRoot=V_.createRoot,Yf.hydrateRoot=V_.hydrateRoot;var ci=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},pj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},gj=(Iw=class{constructor(){Je(this,go,pj);Je(this,qg,!1)}setTimeoutProvider(e){Ie(this,go,e)}setTimeout(e,t){return ne(this,go).setTimeout(e,t)}clearTimeout(e){ne(this,go).clearTimeout(e)}setInterval(e,t){return ne(this,go).setInterval(e,t)}clearInterval(e){ne(this,go).clearInterval(e)}},go=new WeakMap,qg=new WeakMap,Iw),tl=new gj;function _j(e){setTimeout(e,0)}var nl=typeof window>"u"||"Deno"in globalThis;function Ls(){}function vj(e,t){return typeof e=="function"?e(t):e}function Xf(e){return typeof e=="number"&&e>=0&&e!==1/0}function W_(e,t){return Math.max(e+(t||0)-Date.now(),0)}function lo(e,t){return typeof e=="function"?e(t):e}function Or(e,t){return typeof e=="function"?e(t):e}function K_(e,t){const{type:n="all",exact:s,fetchStatus:l,predicate:i,queryKey:c,stale:u}=e;if(c){if(s){if(t.queryHash!==Jf(c,t.options))return!1}else if(!Pc(t.queryKey,c))return!1}if(n!=="all"){const d=t.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||l&&l!==t.state.fetchStatus||i&&!i(t))}function Y_(e,t){const{exact:n,status:s,predicate:l,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(sl(t.options.mutationKey)!==sl(i))return!1}else if(!Pc(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||l&&!l(t))}function Jf(e,t){return((t==null?void 0:t.queryKeyHashFn)||sl)(e)}function sl(e){return JSON.stringify(e,(t,n)=>Zf(n)?Object.keys(n).sort().reduce((s,l)=>(s[l]=n[l],s),{}):n)}function Pc(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Pc(e[n],t[n])):!1}var yj=Object.prototype.hasOwnProperty;function G_(e,t){if(e===t)return e;const n=Q_(e)&&Q_(t);if(!n&&!(Zf(e)&&Zf(t)))return t;const l=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),c=i.length,u=n?new Array(c):{};let d=0;for(let p=0;p<c;p++){const h=n?p:i[p],f=e[h],g=t[h];if(f===g){u[h]=f,(n?p<l:yj.call(e,h))&&d++;continue}if(f===null||g===null||typeof f!="object"||typeof g!="object"){u[h]=g;continue}const w=G_(f,g);u[h]=w,w===f&&d++}return l===c&&d===l?e:u}function Id(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function Q_(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Zf(e){if(!X_(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!X_(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function X_(e){return Object.prototype.toString.call(e)==="[object Object]"}function bj(e){return new Promise(t=>{tl.setTimeout(t,e)})}function ep(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?G_(e,t):t}function xj(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function wj(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var tp=Symbol();function J_(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===tp?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function Z_(e,t){return typeof e=="function"?e(...t):!!e}var jj=(Bw=class extends ci{constructor(){super();Je(this,xl);Je(this,_o);Je(this,Ai);Ie(this,Ai,t=>{if(!nl&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ne(this,_o)||this.setEventListener(ne(this,Ai))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,_o))==null||t.call(this),Ie(this,_o,void 0))}setEventListener(t){var n;Ie(this,Ai,t),(n=ne(this,_o))==null||n.call(this),Ie(this,_o,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){ne(this,xl)!==t&&(Ie(this,xl,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof ne(this,xl)=="boolean"?ne(this,xl):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},xl=new WeakMap,_o=new WeakMap,Ai=new WeakMap,Bw),np=new jj;function sp(){let e,t;const n=new Promise((l,i)=>{e=l,t=i});n.status="pending",n.catch(()=>{});function s(l){Object.assign(n,l),delete n.resolve,delete n.reject}return n.resolve=l=>{s({status:"fulfilled",value:l}),e(l)},n.reject=l=>{s({status:"rejected",reason:l}),t(l)},n}var Nj=_j;function Cj(){let e=[],t=0,n=u=>{u()},s=u=>{u()},l=Nj;const i=u=>{t?e.push(u):l(()=>{n(u)})},c=()=>{const u=e;e=[],u.length&&l(()=>{s(()=>{u.forEach(d=>{n(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{i(()=>{u(...d)})},schedule:i,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{l=u}}}var qn=Cj(),Sj=(Uw=class extends ci{constructor(){super();Je(this,Oi,!0);Je(this,vo);Je(this,Pi);Ie(this,Pi,t=>{if(!nl&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){ne(this,vo)||this.setEventListener(ne(this,Pi))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,vo))==null||t.call(this),Ie(this,vo,void 0))}setEventListener(t){var n;Ie(this,Pi,t),(n=ne(this,vo))==null||n.call(this),Ie(this,vo,t(this.setOnline.bind(this)))}setOnline(t){ne(this,Oi)!==t&&(Ie(this,Oi,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return ne(this,Oi)}},Oi=new WeakMap,vo=new WeakMap,Pi=new WeakMap,Uw),Bd=new Sj;function Ej(e){return Math.min(1e3*2**e,3e4)}function ev(e){return(e??"online")==="online"?Bd.isOnline():!0}var rp=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function tv(e){let t=!1,n=0,s;const l=sp(),i=()=>l.status!=="pending",c=b=>{var x;if(!i()){const N=new rp(b);g(N),(x=e.onCancel)==null||x.call(e,N)}},u=()=>{t=!0},d=()=>{t=!1},p=()=>np.isFocused()&&(e.networkMode==="always"||Bd.isOnline())&&e.canRun(),h=()=>ev(e.networkMode)&&e.canRun(),f=b=>{i()||(s==null||s(),l.resolve(b))},g=b=>{i()||(s==null||s(),l.reject(b))},w=()=>new Promise(b=>{var x;s=N=>{(i()||p())&&b(N)},(x=e.onPause)==null||x.call(e)}).then(()=>{var b;s=void 0,i()||(b=e.onContinue)==null||b.call(e)}),y=()=>{if(i())return;let b;const x=n===0?e.initialPromise:void 0;try{b=x??e.fn()}catch(N){b=Promise.reject(N)}Promise.resolve(b).then(f).catch(N=>{var M;if(i())return;const E=e.retry??(nl?0:3),k=e.retryDelay??Ej,j=typeof k=="function"?k(n,N):k,S=E===!0||typeof E=="number"&&n<E||typeof E=="function"&&E(n,N);if(t||!S){g(N);return}n++,(M=e.onFail)==null||M.call(e,n,N),bj(j).then(()=>p()?void 0:w()).then(()=>{t?g(N):y()})})};return{promise:l,status:()=>l.status,cancel:c,continue:()=>(s==null||s(),l),cancelRetry:u,continueRetry:d,canStart:h,start:()=>(h()?y():w().then(y),l)}}var nv=(qw=class{constructor(){Je(this,wl)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Xf(this.gcTime)&&Ie(this,wl,tl.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(nl?1/0:5*60*1e3))}clearGcTimeout(){ne(this,wl)&&(tl.clearTimeout(ne(this,wl)),Ie(this,wl,void 0))}},wl=new WeakMap,qw),kj={NODE_ENV:"production"},Mj=(Hw=class extends nv{constructor(t){super();Je(this,Qr);Je(this,jl);Je(this,Ti);Je(this,Pr);Je(this,Nl);Je(this,Zn);Je(this,vu);Je(this,Cl);Ie(this,Cl,!1),Ie(this,vu,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ie(this,Nl,t.client),Ie(this,Pr,ne(this,Nl).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ie(this,jl,rv(this.options)),this.state=t.state??ne(this,jl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ne(this,Zn))==null?void 0:t.promise}setOptions(t){if(this.options={...ne(this,vu),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=rv(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),Ie(this,jl,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ne(this,Pr).remove(this)}setData(t,n){const s=ep(this.state.data,t,this.options);return Nt(this,Qr,oo).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){Nt(this,Qr,oo).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,l;const n=(s=ne(this,Zn))==null?void 0:s.promise;return(l=ne(this,Zn))==null||l.cancel(t),n?n.then(Ls).catch(Ls):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ne(this,jl))}isActive(){return this.observers.some(t=>Or(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===tp||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>lo(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!W_(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,Zn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,Zn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ne(this,Pr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(ne(this,Zn)&&(ne(this,Cl)?ne(this,Zn).cancel({revert:!0}):ne(this,Zn).cancelRetry()),this.scheduleGc()),ne(this,Pr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Nt(this,Qr,oo).call(this,{type:"invalidate"})}async fetch(t,n){var d,p,h,f,g,w,y,b,x,N,E,k;if(this.state.fetchStatus!=="idle"&&((d=ne(this,Zn))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ne(this,Zn))return ne(this,Zn).continueRetry(),ne(this,Zn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(S=>S.options.queryFn);j&&this.setOptions(j.options)}const s=new AbortController,l=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(Ie(this,Cl,!0),s.signal)})},i=()=>{const j=J_(this.options,n),M=(()=>{const $={client:ne(this,Nl),queryKey:this.queryKey,meta:this.meta};return l($),$})();return Ie(this,Cl,!1),this.options.persister?this.options.persister(j,M,this):j(M)},u=(()=>{const j={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:ne(this,Nl),state:this.state,fetchFn:i};return l(j),j})();(p=this.options.behavior)==null||p.onFetch(u,this),Ie(this,Ti,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=u.fetchOptions)==null?void 0:h.meta))&&Nt(this,Qr,oo).call(this,{type:"fetch",meta:(f=u.fetchOptions)==null?void 0:f.meta}),Ie(this,Zn,tv({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,onCancel:j=>{j instanceof rp&&j.revert&&this.setState({...ne(this,Ti),fetchStatus:"idle"}),s.abort()},onFail:(j,S)=>{Nt(this,Qr,oo).call(this,{type:"failed",failureCount:j,error:S})},onPause:()=>{Nt(this,Qr,oo).call(this,{type:"pause"})},onContinue:()=>{Nt(this,Qr,oo).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const j=await ne(this,Zn).start();if(j===void 0)throw kj.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(j),(w=(g=ne(this,Pr).config).onSuccess)==null||w.call(g,j,this),(b=(y=ne(this,Pr).config).onSettled)==null||b.call(y,j,this.state.error,this),j}catch(j){if(j instanceof rp){if(j.silent)return ne(this,Zn).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw Nt(this,Qr,oo).call(this,{type:"error",error:j}),(N=(x=ne(this,Pr).config).onError)==null||N.call(x,j,this),(k=(E=ne(this,Pr).config).onSettled)==null||k.call(E,this.state.data,j,this),j}finally{this.scheduleGc()}}},jl=new WeakMap,Ti=new WeakMap,Pr=new WeakMap,Nl=new WeakMap,Zn=new WeakMap,vu=new WeakMap,Cl=new WeakMap,Qr=new WeakSet,oo=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...sv(s.data,this.options),fetchMeta:t.meta??null};case"success":const l={...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Ie(this,Ti,t.manual?l:void 0),l;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),qn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),ne(this,Pr).notify({query:this,type:"updated",action:t})})},Hw);function sv(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ev(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function rv(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var Aj=(Vw=class extends ci{constructor(t,n){super();Je(this,Ht);Je(this,Xs);Je(this,Ot);Je(this,yu);Je(this,zs);Je(this,Sl);Je(this,$i);Je(this,Pa);Je(this,yo);Je(this,bu);Je(this,Li);Je(this,zi);Je(this,El);Je(this,kl);Je(this,bo);Je(this,Di,new Set);this.options=n,Ie(this,Xs,t),Ie(this,yo,null),Ie(this,Pa,sp()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ne(this,Ot).addObserver(this),av(ne(this,Ot),this.options)?Nt(this,Ht,Fd).call(this):this.updateResult(),Nt(this,Ht,P_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return ap(ne(this,Ot),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return ap(ne(this,Ot),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,Nt(this,Ht,T_).call(this),Nt(this,Ht,$_).call(this),ne(this,Ot).removeObserver(this)}setOptions(t){const n=this.options,s=ne(this,Ot);if(this.options=ne(this,Xs).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Or(this.options.enabled,ne(this,Ot))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");Nt(this,Ht,L_).call(this),ne(this,Ot).setOptions(this.options),n._defaulted&&!Id(this.options,n)&&ne(this,Xs).getQueryCache().notify({type:"observerOptionsUpdated",query:ne(this,Ot),observer:this});const l=this.hasListeners();l&&ov(ne(this,Ot),s,this.options,n)&&Nt(this,Ht,Fd).call(this),this.updateResult(),l&&(ne(this,Ot)!==s||Or(this.options.enabled,ne(this,Ot))!==Or(n.enabled,ne(this,Ot))||lo(this.options.staleTime,ne(this,Ot))!==lo(n.staleTime,ne(this,Ot)))&&Nt(this,Ht,M_).call(this);const i=Nt(this,Ht,A_).call(this);l&&(ne(this,Ot)!==s||Or(this.options.enabled,ne(this,Ot))!==Or(n.enabled,ne(this,Ot))||i!==ne(this,bo))&&Nt(this,Ht,O_).call(this,i)}getOptimisticResult(t){const n=ne(this,Xs).getQueryCache().build(ne(this,Xs),t),s=this.createResult(n,t);return Pj(this,s)&&(Ie(this,zs,s),Ie(this,$i,this.options),Ie(this,Sl,ne(this,Ot).state)),s}getCurrentResult(){return ne(this,zs)}trackResult(t,n){return new Proxy(t,{get:(s,l)=>(this.trackProp(l),n==null||n(l),l==="promise"&&!this.options.experimental_prefetchInRender&&ne(this,Pa).status==="pending"&&ne(this,Pa).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(s,l))})}trackProp(t){ne(this,Di).add(t)}getCurrentQuery(){return ne(this,Ot)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=ne(this,Xs).defaultQueryOptions(t),s=ne(this,Xs).getQueryCache().build(ne(this,Xs),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(t){return Nt(this,Ht,Fd).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ne(this,zs)))}createResult(t,n){var L;const s=ne(this,Ot),l=this.options,i=ne(this,zs),c=ne(this,Sl),u=ne(this,$i),p=t!==s?t.state:ne(this,yu),{state:h}=t;let f={...h},g=!1,w;if(n._optimisticResults){const P=this.hasListeners(),O=!P&&av(t,n),D=P&&ov(t,s,n,l);(O||D)&&(f={...f,...sv(h.data,t.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:y,errorUpdatedAt:b,status:x}=f;w=f.data;let N=!1;if(n.placeholderData!==void 0&&w===void 0&&x==="pending"){let P;i!=null&&i.isPlaceholderData&&n.placeholderData===(u==null?void 0:u.placeholderData)?(P=i.data,N=!0):P=typeof n.placeholderData=="function"?n.placeholderData((L=ne(this,zi))==null?void 0:L.state.data,ne(this,zi)):n.placeholderData,P!==void 0&&(x="success",w=ep(i==null?void 0:i.data,P,n),g=!0)}if(n.select&&w!==void 0&&!N)if(i&&w===(c==null?void 0:c.data)&&n.select===ne(this,bu))w=ne(this,Li);else try{Ie(this,bu,n.select),w=n.select(w),w=ep(i==null?void 0:i.data,w,n),Ie(this,Li,w),Ie(this,yo,null)}catch(P){Ie(this,yo,P)}ne(this,yo)&&(y=ne(this,yo),w=ne(this,Li),b=Date.now(),x="error");const E=f.fetchStatus==="fetching",k=x==="pending",j=x==="error",S=k&&E,M=w!==void 0,T={status:x,fetchStatus:f.fetchStatus,isPending:k,isSuccess:x==="success",isError:j,isInitialLoading:S,isLoading:S,data:w,dataUpdatedAt:f.dataUpdatedAt,error:y,errorUpdatedAt:b,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>p.dataUpdateCount||f.errorUpdateCount>p.errorUpdateCount,isFetching:E,isRefetching:E&&!k,isLoadingError:j&&!M,isPaused:f.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:j&&M,isStale:op(t,n),refetch:this.refetch,promise:ne(this,Pa),isEnabled:Or(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const P=W=>{T.status==="error"?W.reject(T.error):T.data!==void 0&&W.resolve(T.data)},O=()=>{const W=Ie(this,Pa,T.promise=sp());P(W)},D=ne(this,Pa);switch(D.status){case"pending":t.queryHash===s.queryHash&&P(D);break;case"fulfilled":(T.status==="error"||T.data!==D.value)&&O();break;case"rejected":(T.status!=="error"||T.error!==D.reason)&&O();break}}return T}updateResult(){const t=ne(this,zs),n=this.createResult(ne(this,Ot),this.options);if(Ie(this,Sl,ne(this,Ot).state),Ie(this,$i,this.options),ne(this,Sl).data!==void 0&&Ie(this,zi,ne(this,Ot)),Id(n,t))return;Ie(this,zs,n);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,i=typeof l=="function"?l():l;if(i==="all"||!i&&!ne(this,Di).size)return!0;const c=new Set(i??ne(this,Di));return this.options.throwOnError&&c.add("error"),Object.keys(ne(this,zs)).some(u=>{const d=u;return ne(this,zs)[d]!==t[d]&&c.has(d)})};Nt(this,Ht,cj).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&Nt(this,Ht,P_).call(this)}},Xs=new WeakMap,Ot=new WeakMap,yu=new WeakMap,zs=new WeakMap,Sl=new WeakMap,$i=new WeakMap,Pa=new WeakMap,yo=new WeakMap,bu=new WeakMap,Li=new WeakMap,zi=new WeakMap,El=new WeakMap,kl=new WeakMap,bo=new WeakMap,Di=new WeakMap,Ht=new WeakSet,Fd=function(t){Nt(this,Ht,L_).call(this);let n=ne(this,Ot).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Ls)),n},M_=function(){Nt(this,Ht,T_).call(this);const t=lo(this.options.staleTime,ne(this,Ot));if(nl||ne(this,zs).isStale||!Xf(t))return;const s=W_(ne(this,zs).dataUpdatedAt,t)+1;Ie(this,El,tl.setTimeout(()=>{ne(this,zs).isStale||this.updateResult()},s))},A_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ne(this,Ot)):this.options.refetchInterval)??!1},O_=function(t){Nt(this,Ht,$_).call(this),Ie(this,bo,t),!(nl||Or(this.options.enabled,ne(this,Ot))===!1||!Xf(ne(this,bo))||ne(this,bo)===0)&&Ie(this,kl,tl.setInterval(()=>{(this.options.refetchIntervalInBackground||np.isFocused())&&Nt(this,Ht,Fd).call(this)},ne(this,bo)))},P_=function(){Nt(this,Ht,M_).call(this),Nt(this,Ht,O_).call(this,Nt(this,Ht,A_).call(this))},T_=function(){ne(this,El)&&(tl.clearTimeout(ne(this,El)),Ie(this,El,void 0))},$_=function(){ne(this,kl)&&(tl.clearInterval(ne(this,kl)),Ie(this,kl,void 0))},L_=function(){const t=ne(this,Xs).getQueryCache().build(ne(this,Xs),this.options);if(t===ne(this,Ot))return;const n=ne(this,Ot);Ie(this,Ot,t),Ie(this,yu,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},cj=function(t){qn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(ne(this,zs))}),ne(this,Xs).getQueryCache().notify({query:ne(this,Ot),type:"observerResultsUpdated"})})},Vw);function Oj(e,t){return Or(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function av(e,t){return Oj(e,t)||e.state.data!==void 0&&ap(e,t,t.refetchOnMount)}function ap(e,t,n){if(Or(t.enabled,e)!==!1&&lo(t.staleTime,e)!=="static"){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&op(e,t)}return!1}function ov(e,t,n,s){return(e!==t||Or(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&op(e,n)}function op(e,t){return Or(t.enabled,e)!==!1&&e.isStaleByTime(lo(t.staleTime,e))}function Pj(e,t){return!Id(e.getCurrentResult(),t)}function lv(e){return{onFetch:(t,n)=>{var h,f,g,w,y;const s=t.options,l=(g=(f=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:g.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],c=((y=t.state.data)==null?void 0:y.pageParams)||[];let u={pages:[],pageParams:[]},d=0;const p=async()=>{let b=!1;const x=k=>{Object.defineProperty(k,"signal",{enumerable:!0,get:()=>(t.signal.aborted?b=!0:t.signal.addEventListener("abort",()=>{b=!0}),t.signal)})},N=J_(t.options,t.fetchOptions),E=async(k,j,S)=>{if(b)return Promise.reject();if(j==null&&k.pages.length)return Promise.resolve(k);const $=(()=>{const O={client:t.client,queryKey:t.queryKey,pageParam:j,direction:S?"backward":"forward",meta:t.options.meta};return x(O),O})(),T=await N($),{maxPages:L}=t.options,P=S?wj:xj;return{pages:P(k.pages,T,L),pageParams:P(k.pageParams,j,L)}};if(l&&i.length){const k=l==="backward",j=k?Tj:iv,S={pages:i,pageParams:c},M=j(s,S);u=await E(S,M,k)}else{const k=e??i.length;do{const j=d===0?c[0]??s.initialPageParam:iv(s,u);if(d>0&&j==null)break;u=await E(u,j),d++}while(d<k)}return u};t.options.persister?t.fetchFn=()=>{var b,x;return(x=(b=t.options).persister)==null?void 0:x.call(b,p,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=p}}}function iv(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function Tj(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var $j=(Ww=class extends nv{constructor(t){super();Je(this,fa);Je(this,xu);Je(this,ha);Je(this,Ds);Je(this,Ml);Ie(this,xu,t.client),this.mutationId=t.mutationId,Ie(this,Ds,t.mutationCache),Ie(this,ha,[]),this.state=t.state||cv(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ne(this,ha).includes(t)||(ne(this,ha).push(t),this.clearGcTimeout(),ne(this,Ds).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ie(this,ha,ne(this,ha).filter(n=>n!==t)),this.scheduleGc(),ne(this,Ds).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ne(this,ha).length||(this.state.status==="pending"?this.scheduleGc():ne(this,Ds).remove(this))}continue(){var t;return((t=ne(this,Ml))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var c,u,d,p,h,f,g,w,y,b,x,N,E,k,j,S,M,$,T,L;const n=()=>{Nt(this,fa,Zo).call(this,{type:"continue"})},s={client:ne(this,xu),meta:this.options.meta,mutationKey:this.options.mutationKey};Ie(this,Ml,tv({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(P,O)=>{Nt(this,fa,Zo).call(this,{type:"failed",failureCount:P,error:O})},onPause:()=>{Nt(this,fa,Zo).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ne(this,Ds).canRun(this)}));const l=this.state.status==="pending",i=!ne(this,Ml).canStart();try{if(l)n();else{Nt(this,fa,Zo).call(this,{type:"pending",variables:t,isPaused:i}),await((u=(c=ne(this,Ds).config).onMutate)==null?void 0:u.call(c,t,this,s));const O=await((p=(d=this.options).onMutate)==null?void 0:p.call(d,t,s));O!==this.state.context&&Nt(this,fa,Zo).call(this,{type:"pending",context:O,variables:t,isPaused:i})}const P=await ne(this,Ml).start();return await((f=(h=ne(this,Ds).config).onSuccess)==null?void 0:f.call(h,P,t,this.state.context,this,s)),await((w=(g=this.options).onSuccess)==null?void 0:w.call(g,P,t,this.state.context,s)),await((b=(y=ne(this,Ds).config).onSettled)==null?void 0:b.call(y,P,null,this.state.variables,this.state.context,this,s)),await((N=(x=this.options).onSettled)==null?void 0:N.call(x,P,null,t,this.state.context,s)),Nt(this,fa,Zo).call(this,{type:"success",data:P}),P}catch(P){try{throw await((k=(E=ne(this,Ds).config).onError)==null?void 0:k.call(E,P,t,this.state.context,this,s)),await((S=(j=this.options).onError)==null?void 0:S.call(j,P,t,this.state.context,s)),await(($=(M=ne(this,Ds).config).onSettled)==null?void 0:$.call(M,void 0,P,this.state.variables,this.state.context,this,s)),await((L=(T=this.options).onSettled)==null?void 0:L.call(T,void 0,P,t,this.state.context,s)),P}finally{Nt(this,fa,Zo).call(this,{type:"error",error:P})}}finally{ne(this,Ds).runNext(this)}}},xu=new WeakMap,ha=new WeakMap,Ds=new WeakMap,Ml=new WeakMap,fa=new WeakSet,Zo=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),qn.batch(()=>{ne(this,ha).forEach(s=>{s.onMutationUpdate(t)}),ne(this,Ds).notify({mutation:this,type:"updated",action:t})})},Ww);function cv(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Lj=(Kw=class extends ci{constructor(t={}){super();Je(this,Ta);Je(this,Xr);Je(this,wu);this.config=t,Ie(this,Ta,new Set),Ie(this,Xr,new Map),Ie(this,wu,0)}build(t,n,s){const l=new $j({client:t,mutationCache:this,mutationId:++Wf(this,wu)._,options:t.defaultMutationOptions(n),state:s});return this.add(l),l}add(t){ne(this,Ta).add(t);const n=Ud(t);if(typeof n=="string"){const s=ne(this,Xr).get(n);s?s.push(t):ne(this,Xr).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ne(this,Ta).delete(t)){const n=Ud(t);if(typeof n=="string"){const s=ne(this,Xr).get(n);if(s)if(s.length>1){const l=s.indexOf(t);l!==-1&&s.splice(l,1)}else s[0]===t&&ne(this,Xr).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Ud(t);if(typeof n=="string"){const s=ne(this,Xr).get(n),l=s==null?void 0:s.find(i=>i.state.status==="pending");return!l||l===t}else return!0}runNext(t){var s;const n=Ud(t);if(typeof n=="string"){const l=(s=ne(this,Xr).get(n))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(l==null?void 0:l.continue())??Promise.resolve()}else return Promise.resolve()}clear(){qn.batch(()=>{ne(this,Ta).forEach(t=>{this.notify({type:"removed",mutation:t})}),ne(this,Ta).clear(),ne(this,Xr).clear()})}getAll(){return Array.from(ne(this,Ta))}find(t){const n={exact:!0,...t};return this.getAll().find(s=>Y_(n,s))}findAll(t={}){return this.getAll().filter(n=>Y_(t,n))}notify(t){qn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return qn.batch(()=>Promise.all(t.map(n=>n.continue().catch(Ls))))}},Ta=new WeakMap,Xr=new WeakMap,wu=new WeakMap,Kw);function Ud(e){var t;return(t=e.options.scope)==null?void 0:t.id}var zj=(Yw=class extends ci{constructor(t,n){super();Je(this,za);Je(this,$a);Je(this,xo);Je(this,Js);Je(this,La);Ie(this,$a,t),this.setOptions(n),this.bindMethods(),Nt(this,za,Kf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const n=this.options;this.options=ne(this,$a).defaultMutationOptions(t),Id(this.options,n)||ne(this,$a).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ne(this,Js),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&sl(n.mutationKey)!==sl(this.options.mutationKey)?this.reset():((s=ne(this,Js))==null?void 0:s.state.status)==="pending"&&ne(this,Js).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=ne(this,Js))==null||t.removeObserver(this)}onMutationUpdate(t){Nt(this,za,Kf).call(this),Nt(this,za,z_).call(this,t)}getCurrentResult(){return ne(this,xo)}reset(){var t;(t=ne(this,Js))==null||t.removeObserver(this),Ie(this,Js,void 0),Nt(this,za,Kf).call(this),Nt(this,za,z_).call(this)}mutate(t,n){var s;return Ie(this,La,n),(s=ne(this,Js))==null||s.removeObserver(this),Ie(this,Js,ne(this,$a).getMutationCache().build(ne(this,$a),this.options)),ne(this,Js).addObserver(this),ne(this,Js).execute(t)}},$a=new WeakMap,xo=new WeakMap,Js=new WeakMap,La=new WeakMap,za=new WeakSet,Kf=function(){var n;const t=((n=ne(this,Js))==null?void 0:n.state)??cv();Ie(this,xo,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},z_=function(t){qn.batch(()=>{var n,s,l,i,c,u,d,p;if(ne(this,La)&&this.hasListeners()){const h=ne(this,xo).variables,f=ne(this,xo).context,g={client:ne(this,$a),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((s=(n=ne(this,La)).onSuccess)==null||s.call(n,t.data,h,f,g),(i=(l=ne(this,La)).onSettled)==null||i.call(l,t.data,null,h,f,g)):(t==null?void 0:t.type)==="error"&&((u=(c=ne(this,La)).onError)==null||u.call(c,t.error,h,f,g),(p=(d=ne(this,La)).onSettled)==null||p.call(d,void 0,t.error,h,f,g))}this.listeners.forEach(h=>{h(ne(this,xo))})})},Yw),Dj=(Gw=class extends ci{constructor(t={}){super();Je(this,pa);this.config=t,Ie(this,pa,new Map)}build(t,n,s){const l=n.queryKey,i=n.queryHash??Jf(l,n);let c=this.get(i);return c||(c=new Mj({client:t,queryKey:l,queryHash:i,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(l)}),this.add(c)),c}add(t){ne(this,pa).has(t.queryHash)||(ne(this,pa).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=ne(this,pa).get(t.queryHash);n&&(t.destroy(),n===t&&ne(this,pa).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){qn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ne(this,pa).get(t)}getAll(){return[...ne(this,pa).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>K_(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>K_(t,s)):n}notify(t){qn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){qn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){qn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},pa=new WeakMap,Gw),Rj=(Qw=class{constructor(e={}){Je(this,_n);Je(this,wo);Je(this,jo);Je(this,Ri);Je(this,Fi);Je(this,No);Je(this,Ii);Je(this,Bi);Ie(this,_n,e.queryCache||new Dj),Ie(this,wo,e.mutationCache||new Lj),Ie(this,jo,e.defaultOptions||{}),Ie(this,Ri,new Map),Ie(this,Fi,new Map),Ie(this,No,0)}mount(){Wf(this,No)._++,ne(this,No)===1&&(Ie(this,Ii,np.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,_n).onFocus())})),Ie(this,Bi,Bd.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,_n).onOnline())})))}unmount(){var e,t;Wf(this,No)._--,ne(this,No)===0&&((e=ne(this,Ii))==null||e.call(this),Ie(this,Ii,void 0),(t=ne(this,Bi))==null||t.call(this),Ie(this,Bi,void 0))}isFetching(e){return ne(this,_n).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ne(this,wo).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,_n).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=ne(this,_n).build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(lo(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return ne(this,_n).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),l=ne(this,_n).get(s.queryHash),i=l==null?void 0:l.state.data,c=vj(t,i);if(c!==void 0)return ne(this,_n).build(this,s).setData(c,{...n,manual:!0})}setQueriesData(e,t,n){return qn.batch(()=>ne(this,_n).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,_n).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=ne(this,_n);qn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=ne(this,_n);return qn.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=qn.batch(()=>ne(this,_n).findAll(e).map(l=>l.cancel(n)));return Promise.all(s).then(Ls).catch(Ls)}invalidateQueries(e,t={}){return qn.batch(()=>(ne(this,_n).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=qn.batch(()=>ne(this,_n).findAll(e).filter(l=>!l.isDisabled()&&!l.isStatic()).map(l=>{let i=l.fetch(void 0,n);return n.throwOnError||(i=i.catch(Ls)),l.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(Ls)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=ne(this,_n).build(this,t);return n.isStaleByTime(lo(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Ls).catch(Ls)}fetchInfiniteQuery(e){return e.behavior=lv(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Ls).catch(Ls)}ensureInfiniteQueryData(e){return e.behavior=lv(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Bd.isOnline()?ne(this,wo).resumePausedMutations():Promise.resolve()}getQueryCache(){return ne(this,_n)}getMutationCache(){return ne(this,wo)}getDefaultOptions(){return ne(this,jo)}setDefaultOptions(e){Ie(this,jo,e)}setQueryDefaults(e,t){ne(this,Ri).set(sl(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ne(this,Ri).values()],n={};return t.forEach(s=>{Pc(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){ne(this,Fi).set(sl(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ne(this,Fi).values()],n={};return t.forEach(s=>{Pc(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ne(this,jo).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Jf(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===tp&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ne(this,jo).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ne(this,_n).clear(),ne(this,wo).clear()}},_n=new WeakMap,wo=new WeakMap,jo=new WeakMap,Ri=new WeakMap,Fi=new WeakMap,No=new WeakMap,Ii=new WeakMap,Bi=new WeakMap,Qw),uv=v.createContext(void 0),rl=e=>{const t=v.useContext(uv);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Fj=({client:e,children:t})=>(v.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(uv.Provider,{value:e,children:t})),dv=v.createContext(!1),Ij=()=>v.useContext(dv);dv.Provider;function Bj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Uj=v.createContext(Bj()),qj=()=>v.useContext(Uj),Hj=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Vj=e=>{v.useEffect(()=>{e.clearReset()},[e])},Wj=({result:e,errorResetBoundary:t,throwOnError:n,query:s,suspense:l})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(l&&e.data===void 0||Z_(n,[e.error,s])),Kj=e=>{if(e.suspense){const n=l=>l==="static"?l:Math.max(l??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...l)=>n(s(...l)):n(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Yj=(e,t)=>e.isLoading&&e.isFetching&&!t,Gj=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,mv=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Qj(e,t,n){var f,g,w,y,b;const s=Ij(),l=qj(),i=rl(),c=i.defaultQueryOptions(e);(g=(f=i.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||g.call(f,c),c._optimisticResults=s?"isRestoring":"optimistic",Kj(c),Hj(c,l),Vj(l);const u=!i.getQueryCache().get(c.queryHash),[d]=v.useState(()=>new t(i,c)),p=d.getOptimisticResult(c),h=!s&&e.subscribed!==!1;if(v.useSyncExternalStore(v.useCallback(x=>{const N=h?d.subscribe(qn.batchCalls(x)):Ls;return d.updateResult(),N},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),v.useEffect(()=>{d.setOptions(c)},[c,d]),Gj(c,p))throw mv(c,d,l);if(Wj({result:p,errorResetBoundary:l,throwOnError:c.throwOnError,query:i.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;if((y=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||y.call(w,c,p),c.experimental_prefetchInRender&&!nl&&Yj(p,s)){const x=u?mv(c,d,l):(b=i.getQueryCache().get(c.queryHash))==null?void 0:b.promise;x==null||x.catch(Ls).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?p:d.trackResult(p)}function mr(e,t){return Qj(e,Aj)}function qd(e,t){const n=rl(),[s]=v.useState(()=>new zj(n,e));v.useEffect(()=>{s.setOptions(e)},[s,e]);const l=v.useSyncExternalStore(v.useCallback(c=>s.subscribe(qn.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((c,u)=>{s.mutate(c,u).catch(Ls)},[s]);if(l.error&&Z_(s.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:i,mutateAsync:l.mutate}}function Xj(e){let t;const n=new Set,s=(p,h)=>{const f=typeof p=="function"?p(t):p;if(f!==t){const g=t;t=h?f:Object.assign({},t,f),n.forEach(w=>w(t,g))}},l=()=>t,i=(p,h=l,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let g=h(t);function w(){const y=h(t);if(!f(g,y)){const b=g;p(g=y,b)}}return n.add(w),()=>n.delete(w)},d={setState:s,getState:l,subscribe:(p,h,f)=>h||f?i(p,h,f):(n.add(p),()=>n.delete(p)),destroy:()=>n.clear()};return t=e(s,l,d),d}const hv=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?v.useEffect:v.useLayoutEffect;function Jj(e){const t=typeof e=="function"?Xj(e):e,n=(s=t.getState,l=Object.is)=>{const[,i]=v.useReducer(x=>x+1,0),c=t.getState(),u=v.useRef(c),d=v.useRef(s),p=v.useRef(l),h=v.useRef(!1),f=v.useRef();f.current===void 0&&(f.current=s(c));let g,w=!1;(u.current!==c||d.current!==s||p.current!==l||h.current)&&(g=s(c),w=!l(f.current,g)),hv(()=>{w&&(f.current=g),u.current=c,d.current=s,p.current=l,h.current=!1});const y=v.useRef(c);hv(()=>{const x=()=>{try{const E=t.getState(),k=d.current(E);p.current(f.current,k)||(u.current=E,f.current=k,i())}catch{h.current=!0,i()}},N=t.subscribe(x);return t.getState()!==y.current&&x(),N},[]);const b=w?g:f.current;return v.useDebugValue(b),b};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[n,t];return{next(){const l=s.length<=0;return{value:s.shift(),done:l}}}},n}function Zj(){const e=v.createContext(void 0);return{Provider:({initialStore:l,createStore:i,children:c})=>{const u=v.useRef();return u.current||(l&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),i||(i=()=>l)),u.current=i()),v.createElement(e.Provider,{value:u.current},c)},useStore:(l,i=Object.is)=>{const c=v.useContext(e);if(!c)throw new Error("Seems like you have not used zustand provider as an ancestor.");return c(l,i)},useStoreApi:()=>{const l=v.useContext(e);if(!l)throw new Error("Seems like you have not used zustand provider as an ancestor.");return v.useMemo(()=>({getState:l.getState,setState:l.setState,subscribe:l.subscribe,destroy:l.destroy}),[l])}}}var eN={value:()=>{}};function Hd(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new Vd(n)}function Vd(e){this._=e}function tN(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",l=n.indexOf(".");if(l>=0&&(s=n.slice(l+1),n=n.slice(0,l)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}Vd.prototype=Hd.prototype={constructor:Vd,on:function(e,t){var n=this._,s=tN(e+"",n),l,i=-1,c=s.length;if(arguments.length<2){for(;++i<c;)if((l=(e=s[i]).type)&&(l=nN(n[l],e.name)))return l;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<c;)if(l=(e=s[i]).type)n[l]=fv(n[l],e.name,t);else if(t==null)for(l in n)n[l]=fv(n[l],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Vd(e)},call:function(e,t){if((l=arguments.length-2)>0)for(var n=new Array(l),s=0,l,i;s<l;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],s=0,l=i.length;s<l;++s)i[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],l=0,i=s.length;l<i;++l)s[l].value.apply(t,n)}};function nN(e,t){for(var n=0,s=e.length,l;n<s;++n)if((l=e[n]).name===t)return l.value}function fv(e,t,n){for(var s=0,l=e.length;s<l;++s)if(e[s].name===t){e[s]=eN,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var lp="http://www.w3.org/1999/xhtml";const pv={svg:"http://www.w3.org/2000/svg",xhtml:lp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Wd(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),pv.hasOwnProperty(t)?{space:pv[t],local:e}:e}function sN(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===lp&&t.documentElement.namespaceURI===lp?t.createElement(e):t.createElementNS(n,e)}}function rN(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function gv(e){var t=Wd(e);return(t.local?rN:sN)(t)}function aN(){}function ip(e){return e==null?aN:function(){return this.querySelector(e)}}function oN(e){typeof e!="function"&&(e=ip(e));for(var t=this._groups,n=t.length,s=new Array(n),l=0;l<n;++l)for(var i=t[l],c=i.length,u=s[l]=new Array(c),d,p,h=0;h<c;++h)(d=i[h])&&(p=e.call(d,d.__data__,h,i))&&("__data__"in d&&(p.__data__=d.__data__),u[h]=p);return new hr(s,this._parents)}function lN(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function iN(){return[]}function _v(e){return e==null?iN:function(){return this.querySelectorAll(e)}}function cN(e){return function(){return lN(e.apply(this,arguments))}}function uN(e){typeof e=="function"?e=cN(e):e=_v(e);for(var t=this._groups,n=t.length,s=[],l=[],i=0;i<n;++i)for(var c=t[i],u=c.length,d,p=0;p<u;++p)(d=c[p])&&(s.push(e.call(d,d.__data__,p,c)),l.push(d));return new hr(s,l)}function vv(e){return function(){return this.matches(e)}}function yv(e){return function(t){return t.matches(e)}}var dN=Array.prototype.find;function mN(e){return function(){return dN.call(this.children,e)}}function hN(){return this.firstElementChild}function fN(e){return this.select(e==null?hN:mN(typeof e=="function"?e:yv(e)))}var pN=Array.prototype.filter;function gN(){return Array.from(this.children)}function _N(e){return function(){return pN.call(this.children,e)}}function vN(e){return this.selectAll(e==null?gN:_N(typeof e=="function"?e:yv(e)))}function yN(e){typeof e!="function"&&(e=vv(e));for(var t=this._groups,n=t.length,s=new Array(n),l=0;l<n;++l)for(var i=t[l],c=i.length,u=s[l]=[],d,p=0;p<c;++p)(d=i[p])&&e.call(d,d.__data__,p,i)&&u.push(d);return new hr(s,this._parents)}function bv(e){return new Array(e.length)}function bN(){return new hr(this._enter||this._groups.map(bv),this._parents)}function Kd(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Kd.prototype={constructor:Kd,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function xN(e){return function(){return e}}function wN(e,t,n,s,l,i){for(var c=0,u,d=t.length,p=i.length;c<p;++c)(u=t[c])?(u.__data__=i[c],s[c]=u):n[c]=new Kd(e,i[c]);for(;c<d;++c)(u=t[c])&&(l[c]=u)}function jN(e,t,n,s,l,i,c){var u,d,p=new Map,h=t.length,f=i.length,g=new Array(h),w;for(u=0;u<h;++u)(d=t[u])&&(g[u]=w=c.call(d,d.__data__,u,t)+"",p.has(w)?l[u]=d:p.set(w,d));for(u=0;u<f;++u)w=c.call(e,i[u],u,i)+"",(d=p.get(w))?(s[u]=d,d.__data__=i[u],p.delete(w)):n[u]=new Kd(e,i[u]);for(u=0;u<h;++u)(d=t[u])&&p.get(g[u])===d&&(l[u]=d)}function NN(e){return e.__data__}function CN(e,t){if(!arguments.length)return Array.from(this,NN);var n=t?jN:wN,s=this._parents,l=this._groups;typeof e!="function"&&(e=xN(e));for(var i=l.length,c=new Array(i),u=new Array(i),d=new Array(i),p=0;p<i;++p){var h=s[p],f=l[p],g=f.length,w=SN(e.call(h,h&&h.__data__,p,s)),y=w.length,b=u[p]=new Array(y),x=c[p]=new Array(y),N=d[p]=new Array(g);n(h,f,b,x,N,w,t);for(var E=0,k=0,j,S;E<y;++E)if(j=b[E]){for(E>=k&&(k=E+1);!(S=x[k])&&++k<y;);j._next=S||null}}return c=new hr(c,s),c._enter=u,c._exit=d,c}function SN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function EN(){return new hr(this._exit||this._groups.map(bv),this._parents)}function kN(e,t,n){var s=this.enter(),l=this,i=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(l=t(l),l&&(l=l.selection())),n==null?i.remove():n(i),s&&l?s.merge(l).order():l}function MN(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,l=n.length,i=s.length,c=Math.min(l,i),u=new Array(l),d=0;d<c;++d)for(var p=n[d],h=s[d],f=p.length,g=u[d]=new Array(f),w,y=0;y<f;++y)(w=p[y]||h[y])&&(g[y]=w);for(;d<l;++d)u[d]=n[d];return new hr(u,this._parents)}function AN(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],l=s.length-1,i=s[l],c;--l>=0;)(c=s[l])&&(i&&c.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(c,i),i=c);return this}function ON(e){e||(e=PN);function t(f,g){return f&&g?e(f.__data__,g.__data__):!f-!g}for(var n=this._groups,s=n.length,l=new Array(s),i=0;i<s;++i){for(var c=n[i],u=c.length,d=l[i]=new Array(u),p,h=0;h<u;++h)(p=c[h])&&(d[h]=p);d.sort(t)}return new hr(l,this._parents).order()}function PN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function TN(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function $N(){return Array.from(this)}function LN(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],l=0,i=s.length;l<i;++l){var c=s[l];if(c)return c}return null}function zN(){let e=0;for(const t of this)++e;return e}function DN(){return!this.node()}function RN(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var l=t[n],i=0,c=l.length,u;i<c;++i)(u=l[i])&&e.call(u,u.__data__,i,l);return this}function FN(e){return function(){this.removeAttribute(e)}}function IN(e){return function(){this.removeAttributeNS(e.space,e.local)}}function BN(e,t){return function(){this.setAttribute(e,t)}}function UN(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function qN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function HN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function VN(e,t){var n=Wd(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?IN:FN:typeof t=="function"?n.local?HN:qN:n.local?UN:BN)(n,t))}function xv(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function WN(e){return function(){this.style.removeProperty(e)}}function KN(e,t,n){return function(){this.style.setProperty(e,t,n)}}function YN(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function GN(e,t,n){return arguments.length>1?this.each((t==null?WN:typeof t=="function"?YN:KN)(e,t,n??"")):ui(this.node(),e)}function ui(e,t){return e.style.getPropertyValue(t)||xv(e).getComputedStyle(e,null).getPropertyValue(t)}function QN(e){return function(){delete this[e]}}function XN(e,t){return function(){this[e]=t}}function JN(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ZN(e,t){return arguments.length>1?this.each((t==null?QN:typeof t=="function"?JN:XN)(e,t)):this.node()[e]}function wv(e){return e.trim().split(/^|\s+/)}function cp(e){return e.classList||new jv(e)}function jv(e){this._node=e,this._names=wv(e.getAttribute("class")||"")}jv.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Nv(e,t){for(var n=cp(e),s=-1,l=t.length;++s<l;)n.add(t[s])}function Cv(e,t){for(var n=cp(e),s=-1,l=t.length;++s<l;)n.remove(t[s])}function eC(e){return function(){Nv(this,e)}}function tC(e){return function(){Cv(this,e)}}function nC(e,t){return function(){(t.apply(this,arguments)?Nv:Cv)(this,e)}}function sC(e,t){var n=wv(e+"");if(arguments.length<2){for(var s=cp(this.node()),l=-1,i=n.length;++l<i;)if(!s.contains(n[l]))return!1;return!0}return this.each((typeof t=="function"?nC:t?eC:tC)(n,t))}function rC(){this.textContent=""}function aC(e){return function(){this.textContent=e}}function oC(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function lC(e){return arguments.length?this.each(e==null?rC:(typeof e=="function"?oC:aC)(e)):this.node().textContent}function iC(){this.innerHTML=""}function cC(e){return function(){this.innerHTML=e}}function uC(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function dC(e){return arguments.length?this.each(e==null?iC:(typeof e=="function"?uC:cC)(e)):this.node().innerHTML}function mC(){this.nextSibling&&this.parentNode.appendChild(this)}function hC(){return this.each(mC)}function fC(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function pC(){return this.each(fC)}function gC(e){var t=typeof e=="function"?e:gv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function _C(){return null}function vC(e,t){var n=typeof e=="function"?e:gv(e),s=t==null?_C:typeof t=="function"?t:ip(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function yC(){var e=this.parentNode;e&&e.removeChild(this)}function bC(){return this.each(yC)}function xC(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function wC(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function jC(e){return this.select(e?wC:xC)}function NC(e){return arguments.length?this.property("__data__",e):this.node().__data__}function CC(e){return function(t){e.call(this,t,this.__data__)}}function SC(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function EC(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,l=t.length,i;n<l;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++s]=i;++s?t.length=s:delete this.__on}}}function kC(e,t,n){return function(){var s=this.__on,l,i=CC(t);if(s){for(var c=0,u=s.length;c<u;++c)if((l=s[c]).type===e.type&&l.name===e.name){this.removeEventListener(l.type,l.listener,l.options),this.addEventListener(l.type,l.listener=i,l.options=n),l.value=t;return}}this.addEventListener(e.type,i,n),l={type:e.type,name:e.name,value:t,listener:i,options:n},s?s.push(l):this.__on=[l]}}function MC(e,t,n){var s=SC(e+""),l,i=s.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var d=0,p=u.length,h;d<p;++d)for(l=0,h=u[d];l<i;++l)if((c=s[l]).type===h.type&&c.name===h.name)return h.value}return}for(u=t?kC:EC,l=0;l<i;++l)this.each(u(s[l],t,n));return this}function Sv(e,t,n){var s=xv(e),l=s.CustomEvent;typeof l=="function"?l=new l(t,n):(l=s.document.createEvent("Event"),n?(l.initEvent(t,n.bubbles,n.cancelable),l.detail=n.detail):l.initEvent(t,!1,!1)),e.dispatchEvent(l)}function AC(e,t){return function(){return Sv(this,e,t)}}function OC(e,t){return function(){return Sv(this,e,t.apply(this,arguments))}}function PC(e,t){return this.each((typeof t=="function"?OC:AC)(e,t))}function*TC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],l=0,i=s.length,c;l<i;++l)(c=s[l])&&(yield c)}var Ev=[null];function hr(e,t){this._groups=e,this._parents=t}function Tc(){return new hr([[document.documentElement]],Ev)}function $C(){return this}hr.prototype=Tc.prototype={constructor:hr,select:oN,selectAll:uN,selectChild:fN,selectChildren:vN,filter:yN,data:CN,enter:bN,exit:EN,join:kN,merge:MN,selection:$C,order:AN,sort:ON,call:TN,nodes:$N,node:LN,size:zN,empty:DN,each:RN,attr:VN,style:GN,property:ZN,classed:sC,text:lC,html:dC,raise:hC,lower:pC,append:gC,insert:vC,remove:bC,clone:jC,datum:NC,on:MC,dispatch:PC,[Symbol.iterator]:TC};function Wr(e){return typeof e=="string"?new hr([[document.querySelector(e)]],[document.documentElement]):new hr([[e]],Ev)}function LC(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ca(e,t){if(e=LC(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var l=t.getBoundingClientRect();return[e.clientX-l.left-t.clientLeft,e.clientY-l.top-t.clientTop]}}return[e.pageX,e.pageY]}const zC={passive:!1},$c={capture:!0,passive:!1};function up(e){e.stopImmediatePropagation()}function di(e){e.preventDefault(),e.stopImmediatePropagation()}function kv(e){var t=e.document.documentElement,n=Wr(e).on("dragstart.drag",di,$c);"onselectstart"in t?n.on("selectstart.drag",di,$c):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Mv(e,t){var n=e.document.documentElement,s=Wr(e).on("dragstart.drag",null);t&&(s.on("click.drag",di,$c),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Yd=e=>()=>e;function dp(e,{sourceEvent:t,subject:n,target:s,identifier:l,active:i,x:c,y:u,dx:d,dy:p,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:l,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:h}})}dp.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function DC(e){return!e.ctrlKey&&!e.button}function RC(){return this.parentNode}function FC(e,t){return t??{x:e.x,y:e.y}}function IC(){return navigator.maxTouchPoints||"ontouchstart"in this}function BC(){var e=DC,t=RC,n=FC,s=IC,l={},i=Hd("start","drag","end"),c=0,u,d,p,h,f=0;function g(j){j.on("mousedown.drag",w).filter(s).on("touchstart.drag",x).on("touchmove.drag",N,zC).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function w(j,S){if(!(h||!e.call(this,j,S))){var M=k(this,t.call(this,j,S),j,S,"mouse");M&&(Wr(j.view).on("mousemove.drag",y,$c).on("mouseup.drag",b,$c),kv(j.view),up(j),p=!1,u=j.clientX,d=j.clientY,M("start",j))}}function y(j){if(di(j),!p){var S=j.clientX-u,M=j.clientY-d;p=S*S+M*M>f}l.mouse("drag",j)}function b(j){Wr(j.view).on("mousemove.drag mouseup.drag",null),Mv(j.view,p),di(j),l.mouse("end",j)}function x(j,S){if(e.call(this,j,S)){var M=j.changedTouches,$=t.call(this,j,S),T=M.length,L,P;for(L=0;L<T;++L)(P=k(this,$,j,S,M[L].identifier,M[L]))&&(up(j),P("start",j,M[L]))}}function N(j){var S=j.changedTouches,M=S.length,$,T;for($=0;$<M;++$)(T=l[S[$].identifier])&&(di(j),T("drag",j,S[$]))}function E(j){var S=j.changedTouches,M=S.length,$,T;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),$=0;$<M;++$)(T=l[S[$].identifier])&&(up(j),T("end",j,S[$]))}function k(j,S,M,$,T,L){var P=i.copy(),O=ca(L||M,S),D,W,z;if((z=n.call(j,new dp("beforestart",{sourceEvent:M,target:g,identifier:T,active:c,x:O[0],y:O[1],dx:0,dy:0,dispatch:P}),$))!=null)return D=z.x-O[0]||0,W=z.y-O[1]||0,function R(U,V,B){var X=O,H;switch(U){case"start":l[T]=R,H=c++;break;case"end":delete l[T],--c;case"drag":O=ca(B||V,S),H=c;break}P.call(U,j,new dp(U,{sourceEvent:V,subject:z,target:g,identifier:T,active:H,x:O[0]+D,y:O[1]+W,dx:O[0]-X[0],dy:O[1]-X[1],dispatch:P}),$)}}return g.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Yd(!!j),g):e},g.container=function(j){return arguments.length?(t=typeof j=="function"?j:Yd(j),g):t},g.subject=function(j){return arguments.length?(n=typeof j=="function"?j:Yd(j),g):n},g.touchable=function(j){return arguments.length?(s=typeof j=="function"?j:Yd(!!j),g):s},g.on=function(){var j=i.on.apply(i,arguments);return j===i?g:j},g.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,g):Math.sqrt(f)},g}function mp(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Av(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function Lc(){}var zc=.7,Gd=1/zc,mi="\\s*([+-]?\\d+)\\s*",Dc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ua="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",UC=/^#([0-9a-f]{3,8})$/,qC=new RegExp(`^rgb\\(${mi},${mi},${mi}\\)$`),HC=new RegExp(`^rgb\\(${ua},${ua},${ua}\\)$`),VC=new RegExp(`^rgba\\(${mi},${mi},${mi},${Dc}\\)$`),WC=new RegExp(`^rgba\\(${ua},${ua},${ua},${Dc}\\)$`),KC=new RegExp(`^hsl\\(${Dc},${ua},${ua}\\)$`),YC=new RegExp(`^hsla\\(${Dc},${ua},${ua},${Dc}\\)$`),Ov={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mp(Lc,Rc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Pv,formatHex:Pv,formatHex8:GC,formatHsl:QC,formatRgb:Tv,toString:Tv});function Pv(){return this.rgb().formatHex()}function GC(){return this.rgb().formatHex8()}function QC(){return Rv(this).formatHsl()}function Tv(){return this.rgb().formatRgb()}function Rc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=UC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?$v(t):n===3?new Ys(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=qC.exec(e))?new Ys(t[1],t[2],t[3],1):(t=HC.exec(e))?new Ys(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=VC.exec(e))?Qd(t[1],t[2],t[3],t[4]):(t=WC.exec(e))?Qd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=KC.exec(e))?Dv(t[1],t[2]/100,t[3]/100,1):(t=YC.exec(e))?Dv(t[1],t[2]/100,t[3]/100,t[4]):Ov.hasOwnProperty(e)?$v(Ov[e]):e==="transparent"?new Ys(NaN,NaN,NaN,0):null}function $v(e){return new Ys(e>>16&255,e>>8&255,e&255,1)}function Qd(e,t,n,s){return s<=0&&(e=t=n=NaN),new Ys(e,t,n,s)}function XC(e){return e instanceof Lc||(e=Rc(e)),e?(e=e.rgb(),new Ys(e.r,e.g,e.b,e.opacity)):new Ys}function hp(e,t,n,s){return arguments.length===1?XC(e):new Ys(e,t,n,s??1)}function Ys(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}mp(Ys,hp,Av(Lc,{brighter(e){return e=e==null?Gd:Math.pow(Gd,e),new Ys(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?zc:Math.pow(zc,e),new Ys(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ys(al(this.r),al(this.g),al(this.b),Xd(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Lv,formatHex:Lv,formatHex8:JC,formatRgb:zv,toString:zv}));function Lv(){return`#${ol(this.r)}${ol(this.g)}${ol(this.b)}`}function JC(){return`#${ol(this.r)}${ol(this.g)}${ol(this.b)}${ol((isNaN(this.opacity)?1:this.opacity)*255)}`}function zv(){const e=Xd(this.opacity);return`${e===1?"rgb(":"rgba("}${al(this.r)}, ${al(this.g)}, ${al(this.b)}${e===1?")":`, ${e})`}`}function Xd(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function al(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ol(e){return e=al(e),(e<16?"0":"")+e.toString(16)}function Dv(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Kr(e,t,n,s)}function Rv(e){if(e instanceof Kr)return new Kr(e.h,e.s,e.l,e.opacity);if(e instanceof Lc||(e=Rc(e)),!e)return new Kr;if(e instanceof Kr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,l=Math.min(t,n,s),i=Math.max(t,n,s),c=NaN,u=i-l,d=(i+l)/2;return u?(t===i?c=(n-s)/u+(n<s)*6:n===i?c=(s-t)/u+2:c=(t-n)/u+4,u/=d<.5?i+l:2-i-l,c*=60):u=d>0&&d<1?0:c,new Kr(c,u,d,e.opacity)}function ZC(e,t,n,s){return arguments.length===1?Rv(e):new Kr(e,t,n,s??1)}function Kr(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}mp(Kr,ZC,Av(Lc,{brighter(e){return e=e==null?Gd:Math.pow(Gd,e),new Kr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?zc:Math.pow(zc,e),new Kr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,l=2*n-s;return new Ys(fp(e>=240?e-240:e+120,l,s),fp(e,l,s),fp(e<120?e+240:e-120,l,s),this.opacity)},clamp(){return new Kr(Fv(this.h),Jd(this.s),Jd(this.l),Xd(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xd(this.opacity);return`${e===1?"hsl(":"hsla("}${Fv(this.h)}, ${Jd(this.s)*100}%, ${Jd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Fv(e){return e=(e||0)%360,e<0?e+360:e}function Jd(e){return Math.max(0,Math.min(1,e||0))}function fp(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Iv=e=>()=>e;function eS(e,t){return function(n){return e+n*t}}function tS(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function nS(e){return(e=+e)==1?Bv:function(t,n){return n-t?tS(t,n,e):Iv(isNaN(t)?n:t)}}function Bv(e,t){var n=t-e;return n?eS(e,n):Iv(isNaN(e)?t:e)}const Uv=function e(t){var n=nS(t);function s(l,i){var c=n((l=hp(l)).r,(i=hp(i)).r),u=n(l.g,i.g),d=n(l.b,i.b),p=Bv(l.opacity,i.opacity);return function(h){return l.r=c(h),l.g=u(h),l.b=d(h),l.opacity=p(h),l+""}}return s.gamma=e,s}(1);function io(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var pp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,gp=new RegExp(pp.source,"g");function sS(e){return function(){return e}}function rS(e){return function(t){return e(t)+""}}function aS(e,t){var n=pp.lastIndex=gp.lastIndex=0,s,l,i,c=-1,u=[],d=[];for(e=e+"",t=t+"";(s=pp.exec(e))&&(l=gp.exec(t));)(i=l.index)>n&&(i=t.slice(n,i),u[c]?u[c]+=i:u[++c]=i),(s=s[0])===(l=l[0])?u[c]?u[c]+=l:u[++c]=l:(u[++c]=null,d.push({i:c,x:io(s,l)})),n=gp.lastIndex;return n<t.length&&(i=t.slice(n),u[c]?u[c]+=i:u[++c]=i),u.length<2?d[0]?rS(d[0].x):sS(t):(t=d.length,function(p){for(var h=0,f;h<t;++h)u[(f=d[h]).i]=f.x(p);return u.join("")})}var qv=180/Math.PI,_p={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Hv(e,t,n,s,l,i){var c,u,d;return(c=Math.sqrt(e*e+t*t))&&(e/=c,t/=c),(d=e*n+t*s)&&(n-=e*d,s-=t*d),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,d/=u),e*s<t*n&&(e=-e,t=-t,d=-d,c=-c),{translateX:l,translateY:i,rotate:Math.atan2(t,e)*qv,skewX:Math.atan(d)*qv,scaleX:c,scaleY:u}}var Zd;function oS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?_p:Hv(t.a,t.b,t.c,t.d,t.e,t.f)}function lS(e){return e==null||(Zd||(Zd=document.createElementNS("http://www.w3.org/2000/svg","g")),Zd.setAttribute("transform",e),!(e=Zd.transform.baseVal.consolidate()))?_p:(e=e.matrix,Hv(e.a,e.b,e.c,e.d,e.e,e.f))}function Vv(e,t,n,s){function l(p){return p.length?p.pop()+" ":""}function i(p,h,f,g,w,y){if(p!==f||h!==g){var b=w.push("translate(",null,t,null,n);y.push({i:b-4,x:io(p,f)},{i:b-2,x:io(h,g)})}else(f||g)&&w.push("translate("+f+t+g+n)}function c(p,h,f,g){p!==h?(p-h>180?h+=360:h-p>180&&(p+=360),g.push({i:f.push(l(f)+"rotate(",null,s)-2,x:io(p,h)})):h&&f.push(l(f)+"rotate("+h+s)}function u(p,h,f,g){p!==h?g.push({i:f.push(l(f)+"skewX(",null,s)-2,x:io(p,h)}):h&&f.push(l(f)+"skewX("+h+s)}function d(p,h,f,g,w,y){if(p!==f||h!==g){var b=w.push(l(w)+"scale(",null,",",null,")");y.push({i:b-4,x:io(p,f)},{i:b-2,x:io(h,g)})}else(f!==1||g!==1)&&w.push(l(w)+"scale("+f+","+g+")")}return function(p,h){var f=[],g=[];return p=e(p),h=e(h),i(p.translateX,p.translateY,h.translateX,h.translateY,f,g),c(p.rotate,h.rotate,f,g),u(p.skewX,h.skewX,f,g),d(p.scaleX,p.scaleY,h.scaleX,h.scaleY,f,g),p=h=null,function(w){for(var y=-1,b=g.length,x;++y<b;)f[(x=g[y]).i]=x.x(w);return f.join("")}}}var iS=Vv(oS,"px, ","px)","deg)"),cS=Vv(lS,", ",")",")"),uS=1e-12;function Wv(e){return((e=Math.exp(e))+1/e)/2}function dS(e){return((e=Math.exp(e))-1/e)/2}function mS(e){return((e=Math.exp(2*e))-1)/(e+1)}const hS=function e(t,n,s){function l(i,c){var u=i[0],d=i[1],p=i[2],h=c[0],f=c[1],g=c[2],w=h-u,y=f-d,b=w*w+y*y,x,N;if(b<uS)N=Math.log(g/p)/t,x=function($){return[u+$*w,d+$*y,p*Math.exp(t*$*N)]};else{var E=Math.sqrt(b),k=(g*g-p*p+s*b)/(2*p*n*E),j=(g*g-p*p-s*b)/(2*g*n*E),S=Math.log(Math.sqrt(k*k+1)-k),M=Math.log(Math.sqrt(j*j+1)-j);N=(M-S)/t,x=function($){var T=$*N,L=Wv(S),P=p/(n*E)*(L*mS(t*T+S)-dS(S));return[u+P*w,d+P*y,p*L/Wv(t*T+S)]}}return x.duration=N*1e3*t/Math.SQRT2,x}return l.rho=function(i){var c=Math.max(.001,+i),u=c*c,d=u*u;return e(c,u,d)},l}(Math.SQRT2,2,4);var hi=0,Fc=0,Ic=0,Kv=1e3,em,Bc,tm=0,ll=0,nm=0,Uc=typeof performance=="object"&&performance.now?performance:Date,Yv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function vp(){return ll||(Yv(fS),ll=Uc.now()+nm)}function fS(){ll=0}function sm(){this._call=this._time=this._next=null}sm.prototype=Gv.prototype={constructor:sm,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?vp():+n)+(t==null?0:+t),!this._next&&Bc!==this&&(Bc?Bc._next=this:em=this,Bc=this),this._call=e,this._time=n,yp()},stop:function(){this._call&&(this._call=null,this._time=1/0,yp())}};function Gv(e,t,n){var s=new sm;return s.restart(e,t,n),s}function pS(){vp(),++hi;for(var e=em,t;e;)(t=ll-e._time)>=0&&e._call.call(void 0,t),e=e._next;--hi}function Qv(){ll=(tm=Uc.now())+nm,hi=Fc=0;try{pS()}finally{hi=0,_S(),ll=0}}function gS(){var e=Uc.now(),t=e-tm;t>Kv&&(nm-=t,tm=e)}function _S(){for(var e,t=em,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:em=n);Bc=e,yp(s)}function yp(e){if(!hi){Fc&&(Fc=clearTimeout(Fc));var t=e-ll;t>24?(e<1/0&&(Fc=setTimeout(Qv,e-Uc.now()-nm)),Ic&&(Ic=clearInterval(Ic))):(Ic||(tm=Uc.now(),Ic=setInterval(gS,Kv)),hi=1,Yv(Qv))}}function Xv(e,t,n){var s=new sm;return t=t==null?0:+t,s.restart(l=>{s.stop(),e(l+t)},t,n),s}var vS=Hd("start","end","cancel","interrupt"),yS=[],Jv=0,Zv=1,bp=2,rm=3,ey=4,xp=5,am=6;function om(e,t,n,s,l,i){var c=e.__transition;if(!c)e.__transition={};else if(n in c)return;bS(e,n,{name:t,index:s,group:l,on:vS,tween:yS,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Jv})}function wp(e,t){var n=Yr(e,t);if(n.state>Jv)throw new Error("too late; already scheduled");return n}function da(e,t){var n=Yr(e,t);if(n.state>rm)throw new Error("too late; already running");return n}function Yr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function bS(e,t,n){var s=e.__transition,l;s[t]=n,n.timer=Gv(i,0,n.time);function i(p){n.state=Zv,n.timer.restart(c,n.delay,n.time),n.delay<=p&&c(p-n.delay)}function c(p){var h,f,g,w;if(n.state!==Zv)return d();for(h in s)if(w=s[h],w.name===n.name){if(w.state===rm)return Xv(c);w.state===ey?(w.state=am,w.timer.stop(),w.on.call("interrupt",e,e.__data__,w.index,w.group),delete s[h]):+h<t&&(w.state=am,w.timer.stop(),w.on.call("cancel",e,e.__data__,w.index,w.group),delete s[h])}if(Xv(function(){n.state===rm&&(n.state=ey,n.timer.restart(u,n.delay,n.time),u(p))}),n.state=bp,n.on.call("start",e,e.__data__,n.index,n.group),n.state===bp){for(n.state=rm,l=new Array(g=n.tween.length),h=0,f=-1;h<g;++h)(w=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(l[++f]=w);l.length=f+1}}function u(p){for(var h=p<n.duration?n.ease.call(null,p/n.duration):(n.timer.restart(d),n.state=xp,1),f=-1,g=l.length;++f<g;)l[f].call(e,h);n.state===xp&&(n.on.call("end",e,e.__data__,n.index,n.group),d())}function d(){n.state=am,n.timer.stop(),delete s[t];for(var p in s)return;delete e.__transition}}function lm(e,t){var n=e.__transition,s,l,i=!0,c;if(n){t=t==null?null:t+"";for(c in n){if((s=n[c]).name!==t){i=!1;continue}l=s.state>bp&&s.state<xp,s.state=am,s.timer.stop(),s.on.call(l?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[c]}i&&delete e.__transition}}function xS(e){return this.each(function(){lm(this,e)})}function wS(e,t){var n,s;return function(){var l=da(this,e),i=l.tween;if(i!==n){s=n=i;for(var c=0,u=s.length;c<u;++c)if(s[c].name===t){s=s.slice(),s.splice(c,1);break}}l.tween=s}}function jS(e,t,n){var s,l;if(typeof n!="function")throw new Error;return function(){var i=da(this,e),c=i.tween;if(c!==s){l=(s=c).slice();for(var u={name:t,value:n},d=0,p=l.length;d<p;++d)if(l[d].name===t){l[d]=u;break}d===p&&l.push(u)}i.tween=l}}function NS(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=Yr(this.node(),n).tween,l=0,i=s.length,c;l<i;++l)if((c=s[l]).name===e)return c.value;return null}return this.each((t==null?wS:jS)(n,e,t))}function jp(e,t,n){var s=e._id;return e.each(function(){var l=da(this,s);(l.value||(l.value={}))[t]=n.apply(this,arguments)}),function(l){return Yr(l,s).value[t]}}function ty(e,t){var n;return(typeof t=="number"?io:t instanceof Rc?Uv:(n=Rc(t))?(t=n,Uv):aS)(e,t)}function CS(e){return function(){this.removeAttribute(e)}}function SS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function ES(e,t,n){var s,l=n+"",i;return function(){var c=this.getAttribute(e);return c===l?null:c===s?i:i=t(s=c,n)}}function kS(e,t,n){var s,l=n+"",i;return function(){var c=this.getAttributeNS(e.space,e.local);return c===l?null:c===s?i:i=t(s=c,n)}}function MS(e,t,n){var s,l,i;return function(){var c,u=n(this),d;return u==null?void this.removeAttribute(e):(c=this.getAttribute(e),d=u+"",c===d?null:c===s&&d===l?i:(l=d,i=t(s=c,u)))}}function AS(e,t,n){var s,l,i;return function(){var c,u=n(this),d;return u==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),d=u+"",c===d?null:c===s&&d===l?i:(l=d,i=t(s=c,u)))}}function OS(e,t){var n=Wd(e),s=n==="transform"?cS:ty;return this.attrTween(e,typeof t=="function"?(n.local?AS:MS)(n,s,jp(this,"attr."+e,t)):t==null?(n.local?SS:CS)(n):(n.local?kS:ES)(n,s,t))}function PS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function TS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function $S(e,t){var n,s;function l(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&TS(e,i)),n}return l._value=t,l}function LS(e,t){var n,s;function l(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&PS(e,i)),n}return l._value=t,l}function zS(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=Wd(e);return this.tween(n,(s.local?$S:LS)(s,t))}function DS(e,t){return function(){wp(this,e).delay=+t.apply(this,arguments)}}function RS(e,t){return t=+t,function(){wp(this,e).delay=t}}function FS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?DS:RS)(t,e)):Yr(this.node(),t).delay}function IS(e,t){return function(){da(this,e).duration=+t.apply(this,arguments)}}function BS(e,t){return t=+t,function(){da(this,e).duration=t}}function US(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?IS:BS)(t,e)):Yr(this.node(),t).duration}function qS(e,t){if(typeof t!="function")throw new Error;return function(){da(this,e).ease=t}}function HS(e){var t=this._id;return arguments.length?this.each(qS(t,e)):Yr(this.node(),t).ease}function VS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;da(this,e).ease=n}}function WS(e){if(typeof e!="function")throw new Error;return this.each(VS(this._id,e))}function KS(e){typeof e!="function"&&(e=vv(e));for(var t=this._groups,n=t.length,s=new Array(n),l=0;l<n;++l)for(var i=t[l],c=i.length,u=s[l]=[],d,p=0;p<c;++p)(d=i[p])&&e.call(d,d.__data__,p,i)&&u.push(d);return new Ca(s,this._parents,this._name,this._id)}function YS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,l=n.length,i=Math.min(s,l),c=new Array(s),u=0;u<i;++u)for(var d=t[u],p=n[u],h=d.length,f=c[u]=new Array(h),g,w=0;w<h;++w)(g=d[w]||p[w])&&(f[w]=g);for(;u<s;++u)c[u]=t[u];return new Ca(c,this._parents,this._name,this._id)}function GS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function QS(e,t,n){var s,l,i=GS(t)?wp:da;return function(){var c=i(this,e),u=c.on;u!==s&&(l=(s=u).copy()).on(t,n),c.on=l}}function XS(e,t){var n=this._id;return arguments.length<2?Yr(this.node(),n).on.on(e):this.each(QS(n,e,t))}function JS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ZS(){return this.on("end.remove",JS(this._id))}function eE(e){var t=this._name,n=this._id;typeof e!="function"&&(e=ip(e));for(var s=this._groups,l=s.length,i=new Array(l),c=0;c<l;++c)for(var u=s[c],d=u.length,p=i[c]=new Array(d),h,f,g=0;g<d;++g)(h=u[g])&&(f=e.call(h,h.__data__,g,u))&&("__data__"in h&&(f.__data__=h.__data__),p[g]=f,om(p[g],t,n,g,p,Yr(h,n)));return new Ca(i,this._parents,t,n)}function tE(e){var t=this._name,n=this._id;typeof e!="function"&&(e=_v(e));for(var s=this._groups,l=s.length,i=[],c=[],u=0;u<l;++u)for(var d=s[u],p=d.length,h,f=0;f<p;++f)if(h=d[f]){for(var g=e.call(h,h.__data__,f,d),w,y=Yr(h,n),b=0,x=g.length;b<x;++b)(w=g[b])&&om(w,t,n,b,g,y);i.push(g),c.push(h)}return new Ca(i,c,t,n)}var nE=Tc.prototype.constructor;function sE(){return new nE(this._groups,this._parents)}function rE(e,t){var n,s,l;return function(){var i=ui(this,e),c=(this.style.removeProperty(e),ui(this,e));return i===c?null:i===n&&c===s?l:l=t(n=i,s=c)}}function ny(e){return function(){this.style.removeProperty(e)}}function aE(e,t,n){var s,l=n+"",i;return function(){var c=ui(this,e);return c===l?null:c===s?i:i=t(s=c,n)}}function oE(e,t,n){var s,l,i;return function(){var c=ui(this,e),u=n(this),d=u+"";return u==null&&(d=u=(this.style.removeProperty(e),ui(this,e))),c===d?null:c===s&&d===l?i:(l=d,i=t(s=c,u))}}function lE(e,t){var n,s,l,i="style."+t,c="end."+i,u;return function(){var d=da(this,e),p=d.on,h=d.value[i]==null?u||(u=ny(t)):void 0;(p!==n||l!==h)&&(s=(n=p).copy()).on(c,l=h),d.on=s}}function iE(e,t,n){var s=(e+="")=="transform"?iS:ty;return t==null?this.styleTween(e,rE(e,s)).on("end.style."+e,ny(e)):typeof t=="function"?this.styleTween(e,oE(e,s,jp(this,"style."+e,t))).each(lE(this._id,e)):this.styleTween(e,aE(e,s,t),n).on("end.style."+e,null)}function cE(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function uE(e,t,n){var s,l;function i(){var c=t.apply(this,arguments);return c!==l&&(s=(l=c)&&cE(e,c,n)),s}return i._value=t,i}function dE(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,uE(e,t,n??""))}function mE(e){return function(){this.textContent=e}}function hE(e){return function(){var t=e(this);this.textContent=t??""}}function fE(e){return this.tween("text",typeof e=="function"?hE(jp(this,"text",e)):mE(e==null?"":e+""))}function pE(e){return function(t){this.textContent=e.call(this,t)}}function gE(e){var t,n;function s(){var l=e.apply(this,arguments);return l!==n&&(t=(n=l)&&pE(l)),t}return s._value=e,s}function _E(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,gE(e))}function vE(){for(var e=this._name,t=this._id,n=sy(),s=this._groups,l=s.length,i=0;i<l;++i)for(var c=s[i],u=c.length,d,p=0;p<u;++p)if(d=c[p]){var h=Yr(d,t);om(d,e,n,p,c,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Ca(s,this._parents,e,n)}function yE(){var e,t,n=this,s=n._id,l=n.size();return new Promise(function(i,c){var u={value:c},d={value:function(){--l===0&&i()}};n.each(function(){var p=da(this,s),h=p.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(d)),p.on=t}),l===0&&i()})}var bE=0;function Ca(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function sy(){return++bE}var Sa=Tc.prototype;Ca.prototype={constructor:Ca,select:eE,selectAll:tE,selectChild:Sa.selectChild,selectChildren:Sa.selectChildren,filter:KS,merge:YS,selection:sE,transition:vE,call:Sa.call,nodes:Sa.nodes,node:Sa.node,size:Sa.size,empty:Sa.empty,each:Sa.each,on:XS,attr:OS,attrTween:zS,style:iE,styleTween:dE,text:fE,textTween:_E,remove:ZS,tween:NS,delay:FS,duration:US,ease:HS,easeVarying:WS,end:yE,[Symbol.iterator]:Sa[Symbol.iterator]};function xE(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var wE={time:null,delay:0,duration:250,ease:xE};function jE(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function NE(e){var t,n;e instanceof Ca?(t=e._id,e=e._name):(t=sy(),(n=wE).time=vp(),e=e==null?null:e+"");for(var s=this._groups,l=s.length,i=0;i<l;++i)for(var c=s[i],u=c.length,d,p=0;p<u;++p)(d=c[p])&&om(d,e,t,p,c,n||jE(d,t));return new Ca(s,this._parents,e,t)}Tc.prototype.interrupt=xS,Tc.prototype.transition=NE;const im=e=>()=>e;function CE(e,{sourceEvent:t,target:n,transform:s,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:l}})}function Ea(e,t,n){this.k=e,this.x=t,this.y=n}Ea.prototype={constructor:Ea,scale:function(e){return e===1?this:new Ea(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ea(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var il=new Ea(1,0,0);Ea.prototype;function Np(e){e.stopImmediatePropagation()}function qc(e){e.preventDefault(),e.stopImmediatePropagation()}function SE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function EE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function ry(){return this.__zoom||il}function kE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function ME(){return navigator.maxTouchPoints||"ontouchstart"in this}function AE(e,t,n){var s=e.invertX(t[0][0])-n[0][0],l=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],c=e.invertY(t[1][1])-n[1][1];return e.translate(l>s?(s+l)/2:Math.min(0,s)||Math.max(0,l),c>i?(i+c)/2:Math.min(0,i)||Math.max(0,c))}function OE(){var e=SE,t=EE,n=AE,s=kE,l=ME,i=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=hS,p=Hd("start","zoom","end"),h,f,g,w=500,y=150,b=0,x=10;function N(z){z.property("__zoom",ry).on("wheel.zoom",T,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",P).filter(l).on("touchstart.zoom",O).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",W).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.transform=function(z,R,U,V){var B=z.selection?z.selection():z;B.property("__zoom",ry),z!==B?S(z,R,U,V):B.interrupt().each(function(){M(this,arguments).event(V).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},N.scaleBy=function(z,R,U,V){N.scaleTo(z,function(){var B=this.__zoom.k,X=typeof R=="function"?R.apply(this,arguments):R;return B*X},U,V)},N.scaleTo=function(z,R,U,V){N.transform(z,function(){var B=t.apply(this,arguments),X=this.__zoom,H=U==null?j(B):typeof U=="function"?U.apply(this,arguments):U,F=X.invert(H),K=typeof R=="function"?R.apply(this,arguments):R;return n(k(E(X,K),H,F),B,c)},U,V)},N.translateBy=function(z,R,U,V){N.transform(z,function(){return n(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof U=="function"?U.apply(this,arguments):U),t.apply(this,arguments),c)},null,V)},N.translateTo=function(z,R,U,V,B){N.transform(z,function(){var X=t.apply(this,arguments),H=this.__zoom,F=V==null?j(X):typeof V=="function"?V.apply(this,arguments):V;return n(il.translate(F[0],F[1]).scale(H.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof U=="function"?-U.apply(this,arguments):-U),X,c)},V,B)};function E(z,R){return R=Math.max(i[0],Math.min(i[1],R)),R===z.k?z:new Ea(R,z.x,z.y)}function k(z,R,U){var V=R[0]-U[0]*z.k,B=R[1]-U[1]*z.k;return V===z.x&&B===z.y?z:new Ea(z.k,V,B)}function j(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function S(z,R,U,V){z.on("start.zoom",function(){M(this,arguments).event(V).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(V).end()}).tween("zoom",function(){var B=this,X=arguments,H=M(B,X).event(V),F=t.apply(B,X),K=U==null?j(F):typeof U=="function"?U.apply(B,X):U,re=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),G=B.__zoom,q=typeof R=="function"?R.apply(B,X):R,Y=d(G.invert(K).concat(re/G.k),q.invert(K).concat(re/q.k));return function(Q){if(Q===1)Q=q;else{var ee=Y(Q),J=re/ee[2];Q=new Ea(J,K[0]-ee[0]*J,K[1]-ee[1]*J)}H.zoom(null,Q)}})}function M(z,R,U){return!U&&z.__zooming||new $(z,R)}function $(z,R){this.that=z,this.args=R,this.active=0,this.sourceEvent=null,this.extent=t.apply(z,R),this.taps=0}$.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,R){return this.mouse&&z!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var R=Wr(this.that).datum();p.call(z,this.that,new CE(z,{sourceEvent:this.sourceEvent,target:N,transform:this.that.__zoom,dispatch:p}),R)}};function T(z,...R){if(!e.apply(this,arguments))return;var U=M(this,R).event(z),V=this.__zoom,B=Math.max(i[0],Math.min(i[1],V.k*Math.pow(2,s.apply(this,arguments)))),X=ca(z);if(U.wheel)(U.mouse[0][0]!==X[0]||U.mouse[0][1]!==X[1])&&(U.mouse[1]=V.invert(U.mouse[0]=X)),clearTimeout(U.wheel);else{if(V.k===B)return;U.mouse=[X,V.invert(X)],lm(this),U.start()}qc(z),U.wheel=setTimeout(H,y),U.zoom("mouse",n(k(E(V,B),U.mouse[0],U.mouse[1]),U.extent,c));function H(){U.wheel=null,U.end()}}function L(z,...R){if(g||!e.apply(this,arguments))return;var U=z.currentTarget,V=M(this,R,!0).event(z),B=Wr(z.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",re,!0),X=ca(z,U),H=z.clientX,F=z.clientY;kv(z.view),Np(z),V.mouse=[X,this.__zoom.invert(X)],lm(this),V.start();function K(G){if(qc(G),!V.moved){var q=G.clientX-H,Y=G.clientY-F;V.moved=q*q+Y*Y>b}V.event(G).zoom("mouse",n(k(V.that.__zoom,V.mouse[0]=ca(G,U),V.mouse[1]),V.extent,c))}function re(G){B.on("mousemove.zoom mouseup.zoom",null),Mv(G.view,V.moved),qc(G),V.event(G).end()}}function P(z,...R){if(e.apply(this,arguments)){var U=this.__zoom,V=ca(z.changedTouches?z.changedTouches[0]:z,this),B=U.invert(V),X=U.k*(z.shiftKey?.5:2),H=n(k(E(U,X),V,B),t.apply(this,R),c);qc(z),u>0?Wr(this).transition().duration(u).call(S,H,V,z):Wr(this).call(N.transform,H,V,z)}}function O(z,...R){if(e.apply(this,arguments)){var U=z.touches,V=U.length,B=M(this,R,z.changedTouches.length===V).event(z),X,H,F,K;for(Np(z),H=0;H<V;++H)F=U[H],K=ca(F,this),K=[K,this.__zoom.invert(K),F.identifier],B.touch0?!B.touch1&&B.touch0[2]!==K[2]&&(B.touch1=K,B.taps=0):(B.touch0=K,X=!0,B.taps=1+!!h);h&&(h=clearTimeout(h)),X&&(B.taps<2&&(f=K[0],h=setTimeout(function(){h=null},w)),lm(this),B.start())}}function D(z,...R){if(this.__zooming){var U=M(this,R).event(z),V=z.changedTouches,B=V.length,X,H,F,K;for(qc(z),X=0;X<B;++X)H=V[X],F=ca(H,this),U.touch0&&U.touch0[2]===H.identifier?U.touch0[0]=F:U.touch1&&U.touch1[2]===H.identifier&&(U.touch1[0]=F);if(H=U.that.__zoom,U.touch1){var re=U.touch0[0],G=U.touch0[1],q=U.touch1[0],Y=U.touch1[1],Q=(Q=q[0]-re[0])*Q+(Q=q[1]-re[1])*Q,ee=(ee=Y[0]-G[0])*ee+(ee=Y[1]-G[1])*ee;H=E(H,Math.sqrt(Q/ee)),F=[(re[0]+q[0])/2,(re[1]+q[1])/2],K=[(G[0]+Y[0])/2,(G[1]+Y[1])/2]}else if(U.touch0)F=U.touch0[0],K=U.touch0[1];else return;U.zoom("touch",n(k(H,F,K),U.extent,c))}}function W(z,...R){if(this.__zooming){var U=M(this,R).event(z),V=z.changedTouches,B=V.length,X,H;for(Np(z),g&&clearTimeout(g),g=setTimeout(function(){g=null},w),X=0;X<B;++X)H=V[X],U.touch0&&U.touch0[2]===H.identifier?delete U.touch0:U.touch1&&U.touch1[2]===H.identifier&&delete U.touch1;if(U.touch1&&!U.touch0&&(U.touch0=U.touch1,delete U.touch1),U.touch0)U.touch0[1]=this.__zoom.invert(U.touch0[0]);else if(U.end(),U.taps===2&&(H=ca(H,this),Math.hypot(f[0]-H[0],f[1]-H[1])<x)){var F=Wr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return N.wheelDelta=function(z){return arguments.length?(s=typeof z=="function"?z:im(+z),N):s},N.filter=function(z){return arguments.length?(e=typeof z=="function"?z:im(!!z),N):e},N.touchable=function(z){return arguments.length?(l=typeof z=="function"?z:im(!!z),N):l},N.extent=function(z){return arguments.length?(t=typeof z=="function"?z:im([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),N):t},N.scaleExtent=function(z){return arguments.length?(i[0]=+z[0],i[1]=+z[1],N):[i[0],i[1]]},N.translateExtent=function(z){return arguments.length?(c[0][0]=+z[0][0],c[1][0]=+z[1][0],c[0][1]=+z[0][1],c[1][1]=+z[1][1],N):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},N.constrain=function(z){return arguments.length?(n=z,N):n},N.duration=function(z){return arguments.length?(u=+z,N):u},N.interpolate=function(z){return arguments.length?(d=z,N):d},N.on=function(){var z=p.on.apply(p,arguments);return z===p?N:z},N.clickDistance=function(z){return arguments.length?(b=(z=+z)*z,N):Math.sqrt(b)},N.tapDistance=function(z){return arguments.length?(x=+z,N):x},N}function Lt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cp(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function ay(e,t){if(e){if(typeof e=="string")return Cp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Cp(e,t)}}function PE(e){if(Array.isArray(e))return e}function TE(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s=[],l=!0,i=!1,c,u;try{for(n=n.call(e);!(l=(c=n.next()).done)&&(s.push(c.value),!(t&&s.length===t));l=!0);}catch(d){i=!0,u=d}finally{try{!l&&n.return!=null&&n.return()}finally{if(i)throw u}}return s}}function $E(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Et(e,t){return PE(e)||TE(e,t)||ay(e,t)||$E()}var cl;(function(e){e.Strict="strict",e.Loose="loose"})(cl||(cl={}));var fi;(function(e){e.Lines="lines",e.Dots="dots"})(fi||(fi={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var co;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(co||(co={}));var cm;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(cm||(cm={}));var Re;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Re||(Re={}));var Sp=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},gi=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),s)},oy=function(t,n){return{x:gi(t.x,n[0][0],n[1][0]),y:gi(t.y,n[0][1],n[1][1])}},ly=function(t){var n,s;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((s=window)===null||s===void 0?void 0:s.document)},LE=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},um=function(t){var n=t.x,s=t.y,l=t.width,i=t.height;return{x:n,y:s,x2:n+l,y2:s+i}},zE=function(t){var n=t.x,s=t.y,l=t.x2,i=t.y2;return{x:n,y:s,width:l-n,height:i-s}},iy=function(t){return!isNaN(t)&&isFinite(t)},ds=Symbol("internals");function cy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Hc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function uy(e,t){var n=e.find(function(p){return p.id===t.parentNode});if(n){var s=t.position.x+t.width-n.width,l=t.position.y+t.height-n.height;if(s>0||l>0||t.position.x<0||t.position.y<0){var i,c;if(n.style=Hc({},n.style)||{},n.style.width=(i=n.style.width)!==null&&i!==void 0?i:n.width,n.style.height=(c=n.style.height)!==null&&c!==void 0?c:n.height,s>0&&(n.style.width+=s),l>0&&(n.style.height+=l),t.position.x<0){var u=Math.abs(t.position.x);n.position.x=n.position.x-u,n.style.width+=u,t.position.x=0}if(t.position.y<0){var d=Math.abs(t.position.y);n.position.y=n.position.y-d,n.style.height+=d,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function dy(e,t){if(e.some(function(s){return s.type==="reset"}))return e.filter(function(s){return s.type==="reset"}).map(function(s){return s.item});var n=e.filter(function(s){return s.type==="add"}).map(function(s){return s.item});return t.reduce(function(s,l){var i=e.find(function(d){return d.id===l.id});if(i)switch(i.type){case"select":return s.push(Hc(Hc({},l),{},{selected:i.selected})),s;case"position":{var c=Hc({},l);return typeof i.position<"u"&&(c.position=i.position),typeof i.positionAbsolute<"u"&&(c.positionAbsolute=i.positionAbsolute),typeof i.dragging<"u"&&(c.dragging=i.dragging),c.expandParent&&uy(s,c),s.push(c),s}case"dimensions":{var u=Hc({},l);return typeof i.dimensions<"u"&&(u.width=i.dimensions.width,u.height=i.dimensions.height),u.expandParent&&uy(s,u),s.push(u),s}case"remove":return s}return s.push(l),s},n)}function my(e,t){return dy(e,t)}function DE(e,t){return dy(e,t)}var uo=function(t,n){return{id:t,type:"select",selected:n}};function _i(e,t){return e.reduce(function(n,s){var l=t.includes(s.id);return!s.selected&&l?(s.selected=!0,n.push(uo(s.id,!0))):s.selected&&!l&&(s.selected=!1,n.push(uo(s.id,!1))),n},[])}function hy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function fy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var py=function(t,n,s){var l=n.querySelectorAll(t);if(!l||!l.length)return null;var i=Array.from(l),c=n.getBoundingClientRect();return i.map(function(u){var d=u.getBoundingClientRect();return fy({id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(d.left-c.left)/s,y:(d.top-c.top)/s},Sp(u))})};function Vc(e,t,n){return n===void 0?n:function(s){var l=t().nodeInternals.get(e);n(s,fy({},l))}}function gy(e){var t=e.id,n=e.store,s=n.getState(),l=s.addSelectedNodes,i=s.unselectNodesAndEdges,c=s.multiSelectionActive,u=s.nodeInternals,d=u.get(t);n.setState({nodesSelectionActive:!1}),d.selected?d.selected&&c&&i({nodes:[d]}):l([t])}function _y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Wc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_y(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_y(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var RE=function(t){return"id"in t&&"source"in t&&"target"in t},FE=function(t){var n=t.source,s=t.sourceHandle,l=t.target,i=t.targetHandle;return"reactflow__edge-".concat(n).concat(s||"","-").concat(l).concat(i||"")},Ep=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var s=n?"".concat(n,"__"):"";return"".concat(s).concat(Object.keys(t).sort().map(function(l){return"".concat(l,"=").concat(t[l])}).join("&"))},IE=function(t,n){return n.some(function(s){return s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)})},vy=function(t,n){if(!t.source||!t.target)return n;var s;return RE(t)?s=Wc({},t):s=Wc(Wc({},t),{},{id:FE(t)}),IE(s,n)?n:n.concat(s)},yy=function(t,n,s,l){var i=t.x,c=t.y,u=Et(n,3),d=u[0],p=u[1],h=u[2],f=Et(l,2),g=f[0],w=f[1],y={x:(i-d)/h,y:(c-p)/h};return s?{x:g*Math.round(y.x/g),y:w*Math.round(y.y/w)}:y},kp=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(s,l){var i=l.positionAbsolute,c=l.position,u=l.width,d=l.height;return LE(s,um({x:i?i.x:c.x,y:i?i.y:c.y,width:u||0,height:d||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return zE(n)},by=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],l=Et(s,3),i=l[0],c=l[1],u=l[2],d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,h=um({x:(n.x-i)/u,y:(n.y-c)/u,width:n.width/u,height:n.height/u}),f=[];return t.forEach(function(g){var w=g.positionAbsolute,y=g.width,b=g.height,x=g.selectable,N=x===void 0?!0:x;if(p&&!N)return!1;var E=um(Wc(Wc({},w),{},{width:y||0,height:b||0})),k=Math.max(0,Math.min(h.x2,E.x2)-Math.max(h.x,E.x)),j=Math.max(0,Math.min(h.y2,E.y2)-Math.max(h.y,E.y)),S=Math.ceil(k*j),M=typeof y>"u"||typeof b>"u"||y===null||b===null,$=d&&S>0,T=(y||0)*(b||0),L=M||$||S>=T;L&&f.push(g)}),f},xy=function(t,n){var s=t.map(function(l){return l.id});return n.filter(function(l){return s.includes(l.source)||s.includes(l.target)})},wy=function(t,n,s,l,i){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,u=n/(t.width*(1+c)),d=s/(t.height*(1+c)),p=Math.min(u,d),h=gi(p,l,i),f=t.x+t.width/2,g=t.y+t.height/2,w=n/2-f*h,y=s/2-g*h;return[w,y,h]},ul=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function jy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function vi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Ny(e,t,n,s){var l,i,c,u,d,p,h,f,g,w,y,b;if(!e.parentNode)return s;var x=t.get(e.parentNode);return Ny(x,t,n,{x:((l=s.x)!==null&&l!==void 0?l:0)+((i=(c=x.position)===null||c===void 0?void 0:c.x)!==null&&i!==void 0?i:0),y:((u=s.y)!==null&&u!==void 0?u:0)+((d=(p=x.position)===null||p===void 0?void 0:p.y)!==null&&d!==void 0?d:0),z:((h=(f=x[ds])===null||f===void 0?void 0:f.z)!==null&&h!==void 0?h:0)>((g=s.z)!==null&&g!==void 0?g:0)?(w=(y=x[ds])===null||y===void 0?void 0:y.z)!==null&&w!==void 0?w:0:(b=s.z)!==null&&b!==void 0?b:0})}function Mp(e,t){var n=new Map,s={};return e.forEach(function(l){var i,c=iy(l.zIndex)?l.zIndex:l.selected?1e3:0,u=t.get(l.id),d=vi(vi({width:u==null?void 0:u.width,height:u==null?void 0:u.height},l),{},{positionAbsolute:{x:l.position.x,y:l.position.y}});l.parentNode&&(d.parentNode=l.parentNode,s[l.parentNode]=!0),Object.defineProperty(d,ds,{enumerable:!1,value:{handleBounds:u==null||(i=u[ds])===null||i===void 0?void 0:i.handleBounds,z:c}}),n.set(l.id,d)}),n.forEach(function(l){if(l.parentNode&&!n.has(l.parentNode))throw new Error("Parent node ".concat(l.parentNode," not found"));if(l.parentNode||s[l.id]){var i,c,u=Ny(l,n,s,vi(vi({},l.position),{},{z:(i=(c=l[ds])===null||c===void 0?void 0:c.z)!==null&&i!==void 0?i:0})),d=u.x,p=u.y,h=u.z;l.positionAbsolute={x:d,y:p},l[ds].z=h,s[l.id]&&(l[ds].isParent=!0)}}),n}function Cy(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),s=n.nodeInternals,l=n.width,i=n.height,c=n.minZoom,u=n.maxZoom,d=n.d3Zoom,p=n.d3Selection,h=n.fitViewOnInitDone,f=n.fitViewOnInit;if((t.initial&&!h&&f||!t.initial)&&d&&p){var g=Array.from(s.values()).filter(function(T){return t.includeHiddenNodes?T.width&&T.height:!T.hidden}),w=g.every(function(T){return T.width&&T.height});if(g.length>0&&w){var y,b,x,N=kp(g),E=wy(N,l,i,(y=t.minZoom)!==null&&y!==void 0?y:c,(b=t.maxZoom)!==null&&b!==void 0?b:u,(x=t.padding)!==null&&x!==void 0?x:.1),k=Et(E,3),j=k[0],S=k[1],M=k[2],$=il.translate(j,S).scale(M);return typeof t.duration=="number"&&t.duration>0?d.transform(ul(p,t.duration),$):d.transform(p,$),!0}}return!1}function BE(e,t){return e.forEach(function(n){var s=t.get(n.id);if(s){var l;t.set(s.id,vi(vi({},s),{},(l={},Lt(l,ds,s[ds]),Lt(l,"selected",n.selected),l)))}}),new Map(t)}function UE(e,t){return t.map(function(n){var s=e.find(function(l){return l.id===n.id});return s&&(n.selected=s.selected),n})}function dm(e){var t=e.changedNodes,n=e.changedEdges,s=e.get,l=e.set,i=s(),c=i.nodeInternals,u=i.edges,d=i.onNodesChange,p=i.onEdgesChange,h=i.hasDefaultNodes,f=i.hasDefaultEdges;t!=null&&t.length&&(h&&l({nodeInternals:BE(t,c)}),d==null||d(t)),n!=null&&n.length&&(f&&l({edges:UE(n,u)}),p==null||p(n))}var Ap=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Sy={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Ap,nodeExtent:Ap,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:cl.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function Ey(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function ma(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ey(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Op=Zj(),ky=Op.Provider,Tn=Op.useStore,js=Op.useStoreApi,My=function(){return Jj(function(t,n){return ma(ma({},Sy),{},{setNodes:function(l){t({nodeInternals:Mp(l,n().nodeInternals)})},setEdges:function(l){var i=n(),c=i.defaultEdgeOptions,u=c===void 0?{}:c;t({edges:l.map(function(d){return ma(ma({},u),d)})})},setDefaultNodesAndEdges:function(l,i){var c=typeof l<"u",u=typeof i<"u",d=c?Mp(l,new Map):new Map,p=u?i:[];t({nodeInternals:d,edges:p,hasDefaultNodes:c,hasDefaultEdges:u})},updateNodeDimensions:function(l){var i=n(),c=i.onNodesChange,u=i.nodeInternals,d=i.fitViewOnInit,p=i.fitViewOnInitDone,h=i.fitViewOnInitOptions,f=i.domNode,g=f==null?void 0:f.querySelector(".react-flow__viewport");if(g){var w=window.getComputedStyle(g),y=new window.DOMMatrixReadOnly(w.transform),b=y.m22,x=l.reduce(function(E,k){var j=u.get(k.id);if(j){var S=Sp(k.nodeElement),M=!!(S.width&&S.height&&(j.width!==S.width||j.height!==S.height||k.forceUpdate));M&&(u.set(j.id,ma(ma({},j),{},Lt({},ds,ma(ma({},j[ds]),{},{handleBounds:{source:py(".source",k.nodeElement,b),target:py(".target",k.nodeElement,b)}})),S)),E.push({id:j.id,type:"dimensions",dimensions:S}))}return E},[]),N=p||d&&!p&&Cy(n,ma({initial:!0},h));t({nodeInternals:new Map(u),fitViewOnInitDone:N}),(x==null?void 0:x.length)>0&&(c==null||c(x))}},updateNodePositions:function(l){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=n(),d=u.onNodesChange,p=u.nodeInternals,h=u.hasDefaultNodes;if(h||d){var f=l.map(function(y){var b={id:y.id,type:"position",dragging:c};return i&&(b.positionAbsolute=y.positionAbsolute,b.position=y.position),b});if(f!=null&&f.length){if(h){var g=my(f,Array.from(p.values())),w=Mp(g,p);t({nodeInternals:w})}d==null||d(f)}}},addSelectedNodes:function(l){var i=n(),c=i.multiSelectionActive,u=i.nodeInternals,d=i.edges,p,h=null;c?p=l.map(function(f){return uo(f,!0)}):(p=_i(Array.from(u.values()),l),h=_i(d,[])),dm({changedNodes:p,changedEdges:h,get:n,set:t})},addSelectedEdges:function(l){var i=n(),c=i.multiSelectionActive,u=i.edges,d=i.nodeInternals,p,h=null;c?p=l.map(function(f){return uo(f,!0)}):(p=_i(u,l),h=_i(Array.from(d.values()),[])),dm({changedNodes:h,changedEdges:p,get:n,set:t})},unselectNodesAndEdges:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=l.nodes,c=l.edges,u=n(),d=u.nodeInternals,p=u.edges,h=i||Array.from(d.values()),f=c||p,g=h.map(function(y){return y.selected=!1,uo(y.id,!1)}),w=f.map(function(y){return uo(y.id,!1)});dm({changedNodes:g,changedEdges:w,get:n,set:t})},setMinZoom:function(l){var i=n(),c=i.d3Zoom,u=i.maxZoom;c==null||c.scaleExtent([l,u]),t({minZoom:l})},setMaxZoom:function(l){var i=n(),c=i.d3Zoom,u=i.minZoom;c==null||c.scaleExtent([u,l]),t({maxZoom:l})},setTranslateExtent:function(l){var i=n(),c=i.d3Zoom;c==null||c.translateExtent(l),t({translateExtent:l})},resetSelectedElements:function(){var l=n(),i=l.nodeInternals,c=l.edges,u=Array.from(i.values()),d=u.filter(function(h){return h.selected}).map(function(h){return uo(h.id,!1)}),p=c.filter(function(h){return h.selected}).map(function(h){return uo(h.id,!1)});dm({changedNodes:d,changedEdges:p,get:n,set:t})},setNodeExtent:function(l){var i=n(),c=i.nodeInternals;c.forEach(function(u){u.positionAbsolute=oy(u.position,l)}),t({nodeExtent:l,nodeInternals:new Map(c)})},reset:function(){return t(ma({},Sy))}})})};function fr(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=fr(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function pr(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let s=0;s<n.length;s++)if(!Object.prototype.hasOwnProperty.call(t,n[s])||!Object.is(e[n[s]],t[n[s]]))return!1;return!0}function qE(e){if(Array.isArray(e))return Cp(e)}function HE(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function VE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function dl(e){return qE(e)||HE(e)||ay(e)||VE()}var WE={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},KE=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},YE=function(){var t=js(),n=Tn(KE,pr),s=n.d3Zoom,l=n.d3Selection,i=v.useMemo(function(){return l&&s?{zoomIn:function(u){return s.scaleBy(ul(l,u==null?void 0:u.duration),1.2)},zoomOut:function(u){return s.scaleBy(ul(l,u==null?void 0:u.duration),1/1.2)},zoomTo:function(u,d){return s.scaleTo(ul(l,d==null?void 0:d.duration),u)},getZoom:function(){return t.getState().transform[2]},setViewport:function(u,d){var p,h,f,g=Et(t.getState().transform,3),w=g[0],y=g[1],b=g[2],x=il.translate((p=u.x)!==null&&p!==void 0?p:w,(h=u.y)!==null&&h!==void 0?h:y).scale((f=u.zoom)!==null&&f!==void 0?f:b);s.transform(ul(l,d==null?void 0:d.duration),x)},getViewport:function(){var u=Et(t.getState().transform,3),d=u[0],p=u[1],h=u[2];return{x:d,y:p,zoom:h}},fitView:function(u){return Cy(t.getState,u)},setCenter:function(u,d,p){var h=t.getState(),f=h.width,g=h.height,w=h.maxZoom,y=typeof(p==null?void 0:p.zoom)<"u"?p.zoom:w,b=f/2-u*y,x=g/2-d*y,N=il.translate(b,x).scale(y);s.transform(ul(l,p==null?void 0:p.duration),N)},fitBounds:function(u,d){var p,h=t.getState(),f=h.width,g=h.height,w=h.minZoom,y=h.maxZoom,b=wy(u,f,g,w,y,(p=d==null?void 0:d.padding)!==null&&p!==void 0?p:.1),x=Et(b,3),N=x[0],E=x[1],k=x[2],j=il.translate(N,E).scale(k);s.transform(ul(l,d==null?void 0:d.duration),j)},project:function(u){var d=t.getState(),p=d.transform,h=d.snapToGrid,f=d.snapGrid;return yy(u,p,h,f)},viewportInitialized:!0}:WE},[s,l]);return i};function Ay(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function yi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ay(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ay(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Pp(){var e=YE(),t=js(),n=v.useCallback(function(){var f=t.getState(),g=f.nodeInternals,w=Array.from(g.values());return w.map(function(y){return yi({},y)})},[]),s=v.useCallback(function(f){var g=t.getState(),w=g.nodeInternals;return w.get(f)},[]),l=v.useCallback(function(){var f=t.getState(),g=f.edges,w=g===void 0?[]:g;return w.map(function(y){return yi({},y)})},[]),i=v.useCallback(function(f){var g=t.getState(),w=g.edges,y=w===void 0?[]:w;return y.find(function(b){return b.id===f})},[]),c=v.useCallback(function(f){var g=t.getState(),w=g.nodeInternals,y=g.setNodes,b=g.hasDefaultNodes,x=g.onNodesChange,N=Array.from(w.values()),E=typeof f=="function"?f(N):f;if(b)y(E);else if(x){var k=E.length===0?N.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});x(k)}},[]),u=v.useCallback(function(f){var g=t.getState(),w=g.edges,y=w===void 0?[]:w,b=g.setEdges,x=g.hasDefaultEdges,N=g.onEdgesChange,E=typeof f=="function"?f(y):f;if(x)b(E);else if(N){var k=E.length===0?y.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});N(k)}},[]),d=v.useCallback(function(f){var g=Array.isArray(f)?f:[f],w=t.getState(),y=w.nodeInternals,b=w.setNodes,x=w.hasDefaultNodes,N=w.onNodesChange;if(x){var E=Array.from(y.values()),k=[].concat(E,dl(g));b(k)}else if(N){var j=g.map(function(S){return{item:S,type:"add"}});N(j)}},[]),p=v.useCallback(function(f){var g=Array.isArray(f)?f:[f],w=t.getState(),y=w.edges,b=y===void 0?[]:y,x=w.setEdges,N=w.hasDefaultEdges,E=w.onEdgesChange;if(N)x([].concat(dl(b),dl(g)));else if(E){var k=g.map(function(j){return{item:j,type:"add"}});E(k)}},[]),h=v.useCallback(function(){var f=t.getState(),g=f.nodeInternals,w=f.edges,y=w===void 0?[]:w,b=f.transform,x=Array.from(g.values()),N=Et(b,3),E=N[0],k=N[1],j=N[2];return{nodes:x.map(function(S){return yi({},S)}),edges:y.map(function(S){return yi({},S)}),viewport:{x:E,y:k,zoom:j}}},[]);return v.useMemo(function(){return yi(yi({},e),{},{getNodes:n,getNode:s,getEdges:l,getEdge:i,setNodes:c,setEdges:u,addNodes:d,addEdges:p,toObject:h})},[e,n,s,l,i,c,u,d,p,h])}function GE(e,t){if(e==null)return{};var n={},s=Object.keys(e),l,i;for(i=0;i<s.length;i++)l=s[i],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function mm(e,t){if(e==null)return{};var n=GE(e,t),s,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(l=0;l<i.length;l++)s=i[l],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function QE(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},be.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function XE(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},be.createElement("path",{d:"M0 0h32v4.2H0z"}))}function JE(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},be.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function ZE(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},be.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function e1(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},be.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var t1=["children","className"];function Oy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function n1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Oy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var hm=function(t){var n=t.children,s=t.className,l=mm(t,t1);return be.createElement("button",n1({type:"button",className:fr(["react-flow__controls-button",s])},l),n)},s1=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},Py=function(t){var n=t.style,s=t.showZoom,l=s===void 0?!0:s,i=t.showFitView,c=i===void 0?!0:i,u=t.showInteractive,d=u===void 0?!0:u,p=t.fitViewOptions,h=t.onZoomIn,f=t.onZoomOut,g=t.onFitView,w=t.onInteractiveChange,y=t.className,b=t.children,x=js(),N=v.useState(!1),E=Et(N,2),k=E[0],j=E[1],S=Tn(s1),M=Pp(),$=M.zoomIn,T=M.zoomOut,L=M.fitView;if(v.useEffect(function(){j(!0)},[]),!k)return null;var P=function(){$==null||$(),h==null||h()},O=function(){T==null||T(),f==null||f()},D=function(){L==null||L(p),g==null||g()},W=function(){x.setState({nodesDraggable:!S,nodesConnectable:!S,elementsSelectable:!S}),w==null||w(!S)};return be.createElement("div",{className:fr(["react-flow__controls",y]),style:n},l&&be.createElement(be.Fragment,null,be.createElement(hm,{onClick:P,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},be.createElement(QE,null)),be.createElement(hm,{onClick:O,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},be.createElement(XE,null))),c&&be.createElement(hm,{className:"react-flow__controls-fitview",onClick:D,title:"fit view","aria-label":"fit view"},be.createElement(JE,null)),d&&be.createElement(hm,{className:"react-flow__controls-interactive",onClick:W,title:"toggle interactivity","aria-label":"toggle interactivity"},S?be.createElement(e1,null):be.createElement(ZE,null)),b)};Py.displayName="Controls";var r1=v.memo(Py),a1=function(t,n,s){return be.createElement("path",{stroke:s,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},o1=function(t,n){return be.createElement("circle",{cx:t,cy:t,r:t,fill:n})},fm;function Ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function $y(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ty(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ty(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var l1=(fm={},Lt(fm,fi.Dots,"#81818a"),Lt(fm,fi.Lines,"#eee"),fm),i1=function(t){return t.transform},Ly=function(t){var n=t.variant,s=n===void 0?fi.Dots:n,l=t.gap,i=l===void 0?15:l,c=t.size,u=c===void 0?.4:c,d=t.color,p=t.style,h=t.className,f=v.useRef(null),g=v.useState(null),w=Et(g,2),y=w[0],b=w[1],x=Tn(i1),N=Et(x,3),E=N[0],k=N[1],j=N[2];v.useEffect(function(){var O=document.querySelectorAll(".react-flow__background"),D=Array.from(O).findIndex(function(W){return W===f.current});b("pattern-".concat(D))},[]);var S=i*j||1,M=E%S,$=k%S,T=s===fi.Lines,L=d||l1[s],P=T?a1(S,u,L):o1(u*j,L);return be.createElement("svg",{className:fr(["react-flow__background","react-flow__container",h]),style:$y($y({},p),{},{width:"100%",height:"100%"}),ref:f},y&&be.createElement(be.Fragment,null,be.createElement("pattern",{id:y,x:M,y:$,width:S,height:S,patternUnits:"userSpaceOnUse"},P),be.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(y,")")})))};Ly.displayName="Background";var c1=v.memo(Ly),u1=function(t){return t.updateNodeDimensions};function d1(){var e=js(),t=Tn(u1);return v.useCallback(function(n){var s,l=(s=e.getState().domNode)===null||s===void 0?void 0:s.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));l&&requestAnimationFrame(function(){return t([{id:n,nodeElement:l,forceUpdate:!0}])})},[])}var m1=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function h1(e){var t=e.proOptions,n=e.position,s=n===void 0?"bottom-right":n;if(t!=null&&t.account&&m1.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var l="".concat(s).split("-");return be.createElement("div",{className:fr(["react-flow__attribution"].concat(dl(l))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},be.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var f1=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function zy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function p1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var g1=function(t){var n=t.x,s=t.y,l=t.label,i=t.labelStyle,c=i===void 0?{}:i,u=t.labelShowBg,d=u===void 0?!0:u,p=t.labelBgStyle,h=p===void 0?{}:p,f=t.labelBgPadding,g=f===void 0?[2,4]:f,w=t.labelBgBorderRadius,y=w===void 0?2:w,b=t.children,x=t.className,N=mm(t,f1),E=v.useRef(null),k=v.useState({x:0,y:0,width:0,height:0}),j=Et(k,2),S=j[0],M=j[1],$=fr(["react-flow__edge-textwrapper",x]);return v.useEffect(function(){if(E.current){var T=E.current.getBBox();M({x:T.x,y:T.y,width:T.width,height:T.height})}},[l]),typeof l>"u"||!l?null:be.createElement("g",p1({transform:"translate(".concat(n-S.width/2," ").concat(s-S.height/2,")"),className:$},N),d&&be.createElement("rect",{width:S.width+2*g[0],x:-g[0],y:-g[1],height:S.height+2*g[1],className:"react-flow__edge-textbg",style:h,rx:y,ry:y}),be.createElement("text",{className:"react-flow__edge-text",y:S.height/2,dy:"0.3em",ref:E,style:c},l),b)},_1=v.memo(g1),pm=function(e){var t=e.path,n=e.centerX,s=e.centerY,l=e.label,i=e.labelStyle,c=e.labelShowBg,u=e.labelBgStyle,d=e.labelBgPadding,p=e.labelBgBorderRadius,h=e.style,f=e.markerEnd,g=e.markerStart,w=l?be.createElement(_1,{x:n,y:s,label:l,labelStyle:i,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:p}):null;return be.createElement(be.Fragment,null,be.createElement("path",{style:h,d:t,className:"react-flow__edge-path",markerEnd:f,markerStart:g}),w)};function gm(e){var t=e.pos,n=e.x1,s=e.y1,l=e.x2,i=e.y2,c,u;switch(t){case Re.Left:case Re.Right:c=.5*(n+l),u=s;break;case Re.Top:case Re.Bottom:c=n,u=.5*(s+i);break}return[c,u]}function Dy(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Re.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Re.Top:u,p=gm({pos:l,x1:t,y1:n,x2:i,y2:c}),h=Et(p,2),f=h[0],g=h[1],w=gm({pos:d,x1:i,y1:c,x2:t,y2:n}),y=Et(w,2),b=y[0],x=y[1];return"M".concat(t,",").concat(n," C").concat(f,",").concat(g," ").concat(b,",").concat(x," ").concat(i,",").concat(c)}function v1(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Re.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Re.Top:u,p=gm({pos:l,x1:t,y1:n,x2:i,y2:c}),h=Et(p,2),f=h[0],g=h[1],w=gm({pos:d,x1:i,y1:c,x2:t,y2:n}),y=Et(w,2),b=y[0],x=y[1],N=t*.125+f*.375+b*.375+i*.125,E=n*.125+g*.375+x*.375+c*.125,k=Math.abs(N-t),j=Math.abs(E-n);return[N,E,k,j]}var Ry=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.sourcePosition,c=i===void 0?Re.Bottom:i,u=e.targetPosition,d=u===void 0?Re.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,w=e.labelBgPadding,y=e.labelBgBorderRadius,b=e.style,x=e.markerEnd,N=e.markerStart,E={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:l,targetPosition:d},k=Dy(E),j=v1(E),S=Et(j,2),M=S[0],$=S[1];return be.createElement(pm,{path:k,centerX:M,centerY:$,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:y,style:b,markerEnd:x,markerStart:N})});function Fy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function y1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Fy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Fy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Iy=[Re.Left,Re.Right],By=function(t){var n=t.sourceX,s=t.sourceY,l=t.targetX,i=t.targetY,c=t.sourcePosition,u=c===void 0?Re.Bottom:c,d=t.targetPosition,p=d===void 0?Re.Top:d,h=Iy.includes(u),f=Iy.includes(p),g=h&&!f||f&&!h;if(g){var w=h?Math.abs(l-n):0,y=n>l?n-w:n+w,b=h?0:Math.abs(i-s),x=s<i?s+b:s-b;return[y,x,w,b]}var N=Math.abs(l-n)/2,E=l<n?l+N:l-N,k=Math.abs(i-s)/2,j=i<s?i+k:i-k;return[E,j,N,k]};function Kc(e,t,n){return n===void 0?n:function(s){var l=t().edges.find(function(i){return i.id===e});n(s,y1({},l))}}var Tp=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},$p=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},Lp=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},zp=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},Dp=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)},Rp=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},Fp=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},Ip=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)};function Bp(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Re.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Re.Top:u,p=e.borderRadius,h=p===void 0?5:p,f=e.centerX,g=e.centerY,w=By({sourceX:t,sourceY:n,targetX:i,targetY:c}),y=Et(w,4),b=y[0],x=y[1],N=y[2],E=y[3],k=Math.min(h,Math.abs(i-t)),j=Math.min(h,Math.abs(c-n)),S=Math.min(k,j,N,E),M=[Re.Left,Re.Right],$=typeof f<"u"?f:b,T=typeof g<"u"?g:x,L=null,P=null;return t<=i?(L=n<=c?Tp(t,T,S):Rp(t,T,S),P=n<=c?Ip(i,T,S):zp(i,T,S)):(L=n<c?Lp(t,T,S):Fp(t,T,S),P=n<c?Dp(i,T,S):$p(i,T,S)),M.includes(l)&&M.includes(d)?t<=i?(L=n<=c?Ip($,n,S):zp($,n,S),P=n<=c?Tp($,c,S):Rp($,c,S)):(l===Re.Right&&d===Re.Left||l===Re.Left&&d===Re.Right||l===Re.Left&&d===Re.Left)&&(L=n<=c?Dp($,n,S):$p($,n,S),P=n<=c?Lp($,c,S):Fp($,c,S)):M.includes(l)&&!M.includes(d)?(t<=i?L=n<=c?Ip(i,n,S):zp(i,n,S):L=n<=c?Dp(i,n,S):$p(i,n,S),P=""):!M.includes(l)&&M.includes(d)&&(t<=i?L=n<=c?Tp(t,c,S):Rp(t,c,S):L=n<=c?Lp(t,c,S):Fp(t,c,S),P=""),"M ".concat(t,",").concat(n).concat(L).concat(P,"L ").concat(i,",").concat(c)}var Up=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.sourcePosition,w=g===void 0?Re.Bottom:g,y=e.targetPosition,b=y===void 0?Re.Top:y,x=e.markerEnd,N=e.markerStart,E=e.borderRadius,k=E===void 0?5:E,j=By({sourceX:t,sourceY:n,targetX:s,targetY:l,sourcePosition:w,targetPosition:b}),S=Et(j,2),M=S[0],$=S[1],T=Bp({sourceX:t,sourceY:n,sourcePosition:w,targetX:s,targetY:l,targetPosition:b,borderRadius:k});return be.createElement(pm,{path:T,centerX:M,centerY:$,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:x,markerStart:N})});function Uy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function qy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Uy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Hy=v.memo(function(e){return be.createElement(Up,qy(qy({},e),{},{borderRadius:0}))}),Vy=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.markerEnd,w=e.markerStart,y=Math.abs(l-n)/2,b=l<n?l+y:l-y,x=Math.abs(s-t)/2,N=s<t?s+x:s-x,E="M ".concat(t,",").concat(n,"L ").concat(s,",").concat(l);return be.createElement(pm,{path:E,centerX:N,centerY:b,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:w})});function _m(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function vm(e){var t=e.pos,n=e.x1,s=e.y1,l=e.x2,i=e.y2,c=e.c,u,d;switch(t){case Re.Left:u=n-_m(n-l,c),d=s;break;case Re.Right:u=n+_m(l-n,c),d=s;break;case Re.Top:u=n,d=s-_m(s-i,c);break;case Re.Bottom:u=n,d=s+_m(i-s,c);break}return[u,d]}function Wy(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Re.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Re.Top:u,p=e.curvature,h=p===void 0?.25:p,f=vm({pos:l,x1:t,y1:n,x2:i,y2:c,c:h}),g=Et(f,2),w=g[0],y=g[1],b=vm({pos:d,x1:i,y1:c,x2:t,y2:n,c:h}),x=Et(b,2),N=x[0],E=x[1];return"M".concat(t,",").concat(n," C").concat(w,",").concat(y," ").concat(N,",").concat(E," ").concat(i,",").concat(c)}function b1(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Re.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Re.Top:u,p=e.curvature,h=p===void 0?.25:p,f=vm({pos:l,x1:t,y1:n,x2:i,y2:c,c:h}),g=Et(f,2),w=g[0],y=g[1],b=vm({pos:d,x1:i,y1:c,x2:t,y2:n,c:h}),x=Et(b,2),N=x[0],E=x[1],k=t*.125+w*.375+N*.375+i*.125,j=n*.125+y*.375+E*.375+c*.125,S=Math.abs(k-t),M=Math.abs(j-n);return[k,j,S,M]}var qp=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.sourcePosition,c=i===void 0?Re.Bottom:i,u=e.targetPosition,d=u===void 0?Re.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,w=e.labelBgPadding,y=e.labelBgBorderRadius,b=e.style,x=e.markerEnd,N=e.markerStart,E=e.curvature,k={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:l,targetPosition:d,curvature:E},j=Wy(k),S=b1(k),M=Et(S,2),$=M[0],T=M[1];return be.createElement(pm,{path:j,centerX:$,centerY:T,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:y,style:b,markerEnd:x,markerStart:N})}),Hp=v.createContext(null),x1=Hp.Provider;Hp.Consumer;function Vp(e,t,n,s,l,i,c){var u=c.elementFromPoint(e.clientX,e.clientY),d=(u==null?void 0:u.classList.contains("target"))||!1,p=(u==null?void 0:u.classList.contains("source"))||!1,h={elementBelow:u,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(u&&(d||p)){h.isHoveringHandle=!0;var f=u.getAttribute("data-nodeid"),g=u.getAttribute("data-handleid"),w=n?{source:f,sourceHandle:g,target:s,targetHandle:l}:{source:s,sourceHandle:l,target:f,targetHandle:g};h.connection=w;var y=t===cl.Strict?n&&p||!n&&d:!0;y&&(h.isValid=i(w))}return h}function Wp(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function Ky(e){var t=e.event,n=e.handleId,s=e.nodeId,l=e.onConnect,i=e.isTarget,c=e.getState,u=e.setState,d=e.isValidConnection,p=e.elementEdgeUpdaterType,h=e.onEdgeUpdateEnd,f=t.target.closest(".react-flow"),g=ly(t.target);if(!g)return;var w=g.elementFromPoint(t.clientX,t.clientY),y=w==null?void 0:w.classList.contains("target"),b=w==null?void 0:w.classList.contains("source");if(!f||!y&&!b&&!p)return;var x=c(),N=x.onConnectStart,E=x.connectionMode,k=p||(y?"target":"source"),j=f.getBoundingClientRect(),S;u({connectionPosition:{x:t.clientX-j.left,y:t.clientY-j.top},connectionNodeId:s,connectionHandleId:n,connectionHandleType:k}),N==null||N(t,{nodeId:s,handleId:n,handleType:k});function M(T){u({connectionPosition:{x:T.clientX-j.left,y:T.clientY-j.top}});var L=Vp(T,E,i,s,n,d,g),P=L.connection,O=L.elementBelow,D=L.isValid,W=L.isHoveringHandle;if(!W)return Wp(S);P.source!==P.target&&O&&(Wp(S),S=O,O.classList.add("react-flow__handle-connecting"),O.classList.toggle("react-flow__handle-valid",D))}function $(T){var L=c(),P=L.onConnectStop,O=L.onConnectEnd,D=Vp(T,E,i,s,n,d,g),W=D.connection,z=D.isValid;P==null||P(T),z&&(l==null||l(W)),O==null||O(T),p&&h&&h(T),Wp(S),u({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),g.removeEventListener("mousemove",M),g.removeEventListener("mouseup",$)}g.addEventListener("mousemove",M),g.addEventListener("mouseup",$)}var w1=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function Yy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Kp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yy(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var j1=function(){return!0},N1=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},Gy=v.forwardRef(function(e,t){var n=e.type,s=n===void 0?"source":n,l=e.position,i=l===void 0?Re.Top:l,c=e.isValidConnection,u=c===void 0?j1:c,d=e.isConnectable,p=d===void 0?!0:d,h=e.id,f=e.onConnect,g=e.children,w=e.className,y=e.onMouseDown,b=mm(e,w1),x=js(),N=v.useContext(Hp),E=Tn(N1,pr),k=E.connectionStartHandle,j=E.connectOnClick,S=h||null,M=s==="target",$=function(O){var D=x.getState(),W=D.defaultEdgeOptions,z=D.onConnect,R=D.hasDefaultEdges,U=Kp(Kp({},W),O);if(R){var V=x.getState(),B=V.edges;x.setState({edges:vy(U,B)})}z==null||z(U),f==null||f(U)},T=function(O){O.button===0&&Ky({event:O,handleId:S,nodeId:N,onConnect:$,isTarget:M,getState:x.getState,setState:x.setState,isValidConnection:u}),y==null||y(O)},L=function(O){var D=x.getState(),W=D.onClickConnectStart,z=D.onClickConnectStop,R=D.onClickConnectEnd,U=D.connectionMode;if(!k){W==null||W(O,{nodeId:N,handleId:S,handleType:s}),x.setState({connectionStartHandle:{nodeId:N,type:s,handleId:S}});return}var V=ly(O.target),B=Vp(O,U,k.type==="target",k.nodeId,k.handleId||null,u,V),X=B.connection,H=B.isValid;z==null||z(O),H&&$(X),R==null||R(O),x.setState({connectionStartHandle:null})};return be.createElement("div",Kp({"data-handleid":S,"data-nodeid":N,"data-handlepos":i,className:fr(["react-flow__handle","react-flow__handle-".concat(i),"nodrag",w,{source:!M,target:M,connectable:p,connecting:(k==null?void 0:k.nodeId)===N&&(k==null?void 0:k.handleId)===S&&(k==null?void 0:k.type)===s}]),onMouseDown:T,onClick:j?L:void 0,ref:t},b),g)});Gy.displayName="Handle";var Yc=v.memo(Gy),Qy=function(t){var n=t.data,s=t.isConnectable,l=t.targetPosition,i=l===void 0?Re.Top:l,c=t.sourcePosition,u=c===void 0?Re.Bottom:c;return be.createElement(be.Fragment,null,be.createElement(Yc,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label,be.createElement(Yc,{type:"source",position:u,isConnectable:s}))};Qy.displayName="DefaultNode";var Yp=v.memo(Qy),Xy=function(t){var n=t.data,s=t.isConnectable,l=t.sourcePosition,i=l===void 0?Re.Bottom:l;return be.createElement(be.Fragment,null,n==null?void 0:n.label,be.createElement(Yc,{type:"source",position:i,isConnectable:s}))};Xy.displayName="InputNode";var Jy=v.memo(Xy),Zy=function(t){var n=t.data,s=t.isConnectable,l=t.targetPosition,i=l===void 0?Re.Top:l;return be.createElement(be.Fragment,null,be.createElement(Yc,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label)};Zy.displayName="OutputNode";var eb=v.memo(Zy),C1=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},S1=function(t,n){var s=t.selectedNodes.map(function(u){return u.id}),l=n.selectedNodes.map(function(u){return u.id}),i=t.selectedEdges.map(function(u){return u.id}),c=n.selectedEdges.map(function(u){return u.id});return pr(s,l)&&pr(i,c)};function E1(e){var t=e.onSelectionChange,n=Tn(C1,S1),s=n.selectedNodes,l=n.selectedEdges;return v.useEffect(function(){t({nodes:s,edges:l})},[s,l]),null}var k1=v.memo(E1),M1=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function mo(e,t){v.useEffect(function(){typeof e<"u"&&t(e)},[e])}function Jt(e,t,n){v.useEffect(function(){typeof t<"u"&&n(Lt({},e,t))},[t])}var A1=function(t){var n=t.nodes,s=t.edges,l=t.defaultNodes,i=t.defaultEdges,c=t.onConnect,u=t.onConnectStart,d=t.onConnectStop,p=t.onConnectEnd,h=t.onClickConnectStart,f=t.onClickConnectStop,g=t.onClickConnectEnd,w=t.nodesDraggable,y=t.nodesConnectable,b=t.minZoom,x=t.maxZoom,N=t.nodeExtent,E=t.onNodesChange,k=t.onEdgesChange,j=t.elementsSelectable,S=t.connectionMode,M=t.snapGrid,$=t.snapToGrid,T=t.translateExtent,L=t.connectOnClick,P=t.defaultEdgeOptions,O=t.fitView,D=t.fitViewOptions,W=t.onNodesDelete,z=t.onEdgesDelete,R=t.onNodeDrag,U=t.onNodeDragStart,V=t.onNodeDragStop,B=t.onSelectionDrag,X=t.onSelectionDragStart,H=t.onSelectionDragStop,F=Tn(M1,pr),K=F.setNodes,re=F.setEdges,G=F.setDefaultNodesAndEdges,q=F.setMinZoom,Y=F.setMaxZoom,Q=F.setTranslateExtent,ee=F.setNodeExtent,J=F.reset,se=js();return v.useEffect(function(){return G(l,i),function(){J()}},[]),Jt("defaultEdgeOptions",P,se.setState),Jt("connectionMode",S,se.setState),Jt("onConnect",c,se.setState),Jt("onConnectStart",u,se.setState),Jt("onConnectStop",d,se.setState),Jt("onConnectEnd",p,se.setState),Jt("onClickConnectStart",h,se.setState),Jt("onClickConnectStop",f,se.setState),Jt("onClickConnectEnd",g,se.setState),Jt("nodesDraggable",w,se.setState),Jt("nodesConnectable",y,se.setState),Jt("elementsSelectable",j,se.setState),Jt("snapToGrid",$,se.setState),Jt("snapGrid",M,se.setState),Jt("onNodesChange",E,se.setState),Jt("onEdgesChange",k,se.setState),Jt("connectOnClick",L,se.setState),Jt("fitViewOnInit",O,se.setState),Jt("fitViewOnInitOptions",D,se.setState),Jt("onNodesDelete",W,se.setState),Jt("onEdgesDelete",z,se.setState),Jt("onNodeDrag",R,se.setState),Jt("onNodeDragStart",U,se.setState),Jt("onNodeDragStop",V,se.setState),Jt("onSelectionDrag",B,se.setState),Jt("onSelectionDragStart",X,se.setState),Jt("onSelectionDragStop",H,se.setState),mo(n,K),mo(s,re),mo(l,K),mo(i,re),mo(b,q),mo(x,Y),mo(T,Q),mo(N,ee),null},O1=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",P1=O1,T1=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",$1=T1,L1=function(t,n,s){return s===Re.Left?t-n:s===Re.Right?t+n:t},z1=function(t,n,s){return s===Re.Top?t-n:s===Re.Bottom?t+n:t},tb=function(t){var n=t.className,s=t.position,l=t.centerX,i=t.centerY,c=t.radius,u=c===void 0?10:c;return be.createElement("circle",{className:fr(["react-flow__edgeupdater",n]),cx:L1(l,u,s),cy:z1(i,u,s),r:u,stroke:"transparent",fill:"transparent"})},bi=function(e){var t=function(s){var l=s.id,i=s.className,c=s.type,u=s.data,d=s.onClick,p=s.onEdgeDoubleClick,h=s.selected,f=s.animated,g=s.label,w=s.labelStyle,y=s.labelShowBg,b=s.labelBgStyle,x=s.labelBgPadding,N=s.labelBgBorderRadius,E=s.style,k=s.source,j=s.target,S=s.sourceX,M=s.sourceY,$=s.targetX,T=s.targetY,L=s.sourcePosition,P=s.targetPosition,O=s.elementsSelectable,D=s.hidden,W=s.sourceHandleId,z=s.targetHandleId,R=s.onContextMenu,U=s.onMouseEnter,V=s.onMouseMove,B=s.onMouseLeave,X=s.edgeUpdaterRadius,H=s.onEdgeUpdate,F=s.onEdgeUpdateStart,K=s.onEdgeUpdateEnd,re=s.markerEnd,G=s.markerStart,q=s.rfId,Y=v.useState(!1),Q=Et(Y,2),ee=Q[0],J=Q[1],se=js(),ke=function(ot){var $e=se.getState(),je=$e.edges,Vt=$e.addSelectedEdges,tt=je.find(function(Wt){return Wt.id===l});O&&(se.setState({nodesSelectionActive:!1}),Vt([l])),d==null||d(ot,tt)},Pe=Kc(l,se.getState,p),De=Kc(l,se.getState,R),Be=Kc(l,se.getState,U),mt=Kc(l,se.getState,V),Ge=Kc(l,se.getState,B),ue=function(ot,$e){var je=$e?j:k,Vt=($e?z:W)||null,tt=$e?"target":"source",Wt=function(){return!0},ct=$e,Rt=se.getState().edges.find(function(Ft){return Ft.id===l});F==null||F(ot,Rt,tt);var mn=K?function(Ft){return K(Ft,Rt,tt)}:void 0,$n=function(ln){return H==null?void 0:H(Rt,ln)};Ky({event:ot,handleId:Vt,nodeId:je,onConnect:$n,isTarget:ct,getState:se.getState,setState:se.setState,isValidConnection:Wt,elementEdgeUpdaterType:tt,onEdgeUpdateEnd:mn})},ye=function(ot){return ue(ot,!0)},Me=function(ot){return ue(ot,!1)},Le=function(){return J(!0)},Ve=function(){return J(!1)},ce=v.useMemo(function(){return"url(#".concat(Ep(G,q),")")},[G,q]),Fe=v.useMemo(function(){return"url(#".concat(Ep(re,q),")")},[re,q]);if(D)return null;var et=!O&&!d,it=typeof H<"u",at=fr(["react-flow__edge","react-flow__edge-".concat(c),i,{selected:h,animated:f,inactive:et,updating:ee}]);return be.createElement("g",{className:at,onClick:ke,onDoubleClick:Pe,onContextMenu:De,onMouseEnter:Be,onMouseMove:mt,onMouseLeave:Ge},be.createElement(e,{id:l,source:k,target:j,selected:h,animated:f,label:g,labelStyle:w,labelShowBg:y,labelBgStyle:b,labelBgPadding:x,labelBgBorderRadius:N,data:u,style:E,sourceX:S,sourceY:M,targetX:$,targetY:T,sourcePosition:L,targetPosition:P,sourceHandleId:W,targetHandleId:z,markerStart:ce,markerEnd:Fe,"data-testid":"rf__edge-".concat(l)}),it&&be.createElement("g",{onMouseDown:ye,onMouseEnter:Le,onMouseOut:Ve},be.createElement(tb,{position:L,centerX:S,centerY:M,radius:X})),it&&be.createElement("g",{onMouseDown:Me,onMouseEnter:Le,onMouseOut:Ve},be.createElement(tb,{position:P,centerX:$,centerY:T,radius:X})))};return t.displayName="EdgeWrapper",v.memo(t)};function nb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function sb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nb(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function D1(e){var t={default:bi(e.default||qp),straight:bi(e.bezier||Vy),step:bi(e.step||Hy),smoothstep:bi(e.step||Up),simplebezier:bi(e.simplebezier||Ry)},n={},s=Object.keys(e).filter(function(l){return!["default","bezier"].includes(l)}).reduce(function(l,i){return l[i]=bi(e[i]||qp),l},n);return sb(sb({},t),s)}function rb(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=((n==null?void 0:n.x)||0)+t.x,l=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,c=(n==null?void 0:n.height)||t.height;switch(e){case Re.Top:return{x:s+i/2,y:l};case Re.Right:return{x:s+i,y:l+c/2};case Re.Bottom:return{x:s+i/2,y:l+c};case Re.Left:return{x:s,y:l+c/2}}}function ab(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(s){return s.id===t})),typeof n>"u"?null:n}var R1=function(t,n,s,l,i,c){var u=rb(s,t,n),d=rb(c,l,i);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y}};function F1(e){var t=e.sourcePos,n=e.targetPos,s=e.sourceWidth,l=e.sourceHeight,i=e.targetWidth,c=e.targetHeight,u=e.width,d=e.height,p=e.transform,h={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+s,n.x+i),y2:Math.max(t.y+l,n.y+c)};h.x===h.x2&&(h.x2+=1),h.y===h.y2&&(h.y2+=1);var f=um({x:(0-p[0])/p[2],y:(0-p[1])/p[2],width:u/p[2],height:d/p[2]}),g=Math.max(0,Math.min(f.x2,h.x2)-Math.max(f.x,h.x)),w=Math.max(0,Math.min(f.y2,h.y2)-Math.max(f.y,h.y)),y=Math.ceil(g*w);return y>0}function ob(e,t){var n,s,l,i,c,u=e.get(t),d=(u==null||(n=u[ds])===null||n===void 0?void 0:n.handleBounds)||null,p=!u||!d||!u.width||!u.height||typeof((s=u.positionAbsolute)===null||s===void 0?void 0:s.x)>"u"||typeof((l=u.positionAbsolute)===null||l===void 0?void 0:l.y)>"u";return[{x:(u==null||(i=u.positionAbsolute)===null||i===void 0?void 0:i.x)||0,y:(u==null||(c=u.positionAbsolute)===null||c===void 0?void 0:c.y)||0,width:(u==null?void 0:u.width)||0,height:(u==null?void 0:u.height)||0},d,!p]}var I1=typeof document<"u"?document:null,ym=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:I1},n=v.useState(!1),s=Et(n,2),l=s[0],i=s[1],c=v.useRef(new Set([])),u=v.useMemo(function(){if(e!==null){var f=Array.isArray(e)?e:[e],g=f.filter(function(y){return typeof y=="string"}).map(function(y){return y.split("+")}),w=g.reduce(function(y,b){return y.concat.apply(y,dl(b))},[]);return[g,w]}return[[],[]]},[e]),d=Et(u,2),p=d[0],h=d[1];return v.useEffect(function(){if(e!==null){var f,g,w=function(N){if(cb(N))return!1;var E=ib(N.code,h);c.current.add(N[E]),lb(p,c.current,!1)&&(N.preventDefault(),i(!0))},y=function(N){if(cb(N))return!1;var E=ib(N.code,h);lb(p,c.current,!0)?(i(!1),c.current.clear()):c.current.delete(N[E])},b=function(){c.current.clear(),i(!1)};return t==null||(f=t.target)===null||f===void 0||f.addEventListener("keydown",w),t==null||(g=t.target)===null||g===void 0||g.addEventListener("keyup",y),window.addEventListener("blur",b),function(){var x,N;t==null||(x=t.target)===null||x===void 0||x.removeEventListener("keydown",w),t==null||(N=t.target)===null||N===void 0||N.removeEventListener("keyup",y),window.removeEventListener("blur",b)}}},[e,i]),l};function lb(e,t,n){return e.filter(function(s){return n||s.length===t.size}).some(function(s){return s.every(function(l){return t.has(l)})})}function ib(e,t){return t.includes(e)?"code":"key"}function cb(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var B1=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},U1=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,s=js(),l=Tn(B1,pr),i=l.onNodesChange,c=l.onEdgesChange,u=ym(t),d=ym(n);v.useEffect(function(){var p=s.getState(),h=p.nodeInternals,f=p.edges,g=p.hasDefaultNodes,w=p.hasDefaultEdges,y=p.onNodesDelete,b=p.onEdgesDelete,x=Array.from(h.values()),N=x.reduce(function(T,L){return(!L.selected&&L.parentNode&&T.find(function(P){return P.id===L.parentNode})||L.selected)&&T.push(L),T},[]),E=f.filter(function(T){return T.selected});if(u&&(N||E)){var k=xy(N,f),j=[].concat(dl(E),dl(k)),S=j.reduce(function(T,L){return T.includes(L.id)||T.push(L.id),T},[]);if((w||g)&&(w&&s.setState({edges:f.filter(function(T){return!S.includes(T.id)})}),g&&(N.forEach(function(T){h.delete(T.id)}),s.setState({nodeInternals:new Map(h)}))),S.length>0&&(b==null||b(j),c)){var M=S.map(function(T){return{id:T,type:"remove"}});c(M)}if(N.length>0&&(y==null||y(N),i)){var $=N.map(function(T){return{id:T.id,type:"remove"}});i($)}s.setState({nodesSelectionActive:!1})}},[u,i,c]),v.useEffect(function(){s.setState({multiSelectionActive:d})},[d])};function q1(e){var t=js();v.useEffect(function(){var n,s=function(){if(e.current){var i=Sp(e.current);t.setState({width:i.width||500,height:i.height||500})}};return s(),window.onresize=s,e.current&&(n=new ResizeObserver(function(){return s()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var H1=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},Gp=function(t){return{x:t.x,y:t.y,zoom:t.k}},bm=function(t,n){return t.target.closest(".".concat(n))},V1=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},W1=function(t){var n=t.onMove,s=t.onMoveStart,l=t.onMoveEnd,i=t.zoomOnScroll,c=i===void 0?!0:i,u=t.zoomOnPinch,d=u===void 0?!0:u,p=t.panOnScroll,h=p===void 0?!1:p,f=t.panOnScrollSpeed,g=f===void 0?.5:f,w=t.panOnScrollMode,y=w===void 0?pi.Free:w,b=t.zoomOnDoubleClick,x=b===void 0?!0:b,N=t.selectionKeyPressed,E=t.elementsSelectable,k=t.panOnDrag,j=k===void 0?!0:k,S=t.translateExtent,M=t.minZoom,$=t.maxZoom,T=t.defaultZoom,L=T===void 0?1:T,P=t.defaultPosition,O=P===void 0?[0,0]:P,D=t.zoomActivationKeyCode,W=t.preventScrolling,z=W===void 0?!0:W,R=t.children,U=t.noWheelClassName,V=t.noPanClassName,B=js(),X=v.useRef(!1),H=v.useRef(null),F=v.useRef({x:0,y:0,zoom:0}),K=Tn(V1,pr),re=K.d3Zoom,G=K.d3Selection,q=K.d3ZoomHandler,Y=ym(D);return q1(H),v.useEffect(function(){if(H.current){var Q,ee=OE().scaleExtent([M,$]).translateExtent(S),J=Wr(H.current).call(ee),se=gi(O[0],S[0][0],S[1][0]),ke=gi(O[1],S[0][1],S[1][1]),Pe=gi(L,M,$),De=il.translate(se,ke).scale(Pe);ee.transform(J,De),B.setState({d3Zoom:ee,d3Selection:J,d3ZoomHandler:J.on("wheel.zoom"),transform:[se,ke,Pe],domNode:(Q=J.node())===null||Q===void 0?void 0:Q.closest(".react-flow")})}},[]),v.useEffect(function(){G&&re&&(h&&!Y?G.on("wheel",function(Q){if(bm(Q,U))return!1;Q.preventDefault(),Q.stopImmediatePropagation();var ee=G.property("__zoom").k||1;if(Q.ctrlKey&&d){var J=ca(Q),se=-Q.deltaY*(Q.deltaMode===1?.05:Q.deltaMode?1:.002)*10,ke=ee*Math.pow(2,se);re.scaleTo(G,ke,J);return}var Pe=Q.deltaMode===1?20:1,De=y===pi.Vertical?0:Q.deltaX*Pe,Be=y===pi.Horizontal?0:Q.deltaY*Pe;re.translateBy(G,-(De/ee)*g,-(Be/ee)*g)}).on("wheel.zoom",null):typeof q<"u"&&G.on("wheel",function(Q){if(!z||bm(Q,U))return null;Q.preventDefault()}).on("wheel.zoom",q))},[h,y,G,re,q,Y,d,z,U]),v.useEffect(function(){re&&(N&&!X.current?re.on("zoom",null):N||re.on("zoom",function(Q){if(B.setState({transform:[Q.transform.x,Q.transform.y,Q.transform.k]}),n){var ee=Gp(Q.transform);n(Q.sourceEvent,ee)}}))},[N,re,n]),v.useEffect(function(){re&&re.on("start",function(Q){if(X.current=!0,s){var ee=Gp(Q.transform);F.current=ee,s(Q.sourceEvent,ee)}})},[re,s]),v.useEffect(function(){re&&re.on("end",function(Q){if(X.current=!1,l&&H1(F.current,Q.transform)){var ee=Gp(Q.transform);F.current=ee,l(Q.sourceEvent,ee)}})},[re,l]),v.useEffect(function(){re&&re.filter(function(Q){var ee=Y||c,J=d&&Q.ctrlKey;return!j&&!ee&&!h&&!x&&!d||N||!x&&Q.type==="dblclick"||bm(Q,U)&&Q.type==="wheel"||bm(Q,V)&&Q.type!=="wheel"||!d&&Q.ctrlKey&&Q.type==="wheel"||!ee&&!h&&!J&&Q.type==="wheel"||!j&&(Q.type==="mousedown"||Q.type==="touchstart")?!1:(!Q.ctrlKey||Q.type==="wheel")&&!Q.button})},[re,c,d,h,x,j,N,E,Y]),be.createElement("div",{className:"react-flow__renderer react-flow__container",ref:H},R)};function ub(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function db(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ub(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ub(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function mb(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var K1=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},hb={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},Y1=v.memo(function(e){var t=e.selectionKeyPressed,n=js(),s=v.useRef(0),l=v.useRef(0),i=v.useRef(),c=v.useState(hb),u=Et(c,2),d=u[0],p=u[1],h=Tn(K1,pr),f=h.userSelectionActive,g=h.elementsSelectable,w=f||t;if(!g||!w)return null;var y=function(){p(hb),n.setState({userSelectionActive:!1}),s.current=0,l.current=0},b=function(j){var S=j.target.closest(".react-flow");i.current=S.getBoundingClientRect();var M=mb(j,i.current);p({width:0,height:0,startX:M.x,startY:M.y,x:M.x,y:M.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},x=function(j){var S,M;if(!(!t||!d.draw||!i.current)){var $=mb(j,i.current),T=(S=d.startX)!==null&&S!==void 0?S:0,L=(M=d.startY)!==null&&M!==void 0?M:0,P=db(db({},d),{},{x:$.x<T?$.x:T,y:$.y<L?$.y:L,width:Math.abs($.x-T),height:Math.abs($.y-L)}),O=n.getState(),D=O.nodeInternals,W=O.edges,z=O.transform,R=O.onNodesChange,U=O.onEdgesChange,V=Array.from(D.values()),B=by(D,P,z,!1,!0),X=xy(B,W).map(function(re){return re.id}),H=B.map(function(re){return re.id});if(s.current!==H.length){s.current=H.length;var F=_i(V,H);F.length&&(R==null||R(F))}if(l.current!==X.length){l.current=X.length;var K=_i(W,X);K.length&&(U==null||U(K))}p(P)}},N=function(){n.setState({nodesSelectionActive:s.current>0}),y()},E=function(){n.setState({nodesSelectionActive:!1}),y()};return be.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:b,onMouseMove:x,onMouseUp:N,onMouseLeave:E},d.draw&&be.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:d.width,height:d.height,transform:"translate(".concat(d.x,"px, ").concat(d.y,"px)")}}))});function fb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function pb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fb(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function gb(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:gb(n,t):!1}function _b(e,t,n){var s=e;do{var l;if((l=s)!==null&&l!==void 0&&l.matches(t))return!0;if(s===n.current)return!1;s=s.parentElement}while(s);return!1}function G1(e,t,n){return Array.from(e.values()).filter(function(s){return(s.selected||s.id===n)&&(!s.parentNode||!gb(s,e))}).map(function(s){var l,i,c,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:t.x-((l=(i=s.positionAbsolute)===null||i===void 0?void 0:i.x)!==null&&l!==void 0?l:0),y:t.y-((c=(u=s.positionAbsolute)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function Q1(e,t,n,s,l,i){var c=Et(s,2),u=c[0],d=c[1],p=e.extent||i,h={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(h.x=u*Math.round(h.x/u),h.y=d*Math.round(h.y/d)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var f=l.get(e.parentNode);p=f!=null&&f.positionAbsolute&&f!==null&&f!==void 0&&f.width&&f!==null&&f!==void 0&&f.height?[[f.positionAbsolute.x,f.positionAbsolute.y],[f.positionAbsolute.x+f.width-e.width,f.positionAbsolute.y+f.height-e.height]]:p}else p=i;else if(e.extent&&e.parentNode){var g,w,y,b,x=l.get(e.parentNode),N=(g=x==null||(w=x.positionAbsolute)===null||w===void 0?void 0:w.x)!==null&&g!==void 0?g:0,E=(y=x==null||(b=x.positionAbsolute)===null||b===void 0?void 0:b.y)!==null&&y!==void 0?y:0;p=[[e.extent[0][0]+N,e.extent[0][1]+E],[e.extent[1][0]+N,e.extent[1][1]+E]]}var k={x:0,y:0};if(e.parentNode){var j,S,M,$,T=l.get(e.parentNode);k={x:(j=T==null||(S=T.positionAbsolute)===null||S===void 0?void 0:S.x)!==null&&j!==void 0?j:0,y:(M=T==null||($=T.positionAbsolute)===null||$===void 0?void 0:$.y)!==null&&M!==void 0?M:0}}return e.positionAbsolute=p?oy(h,p):h,e.position={x:e.positionAbsolute.x-k.x,y:e.positionAbsolute.y-k.y},e}function Qp(e){var t=e.nodeId,n=e.dragItems,s=e.nodeInternals,l=n.map(function(i){var c=s.get(i.id);return pb(pb({},c),{},{position:i.position,positionAbsolute:i.positionAbsolute})});return[t?l.find(function(i){return i.id===t}):l[0],l]}function Xp(e){return function(t,n,s){return e==null?void 0:e(t,s)}}function vb(e){var t=e.nodeRef,n=e.disabled,s=n===void 0?!1:n,l=e.noDragClassName,i=e.handleSelector,c=e.nodeId,u=e.isSelectable,d=e.selectNodesOnDrag,p=v.useState(!1),h=Et(p,2),f=h[0],g=h[1],w=js(),y=v.useRef(),b=v.useRef({x:null,y:null}),x=v.useCallback(function(N){var E=N.sourceEvent,k=w.getState(),j=k.transform,S=k.snapGrid,M=k.snapToGrid,$=E.touches?E.touches[0].clientX:E.clientX,T=E.touches?E.touches[0].clientY:E.clientY,L=yy({x:$,y:T},j,M,S);return L},[]);return v.useEffect(function(){if(t!=null&&t.current){var N=Wr(t.current);if(s)N.on(".drag",null);else{var E=BC().on("start",function(k){var j=w.getState(),S=j.nodeInternals,M=j.multiSelectionActive,$=j.unselectNodesAndEdges,T=j.onNodeDragStart,L=j.onSelectionDragStart,P=c?T:Xp(L);if(!d&&!M&&c){var O;(O=S.get(c))!==null&&O!==void 0&&O.selected||$()}c&&u&&d&&gy({id:c,store:w});var D=x(k);if(b.current=D,y.current=G1(S,D,c),P&&y.current){var W=Qp({nodeId:c,dragItems:y.current,nodeInternals:S}),z=Et(W,2),R=z[0],U=z[1];P(k.sourceEvent,R,U)}}).on("drag",function(k){var j=w.getState(),S=j.updateNodePositions,M=j.snapToGrid,$=j.snapGrid,T=j.nodeInternals,L=j.nodeExtent,P=j.onNodeDrag,O=j.onSelectionDrag,D=x(k);if((b.current.x!==D.x||b.current.y!==D.y)&&y.current){b.current=D,y.current=y.current.map(function(B){return Q1(B,D,M,$,T,L)});var W=c?P:Xp(O);if(S(y.current,!0,!0),g(!0),W){var z=Qp({nodeId:c,dragItems:y.current,nodeInternals:T}),R=Et(z,2),U=R[0],V=R[1];W(k.sourceEvent,U,V)}}k.on("end",function(B){if(g(!1),y.current){var X=w.getState(),H=X.updateNodePositions,F=X.nodeInternals,K=X.onNodeDragStop,re=X.onSelectionDragStop,G=c?K:Xp(re);if(H(y.current,!1,!1),G){var q=Qp({nodeId:c,dragItems:y.current,nodeInternals:F}),Y=Et(q,2),Q=Y[0],ee=Y[1];G(B.sourceEvent,Q,ee)}}})}).filter(function(k){var j=k.target,S=!k.button&&(!l||!_b(j,".".concat(l),t))&&(!i||_b(j,i,t));return S});return N.call(E),function(){N.on(".drag",null)}}}},[t,s,l,i,u,w,c,d,x]),f}function yb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function X1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yb(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var J1=function(t){return X1({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},kp(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},Z1=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(s){return s.selected});return kp(n)};function ek(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,s=js(),l=Tn(J1,pr),i=l.transformString,c=l.userSelectionActive,u=Tn(Z1,pr),d=u.width,p=u.height,h=u.x,f=u.y,g=v.useRef(null);if(vb({nodeRef:g}),c||!d||!p)return null;var w=t?function(y){var b=Array.from(s.getState().nodeInternals.values()).filter(function(x){return x.selected});t(y,b)}:void 0;return be.createElement("div",{className:fr(["react-flow__nodesselection","react-flow__container",n]),style:{transform:i}},be.createElement("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:w,style:{width:d,height:p,top:f,left:h}}))}var tk=v.memo(ek),nk=function(t){return t.nodesSelectionActive},bb=function(t){var n=t.children,s=t.onPaneClick,l=t.onPaneContextMenu,i=t.onPaneScroll,c=t.deleteKeyCode,u=t.onMove,d=t.onMoveStart,p=t.onMoveEnd,h=t.selectionKeyCode,f=t.multiSelectionKeyCode,g=t.zoomActivationKeyCode,w=t.elementsSelectable,y=t.zoomOnScroll,b=t.zoomOnPinch,x=t.panOnScroll,N=t.panOnScrollSpeed,E=t.panOnScrollMode,k=t.zoomOnDoubleClick,j=t.panOnDrag,S=t.translateExtent,M=t.minZoom,$=t.maxZoom,T=t.defaultZoom,L=t.defaultPosition,P=t.preventScrolling,O=t.onSelectionContextMenu,D=t.noWheelClassName,W=t.noPanClassName,z=js(),R=Tn(nk),U=ym(h);U1({deleteKeyCode:c,multiSelectionKeyCode:f});var V=function(F){s==null||s(F),z.getState().resetSelectedElements(),z.setState({nodesSelectionActive:!1})},B=l?function(H){return l(H)}:void 0,X=i?function(H){return i(H)}:void 0;return be.createElement(W1,{onMove:u,onMoveStart:d,onMoveEnd:p,selectionKeyPressed:U,elementsSelectable:w,zoomOnScroll:y,zoomOnPinch:b,panOnScroll:x,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:k,panOnDrag:j,translateExtent:S,minZoom:M,maxZoom:$,defaultZoom:T,defaultPosition:L,zoomActivationKeyCode:g,preventScrolling:P,noWheelClassName:D,noPanClassName:W},n,be.createElement(Y1,{selectionKeyPressed:U}),R&&be.createElement(tk,{onSelectionContextMenu:O,noPanClassName:W}),be.createElement("div",{className:"react-flow__pane react-flow__container",onClick:V,onContextMenu:B,onWheel:X}))};bb.displayName="FlowRenderer";var sk=v.memo(bb);function rk(e){var t=Tn(v.useCallback(function(n){return e?by(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var ak=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},xb=function(t){var n=Tn(ak,pr),s=n.nodesDraggable,l=n.nodesConnectable,i=n.elementsSelectable,c=n.updateNodeDimensions,u=rk(t.onlyRenderVisibleElements),d=v.useRef(),p=v.useMemo(function(){if(typeof ResizeObserver>"u")return null;var h=new ResizeObserver(function(f){var g=f.map(function(w){return{id:w.target.getAttribute("data-id"),nodeElement:w.target,forceUpdate:!0}});c(g)});return d.current=h,h},[]);return v.useEffect(function(){return function(){var h;d==null||(h=d.current)===null||h===void 0||h.disconnect()}},[]),be.createElement("div",{className:"react-flow__nodes react-flow__container"},u.map(function(h){var f,g,w,y,b,x,N,E=h.type||"default";t.nodeTypes[E]||(E="default");var k=t.nodeTypes[E]||t.nodeTypes.default,j=!!(h.draggable||s&&typeof h.draggable>"u"),S=!!(h.selectable||i&&typeof h.selectable>"u"),M=!!(h.connectable||l&&typeof h.connectable>"u");return be.createElement(k,{key:h.id,id:h.id,className:h.className,style:h.style,type:E,data:h.data,sourcePosition:h.sourcePosition||Re.Bottom,targetPosition:h.targetPosition||Re.Top,hidden:h.hidden,xPos:(f=(g=h.positionAbsolute)===null||g===void 0?void 0:g.x)!==null&&f!==void 0?f:0,yPos:(w=(y=h.positionAbsolute)===null||y===void 0?void 0:y.y)!==null&&w!==void 0?w:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!h.selected,isDraggable:j,isSelectable:S,isConnectable:M,resizeObserver:p,dragHandle:h.dragHandle,zIndex:(b=(x=h[ds])===null||x===void 0?void 0:x.z)!==null&&b!==void 0?b:0,isParent:!!((N=h[ds])!==null&&N!==void 0&&N.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!h.width&&!!h.height})}))};xb.displayName="NodeRenderer";var ok=v.memo(xb),xi;function wb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function jb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wb(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var lk=(xi={},Lt(xi,Re.Left,Re.Right),Lt(xi,Re.Right,Re.Left),Lt(xi,Re.Top,Re.Bottom),Lt(xi,Re.Bottom,Re.Top),xi),ik=function(e){var t,n,s,l,i,c=e.connectionNodeId,u=e.connectionHandleType,d=e.connectionLineStyle,p=e.connectionLineType,h=p===void 0?co.Bezier:p,f=e.isConnectable,g=e.CustomConnectionLineComponent,w=Tn(v.useCallback(function(X){return{fromNode:X.nodeInternals.get(c),handleId:X.connectionHandleId,toX:(X.connectionPosition.x-X.transform[0])/X.transform[2],toY:(X.connectionPosition.y-X.transform[1])/X.transform[2]}},[c]),pr),y=w.fromNode,b=w.handleId,x=w.toX,N=w.toY,E=y==null||(t=y[ds])===null||t===void 0?void 0:t.handleBounds;if(!y||!f||!(E!=null&&E[u]))return null;var k=E[u],j=b?k.find(function(X){return X.id===b}):k[0],S=j?j.x+j.width/2:((n=y==null?void 0:y.width)!==null&&n!==void 0?n:0)/2,M=j?j.y+j.height/2:(s=y==null?void 0:y.height)!==null&&s!==void 0?s:0,$=((y==null||(l=y.positionAbsolute)===null||l===void 0?void 0:l.x)||0)+S,T=((y==null||(i=y.positionAbsolute)===null||i===void 0?void 0:i.y)||0)+M,L=j==null?void 0:j.position;if(!L)return null;var P=lk[L],O,D,W,z,R,U;switch(u){case"source":O=$,D=T,W=L,z=x,R=N,U=P;break;case"target":O=x,D=N,W=P,z=$,R=T,U=L;break}if(g)return be.createElement("g",{className:"react-flow__connection"},be.createElement(g,{connectionLineType:h,connectionLineStyle:d,fromNode:y,fromHandle:j,fromX:$,fromY:T,toX:x,toY:N,fromPosition:L,toPosition:P,sourcePosition:W,targetPosition:U,sourceNode:y,sourceHandle:j,targetX:z,targetY:R,sourceX:O,sourceY:D}));var V="",B={sourceX:O,sourceY:D,sourcePosition:W,targetX:z,targetY:R,targetPosition:U};return h===co.Bezier?V=Wy(B):h===co.Step?V=Bp(jb(jb({},B),{},{borderRadius:0})):h===co.SmoothStep?V=Bp(B):h===co.SimpleBezier?V=Dy(B):V="M".concat(O,",").concat(D," ").concat(z,",").concat(R),be.createElement("g",{className:"react-flow__connection"},be.createElement("path",{d:V,className:"react-flow__connection-path",style:d}))};function Jp(e){"@babel/helpers - typeof";return Jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Jp(e)}var xm,ck=function(t){var n=t.color,s=n===void 0?"none":n,l=t.strokeWidth,i=l===void 0?1:l;return be.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:"none",points:"-5,-4 0,0 -5,4"})},uk=function(t){var n=t.color,s=n===void 0?"none":n,l=t.strokeWidth,i=l===void 0?1:l;return be.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:s,points:"-5,-4 0,0 -5,4 -5,-4"})},Nb=(xm={},Lt(xm,cm.Arrow,ck),Lt(xm,cm.ArrowClosed,uk),xm);function dk(e){var t=v.useMemo(function(){var n=Nb.hasOwnProperty(e);return n?Nb[e]:function(){return null}},[e]);return t}function Cb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function mk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cb(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var hk=function(t){var n=t.id,s=t.type,l=t.color,i=t.width,c=i===void 0?12.5:i,u=t.height,d=u===void 0?12.5:u,p=t.markerUnits,h=p===void 0?"strokeWidth":p,f=t.strokeWidth,g=t.orient,w=g===void 0?"auto":g,y=dk(s);return be.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(c),markerHeight:"".concat(d),viewBox:"-10 -10 20 20",markerUnits:h,orient:w,refX:"0",refY:"0"},be.createElement(y,{color:l,strokeWidth:f}))},fk=function(t){var n=t.defaultColor,s=t.rfId;return function(l){var i=[];return l.edges.reduce(function(c,u){return[u.markerStart,u.markerEnd].forEach(function(d){if(d&&Jp(d)==="object"){var p=Ep(d,s);i.includes(p)||(c.push(mk({id:p,color:d.color||n},d)),i.push(p))}}),c},[]).sort(function(c,u){return c.id.localeCompare(u.id)})}},Sb=function(t){var n=t.defaultColor,s=t.rfId,l=Tn(v.useCallback(fk({defaultColor:n,rfId:s}),[n,s]),function(i,c){return!(i.length!==c.length||i.some(function(u,d){return u.id!==c[d].id}))});return be.createElement("defs",null,l.map(function(i){return be.createElement(hk,{id:i.id,key:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient})}))};Sb.displayName="MarkerDefinitions";var pk=v.memo(Sb),gk=[{level:0,isMaxLevel:!0,edges:[]}];function _k(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=-1,l=e.reduce(function(c,u){var d=iy(u.zIndex),p=d?u.zIndex:0;if(n){var h,f,g,w;p=d?u.zIndex:Math.max(((h=t.get(u.source))===null||h===void 0||(f=h[ds])===null||f===void 0?void 0:f.z)||0,((g=t.get(u.target))===null||g===void 0||(w=g[ds])===null||w===void 0?void 0:w.z)||0)}return c[p]?c[p].push(u):c[p]=[u],s=p>s?p:s,c},{}),i=Object.entries(l).map(function(c){var u=Et(c,2),d=u[0],p=u[1],h=+d;return{edges:p,level:h,isMaxLevel:h===s}});return i.length===0?gk:i}function vk(e,t,n){var s=Tn(v.useCallback(function(l){return e?l.edges.filter(function(i){var c=t.get(i.source),u=t.get(i.target);return(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&F1({sourcePos:c.positionAbsolute||{x:0,y:0},targetPos:u.positionAbsolute||{x:0,y:0},sourceWidth:c.width,sourceHeight:c.height,targetWidth:u.width,targetHeight:u.height,width:l.width,height:l.height,transform:l.transform})}):l.edges},[e,t]));return _k(s,t,n)}var yk=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},Eb=function(t){var n=Tn(yk,pr),s=n.connectionNodeId,l=n.connectionHandleType,i=n.nodesConnectable,c=n.elementsSelectable,u=n.width,d=n.height,p=n.connectionMode,h=n.nodeInternals,f=vk(t.onlyRenderVisibleElements,h,t.elevateEdgesOnSelect);if(!u)return null;var g=t.connectionLineType,w=t.defaultMarkerColor,y=t.connectionLineStyle,b=t.connectionLineComponent,x=t.connectionLineContainerStyle,N=s&&l;return be.createElement(be.Fragment,null,f.map(function(E){var k=E.level,j=E.edges,S=E.isMaxLevel;return be.createElement("svg",{key:k,style:{zIndex:k},width:u,height:d,className:"react-flow__edges react-flow__container"},S&&be.createElement(pk,{defaultColor:w,rfId:t.rfId}),be.createElement("g",null,j.map(function(M){var $=ob(h,M.source),T=Et($,3),L=T[0],P=T[1],O=T[2],D=ob(h,M.target),W=Et(D,3),z=W[0],R=W[1],U=W[2];if(!O||!U)return null;var V=M.type||"default";t.edgeTypes[V]||(console.warn('[React Flow]: Edge type "'.concat(V,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),V="default");var B=t.edgeTypes[V]||t.edgeTypes.default,X=p===cl.Strict?R.target:R.target||R.source,H=ab(P.source,M.sourceHandle||null),F=ab(X,M.targetHandle||null),K=(H==null?void 0:H.position)||Re.Bottom,re=(F==null?void 0:F.position)||Re.Top;if(!H||!F)return null;var G=R1(L,H,K,z,F,re),q=G.sourceX,Y=G.sourceY,Q=G.targetX,ee=G.targetY;return be.createElement(B,{key:M.id,id:M.id,className:fr([M.className,t.noPanClassName]),type:V,data:M.data,selected:!!M.selected,animated:!!M.animated,hidden:!!M.hidden,label:M.label,labelStyle:M.labelStyle,labelShowBg:M.labelShowBg,labelBgStyle:M.labelBgStyle,labelBgPadding:M.labelBgPadding,labelBgBorderRadius:M.labelBgBorderRadius,style:M.style,source:M.source,target:M.target,sourceHandleId:M.sourceHandle,targetHandleId:M.targetHandle,markerEnd:M.markerEnd,markerStart:M.markerStart,sourceX:q,sourceY:Y,targetX:Q,targetY:ee,sourcePosition:K,targetPosition:re,elementsSelectable:c,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),N&&be.createElement("svg",{style:x,width:u,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},be.createElement(ik,{connectionNodeId:s,connectionHandleType:l,connectionLineStyle:y,connectionLineType:g,isConnectable:i,CustomConnectionLineComponent:b})))};Eb.displayName="EdgeRenderer";var bk=v.memo(Eb),xk=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function wk(e){var t=e.children,n=Tn(xk);return be.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function jk(e){var t=Pp(),n=v.useRef(!1);v.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var kb=function(t){var n=t.nodeTypes,s=t.edgeTypes,l=t.onMove,i=t.onMoveStart,c=t.onMoveEnd,u=t.onInit,d=t.onNodeClick,p=t.onEdgeClick,h=t.onNodeDoubleClick,f=t.onEdgeDoubleClick,g=t.onNodeMouseEnter,w=t.onNodeMouseMove,y=t.onNodeMouseLeave,b=t.onNodeContextMenu,x=t.onSelectionContextMenu,N=t.connectionLineType,E=t.connectionLineStyle,k=t.connectionLineComponent,j=t.connectionLineContainerStyle,S=t.selectionKeyCode,M=t.multiSelectionKeyCode,$=t.zoomActivationKeyCode,T=t.deleteKeyCode,L=t.onlyRenderVisibleElements,P=t.elementsSelectable,O=t.selectNodesOnDrag,D=t.translateExtent,W=t.minZoom,z=t.maxZoom,R=t.defaultZoom,U=t.defaultPosition,V=t.preventScrolling,B=t.defaultMarkerColor,X=t.zoomOnScroll,H=t.zoomOnPinch,F=t.panOnScroll,K=t.panOnScrollSpeed,re=t.panOnScrollMode,G=t.zoomOnDoubleClick,q=t.panOnDrag,Y=t.onPaneClick,Q=t.onPaneScroll,ee=t.onPaneContextMenu,J=t.onEdgeUpdate,se=t.onEdgeContextMenu,ke=t.onEdgeMouseEnter,Pe=t.onEdgeMouseMove,De=t.onEdgeMouseLeave,Be=t.edgeUpdaterRadius,mt=t.onEdgeUpdateStart,Ge=t.onEdgeUpdateEnd,ue=t.noDragClassName,ye=t.noWheelClassName,Me=t.noPanClassName,Le=t.elevateEdgesOnSelect,Ve=t.id;return jk(u),be.createElement(sk,{onPaneClick:Y,onPaneContextMenu:ee,onPaneScroll:Q,deleteKeyCode:T,selectionKeyCode:S,multiSelectionKeyCode:M,zoomActivationKeyCode:$,elementsSelectable:P,onMove:l,onMoveStart:i,onMoveEnd:c,zoomOnScroll:X,zoomOnPinch:H,zoomOnDoubleClick:G,panOnScroll:F,panOnScrollSpeed:K,panOnScrollMode:re,panOnDrag:q,translateExtent:D,minZoom:W,maxZoom:z,defaultZoom:R,defaultPosition:U,onSelectionContextMenu:x,preventScrolling:V,noDragClassName:ue,noWheelClassName:ye,noPanClassName:Me},be.createElement(wk,null,be.createElement(bk,{edgeTypes:s,onEdgeClick:p,onEdgeDoubleClick:f,connectionLineType:N,connectionLineStyle:E,connectionLineComponent:k,connectionLineContainerStyle:j,onEdgeUpdate:J,onlyRenderVisibleElements:L,onEdgeContextMenu:se,onEdgeMouseEnter:ke,onEdgeMouseMove:Pe,onEdgeMouseLeave:De,onEdgeUpdateStart:mt,onEdgeUpdateEnd:Ge,edgeUpdaterRadius:Be,defaultMarkerColor:B,noPanClassName:Me,elevateEdgesOnSelect:!!Le,rfId:Ve}),be.createElement(ok,{nodeTypes:n,onNodeClick:d,onNodeDoubleClick:h,onNodeMouseEnter:g,onNodeMouseMove:w,onNodeMouseLeave:y,onNodeContextMenu:b,selectNodesOnDrag:O,onlyRenderVisibleElements:L,noPanClassName:Me,noDragClassName:ue})))};kb.displayName="GraphView";var Nk=v.memo(kb),Mb=function(){return null};Mb.displayName="GroupNode";function Ab(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Ob(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ab(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ab(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Gc=function(e){var t=function(s){var l=s.id,i=s.type,c=s.data,u=s.xPos,d=s.yPos,p=s.selected,h=s.onClick,f=s.onMouseEnter,g=s.onMouseMove,w=s.onMouseLeave,y=s.onContextMenu,b=s.onDoubleClick,x=s.style,N=s.className,E=s.isDraggable,k=s.isSelectable,j=s.isConnectable,S=s.selectNodesOnDrag,M=s.sourcePosition,$=s.targetPosition,T=s.hidden,L=s.resizeObserver,P=s.dragHandle,O=s.zIndex,D=s.isParent,W=s.noPanClassName,z=s.noDragClassName,R=s.initialized,U=js(),V=v.useRef(null),B=v.useRef(M),X=v.useRef($),H=v.useRef(i),F=k||E||h||f||g||w,K=Vc(l,U.getState,f),re=Vc(l,U.getState,g),G=Vc(l,U.getState,w),q=Vc(l,U.getState,y),Y=Vc(l,U.getState,b),Q=function(se){if(k&&(!S||!E)&&gy({id:l,store:U}),h){var ke=U.getState().nodeInternals.get(l);h(se,Ob({},ke))}};v.useEffect(function(){if(V.current&&!T){var J=V.current;return L==null||L.observe(J),function(){return L==null?void 0:L.unobserve(J)}}},[T]),v.useEffect(function(){var J=H.current!==i,se=B.current!==M,ke=X.current!==$;V.current&&(J||se||ke)&&(J&&(H.current=i),se&&(B.current=M),ke&&(X.current=$),U.getState().updateNodeDimensions([{id:l,nodeElement:V.current,forceUpdate:!0}]))},[l,i,M,$]);var ee=vb({nodeRef:V,disabled:T||!E,noDragClassName:z,handleSelector:P,nodeId:l,isSelectable:k,selectNodesOnDrag:S});return T?null:be.createElement("div",{className:fr(["react-flow__node","react-flow__node-".concat(i),W,N,{selected:p,selectable:k,parent:D}]),ref:V,style:Ob({zIndex:O,transform:"translate(".concat(u,"px,").concat(d,"px)"),pointerEvents:F?"all":"none",visibility:R?"visible":"hidden"},x),onMouseEnter:K,onMouseMove:re,onMouseLeave:G,onContextMenu:q,onClick:Q,onDoubleClick:Y,"data-testid":"rf__node-".concat(l),"data-id":l},be.createElement(x1,{value:l},be.createElement(e,{id:l,data:c,type:i,xPos:u,yPos:d,selected:p,isConnectable:j,sourcePosition:M,targetPosition:$,dragging:ee,dragHandle:P,zIndex:O})))};return t.displayName="NodeWrapper",v.memo(t)};function Pb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Tb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pb(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Ck(e){var t={input:Gc(e.input||Jy),default:Gc(e.default||Yp),output:Gc(e.output||eb),group:Gc(e.group||Mb)},n={},s=Object.keys(e).filter(function(l){return!["input","default","output","group"].includes(l)}).reduce(function(l,i){return l[i]=Gc(e[i]||Yp),l},n);return Tb(Tb({},t),s)}function $b(e,t){v.useRef(null);var n=v.useMemo(function(){return t(e)},[e]);return n}function Lb(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var zb=function(t){var n=t.children,s=!0;try{js()}catch{s=!1}return s?be.createElement(be.Fragment,null,n):be.createElement(ky,{createStore:My},n)};zb.displayName="ReactFlowWrapper";var Sk=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function Db(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Rb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Db(Object(n),!0).forEach(function(s){Lt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Db(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}Lb(P1),Lb($1);var Ek={input:Jy,default:Yp,output:eb},kk={default:qp,straight:Vy,step:Hy,smoothstep:Up,simplebezier:Ry},Mk=[15,15],Ak=[0,0],Fb=v.forwardRef(function(e,t){var n=e.nodes,s=e.edges,l=e.defaultNodes,i=e.defaultEdges,c=e.className,u=e.nodeTypes,d=u===void 0?Ek:u,p=e.edgeTypes,h=p===void 0?kk:p,f=e.onNodeClick,g=e.onEdgeClick,w=e.onInit,y=e.onMove,b=e.onMoveStart,x=e.onMoveEnd,N=e.onConnect,E=e.onConnectStart,k=e.onConnectStop,j=e.onConnectEnd,S=e.onClickConnectStart,M=e.onClickConnectStop,$=e.onClickConnectEnd,T=e.onNodeMouseEnter,L=e.onNodeMouseMove,P=e.onNodeMouseLeave,O=e.onNodeContextMenu,D=e.onNodeDoubleClick,W=e.onNodeDragStart,z=e.onNodeDrag,R=e.onNodeDragStop,U=e.onNodesDelete,V=e.onEdgesDelete,B=e.onSelectionChange,X=e.onSelectionDragStart,H=e.onSelectionDrag,F=e.onSelectionDragStop,K=e.onSelectionContextMenu,re=e.connectionMode,G=re===void 0?cl.Strict:re,q=e.connectionLineType,Y=q===void 0?co.Bezier:q,Q=e.connectionLineStyle,ee=e.connectionLineComponent,J=e.connectionLineContainerStyle,se=e.deleteKeyCode,ke=se===void 0?"Backspace":se,Pe=e.selectionKeyCode,De=Pe===void 0?"Shift":Pe,Be=e.multiSelectionKeyCode,mt=Be===void 0?"Meta":Be,Ge=e.zoomActivationKeyCode,ue=Ge===void 0?"Meta":Ge,ye=e.snapToGrid,Me=ye===void 0?!1:ye,Le=e.snapGrid,Ve=Le===void 0?Mk:Le,ce=e.onlyRenderVisibleElements,Fe=ce===void 0?!1:ce,et=e.selectNodesOnDrag,it=et===void 0?!0:et,at=e.nodesDraggable,xt=e.nodesConnectable,ot=e.elementsSelectable,$e=e.minZoom,je=$e===void 0?.5:$e,Vt=e.maxZoom,tt=Vt===void 0?2:Vt,Wt=e.defaultZoom,ct=Wt===void 0?1:Wt,Rt=e.defaultPosition,mn=Rt===void 0?Ak:Rt,$n=e.translateExtent,Ft=$n===void 0?Ap:$n,ln=e.preventScrolling,Hn=ln===void 0?!0:ln,Gt=e.nodeExtent,_t=e.defaultMarkerColor,es=_t===void 0?"#b1b1b7":_t,cn=e.zoomOnScroll,En=cn===void 0?!0:cn,yt=e.zoomOnPinch,Zs=yt===void 0?!0:yt,nn=e.panOnScroll,jt=nn===void 0?!1:nn,kt=e.panOnScrollSpeed,Cs=kt===void 0?.5:kt,vn=e.panOnScrollMode,Ln=vn===void 0?pi.Free:vn,yn=e.zoomOnDoubleClick,Vn=yn===void 0?!0:yn,bn=e.panOnDrag,Ss=bn===void 0?!0:bn,Yt=e.onPaneClick,ts=e.onPaneScroll,Wn=e.onPaneContextMenu,zn=e.children,Tr=e.onEdgeUpdate,fs=e.onEdgeContextMenu,er=e.onEdgeDoubleClick,Rs=e.onEdgeMouseEnter,Fs=e.onEdgeMouseMove,yr=e.onEdgeMouseLeave,ps=e.onEdgeUpdateStart,rn=e.onEdgeUpdateEnd,It=e.edgeUpdaterRadius,ht=It===void 0?10:It,$r=e.onNodesChange,ns=e.onEdgesChange,br=e.noDragClassName,Es=br===void 0?"nodrag":br,Jr=e.noWheelClassName,le=Jr===void 0?"nowheel":Jr,xe=e.noPanClassName,Ue=xe===void 0?"nopan":xe,$t=e.fitView,Ee=$t===void 0?!1:$t,ut=e.fitViewOptions,gt=e.connectOnClick,Kt=gt===void 0?!0:gt,Bt=e.attributionPosition,hn=e.proOptions,Qt=e.defaultEdgeOptions,xn=e.elevateEdgesOnSelect,tr=xn===void 0?!1:xn,gs=mm(e,Sk),Dn=$b(d,Ck),Kn=$b(h,D1);return be.createElement("div",Rb(Rb({},gs),{},{ref:t,className:fr(["react-flow",c])}),be.createElement(zb,null,be.createElement(Nk,{onInit:w,onMove:y,onMoveStart:b,onMoveEnd:x,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:T,onNodeMouseMove:L,onNodeMouseLeave:P,onNodeContextMenu:O,onNodeDoubleClick:D,nodeTypes:Dn,edgeTypes:Kn,connectionLineType:Y,connectionLineStyle:Q,connectionLineComponent:ee,connectionLineContainerStyle:J,selectionKeyCode:De,deleteKeyCode:ke,multiSelectionKeyCode:mt,zoomActivationKeyCode:ue,onlyRenderVisibleElements:Fe,selectNodesOnDrag:it,translateExtent:Ft,minZoom:je,maxZoom:tt,defaultZoom:ct,defaultPosition:mn,preventScrolling:Hn,zoomOnScroll:En,zoomOnPinch:Zs,zoomOnDoubleClick:Vn,panOnScroll:jt,panOnScrollSpeed:Cs,panOnScrollMode:Ln,panOnDrag:Ss,onPaneClick:Yt,onPaneScroll:ts,onPaneContextMenu:Wn,onSelectionContextMenu:K,onEdgeUpdate:Tr,onEdgeContextMenu:fs,onEdgeDoubleClick:er,onEdgeMouseEnter:Rs,onEdgeMouseMove:Fs,onEdgeMouseLeave:yr,onEdgeUpdateStart:ps,onEdgeUpdateEnd:rn,edgeUpdaterRadius:ht,defaultMarkerColor:es,noDragClassName:Es,noWheelClassName:le,noPanClassName:Ue,elevateEdgesOnSelect:tr,id:gs==null?void 0:gs.id}),be.createElement(A1,{nodes:n,edges:s,defaultNodes:l,defaultEdges:i,onConnect:N,onConnectStart:E,onConnectStop:k,onConnectEnd:j,onClickConnectStart:S,onClickConnectStop:M,onClickConnectEnd:$,nodesDraggable:at,nodesConnectable:xt,elementsSelectable:ot,minZoom:je,maxZoom:tt,nodeExtent:Gt,onNodesChange:$r,onEdgesChange:ns,snapToGrid:Me,snapGrid:Ve,connectionMode:G,translateExtent:Ft,connectOnClick:Kt,defaultEdgeOptions:Qt,fitView:Ee,fitViewOptions:ut,onNodesDelete:U,onEdgesDelete:V,onNodeDragStart:W,onNodeDrag:z,onNodeDragStop:R,onSelectionDrag:H,onSelectionDragStart:X,onSelectionDragStop:F}),B&&be.createElement(k1,{onSelectionChange:B}),zn,be.createElement(h1,{proOptions:hn,position:Bt})))});Fb.displayName="ReactFlow";var Ib=function(t){var n=t.children;return be.createElement(ky,{createStore:My},n)};Ib.displayName="ReactFlowProvider";function Bb(e){return function(t){var n=v.useState(t),s=Et(n,2),l=s[0],i=s[1],c=v.useCallback(function(u){return i(function(d){return e(u,d)})},[]);return[l,i,c]}}var Ok=Bb(my),Pk=Bb(DE);const Tk=e=>Number.isFinite(e),wm=e=>Math.round(e*100)/100,$k=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const l=Math.abs(n-e),i=Math.abs(s-t),c=Math.sqrt(l*l+i*i),u=Math.max(80,Math.min(c*.4,280)),d=Number.isFinite(u)?u:120,p=n>=e?1:-1,h=Math.min(Math.abs(s-t)*.2,50),f=e+p*d,g=t+(s>t?h:-h),w=n-p*d,y=s-(s>t?h:-h);return`M ${e},${t} C ${f},${g} ${w},${y} ${n},${s}`},Lk=({id:e,sourceX:t,sourceY:n,targetX:s,targetY:l,markerEnd:i,style:c})=>{const{setEdges:u}=Pp(),[d,p]=v.useState(!1),h=v.useCallback(()=>{p(!0)},[]),f=v.useCallback(()=>{p(!1)},[]),g=v.useMemo(()=>[t,n,s,l].every(P=>Tk(P))?{sourceX:wm(t),sourceY:wm(n),targetX:wm(s),targetY:wm(l)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:s,targetY:l}),null),[t,n,s,l,e]),w=v.useMemo(()=>{if(!g)return null;const{sourceX:P,sourceY:O,targetX:D,targetY:W}=g;return $k(P,O,D,W)},[g]),y=v.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!g||!w)return null;const{sourceX:b,sourceY:x,targetX:N,targetY:E}=g,k=(b+N)/2,j=(x+E)/2,S=32,M=k-S/2,$=j-S/2,T=`animated-edge${d?" animated-edge--hovered":""}`,L=`canvas-edge-remove${d?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:T,onMouseEnter:h,onMouseLeave:f,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:y,gradientUnits:"userSpaceOnUse",x1:b,y1:x,x2:N,y2:E,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:w,fill:"none",stroke:"transparent",strokeWidth:20,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${y})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${y})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:i,className:"animated-edge__base",style:{...c,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${y})`,strokeWidth:d?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:L,x:M,y:$,width:S,height:S,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:P=>{P.stopPropagation(),u(O=>O.filter(D=>D.id!==e))},"aria-label":"Remove connection",children:""})})})]})};async function Ub(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function qb(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function Hb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load label encoding recommendations");return c.json()}async function Vb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load ordinal encoding suggestions");return c.json()}async function Wb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load target encoding recommendations");return c.json()}async function Kb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load hash encoding recommendations");return c.json()}async function Yb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load one-hot encoding recommendations");return c.json()}async function Gb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load dummy encoding recommendations");return c.json()}async function Zp(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load column drop recommendations");return c.json()}async function Qb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,c={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load outlier recommendations");return u.json()}async function Xb(e,t={}){const{sampleSize:n=500,transformations:s,graph:l,targetNodeId:i}=t,c={dataset_source_id:e,sample_size:n};Array.isArray(s)?s.length>0&&(c.transformations=JSON.stringify(s)):s&&typeof s=="object"&&Object.keys(s).length>0&&(c.transformations=JSON.stringify(s)),l&&Array.isArray(l.nodes)&&Array.isArray(l.edges)&&(c.graph={nodes:l.nodes,edges:l.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load skewness recommendations");return u.json()}async function Jb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load scaling recommendations");return c.json()}async function Zb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/binning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load binning recommendations");return c.json()}async function ex(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/analytics/binned-distribution",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){let d="Failed to load binned column distributions";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function tx(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c=new URLSearchParams({dataset_source_id:e,sample_size:String(i)});s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&c.set("graph",JSON.stringify({nodes:s.nodes,edges:s.edges})),l&&c.set("target_node_id",l);const u=await fetch(`/ml-workflow/api/analytics/quick-profile?${c.toString()}`);if(!u.ok){let d="Failed to generate dataset profile";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function zk(e,t={}){const{config:n,sampleSize:s,graph:l,targetNodeId:i}=t,c={dataset_source_id:e,sample_size:s==="all"?0:typeof s=="number"&&Number.isFinite(s)?s:300};if(n&&typeof n=="object"){const d=(g,w)=>{const y=Number(g);return Number.isFinite(y)?y<0?0:y>100?100:y:w},p=g=>{if(!g||typeof g!="object")return{};const w={};return Object.entries(g).forEach(([y,b])=>{const x=String(y??"").trim();if(!x)return;let N=null,E=null;if(b&&typeof b=="object"){const k=b.lower??b.min??b.minimum??null,j=b.upper??b.max??b.maximum??null,S=Number(k);Number.isFinite(S)&&(N=S);const M=Number(j);Number.isFinite(M)&&(E=M)}if(!(N===null&&E===null)){if(N!==null&&E!==null&&N>E){const k=N;N=E,E=k}w[x]={lower:N,upper:E}}}),w},h=d(n.lower_percentile,5),f=d(n.upper_percentile,95);c.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:h,upper_percentile:f<=h?Math.min(h+1,100):f,manual_bounds:p(n.manual_bounds)}}l&&Array.isArray(l.nodes)&&Array.isArray(l.edges)&&(c.graph={nodes:l.nodes,edges:l.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){const d=await u.text();throw new Error(d||"Failed to load outlier diagnostics")}return u.json()}async function nx(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function sx(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function rx(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}async function ax(e,t={}){const{offset:n,limit:s,mode:l}=t,i=new URLSearchParams;typeof n=="number"&&Number.isFinite(n)&&i.set("offset",String(n)),typeof s=="number"&&Number.isFinite(s)&&i.set("limit",String(s)),l&&i.set("mode",l);const c=i.toString(),u=`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/preview/rows${c?`?${c}`:""}`,d=await fetch(u);if(!d.ok){const p=await d.text();throw new Error(p||"Failed to load preview rows")}return d.json()}async function ox(e){const t=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(n||"Failed to load pipeline preview")}return t.json()}async function lx(e){const t={...e,sample_size:0},n=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const s=await n.text();throw new Error(s||"Failed to trigger full dataset execution")}return n.json()}async function Dk(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/full-execution/${encodeURIComponent(t)}`);if(!n.ok){const s=await n.text();throw new Error(s||"Failed to fetch full execution status")}return n.json()}async function ix(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,l=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:l}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function cx(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function Qc(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view training jobs.");const l=await s.text();throw new Error(l||"Failed to load training jobs")}return s.json()}async function ux(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const s=await n.text();throw new Error(s||"Failed to evaluate model")}return n.json()}async function dx(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,l=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:l}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function Rk(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function Xc(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view tuning jobs.");const l=await s.text();throw new Error(l||"Failed to load tuning jobs")}return s.json()}async function jm(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function mx(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const s=n.toString(),l=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${s?`?${s}`:""}`,{credentials:"include"});if(!l.ok){if(l.status===404)throw new Error(`Model type '${e}' not found`);const i=await l.text();throw new Error(i||"Failed to fetch best hyperparameters")}return l.json()}const eg=e=>{if(Array.isArray(e))return e.map(t=>eg(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(s=>{n[s]=eg(e[s])}),n}return e},Fk=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),Ik=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return Fk(n)},Bk=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],s=t.map(i=>{let c=null;if(i&&i.data&&typeof i.data=="object"){const u=i.data.config;if(u!==void 0)try{c=JSON.parse(JSON.stringify(u))}catch{c=u}}return{id:i&&Object.prototype.hasOwnProperty.call(i,"id")?i.id??null:null,type:i&&Object.prototype.hasOwnProperty.call(i,"type")?i.type??null:null,catalogType:i&&i.data&&Object.prototype.hasOwnProperty.call(i.data,"catalogType")?i.data.catalogType??null:null,config:c}}).sort((i,c)=>{const u=typeof i.id=="string"?i.id:String(i.id??""),d=typeof c.id=="string"?c.id:String(c.id??"");return u.localeCompare(d)}),l=n.map(i=>({source:i&&Object.prototype.hasOwnProperty.call(i,"source")?i.source??null:null,target:i&&Object.prototype.hasOwnProperty.call(i,"target")?i.target??null:null,sourceHandle:i&&Object.prototype.hasOwnProperty.call(i,"sourceHandle")?i.sourceHandle??null:null,targetHandle:i&&Object.prototype.hasOwnProperty.call(i,"targetHandle")?i.targetHandle??null:null})).sort((i,c)=>{const u=String(i.source??"").localeCompare(String(c.source??""));return u!==0?u:String(i.target??"").localeCompare(String(c.target??""))});return{nodes:s,edges:l}};async function ml(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=Bk(t),s=JSON.stringify(eg(n)),l=await Ik(s);return`${e}_${l.slice(0,8)}`}const Uk=Object.freeze(Object.defineProperty({__proto__:null,createHyperparameterTuningJob:dx,createTrainingJob:ix,evaluateTrainingJob:ux,fetchBestHyperparameters:mx,fetchBinnedDistribution:ex,fetchBinningRecommendations:Zb,fetchDatasets:qb,fetchDropColumnRecommendations:Zp,fetchDummyEncodingRecommendations:Gb,fetchFullExecutionStatus:Dk,fetchHashEncodingRecommendations:Kb,fetchHyperparameterTuningJob:Rk,fetchHyperparameterTuningJobs:Xc,fetchLabelEncodingRecommendations:Hb,fetchModelHyperparameters:jm,fetchNodeCatalog:Ub,fetchOneHotEncodingRecommendations:Yb,fetchOrdinalEncodingRecommendations:Vb,fetchOutlierDiagnostics:zk,fetchOutlierRecommendations:Qb,fetchPipeline:nx,fetchPipelineHistory:rx,fetchPipelinePreview:ox,fetchPipelinePreviewRows:ax,fetchQuickProfile:tx,fetchScalingRecommendations:Jb,fetchSkewnessRecommendations:Xb,fetchTargetEncodingRecommendations:Wb,fetchTrainingJob:cx,fetchTrainingJobs:Qc,generatePipelineId:ml,savePipeline:sx,triggerFullDatasetExecution:lx},Symbol.toStringTag,{value:"Module"})),qk=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:l,columnTypeMap:i,setAvailableColumns:c,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:p,setColumnSuggestions:h})=>{const[f,g]=v.useState([]),[w,y]=v.useState(null),[b,x]=v.useState([]),[N,E]=v.useState(null),[k,j]=v.useState(!1),[S,M]=v.useState(null),[$,T]=v.useState(null),[L,P]=v.useState(0),O=v.useRef(i);v.useEffect(()=>{O.current=i},[i]),v.useEffect(()=>{let U=!0;const V=B=>{x([]),E(B??null),M(null),T(null),j(!1),g([]),y(null),c([]),u(""),d({}),p({}),h({})};return e?t?l?(j(!0),E(null),Zp(t,{graph:s,targetNodeId:n??null}).then(B=>{if(!U)return;const X=Array.isArray(B==null?void 0:B.candidates)?B.candidates:[];x(X),M((B==null?void 0:B.generated_at)??null),T(typeof(B==null?void 0:B.suggested_threshold)=="number"?Number(B.suggested_threshold):null);const H=Array.isArray(B==null?void 0:B.available_filters)?B.available_filters:[];g(H),y(G=>G&&H.some(q=>q.id===G)?G:null);const F={};B&&typeof B=="object"&&(B!=null&&B.column_missing_map)&&typeof B.column_missing_map=="object"&&Object.entries(B.column_missing_map).forEach(([G,q])=>{const Y=String(G??"").trim();if(!Y)return;const Q=Number(q);Number.isFinite(Q)&&(F[Y]=Number(Q))});const K=new Set;Array.isArray(B==null?void 0:B.all_columns)&&B.all_columns.forEach(G=>{const q=String(G??"").trim();q&&K.add(q)}),Object.keys(O.current??{}).forEach(G=>K.add(G));const re=Array.from(K).sort((G,q)=>G.localeCompare(q));re.forEach(G=>{Object.prototype.hasOwnProperty.call(F,G)||(F[G]=0)}),c(re),u(""),d(F),p(G=>{const q=B==null?void 0:B.column_type_map;if(!q||typeof q!="object")return G;const Y={...G};return Object.entries(q).forEach(([Q,ee])=>{const J=String(Q??"").trim();if(!J)return;const se=String(ee??"").trim();Y[J]=se||G[J]||""}),Y}),h(G=>{const q=B==null?void 0:B.column_recommendations;if(!q||typeof q!="object")return G;const Y={};return Object.entries(q).forEach(([Q,ee])=>{const J=String(Q??"").trim();if(!J)return;const se=Array.isArray(ee)?ee.map(ke=>String(ke??"").trim()).filter(Boolean):[];Y[J]=se}),Y})}).catch(B=>{U&&V((B==null?void 0:B.message)??"Unable to load recommendations")}).finally(()=>{U&&j(!1)}),()=>{U=!1}):(V("Connect this step to an upstream output to load recommendations."),()=>{U=!1}):(V(),()=>{U=!1}):(V(),()=>{U=!1})},[O,s,e,l,n,L,c,d,u,h,p,t]);const D=v.useCallback(()=>{!e||!t||!l||P(U=>U+1)},[e,l,t]),W=v.useMemo(()=>{const U=new Map;return f.forEach(V=>{V!=null&&V.id&&U.set(V.id,V.label)}),U},[f]),z=v.useCallback(U=>U?W.has(U)?W.get(U)??null:U.split("_").filter(Boolean).map(B=>B.charAt(0).toUpperCase()+B.slice(1)).join(" ")||U:null,[W]),R=v.useMemo(()=>w?b.filter(U=>Array.isArray(U==null?void 0:U.signals)&&U.signals.includes(w)):b,[w,b]);return{hasDropColumnSource:e,availableFilters:f,activeFilterId:w,setActiveFilterId:y,recommendations:b,filteredRecommendations:R,formatSignalName:z,isFetchingRecommendations:k,recommendationsError:N,recommendationsGeneratedAt:S,suggestedThreshold:$,refreshRecommendations:D}},Hk=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:s,recommendations:l,filteredRecommendations:i,isFetchingRecommendations:c,recommendationsError:u,relativeGeneratedAt:d,formatSignalName:p,formatMissingPercentage:h,getPriorityClass:f,getPriorityLabel:g,handleToggleColumn:w,selectedColumns:y})=>{const b=x=>{if(!(x!=null&&x.name))return null;const N=String(x.name),E=y.includes(N),k=f(x.priority),j=g(x.priority),S=Array.isArray(x==null?void 0:x.signals)?x.signals.map(M=>p(M)).filter(M=>!!M):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:E,onChange:()=>w(N)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:N}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[x.missing_percentage!==void 0&&x.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${h(x.missing_percentage)}`}),k&&j&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${k}`,children:j})]}),S.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:S.map(M=>a.jsx("span",{className:"canvas-modal__signal-badge",children:M},`${N}-${M}`))}),x.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:x.reason})]})]},N)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>s(null),children:["All reasons (",l.length,")"]}),t.map(x=>{const N=n===x.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${N?" canvas-modal__filter-button--active":""}`,onClick:()=>s(E=>E===x.id?null:x.id),title:x.description??void 0,children:[x.label," (",x.count,")"]},x.id)})]}),c&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!c&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!c&&!u&&a.jsxs(a.Fragment,{children:[d&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",d,"."]}),i.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:i.map(x=>b(x))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},Vk=({thresholdParameter:e,dropIfAnyParameter:t,renderParameterField:n})=>!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&n(e),t&&n(t)]}),Wk="first",Kk=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],Yk=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:s,renderMultiSelectField:l,removeDuplicatesKeepSelectId:i,removeDuplicatesKeep:c,onKeepChange:u})=>{if(!n&&!s)return null;const d=p=>{const h=p.target.value;u(h==="last"||h==="none"?h:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),l(n)]}),s&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:i,className:"canvas-modal__parameter-label",children:s.label??"Keep strategy"}),s.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:s.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:i,value:c,onChange:d,children:Kk.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))})})]})]})},Ze=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],Gk=["float64","Int64","boolean","string","category","datetime64[ns]","object"],Qk=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:s,columnSuggestions:l,selectedColumns:i,previewColumns:c,previewStatus:u,sourceId:d,hasReachableSource:p})=>{const h=v.useMemo(()=>{const j=e==null?void 0:e.column_overrides;if(!j||typeof j!="object"||Array.isArray(j))return{};const S={};return Object.entries(j).forEach(([M,$])=>{const T=String(M??"").trim();if(!T||typeof $!="string")return;const L=$.trim();L&&(S[T]=L)}),S},[e==null?void 0:e.column_overrides]),f=v.useMemo(()=>{const j=e==null?void 0:e.target_dtype;return typeof j=="string"?j.trim():""},[e==null?void 0:e.target_dtype]),g=v.useMemo(()=>{const j=new Set;return n.forEach(M=>j.add(M)),Object.keys(s).forEach(M=>j.add(M)),Object.keys(l).forEach(M=>j.add(M)),Object.keys(h).forEach(M=>j.add(M)),i.forEach(M=>j.add(M)),c.forEach(M=>{typeof M=="string"&&j.add(M)}),Array.from(j).sort((M,$)=>M.localeCompare($)).map(M=>{const $=s[M]??"Unknown",T=l[M]??[],L=T.length?T[0]:null,P=Object.prototype.hasOwnProperty.call(h,M),O=P?h[M]:null,D=typeof O=="string"?O.trim():"",W=P?D:f,z=new Set;W&&z.add(W),T.forEach(H=>z.add(H)),$&&$!=="Unknown"&&z.add($),f&&z.add(f),Gk.forEach(H=>z.add(H));const R=W??"",U=!!(L&&L!==R),V=!!(L&&L===R),B=i.includes(M),X=Array.from(z).sort((H,F)=>H.localeCompare(F));return{column:M,originalType:$,recommended:L,currentTarget:W,suggestions:T,options:X,hasRecommendationGap:U,hasOverride:P,usesDefaultTarget:!P,isRecommendationApplied:V,isSelected:B}})},[n,f,h,l,s,c,i]),w=v.useMemo(()=>{const j=g.filter($=>$.hasRecommendationGap),S=g.filter($=>!$.hasRecommendationGap),M=[];return j.length&&M.push({key:"needs-attention",label:"Needs attention",rows:j}),S.length&&M.push({key:"all-columns",label:j.length?"Other columns":"All columns",rows:S}),M},[g]),y=v.useMemo(()=>g.filter(j=>j.hasRecommendationGap).length,[g]),b=v.useMemo(()=>y>0,[y]),x=v.useMemo(()=>g.filter(j=>j.isSelected).length,[g]),N=v.useCallback((j,S)=>{const M=j.trim();M&&t($=>{const T=$.column_overrides&&typeof $.column_overrides=="object"&&!Array.isArray($.column_overrides)?{...$.column_overrides}:{},L=typeof S=="string"?S.trim():"",P=new Set(Ze($.columns)),O=new Set(Ze($.skipped_columns)),D=O.delete(M);L?(T[M]=L,P.add(M)):delete T[M];const W={...$,columns:Array.from(P).sort((z,R)=>z.localeCompare(R)),column_overrides:T};return D&&(W.skipped_columns=Array.from(O).sort((z,R)=>z.localeCompare(R))),W})},[t]),E=v.useCallback(()=>{const j=Object.entries(l).filter(([,S])=>S.length>0);j.length&&t(S=>{const M=new Set(Ze(S.columns)),$=S.column_overrides&&typeof S.column_overrides=="object"&&!Array.isArray(S.column_overrides)?{...S.column_overrides}:{};return j.forEach(([T,L])=>{const P=T.trim();P&&(M.add(P),L.length&&($[P]=L[0]))}),{...S,columns:Array.from(M).sort((T,L)=>T.localeCompare(L)),column_overrides:$}})},[l,t]),k=v.useCallback((j,S)=>{S==="__default__"?N(j,null):N(j,S)},[N]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:E,disabled:!b,children:"Apply recommendations"})})]}),!d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),d&&!p&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),f?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:f}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),g.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",g.length," column",g.length===1?"":"s","  ",x," mapped in node selection."]}),b?a.jsxs("p",{className:"canvas-modal__note",children:[y," column",y===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):g.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),u==="loading"&&!g.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),g.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:w.map(j=>a.jsxs("div",{className:"canvas-cast__group",children:[j.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:j.label}),a.jsxs("span",{children:[j.rows.length," column",j.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:j.rows.map(S=>{const M=["canvas-cast__row"];S.hasRecommendationGap&&M.push("canvas-cast__row--attention"),S.hasOverride&&M.push("canvas-cast__row--override");const $=S.hasOverride?S.currentTarget||"":"__default__",T=S.isRecommendationApplied,L=S.suggestions.slice(1,4),P=S.hasOverride?S.currentTarget?`Override  ${S.currentTarget}`:"Override cleared (uses original dtype)":f?`Inheriting ${f}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:M.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:S.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[S.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),S.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!S.isSelected&&!S.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:S.originalType})}),a.jsx("td",{children:S.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${S.hasRecommendationGap?" canvas-cast__chip--attention":""}${T?" canvas-cast__chip--applied":""}`,children:S.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:T?"Aligned with target":"Not applied yet"}),L.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",L.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:$,onChange:O=>k(S.column,O.target.value),children:[a.jsx("option",{value:"__default__",children:f?`Inherit global (${f})`:"No override (use original)"}),S.options.map(O=>a.jsx("option",{value:O,children:O},`${S.column}-${O}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:P})]})})]},`cast-row-${S.column}`)})})]})})]},`cast-group-${j.key}`))})]})},Jc=100,Xk=12,Jk={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},hx={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},Zk={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details."},eM={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},tM=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},nM=e=>{if(!e)return"";const t=Zk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},fx=(e,t)=>{if(!e)return null;const n=e.job_status??null,s=tM(n??e.status??null),l=hx[n??e.status??s]??hx[s],i=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,c=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let u=`Full dataset run: ${l}`;s==="running"&&i&&c?u=`Full dataset run: In progress (${i}/${c})`:s==="running"&&i?u=`Full dataset run: In progress (${i} rows)`:s==="succeeded"&&i?u=`Full dataset run: Completed (${i} rows)`:s==="succeeded"&&c&&(u=`Full dataset run: Completed (${c} rows)`);const d=[],p=[],h=n?eM[n]??n:null;if(n==="running"?i&&c?d.push(`Processed ${i} of ${c} rows.`):i?d.push(`Processed ${i} rows.`):c&&d.push(`Processing ${c} rows.`):i?d.push(`Processed ${i} rows.`):c&&d.push(`Total rows ${c}.`),e.reason&&d.push(e.reason),h&&p.push({label:"Background job",value:h}),e.job_id&&p.push({label:"Background job ID",value:e.job_id}),c&&p.push({label:"Dataset rows",value:c}),i&&s!=="queued"&&s!=="skipped"&&p.push({label:"Processed rows",value:i}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&p.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const w=new Date(e.last_updated).toLocaleString();p.push({label:"Last updated",value:w})}catch{p.push({label:"Last updated",value:String(e.last_updated)})}const f=Array.isArray(e.warnings)?e.warnings.map(nM).map(w=>w.trim()).filter(Boolean):[];let g=null;switch(s){case"queued":g=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":g=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(i){const w=e.processed_rows===1?"":"s";g=`Full dataset run processed ${i} row${w}.`}else c?g=`Full dataset run completed (${c} rows).`:g="Full dataset run completed.";break;case"failed":g=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":g="Full dataset run cancelled.";break;case"skipped":g=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":g=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:g=null;break}return{label:u,tone:s,details:d,metadata:p,warnings:f,stepLabel:g,isActive:n==="queued"||n==="running"}},px=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),sM=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const s=e.split(":",2)[1]??"";return s?`Preview mode "${s}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=Jk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},rM=({preview:e,columns:t,rows:n,tableNote:s,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:p,fullExecutionWarnings:h})=>{const f=e==null?void 0:e.metrics,g=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],w=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],y=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let b=y;const x=p||null;if(x){const j=y.findIndex(S=>typeof S=="string"&&S.toLowerCase().startsWith("full dataset run"));j>=0?b=[...y.slice(0,j),x,...y.slice(j+1)]:y.includes(x)||(b=[...y,x])}const N=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],E=w.reduce((j,S)=>(S&&typeof S.index=="number"&&(j[S.index]=typeof S.missing_percentage=="number"?S.missing_percentage:0),j),{}),k=N.slice(0,Xk);return a.jsxs("div",{className:"canvas-preview",children:[f&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:f.requested_sample_size===0?"Full dataset":i(f.requested_sample_size)})]})]}),b.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:b.map((j,S)=>a.jsx("li",{children:j},`${j}-${S}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(j=>a.jsx("th",{children:j},j))})}),a.jsx("tbody",{children:n.map((j,S)=>a.jsx("tr",{children:t.map(M=>a.jsx("td",{children:l(j==null?void 0:j[M])},`${S}-${M}`))},`row-${S}`))})]}),s?a.jsx("p",{className:"canvas-modal__note",children:s}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),w.length>0&&k.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:k.map((j,S)=>{const M=E[S]??0,$=M%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",S+1]}),a.jsxs("strong",{children:[i(M,$),"%"]})]},`row-missing-${S}`)})})]}),g.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:g.map(j=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:j.name}),j.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",j.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",c(j.missing_percentage)," (",i(j.missing_count),")"]}),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",u(j.mean)]}),typeof j.median=="number"&&!Number.isNaN(j.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",u(j.median)]}),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",d(j.mode)]}),typeof j.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",i(j.distinct_count)]})]},j.name))})]}),h&&h.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:h.map((j,S)=>a.jsx("li",{children:j},`${j}-${S}`))})]})]})},aM=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:s,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d})=>{var V,B,X,H,F;const[p,h]=v.useState(()=>px()),[f,g]=v.useState(null),[w,y]=v.useState(!1),b=e.status==="loading",x=b||!n,N=v.useMemo(()=>{var re;const K=(re=e.data)==null?void 0:re.columns;return Array.isArray(K)?K.filter(G=>typeof G=="string"):[]},[(V=e.data)==null?void 0:V.columns]),E=v.useMemo(()=>{var K;return Array.isArray((K=e.data)==null?void 0:K.sample_rows)?e.data.sample_rows.slice(0,Jc):[]},[(B=e.data)==null?void 0:B.sample_rows]),k=E.length,j=Array.isArray((X=e.data)==null?void 0:X.sample_rows)?e.data.sample_rows.length:0,S=(H=e.data)==null?void 0:H.metrics,M=v.useMemo(()=>S?j>k||typeof S.total_rows=="number"&&S.total_rows>j:!1,[S,k,j]);v.useEffect(()=>{var re;if(e.status!=="success"||!e.data){h(G=>G.status==="idle"?G:px()),g(null);return}const K=fx((re=e.data.signals)==null?void 0:re.full_execution,i);g(K),h({status:"ready",columns:[...N],rows:[...E],nextOffset:k,hasMore:M,totalRows:typeof(S==null?void 0:S.total_rows)=="number"?S.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[N,E,k,M,i,S==null?void 0:S.total_rows,e.data,e.status]),v.useEffect(()=>{var q,Y;if(!f||!f.isActive)return;const K=(Y=(q=e.data)==null?void 0:q.signals)==null?void 0:Y.full_execution;if(!K||!K.job_id||!t)return;const re=typeof K.poll_after_seconds=="number"&&K.poll_after_seconds>0?K.poll_after_seconds*1e3:5e3,G=setTimeout(()=>{Promise.resolve().then(()=>Uk).then(Q=>Q.fetchFullExecutionStatus(t,K.job_id)).then(Q=>{const ee=fx(Q,i);g(ee),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(Q=>{console.error("Failed to poll background job status:",Q)})},re);return()=>clearTimeout(G)},[f,t,i,e.data]);const $=p.columns.length>0?p.columns:N,T=p.rows.length>0?p.rows:E,L=p.totalRows??(typeof(S==null?void 0:S.total_rows)=="number"?S.total_rows:null),P=p.status==="idle"?M:p.hasMore,O=p.status==="loading",D=T.length,W=v.useMemo(()=>{if(!D)return null;const K=i(D);if(L!==null&&L>=0){const re=i(L),G=`Loaded ${K} of ${re} rows.`;return P&&D<L?`${G} Load more rows to continue.`:!P&&D<L?`${G} Preview limited by backend settings.`:G}return P?`Loaded ${K} rows. Additional rows available.`:`Loaded ${K} rows.`},[P,i,D,L]),z=v.useMemo(()=>(p.status==="idle"?[]:p.samplingAdjustments).map(sM).map(re=>re.trim()).filter(Boolean),[p.samplingAdjustments,p.status]),R=p.status==="idle"?!1:p.largeDataset,U=v.useCallback(()=>{var q;if(!t||!P||p.status==="loading")return;const K=p.rows.length>0?p.rows:E,re=p.status==="idle"?K.length:p.nextOffset??K.length,G=Array.isArray((q=e.data)==null?void 0:q.sample_rows)?e.data.sample_rows:[];if(re<G.length){const Y=G.slice(re,re+Jc),Q=K.concat(Y),ee=re+Y.length,J=ee<G.length||typeof(S==null?void 0:S.total_rows)=="number"&&S.total_rows>G.length;h({status:"ready",columns:p.columns.length>0?p.columns:N,rows:Q,nextOffset:J?ee:null,hasMore:J,totalRows:typeof(S==null?void 0:S.total_rows)=="number"?S.total_rows:null,samplingAdjustments:p.samplingAdjustments,largeDataset:p.largeDataset,error:null});return}h(Y=>({...Y,status:"loading",error:null})),ax(t,{offset:re,limit:Jc}).then(Y=>{h(Q=>{const ee=Q.rows.length>0?Q.rows:K,J=Array.isArray(Y.columns)&&Y.columns.length>0?Y.columns.map(Le=>String(Le)):Q.columns.length>0?Q.columns:N,se=typeof Y.offset=="number"&&Y.offset>=0?Y.offset:0,ke=Array.isArray(Y.rows)?Y.rows:[],Pe=se<=ee.length?ee.slice(0,se):ee.slice(),De=se<=ee.length?Pe.concat(ke):ee.concat(ke),Be=ke.length,mt=!!Y.has_more,Ge=typeof Y.next_offset=="number"?Y.next_offset:mt?se+Be:null,ue=typeof Y.total_rows=="number"?Y.total_rows:null,ye=mt?null:De.length,Me=ue!==null?ue:Q.totalRows!==null?Q.totalRows:ye;return{status:"ready",columns:[...J],rows:De,nextOffset:Ge,hasMore:mt,totalRows:Me,samplingAdjustments:Array.isArray(Y.sampling_adjustments)?Y.sampling_adjustments:[],largeDataset:!!Y.large_dataset,error:null}})}).catch(Y=>{h(Q=>({...Q,status:"error",error:(Y==null?void 0:Y.message)??"Unable to load additional rows."}))})},[N,E,t,P,p,(F=e.data)==null?void 0:F.sample_rows,S]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),f&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${f.tone}`,role:"status","aria-live":f.isActive?"polite":"off",title:f.details.length>0?f.details.join(" "):void 0,children:f.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:x,children:b?"Refreshing":"Refresh"})})]}),f&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[f.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:f.details.map((K,re)=>a.jsx("li",{children:K},`${K}-${re}`))}),f.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>y(!w),"aria-expanded":w,children:[w?"":""," ",w?"Hide":"Show"," job details"]}),w&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:f.metadata.map((K,re)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:K.label}),a.jsx("dd",{children:K.value})]},`${K.label}-${K.value}-${re}`))})]})]}),b&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(rM,{preview:e.data,columns:$,rows:T,tableNote:W,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:(f==null?void 0:f.stepLabel)??null,fullExecutionWarnings:(f==null?void 0:f.warnings)??[]}),p.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:p.error}),R&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",i(Jc)," rows to stay responsive."]}),z.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:z.map((K,re)=>a.jsx("li",{children:K},`${K}-${re}`))})]}),P&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:U,disabled:O,children:O?"Loading rows":`Load next ${i(Jc)} rows`})}),!P&&!b&&L!==null&&D>=L&&D>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},wi=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],oM=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:s,graphContext:l,profilingGraphSignature:i,formatRelativeTime:c})=>{var U;const[u,d]=v.useState({status:"idle",data:null,error:null}),[p,h]=v.useState(0),[f,g]=v.useState({}),[w,y]=v.useState("500"),[b,x]=v.useState("summary"),[N,E]=v.useState(!1),k=v.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${w}::${i}`,[t,e==null?void 0:e.id,i,w,n]),j=v.useMemo(()=>k?f[k]??null:null,[f,k]);v.useEffect(()=>{y("500"),d({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),v.useEffect(()=>{if(!t){d({status:"idle",data:null,error:null});return}if(!n){d({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!s){d({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(j){d({status:"success",data:j,error:null});return}let V=!0;d({status:"loading",data:null,error:null});const B=wi.find(H=>H.value===w)??wi[1]??wi[0],X=B.value==="all"?"all":Number(B.value);return tx(n,{sampleSize:X,graph:l,targetNodeId:(e==null?void 0:e.id)??null}).then(H=>{V&&(k&&H&&g(F=>({...F,[k]:H})),d({status:"success",data:H??null,error:null}))}).catch(H=>{V&&d({status:"error",data:null,error:(H==null?void 0:H.message)??"Unable to generate dataset profile"})}),()=>{V=!1}},[j,l,s,t,e==null?void 0:e.id,p,k,w,n]);const S=u.data,M=(S==null?void 0:S.generated_at)??null,$=((U=S==null?void 0:S.correlations)==null?void 0:U.length)??0;v.useEffect(()=>{E(!1),x("summary")},[t,M]),v.useEffect(()=>{b==="correlations"&&$===0&&x("summary")},[b,$]);const T=v.useCallback(()=>{k&&g(V=>{if(!Object.prototype.hasOwnProperty.call(V,k))return V;const B={...V};return delete B[k],B}),h(V=>V+1)},[k]),L=v.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),P=v.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),O=v.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),D=v.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),W=v.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),z=v.useMemo(()=>wi.find(V=>V.value===w)??wi[0],[w]),R=v.useMemo(()=>c((S==null?void 0:S.generated_at)??null),[c,S==null?void 0:S.generated_at]);return{profileState:u,profileData:S,profilingSamplePreset:w,setProfilingSamplePreset:y,profilingActiveTab:b,setProfilingActiveTab:x,isProfilingWarningsOpen:N,setIsProfilingWarningsOpen:E,handleRefreshDatasetProfile:T,activeProfilingSamplePreset:z,profilingWarningsListId:L,profilingSummaryPanelId:P,profilingCorrelationsPanelId:O,profilingSummaryTabId:D,profilingCorrelationsTabId:W,profilingCorrelationCount:$,relativeProfilingGeneratedAt:R}},lM=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:s,formatMissingPercentage:l})=>{if(!e)return null;const{profileState:i,profileData:c,profilingSamplePreset:u,setProfilingSamplePreset:d,profilingActiveTab:p,setProfilingActiveTab:h,isProfilingWarningsOpen:f,setIsProfilingWarningsOpen:g,handleRefreshDatasetProfile:w,activeProfilingSamplePreset:y,profilingWarningsListId:b,profilingSummaryPanelId:x,profilingCorrelationsPanelId:N,profilingSummaryTabId:E,profilingCorrelationsTabId:k,profilingCorrelationCount:j,relativeProfilingGeneratedAt:S}=t,M=i.status==="success"&&!!c;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:wi.map($=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":$.value===u,onClick:()=>d($.value),disabled:i.status==="loading",children:$.label},$.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:w,disabled:i.status==="loading",children:i.status==="loading"?"Refreshing":"Refresh"})]})]}),S&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",S]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:y.label}),"."]}),i.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),i.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i.error}),M&&c&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",c.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",c.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",c.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",c.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",c.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:E,role:"tab","data-active":p==="summary","aria-selected":p==="summary","aria-controls":x,onClick:()=>h("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:k,role:"tab","data-active":p==="correlations","aria-selected":p==="correlations","aria-controls":N,onClick:()=>h("correlations"),disabled:!j,children:"Correlations"})]}),p==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:x,role:"tabpanel","aria-labelledby":E,children:[c.warnings&&c.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>g($=>!$),"aria-expanded":f,"aria-controls":b,children:f?"Hide warnings":`Show warnings (${c.warnings.length})`}),f&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:b,children:c.warnings.map(($,T)=>a.jsx("li",{children:$},`profiling-warning-${T}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:c.columns.map($=>{const T=$.numeric_summary,L=!!T,P=Array.isArray($.top_values)?$.top_values:[],O=Array.isArray($.sample_values)?$.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${$.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:$.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:$.semantic_type??$.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${l($.missing_percentage)} (${$.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:$.distinct_count!==null?$.distinct_count.toLocaleString():""})]})]}),L?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",s(T==null?void 0:T.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",s(T==null?void 0:T.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",s(T==null?void 0:T.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",s(T==null?void 0:T.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",s(T==null?void 0:T.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",s(T==null?void 0:T.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",s(T==null?void 0:T.percentile_75)]})]})]}):null,P.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:P.map((D,W)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(D.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[D.count.toLocaleString()," (",D.percentage.toFixed(1),"%)"]})]},`${$.name}-top-${W}`))})]}):null,O.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:O.slice(0,5).map((D,W)=>a.jsx("li",{children:n(D)},`${$.name}-sample-${W}`))})]}):null]},$.name)})})]}),p==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:N,role:"tabpanel","aria-labelledby":k,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),c.correlations&&c.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:c.correlations.map(($,T)=>{const L=Math.abs($.coefficient);let P="low";L>=.85?P="extreme":L>=.7?P="strong":L>=.55&&(P="moderate");const O=$.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:$.column_a}),a.jsx("td",{children:$.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":P,"data-sign":O,children:$.coefficient.toFixed(2)})]},`profile-correlation-${T}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},iM=({type:e})=>a.jsx("span",{"aria-hidden":"true",className:`canvas-modal__title-glyph${e==="dataset"?" canvas-modal__title-glyph--dataset":""}`,children:e==="dataset"?"":""}),cM=({title:e,isDataset:t,onClose:n,canResetNode:s=!1,onResetNode:l})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx(iM,{type:t?"dataset":"default"}),a.jsxs("div",{children:[a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e}),a.jsx("p",{className:"canvas-modal__subtitle",children:t?"Configure how this dataset feeds the pipeline.":"Adjust parameters to control this transformation."})]})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[s&&l&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,children:"Reset node"}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",children:""})]})]}),uM=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:s,canSave:l,onSave:i,isBusy:c,busyLabel:u})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsx("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":c,children:c&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:u??"Processing"})]})}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,children:"Reset node"}),s&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:i,disabled:!l,children:"Save changes"})]})]}),gr=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),ms=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},Gs=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return gr(t,n)},gx=e=>e==null||e===""?"":typeof e=="number"?Gs(e):String(e),dM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},mM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},hM=5,fM=4,pM=3,gM="_binned",_x="Missing",_M=5,vM="ordinal",yM="quantile",bM=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],xM=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],tg={equal_width:"Equal-width",equal_frequency:"Equal-frequency",custom:"Custom edges",kbins:"KBins (sklearn)"},wM=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],Zc=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],vx=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",s=Ze(e==null?void 0:e.columns),l=(R,U,V,B)=>{const X=Number(R);if(!Number.isFinite(X))return U;const H=Math.round(X);return Math.max(V,Math.min(B,H))},i=l(e==null?void 0:e.equal_width_bins,hM,2,200),c=l(e==null?void 0:e.equal_frequency_bins,fM,2,200),u=l(e==null?void 0:e.precision,pM,0,8),d=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",p=!!((e==null?void 0:e.include_lowest)??!0),h=!!((e==null?void 0:e.drop_original)??!1),g=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||gM,w=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",y=["range","bin_index","ordinal","column_suffix"].includes(w)?w:"range",x=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",N=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",E=x==="label"&&N||_x,k=l(e==null?void 0:e.kbins_n_bins,_M,2,200),j=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",S=["ordinal","onehot","onehot-dense"].includes(j)?j:vM,M=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",$=["uniform","quantile","kmeans"].includes(M)?M:yM,T=R=>{if(!Array.isArray(R))return[];const V=R.map(B=>{if(typeof B=="number")return B;if(B==null)return Number.NaN;const X=String(B).trim();return X?Number(X):Number.NaN}).filter(B=>Number.isFinite(B)).sort((B,X)=>B-X).filter((B,X,H)=>X===0||B!==H[X-1]);return V.length>=2?V:[]},L=R=>Array.isArray(R)?R.map(U=>String(U).trim()).filter(Boolean):typeof R=="string"?R.split(/[\,\n]/).map(U=>U.trim()).filter(Boolean):[],P=(R,U,V)=>{if(R==null)return null;const B=Number(R);if(!Number.isFinite(B))return null;const X=Math.round(B);return Math.max(U,Math.min(V,X))},O={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([R,U])=>{const V=String(R??"").trim();if(!V)return;const B=T(U);B.length>=2&&(O[V]=B)});const D={};e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([R,U])=>{const V=String(R??"").trim();if(!V)return;const B=L(U);B.length&&(D[V]=B)});const W={},z=e!=null&&e.column_strategies&&typeof e.column_strategies=="object"&&!Array.isArray(e.column_strategies)?e.column_strategies:e!=null&&e.column_overrides&&typeof e.column_overrides=="object"&&!Array.isArray(e.column_overrides)?e.column_overrides:null;return z&&Object.entries(z).forEach(([R,U])=>{const V=String(R??"").trim();if(!V||!U||typeof U!="object"||Array.isArray(U))return;const B=U,X={},H=typeof B.strategy=="string"?B.strategy.trim().toLowerCase():"";["equal_width","equal_frequency","custom","kbins"].includes(H)&&(X.strategy=H);const F=P(B.equal_width_bins,2,200);F!==null&&(X.equalWidthBins=F);const K=P(B.equal_frequency_bins,2,200);K!==null&&(X.equalFrequencyBins=K);const re=P(B.kbins_n_bins,2,200);re!==null&&(X.kbinsNBins=re);const G=typeof B.kbins_encode=="string"?B.kbins_encode.trim().toLowerCase():"";["ordinal","onehot","onehot-dense"].includes(G)&&(X.kbinsEncode=G);const q=typeof B.kbins_strategy=="string"?B.kbins_strategy.trim().toLowerCase():"";["uniform","quantile","kmeans"].includes(q)&&(X.kbinsStrategy=q);const Y=T(B.custom_bins);Y.length>=2&&(X.customBins=Y);const Q=L(B.custom_labels);Q.length>0&&(X.customLabels=Q),Object.keys(X).length>0&&(W[V]=X)}),{strategy:n,columns:s,equalWidthBins:i,equalFrequencyBins:c,includeLowest:p,precision:u,duplicates:d,outputSuffix:g,dropOriginal:h,labelFormat:y,missingStrategy:x,missingLabel:E,customBins:O,customLabels:D,columnStrategies:W,kbinsNBins:k,kbinsEncode:S,kbinsStrategy:$}},jM=(e,t,n,s=tg)=>{if(!e.length)return null;const l=e.map(i=>{const c=t[i],u=(c==null?void 0:c.strategy)??null;if(!u)return i;const d=s[u]??u,p=[];u==="equal_width"&&(c!=null&&c.equalWidthBins)?p.push(`${c.equalWidthBins} bins`):u==="equal_frequency"&&(c!=null&&c.equalFrequencyBins)?p.push(`${c.equalFrequencyBins} bins`):u==="kbins"&&(c!=null&&c.kbinsNBins&&p.push(`${c.kbinsNBins} bins`),c!=null&&c.kbinsStrategy&&p.push(c.kbinsStrategy),c!=null&&c.kbinsEncode&&p.push(c.kbinsEncode));const h=p.length?` (${p.join(", ")})`:"";return`${i} -> ${d}${h}`});return n>e.length&&l.push(""),l.join(", ")},NM=({config:e,fieldIds:t,onIntegerChange:n,onBooleanToggle:s,onSuffixChange:l,onLabelFormatChange:i,onMissingStrategyChange:c,onMissingLabelChange:u})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Global output & labeling"}),a.jsx("p",{className:"canvas-modal__note",children:"Applies to every selected column unless custom bins or labels override the defaults."}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.suffix,className:"canvas-modal__parameter-label",children:"Output suffix"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.suffix,type:"text",className:"canvas-modal__input",value:e.outputSuffix,onChange:d=>l(d.target.value),placeholder:"e.g. _binned"})})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.labelFormat,className:"canvas-modal__parameter-label",children:"Label format"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:t.labelFormat,value:e.labelFormat,onChange:d=>i(d.target.value??"range"),children:xM.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Controls how new bin values are named when custom labels arent provided."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.precision,className:"canvas-modal__parameter-label",children:"Decimal precision"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.precision,type:"number",className:"canvas-modal__input",min:0,max:8,step:1,value:e.precision,onChange:d=>n("precision",d.target.value,0,8)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Sets rounding precision for interval labels."})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.includeLowest,children:"Include lowest edge"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.includeLowest,type:"checkbox",checked:e.includeLowest,onChange:d=>s("include_lowest",d.target.checked)}),"Include the minimum value in the first bin"]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.dropOriginal,children:"Drop original columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.dropOriginal,type:"checkbox",checked:e.dropOriginal,onChange:d=>s("drop_original",d.target.checked)}),"Remove source columns after binning"]})]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:wM.map(d=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===d.value,onClick:()=>c(d.value),children:d.label},d.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:d=>u(d.target.value),placeholder:"e.g. Missing"})})]})]})]}),yx=e=>tg[e]??e.replace(/_/g," "),CM=e=>{switch(e){case"high":return"High confidence";case"medium":return"Medium confidence";case"low":return"Low confidence";default:return"Confidence unknown"}},SM=(e,t,n)=>{if(!e||typeof e!="object")return"No distribution summary";const s=[];typeof e.valid_count=="number"&&Number.isFinite(e.valid_count)&&s.push(`${t(e.valid_count)} valid rows`),typeof e.distinct_count=="number"&&Number.isFinite(e.distinct_count)&&s.push(`${t(e.distinct_count)} distinct values`);const l=typeof e.minimum=="number"&&Number.isFinite(e.minimum),i=typeof e.maximum=="number"&&Number.isFinite(e.maximum);if(l||i){const c=l?n(e.minimum):"",u=i?n(e.maximum):"";s.push(`Range ${c}  ${u}`)}return typeof e.skewness=="number"&&Number.isFinite(e.skewness)&&s.push(`Skew ${n(e.skewness)}`),s.length?s.join("  "):"No distribution summary"},EM=({hasSource:e,hasReachableSource:t,isFetching:n,error:s,relativeGeneratedAt:l,sampleSize:i,binningConfig:c,binningDefaultLabel:u,binningOverrideCount:d,binningOverrideSummary:p,recommendations:h,excludedColumns:f,numericColumnCount:g,canApplyAllNumeric:w,onApplyAllNumeric:y,onApplyStrategies:b,onClearOverrides:x,customEdgeDrafts:N,customLabelDrafts:E,onOverrideStrategyChange:k,onOverrideNumberChange:j,onOverrideKbinsEncodeChange:S,onOverrideKbinsStrategyChange:M,onOverrideClear:$,onCustomBinsChange:T,onCustomLabelsChange:L,onClearCustomColumn:P,formatMetricValue:O,formatNumericStat:D})=>{const W=v.useMemo(()=>e?t?n?"Diagnostics are loading":s?"Diagnostics are unavailable at the moment.":g>0?`Detected ${g} numeric column${g===1?"":"s"} in the current sample.`:f.length>0?`Diagnostics skipped ${f.length} column${f.length===1?"":"s"} (see details).`:"No additional diagnostics were produced for the current sample.":"Connect this step to an upstream output to surface diagnostics.":"Select a dataset to surface diagnostics.",[s,f.length,t,e,n,g]),z=v.useMemo(()=>{const H=f.slice(0,6),F=Math.max(0,f.length-H.length);return{preview:H,remaining:F}},[f]),R=v.useMemo(()=>{const H=new Map;return h.forEach(F=>{const K=typeof(F==null?void 0:F.column)=="string"?F.column.trim():"";K&&H.set(K,F)}),H},[h]),U=v.useMemo(()=>{const H=new Set;return c.columns.forEach(F=>{const K=String(F??"").trim();K&&H.add(K)}),Object.keys(c.columnStrategies).forEach(F=>{const K=String(F??"").trim();K&&H.add(K)}),h.forEach(F=>{const K=typeof(F==null?void 0:F.column)=="string"?F.column.trim():"";K&&H.add(K)}),Array.from(H).sort((F,K)=>F.localeCompare(K))},[c.columnStrategies,c.columns,h]),V=(H,F)=>{var K;return!H||Object.keys(H).length===0?"__default__":H.strategy?H.strategy:(K=H.customBins)!=null&&K.length?"custom":H.kbinsNBins||H.kbinsEncode||H.kbinsStrategy?"kbins":H.equalFrequencyBins?"equal_frequency":H.equalWidthBins?"equal_width":F},B=e&&t,X=H=>{var K,re;if(!H)return[];const F=[];return typeof H.equalWidthBins=="number"&&F.push(`${H.equalWidthBins} bins`),typeof H.equalFrequencyBins=="number"&&F.push(`${H.equalFrequencyBins} bins`),typeof H.kbinsNBins=="number"&&F.push(`${H.kbinsNBins} bins`),H.kbinsStrategy&&F.push(H.kbinsStrategy),H.kbinsEncode&&F.push(H.kbinsEncode),(K=H.customBins)!=null&&K.length&&F.push("Custom bins"),(re=H.customLabels)!=null&&re.length&&F.push("Custom labels"),F};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binning diagnostics"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:x,disabled:!d,children:"Clear"}),b&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:b,disabled:!h.length,children:"Quick apply"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:W}),a.jsxs("p",{className:"canvas-modal__note",children:["Default strategy ",a.jsx("strong",{children:u}),d>0?`  Overrides: ${d}${p?` (${p})`:""}`:"  No column overrides yet"]}),a.jsxs("div",{className:"canvas-modal__collapsible",children:[!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface binning insights and column diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),B&&a.jsxs(a.Fragment,{children:[l&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",l,i!==null?` on ${O(i)} row${i===1?"":"s"}.`:"."]}),y&&g>0&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:y,disabled:!w,children:`Add all numeric columns (${g})`})}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binning diagnostics"}),s&&!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s}),!s&&a.jsxs(a.Fragment,{children:[U.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested strategy"}),a.jsx("th",{scope:"col",children:"Configured strategy"}),a.jsx("th",{scope:"col",children:"Distribution highlights"})]})}),a.jsx("tbody",{children:U.map(H=>{var xt,ot,$e,je,Vt;const F=R.get(H)??null,K=c.columnStrategies[H],re=V(K,c.strategy),G=re==="__default__"?c.strategy:re,q=(F==null?void 0:F.recommended_strategy)??null,Y=!!(q&&q!==G),Q=!!(K&&Object.keys(K).length),ee=c.columns.includes(H),J=F==null?void 0:F.recommended_bins,se=typeof J=="number"?J:J!=null?Number(J):null,ke=typeof se=="number"&&Number.isFinite(se)&&se>0?se:null,Pe=(K==null?void 0:K.equalWidthBins)??c.equalWidthBins,De=(K==null?void 0:K.equalFrequencyBins)??c.equalFrequencyBins,Be=(K==null?void 0:K.kbinsNBins)??c.kbinsNBins,mt=(K==null?void 0:K.kbinsEncode)??"__default__",Ge=(K==null?void 0:K.kbinsStrategy)??"__default__",ue=["canvas-cast__row"];Y&&ue.push("canvas-cast__row--attention"),Q&&ue.push("canvas-cast__row--override"),ee||ue.push("canvas-cast__row--muted");const ye=SM(F==null?void 0:F.stats,O,D),Me=((xt=F==null?void 0:F.reasons)==null?void 0:xt.filter(tt=>tt&&tt.trim()))??[],Le=(()=>{const tt=X(K),Wt=Array.isArray(c.customBins[H])?c.customBins[H].length>=2:!1,ct=Array.isArray(c.customLabels[H])?c.customLabels[H].length>0:!1,Rt=[...tt];return Wt&&!Rt.includes("Custom bins")&&Rt.push("Custom bins"),ct&&!Rt.includes("Custom labels")&&Rt.push("Custom labels"),Rt})(),Ve=re==="__default__"?`Inheriting ${u}`:`Override  ${yx(G)}${Le.length?` (${Le.join(", ")})`:""}`,ce=(F==null?void 0:F.dtype)??null,Fe=F?CM(F.confidence):null,et=Object.prototype.hasOwnProperty.call(N,H)?N[H]:((ot=c.customBins[H])==null?void 0:ot.join(", "))??"",it=Object.prototype.hasOwnProperty.call(E,H)?E[H]:(($e=c.customLabels[H])==null?void 0:$e.join(", "))??"",at=(((je=c.customBins[H])==null?void 0:je.length)??0)>=2||(((Vt=c.customLabels[H])==null?void 0:Vt.length)??0)>0;return a.jsxs("tr",{className:ue.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:H}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[ce&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",ce]}),!ee&&a.jsx("span",{className:"canvas-cast__muted",children:"Not currently in node"}),Q&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),Y&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--attention",children:"Needs review"})]})]})}),a.jsx("td",{children:a.jsx("div",{className:"canvas-cast__recommendation",children:F?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-cast__chip canvas-cast__chip--applied",children:yx(F.recommended_strategy)}),a.jsxs("span",{className:"canvas-cast__recommendation-note",children:[ke!==null?`${ke} bin${ke===1?"":"s"}`:"Bins not provided",Fe?`  ${Fe}`:""]}),Me.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:Me.join("; ")})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:re,onChange:tt=>k(H,tt.target.value,{recommendedBins:ke}),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",u,")"]}),bM.map(tt=>a.jsx("option",{value:tt.value,children:tt.label},`${H}-${tt.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:Ve}),re==="equal_width"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Pe??"",onChange:tt=>j(H,"equal_width_bins",tt.target.value)})]})}),re==="equal_frequency"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:De??"",onChange:tt=>j(H,"equal_frequency_bins",tt.target.value)})]})}),re==="kbins"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Max bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Be??"",onChange:tt=>j(H,"kbins_n_bins",tt.target.value)})]}),a.jsxs("label",{children:["Encode",a.jsxs("select",{value:mt,onChange:tt=>S(H,tt.target.value==="__default__"?null:tt.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsEncode,")"]}),a.jsx("option",{value:"ordinal",children:"Ordinal"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})]}),a.jsxs("label",{children:["Strategy",a.jsxs("select",{value:Ge,onChange:tt=>M(H,tt.target.value==="__default__"?null:tt.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsStrategy,")"]}),a.jsx("option",{value:"uniform",children:"Uniform"}),a.jsx("option",{value:"quantile",children:"Quantile"}),a.jsx("option",{value:"kmeans",children:"K-means"})]})]})]}),re==="custom"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Custom edges",a.jsx("input",{type:"text",className:"canvas-modal__input",value:et,placeholder:"e.g. 0, 50, 100",onChange:tt=>T(H,tt.target.value)})]}),a.jsxs("label",{children:["Optional labels",a.jsx("input",{type:"text",className:"canvas-modal__input",value:it,placeholder:"e.g. Low, Medium, High",onChange:tt=>L(H,tt.target.value)})]}),at&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>P(H),children:"Clear custom edges"})]}),Q&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>$(H),children:"Clear"})]})}),a.jsx("td",{children:a.jsx("span",{children:ye})})]},`binning-insight-${H}`)})})]})})}),!n&&U.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"No columns met the sampling requirements for binning recommendations."}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",f.length," column",f.length===1?"":"s"," due to non-numeric values or limited variance",z.preview.length>0&&a.jsxs(a.Fragment,{children:[":"," ",z.preview.map(H=>`${H.column}${H.reason?` (${H.reason})`:""}`).join(", "),z.remaining>0?`,  (+${z.remaining} more)`:""]}),"."]})]})]})]})]})},kM=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:s,sampleSize:l,relativeGeneratedAt:i,error:c,onRefresh:u,canRefresh:d})=>{const p=v.useMemo(()=>Zc.find(h=>h.value===t)??Zc[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:Zc.map(h=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":h.value===t,onClick:()=>n(h.value),disabled:s,children:h.label},h.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:u,disabled:s||!d,children:s?"Refreshing":"Refresh"})]})]}),l!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:p.label}),"."," ",p.value==="all"?`Summaries computed from the full dataset (${l.toLocaleString()} rows).`:`Summaries computed from ${l.toLocaleString()} sampled rows.`]}),i&&a.jsxs("p",{className:"canvas-modal__note",children:["Updated ",i]}),s&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!s&&c&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:c}),!s&&!c&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(h=>{const f=h.topPercentage!==null?`${h.topPercentage.toFixed(1)}%`:null,g=h.topCount!==null?`${h.topCount.toLocaleString()}${f?`  ${f}`:""}`:f??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:h.column}),h.sourceColumn&&h.sourceColumn!==h.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:h.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:h.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:g})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:h.bins.map(w=>{const y=w.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",b=Math.min(100,Math.max(0,w.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:y,children:w.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${b}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:w.count.toLocaleString()}),a.jsxs("span",{children:[w.percentage.toFixed(1),"%"]})]})]},`${h.column}-${w.label}`)})}),h.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",h.bins.length," of ",h.totalBinCount," bins."]})]},`binned-card-${h.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},MM=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],AM=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],OM=[...MM,...AM],PM=[0,5,10,20,40,60],TM=["float","double","int","uint","long","short","byte","number","decimal"],$M=["bool","boolean"],LM=["object","string","category","datetime","date","time"],zM=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:LM.some(n=>t.includes(n))?!1:!!(TM.some(n=>t.includes(n))||$M.some(n=>t.includes(n)))},bx=e=>e!=="mode",xx=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},eu=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,s=Number(n);return{neighbors:Number.isFinite(s)?Math.max(1,Math.round(s)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,s=Number(n);return{max_iter:Number.isFinite(s)?Math.max(1,Math.round(s)):10}}},wx=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",s=new Set(t);return e.map(l=>{if(!l||typeof l!="object")return null;const i=typeof l.method=="string"?l.method.trim().toLowerCase():n,c=s.has(i)?i:n;let u=[];Array.isArray(l.columns)?u=l.columns.map(f=>String(f).trim()).filter(Boolean):typeof l.columns=="string"&&(u=l.columns.split(",").map(f=>f.trim()).filter(Boolean));const d=l.options&&typeof l.options=="object"?l.options:{};let p;if(c==="knn"){const f=d.neighbors??l.neighbors,g=Number(f);p={neighbors:Number.isFinite(g)?Math.max(1,Math.round(g)):5}}else if(c==="regression"||c==="mice"){const f=d.max_iter??d.maxIter??l.max_iter??l.maxIter,g=Number(f);p={max_iter:Number.isFinite(g)?Math.max(1,Math.round(g)):10}}const h=eu(c,p??xx(c));return{method:c,columns:u,options:h}}).filter(l=>!!l)},DM=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),RM=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:s,methodOptions:l,missingFilter:i,missingFilterMax:c,missingFilterActive:u,filteredOptionCount:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onMethodChange:w,onOptionNumberChange:y,onColumnsChange:b,onColumnToggle:x,onMissingFilterChange:N,formatMissingPercentage:E,formatNumericStat:k,formatModeStat:j,schemaDiagnostics:S})=>{const M=be.useMemo(()=>{var P;return(P=S==null?void 0:S.entries)!=null&&P.length?new Map(S.entries.map(O=>[O.index,O])):new Map},[S]),$=Math.max(c,i||0),T=s.length>0,L=P=>{var D,W,z;const O=((D=l.find(R=>R.value===P.method))==null?void 0:D.label)??P.method;return P.method==="knn"&&((W=P.options)!=null&&W.neighbors)?`${O}  k=${P.options.neighbors}`:(P.method==="regression"||P.method==="mice")&&((z=P.options)!=null&&z.max_iter)?`${O}  ${P.options.max_iter} iter`:O};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(S==null?void 0:S.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S.message}),s.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",d," of ",s.length," column",s.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx("input",{id:"imputer-missing-filter",type:"range",min:0,max:$,step:1,value:i,onChange:P=>N(Number(P.target.value)),className:"canvas-imputer__filter-range"}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[i,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>N(0),disabled:!i,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:PM.map(P=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${i===P?" canvas-imputer__filter-button--active":""}`,onClick:()=>N(P),children:["",P,"%"]},`imputer-missing-preset-${P}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map((P,O)=>{var K,re,G;const D=P.columns.join(", "),W=bx(P.method),z=s.filter(q=>{if(P.columns.includes(q.name))return!0;if(W&&!zM(q))return!1;const Y=typeof q.missingPercentage=="number"?q.missingPercentage:null;return Y!==null?Y<=0?!1:Y>=i:i===0}),R=L(P),U=P.columns.length?`${P.columns.length} column${P.columns.length===1?"":"s"}`:"No columns yet",V=p.has(O),B=z.filter(q=>!P.columns.includes(q.name)),X=M.get(O),H=(K=X==null?void 0:X.details)!=null&&K.length?X.details.map(q=>q.logical_family?`${q.name} (${q.logical_family})`:q.name).join(", "):"",F=()=>{if(!z.length)return;const q=[...P.columns];z.forEach(Y=>{q.includes(Y.name)||q.push(Y.name)}),b(O,q.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(O),"aria-expanded":!V,"aria-controls":`imputer-strategy-body-${O}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${V?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",O+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[R,"  ",U]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(O),"aria-label":`Remove strategy ${O+1}`,children:"Remove"})]}),!V&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${O}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Method"}),a.jsx("select",{value:P.method,onChange:q=>w(O,q.target.value??"mean"),children:l.map(q=>a.jsx("option",{value:q.value,children:q.label},q.value))})]}),P.method==="knn"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Neighbors (k)"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:50,step:1,value:((re=P.options)==null?void 0:re.neighbors)??5,onChange:q=>y(O,"neighbors",q.target.value)})]}),(P.method==="regression"||P.method==="mice")&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Max iterations"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:100,step:1,value:((G=P.options)==null?void 0:G.max_iter)??10,onChange:q=>y(O,"max_iter",q.target.value)})]}),P.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),H&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",H,"."]}),z.length>0&&B.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:F,children:"Select all columns"}),z.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:z.map(q=>{const Y=P.columns.includes(q.name),Q=E(q.missingPercentage),ee=typeof q.mean=="number",J=typeof q.median=="number",se=q.mode!==null&&q.mode!==void 0&&q.mode!=="",ke=ee||J||se;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Y?" canvas-imputer__column-pill--selected":""}`,onClick:()=>x(O,q.name),"aria-pressed":Y,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:q.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",Q]}),q.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:q.dtype})]}),ke&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[ee&&a.jsxs("span",{children:["Mean: ",k(q.mean)]}),J&&a.jsxs("span",{children:["Median: ",k(q.median)]}),se&&a.jsxs("span",{children:["Mode: ",j(q.mode)]})]})]},q.name)})}):a.jsx("p",{className:"canvas-modal__note",children:T?u?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${P.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:P.columns.length?P.columns.map(q=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:q},q)):a.jsx("span",{children:"No columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Manual columns (optional)"}),a.jsx("input",{type:"text",className:"canvas-imputer__columns-input",value:D,onChange:q=>b(O,q.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${O}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},FM=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:s,scalingMethodOptions:l,scalingMethodDetailMap:i,scalingDefaultDetail:c,scalingAutoDetectEnabled:u,scalingSelectedCount:d,scalingDefaultLabel:p,scalingOverrideCount:h,scalingOverrideExampleSummary:f,scalingRecommendationRows:g,scalingHasRecommendations:w,scalingStatusMessage:y,scalingError:b,scalingSampleSize:x,relativeScalingGeneratedAt:N,formatMetricValue:E,formatNumericStat:k,formatMissingPercentage:j,onApplyAllRecommendations:S,onClearOverrides:M,onDefaultMethodChange:$,onAutoDetectToggle:T,onOverrideSelect:L})=>{const P=c??i.get(s.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:S,disabled:!w,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:M,disabled:!h,children:"Clear overrides"})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),N&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",N,x!==null?` on ${E(x)} row${x===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:l.map(O=>{const D=i.get(O.value)??null,W=O.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${W?" canvas-scaling__method-button--active":""}`,"aria-pressed":W,onClick:()=>$(O.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:O.label}),(D==null?void 0:D.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:D.description})]},O.value)})}),(P==null?void 0:P.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:P.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:O=>T(O.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"When enabled, recommended numeric features join this node automatically after each refresh."})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",h>0?`  Overrides: ${h}${f?` (${f})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&b&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:b}),!n&&!b&&a.jsxs(a.Fragment,{children:[y&&a.jsx("p",{className:"canvas-modal__note",children:y}),g.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:g.map(O=>{const D=!O.isSkipped&&O.recommendedMethod!==O.currentMethod,W=["canvas-cast__row"];D&&W.push("canvas-cast__row--attention"),O.isOverrideApplied&&W.push("canvas-cast__row--override"),O.isSkipped&&W.push("canvas-cast__row--muted");const z=O.isSkipped?"__skip__":O.isOverrideApplied?O.currentMethod:"__default__",R=O.isOverrideApplied?`Override -> ${O.currentMethodLabel}`:O.isSkipped?"Skipped (column will not be scaled)":O.isSelected?`Inheriting ${p}`:"Pending inclusion",U=O.stats,V=[];typeof U.valid_count=="number"&&Number.isFinite(U.valid_count)&&V.push(`${E(U.valid_count)} valid rows`),typeof U.mean=="number"&&Number.isFinite(U.mean)&&V.push(`Mean ${k(U.mean)}`),typeof U.median=="number"&&Number.isFinite(U.median)&&V.push(`Median ${k(U.median)}`),typeof U.stddev=="number"&&Number.isFinite(U.stddev)&&V.push(` ${k(U.stddev)}`),typeof U.iqr=="number"&&Number.isFinite(U.iqr)&&V.push(`IQR ${k(U.iqr)}`);const B=typeof U.minimum=="number"&&Number.isFinite(U.minimum),X=typeof U.maximum=="number"&&Number.isFinite(U.maximum);if(B||X){const F=B?k(U.minimum):"",K=X?k(U.maximum):"";V.push(`Range ${F}  ${K}`)}typeof U.skewness=="number"&&Number.isFinite(U.skewness)&&V.push(`Skew ${k(U.skewness)}`),typeof U.outlier_ratio=="number"&&Number.isFinite(U.outlier_ratio)&&U.outlier_ratio>0&&V.push(`${j(U.outlier_ratio*100)} outliers`);const H=V.length?V.join("  "):null;return a.jsxs("tr",{className:W.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",O.dtype]}),O.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),O.isSelected&&!O.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),O.isSkipped&&!O.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),O.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${D?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:O.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:O.confidenceLabel}),O.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:O.reasons.join("; ")})]})}),a.jsx("td",{children:H?a.jsx("span",{children:H}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:z,onChange:F=>L(O.column,F.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),l.map(F=>a.jsx("option",{value:F.value,children:F.label},`${O.column}-${F.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:R})]})})]},`scaling-row-${O.column}`)})})]})})})]})]})},Nm=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],IM="log",ka=e=>typeof e=="string"&&Nm.includes(e),jx=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",s=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const l=ka(s)?s:IM;return{column:n,method:l}}).filter(t=>!!t):[],ng=e=>{const t=new Set,n=[];return e.forEach(s=>{const l=`${s.column}__${s.method}`;t.has(l)||(t.add(l),n.push(s))}),n},Nx={left:"Left skew",right:"Right skew"},BM={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},UM=e=>{const t={...BM};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!s||!l||ka(s)&&(t[s]=l)}),t},qM=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:s,transformationMap:l})=>{const i=e==="recommended"?t.map(d=>d!=null&&d.column?d.column:null).filter(d=>!!d):n,c=new Set,u=[];return i.forEach(d=>{const p=typeof d=="string"?d.trim():"";if(!p||c.has(p))return;c.add(p);const h=s.get(p)??null,f=h?h.recommended_methods.filter(ka):[],g=f.length?f[0]:null,w=h!=null&&h.direction?Nx[h.direction]??h.direction:null,y=h!=null&&h.magnitude?`${h.magnitude.charAt(0).toUpperCase()}${h.magnitude.slice(1)}`:null,b=h&&typeof h.skewness=="number"&&Number.isFinite(h.skewness)?h.skewness:null,x=(h==null?void 0:h.summary)??null,N=l.get(p)??null;u.push({column:p,recommendedMethods:f,primaryMethod:g,directionLabel:w,magnitudeLabel:y,skewnessValue:b,summary:x,selectedMethod:N})}),u.sort((d,p)=>{const h=typeof d.skewnessValue=="number"?Math.abs(d.skewnessValue):-1/0,f=typeof p.skewnessValue=="number"?Math.abs(p.skewnessValue):-1/0;if(h!==f)return f-h;const g=!!d.primaryMethod,w=!!p.primaryMethod;return g!==w?g?-1:1:d.column.localeCompare(p.column)}),u},HM=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const s="no-recommendation",l=new Map;e.forEach(c=>{const u=c.primaryMethod??null,d=u??s,p=u?n(u):"No recommended action",h=l.get(d)??{key:d,label:p,method:u,rows:[]};h.rows.push(c),l.set(d,h)});const i=Array.from(l.values());return i.sort((c,u)=>{const d=g=>g?Nm.indexOf(g):Nm.length,p=d(c.method)-d(u.method);if(p!==0)return p;if(c.rows.length!==u.rows.length)return u.rows.length-c.rows.length;const h=c.label??"",f=u.label??"";return h.localeCompare(f)}),i},VM=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:s,skewnessError:l,skewnessViewMode:i,skewnessRecommendedCount:c,skewnessNumericCount:u,skewnessGroupByMethod:d,skewnessRows:p,skewnessTableGroups:h,hasSkewnessAutoRecommendations:f,skewnessTransformationsCount:g,isFetchingRecommendations:w,getSkewnessMethodLabel:y,getSkewnessMethodStatus:b,onApplyRecommendations:x,onViewModeChange:N,onGroupByToggle:E,onOverrideChange:k,onClearSelections:j})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:x,disabled:w||!f,children:"Apply recommendations"})})]}),s!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",s.toFixed(2)," are surfaced below."]}),n&&p.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&l&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l}),(!n||p.length>0)&&!l&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="recommended",onClick:()=>N("recommended"),disabled:!c,children:["Recommended (",c,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="all",onClick:()=>N("all"),disabled:!u,children:["All numeric (",u,")"]})]}),a.jsxs("label",{className:"canvas-skewness__toggle",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:S=>E(S.target.checked)}),"Group columns by recommended action"]})]}),p.length===0?a.jsx("p",{className:"canvas-modal__note",children:i==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:h.map(S=>a.jsxs("div",{className:"canvas-skewness__group",children:[S.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:S.label}),a.jsxs("span",{children:[S.rows.length," column",S.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:S.rows.map(M=>{const $=[];M.directionLabel&&$.push(M.directionLabel),M.skewnessValue!==null&&$.push(`(${M.skewnessValue.toFixed(2)})`),M.magnitudeLabel&&$.push(` ${M.magnitudeLabel}`);const T=$.length?$.join(" "):"",L=M.selectedMethod??"",P=new Set(M.recommendedMethods),O=[{value:"",label:"No transform",status:null,reason:null}];M.recommendedMethods.forEach(z=>{const R=b(M.column,z);O.push({value:z,label:`${y(z)}${z===M.primaryMethod?" (recommended)":""}`,status:R,reason:(R==null?void 0:R.reason)??null})}),Nm.forEach(z=>{if(P.has(z))return;const R=b(M.column,z);O.push({value:z,label:y(z),status:R,reason:(R==null?void 0:R.reason)??null})});const D=M.selectedMethod?b(M.column,M.selectedMethod):null,W=!M.selectedMethod&&M.primaryMethod?b(M.column,M.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${M.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:M.column}),M.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:M.summary})]})}),a.jsx("td",{children:M.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${M.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:M.primaryMethod?y(M.primaryMethod):y(M.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:T})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx("select",{value:L,onChange:z=>k(M.column,z.target.value),disabled:w||!t,children:O.map(z=>{var V;const R=z.reason?`${z.label} (caution: ${z.reason})`:z.label,U=((V=z.status)==null?void 0:V.status)??"ready";return a.jsx("option",{value:z.value,"data-status":U,children:R},`skewness-option-${M.column}-${z.value||"none"}`)})}),D&&D.status!=="ready"&&D.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",D.reason]}),!M.selectedMethod&&W&&W.status!=="ready"&&W.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",W.reason]})]})})]},`skewness-row-${M.column}`)})})]})})]},`skewness-group-${S.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:g?`${g} transformation${g===1?"":"s"} configured`:"No transformations configured yet."}),g>0&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:j,children:"Clear selections"})]})]})]}),WM=({counts:e,binEdges:t,className:n})=>{const s=v.useId(),l=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:l,"aria-hidden":"true"});const i=e.reduce((d,p)=>Math.max(d,p),0),c=i>0?i:1,u=100/e.length;return a.jsx("div",{className:l,role:"img","aria-label":"Histogram sparkline",children:a.jsxs("svg",{viewBox:"0 0 100 60",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((d,p)=>{const h=d/c*52,f=p*u,g=58-h,w=Math.max(u-2,1);return a.jsx("rect",{x:f+1,y:g,width:w,height:h,rx:1.2,ry:1.2,fill:`url(#${s})`},`hist-bin-${p}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},KM=({skewnessThreshold:e,isFetchingSkewness:t,skewnessError:n,skewnessDistributionCards:s,skewnessDistributionView:l,setSkewnessDistributionView:i,onRefresh:c,canRefresh:u})=>{const d=(p,h,f)=>{const g=Math.max(0,p.sample_size||0),w=Math.max(0,p.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:h}),f?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:f}):null]}),a.jsx(WM,{counts:p.counts,binEdges:p.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Gs(p.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Gs(p.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Gs(p.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Gs(p.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Gs(p.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:g.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:w.toLocaleString()})]})]})]},h)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="before",onClick:()=>i("before"),disabled:!s.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="after",onClick:()=>i("after"),disabled:!s.length,children:"After"})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:c,disabled:t||!u,children:t?"Refreshing":"Refresh"})]})]}),e!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",e.toFixed(2)," are visualized below."]}),t&&s.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!t&&n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n}),(!t||s.length>0)&&!n&&(s.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:s.map(p=>{const h=p.distributionAfter,f=l==="before",g=l==="after"&&!!h,w=l==="after"&&!h,y=l==="before"?"Showing the original distribution returned by the skewness analysis.":h?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${p.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:p.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[p.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.directionLabel}),p.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.magnitudeLabel}),p.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",p.recommendedLabel]}),p.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",p.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:p.skewness!==null?gr(p.skewness,2):""})]})]}),p.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:p.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[f?d(p.distributionBefore,"Before transform"):null,g&&h?d(h,"After transform",p.appliedLabel):null,w?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",y]})]},`skewness-dist-${p.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]})},YM="_was_missing",GM=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const s=typeof t=="string"?t.trim():"";return s||YM},QM=(e,t)=>{const n=typeof e=="string"?e.trim():"",s=typeof t=="string"?t:"";return!n||!s?!1:n.endsWith(s)},XM=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:s})=>{const l=typeof s=="string"?s:"",i=Ze(t),c=new Set(i),u=Array.from(new Set(Ze(e))),d=[];if(u.forEach(f=>{const g=`${f}${l}`,w=n[f],y=typeof w=="number"&&Number.isFinite(w)?Math.max(0,w):null;d.push({column:f,missingPercentage:y,flagColumn:g,conflicts:{alreadyExists:c.has(g),duplicateFlag:!1}})}),d.length>0){const f=new Map;d.forEach(g=>{f.set(g.flagColumn,(f.get(g.flagColumn)??0)+1)}),d.forEach(g=>{g.conflicts.duplicateFlag=(f.get(g.flagColumn)??0)>1})}d.sort((f,g)=>{const w=f.missingPercentage,y=g.missingPercentage,b=typeof w=="number",x=typeof y=="number";return b&&x&&w!==y?y-w:b!==x?b?-1:1:f.column.localeCompare(g.column)});const p=l?Array.from(new Set(i.filter(f=>QM(f,l)))):[],h=d.reduce((f,g)=>g.conflicts.alreadyExists||g.conflicts.duplicateFlag?f+1:f,0);return{rows:d,flaggedColumnsInDataset:p,conflictCount:h}},JM=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:s,flaggedColumnsInDataset:l,conflictCount:i}=t,c=s.length>0,u=e||"(no suffix)",d=l.slice(0,4),p=Math.max(l.length-d.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:s.length})," flag column",s.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:u}),"."]}),l.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",l.length," existing flag column",l.length===1?"":"s"," ","with this suffix",d.length>0?` (examples: ${d.join(", ")}${p>0?", ":""})`:"","."]}),i>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i," generated flag column",i===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),c?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:s.map(h=>{const f=[];h.conflicts.alreadyExists&&f.push("Already exists"),h.conflicts.duplicateFlag&&f.push("Duplicate name");const g=f.length>0,w=g?f.join("  "):"Ready",y=g?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",b=g?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:b,children:[a.jsx("th",{scope:"row",children:h.column}),a.jsx("td",{children:n(h.missingPercentage)}),a.jsx("td",{children:h.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:y,children:w})})]},`missing-indicator-${h.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},Cx=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],sg="canonicalize_country_codes",ZM=new Set(Cx),eA=["string","object","text","category","mixed","varchar","char"],tA=4,nA=6,hl=4,sA=3,Sx=36,rA=5,rg={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},Ex=Cx.map(e=>{var t;return{value:e,label:((t=rg[e])==null?void 0:t.label)??e}}),aA=new Set(["true","1","yes","y","on"]),oA=new Set(["false","0","no","n","off"]),lA=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(aA.has(n))return!0;if(oA.has(n))return!1}return t},ag=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?ag(e.split(",")):[],kx=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,s=ag(n.columns),l=lA(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),i=Sm(typeof n.mode=="string"?n.mode:void 0,t.mode);return!s.length&&!l?null:{mode:i,columns:s,autoDetect:l}},Mx=(e,t)=>{const n={mode:t.mode,columns:ag(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const l=kx(e,n);return l?[l]:[n]}const s=[];return e.forEach(l=>{const i=kx(l,n);i&&s.push(i)}),s.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):s},iA=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),cA=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),Cm=e=>e.length<=Sx?e:`${e.slice(0,Sx-1)}...`,Ax=e=>ZM.has(e),Ox=e=>{if(!e)return!1;const t=e.toLowerCase();return eA.some(n=>t.includes(n))},Sm=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Ax(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Ax(s)?s:sg},uA=e=>{const t=rg[e]??rg[sg];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},dA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:s})=>{const l=Array.from(new Set(Ze(e))),i=new Set(l),c=t.filter(h=>Ox(n[h]??null)),u=c.filter(h=>!i.has(h)),d=l.filter(h=>!Ox(n[h]??null)),p=typeof s=="boolean"?s:l.length===0;return{selectedColumns:l,nonTextSelected:d,autoDetectionActive:p,recommendedColumns:u,textColumnCount:c.length,textColumns:c}},mA=/[\n;,]+/,ji=(e,t)=>e.slice(0,t),Em=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[s,...l]=n,i=l.join(t);return[s,i]},hA=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],s=[],l=new Map;let i=0;const c=(h,f)=>{const g=String(h??"").trim(),w=String(f??"").trim();if(!g||!w){(g||w)&&n.push(`${g} => ${w}`.trim());return}const y=cA(g);if(!y){n.push(`${g} => ${w}`);return}l.has(y)?t.add(g):(l.set(y,w),s.length<tA&&s.push(`${g} => ${w}`)),i+=1};if(typeof e=="string"){e.split(mA).forEach(y=>{const b=y.trim();if(b){if(b.includes("=>")){const x=Em(b,"=>");x?c(x[0],x[1]):n.push(b);return}if(b.includes(":")){const x=Em(b,":");x?c(x[0],x[1]):n.push(b);return}n.push(b)}});const f=Array.from(t),g=ji(f,hl),w=ji(n,hl);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:g,duplicateOverflow:Math.max(f.length-g.length,0),invalidEntries:w,invalidOverflow:Math.max(n.length-w.length,0)}}if(Array.isArray(e)){e.forEach(w=>{if(w){if(typeof w=="string"){const y=w.trim();if(!y)return;if(y.includes("=>")){const b=Em(y,"=>");b?c(b[0],b[1]):n.push(y)}else if(y.includes(":")){const b=Em(y,":");b?c(b[0],b[1]):n.push(y)}else n.push(y);return}if(typeof w=="object"){const{alias:y,replacement:b}=w;c(y,b);return}n.push(String(w))}});const h=Array.from(t),f=ji(h,hl),g=ji(n,hl);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:f,duplicateOverflow:Math.max(h.length-f.length,0),invalidEntries:g,invalidOverflow:Math.max(n.length-g.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([h,f])=>{c(h,f)});const u=Array.from(t),d=ji(u,hl),p=ji(n,hl);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:d,duplicateOverflow:Math.max(u.length-d.length,0),invalidEntries:p,invalidOverflow:Math.max(n.length-p.length,0)}},fA=e=>{const t=e.slice(0,nA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},pA=e=>{const t=e.slice(0,hl);return{preview:t,remaining:Math.max(e.length-t.length,0)}},gA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Cm(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?Cm(t):null}try{const t=JSON.stringify(e);return t?Cm(t):null}catch{return Cm(String(e))}},_A=(e,t=sA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;const u=gA(i);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},vA=(e,t,n=rA)=>{if(!t.length)return[];const s=[];for(const l of t){if(s.length>=n)break;const i=e[l];!i||!i.length||s.push({column:l,values:i,overflow:0})}return s},og=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),Px=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],Tx=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);Px.forEach(e=>{e.forEach(t=>Tx.add(og(t)))});const $x=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],Lx=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);$x.forEach(e=>{e.forEach(t=>Lx.add(og(t)))});const yA=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],bA=/^[A-Za-z]{2,3}$/,xA=/[^0-9A-Za-z\s]/,wA=/[^0-9A-Za-z]+/,km={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:Px},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:$x},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:yA},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},jA=e=>{const t=[];return e.forEach(n=>{n.split(wA).filter(Boolean).forEach(l=>{t.push(l)})}),t},NA=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(s=>xA.test(s));const n=jA(t).map(s=>og(s));return n.length?e==="canonicalize_country_codes"?n.some(s=>Tx.has(s))||t.some(s=>bA.test(s.trim())):e==="normalize_boolean"?n.some(s=>Lx.has(s)):!1:!1},zx=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},CA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:l,sampleMap:i,modeOptions:c=Ex,customPairSummary:u,customPairsParameter:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onModeChange:w,onAutoDetectToggle:y,onColumnToggle:b,onColumnsChange:x,renderParameterField:N})=>{const E=n.length>0,k=s.selectedColumns.length,j=v.useMemo(()=>fA(s.recommendedColumns),[s.recommendedColumns]),S=v.useMemo(()=>pA(s.nonTextSelected),[s.nonTextSelected]),M=v.useMemo(()=>vA(i,s.selectedColumns),[s.selectedColumns,i]),$=!e||!t,T=u.duplicates.length+u.duplicateOverflow,L=u.invalidEntries.length+u.invalidOverflow,P=u.duplicates.join(", "),O=u.invalidEntries.join(", "),D=v.useMemo(()=>n.some(G=>G.mode==="custom"),[n]),W=v.useMemo(()=>{const G=new Map;return n.forEach(q=>{q.columns.forEach(Y=>{const Q=Y.trim();Q&&G.set(Q,(G.get(Q)??0)+1)})}),G},[n]),[z,R]=v.useState(()=>new Set),U=v.useCallback(G=>{R(q=>{const Y=new Set(q);return Y.has(G)?Y.delete(G):Y.add(G),Y})},[]);v.useEffect(()=>{R(G=>{const q=new Set;return G.forEach(Y=>{Y<n.length&&q.add(Y)}),q.size===G.size?G:q})},[n.length]);const[V,B]=v.useState(()=>({index:null,mode:null})),X=v.useMemo(()=>{const G=new Map;return l.forEach(q=>{const Y=Array.isArray(q.samples)?q.samples:[],Q=Array.isArray(i[q.name])?i[q.name]:[],ee=[...Y,...Q].map(J=>String(J??"").trim()).filter(J=>J.length>0);G.set(q.name,ee.slice(0,12))}),G},[l,i]),H=v.useMemo(()=>{const G=new Map;return l.forEach(q=>{const Y=X.get(q.name)??[],Q=Y.length?Y:[q.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(ee=>{NA(ee,Q)&&(G.has(ee)||G.set(ee,new Set),G.get(ee).add(q.name))})}),G},[l,X]);v.useEffect(()=>{if(V.index===null)return;const G=n[V.index];(!G||G.mode!==V.mode)&&B({index:null,mode:null})},[V.index,V.mode,n]);const F=v.useCallback((G,q)=>{B({index:G,mode:q})},[]),K=v.useCallback(()=>{B({index:null,mode:null})},[]);let re=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),s.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:k})," column",k===1?"":"s"," across all strategies."]}),M.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",M.map(G=>`${G.column} (${G.values.join(", ")})`).join("; "),"."]}),s.textColumnCount>0&&j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.preview.join(", ")," ",S.preview.length===1?"is":"are"," not text-like.",S.remaining>0?` ${S.remaining} more column${S.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),$?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!E&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),E&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((G,q)=>{var Ve;const Y=uA(G.mode),Q=((Ve=c.find(ce=>ce.value===G.mode))==null?void 0:Ve.label)??Y.label,ee=G.columns.length,J=ee?`${ee} column${ee===1?"":"s"}`:G.autoDetect?"Auto-detecting columns":"No columns yet",se=p.has(q),ke=z.has(q),Pe=G.columns.join(", "),De=H.get(G.mode)??new Set,Be=G.mode==="custom"&&!!d&&!re,mt=G.mode==="custom"&&!!d&&re;Be&&(re=!0);const Ge=l.map(ce=>{const Fe=G.columns.includes(ce.name),et=De.has(ce.name),it=Fe?0:et?1:ce.isRecommended?2:ce.isTextLike?3:4;return{option:ce,priority:it}}).sort((ce,Fe)=>ce.priority!==Fe.priority?ce.priority-Fe.priority:ce.option.name.localeCompare(Fe.option.name)).map(ce=>ce.option),ue=De.size>0,ye=Ge.filter(ce=>G.columns.includes(ce.name)?!0:ue?De.has(ce.name):ce.isRecommended||ce.isTextLike),Me=new Set(ye.map(ce=>ce.name)),Le=Ge.filter(ce=>!Me.has(ce.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(q),"aria-expanded":!se,"aria-controls":`alias-strategy-body-${q}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${se?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",q+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[Q,G.autoDetect?"  auto-detect":"",J?`  ${J}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(q),"aria-label":`Remove alias strategy ${q+1}`,children:"Remove"})]}),!se&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${q}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[c.map(ce=>{const Fe=ce.value===G.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${Fe?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":Fe,onClick:()=>w(q,ce.value),children:ce.label},ce.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>F(q,G.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:Y.guidance})]}),V.index===q&&V.mode===G.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:km[G.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:K,children:"Close"})]}),a.jsx("p",{children:km[G.mode].description}),km[G.mode].preview&&a.jsx("ul",{children:km[G.mode].preview.map(([ce,Fe])=>a.jsxs("li",{children:[ce," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",Fe]},`${ce}-${Fe}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${q}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${q}-auto-detect`,type:"checkbox",checked:G.autoDetect,onChange:ce=>y(q,ce.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${q}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),l.length?a.jsxs(a.Fragment,{children:[De.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",Q.toLowerCase()," entries."]}),ye.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${q+1}`,children:ye.map(ce=>{const Fe=G.columns.includes(ce.name),et=zx(ce.samples.length?ce.samples:i[ce.name]??[]),at=(W.get(ce.name)??0)-(Fe?1:0)>0,xt=De.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Fe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>b(q,ce.name),"aria-pressed":Fe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),ce.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),xt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),at&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),et&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",et]})]},ce.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),Le.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>U(q),"aria-expanded":ke,"aria-controls":`alias-strategy-${q}-other-columns`,children:ke?"Hide other columns":`Show other columns (${Le.length})`}),ke&&a.jsx("div",{id:`alias-strategy-${q}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${q+1}`,children:Le.map(ce=>{const Fe=G.columns.includes(ce.name),et=zx(ce.samples.length?ce.samples:i[ce.name]??[]),at=(W.get(ce.name)??0)-(Fe?1:0)>0,xt=De.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Fe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>b(q,ce.name),"aria-pressed":Fe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),xt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),at&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),et&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",et]})]},ce.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${G.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:G.columns.length?G.columns.map(ce=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:ce},ce)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${q}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${q}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:Pe,onChange:ce=>x(q,ce.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),G.mode==="custom"&&d&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Be?N(d):mt?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${q}`)})}),u.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[u.totalPairs," custom pair",u.totalPairs===1?"":"s"," captured.",D?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",u.previewPairs.length>0?` Examples: ${u.previewPairs.join("; ")}${u.previewOverflow>0?"...":""}`:""]}),u.totalPairs===0&&D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),T>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",P?`: ${P}`:"",u.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),L>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",L," incomplete pair",L===1?"":"s",".",O?` Examples: ${O}${u.invalidOverflow>0?"...":""}`:""]})]})},Mm=["iso_date","iso_datetime","month_day_year","day_month_year"],SA="iso_date",EA=["date","time","timestamp","datetime"],kA=3,Dx=36,tu={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},lg=Mm.map(e=>({value:e,label:tu[e].label,guidance:tu[e].guidance,example:tu[e].example})),MA=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],Rx=e=>e.length<=Dx?e:`${e.slice(0,Dx-1)}...`,Fx=e=>{if(!e)return!1;const t=e.toLowerCase();return EA.some(n=>t.includes(n))},AA=e=>MA.some(t=>t.test(e)),Ix=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Mm.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Mm.includes(s)?s:SA},OA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s||!s.length)return;const l=s.length;let i=0;if(s.forEach(u=>{AA(u)&&(i+=1)}),!l)return;i/l>=.6&&i>=2&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},PA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ze(e)));l.sort((g,w)=>g.localeCompare(w));const i=new Set(l),c=t.filter(g=>Fx(n[g]??null)),u=OA(s),d=new Set;c.forEach(g=>{i.has(g)||d.add(g)}),u.forEach(g=>{i.has(g)||d.add(g)});const p=Array.from(d);p.sort((g,w)=>g.localeCompare(w));const h=l.filter(g=>!(Fx(n[g]??null)||u.includes(g))),f=u.slice().sort((g,w)=>g.localeCompare(w));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:p,nonDateSelected:h,dateColumnCount:c.length,sampleCandidateCount:u.length,sampleCandidates:f}},TA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&Mm.includes(n)?n:t},$A=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},Bx=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,s=e.map(l=>{if(!l||typeof l!="object")return null;const i=Ze(l.columns),c=Array.from(new Set(i.map(h=>h.trim()).filter(Boolean))).sort((h,f)=>h.localeCompare(f)),u=TA(l.mode,t.mode),d=$A(l.auto_detect??l.autoDetect??l.auto),p=`${u}|${c.join(",")}|${d?"auto":"manual"}`;return n.has(p)?null:(n.add(p),{mode:u,columns:c,autoDetect:d})}).filter(l=>!!l);return s.length?s:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},LA=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),zA=e=>{var t;return((t=tu[e])==null?void 0:t.label)??tu.iso_date.label},DA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Rx(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?Rx(t):null},RA=(e,t=kA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;const u=DA(i);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},FA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},Ux=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},IA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:l,sampleMap:i,collapsedStrategies:c,onToggleStrategy:u,onRemoveStrategy:d,onAddStrategy:p,onModeChange:h,onColumnToggle:f,onColumnsChange:g,onAutoDetectToggle:w,modeOptions:y=lg})=>{const b=n.length>0,x=v.useMemo(()=>n.some(T=>T.autoDetect),[n]),[N,E]=v.useState(()=>new Set),k=v.useCallback(T=>{E(L=>{const P=new Set(L);return P.has(T)?P.delete(T):P.add(T),P})},[]);v.useEffect(()=>{E(T=>{const L=new Set;return T.forEach(P=>{P<n.length&&L.add(P)}),L.size===T.size?T:L})},[n.length]);const j=v.useMemo(()=>{const T=new Map;return n.forEach(L=>{L.columns.forEach(P=>{const O=P.trim();O&&T.set(O,(T.get(O)??0)+1)})}),T},[n]),S=v.useMemo(()=>{const T=s.recommendedColumns.slice(0,6),L=Math.max(s.recommendedColumns.length-T.length,0);return{preview:T,remaining:L}},[s.recommendedColumns]),M=v.useMemo(()=>{const T=s.nonDateSelected.slice(0,4),L=Math.max(s.nonDateSelected.length-T.length,0);return{preview:T,remaining:L}},[s.nonDateSelected]),$=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:p,children:"Add strategy"})})]}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",S.preview.join(", "),S.remaining>0?`,  (${S.remaining} more)`:"",".",x?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),s.sampleCandidates.length===0&&!S.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[M.preview.join(", ")," ",M.preview.length===1?"looks":"look"," non-date-like.",M.remaining>0?` ${M.remaining} more selected column${M.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),x&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",s.sampleCandidateCount||s.dateColumnCount," date-like columns that are not already assigned."]}),b?a.jsx("div",{className:"canvas-imputer__list",children:n.map((T,L)=>{var K,re;const P=((K=y.find(G=>G.value===T.mode))==null?void 0:K.label)??zA(T.mode),O=T.columns.length,D=O?`${O} column${O===1?"":"s"}`:T.autoDetect?"Auto-detecting columns":"No columns yet",W=c.has(L),z=T.columns.join(", "),R=`date-strategy-${L}-toggle`,U=`date-strategy-${L}-auto-detect`,V=l.map(G=>({option:G,priority:G.isRecommended?0:G.isSampleCandidate?1:2})).sort((G,q)=>G.priority!==q.priority?G.priority-q.priority:G.option.name.localeCompare(q.option.name)).map(G=>G.option),B=V.filter(G=>T.columns.includes(G.name)?!0:G.isRecommended||G.isSampleCandidate),X=new Set(B.map(G=>G.name)),H=V.filter(G=>!X.has(G.name)),F=N.has(L);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:R,className:"canvas-imputer__card-toggle",onClick:()=>u(L),"aria-expanded":!W,"aria-controls":`date-strategy-body-${L}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${W?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",L+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[P,T.autoDetect?"  auto-detect":"",D?`  ${D}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(L),"aria-label":`Remove date formatting strategy ${L+1}`,children:"Remove"})]}),!W&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${L}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${L}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${L}-mode`,value:T.mode,onChange:G=>h(L,G.target.value),children:y.map(G=>a.jsx("option",{value:G.value,children:G.label},G.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((re=y.find(G=>G.value===T.mode))==null?void 0:re.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:U,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:U,type:"checkbox",checked:T.autoDetect,onChange:G=>w(L,G.target.checked)}),a.jsx("label",{htmlFor:U,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),V.length?a.jsxs(a.Fragment,{children:[B.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:B.map(G=>{const q=T.columns.includes(G.name),Y=Ux(G.samples.length?G.samples:i[G.name]??[]),ee=(j.get(G.name)??0)-(q?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${q?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(L,G.name),"aria-pressed":q,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:G.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[G.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:G.dtype}),G.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!G.isRecommended&&G.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),ee&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Y&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Y]})]},G.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),H.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>k(L),"aria-expanded":F,"aria-controls":`date-strategy-${L}-other-columns`,children:F?"Hide other columns":`Show other columns (${H.length})`}),F&&a.jsx("div",{id:`date-strategy-${L}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:H.map(G=>{const q=T.columns.includes(G.name),Y=Ux(G.samples.length?G.samples:i[G.name]??[]),ee=(j.get(G.name)??0)-(q?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${q?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(L,G.name),"aria-pressed":q,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:G.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[G.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:G.dtype}),ee&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Y&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Y]})]},G.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${T.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:T.columns.length?T.columns.map(G=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:G},G)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${L}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${L}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:z,onChange:G=>g(L,G.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${L}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},qx=["both","leading","trailing"],Hx="both",BA=["string","object","text","category","mixed","varchar","char"],UA=3,Vx=36,Wx=6,qA=4,HA=5,Kx={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},VA=e=>e.length<=Vx?e:`${e.slice(0,Vx-1)}...`,Yx=e=>{if(!e)return!1;const t=e.toLowerCase();return BA.some(n=>t.includes(n))},WA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${VA(t)}'`},KA=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,YA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&qx.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&qx.includes(s)?s:Hx},GA=e=>{const t=Kx[e]??Kx[Hx];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},QA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s.length)return;const l=s.reduce((c,u)=>u.hasIssue?c+1:c,0);if(!l)return;const i=l/s.length;(l>=2||i>=.5)&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},XA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ze(e)));l.sort((f,g)=>f.localeCompare(g));const i=new Set(l),c=t.filter(f=>Yx(n[f]??null)),u=QA(s),d=new Set;c.forEach(f=>{i.has(f)||d.add(f)}),u.forEach(f=>{i.has(f)||d.add(f)});const p=Array.from(d).sort((f,g)=>f.localeCompare(g)),h=l.filter(f=>!Yx(n[f]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:p,nonTextSelected:h,textColumnCount:c.length,whitespaceCandidateCount:u.length,whitespaceCandidates:u}},ig=(e,t)=>e.slice(0,t),JA=e=>{const t=ig(e,Wx);return{preview:t,remaining:Math.max(e.length-t.length,0)}},ZA=e=>{const t=ig(e,qA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},eO=e=>{const t=ig(e,Wx);return{preview:t,remaining:Math.max(e.length-t.length,0)}},tO=(e,t=UA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=KA(u),p=WA(u),h=n[c]??[];h.find(f=>f.value===p)||h.length>=t||(n[c]=[...h,{value:p,hasIssue:d}])})}),n},nO=(e,t,n=HA)=>{if(!t.length)return[];const s=[];for(const l of t){if(s.length>=n)break;const i=e[l];!i||!i.length||s.push({column:l,values:i.map(c=>c.value),overflow:0})}return s},sO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},rO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:l,renderParameterField:i,columnSummary:c,modeDetails:u,sampleMap:d})=>{if(!n&&!s)return null;const p=c.selectedColumns.length,h=JA(c.recommendedColumns),f=ZA(c.nonTextSelected),g=eO(c.whitespaceCandidates),w=nO(d,c.selectedColumns),y=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for trimming."]}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",w.map(b=>`${b.column} (${b.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),h.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",h.preview.join(", "),h.remaining>0?`, ... (${h.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[f.preview.join(", ")," ",f.preview.length===1?"is":"are"," not text-like.",f.remaining>0?` ${f.remaining} more column${f.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),y?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),l(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},Gx=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],Qx="keep_alphanumeric",aO=["string","object","text","category","mixed","varchar","char"],oO=3,Xx=36,lO=6,iO=4,cO=5,Jx={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},uO=e=>e.length<=Xx?e:`${e.slice(0,Xx-1)}...`,dO=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${uO(t)}'`},Zx=e=>{if(!e)return!1;const t=e.toLowerCase();return aO.some(n=>t.includes(n))},mO=e=>/[^0-9A-Za-z\s]/.test(e),hO=e=>/[A-Za-z]/.test(e),fO=e=>/[0-9]/.test(e),pO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Gx.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Gx.includes(s)?s:Qx},gO=e=>{const t=Jx[e]??Jx[Qx];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},_O=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([u,d])=>{if(!d.length)return;let p=0,h=0,f=0;d.forEach(g=>{g.hasSpecial&&(p+=1),g.hasDigits&&(h+=1),g.hasLetters&&(f+=1)}),p>0&&t.add(u),h>0&&f===0&&n.add(u),f>0&&h===0&&s.add(u)});const l=Array.from(t).sort((u,d)=>u.localeCompare(d)),i=Array.from(n).sort((u,d)=>u.localeCompare(d)),c=Array.from(s).sort((u,d)=>u.localeCompare(d));return{specialCandidates:l,digitsOnlyCandidates:i,lettersOnlyCandidates:c}},vO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ze(e)));l.sort((w,y)=>w.localeCompare(y));const i=new Set(l),c=t.filter(w=>Zx(n[w]??null)),{specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}=_O(s),h=new Set;c.forEach(w=>{i.has(w)||h.add(w)}),u.forEach(w=>{i.has(w)||h.add(w)});const f=Array.from(h).sort((w,y)=>w.localeCompare(y)),g=l.filter(w=>!Zx(n[w]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,specialCandidateCount:u.length,specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}},e0=(e,t)=>e.slice(0,t),yO=e=>{const t=e0(e,lO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Am=e=>{const t=e0(e,iO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},bO=(e,t=oO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=dO(u),p=mO(u),h={value:d,hasSpecial:p,hasDigits:fO(u),hasLetters:hO(u)},f=n[c]??[];f.find(g=>g.value===d)||f.length>=t||(n[c]=[...f,h])})}),n},xO=(e,t,n=cO)=>{if(!t.length)return[];const s=[];for(const l of t){if(s.length>=n)break;const i=e[l];!i||!i.length||s.push({column:l,values:i.map(c=>c.value),overflow:0})}return s},wO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},jO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,replacementParameter:l,renderMultiSelectField:i,renderParameterField:c,columnSummary:u,modeDetails:d,sampleMap:p})=>{if(!n&&!s&&!l)return null;const h=u.selectedColumns.length,f=yO(u.recommendedColumns),g=Am(u.specialCandidates),w=Am(u.digitsOnlyCandidates),y=Am(u.lettersOnlyCandidates),b=Am(u.nonTextSelected),x=xO(p,u.selectedColumns),N=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for cleanup."]}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",x.map(E=>`${E.column} (${E.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"",". Consider `digits only` mode."]}),y.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",y.preview.join(", "),y.remaining>0?`, ... (${y.remaining} more)`:"",". Consider `letters only` mode."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[b.preview.join(", ")," ",b.preview.length===1?"is":"are"," not text-like.",b.remaining>0?` ${b.remaining} more column${b.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),N?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),i(n)]}),(s||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?c(s):null,l?c(l):null]})]})},t0=["lower","upper","title","sentence"],n0="lower",NO=["string","object","text","category","mixed","varchar","char"],CO=3,s0=60,SO=6,EO=4,kO=5,r0={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},MO=e=>e.length<=s0?e:`${e.slice(0,s0-1)}...`,a0=e=>{if(!e)return!1;const t=e.toLowerCase();return NO.some(n=>t.includes(n))},nu=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${MO(t)}'`},AO=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),OO=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),PO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&t0.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&t0.includes(s)?s:n0},TO=e=>{const t=r0[e]??r0[n0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},$O=(e,t)=>{const n=[];return Object.entries(e).forEach(([s,l])=>{if(!l.length)return;l.some(c=>{const u=c[t];return c.original!==u})&&n.push(s)}),n.sort((s,l)=>s.localeCompare(l)),n},LO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s,mode:l})=>{const i=Array.from(new Set(Ze(e)));i.sort((g,w)=>g.localeCompare(w));const c=new Set(i),u=t.filter(g=>a0(n[g]??null)),d=$O(s,l),p=new Set;u.forEach(g=>{c.has(g)||p.add(g)}),d.forEach(g=>{c.has(g)||p.add(g)});const h=Array.from(p).sort((g,w)=>g.localeCompare(w)),f=i.filter(g=>!a0(n[g]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:h,nonTextSelected:f,textColumnCount:u.length,inconsistentColumns:d}},o0=(e,t)=>e.slice(0,t),zO=e=>{const t=o0(e,SO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},l0=e=>{const t=o0(e,EO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},DO=(e,t=CO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=nu(u),p={original:d,lower:nu(u.toLowerCase()),upper:nu(u.toUpperCase()),title:nu(AO(u)),sentence:nu(OO(u))},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},RO=(e,t,n,s=kO)=>{if(!t.length)return[];const l=[];for(const i of t){if(l.length>=s)break;const c=e[i];if(!c||!c.length)continue;const u=c.map(d=>`${d.original}  ${d[n]}`);l.push({column:i,values:u,overflow:0})}return l},FO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},IO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:l,renderParameterField:i,columnSummary:c,modeDetails:u,sampleMap:d,selectedMode:p})=>{if(!n&&!s)return null;const h=c.selectedColumns.length,f=zO(c.recommendedColumns),g=l0(c.inconsistentColumns),w=l0(c.nonTextSelected),y=RO(d,c.selectedColumns,p),b=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for case normalization."]}),y.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",y.map(x=>`${x.column} (${x.values.join("; ")})`).join(" | "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[w.preview.join(", ")," ",w.preview.length===1?"is":"are"," not text-like.",w.remaining>0?` ${w.remaining} more column${w.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),b?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),l(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},i0=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],c0="preset_digits_only",BO=["string","object","text","category","mixed","varchar","char"],UO=3,u0=60,qO=6,HO=4,VO=5,d0={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},WO=e=>e.length<=u0?e:`${e.slice(0,u0-1)}...`,su=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${WO(t)}'`},m0=e=>{if(!e)return!1;const t=e.toLowerCase();return BO.some(n=>t.includes(n))},KO=e=>e.replace(/\s+/g," ").trim(),YO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&i0.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&i0.includes(s)?s:c0},GO=e=>{const t=d0[e]??d0[c0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},QO=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([i,c])=>{c.length&&c.forEach(u=>{u.hasDigits&&t.add(i),u.hasLetters&&n.add(i),u.hasWhitespaceRuns&&s.add(i)})});const l=i=>Array.from(i).sort((c,u)=>c.localeCompare(u));return{digits:l(t),letters:l(n),whitespace:l(s)}},XO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ze(e)));l.sort((w,y)=>w.localeCompare(y));const i=new Set(l),c=t.filter(w=>m0(n[w]??null)),{digits:u,letters:d,whitespace:p}=QO(s),h=new Set;c.forEach(w=>{i.has(w)||h.add(w)}),[...u,...d,...p].forEach(w=>{i.has(w)||h.add(w)});const f=Array.from(h).sort((w,y)=>w.localeCompare(y)),g=l.filter(w=>!m0(n[w]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,digitsCandidates:u,lettersCandidates:d,whitespaceCandidates:p}},h0=(e,t)=>e.slice(0,t),JO=e=>{const t=h0(e,qO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Om=e=>{const t=h0(e,HO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},ZO=(e,t=UO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=su(u),p={original:d,presetDigits:su(u.replace(/\D+/g,"")),presetLetters:su(u.replace(/[^A-Za-z]+/g,"")),presetWhitespace:su(KO(u)),hasDigits:/\d/.test(u),hasLetters:/[A-Za-z]/.test(u),hasWhitespaceRuns:/\s{2,}/.test(u)||/\t|\n|\r/.test(u)},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},eP=(e,t,n)=>{const s=n??"",l=i=>i.length?i:"''";switch(t){case"preset_letters_only":return`${l(e.original)}  ${l(e.presetLetters)}`;case"preset_whitespace_collapse":return`${l(e.original)}  ${l(e.presetWhitespace)}`;case"custom":try{const i=new RegExp(s.split("|||")[0]??"",s.split("|||")[1]??""),c=su(e.original.replace(i,s.split("|||")[2]??""));return`${l(e.original)}  ${l(c)}`}catch{return`${l(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${l(e.original)}  ${l(e.presetDigits)}`}},tP=(e,t,n,s,l=VO)=>{if(!t.length)return[];const i=[];for(const c of t){if(i.length>=l)break;const u=e[c];if(!u||!u.length)continue;const d=u.map(p=>eP(p,n,s));i.push({column:c,values:d,overflow:0})}return i},nP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},sP=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",s=t[1]??"",l=t[2]??"";return!n.trim()&&!l.trim()?null:`Pattern: /${n||"(empty)"}/${s||"(none)"} Replacement: ${l||"''"}`},rP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,patternParameter:l,replacementParameter:i,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,replacementValue:g})=>{if(!n&&!s&&!l&&!i)return null;const w=d.selectedColumns.length,y=JO(d.recommendedColumns),b=Om(d.digitsCandidates),x=Om(d.lettersCandidates),N=Om(d.whitespaceCandidates),E=Om(d.nonTextSelected),k=sP(g),j=tP(h,d.selectedColumns,f,g),S=!e||!t,M=f==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," mode. ",p.guidance," Example: ",p.example,"."]}),k&&a.jsx("p",{className:"canvas-modal__note",children:k}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:w})," column",w===1?"":"s"," for regex cleanup."]}),j.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",j.map($=>`${$.column} (${$.values.join("; ")})`).join(" | "),"."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",b.preview.join(", "),b.remaining>0?`, ... (${b.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),y.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",y.preview.join(", "),y.remaining>0?`, ... (${y.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"is":"are"," not text-like.",E.remaining>0?` ${E.remaining} more column${E.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),M&&!k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),S?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||l||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,l?u(l):null,i?u(i):null]})]})},f0=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],p0="negative_to_nan",aP=["int","float","double","numeric","number","decimal","real","long"],oP=3,lP=6,iP=4,cP=5,g0={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},uP=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},dP=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},mP=e=>{if(!e)return!1;const t=e.toLowerCase();return aP.some(n=>t.includes(n))},hP=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&f0.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&f0.includes(s)?s:p0},fP=e=>{const t=g0[e]??g0[p0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},pP=e=>{const t=new Set,n=new Set,s=new Set,l=new Set;Object.entries(e).forEach(([c,u])=>{u.forEach(d=>{d.isNegative&&t.add(c),d.isZero&&n.add(c),(d.numericValue<0||d.numericValue>100)&&s.add(c),(d.numericValue<0||d.numericValue>120)&&l.add(c)})});const i=c=>Array.from(c).sort((u,d)=>u.localeCompare(d));return{negative:i(t),zeros:i(n),percentage:i(s),age:i(l)}},gP=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ze(e))).sort((y,b)=>y.localeCompare(b)),i=new Set(l),c=t.filter(y=>mP(n[y]??null)),u=new Set(c),{negative:d,zeros:p,percentage:h,age:f}=pP(s),g=new Set;c.forEach(y=>{i.has(y)||g.add(y)}),[...d,...p,...h,...f].forEach(y=>{i.has(y)||g.add(y)});const w=l.filter(y=>!u.has(y));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:Array.from(g).sort((y,b)=>y.localeCompare(b)),nonNumericSelected:w,numericColumnCount:c.length,negativeCandidates:d,zeroCandidates:p,percentageOutliers:h,ageOutliers:f}},_P=e=>{const t=e.slice(0,lP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},ru=e=>{const t=e.slice(0,iP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},vP=(e,t=oP)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;const u=dP(i);if(u===null)return;const d=uP(String(i)),p={originalDisplay:d,numericValue:u,isNegative:u<0,isZero:Math.abs(u)<=1e-9},h=n[c]??[];h.find(f=>f.originalDisplay===d)||h.length>=t||(n[c]=[...h,p])})}),n},yP=0,bP=100,xP=0,wP=120,jP=(e,t,n,s)=>{switch(t){case"negative_to_nan":{const l=n??0;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:s!==null&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const l=n??yP,i=s??bP;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"age_bounds":{const l=n??xP,i=s??wP;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"custom_range":default:{const l=n!=null,i=s!=null;return!l&&!i?{flagged:!1,reason:null}:l&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:i&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}}},NP=(e,t,n,s)=>{const{flagged:l,reason:i}=jP(e,t,n,s);return l?`${e.originalDisplay}  flagged (${i??"rule match"})`:`${e.originalDisplay}  ok`},CP=(e,t,n,s,l,i=cP)=>{if(!t.length)return[];const c=[];for(const u of t){if(c.length>=i)break;const d=e[u];!d||!d.length||c.push({column:u,values:d.map(p=>NP(p,n,s,l)),overflow:0})}return c},SP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},EP=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const s=t===null?"-":String(t),l=n===null?"":String(n);return`Custom bounds active: [${s}, ${l}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const s=t??0;return n===null?`Negative-to-missing rule overrides values below ${s}.`:`Negative-to-missing rule overrides values < ${s} or > ${n}.`}return null},kP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,minValueParameter:l,maxValueParameter:i,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,minValue:g,maxValue:w})=>{if(!n&&!s&&!l&&!i)return null;const{selectedColumns:y,autoDetectionActive:b}=d,x=y.length,N=_P(d.recommendedColumns),E=ru(d.negativeCandidates),k=ru(d.zeroCandidates),j=ru(d.percentageOutliers),S=ru(d.ageOutliers),M=ru(d.nonNumericSelected),$=CP(h,y,f,g,w),T=EP(f,g,w),L=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," rule. ",p.guidance," Example: ",p.example,"."]}),T&&a.jsx("p",{className:"canvas-modal__note",children:T}),b?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:x})," column",x===1?"":"s"," for invalid value cleanup."]}),$.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",$.map(P=>`${P.column} (${P.values.join("; ")})`).join(" | "),"."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",E.preview.join(", "),E.remaining>0?`, ... (${E.remaining} more)`:"","."]}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",k.preview.join(", "),k.remaining>0?`, ... (${k.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",S.preview.join(", "),S.remaining>0?`, ... (${S.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[M.preview.join(", ")," ",M.preview.length===1?"is":"are"," not numeric-type columns.",M.remaining>0?` ${M.remaining} more column${M.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),L?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||l||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,l?u(l):null,i?u(i):null]})]})};let MP="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",_0=(e=21)=>{let t="",n=e|0;for(;n--;)t+=MP[Math.random()*64|0];return t};const v0=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],y0=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],cg=[{value:"token_sort_ratio",label:"Token Sort  Same words, ignore order",description:"Split into words, sort alphabetically, then compare. Great when the same words appear in different order."},{value:"token_set_ratio",label:"Token Set  Unique words, ignore extras",description:"Focus on overlapping unique words and down-weight extras. Best when one string has additional words."},{value:"ratio",label:"Character Ratio  Raw string similarity",description:"Compare characters in order using edit distance. Sensitive to spelling differences."}],Pm=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],AP=new Set(Pm.map(e=>e.value)),Ni=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],au="UTC",Tm=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Tm(e.split(",")):[]:[],b0=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(s=>{const l=Number(s);Number.isFinite(l)&&n.push(l)}),n}if(typeof e=="string")return b0(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},ug=e=>{const t=Number(e);return Number.isFinite(t)?t:null},x0=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},OP=(e,t)=>{var s,l,i,c,u;if(typeof t!="string")return((s=Ni.find(d=>d.value===e))==null?void 0:s.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((i=v0.find(d=>d.value===n))==null?void 0:i.value)??"add":e==="stat"?((c=y0.find(d=>d.value===n))==null?void 0:c.value)??"mean":e==="similarity"?((u=cg.find(d=>d.value===n))==null?void 0:u.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((l=Ni.find(d=>d.value===e))==null?void 0:l.defaultMethod)??""},PP=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},TP=e=>{const t=Tm(e);return t.length?t.filter(n=>AP.has(n)):["year","month","day"]},$P=e=>typeof e!="string"?au:e.trim()||au,w0=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,s)=>{if(!n||typeof n!="object")return;const l=n,i=PP(l.operation_type??l.type),c=l.operation_id??l.id??`feature_math_${s+1}`,u=typeof c=="string"&&c.trim()?c.trim():`feature_math_${s+1}`,d=OP(i,l.method),p=Tm(l.input_columns??l.inputs??l.inputColumns),h=Tm(l.secondary_columns??l.denominator??l.secondaryColumns),f=b0(l.constants),g=typeof l.output_column=="string"?l.output_column.trim():"",w=typeof l.output_prefix=="string"?l.output_prefix.trim():"",y=i==="datetime_extract"?TP(l.datetime_features):[],b=i==="datetime_extract"?$P(l.timezone):au,x=ug(l.fillna),N=(()=>{const M=ug(l.round??l.round_digits);return Number.isInteger(M??NaN),M})(),E=ug(l.epsilon),k=i==="similarity"?x0(l.normalize,!1):!1,j=l.allow_overwrite===void 0?null:x0(l.allow_overwrite,!1),S=typeof l.description=="string"?l.description:void 0;t.push({id:u,type:i,method:d,inputColumns:p,secondaryColumns:h,constants:f,outputColumn:g,outputPrefix:w,datetimeFeatures:y,timezone:b,fillna:x,roundDigits:N,normalize:k,epsilon:E,allowOverwrite:j,description:S})}),t},LP=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||au):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},zP=e=>e.map(t=>LP(t)),DP={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},j0=(e,t)=>{var l;const n=DP[e]??{};let s=`math_${e}_${_0(6)}`;for(;t.has(s);)s=`math_${e}_${_0(6)}`;return{id:s,type:e,method:n.method??((l=Ni.find(i=>i.value===e))==null?void 0:l.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:au,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},RP=(e,t)=>{const n=new Map;return t==null||t.forEach(s=>{s.operations.forEach(l=>{n.has(l.operation_id)||n.set(l.operation_id,l)})}),e.map((s,l)=>{const i=n.get(s.id),c=`${l+1}. ${s.type.replace("_"," ")}${s.method?`  ${s.method}`:""}`;return{id:s.id,label:c,status:i==null?void 0:i.status,message:(i==null?void 0:i.message)??void 0,outputColumns:(i==null?void 0:i.output_columns)??[]}})},N0=e=>e==="arithmetic"?v0:e==="stat"?y0:e==="similarity"?cg:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],FP=e=>{const t=cg.find(n=>n.value===e);return t!=null&&t.description?t.description:"Compare the input text columns using the selected similarity technique."},IP={applied:"Applied",skipped:"Skipped",failed:"Failed"},BP={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},UP=new Set(Pm.map(e=>e.value)),qP=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},C0=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],HP=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],VP=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",WP=({index:e,total:t,operation:n,summary:s,availableColumns:l,isCollapsed:i,onToggleCollapsed:c,onDuplicate:u,onRemove:d,onReorder:p,onChange:h})=>{var ee;const f=v.useMemo(()=>N0(n.type),[n.type]),g=v.useMemo(()=>{var J;return((J=Ni.find(se=>se.value===n.type))==null?void 0:J.label)??n.type},[n.type]),w=v.useMemo(()=>{var J;return((J=f.find(se=>se.value===n.method))==null?void 0:J.label)??n.method},[f,n.method]),y=v.useMemo(()=>n.type==="similarity"?FP(n.method):"",[n.method,n.type]),[b,x]=v.useState(n.inputColumns.join(", ")),[N,E]=v.useState(n.secondaryColumns.join(", ")),[k,j]=v.useState(n.constants.join(", "));v.useEffect(()=>{x(n.inputColumns.join(", "))},[n.inputColumns]),v.useEffect(()=>{E(n.secondaryColumns.join(", "))},[n.secondaryColumns]),v.useEffect(()=>{j(n.constants.join(", "))},[n.constants]);const S=()=>{h(n.id,{inputColumns:C0(b)})},M=()=>{h(n.id,{secondaryColumns:C0(N)})},$=()=>{h(n.id,{constants:HP(k)})},T=`feature-math-toggle-${n.id}`,L=`feature-math-body-${n.id}`,P=`feature-math-input-columns-${n.id}`,O=`feature-math-secondary-columns-${n.id}`,D=s==null?void 0:s.status,W=D?a.jsx("span",{className:`canvas-cast__chip ${BP[D]??""}`,style:{marginLeft:"0.5rem"},children:IP[D]}):null,z=s!=null&&s.message?s.message.trim():"",R=VP(D),U=(ee=s==null?void 0:s.outputColumns)!=null&&ee.length?s.outputColumns.join(", "):"",V=qP(n.inputColumns),B=n.type==="ratio"||n.type==="similarity",X=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",H=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",F=n.type==="similarity",K=n.type==="datetime_extract",re=n.type==="stat"||n.type==="datetime_extract",G=v.useMemo(()=>{if(!l.length)return"";const J=l.slice(0,6),se=l.length-J.length;return se>0?`${J.join(", ")}  (${se} more)`:J.join(", ")},[l]),q=J=>{if(!J||!UP.has(J))return;const se=new Set(n.datetimeFeatures);se.has(J)?se.delete(J):se.add(J),h(n.id,{datetimeFeatures:Array.from(se)})},Y=J=>se=>{const ke=se.target.value;if(ke===""){h(n.id,{[J]:null});return}const Pe=Number(ke);Number.isFinite(Pe)&&(J==="roundDigits"?h(n.id,{roundDigits:Math.round(Pe)}):J==="fillna"?h(n.id,{fillna:Pe}):h(n.id,{epsilon:Pe}))},Q=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:T,className:"canvas-imputer__card-toggle",onClick:()=>c(n.id),"aria-expanded":!i,"aria-controls":L,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${i?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[g,w?`  ${w}`:"",n.outputColumn?`   ${n.outputColumn}`:"",W]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",V]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!i&&a.jsxs("div",{className:"canvas-imputer__card-body",id:L,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>u(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),z&&a.jsx("p",{className:R,children:z}),U&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",U]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:J=>h(n.id,{type:J.target.value}),children:Ni.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:J=>h(n.id,{method:J.target.value}),children:f.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),n.type==="similarity"&&y&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:y}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:b,onChange:J=>x(J.target.value),onBlur:S,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),S())},placeholder:"col_a, col_b",list:P}),a.jsx("datalist",{id:P,children:l.map(J=>a.jsx("option",{value:J},`${n.id}-input-option-${J}`))}),G&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",G]})]}),B&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:N,onChange:J=>E(J.target.value),onBlur:M,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),M())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:O}),a.jsx("datalist",{id:O,children:l.map(J=>a.jsx("option",{value:J},`${n.id}-secondary-option-${J}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),X&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:k,onChange:J=>j(J.target.value),onBlur:$,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),$())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:J=>h(n.id,{outputColumn:J.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),re&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:J=>h(n.id,{outputPrefix:J.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),H&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:Y("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:Y("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:Y("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),F&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:J=>h(n.id,{normalize:J.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),K&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:Pm.map(J=>{const se=`feature-math-${n.id}-datetime-${J.value}`,ke=n.datetimeFeatures.includes(J.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:se,children:[a.jsx("input",{id:se,type:"checkbox",checked:ke,onChange:()=>q(J.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:J.label})]},J.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:J=>h(n.id,{timezone:J.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:Q,onChange:J=>{const se=J.target.value;se==="inherit"?h(n.id,{allowOverwrite:null}):h(n.id,{allowOverwrite:se==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},KP=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:s,onAddOperation:l,onDuplicateOperation:i,onRemoveOperation:c,onReorderOperation:u,onOperationChange:d,availableColumns:p,signals:h,previewStatus:f,errorHandlingParameter:g,allowOverwriteParameter:w,defaultTimezoneParameter:y,epsilonParameter:b,renderParameterField:x})=>{const[N,E]=v.useState("arithmetic"),k=v.useMemo(()=>{const T=new Map;return t.forEach(L=>{T.set(L.id,L)}),T},[t]),j=v.useMemo(()=>h.length?h[h.length-1]:null,[h]),S=(j==null?void 0:j.warnings)??[],M=j&&j.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",$=()=>{l(N)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("select",{value:N,onChange:T=>E(T.target.value),children:Ni.map(T=>a.jsx("option",{value:T.value,children:T.label},T.value))}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:$,children:"Add operation"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),f==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),j&&a.jsxs("p",{className:M,children:["Preview applied ",j.applied_operations," of ",j.total_operations," operation",j.total_operations===1?"":"s"," (",j.skipped_operations," skipped, ",j.failed_operations," failed)."]}),S.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:S.map((T,L)=>a.jsx("li",{children:T},`feature-math-warning-${L}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((T,L)=>a.jsx(WP,{index:L,total:e.length,operation:T,summary:k.get(T.id),availableColumns:p,isCollapsed:n.has(T.id),onToggleCollapsed:s,onDuplicate:i,onRemove:c,onReorder:u,onChange:d},T.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[g&&x(g),w&&x(w),y&&x(y),b&&x(b)]})]})},YP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},GP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},S0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),QP=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxUniqueParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,missingStrategyParameter:f,missingCodeParameter:g,selectedColumns:w,renderParameterField:y,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const M=new Set;return l.forEach($=>{$.status==="recommended"&&$.selectable&&M.add($.column)}),Array.from(M)},[l]),k=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),j=l.length>0,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:k}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((M,$)=>a.jsx("li",{children:M},`label-encoding-note-${$}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(M=>{const $=w.includes(M.column),T=YP[M.status],L=GP[M.status]??"canvas-cast__chip--muted",P=M.sample_values.length?M.sample_values.join(", "):"",O=M.unique_count!==void 0&&M.unique_count!==null?`${S0(M.unique_count)} (${S0(M.unique_percentage)}%)`:"",D=N(M.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:M.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[M.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",M.dtype]}),M.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:M.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",P]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:M.reason})]})}),a.jsx("td",{children:O}),a.jsx("td",{children:D}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:T})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>b(M.column),disabled:!M.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:M.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${M.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),d&&y(d),p&&y(p),h&&y(h),f&&y(f),g&&y(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(c)]})]})},XP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},JP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},E0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),ZP=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,targetColumnParameter:u,autoDetectParameter:d,maxCategoriesParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,smoothingParameter:g,encodeMissingParameter:w,handleUnknownParameter:y,selectedColumns:b,renderParameterField:x,onToggleColumn:N,onApplyRecommended:E,formatMissingPercentage:k})=>{const j=v.useMemo(()=>{if(!l.length)return[];const T=new Set;return l.forEach(L=>{L.status==="recommended"&&L.selectable&&T.add(L.column)}),Array.from(T)},[l]),S=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),M=l.length>0,$=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(j),disabled:!j.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),!u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((T,L)=>a.jsx("li",{children:T},`target-encoding-note-${L}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!M&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&M&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(T=>{const L=b.includes(T.column),P=XP[T.status],O=JP[T.status]??"canvas-cast__chip--muted",D=T.sample_values.length?T.sample_values.join(", "):"",W=T.unique_count!==void 0&&T.unique_count!==null?`${E0(T.unique_count)} (${E0(T.unique_percentage)}%)`:"",z=k(T.missing_percentage),R=T.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:T.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[T.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",T.dtype]}),T.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:T.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",D]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:T.reason})]})}),a.jsx("td",{children:W}),a.jsx("td",{children:z}),a.jsx("td",{children:R}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${O}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:()=>N(T.column),disabled:!T.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:T.selectable?L?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${T.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&x(u),d&&x(d),p&&x(p),h&&x(h),f&&x(f),g&&x(g),w&&x(w),y&&x(y)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(c)]})]})},eT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},tT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},k0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),nT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,bucketsParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,encodeMissingParameter:g,selectedColumns:w,renderParameterField:y,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const $=new Set;return l.forEach(T=>{T.status==="recommended"&&T.selectable&&$.add(T.column)}),Array.from($)},[l]),k=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),j=l.length>0,S=i.suggestedBucketDefault>0?`Default bucket suggestion: ${i.suggestedBucketDefault.toLocaleString()}.`:null,M=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:k}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:S}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map(($,T)=>a.jsx("li",{children:$},`hash-encoding-note-${T}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map($=>{const T=w.includes($.column),L=eT[$.status],P=tT[$.status]??"canvas-cast__chip--muted",O=$.sample_values.length?$.sample_values.join(", "):"",D=$.unique_count!==void 0&&$.unique_count!==null?`${k0($.unique_count)} (${k0($.unique_percentage)}%)`:"",W=N($.missing_percentage),z=$.recommended_bucket_count?$.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:$.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[$.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",$.dtype]}),$.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:$.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",O]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:$.reason})]})}),a.jsx("td",{children:D}),a.jsx("td",{children:W}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:()=>b($.column),disabled:!$.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:$.selectable?T?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${$.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),d&&y(d),p&&y(p),h&&y(h),f&&y(f),g&&y(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(c)]})]})},sT=({columnsParameter:e,autoDetectParameter:t,degreeParameter:n,includeBiasParameter:s,interactionOnlyParameter:l,includeInputFeaturesParameter:i,outputPrefixParameter:c,renderParameterField:u,signal:d})=>{const p=v.useMemo(()=>[e,t,n,s,l,i,c].filter(x=>!!x),[e,t,n,s,l,i,c]),h=(d==null?void 0:d.generated_features)??[],f=(d==null?void 0:d.skipped_columns)??[],g=(d==null?void 0:d.filled_columns)??{},w=(d==null?void 0:d.notes)??[],y=(d==null?void 0:d.feature_count)??0,b=v.useMemo(()=>{const x=Object.entries(g);return x.length?x.map(([N,E])=>`${N} (${E.toLocaleString()} missing)`).join(", "):null},[g]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Polynomial feature settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),p.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:p.map(x=>u(x))}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",f.join(", "),"."]}),b&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",b," before generating features."]}),y>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:h.map(x=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:x.column}),a.jsx("td",{children:x.expression||(x.terms.length?x.terms.join("  "):"1")}),a.jsx("td",{children:x.degree})]},`poly-feature-${x.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),w.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:w.map((x,N)=>a.jsx("li",{children:x},`polynomial-note-${N}`))})]})},M0=e=>!!e,ou=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},rT=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},A0=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},aT=({columnsParameter:e,autoDetectParameter:t,targetColumnParameter:n,methodParameter:s,scoreFuncParameter:l,problemTypeParameter:i,kParameter:c,percentileParameter:u,alphaParameter:d,thresholdParameter:p,modeParameter:h,estimatorParameter:f,stepParameter:g,minFeaturesParameter:w,maxFeaturesParameter:y,dropUnselectedParameter:b,renderParameterField:x,signal:N})=>{const E=v.useMemo(()=>[e,t,n,s,l,i].filter(M0),[e,t,n,s,l,i]),k=v.useMemo(()=>[c,u,d,p,h,f,g,w,y,b].filter(M0),[c,u,d,p,h,f,g,w,y,b]),j=(N==null?void 0:N.configured_columns)??[],S=(N==null?void 0:N.evaluated_columns)??[],M=(N==null?void 0:N.selected_columns)??[],$=(N==null?void 0:N.dropped_columns)??[],T=(N==null?void 0:N.feature_summaries)??[],L=(N==null?void 0:N.notes)??[],P=(N==null?void 0:N.drop_unselected)??!1,O=v.useMemo(()=>{if(!S.length&&!j.length)return null;if(S.length===j.length)return`Evaluated ${S.length.toLocaleString()} column(s).`;if(!j.length)return`Evaluated ${S.length.toLocaleString()} column(s) via auto-detect.`;const R=Math.max(S.length-j.length,0);return R>0?`Evaluated ${S.length.toLocaleString()} column(s) (${R.toLocaleString()} auto-detected).`:`Evaluated ${S.length.toLocaleString()} of ${j.length.toLocaleString()} configured column(s).`},[j,S]),D=v.useMemo(()=>{if(!N)return null;const R=[];return N.method&&R.push(`Method: ${N.method}`),N.score_func&&R.push(`Score: ${N.score_func}`),N.estimator&&R.push(`Estimator: ${N.estimator}`),N.problem_type&&N.problem_type!=="auto"&&R.push(`Problem: ${N.problem_type}`),N.target_column&&R.push(`Target: ${N.target_column}`),typeof N.k=="number"&&Number.isFinite(N.k)&&R.push(`k = ${N.k.toLocaleString()}`),typeof N.percentile=="number"&&Number.isFinite(N.percentile)&&R.push(`percentile = ${ou(N.percentile,2)}`),typeof N.alpha=="number"&&Number.isFinite(N.alpha)&&R.push(`alpha = ${ou(N.alpha,4)}`),N.threshold!==null&&N.threshold!==void 0&&Number.isFinite(N.threshold)&&R.push(`threshold = ${ou(N.threshold,4)}`),N.auto_detect&&R.push("Auto-detect enabled"),R.length?R.join("  "):null},[N]),W=v.useMemo(()=>A0(M),[M]),z=v.useMemo(()=>A0($),[$]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Feature selection settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:D}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:O}),E.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:E.map(R=>x(R))}),k.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:k.map(R=>x(R))}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:P?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),M.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",M.length.toLocaleString()," column(s): ",W]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),$.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",$.length.toLocaleString()," column(s): ",z]}),T.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:T.map(R=>{const U=["canvas-cast__row"];return R.selected||U.push("canvas-cast__row--muted"),a.jsxs("tr",{className:U.join(" "),children:[a.jsx("th",{scope:"row",children:R.column}),a.jsx("td",{children:ou(R.score)}),a.jsx("td",{children:rT(R.p_value)}),a.jsx("td",{children:R.rank??""}),a.jsx("td",{children:ou(R.importance,4)}),a.jsx("td",{children:R.selected?"Selected":"Dropped"}),a.jsx("td",{children:R.note??""})]},`feature-selection-summary-${R.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),L.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:L.map((R,U)=>a.jsx("li",{children:R},`feature-selection-note-${U}`))})]})},oT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},lT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},O0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),iT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,encodeMissingParameter:f,handleUnknownParameter:g,unknownValueParameter:w,selectedColumns:y,renderParameterField:b,onToggleColumn:x,onApplyRecommended:N,formatMissingPercentage:E})=>{const k=v.useMemo(()=>{if(!l.length)return[];const $=new Set;return l.forEach(T=>{T.status==="recommended"&&T.selectable&&$.add(T.column)}),Array.from($)},[l]),j=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),S=l.length>0,M=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>N(k),disabled:!k.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),j&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:j}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map(($,T)=>a.jsx("li",{children:$},`ordinal-encoding-note-${T}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!S&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&S&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map($=>{const T=y.includes($.column),L=oT[$.status],P=lT[$.status]??"canvas-cast__chip--muted",O=$.sample_values.length?$.sample_values.join(", "):"",D=$.unique_count!==void 0&&$.unique_count!==null?`${O0($.unique_count)} (${O0($.unique_percentage)}%)`:"",W=E($.missing_percentage),z=$.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:$.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[$.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",$.dtype]}),$.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:$.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",O]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:$.reason})]})}),a.jsx("td",{children:D}),a.jsx("td",{children:W}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:()=>x($.column),disabled:!$.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:$.selectable?T?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${$.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&b(u),d&&b(d),p&&b(p),h&&b(h),f&&b(f),g&&b(g),w&&b(w)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),b(c)]})]})},cT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},uT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},P0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),dT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:w,renderParameterField:y,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const M=new Set;return l.forEach($=>{$.status==="recommended"&&$.selectable&&M.add($.column)}),Array.from(M)},[l]),k=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),j=l.length>0,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:k}),i.autoDetectDefault&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((M,$)=>a.jsx("li",{children:M},`dummy-note-${$}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(M=>{const $=w.includes(M.column),T=cT[M.status],L=uT[M.status]??"canvas-cast__chip--muted",P=M.sample_values.length?M.sample_values.join(", "):"",O=M.unique_count!==void 0&&M.unique_count!==null?`${P0(M.unique_count)} (${P0(M.unique_percentage)}%)`:"",D=N(M.missing_percentage),W=M.estimated_dummy_columns?M.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:M.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[M.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",M.dtype]}),M.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:M.text_category}),M.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",P]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:M.reason})]})}),a.jsx("td",{children:O}),a.jsx("td",{children:D}),a.jsx("td",{children:W}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:T})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>b(M.column),disabled:!M.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:M.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${M.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),d&&y(d),p&&y(p),h&&y(h),f&&y(f),g&&y(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(c)]})]})},mT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},hT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},T0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),fT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:w,renderParameterField:y,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const M=new Set;return l.forEach($=>{$.status==="recommended"&&$.selectable&&M.add($.column)}),Array.from(M)},[l]),k=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),j=l.length>0,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:k}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((M,$)=>a.jsx("li",{children:M},`one-hot-note-${$}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(M=>{const $=w.includes(M.column),T=mT[M.status],L=hT[M.status]??"canvas-cast__chip--muted",P=M.sample_values.length?M.sample_values.join(", "):"",O=M.unique_count!==void 0&&M.unique_count!==null?`${T0(M.unique_count)} (${T0(M.unique_percentage)}%)`:"",D=N(M.missing_percentage),W=M.estimated_dummy_columns?M.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:M.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[M.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",M.dtype]}),M.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:M.text_category}),M.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",P]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:M.reason})]})}),a.jsx("td",{children:O}),a.jsx("td",{children:D}),a.jsx("td",{children:W}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:T})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>b(M.column),disabled:!M.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:M.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${M.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),d&&y(d),p&&y(p),h&&y(h),f&&y(f),g&&y(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(c)]})]})},$0={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},pT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},L0=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},gT=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(s=>s&&s.split===t)??null:null,dg=(e,t)=>{const n=gT(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const s=$0[n.action]??n.action,l=L0(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:s}),l&&a.jsx("span",{className:"canvas-cast__muted",children:l})]})},_T=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(s=>s&&!["train","test","validation"].includes(s.split));return t.length&&t.map(s=>{const l=s.label||s.split,i=$0[s.action]??s.action,c=L0(s.rows??null);return c?`${l}: ${i} (${c})`:`${l}: ${i}`}).join("; ")||null},vT=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,yT=({signal:e,previewStatus:t,hasSource:n,hasReachableSource:s,onRefreshPreview:l})=>{const i=v.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),c=(e==null?void 0:e.total_transformers)??i.length,u=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],d=t==="loading",p=c?`Tracking ${c.toLocaleString()} transformer${c===1?"":"s"}.`:null,h=d||!n||!s;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:h,children:d?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),p&&a.jsx("p",{className:"canvas-modal__note",children:p}),!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),n&&!s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),u.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:u.map((f,g)=>a.jsx("li",{children:f},`transformer-audit-note-${g}`))}),d&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!d&&t==="error"&&n&&s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!d&&n&&s&&!i.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!d&&i.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:i.map((f,g)=>{const w=f.storage_key??`${f.transformer_name}-${f.column_name??"all"}-${g}`,y=_T(f),b=f.source_node_label||f.source_node_id||"",x=pT(f.updated_at??f.created_at??null),N=f.column_name??"",E=vT(f);return a.jsxs(be.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:b})})}),a.jsx("td",{children:f.transformer_name}),a.jsx("td",{children:N}),a.jsx("td",{children:E||""}),a.jsx("td",{children:dg(f,"train")}),a.jsx("td",{children:dg(f,"test")}),a.jsx("td",{children:dg(f,"validation")}),a.jsx("td",{children:x})]}),y&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",y]})})})]},w)})})]})})]})},mg=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",bT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},xT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},wT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:l,config:i,targetColumnParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p})=>{var re,G,q,Y;const h=s.data,f=s.status,g=Array.isArray(h==null?void 0:h.applied_steps)?h.applied_steps:[],w=Array.isArray(h==null?void 0:h.columns)?h==null?void 0:h.columns:[],y=Array.isArray((re=h==null?void 0:h.signals)==null?void 0:re.feature_target_split)?(G=h==null?void 0:h.signals)==null?void 0:G.feature_target_split:[],b=xT(y,e),x=(i==null?void 0:i.targetColumn)??"",N=(b==null?void 0:b.target_column)??x,E=(i==null?void 0:i.featureColumns)??[],k=v.useMemo(()=>Array.isArray(h==null?void 0:h.column_stats)?h==null?void 0:h.column_stats:[],[h==null?void 0:h.column_stats]),j=v.useMemo(()=>{const Q=new Map;return k.forEach(ee=>{ee!=null&&ee.name&&Q.set(ee.name,ee)}),Q},[k]),S=v.useMemo(()=>{var Q;return(Q=b==null?void 0:b.feature_columns)!=null&&Q.length?b.feature_columns:E.length?E:N?w.filter(ee=>ee!==N):w.slice()},[b==null?void 0:b.feature_columns,E,w,N]),M=(b==null?void 0:b.auto_included_columns)??[],$=(b==null?void 0:b.missing_feature_columns)??[],T=(b==null?void 0:b.excluded_columns)??[],L=(b==null?void 0:b.target_missing_count)??0,P=typeof(b==null?void 0:b.target_missing_percentage)=="number"?b.target_missing_percentage:null,O=(b==null?void 0:b.target_dtype)??(N?((q=j.get(N))==null?void 0:q.dtype)??null:null),D=typeof((Y=h==null?void 0:h.metrics)==null?void 0:Y.row_count)=="number"?h.metrics.row_count:null,W=S.length,z=M.length,R=T.length,U=$.length,V=v.useMemo(()=>bT(g),[g]),B=v.useMemo(()=>{const Q=[];if(Q.push({label:"Target column",value:N||"Not set"}),Q.push({label:"Feature columns",value:d(W)}),D!==null&&Q.push({label:"Preview rows",value:d(D)}),z&&Q.push({label:"Auto-selected features",value:d(z)}),U&&Q.push({label:"Configured features missing",value:d(U)}),R&&Q.push({label:"Excluded columns",value:d(R)}),L){const ee=d(L),J=P!==null?p(P):null;Q.push({label:"Target missing values",value:J?`${ee} (${J})`:ee})}return Q},[z,R,W,d,p,U,D,N,L,P]),X=v.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),H=v.useMemo(()=>!t||!n?null:f==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,f,t]),F=v.useMemo(()=>N?f==="success"&&N&&!w.includes(N)?`Target column "${N}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[w,f,N]),K=!!t&&n&&f!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:!K,children:f==="loading"?"Refreshing...":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),X&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:X}),s.error&&f==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:H}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:F}),U>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",mg($),"."]}),R>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",mg(T),"."]}),z>0&&E.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",mg(M),"."]}),V&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:V}),B.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:B.map(Q=>a.jsxs("li",{children:[Q.label,": ",a.jsx("strong",{children:Q.value})]},`feature-target-summary-${Q.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:c&&u(c)}),f==="success"&&W===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",O?a.jsx("strong",{children:O}):a.jsx("span",{children:"Unknown"}),L?` - Missing rows flagged for review: ${d(L)}.`:""]})]})},jT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},Ma=e=>`${(e*100).toFixed(1)}%`,NT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:l,config:i,parameters:c,renderParameterField:u,formatMetricValue:d})=>{var P,O;const p=s.data,h=s.status,f=Array.isArray((P=p==null?void 0:p.signals)==null?void 0:P.train_test_split)?(O=p==null?void 0:p.signals)==null?void 0:O.train_test_split:[],g=jT(f,e),w=(i==null?void 0:i.test_size)??.2,y=(i==null?void 0:i.validation_size)??0,b=i==null?void 0:i.random_state;i==null||i.shuffle;const x=(i==null?void 0:i.stratify)??!1,N=(i==null?void 0:i.target_column)??"",E=y>0,k=v.useMemo(()=>g?{trainSize:g.train_size??0,validationSize:g.validation_size??0,testSize:g.test_size??0,totalSize:g.total_size??0,trainRatio:g.train_size&&g.total_size?g.train_size/g.total_size:0,validationRatio:g.validation_ratio??0,testRatio:g.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-w-y,validationRatio:y,testRatio:w},[g,w,y]),j=c.find(D=>D.name==="test_size"),S=c.find(D=>D.name==="validation_size"),M=c.find(D=>D.name==="random_state"),$=c.find(D=>D.name==="shuffle"),T=c.find(D=>D.name==="stratify"),L=c.find(D=>D.name==="target_column");return a.jsxs("div",{className:"node-settings__section",children:[a.jsx("div",{className:"node-settings__section-header",children:a.jsx("h3",{children:"Train/Test Split Configuration"})}),a.jsxs("div",{className:"node-settings__field-group",children:[j&&u(j),S&&u(S),M&&u(M),$&&u($),T&&u(T),x&&L&&u(L)]}),h==="success"&&g&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:Ma(k.trainRatio)},title:`Training: ${k.trainSize} rows (${Ma(k.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),E&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:Ma(k.validationRatio)},title:`Validation: ${k.validationSize} rows (${Ma(k.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:Ma(k.testRatio)},title:`Test: ${k.testSize} rows (${Ma(k.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:d(k.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(k.trainSize,0)," (",Ma(k.trainRatio),")"]})]}),E&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(k.validationSize,0)," (",Ma(k.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(k.testSize,0)," (",Ma(k.testRatio),")"]})]}),x&&N&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:N})]}),b!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:b})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",children:[a.jsx("span",{className:"node-settings__warning-icon",children:""}),"Connect this node to a data source to configure the split."]}),h==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),h==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},CT={classification:"Classification",regression:"Regression"},ST=e=>e==="numeric"||e==="integer",ET=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},hg=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,kT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},MT=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:s,config:l,targetColumnParameter:i,problemTypeParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p,schemaColumns:h})=>{var q;const f=n.data,g=n.status,w=Array.isArray(f==null?void 0:f.applied_steps)?f.applied_steps:[],y=Array.isArray(f==null?void 0:f.column_stats)?f.column_stats:[],b=(f==null?void 0:f.metrics)??null,x=v.useMemo(()=>Array.isArray(f==null?void 0:f.columns)?f.columns.filter(Y=>typeof Y=="string"&&Y.trim().length>0):[],[f==null?void 0:f.columns]),N=v.useMemo(()=>{var Y;return h.length?h:Array.isArray((Y=f==null?void 0:f.schema)==null?void 0:Y.columns)?f.schema.columns:x.length>0?x.map(Q=>({name:Q,pandas_dtype:null,logical_family:"unknown",nullable:!0})):[]},[(q=f==null?void 0:f.schema)==null?void 0:q.columns,x,h]),E=v.useMemo(()=>{const Y=new Map;return N.forEach(Q=>{Q!=null&&Q.name&&Y.set(Q.name,Q)}),Y},[N]),k=(l==null?void 0:l.targetColumn)??"",j=(l==null?void 0:l.problemType)??"classification",S=k?y.find(Y=>(Y==null?void 0:Y.name)===k)??null:null,$=!!(k?E.get(k)??null:null),T=v.useMemo(()=>{const Y=new Set;return y.forEach(Q=>{Q!=null&&Q.name&&Q.name!==k&&Y.add(Q.name)}),N.forEach(Q=>{Q!=null&&Q.name&&Q.name!==k&&Y.add(Q.name)}),Array.from(Y).sort()},[y,N,k]),L=v.useMemo(()=>T.filter(Y=>{const Q=E.get(Y);if(Q&&ST(Q.logical_family))return!0;const ee=y.find(J=>J.name===Y);return ET((ee==null?void 0:ee.dtype)??null)}),[y,T,E]),P=v.useMemo(()=>new Set(L),[L]),O=v.useMemo(()=>T.filter(Y=>!P.has(Y)),[T,P]),D=v.useMemo(()=>y.filter(Y=>(Y==null?void 0:Y.name)&&Y.name!==k&&(Y.missing_count??0)>0).map(Y=>Y.name),[y,k]),W=typeof(b==null?void 0:b.row_count)=="number"?b.row_count:null,z=typeof(S==null?void 0:S.distinct_count)=="number"&&Number.isFinite(S.distinct_count)?S.distinct_count:null,R=typeof(S==null?void 0:S.missing_count)=="number"?S.missing_count:0,U=typeof(S==null?void 0:S.missing_percentage)=="number"?S.missing_percentage:null,V=v.useMemo(()=>{const Y=[];return k?g!=="success"?Y:!S&&!$&&!T.length?(Y.push(`Target column "${k}" is not present in the preview output, and no feature columns were found.`),Y):(T.length||Y.push("Add at least one feature column in addition to the target before training."),S&&R>0&&Y.push(`Target column includes ${R} missing value${R===1?"":"s"}.`),j==="classification"&&S&&(z??0)<2&&Y.push("Classification tasks require at least two distinct target classes."),j==="regression"&&L.length===0&&Y.push("Regression tasks need at least one numeric feature column."),D.length>0&&Y.push(`Feature columns with missing values: ${hg(D)}.`),W!==null&&W===0&&Y.push("Preview returned zero rows after upstream transformations."),Y):(Y.push("Set a target column to evaluate downstream modeling constraints."),Y)},[D,T.length,R,L.length,W,g,j,k,z,S,$]),B=v.useMemo(()=>CT[j],[j]),X=v.useMemo(()=>{const Y=[{label:"Problem type",value:B},{label:"Target column",value:k||"Not set"}];if(g==="success"){if(z!==null&&Y.push({label:"Target distinct values",value:d(z)}),S){const Q=d(R),ee=U!==null?p(U):null;Y.push({label:"Target missing values",value:ee?`${Q} (${ee})`:Q})}D.length>0&&Y.push({label:"Features with missing values",value:d(D.length)})}return Y},[B,D.length,d,p,R,g,k,z,U,S]),H=v.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),F=v.useMemo(()=>!e||!t?null:g==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,g,e]),K=v.useMemo(()=>kT(w),[w]),re=!!e&&t&&g!=="loading",G=v.useMemo(()=>!k||g!=="success"||V.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[g,V.length,k]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:!re,children:g==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:H}),n.error&&g==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:F}),V.map((Y,Q)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Y},`train-model-issue-${Q}`)),G&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:G}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:K}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[i&&u(i),c&&u(c)]}),X.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:X.map(Y=>a.jsxs("li",{children:[Y.label,": ",a.jsx("strong",{children:Y.value})]},`train-model-summary-${Y.label}`))}),g==="success"&&D.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",hg(D),"."]}),g==="success"&&j==="regression"&&O.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",hg(O),". Consider encoding or casting them before training regression models."]})]})},z0=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?gr(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},AT=e=>e||"Unknown",OT=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},hs=e=>{const t=OT(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const s=Math.round(n/60);if(s===1)return"1 hour ago";if(s<24)return`${s} hours ago`;const l=Math.round(s/24);return l===1?"1 day ago":`${l} days ago`},D0=e=>typeof e!="number"||!Number.isFinite(e)?"":Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3),PT=({presets:e,isOpen:t,onClose:n,onApply:s,activePresetId:l,fieldMetadata:i})=>{const[c,u]=v.useState(null);v.useEffect(()=>{var f;if(!t){u(null);return}c&&e.some(g=>g.id===c)||u(((f=e[0])==null?void 0:f.id)??null)},[t,e,c]),v.useEffect(()=>{if(!t)return;const f=g=>{g.key==="Escape"&&n()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[t,n]);const d=v.useMemo(()=>c?e.find(f=>f.id===c)??e[0]??null:e[0]??null,[e,c]),p=v.useMemo(()=>!l||!d?!1:l===d.id,[l,d]),h=v.useMemo(()=>{var x,N;if(!t||!e.length)return null;const f=((x=d==null?void 0:d.modelType)==null?void 0:x.toLowerCase())==="logistic_regression"?(N=d==null?void 0:d.params)==null?void 0:N.solver:null,g=typeof f=="string"?f.trim().toLowerCase():null,w=g&&(g==="sag"||g==="saga")?"SAG and SAGA solvers expect standardized features. Scale inputs before training to improve convergence and avoid repeated warnings.":null,y=d?Object.entries(d.params??{}).sort(([E],[k])=>E.localeCompare(k)).map(([E,k])=>{const j=i==null?void 0:i[E],S=O=>{var D;return(D=j==null?void 0:j.options)!=null&&D.length?j.options.find(W=>{const z=W.value;return O==null?z===null||typeof z=="string"&&z.trim().toLowerCase()==="none":typeof O=="string"&&typeof z=="string"?z===O?!0:z.trim().toLowerCase()===O.trim().toLowerCase():String(z)===String(O)})??null:null},M=O=>{if(O===null)return j!=null&&j.nullable?"None":"";if(O===void 0)return"";if(typeof O=="boolean")return O?"true":"false";if(typeof O=="number")return Number.isFinite(O)?O.toString():String(O);if(O&&typeof O=="object")try{return JSON.stringify(O)}catch{return"[object]"}return String(O??"")},$=O=>{var R;if(!O)return null;const D=O.value,W=(R=O.label)==null?void 0:R.trim(),z=M(D);return W&&z&&W!==z?`${W} (${z})`:W||z},T=()=>{if(j&&j.default!==void 0){const O=L(j.default,!1);if(O.text)return{text:O.text,note:"Using estimator default"}}return{text:"",note:"Using estimator default"}},L=(O,D=!0)=>{const W=S(O);return W?{text:$(W)??"",note:null}:Array.isArray(O)?O.length===0?D?T():{text:"",note:null}:{text:O.map(R=>L(R,!1)).map(R=>R.text).filter(Boolean).join(", "),note:null}:O===void 0||typeof O=="string"&&O.trim()===""?D?T():{text:"",note:null}:O===null?j!=null&&j.nullable?{text:"None",note:null}:D?T():{text:"",note:null}:{text:M(O),note:null}},P=L(k);return{key:E,label:(j==null?void 0:j.label)??E,description:(j==null?void 0:j.description)??null,value:P.text,note:P.note}}):[],b=d!=null&&d.finishedAt?hs(d.finishedAt):null;return a.jsxs("div",{className:"canvas-modal best-param-modal",role:"dialog","aria-modal":"true",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:n}),a.jsxs("div",{className:"canvas-modal__panel best-param-modal__panel",role:"document",children:[a.jsxs("header",{className:"best-param-modal__header",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"best-param-modal__title",children:"Tuned Hyperparameter Presets"}),a.jsx("p",{className:"best-param-modal__subtitle",children:"Review hyperparameter sets discovered by recent tuning runs and apply them to the current model."})]}),a.jsx("button",{type:"button",className:"best-param-modal__close",onClick:n,children:"Close"})]}),a.jsxs("div",{className:"best-param-modal__layout",children:[a.jsx("aside",{className:"best-param-modal__list","aria-label":"Tuned presets",children:e.map(E=>{const k=E.id===(d==null?void 0:d.id),j=E.finishedAt?hs(E.finishedAt):null;return a.jsxs("button",{type:"button",className:`best-param-modal__list-button${k?" best-param-modal__list-button--active":""}`,onClick:()=>u(E.id),children:[a.jsx("span",{className:"best-param-modal__list-title",children:E.label}),a.jsxs("span",{className:"best-param-modal__list-meta",children:[E.runNumber?`Run ${E.runNumber}`:"Tuning run",j?`  ${j}`:""]}),E.scoring&&a.jsxs("span",{className:"best-param-modal__list-score",children:[E.scoring,": ",D0(E.score)]}),E.targetColumn&&a.jsxs("span",{className:"best-param-modal__list-target",children:["Target: ",E.targetColumn]})]},E.id)})}),a.jsx("section",{className:"best-param-modal__details",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"best-param-modal__summary",children:[a.jsxs("div",{className:"best-param-modal__summary-main",children:[a.jsx("h4",{children:d.label}),a.jsxs("p",{children:[d.runNumber?`Run ${d.runNumber}`:"Tuning run",b?`  ${b}`:"",d.searchStrategy?`  ${d.searchStrategy}`:""]}),a.jsxs("p",{children:["Model: ",a.jsx("strong",{children:d.modelType}),d.targetColumn?a.jsxs(a.Fragment,{children:[" "," Target: ",a.jsx("strong",{children:d.targetColumn})]}):null,d.scoring?a.jsxs(a.Fragment,{children:[" "," ",d.scoring,": ",a.jsx("strong",{children:D0(d.score)})]}):null]})]}),a.jsx("div",{className:"best-param-modal__summary-actions",children:a.jsx("button",{type:"button",className:"best-param-modal__apply",onClick:()=>s(d),disabled:!y.length,children:p?"Already applied":"Apply preset"})})]}),d.description&&a.jsx("p",{className:"best-param-modal__note",children:d.description}),w&&a.jsxs("div",{className:"best-param-modal__notice best-param-modal__notice--warning",children:[a.jsx("strong",{children:"Tip:"})," ",w]}),a.jsx("div",{className:"best-param-modal__param-grid",role:"table",children:y.length?y.map(E=>a.jsxs("div",{className:"best-param-modal__param-row",role:"row",children:[a.jsxs("div",{className:"best-param-modal__param-name",role:"cell",children:[a.jsxs("div",{className:"best-param-modal__param-label",children:[E.label,E.label!==E.key&&a.jsx("span",{className:"best-param-modal__param-key",children:a.jsx("code",{children:E.key})})]}),E.description&&a.jsx("div",{className:"best-param-modal__param-description",children:E.description})]}),a.jsxs("div",{className:"best-param-modal__param-value",role:"cell",children:[a.jsx("code",{children:E.value}),E.note&&a.jsx("span",{className:"best-param-modal__param-note",children:E.note})]})]},E.key)):a.jsx("p",{className:"best-param-modal__empty",children:"No hyperparameters available for this preset."})})]}):a.jsx("p",{className:"best-param-modal__empty",children:"Select a tuning run to inspect its hyperparameters."})})]})]})]})},[l,p,i,t,s,n,e,d]);return h?H_.createPortal(h,document.body):null},TT=new Set(["scale_numeric_features","scaling","scale_numeric"]),$T=[/convergencewarning/i,/failed to converge/i,/did not converge/i,/optimizer failed to converge/i,/increase the number of iterations/i,/scale your features/i,/standardize your features/i,/consider scaling your (data|features)/i,/feature scaling is (recommended|required)/i],LT=["forest","tree","boost","xgboost","lightgbm","catboost","gradient","histgradient","bagging"],zT=["bayes","naive_bayes","gaussian_nb"],DT=e=>{const t=e.trim().toLowerCase();return t?LT.some(s=>t.includes(s))?{required:!1,reason:null}:zT.some(s=>t.includes(s))?{required:!1,reason:null}:t.includes("logistic")?{required:!0,reason:"logistic"}:t.includes("svm")||t.includes("svc")||t.includes("svr")?{required:!0,reason:"svm"}:t.includes("knn")||t.includes("nearest")?{required:!0,reason:"knn"}:t.includes("sgd")||t.includes("perceptron")?{required:!0,reason:"sgd"}:["linear","ridge","lasso","elastic","regression"].some(s=>t.includes(s))?{required:!0,reason:"linear"}:{required:!1,reason:null}:{required:!1,reason:null}},RT=(e,t)=>{const n=new Set;if(!e||!t)return n;const s=Array.isArray(e.edges)?e.edges:[],l=[t];for(;l.length;){const i=l.pop();if(i)for(const c of s){if(!c)continue;const u=typeof c.source=="string"?c.source.trim():"",d=typeof c.target=="string"?c.target.trim():"";!u||!d||d===i&&!n.has(u)&&(n.add(u),l.push(u))}}return n},FT=(e,t)=>{if(!e||!t)return!1;const n=RT(e,t);return n.size?(Array.isArray(e.nodes)?e.nodes:[]).some(l=>{var c;if(!l||typeof l.id!="string"||!n.has(l.id))return!1;const i=String(((c=l==null?void 0:l.data)==null?void 0:c.catalogType)??(l==null?void 0:l.type)??"").toLowerCase();return i?TT.has(i)?!0:i.includes("scale")&&i.includes("numeric"):!1}):!1},IT=(e,t)=>{const n=t.find(s=>(s==null?void 0:s.value)===e);return n!=null&&n.label?n.label:e.replace(/_/g," ").replace(/\s+/g," ").trim()},fg=(e,t=new Set,n=0)=>{if(e==null)return[];if(typeof e=="string")return[e];if(typeof e=="number"||typeof e=="boolean")return[];if(n>3)return[];if(Array.isArray(e)){if(!e.length)return[];const s=32,l=[];for(let i=0;i<e.length&&i<s;i+=1)l.push(...fg(e[i],t,n+1));return l}if(typeof e=="object"){if(t.has(e))return[];t.add(e);const s=Object.values(e);if(!s.length)return[];const l=32,i=[];for(let c=0;c<s.length&&c<l;c+=1)i.push(...fg(s[c],t,n+1));return i}return[]},Ci=e=>{if(!e)return!1;const t=fg(e);return t.length?t.some(n=>$T.some(s=>s.test(n))):!1},lu=e=>{var n,s,l,i,c,u,d,p,h,f,g,w,y,b;if(!e)return!1;const t=[e.error_message,e.warning_message,e.message,e.details,e.notes,e.status_reason,e.status_message,e.error,(n=e.metadata)==null?void 0:n.warnings,(s=e.metadata)==null?void 0:s.warning,(l=e.metadata)==null?void 0:l.notes,(i=e.metadata)==null?void 0:i.messages,(c=e.metadata)==null?void 0:c.message,(u=e.metadata)==null?void 0:u.errors,(d=e.metrics)==null?void 0:d.warnings,(p=e.metrics)==null?void 0:p.warning,(h=e.metrics)==null?void 0:h.messages,(f=e.metrics)==null?void 0:f.message,(g=e.job_metadata)==null?void 0:g.warnings,(w=e.job_metadata)==null?void 0:w.warning,(y=e.job_metadata)==null?void 0:y.messages,(b=e.job_metadata)==null?void 0:b.notes];for(const x of t)if(Ci(x))return!0;return!!(Ci(e.metadata)||Ci(e.metrics))},BT=(e,t,n)=>{const s=t||"This model";switch(e){case"logistic":return{headline:`${s} needs scaled numeric features`,summary:'Standardize numeric inputs before launching jobs to keep the logistic solver stable and avoid repeated "scale your features" warnings.',details:["Insert a Scale numeric features step before this node or reuse an upstream scaler.","StandardScaler works for most datasets; RobustScaler can help when outliers dominate.","Once scaling is in place, re-run tuning or training so the solver converges cleanly."]};case"svm":return{headline:`${s} is sensitive to feature scale`,summary:"Support Vector Machines depend on distance calculations. Keep numeric features on comparable scales to preserve margin geometry.",details:["Add the Scale numeric features step upstream of this node.","Try StandardScaler or MinMaxScaler depending on the kernel and expected ranges.","Retrain after scaling to refresh support vectors and hyperparameters."]};case"knn":return{headline:`${s} uses distance-based comparisons`,summary:"k-NN models weigh distances directly, so unscaled columns dominate neighbors. Scale numeric fields to keep votes balanced.",details:["Drop in a Scale numeric features step before launching jobs.","MinMaxScaler keeps features in [0, 1]; StandardScaler works when values are roughly normal.","Requeue jobs after scaling so neighbor search reflects the new feature space."]};case"sgd":return{headline:`${s} benefits from normalized inputs`,summary:"Stochastic gradient models converge faster and produce steadier coefficients when numeric inputs share a common scale.",details:["Insert a Scale numeric features node prior to this step.","StandardScaler plus optional RobustScaler for heavy-tailed features keeps gradients stable.","Re-run jobs after scaling to avoid exploding or vanishing updates."]};default:return{headline:`${s} prefers standardized numeric features`,summary:n==="regression"?"Linear regression families rely on comparable feature magnitudes. Scaling keeps coefficients well-conditioned and improves R stability.":"Linear classification models respond better when numeric inputs share a common scale. Scaling prevents any single column from dominating the loss.",details:["Add the Scale numeric features step ahead of this node or reuse an existing scaler.","StandardScaler is a safe default; RobustScaler helps when outliers skew distributions.","Re-launch jobs once scaling is applied so coefficients represent the standardized space."]}}},R0=({graph:e,nodeId:t,modelType:n,problemType:s,modelTypeOptions:l,enabled:i})=>v.useMemo(()=>{if(!i||!n||!n.trim()||FT(e,t))return null;const c=n.trim().toLowerCase(),{required:u,reason:d}=DT(c);if(!u||!d)return null;const p=IT(n,l);return BT(d,p,s)},[i,e,n,l,t,s]),UT={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},Si={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},pg=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([s,l])=>{t.has(s)&&(n[s]=l)}),n},F0=(e,t)=>{if(e===t||typeof e=="number"&&typeof t=="number"&&Number.isNaN(e)&&Number.isNaN(t))return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length!==t.length?!1:e.every((n,s)=>F0(n,t[s]));if(e&&t&&typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1},qT=(e,t,n)=>{if(!e)return{};const s={};return Object.entries(e).forEach(([l,i])=>{if(!t.has(l)||i===""||i===null||i===void 0)return;const c=n==null?void 0:n[l];let u=i;if(c){if(typeof u=="string"){const d=u.trim();if(!d)return;c.type==="select"&&(u=d)}if(c.name==="multi_class"&&typeof u=="string"){const d=u.trim().toLowerCase();if(d==="auto")return;(d==="ovr"||d==="multinomial")&&(u=d)}if(c.default!==void 0){if(typeof c.default=="string"&&typeof u=="string"){const d=c.default.trim(),p=u.trim();if(d===p)return}else if(F0(c.default,u))return}}s[l]=u}),s},I0=e=>!!e&&typeof e=="object"&&!Array.isArray(e),iu=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},HT=e=>{if(!e)return Si.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return Si.regression;if(t.includes("classifier")||t.includes("classification"))return Si.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?Si.regression:n==="classification"?Si.classification:Si.fallback},VT=e=>{var i,c,u;if(!e)return null;const t=[],n=(c=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:c.mean;I0(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const s=[e.test,e.validation,e.train];for(const d of s)I0(d)&&t.push({dataset:d,labelPrefix:""});const l=HT(e);for(const d of t)for(const p of l){const h=d.dataset[p];if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h}}for(const d of t)for(const[p,h]of Object.entries(d.dataset))if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h};return null},B0=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",WT=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:l,cvConfig:i,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,hyperparametersParameter:h,cvEnabledParameter:f,cvStrategyParameter:g,cvFoldsParameter:w,cvShuffleParameter:y,cvRandomStateParameter:b,cvRefitStrategyParameter:x,onSaveDraftConfig:N})=>{var ns,br,Es,Jr;const E=rl(),[k,j]=v.useState(null),[S,M]=v.useState(null),[$,T]=v.useState(null),[L,P]=v.useState(0),[O,D]=v.useState({}),[W,z]=v.useState(!1),R=v.useRef(!1),[U,V]=v.useState(null),[B,X]=v.useState(!1),[H,F]=v.useState(!1),[K,re]=v.useState(null),[G,q]=v.useState(null),[Y,Q]=v.useState(!1),ee=((s==null?void 0:s.targetColumn)??"").trim(),J=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",se=((l==null?void 0:l.modelType)??"").trim(),ke=(l==null?void 0:l.hyperparameters)??null,Pe=(l==null?void 0:l.hyperparametersError)??null,De=!!(i!=null&&i.enabled),Be=(i==null?void 0:i.strategy)??"auto",mt=typeof(i==null?void 0:i.folds)=="number"?i.folds:0,Ge=!!(i!=null&&i.shuffle),ue=(i==null?void 0:i.randomState)??null,ye=(i==null?void 0:i.refitStrategy)??"train_plus_validation",Me=v.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),Le=mr({queryKey:["model-hyperparameters",se],queryFn:()=>jm(se),enabled:!!se,staleTime:5*60*1e3}),Ve=mr({queryKey:["best-hyperparameters",se,U,t],queryFn:()=>mx(se,{pipelineId:U||void 0,datasetSourceId:t||void 0}),enabled:!!(se&&t),staleTime:30*1e3,retry:1}),ce=((ns=Le.data)==null?void 0:ns.fields)??[],Fe=((br=Le.data)==null?void 0:br.defaults)??{},et=v.useMemo(()=>ce.length?new Set(ce.map(le=>le.name)):new Set,[ce]),it=v.useMemo(()=>ce.length?ce.reduce((le,xe)=>(xe!=null&&xe.name&&(le[xe.name]=xe),le),{}):{},[ce]),at=v.useMemo(()=>{if(!se||!ke||et.size===0)return null;const le=pg(ke,et);return Object.keys(le).length>0?le:null},[et,ke,se]);v.useEffect(()=>{D({}),z(!1),R.current=!1},[se]),v.useEffect(()=>{at&&(D(le=>{const xe=Object.keys(le),Ue=Object.keys(at);return xe.length===Ue.length&&Ue.every(Ee=>Object.is(le[Ee],at[Ee]))?le:at}),R.current||(z(!0),R.current=!0))},[at]),v.useEffect(()=>{if(!se||at||et.size===0||!Fe||Object.keys(Fe).length===0)return;const le=pg(Fe,et);Object.keys(le).length!==0&&D(xe=>Object.keys(xe).length>0?xe:le)},[et,at,Fe,se]);const xt=v.useMemo(()=>{if(et.size===0)return null;const le=qT(O,et,it);return Object.keys(le).length>0?le:null},[et,O]),ot=v.useCallback(()=>{z(le=>{const xe=!le;return xe&&(R.current=!0),xe})},[]),$e=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),je=v.useMemo(()=>{if(!$e)return null;if(!c||Object.keys(c).length===0)return $e;const le=iu($e);return!le||!Array.isArray(le.nodes)||(le.nodes=le.nodes.map(xe=>{if(!xe||xe.id!==e)return xe;const Ue=(xe==null?void 0:xe.data)??{},Ee={...(Ue==null?void 0:Ue.config)??{},...c};return{...xe,data:{...Ue,config:Ee,isConfigured:!0}}})),le},[c,$e,e]);v.useEffect(()=>{let le=!1;return!t||!$e?(V(null),()=>{le=!0}):(ml(t,$e).then(xe=>{le||V(xe)}).catch(()=>{le||V(null)}),()=>{le=!0})},[$e,t]),v.useEffect(()=>{let le=!1;M(null);const xe=je??$e;return!t||!xe?(j(null),()=>{le=!0}):(ml(t,xe).then(Ue=>{le||j(Ue)}).catch(Ue=>{le||(M((Ue==null?void 0:Ue.message)??"Unable to compute pipeline ID"),j(null))}),()=>{le=!0})},[$e,je,t]),v.useEffect(()=>{if(!k||!U){X(!1);return}X(k!==U)},[k,U]);const Vt=v.useMemo(()=>["feature-canvas","training-jobs",t??"none",k??"pending",e],[e,k,t]),tt=v.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",k??"pending",e],[e,k,t]),Wt=!!(t&&e),ct=mr({queryKey:tt,queryFn:async()=>{var xe;const le={datasetSourceId:t||void 0,limit:5};if(k){const Ue=await Xc({...le,pipelineId:k});if((((xe=Ue==null?void 0:Ue.jobs)==null?void 0:xe.length)??0)>0)return Ue}return Xc(le)},enabled:Wt,retry:(le,xe)=>xe.message.includes("Sign in")?!1:le<2,refetchInterval:le=>{const xe=le.state.data;return((xe==null?void 0:xe.jobs)??[]).some(Ee=>Ee.status==="queued"||Ee.status==="running")?5e3:!1}}),Rt=mr({queryKey:Vt,queryFn:async()=>{var xe;const le={datasetSourceId:t||void 0,nodeId:e,limit:5};if(k){const Ue=await Qc({...le,pipelineId:k});if((((xe=Ue==null?void 0:Ue.jobs)==null?void 0:xe.length)??0)>0)return Ue}return Qc(le)},enabled:Wt,retry:(le,xe)=>xe.message.includes("Sign in")?!1:le<2,refetchInterval:le=>{const xe=le.state.data;return((xe==null?void 0:xe.jobs)??[]).some(Ee=>Ee.status==="queued"||Ee.status==="running")?5e3:!1}}),{mutateAsync:mn,isPending:$n,error:Ft}=qd({mutationFn:ix,onSuccess:le=>{const xe=Array.isArray(le.jobs)?le.jobs.length:0,Ue=xe>0?le.jobs[0]:null;T(Ue),P(xe),E.invalidateQueries({queryKey:Vt})}}),ln=ct.error,Hn=ct.isLoading||ct.isFetching,Gt=((Es=ct.data)==null?void 0:Es.jobs)??[],_t=Ve.data,es=v.useCallback(le=>{if(!le)return null;const xe=Object.keys(le);if(xe.length===0)return null;if(et.size===0)return{params:le,hasUnmapped:!1};const Ue=pg(le,et),$t=Object.keys(Ue);return $t.length>0?{params:Ue,hasUnmapped:$t.length!==xe.length}:{params:le,hasUnmapped:!0}},[et]),cn=v.useMemo(()=>Gt.length?Gt.filter(le=>le.status==="succeeded"):[],[Gt]),En=v.useMemo(()=>{if(!se)return[];const le=[],xe=new Set,Ue=ee?ee.trim().toLowerCase():"",$t=Ee=>!Ue||!Ee?!0:Ee.trim().toLowerCase()===Ue;if(_t!=null&&_t.available&&_t.best_params&&(!_t.model_type||_t.model_type===se)){const Ee=es(_t.best_params);if(Ee){const ut=_t.job_id??null;if(!ut||!xe.has(ut)){const gt=["Most recent tuned run"];_t.run_number&&gt.push(`#${_t.run_number}`);const Kt=`best-api-${ut??se}`;le.push({id:Kt,label:gt.join(" "),source:"best-api",modelType:_t.model_type??se,params:Ee.params,jobId:ut,nodeId:_t.node_id??null,runNumber:_t.run_number??null,score:_t.best_score??null,scoring:_t.scoring??null,finishedAt:_t.finished_at??null,searchStrategy:_t.search_strategy??null,nIterations:_t.n_iterations??null,targetColumn:ee||null,pipelineId:_t.pipeline_id??null,datasetSourceId:t??null,description:Ee.hasUnmapped?"Includes parameters outside the current template. They will be stored as custom overrides.":null}),ut&&xe.add(ut)}}}return cn.forEach(Ee=>{var xn,tr,gs,Dn,Kn;if(!Ee.best_params||Ee.model_type!==se||t&&Ee.dataset_source_id&&Ee.dataset_source_id!==t||xe.has(Ee.id))return;const ut=es(Ee.best_params);if(!ut)return;const gt=typeof((xn=Ee.metadata)==null?void 0:xn.target_column)=="string"?Ee.metadata.target_column:typeof((tr=Ee.metadata)==null?void 0:tr.targetColumn)=="string"?Ee.metadata.targetColumn:null;if(!$t(gt))return;const Kt=`job-${Ee.id}`,Bt=(()=>{var _s;const ks=typeof((_s=Ee.metadata)==null?void 0:_s.label)=="string"?Ee.metadata.label.trim():"";return ks||(Ee.run_number?`Run ${Ee.run_number}`:`Job ${Ee.id.slice(0,6)}`)})(),hn=typeof((gs=Ee.metadata)==null?void 0:gs.scoring)=="string"?Ee.metadata.scoring:typeof((Dn=Ee.metrics)==null?void 0:Dn.scoring)=="string"?Ee.metrics.scoring:null,Qt=typeof((Kn=Ee.metadata)==null?void 0:Kn.n_iterations)=="number"?Ee.metadata.n_iterations:null;le.push({id:Kt,label:Bt,source:"tuning-job",modelType:Ee.model_type,params:ut.params,jobId:Ee.id,nodeId:Ee.node_id,runNumber:Ee.run_number??null,score:Ee.best_score??null,scoring:hn,finishedAt:Ee.updated_at??Ee.created_at??null,searchStrategy:Ee.search_strategy??null,nIterations:Qt,targetColumn:gt??(ee||null),pipelineId:Ee.pipeline_id??null,datasetSourceId:Ee.dataset_source_id??null,description:ut.hasUnmapped?"Some tuned parameters fall outside the current template and will be saved as custom overrides.":null}),xe.add(Ee.id)}),le.sort((Ee,ut)=>{const gt=Ee.finishedAt?Date.parse(Ee.finishedAt):0,Kt=ut.finishedAt?Date.parse(ut.finishedAt):0;return gt!==Kt?Kt-gt:(ut.runNumber??0)-(Ee.runNumber??0)}),le},[_t,es,se,t,ee,cn]),yt=En[0]??null,Zs=En.length>0,nn=!yt,jt=!Zs,kt=v.useMemo(()=>cn.length?cn.slice().sort((le,xe)=>{const Ue=Date.parse(le.updated_at||le.created_at||"0");return Date.parse(xe.updated_at||xe.created_at||"0")-Ue})[0]:Gt.length?Gt.slice().sort((le,xe)=>{const Ue=Date.parse(le.updated_at||le.created_at||"0");return Date.parse(xe.updated_at||xe.created_at||"0")-Ue})[0]:null,[cn,Gt]),Cs=kt&&(kt.updated_at||kt.created_at)||null,vn=Cs?hs(Cs):null,Ln=(kt==null?void 0:kt.run_number)??null,yn=yt!=null&&yt.finishedAt?hs(yt.finishedAt):null,Vn=yt&&yt.scoring&&typeof yt.score=="number"&&Number.isFinite(yt.score)?`${yt.scoring}: ${B0(yt.score)}`:null;v.useEffect(()=>{if(!En.length){K&&re(null),(G==null?void 0:G.tone)==="success"&&q(null);return}K&&!En.some(le=>le.id===K)&&(re(null),q(null))},[G,En,K]);const bn=v.useCallback((le,xe)=>{if(!le||Object.keys(le.params??{}).length===0){q({message:"Selected preset does not include any hyperparameters to apply.",tone:"warning"});return}D(()=>iu(le.params)),z(!0),R.current=!0,re(le.id),q({message:xe??`Applied tuned parameters from ${le.label}.`,tone:"success"})},[D,z,q,re]),Ss=v.useCallback(()=>{if(!yt){const xe=kt&&kt.model_type&&kt.model_type!==se?`Latest tuning run targeted ${kt.model_type}. Switch the model template to reuse its parameters.`:"No tuning job results available to apply.";q({message:xe,tone:"warning"});return}const le=yt.runNumber?`Applied tuned parameters from run ${yt.runNumber}.`:`Applied tuned parameters from ${yt.label}.`;bn(yt,le)},[bn,kt,se,yt,q]),Yt=v.useMemo(()=>{if(!G)return"rgba(148, 163, 184, 0.75)";switch(G.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[G]),ts=v.useMemo(()=>{const le=[];return t||le.push("Select a dataset before launching training jobs."),(!$e||!$e.nodes.length)&&le.push("Connect this node to an upstream pipeline before training."),ee||le.push("Set a target column in the Train model readiness section."),se||le.push("Choose a model type before enqueuing training jobs."),De&&mt<2&&le.push("Cross-validation requires at least 2 folds."),S&&le.push(S),Pe&&le.push(Pe),le},[De,mt,$e,Pe,se,S,t,ee]),Wn=((Jr=Rt.data)==null?void 0:Jr.jobs)??[],zn=v.useMemo(()=>{if(!Wn.length)return Wn;const le=J==null?void 0:J.toLowerCase();return Wn.filter(xe=>{if(!le)return!0;const Ue=(()=>{var Kt,Bt,hn,Qt;const Ee=typeof xe.problem_type=="string"?xe.problem_type:null,ut=typeof((Kt=xe.metadata)==null?void 0:Kt.problem_type)=="string"?(Bt=xe.metadata)==null?void 0:Bt.problem_type:null,gt=typeof((hn=xe.metadata)==null?void 0:hn.resolved_problem_type)=="string"?(Qt=xe.metadata)==null?void 0:Qt.resolved_problem_type:null;return(Ee||gt||ut||"").toLowerCase()})();if(Ue)return Ue===le;const $t=String(xe.model_type||"").toLowerCase();return le==="regression"?$t.includes("regress"):le==="classification"?$t.includes("classif"):!0})},[Wn,J]),Tr=v.useMemo(()=>!!(Ft instanceof Error&&Ci(Ft.message)||$&&lu($)||Wn.some(le=>lu(le))||Gt.some(le=>lu(le))),[Ft,Wn,$,Gt]),fs=R0({graph:n,nodeId:e,modelType:se,problemType:J,modelTypeOptions:p,enabled:Tr});v.useEffect(()=>{fs||Q(!1)},[fs]);const er=Math.max(Wn.length-zn.length,0),Rs=Rt.isLoading||Rt.isFetching,Fs=Rt.error,yr=ts.length>0||!k||!t||!$e||$n,ps=v.useCallback((le,xe)=>{D(Ue=>({...Ue,[le]:xe}))},[]),rn=v.useCallback(le=>{var $t;const xe=O[le.name]??le.default,Ue=`hyperparam-${e}-${le.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Ue,className:"canvas-modal__parameter-label",children:[le.label,le.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:le.description})]}),le.type==="number"&&a.jsx("input",{id:Ue,type:"number",className:"canvas-modal__parameter-input",value:xe??"",onChange:Ee=>{const ut=Ee.target.value;if(ut===""&&le.nullable)ps(le.name,null);else{const gt=parseFloat(ut);isNaN(gt)||ps(le.name,gt)}},min:le.min,max:le.max,step:le.step,placeholder:le.nullable?"Empty = default":""}),le.type==="select"&&a.jsx("select",{id:Ue,className:"canvas-modal__parameter-select",value:xe??"",onChange:Ee=>ps(le.name,Ee.target.value),children:($t=le.options)==null?void 0:$t.map(Ee=>a.jsx("option",{value:Ee.value,children:Ee.label},Ee.value))}),le.type==="boolean"&&a.jsx("input",{id:Ue,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!xe,onChange:Ee=>ps(le.name,Ee.target.checked)}),le.type==="text"&&a.jsx("input",{id:Ue,type:"text",className:"canvas-modal__parameter-input",value:xe??"",onChange:Ee=>ps(le.name,Ee.target.value),placeholder:le.nullable?"Empty = default":""})]},le.name)},[O,ps,e]),It=v.useCallback(async()=>{if(!k||!t||!se)return;if(B&&N){try{const gt=N({closeModal:!1});gt&&typeof gt.then=="function"&&await gt,X(!1)}catch{}await new Promise(gt=>setTimeout(gt,100))}const le=je??$e;if(!le)return;const xe={};ee&&(xe.target_column=ee),xe.problem_type=J,xe.cross_validation={enabled:De,strategy:Be,folds:mt,shuffle:Ge,random_state:ue,refit_strategy:ye};const Ue=Object.keys(xe).length?xe:void 0,$t=iu(le);$t&&Array.isArray($t.nodes)&&($t.nodes=$t.nodes.map(gt=>{if(!gt||gt.id!==e)return gt;const Kt=(gt==null?void 0:gt.data)??{},Bt=(Kt==null?void 0:Kt.config)??{},hn=c?{...Bt,...c}:Bt;return{...gt,data:{...Kt,config:hn,isConfigured:!0}}}));const Ee=se?[se]:[],ut={dataset_source_id:t,pipeline_id:k,node_id:e,model_type:se||void 0,model_types:Ee.length?Ee:void 0,hyperparameters:W&&xt?iu(xt):void 0,metadata:Ue,job_metadata:Ue,run_training:!0,graph:$t??iu(le),target_node_id:e};try{await mn(ut)}catch{}},[De,mt,ue,ye,Ge,Be,c,mn,$e,je,B,se,e,N,k,J,xt,W,t,ee]),ht=v.useCallback(()=>{Wt&&Rt.refetch()},[Wt,Rt]),$r=le=>{var xn,tr,gs,Dn;const xe=VT(le.metrics??null),Ue=le.updated_at?hs(le.updated_at):null,$t=le.updated_at||le.created_at,Ee=$t?Ue??new Date($t).toLocaleString():null,ut=UT[le.status]??le.status,gt=(le.problem_type||((xn=le.metadata)==null?void 0:xn.resolved_problem_type)||((tr=le.metadata)==null?void 0:tr.problem_type)||"").toString(),Kt=((gs=le.metadata)==null?void 0:gs.cross_validation)??null,Bt=((Dn=le.metrics)==null?void 0:Dn.cross_validation)??null,hn=typeof le.error_message=="string"?le.error_message.trim():"",Qt=[];if(Qt.push(`Model ${le.model_type}`),gt&&Qt.push(gt.charAt(0).toUpperCase()+gt.slice(1)),Kt!=null&&Kt.enabled){const Kn=String(Kt.strategy??"auto"),ks=Kn==="stratified_kfold"?"Stratified KFold":Kn==="kfold"?"KFold":"Auto CV",_s=typeof Kt.folds=="number"?`${Kt.folds} folds`:"CV enabled";if(Qt.push(`${ks} (${_s})`),(Bt==null?void 0:Bt.status)==="skipped"){const Co=String((Bt==null?void 0:Bt.reason)??"unknown reason").replace(/_/g," ");Qt.push(`CV skipped (${Co})`)}}else if((Bt==null?void 0:Bt.status)==="skipped"){const Kn=String((Bt==null?void 0:Bt.reason)??"unknown reason").replace(/_/g," ");Qt.push(`CV skipped (${Kn})`)}if(xe&&Qt.push(`${xe.label}: ${B0(xe.value)}`),le.status==="failed"&&hn){const Kn=hn.replace(/\s+/g," ");Qt.push(`Error: ${Kn}`)}return Ee&&Qt.push(`Updated ${Ee}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["v",le.version]}),"  ",ut,Qt.length>0?`  ${Qt.join("  ")}`:""]},le.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:ht,disabled:!Wt||Rs,children:Rs?"Refreshing":"Refresh jobs"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),k&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:k})]}),B&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]}),ts.map((le,xe)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:le},`training-prereq-${xe}`)),Ft instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Ft.message}),Fs&&!(Ft instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Fs.message||"Unable to load training jobs."}),ln&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:ln.message||"Unable to load tuning jobs."}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:L>1?a.jsxs("span",{children:["Queued ",L," training jobs. Latest job ",$.id," (version ",$.version,")."]}):a.jsxs("span",{children:["Training job ",$.id," queued (version ",$.version,")."]})}),Hn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Me&&u(Me),f&&u(f),De&&a.jsxs(a.Fragment,{children:[g&&u(g),w&&u(w),y&&u(y),b&&u(b),x&&u(x)]}),se&&ce.length>0&&a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:W?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),(yt||kt)&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:yt?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:yt.modelType}),yt.runNumber?` (run ${yt.runNumber})`:"",yn?`  ${yn}`:"",yt.targetColumn?`  Target: ${yt.targetColumn}`:"",Vn?`  ${Vn}`:""]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",Ln||"N/A",vn?`  ${vn}`:"",kt!=null&&kt.model_type&&kt.model_type!==se?` targeted ${kt.model_type}.`:" did not produce reusable parameters for this configuration yet."]})}),G&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:Yt},children:G.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",onClick:Ss,disabled:nn,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:nn?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:nn?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:nn?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:nn?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:nn?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply tuned params"}),a.jsx("button",{type:"button",onClick:()=>F(!0),disabled:jt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:jt?"rgba(148, 163, 184, 0.55)":"rgba(168, 85, 247, 0.95)",background:jt?"rgba(15, 23, 42, 0.35)":"rgba(76, 29, 149, 0.18)",border:jt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(168, 85, 247, 0.45)",borderRadius:"4px",cursor:jt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"150px"},children:"Browse tuned params"}),a.jsx("button",{type:"button",onClick:ot,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:W?"#fff":"rgba(148, 163, 184, 0.85)",background:W?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(15, 23, 42, 0.6)",border:W?"none":"1px solid rgba(148, 163, 184, 0.45)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:W?"0 4px 12px rgba(118, 75, 162, 0.25)":"none"},onMouseEnter:le=>{W?le.currentTarget.style.boxShadow="0 6px 16px rgba(118, 75, 162, 0.35)":(le.currentTarget.style.borderColor="rgba(148, 163, 184, 0.65)",le.currentTarget.style.background="rgba(15, 23, 42, 0.8)")},onMouseLeave:le=>{W?le.currentTarget.style.boxShadow="0 4px 12px rgba(118, 75, 162, 0.25)":(le.currentTarget.style.borderColor="rgba(148, 163, 184, 0.45)",le.currentTarget.style.background="rgba(15, 23, 42, 0.6)")},children:W?" Advanced":"Default"})]})]})}),se&&Le.isLoading&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),se&&Le.error&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",Le.error.message]}),se&&W&&ce.length>0&&a.jsxs("div",{style:{gridColumn:"1 / -1",padding:"1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginTop:"0.5rem"},children:[a.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid rgba(102, 126, 234, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600",color:"#e2e8f0"},children:"Advanced Hyperparameters"}),a.jsxs("p",{style:{margin:"0",fontSize:"0.875rem",color:"rgba(148, 163, 184, 0.85)",lineHeight:"1.5"},children:["Configure ",se.replace(/_/g," ")," hyperparameters. Leave empty to use recommended defaults."]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:ce.map(rn)})]}),!se&&h&&u(h)]}),De&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",mt," folds before refitting on"," ",ye==="train_plus_validation"?"training plus validation data.":"training data only."]}),fs&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",fs.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:fs.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>Q(le=>!le),style:{whiteSpace:"nowrap"},children:Y?"Hide tips":"Show tips"})]}),Y&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:fs.details.map((le,xe)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:le},`scaling-tip-${xe}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:It,disabled:yr,children:$n?"Queuing":"Launch training job"})}),Rs&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),er>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:er===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${er} training jobs use a different problem type. Switch the problem type to view them.`}),!Rs&&zn.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),zn.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:zn.map($r)}),a.jsx(PT,{presets:En,isOpen:H,onClose:()=>F(!1),onApply:le=>{bn(le),F(!1)},activePresetId:K,fieldMetadata:it})]})},KT=new Set(["true","1","yes","on"]),YT=new Set(["false","0","no","off"]),GT=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],U0=new Set(["true","1","yes","y","on","t"]),q0=new Set(["false","0","no","n","off","f"]),fl=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(KT.has(t))return!0;if(YT.has(t))return!1}return null},Ei=e=>{if(!(!e||typeof e!="object")){for(const t of GT)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},gg=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},_g=e=>Array.isArray(e)?e.map(t=>_g(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=_g(e[n]),t),{}):e,cu=e=>e===void 0?"":JSON.stringify(_g(e)),H0=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},QT=(e,t)=>{const n=[],s=f=>{n.includes(f)||n.push(f)},l=(e??"").toLowerCase();if(!t.length)return n;const i=t.filter(f=>f!=null);if(!i.length)return n;const c=i.reduce((f,g)=>{if(typeof g=="number"&&Number.isFinite(g))return f+1;if(typeof g=="string"){const w=g.trim();if(!w)return f;const y=Number(w);if(!Number.isNaN(y)&&Number.isFinite(y))return f+1}return f},0),u=i.reduce((f,g)=>{const w=String(g).trim().toLowerCase();return w&&(U0.has(w)||q0.has(w))?f+1:f},0),d=(()=>{const f=new Set;return i.forEach(g=>{f.add(String(g).trim().toLowerCase())}),f.size})(),p=c/i.length,h=u/i.length;if(l.includes("object")||l.includes("string"))return h>=.7&&s("boolean"),p>=.7&&s("float64"),d>0&&d<=20&&s("category"),n;if(l.includes("float")){const f=i.reduce((g,w)=>{if(typeof w=="number")return Number.isInteger(w)?g+1:g;if(typeof w=="string"){const y=w.trim();if(!y)return g;const b=Number(y);if(!Number.isNaN(b)&&Number.isFinite(b)&&Number.isInteger(b))return g+1}return g},0);return h>=.8&&s("boolean"),i.length>0&&f/i.length>=.9&&s("Int64"),n}return l.includes("int")&&h>=.7&&s("boolean"),n},$m=[{value:"train",label:"Train",accent:"train"},{value:"test",label:"Test",accent:"test"},{value:"validation",label:"Validation",accent:"validation"}],Lm={train:0,test:1,validation:2},XT=["train","test","validation"],vg=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],uu=e=>{const t=new Set($m.map(l=>l.value)),n=[];e.forEach(l=>{if(l){if(l==="training"&&(l="train"),l==="valid"||l==="val"){n.push("validation");return}t.has(l)&&n.push(l)}});const s=new Set;return n.filter(l=>s.has(l)?!1:(s.add(l),!0)).sort((l,i)=>Lm[l]-Lm[i])},JT=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},yg=(e,t)=>{const n=fl(e);return n===null?t:n},V0=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},W0=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},K0=e=>{const t=$m.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},ZT=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},e2=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${ZT(e.status)}`);const n=hs(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},zm=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,Y0=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,s])=>{typeof s=="number"&&Number.isFinite(s)&&t.push({key:n,value:s})}),t.sort((n,s)=>n.key.localeCompare(s.key)),t},G0=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},t2=({nodeId:e,sourceId:t,graph:n,config:s,setConfigState:l,renderParameterField:i,formatMetricValue:c,connectedSplitHandles:u})=>{var Ge;const d=rl(),p=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),h=v.useMemo(()=>{if(!p)return[];const ue=new Map;p.nodes.forEach(Me=>{Me!=null&&Me.id&&ue.set(Me.id,Me)});const ye=new Set;return p.edges.forEach(Me=>{var Ve;if(!Me||Me.target!==e)return;const Le=ue.get(Me.source);((Ve=Le==null?void 0:Le.data)==null?void 0:Ve.catalogType)==="train_model_draft"&&ye.add(Le.id)}),ye.size>0?Array.from(ye):p.nodes.filter(Me=>{var Le;return((Le=Me==null?void 0:Me.data)==null?void 0:Le.catalogType)==="train_model_draft"}).map(Me=>Me.id)},[p,e]),f=v.useMemo(()=>h.length?h.slice().sort().join("|"):"all",[h]),[g,w]=v.useState(null),[y,b]=v.useState(null);v.useEffect(()=>{let ue=!1;return b(null),!t||!p?(w(null),()=>{ue=!0}):(ml(t,p).then(ye=>{ue||w(ye)}).catch(ye=>{ue||(b((ye==null?void 0:ye.message)??"Unable to compute pipeline signature."),w(null))}),()=>{ue=!0})},[p,t]);const x=v.useMemo(()=>{const ue=s==null?void 0:s.training_job_id;return typeof ue=="string"?ue.trim():typeof ue=="number"?String(ue):""},[s==null?void 0:s.training_job_id]),N=v.useMemo(()=>uu(vg(s==null?void 0:s.splits)),[s==null?void 0:s.splits]),E=v.useMemo(()=>N.length?N:XT,[N]);v.useEffect(()=>{u&&l(ue=>{const ye=ue??{},Me=uu(vg(ye.splits)),Le=Me.filter(ce=>u[ce]!==!1);if(Le.length===Me.length&&Le.every((ce,Fe)=>ce===Me[Fe]))return ue;const Ve={...ye};return Le.length?Ve.splits=Le:delete Ve.splits,Ve})},[u,l]);const k=v.useMemo(()=>u?E.filter(ue=>u[ue]!==!1):E,[u,E]),j=v.useMemo(()=>u?$m.filter(ue=>u[ue.value]===!1).map(ue=>ue.label):[],[u]),S=v.useMemo(()=>{if(!j.length)return"";if(j.length===1)return j[0];if(j.length===2)return`${j[0]} and ${j[1]}`;const ue=j[j.length-1];return`${j.slice(0,-1).join(", ")}, and ${ue}`},[j]),M=k.length>0,$=yg(s==null?void 0:s.include_confusion,!0),T=yg(s==null?void 0:s.include_curves,!0),L=yg(s==null?void 0:s.include_residuals,!0),P=V0(s==null?void 0:s.max_curve_points,500),O=V0(s==null?void 0:s.max_scatter_points,750),D=typeof(s==null?void 0:s.last_evaluated_at)=="string"?s.last_evaluated_at:null,[W,z]=v.useState(null),[R,U]=v.useState("details"),V=v.useRef(!1);v.useEffect(()=>{z(null),V.current=!1},[x]),v.useEffect(()=>{U("details")},[W==null?void 0:W.job_id]);const B=v.useMemo(()=>["feature-canvas","model-evaluation",t??"none",g??"pending",f],[g,t,f]),X=mr({queryKey:B,queryFn:async()=>{const ue={datasetSourceId:t||void 0,limit:50},ye=new Map,Me=[];let Le=null;const Ve=it=>{Array.isArray(it)&&it.forEach(at=>{at&&!ye.has(at.id)&&ye.set(at.id,at)})},ce=async it=>{try{const at=await Qc(it);return Ve(at==null?void 0:at.jobs),at}catch(at){return at instanceof Error&&Me.push(at),null}};if(g&&await ce({...ue,pipelineId:g}),h.length&&await Promise.all(h.map(it=>ce({...ue,nodeId:it}))),Le=await ce(ue),!ye.size){if(Le)return Le;if(Me.length)throw Me[0];return{jobs:[],total:0}}const Fe=Array.from(ye.values());Fe.sort((it,at)=>W0(at.updated_at??at.created_at)-W0(it.updated_at??it.created_at));const et=(Le==null?void 0:Le.total)??Fe.length;return{jobs:Fe,total:et}},enabled:!!t,staleTime:30*1e3,retry:(ue,ye)=>ye.message.includes("Sign in")?!1:ue<2,refetchInterval:ue=>{const ye=ue.state.data;return((ye==null?void 0:ye.jobs)??[]).some(Ve=>Ve.status==="queued"||Ve.status==="running")?5e3:!1}}),H=((Ge=X.data)==null?void 0:Ge.jobs)??[],F=v.useMemo(()=>{const ue=new Map;return H.forEach(ye=>{ue.set(ye.id,ye)}),ue},[H]),K=v.useMemo(()=>H.filter(ue=>ue.status==="succeeded"),[H]),re=v.useMemo(()=>K.map(ue=>({value:ue.id,label:e2(ue)})),[K]),G=x?F.get(x)??null:null,q=mr({queryKey:["feature-canvas","training-job",x||"none"],queryFn:()=>cx(x),enabled:!!x,staleTime:30*1e3});v.useEffect(()=>{var it,at;const ue=q.data;if(!ue)return;const ye=(it=ue.metrics)==null?void 0:it.evaluation;if(!ye||typeof ye!="object")return;const Me=ye.splits;if(!Me||typeof Me!="object")return;const Le={};Object.entries(Me).forEach(([xt,ot])=>{ot&&typeof ot=="object"&&(Le[xt]=ot)});const Ve=typeof ye.generated_at=="string"?ye.generated_at:D??ue.updated_at??ue.created_at??new Date().toISOString(),ce=ye.problem_type==="regression"?"regression":"classification",Fe={job_id:ue.id,pipeline_id:ue.pipeline_id,node_id:ue.node_id,generated_at:Ve,problem_type:ce,target_column:ye.target_column??((at=ue.metadata)==null?void 0:at.target_column)??null,splits:Le};z(Fe),Ve&&Ve!==D&&l(xt=>({...xt??{},last_evaluated_at:Ve}));const et=uu(Object.keys(Le));et.length&&!V.current&&!JT(N,et)&&l(xt=>({...xt??{},splits:et}))},[q.data,D,l,N]);const Y=qd({mutationFn:async ue=>{if(!x)throw new Error("Select a training job before running evaluation.");return ux(x,ue)},onSuccess:ue=>{z(ue),l(ye=>({...ye??{},training_job_id:x,splits:ue.splits?Object.keys(ue.splits):k,include_confusion:$,include_curves:T,include_residuals:L,max_curve_points:P,max_scatter_points:O,last_evaluated_at:ue.generated_at})),d.invalidateQueries({queryKey:["feature-canvas","training-job",x]})}}),Q=v.useCallback(ue=>{const ye=ue.target.value;Y.reset(),l(Me=>{const Le={...Me??{}};return ye?Le.training_job_id=ye:delete Le.training_job_id,Le})},[Y,l]),ee=v.useCallback(ue=>{u&&u[ue]===!1||(Y.reset(),V.current=!0,l(ye=>{const Me=uu(vg(ye==null?void 0:ye.splits)),Le=Me.includes(ue);let Ve;if(Le){if(Me.length<=1)return ye??{};Ve=Me.filter(ce=>ce!==ue)}else Ve=uu([...Me,ue]);return{...ye??{},splits:Ve}}))},[u,Y,l]),J=v.useCallback((ue,ye)=>{Y.reset(),l(Me=>({...Me??{},[ue]:ye}))},[Y,l]),se=v.useCallback(()=>{if(!x)return;const ue={splits:k,include_confusion:$,include_curves:T,include_residuals:L,max_curve_points:T?P:void 0,max_scatter_points:L?O:void 0};Y.mutate(ue)},[Y,$,T,L,P,O,x,k]),ke=W?hs(W.generated_at):D?hs(D):null,Pe=v.useMemo(()=>W?Object.entries(W.splits).sort((ue,ye)=>{const[Me]=ue,[Le]=ye,Ve=Lm[Me]??99,ce=Lm[Le]??99;return Ve-ce}):[],[W]),De=v.useMemo(()=>{if(!W||!Pe.length)return null;const ue=Pe.map(([Me,Le])=>{const Ve=Y0(Le.metrics).reduce((ce,Fe)=>(ce[Fe.key]=Fe.value,ce),{});return{key:Me,label:K0(Me),rowCount:typeof Le.row_count=="number"?Le.row_count:null,metrics:Ve}}),ye=Array.from(new Set(ue.flatMap(Me=>Object.keys(Me.metrics)))).sort((Me,Le)=>Me.localeCompare(Le));return{splits:ue,metricKeys:ye}},[Pe,W]),Be=v.useMemo(()=>De?De.splits.length<=1?"Connect at least two splits to compare results.":De.metricKeys.length?null:"No numeric metrics available for comparison yet.":"Run an evaluation to compare metrics.",[De]);v.useEffect(()=>{R==="comparison"&&Be&&U("details")},[R,Be]);const mt=v.useCallback(ue=>{ue==="comparison"&&Be||U(ue)},[Be]);return a.jsxs("div",{className:"node-settings__section node-settings__evaluation",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:ke&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",ke]})})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:x,onChange:Q,disabled:X.isLoading||X.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),re.map(ue=>a.jsx("option",{value:ue.value,children:ue.label},ue.value))]}),X.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),X.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:X.error.message}),!X.isLoading&&!re.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),y&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:y})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:$m.map(ue=>{const ye=u?u[ue.value]!==!1:!0,Me=ye&&k.includes(ue.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${ue.accent} ${Me?"evaluation-chip--active":""}`,"aria-disabled":!ye,title:ye?void 0:`${ue.label} split is not connected`,style:ye?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:Me,disabled:!ye,onChange:()=>ee(ue.value)}),a.jsx("span",{children:ue.label})]},ue.value)})}),j.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",S," split",j.length>1?"s":""," to enable diagnostics."]}),!M&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a train, validation, or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:ue=>J("include_confusion",ue.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:ue=>J("include_curves",ue.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:ue=>J("include_residuals",ue.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:se,disabled:!x||Y.isPending||!M,children:Y.isPending?"Running":"Run evaluation"}),G&&G.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!M&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),Y.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:Y.error.message}),Y.isSuccess&&W&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",hs(W.generated_at),"."]}),q.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:q.error.message})]}),W?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:W.problem_type==="regression"?"Regression":"Classification"})]}),W.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:W.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:hs(W.generated_at)??W.generated_at})]})]}),a.jsxs("div",{className:"evaluation-tabs",role:"tablist","aria-label":"Evaluation views",children:[a.jsx("button",{type:"button",className:`evaluation-tab ${R==="details"?"evaluation-tab--active":""}`,role:"tab","aria-selected":R==="details",onClick:()=>mt("details"),children:"Split details"}),a.jsx("button",{type:"button",className:`evaluation-tab ${R==="comparison"?"evaluation-tab--active":""}`,role:"tab","aria-selected":R==="comparison","aria-disabled":!!Be,disabled:!!Be,title:Be??void 0,onClick:()=>mt("comparison"),children:"Split comparison"})]}),R==="comparison"&&De?a.jsx(n2,{comparison:De,formatMetricValue:c}):Pe.map(([ue,ye])=>a.jsx(s2,{splitKey:ue,payload:ye,problemType:W.problem_type,formatMetricValue:c},ue))]}):a.jsx("div",{className:"evaluation-placeholder",children:x?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},n2=({comparison:e,formatMetricValue:t})=>e.metricKeys.length?a.jsx("section",{className:"evaluation-comparison",children:a.jsx("div",{className:"evaluation-comparison__table-wrapper",children:a.jsxs("table",{className:"evaluation-comparison__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Metric"}),e.splits.map(n=>a.jsx("th",{children:n.label},n.key))]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"evaluation-comparison__row evaluation-comparison__row--muted",children:[a.jsx("td",{children:"Rows evaluated"}),e.splits.map(n=>a.jsx("td",{children:typeof n.rowCount=="number"?n.rowCount.toLocaleString():""},`${n.key}-rows`))]}),e.metricKeys.map(n=>a.jsxs("tr",{className:"evaluation-comparison__row",children:[a.jsx("td",{children:n}),e.splits.map(s=>a.jsx("td",{children:typeof s.metrics[n]=="number"?t(s.metrics[n]):""},`${s.key}-${n}`))]},n))]})]})})}):a.jsx("div",{className:"evaluation-placeholder",children:a.jsx("p",{children:"No numeric metrics were reported across splits for comparison."})}),s2=({splitKey:e,payload:t,problemType:n,formatMetricValue:s})=>{const l=Y0(t.metrics),i=l.length>0,c=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[K0(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),i?a.jsx("div",{className:"evaluation-metrics__grid",children:l.map(u=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:u.key}),a.jsx("span",{className:"evaluation-metrics__value",children:s(u.value)})]},u.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(r2,{matrix:t.confusion_matrix,formatMetricValue:s}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(u=>a.jsx(a2,{curve:u,formatMetricValue:s},`roc-${u.label}`)),t.pr_curves.map(u=>a.jsx(o2,{curve:u,formatMetricValue:s},`pr-${u.label}`))]}),n==="regression"&&t.residuals&&a.jsx(i2,{residuals:t.residuals,formatMetricValue:s})]}),c.length>0&&a.jsx("ul",{className:"evaluation-notes",children:c.map((u,d)=>a.jsx("li",{children:u},`${e}-note-${d}`))})]})},r2=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],s=Array.isArray(e.totals)?e.totals:[],l=Array.isArray(e.normalized)?e.normalized:[],i=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),i!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",G0(i,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((c,u)=>a.jsx("th",{children:c},`pred-${u}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((c,u)=>{const d=l[u]??[],p=s[u]??c.reduce((h,f)=>h+f,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[u]??`Class ${u}`}),c.map((h,f)=>{const g=typeof d[f]=="number"?d[f]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:h}),g!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:G0(g,t)})]},`cell-${u}-${f}`)}),a.jsx("td",{children:p})]},`row-${u}`)})})]})]})},a2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,s=240,l=28,i=n-l*2,c=s-l*2,u=e.fpr.map((d,p)=>{const h=l+zm(d)*i,f=s-l-zm(e.tpr[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:l,y:l,width:i,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:l,y1:s-l,x2:n-l,y2:l,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:l,y1:l,x2:l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("line",{x1:l,y1:s-l,x2:n-l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},o2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,s=240,l=28,i=n-l*2,c=s-l*2,u=e.recall.map((d,p)=>{const h=l+zm(d)*i,f=s-l-zm(e.precision[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:l,y:l,width:i,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:l,y1:l,x2:l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("line",{x1:l,y1:s-l,x2:n-l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},l2={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},i2=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(s=>typeof s[1]=="number"&&Number.isFinite(s[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([s,l])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:l2[s]??s}),a.jsx("span",{className:"evaluation-summary__value",children:t(l)})]},s))}),a.jsx(c2,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx(u2,{points:e.scatter})]})},c2=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const s=t.reduce((l,i)=>Math.max(l,i),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((l,i)=>{const c=l/s*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${l} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${c}%`}})},`bin-${i}`)})})},u2=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,s=36,l=e.map(g=>g.actual),i=e.map(g=>g.predicted),c=Math.min(...l,...i),u=Math.max(...l,...i),d=u-c||1,p=g=>(g-c)/d,h=g=>s+p(g)*(t-s*2),f=g=>n-s-p(g)*(n-s*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:s,y:s,width:t-s*2,height:n-s*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:s,y1:n-s,x2:t-s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:s,y1:s,x2:s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:h(c),y1:f(c),x2:h(u),y2:f(u),className:"evaluation-curve__baseline"}),e.map((g,w)=>a.jsx("circle",{cx:h(g.actual),cy:f(g.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${w}`))]})})},d2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},m2={queued:"info",running:"info",succeeded:"success",failed:"danger",cancelled:"neutral"},ki={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score"],regression:["rmse","mae","r2","mape"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},Q0=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted"],X0=["rmse","mae","r2","mape"],J0=new Set(["rmse","mae","mape","mse"]),Z0={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},_r=e=>!!e&&typeof e=="object"&&!Array.isArray(e),h2=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},bg=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",f2=e=>{if(!e)return ki.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return ki.regression;if(t.includes("class")||t.includes("classification"))return ki.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?ki.regression:n==="classification"?ki.classification:ki.fallback},p2=e=>{var l,i,c;if(!_r(e))return null;const t=[],n=(i=(l=e==null?void 0:e.cross_validation)==null?void 0:l.metrics)==null?void 0:i.mean;_r(n)&&((c=e==null?void 0:e.cross_validation)==null?void 0:c.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),_r(e.test)&&t.push({values:e.test,labelPrefix:""}),_r(e.validation)&&t.push({values:e.validation,labelPrefix:""}),_r(e.train)&&t.push({values:e.train,labelPrefix:""});const s=f2(e);for(const u of t)for(const d of s){const p=u.values[d];if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p}}for(const u of t)for(const[d,p]of Object.entries(u.values))if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p};return null},g2=e=>{var n,s;if(!_r(e))return{label:null,values:{}};if(_r(e.test))return{label:"Test",values:e.test};if(_r(e.validation))return{label:"Validation",values:e.validation};const t=(s=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:s.mean;return _r(t)?{label:"CV mean",values:t}:_r(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},ew=e=>{if(!e)return"Unknown model";const t=e.trim();return Z0[t]?Z0[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},_2=e=>{var i,c;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const u of n)if(typeof u=="string"){const d=u.trim().toLowerCase();if(d==="classification"||d==="regression")return d}const s=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(s.includes("classifier")||s.includes("classification"))return"classification";if(s.includes("regress")||s.includes("regression"))return"regression";const l=e.metrics;if(_r(l)){const u=new Set,d=g=>{_r(g)&&Object.keys(g).forEach(w=>u.add(w.toLowerCase()))};d(l.test),d(l.validation),d(l.train);const p=(c=(i=l==null?void 0:l.cross_validation)==null?void 0:i.metrics)==null?void 0:c.mean;_r(p)&&d(p);const h=Q0.some(g=>u.has(g)),f=X0.some(g=>u.has(g));if(h&&!f)return"classification";if(f&&!h)return"regression"}return"unknown"},v2=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:_2(t),modelLabel:ew(t.model_type),primaryMetric:p2(n),metricBucket:g2(n)}}),tw=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return J0.has(t)||J0.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},y2=({nodeId:e,sourceId:t,graph:n,parameters:s,config:l,renderParameterField:i})=>{var G;const c=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),u=v.useMemo(()=>{if(!c)return[];const q=new Map;c.nodes.forEach(ee=>{ee&&ee.id&&q.set(ee.id,ee)});const Y=new Set;return c.edges.forEach(ee=>{var se;if(!ee||ee.target!==e)return;const J=q.get(ee.source);((se=J==null?void 0:J.data)==null?void 0:se.catalogType)==="train_model_draft"&&Y.add(J.id)}),Y.size>0?Array.from(Y):c.nodes.filter(ee=>{var J;return((J=ee==null?void 0:ee.data)==null?void 0:J.catalogType)==="train_model_draft"}).map(ee=>ee.id)},[c,e]),d=v.useMemo(()=>u.length?u.slice().sort().join("|"):"all",[u]),[p,h]=v.useState(null),[f,g]=v.useState(null);v.useEffect(()=>{let q=!1;return g(null),!t||!c?(h(null),()=>{q=!0}):(ml(t,c).then(Y=>{q||h(Y)}).catch(Y=>{q||(g((Y==null?void 0:Y.message)??"Unable to compute pipeline ID"),h(null))}),()=>{q=!0})},[c,t]);const w=h2(l==null?void 0:l.show_non_success,!0),y=v.useMemo(()=>["feature-canvas","model-registry",t??"none",p??"pending",d,w?"all-statuses":"succeeded"],[p,w,t,d]),b=mr({queryKey:y,queryFn:async()=>{const q={datasetSourceId:t||void 0,limit:50},Y=new Map,Q=[];let ee=null;const J=De=>{!Array.isArray(De)||!De.length||De.forEach(Be=>{Be&&!Y.has(Be.id)&&Y.set(Be.id,Be)})},se=async De=>{try{const Be=await Qc(De);return J(Be==null?void 0:Be.jobs),Be}catch(Be){return Be instanceof Error&&Q.push(Be),null}};if(p&&await se({...q,pipelineId:p}),u.length===1){const[De]=u;await se({...q,nodeId:De})}if(ee=await se(q),!Y.size){if(ee)return ee;if(Q.length)throw Q[0];return{jobs:[],total:0}}const ke=Array.from(Y.values()),Pe=(ee==null?void 0:ee.total)??ke.length;return{jobs:ke,total:Pe}},enabled:!!t,staleTime:30*1e3,retry:(q,Y)=>Y.message.includes("Sign in")?!1:q<2,refetchInterval:q=>{const Y=q.state.data;return((Y==null?void 0:Y.jobs)??[]).some(J=>J.status==="queued"||J.status==="running")?5e3:!1}}),x=((G=b.data)==null?void 0:G.jobs)??[],N=v.useMemo(()=>{if(!x.length)return[];if(!u.length)return x;const q=x.filter(Y=>u.includes(Y.node_id));return q.length?q:x},[x,u]),E=v.useMemo(()=>v2(N),[N]),k=v.useMemo(()=>w?E:E.filter(q=>q.job.status==="succeeded"),[E,w]),j=v.useMemo(()=>k.filter(q=>q.problemType==="classification"),[k]),S=v.useMemo(()=>k.filter(q=>q.problemType==="regression"),[k]),M=v.useMemo(()=>!j.length&&!S.length?"classification":j.length?S.length?j.length>=S.length?"classification":"regression":"classification":"regression",[j.length,S.length]),$=typeof(l==null?void 0:l.default_problem_type)=="string"?l.default_problem_type.trim().toLowerCase():"auto",T=$==="classification"||$==="regression"?$:M,[L,P]=v.useState(T);v.useEffect(()=>{P(T)},[T]);const O=L==="classification"?j:S,D=v.useMemo(()=>{const q=new Map;return O.forEach(Y=>{const Q=Y.job.model_type,ee=q.get(Q)??{label:Y.modelLabel,count:0};ee.count+=1,q.set(Q,ee)}),Array.from(q.entries()).map(([Y,Q])=>({value:Y,label:Q.label,count:Q.count})).sort((Y,Q)=>Y.label.localeCompare(Q.label))},[O]),W=typeof(l==null?void 0:l.default_method)=="string"?l.default_method.trim().toLowerCase():"",[z,R]=v.useState("all");v.useEffect(()=>{if(!D.length){R("all");return}const q=D.find(Y=>Y.value.toLowerCase()===W);R(q?q.value:"all")},[W,D,L]);const U=v.useMemo(()=>z==="all"?O:O.filter(q=>q.job.model_type===z),[z,O]),V=v.useMemo(()=>U.slice().sort((q,Y)=>{if(Y.job.version!==q.job.version)return Y.job.version-q.job.version;const Q=Date.parse(q.job.updated_at??q.job.created_at??"");return Date.parse(Y.job.updated_at??Y.job.created_at??"")-Q}),[U]),B=v.useMemo(()=>{if(!O.length)return[];const q=new Map;O.forEach(Q=>{const ee=Q.job.model_type,J=q.get(ee)??[];J.push(Q),q.set(ee,J)});const Y=[];return q.forEach((Q,ee)=>{const J=Q.reduce((se,ke)=>{const Pe=tw(ke.primaryMetric);if(Pe===null)return se;if(!se)return ke;const De=tw(se.primaryMetric);return De===null||Pe>De?ke:se},null);Y.push({modelType:ee,label:ew(ee),bestJob:J})}),Y.sort((Q,ee)=>Q.label.localeCompare(ee.label))},[O]),X=v.useMemo(()=>s.filter(q=>["default_problem_type","show_non_success"].includes(q.name)),[s]),H=L==="classification"?Q0:X0,F=b.isLoading||b.isFetching,K=b.error??null,re=V.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),p&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",p]})]}),f&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:f}),!u.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),X.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:X.map(q=>a.jsx(be.Fragment,{children:i(q)},q.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(q=>a.jsxs("button",{type:"button",role:"tab","data-active":L===q,className:"model-registry__tab",onClick:()=>P(q),disabled:q==="classification"&&!j.length||q==="regression"&&!S.length,children:[q==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:q==="classification"?j.length:S.length})]},q))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z==="all",onClick:()=>R("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:O.length})]}),D.map(q=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z===q.value,onClick:()=>R(q.value),children:[q.label,a.jsx("span",{className:"model-registry__method-count",children:q.count})]},q.value))]})]}),B.length>0&&a.jsx("div",{className:"model-registry__summary",children:B.map(q=>{const Y=q.bestJob,Q=Y!=null&&Y.primaryMetric?Y.primaryMetric.label:null,ee=Y!=null&&Y.primaryMetric?bg(Y.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:q.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[Q||"No metrics",Q&&a.jsx("strong",{children:ee})]}),(Y==null?void 0:Y.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",Y.job.version]})]},q.modelType)})}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:K.message}),!F&&!K&&!re&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),re&&a.jsx("div",{className:"model-registry__table-wrapper",children:a.jsxs("table",{className:"model-registry__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Version"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Model"}),a.jsx("th",{scope:"col",children:"Primary metric"}),H.map(q=>a.jsx("th",{scope:"col",children:q.replace(/_/g," ")},q)),a.jsx("th",{scope:"col",children:"Evaluated"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:V.map(q=>{const{job:Y,primaryMetric:Q,metricBucket:ee}=q,J=ee.values||{},se=ee.label??"",ke=Y.updated_at??Y.created_at??null;return a.jsxs("tr",{children:[a.jsxs("td",{children:["v",Y.version]}),a.jsx("td",{children:a.jsx("span",{className:`model-registry__status model-registry__status--${m2[Y.status]}`,children:d2[Y.status]})}),a.jsx("td",{children:q.modelLabel}),a.jsx("td",{children:Q?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",children:Q.label}),a.jsx("span",{className:"model-registry__metric-value",children:bg(Q.value)})]}):""}),H.map(Pe=>{const De=J[Pe];return a.jsx("td",{children:typeof De=="number"&&Number.isFinite(De)?bg(De):""},`${Y.id}-${Pe}`)}),a.jsx("td",{children:se}),a.jsx("td",{children:ke?hs(ke)??ke:""})]},Y.id)})})]})})]})},b2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},pl="__tuning_strategies",gl="__active_tuning_strategy_id",_l="__expanded_tuning_strategy_ids",xg=["random","grid","halving","optuna"],Dm=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const s=n.toLowerCase();if(t&&t.length>0){const i=t.find(c=>c.toLowerCase()===s);if(i)return i}const l=xg.find(i=>i.toLowerCase()===s);return l||n},Gr=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Ns=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},ho=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return Gr(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return Gr(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},wg=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,s])=>{if(n){if(Array.isArray(s)){const l=s.filter(i=>i!=null);l.length>0&&(t[n]=l.map(i=>Ns(i)));return}s==null||s===""||(t[n]=[Ns(s)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},x2=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",w2=new Set(["train","test","validation"]),nw=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const s=n.trim().toLowerCase();w2.has(s)&&t.add(s)}}),Array.from(t)},jg=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,l])=>{t.has(s)&&(n[s]=l)}),n},Ng=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,l])=>{if(t.has(s)){if(Array.isArray(l)){const i=l.map(c=>Ns(c)).filter(c=>c!=null&&c!=="");i.length>0&&(n[s]=i);return}l!=null&&l!==""&&(n[s]=[Ns(l)])}}),n},j2=(e,t)=>{const n=t.split(/[\n,]+/).map(d=>d.trim()).filter(d=>d.length>0);if(n.length===0)return{values:[],error:null};const s=[],l=[],i=Array.isArray(e.options)?new Set(e.options.map(d=>d.value)):null;n.forEach(d=>{if(e.type==="number"){const p=Number(d);Number.isFinite(p)?s.push(p):l.push(d);return}if(e.type==="boolean"){const p=d.toLowerCase();if(["true","1","yes","y"].includes(p)){s.push(!0);return}if(["false","0","no","n"].includes(p)){s.push(!1);return}l.push(d);return}if(e.type==="select"){if(i&&!i.has(d)){l.push(d);return}s.push(d);return}s.push(d)});const c=[],u=new Set;if(s.forEach(d=>{const p=typeof d=="object"?JSON.stringify(d):String(d);u.has(p)||(u.add(p),c.push(d))}),l.length>0){const d=l.slice(0,3).join(", "),p=l.length>3?"":"";return{values:c,error:`Invalid value${l.length>1?"s":""}: ${d}${p}`}}return{values:c,error:null}},sw=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),Rm=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},Fm=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},du=(e,t,n)=>{let s=e;return typeof t=="number"&&Number.isFinite(t)&&(s=Math.max(s,t)),typeof n=="number"&&Number.isFinite(n)&&(s=Math.min(s,n)),s},N2=(e,t)=>{const n={},s=e.find(d=>(d==null?void 0:d.name)==="solver"),l=e.find(d=>(d==null?void 0:d.name)==="penalty"),i=!!(s&&l&&Array.isArray(s.options)&&s.options.some(d=>(d==null?void 0:d.value)==="liblinear")&&Array.isArray(l.options)&&l.options.some(d=>(d==null?void 0:d.value)==="elasticnet")),c=new Set(["lbfgs","saga"]),u=new Set(["l2","none"]);return e.forEach(d=>{if(!(d!=null&&d.name))return;const p=new Map,h=w=>{if(w==null||typeof w=="number"&&!Number.isFinite(w))return;const y=typeof w=="object"?JSON.stringify(w):`${typeof w}:${String(w)}`;p.has(y)||p.set(y,Ns(w))},f=t==null?void 0:t[d.name];if(i&&d.name==="solver")(Array.isArray(d.options)?d.options:[]).forEach(y=>{y!=null&&y.value&&c.has(String(y.value))&&h(y.value)}),!p.size&&typeof f=="string"&&c.has(f)&&h(f),p.size||c.forEach(y=>h(y));else if(i&&d.name==="penalty")(Array.isArray(d.options)?d.options:[]).forEach(y=>{y!=null&&y.value&&u.has(String(y.value))&&h(y.value)}),!p.size&&typeof f=="string"&&u.has(f)&&h(f),p.size||u.forEach(y=>h(y));else if(d.type==="number"){const w=Fm(f),y=Fm(d.min),b=Fm(d.max);if(y!==null&&h(y),w!==null&&h(du(w,y,b)),b!==null&&h(b),p.size<=1&&w!==null){const x=Fm(d.step);x!==null&&x>0?(h(du(w+x,y,b)),h(du(w-x,y,b))):(h(du(w*1.5,y,b)),h(du(w*.5,y,b)))}}else d.type==="boolean"?(h(!0),h(!1),typeof f=="boolean"&&h(f)):(d.type==="select"&&(d.options??[]).slice(0,6).forEach(w=>{(w==null?void 0:w.value)!==void 0&&h(w.value)}),typeof f=="string"&&f.trim().length&&h(f.trim()));const g=Array.from(p.values());g.length>0&&(n[d.name]=g)}),n},C2={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},Cg=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,mu=e=>{if(!Gr(e))return{};const t=Ns(e);return Gr(t)?(delete t[pl],delete t[gl],delete t[_l],t):{}},Mi=e=>mu(e),S2=(e,t,n)=>({id:Cg(),label:e,config:Mi(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),fo=e=>`Strategy ${e}`,rw=e=>Gr(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},aw=e=>Gr(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const s=e[n];return t[n]=s===null?null:String(s),t},{}):{},E2=e=>{if(!Gr(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,pl)&&(t[pl]=Ns(e[pl])),Object.prototype.hasOwnProperty.call(e,gl)&&(t[gl]=e[gl]),Object.prototype.hasOwnProperty.call(e,_l)&&(t[_l]=Ns(e[_l])),t},k2=()=>({strategies:[],activeId:null,expandedIds:[]}),Sg=e=>{var d;const t=k2();if(!Gr(e))return t;const n=e[pl];if(Array.isArray(n)){const p=new Set;n.forEach(h=>{if(!Gr(h))return;let f=typeof h.id=="string"?h.id.trim():"";(!f||p.has(f))&&(f=Cg()),p.add(f);const g=typeof h.label=="string"?h.label.trim():"",w=g.length?g:fo(t.strategies.length+1),y=Gr(h.config)?h.config:{},b={id:f,label:w,config:mu(y),searchSpaceTexts:rw(h.searchSpaceTexts),searchSpaceFieldErrors:aw(h.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!h.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!h.searchSpaceManuallyCleared};t.strategies.push(b)})}const s=new Set(t.strategies.map(p=>p.id)),l=e[gl],i=typeof l=="string"?l.trim():"";t.activeId=i&&s.has(i)?i:((d=t.strategies[0])==null?void 0:d.id)??null;const c=e[_l],u=Array.isArray(c)?c.map(p=>typeof p=="string"?p.trim():"").filter(p=>!!p&&s.has(p)):[];return t.activeId&&!u.includes(t.activeId)&&u.push(t.activeId),t.expandedIds=Array.from(new Set(u)).sort(),t},ow=e=>({id:e.id,label:e.label,config:Mi(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),M2=(e,t,n)=>{var u;const s=e.map((d,p)=>({id:typeof d.id=="string"&&d.id.trim().length?d.id:Cg(),label:typeof d.label=="string"&&d.label.trim().length?d.label:fo(p+1),config:mu(d.config),searchSpaceTexts:rw(d.searchSpaceTexts),searchSpaceFieldErrors:aw(d.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!d.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!d.searchSpaceManuallyCleared})),l=new Set(s.map(d=>d.id)),i=typeof t=="string"&&l.has(t)?t:((u=s[0])==null?void 0:u.id)??null,c=Array.from(n??new Set).filter(d=>l.has(d));return i&&!c.includes(i)&&c.push(i),{strategies:s,activeId:i,expandedIds:Array.from(new Set(c)).sort()}},lw=(e,t)=>{var n;return t&&e.some(s=>s.id===t)?t:((n=e[0])==null?void 0:n.id)??""},iw=(e,t)=>{const n=new Set(e.map(l=>l.id)),s=t.filter(l=>n.has(l));return!s.length&&e[0]&&s.push(e[0].id),new Set(s)},Im=e=>cu(e),cw=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const l of n)if(e[l]!==t[l])return!1;return!0},A2=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:l,cvConfig:i,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,searchStrategyParameter:h,searchIterationsParameter:f,searchRandomStateParameter:g,scoringMetricParameter:w,setDraftConfigState:y,onSaveDraftConfig:b})=>{var Tl,So,Ms,xr;const x=rl(),[N,E]=v.useState(null),[k,j]=v.useState(null),[S,M]=v.useState(null),[$,T]=v.useState(0),[L,P]=v.useState(null),[O,D]=v.useState(!1),[W,z]=v.useState(null),[R,U]=v.useState(!1),V=((s==null?void 0:s.targetColumn)??"").trim(),B=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",X=(d==null?void 0:d.name)??"model_type",H=(h==null?void 0:h.name)??"search_strategy",F=(f==null?void 0:f.name)??"search_iterations",K=(g==null?void 0:g.name)??"search_random_state",re=(w==null?void 0:w.name)??"scoring_metric",G=c==null?void 0:c[X],q=typeof G=="string"&&G.trim().length?G.trim():((l==null?void 0:l.modelType)??"").trim(),Y=mr({queryKey:["model-hyperparameters",q],queryFn:()=>jm(q),enabled:!!q,staleTime:5*60*1e3}),Q=((Tl=Y.data)==null?void 0:Tl.fields)??[],ee=((So=Y.data)==null?void 0:So.defaults)??{},J=v.useMemo(()=>{if(!Q.length)return new Set;const Z=new Set;return Q.forEach(ge=>{ge!=null&&ge.name&&Z.add(ge.name)}),Z},[Q]),se=!!(i!=null&&i.enabled),ke=(i==null?void 0:i.strategy)??"auto",Pe=typeof(i==null?void 0:i.folds)=="number"?i.folds:5,De=!!(i!=null&&i.shuffle),Be=(i==null?void 0:i.randomState)??null,mt=v.useMemo(()=>{const Z=[];return((h==null?void 0:h.options)??[]).forEach(ge=>{if(!ge||typeof ge.value!="string")return;const he=ge.value.trim();if(!he.length)return;const ze=he.toLowerCase();Z.some(Oe=>Oe.toLowerCase()===ze)||Z.push(he)}),Z},[h]),Ge=v.useMemo(()=>mt.length>0?[...mt]:[...xg],[mt]),ue=Dm(h==null?void 0:h.default,mt),Me=Dm(c==null?void 0:c[H],mt)??ue??Ge[0]??xg[0],Le=c==null?void 0:c[F];let Ve=null;if(typeof Le=="number"&&Number.isFinite(Le))Ve=Math.max(1,Math.floor(Le));else if(typeof Le=="string"){const Z=Number(Le.trim());Number.isFinite(Z)&&Z>0&&(Ve=Math.max(1,Math.floor(Z)))}const ce=c==null?void 0:c[K];let Fe=null;if(typeof ce=="number"&&Number.isFinite(ce))Fe=Math.trunc(ce);else if(typeof ce=="string"){const Z=Number(ce.trim());Number.isFinite(Z)&&(Fe=Math.trunc(Z))}const et=typeof(f==null?void 0:f.default)=="number"&&Number.isFinite(f.default)?Math.max(1,Math.floor(f.default)):null,it=typeof(g==null?void 0:g.default)=="number"&&Number.isFinite(g.default)?Math.trunc(g.default):null,at=typeof(c==null?void 0:c[re])=="string"?String(c[re]).trim():"",xt=at.length?at:null,ot=v.useMemo(()=>ho(c==null?void 0:c.baseline_hyperparameters),[c==null?void 0:c.baseline_hyperparameters]),$e=v.useMemo(()=>ho(c==null?void 0:c.search_space),[c==null?void 0:c.search_space]),je=v.useMemo(()=>wg($e.value),[$e.value]),Vt=ot.value,tt=ot.error,Wt=je.value,ct=$e.error??je.error,Rt=v.useMemo(()=>jg(Vt,J),[J,Vt]),mn=v.useMemo(()=>Ng(Wt,J),[J,Wt]),$n=v.useMemo(()=>Object.keys(Rt).length,[Rt]),Ft=v.useMemo(()=>Object.keys(mn).length,[mn]),ln=Ft>0,[Hn,Gt]=v.useState({}),[_t,es]=v.useState({}),[cn,En]=v.useState(!1),[yt,Zs]=v.useState(!1),nn=v.useRef(null);if(!nn.current){const Z=Sg(c);let ze=Z.strategies.length>0?Z.strategies.map(ow):[];const Oe=lw(ze,Z.activeId),Ce=iw(ze,Z.expandedIds);Oe&&!Ce.has(Oe)&&ze.length&&Ce.add(Oe);const lt=Im(Z);nn.current={strategies:ze,activeId:Oe,expanded:Ce,signature:lt}}const[jt,kt]=v.useState(()=>nn.current?nn.current.strategies:[]),[Cs,vn]=v.useState(()=>new Set(nn.current?Array.from(nn.current.expanded):[])),[Ln,yn]=v.useState(()=>{var Z;return((Z=nn.current)==null?void 0:Z.activeId)??""}),Vn=v.useRef(((Ms=nn.current)==null?void 0:Ms.signature)??""),bn=v.useRef(null),Ss=v.useRef(null),Yt=v.useMemo(()=>jt.length?jt.find(ge=>ge.id===Ln)??jt[0]:null,[Ln,jt]),ts=v.useMemo(()=>Sg(c),[c]),Wn=v.useMemo(()=>Im(ts),[ts]);v.useEffect(()=>{if(Wn===Vn.current)return;const Z=ts.strategies.length?ts.strategies.map(ow):[],ge=lw(Z,ts.activeId),he=iw(Z,ts.expandedIds);ge&&!he.has(ge)&&Z.length&&he.add(ge),bn.current=null,kt(Z),yn(ge),vn(he),Vn.current=Wn},[Wn,ts,c]),v.useEffect(()=>{if(!jt.length)return;jt.some(ge=>ge.id===Ln)||yn(jt[0].id)},[Ln,jt]),v.useEffect(()=>{const Z=M2(jt,Ln,Cs),ge=Im(Z);Vn.current!==ge&&y(he=>{const ze=Sg(he),Oe=Im(ze);if(Oe===ge)return Vn.current=Oe,he??{};const Ce=he?{...he}:{};return Z.strategies.length?Ce[pl]=Z.strategies.map(lt=>({...lt,config:Ns(lt.config),searchSpaceTexts:{...lt.searchSpaceTexts},searchSpaceFieldErrors:{...lt.searchSpaceFieldErrors}})):delete Ce[pl],Z.activeId?Ce[gl]=Z.activeId:delete Ce[gl],Z.expandedIds.length?Ce[_l]=[...Z.expandedIds]:delete Ce[_l],Vn.current=ge,Ce})},[Ln,Cs,y,jt]),v.useEffect(()=>{if(!Yt||bn.current===Yt.id)return;bn.current=Yt.id;const Z=Mi(Yt.config);y(he=>({...E2(he),...Z})),Gt(Yt.searchSpaceTexts??{}),es(Yt.searchSpaceFieldErrors??{}),En(Yt.hasAutoFilledSearchSpace??!1),Zs(Yt.searchSpaceManuallyCleared??!1);const ge=typeof(Z==null?void 0:Z[X])=="string"?String(Z[X]):(l==null?void 0:l.modelType)??"";Ss.current=ge},[Yt,X,l==null?void 0:l.modelType,y]),v.useEffect(()=>{if(!Yt)return;const Z=Mi(c),ge=JSON.stringify(Z)!==JSON.stringify(Yt.config??{}),he=!cw(Hn,Yt.searchSpaceTexts),ze=!cw(_t,Yt.searchSpaceFieldErrors),Oe=Yt.hasAutoFilledSearchSpace!==cn,Ce=Yt.searchSpaceManuallyCleared!==yt;!ge&&!he&&!ze&&!Oe&&!Ce||kt(lt=>lt.map(Ke=>Ke.id!==Yt.id?Ke:{...Ke,config:Z,searchSpaceTexts:{...Hn},searchSpaceFieldErrors:{..._t},hasAutoFilledSearchSpace:cn,searchSpaceManuallyCleared:yt}))},[Yt,c,cn,_t,yt,Hn]);const zn=v.useCallback(()=>{const Z=jt.length+1,ge=Mi(c),he=new Set;jt.forEach(Ke=>{var ft;const vt=Dm((ft=Ke.config)==null?void 0:ft[H],Ge);vt&&he.add(vt)});const ze=Ge.find(Ke=>!he.has(Ke))??Me,Oe=Ns(ge),Ce=Gr(Oe)?Oe:{};if(Ce[H]=ze,ze==="random"||ze==="optuna"){const Ke=Ve!==null?Ve:et;Ke!==null?Ce[F]=Ke:delete Ce[F];const vt=Fe!==null?Fe:it;vt!==null?Ce[K]=vt:delete Ce[K]}else delete Ce[F],delete Ce[K];const lt=S2(fo(Z),Ce,{searchSpaceTexts:{...Hn},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:cn,searchSpaceManuallyCleared:yt});kt(Ke=>[...Ke,lt]),vn(Ke=>new Set([...Ke,lt.id])),bn.current=null,yn(lt.id)},[Ge,c,cn,Ve,et,Fe,it,yt,Hn,Me,H,F,K,kt,yn,vn,jt]),Tr=v.useCallback(Z=>{vn(ge=>{const he=new Set(ge);return he.has(Z)?he.delete(Z):he.add(Z),he})},[]),fs=v.useCallback(Z=>{!Z||Z===Ln||(bn.current=null,yn(Z),vn(ge=>{const he=new Set(ge);return he.add(Z),he}))},[Ln]),er=v.useCallback(Z=>{let ge=null;kt(he=>{if(he.length<=1)return he;const ze=he.filter(Ce=>Ce.id!==Z);if(!ze.length)return he;const Oe=ze.map((Ce,lt)=>({...Ce,label:fo(lt+1)}));if(Z===Ln){bn.current=null;const Ce=Oe[0].id;ge=Ce,yn(Ce)}return Oe}),vn(he=>{const ze=new Set(he);return ze.delete(Z),ge&&ze.add(ge),ze})},[Ln]),Rs=v.useMemo(()=>jt.map((Z,ge)=>{var ga,Lr;const he=Z.config??{},ze=he==null?void 0:he[X],Oe=typeof ze=="string"?ze.trim():"",Ce=((ga=p.find(vs=>vs.value===Oe))==null?void 0:ga.label)??Oe,lt=he==null?void 0:he[H],Ke=typeof lt=="string"?lt.trim():"",vt=(Lr=((h==null?void 0:h.options)??[]).find(vs=>vs.value===Ke))==null?void 0:Lr.label,ft=he==null?void 0:he[re],nt=typeof ft=="string"?ft.trim():"",Yn=ho(he==null?void 0:he.baseline_hyperparameters).error,Xt=ho(he==null?void 0:he.search_space),Rn=wg(Xt.value),nr=Rn.value?Object.keys(Rn.value).length:0,sr=Rn.value?Object.values(Rn.value).reduce((vs,Is)=>vs+(Array.isArray(Is)?Is.length:0),0):0,wr=Yn!==null||Object.values(Z.searchSpaceFieldErrors).some(vs=>!!vs);return{id:Z.id,label:Z.label||fo(ge+1),modelLabel:Ce||"Select model",searchStrategyLabel:vt??(Ke||"Random search"),scoringLabel:nt||"Estimator default",parameterCount:nr,candidateCount:sr,hasErrors:wr}}),[p,X,re,h,H,jt]);v.useEffect(()=>{const Z=Ss.current;if(Z===null){Ss.current=q;return}Z!==q&&(Ss.current=q,Gt({}),es({}),En(!1),Zs(!1))},[q]),v.useEffect(()=>{!q||!Q.length||Gt(Z=>{const ge={...Z};let he=!1;return Q.forEach(ze=>{if(_t[ze.name])return;const Oe=mn[ze.name],Ce=Array.isArray(Oe)&&Oe.length>0?Oe.map(lt=>sw(ze,lt)).join(", "):"";ge[ze.name]!==Ce&&(ge[ze.name]=Ce,he=!0)}),he?ge:Z})},[mn,Q,q,_t]),v.useEffect(()=>{if(!q||!Q.length||yt)return;if(ln){cn||En(!0);return}if(cn)return;const Z=N2(Q,ee);Object.keys(Z).length&&(En(!0),es({}),Gt(()=>{const ge={};return Q.forEach(he=>{if(!Z[he.name])return;const ze=Z[he.name].map(Oe=>sw(he,Oe)).filter(Oe=>Oe.length>0).join(", ");ge[he.name]=ze}),ge}),y(ge=>{const he=ge?{...ge}:{};return he.search_space=Z,he}))},[cn,ee,Q,q,ln,yt,y]);const[Fs,yr]=v.useState(xt??"");v.useEffect(()=>{yr(xt??"")},[xt]);const ps=v.useMemo(()=>C2[B==="regression"?"regression":"classification"],[B]),rn=(w==null?void 0:w.label)??"Scoring metric",It=(w==null?void 0:w.description)??"Pick the evaluation metric used to rank candidates.",ht=v.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),$r=v.useMemo(()=>Object.values(_t).some(Z=>!!Z),[_t]),ns=v.useCallback((Z,ge)=>{J.has(Z)&&y(he=>{const ze={...he},Oe=ho(he==null?void 0:he.baseline_hyperparameters).value??{},lt={...jg(Oe,J)};return ge===void 0?delete lt[Z]:lt[Z]=ge,Object.keys(lt).length>0?ze.baseline_hyperparameters=lt:delete ze.baseline_hyperparameters,ze})},[J,y]),br=v.useCallback((Z,ge)=>{Gt(Oe=>({...Oe,[Z.name]:ge}));const{values:he,error:ze}=j2(Z,ge);es(Oe=>({...Oe,[Z.name]:ze})),!ze&&y(Oe=>{const Ce={...Oe},lt=ho(Oe==null?void 0:Oe.search_space).value??{},vt={...Ng(lt,J)};return he.length>0?vt[Z.name]=he.map(ft=>Ns(ft)):delete vt[Z.name],Object.keys(vt).length>0?Ce.search_space=vt:delete Ce.search_space,Ce})},[J,y]),Es=v.useCallback(Z=>{ns(Z,void 0)},[ns]),Jr=v.useCallback(()=>{y(Z=>{if(!Z||!Z.baseline_hyperparameters)return Z??{};const ge={...Z};return delete ge.baseline_hyperparameters,ge})},[y]),le=v.useCallback(()=>{Zs(!0),En(!0),Gt({}),es({}),y(Z=>{if(!Z||!Z.search_space)return Z??{};const ge={...Z};return delete ge.search_space,ge})},[y]),xe=v.useCallback(Z=>{yr(Z);const ge=Z.trim();y(he=>{const ze={...he};return ge.length>0?ze.scoring_metric=ge:delete ze.scoring_metric,ze})},[y]),Ue=v.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const ge=`baseline-${e}-${Z.name}`,he=Rt[Z.name],ze=he!==void 0,Oe=ee==null?void 0:ee[Z.name],Ce=Z.label??Z.name,lt=Z.description,Ke=Oe!==void 0?`Default: ${Rm(Oe)}`:"Default: estimator setting";let vt;if(Z.type==="number"){const ft=typeof he=="number"?String(he):"";vt=a.jsx("input",{id:ge,type:"number",className:"canvas-modal__parameter-input",value:ft,onChange:nt=>{const Pt=nt.target.value;if(!Pt.length){Es(Z.name);return}const Yn=Number(Pt);Number.isFinite(Yn)&&ns(Z.name,Yn)},min:Z.min,max:Z.max,step:Z.step,placeholder:"Leave blank to use default"})}else if(Z.type==="select"){const ft=ze?String(he):"";vt=a.jsxs("select",{id:ge,className:"canvas-modal__parameter-select",value:ft,onChange:nt=>{const Pt=nt.target.value;if(!Pt.length){Es(Z.name);return}ns(Z.name,Pt)},children:[a.jsx("option",{value:"",children:"Use default"}),(Z.options??[]).map(nt=>a.jsx("option",{value:nt.value,children:nt.label},nt.value))]})}else if(Z.type==="boolean"){const ft=ze?he?"true":"false":"";vt=a.jsxs("select",{id:ge,className:"canvas-modal__parameter-select",value:ft,onChange:nt=>{const Pt=nt.target.value;if(!Pt.length){Es(Z.name);return}ns(Z.name,Pt==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const ft=typeof he=="string"?he:"";vt=a.jsx("input",{id:ge,type:"text",className:"canvas-modal__parameter-input",value:ft,onChange:nt=>{const Pt=nt.target.value;if(!Pt.length){Es(Z.name);return}ns(Z.name,Pt)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:ge,className:"canvas-modal__parameter-label",children:[Ce,lt&&a.jsx("span",{className:"canvas-modal__parameter-description",children:lt})]}),vt,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:ze?`Override: ${Rm(he)}`:Ke})})]},Z.name)},[J,Rt,ee,e,ns]),$t=v.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const ge=`search-${e}-${Z.name}`,he=Hn[Z.name]??"",ze=mn[Z.name],Oe=Array.isArray(ze)?ze.length:0,Ce=_t[Z.name],lt=ee==null?void 0:ee[Z.name],Ke=Z.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":Z.type==="boolean"?"Enter true/false values, separated by commas or new lines":Z.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",vt=Array.isArray(ze)?ze.slice(0,3).map(ft=>Rm(ft)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:ge,className:"canvas-modal__parameter-label",children:[Z.label??Z.name,Z.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:Z.description})]}),a.jsx("textarea",{id:ge,className:"canvas-modal__parameter-input",rows:3,value:he,onChange:ft=>br(Z,ft.target.value),placeholder:Ke,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Oe>0?`Configured ${Oe} value${Oe===1?"":"s"}${vt?` (${vt}${Oe>3?"":""})`:""}`:`Default: ${Rm(lt)}`})}),Ce&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:Ce})]},Z.name)},[J,mn,br,ee,e,_t,Hn]),Ee=v.useMemo(()=>{if(!ln)return{parameterCount:0,candidateProduct:null};const Z=Object.values(mn),ge=Z.length;let he=null;if(Z.length>0){let ze=1,Oe=!1;Z.forEach(Ce=>{ze*=Math.max(Ce.length,1),(!Number.isFinite(ze)||ze>1e6)&&(Oe=!0)}),he=Oe?null:ze}return{parameterCount:ge,candidateProduct:he}},[mn,ln]),ut=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),gt=v.useCallback(Z=>{if(!ut)return null;const ge=Ns(ut);if(!ge||!Array.isArray(ge.nodes))return ut;const he=mu(Z),ze=Object.keys(he).length>0;return ge.nodes=ge.nodes.map(Oe=>{if(!Oe||Oe.id!==e)return Oe;const Ce=(Oe==null?void 0:Oe.data)??{},lt=(Ce==null?void 0:Ce.config)??{},Ke=mu(lt),vt=ze?{...Ke,...he}:Ke;return{...Oe,data:{...Ce,config:vt,isConfigured:!0}}}),ge},[ut,e]),Kt=v.useMemo(()=>{const Z=gt(c);return Z||ut},[c,ut,gt]),Bt=v.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const Z=n.nodes,ge=n.edges;return(()=>{var lt;const Ce=Z.find(Ke=>(Ke==null?void 0:Ke.id)===e);return Ce?nw((lt=Ce==null?void 0:Ce.data)==null?void 0:lt.connectedSplits):[]})().includes("validation")||ge.some(Ce=>!Ce||(typeof Ce.target=="string"?Ce.target:null)!==e?!1:(typeof Ce.sourceHandle=="string"?Ce.sourceHandle.toLowerCase():"").includes("validation"))?!0:ge.some(Ce=>{var nt;if(!Ce||(typeof Ce.target=="string"?Ce.target:null)!==e)return!1;const Ke=typeof Ce.source=="string"?Ce.source:null;if(!Ke)return!1;const vt=Z.find(Pt=>(Pt==null?void 0:Pt.id)===Ke);return vt?nw((nt=vt==null?void 0:vt.data)==null?void 0:nt.activeSplits).includes("validation"):!1})?!1:null},[n,e]);v.useEffect(()=>{let Z=!1;return!t||!ut?(P(null),()=>{Z=!0}):(ml(t,ut).then(ge=>{Z||P(ge)}).catch(()=>{Z||P(null)}),()=>{Z=!0})},[ut,t]),v.useEffect(()=>{let Z=!1;j(null);const ge=Kt??ut;return!t||!ge?(E(null),()=>{Z=!0}):(ml(t,ge).then(he=>{Z||E(he)}).catch(he=>{Z||(j((he==null?void 0:he.message)??"Unable to compute pipeline ID"),E(null))}),()=>{Z=!0})},[ut,Kt,t]),v.useEffect(()=>{if(!N||!L){D(!1);return}D(N!==L)},[N,L]);const hn=!!(t&&e),Qt=v.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",N??"pending",e],[e,N,t]),xn=mr({queryKey:Qt,queryFn:async()=>{var ge;const Z={datasetSourceId:t||void 0,nodeId:e,limit:5};if(N){const he=await Xc({...Z,pipelineId:N});if((((ge=he==null?void 0:he.jobs)==null?void 0:ge.length)??0)>0)return he}return Xc(Z)},enabled:hn,retry:(Z,ge)=>ge.message.includes("Sign in")?!1:Z<2,refetchInterval:Z=>{const ge=Z.state.data;return((ge==null?void 0:ge.jobs)??[]).some(Oe=>Oe.status==="queued"||Oe.status==="running")?5e3:!1}}),{mutateAsync:tr,isPending:gs,error:Dn}=qd({mutationFn:dx,onSuccess:Z=>{const ge=Array.isArray(Z.jobs)?Z.jobs.length:0,he=ge>0?Z.jobs[0]:null;M(he),T(ge),x.invalidateQueries({queryKey:Qt})}}),Kn=v.useMemo(()=>{const Z=[];return t||Z.push("Select a dataset before launching tuning jobs."),(!ut||!ut.nodes.length)&&Z.push("Connect this node to an upstream pipeline before tuning."),V||Z.push("Set a target column before tuning."),Bt===!1&&Z.push("Connect the validation split to this node to enable tuning."),q||Z.push("Choose a model type before enqueuing tuning jobs."),jt.length===0&&Z.push("Add a tuning strategy before launching tuning jobs."),ln||Z.push("Define at least one hyperparameter in the search space."),tt&&Z.push(tt),ct&&Z.push(ct),$r&&Z.push("Resolve invalid candidate values in the search space."),(Me==="random"||Me==="optuna")&&!Ve&&Z.push("Provide the maximum iterations for random or Optuna search."),se&&Pe<2&&Z.push("Cross-validation requires at least 2 folds."),k&&Z.push(k),Z},[tt,se,Pe,ut,ln,$r,q,k,Ve,ct,Me,t,V,Bt,jt.length]),ks=((xr=xn.data)==null?void 0:xr.jobs)??[],_s=xn.isLoading||xn.isFetching,Co=xn.error,Al=v.useMemo(()=>!!(Dn instanceof Error&&Ci(Dn.message)||W&&Ci(W)||S&&lu(S)||ks.some(Z=>lu(Z))),[W,Dn,S,ks]),Ct=R0({graph:n,nodeId:e,modelType:q,problemType:B,modelTypeOptions:p,enabled:Al});v.useEffect(()=>{Ct||U(!1)},[Ct]);const Ui=Kn.length>0||$r||!N||!t||!ut||jt.length===0||!ln||gs,Ol=v.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),Pl=v.useCallback(async()=>{if(!N||!t||!ut||jt.length===0)return;if(b){try{const Oe=b({closeModal:!1});D(!1),Oe&&typeof Oe.then=="function"&&await Oe}catch{}await new Promise(Oe=>setTimeout(Oe,100))}const Z=async()=>{const Oe=[],Ce=[],lt=async Ke=>{if(!Ke)return new Set;if(Ke===q)return J;const vt=["model-hyperparameters",Ke],ft=x.getQueryData(vt),nt=Pt=>{const Yn=new Set;return(Pt??[]).forEach(Xt=>{Xt!=null&&Xt.name&&Yn.add(Xt.name)}),Yn};if(ft)return nt(ft.fields);try{const Pt=await x.fetchQuery({queryKey:vt,queryFn:()=>jm(Ke)});return nt(Pt==null?void 0:Pt.fields)}catch{return new Set}};for(let Ke=0;Ke<jt.length;Ke+=1){const vt=jt[Ke],ft=vt.label||fo(Ke+1),nt=Mi(vt.config),Pt=nt==null?void 0:nt[X],Yn=typeof Pt=="string"&&Pt.trim().length?Pt.trim():q;if(!Yn){Ce.push(`${ft} is missing a model selection.`);continue}const Xt=Dm(nt==null?void 0:nt[H],Ge)??ue??"random",Rn=await lt(Yn),sr=ho(nt==null?void 0:nt.baseline_hyperparameters).value??{},wr=Rn.size>0?jg(sr,Rn):Ns(sr),ga=ho(nt==null?void 0:nt.search_space);if(ga.error){Ce.push(`${ft} has invalid search space: ${ga.error}`);continue}const Lr=wg(ga.value);if(Lr.error){Ce.push(`${ft} has invalid search space: ${Lr.error}`);continue}const vs=Lr.value??{},Is=Rn.size>0?Ng(vs,Rn):Ns(vs);if(!Is||Object.keys(Is).length===0){Ce.push(`${ft} requires at least one hyperparameter in the search space.`);continue}if(Object.values(vt.searchSpaceFieldErrors??{}).some(dn=>!!dn)){Ce.push(`${ft} has search space entries that need attention.`);continue}const Eo=Object.keys(Is).length;let rr=null;if(Eo>0){let dn=1,Fn=!1;Object.values(Is).forEach(As=>{const Vi=Array.isArray(As)?As.length:0;dn*=Math.max(Vi,1),(!Number.isFinite(dn)||dn>1e6)&&(Fn=!0)}),rr=Fn?null:dn}const ko=nt==null?void 0:nt[re],Da=typeof ko=="string"?ko.trim():"",Mo=Da.length?Da:null,Ao=()=>{const dn=nt==null?void 0:nt[F];let Fn=null;if(typeof dn=="number"&&Number.isFinite(dn))Fn=Math.max(1,Math.floor(dn));else if(typeof dn=="string"){const As=Number(dn.trim());Number.isFinite(As)&&As>0&&(Fn=Math.max(1,Math.floor(As)))}return Fn===null&&(Xt==="random"||Xt==="optuna")?et!==null?et:null:Fn},Oo=()=>{const dn=nt==null?void 0:nt[K];let Fn=null;if(typeof dn=="number"&&Number.isFinite(dn))Fn=Math.trunc(dn);else if(typeof dn=="string"){const As=Number(dn.trim());Number.isFinite(As)&&(Fn=Math.trunc(As))}return Fn===null&&(Xt==="random"||Xt==="optuna")?it!==null?it:null:Fn},Po=Ao(),Gn=Oo(),un={};V&&(un.target_column=V),un.problem_type=B,un.strategy_id=vt.id,un.strategy_label=ft,un.strategy_index=Ke+1,un.search_strategy=Xt,Po!==null&&(Xt==="random"||Xt==="optuna")&&(un.max_iterations=Po),Mo&&(un.scoring_metric=Mo),Gn!==null&&(un.random_state=Gn),un.search_space_keys=Object.keys(Is),Eo>0&&(un.search_space_parameters=Eo),rr!==null&&(un.search_space_candidates=rr),un.cross_validation={enabled:se,strategy:ke,folds:Pe,shuffle:De,random_state:Be};const To=gt(nt)??ut;if(!To){Ce.push(`Unable to build pipeline graph for ${ft}.`);continue}const Ra=wr&&Object.keys(wr).length>0?Ns(wr):void 0,ju=Ns(Is),$l={dataset_source_id:t,pipeline_id:N,node_id:e,model_type:Yn,model_types:[Yn],search_strategy:Xt,search_space:ju,baseline_hyperparameters:Ra,n_iterations:Xt==="random"||Xt==="optuna"?Po??void 0:void 0,scoring:Mo??void 0,random_state:Gn??void 0,cross_validation:{enabled:se,strategy:ke,folds:Pe,shuffle:De,random_state:Be},metadata:un,job_metadata:un,run_tuning:!0,graph:To,target_node_id:e};Oe.push({payload:$l,label:ft})}return{plans:Oe,issues:Ce}};z(null);const{plans:ge,issues:he}=await Z();if(!ge.length){he.length&&z(he.join(" "));return}const ze=[];for(const{payload:Oe}of ge)try{const Ce=await tr(Oe);Array.isArray(Ce==null?void 0:Ce.jobs)&&Ce.jobs.length&&ze.push(...Ce.jobs)}catch(Ce){Ce instanceof Error&&Ce.message?z(Ce.message):z("Failed to enqueue one or more tuning jobs.");return}if(ze.length){const Oe=ze[ze.length-1];M(Oe),T(ze.length)}},[J,se,Pe,Be,De,ke,tr,ut,gt,q,X,e,b,ue,x,N,B,re,et,F,it,K,H,z,D,t,jt,V]),qi=v.useCallback(()=>{hn&&xn.refetch()},[hn,xn]),Hi=Z=>{var Yn,Xt,Rn,nr,sr;const ge=b2[Z.status]??Z.status,ze=(((Yn=p.find(wr=>wr.value===Z.model_type))==null?void 0:Yn.label)??Z.model_type??"").trim(),Oe=(()=>{switch(Z.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"halving_random":return"Successive halving (randomized)";case"optuna":return"Optuna search";default:return"Random search"}})(),Ce=Z.updated_at?hs(Z.updated_at):null,lt=Z.updated_at||Z.created_at,Ke=lt?Ce??new Date(lt).toLocaleString():null,vt=typeof Z.error_message=="string"?Z.error_message.trim():"",ft=[];ze&&ft.push(`Model ${ze}`),ft.push(Oe),Array.isArray(Z.results)&&Z.results.length>0&&ft.push(`${Z.results.length} candidates`);const nt=typeof Z.best_score=="number"&&Number.isFinite(Z.best_score)?Z.best_score:typeof((Xt=Z.metrics)==null?void 0:Xt.best_score)=="number"?Z.metrics.best_score:null;nt!==null&&ft.push(`Best score ${x2(nt)}`);const Pt=String(((Rn=Z.metrics)==null?void 0:Rn.scoring)??((nr=Z.metrics)==null?void 0:nr.scorer)??((sr=Z.metadata)==null?void 0:sr.scoring_metric)??"").trim();if(Pt&&ft.push(`Scoring ${Pt}`),Z.status==="failed"&&vt){const wr=vt.replace(/\s+/g," ");ft.push(`Error: ${wr}`)}return Ke&&ft.push(`Updated ${Ke}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["Run ",Z.run_number]}),"  ",ge,ft.length?`  ${ft.join("  ")}`:""]},Z.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:zn,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:qi,disabled:!hn||_s,children:_s?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:N})]}),O&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]}),Kn.map((Z,ge)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Z},`tuning-prereq-${ge}`)),Dn instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Dn.message}),W&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:W}),Co&&!(Dn instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Co.message||"Unable to load tuning jobs."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:$>1?a.jsxs("span",{children:["Queued ",$," tuning jobs. Latest job ",S.id," (run ",S.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",S.id," queued (run ",S.run_number,")."]})}),ln&&Ee.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",Ee.parameterCount," hyperparameter",Ee.parameterCount===1?"":"s",Ee.candidateProduct!==null?`  up to ${Ee.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsxs("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:[jt.length===0&&a.jsx("p",{style:{margin:"0",padding:"1rem 1.25rem",border:"1px dashed rgba(148, 163, 184, 0.4)",borderRadius:"6px",color:"rgba(148, 163, 184, 0.85)",background:"rgba(15, 23, 42, 0.35)"},children:'No tuning strategies configured yet. Use "Add strategy" to define your search plan.'}),jt.map((Z,ge)=>{const he=Rs[ge],ze=!!(Yt&&Yt.id===Z.id),Oe=Cs.has(Z.id),Ce=[];if(he!=null&&he.modelLabel&&Ce.push(he.modelLabel),he!=null&&he.searchStrategyLabel&&Ce.push(he.searchStrategyLabel),he!=null&&he.scoringLabel&&Ce.push(`Scoring ${he.scoringLabel}`),he!=null&&he.parameterCount){const Ke=he.candidateCount?`${he.parameterCount} param${he.parameterCount===1?"":"s"}  ${he.candidateCount} candidate${he.candidateCount===1?"":"s"}`:`${he.parameterCount} param${he.parameterCount===1?"":"s"}`;Ce.push(Ke)}else Ce.includes("Needs attention")||Ce.push("No search values");he!=null&&he.hasErrors&&Ce.push("Needs attention");const lt=Ce.length>0?Ce.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{Tr(Z.id),ze||fs(Z.id)},"aria-expanded":Oe,"aria-controls":`tuning-strategy-body-${Z.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${Oe?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(he==null?void 0:he.label)??fo(ge+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:lt})]})]}),jt.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>er(Z.id),"aria-label":`Remove ${(he==null?void 0:he.label)??fo(ge+1)}`,children:"Remove"})]}),Oe&&ze&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${Z.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Ol&&u(Ol),h&&u(h),(Me==="random"||Me==="optuna")&&f&&u(f),(Me==="random"||Me==="optuna")&&g&&u(g)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:rn}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:It}),a.jsxs("div",{id:ht,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:Fs||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[ps.map(Ke=>a.jsx("button",{type:"button",onClick:()=>xe(Ke.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Fs===Ke.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:Fs===Ke.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:Ke.label},Ke.value)),a.jsx("button",{type:"button",onClick:()=>xe(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),q&&Q.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:$n>0?`${$n} override${$n===1?"":"s"} configured`:"Using template defaults"}),$n>0&&a.jsx("button",{type:"button",onClick:Jr,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),tt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:tt}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:Q.map(Ue)})]}),q&&Q.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Ft>0?`${Ft} parameter${Ft===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:le,disabled:Ft===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Ft===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:Ft===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:Ft===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),ct&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:ct}),$r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:Q.map($t)})]})]})]},Z.id)})]}),se&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",Pe," folds before reporting aggregate metrics."]}),Ct&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",Ct.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:Ct.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>U(Z=>!Z),style:{whiteSpace:"nowrap"},children:R?"Hide tips":"Show tips"})]}),R&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:Ct.details.map((Z,ge)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:Z},`tuning-scaling-tip-${ge}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Pl,disabled:Ui,children:gs?"Queuing":"Launch tuning job"})}),_s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!_s&&ks.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),ks.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:ks.map(Hi)})]})},Eg={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},O2=(e,t)=>{if(e==null||e==="")return Eg[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return Eg[t].auto;const s=Math.max(Math.min(e,1),0),l=s*100,i=s.toFixed(s>=.1||s===0?2:3),c=t==="undersampling"?"majority":"majority baseline";return`${i} ratio (${l.toFixed(1)}% of ${c})`}const n=e.trim().toLowerCase();return Eg[t][n]??n},P2=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let s=e.length-1;s>=0;s-=1){const l=e[s];if(typeof l!="string")continue;const i=l.toLowerCase();if(n.some(c=>i.includes(c)))return l}return null},T2=(e,t)=>t?"Missing":e.length?e:"Empty string",$2=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:l,config:i,methodParameter:c,targetColumnParameter:u,samplingStrategyParameter:d,randomStateParameter:p,replacementParameter:h,kNeighborsParameter:f,renderParameterField:g,formatMetricValue:w,formatMissingPercentage:y,schemaGuard:b})=>{var F;const x=s.data,N=s.status,E=Array.isArray(x==null?void 0:x.applied_steps)?x==null?void 0:x.applied_steps:[],k=v.useMemo(()=>P2(E,e),[E,e]),j=(i==null?void 0:i.targetColumn)??"",S=(i==null?void 0:i.method)||(typeof(c==null?void 0:c.default)=="string"?c.default:""),M=v.useMemo(()=>{const K=Array.isArray(c==null?void 0:c.options)?c==null?void 0:c.options:[];if(S){const re=K.find(G=>G.value===S);return re!=null&&re.label?re.label:S.replace(/_/g," ")}return K.length>0?K[0].label??K[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[S,c==null?void 0:c.options,e]),$=v.useMemo(()=>O2(i==null?void 0:i.samplingStrategy,e),[i==null?void 0:i.samplingStrategy,e]),T=v.useMemo(()=>(i==null?void 0:i.randomState)===null||(i==null?void 0:i.randomState)===void 0?"Not set":Number.isFinite(i.randomState)?String(i.randomState):"Not set",[i==null?void 0:i.randomState]),L=v.useMemo(()=>{if(e!=="oversampling")return null;const K=i==null?void 0:i.kNeighbors;if(typeof K=="number"&&Number.isFinite(K))return String(Math.max(1,Math.round(K)));if(f&&typeof f.default=="number"){const re=f.default;if(Number.isFinite(re))return String(Math.max(1,Math.round(re)))}return"Default"},[i==null?void 0:i.kNeighbors,f,e]),P=(i==null?void 0:i.replacement)===null||(i==null?void 0:i.replacement)===void 0?null:i.replacement?"With replacement":"Without replacement",O=v.useMemo(()=>{if(N!=="success"||!x||!j)return{rows:[],total:0,truncated:!1};const K=Array.isArray(x.sample_rows)?x.sample_rows:[];if(!K.length)return{rows:[],total:0,truncated:!1};const re=new Map;K.forEach(se=>{if(!se||typeof se!="object")return;const ke=se[j],Pe=ke==null,De=Pe?"__missing__":String(ke),Be=T2(Pe?"":De,Pe),mt=re.get(De);mt?mt.count+=1:re.set(De,{label:Be,count:1,percentage:0,isMissing:Pe})});const G=Array.from(re.values()).sort((se,ke)=>ke.count-se.count),q=G.reduce((se,ke)=>se+ke.count,0),Y=8,Q=G.length>Y;return{rows:(Q?G.slice(0,Y):G).map(se=>({...se,percentage:q>0?se.count/q*100:0})),total:q,truncated:Q}},[x,N,j]),D=((F=x==null?void 0:x.metrics)==null?void 0:F.row_count)??null,W=!!t&&n&&N!=="loading"&&!(b!=null&&b.blocked),z=v.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),R=v.useMemo(()=>!(b!=null&&b.blocked)||!b.details.length?"":b.details.map(K=>K.logical_family?`${K.name} (${K.logical_family})`:K.name).join(", "),[b]),U=!j,V=!!j&&Array.isArray(x==null?void 0:x.columns)&&!(x!=null&&x.columns.includes(j)),B=e==="undersampling"?"Class undersampling":"Class oversampling",X=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",H=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:B}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:!W,children:N==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:X}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),U&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",H,"."]}),(b==null?void 0:b.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[b.message,R&&a.jsxs(a.Fragment,{children:[" ","Columns: ",R,"."]})]}),N==="error"&&s.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),V&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",j," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:k}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:M})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:$})]}),e==="oversampling"&&L&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:L})]}),P&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:P})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:T})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[c&&g(c),d&&g(d),e==="oversampling"&&f&&g(f),p&&g(p),h&&g(h)]}),u&&a.jsx("div",{className:"canvas-modal__parameter-list",children:g(u)}),j&&N==="success"&&!V&&(O.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:O.rows.map(K=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:K.label}),a.jsx("td",{children:w(K.count)}),a.jsx("td",{children:y(K.percentage)})]},`resampling-class-${K.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",w(O.total)," row",O.total===1?"":"s"," from the preview.",O.truncated?" Showing top classes by frequency.":""]}),D!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",w(D),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},L2=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},z2=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),D2=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),R2=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return v.useMemo(()=>{const s=L2(e),l=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",i=t==="missing_value_indicator",c=t==="replace_aliases_typos",u=t==="trim_whitespace",d=t==="remove_special_characters",p=t==="replace_invalid_values",h=t==="regex_replace_fix",f=t==="normalize_text_case",g=t==="standardize_date_formats",w=t==="label_encoding",y=t==="target_encoding",b=t==="hash_encoding",x=t==="train_model_draft",N=t==="model_evaluation",E=t==="model_registry_overview",k=t==="hyperparameter_tuning",j=t==="feature_target_split",S=t==="train_test_split",M=t==="class_undersampling",$=t==="class_oversampling",T=t==="ordinal_encoding",L=t==="dummy_encoding",P=t==="one_hot_encoding",O=t==="feature_math",D=t==="cast_column_types",W=t==="binning_discretization",z=t==="scale_numeric_features",R=t==="polynomial_features",U=t==="feature_selection",V=t==="transformer_audit",B=t==="outlier_removal",X=t==="skewness_transform",H=t==="skewness_distribution",F=t==="binned_distribution",K=D2.has(t),re=z2.has(t),G=t==="remove_duplicates",q=t==="drop_missing_columns",Y=t==="drop_missing_rows";return{catalogType:t,isDataset:s,isImputerNode:l,isMissingIndicatorNode:i,isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isReplaceInvalidValuesNode:p,isRegexCleanupNode:h,isNormalizeTextCaseNode:f,isStandardizeDatesNode:g,isLabelEncodingNode:w,isTargetEncodingNode:y,isHashEncodingNode:b,isTrainModelDraftNode:x,isModelEvaluationNode:N,isModelRegistryNode:E,isHyperparameterTuningNode:k,isFeatureTargetSplitNode:j,isTrainTestSplitNode:S,isClassUndersamplingNode:M,isClassOversamplingNode:$,isOrdinalEncodingNode:T,isDummyEncodingNode:L,isOneHotEncodingNode:P,isFeatureMathNode:O,isCastNode:D,isBinningNode:W,isScalingNode:z,isPolynomialFeaturesNode:R,isFeatureSelectionNode:U,isTransformerAuditNode:V,isOutlierNode:B,isSkewnessNode:X,isSkewnessDistributionNode:H,isBinnedDistributionNode:F,isDataConsistencyNode:K,isInspectionNode:re,isRemoveDuplicatesNode:G,isDropMissingColumnsNode:q,isDropMissingRowsNode:Y,isDropMissingNode:q||Y}},[t,e])},F2=({isScalingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(y=>y+1)},[]);return v.useEffect(()=>{let y=!0;return e?t?n?(h(!0),d(null),Jb(t,{graph:s,targetNodeId:l}).then(b=>{y&&c(b??null)}).catch(b=>{y&&(c(null),d((b==null?void 0:b.message)??"Unable to load scaling insights"))}).finally(()=>{y&&h(!1)}),()=>{y=!1}):(c(null),d("Connect this step to an upstream output to load scaling insights."),h(!1),()=>{y=!1}):(c(null),d("Select a dataset to load scaling insights."),h(!1),()=>{y=!1}):(c(null),d(null),h(!1),()=>{y=!1})},[s,n,e,f,t,l]),{scalingData:i,scalingError:u,isFetchingScaling:p,refreshScaling:w}},I2=({isBinningNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(y=>y+1)},[]);return v.useEffect(()=>{let y=!0;return e?t?n?(h(!0),d(null),Zb(t,{graph:s,targetNodeId:l}).then(b=>{y&&c(b??null)}).catch(b=>{y&&(c(null),d((b==null?void 0:b.message)??"Unable to load binning insights"))}).finally(()=>{y&&h(!1)}),()=>{y=!1}):(c(null),d("Connect this step to an upstream output to analyse numeric columns."),h(!1),()=>{y=!1}):(c(null),d("Select a dataset to load binning insights."),h(!1),()=>{y=!1}):(c(null),d(null),h(!1),()=>{y=!1})},[s,n,e,f,t,l]),{binningData:i,binningError:u,isFetchingBinning:p,refreshBinning:w}},B2=({shouldLoad:e,sourceId:t,graphContext:n,targetNodeId:s,transformations:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useRef(null),y=v.useCallback(()=>{g(b=>b+1)},[]);return v.useEffect(()=>{let b=!0;return e?t?(w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{if(!b)return;h(!0),d(null);let x;l.length>0&&(x=l.map(N=>({column:N.column,method:N.method}))),Xb(t,{transformations:x,graph:n,targetNodeId:s}).then(N=>{b&&c(N??null)}).catch(N=>{b&&(c(null),d((N==null?void 0:N.message)??"Unable to load skewness insights"))}).finally(()=>{b&&h(!1)})},300),()=>{b=!1,w.current&&clearTimeout(w.current)}):(c(null),d("Select a dataset to load skewness insights."),h(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{b=!1}):(c(null),d(null),h(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{b=!1})},[n,f,e,t,s,l]),{skewnessData:i,skewnessError:u,isFetchingSkewness:p,refreshSkewness:y}},U2=({isBinnedDistributionNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l,samplePreset:i})=>{const[c,u]=v.useState(null),[d,p]=v.useState(null),[h,f]=v.useState(!1),[g,w]=v.useState(0),y=v.useCallback(()=>{w(b=>b+1)},[]);return v.useEffect(()=>{let b=!0;if(!e)return u(null),p(null),f(!1),()=>{b=!1};if(!t)return u(null),p("Select a dataset to load binned column distributions."),f(!1),()=>{b=!1};if(!n)return u(null),p("Connect this step to an upstream output to load binned column distributions."),f(!1),()=>{b=!1};f(!0),p(null);const x=Zc.find(E=>E.value===i)??Zc[0],N=x.value==="all"?"all":Number(x.value);return ex(t,{sampleSize:N,graph:s,targetNodeId:l}).then(E=>{b&&u(E??null)}).catch(E=>{b&&(u(null),p((E==null?void 0:E.message)??"Unable to load binned column distributions"))}).finally(()=>{b&&f(!1)}),()=>{b=!1}},[s,n,e,g,i,t,l]),{binnedDistributionData:c,binnedDistributionError:d,isFetchingBinnedDistribution:h,refreshBinnedDistribution:y}},q2=({shouldLoad:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l,setAvailableColumns:i,setColumnMissingMap:c})=>{const[u,d]=v.useState(!1),[p,h]=v.useState(null),[f,g]=v.useState(0),w=v.useCallback(()=>{!e||!t||!n||g(y=>y+1)},[n,e,t]);return v.useEffect(()=>{let y=!0;return e?t?n?(d(!0),h(null),Zp(t,{graph:s,targetNodeId:l}).then(b=>{if(!y)return;const x={};b&&typeof b=="object"&&(b!=null&&b.column_missing_map)&&typeof b.column_missing_map=="object"&&Object.entries(b.column_missing_map).forEach(([k,j])=>{const S=String(k??"").trim();if(!S)return;const M=Number(j);Number.isNaN(M)||M<0||(x[S]=Number(M))});const N=new Set;Array.isArray(b==null?void 0:b.all_columns)&&b.all_columns.forEach(k=>{const j=String(k??"").trim();j&&N.add(j)}),Object.keys(x).forEach(k=>N.add(k));const E=Array.from(N).sort((k,j)=>k.localeCompare(j));E.forEach(k=>{Object.prototype.hasOwnProperty.call(x,k)||(x[k]=0)}),E.length&&i(E),Object.keys(x).length&&c(k=>({...k,...x}))}).catch(b=>{y&&h((b==null?void 0:b.message)??"Unable to load column metrics.")}).finally(()=>{y&&d(!1)}),()=>{y=!1}):(h("Connect this step to an upstream output to load column metrics."),d(!1),()=>{y=!1}):(h("Select a dataset to load column metrics."),d(!1),()=>{y=!1}):()=>{y=!1}},[s,n,f,i,c,e,t,l]),{isFetching:u,error:p,refreshDropColumnRecommendations:w}},H2=({isOutlierNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(y=>y+1)},[]);return v.useEffect(()=>{let y=!0;return e?t?n?(h(!0),d(null),Qb(t,{graph:s,targetNodeId:l}).then(b=>{y&&c(b??null)}).catch(b=>{y&&(c(null),d((b==null?void 0:b.message)??"Unable to load outlier insights"))}).finally(()=>{y&&h(!1)}),()=>{y=!1}):(c(null),d("Connect this step to an upstream output to load outlier insights."),h(!1),()=>{y=!1}):(c(null),d("Select a dataset to load outlier insights."),h(!1),()=>{y=!1}):(c(null),d(null),h(!1),()=>{y=!1})},[s,n,e,f,t,l]),{outlierData:i,outlierError:u,isFetchingOutliers:p,refreshOutliers:w}},V2=["int","float","double","decimal","number","numeric","long","short"],W2=["datetime","date","time","timestamp"],K2=["object","string","text","category","categorical","char"],Y2=({shouldAnalyze:e,availableColumns:t,columnTypeMap:n,previewSampleRows:s})=>{const l=v.useMemo(()=>{if(!e)return{excluded:new Set,reasons:new Map};const i=new Set,c=new Map;return t.forEach(u=>{const d=(n[u]??"").toLowerCase(),p=V2.some(N=>d.includes(N)),h=W2.some(N=>d.includes(N)),f=K2.some(N=>d.includes(N));if(d.includes("bool")){i.add(u),c.set(u,"Boolean dtype");return}if((h||f)&&!p){i.add(u),c.set(u,"Non-numeric dtype");return}const g=s.map(N=>N&&Object.prototype.hasOwnProperty.call(N,u)?N[u]:void 0).filter(N=>N!=null);if(!g.length){p||(i.add(u),c.set(u,"No numeric samples"));return}let w=!0,y=!1,b=!1;const x=new Set;for(const N of g){if(typeof N=="boolean"){x.add(N?"1":"0");continue}if(typeof N=="number"){if(!Number.isFinite(N)){w=!1;break}y=!0,Math.abs(N)<1e-9?x.add("0"):Math.abs(N-1)<1e-9?x.add("1"):b=!0;continue}if(typeof N=="string"){const E=N.trim();if(!E)continue;const k=E.toLowerCase();if(U0.has(k)){x.add("1");continue}if(q0.has(k)){x.add("0");continue}const j=Number(E);if(!Number.isNaN(j)&&Number.isFinite(j)){y=!0,Math.abs(j)<1e-9?x.add("0"):Math.abs(j-1)<1e-9?x.add("1"):b=!0;continue}w=!1;break}w=!1;break}if(!w||!y&&!p){i.add(u),c.set(u,"Non-numeric values");return}!b&&x.size>0&&Array.from(x).every(E=>E==="0"||E==="1")&&(i.add(u),c.set(u,"Binary/bool-like values"))}),{excluded:i,reasons:c}},[t,n,s,e]);return{numericExcludedColumns:l.excluded,numericExclusionReasons:l.reasons}},G2=({isImputerNode:e,imputerStrategies:t,availableColumns:n,columnMissingMap:s,previewColumns:l,previewColumnStats:i,nodeColumns:c,imputerMissingFilter:u})=>{const d=v.useMemo(()=>{if(!e)return[];const g=l.length?new Set(l.map(k=>typeof k=="string"?k.trim():"").filter(k=>k.length>0)):null,w=new Set;t.forEach(k=>{k.columns.forEach(j=>{const S=typeof j=="string"?j.trim():"";S&&w.add(S)})}),Ze(c).forEach(k=>{k&&w.add(k)});const y=k=>!g||g.size===0?!1:!g.has(k)&&!w.has(k),b=new Map,x=(k,j)=>{const S=typeof k=="string"?k.trim():"";if(!S||y(S))return;const M=b.get(S)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};j&&(typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)&&(M.missingPercentage=Math.max(0,j.missingPercentage)),j.dtype!==void 0&&(M.dtype=j.dtype),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&(M.mean=j.mean),typeof j.median=="number"&&!Number.isNaN(j.median)&&(M.median=j.median),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&(M.mode=j.mode)),b.set(S,M)};n.forEach(k=>{const j=Object.prototype.hasOwnProperty.call(s,k)?s[k]:null;x(k,{missingPercentage:typeof j=="number"?j:null})}),(Array.isArray(i)?i:[]).forEach(k=>{!k||!k.name||x(k.name,{missingPercentage:typeof k.missing_percentage=="number"?k.missing_percentage:null,dtype:k.dtype??null,mean:typeof k.mean=="number"?k.mean:null,median:typeof k.median=="number"?k.median:null,mode:k.mode??null})}),Ze(c).forEach(k=>x(k)),t.forEach(k=>{k.columns.forEach(j=>x(j))});const E=Array.from(b.entries()).map(([k,j])=>({name:k,missingPercentage:typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)?Math.max(0,j.missingPercentage):null,dtype:j.dtype??null,mean:typeof j.mean=="number"&&!Number.isNaN(j.mean)?j.mean:null,median:typeof j.median=="number"&&!Number.isNaN(j.median)?j.median:null,mode:j.mode!==void 0&&j.mode!==null&&j.mode!==""?j.mode:null}));return E.sort((k,j)=>{const S=typeof k.missingPercentage=="number",M=typeof j.missingPercentage=="number";return S&&M&&k.missingPercentage!==j.missingPercentage?j.missingPercentage-k.missingPercentage:S!==M?S?-1:1:k.name.localeCompare(j.name)}),E},[n,s,t,c,i,l,e]),p=v.useMemo(()=>{if(!d.length)return 100;const g=d.reduce((y,b)=>{const x=typeof b.missingPercentage=="number"?b.missingPercentage:0;return x>y?x:y},0),w=Math.ceil(g/5)*5;return Math.max(100,w||0)},[d]),h=v.useMemo(()=>d.length?d.reduce((g,w)=>{const y=typeof w.missingPercentage=="number"?w.missingPercentage:null;return y!==null?y<=0?g:y>=u?g+1:g:u===0?g+1:g},0):0,[d,u]),f=u>0;return{imputerColumnOptions:d,imputerMissingSliderMax:p,imputerFilteredOptionCount:h,imputerMissingFilterActive:f}},Q2=({configState:e,setConfigState:t,isFeatureTargetSplitNode:n,isTrainTestSplitNode:s,isTrainModelDraftNode:l,isHyperparameterTuningNode:i,isClassResamplingNode:c,isClassOversamplingNode:u,isClassUndersamplingNode:d,upstreamTargetColumn:p,nodeId:h,modelTypeOptions:f})=>{const g=l||i,w=v.useMemo(()=>{if(!n)return null;const T=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",L=Ze(e==null?void 0:e.feature_columns).map(P=>typeof P=="string"?P.trim():"").filter(P=>!!P);return{targetColumn:T,featureColumns:L}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,n]),y=v.useMemo(()=>{if(!s)return null;const T=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,L=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,P=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,O=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,D=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,W=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:T,validation_size:L,random_state:P,shuffle:O,stratify:D,target_column:W}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,s]),b=v.useMemo(()=>{if(!c)return null;const T=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",L=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",P=e==null?void 0:e.sampling_strategy;let O=null;if(typeof P=="number"&&Number.isFinite(P))O=P;else if(typeof P=="string"){const U=P.trim();O=U||null}else P===null&&(O=null);const D=e==null?void 0:e.random_state;let W=null;if(typeof D=="number"&&Number.isFinite(D))W=D;else if(typeof D=="string"){const U=Number(D);W=Number.isFinite(U)?U:null}let z=null;if(d){const U=e==null?void 0:e.replacement;z=typeof U=="boolean"?U:typeof U=="string"?U.trim().toLowerCase()==="true":!!U}let R=null;if(u){const U=e==null?void 0:e.k_neighbors;if(typeof U=="number"&&Number.isFinite(U))R=Math.max(1,Math.round(U));else if(typeof U=="string"){const V=Number(U);Number.isFinite(V)&&(R=Math.max(1,Math.round(V)))}}return{method:T,targetColumn:L,samplingStrategy:O,randomState:W,replacement:z,kNeighbors:R}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,u,c,d]),x=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",N=x==="regression"?"regression":"classification",E=v.useMemo(()=>Array.isArray(f)?f.filter(T=>T&&typeof T.value=="string"):[],[f]),k=v.useMemo(()=>{const T={classification:[],regression:[]};return E.forEach(L=>{var O;const P=String(((O=L==null?void 0:L.metadata)==null?void 0:O.problem_type)??"").trim().toLowerCase();P==="regression"?T.regression.push(L):P==="classification"?T.classification.push(L):(T.classification.push(L),T.regression.push(L))}),T},[E]),j=v.useMemo(()=>{if(!E.length)return[];const T=N==="regression"?k.regression:k.classification;return T.length>0?T:E},[E,k,N]),S=v.useMemo(()=>g?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:N}:null,[e==null?void 0:e.target_column,g,N]),M=v.useMemo(()=>{if(!g)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const T=(e==null?void 0:e.cv_enabled)===void 0?!!i:!!e.cv_enabled,L=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",P=["auto","kfold","stratified_kfold"].includes(L)?L:"auto",O=Number(e==null?void 0:e.cv_folds),D=Number.isFinite(O)&&O>=2?Math.floor(O):5,W=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let z=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))z=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const V=Number(e.cv_random_state.trim());z=Number.isFinite(V)?Math.trunc(V):null}const U=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:T,strategy:P,folds:D,shuffle:W,randomState:z,refitStrategy:U}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,i,g]);v.useEffect(()=>{g&&x!==N&&t(T=>({...T,problem_type:N}))},[g,N,x,t]),v.useEffect(()=>{var O;if(!g||!j.length)return;const T=new Set(j.map(D=>D.value)),L=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if(L&&T.has(L))return;const P=((O=j[0])==null?void 0:O.value)??"";P&&t(D=>{const W=typeof(D==null?void 0:D.model_type)=="string"?D.model_type.trim():"";return W&&T.has(W)||W===P?D:{...D,model_type:P}})},[e==null?void 0:e.model_type,j,g,t]);const $=v.useMemo(()=>{if(!g)return null;const T=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",L=e==null?void 0:e.hyperparameters;let P=null,O=null;if(L&&typeof L=="string"){const D=L.trim();if(D.length)try{const W=JSON.parse(D);W&&typeof W=="object"&&!Array.isArray(W)?P=W:O="Hyperparameters JSON must be an object."}catch{O="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else L&&typeof L=="object"&&!Array.isArray(L)&&(P=L);return{modelType:T||null,hyperparameters:P,hyperparametersError:O}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,g]);return v.useEffect(()=>{(s||l||i)&&p&&(s&&(e==null?void 0:e.stratify)!==!0||t(T=>(typeof(T==null?void 0:T.target_column)=="string"?T.target_column.trim():"")?T:{...T,target_column:p}))},[e==null?void 0:e.stratify,i,l,s,h,t,p]),{featureTargetSplitConfig:w,trainTestSplitConfig:y,resamplingConfig:b,trainModelDraftConfig:S,trainModelRuntimeConfig:$,trainModelCVConfig:M,filteredModelTypeOptions:j}},X2=["int","float","double","numeric","number"],uw=e=>{if(!e)return!1;const t=e.toLowerCase();return X2.some(n=>t.includes(n))},J2=({skewnessData:e,shouldLoadInsights:t,skewnessTransformations:n,availableColumns:s,previewColumns:l,columnTypeMap:i,updateSkewnessTransformations:c})=>{const[u,d]=v.useState("recommended"),[p,h]=v.useState(!1),[f,g]=v.useState("before"),w=n.length,y=v.useMemo(()=>e!=null&&e.methods?[...e.methods]:[],[e==null?void 0:e.methods]),b=v.useMemo(()=>UM(y),[y]),x=v.useMemo(()=>e!=null&&e.columns?[...e.columns]:[],[e==null?void 0:e.columns]),N=v.useMemo(()=>{const V=new Map;return x.forEach(B=>{B&&B.column&&V.set(B.column,B)}),V},[x]),E=v.useMemo(()=>{const V=new Set;return x.forEach(B=>{B!=null&&B.column&&V.add(B.column)}),s.forEach(B=>{B&&uw(i[B]??null)&&V.add(B)}),l.forEach(B=>{const X=typeof B=="string"?B.trim():"";X&&uw(i[X]??null)&&V.add(X)}),Array.from(V).sort((B,X)=>B.localeCompare(X))},[s,l,x,i]);v.useEffect(()=>{u==="recommended"&&x.length===0&&E.length>0&&d("all")},[E.length,x.length,u]);const k=(e==null?void 0:e.skewness_threshold)??null,j=v.useCallback(V=>b[V]??V,[b]),S=v.useCallback((V,B)=>{const X=N.get(V);return!X||!X.method_status?{status:"ready",reason:void 0}:X.method_status[B]??{status:"ready",reason:void 0}},[N]),M=v.useCallback(()=>{const V=x.map(B=>{if(!B||!B.column)return null;const X=Array.isArray(B.recommended_methods)?B.recommended_methods.find(ka):void 0;return X?{column:B.column,method:X}:null}).filter(B=>!!B);V.length&&c(B=>{const X=new Map;return B.forEach(H=>{const F=typeof H.column=="string"?H.column.trim():"";F&&ka(H.method)&&X.set(F,H.method)}),V.forEach(H=>{const F=typeof H.column=="string"?H.column.trim():"";F&&X.set(F,H.method)}),Array.from(X.entries()).map(([H,F])=>({column:H,method:F}))})},[x,c]),$=v.useMemo(()=>{const V=new Map;return n.forEach(B=>{const X=typeof B.column=="string"?B.column.trim():"";!X||V.has(X)||V.set(X,B.method)}),V},[n]),T=v.useCallback((V,B)=>{const X=typeof V=="string"?V.trim():"";X&&c(H=>{const F=H.filter(K=>K.column!==X);return B?[...F,{column:X,method:B}]:F})},[c]),L=v.useCallback((V,B)=>{if(V){if(!B){T(V,null);return}ka(B)&&T(V,B)}},[T]),P=v.useCallback(()=>{c(()=>[])},[c]),O=x.length,D=v.useMemo(()=>x.some(V=>V&&typeof V.column=="string"&&Array.isArray(V.recommended_methods)&&V.recommended_methods.some(ka)),[x]),W=E.length,z=v.useMemo(()=>qM({viewMode:u,recommendations:x,columnOptions:E,recommendationMap:N,transformationMap:$}),[u,x,E,N,$]),R=v.useMemo(()=>t?x.map(V=>{var Q;if(!V||!V.column)return null;const B=V.distribution_before??V.distribution??null;if(!B||!Array.isArray(B.bin_edges)||!Array.isArray(B.counts)||B.counts.length===0||B.bin_edges.length!==B.counts.length+1)return null;let X=V.distribution_after??null;X&&(!Array.isArray(X.bin_edges)||!Array.isArray(X.counts)||X.counts.length===0||X.bin_edges.length!==X.counts.length+1)&&(X=null);const H=((Q=V.recommended_methods)==null?void 0:Q.find(ka))??null,F=V.magnitude?`${V.magnitude.charAt(0).toUpperCase()}${V.magnitude.slice(1)}`:null,K=V.direction?Nx[V.direction]??V.direction:null,re=V.applied_method&&ka(V.applied_method)?V.applied_method:null,G=$.get(V.column)??null,q=re??G??null,Y=q?j(q):null;return{column:V.column,skewness:typeof V.skewness=="number"?V.skewness:null,magnitudeLabel:F,directionLabel:K,summary:V.summary??null,recommendedLabel:Y?null:H?j(H):null,appliedLabel:Y,distributionBefore:B,distributionAfter:X}}).filter(V=>!!V).sort((V,B)=>{const X=V.skewness!==null?Math.abs(V.skewness):-1/0,H=B.skewness!==null?Math.abs(B.skewness):-1/0;return X!==H?H-X:V.column.localeCompare(B.column)}):[],[j,t,x,$]),U=v.useMemo(()=>HM(z,p,j),[z,p,j]);return{skewnessThreshold:k,skewnessViewMode:u,setSkewnessViewMode:d,skewnessGroupByMethod:p,setSkewnessGroupByMethod:h,skewnessDistributionView:f,setSkewnessDistributionView:g,skewnessRecommendedCount:O,skewnessNumericCount:W,skewnessTransformationsCount:w,hasSkewnessAutoRecommendations:D,skewnessRows:z,skewnessTableGroups:U,skewnessDistributionCards:R,getSkewnessMethodLabel:j,getSkewnessMethodStatus:S,applySkewnessRecommendations:M,handleSkewnessOverrideChange:L,clearSkewnessTransformations:P}},Z2={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},e$=new Set(Pm.map(e=>e.value)),hu=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),dw=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),mw=e=>{const n=hu(e).filter(s=>e$.has(s));return n.length?n:["year","month","day"]},fu=e=>e==null?null:Number.isFinite(e)?e:null,hw=e=>{const t=fu(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},fw=e=>typeof e!="string"?"UTC":e.trim()||"UTC",Qs=["iqr","zscore","elliptic_envelope","winsorize","manual"],vl={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},Bm={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},po={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Um=(e,{min:t,max:n}={})=>{const s=typeof e=="number"?e:Number(e);if(!Number.isFinite(s))return null;let l=s;return typeof t=="number"&&Number.isFinite(t)&&l<t&&(l=t),typeof n=="number"&&Number.isFinite(n)&&l>n&&(l=n),l},pw=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const s=String(n??"").trim();s&&t.push(s)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,s)=>n.localeCompare(s))},t$=e=>{const t={iqr:{...po.iqr},zscore:{...po.zscore},elliptic_envelope:{...po.elliptic_envelope},winsorize:{...po.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,s])=>{const l=n.trim().toLowerCase();if(!Qs.includes(l))return;const i=t[l]??{};if(!(!s||typeof s!="object"||Array.isArray(s))){if(Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Bm[l].includes(d))return;let p={};d==="threshold"?p={min:.1}:d==="multiplier"?p={min:.1}:(d==="lower_percentile"||d==="upper_percentile")&&(p={min:0,max:100});const h=Um(u,p);h!==null&&(i[d]=h)}),l==="winsorize"){const c=Um(i.lower_percentile,{min:0,max:100}),u=Um(i.upper_percentile,{min:0,max:100});typeof c=="number"&&typeof u=="number"&&c>=u?(i.lower_percentile=po.winsorize.lower_percentile,i.upper_percentile=po.winsorize.upper_percentile):(typeof c=="number"&&(i.lower_percentile=c),typeof u=="number"&&(i.upper_percentile=u))}t[l]=i}}),t},n$=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,s])=>{const l=String(n??"").trim();if(!l||!s||typeof s!="object"||Array.isArray(s))return;const i={};Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Object.values(Bm).some(g=>g.includes(d)))return;let h={};d==="threshold"?h={min:.1}:d==="multiplier"?h={min:.1}:d==="contamination"?h={min:1e-4,max:.49}:(d==="lower_percentile"||d==="upper_percentile")&&(h={min:0,max:100});const f=Um(u,h);f!==null&&(i[d]=f)}),Object.keys(i).length&&(t[l]=i)}),t},s$=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=pw(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",l=Qs.includes(s)?s:"iqr",i={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([h,f])=>{const g=String(h??"").trim(),w=typeof f=="string"?f.trim().toLowerCase():"";g&&Qs.includes(w)&&(i[g]=w)});const c=typeof t.auto_detect=="boolean"?t.auto_detect:!0,u=pw(t.skipped_columns),d=t$(t.method_parameters),p=n$(t.column_parameters);return{columns:n,defaultMethod:l,columnMethods:i,autoDetect:c,skippedColumns:u,methodParameters:d,columnParameters:p}},r$=e=>{const t={...vl};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&l&&Qs.includes(s)&&(t[s]=l)}),t},a$=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&Qs.includes(s)&&t.set(s,n)}),t},o$=e=>Qs.map(t=>({value:t,label:e[t]??vl[t]??t})),l$=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:s,skippedColumns:l,excludedColumns:i})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p={};Array.isArray(u==null?void 0:u.method_summaries)&&u.method_summaries.forEach(k=>{const j=k==null?void 0:k.method;j&&Qs.includes(j)&&(p[j]=k)});const h=u!=null&&u.recommended_method&&Qs.includes(u.recommended_method)?u.recommended_method:null,f=h?n[h]??vl[h]??h:null,g=t.columnMethods[d]??null,w=g??t.defaultMethod,y=n[w]??vl[w]??w,b=l.has(d),x=i.has(d),N=s.has(d),E=!!(u!=null&&u.has_missing);c.push({column:d,dtype:typeof(u==null?void 0:u.dtype)=="string"?u.dtype:null,stats:(u==null?void 0:u.stats)??{},recommendedMethod:h,recommendedLabel:f,recommendedReason:typeof(u==null?void 0:u.recommended_reason)=="string"?u.recommended_reason:null,methodSummaries:p,currentOverride:g,currentMethod:w,currentMethodLabel:y,isOverrideApplied:g!==null,isSelected:N,isSkipped:b,isExcluded:x,hasMissing:E})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},i$=(e,t,n,s)=>{if(!e.length)return null;const l=e.map(i=>{const c=t[i],u=c?n[c]??vl[c]??c:null;return u?`${i} -> ${u}`:i});return s>e.length&&l.push(""),l.join(", ")},c$=(e,t)=>{var l;const n=(l=e==null?void 0:e.parameter_help)==null?void 0:l[t];if(n)return n;const s=t.replace(/_/g," ").trim();return s.charAt(0).toUpperCase()+s.slice(1)},u$=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},d$=(e,t,n,s,l)=>{var p;const i=n[s]??{};if(Object.prototype.hasOwnProperty.call(i,t)){const h=i[t];if(typeof h=="number"&&Number.isFinite(h))return{value:h,fallback:null}}const u=(l[e]??{})[t];return typeof u=="number"&&Number.isFinite(u)?{value:"",fallback:u}:{value:"",fallback:((p=po[e])==null?void 0:p[t])??null??null}},gw=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",_w={lower_percentile:"%",upper_percentile:"%"},m$=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:s,outlierMethodOptions:l,outlierMethodDetailMap:i,outlierDefaultDetail:c,outlierAutoDetectEnabled:u,outlierSelectedCount:d,outlierDefaultLabel:p,outlierOverrideCount:h,outlierParameterOverrideCount:f,outlierOverrideExampleSummary:g,outlierHasOverrides:w,outlierRecommendationRows:y,outlierHasRecommendations:b,outlierStatusMessage:x,outlierError:N,outlierSampleSize:E,relativeOutlierGeneratedAt:k,outlierPreviewSignal:j,formatMetricValue:S,formatNumericStat:M,onApplyAllRecommendations:$,onClearOverrides:T,onDefaultMethodChange:L,onAutoDetectToggle:P,onOverrideSelect:O,onMethodParameterChange:D,onColumnParameterChange:W})=>{const z=u$(j);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:$,disabled:!b,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:T,disabled:!w,children:"Clear overrides"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),k&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",k,E!==null?` on ${S(E)} row${E===1?"":"s"}.`:"."]}),!k&&E!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",S(E)," row",E===1?"":"s","."]}),z&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",z]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:l.map(R=>{const U=i.get(R.value)??null,V=R.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${V?" canvas-scaling__method-button--active":""}`,"aria-pressed":V,onClick:()=>L(R.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:R.label}),(U==null?void 0:U.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:U.description})]},R.value)})}),(c==null?void 0:c.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:c.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:R=>P(R.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]})]}),a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for each strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:Qs.map(R=>{const U=i.get(R)??null,V=Bm[R];if(!V.length)return null;const B=(U==null?void 0:U.label)??vl[R]??R;return a.jsxs("article",{className:"canvas-outlier__method-card",children:[a.jsxs("header",{className:"canvas-outlier__method-header",children:[a.jsx("span",{className:"canvas-outlier__method-title",children:B}),(U==null?void 0:U.description)&&a.jsx("p",{className:"canvas-outlier__method-summary",children:U.description})]}),a.jsx("div",{className:"canvas-outlier__parameter-list",children:V.map(X=>{var K,re;const H=((K=s.methodParameters[R])==null?void 0:K[X])??null,F=_w[X]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:c$(U,X)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx("input",{type:"number",className:"canvas-outlier__method-input-field",value:typeof H=="number"&&Number.isFinite(H)?H:"",placeholder:gw(((re=po[R])==null?void 0:re[X])??null),onChange:G=>{const q=G.target.value;if(q==="")D(R,X,null);else{const Y=Number(q);D(R,X,Number.isFinite(Y)?Y:null)}}}),F&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:F})]})]},`${R}-${X}`)})})]},`outlier-method-${R}`)})})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s","  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",(()=>{if(!(h+f))return"  No overrides yet";const U=[];return h>0&&U.push(g?`${h} method override${h===1?"":"s"} (${g})`:`${h} method override${h===1?"":"s"}`),f>0&&U.push(`${f} parameter override${f===1?"":"s"}`),`  Overrides: ${U.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&N&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:N}),!n&&!N&&a.jsxs(a.Fragment,{children:[x&&a.jsx("p",{className:"canvas-modal__note",children:x}),y.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:y.map(R=>{const U=!R.isSkipped&&!R.isExcluded&&R.recommendedMethod&&R.recommendedMethod!==R.currentMethod,V=["canvas-cast__row"];U&&V.push("canvas-cast__row--attention"),R.isOverrideApplied&&V.push("canvas-cast__row--override"),R.isSkipped&&V.push("canvas-cast__row--muted");const B=R.isSkipped?"__skip__":R.isOverrideApplied?R.currentMethod:"__default__",X=R.isOverrideApplied?`Override -> ${R.currentMethodLabel}`:R.isSkipped?"Skipped (column will not be altered)":R.isSelected?`Inheriting ${p}`:"Pending inclusion",H=R.stats,F=[];typeof H.valid_count=="number"&&Number.isFinite(H.valid_count)&&F.push(`${S(H.valid_count)} valid rows`);const K=typeof H.minimum=="number"&&Number.isFinite(H.minimum),re=typeof H.maximum=="number"&&Number.isFinite(H.maximum);if(K||re){const J=K?M(H.minimum):"",se=re?M(H.maximum):"";F.push(`Range ${J}  ${se}`)}typeof H.mean=="number"&&Number.isFinite(H.mean)&&F.push(`Mean ${M(H.mean)}`),typeof H.median=="number"&&Number.isFinite(H.median)&&F.push(`Median ${M(H.median)}`),typeof H.stddev=="number"&&Number.isFinite(H.stddev)&&F.push(` ${M(H.stddev)}`);const G=F.length?F.join("  "):null,q=!R.recommendedMethod||!R.recommendedLabel?R.recommendedReason||"No outlier risk detected":R.recommendedReason?`${R.recommendedLabel}  ${R.recommendedReason}`:R.recommendedLabel,Y=s.columnParameters,Q=s.methodParameters,ee=Bm[R.currentMethod]??[];return a.jsxs("tr",{className:V.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:R.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[R.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",R.dtype]}),R.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),R.isSelected&&!R.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),R.isSkipped&&!R.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),R.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),R.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[R.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${U?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:R.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),q&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:q})]})}),a.jsx("td",{children:G?a.jsx("span",{children:G}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:B,onChange:J=>O(R.column,J.target.value),disabled:R.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),l.map(J=>a.jsx("option",{value:J.value,children:J.label},`${R.column}-${J.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:X}),ee.length>0&&!R.isExcluded&&a.jsx("div",{className:"canvas-outlier__parameters",children:ee.map(J=>{const{value:se,fallback:ke}=d$(R.currentMethod,J,Y,R.column,Q),Pe=_w[J]??"";return a.jsxs("label",{children:[a.jsx("span",{children:J.replace(/_/g," ")}),a.jsx("input",{type:"number",value:se,placeholder:gw(ke),onChange:De=>{const Be=De.target.value;if(Be==="")W(R.column,J,null);else{const mt=Number(Be);W(R.column,J,Number.isFinite(mt)?mt:null)}}}),Pe&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:Pe})]},`${R.column}-${R.currentMethod}-${J}`)})})]})})]},`outlier-row-${R.column}`)})})]})})})]})]})},h$=e=>{const t=v.useMemo(()=>{var l,i,c,u,d,p;const s=[];return(l=e==null?void 0:e.data)!=null&&l.label&&s.push({label:"Label",value:String(e.data.label)}),(i=e==null?void 0:e.data)!=null&&i.description&&s.push({label:"Description",value:String(e.data.description)}),(c=e==null?void 0:e.data)!=null&&c.category&&s.push({label:"Category",value:String(e.data.category)}),(u=e==null?void 0:e.data)!=null&&u.catalogType&&s.push({label:"Node type",value:String(e.data.catalogType)}),(d=e==null?void 0:e.data)!=null&&d.inputs&&Array.isArray(e.data.inputs)&&e.data.inputs.length&&s.push({label:"Inputs",value:e.data.inputs.join(", ")}),(p=e==null?void 0:e.data)!=null&&p.outputs&&Array.isArray(e.data.outputs)&&e.data.outputs.length&&s.push({label:"Outputs",value:e.data.outputs.join(", ")}),s},[e]),n=v.useMemo(()=>{var l;const s=((l=e==null?void 0:e.data)==null?void 0:l.label)??(e==null?void 0:e.id);return typeof s=="string"&&s.trim()?s:`Node ${(e==null?void 0:e.id)??""}`},[e]);return{metadata:t,title:n}},f$=({connectionInfo:e,connectedInputHandles:t,connectedOutputHandles:n,connectionReady:s})=>e?a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:s?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",children:[a.jsx("strong",{children:s?"Ready to execute.":"Missing required connections."})," ",s?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]}),e.inputs&&e.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:e.inputs.map(l=>{const i=t.has(l.key),c=l.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:l.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":c?"Missing":"Optional"})]},`inputs-${l.key}`)})})]}),e.outputs&&e.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:e.outputs.map(l=>{const i=n.has(l.key),c=l.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:l.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":c?"Unlinked":"Optional"})]},`outputs-${l.key}`)})})]})]}):null,vw=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},p$=(e,t)=>{var w;const n=typeof(e==null?void 0:e.id)=="string"?e.id:"",s=v.useMemo(()=>{var x;const y=(x=e==null?void 0:e.data)==null?void 0:x.connectionInfo;if(!y)return null;const b=N=>Array.isArray(N)?N.map(E=>({...E})):[];return{inputs:b(y.inputs),outputs:b(y.outputs)}},[e]),l=v.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const y=t.edges.filter(b=>(b==null?void 0:b.target)===n).map(b=>vw(n,b==null?void 0:b.targetHandle)).filter(b=>!!b);return new Set(y)},[t,n]),i=v.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const y=t.edges.filter(b=>(b==null?void 0:b.source)===n).map(b=>vw(n,b==null?void 0:b.sourceHandle)).filter(b=>!!b);return new Set(y)},[t,n]),c=((w=e==null?void 0:e.data)==null?void 0:w.hasRequiredConnections)!==!1,u=v.useMemo(()=>{var y;return(y=s==null?void 0:s.inputs)!=null&&y.length?s.inputs.filter(b=>b.required!==!1):[]},[s==null?void 0:s.inputs]),d=v.useMemo(()=>u.length?u.filter(y=>!l.has(y.key)):[],[l,u]),p=c&&d.length===0,h=v.useMemo(()=>{if(!p)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[p]),f=p?void 0:!0,g=v.useMemo(()=>{if(!(s!=null&&s.inputs)||s.inputs.length===0)return;let y=!1;const b={};return s.inputs.forEach(x=>{if(!Array.isArray(x.accepts)||x.accepts.length===0)return;const N=l.has(x.key);x.accepts.forEach(E=>{(E==="train"||E==="validation"||E==="test")&&(b[E]=N,y=!0)})}),y?b:void 0},[s==null?void 0:s.inputs,l]);return{connectionInfo:s,connectedHandleKeys:l,connectedOutputHandleKeys:i,evaluationSplitConnectivity:g,connectionReady:p,gatedSectionStyle:h,gatedAriaDisabled:f}},g$=(e,t)=>{const{isBinningNode:n,isCastNode:s,isDropMissingColumnsNode:l,isDropMissingRowsNode:i,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:p,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:f,isRegexCleanupNode:g,isNormalizeTextCaseNode:w,isStandardizeDatesNode:y,isScalingNode:b,isClassUndersamplingNode:x,isClassOversamplingNode:N,isTrainModelDraftNode:E,isLabelEncodingNode:k,isOrdinalEncodingNode:j,isDummyEncodingNode:S,isOneHotEncodingNode:M,isRemoveDuplicatesNode:$,isSkewnessNode:T,isFeatureTargetSplitNode:L}=t;return v.useMemo(()=>{let P=e;return P=P.filter(O=>{var D;return((D=O==null?void 0:O.source)==null?void 0:D.type)!=="drop_column_recommendations"}),(l||i)&&(P=P.filter(O=>O.name!=="missing_threshold")),i&&(P=P.filter(O=>O.name!=="drop_if_any_missing")),c&&(P=P.filter(O=>O.name!=="strategies")),T&&(P=P.filter(O=>O.name!=="transformations")),s&&(P=P.filter(O=>O.name!=="columns")),n&&(P=P.filter(O=>O.name!=="columns")),b&&(P=P.filter(O=>!["columns","default_method","auto_detect"].includes(O.name))),$&&(P=P.filter(O=>O.name!=="columns"&&O.name!=="keep")),u&&(P=P.filter(O=>O.name!=="columns"&&O.name!=="flag_suffix")),d&&(P=P.filter(O=>!["columns","mode","custom_pairs"].includes(O.name))),p&&(P=P.filter(O=>!["columns","mode"].includes(O.name))),h&&(P=P.filter(O=>!["columns","mode","replacement"].includes(O.name))),f&&(P=P.filter(O=>!["columns","mode","min_value","max_value"].includes(O.name))),g&&(P=P.filter(O=>!["columns","mode","pattern","replacement"].includes(O.name))),w&&(P=P.filter(O=>!["columns","mode"].includes(O.name))),y&&(P=P.filter(O=>!["columns","mode"].includes(O.name))),x&&(P=P.filter(O=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(O.name))),N&&(P=P.filter(O=>!["method","target_column","sampling_strategy","random_state"].includes(O.name))),E&&(P=P.filter(O=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(O.name))),L&&(P=P.filter(O=>O.name!=="target_column")),k&&(P=P.filter(O=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(O.name))),j&&(P=P.filter(O=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(O.name))),S&&(P=P.filter(O=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(O.name))),M&&(P=P.filter(O=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(O.name))),P},[e,n,s,l,i,c,u,d,p,h,f,g,w,y,b,x,N,E,k,j,S,M,$,T,L])},_$=({node:e})=>{var f;const t=typeof(e==null?void 0:e.id)=="string"?e.id:void 0,n=v.useMemo(()=>{var w;const g=gg(((w=e==null?void 0:e.data)==null?void 0:w.config)??{});return!g||typeof g!="object"||Array.isArray(g)?{}:((!g.column_overrides||typeof g.column_overrides!="object"||Array.isArray(g.column_overrides))&&(g.column_overrides={}),g)},[e==null?void 0:e.id,(f=e==null?void 0:e.data)==null?void 0:f.config]),[s,l]=v.useState(n),[i,c]=v.useState(0),u=v.useRef(t);v.useEffect(()=>{u.current!==t&&(u.current=t,l(n),c(g=>g+1))},[t]);const d=v.useMemo(()=>cu(n),[n]),p=v.useMemo(()=>cu(s),[s]),h=v.useCallback(()=>{l(n)},[n]);return{initialConfig:n,configState:s,setConfigState:l,stableInitialConfig:d,stableCurrentConfig:p,nodeChangeVersion:i,resetToInitialConfig:h}},v$=({setConfigState:e})=>{const t=v.useCallback((c,u)=>{c&&e(d=>{const p={...d};return u===void 0?delete p[c]:p[c]=u,p})},[e]),n=v.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);Number.isNaN(d)||t(c,d)},[t]),s=v.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);if(!Number.isFinite(d))return;const p=Math.min(Math.max(d,0),100);t(c,p)},[t]),l=v.useCallback((c,u)=>{t(c,u)},[t]),i=v.useCallback((c,u)=>{t(c,u)},[t]);return{handleParameterChange:t,handleNumberChange:n,handlePercentileChange:s,handleBooleanChange:l,handleTextChange:i}},kg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},y$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Mg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],b$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=y$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Mg(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g}}).filter(t=>!!t),x$=e=>{if(!e||typeof e!="object")return{...kg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,c=Mg(e.high_cardinality_columns),u=Mg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:i,highCardinalityColumns:c,notes:u}},w$=({isLabelEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...kg}),[w,y]=v.useState(0);v.useEffect(()=>{let E=!0;const k=j=>{h([]),g({...kg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Hb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(b$(j)),g(x$(j)))}).catch(j=>{if(!E)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load label encoding suggestions";k(S)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(k("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(k(),()=>{E=!1}):(k(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||y(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},Ag={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},j$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Og=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],N$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=j$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Og(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_use_global_fallback:w}}).filter(t=>!!t),C$=e=>{if(!e||typeof e!="object")return{...Ag};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.enable_global_fallback_default,c=Og(e.high_cardinality_columns),u=Og(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:d,enableGlobalFallbackDefault:i,highCardinalityColumns:c,notes:u}},S$=({isTargetEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Ag}),[w,y]=v.useState(0);v.useEffect(()=>{let E=!0;const k=j=>{h([]),g({...Ag}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Wb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(N$(j)),g(C$(j)))}).catch(j=>{if(!E)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load target encoding suggestions";k(S)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(k("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(k(),()=>{E=!1}):(k(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||y(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},qm={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},E$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Pg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],k$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=E$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Pg(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_bucket_count:w}}).filter(t=>!!t),M$=e=>{if(!e||typeof e!="object")return{...qm};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,c=Number(e.suggested_bucket_default??0)||0,u=Pg(e.high_cardinality_columns),d=Pg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:i,suggestedBucketDefault:c,highCardinalityColumns:u,notes:d}},A$=({isHashEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...qm}),[w,y]=v.useState(0),b=v.useCallback(E=>{h([]),g({...qm}),c(!1),d(E??null)},[]);v.useEffect(()=>{let E=!0;return e?t?n?(c(!0),d(null),Kb(t,{graph:s??null,targetNodeId:l??null}).then(k=>{E&&(h(k$(k)),g(M$(k)))}).catch(k=>{E&&(h([]),g({...qm}),d(k!=null&&k.message?String(k.message):"Unable to load hash encoding suggestions"))}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(b("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(b(),()=>{E=!1}):(b(),()=>{E=!1})},[s,n,e,b,t,l,w]);const x=v.useCallback(()=>{y(E=>E+1)},[]);return v.useMemo(()=>({isFetching:i,error:u,suggestions:p,metadata:f,refresh:x}),[u,i,f,x,p])},Tg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},O$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},$g=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],P$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=O$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=$g(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_handle_unknown:w}}).filter(t=>!!t),T$=e=>{if(!e||typeof e!="object")return{...Tg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.enable_unknown_default,c=$g(e.high_cardinality_columns),u=$g(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:d,enableUnknownDefault:i,highCardinalityColumns:c,notes:u}},$$=({isOrdinalEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Tg}),[w,y]=v.useState(0);v.useEffect(()=>{let E=!0;const k=j=>{h([]),g({...Tg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Vb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(P$(j)),g(T$(j)))}).catch(j=>{if(!E)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load ordinal encoding suggestions";k(S)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(k("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(k(),()=>{E=!1}):(k(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||y(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},Lg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},L$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},zg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],z$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=L$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=zg(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,y=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:w,recommended_drop_first:y}}).filter(t=>!!t),D$=e=>{if(!e||typeof e!="object")return{...Lg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,c=zg(e.high_cardinality_columns),u=zg(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,cautionedCount:i,highCardinalityColumns:c,notes:u,autoDetectDefault:d}},R$=({isDummyEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Lg}),[w,y]=v.useState(0);v.useEffect(()=>{let E=!0;const k=j=>{h([]),g({...Lg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Gb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(z$(j)),g(D$(j)))}).catch(j=>{if(!E)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load dummy encoding suggestions";k(S)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(k("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(k(),()=>{E=!1}):(k(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||y(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},Dg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},F$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Rg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],I$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=F$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Rg(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,y=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:w,recommended_drop_first:y}}).filter(t=>!!t),B$=e=>{if(!e||typeof e!="object")return{...Dg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,c=Rg(e.high_cardinality_columns),u=Rg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,cautionedCount:i,highCardinalityColumns:c,notes:u}},U$=({isOneHotEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Dg}),[w,y]=v.useState(0);v.useEffect(()=>{let E=!0;const k=j=>{h([]),g({...Dg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Yb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(I$(j)),g(B$(j)))}).catch(j=>{if(!E)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load one-hot encoding suggestions";k(S)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(k("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(k(),()=>{E=!1}):(k(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||y(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},q$=({isTargetEncodingNode:e,enableGlobalFallbackDefault:t,encodeMissing:n,handleUnknown:s,setConfigState:l,nodeChangeVersion:i})=>{const c=v.useRef(!1);v.useEffect(()=>{c.current=!1},[i]),v.useEffect(()=>{if(!e||!t||c.current)return;const u=typeof n=="boolean"?n:null,d=typeof s=="string"?s.trim().toLowerCase():"";if(u===!0&&d==="global_mean"){c.current=!0;return}l(p=>{const h=typeof(p==null?void 0:p.encode_missing)=="boolean"?p.encode_missing:null,f=typeof(p==null?void 0:p.handle_unknown)=="string"?p.handle_unknown.trim().toLowerCase():"";if(h===!0&&f==="global_mean")return c.current=!0,p;const g={...p};return h!==!0&&(g.encode_missing=!0),f!=="global_mean"&&(g.handle_unknown="global_mean"),c.current=!0,g})},[n,s,e,t,l])},H$=({isLabelEncodingNode:e,isTargetEncodingNode:t,isHashEncodingNode:n,isOrdinalEncodingNode:s,isDummyEncodingNode:l,isOneHotEncodingNode:i,sourceId:c,hasReachableSource:u,graphContext:d,node:p,configState:h,setConfigState:f,nodeChangeVersion:g})=>{const w=(p==null?void 0:p.id)??null,{isFetching:y,error:b,suggestions:x,metadata:N}=w$({isLabelEncodingNode:e,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:E,error:k,suggestions:j,metadata:S}=S$({isTargetEncodingNode:t,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w});q$({isTargetEncodingNode:t,enableGlobalFallbackDefault:S.enableGlobalFallbackDefault,encodeMissing:h==null?void 0:h.encode_missing,handleUnknown:h==null?void 0:h.handle_unknown,setConfigState:f,nodeChangeVersion:g});const{isFetching:M,error:$,suggestions:T,metadata:L}=A$({isHashEncodingNode:n,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:P,error:O,suggestions:D,metadata:W}=$$({isOrdinalEncodingNode:s,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:z,error:R,suggestions:U,metadata:V}=R$({isDummyEncodingNode:l,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:B,error:X,suggestions:H,metadata:F}=U$({isOneHotEncodingNode:i,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w});v.useEffect(()=>{e&&(h!=null&&h.auto_detect)&&N.autoDetectDefault&&f(ee=>({...ee,columns:N.autoDetectDefault}))},[h==null?void 0:h.auto_detect,e,N.autoDetectDefault,f]),v.useEffect(()=>{t&&(h!=null&&h.auto_detect)&&S.autoDetectDefault&&f(ee=>({...ee,columns:S.autoDetectDefault}))},[h==null?void 0:h.auto_detect,t,f,S.autoDetectDefault]),v.useEffect(()=>{n&&(h!=null&&h.auto_detect)&&L.autoDetectDefault&&f(ee=>({...ee,columns:L.autoDetectDefault}))},[h==null?void 0:h.auto_detect,L.autoDetectDefault,n,f]),v.useEffect(()=>{n&&L.suggestedBucketDefault&&f(ee=>({...ee,n_buckets:L.suggestedBucketDefault}))},[L.suggestedBucketDefault,n,f]),v.useEffect(()=>{t&&S.enableGlobalFallbackDefault&&f(ee=>{const J={};return ee.encode_missing===void 0&&(J.encode_missing=!0),ee.handle_unknown===void 0&&(J.handle_unknown="value"),Object.keys(J).length>0?{...ee,...J}:ee})},[h==null?void 0:h.encode_missing,h==null?void 0:h.handle_unknown,t,f,S.enableGlobalFallbackDefault]),v.useEffect(()=>{s&&(h!=null&&h.auto_detect)&&W.autoDetectDefault&&f(ee=>({...ee,columns:W.autoDetectDefault}))},[h==null?void 0:h.auto_detect,s,W.autoDetectDefault,f]),v.useEffect(()=>{s&&W.enableUnknownDefault&&f(ee=>ee.handle_unknown===void 0?{...ee,handle_unknown:"use_encoded_value",unknown_value:-1}:ee)},[h==null?void 0:h.handle_unknown,s,W.enableUnknownDefault,f]),v.useEffect(()=>{l&&(h!=null&&h.auto_detect)&&V.autoDetectDefault&&f(ee=>({...ee,columns:V.autoDetectDefault}))},[h==null?void 0:h.auto_detect,V.autoDetectDefault,l,f]);const K=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),re=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),G=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),q=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),Y=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),Q=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]);return{isFetchingLabelEncoding:y,labelEncodingError:b,labelEncodingSuggestions:x,labelEncodingMetadata:N,isFetchingTargetEncoding:E,targetEncodingError:k,targetEncodingSuggestions:j,targetEncodingMetadata:S,isFetchingHashEncoding:M,hashEncodingError:$,hashEncodingSuggestions:T,hashEncodingMetadata:L,isFetchingOrdinalEncoding:P,ordinalEncodingError:O,ordinalEncodingSuggestions:D,ordinalEncodingMetadata:W,isFetchingDummyEncoding:z,dummyEncodingError:R,dummyEncodingSuggestions:U,dummyEncodingMetadata:V,isFetchingOneHotEncoding:B,oneHotEncodingError:X,oneHotEncodingSuggestions:H,oneHotEncodingMetadata:F,handleApplyLabelEncodingRecommended:K,handleApplyTargetEncodingRecommended:re,handleApplyHashEncodingRecommended:G,handleApplyOrdinalEncodingRecommended:q,handleApplyDummyEncodingRecommended:Y,handleApplyOneHotEncodingRecommended:Q}},vr=["standard","robust","minmax","maxabs"],yl={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},yw={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},bw=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],xw=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=bw(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",l=vr.includes(s)?s:"standard",i={},c=t.column_methods;c&&typeof c=="object"&&!Array.isArray(c)&&Object.entries(c).forEach(([p,h])=>{const f=String(p??"").trim(),g=typeof h=="string"?h.trim().toLowerCase():"";f&&vr.includes(g)&&(i[f]=g)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=bw(t.skipped_columns);return{columns:n,defaultMethod:l,columnMethods:i,autoDetect:u,skippedColumns:d}},V$=e=>{const t={...yl};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&vr.includes(s)&&l&&(t[s]=l)}),t},W$=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&vr.includes(s)&&t.set(s,n)}),t},K$=e=>vr.map(t=>({value:t,label:e[t]??yl[t]??t})),Y$=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:s,scalingSkippedColumns:l,scalingExcludedColumns:i})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p=u.recommended_method,h=n[p]??yl[p]??p,f=Array.isArray(u.fallback_methods)?u.fallback_methods.filter(M=>vr.includes(M)).map(M=>{const $=M;return n[$]??yl[$]??$}):[],g=u.confidence??"medium",w=yw[g]??yw.medium,b=t.columnMethods[d]??null,x=b??t.defaultMethod,N=n[x]??yl[x]??x,E=i.has(d),k=l.has(d),j=s.has(d),S=u.stats;c.push({column:d,dtype:u.dtype??null,recommendedMethod:p,recommendedLabel:h,confidence:g,confidenceLabel:w,reasons:Array.isArray(u.reasons)?u.reasons:[],fallbackLabels:f,stats:S,hasMissing:!!u.has_missing,currentOverride:b,currentMethod:x,currentMethodLabel:N,isOverrideApplied:b!==null,isSelected:j,isExcluded:E,isSkipped:k})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},G$=(e,t,n,s)=>{if(!e.length)return null;const l=e.map(i=>{const c=t[i],u=c?n[c]??yl[c]??c:null;return u?`${i} -> ${u}`:i});return s>e.length&&l.push(""),l.join(", ")},Q$=({isScalingNode:e,configState:t,numericExcludedColumns:n,scalingData:s})=>{const l=v.useMemo(()=>xw(t),[t]),i=v.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),c=v.useMemo(()=>e?n:new Set,[e,n]),u=v.useMemo(()=>e?new Set(l.columns):new Set,[e,l.columns]),d=v.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),p=v.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(D=>!!(D&&D.column)):[],[s==null?void 0:s.columns]),h=v.useMemo(()=>V$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=v.useMemo(()=>W$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=v.useMemo(()=>Y$({recommendations:p,scalingConfig:l,scalingMethodLabelMap:h,scalingSelectedSet:u,scalingSkippedColumns:i,scalingExcludedColumns:c}),[p,l,h,u,i,c]),w=v.useMemo(()=>Array.from(d).sort((D,W)=>D.localeCompare(W)),[d]),y=v.useMemo(()=>w.slice(0,4),[w]),b=g.length,x=d.size,N=u.size,E=l.autoDetect,k=v.useMemo(()=>f.get(l.defaultMethod)??null,[l.defaultMethod,f]),j=v.useMemo(()=>{const D=l.defaultMethod;return h[D]??yl[D]??D},[l.defaultMethod,h]),S=b>0,M=v.useMemo(()=>g.filter(D=>!D.isSkipped&&!D.isExcluded&&D.isSelected&&D.recommendedMethod!==D.currentMethod).length,[g]),$=v.useMemo(()=>g.filter(D=>D.isSelected&&!D.isSkipped&&!D.isExcluded).length,[g]),T=v.useMemo(()=>g.filter(D=>D.isSkipped&&!D.isExcluded).length,[g]),L=v.useMemo(()=>g.length?M>0?`${M} column${M===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:$>0?"All configured columns align with the recommended scalers.":T>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[M,$,g,T]),P=v.useMemo(()=>K$(h),[h]),O=v.useMemo(()=>G$(y,l.columnMethods,h,x),[y,l.columnMethods,h,x]);return{scalingConfig:l,scalingExcludedColumns:c,scalingMethodDetailMap:f,scalingMethodOptions:P,scalingRecommendations:p,scalingRecommendationRows:g,scalingSelectedCount:N,scalingOverrideCount:x,scalingDefaultDetail:k,scalingDefaultLabel:j,scalingAutoDetectEnabled:E,scalingHasRecommendations:S,scalingStatusMessage:L,scalingOverrideExampleSummary:O}},X$=({isOutlierNode:e,configState:t,numericExcludedColumns:n,outlierData:s})=>{const l=v.useMemo(()=>s$(t),[t]),i=v.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(D=>!!(D&&D.column)):[],[s==null?void 0:s.columns]),c=v.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),u=v.useMemo(()=>e?new Set(l.columns):new Set,[e,l.columns]),d=v.useMemo(()=>{if(!e||!n.size)return new Set;const D=new Set;l.columns.forEach(z=>{const R=String(z??"").trim();R&&D.add(R)}),i.forEach(z=>{const R=String((z==null?void 0:z.column)??"").trim();R&&D.add(R)});const W=new Set;return n.forEach(z=>{D.has(z)||W.add(z)}),W},[e,n,l.columns,i]),p=v.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),h=v.useMemo(()=>r$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=v.useMemo(()=>a$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=v.useMemo(()=>l$({insights:i,outlierConfig:l,labelMap:h,selectedColumns:u,skippedColumns:c,excludedColumns:d}),[i,l,h,u,c,d]),w=v.useMemo(()=>o$(h),[h]),y=v.useMemo(()=>Array.from(p).sort((D,W)=>D.localeCompare(W)),[p]),b=v.useMemo(()=>y.slice(0,4),[y]),x=u.size,N=p.size,E=v.useMemo(()=>Object.keys(l.columnParameters).length,[l.columnParameters]),k=l.autoDetect,j=v.useMemo(()=>f.get(l.defaultMethod)??null,[l.defaultMethod,f]),S=v.useMemo(()=>{const D=l.defaultMethod;return h[D]??vl[D]??D},[l.defaultMethod,h]),M=g.length>0,$=v.useMemo(()=>g.filter(D=>D.isSkipped||D.isExcluded||!D.isSelected||!D.recommendedMethod?!1:D.recommendedMethod!==D.currentMethod).length,[g]),T=v.useMemo(()=>g.filter(D=>D.isSelected&&!D.isSkipped&&!D.isExcluded).length,[g]),L=v.useMemo(()=>g.filter(D=>D.isSkipped&&!D.isExcluded).length,[g]),P=v.useMemo(()=>g.length?$>0?`${$} column${$===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:T>0?"All configured columns align with the recommended outlier handling strategies.":L>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[$,T,g,L]),O=v.useMemo(()=>i$(b,l.columnMethods,h,N),[b,l.columnMethods,h,N]);return{outlierConfig:l,outlierExcludedColumns:d,outlierMethodLabelMap:h,outlierMethodDetailMap:f,outlierMethodOptions:w,outlierRecommendations:i,outlierRecommendationRows:g,outlierSelectedCount:x,outlierOverrideCount:N,outlierParameterOverrideCount:E,outlierDefaultDetail:j,outlierDefaultLabel:S,outlierAutoDetectEnabled:k,outlierHasRecommendations:M,outlierStatusMessage:P,outlierOverrideExampleSummary:O}},J$=({configState:e,nodeId:t})=>{const n=v.useMemo(()=>vx(e),[e]),s=n.columns.length,l=tg[n.strategy]??n.strategy,i=v.useMemo(()=>Object.keys(n.columnStrategies).map(y=>y.trim()).filter(Boolean).sort((y,b)=>y.localeCompare(b)),[n.columnStrategies]),c=i.length,u=v.useMemo(()=>{if(!i.length)return null;const y=i.slice(0,4);return jM(y,n.columnStrategies,c)},[n.columnStrategies,i,c]),d=v.useMemo(()=>`binning-${t||"node"}`,[t]),p=v.useMemo(()=>({equalWidth:`${d}-equal-width-bins`,equalFrequency:`${d}-equal-frequency-bins`,precision:`${d}-precision`,suffix:`${d}-suffix`,missingLabel:`${d}-missing-label`,includeLowest:`${d}-include-lowest`,dropOriginal:`${d}-drop-original`,labelFormat:`${d}-label-format`,duplicates:`${d}-duplicates`,kbinsNBins:`${d}-kbins-n-bins`,kbinsEncode:`${d}-kbins-encode`,kbinsStrategy:`${d}-kbins-strategy`}),[d]),[h,f]=v.useState({}),[g,w]=v.useState({});return v.useEffect(()=>{f(y=>{const b=new Set,x={...y};return n.columns.forEach(N=>{const E=String(N??"").trim();if(!E||(b.add(E),Object.prototype.hasOwnProperty.call(x,E)))return;const k=n.customBins[E]??[];x[E]=k.length>=2?k.join(", "):""}),Object.keys(x).forEach(N=>{b.has(N)||delete x[N]}),x})},[n.columns,n.customBins]),v.useEffect(()=>{w(y=>{const b=new Set,x={...y};return n.columns.forEach(N=>{const E=String(N??"").trim();if(!E||(b.add(E),Object.prototype.hasOwnProperty.call(x,E)))return;const k=n.customLabels[E]??[];x[E]=k.length>0?k.join(", "):""}),Object.keys(x).forEach(N=>{b.has(N)||delete x[N]}),x})},[n.columns,n.customLabels]),{binningConfig:n,binningSelectedCount:s,binningDefaultLabel:l,binningOverrideColumns:i,binningOverrideCount:c,binningOverrideSummary:u,fieldIds:p,customEdgeDrafts:h,setCustomEdgeDrafts:f,customLabelDrafts:g,setCustomLabelDrafts:w}},Z$=({setConfigState:e,setBinningCustomEdgeDrafts:t,setBinningCustomLabelDrafts:n,binningConfig:s,binningInsightsRecommendations:l,binningAllNumericColumns:i})=>{const c=v.useCallback((L,P,O,D)=>{e(W=>{const z=typeof(W==null?void 0:W[L])=="number"&&Number.isFinite(W[L])?W[L]:void 0;if(P===""){if(z===void 0)return W;const V={...W};return delete V[L],V}const R=Number(P);if(!Number.isFinite(R))return W;const U=Math.min(Math.max(Math.round(R),O),D);return z===U?W:{...W,[L]:U}})},[e]),u=v.useCallback((L,P)=>{e(O=>!!(O!=null&&O[L])===P?O:{...O,[L]:P})},[e]),d=v.useCallback(L=>{const P=L.trim();e(O=>{const D=typeof(O==null?void 0:O.output_suffix)=="string"?O.output_suffix:"";if(!P){if(!D)return O;const W={...O};return delete W.output_suffix,W}return D===P?O:{...O,output_suffix:P}})},[e]),p=v.useCallback(L=>{e(P=>{const O=typeof(P==null?void 0:P.label_format)=="string"?P.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(O)?O:"range")===L?P:{...P,label_format:L}})},[e]),h=v.useCallback(L=>{e(P=>{if(((P==null?void 0:P.missing_strategy)==="label"?"label":"keep")===L)return P;const D={...P,missing_strategy:L};return L!=="label"&&Object.prototype.hasOwnProperty.call(D,"missing_label")&&delete D.missing_label,D})},[e]),f=v.useCallback(L=>{const P=L.trim();e(O=>{const D=typeof(O==null?void 0:O.missing_label)=="string"?O.missing_label:"";if(!P){if(!D)return O;const W={...O};return delete W.missing_label,W}return D===P?O:{...O,missing_label:P}})},[e]),g=v.useCallback((L,P)=>{const O=String(L??"").trim();O&&(t(D=>({...D,[O]:P})),e(D=>{const W=D==null?void 0:D.custom_bins,z=W&&typeof W=="object"&&!Array.isArray(W)?W:{},R=Array.isArray(z[O])?z[O]:void 0,V=P.split(/[,\n]/).map(F=>F.trim()).filter(Boolean).map(F=>Number(F)).filter(F=>Number.isFinite(F)).sort((F,K)=>F-K).filter((F,K,re)=>K===0||F!==re[K-1]),B=V.length>=2;if(B&&R&&R.length===V.length&&R.every((F,K)=>F===V[K])||!B&&!R)return D;const X={...D},H={...z};return B?H[O]=V:delete H[O],Object.keys(H).length>0?X.custom_bins=H:delete X.custom_bins,X}))},[t,e]),w=v.useCallback((L,P)=>{const O=String(L??"").trim();O&&(n(D=>({...D,[O]:P})),e(D=>{const W=D==null?void 0:D.custom_labels,z=W&&typeof W=="object"&&!Array.isArray(W)?W:{},R=Array.isArray(z[O])?z[O]:void 0,U=P.split(/[,\n]/).map(X=>X.trim()).filter(Boolean);if(U.length>0&&R&&R.length===U.length&&R.every((X,H)=>X===U[H])||U.length===0&&!R)return D;const V={...D},B={...z};return U.length>0?B[O]=U:delete B[O],Object.keys(B).length>0?V.custom_labels=B:delete V.custom_labels,V}))},[n,e]),y=v.useCallback(L=>{const P=String(L??"").trim();P&&(t(O=>{if(!Object.prototype.hasOwnProperty.call(O,P))return O;const D={...O};return delete D[P],D}),n(O=>{if(!Object.prototype.hasOwnProperty.call(O,P))return O;const D={...O};return delete D[P],D}),e(O=>{let D=!1;const W={...O};if(O!=null&&O.custom_bins&&typeof O.custom_bins=="object"&&!Array.isArray(O.custom_bins)&&Object.prototype.hasOwnProperty.call(O.custom_bins,P)){const z={...O.custom_bins};delete z[P],Object.keys(z).length>0?W.custom_bins=z:delete W.custom_bins,D=!0}if(O!=null&&O.custom_labels&&typeof O.custom_labels=="object"&&!Array.isArray(O.custom_labels)&&Object.prototype.hasOwnProperty.call(O.custom_labels,P)){const z={...O.custom_labels};delete z[P],Object.keys(z).length>0?W.custom_labels=z:delete W.custom_labels,D=!0}return D?W:O}))},[t,n,e]),b=v.useCallback((L,P)=>{const O=String(L??"").trim();O&&e(D=>{const z={...D!=null&&D.column_strategies&&typeof D.column_strategies=="object"&&!Array.isArray(D.column_strategies)?D.column_strategies:D!=null&&D.column_overrides&&typeof D.column_overrides=="object"&&!Array.isArray(D.column_overrides)?D.column_overrides:{}},R=z[O],U=R&&typeof R=="object"&&!Array.isArray(R)?{...R}:{},V=P(U),B=!!(V&&Object.keys(V).length);B?z[O]=V:delete z[O];const X={...D};if(B){const H=new Set(Ze(D==null?void 0:D.columns));H.has(O)||(H.add(O),X.columns=Array.from(H).sort((F,K)=>F.localeCompare(K)))}return Object.keys(z).length?(X.column_overrides=z,X.column_strategies=z):(Object.prototype.hasOwnProperty.call(X,"column_overrides")&&delete X.column_overrides,Object.prototype.hasOwnProperty.call(X,"column_strategies")&&delete X.column_strategies),X})},[e]),x=v.useCallback((L,P,O)=>{const D=String(L??"").trim();if(!D)return;if(P==="__default__"){y(D),b(D,()=>null);return}const W=Number.isFinite(O==null?void 0:O.recommendedBins)?Math.round(O.recommendedBins):null;b(D,z=>{const R={...z};R.strategy=P;const U=V=>Math.min(200,Math.max(2,Math.round(W??V)));return P==="equal_width"?(R.equal_width_bins=U(s.equalWidthBins),delete R.equal_frequency_bins,delete R.kbins_n_bins,delete R.kbins_encode,delete R.kbins_strategy):P==="equal_frequency"?(R.equal_frequency_bins=U(s.equalFrequencyBins),delete R.equal_width_bins,delete R.kbins_n_bins,delete R.kbins_encode,delete R.kbins_strategy):P==="kbins"?(R.kbins_n_bins=U(s.kbinsNBins),R.kbins_encode=s.kbinsEncode,R.kbins_strategy=s.kbinsStrategy,delete R.equal_width_bins,delete R.equal_frequency_bins):P==="custom"&&(delete R.equal_width_bins,delete R.equal_frequency_bins,delete R.kbins_n_bins,delete R.kbins_encode,delete R.kbins_strategy),Object.keys(R).length?R:null}),P!=="custom"&&y(D)},[s.equalFrequencyBins,s.equalWidthBins,s.kbinsEncode,s.kbinsNBins,s.kbinsStrategy,y,b]),N=v.useCallback((L,P,O)=>{const D=String(L??"").trim();D&&(b(D,W=>{const z={...W};if(!O.trim())delete z[P];else{const R=Number(O);if(!Number.isFinite(R))return W;const U=Math.min(200,Math.max(2,Math.round(R)));z[P]=U,P==="equal_width_bins"?(z.strategy="equal_width",delete z.equal_frequency_bins,delete z.kbins_n_bins,delete z.kbins_encode,delete z.kbins_strategy):P==="equal_frequency_bins"?(z.strategy="equal_frequency",delete z.equal_width_bins,delete z.kbins_n_bins,delete z.kbins_encode,delete z.kbins_strategy):P==="kbins_n_bins"&&(z.strategy="kbins",delete z.equal_width_bins,delete z.equal_frequency_bins)}return Object.keys(z).length?z:null}),y(D))},[y,b]),E=v.useCallback((L,P)=>{const O=String(L??"").trim();O&&b(O,D=>{const W={...D};return P?(W.strategy="kbins",W.kbins_encode=P):delete W.kbins_encode,Object.keys(W).length?W:null})},[b]),k=v.useCallback((L,P)=>{const O=String(L??"").trim();O&&b(O,D=>{const W={...D};return P?(W.strategy="kbins",W.kbins_strategy=P):delete W.kbins_strategy,Object.keys(W).length?W:null})},[b]),j=v.useCallback(L=>{const P=String(L??"").trim();P&&(y(P),b(P,()=>null))},[y,b]),S=v.useCallback(()=>{e(L=>{if(!((L==null?void 0:L.column_strategies)&&typeof L.column_strategies=="object"&&!Array.isArray(L.column_strategies)&&Object.keys(L.column_strategies).length>0||(L==null?void 0:L.column_overrides)&&typeof L.column_overrides=="object"&&!Array.isArray(L.column_overrides)&&Object.keys(L.column_overrides).length>0))return L;const O={...L};return Object.prototype.hasOwnProperty.call(O,"column_overrides")&&delete O.column_overrides,Object.prototype.hasOwnProperty.call(O,"column_strategies")&&delete O.column_strategies,O})},[e]),M=v.useCallback(()=>{l.length&&l.forEach(L=>{const P=typeof(L==null?void 0:L.column)=="string"?L.column.trim():"";if(!P)return;const O=L.recommended_strategy??"equal_width";x(P,O,{recommendedBins:Number.isFinite(L==null?void 0:L.recommended_bins)?L.recommended_bins:null})})},[l,x]),$=v.useCallback(L=>{if(!L)return;const P=[];for(const O of L){const D=typeof O=="string"?O.trim():"";D&&P.push(D)}P.length&&e(O=>{const D=O&&typeof O=="object"?O:{},W=new Set(Ze(D.columns));let z=!1;if(P.forEach(U=>{W.has(U)||(W.add(U),z=!0)}),!z)return O;const R={...D};return R.columns=Array.from(W).sort((U,V)=>U.localeCompare(V)),R})},[e]),T=v.useCallback(()=>{i.length&&$(i)},[i,$]);return{handleBinningIntegerChange:c,handleBinningBooleanToggle:u,handleBinningSuffixChange:d,handleBinningLabelFormatChange:p,handleBinningMissingStrategyChange:h,handleBinningMissingLabelChange:f,handleBinningCustomBinsChange:g,handleBinningCustomLabelsChange:w,handleBinningClearCustomColumn:y,updateBinningColumnOverride:b,handleBinningOverrideStrategyChange:x,handleBinningOverrideNumberChange:N,handleBinningOverrideKbinsEncodeChange:E,handleBinningOverrideKbinsStrategyChange:k,handleBinningClearOverride:j,handleBinningClearOverrides:S,handleBinningApplyStrategies:M,handleBinningApplyColumns:$,handleApplyAllBinningNumeric:T}},eL=({setConfigState:e,outlierRecommendationRows:t,outlierExcludedColumns:n,outlierConfig:s})=>{const l=v.useCallback(y=>{Qs.includes(y)&&e(b=>(b==null?void 0:b.default_method)===y?b:{...b,default_method:y})},[e]),i=v.useCallback(y=>{e(b=>(typeof(b==null?void 0:b.auto_detect)=="boolean"?b.auto_detect:!0)===y?b:{...b,auto_detect:y})},[e]),c=v.useCallback((y,b)=>{const x=String(y??"").trim();x&&e(N=>{if(!N||typeof N!="object")return N;const E=Ze(N.columns),k=new Set(E),j=N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)?{...N.column_methods}:{};let S=!1;if(b){if(!Qs.includes(b))return N;j[x]!==b&&(j[x]=b,S=!0),k.has(x)||(k.add(x),S=!0)}else Object.prototype.hasOwnProperty.call(j,x)&&(delete j[x],S=!0);if(!S)return N;const M={...N};return M.columns=Array.from(k).sort(($,T)=>$.localeCompare(T)),Object.keys(j).length?M.column_methods=j:Object.prototype.hasOwnProperty.call(M,"column_methods")&&delete M.column_methods,M})},[e]),u=v.useCallback(()=>{e(y=>{if(!y||typeof y!="object")return y;const b=y.column_methods&&typeof y.column_methods=="object"&&!Array.isArray(y.column_methods)&&Object.keys(y.column_methods).length>0,x=y.column_parameters&&typeof y.column_parameters=="object"&&!Array.isArray(y.column_parameters)&&Object.keys(y.column_parameters).length>0;if(!b&&!x)return y;const N={...y};return b&&delete N.column_methods,x&&delete N.column_parameters,N})},[e]),d=v.useCallback(()=>{t.length&&e(y=>{if(!y||typeof y!="object")return y;const b=new Set(Ze(y.columns)),x=new Set(Ze(y.skipped_columns)),N=y.column_methods&&typeof y.column_methods=="object"&&!Array.isArray(y.column_methods)?{...y.column_methods}:{},E=y.column_parameters&&typeof y.column_parameters=="object"&&!Array.isArray(y.column_parameters)?{...y.column_parameters}:{};let k=!1;if(t.forEach(S=>{if(!S||S.isExcluded||!S.recommendedMethod)return;const M=String(S.column??"").trim();if(!M||n.has(M))return;const $=S.recommendedMethod;Qs.includes($)&&(x.has(M)&&(x.delete(M),k=!0),b.has(M)||(b.add(M),k=!0),$===s.defaultMethod?Object.prototype.hasOwnProperty.call(N,M)&&(delete N[M],k=!0):N[M]!==$&&(N[M]=$,k=!0),Object.prototype.hasOwnProperty.call(E,M)&&(delete E[M],k=!0))}),!k)return y;const j={...y,columns:Array.from(b).sort((S,M)=>S.localeCompare(M))};return x.size?j.skipped_columns=Array.from(x).sort((S,M)=>S.localeCompare(M)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,Object.keys(N).length?j.column_methods=N:Object.prototype.hasOwnProperty.call(j,"column_methods")&&delete j.column_methods,Object.keys(E).length?j.column_parameters=E:Object.prototype.hasOwnProperty.call(j,"column_parameters")&&delete j.column_parameters,j})},[s.defaultMethod,n,t,e]),p=v.useCallback(y=>{const b=String(y??"").trim();b&&e(x=>{if(!x||typeof x!="object")return x;const N=Ze(x.columns),E=N.filter(D=>D!==b),k=new Set(Ze(x.skipped_columns)),j=k.size;k.add(b);const S=j!==k.size,M=x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)?{...x.column_methods}:{},$=Object.prototype.hasOwnProperty.call(M,b);$&&delete M[b];const T=x.column_parameters&&typeof x.column_parameters=="object"&&!Array.isArray(x.column_parameters)?{...x.column_parameters}:{},L=Object.prototype.hasOwnProperty.call(T,b);if(L&&delete T[b],!(E.length!==N.length)&&!S&&!$&&!L)return x;const O={...x,columns:E.sort((D,W)=>D.localeCompare(W)),skipped_columns:Array.from(k).sort((D,W)=>D.localeCompare(W))};return Object.keys(M).length?O.column_methods=M:Object.prototype.hasOwnProperty.call(O,"column_methods")&&delete O.column_methods,Object.keys(T).length?O.column_parameters=T:Object.prototype.hasOwnProperty.call(O,"column_parameters")&&delete O.column_parameters,O})},[e]),h=v.useCallback(y=>{const b=String(y??"").trim();b&&e(x=>{if(!x||typeof x!="object")return x;const N=Ze(x.skipped_columns);if(!N.includes(b))return x;const E=N.filter(S=>S!==b),k=new Set(Ze(x.columns));k.has(b)||k.add(b);const j={...x,columns:Array.from(k).sort((S,M)=>S.localeCompare(M))};return E.length?j.skipped_columns=E.sort((S,M)=>S.localeCompare(M)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,j})},[e]),f=v.useCallback((y,b)=>{if(b==="__skip__"){p(y);return}if(b==="__default__"){h(y),c(y,null);return}Qs.includes(b)&&(h(y),c(y,b))},[p,h,c]),g=v.useCallback((y,b,x)=>{const N=String(b??"").trim().toLowerCase();e(E=>{if(!E||typeof E!="object")return E;const k=E.method_parameters&&typeof E.method_parameters=="object"&&!Array.isArray(E.method_parameters)?{...E.method_parameters}:{},j={...k[y]??{}},S=typeof x=="number"&&Number.isFinite(x)?x:null;let M=!1;if(S===null?Object.prototype.hasOwnProperty.call(j,N)&&(delete j[N],M=!0):j[N]!==S&&(j[N]=S,M=!0),!M)return E;if(Object.keys(j).length?k[y]=j:delete k[y],!Object.keys(k).length){const $={...E};return Object.prototype.hasOwnProperty.call($,"method_parameters")&&delete $.method_parameters,$}return{...E,method_parameters:k}})},[e]),w=v.useCallback((y,b,x)=>{const N=String(y??"").trim();if(!N)return;const E=String(b??"").trim().toLowerCase();e(k=>{if(!k||typeof k!="object")return k;const j=k.column_parameters&&typeof k.column_parameters=="object"&&!Array.isArray(k.column_parameters)?{...k.column_parameters}:{},S={...j[N]??{}},M=typeof x=="number"&&Number.isFinite(x)?x:null;let $=!1;if(M===null?Object.prototype.hasOwnProperty.call(S,E)&&(delete S[E],$=!0):S[E]!==M&&(S[E]=M,$=!0),!$)return k;if(Object.keys(S).length?j[N]=S:delete j[N],!Object.keys(j).length){const T={...k};return Object.prototype.hasOwnProperty.call(T,"column_parameters")&&delete T.column_parameters,T}return{...k,column_parameters:j}})},[e]);return{handleOutlierDefaultMethodChange:l,handleOutlierAutoDetectToggle:i,setOutlierColumnMethod:c,handleOutlierClearOverrides:u,handleOutlierApplyAllRecommendations:d,handleOutlierSkipColumn:p,handleOutlierUnskipColumn:h,handleOutlierOverrideSelect:f,handleOutlierMethodParameterChange:g,handleOutlierColumnParameterChange:w}},tL=({setConfigState:e,scalingRecommendations:t})=>{const n=v.useCallback(h=>{vr.includes(h)&&e(f=>(f==null?void 0:f.default_method)===h?f:{...f,default_method:h})},[e]),s=v.useCallback(h=>{e(f=>(typeof(f==null?void 0:f.auto_detect)=="boolean"?f.auto_detect:!0)===h?f:{...f,auto_detect:h})},[e]),l=v.useCallback((h,f)=>{const g=String(h??"").trim();g&&e(w=>{const y=Ze(w.columns),b=y.includes(g),x=w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)?{...w.column_methods}:{};if(f){if(!vr.includes(f))return w;const k=(x[g]??null)!==f,j=!b;if(!k&&!j)return w;x[g]=f;const S=j?[...y,g].sort((M,$)=>M.localeCompare($)):y;return{...w,columns:S,column_methods:x}}if(!Object.prototype.hasOwnProperty.call(x,g))return w;if(delete x[g],Object.keys(x).length)return{...w,column_methods:x};const N={...w};return Object.prototype.hasOwnProperty.call(N,"column_methods")&&delete N.column_methods,N})},[e]),i=v.useCallback(()=>{e(h=>{if(!h.column_methods||typeof h.column_methods!="object"||Array.isArray(h.column_methods)||!Object.keys(h.column_methods).length)return h;const f={...h};return delete f.column_methods,f})},[e]),c=v.useCallback(()=>{t.length&&e(h=>{const f=Ze(h.columns),g=new Set(f),w=new Set(Ze(h.skipped_columns)),y=h.column_methods&&typeof h.column_methods=="object"&&!Array.isArray(h.column_methods)?{...h.column_methods}:{};let b=!1;if(t.forEach(N=>{const E=String(N.column??"").trim(),k=N.recommended_method;!E||!vr.includes(k)||w.has(E)||(y[E]!==k&&(y[E]=k,b=!0),g.has(E)||(g.add(E),b=!0))}),!b)return h;const x=Array.from(g).sort((N,E)=>N.localeCompare(E));return{...h,columns:x,column_methods:y}})},[t,e]),u=v.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const w=Ze(g.columns),y=w.filter(j=>j!==f),b=new Set(Ze(g.skipped_columns)),x=b.size;b.add(f);const N=b.size!==x,E=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{},k=Object.prototype.hasOwnProperty.call(E,f);return k&&delete E[f],!N&&y.length===w.length&&!k?g:{...g,columns:y.sort((j,S)=>j.localeCompare(S)),column_methods:E,skipped_columns:Array.from(b).sort((j,S)=>j.localeCompare(S))}})},[e]),d=v.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const w=Ze(g.skipped_columns);if(!w.includes(f))return g;const y=new Set(w);y.delete(f);const b=new Set(Ze(g.columns));return b.has(f)||b.add(f),{...g,columns:Array.from(b).sort((N,E)=>N.localeCompare(E)),skipped_columns:Array.from(y).sort((N,E)=>N.localeCompare(E))}})},[e]),p=v.useCallback((h,f)=>{if(f==="__skip__"){u(h);return}if(f==="__default__"){d(h),l(h,null);return}vr.includes(f)&&(d(h),l(h,f))},[u,d,l]);return{handleScalingDefaultMethodChange:n,handleScalingAutoDetectToggle:s,setScalingColumnMethod:l,handleScalingClearOverrides:i,handleScalingApplyAllRecommendations:c,handleScalingSkipColumn:u,handleScalingUnskipColumn:d,handleScalingOverrideSelect:p}},nL=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},sL=({isBinningNode:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:s,availableColumns:l,recommendedColumns:i})=>{const c=v.useMemo(()=>{if(!i)return null;const h=new Set;for(const f of i){const g=typeof f=="string"?f.trim():"";g&&h.add(g)}return h.size>0?h:null},[i]),u=v.useMemo(()=>{if(!Array.isArray(n)||!n.length)return null;const h=new Set;return n.forEach(f=>{const g=typeof f=="string"?f.trim():"";g&&h.add(g)}),h.size>0?h:null},[n]),d=v.useMemo(()=>{if(!e)return new Set;if(!t.size||!c&&!u)return t;const h=new Set;return t.forEach(f=>{c!=null&&c.has(f)||u!=null&&u.has(f)||h.add(f)}),h},[e,t,c,u]),p=v.useMemo(()=>{if(!e||!s.length)return{};const h={};return l.forEach(f=>{if(d.has(f))return;let g=null,w=null;const y=new Set;if(s.forEach(b=>{if(!b||!Object.prototype.hasOwnProperty.call(b,f))return;const x=nL(b[f]);x!==null&&((g===null||x<g)&&(g=x),(w===null||x>w)&&(w=x),y.size<=1e3&&y.add(x))}),g!==null||w!==null){const b=y.size>0?y.size:null;h[f]={min:g,max:w,distinct:b}}}),h},[l,d,e,s]);return{binningExcludedColumns:d,binningColumnPreviewMap:p,manualBoundColumns:[],manualRangeFallbackMap:{}}},rL=({isScalingNode:e,isBinningNode:t,isOutlierNode:n,scalingExcludedColumns:s,binningExcludedColumns:l,outlierExcludedColumns:i,setConfigState:c})=>{v.useEffect(()=>{!e||s.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ze(u.columns);if(!d.length)return u;const p=d.filter(f=>!s.has(f));if(p.length===d.length||!p.length)return u;const h={...u,columns:p};if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const f={};let g=!1;Object.entries(u.column_methods).forEach(([w,y])=>{const b=String(w??"").trim();if(!b)return;if(s.has(b)){g=!0;return}const x=typeof y=="string"?y.trim():null;x&&vr.includes(x)&&(f[b]=x)}),g?Object.keys(f).length?h.column_methods=f:h.column_methods={}:h.column_methods=u.column_methods}return h})},[e,s,c]),v.useEffect(()=>{!t||l.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ze(u.columns);if(!d.length)return u;const p=d.filter(g=>!l.has(g));if(p.length===d.length)return u;const h=new Set(d.filter(g=>l.has(g))),f={...u,columns:p};if(u.custom_bins&&typeof u.custom_bins=="object"&&!Array.isArray(u.custom_bins)){const g={};Object.entries(u.custom_bins).forEach(([w,y])=>{!h.has(w)&&Array.isArray(y)&&y.length&&(g[w]=[...y])}),Object.keys(g).length?f.custom_bins=g:Object.prototype.hasOwnProperty.call(f,"custom_bins")&&delete f.custom_bins}if(u.custom_labels&&typeof u.custom_labels=="object"&&!Array.isArray(u.custom_labels)){const g={};Object.entries(u.custom_labels).forEach(([w,y])=>{!h.has(w)&&Array.isArray(y)&&y.length&&(g[w]=y.map(b=>String(b)))}),Object.keys(g).length?f.custom_labels=g:Object.prototype.hasOwnProperty.call(f,"custom_labels")&&delete f.custom_labels}return f})},[l,t,c]),v.useEffect(()=>{!n||i.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ze(u.columns),p=d.filter(E=>!i.has(E)),h=p.length!==d.length,f=Ze(u.skipped_columns),g=f.filter(E=>!i.has(E)),w=g.length!==f.length,y=E=>E??{...u};let b=null;h&&(b=y(b),b.columns=p.sort((E,k)=>E.localeCompare(k))),w&&(b=y(b),g.length?b.skipped_columns=g.sort((E,k)=>E.localeCompare(k)):Object.prototype.hasOwnProperty.call(b,"skipped_columns")&&delete b.skipped_columns);let x=!1;if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const E={};Object.entries(u.column_methods).forEach(([k,j])=>{const S=String(k??"").trim();if(!S||i.has(S)){x=!0;return}const M=typeof j=="string"?j.trim():null;M&&Qs.includes(M)?E[S]=M:x=!0}),x&&(b=y(b),Object.keys(E).length?b.column_methods=E:Object.prototype.hasOwnProperty.call(b,"column_methods")&&delete b.column_methods)}let N=!1;if(u.column_parameters&&typeof u.column_parameters=="object"&&!Array.isArray(u.column_parameters)){const E={};Object.entries(u.column_parameters).forEach(([k,j])=>{const S=String(k??"").trim();if(!S||i.has(S)){N=!0;return}if(!j||typeof j!="object"||Array.isArray(j)){N=!0;return}E[S]={...j}}),N&&(b=y(b),Object.keys(E).length?b.column_parameters=E:Object.prototype.hasOwnProperty.call(b,"column_parameters")&&delete b.column_parameters)}return b||u})},[n,i,c])},aL=({isScalingNode:e,isOutlierNode:t,isBinningNode:n,configState:s,setConfigState:l,nodeId:i,numericExcludedColumns:c,scalingData:u,outlierData:d,binningData:p,availableColumns:h,previewSampleRows:f})=>{const{scalingConfig:g,scalingExcludedColumns:w,scalingMethodDetailMap:y,scalingMethodOptions:b,scalingRecommendations:x,scalingRecommendationRows:N,scalingSelectedCount:E,scalingOverrideCount:k,scalingDefaultDetail:j,scalingDefaultLabel:S,scalingAutoDetectEnabled:M,scalingHasRecommendations:$,scalingStatusMessage:T,scalingOverrideExampleSummary:L}=Q$({isScalingNode:e,configState:s,numericExcludedColumns:c,scalingData:u}),{outlierConfig:P,outlierExcludedColumns:O,outlierMethodLabelMap:D,outlierMethodDetailMap:W,outlierMethodOptions:z,outlierRecommendations:R,outlierRecommendationRows:U,outlierSelectedCount:V,outlierOverrideCount:B,outlierParameterOverrideCount:X,outlierDefaultDetail:H,outlierDefaultLabel:F,outlierAutoDetectEnabled:K,outlierHasRecommendations:re,outlierStatusMessage:G,outlierOverrideExampleSummary:q}=X$({isOutlierNode:t,configState:s,numericExcludedColumns:c,outlierData:d}),Y=typeof(d==null?void 0:d.sample_size)=="number"?d.sample_size:null,Q=null,ee=B>0||X>0,J=v.useMemo(()=>B>0?q:X>0?`${X} column${X===1?"":"s"} with parameter overrides`:null,[B,X,q]),{binningConfig:se,binningSelectedCount:ke,binningDefaultLabel:Pe,binningOverrideColumns:De,binningOverrideCount:Be,binningOverrideSummary:mt,fieldIds:Ge,customEdgeDrafts:ue,setCustomEdgeDrafts:ye,customLabelDrafts:Me,setCustomLabelDrafts:Le}=J$({configState:s,nodeId:i}),Ve=v.useMemo(()=>e?g.columns:n?se.columns:t?P.columns:Ze(s==null?void 0:s.columns),[se.columns,s,n,t,e,P.columns,g.columns]),ce=v.useMemo(()=>{const rn=p==null?void 0:p.columns;return Array.isArray(rn)?rn.filter(It=>!It||typeof It.column!="string"?!1:!!It.column.trim()):[]},[p==null?void 0:p.columns]),Fe=v.useMemo(()=>{if(!ce.length)return new Set;const rn=new Set;return ce.forEach(It=>{const ht=typeof It.column=="string"?It.column.trim():"";ht&&rn.add(ht)}),rn},[ce]),et=v.useMemo(()=>{if(!n)return[];const rn=new Set;return h.forEach(It=>{if(c.has(It))return;const ht=It.trim();ht&&rn.add(ht)}),ce.forEach(It=>{const ht=typeof It.column=="string"?It.column.trim():"";ht&&(!c.has(ht)||Fe.has(ht))&&rn.add(ht)}),Ve.forEach(It=>{const ht=typeof It=="string"?It.trim():"";ht&&(!c.has(ht)||Fe.has(ht))&&rn.add(ht)}),Array.from(rn).sort((It,ht)=>It.localeCompare(ht))},[h,ce,Fe,n,c,Ve]),it=v.useMemo(()=>!n||!et.length?[]:et.filter(rn=>!Ve.includes(rn)),[et,n,Ve]),at=it.length>0,{handleBinningIntegerChange:xt,handleBinningBooleanToggle:ot,handleBinningSuffixChange:$e,handleBinningLabelFormatChange:je,handleBinningMissingStrategyChange:Vt,handleBinningMissingLabelChange:tt,handleBinningCustomBinsChange:Wt,handleBinningCustomLabelsChange:ct,handleBinningClearCustomColumn:Rt,updateBinningColumnOverride:mn,handleBinningOverrideStrategyChange:$n,handleBinningOverrideNumberChange:Ft,handleBinningOverrideKbinsEncodeChange:ln,handleBinningOverrideKbinsStrategyChange:Hn,handleBinningClearOverride:Gt,handleBinningClearOverrides:_t,handleBinningApplyStrategies:es,handleBinningApplyColumns:cn,handleApplyAllBinningNumeric:En}=Z$({setConfigState:l,setBinningCustomEdgeDrafts:ye,setBinningCustomLabelDrafts:Le,binningConfig:se,binningInsightsRecommendations:ce,binningAllNumericColumns:et}),{handleOutlierDefaultMethodChange:yt,handleOutlierAutoDetectToggle:Zs,setOutlierColumnMethod:nn,handleOutlierClearOverrides:jt,handleOutlierApplyAllRecommendations:kt,handleOutlierSkipColumn:Cs,handleOutlierUnskipColumn:vn,handleOutlierOverrideSelect:Ln,handleOutlierMethodParameterChange:yn,handleOutlierColumnParameterChange:Vn}=eL({setConfigState:l,outlierRecommendationRows:U,outlierExcludedColumns:O,outlierConfig:P}),{handleScalingDefaultMethodChange:bn,handleScalingAutoDetectToggle:Ss,setScalingColumnMethod:Yt,handleScalingClearOverrides:ts,handleScalingApplyAllRecommendations:Wn,handleScalingSkipColumn:zn,handleScalingUnskipColumn:Tr,handleScalingOverrideSelect:fs}=tL({setConfigState:l,scalingRecommendations:x}),{binningExcludedColumns:er,binningColumnPreviewMap:Rs,manualBoundColumns:Fs,manualRangeFallbackMap:yr}=sL({isBinningNode:n,numericExcludedColumns:c,selectedColumns:Ve,previewSampleRows:f,availableColumns:h,recommendedColumns:Fe}),ps=v.useMemo(()=>{const rn=p==null?void 0:p.excluded_columns;return Array.isArray(rn)?rn.filter(It=>!It||typeof It.column!="string"?!1:!!It.column.trim()):[]},[p==null?void 0:p.excluded_columns]);return rL({isScalingNode:e,isBinningNode:n,isOutlierNode:t,scalingExcludedColumns:w,binningExcludedColumns:er,outlierExcludedColumns:O,setConfigState:l}),{scalingConfig:g,scalingExcludedColumns:w,scalingMethodDetailMap:y,scalingMethodOptions:b,scalingRecommendations:x,scalingRecommendationRows:N,scalingSelectedCount:E,scalingOverrideCount:k,scalingDefaultDetail:j,scalingDefaultLabel:S,scalingAutoDetectEnabled:M,scalingHasRecommendations:$,scalingStatusMessage:T,scalingOverrideExampleSummary:L,outlierConfig:P,outlierExcludedColumns:O,outlierMethodLabelMap:D,outlierMethodDetailMap:W,outlierMethodOptions:z,outlierRecommendations:R,outlierRecommendationRows:U,outlierSelectedCount:V,outlierOverrideCount:B,outlierParameterOverrideCount:X,outlierDefaultDetail:H,outlierDefaultLabel:F,outlierAutoDetectEnabled:K,outlierHasRecommendations:re,outlierStatusMessage:G,outlierOverrideExampleSummary:q,outlierSampleSize:Y,relativeOutlierGeneratedAt:Q,outlierHasOverrides:ee,outlierOverrideSummaryDisplay:J,binningConfig:se,binningSelectedCount:ke,binningDefaultLabel:Pe,binningOverrideColumns:De,binningOverrideCount:Be,binningOverrideSummary:mt,binningFieldIds:Ge,binningCustomEdgeDrafts:ue,setBinningCustomEdgeDrafts:ye,binningCustomLabelDrafts:Me,setBinningCustomLabelDrafts:Le,selectedColumns:Ve,binningInsightsRecommendations:ce,binningRecommendedColumnSet:Fe,binningAllNumericColumns:et,binningNumericColumnsNotSelected:it,canApplyAllBinningNumeric:at,binningExcludedColumns:er,binningColumnPreviewMap:Rs,manualBoundColumns:Fs,manualRangeFallbackMap:yr,handleOutlierDefaultMethodChange:yt,handleOutlierAutoDetectToggle:Zs,setOutlierColumnMethod:nn,handleOutlierClearOverrides:jt,handleOutlierApplyAllRecommendations:kt,handleOutlierSkipColumn:Cs,handleOutlierUnskipColumn:vn,handleOutlierOverrideSelect:Ln,handleOutlierMethodParameterChange:yn,handleOutlierColumnParameterChange:Vn,handleScalingDefaultMethodChange:bn,handleScalingAutoDetectToggle:Ss,setScalingColumnMethod:Yt,handleScalingClearOverrides:ts,handleScalingApplyAllRecommendations:Wn,handleScalingSkipColumn:zn,handleScalingUnskipColumn:Tr,handleScalingOverrideSelect:fs,binningInsightsExcludedColumns:ps,handleBinningIntegerChange:xt,handleBinningBooleanToggle:ot,handleBinningSuffixChange:$e,handleBinningLabelFormatChange:je,handleBinningMissingStrategyChange:Vt,handleBinningMissingLabelChange:tt,handleBinningCustomBinsChange:Wt,handleBinningCustomLabelsChange:ct,handleBinningClearCustomColumn:Rt,updateBinningColumnOverride:mn,handleBinningOverrideStrategyChange:$n,handleBinningOverrideNumberChange:Ft,handleBinningOverrideKbinsEncodeChange:ln,handleBinningOverrideKbinsStrategyChange:Hn,handleBinningClearOverride:Gt,handleBinningClearOverrides:_t,handleBinningApplyStrategies:es,handleBinningApplyColumns:cn,handleApplyAllBinningNumeric:En}},ww={enabled:!1,explicit:!1},oL={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},lL={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},iL={},cL=[],uL=({isReplaceAliasesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:l,previewSampleRows:i})=>{const c=v.useMemo(()=>{if(!e)return ww;const b=Ei(t);if(b!==void 0)return{enabled:!!fl(b),explicit:!0};if(n&&typeof n=="object"){const x=Ei(n);if(x!==void 0)return{enabled:!!fl(x),explicit:!0}}return ww},[t,e,n]),u=v.useMemo(()=>{if(!e)return[];const b=Ze((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),x=Sm(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),N=(()=>{const k=Ei(t);if(k!==void 0){const j=fl(k);if(j!==null)return j}if(n&&typeof n=="object"){const j=Ei(n);if(j!==void 0){const S=fl(j);if(S!==null)return S}}return b.length===0})(),E=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return Mx(E,{mode:x,columns:b,autoDetect:N})},[t,e,n]),d=v.useMemo(()=>e?u.length?Array.from(new Set(u.flatMap(b=>b.columns.map(x=>x.trim()).filter(Boolean)))).sort((b,x)=>b.localeCompare(x)):Ze(t==null?void 0:t.columns):[],[u,t==null?void 0:t.columns,e]),p=v.useMemo(()=>e?u.length?u.some(b=>b.autoDetect):c.explicit?c.enabled:d.length===0:!1,[c.enabled,c.explicit,d.length,u,e]),h=v.useMemo(()=>{if(e)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,e]),f=v.useMemo(()=>e?_A(i):iL,[e,i]),g=v.useMemo(()=>e?dA({selectedColumns:d,availableColumns:s,columnTypeMap:l,autoDetectEnabled:p}):oL,[p,d,s,l,e]),w=v.useMemo(()=>e?hA(h):lL,[e,h]),y=v.useMemo(()=>{if(!e)return cL;const b=new Set(g.recommendedColumns),x=new Set(g.textColumns);return s.map(N=>{const E=l[N]??null,k=f[N]??[];return{name:N,dtype:E,samples:k.slice(0,3),isRecommended:b.has(N),isTextLike:x.has(N)}})},[g.recommendedColumns,g.textColumns,f,s,l,e]);return{aliasAutoDetectMeta:c,aliasStrategies:u,aliasStrategyCount:u.length,aliasSelectedColumns:d,aliasAutoDetectEnabled:p,replaceAliasesCustomPairsValue:h,aliasColumnSummary:g,aliasCustomPairSummary:w,aliasSampleMap:f,aliasColumnOptions:y}},dL=({isTrimWhitespaceNode:e,isRemoveSpecialCharsNode:t,isRegexCleanupNode:n,isNormalizeTextCaseNode:s,configState:l,nodeConfig:i,availableColumns:c,columnTypeMap:u,previewSampleRows:d})=>{const p=v.useMemo(()=>YA(e?l==null?void 0:l.mode:void 0,e?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,e,i==null?void 0:i.mode]),h=v.useMemo(()=>e?Ze(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,e]),f=v.useMemo(()=>e?tO(d):{},[e,d]),g=v.useMemo(()=>e?XA({selectedColumns:h,availableColumns:c,columnTypeMap:u,sampleMap:f}):sO,[c,u,e,h,f]),w=v.useMemo(()=>GA(p),[p]),y=v.useMemo(()=>pO(t?l==null?void 0:l.mode:void 0,t?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,t,i==null?void 0:i.mode]),b=v.useMemo(()=>t?Ze(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,t]),x=v.useMemo(()=>t?bO(d):{},[t,d]),N=v.useMemo(()=>t?vO({selectedColumns:b,availableColumns:c,columnTypeMap:u,sampleMap:x}):wO,[c,u,t,b,x]),E=v.useMemo(()=>gO(y),[y]),k=v.useMemo(()=>YO(n?l==null?void 0:l.mode:void 0,n?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,n,i==null?void 0:i.mode]),j=v.useMemo(()=>n?Ze(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,n]),S=v.useMemo(()=>n?ZO(d):{},[n,d]),M=v.useMemo(()=>n?XO({selectedColumns:j,availableColumns:c,columnTypeMap:u,sampleMap:S}):nP,[c,u,n,j,S]),$=v.useMemo(()=>GO(k),[k]),T=v.useMemo(()=>{if(!n)return null;const z=(l==null?void 0:l.replacement)??(i==null?void 0:i.replacement)??null;return typeof z=="string"?z:null},[l==null?void 0:l.replacement,n,i==null?void 0:i.replacement]),L=v.useMemo(()=>PO(s?l==null?void 0:l.mode:void 0,s?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,s,i==null?void 0:i.mode]),P=v.useMemo(()=>s?Ze(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,s]),O=v.useMemo(()=>s?DO(d):{},[s,d]),D=v.useMemo(()=>s?LO({selectedColumns:P,availableColumns:c,columnTypeMap:u,sampleMap:O,mode:L}):FO,[c,u,s,P,L,O]),W=v.useMemo(()=>TO(L),[L]);return{trimWhitespace:{columnSummary:g,sampleMap:f,modeDetails:w},removeSpecial:{columnSummary:N,sampleMap:x,modeDetails:E,selectedMode:y},regexCleanup:{columnSummary:M,sampleMap:S,modeDetails:$,selectedMode:k,replacementValue:T},normalizeCase:{columnSummary:D,sampleMap:O,modeDetails:W,selectedMode:L}}},mL={},hL=({isReplaceInvalidValuesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:l,previewSampleRows:i})=>{const c=v.useMemo(()=>hP(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),u=v.useMemo(()=>e?Ze(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,e]),d=v.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),y=Number(w);return Number.isFinite(y)?y:null},[t==null?void 0:t.min_value,e,n==null?void 0:n.min_value]),p=v.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),y=Number(w);return Number.isFinite(y)?y:null},[t==null?void 0:t.max_value,e,n==null?void 0:n.max_value]),h=v.useMemo(()=>e?vP(i):mL,[e,i]),f=v.useMemo(()=>e?gP({selectedColumns:u,availableColumns:s,columnTypeMap:l,sampleMap:h}):SP,[s,l,e,h,u]),g=v.useMemo(()=>fP(c),[c]);return{selectedColumns:u,selectedMode:c,modeDetails:g,sampleMap:h,columnSummary:f,minValue:d,maxValue:p}},fL={},pL=({isStandardizeDatesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:l,previewSampleRows:i})=>{const c=v.useMemo(()=>Ix(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),u=v.useMemo(()=>e?Ze((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,e,n==null?void 0:n.columns]),d=v.useMemo(()=>{if(!e)return[];const y={columns:u,mode:c,autoDetect:u.length===0};return Bx((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),y)},[t==null?void 0:t.format_strategies,e,u,n==null?void 0:n.format_strategies,c]),p=v.useMemo(()=>{if(!e)return[];const y=new Set;return d.forEach(b=>{b.columns.forEach(x=>{const N=x.trim();N&&y.add(N)})}),Array.from(y).sort((b,x)=>b.localeCompare(x))},[e,d]),h=v.useMemo(()=>d.some(y=>y.autoDetect),[d]),f=v.useMemo(()=>e?RA(i):fL,[e,i]),g=v.useMemo(()=>{if(!e)return FA;const y=PA({selectedColumns:p,availableColumns:s,columnTypeMap:l,sampleMap:f});return h?{...y,autoDetectionActive:!0}:y},[s,l,h,e,f,p]),w=v.useMemo(()=>{if(!e)return[];const y=new Set(g.recommendedColumns),b=new Set(g.sampleCandidates);return s.map(x=>{const N=l[x]??null,E=f[x]??[];return{name:x,dtype:N,samples:E.slice(0,3),isRecommended:y.has(x),isSampleCandidate:b.has(x)}})},[s,g,l,e,f]);return{selectedMode:c,strategies:d,sampleMap:f,columnSummary:g,columnOptions:w}},gL=({isReplaceAliasesNode:e,isTrimWhitespaceNode:t,isRemoveSpecialCharsNode:n,isRegexCleanupNode:s,isNormalizeTextCaseNode:l,isReplaceInvalidValuesNode:i,isStandardizeDatesNode:c,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f})=>{const{aliasAutoDetectMeta:g,aliasStrategies:w,aliasStrategyCount:y,aliasSelectedColumns:b,aliasAutoDetectEnabled:x,replaceAliasesCustomPairsValue:N,aliasColumnSummary:E,aliasCustomPairSummary:k,aliasSampleMap:j,aliasColumnOptions:S}=uL({isReplaceAliasesNode:e,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{trimWhitespace:{columnSummary:M,sampleMap:$,modeDetails:T},removeSpecial:{columnSummary:L,sampleMap:P,modeDetails:O,selectedMode:D},regexCleanup:{columnSummary:W,sampleMap:z,modeDetails:R,selectedMode:U,replacementValue:V},normalizeCase:{columnSummary:B,sampleMap:X,modeDetails:H,selectedMode:F}}=dL({isTrimWhitespaceNode:t,isRemoveSpecialCharsNode:n,isRegexCleanupNode:s,isNormalizeTextCaseNode:l,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{selectedMode:K,modeDetails:re,sampleMap:G,columnSummary:q,minValue:Y,maxValue:Q}=hL({isReplaceInvalidValuesNode:i,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{selectedMode:ee,strategies:J,sampleMap:se,columnSummary:ke,columnOptions:Pe}=pL({isStandardizeDatesNode:c,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f});return{aliasAutoDetectMeta:g,aliasStrategies:w,aliasStrategyCount:y,aliasSelectedColumns:b,aliasAutoDetectEnabled:x,replaceAliasesCustomPairsValue:N,aliasColumnSummary:E,aliasCustomPairSummary:k,aliasSampleMap:j,aliasColumnOptions:S,trimWhitespaceColumnSummary:M,trimWhitespaceSampleMap:$,trimWhitespaceModeDetails:T,removeSpecialColumnSummary:L,removeSpecialSampleMap:P,removeSpecialModeDetails:O,removeSpecialMode:D,regexCleanupColumnSummary:W,regexCleanupSampleMap:z,regexCleanupModeDetails:R,regexCleanupMode:U,regexCleanupReplacementValue:V,normalizeCaseColumnSummary:B,normalizeCaseSampleMap:X,normalizeCaseModeDetails:H,normalizeCaseMode:F,replaceInvalidMode:K,replaceInvalidModeDetails:re,replaceInvalidSampleMap:G,replaceInvalidColumnSummary:q,replaceInvalidMinValue:Y,replaceInvalidMaxValue:Q,standardizeDatesMode:ee,dateStrategies:J,standardizeDatesSampleMap:se,standardizeDatesColumnSummary:ke,dateColumnOptions:Pe}},_L=({graphSnapshot:e,nodeId:t,isDataset:n})=>{const s=v.useMemo(()=>{if(!e)return null;const f=Array.isArray(e.nodes)?e.nodes:[],g=Array.isArray(e.edges)?e.edges:[];return{nodes:f,edges:g}},[e]),l=v.useMemo(()=>e&&Array.isArray(e.nodes)?e.nodes:[],[e]),i=v.useMemo(()=>e&&Array.isArray(e.edges)?e.edges:[],[e]),c=l.length,u=v.useMemo(()=>{if(!t||!i.length)return[];const f=new Set,g=[t];for(;g.length;){const y=g.pop();y&&i.forEach(b=>{const x=b&&typeof b.source=="string"?b.source.trim():"",N=b&&typeof b.target=="string"?b.target.trim():"";!x||!N||N===y&&!f.has(x)&&(f.add(x),g.push(x))})}const w=Array.from(f);return w.sort(),w},[i,t]),d=v.useMemo(()=>{var w,y,b,x,N;if(!u.length)return"";let f="",g="";for(const E of u){const k=l.find(S=>(S==null?void 0:S.id)===E);if(!k)continue;const j=String(((w=k==null?void 0:k.data)==null?void 0:w.catalogType)??"").toLowerCase().trim();if(j==="feature_target_split"){const S=(b=(y=k==null?void 0:k.data)==null?void 0:y.config)==null?void 0:b.target_column;typeof S=="string"&&S.trim()&&(f=S.trim())}else if(j==="train_test_split"){const S=(N=(x=k==null?void 0:k.data)==null?void 0:x.config)==null?void 0:N.target_column;typeof S=="string"&&S.trim()&&(g=S.trim())}}return f||g||""},[l,u]),p=v.useMemo(()=>{const f=new Set;return l.forEach(g=>{if(!g)return;const w=typeof g.id=="string"?g.id.trim():String((g==null?void 0:g.id)??"").trim();if(!w)return;const y=(g==null?void 0:g.data)??{};(w==="dataset-source"||(y==null?void 0:y.isDataset)===!0||(y==null?void 0:y.catalogType)==="dataset")&&f.add(w)}),f.size||f.add("dataset-source"),Array.from(f)},[l]),h=v.useMemo(()=>{if(!t)return!1;if(n)return!0;if(!i.length)return p.includes(t);const f=new Map;i.forEach(y=>{const b=y==null?void 0:y.source,x=y==null?void 0:y.target,N=typeof b=="string"?b.trim():String(b??"").trim(),E=typeof x=="string"?x.trim():String(x??"").trim();if(!N||!E)return;const k=f.get(N);k?k.push(E):f.set(N,[E])});const g=new Set,w=[...p];for(;w.length;){const y=w.pop();if(!y||g.has(y))continue;g.add(y);const b=f.get(y);b&&b.forEach(x=>{x&&!g.has(x)&&w.push(x)})}return g.has(t)},[p,i,n,t]);return{graphContext:s,graphNodes:l,graphEdges:i,graphNodeCount:c,upstreamNodeIds:u,upstreamTargetColumn:d,hasReachableSource:h}},pu={status:"idle",data:null,error:null},vL=1e3,yL=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:s,isPreviewNode:l,targetNodeId:i,previewSignature:c,skipPreview:u=!1,requestPreviewRows:d,includeSignals:p})=>{const[h,f]=v.useState(pu),[g,w]=v.useState(0),y=v.useRef(null),b=v.useRef(-1),x=v.useCallback(()=>{w(N=>N+1)},[]);return v.useEffect(()=>{if(!e){f(pu),y.current=null,b.current=-1;return}if(u)return;if(!t){f(l?{status:"error",data:null,error:"Select a dataset to generate previews."}:pu);return}if(!n){f(l?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:pu);return}if(!s)return;const N=(()=>{const L=Array.isArray(s.nodes)?s.nodes.map(O=>O&&typeof O.id=="string"?O.id:null).filter(O=>!!O).sort():[],P=Array.isArray(s.edges)?s.edges.map(O=>{const D=O&&typeof O.source=="string"?O.source.trim():"",W=O&&typeof O.target=="string"?O.target.trim():"";return D&&W?`${D}->${W}`:null}).filter(O=>!!O).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:i??null,nodeIds:L,edgePairs:P})})(),E=c??N,k=E!==y.current;if(!(b.current!==g)&&!k)return;y.current=E,b.current=g;let S=!0;f(L=>({status:"loading",data:L.data??null,error:null}));const M=d??l,$=p??M,T={dataset_source_id:t,graph:{nodes:s.nodes,edges:s.edges},target_node_id:i??void 0,include_preview_rows:M,include_signals:$};return M&&(T.sample_size=vL),ox(T).then(L=>{S&&f({status:"success",data:L,error:null})}).catch(L=>{S&&f(l?{status:"error",data:null,error:(L==null?void 0:L.message)??"Unable to generate preview."}:pu)}),()=>{S=!1}},[n,s,l,u,c,g,e,t,i]),{previewState:h,refreshPreview:x}},bL=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:l,nodeId:i,previewSignature:c,skipPreview:u,isPreviewNode:d,isFeatureMathNode:p,isPolynomialFeaturesNode:h,isFeatureSelectionNode:f,isTrainTestSplitNode:g,isOutlierNode:w,isTransformerAuditNode:y,cachedPreviewSchema:b,setCachedPreviewSchema:x})=>{var $;const N=v.useMemo(()=>!(!e||!t||!n),[t,e,n]),E=v.useMemo(()=>!e||!s||!n?!1:t>0,[t,e,n,s]),k=v.useMemo(()=>d||p||h||f||g||w||y,[p,f,w,h,d,g,y]),{previewState:j,refreshPreview:S}=yL({shouldFetchPreview:N,sourceId:s,canTriggerPreview:E,graphSnapshot:e,isPreviewNode:d,targetNodeId:(l==null?void 0:l.id)??null,previewSignature:c,skipPreview:u,requestPreviewRows:d,includeSignals:k});v.useEffect(()=>{var L;const T=((L=j.data)==null?void 0:L.schema)??null;T&&x(P=>P!=null&&P.signature&&T.signature&&P.signature===T.signature?P:T)},[($=j.data)==null?void 0:$.schema]),v.useEffect(()=>{x(null)},[s]),v.useEffect(()=>{x(null)},[c]);const M=v.useCallback(()=>{x(null)},[]);return{previewState:j,refreshPreview:S,cachedPreviewSchema:b,clearCachedPreviewSchema:M,canTriggerPreview:E}},xL=(e,t,n,s,l)=>{e([]),t({}),n({}),s({}),l("")},wL=({requiresColumnCatalog:e,isImputerNode:t,nodeId:n,sourceId:s,hasReachableSource:l})=>{const[i,c]=v.useState([]),[u,d]=v.useState(""),[p,h]=v.useState({}),[f,g]=v.useState({}),[w,y]=v.useState({}),[b,x]=v.useState(0);return v.useEffect(()=>{!e&&!t||s&&l||xL(c,h,g,y,d)},[l,t,e,s]),v.useEffect(()=>{x(0)},[t,n]),{availableColumns:i,setAvailableColumns:c,columnSearch:u,setColumnSearch:d,columnMissingMap:p,setColumnMissingMap:h,columnTypeMap:f,setColumnTypeMap:g,columnSuggestions:w,setColumnSuggestions:y,imputerMissingFilter:b,setImputerMissingFilter:x}},jL=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:l})=>{var i;v.useEffect(()=>{var h;const c=Array.isArray((h=e.data)==null?void 0:h.column_stats)?e.data.column_stats:[],u=e.status;if(!c.length){if(u==="loading")return;s(f=>Object.keys(f).length?{}:f),l(f=>Object.keys(f).length?{}:f);return}const d={},p={};c.forEach(f=>{if(!f||!f.name)return;const g=String(f.name).trim();if(!g||n&&g.endsWith(n))return;const w=typeof f.dtype=="string"?f.dtype:null;w&&(d[g]=w);const y=t.map(x=>x&&Object.prototype.hasOwnProperty.call(x,g)?x[g]:void 0),b=QT(w,y);b.length&&(p[g]=b)}),s(f=>{const g=Object.entries(f),w=Object.entries(d);return g.length===w.length&&g.every(([y,b])=>Object.prototype.hasOwnProperty.call(d,y)&&d[y]===b)?f:d}),l(f=>{const g=Object.keys(f),w=Object.keys(p);return g.length===w.length&&g.every(y=>{if(!Object.prototype.hasOwnProperty.call(p,y))return!1;const b=f[y]??[],x=p[y]??[];return H0(b,x)})?f:p})},[n,t,(i=e.data)==null?void 0:i.column_stats,e.status,l,s])},NL=({previewState:e,activeFlagSuffix:t,hasReachableSource:n,requiresColumnCatalog:s,nodeColumns:l,selectedColumns:i,setAvailableColumns:c,setColumnMissingMap:u})=>{var d,p;v.useEffect(()=>{var b,x;if(!s||!n)return;const h=new Set;(Array.isArray((b=e.data)==null?void 0:b.columns)?e.data.columns:[]).forEach(N=>{const E=typeof N=="string"?N.trim():"";E&&(t&&E.endsWith(t)||h.add(E))});const g=Array.isArray((x=e.data)==null?void 0:x.column_stats)?e.data.column_stats:[],w={};if(g.forEach(N=>{if(!N||!N.name)return;const E=String(N.name).trim();if(!E||t&&E.endsWith(t))return;h.add(E);const k=Number(N.missing_percentage);!Number.isNaN(k)&&k>=0&&(w[E]=k)}),Ze(l).forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),i.forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),h.size===0)return;const y=Array.from(h).sort((N,E)=>N.localeCompare(E));c(N=>H0(N,y)?N:y),Object.keys(w).length>0&&u(N=>({...N,...w}))},[t,n,l,(d=e.data)==null?void 0:d.column_stats,(p=e.data)==null?void 0:p.columns,s,i,c,u])},CL=({previewState:e,nodeId:t,isFeatureMathNode:n,isPolynomialFeaturesNode:s,isFeatureSelectionNode:l})=>{var d,p,h,f,g,w;const i=v.useMemo(()=>{var b,x;if(!n)return[];const y=(x=(b=e.data)==null?void 0:b.signals)==null?void 0:x.feature_math;return Array.isArray(y)?y:[]},[n,(p=(d=e.data)==null?void 0:d.signals)==null?void 0:p.feature_math]),c=v.useMemo(()=>{var x,N;if(!s)return null;const y=(N=(x=e.data)==null?void 0:x.signals)==null?void 0:N.polynomial_features;return!Array.isArray(y)||y.length===0?null:(t?y.find(E=>E&&typeof E.node_id=="string"&&E.node_id===t):null)??y[0]??null},[s,t,(f=(h=e.data)==null?void 0:h.signals)==null?void 0:f.polynomial_features]),u=v.useMemo(()=>{var x,N;if(!l)return null;const y=(N=(x=e.data)==null?void 0:x.signals)==null?void 0:N.feature_selection;return!Array.isArray(y)||y.length===0?null:(t?y.find(E=>E&&typeof E.node_id=="string"&&E.node_id===t):null)??y[0]??null},[l,t,(w=(g=e.data)==null?void 0:g.signals)==null?void 0:w.feature_selection]);return{featureMathSignals:i,polynomialSignal:c,featureSelectionSignal:u}},SL=({isFeatureSelectionNode:e,featureSelectionSignal:t,upstreamTargetColumn:n,setConfigState:s})=>{v.useEffect(()=>{if(!e)return;const l=typeof(t==null?void 0:t.target_column)=="string"?t.target_column.trim():"",i=typeof n=="string"?n.trim():"",c=l||i;c&&s(u=>(typeof(u==null?void 0:u.target_column)=="string"?u.target_column.trim():"")?u:{...u,target_column:c})},[t==null?void 0:t.target_column,e,s,n]),v.useEffect(()=>{if(!e)return;const l=typeof(t==null?void 0:t.k)=="number"&&Number.isFinite(t.k)?Math.max(0,Math.trunc(t.k)):null,i=Array.isArray(t==null?void 0:t.selected_columns)?t.selected_columns.length:null,c=l??i??null;c===null||c<=0||s(u=>{const d=u==null?void 0:u.k;let p=null;if(typeof d=="number"&&Number.isFinite(d))p=Math.trunc(d);else if(typeof d=="string"){const h=Number(d);Number.isFinite(h)&&(p=Math.trunc(h))}return p!==null&&p<=c?u:{...u,k:c}})},[t==null?void 0:t.k,t==null?void 0:t.selected_columns,e,s])},Hm=e=>String(e??"").trim(),EL=({isBinningNode:e,isScalingNode:t,setConfigState:n,binningExcludedColumns:s,scalingExcludedColumns:l,availableColumns:i,recommendations:c})=>{const u=v.useCallback((y,b,x)=>{const N=Hm(y);N&&n(E=>{const k=E.manual_bounds&&typeof E.manual_bounds=="object"&&!Array.isArray(E.manual_bounds)?{...E.manual_bounds}:{},j=k[N]&&typeof k[N]=="object"?{...k[N]}:{lower:null,upper:null};if(x==="")b==="lower"?j.lower=null:j.upper=null;else{const $=Number(x);if(!Number.isFinite($))return E;b==="lower"?j.lower=$:j.upper=$}const S=j.lower??null,M=j.upper??null;return S===null&&M===null?delete k[N]:k[N]={lower:S,upper:M},{...E,manual_bounds:k}})},[n]),d=v.useCallback(y=>{const b=Hm(y);b&&n(x=>{const N=x.manual_bounds&&typeof x.manual_bounds=="object"&&!Array.isArray(x.manual_bounds)?x.manual_bounds:null;if(!N||!Object.prototype.hasOwnProperty.call(N,b))return x;const E={...N};return delete E[b],{...x,manual_bounds:E}})},[n]),p=v.useCallback(y=>{const b=Hm(y);b&&n(x=>{const N=Ze(x.columns),E=N.includes(b),k=E?N.filter($=>$!==b):[...N,b];let j=!1,S=x.manual_bounds;E&&S&&typeof S=="object"&&!Array.isArray(S)&&Object.prototype.hasOwnProperty.call(S,b)&&(S={...S},delete S[b],j=!0);const M={...x,columns:k};if(j&&(M.manual_bounds=S),e){const $=new Set(k);if(x.custom_bins&&typeof x.custom_bins=="object"&&!Array.isArray(x.custom_bins)){const T={};Object.entries(x.custom_bins).forEach(([L,P])=>{$.has(L)&&Array.isArray(P)&&P.length&&(T[L]=[...P])}),Object.keys(T).length?M.custom_bins=T:"custom_bins"in M&&delete M.custom_bins}else"custom_bins"in M&&delete M.custom_bins;if(x.custom_labels&&typeof x.custom_labels=="object"&&!Array.isArray(x.custom_labels)){const T={};Object.entries(x.custom_labels).forEach(([L,P])=>{$.has(L)&&Array.isArray(P)&&P.length&&(T[L]=P.map(O=>String(O)))}),Object.keys(T).length?M.custom_labels=T:"custom_labels"in M&&delete M.custom_labels}else"custom_labels"in M&&delete M.custom_labels;if(x.column_overrides&&typeof x.column_overrides=="object"&&!Array.isArray(x.column_overrides)){const T={};Object.entries(x.column_overrides).forEach(([L,P])=>{$.has(L)&&P&&typeof P=="object"&&!Array.isArray(P)&&(T[L]={...P})}),Object.keys(T).length?(M.column_overrides=T,M.column_strategies=T):("column_overrides"in M&&delete M.column_overrides,"column_strategies"in M&&delete M.column_strategies)}else"column_overrides"in M&&delete M.column_overrides,"column_strategies"in M&&delete M.column_strategies}if(t){let $=null;x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)&&($={},Object.entries(x.column_methods).forEach(([T,L])=>{const P=typeof L=="string"?L.trim():null;!P||!vr.includes(P)||E&&T===b||($[T]=P)})),$&&Object.keys($).length?M.column_methods=$:E&&Object.prototype.hasOwnProperty.call(M,"column_methods")&&delete M.column_methods}return M})},[e,t,n]),h=v.useCallback(()=>{c.length&&n(y=>{const b=new Set(Ze(y.columns));return c.forEach(x=>{x!=null&&x.name&&b.add(String(x.name))}),{...y,columns:Array.from(b)}})},[c,n]),f=v.useCallback(()=>{i.length&&n(y=>{const b=new Set(Ze(y.columns));return i.filter(N=>e?!s.has(N):t?!l.has(N):!0).forEach(N=>b.add(N)),{...y,columns:Array.from(b).sort((N,E)=>N.localeCompare(E))}})},[i,s,e,t,l,n]),g=v.useCallback(()=>{n(y=>{const b={...y,columns:[]};return y!=null&&y.manual_bounds&&typeof y.manual_bounds=="object"&&!Array.isArray(y.manual_bounds)&&Object.keys(y.manual_bounds).length&&(b.manual_bounds={}),e&&("custom_bins"in b&&delete b.custom_bins,"custom_labels"in b&&delete b.custom_labels,"column_overrides"in b&&delete b.column_overrides,"column_strategies"in b&&delete b.column_strategies),t&&"column_methods"in b&&delete b.column_methods,b})},[e,t,n]),w=v.useCallback(y=>{const b=Hm(y);b&&n(x=>{const N=Ze(x.columns);if(!N.includes(b))return x;const E=N.filter(M=>M!==b);let k=!1,j=x.manual_bounds;j&&typeof j=="object"&&!Array.isArray(j)&&Object.prototype.hasOwnProperty.call(j,b)&&(j={...j},delete j[b],k=!0);const S={...x,columns:E};if(k&&(S.manual_bounds=j),e){if(x.custom_bins&&typeof x.custom_bins=="object"&&!Array.isArray(x.custom_bins)){const M={};Object.entries(x.custom_bins).forEach(([$,T])=>{$!==b&&Array.isArray(T)&&T.length&&(M[$]=[...T])}),Object.keys(M).length?S.custom_bins=M:"custom_bins"in S&&delete S.custom_bins}else"custom_bins"in S&&delete S.custom_bins;if(x.custom_labels&&typeof x.custom_labels=="object"&&!Array.isArray(x.custom_labels)){const M={};Object.entries(x.custom_labels).forEach(([$,T])=>{$!==b&&Array.isArray(T)&&T.length&&(M[$]=T.map(L=>String(L)))}),Object.keys(M).length?S.custom_labels=M:"custom_labels"in S&&delete S.custom_labels}else"custom_labels"in S&&delete S.custom_labels;if(x.column_overrides&&typeof x.column_overrides=="object"&&!Array.isArray(x.column_overrides)){const M={};Object.entries(x.column_overrides).forEach(([$,T])=>{$!==b&&T&&typeof T=="object"&&!Array.isArray(T)&&(M[$]={...T})}),Object.keys(M).length?(S.column_overrides=M,S.column_strategies=M):("column_overrides"in S&&delete S.column_overrides,"column_strategies"in S&&delete S.column_strategies)}else"column_overrides"in S&&delete S.column_overrides,"column_strategies"in S&&delete S.column_strategies}if(t)if(x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)){const M={};Object.entries(x.column_methods).forEach(([$,T])=>{const L=typeof T=="string"?T.trim():null;!L||!vr.includes(L)||$!==b&&(M[$]=L)}),Object.keys(M).length?S.column_methods=M:Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods}else Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods;return S})},[e,t,n]);return{handleManualBoundChange:u,handleClearManualBound:d,handleToggleColumn:p,handleApplyAllRecommended:h,handleSelectAllColumns:f,handleClearColumns:g,handleRemoveColumn:w}},kL=({configState:e,isBinningNode:t,isScalingNode:n,nodeId:s,onUpdateConfig:l,onClose:i,sourceId:c,graphSnapshot:u,isInspectionNode:d,onUpdateNodeData:p,setConfigState:h,canResetNode:f,defaultConfigTemplate:g,onResetConfig:w})=>{const y=v.useCallback(x=>{if(!s)return;let N=gg(e);if(t){const E=vx(N);N={...N,strategy:E.strategy,columns:E.columns,equal_width_bins:E.equalWidthBins,equal_frequency_bins:E.equalFrequencyBins,include_lowest:E.includeLowest,precision:E.precision,duplicates:E.duplicates,output_suffix:E.outputSuffix,drop_original:E.dropOriginal,label_format:E.labelFormat,missing_strategy:E.missingStrategy},E.missingStrategy==="label"?N.missing_label=E.missingLabel:Object.prototype.hasOwnProperty.call(N,"missing_label")&&delete N.missing_label,Object.keys(E.customBins).length?N.custom_bins=E.customBins:Object.prototype.hasOwnProperty.call(N,"custom_bins")&&delete N.custom_bins,Object.keys(E.customLabels).length?N.custom_labels=E.customLabels:Object.prototype.hasOwnProperty.call(N,"custom_labels")&&delete N.custom_labels}if(n){const E=xw(N);N={...N,columns:E.columns,default_method:E.defaultMethod,auto_detect:E.autoDetect,skipped_columns:E.skippedColumns},Object.keys(E.columnMethods).length>0?N.column_methods=E.columnMethods:Object.prototype.hasOwnProperty.call(N,"column_methods")&&delete N.column_methods}l(s,N),(x==null?void 0:x.closeModal)!==!1&&i(),c&&u&&!d&&(p==null||p(s,{backgroundExecutionStatus:"loading"}),lx({dataset_source_id:c,graph:{nodes:u.nodes||[],edges:u.edges||[]},target_node_id:s}).then(()=>{p==null||p(s,{backgroundExecutionStatus:"success"})}).catch(E=>{p==null||p(s,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",E)}))},[e,u,t,d,n,s,i,l,p,c]),b=v.useCallback(()=>{if(!f||!s)return;const x=gg(g??{});h(x),w==null||w(s,x)},[f,g,s,w,h]);return{handleSave:y,handleResetNode:b}},ML=e=>v.useMemo(()=>{const t=new Map;return e.forEach(n=>{n!=null&&n.name&&t.set(n.name,n)}),n=>t.get(n)??null},[e]),AL=e=>{const t=v.useMemo(()=>{var u;const c=(u=e==null?void 0:e.data)==null?void 0:u.parameters;return Array.isArray(c)?c.filter(d=>!!(d!=null&&d.name)).map(d=>({...d})):[]},[e]),n=ML(t),s=v.useCallback((c,u)=>c?n(u):null,[n]),l=v.useMemo(()=>t.some(c=>{var u;return(c==null?void 0:c.type)==="multi_select"&&((u=c==null?void 0:c.source)==null?void 0:u.type)!=="drop_column_recommendations"}),[t]),i=v.useMemo(()=>t.find(c=>{var u;return((u=c==null?void 0:c.source)==null?void 0:u.type)==="drop_column_recommendations"})??null,[t]);return{parameters:t,getParameter:n,getParameterIf:s,requiresColumnCatalog:l,dropColumnParameter:i}},OL=({isResetAvailable:e=!1,isDataset:t,defaultConfigTemplate:n,footerResetFlags:s,isScalingNode:l,isBinningNode:i,isBinnedDistributionNode:c,isSkewnessDistributionNode:u})=>{const d=v.useMemo(()=>!!(e&&!t&&n),[n,t,e]),p=s.some(Boolean),h=c||u;return{canResetNode:d,headerCanResetNode:d&&!(h||l||i||p),footerCanResetNode:d&&!h}},PL=({cachedPreviewSchema:e,isClassOversamplingNode:t,resamplingTargetColumn:n,isImputerNode:s,imputerStrategies:l})=>{const i=v.useMemo(()=>(e==null?void 0:e.columns)??[],[e]),c=v.useMemo(()=>{if(!t||!i.length||!n)return null;const p=new Set(["numeric","integer","boolean"]),h=i.filter(f=>f&&f.name!==n).filter(f=>!p.has(String(f.logical_family??"unknown"))).map(f=>({name:f.name,logical_family:String(f.logical_family??"unknown")}));return h.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:h.map(f=>f.name),details:h}:null},[i,t,n]),u=v.useMemo(()=>{if(!s||!i.length||!l.length)return null;const p=new Set(["numeric","integer"]),h=new Map(i.map(g=>[g.name,g])),f=[];return l.forEach((g,w)=>{if(!bx(g.method)||!Array.isArray(g.columns)||!g.columns.length)return;const y=g.columns.map(b=>h.get(b)).filter(b=>!!b).filter(b=>!p.has(String(b.logical_family??"unknown"))).map(b=>({name:b.name,logical_family:String(b.logical_family??"unknown")}));y.length&&f.push({index:w,columns:y.map(b=>b.name),details:y})}),f.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:f}:null},[i,l,s]),d=!!(c!=null&&c.blocked||u!=null&&u.blocked);return{cachedSchemaColumns:i,oversamplingSchemaGuard:c,imputationSchemaDiagnostics:u,skipPreview:d}},TL=e=>{var l,i,c;const t=v.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.columns;return Array.isArray(u)?u.filter(p=>typeof p=="string"):[]},[(l=e.data)==null?void 0:l.columns]),n=v.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.column_stats;return Array.isArray(u)?u:[]},[(i=e.data)==null?void 0:i.column_stats]),s=v.useMemo(()=>{var u;return Array.isArray((u=e.data)==null?void 0:u.sample_rows)?e.data.sample_rows:[]},[(c=e.data)==null?void 0:c.sample_rows]);return{previewColumns:t,previewColumnStats:n,previewSampleRows:s}},$L=({isProfileLoading:e,isPreviewLoading:t,isFetchingScaling:n,isFetchingBinning:s,isFetchingHashEncoding:l,isFetchingBinnedDistribution:i,isFetchingRecommendations:c,isPreviewNode:u})=>{const d=v.useMemo(()=>e||t||n||s||l||i||c,[i,s,l,n,c,t,e]),p=v.useMemo(()=>e?"Generating dataset profile":n?"Loading scaling insights":s?"Loading binning insights":l?"Loading hash encoding insights":i?"Computing binned distributions":c?"Fetching column recommendations":t?u?"Loading dataset preview":"Analyzing node outputs":null,[i,s,l,c,n,t,u,e]);return{hasActiveAsyncWork:d,busyLabel:p,footerBusyLabel:p??(d?"Processing":null)}},Fg=e=>{const t=Number(e);return Number.isFinite(t)?Math.max(0,Math.round(t)):null},LL=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s})=>{const l=v.useMemo(()=>hs(e??null),[e]),i=v.useMemo(()=>hs((t==null?void 0:t.generated_at)??null),[t==null?void 0:t.generated_at]),c=v.useMemo(()=>hs((n==null?void 0:n.generated_at)??null),[n==null?void 0:n.generated_at]),u=v.useMemo(()=>hs((s==null?void 0:s.generated_at)??null),[s==null?void 0:s.generated_at]),d=v.useMemo(()=>Fg((t==null?void 0:t.sample_size)??null),[t==null?void 0:t.sample_size]),p=v.useMemo(()=>Fg((n==null?void 0:n.sample_size)??null),[n==null?void 0:n.sample_size]),h=v.useMemo(()=>Fg((s==null?void 0:s.sample_size)??null),[s==null?void 0:s.sample_size]);return{relativeGeneratedAt:l,relativeScalingGeneratedAt:i,relativeBinningGeneratedAt:c,relativeBinnedGeneratedAt:u,scalingSampleSize:d,binningSampleSize:p,binnedSampleSize:h}},zL=({suggestedThreshold:e,thresholdParameterName:t,configState:n,handleParameterChange:s})=>{const l=v.useMemo(()=>{if(e===null||Number.isNaN(Number(e)))return null;const d=Number(e);return Math.round(d*10)/10},[e]),i=v.useMemo(()=>{if(t===null||l===null)return!1;const d=Number(n==null?void 0:n[t]);return!Number.isNaN(d)&&d===l},[n,l,t]),c=l!==null&&!i,u=v.useCallback(()=>{l===null||!t||s(t,l)},[s,l,t]);return{normalizedSuggestedThreshold:l,thresholdMatchesSuggestion:i,canApplySuggestedThreshold:c,handleApplySuggestedThreshold:u}},DL=({node:e,graphContext:t,hasReachableSource:n,sourceId:s,formatRelativeTime:l})=>{var h,f;const i=v.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="data_preview"},[(h=e==null?void 0:e.data)==null?void 0:h.catalogType]),c=v.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="dataset_profile"},[(f=e==null?void 0:e.data)==null?void 0:f.catalogType]),u=v.useMemo(()=>t?cu(t):"",[t]),d=oM({node:e,isDatasetProfileNode:c,sourceId:s,hasReachableSource:n,graphContext:t,profilingGraphSignature:u,formatRelativeTime:l}),{profileState:p}=d;return{isPreviewNode:i,isDatasetProfileNode:c,datasetProfileController:d,profileState:p}},RL=({parameter:e,nodeId:t,configState:n,handleNumberChange:s,handleBooleanChange:l,handleTextChange:i,thresholdParameterName:c,normalizedSuggestedThreshold:u,showRecommendations:d,canApplySuggestedThreshold:p,thresholdMatchesSuggestion:h,handleApplySuggestedThreshold:f,renderMultiSelect:g})=>{var b;if(!(e!=null&&e.name))return null;if(e.type==="multi_select")return a.jsx(a.Fragment,{children:g(e)});if(e.type==="number"){const x=`node-${t}-${e.name}`,N=n==null?void 0:n[e.name],E=typeof N=="number"?N:N??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx("input",{id:x,type:"number",className:"canvas-modal__input",value:E,min:e.min!==void 0?e.min:void 0,max:e.max!==void 0?e.max:void 0,step:e.step!==void 0?e.step:"any",onChange:k=>s(e.name,k.target.value)}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),c===e.name&&u!==null&&d&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:ms(u)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:!p,children:h?"Applied":"Apply suggestion"})]})]},e.name)}if(e.type==="boolean"){const x=`node-${t}-${e.name}`,N=!!(n!=null&&n[e.name]);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:x,children:e.label})}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:x,type:"checkbox",checked:N,onChange:E=>l(e.name,E.target.checked)}),a.jsx("span",{children:N?"Enabled":"Disabled"})]})]},e.name)}if(e.type==="select"){const x=`node-${t}-${e.name}`,N=Array.isArray(e.options)?e.options:[],E=n==null?void 0:n[e.name],k=typeof e.default=="string"?e.default:((b=N.find(S=>S&&typeof S.value=="string"))==null?void 0:b.value)??"",j=typeof E=="string"&&E.trim().length?E:k;return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("select",{id:x,className:"canvas-modal__input",value:j,onChange:S=>i(e.name,S.target.value),children:N.map(S=>a.jsx("option",{value:S.value,title:S.description??void 0,children:S.label??S.value},S.value))})]},e.name)}if(e.type==="textarea"){const x=`node-${t}-${e.name}`;if(e.name==="hyperparameters"){let E="",k=n==null?void 0:n[e.name];if(typeof k=="string"&&k.trim())try{const j=JSON.parse(k);j&&typeof j=="object"&&!Array.isArray(j)?E=Object.entries(j).map(([S,M])=>`${S}: ${JSON.stringify(M)}`).join(`
`):E=k}catch{E=k}else k&&typeof k=="object"&&!Array.isArray(k)&&(E=Object.entries(k).map(([j,S])=>`${j}: ${JSON.stringify(S)}`).join(`
`));return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description||"Enter parameters as key: value pairs (one per line)"}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:E,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:j=>{const M=j.target.value.split(`
`).filter(T=>T.trim()),$={};for(const T of M){const L=T.indexOf(":");if(L===-1)continue;const P=T.substring(0,L).trim(),O=T.substring(L+1).trim();if(P)try{$[P]=JSON.parse(O)}catch{$[P]=O}}i(e.name,JSON.stringify($,null,2))},rows:6})]},e.name)}const N=typeof(n==null?void 0:n[e.name])=="string"?n==null?void 0:n[e.name]:"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:N,placeholder:e.placeholder??"",onChange:E=>i(e.name,E.target.value),rows:4})]},e.name)}const w=`node-${t}-${e.name}`,y=(n==null?void 0:n[e.name])??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:w,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("input",{id:w,type:"text",className:"canvas-modal__input canvas-modal__input--wide",value:y,placeholder:e.placeholder??"",onChange:x=>i(e.name,x.target.value)})]},e.name)},FL=({parameter:e,previewStateStatus:t,isBinningNode:n,isScalingNode:s,binningAllNumericColumns:l,binningRecommendedColumnSet:i,selectedColumns:c,availableColumns:u,scalingExcludedColumns:d,normalizedColumnSearch:p,filteredColumnOptions:h,binningExcludedColumns:f,selectionCount:g,isCastNode:w,columnSuggestions:y,sourceId:b,isFetchingRecommendations:x,hasReachableSource:N,refreshRecommendations:E,availableFilters:k,activeFilterId:j,setActiveFilterId:S,recommendations:M,filteredRecommendations:$,recommendationsError:T,relativeGeneratedAt:L,formatSignalName:P,handleToggleColumn:O,handleRemoveColumn:D,handleApplyAllRecommended:W,handleBinningApplyColumns:z,handleSelectAllColumns:R,handleClearColumns:U,columnSearch:V,setColumnSearch:B,columnMissingMap:X,columnTypeMap:H,binningColumnPreviewMap:F,isImputerNode:K,showRecommendations:re})=>{var Ve;const G=((Ve=e==null?void 0:e.source)==null?void 0:Ve.type)==="drop_column_recommendations",q=!G,Y=q&&t==="loading",Q=n&&e.name==="columns",ee=s&&e.name==="columns",J=(()=>{if(!Q)return[];const ce=[...l];return i.size>0&&i.forEach(Fe=>{ce.includes(Fe)||ce.push(Fe)}),c.forEach(Fe=>{Fe&&!ce.includes(Fe)&&ce.push(Fe)}),ce})(),se=Q?J:ee?u.filter(ce=>!d.has(ce)):u,ke=Q?p?J.filter(ce=>ce.toLowerCase().includes(p)):J:ee?h.filter(ce=>!d.has(ce)):h,Pe=Q?c.filter(ce=>!f.has(ce)).length:ee?c.filter(ce=>!d.has(ce)).length:g,De=q&&se.length>0&&Pe>=se.length,Be=G||K,mt=new Set(se),Ge=w&&q?Object.entries(y).filter(([ce,Fe])=>mt.has(ce)&&Fe.length>0).map(([ce,Fe])=>`${ce}: ${Fe.join(", ")}`).slice(0,4):[],ue=Q?Array.from(f).slice(0,4):[],ye=ee?Array.from(d).slice(0,4):[],Me=Q&&i.size>0,Le=Me?Array.from(i).some(ce=>!c.includes(ce)):!1;return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),G&&b&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:E,disabled:x||!N,children:x?"Refreshing":"Refresh suggestions"})})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),Ge.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",Ge.join("; ")]}),Q&&f.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",f.size," non-numeric column",f.size===1?"":"s",ue.length?` (examples: ${ue.join(", ")}${f.size>ue.length?", ":""})`:""," binning only supports numeric inputs."]}),ee&&d.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",d.size," non-numeric column",d.size===1?"":"s",ye.length?` (examples: ${ye.join(", ")}${d.size>ye.length?", ":""})`:""," scaling only supports numeric inputs."]}),G&&a.jsx(Hk,{sourceId:b,availableFilters:k,activeFilterId:j,setActiveFilterId:S,recommendations:M,filteredRecommendations:$,isFetchingRecommendations:x,recommendationsError:T,relativeGeneratedAt:L,formatSignalName:P,formatMissingPercentage:ms,getPriorityClass:dM,getPriorityLabel:mM,handleToggleColumn:O,selectedColumns:c}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:Pe})]}),Pe>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:c.map(ce=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[ce,a.jsx("button",{type:"button",onClick:()=>D(ce),"aria-label":`Remove ${ce}`,children:""})]},ce))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[G&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:W,disabled:!M.length,children:"Use all recommendations"}),Me&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>z(i),disabled:!Le,children:"Add recommended columns"}),q&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:R,disabled:!se.length||De,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:U,disabled:!g,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:V,onChange:ce=>B(ce.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:ke.length?ke.map(ce=>{const Fe=c.includes(ce),et=Object.prototype.hasOwnProperty.call(X,ce)?X[ce]:void 0,it=ms(typeof et=="number"?et:null),at=H[ce]??null,xt=y[ce]??[],ot=Q?F[ce]:void 0,$e=!!(ot&&(ot.min!==null&&ot.min!==void 0||ot.max!==null&&ot.max!==void 0)),je=Q?(ot==null?void 0:ot.distinct)??null:null,Vt=Q&&je!==null&&Number.isFinite(je),tt=Vt?je:null,Wt=!Q,ct=Wt||Be||$e||Vt,Rt=Wt&&xt.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${Fe?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:Fe,onChange:()=>O(ce)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:ce}),ct&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Wt&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",AT(at)]}),Be&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",it]}),$e&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[Q?"Sample range":"Range",":"," ",ot&&ot.min!==null&&ot.min!==void 0?Gs(ot.min):""," ",""," ",ot&&ot.max!==null&&ot.max!==void 0?Gs(ot.max):""]}),Vt&&tt!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",gr(tt)]})]}),Rt&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",xt.join(", ")]})]})]},ce)}):a.jsx("p",{className:"canvas-modal__note",children:u.length?Q&&se.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":Y?"Loading column catalog":b?N?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},e.name)},IL=({setConfigState:e,imputationMethodValues:t,imputationMethodOptions:n,imputerStrategyCount:s,setCollapsedStrategies:l,setImputerMissingFilter:i})=>{const c=v.useCallback(b=>{e(x=>{const N=wx(x==null?void 0:x.strategies,t),E=b(N).map(k=>({...k,options:eu(k.method,k.options)}));return{...x,strategies:DM(E)}})},[t,e]),u=v.useCallback(()=>{var N;const b=s,x=((N=n[0])==null?void 0:N.value)??"mean";c(E=>[...E,{method:x,columns:[],options:eu(x,xx(x))}]),l(E=>{const k=new Set(E);return k.delete(b),k})},[n,s,c,l]),d=v.useCallback(b=>{c(x=>x.filter((N,E)=>E!==b)),l(x=>{const N=new Set;return x.forEach(E=>{E!==b&&N.add(E>b?E-1:E)}),N})},[c,l]),p=v.useCallback(b=>{l(x=>{const N=new Set(x);return N.has(b)?N.delete(b):N.add(b),N})},[l]),h=v.useCallback((b,x)=>{c(N=>N.map((E,k)=>k===b?{...E,method:x,options:eu(x,E.options)}:E))},[c]),f=v.useCallback((b,x,N)=>{c(E=>E.map((k,j)=>{if(j!==b)return k;const S={...k.options??{}};if(N==="")delete S[x];else{const M=Number(N);if(!Number.isFinite(M))return k;S[x]=M}return{...k,options:eu(k.method,S)}}))},[c]),g=v.useCallback((b,x)=>{const N=x.split(",").map(E=>E.trim()).filter(Boolean);c(E=>E.map((k,j)=>j===b?{...k,columns:N}:k))},[c]),w=v.useCallback((b,x)=>{const N=x.trim();N&&c(E=>E.map((k,j)=>{if(j!==b)return k;const M=k.columns.includes(N)?k.columns.filter($=>$!==N):[...k.columns,N];return M.sort(($,T)=>$.localeCompare(T)),{...k,columns:M}}))},[c]),y=v.useCallback(b=>{i(b)},[i]);return{updateImputerStrategies:c,handleAddImputerStrategy:u,handleRemoveImputerStrategy:d,toggleImputerStrategySection:p,handleImputerMethodChange:h,handleImputerOptionNumberChange:f,handleImputerColumnsChange:g,handleImputerColumnToggle:w,handleImputerMissingFilterChange:y}},BL=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:s,sourceId:l,graphSnapshot:i,onResetConfig:c,defaultConfigTemplate:u,isResetAvailable:d=!1})=>{var Hs,Mt,Mn,fn,Bn,Ts,so,Nn,Go,Na,oi,Ec,Qo,ws,kc,ro;const{metadata:p,title:h}=h$(e),{connectionInfo:f,connectedHandleKeys:g,connectedOutputHandleKeys:w,evaluationSplitConnectivity:y,connectionReady:b,gatedSectionStyle:x,gatedAriaDisabled:N}=p$(e,i??null),{catalogType:E,isDataset:k,isImputerNode:j,isMissingIndicatorNode:S,isReplaceAliasesNode:M,isTrimWhitespaceNode:$,isRemoveSpecialCharsNode:T,isReplaceInvalidValuesNode:L,isRegexCleanupNode:P,isNormalizeTextCaseNode:O,isStandardizeDatesNode:D,isLabelEncodingNode:W,isTargetEncodingNode:z,isHashEncodingNode:R,isFeatureTargetSplitNode:U,isTrainTestSplitNode:V,isTrainModelDraftNode:B,isModelEvaluationNode:X,isModelRegistryNode:H,isHyperparameterTuningNode:F,isClassUndersamplingNode:K,isClassOversamplingNode:re,isOrdinalEncodingNode:G,isDummyEncodingNode:q,isOneHotEncodingNode:Y,isFeatureMathNode:Q,isCastNode:ee,isBinningNode:J,isScalingNode:se,isPolynomialFeaturesNode:ke,isFeatureSelectionNode:Pe,isTransformerAuditNode:De,isOutlierNode:Be,isSkewnessNode:mt,isSkewnessDistributionNode:Ge,isBinnedDistributionNode:ue,isDataConsistencyNode:ye,isInspectionNode:Me,isRemoveDuplicatesNode:Le,isDropMissingColumnsNode:Ve,isDropMissingRowsNode:ce,isDropMissingNode:Fe}=R2(e),et=k,it=K||re,at=v.useMemo(()=>OM,[]),xt=v.useMemo(()=>at.map(ve=>ve.value),[at]),{parameters:ot,getParameter:$e,getParameterIf:je,requiresColumnCatalog:Vt,dropColumnParameter:tt}=AL(e),Wt=v.useMemo(()=>Z2[E]??null,[E]),ct=typeof(e==null?void 0:e.id)=="string"?e.id:"",Rt=[Q,U,V,X,R,ke,Pe,ye,B,F,it,W,z,q,Y,G,j,S,M,$,T,L,P,O,D,ee,Le,Fe,Be],{canResetNode:mn,headerCanResetNode:$n,footerCanResetNode:Ft}=OL({isResetAvailable:d,isDataset:k,defaultConfigTemplate:u,footerResetFlags:Rt,isScalingNode:se,isBinningNode:J,isBinnedDistributionNode:ue,isSkewnessDistributionNode:Ge});je(J,"columns"),je(se,"columns");const ln=je(Le,"columns"),Hn=je(Le,"keep"),Gt=je(M,"custom_pairs"),_t=je($,"columns"),es=je($,"mode"),cn=je(T,"columns"),En=je(T,"mode"),yt=je(T,"replacement"),Zs=je(L,"columns"),nn=je(L,"mode"),jt=je(L,"min_value"),kt=je(L,"max_value"),Cs=je(P,"columns"),vn=je(P,"mode"),Ln=je(P,"pattern"),yn=je(P,"replacement"),Vn=je(O,"columns"),bn=je(O,"mode"),Ss=W?$e("columns"):null,Yt=W?$e("auto_detect"):null,ts=W?$e("max_unique_values"):null,Wn=W?$e("output_suffix"):null,zn=W?$e("drop_original"):null,Tr=W?$e("missing_strategy"):null,fs=W?$e("missing_code"):null,er=R?$e("columns"):null,Rs=R?$e("auto_detect"):null,Fs=R?$e("max_categories"):null,yr=R?$e("n_buckets"):null,ps=R?$e("output_suffix"):null,rn=R?$e("drop_original"):null,It=R?$e("encode_missing"):null,ht=je(ke,"columns"),$r=je(ke,"auto_detect"),ns=je(ke,"degree"),br=je(ke,"include_bias"),Es=je(ke,"interaction_only"),Jr=je(ke,"include_input_features"),le=je(ke,"output_prefix"),xe=je(Pe,"columns"),Ue=je(Pe,"auto_detect"),$t=je(Pe,"target_column"),Ee=je(Pe,"method"),ut=je(Pe,"score_func"),gt=je(Pe,"problem_type"),Kt=je(Pe,"k"),Bt=je(Pe,"percentile"),hn=je(Pe,"alpha"),Qt=je(Pe,"threshold"),xn=je(Pe,"mode"),tr=je(Pe,"estimator"),gs=je(Pe,"step"),Dn=je(Pe,"min_features"),Kn=je(Pe,"max_features"),ks=je(Pe,"drop_unselected"),_s=je(Q,"error_handling"),Co=je(Q,"allow_overwrite"),Al=je(Q,"default_timezone"),Ct=je(Q,"epsilon"),Ui=je(it,"method"),Ol=je(it,"target_column"),Pl=je(it,"sampling_strategy"),qi=je(it,"random_state"),Hi=je(re,"k_neighbors"),Tl=je(K,"replacement"),So=je(U,"target_column"),Ms=B||F,xr=je(Ms,"target_column"),Z=je(Ms,"problem_type"),ge=je(Ms,"model_type"),he=je(B,"hyperparameters"),ze=je(F,"search_strategy"),Oe=je(F,"search_iterations"),Ce=je(F,"search_random_state"),lt=je(F,"scoring_metric"),Ke=je(Ms,"cv_enabled"),vt=je(Ms,"cv_strategy"),ft=je(Ms,"cv_folds"),nt=je(Ms,"cv_shuffle"),Pt=je(Ms,"cv_random_state"),Yn=je(B,"cv_refit_strategy"),Xt=z?$e("columns"):null,Rn=z?$e("target_column"):null,nr=z?$e("auto_detect"):null,sr=z?$e("max_categories"):null,wr=z?$e("output_suffix"):null,ga=z?$e("drop_original"):null,Lr=z?$e("smoothing"):null,vs=z?$e("encode_missing"):null,Is=z?$e("handle_unknown"):null,Eo=G?$e("columns"):null,rr=G?$e("auto_detect"):null,ko=G?$e("max_categories"):null,Da=G?$e("output_suffix"):null,Mo=G?$e("drop_original"):null,Ao=G?$e("encode_missing"):null,Oo=G?$e("handle_unknown"):null,Po=G?$e("unknown_value"):null,Gn=q?$e("columns"):null,un=q?$e("auto_detect"):null,To=q?$e("max_categories"):null,Ra=q?$e("drop_first"):null,ju=q?$e("include_missing"):null,$l=q?$e("drop_original"):null,dn=q?$e("prefix_separator"):null,Fn=Y?$e("columns"):null,As=Y?$e("auto_detect"):null,Vi=Y?$e("max_categories"):null,Hg=Y?$e("drop_first"):null,Vg=Y?$e("include_missing"):null,Wg=Y?$e("drop_original"):null,Nu=Y?$e("prefix_separator"):null,Cu=je(S,"columns"),Su=je(S,"flag_suffix");je(se,"default_method"),je(se,"auto_detect");const Qm=je(ce,"drop_if_any_missing"),Xm=g$(ot,{isBinningNode:J,isCastNode:ee,isDropMissingColumnsNode:Ve,isDropMissingRowsNode:ce,isImputerNode:j,isMissingIndicatorNode:S,isReplaceAliasesNode:M,isTrimWhitespaceNode:$,isRemoveSpecialCharsNode:T,isReplaceInvalidValuesNode:L,isRegexCleanupNode:P,isNormalizeTextCaseNode:O,isStandardizeDatesNode:D,isScalingNode:se,isClassUndersamplingNode:K,isClassOversamplingNode:re,isTrainModelDraftNode:B,isLabelEncodingNode:W,isOrdinalEncodingNode:G,isDummyEncodingNode:q,isOneHotEncodingNode:Y,isRemoveDuplicatesNode:Le,isSkewnessNode:mt,isFeatureTargetSplitNode:U}),Jm=v.useMemo(()=>ye?Xm:[],[Xm,ye]),Eu=mt||Ge,{configState:Xe,setConfigState:In,stableInitialConfig:Zm,stableCurrentConfig:Kg,nodeChangeVersion:ku}=_$({node:e}),{handleParameterChange:Yg,handleNumberChange:eh,handleBooleanChange:th,handleTextChange:Mu}=v$({setConfigState:In}),Gg=v.useMemo(()=>H?Xe?{...Xe}:{}:null,[Xe,H]),Wi=v.useMemo(()=>wx(Xe==null?void 0:Xe.strategies,xt),[Xe==null?void 0:Xe.strategies,xt]),Qg=Wi.length,nh=v.useMemo(()=>ng(jx(Xe==null?void 0:Xe.transformations)),[Xe==null?void 0:Xe.transformations]),{graphContext:Bs,graphNodes:sh,graphNodeCount:Xg,upstreamNodeIds:Fa,upstreamTargetColumn:$o,hasReachableSource:bt}=_L({graphSnapshot:i??null,nodeId:ct,isDataset:k}),{featureTargetSplitConfig:rh,trainTestSplitConfig:ah,resamplingConfig:Ll,trainModelDraftConfig:Ki,trainModelRuntimeConfig:Au,trainModelCVConfig:Ia,filteredModelTypeOptions:oh}=Q2({configState:Xe,setConfigState:In,isFeatureTargetSplitNode:U,isTrainTestSplitNode:V,isTrainModelDraftNode:B,isHyperparameterTuningNode:F,isClassResamplingNode:it,isClassOversamplingNode:re,isClassUndersamplingNode:K,upstreamTargetColumn:$o,nodeId:ct,modelTypeOptions:(ge==null?void 0:ge.options)??null}),zl=v.useMemo(()=>Q?w0((Xe==null?void 0:Xe.operations)??[]):[],[Xe==null?void 0:Xe.operations,Q]),lh=v.useMemo(()=>{if(!Fa.length)return{};const ve={};return Fa.forEach(de=>{var _e;const pe=sh.find(dt=>dt&&typeof dt.id=="string"&&dt.id===de);if(!pe)return;const we=((_e=pe==null?void 0:pe.data)==null?void 0:_e.config)??null;ve[de]=we}),ve},[sh,Fa]),ih=v.useMemo(()=>cu({sourceId:l??null,nodeId:ct||null,config:Xe,upstreamIds:Fa,upstreamConfig:lh}),[Xe,ct,l,lh,Fa]),[Ou,Dl]=v.useState(null),{cachedSchemaColumns:Rl,oversamplingSchemaGuard:Jg,imputationSchemaDiagnostics:Yi,skipPreview:Zg}=PL({cachedPreviewSchema:Ou,isClassOversamplingNode:re,resamplingTargetColumn:(Ll==null?void 0:Ll.targetColumn)??null,isImputerNode:j,imputerStrategies:Wi}),{availableColumns:ss,setAvailableColumns:Fl,columnSearch:Lo,setColumnSearch:Gi,columnMissingMap:zo,setColumnMissingMap:Qi,columnTypeMap:Ba,setColumnTypeMap:ch,columnSuggestions:Pu,setColumnSuggestions:uh,imputerMissingFilter:dh,setImputerMissingFilter:jr}=wL({requiresColumnCatalog:Vt,isImputerNode:j,nodeId:ct,sourceId:l,hasReachableSource:bt}),Il=!!tt,{hasDropColumnSource:mh,availableFilters:Tu,activeFilterId:$u,setActiveFilterId:Lu,recommendations:Bl,filteredRecommendations:hh,formatSignalName:fh,isFetchingRecommendations:Zr,recommendationsError:Xi,recommendationsGeneratedAt:Ul,suggestedThreshold:zu,refreshRecommendations:Du}=qk({hasDropColumnSource:Il,sourceId:l,nodeId:ct,graphContext:Bs,hasReachableSource:bt,columnTypeMap:Ba,setAvailableColumns:Fl,setColumnSearch:Gi,setColumnMissingMap:Qi,setColumnTypeMap:ch,setColumnSuggestions:uh});q2({shouldLoad:j,sourceId:l,hasReachableSource:bt,graphContext:Bs,targetNodeId:(e==null?void 0:e.id)??null,setAvailableColumns:Fl,setColumnMissingMap:Qi});const{isFetchingLabelEncoding:Ji,labelEncodingError:Do,labelEncodingSuggestions:Ru,labelEncodingMetadata:ph,isFetchingTargetEncoding:Zi,targetEncodingError:gh,targetEncodingSuggestions:_h,targetEncodingMetadata:vh,isFetchingHashEncoding:Fu,hashEncodingError:yh,hashEncodingSuggestions:bh,hashEncodingMetadata:_a,isFetchingOrdinalEncoding:Iu,ordinalEncodingError:Bu,ordinalEncodingSuggestions:e_,ordinalEncodingMetadata:t_,isFetchingDummyEncoding:ql,dummyEncodingError:n_,dummyEncodingSuggestions:xh,dummyEncodingMetadata:wh,isFetchingOneHotEncoding:Zt,oneHotEncodingError:Uu,oneHotEncodingSuggestions:ec,oneHotEncodingMetadata:Hl,handleApplyLabelEncodingRecommended:jh,handleApplyTargetEncodingRecommended:qu,handleApplyHashEncodingRecommended:Vl,handleApplyOrdinalEncodingRecommended:tc,handleApplyDummyEncodingRecommended:Ro,handleApplyOneHotEncodingRecommended:Nh}=H$({isLabelEncodingNode:W,isTargetEncodingNode:z,isHashEncodingNode:R,isOrdinalEncodingNode:G,isDummyEncodingNode:q,isOneHotEncodingNode:Y,sourceId:l,hasReachableSource:bt,graphContext:Bs,node:e,configState:Xe,setConfigState:In,nodeChangeVersion:ku}),[Ch,s_]=v.useState("500"),[nc,ys]=v.useState(()=>new Set),[sc,Nr]=v.useState(()=>new Set);v.useEffect(()=>{ys(new Set)},[Zm]);const{isPreviewNode:Wl,isDatasetProfileNode:Hu,datasetProfileController:Vu,profileState:r_}=DL({node:e,graphContext:Bs,hasReachableSource:bt,sourceId:l,formatRelativeTime:hs}),{previewState:wn,refreshPreview:Sh,clearCachedPreviewSchema:Eh,canTriggerPreview:Wu}=bL({graphSnapshot:i??null,graphNodeCount:Xg,hasReachableSource:bt,sourceId:l,node:e,nodeId:ct,previewSignature:ih,skipPreview:Zg,cachedPreviewSchema:Ou,setCachedPreviewSchema:Dl,isPreviewNode:Wl,isFeatureMathNode:Q,isPolynomialFeaturesNode:ke,isFeatureSelectionNode:Pe,isTrainTestSplitNode:V,isOutlierNode:Be,isTransformerAuditNode:De}),{featureMathSignals:zr,polynomialSignal:kh,featureSelectionSignal:Ua}=CL({previewState:wn,nodeId:ct,isFeatureMathNode:Q,isPolynomialFeaturesNode:ke,isFeatureSelectionNode:Pe});SL({isFeatureSelectionNode:Pe,featureSelectionSignal:Ua,upstreamTargetColumn:$o,setConfigState:In});const Dr=v.useMemo(()=>Q?RP(zl,zr):[],[zl,zr,Q]);v.useEffect(()=>{if(!Q){Nr(()=>new Set);return}Nr(ve=>{if(!ve.size)return ve;const de=new Set(zl.map(we=>we.id)),pe=new Set;return ve.forEach(we=>{de.has(we)&&pe.add(we)}),pe.size===ve.size?ve:pe})},[zl,Q]);const{outlierData:Kl,outlierError:ea,isFetchingOutliers:Ku,refreshOutliers:Mh}=H2({isOutlierNode:Be,sourceId:l,hasReachableSource:bt,graphContext:Bs,targetNodeId:ct||null}),{scalingData:Ah,scalingError:qa,isFetchingScaling:Fo,refreshScaling:Ha}=F2({isScalingNode:se,sourceId:l,hasReachableSource:bt,graphContext:Bs,targetNodeId:(e==null?void 0:e.id)??null}),{binningData:Yl,binningError:Yu,isFetchingBinning:Va,refreshBinning:ta}=I2({isBinningNode:J,sourceId:l,hasReachableSource:bt,graphContext:Bs,targetNodeId:(e==null?void 0:e.id)??null}),Ut=v.useCallback(()=>{Eh(),Sh(),se&&Ha(),J&&ta(),Be&&Mh()},[J,Be,se,ta,Mh,Eh,Sh,Ha]),{binnedDistributionData:Tt,binnedDistributionError:va,isFetchingBinnedDistribution:Qn,refreshBinnedDistribution:bs}=U2({isBinnedDistributionNode:ue,sourceId:l,hasReachableSource:bt,graphContext:Bs,targetNodeId:(e==null?void 0:e.id)??null,samplePreset:Ch}),{skewnessData:Wa,skewnessError:Ka,isFetchingSkewness:xs,refreshSkewness:rc}=B2({shouldLoad:Eu,sourceId:l,graphContext:Bs,targetNodeId:(e==null?void 0:e.id)??null,transformations:nh}),{previewColumns:ac,previewColumnStats:Oh,previewSampleRows:Ya}=TL(wn),Io=v.useMemo(()=>{var ve,de;return S?GM(Xe==null?void 0:Xe.flag_suffix,(de=(ve=e==null?void 0:e.data)==null?void 0:ve.config)==null?void 0:de.flag_suffix):""},[Xe==null?void 0:Xe.flag_suffix,S,(Mt=(Hs=e==null?void 0:e.data)==null?void 0:Hs.config)==null?void 0:Mt.flag_suffix]),Rr=v.useMemo(()=>S?Ze(Xe==null?void 0:Xe.columns):[],[Xe==null?void 0:Xe.columns,S]),oc=v.useMemo(()=>S?XM({selectedColumns:Rr,availableColumns:ss,columnMissingMap:zo,suffix:Io}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[Io,ss,zo,S,Rr]),Gu=!!l&&bt,Ph=v.useMemo(()=>{var ve;return Ze((ve=e==null?void 0:e.data)==null?void 0:ve.columns)},[(Mn=e==null?void 0:e.data)==null?void 0:Mn.columns]),{aliasStrategies:a_,aliasStrategyCount:na,aliasColumnSummary:ya,aliasCustomPairSummary:Bo,aliasSampleMap:lc,aliasColumnOptions:ic,trimWhitespaceColumnSummary:ar,trimWhitespaceSampleMap:or,trimWhitespaceModeDetails:Ga,removeSpecialColumnSummary:sa,removeSpecialSampleMap:ra,removeSpecialModeDetails:Qa,regexCleanupColumnSummary:Th,regexCleanupSampleMap:Qu,regexCleanupModeDetails:Xu,regexCleanupMode:Us,regexCleanupReplacementValue:qs,normalizeCaseColumnSummary:sn,normalizeCaseSampleMap:Cr,normalizeCaseModeDetails:$h,normalizeCaseMode:Lh,replaceInvalidMode:Ju,replaceInvalidModeDetails:Zu,replaceInvalidSampleMap:zh,replaceInvalidColumnSummary:cc,replaceInvalidMinValue:Dh,replaceInvalidMaxValue:Uo,standardizeDatesMode:uc,dateStrategies:ed,standardizeDatesSampleMap:Gl,standardizeDatesColumnSummary:qo,dateColumnOptions:Rh}=gL({isReplaceAliasesNode:M,isTrimWhitespaceNode:$,isRemoveSpecialCharsNode:T,isRegexCleanupNode:P,isNormalizeTextCaseNode:O,isReplaceInvalidValuesNode:L,isStandardizeDatesNode:D,configState:Xe,nodeConfig:((fn=e==null?void 0:e.data)==null?void 0:fn.config)??null,availableColumns:ss,columnTypeMap:Ba,previewSampleRows:Ya}),Fh=J||se||Be,{numericExcludedColumns:Xa}=Y2({shouldAnalyze:Fh,availableColumns:ss,columnTypeMap:Ba,previewSampleRows:Ya}),{scalingConfig:Ih,scalingExcludedColumns:Ho,scalingMethodDetailMap:dc,scalingMethodOptions:Vo,scalingRecommendationRows:td,scalingSelectedCount:nd,scalingOverrideCount:sd,scalingDefaultDetail:rd,scalingDefaultLabel:Wo,scalingAutoDetectEnabled:lr,scalingHasRecommendations:Ja,scalingStatusMessage:ad,scalingOverrideExampleSummary:Bh,outlierConfig:aa,outlierMethodDetailMap:ba,outlierMethodOptions:od,outlierRecommendationRows:Uh,outlierSelectedCount:oa,outlierOverrideCount:xa,outlierParameterOverrideCount:mc,outlierDefaultDetail:qh,outlierDefaultLabel:hc,outlierAutoDetectEnabled:Hh,outlierHasRecommendations:Ql,outlierStatusMessage:Fr,outlierSampleSize:Xl,relativeOutlierGeneratedAt:Jl,outlierHasOverrides:Za,outlierOverrideSummaryDisplay:ld,binningConfig:eo,binningDefaultLabel:Vh,binningOverrideCount:id,binningOverrideSummary:an,binningFieldIds:fc,binningCustomEdgeDrafts:cd,binningCustomLabelDrafts:ud,selectedColumns:Os,binningInsightsRecommendations:dd,binningRecommendedColumnSet:wa,binningAllNumericColumns:en,canApplyAllBinningNumeric:kn,binningExcludedColumns:jn,binningColumnPreviewMap:Zl,binningInsightsExcludedColumns:ei,handleScalingDefaultMethodChange:ti,handleScalingAutoDetectToggle:o_,handleScalingClearOverrides:rs,handleScalingApplyAllRecommendations:md,handleScalingOverrideSelect:hd,handleOutlierDefaultMethodChange:fd,handleOutlierAutoDetectToggle:Ir,handleOutlierClearOverrides:ir,handleOutlierApplyAllRecommendations:ni,handleOutlierOverrideSelect:pd,handleOutlierMethodParameterChange:gd,handleOutlierColumnParameterChange:Wh,handleBinningIntegerChange:Kh,handleBinningBooleanToggle:Yh,handleBinningSuffixChange:Gh,handleBinningLabelFormatChange:Qh,handleBinningMissingStrategyChange:Xh,handleBinningMissingLabelChange:Jh,handleBinningCustomBinsChange:Zh,handleBinningCustomLabelsChange:si,handleBinningClearCustomColumn:ef,handleBinningOverrideStrategyChange:pc,handleBinningOverrideNumberChange:gc,handleBinningOverrideKbinsEncodeChange:tf,handleBinningOverrideKbinsStrategyChange:_d,handleBinningClearOverride:nf,handleBinningClearOverrides:sf,handleBinningApplyStrategies:rf,handleBinningApplyColumns:vd,handleApplyAllBinningNumeric:yd}=aL({isScalingNode:se,isOutlierNode:Be,isBinningNode:J,configState:Xe,setConfigState:In,nodeId:ct,numericExcludedColumns:Xa,scalingData:Ah,outlierData:Kl,binningData:Yl,availableColumns:ss,previewSampleRows:Ya});jL({previewState:wn,previewSampleRows:Ya,activeFlagSuffix:Io??"",setColumnTypeMap:ch,setColumnSuggestions:uh}),NL({previewState:wn,activeFlagSuffix:Io??"",hasReachableSource:bt,requiresColumnCatalog:Vt,nodeColumns:Ph,selectedColumns:Os,setAvailableColumns:Fl,setColumnMissingMap:Qi});const af=`${ct||"node"}-remove-duplicates-keep`,of=v.useMemo(()=>{const ve=typeof(Xe==null?void 0:Xe.keep)=="string"?Xe.keep.trim().toLowerCase():"";return ve==="last"||ve==="none"?ve:Wk},[Xe==null?void 0:Xe.keep]),lf=v.useMemo(()=>{var pe,we;if(!Be)return null;const ve=(we=(pe=wn.data)==null?void 0:pe.signals)==null?void 0:we.outlier_removal;return!Array.isArray(ve)||!ve.length?null:ct?ve.find(_e=>_e&&_e.node_id===ct)??ve[ve.length-1]??null:ve[ve.length-1]??null},[Be,ct,(Ts=(Bn=wn.data)==null?void 0:Bn.signals)==null?void 0:Ts.outlier_removal]),l_=v.useMemo(()=>{var pe,we;if(!De)return null;const ve=(we=(pe=wn.data)==null?void 0:pe.signals)==null?void 0:we.transformer_audit;return!Array.isArray(ve)||!ve.length?null:ct?ve.find(_e=>_e&&_e.node_id===ct)??ve[ve.length-1]??null:ve[ve.length-1]??null},[De,ct,(Nn=(so=wn.data)==null?void 0:so.signals)==null?void 0:Nn.transformer_audit]),Ko=v.useMemo(()=>Lo.trim().toLowerCase(),[Lo]),cf=v.useMemo(()=>Ko?ss.filter(ve=>ve.toLowerCase().includes(Ko)):ss,[ss,Ko]),i_=v.useCallback(ve=>{In(de=>{const pe=ng(jx(de==null?void 0:de.transformations)),we=ng(ve(pe));return{...de,transformations:we.map(_e=>({..._e}))}})},[]),{skewnessThreshold:bd,skewnessViewMode:uf,setSkewnessViewMode:df,skewnessGroupByMethod:_c,setSkewnessGroupByMethod:c_,skewnessDistributionView:u_,setSkewnessDistributionView:d_,skewnessRecommendedCount:Sr,skewnessNumericCount:xd,skewnessTransformationsCount:vc,hasSkewnessAutoRecommendations:mf,skewnessRows:hf,skewnessTableGroups:ff,skewnessDistributionCards:wd,getSkewnessMethodLabel:Yo,getSkewnessMethodStatus:jd,applySkewnessRecommendations:Nd,handleSkewnessOverrideChange:m_,clearSkewnessTransformations:pf}=J2({skewnessData:Wa,shouldLoadInsights:Eu,skewnessTransformations:nh,availableColumns:ss,previewColumns:ac,columnTypeMap:Ba,updateSkewnessTransformations:i_}),{imputerColumnOptions:gf,imputerMissingSliderMax:_f,imputerFilteredOptionCount:vf,imputerMissingFilterActive:yf}=G2({isImputerNode:j,imputerStrategies:Wi,availableColumns:ss,columnMissingMap:zo,previewColumns:ac,previewColumnStats:Oh,nodeColumns:(Go=e==null?void 0:e.data)==null?void 0:Go.columns,imputerMissingFilter:dh}),to=$e("missing_threshold"),as=(to==null?void 0:to.name)??null,{normalizedSuggestedThreshold:os,thresholdMatchesSuggestion:Cd,canApplySuggestedThreshold:Sd,handleApplySuggestedThreshold:Ed}=zL({suggestedThreshold:zu,thresholdParameterName:as,configState:Xe,handleParameterChange:Yg}),bf=ce&&!!(to||Qm),{handleToggleColumn:la,handleApplyAllRecommended:yc,handleSelectAllColumns:kd,handleClearColumns:bc,handleRemoveColumn:Md}=EL({isBinningNode:J,isScalingNode:se,setConfigState:In,binningExcludedColumns:jn,scalingExcludedColumns:Ho,availableColumns:ss,recommendations:Bl}),{handleSave:xc,handleResetNode:wc}=kL({configState:Xe,isBinningNode:J,isScalingNode:se,nodeId:ct,onUpdateConfig:n,onClose:t,sourceId:l,graphSnapshot:i??null,isInspectionNode:Me,onUpdateNodeData:s,setConfigState:In,canResetNode:mn,defaultConfigTemplate:u,onResetConfig:c}),jc=Os.length,{relativeGeneratedAt:Ad,relativeScalingGeneratedAt:Od,relativeBinningGeneratedAt:Nc,relativeBinnedGeneratedAt:h_,scalingSampleSize:xf,binningSampleSize:Pd,binnedSampleSize:wf}=LL({recommendationsGeneratedAt:Ul,scalingData:Ah,binningData:Yl,binnedDistributionData:Tt}),no=mh&&!!l&&bt,Br=!et&&!Me,f_=Br&&Zm!==Kg,jf=r_.status==="loading",Td=wn.status==="loading",{hasActiveAsyncWork:Nf,footerBusyLabel:Cf}=$L({isProfileLoading:jf,isPreviewLoading:Td,isFetchingScaling:Fo,isFetchingBinning:Va,isFetchingHashEncoding:Fu,isFetchingBinnedDistribution:Qn,isFetchingRecommendations:Zr,isPreviewNode:Wl}),{handleAddImputerStrategy:ri,handleRemoveImputerStrategy:ls,toggleImputerStrategySection:p_,handleImputerMethodChange:g_,handleImputerOptionNumberChange:Cc,handleImputerColumnsChange:is,handleImputerColumnToggle:__,handleImputerMissingFilterChange:He}=IL({setConfigState:In,imputationMethodValues:xt,imputationMethodOptions:at,imputerStrategyCount:Qg,setCollapsedStrategies:ys,setImputerMissingFilter:jr}),Xn=v.useCallback(ve=>{M&&In(de=>{var $s,Un,Cn,qr,Mr,Ar,Hr,ur,ao;if(!M)return de;const pe=Ze((de==null?void 0:de.columns)??((Un=($s=e==null?void 0:e.data)==null?void 0:$s.config)==null?void 0:Un.columns)),we=Sm(de==null?void 0:de.mode,(qr=(Cn=e==null?void 0:e.data)==null?void 0:Cn.config)==null?void 0:qr.mode),_e=(()=>{var dr;const cs=Ei(de);if(cs!==void 0){const Ws=fl(cs);if(Ws!==null)return Ws}const Dt=Ei((dr=e==null?void 0:e.data)==null?void 0:dr.config);if(Dt!==void 0){const Ws=fl(Dt);if(Ws!==null)return Ws}return pe.length===0})(),dt=(de==null?void 0:de.alias_strategies)??(de==null?void 0:de.strategies)??((Ar=(Mr=e==null?void 0:e.data)==null?void 0:Mr.config)==null?void 0:Ar.alias_strategies)??((ur=(Hr=e==null?void 0:e.data)==null?void 0:Hr.config)==null?void 0:ur.strategies),At=Mx(dt,{mode:we,columns:pe,autoDetect:_e}),St=ve(At).map(cs=>({mode:Sm(cs.mode,we),columns:Array.from(new Set(cs.columns.map(Dt=>Dt.trim()).filter(Boolean))).sort((Dt,dr)=>Dt.localeCompare(dr)),autoDetect:!!cs.autoDetect})),tn=iA(St),on=Array.from(new Set(St.flatMap(cs=>cs.columns))).sort((cs,Dt)=>cs.localeCompare(Dt)),Vs=((ao=St[0])==null?void 0:ao.mode)??we,pn=St.length?St.some(cs=>cs.autoDetect):_e;return{...de,alias_strategies:tn,columns:on,mode:Vs,auto_detect:pn}})},[M,(Na=e==null?void 0:e.data)==null?void 0:Na.config]),Ps=v.useCallback(ve=>{In(de=>{var Vs,pn,$s,Un,Cn,qr,Mr;if(!D)return de;const pe=Ze((de==null?void 0:de.columns)??((pn=(Vs=e==null?void 0:e.data)==null?void 0:Vs.config)==null?void 0:pn.columns)),we=Ix(de==null?void 0:de.mode,(Un=($s=e==null?void 0:e.data)==null?void 0:$s.config)==null?void 0:Un.mode),_e=pe.length===0,dt=Bx((de==null?void 0:de.format_strategies)??((qr=(Cn=e==null?void 0:e.data)==null?void 0:Cn.config)==null?void 0:qr.format_strategies),{columns:pe,mode:we,autoDetect:_e}),At=ve(dt),St=LA(At),tn=Array.from(new Set(At.flatMap(Ar=>Ar.columns.map(Hr=>Hr.trim()).filter(Boolean)))).sort((Ar,Hr)=>Ar.localeCompare(Hr)),on=((Mr=At[0])==null?void 0:Mr.mode)??we;return{...de,format_strategies:St,columns:tn,mode:on}})},[D,(Ec=(oi=e==null?void 0:e.data)==null?void 0:oi.config)==null?void 0:Ec.columns,(ws=(Qo=e==null?void 0:e.data)==null?void 0:Qo.config)==null?void 0:ws.format_strategies,(ro=(kc=e==null?void 0:e.data)==null?void 0:kc.config)==null?void 0:ro.mode]),Sf=v.useCallback(()=>{l&&bs()},[bs,l]),v_=v.useMemo(()=>{if(!ue)return[];const de=(Array.isArray(Tt==null?void 0:Tt.columns)?Tt==null?void 0:Tt.columns:[]).map(pe=>{if(!pe||!pe.column)return null;const we=Number(pe.total_rows),_e=Number.isFinite(we)?Math.max(0,Math.round(we)):0;if(_e<=0)return null;const At=(Array.isArray(pe.bins)?pe.bins:[]).map(Dt=>{if(!Dt)return null;const Ws=(typeof Dt.label=="string"?Dt.label.trim():String(Dt.label??""))||(Dt.is_missing?"Missing":"Unlabeled bin"),Dd=Number(Dt.count);if(!Number.isFinite(Dd))return null;const Df=Math.max(0,Math.round(Dd)),Mc=Number(Dt.percentage),Ac=Number.isFinite(Mc)?Math.min(100,Math.max(0,Mc)):0,b_=Number(Ac.toFixed(2));return{label:Ws,count:Df,percentage:b_,isMissing:!!Dt.is_missing}}).filter(Dt=>!!Dt);if(!At.length)return null;At.sort((Dt,dr)=>Dt.isMissing!==dr.isMissing?Dt.isMissing?1:-1:Dt.count!==dr.count?dr.count-Dt.count:Dt.label.localeCompare(dr.label));const St=At.length,tn=12,on=St>tn,Vs=on?At.slice(0,tn):At,pn=Number(pe.missing_rows),$s=Number.isFinite(pn)?Math.max(0,Math.round(pn)):0,Un=Number(pe.distinct_bins),Cn=Number.isFinite(Un)?Math.max(0,Math.round(Un)):At.length,qr=pe.top_label;let Mr=typeof qr=="string"?qr.trim()||null:qr??null;const Ar=Number(pe.top_count);let Hr=Number.isFinite(Ar)?Math.max(0,Math.round(Ar)):null;const ur=Number(pe.top_percentage);let ao=Number.isFinite(ur)?Number(Math.min(100,Math.max(0,ur)).toFixed(2)):null;(Mr===null||Hr===null||ao===null)&&Vs.length&&(Mr=Vs[0].label,Hr=Vs[0].count,ao=Vs[0].percentage);const cs=typeof pe.source_column=="string"?pe.source_column.trim()||null:pe.source_column??null;return{column:pe.column,sourceColumn:cs,totalRows:_e,missingRows:$s,distinctBins:Cn,topLabel:Mr,topCount:Hr,topPercentage:ao,bins:Vs,hasMoreBins:on,totalBinCount:St}}).filter(pe=>!!pe);return de.sort((pe,we)=>{const _e=(we.topCount??0)-(pe.topCount??0);return _e!==0?_e:pe.column.localeCompare(we.column)}),de},[Tt,ue]),ai=v.useCallback(()=>{const ve=ed.length;Ps(de=>{var At;const pe=new Set;de.forEach(St=>{St.columns.forEach(tn=>{const on=tn.trim();on&&pe.add(on)})});const we=qo.recommendedColumns.find(St=>!pe.has(St)),dt={mode:de.length?de[de.length-1].mode:((At=lg[0])==null?void 0:At.value)??uc,columns:we?[we]:[],autoDetect:!we};return[...de,dt]}),ys(de=>{const pe=new Set(de);return pe.delete(ve),pe})},[ed.length,ys,qo.recommendedColumns,uc,Ps]),Sc=v.useCallback(ve=>{Ps(de=>de.filter((pe,we)=>we!==ve)),ys(de=>{const pe=new Set;return de.forEach(we=>{we!==ve&&pe.add(we>ve?we-1:we)}),pe})},[ys,Ps]),$d=v.useCallback(ve=>{ys(de=>{const pe=new Set(de);return pe.has(ve)?pe.delete(ve):pe.add(ve),pe})},[]),Ef=v.useCallback((ve,de)=>{Ps(pe=>pe.map((we,_e)=>_e===ve?{...we,mode:de}:we))},[Ps]),kf=v.useCallback((ve,de)=>{const pe=de.split(",").map(we=>we.trim()).filter(Boolean).sort((we,_e)=>we.localeCompare(_e));Ps(we=>we.map((_e,dt)=>dt===ve?{..._e,columns:pe}:_e))},[Ps]),Mf=v.useCallback((ve,de)=>{const pe=de.trim();pe&&Ps(we=>we.map((_e,dt)=>{if(dt!==ve)return _e;const St=_e.columns.includes(pe)?_e.columns.filter(tn=>tn!==pe):[..._e.columns,pe];return St.sort((tn,on)=>tn.localeCompare(on)),{..._e,columns:St}}))},[Ps]),Ld=v.useCallback((ve,de)=>{Ps(pe=>pe.map((we,_e)=>_e===ve?{...we,autoDetect:de}:we))},[Ps]),cr=v.useCallback(ve=>{In(de=>{if(!Q)return de;const pe=de&&typeof de=="object"&&!Array.isArray(de)?{...de}:{},we=w0(Array.isArray(de==null?void 0:de.operations)?de.operations:[]),_e=ve(we);return pe.operations=zP(_e),pe})},[Q,In]),Jn=v.useCallback(ve=>{if(!Q)return;let de="";cr(pe=>{const we=new Set(pe.map(dt=>dt.id)),_e=j0(ve,we);return de=_e.id,[...pe,_e]}),de&&Nr(pe=>{const we=new Set(pe);return we.delete(de),we})},[Q,Nr,cr]),Er=v.useCallback(ve=>{if(!Q)return;let de="";cr(pe=>{const we=pe.findIndex(on=>on.id===ve);if(we===-1)return pe;const _e=pe[we],dt=new Set(pe.map(on=>on.id)),At=j0(_e.type,dt);de=At.id;const St={..._e,id:At.id,inputColumns:[..._e.inputColumns],secondaryColumns:[..._e.secondaryColumns],constants:[..._e.constants],datetimeFeatures:[..._e.datetimeFeatures],outputColumn:_e.outputColumn?`${_e.outputColumn}_copy`:""},tn=[...pe];return tn.splice(we+1,0,St),tn}),de&&Nr(pe=>{const we=new Set(pe);return we.delete(de),we})},[Q,Nr,cr]),ja=v.useCallback(ve=>{Q&&(cr(de=>de.filter(pe=>pe.id!==ve)),Nr(de=>{const pe=new Set(de);return pe.delete(ve),pe}))},[Q,Nr,cr]),Af=v.useCallback((ve,de)=>{Q&&cr(pe=>{const we=pe.findIndex(St=>St.id===ve);if(we===-1)return pe;const _e=de==="up"?we-1:we+1;if(_e<0||_e>=pe.length)return pe;const dt=[...pe],[At]=dt.splice(we,1);return dt.splice(_e,0,At),dt})},[Q,cr]),Of=v.useCallback(ve=>{Nr(de=>{const pe=new Set(de);return pe.has(ve)?pe.delete(ve):pe.add(ve),pe})},[]),kr=v.useCallback((ve,de)=>{Q&&cr(pe=>pe.map(we=>{if(we.id!==ve)return we;let _e={...we};if(de.type&&(_e.type=de.type),de.method!==void 0&&(_e.method=de.method),de.inputColumns!==void 0&&(_e.inputColumns=hu(de.inputColumns)),de.secondaryColumns!==void 0&&(_e.secondaryColumns=hu(de.secondaryColumns)),de.constants!==void 0&&(_e.constants=dw(de.constants)),de.outputColumn!==void 0&&(_e.outputColumn=de.outputColumn.trim()),de.outputPrefix!==void 0&&(_e.outputPrefix=de.outputPrefix.trim()),de.datetimeFeatures!==void 0&&(_e.datetimeFeatures=mw(de.datetimeFeatures)),de.timezone!==void 0&&(_e.timezone=fw(de.timezone)),de.fillna!==void 0&&(_e.fillna=fu(de.fillna)),de.roundDigits!==void 0&&(_e.roundDigits=hw(de.roundDigits)),de.normalize!==void 0&&(_e.normalize=de.normalize),de.epsilon!==void 0&&(_e.epsilon=fu(de.epsilon)),de.allowOverwrite!==void 0&&(_e.allowOverwrite=de.allowOverwrite),de.description!==void 0){const St=typeof de.description=="string"?de.description.trim():"";_e.description=St||void 0}const dt=_e.type,At=N0(dt);return At.length?new Set(At.map(tn=>tn.value)).has(_e.method)||(_e.method=At[0].value):dt==="ratio"?_e.method="ratio":dt==="datetime_extract"&&(_e.method="datetime_extract"),_e.inputColumns=hu(_e.inputColumns),dt==="ratio"||dt==="similarity"?_e.secondaryColumns=hu(_e.secondaryColumns):_e.secondaryColumns=[],_e.constants=dw(_e.constants),_e.fillna=fu(_e.fillna),_e.roundDigits=hw(_e.roundDigits),_e.epsilon=fu(_e.epsilon),dt==="datetime_extract"?(_e.datetimeFeatures=mw(_e.datetimeFeatures),_e.timezone=fw(_e.timezone)):(_e.datetimeFeatures=[],_e.timezone="UTC"),dt!=="similarity"?_e.normalize=!1:_e.normalize=!!_e.normalize,typeof _e.allowOverwrite!="boolean"&&(_e.allowOverwrite=null),_e.outputColumn=_e.outputColumn.trim(),_e.outputPrefix=_e.outputPrefix.trim(),_e}))},[Q,cr]),Pf=v.useCallback(()=>{if(!M)return;const ve=na;Xn(de=>{var At;const pe=new Set;de.forEach(St=>{St.columns.forEach(tn=>{const on=tn.trim();on&&pe.add(on)})});const we=ya.recommendedColumns.find(St=>!pe.has(St)),dt={mode:de.length?de[de.length-1].mode:((At=Ex[0])==null?void 0:At.value)??sg,columns:we?[we]:[],autoDetect:!we};return[...de,dt]}),ys(de=>{const pe=new Set(de);return pe.delete(ve),pe})},[ya.recommendedColumns,na,M,ys,Xn]),Ur=v.useCallback(ve=>{Xn(de=>de.filter((pe,we)=>we!==ve)),ys(de=>{const pe=new Set;return de.forEach(we=>{we!==ve&&pe.add(we>ve?we-1:we)}),pe})},[ys,Xn]),y_=v.useCallback(ve=>{ys(de=>{const pe=new Set(de);return pe.has(ve)?pe.delete(ve):pe.add(ve),pe})},[]),Tf=v.useCallback((ve,de)=>{Xn(pe=>pe.map((we,_e)=>_e===ve?{...we,mode:de}:we))},[Xn]),$f=v.useCallback((ve,de)=>{const pe=de.trim();pe&&Xn(we=>we.map((_e,dt)=>{if(dt!==ve)return _e;const St=_e.columns.includes(pe)?_e.columns.filter(tn=>tn!==pe):[..._e.columns,pe];return St.sort((tn,on)=>tn.localeCompare(on)),{..._e,columns:St}}))},[Xn]),Lf=v.useCallback((ve,de)=>{const pe=de.split(",").map(_e=>_e.trim()).filter(Boolean),we=Array.from(new Set(pe)).sort((_e,dt)=>_e.localeCompare(dt));Xn(_e=>_e.map((dt,At)=>At===ve?{...dt,columns:we}:dt))},[Xn]),zf=v.useCallback((ve,de)=>{Xn(pe=>pe.map((we,_e)=>_e===ve?{...we,autoDetect:de}:we))},[Xn]),ia=v.useCallback(ve=>a.jsx(FL,{parameter:ve,previewStateStatus:wn.status,isBinningNode:J,isScalingNode:se,binningAllNumericColumns:en,binningRecommendedColumnSet:wa,selectedColumns:Os,availableColumns:ss,scalingExcludedColumns:Ho,normalizedColumnSearch:Ko,filteredColumnOptions:cf,binningExcludedColumns:jn,selectionCount:jc,isCastNode:ee,columnSuggestions:Pu,sourceId:l,isFetchingRecommendations:Zr,hasReachableSource:bt,refreshRecommendations:Du,availableFilters:Tu,activeFilterId:$u,setActiveFilterId:Lu,recommendations:Bl,filteredRecommendations:hh,recommendationsError:Xi,relativeGeneratedAt:Ad,formatSignalName:fh,handleToggleColumn:la,handleRemoveColumn:Md,handleApplyAllRecommended:yc,handleBinningApplyColumns:vd,handleSelectAllColumns:kd,handleClearColumns:bc,columnSearch:Lo,setColumnSearch:Gi,columnMissingMap:zo,columnTypeMap:Ba,binningColumnPreviewMap:Zl,isImputerNode:j,showRecommendations:no}),[$u,ss,Tu,zo,Lo,Pu,Ba,en,Xa,cf,hh,fh,yc,vd,bc,Md,kd,la,bt,ee,Zr,J,wa,Zl,j,se,jn,wn.status,Bl,Xi,Ad,Os,jc,Lu,Gi,Ho,no,l,Du,Ko]),zt=v.useCallback(ve=>a.jsx(RL,{parameter:ve,nodeId:e.id,configState:Xe,handleNumberChange:eh,handleBooleanChange:th,handleTextChange:Mu,thresholdParameterName:as,normalizedSuggestedThreshold:os,showRecommendations:no,canApplySuggestedThreshold:Sd,thresholdMatchesSuggestion:Cd,handleApplySuggestedThreshold:Ed,renderMultiSelect:ia}),[Sd,Xe,Ed,th,eh,Mu,e.id,os,ia,no,Cd,as]),zd=v.useCallback(ve=>{In(de=>({...de,keep:ve}))},[In]);return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(cM,{title:h,isDataset:et,onClose:t,canResetNode:$n,onResetNode:wc}),a.jsxs("div",{className:"canvas-modal__body",children:[f&&a.jsx(f$,{connectionInfo:f,connectedInputHandles:g,connectedOutputHandles:w,connectionReady:b}),bf&&a.jsx(Vk,{thresholdParameter:to??null,dropIfAnyParameter:Qm,renderParameterField:zt}),tt&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),to&&zt(to),ia(tt)]}),S&&a.jsxs(a.Fragment,{children:[a.jsx(JM,{suffix:Io,insights:oc,formatMissingPercentage:ms}),(Cu||Su)&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[Cu?zt(Cu):null,Su?zt(Su):null]})]})]}),Wl&&a.jsx(aM,{previewState:wn,datasetSourceId:l??null,canTriggerPreview:Wu,onRefresh:Ut,formatCellValue:z0,formatMetricValue:gr,formatMissingPercentage:ms,formatNumericStat:Gs,formatModeStat:gx}),a.jsx(lM,{isDatasetProfileNode:Hu,controller:Vu,formatCellValue:z0,formatNumericStat:Gs,formatMissingPercentage:ms}),Wt&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",children:[a.jsxs("strong",{children:[Wt.title,"."]})," ",Wt.body]})}),$&&a.jsx(rO,{sourceId:l,hasReachableSource:bt,columnsParameter:_t,modeParameter:es,renderMultiSelectField:ia,renderParameterField:zt,columnSummary:ar,modeDetails:Ga,sampleMap:or}),T&&a.jsx(jO,{sourceId:l,hasReachableSource:bt,columnsParameter:cn,modeParameter:En,replacementParameter:yt,renderMultiSelectField:ia,renderParameterField:zt,columnSummary:sa,modeDetails:Qa,sampleMap:ra}),L&&a.jsx(kP,{sourceId:l,hasReachableSource:bt,columnsParameter:Zs,modeParameter:nn,minValueParameter:jt,maxValueParameter:kt,renderMultiSelectField:ia,renderParameterField:zt,columnSummary:cc,modeDetails:Zu,sampleMap:zh,selectedMode:Ju,minValue:Dh,maxValue:Uo}),P&&a.jsx(rP,{sourceId:l,hasReachableSource:bt,columnsParameter:Cs,modeParameter:vn,patternParameter:Ln,replacementParameter:yn,renderMultiSelectField:ia,renderParameterField:zt,columnSummary:Th,modeDetails:Xu,sampleMap:Qu,selectedMode:Us,replacementValue:qs}),O&&a.jsx(IO,{sourceId:l,hasReachableSource:bt,columnsParameter:Vn,modeParameter:bn,renderMultiSelectField:ia,renderParameterField:zt,columnSummary:sn,modeDetails:$h,sampleMap:Cr,selectedMode:Lh}),Q&&a.jsx(KP,{operations:zl,summaries:Dr,collapsed:sc,onToggleCollapsed:Of,onAddOperation:Jn,onDuplicateOperation:Er,onRemoveOperation:ja,onReorderOperation:Af,onOperationChange:kr,availableColumns:ss,signals:zr,previewStatus:wn.status,errorHandlingParameter:_s,allowOverwriteParameter:Co,defaultTimezoneParameter:Al,epsilonParameter:Ct,renderParameterField:zt}),G&&a.jsx(iT,{sourceId:l,hasReachableSource:bt,isFetching:Iu,error:Bu,suggestions:e_,metadata:t_,columnsParameter:Eo,autoDetectParameter:rr,maxCategoriesParameter:ko,outputSuffixParameter:Da,dropOriginalParameter:Mo,encodeMissingParameter:Ao,handleUnknownParameter:Oo,unknownValueParameter:Po,selectedColumns:Os,renderParameterField:zt,onToggleColumn:la,onApplyRecommended:tc,formatMissingPercentage:ms}),z&&a.jsx(ZP,{sourceId:l,hasReachableSource:bt,isFetching:Zi,error:gh,suggestions:_h,metadata:vh,columnsParameter:Xt,targetColumnParameter:Rn,autoDetectParameter:nr,maxCategoriesParameter:sr,outputSuffixParameter:wr,dropOriginalParameter:ga,smoothingParameter:Lr,encodeMissingParameter:vs,handleUnknownParameter:Is,selectedColumns:Os,renderParameterField:zt,onToggleColumn:la,onApplyRecommended:qu,formatMissingPercentage:ms}),q&&a.jsx(dT,{sourceId:l,hasReachableSource:bt,isFetching:ql,error:n_,suggestions:xh,metadata:wh,columnsParameter:Gn,autoDetectParameter:un,maxCategoriesParameter:To,dropFirstParameter:Ra,includeMissingParameter:ju,dropOriginalParameter:$l,prefixSeparatorParameter:dn,selectedColumns:Os,renderParameterField:zt,onToggleColumn:la,onApplyRecommended:Ro,formatMissingPercentage:ms}),Y&&a.jsx(fT,{sourceId:l,hasReachableSource:bt,isFetching:Zt,error:Uu,suggestions:ec,metadata:Hl,columnsParameter:Fn,autoDetectParameter:As,maxCategoriesParameter:Vi,dropFirstParameter:Hg,includeMissingParameter:Vg,dropOriginalParameter:Wg,prefixSeparatorParameter:Nu,selectedColumns:Os,renderParameterField:zt,onToggleColumn:la,onApplyRecommended:Nh,formatMissingPercentage:ms}),U&&a.jsx(wT,{nodeId:ct,sourceId:l,hasReachableSource:bt,previewState:wn,onRefreshPreview:Ut,config:rh,targetColumnParameter:So,renderParameterField:zt,formatMetricValue:gr,formatMissingPercentage:ms}),V&&a.jsx(NT,{nodeId:ct,sourceId:l,hasReachableSource:bt,previewState:wn,onRefreshPreview:Ut,config:ah,parameters:ot,renderParameterField:zt,formatMetricValue:gr}),it&&a.jsx($2,{mode:re?"oversampling":"undersampling",sourceId:l,hasReachableSource:bt,previewState:wn,onRefreshPreview:Ut,config:Ll,methodParameter:Ui,targetColumnParameter:Ol,samplingStrategyParameter:Pl,randomStateParameter:qi,kNeighborsParameter:re?Hi:null,replacementParameter:K?Tl:null,renderParameterField:zt,formatMetricValue:gr,formatMissingPercentage:ms,schemaGuard:Jg}),(B||F)&&a.jsx(MT,{sourceId:l,hasReachableSource:bt,previewState:wn,onRefreshPreview:Ut,config:Ki,targetColumnParameter:xr,problemTypeParameter:Z,renderParameterField:zt,formatMetricValue:gr,formatMissingPercentage:ms,schemaColumns:Rl}),B&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(WT,{nodeId:ct,sourceId:l,graph:Bs,config:Ki,runtimeConfig:Au,cvConfig:Ia,draftConfigState:Xe,renderParameterField:zt,modelTypeParameter:ge,modelTypeOptions:oh,hyperparametersParameter:he,cvEnabledParameter:Ke,cvStrategyParameter:vt,cvFoldsParameter:ft,cvShuffleParameter:nt,cvRandomStateParameter:Pt,cvRefitStrategyParameter:Yn,onSaveDraftConfig:xc})}),X&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(t2,{nodeId:ct,sourceId:l,graph:Bs,config:Xe,setConfigState:In,renderParameterField:zt,formatMetricValue:gr,connectedSplitHandles:y})}),H&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(y2,{nodeId:ct,sourceId:l,graph:Bs,parameters:ot,config:Gg,renderParameterField:zt})}),F&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(A2,{nodeId:ct,sourceId:l,graph:Bs,config:Ki,runtimeConfig:Au,cvConfig:Ia,draftConfigState:Xe,renderParameterField:zt,modelTypeParameter:ge,modelTypeOptions:oh,searchStrategyParameter:ze,searchIterationsParameter:Oe,searchRandomStateParameter:Ce,scoringMetricParameter:lt,setDraftConfigState:In,onSaveDraftConfig:xc})}),W&&a.jsx(QP,{sourceId:l,hasReachableSource:bt,isFetching:Ji,error:Do,suggestions:Ru,metadata:ph,columnsParameter:Ss,autoDetectParameter:Yt,maxUniqueParameter:ts,outputSuffixParameter:Wn,dropOriginalParameter:zn,missingStrategyParameter:Tr,missingCodeParameter:fs,selectedColumns:Os,renderParameterField:zt,onToggleColumn:la,onApplyRecommended:jh,formatMissingPercentage:ms}),R&&a.jsx(nT,{sourceId:l,hasReachableSource:bt,isFetching:Fu,error:yh,suggestions:bh,metadata:_a,columnsParameter:er,autoDetectParameter:Rs,maxCategoriesParameter:Fs,bucketsParameter:yr,outputSuffixParameter:ps,dropOriginalParameter:rn,encodeMissingParameter:It,selectedColumns:Os,renderParameterField:zt,onToggleColumn:la,onApplyRecommended:Vl,formatMissingPercentage:ms}),ke&&a.jsx(sT,{columnsParameter:ht,autoDetectParameter:$r,degreeParameter:ns,includeBiasParameter:br,interactionOnlyParameter:Es,includeInputFeaturesParameter:Jr,outputPrefixParameter:le,renderParameterField:zt,signal:kh}),Pe&&a.jsx(aT,{columnsParameter:xe,autoDetectParameter:Ue,targetColumnParameter:$t,methodParameter:Ee,scoreFuncParameter:ut,problemTypeParameter:gt,kParameter:Kt,percentileParameter:Bt,alphaParameter:hn,thresholdParameter:Qt,modeParameter:xn,estimatorParameter:tr,stepParameter:gs,minFeaturesParameter:Dn,maxFeaturesParameter:Kn,dropUnselectedParameter:ks,renderParameterField:zt,signal:Ua}),D&&a.jsx(IA,{hasSource:!!l,hasReachableSource:bt,strategies:ed,columnSummary:qo,columnOptions:Rh,sampleMap:Gl,collapsedStrategies:nc,onToggleStrategy:$d,onRemoveStrategy:Sc,onAddStrategy:ai,onModeChange:Ef,onColumnToggle:Mf,onColumnsChange:kf,onAutoDetectToggle:Ld,modeOptions:lg}),M&&a.jsx(CA,{hasSource:!!l,hasReachableSource:bt,strategies:a_,columnSummary:ya,columnOptions:ic,sampleMap:lc,customPairSummary:Bo,customPairsParameter:Gt,collapsedStrategies:nc,onToggleStrategy:y_,onRemoveStrategy:Ur,onAddStrategy:Pf,onModeChange:Tf,onAutoDetectToggle:zf,onColumnToggle:$f,onColumnsChange:Lf,renderParameterField:zt}),j&&a.jsx(RM,{hasSource:!!l,hasReachableSource:bt,strategies:Wi,columnOptions:gf,methodOptions:at,missingFilter:dh,missingFilterMax:_f,missingFilterActive:yf,filteredOptionCount:vf,collapsedStrategies:nc,onToggleStrategy:p_,onRemoveStrategy:ls,onAddStrategy:ri,onMethodChange:g_,onOptionNumberChange:Cc,onColumnsChange:is,onColumnToggle:__,onMissingFilterChange:He,formatMissingPercentage:ms,formatNumericStat:Gs,formatModeStat:gx,schemaDiagnostics:Yi}),ee&&a.jsx(Qk,{configState:Xe,setConfigState:In,availableColumns:ss,columnTypeMap:Ba,columnSuggestions:Pu,selectedColumns:Os,previewColumns:ac,previewStatus:wn.status,sourceId:l,hasReachableSource:bt}),Be&&a.jsx(m$,{sourceId:l,hasReachableSource:bt,isFetchingOutliers:Ku,outlierConfig:aa,outlierMethodOptions:od,outlierMethodDetailMap:ba,outlierDefaultDetail:qh,outlierAutoDetectEnabled:Hh,outlierSelectedCount:oa,outlierDefaultLabel:hc,outlierOverrideCount:xa,outlierParameterOverrideCount:mc,outlierOverrideExampleSummary:ld,outlierHasOverrides:Za,outlierRecommendationRows:Uh,outlierHasRecommendations:Ql,outlierStatusMessage:Fr,outlierError:ea,outlierSampleSize:Xl,relativeOutlierGeneratedAt:Jl,outlierPreviewSignal:lf,formatMetricValue:gr,formatNumericStat:Gs,onApplyAllRecommendations:ni,onClearOverrides:ir,onDefaultMethodChange:fd,onAutoDetectToggle:Ir,onOverrideSelect:pd,onMethodParameterChange:gd,onColumnParameterChange:Wh}),se&&a.jsx(FM,{sourceId:l,hasReachableSource:bt,isFetchingScaling:Fo,scalingConfig:Ih,scalingMethodOptions:Vo,scalingMethodDetailMap:dc,scalingDefaultDetail:rd,scalingAutoDetectEnabled:lr,scalingSelectedCount:nd,scalingDefaultLabel:Wo,scalingOverrideCount:sd,scalingOverrideExampleSummary:Bh,scalingRecommendationRows:td,scalingHasRecommendations:Ja,scalingStatusMessage:ad,scalingError:qa,scalingSampleSize:xf,relativeScalingGeneratedAt:Od,formatMetricValue:gr,formatNumericStat:Gs,formatMissingPercentage:ms,onApplyAllRecommendations:md,onClearOverrides:rs,onDefaultMethodChange:ti,onAutoDetectToggle:o_,onOverrideSelect:hd}),J&&a.jsxs(a.Fragment,{children:[a.jsx(EM,{hasSource:!!l,hasReachableSource:bt,isFetching:Va,error:Yu,relativeGeneratedAt:Nc,sampleSize:Pd,binningConfig:eo,binningDefaultLabel:Vh,binningOverrideCount:id,binningOverrideSummary:an,recommendations:dd,excludedColumns:ei,numericColumnCount:en.length,canApplyAllNumeric:kn,onApplyAllNumeric:yd,onApplyStrategies:rf,onClearOverrides:sf,customEdgeDrafts:cd,customLabelDrafts:ud,onOverrideStrategyChange:pc,onOverrideNumberChange:gc,onOverrideKbinsEncodeChange:tf,onOverrideKbinsStrategyChange:_d,onOverrideClear:nf,onCustomBinsChange:Zh,onCustomLabelsChange:si,onClearCustomColumn:ef,formatMetricValue:gr,formatNumericStat:Gs}),a.jsx(NM,{config:eo,fieldIds:fc,onIntegerChange:Kh,onBooleanToggle:Yh,onSuffixChange:Gh,onLabelFormatChange:Qh,onMissingStrategyChange:Xh,onMissingLabelChange:Jh})]}),mt&&a.jsx(VM,{sourceId:l,hasReachableSource:bt,isFetchingSkewness:xs,skewnessThreshold:bd,skewnessError:Ka,skewnessViewMode:uf,skewnessRecommendedCount:Sr,skewnessNumericCount:xd,skewnessGroupByMethod:_c,skewnessRows:hf,skewnessTableGroups:ff,hasSkewnessAutoRecommendations:mf,skewnessTransformationsCount:vc,isFetchingRecommendations:Zr,getSkewnessMethodLabel:Yo,getSkewnessMethodStatus:jd,onApplyRecommendations:Nd,onViewModeChange:df,onGroupByToggle:c_,onOverrideChange:m_,onClearSelections:pf}),Ge&&a.jsx(KM,{skewnessThreshold:bd,isFetchingSkewness:xs,skewnessError:Ka,skewnessDistributionCards:wd,skewnessDistributionView:u_,setSkewnessDistributionView:d_,onRefresh:rc,canRefresh:Gu}),ue&&a.jsx(kM,{cards:v_,selectedPreset:Ch,onSelectPreset:ve=>s_(ve),isFetching:Qn,sampleSize:wf,relativeGeneratedAt:h_,error:va,onRefresh:Sf,canRefresh:!!l}),Le&&a.jsx(Yk,{sourceId:l,hasReachableSource:bt,removeDuplicatesColumnsParameter:ln,removeDuplicatesKeepParameter:Hn,renderMultiSelectField:ia,removeDuplicatesKeepSelectId:af,removeDuplicatesKeep:of,onKeepChange:zd}),ye&&Jm.length>0&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Data consistency settings"})}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Jm.map(ve=>zt(ve))})]}),De&&a.jsx(yT,{signal:l_,previewStatus:wn.status,hasSource:!!l,hasReachableSource:bt,onRefreshPreview:Ut}),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("h3",{children:"Node details"}),p.length?a.jsx("dl",{className:"canvas-modal__metadata",children:p.map((ve,de)=>a.jsxs("div",{className:"canvas-modal__metadata-row",children:[a.jsx("dt",{children:ve.label}),a.jsx("dd",{children:ve.value})]},`${ve.label}-${de}`))}):a.jsx("p",{className:"canvas-modal__empty",children:"No metadata available for this node."})]})]}),a.jsx(uM,{onClose:t,canResetNode:Ft,onResetNode:wc,showSaveButton:Br,canSave:f_,onSave:xc,isBusy:Nf,busyLabel:Cf})]})]})},jw=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],Aa=jw.map(e=>e.key),UL=jw.reduce((e,t)=>({...e,[t.key]:t.label}),{}),qL=e=>typeof e=="string"&&Aa.includes(e),Oa=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{qL(n)&&t.add(n)}),Aa.filter(n=>t.has(n))},Nw=(e,t)=>{const n=Oa(e),s=Oa(t);return n.length!==s.length?!1:n.every((l,i)=>l===s[i])},Cw=e=>!e||typeof e!="string"?null:Aa.find(t=>e.endsWith(`-${t}`))??null,Sw=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},HL={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},gu={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"train-in",label:"Train Split",position:20,required:!1,accepts:["train"]},{key:"test-in",label:"Test Split",position:40,required:!1,accepts:["test"]},{key:"validation-in",label:"Validation Split",position:60,required:!1,accepts:["validation"]},{key:"models-in",label:"Model",position:80,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},Ew=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:Sw(t,n),VL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,WL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,kw=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},Mw=28,Aw=320,KL=170,Ow="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",Pw="Drop columns",Tw=new Set(["transformer_audit"]),YL=e=>({width:`${Mw}px`,height:`${Mw}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),GL=({id:e,data:t,selected:n})=>{var j;const s=(t==null?void 0:t.label)??e,l=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),i=(t==null?void 0:t.isRemovable)??!l,c=(t==null?void 0:t.catalogType)==="train_test_split",u=l?"Primary dataset input":void 0,d=(t==null?void 0:t.description)??u,h=(t==null?void 0:t.catalogType)==="drop_missing_columns"||d===Ow?Pw:d,f=(t==null?void 0:t.backgroundExecutionStatus)??"idle",w=!((t==null?void 0:t.hasRequiredConnections)??!0),y=(t==null?void 0:t.catalogType)??"",b=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(y),x=v.useCallback(S=>{var M;S.stopPropagation(),(M=t==null?void 0:t.onRemoveNode)==null||M.call(t,e)},[t,e]),N=v.useMemo(()=>{if(l)return[];const S=(t==null?void 0:t.catalogType)??"",M=S?gu[S]:void 0;if(M!=null&&M.inputs&&M.inputs.length){const $=M.inputs.length;return M.inputs.map((T,L)=>({position:Re.Left,id:`${e}-${T.key}`,label:VL(T),style:{top:Ew(T,L,$)}}))}return[{position:Re.Left,id:`${e}-target`},{position:Re.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,l]),E=v.useMemo(()=>{if(l)return[{position:Re.Left,id:`${e}-source-left`},{position:Re.Right,id:`${e}-source`},{position:Re.Top,id:`${e}-source-top`},{position:Re.Bottom,id:`${e}-source-bottom`}];const S=(t==null?void 0:t.catalogType)??"",M=S?gu[S]:void 0;if(M!=null&&M.outputs&&M.outputs.length){const L=M.outputs.length;return M.outputs.map((P,O)=>({position:Re.Right,id:`${e}-${P.key}`,label:P.label,style:{top:Ew(P,O,L)}}))}const $=c?Aa:Oa((t==null?void 0:t.activeSplits)??[]),T=Oa((t==null?void 0:t.connectedSplits)??[]);if($.length){const L=$.length;return $.map((P,O)=>({position:Re.Right,id:`${e}-${P}`,style:{top:Sw(O,L)},label:(()=>{var W;const D=UL[P];if(c){if(P==="validation"&&!(Number(((W=t==null?void 0:t.config)==null?void 0:W.validation_size)??0)>0))return`${D} (disabled)`;if(!T.includes(P))return`${D} (not set)`}return D})()}))}return[{position:Re.Right,id:`${e}-source`},{position:Re.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(j=t==null?void 0:t.config)==null?void 0:j.validation_size,e,l,c]),k=v.useCallback((S,M)=>{const{position:$,id:T,style:L,label:P}=S,O=T.includes("-train")||T.includes("-test")||T.includes("-validation");return a.jsxs(be.Fragment,{children:[a.jsx(Yc,{type:M,position:$,id:T,className:`feature-node__handle feature-node__handle--${M}`,style:{...YL(M),...L??{},...O?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),P&&M==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(L==null?void 0:L.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:P}),P&&M==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(L==null?void 0:L.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:P})]},T)},[]);return a.jsxs("div",{className:`feature-node${n?" feature-node--selected":""}${l?" feature-node--dataset":""}`,children:[N.map(S=>k(S,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:s})]}),a.jsxs("div",{className:"feature-node__controls",children:[w&&b&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)"},children:""}),f==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:"Loading full dataset in background...",children:a.jsx("svg",{className:"feature-node__spinner",viewBox:"0 0 24 24",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60",strokeDashoffset:"30",strokeLinecap:"round"})})}),f==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",children:""}),f==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",children:"!"}),i&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:x,title:"Remove node",children:""})]})]}),h&&a.jsx("p",{className:"feature-node__description",children:h}),E.map(S=>k(S,"source"))]})},bl="__pending_confirmation__",QL=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],XL=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],Vm=e=>e&&typeof e=="object"&&!Array.isArray(e),_u=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},Wm=e=>typeof e=="string"&&Tw.has(e),Km=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",s=!Tw.has(n),l=c=>(s?c[bl]=!0:delete c[bl],c);if(t==null)return l({});const i=_u(t);if(!Vm(i))return l(i&&typeof i=="object"?i:{});switch(Object.entries(i).forEach(([c,u])=>{Array.isArray(u)?QL.some(p=>p.test(c))&&(i[c]=[]):Vm(u)&&XL.some(p=>p.test(c))&&(i[c]={})}),"auto_detect"in i&&(i.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.column_methods=Vm(i.column_methods)?i.column_methods:{},i.skipped_columns=Array.isArray(i.skipped_columns)?i.skipped_columns:[],i.default_method=typeof i.default_method=="string"&&i.default_method.trim()?i.default_method:"standard";break;case"polynomial_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.auto_detect=!!i.auto_detect,i.include_bias=!!i.include_bias,i.interaction_only=!!i.interaction_only,i.include_input_features=!!i.include_input_features,i.degree=typeof i.degree=="number"&&Number.isFinite(i.degree)?i.degree:2,i.output_prefix=typeof i.output_prefix=="string"&&i.output_prefix.trim()?i.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in i&&(i.missing_threshold=null),i.columns=Array.isArray(i.columns)?i.columns:[];break;case"drop_missing_rows":"missing_threshold"in i&&(i.missing_threshold=null),"drop_if_any_missing"in i&&(i.drop_if_any_missing=!1);break;case"outlier_removal":i.method="manual",i.columns=Array.isArray(i.columns)?i.columns:[],i.manual_bounds=Vm(i.manual_bounds)?i.manual_bounds:{};break;case"missing_value_indicator":i.columns=Array.isArray(i.columns)?i.columns:[];break;case"remove_duplicates":if(i.columns=Array.isArray(i.columns)?i.columns:[],typeof i.keep=="string"){const c=i.keep.trim().toLowerCase();i.keep=c==="last"||c==="none"?c:"first"}else i.keep="first";break}return l(i)},JL=(e,t)=>t==="drop_missing_columns"||e===Ow?Pw:e,ZL=e=>Array.isArray(e)?e.map(t=>({...t})):[],ez=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],tz=[],nz=e=>({...e,data:{...e.data??{}}}),Ym=()=>ez.map(e=>nz(e)),sz=()=>tz.map(e=>({...e})),rz=12,az=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},oz=(e,t,n)=>{if(!t||typeof t.project!="function"||!n)return;const s=n.getBoundingClientRect(),l=t.project({x:s.width/2,y:s.height/2});if(!l)return;const i=e.filter(f=>f.id!=="dataset-source").length,c=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],u=i%c.length,d=Math.floor(i/c.length),p=c[u],h=d+1;return{x:l.x+p.x*h,y:l.y+p.y*h}},lz=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),$w=(e,t)=>{if(!e)return!1;if(lz.has(e))return!0;const n=t==null?void 0:t.get(e);return n?(typeof n.category=="string"?n.category.toLowerCase():"").includes("preprocess"):!1},Lw=(e,t)=>{var j,S,M,$,T,L;const{handleOpenSettings:n,handleRemoveNode:s,catalogEntryMap:l}=t,i=e.data??{},c=i.isDataset??e.id==="dataset-source",u={...e.style??{}},d=i.catalogType??i.type??e.id;let h=Array.isArray(i.parameters)?i.parameters:null;if((!h||h.length===0)&&typeof d=="string"){const P=l.get(d)??null;(j=P==null?void 0:P.parameters)!=null&&j.length&&(h=P.parameters)}const f=ZL(h);let g;if(f.length||i.config&&typeof i.config=="object"){const P=_u(i.config);f.forEach(O=>{O!=null&&O.name&&P[O.name]===void 0&&O.default!==void 0&&(Array.isArray(O.default)?P[O.name]=[...O.default]:O.type==="boolean"?P[O.name]=!!O.default:P[O.name]=O.default)}),g=P}u.width||(u.width=c?Aw+20:Aw),u.minHeight||(u.minHeight=KL),u.padding||(u.padding=12),u.borderRadius||(u.borderRadius=16),u.boxSizing=u.boxSizing??"border-box",u.whiteSpace=u.whiteSpace??"pre-line",u.background||(u.background=c?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),u.border||(u.border=c?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),u.boxShadow||(u.boxShadow=c?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),u.color||(u.color=c?"#e0f2fe":"#e2e8f0"),u.fontWeight||(u.fontWeight=c?600:500);const w=JL(i.description,d),y=Wm(d),b=g??(i.config&&typeof i.config=="object"?_u(i.config):void 0);b&&typeof b=="object"&&y&&delete b[bl];const x={...i,label:i.label??e.id,description:w,isDataset:c,isRemovable:i.isRemovable??!c,isConfigured:c||i.isConfigured===!0?!0:i.config&&typeof i.config=="object"?y?!0:!i.config[bl]:!1,inputs:Array.isArray(i.inputs)?[...i.inputs]:i.inputs,outputs:Array.isArray(i.outputs)?[...i.outputs]:i.outputs,category:i.category,parameters:f,config:b,catalogType:d,onRemoveNode:s,onOpenSettings:n},N=typeof d=="string"?gu[d]:void 0;if(N){const P=((S=N.inputs)==null?void 0:S.map(D=>WL(D)))??[],O=((M=N.outputs)==null?void 0:M.map(D=>D.label))??[];P.length?x.inputs=P:delete x.inputs,O.length?x.outputs=O:delete x.outputs,x.connectionInfo={inputs:(($=N.inputs)==null?void 0:$.map(D=>({...D})))??[],outputs:((T=N.outputs)==null?void 0:T.map(D=>({...D})))??[]}}else(!x.inputs||x.inputs.length===0)&&delete x.inputs,(!x.outputs||x.outputs.length===0)&&delete x.outputs,delete x.connectionInfo;const E=Oa(x.activeSplits);E.length?x.activeSplits=E:delete x.activeSplits;const k=Oa(x.connectedSplits);return k.length?x.connectedSplits=k:delete x.connectedSplits,d==="train_test_split"&&(x.activeSplits=[...Aa],k.length||delete x.connectedSplits),(L=x.parameters)!=null&&L.length||delete x.parameters,x.config===void 0&&delete x.config,{...e,type:"featureNode",position:e.position??{x:0,y:0},data:x,style:u}},iz=(e,t,n,s,l)=>{const i=(e==null?void 0:e.label)??(e==null?void 0:e.type)??s,c=typeof i=="string"&&i.trim()?i:s,u=Km(e),d=Wm((e==null?void 0:e.type)??null);return Lw({id:t,type:"featureNode",position:n,data:{label:c,description:e==null?void 0:e.description,inputs:e==null?void 0:e.inputs,outputs:e==null?void 0:e.outputs,category:e==null?void 0:e.category,parameters:e==null?void 0:e.parameters,config:u,catalogType:e==null?void 0:e.type,isConfigured:!!d}},l)},cz=(e,t)=>{const n=e.map(l=>{const{data:i,...c}=l,u=i?{...i}:void 0;return u&&(delete u.onRemoveNode,delete u.onOpenSettings),JSON.parse(JSON.stringify({...c,data:u}))}),s=t.map(l=>JSON.parse(JSON.stringify(l)));return{nodes:n,edges:s}},uz=()=>{var h;const[e,t]=v.useState(!1),n=v.useRef(new Map),s=mr({queryKey:["feature-canvas","node-catalog"],queryFn:Ub,staleTime:5*60*1e3}),l=s.data??[],i=s.isLoading||s.isFetching,c=s.error?((h=s.error)==null?void 0:h.message)??"Unable to load node catalog":null;v.useEffect(()=>{const f=new Map;l.forEach(g=>{g&&typeof g.type=="string"&&g.type.trim()&&f.set(g.type,g)}),n.current=f},[l]);const u=v.useCallback(()=>t(!0),[]),d=v.useCallback(()=>t(!1),[]),p=v.useCallback(()=>t(f=>!f),[]);return{nodeCatalog:l,catalogEntryMapRef:n,isCatalogOpen:e,openCatalog:u,closeCatalog:d,toggleCatalog:p,isCatalogLoading:i,catalogErrorMessage:c}},Gm=e=>!e||!e.length?"":e.join(", "),dz=({nodes:e,onAddNode:t})=>{const[n,s]=v.useState(""),[l,i]=v.useState([]),c=n.trim().toLowerCase(),u=v.useMemo(()=>c?e.filter(g=>{const w=[g.label,g.type,g.description];return g.category&&w.push(g.category),g.tags&&g.tags.length&&w.push(g.tags.join(" ")),w.some(y=>y==null?void 0:y.toLowerCase().includes(c))}):e,[e,c]),d=v.useMemo(()=>{const g=new Map;return u.forEach(w=>{var x;const y=((x=w.category)==null?void 0:x.trim())||"Other",b=g.get(y)??[];b.push(w),g.set(y,b)}),Array.from(g.entries()).sort(([w],[y])=>w.localeCompare(y)).map(([w,y])=>({category:w,entries:y.sort((b,x)=>(b.label||b.type).localeCompare(x.label||x.type))}))},[u]);v.useEffect(()=>{if(!c){i([]);return}i(g=>{const w=new Set(g);let y=!1;return d.forEach(({category:b})=>{w.has(b)||(w.add(b),y=!0)}),y?Array.from(w):g})},[d,c]);const p=g=>{i(w=>{const y=new Set(w);return y.has(g)?y.delete(g):y.add(g),Array.from(y)})},h=u.length,f=h>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsx("h3",{children:"Available steps"}),a.jsxs("div",{className:"feature-canvas-sidebar__search",children:[a.jsx("input",{type:"search",value:n,onChange:g=>s(g.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps"}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>s(""),"aria-label":"Clear search",children:""})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",h," ",h===1?"step":"steps",c?` matching ${n.trim()}`:""]})]}),f?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:d.map(({category:g,entries:w})=>{const y=l.includes(g);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>p(g),"aria-expanded":y,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:g.charAt(0).toUpperCase()+g.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[w.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":y,children:""})]})]}),y&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:w.map(b=>{var x,N;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(b),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:b.label||b.type}),b.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:b.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(x=b.inputs)!=null&&x.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${Gm(b.inputs)}`,children:["In: ",Gm(b.inputs)]}):null,(N=b.outputs)!=null&&N.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${Gm(b.outputs)}`,children:["Out: ",Gm(b.outputs)]}):null,b.parameters&&b.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",children:[b.parameters.length," param",b.parameters.length>1?"s":""]}):null]})]})},b.type)})})]},g)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})},mz=({nodeCatalog:e,isCatalogLoading:t,catalogErrorMessage:n,handleAddNode:s})=>({sidebarContent:v.useMemo(()=>t?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):n?a.jsx("p",{className:"text-danger",children:n}):e.length?a.jsx(dz,{nodes:e,onAddNode:s}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[n,s,t,e])}),hz=({setNodes:e,setEdges:t,setSelectedNodeId:n,setIsSettingsModalOpen:s,catalogEntryMapRef:l,handleOpenSettings:i,reactFlowInstanceRef:c,canvasViewportRef:u,scheduleFitView:d})=>{const p=v.useRef(0),h=v.useCallback(k=>{k!=="dataset-source"&&(e(j=>j.filter(S=>S.id!==k)),t(j=>j.filter(S=>S.source!==k&&S.target!==k)),n(j=>j===k?(s(!1),null):j))},[t,s,e,n]),f=v.useCallback(k=>Lw(k,{handleOpenSettings:i,handleRemoveNode:h,catalogEntryMap:l.current}),[l,i,h]),g=v.useCallback(k=>{const j=k.reduce((S,M)=>{if(typeof M.id=="string"&&M.id.startsWith("node-")){const $=Number(M.id.replace("node-",""));if(!Number.isNaN($))return Math.max(S,$)}return S},0);j>p.current&&(p.current=j)},[]),w=v.useCallback((k,j)=>{const S=p.current+1,M=`node-${S}`;p.current=S;const $=j??{x:160+(S-1)%4*220,y:40+Math.floor((S-1)/4)*160};return f(iz(k??null,M,$,`Step ${S}`,{handleOpenSettings:i,handleRemoveNode:h,catalogEntryMap:l.current}))},[l,i,h,f]),y=v.useCallback(k=>{e(j=>{const S=oz(j,c.current,u.current),M=w(k,S);return[...j,M]}),d()},[u,w,c,d,e]),b=v.useCallback((k,j)=>{e(S=>S.map(M=>{if(M.id!==k)return M;const $=_u(j);$&&typeof $=="object"&&delete $[bl];const T={...M.data??{},config:$,isConfigured:!0};return f({...M,data:T})}))},[f,e]),x=v.useCallback((k,j)=>{e(S=>S.map(M=>{if(M.id!==k)return M;const $={...M.data??{},...j};return f({...M,data:$})}))},[f,e]),N=v.useCallback((k,j)=>{e(S=>S.map(M=>{var O;if(M.id!==k)return M;const $=(O=M==null?void 0:M.data)==null?void 0:O.catalogType,T=$?l.current.get($)??null:null,L=j&&typeof j=="object"?_u(j):Km(T??null),P={...M.data??{},config:L,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...M,data:P})}))},[l,f,e]),E=v.useCallback(()=>{e(k=>k.map(j=>{var L,P;if(!$w((L=j==null?void 0:j.data)==null?void 0:L.catalogType,l.current))return j;const S=(P=j==null?void 0:j.data)==null?void 0:P.catalogType,M=S?l.current.get(S)??null:null,$=Km(M??null),T={...j.data??{},config:$,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...j,data:T})}))},[l,f,e]);return{registerNode:f,createNode:w,handleAddNode:y,handleRemoveNode:h,handleUpdateNodeConfig:b,handleUpdateNodeData:x,handleResetNodeConfig:N,handleResetAllNodes:E,updateNodeCounter:g}},fz=({sourceId:e,datasetDisplayLabel:t,registerNode:n,prepareNodes:s,setNodes:l,setEdges:i,updateNodeCounter:c,scheduleFitView:u,onPipelineHydrated:d,onPipelineError:p})=>{const h=v.useRef(!1),f=mr({queryKey:["feature-canvas","pipeline",e],queryFn:()=>nx(e),enabled:!!e,staleTime:60*1e3,retry:1});return v.useEffect(()=>{const g=`Dataset input
(${t})`;if(!e){if(h.current)l(w=>{let y=!1;const b=w.map(x=>{var E;return x.id!=="dataset-source"||(((E=x==null?void 0:x.data)==null?void 0:E.label)??"")===g?x:(y=!0,n({...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}))});return y?b:w});else{const w=az(t),y=s(w.nodes);h.current=!0,l(y),i(w.edges),c(y),u(),d==null||d({nodes:y,edges:w.edges,pipeline:null,context:"sample"})}return}if(h.current=!1,f.isLoading){l(w=>w.map(y=>y.id==="dataset-source"?n({...y,data:{...y.data??{},label:g,isDataset:!0,isRemovable:!1}}):y));return}if(f.isError){const w=f.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",w),p==null||p(w);const y=Ym().map(x=>x.id==="dataset-source"?{...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}:x),b=s(y);l(b),i([]),c(b),u(),d==null||d({nodes:b,edges:[],pipeline:null,context:"reset"});return}if(f.data){const w=f.data.graph??{},y=Array.isArray(w==null?void 0:w.nodes)&&w.nodes.length?w.nodes:Ym(),b=s(y),N=(Array.isArray(w==null?void 0:w.edges)?w.edges:[]).map(E=>{var P;const k=E==null?void 0:E.type,j=!k||k==="smoothstep"||k==="default"?"animatedEdge":k,S=E==null?void 0:E.source,M=E==null?void 0:E.target,$=b.find(O=>O.id===M),T=(E==null?void 0:E.sourceHandle)??(S?`${S}-source`:void 0),L=(E==null?void 0:E.targetHandle)??((P=$==null?void 0:$.data)!=null&&P.isDataset?void 0:M?`${M}-target`:void 0);return{...E,animated:(E==null?void 0:E.animated)??!0,type:j,sourceHandle:T,targetHandle:L}});l(b),i(N),c(b),u(),d==null||d({nodes:b,edges:N,pipeline:f.data??null,context:"stored"});return}if(f.isFetched&&!f.data){const w=Ym().map(b=>b.id==="dataset-source"?{...b,data:{...b.data??{},label:g,isDataset:!0,isRemovable:!1}}:b),y=s(w);l(y),i([]),c(y),u(),d==null||d({nodes:y,edges:[],pipeline:null,context:"sample"})}},[t,d,p,f.data,f.error,f.isError,f.isFetched,f.isLoading,s,n,u,i,l,e,c]),{isPipelineLoading:f.isLoading||f.isFetching}},pz=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),gz=e=>{var n;const t=e?gu[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(s=>s.required!==!1).map(s=>s.key):[]},_z=(e,t,n)=>{const s=gz(t);if(s.length===0)return!0;const l=n.filter(c=>c.target===e),i=new Set(l.map(c=>kw(e,c.targetHandle)).filter(c=>!!c));return s.every(c=>i.has(c))},vz=(e,t)=>{const n=new Map,s=new Set;e.forEach(d=>{var h;const p=(h=d==null?void 0:d.data)==null?void 0:h.catalogType;if(p&&pz.has(p)){s.add(d.id);return}p==="train_test_split"&&n.set(d.id,new Set(Aa))});let l=!0,i=0;const c=e.length*3;for(;l&&i<c;)l=!1,i++,t.forEach(d=>{if(s.has(d.source)||s.has(d.target))return;const p=n.get(d.source),h=Cw(d.sourceHandle);if(!p||p.size===0)return;n.has(d.target)||n.set(d.target,new Set);const f=n.get(d.target),g=f.size;h?p.has(h)&&f.add(h):p.forEach(w=>f.add(w)),f.size>g&&(l=!0)});const u=new Map;return n.forEach((d,p)=>{!d.size||s.has(p)||u.set(p,Aa.filter(h=>d.has(h)))}),u},yz=e=>{const t=new Map;e.forEach(s=>{const l=Cw(s.sourceHandle);l&&(t.has(s.source)||t.set(s.source,new Set),t.get(s.source).add(l))});const n=new Map;return t.forEach((s,l)=>{n.set(l,Aa.filter(i=>s.has(i)))}),n},bz=({edges:e,setNodes:t,scheduleNodeInternalsUpdate:n})=>{v.useEffect(()=>{const s=[];t(l=>{const i=vz(l,e),c=yz(e);let u=!1;const d=l.map(p=>{var M,$,T,L,P;const f=((M=p==null?void 0:p.data)==null?void 0:M.catalogType)==="train_test_split"?[...Aa]:i.get(p.id)??[],g=Oa(($=p.data)==null?void 0:$.activeSplits),w=Oa(c.get(p.id)),y=Oa((T=p.data)==null?void 0:T.connectedSplits),b=((L=p==null?void 0:p.data)==null?void 0:L.catalogType)??"",x=_z(p.id,b,e),N=((P=p.data)==null?void 0:P.hasRequiredConnections)??!0,E=!Nw(g,f),k=!Nw(y,w);if(!E&&!k&&!(x!==N))return p;const S={...p.data,hasRequiredConnections:x};return f.length?S.activeSplits=f:delete S.activeSplits,w.length?S.connectedSplits=w:delete S.connectedSplits,(E||k)&&s.push(p.id),u=!0,{...p,data:S}});return u?d:l}),s.length&&n(s)},[e,n,t])},xz=({nodes:e,setEdges:t,scheduleNodeInternalsUpdate:n})=>{const s=v.useCallback(i=>{var w,y;const{source:c,target:u,sourceHandle:d,targetHandle:p}=i;if(!c||!u||!p||c===u)return!1;const h=e.find(b=>b.id===u);if(!h)return!1;const f=((w=h==null?void 0:h.data)==null?void 0:w.catalogType)??"",g=f?gu[f]:void 0;if((y=g==null?void 0:g.inputs)!=null&&y.length){const b=kw(u,p);if(!b)return!1;const x=g.inputs.find(N=>N.key===b);return!x||!d?!1:x.accepts&&x.accepts.length>0?x.accepts.some(N=>{const E=HL[N];return E?E(d):!1}):!0}return!0},[e]),l=v.useCallback(i=>{t(u=>vy({...i,type:"animatedEdge",animated:!0},u));const c=[i.source,i.target].filter(u=>!!u);c.length&&n(c)},[n,t]);return{isValidConnection:s,onConnect:l}},wz=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const l=Math.abs(n-e),i=Math.max(64,Math.min(l*.45,240)),c=Number.isFinite(i)?i:100,u=n>=e?1:-1,d=e+u*c,p=t,h=n-u*c;return`M ${e},${t} C ${d},${p} ${h},${s} ${n},${s}`},jz=({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:l,targetPosition:i})=>{const c=wz(e,t,n,s),u="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:u,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:s,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:s,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},Nz=({nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:l,onEdgesChange:i,onConnect:c,isValidConnection:u,onNodeClick:d,reactFlowInstanceRef:p,canvasViewportRef:h,handleResetAllNodes:f,openCatalog:g})=>a.jsxs("div",{className:"canvas-stage__viewport",ref:h,children:[a.jsxs(Fb,{style:{width:"100%",height:"100%"},nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:l,onEdgesChange:i,onConnect:c,isValidConnection:u,onNodeClick:d,onInit:w=>{p.current=w,requestAnimationFrame(()=>w.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:cl.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:jz,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(r1,{position:"bottom-left"}),a.jsx(c1,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:f,"aria-label":"Reset preprocessing nodes",children:""}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:g,"aria-label":"Open node catalog",children:"+"})]}),Cz=v.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:s,onPipelineError:l},i)=>{const c=v.useMemo(()=>({featureNode:GL}),[]),u=v.useMemo(()=>({animatedEdge:Lk}),[]),[d,p,h]=Ok(Ym().map(Ge=>({...Ge,type:"featureNode"}))),[f,g,w]=Pk(sz()),[y,b]=v.useState(null),[x,N]=v.useState(!1),E=v.useRef(null),k=v.useRef(null),j=v.useRef(!1),S=t??e??"Demo dataset",M=d1(),{nodeCatalog:$,catalogEntryMapRef:T,isCatalogOpen:L,openCatalog:P,closeCatalog:O,isCatalogLoading:D,catalogErrorMessage:W}=uz(),z=v.useCallback(Ge=>{const ue=(Array.isArray(Ge)?Ge:[Ge]).filter(Boolean);if(!ue.length)return;const ye=Array.from(new Set(ue));requestAnimationFrame(()=>{requestAnimationFrame(()=>{ye.forEach(Me=>{M(Me)})})})},[M]);bz({edges:f,setNodes:p,scheduleNodeInternalsUpdate:z});const R=v.useMemo(()=>d.find(Ge=>Ge.id===y)??null,[d,y]),U=v.useMemo(()=>cz(d,f),[f,d]),V=v.useCallback(Ge=>{b(Ge),N(!0)},[]),B=v.useCallback(()=>{N(!1),b(null)},[]),X=v.useCallback(()=>{j.current=!0},[]);v.useEffect(()=>{j.current&&(j.current=!1,requestAnimationFrame(()=>{var Ge;(Ge=E.current)==null||Ge.fitView({padding:.25,duration:350})}))},[f,d]);const{registerNode:H,handleAddNode:F,handleUpdateNodeConfig:K,handleUpdateNodeData:re,handleResetNodeConfig:G,handleResetAllNodes:q,updateNodeCounter:Y}=hz({setNodes:p,setEdges:g,setSelectedNodeId:b,setIsSettingsModalOpen:N,catalogEntryMapRef:T,handleOpenSettings:V,reactFlowInstanceRef:E,canvasViewportRef:k,scheduleFitView:X});v.useEffect(()=>{Y(d)},[d,Y]);const Q=v.useCallback(Ge=>Ge.map(ue=>{const ye={...ue.data??{}};ue.id==="dataset-source"&&(ye.label=`Dataset input
(${S})`,ye.isDataset=!0,ye.isRemovable=!1,ye.isConfigured=!0);const Me=ye.catalogType??ye.type??ue.id;return ye.config&&typeof ye.config=="object"&&Wm(Me)&&delete ye.config[bl],ye.isConfigured===void 0&&(ye.config&&typeof ye.config=="object"?ye.isConfigured=Wm(Me)?!0:!ye.config[bl]:ye.isConfigured=!0),H({...ue,data:ye})}),[S,H]),{isPipelineLoading:ee}=fz({sourceId:e,datasetDisplayLabel:S,registerNode:H,prepareNodes:Q,setNodes:p,setEdges:g,updateNodeCounter:Y,scheduleFitView:X,onPipelineHydrated:s,onPipelineError:l}),J=v.useCallback(()=>{p(Ge=>{const ue=Ge.find(Me=>Me.id==="dataset-source");return[H(ue?{...ue,data:{...ue.data??{},label:`Dataset input
(${S})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${S})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),g([]),b(null),N(!1),X()},[S,H,X,g,p,b,N]);v.useImperativeHandle(i,()=>({openCatalog:P,closeCatalog:O,clearGraph:J}),[J,O,P]);const{isValidConnection:se,onConnect:ke}=xz({nodes:d,setEdges:g,scheduleNodeInternalsUpdate:z});v.useEffect(()=>{n==null||n(d,f)},[f,d,n]);const Pe=v.useMemo(()=>{var ye;if(!R)return null;const Ge=(ye=R==null?void 0:R.data)==null?void 0:ye.catalogType;if(!Ge)return null;const ue=T.current.get(Ge);return ue?Km(ue):null},[R]),De=v.useMemo(()=>{var ue,ye;if(!R||(ue=R.data)!=null&&ue.isDataset)return!1;const Ge=(ye=R==null?void 0:R.data)==null?void 0:ye.catalogType;return $w(typeof Ge=="string"?Ge:null,T.current)},[R]),{sidebarContent:Be}=mz({nodeCatalog:$,isCatalogLoading:D,catalogErrorMessage:W,handleAddNode:F}),mt=v.useCallback((Ge,ue)=>{V(ue.id)},[V]);return a.jsxs("div",{className:"canvas-stage","data-pipeline-loading":ee?"true":"false","aria-busy":ee,children:[a.jsx(Nz,{nodes:d,edges:f,nodeTypes:c,edgeTypes:u,onNodesChange:h,onEdgesChange:w,onConnect:ke,isValidConnection:se,onNodeClick:mt,reactFlowInstanceRef:E,canvasViewportRef:k,handleResetAllNodes:q,openCatalog:P}),a.jsxs("div",{className:`canvas-drawer${L?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:O,"aria-label":"Close catalog",children:""})]}),a.jsx("div",{className:"canvas-drawer__body",children:Be})]}),L&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:O}),x&&R&&a.jsx(BL,{node:R,sourceId:e??null,graphSnapshot:U,onClose:B,onUpdateConfig:K,onUpdateNodeData:re,onResetConfig:G,defaultConfigTemplate:Pe,isResetAvailable:De})]})}),zw=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},Ig=e=>{const t=zw(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},Bg=e=>{const t=zw(e);if(!t)return null;const n=t.getTime(),s=Date.now()-n,l=Math.round(s/6e4);if(l<1)return"just now";if(l===1)return"1 minute ago";if(l<60)return`${l} minutes ago`;const i=Math.round(l/60);if(i===1)return"1 hour ago";if(i<24)return`${i} hours ago`;const c=Math.round(i/24);if(c===1)return"1 day ago";if(c<7)return`${c} days ago`;const u=Math.round(c/7);return u===1?"1 week ago":`${u} weeks ago`},Sz=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:l,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:y,historyErrorMessage:b,historyItems:x,activePipelineId:N,isDirty:E,isSaveDisabled:k,saveButtonLabel:j,saveFeedback:S,feedbackIcon:M,feedbackClass:$,onSelectHistory:T})=>{const L=d?(u==null?void 0:u.name)??d:null;return a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),e&&a.jsx("span",{className:"canvas-sidepanel__meta",children:Bg(e)??Ig(e)})]}),t?a.jsx("p",{className:"text-danger",children:t}):l?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:d??"",onChange:P=>h(P.target.value),disabled:n||!i,"aria-label":"Select dataset",children:c.map(P=>a.jsx("option",{value:P.value,disabled:!P.isOwned,children:`${P.label}${P.isOwned?"":" (locked)"}`},P.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),n&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!n&&!s&&!t&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:u.description}),L&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:L})]}),!i&&l>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:f,disabled:!p,"aria-label":"Clean all nodes",title:p?"Remove all nodes and edges from the canvas":"Nothing to clean yet",children:[a.jsx("span",{"aria-hidden":"true",children:""}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:g,disabled:y||!d,"aria-label":"Refresh history",title:"Refresh history",children:""}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:w,disabled:k,"aria-label":j,title:j,children:""})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:y?a.jsx("p",{className:"text-muted",children:"Loading history"}):b?a.jsx("p",{className:"text-danger",children:b}):x.length?x.map(P=>{const D=Bg(P.updated_at)??Ig(P.updated_at),W=P.id===N,z=W&&!E;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${W?" canvas-sidepanel__history-item--active":""}`,onClick:()=>T(P),disabled:z,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:P.name||`Pipeline #${P.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:D}),W&&E&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},P.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),S&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${$}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:M}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:S.message})]})]})},Ez=e=>{var w;const[t,n]=v.useState(e??null),[s,l]=v.useState(null),i=mr({queryKey:["feature-canvas","datasets"],queryFn:()=>qb(12),staleTime:5*60*1e3}),c=i.data??[],u=v.useMemo(()=>c.filter(y=>(y==null?void 0:y.is_owned)!==!1),[c]);v.useEffect(()=>{if(!c.length){l(null);return}if(t){const b=c.find(x=>x.source_id===t);if(b){l(x=>(x==null?void 0:x.id)===b.id?x:b);return}}const y=u[0]??c[0];y&&(t||n(y.source_id??String(y.id)),l(y))},[t,c,u]);const d=v.useMemo(()=>c.map(y=>({value:y.source_id,label:y.name??y.source_id,isOwned:y.is_owned!==!1})),[c]),p=u.length>1,h=c.length>0,f=u.length,g=i.error?((w=i.error)==null?void 0:w.message)??"Unable to load datasets":null;return{datasets:c,ownedDatasets:u,selectedDataset:s,setSelectedDataset:l,activeSourceId:t,setActiveSourceId:n,datasetOptions:d,canSelectDatasets:p,hasDatasets:h,ownedDatasetsCount:f,isDatasetLoading:i.isLoading,datasetErrorMessage:g}},kz=({sourceId:e,setIsDirty:t,setSaveFeedback:n,isHydratingRef:s})=>{const l=Ez(e),{datasets:i,setActiveSourceId:c,setSelectedDataset:u}=l,d=v.useCallback(p=>{const h=i.find(f=>f.source_id===p)??null;if(!h){n({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(h.is_owned===!1){n({message:"Only datasets you own can be selected.",tone:"error"});return}c(p),u(h),s.current=!0,t(!1),n(null)},[i,s,c,t,n,u]);return{...l,handleDatasetSelection:d}},Dw=(e,t)=>({nodes:JSON.parse(JSON.stringify(e??[])),edges:JSON.parse(JSON.stringify(t??[]))}),Rw=e=>Array.isArray(e)?e.some(t=>(t==null?void 0:t.id)&&t.id!=="dataset-source"):!1,Fw=e=>Array.isArray(e)?e.length>0:!1,Mz=({setIsDirty:e,setSaveFeedback:t,isHydratingRef:n})=>{const s=v.useRef({nodes:[],edges:[]}),[l,i]=v.useState(!1),c=v.useCallback((d,p)=>{const h=Dw(d,p);s.current=h;const f=Rw(h.nodes),g=Fw(h.edges);return i(f||g),{hasCustomNodes:f,hasEdges:g}},[]),u=v.useCallback((d,p)=>{const h=Dw(d,p),f=s.current,g=JSON.stringify(f.nodes??[])===JSON.stringify(h.nodes??[])&&JSON.stringify(f.edges??[])===JSON.stringify(h.edges??[]);s.current=h;const w=Rw(h.nodes),y=Fw(h.edges);i(w||y),!(n.current||g)&&(e(!0),t(null))},[n,e,t]);return{graphSnapshotRef:s,canClearCanvas:l,handleGraphChange:u,applyHydratedSnapshot:c}},Az=({canvasShellRef:e,canClearCanvas:t,setSaveFeedback:n})=>v.useCallback(()=>{var s;t&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((s=e.current)==null||s.clearGraph(),n(l=>(l==null?void 0:l.tone)==="error"?l:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[e,t,n]),Oz=({activeSourceId:e,isDirty:t,setSaveFeedback:n,pipelineQueryKey:s,pendingHistoryIdRef:l,isHydratingRef:i,historyLimit:c=rz})=>{var h;const u=rl(),d=mr({queryKey:["feature-canvas","pipeline-history",e],queryFn:()=>rx(e,c),enabled:!!e,staleTime:30*1e3,retry:1}),p=v.useCallback(f=>{if(!(f!=null&&f.graph)){n({message:"Selected revision is missing pipeline data.",tone:"error"});return}t&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(l.current=f.id??null,i.current=!0,n({message:`Loading revision ${f.name??`#${f.id}`}`,tone:"info"}),u.setQueryData(s,f))},[t,i,l,s,u,n]);return{historyItems:d.data??[],isHistoryLoading:d.isLoading||d.isFetching,historyErrorMessage:d.error?((h=d.error)==null?void 0:h.message)??"Unable to load history":null,refetchHistory:d.refetch,handleHistorySelection:p}},Pz=({applyHydratedSnapshot:e,selectedDataset:t,activeSourceId:n,setActivePipelineId:s,setActivePipelineName:l,setActivePipelineUpdatedAt:i,setIsDirty:c,setSaveFeedback:u,pendingHistoryIdRef:d,isHydratingRef:p})=>{const h=v.useCallback(g=>{const{nodes:w,edges:y,pipeline:b,context:x}=g,{hasCustomNodes:N}=e(w,y),E=(b==null?void 0:b.id)??null;if(s(E),l((b==null?void 0:b.name)??null),i((b==null?void 0:b.updated_at)??null),x==="stored"&&b)if(d.current===b.id){const j=Bg(b.updated_at)??Ig(b.updated_at);u({message:`Saved revision ${b.name??`#${b.id}`} (${j})`,tone:"info"}),d.current=null}else p.current&&u(k=>(k==null?void 0:k.tone)==="error"?k:N?{message:"Loaded saved pipeline",tone:"info"}:k);else x==="sample"?(d.current=null,u(k=>(k==null?void 0:k.tone)==="error"||N?k:{message:`Showing starter pipeline for ${(t==null?void 0:t.name)??(t==null?void 0:t.source_id)??n??"demo dataset"}`,tone:"info"})):x==="reset"?d.current=null:b||(d.current=null,u(k=>(k==null?void 0:k.tone)==="error"?k:null));p.current&&c(!1),b&&d.current&&d.current!==b.id&&(d.current=null),p.current=!1},[n,e,d,t,s,l,i,c,u,p]),f=v.useCallback(g=>{u({message:(g==null?void 0:g.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[u]);return{handlePipelineHydrated:h,handlePipelineError:f}},Tz=({queryClient:e,setSaveFeedback:t,setIsDirty:n,setActivePipelineId:s,setActivePipelineName:l,setActivePipelineUpdatedAt:i,pendingHistoryIdRef:c})=>{const{mutate:u,isPending:d}=qd({mutationFn:async({sourceId:p,payload:h})=>sx(p,h),onSuccess:(p,h)=>{t({message:"Draft saved successfully.",tone:"success"}),n(!1),s(p.id??null),l(p.name??null),i(p.updated_at??null),c.current=p.id??null,e.setQueryData(["feature-canvas","pipeline",h.sourceId],p),e.invalidateQueries({queryKey:["feature-canvas","pipeline-history",h.sourceId],exact:!1})},onError:p=>{t({message:(p==null?void 0:p.message)??"Failed to save pipeline.",tone:"error"})}});return{triggerSave:u,isSaving:d}},$z=e=>e==="success"?"":e==="error"?"":"",Lz=e=>e==="error"?"text-danger":e==="success"?"text-success":"text-muted",zz=()=>{const[e,t]=v.useState(null);v.useEffect(()=>{if(!e||e.tone==="error"||typeof window>"u")return;const l=window.setTimeout(()=>t(null),e.tone==="success"?4e3:2500);return()=>window.clearTimeout(l)},[e]);const n=v.useMemo(()=>$z(e==null?void 0:e.tone),[e]),s=v.useMemo(()=>Lz(e==null?void 0:e.tone),[e]);return{saveFeedback:e,setSaveFeedback:t,feedbackIcon:n,feedbackClass:s}},Dz=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:l,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:y,historyErrorMessage:b,historyItems:x,activePipelineId:N,isDirty:E,isSaving:k,saveFeedback:j,feedbackIcon:S,feedbackClass:M,onSelectHistory:$})=>({sidepanelProps:{activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:l,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:y,historyErrorMessage:b,historyItems:x,activePipelineId:N,isDirty:E,isSaveDisabled:!d||k,saveButtonLabel:k?"Saving":E?"Save draft*":"Save draft",saveFeedback:j,feedbackIcon:S,feedbackClass:M,onSelectHistory:$}}),Rz=(e=!0)=>{const[t,n]=v.useState(e),s=v.useCallback(()=>{n(l=>!l)},[]);return{isSidepanelExpanded:t,handleToggleSidepanel:s}},Fz=e=>{const t=e==null?void 0:e.type;return!t||t==="smoothstep"||t==="default"?"animatedEdge":t},Iz=({snapshot:e,selectedDataset:t,activeSourceId:n})=>{const s=e.nodes??[],l=e.edges??[];return{name:t!=null&&t.name?`Draft pipeline for ${t.name}`:`Draft pipeline for ${n}`,graph:{nodes:s,edges:l.map(i=>({...i,animated:(i==null?void 0:i.animated)??!0,type:Fz(i)}))},metadata:{lastClientSave:new Date().toISOString(),nodeCount:s.length,edgeCount:l.length}}},Bz=({sourceId:e})=>{const t=rl(),n=v.useRef(null),s=v.useRef(!0),{isSidepanelExpanded:l,handleToggleSidepanel:i}=Rz(!0),[c,u]=v.useState(!1),{saveFeedback:d,setSaveFeedback:p,feedbackIcon:h,feedbackClass:f}=zz(),{selectedDataset:g,activeSourceId:w,datasetOptions:y,canSelectDatasets:b,hasDatasets:x,ownedDatasetsCount:N,isDatasetLoading:E,datasetErrorMessage:k,handleDatasetSelection:j}=kz({sourceId:e,setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),[S,M]=v.useState(null),[$,T]=v.useState(null),[L,P]=v.useState(null),O=v.useMemo(()=>["feature-canvas","pipeline",w],[w]),D=v.useRef(null),{graphSnapshotRef:W,canClearCanvas:z,handleGraphChange:R,applyHydratedSnapshot:U}=Mz({setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),V=Az({canvasShellRef:n,canClearCanvas:z,setSaveFeedback:p}),{historyItems:B,isHistoryLoading:X,historyErrorMessage:H,refetchHistory:F,handleHistorySelection:K}=Oz({activeSourceId:w,isDirty:c,setSaveFeedback:p,pipelineQueryKey:O,pendingHistoryIdRef:D,isHydratingRef:s}),{triggerSave:re,isSaving:G}=Tz({queryClient:t,setSaveFeedback:p,setIsDirty:u,setActivePipelineId:M,setActivePipelineName:P,setActivePipelineUpdatedAt:T,pendingHistoryIdRef:D}),{handlePipelineHydrated:q,handlePipelineError:Y}=Pz({applyHydratedSnapshot:U,selectedDataset:g,activeSourceId:w,setActivePipelineId:M,setActivePipelineName:P,setActivePipelineUpdatedAt:T,setIsDirty:u,setSaveFeedback:p,pendingHistoryIdRef:D,isHydratingRef:s}),Q=v.useCallback(()=>{if(!w){p({message:"Select a dataset before saving.",tone:"error"});return}const J=W.current;if(!J.nodes||!J.nodes.length){p({message:"Add nodes to the canvas before saving.",tone:"error"});return}const se=Iz({snapshot:J,selectedDataset:g,activeSourceId:w});p({message:"Saving draft",tone:"info"}),re({sourceId:w,payload:se})},[w,g==null?void 0:g.name,re]),{sidepanelProps:ee}=Dz({activePipelineUpdatedAt:$,datasetErrorMessage:k,isDatasetLoading:E,hasDatasets:x,ownedDatasetsCount:N,canSelectDatasets:b,datasetOptions:y,selectedDataset:g,activeSourceId:w,canClearCanvas:z,onDatasetSelection:j,onClearCanvas:V,onRefreshHistory:()=>{F()},onSaveClick:Q,isHistoryLoading:X,historyErrorMessage:H,historyItems:B,activePipelineId:S,isDirty:c,isSaving:G,saveFeedback:d,feedbackIcon:h,feedbackClass:f,onSelectHistory:K});return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":l?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:i,"aria-label":l?"Collapse details panel":"Expand details panel","aria-expanded":l,"aria-controls":"feature-canvas-sidepanel",children:l?"":""}),!l&&d&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${f}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:h}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:d.message})]}),l&&a.jsx(Sz,{...ee}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(Ib,{children:a.jsx(Cz,{ref:n,sourceId:w,datasetName:(g==null?void 0:g.name)??(g==null?void 0:g.source_id)??null,onGraphChange:R,onPipelineHydrated:q,onPipelineError:Y})})})]})},Uz=new Rj,Ug=document.getElementById("ml-workflow-root");if(!Ug)throw new Error("ML workflow root element not found");const qz=Yf.createRoot(Ug),Hz=Ug.getAttribute("data-source-id")||void 0;qz.render(a.jsx(be.StrictMode,{children:a.jsx(Fj,{client:Uz,children:a.jsx(Bz,{sourceId:Hz})})}))})();
//# sourceMappingURL=feature-canvas.js.map
