var oj=cn=>{throw TypeError(cn)};var b_=(cn,yn,bn)=>yn.has(cn)||oj("Cannot "+bn);var ne=(cn,yn,bn)=>(b_(cn,yn,"read from private field"),bn?bn.call(cn):yn.get(cn)),He=(cn,yn,bn)=>yn.has(cn)?oj("Cannot add the same private member more than once"):yn instanceof WeakSet?yn.add(cn):yn.set(cn,bn),Te=(cn,yn,bn,Co)=>(b_(cn,yn,"write to private field"),Co?Co.call(cn,bn):yn.set(cn,bn),bn),vt=(cn,yn,bn)=>(b_(cn,yn,"access private method"),bn);var Ef=(cn,yn,bn,Co)=>({set _(pt){Te(cn,yn,pt,bn)},get _(){return ne(cn,yn,Co)}});(function(){"use strict";var La,Ng,Pw,Wo,za,ai,Tw,oi,Da,li,$w,Ko,Lw,Yo,ii,or,Go,Rn,Wc,Qo,br,Sa,zw,Ms,jt,Kc,ps,Xo,ci,ra,Ra,Yc,ui,di,Jo,Zo,Fa,mi,Lt,jd,x_,w_,j_,N_,C_,S_,E_,lj,Dw,Gc,Ir,gs,el,Br,No,Rw,aa,xr,Qc,Fw,oa,Ia,As,la,ia,kf,k_,Iw,Ur,Bw,un,Ba,Ua,hi,fi,qa,pi,gi,Uw;function cn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var yn={exports:{}},bn={},Co={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M_;function ij(){if(M_)return pt;M_=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(F){return F===null||typeof F!="object"?null:(F=f&&F[f]||F["@@iterator"],typeof F=="function"?F:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,b={};function x(F,K,se){this.props=F,this.context=K,this.refs=b,this.updater=se||w}x.prototype.isReactComponent={},x.prototype.setState=function(F,K){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,K,"setState")},x.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function N(){}N.prototype=x.prototype;function E(F,K,se){this.props=F,this.context=K,this.refs=b,this.updater=se||w}var M=E.prototype=new N;M.constructor=E,_(M,x.prototype),M.isPureReactComponent=!0;var j=Array.isArray,C=Object.prototype.hasOwnProperty,S={current:null},$={key:!0,ref:!0,__self:!0,__source:!0};function A(F,K,se){var Q,H={},Y=null,X=null;if(K!=null)for(Q in K.ref!==void 0&&(X=K.ref),K.key!==void 0&&(Y=""+K.key),K)C.call(K,Q)&&!$.hasOwnProperty(Q)&&(H[Q]=K[Q]);var ee=arguments.length-2;if(ee===1)H.children=se;else if(1<ee){for(var J=Array(ee),re=0;re<ee;re++)J[re]=arguments[re+2];H.children=J}if(F&&F.defaultProps)for(Q in ee=F.defaultProps,ee)H[Q]===void 0&&(H[Q]=ee[Q]);return{$$typeof:e,type:F,key:Y,ref:X,props:H,_owner:S.current}}function L(F,K){return{$$typeof:e,type:F.type,key:K,ref:F.ref,props:F.props,_owner:F._owner}}function T(F){return typeof F=="object"&&F!==null&&F.$$typeof===e}function P(F){var K={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(se){return K[se]})}var z=/\/+/g;function W(F,K){return typeof F=="object"&&F!==null&&F.key!=null?P(""+F.key):K.toString(36)}function D(F,K,se,Q,H){var Y=typeof F;(Y==="undefined"||Y==="boolean")&&(F=null);var X=!1;if(F===null)X=!0;else switch(Y){case"string":case"number":X=!0;break;case"object":switch(F.$$typeof){case e:case t:X=!0}}if(X)return X=F,H=H(X),F=Q===""?"."+W(X,0):Q,j(H)?(se="",F!=null&&(se=F.replace(z,"$&/")+"/"),D(H,K,se,"",function(re){return re})):H!=null&&(T(H)&&(H=L(H,se+(!H.key||X&&X.key===H.key?"":(""+H.key).replace(z,"$&/")+"/")+F)),K.push(H)),1;if(X=0,Q=Q===""?".":Q+":",j(F))for(var ee=0;ee<F.length;ee++){Y=F[ee];var J=Q+W(Y,ee);X+=D(Y,K,se,J,H)}else if(J=g(F),typeof J=="function")for(F=J.call(F),ee=0;!(Y=F.next()).done;)Y=Y.value,J=Q+W(Y,ee++),X+=D(Y,K,se,J,H);else if(Y==="object")throw K=String(F),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return X}function R(F,K,se){if(F==null)return F;var Q=[],H=0;return D(F,Q,"","",function(Y){return K.call(se,Y,H++)}),Q}function U(F){if(F._status===-1){var K=F._result;K=K(),K.then(function(se){(F._status===0||F._status===-1)&&(F._status=1,F._result=se)},function(se){(F._status===0||F._status===-1)&&(F._status=2,F._result=se)}),F._status===-1&&(F._status=0,F._result=K)}if(F._status===1)return F._result.default;throw F._result}var V={current:null},B={transition:null},G={ReactCurrentDispatcher:V,ReactCurrentBatchConfig:B,ReactCurrentOwner:S};function q(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:R,forEach:function(F,K,se){R(F,function(){K.apply(this,arguments)},se)},count:function(F){var K=0;return R(F,function(){K++}),K},toArray:function(F){return R(F,function(K){return K})||[]},only:function(F){if(!T(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},pt.Component=x,pt.Fragment=n,pt.Profiler=l,pt.PureComponent=E,pt.StrictMode=s,pt.Suspense=d,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G,pt.act=q,pt.cloneElement=function(F,K,se){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var Q=_({},F.props),H=F.key,Y=F.ref,X=F._owner;if(K!=null){if(K.ref!==void 0&&(Y=K.ref,X=S.current),K.key!==void 0&&(H=""+K.key),F.type&&F.type.defaultProps)var ee=F.type.defaultProps;for(J in K)C.call(K,J)&&!$.hasOwnProperty(J)&&(Q[J]=K[J]===void 0&&ee!==void 0?ee[J]:K[J])}var J=arguments.length-2;if(J===1)Q.children=se;else if(1<J){ee=Array(J);for(var re=0;re<J;re++)ee[re]=arguments[re+2];Q.children=ee}return{$$typeof:e,type:F.type,key:H,ref:Y,props:Q,_owner:X}},pt.createContext=function(F){return F={$$typeof:c,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:i,_context:F},F.Consumer=F},pt.createElement=A,pt.createFactory=function(F){var K=A.bind(null,F);return K.type=F,K},pt.createRef=function(){return{current:null}},pt.forwardRef=function(F){return{$$typeof:u,render:F}},pt.isValidElement=T,pt.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:U}},pt.memo=function(F,K){return{$$typeof:p,type:F,compare:K===void 0?null:K}},pt.startTransition=function(F){var K=B.transition;B.transition={};try{F()}finally{B.transition=K}},pt.unstable_act=q,pt.useCallback=function(F,K){return V.current.useCallback(F,K)},pt.useContext=function(F){return V.current.useContext(F)},pt.useDebugValue=function(){},pt.useDeferredValue=function(F){return V.current.useDeferredValue(F)},pt.useEffect=function(F,K){return V.current.useEffect(F,K)},pt.useId=function(){return V.current.useId()},pt.useImperativeHandle=function(F,K,se){return V.current.useImperativeHandle(F,K,se)},pt.useInsertionEffect=function(F,K){return V.current.useInsertionEffect(F,K)},pt.useLayoutEffect=function(F,K){return V.current.useLayoutEffect(F,K)},pt.useMemo=function(F,K){return V.current.useMemo(F,K)},pt.useReducer=function(F,K,se){return V.current.useReducer(F,K,se)},pt.useRef=function(F){return V.current.useRef(F)},pt.useState=function(F){return V.current.useState(F)},pt.useSyncExternalStore=function(F,K,se){return V.current.useSyncExternalStore(F,K,se)},pt.useTransition=function(){return V.current.useTransition()},pt.version="18.3.1",pt}Co.exports=ij();var v=Co.exports;const ge=cn(v);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A_;function cj(){if(A_)return bn;A_=1;var e=v,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(u,d,p){var h,f={},g=null,w=null;p!==void 0&&(g=""+p),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(w=d.ref);for(h in d)s.call(d,h)&&!i.hasOwnProperty(h)&&(f[h]=d[h]);if(u&&u.defaultProps)for(h in d=u.defaultProps,d)f[h]===void 0&&(f[h]=d[h]);return{$$typeof:t,type:u,key:g,ref:w,props:f,_owner:l.current}}return bn.Fragment=n,bn.jsx=c,bn.jsxs=c,bn}yn.exports=cj();var a=yn.exports,Mf={},O_={exports:{}},Cs={},Af={exports:{}},Of={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var P_;function uj(){return P_||(P_=1,function(e){function t(B,G){var q=B.length;B.push(G);e:for(;0<q;){var F=q-1>>>1,K=B[F];if(0<l(K,G))B[F]=G,B[q]=K,q=F;else break e}}function n(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var G=B[0],q=B.pop();if(q!==G){B[0]=q;e:for(var F=0,K=B.length,se=K>>>1;F<se;){var Q=2*(F+1)-1,H=B[Q],Y=Q+1,X=B[Y];if(0>l(H,q))Y<K&&0>l(X,H)?(B[F]=X,B[Y]=q,F=Y):(B[F]=H,B[Q]=q,F=Q);else if(Y<K&&0>l(X,q))B[F]=X,B[Y]=q,F=Y;else break e}}return G}function l(B,G){var q=B.sortIndex-G.sortIndex;return q!==0?q:B.id-G.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],p=[],h=1,f=null,g=3,w=!1,_=!1,b=!1,x=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(B){for(var G=n(p);G!==null;){if(G.callback===null)s(p);else if(G.startTime<=B)s(p),G.sortIndex=G.expirationTime,t(d,G);else break;G=n(p)}}function j(B){if(b=!1,M(B),!_)if(n(d)!==null)_=!0,U(C);else{var G=n(p);G!==null&&V(j,G.startTime-B)}}function C(B,G){_=!1,b&&(b=!1,N(A),A=-1),w=!0;var q=g;try{for(M(G),f=n(d);f!==null&&(!(f.expirationTime>G)||B&&!P());){var F=f.callback;if(typeof F=="function"){f.callback=null,g=f.priorityLevel;var K=F(f.expirationTime<=G);G=e.unstable_now(),typeof K=="function"?f.callback=K:f===n(d)&&s(d),M(G)}else s(d);f=n(d)}if(f!==null)var se=!0;else{var Q=n(p);Q!==null&&V(j,Q.startTime-G),se=!1}return se}finally{f=null,g=q,w=!1}}var S=!1,$=null,A=-1,L=5,T=-1;function P(){return!(e.unstable_now()-T<L)}function z(){if($!==null){var B=e.unstable_now();T=B;var G=!0;try{G=$(!0,B)}finally{G?W():(S=!1,$=null)}}else S=!1}var W;if(typeof E=="function")W=function(){E(z)};else if(typeof MessageChannel<"u"){var D=new MessageChannel,R=D.port2;D.port1.onmessage=z,W=function(){R.postMessage(null)}}else W=function(){x(z,0)};function U(B){$=B,S||(S=!0,W())}function V(B,G){A=x(function(){B(e.unstable_now())},G)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){_||w||(_=!0,U(C))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(B){switch(g){case 1:case 2:case 3:var G=3;break;default:G=g}var q=g;g=G;try{return B()}finally{g=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,G){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var q=g;g=B;try{return G()}finally{g=q}},e.unstable_scheduleCallback=function(B,G,q){var F=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?F+q:F):q=F,B){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=q+K,B={id:h++,callback:G,priorityLevel:B,startTime:q,expirationTime:K,sortIndex:-1},q>F?(B.sortIndex=q,t(p,B),n(d)===null&&B===n(p)&&(b?(N(A),A=-1):b=!0,V(j,q-F))):(B.sortIndex=K,t(d,B),_||w||(_=!0,U(C))),B},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(B){var G=g;return function(){var q=g;g=G;try{return B.apply(this,arguments)}finally{g=q}}}}(Of)),Of}var T_;function dj(){return T_||(T_=1,Af.exports=uj()),Af.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $_;function mj(){if($_)return Cs;$_=1;var e=v,t=dj();function n(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,m=1;m<arguments.length;m++)o+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,l={};function i(r,o){c(r,o),c(r+"Capture",o)}function c(r,o){for(l[r]=o,r=0;r<o.length;r++)s.add(o[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(r){return d.call(f,r)?!0:d.call(h,r)?!1:p.test(r)?f[r]=!0:(h[r]=!0,!1)}function w(r,o,m,y){if(m!==null&&m.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return y?!1:m!==null?!m.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function _(r,o,m,y){if(o===null||typeof o>"u"||w(r,o,m,y))return!0;if(y)return!1;if(m!==null)switch(m.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function b(r,o,m,y,k,O,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=y,this.attributeNamespace=k,this.mustUseProperty=m,this.propertyName=r,this.type=o,this.sanitizeURL=O,this.removeEmptyString=I}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){x[r]=new b(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];x[o]=new b(o,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){x[r]=new b(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){x[r]=new b(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){x[r]=new b(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){x[r]=new b(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){x[r]=new b(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){x[r]=new b(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){x[r]=new b(r,5,!1,r.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function E(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(N,E);x[o]=new b(o,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(N,E);x[o]=new b(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(N,E);x[o]=new b(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){x[r]=new b(r,1,!1,r.toLowerCase(),null,!1,!1)}),x.xlinkHref=new b("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){x[r]=new b(r,1,!1,r.toLowerCase(),null,!0,!0)});function M(r,o,m,y){var k=x.hasOwnProperty(o)?x[o]:null;(k!==null?k.type!==0:y||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(_(o,m,k,y)&&(m=null),y||k===null?g(o)&&(m===null?r.removeAttribute(o):r.setAttribute(o,""+m)):k.mustUseProperty?r[k.propertyName]=m===null?k.type===3?!1:"":m:(o=k.attributeName,y=k.attributeNamespace,m===null?r.removeAttribute(o):(k=k.type,m=k===3||k===4&&m===!0?"":""+m,y?r.setAttributeNS(y,o,m):r.setAttribute(o,m))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),S=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),P=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),R=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),V=Symbol.for("react.offscreen"),B=Symbol.iterator;function G(r){return r===null||typeof r!="object"?null:(r=B&&r[B]||r["@@iterator"],typeof r=="function"?r:null)}var q=Object.assign,F;function K(r){if(F===void 0)try{throw Error()}catch(m){var o=m.stack.trim().match(/\n( *(at )?)/);F=o&&o[1]||""}return`
`+F+r}var se=!1;function Q(r,o){if(!r||se)return"";se=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(he){var y=he}Reflect.construct(r,[],o)}else{try{o.call()}catch(he){y=he}r.call(o.prototype)}else{try{throw Error()}catch(he){y=he}r()}}catch(he){if(he&&y&&typeof he.stack=="string"){for(var k=he.stack.split(`
`),O=y.stack.split(`
`),I=k.length-1,te=O.length-1;1<=I&&0<=te&&k[I]!==O[te];)te--;for(;1<=I&&0<=te;I--,te--)if(k[I]!==O[te]){if(I!==1||te!==1)do if(I--,te--,0>te||k[I]!==O[te]){var ae=`
`+k[I].replace(" at new "," at ");return r.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",r.displayName)),ae}while(1<=I&&0<=te);break}}}finally{se=!1,Error.prepareStackTrace=m}return(r=r?r.displayName||r.name:"")?K(r):""}function H(r){switch(r.tag){case 5:return K(r.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return r=Q(r.type,!1),r;case 11:return r=Q(r.type.render,!1),r;case 1:return r=Q(r.type,!0),r;default:return""}}function Y(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case $:return"Fragment";case S:return"Portal";case L:return"Profiler";case A:return"StrictMode";case W:return"Suspense";case D:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case P:return(r.displayName||"Context")+".Consumer";case T:return(r._context.displayName||"Context")+".Provider";case z:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case R:return o=r.displayName||null,o!==null?o:Y(r.type)||"Memo";case U:o=r._payload,r=r._init;try{return Y(r(o))}catch{}}return null}function X(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(o);case 8:return o===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ee(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function J(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function re(r){var o=J(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),y=""+r[o];if(!r.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var k=m.get,O=m.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return k.call(this)},set:function(I){y=""+I,O.call(this,I)}}),Object.defineProperty(r,o,{enumerable:m.enumerable}),{getValue:function(){return y},setValue:function(I){y=""+I},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function we(r){r._valueTracker||(r._valueTracker=re(r))}function Pe(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var m=o.getValue(),y="";return r&&(y=J(r)?r.checked?"true":"false":r.value),r=y,r!==m?(o.setValue(r),!0):!1}function Me(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Fe(r,o){var m=o.checked;return q({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??r._wrapperState.initialChecked})}function Ke(r,o){var m=o.defaultValue==null?"":o.defaultValue,y=o.checked!=null?o.checked:o.defaultChecked;m=ee(o.value!=null?o.value:m),r._wrapperState={initialChecked:y,initialValue:m,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Ue(r,o){o=o.checked,o!=null&&M(r,"checked",o,!1)}function de(r,o){Ue(r,o);var m=ee(o.value),y=o.type;if(m!=null)y==="number"?(m===0&&r.value===""||r.value!=m)&&(r.value=""+m):r.value!==""+m&&(r.value=""+m);else if(y==="submit"||y==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?xe(r,o.type,m):o.hasOwnProperty("defaultValue")&&xe(r,o.type,ee(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function pe(r,o,m){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var y=o.type;if(!(y!=="submit"&&y!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,m||o===r.value||(r.value=o),r.defaultValue=o}m=r.name,m!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,m!==""&&(r.name=m)}function xe(r,o,m){(o!=="number"||Me(r.ownerDocument)!==r)&&(m==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+m&&(r.defaultValue=""+m))}var ke=Array.isArray;function De(r,o,m,y){if(r=r.options,o){o={};for(var k=0;k<m.length;k++)o["$"+m[k]]=!0;for(m=0;m<r.length;m++)k=o.hasOwnProperty("$"+r[m].value),r[m].selected!==k&&(r[m].selected=k),k&&y&&(r[m].defaultSelected=!0)}else{for(m=""+ee(m),o=null,k=0;k<r.length;k++){if(r[k].value===m){r[k].selected=!0,y&&(r[k].defaultSelected=!0);return}o!==null||r[k].disabled||(o=r[k])}o!==null&&(o.selected=!0)}}function ce(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return q({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Oe(r,o){var m=o.value;if(m==null){if(m=o.children,o=o.defaultValue,m!=null){if(o!=null)throw Error(n(92));if(ke(m)){if(1<m.length)throw Error(n(93));m=m[0]}o=m}o==null&&(o=""),m=o}r._wrapperState={initialValue:ee(m)}}function Ye(r,o){var m=ee(o.value),y=ee(o.defaultValue);m!=null&&(m=""+m,m!==r.value&&(r.value=m),o.defaultValue==null&&r.defaultValue!==m&&(r.defaultValue=m)),y!=null&&(r.defaultValue=""+y)}function ct(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function Je(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function mt(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?Je(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var Ze,ot=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,m,y,k){MSApp.execUnsafeLocalFunction(function(){return r(o,m,y,k)})}:r}(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for(Ze=Ze||document.createElement("div"),Ze.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Ze.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function Et(r,o){if(o){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=o;return}}r.textContent=o}var zt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},We=["Webkit","ms","Moz","O"];Object.keys(zt).forEach(function(r){We.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),zt[o]=zt[r]})});function Dt(r,o,m){return o==null||typeof o=="boolean"||o===""?"":m||typeof o!="number"||o===0||zt.hasOwnProperty(r)&&zt[r]?(""+o).trim():o+"px"}function ht(r,o){r=r.style;for(var m in o)if(o.hasOwnProperty(m)){var y=m.indexOf("--")===0,k=Dt(m,o[m],y);m==="float"&&(m="cssFloat"),y?r.setProperty(m,k):r[m]=k}}var kt=q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function sn(r,o){if(o){if(kt[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function wn(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mt=null;function rn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var Fn=null,Ut=null,it=null;function In(r){if(r=hl(r)){if(typeof Fn!="function")throw Error(n(280));var o=r.stateNode;o&&(o=fl(o),Fn(r.stateNode,r.type,o))}}function Zt(r){Ut?it?it.push(r):it=[r]:Ut=r}function gn(){if(Ut){var r=Ut,o=it;if(it=Ut=null,In(r),o)for(r=0;r<o.length;r++)In(o[r])}}function ft(r,o){return r(o)}function Os(){}var Yt=!1;function gt(r,o,m){if(Yt)return r(o,m);Yt=!0;try{return ft(r,o,m)}finally{Yt=!1,(Ut!==null||it!==null)&&(Os(),gn())}}function xt(r,o){var m=r.stateNode;if(m===null)return null;var y=fl(m);if(y===null)return null;m=y[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(r=r.type,y=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!y;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(n(231,o,typeof m));return m}var ls=!1;if(u)try{var dn={};Object.defineProperty(dn,"passive",{get:function(){ls=!0}}),window.addEventListener("test",dn,dn),window.removeEventListener("test",dn,dn)}catch{ls=!1}function jn(r,o,m,y,k,O,I,te,ae){var he=Array.prototype.slice.call(arguments,3);try{o.apply(m,he)}catch(be){this.onError(be)}}var mn=!1,An=null,hn=!1,is=null,It={onError:function(r){mn=!0,An=r}};function Bn(r,o,m,y,k,O,I,te,ae){mn=!1,An=null,jn.apply(It,arguments)}function On(r,o,m,y,k,O,I,te,ae){if(Bn.apply(this,arguments),mn){if(mn){var he=An;mn=!1,An=null}else throw Error(n(198));hn||(hn=!0,is=he)}}function Nn(r){var o=r,m=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,o.flags&4098&&(m=o.return),r=o.return;while(r)}return o.tag===3?m:null}function lr(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function Xn(r){if(Nn(r)!==r)throw Error(n(188))}function Ps(r){var o=r.alternate;if(!o){if(o=Nn(r),o===null)throw Error(n(188));return o!==r?null:r}for(var m=r,y=o;;){var k=m.return;if(k===null)break;var O=k.alternate;if(O===null){if(y=k.return,y!==null){m=y;continue}break}if(k.child===O.child){for(O=k.child;O;){if(O===m)return Xn(k),r;if(O===y)return Xn(k),o;O=O.sibling}throw Error(n(188))}if(m.return!==y.return)m=k,y=O;else{for(var I=!1,te=k.child;te;){if(te===m){I=!0,m=k,y=O;break}if(te===y){I=!0,y=k,m=O;break}te=te.sibling}if(!I){for(te=O.child;te;){if(te===m){I=!0,m=O,y=k;break}if(te===y){I=!0,y=O,m=k;break}te=te.sibling}if(!I)throw Error(n(189))}}if(m.alternate!==y)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?r:o}function _s(r){return r=Ps(r),r!==null?vs(r):null}function vs(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=vs(r);if(o!==null)return o;r=r.sibling}return null}var Xs=t.unstable_scheduleCallback,Jn=t.unstable_cancelCallback,Qt=t.unstable_shouldYield,At=t.unstable_requestPaint,st=t.unstable_now,ir=t.unstable_getCurrentPriorityLevel,Un=t.unstable_ImmediatePriority,Js=t.unstable_UserBlockingPriority,cs=t.unstable_NormalPriority,wr=t.unstable_LowPriority,le=t.unstable_IdlePriority,_e=null,$e=null;function Ct(r){if($e&&typeof $e.onCommitFiberRoot=="function")try{$e.onCommitFiberRoot(_e,r,void 0,(r.current.flags&128)===128)}catch{}}var je=Math.clz32?Math.clz32:Rt,tt=Math.log,lt=Math.LN2;function Rt(r){return r>>>=0,r===0?32:31-(tt(r)/lt|0)|0}var Ot=64,an=4194304;function qt(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function fn(r,o){var m=r.pendingLanes;if(m===0)return 0;var y=0,k=r.suspendedLanes,O=r.pingedLanes,I=m&268435455;if(I!==0){var te=I&~k;te!==0?y=qt(te):(O&=I,O!==0&&(y=qt(O)))}else I=m&~k,I!==0?y=qt(I):O!==0&&(y=qt(O));if(y===0)return 0;if(o!==0&&o!==y&&!(o&k)&&(k=y&-y,O=o&-o,k>=O||k===16&&(O&4194240)!==0))return o;if(y&4&&(y|=m&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=y;0<o;)m=31-je(o),k=1<<m,y|=r[m],o&=~k;return y}function Ts(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zn(r,o){for(var m=r.suspendedLanes,y=r.pingedLanes,k=r.expirationTimes,O=r.pendingLanes;0<O;){var I=31-je(O),te=1<<I,ae=k[I];ae===-1?(!(te&m)||te&y)&&(k[I]=Ts(te,o)):ae<=o&&(r.expiredLanes|=te),O&=~te}}function Cn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function Pn(){var r=Ot;return Ot<<=1,!(Ot&4194240)&&(Ot=64),r}function us(r){for(var o=[],m=0;31>m;m++)o.push(r);return o}function es(r,o,m){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-je(o),r[o]=m}function Ha(r,o){var m=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var y=r.eventTimes;for(r=r.expirationTimes;0<m;){var k=31-je(m),O=1<<k;o[k]=0,y[k]=-1,r[k]=-1,m&=~O}}function tl(r,o){var m=r.entangledLanes|=o;for(r=r.entanglements;m;){var y=31-je(m),k=1<<y;k&o|r[y]&o&&(r[y]|=o),m&=~k}}var yt=0;function _i(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var nl,sl,vi,yi,rl,Va=!1,ca=[],Zs=null,Z=null,fe=null,me=new Map,Ee=new Map,Ce=[],ye="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function et(r,o){switch(r){case"focusin":case"focusout":Zs=null;break;case"dragenter":case"dragleave":Z=null;break;case"mouseover":case"mouseout":fe=null;break;case"pointerover":case"pointerout":me.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ee.delete(o.pointerId)}}function Ie(r,o,m,y,k,O){return r===null||r.nativeEvent!==O?(r={blockedOn:o,domEventName:m,eventSystemFlags:y,nativeEvent:O,targetContainers:[k]},o!==null&&(o=hl(o),o!==null&&sl(o)),r):(r.eventSystemFlags|=y,o=r.targetContainers,k!==null&&o.indexOf(k)===-1&&o.push(k),r)}function ut(r,o,m,y,k){switch(o){case"focusin":return Zs=Ie(Zs,r,o,m,y,k),!0;case"dragenter":return Z=Ie(Z,r,o,m,y,k),!0;case"mouseover":return fe=Ie(fe,r,o,m,y,k),!0;case"pointerover":var O=k.pointerId;return me.set(O,Ie(me.get(O)||null,r,o,m,y,k)),!0;case"gotpointercapture":return O=k.pointerId,Ee.set(O,Ie(Ee.get(O)||null,r,o,m,y,k)),!0}return!1}function rt(r){var o=ga(r.target);if(o!==null){var m=Nn(o);if(m!==null){if(o=m.tag,o===13){if(o=lr(m),o!==null){r.blockedOn=o,rl(r.priority,function(){vi(m)});return}}else if(o===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Ge(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var m=ys(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(m===null){m=r.nativeEvent;var y=new m.constructor(m.type,m);Mt=y,m.target.dispatchEvent(y),Mt=null}else return o=hl(m),o!==null&&sl(o),r.blockedOn=m,!1;o.shift()}return!0}function Nt(r,o,m){Ge(r)&&m.delete(o)}function Tn(){Va=!1,Zs!==null&&Ge(Zs)&&(Zs=null),Z!==null&&Ge(Z)&&(Z=null),fe!==null&&Ge(fe)&&(fe=null),me.forEach(Nt),Ee.forEach(Nt)}function Ht(r,o){r.blockedOn===o&&(r.blockedOn=null,Va||(Va=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Tn)))}function Sn(r){function o(k){return Ht(k,r)}if(0<ca.length){Ht(ca[0],r);for(var m=1;m<ca.length;m++){var y=ca[m];y.blockedOn===r&&(y.blockedOn=null)}}for(Zs!==null&&Ht(Zs,r),Z!==null&&Ht(Z,r),fe!==null&&Ht(fe,r),me.forEach(o),Ee.forEach(o),m=0;m<Ce.length;m++)y=Ce[m],y.blockedOn===r&&(y.blockedOn=null);for(;0<Ce.length&&(m=Ce[0],m.blockedOn===null);)rt(m),m.blockedOn===null&&Ce.shift()}var $s=j.ReactCurrentBatchConfig,Ls=!0;function er(r,o,m,y){var k=yt,O=$s.transition;$s.transition=null;try{yt=1,cr(r,o,m,y)}finally{yt=k,$s.transition=O}}function qr(r,o,m,y){var k=yt,O=$s.transition;$s.transition=null;try{yt=4,cr(r,o,m,y)}finally{yt=k,$s.transition=O}}function cr(r,o,m,y){if(Ls){var k=ys(r,o,m,y);if(k===null)gu(r,o,y,ts,m),et(r,y);else if(ut(k,r,o,m,y))y.stopPropagation();else if(et(r,y),o&4&&-1<ye.indexOf(r)){for(;k!==null;){var O=hl(k);if(O!==null&&nl(O),O=ys(r,o,m,y),O===null&&gu(r,o,y,ts,m),O===k)break;k=O}k!==null&&y.stopPropagation()}else gu(r,o,y,null,m)}}var ts=null;function ys(r,o,m,y){if(ts=null,r=rn(y),r=ga(r),r!==null)if(o=Nn(r),o===null)r=null;else if(m=o.tag,m===13){if(r=lr(o),r!==null)return r;r=null}else if(m===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return ts=r,null}function Wa(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ir()){case Un:return 1;case Js:return 4;case cs:case wr:return 16;case le:return 536870912;default:return 16}default:return 16}}var zs=null,Ka=null,ua=null;function Ya(){if(ua)return ua;var r,o=Ka,m=o.length,y,k="value"in zs?zs.value:zs.textContent,O=k.length;for(r=0;r<m&&o[r]===k[r];r++);var I=m-r;for(y=1;y<=I&&o[m-y]===k[O-y];y++);return ua=k.slice(r,1<y?1-y:void 0)}function Ga(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Qa(){return!0}function Xa(){return!1}function $n(r){function o(m,y,k,O,I){this._reactName=m,this._targetInst=k,this.type=y,this.nativeEvent=O,this.target=I,this.currentTarget=null;for(var te in r)r.hasOwnProperty(te)&&(m=r[te],this[te]=m?m(O):O[te]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?Qa:Xa,this.isPropagationStopped=Xa,this}return q(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Qa)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Qa)},persist:function(){},isPersistent:Qa}),o}var en={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ja=$n(en),da=q({},en,{view:0,detail:0}),Xc=$n(da),al,tn,En,ds=q({},da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==En&&(En&&r.type==="mousemove"?(al=r.screenX-En.screenX,tn=r.screenY-En.screenY):tn=al=0,En=r),al)},movementY:function(r){return"movementY"in r?r.movementY:tn}}),bi=$n(ds),Cg=q({},ds,{dataTransfer:0}),Sg=$n(Cg),Eg=q({},da,{relatedTarget:0}),Jc=$n(Eg),kg=q({},en,{animationName:0,elapsedTime:0,pseudoElement:0}),Zc=$n(kg),eu=q({},en,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),qw=$n(eu),Hw=q({},en,{data:0}),tu=$n(Hw),$m={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Lm={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},zm={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _t(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=zm[r])?!!o[r]:!1}function _n(){return _t}var Dm=q({},da,{key:function(r){if(r.key){var o=$m[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=Ga(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Lm[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(r){return r.type==="keypress"?Ga(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ga(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Mg=$n(Dm),Ag=q({},ds,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rm=$n(Ag),Fm=q({},da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n}),Im=$n(Fm),Bm=q({},en,{propertyName:0,elapsedTime:0,pseudoElement:0}),Og=$n(Bm),xi=q({},ds,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Pg=$n(xi),Um=[9,13,27,32],ns=u&&"CompositionEvent"in window,Za=null;u&&"documentMode"in document&&(Za=document.documentMode);var Tg=u&&"TextEvent"in window&&!Za,eo=u&&(!ns||Za&&8<Za&&11>=Za),nu=" ",dt=!1;function qm(r,o){switch(r){case"keyup":return Um.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var jr=!1;function su(r,o){switch(r){case"compositionend":return Hm(o);case"keypress":return o.which!==32?null:(dt=!0,nu);case"textInput":return r=o.data,r===nu&&dt?null:r;default:return null}}function Vm(r,o){if(jr)return r==="compositionend"||!ns&&qm(r,o)?(r=Ya(),ua=Ka=zs=null,jr=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return eo&&o.locale!=="ko"?null:o.data;default:return null}}var Wm={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ru(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!Wm[r.type]:o==="textarea"}function au(r,o,m,y){Zt(y),o=Pi(o,"onChange"),0<o.length&&(m=new Ja("onChange","change",null,m,y),r.push({event:m,listeners:o}))}var ol=null,to=null;function $g(r){lh(r,0)}function wi(r){var o=oo(r);if(Pe(o))return r}function Lg(r,o){if(r==="change")return o}var Km=!1;if(u){var ou;if(u){var qn="oninput"in document;if(!qn){var ji=document.createElement("div");ji.setAttribute("oninput","return;"),qn=typeof ji.oninput=="function"}ou=qn}else ou=!1;Km=ou&&(!document.documentMode||9<document.documentMode)}function ll(){ol&&(ol.detachEvent("onpropertychange",Ni),to=ol=null)}function Ni(r){if(r.propertyName==="value"&&wi(to)){var o=[];au(o,to,r,rn(r)),gt($g,o)}}function Ci(r,o,m){r==="focusin"?(ll(),ol=o,to=m,ol.attachEvent("onpropertychange",Ni)):r==="focusout"&&ll()}function lu(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return wi(to)}function ma(r,o){if(r==="click")return wi(o)}function Ym(r,o){if(r==="input"||r==="change")return wi(o)}function iu(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Ds=typeof Object.is=="function"?Object.is:iu;function no(r,o){if(Ds(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var m=Object.keys(r),y=Object.keys(o);if(m.length!==y.length)return!1;for(y=0;y<m.length;y++){var k=m[y];if(!d.call(o,k)||!Ds(r[k],o[k]))return!1}return!0}function Gm(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function Qm(r,o){var m=Gm(r);r=0;for(var y;m;){if(m.nodeType===3){if(y=r+m.textContent.length,r<=o&&y>=o)return{node:m,offset:o-r};r=y}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=Gm(m)}}function Xm(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?Xm(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function cu(){for(var r=window,o=Me();o instanceof r.HTMLIFrameElement;){try{var m=typeof o.contentWindow.location.href=="string"}catch{m=!1}if(m)r=o.contentWindow;else break;o=Me(r.document)}return o}function Si(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function Jm(r){var o=cu(),m=r.focusedElem,y=r.selectionRange;if(o!==m&&m&&m.ownerDocument&&Xm(m.ownerDocument.documentElement,m)){if(y!==null&&Si(m)){if(o=y.start,r=y.end,r===void 0&&(r=o),"selectionStart"in m)m.selectionStart=o,m.selectionEnd=Math.min(r,m.value.length);else if(r=(o=m.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var k=m.textContent.length,O=Math.min(y.start,k);y=y.end===void 0?O:Math.min(y.end,k),!r.extend&&O>y&&(k=y,y=O,O=k),k=Qm(m,O);var I=Qm(m,y);k&&I&&(r.rangeCount!==1||r.anchorNode!==k.node||r.anchorOffset!==k.offset||r.focusNode!==I.node||r.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(k.node,k.offset),r.removeAllRanges(),O>y?(r.addRange(o),r.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),r.addRange(o)))}}for(o=[],r=m;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<o.length;m++)r=o[m],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var uu=u&&"documentMode"in document&&11>=document.documentMode,ha=null,Ei=null,Hr=null,ki=!1;function Zm(r,o,m){var y=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;ki||ha==null||ha!==Me(y)||(y=ha,"selectionStart"in y&&Si(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Hr&&no(Hr,y)||(Hr=y,y=Pi(Ei,"onSelect"),0<y.length&&(o=new Ja("onSelect","select",null,o,m),r.push({event:o,listeners:y}),o.target=ha)))}function Mi(r,o){var m={};return m[r.toLowerCase()]=o.toLowerCase(),m["Webkit"+r]="webkit"+o,m["Moz"+r]="moz"+o,m}var fa={animationend:Mi("Animation","AnimationEnd"),animationiteration:Mi("Animation","AnimationIteration"),animationstart:Mi("Animation","AnimationStart"),transitionend:Mi("Transition","TransitionEnd")},du={},eh={};u&&(eh=document.createElement("div").style,"AnimationEvent"in window||(delete fa.animationend.animation,delete fa.animationiteration.animation,delete fa.animationstart.animation),"TransitionEvent"in window||delete fa.transitionend.transition);function Ai(r){if(du[r])return du[r];if(!fa[r])return r;var o=fa[r],m;for(m in o)if(o.hasOwnProperty(m)&&m in eh)return du[r]=o[m];return r}var th=Ai("animationend"),nh=Ai("animationiteration"),sh=Ai("animationstart"),rh=Ai("transitionend"),ah=new Map,mu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vr(r,o){ah.set(r,o),i(o,[r])}for(var hu=0;hu<mu.length;hu++){var fu=mu[hu],zg=fu.toLowerCase(),Dg=fu[0].toUpperCase()+fu.slice(1);Vr(zg,"on"+Dg)}Vr(th,"onAnimationEnd"),Vr(nh,"onAnimationIteration"),Vr(sh,"onAnimationStart"),Vr("dblclick","onDoubleClick"),Vr("focusin","onFocus"),Vr("focusout","onBlur"),Vr(rh,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var il="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Rg=new Set("cancel close invalid load scroll toggle".split(" ").concat(il));function oh(r,o,m){var y=r.type||"unknown-event";r.currentTarget=m,On(y,o,void 0,r),r.currentTarget=null}function lh(r,o){o=(o&4)!==0;for(var m=0;m<r.length;m++){var y=r[m],k=y.event;y=y.listeners;e:{var O=void 0;if(o)for(var I=y.length-1;0<=I;I--){var te=y[I],ae=te.instance,he=te.currentTarget;if(te=te.listener,ae!==O&&k.isPropagationStopped())break e;oh(k,te,he),O=ae}else for(I=0;I<y.length;I++){if(te=y[I],ae=te.instance,he=te.currentTarget,te=te.listener,ae!==O&&k.isPropagationStopped())break e;oh(k,te,he),O=ae}}}if(hn)throw r=is,hn=!1,is=null,r}function Kt(r,o){var m=o[xu];m===void 0&&(m=o[xu]=new Set);var y=r+"__bubble";m.has(y)||(ih(o,r,2,!1),m.add(y))}function pu(r,o,m){var y=0;o&&(y|=4),ih(m,r,y,o)}var Oi="_reactListening"+Math.random().toString(36).slice(2);function cl(r){if(!r[Oi]){r[Oi]=!0,s.forEach(function(m){m!=="selectionchange"&&(Rg.has(m)||pu(m,!1,r),pu(m,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Oi]||(o[Oi]=!0,pu("selectionchange",!1,o))}}function ih(r,o,m,y){switch(Wa(o)){case 1:var k=er;break;case 4:k=qr;break;default:k=cr}m=k.bind(null,o,m,r),k=void 0,!ls||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(k=!0),y?k!==void 0?r.addEventListener(o,m,{capture:!0,passive:k}):r.addEventListener(o,m,!0):k!==void 0?r.addEventListener(o,m,{passive:k}):r.addEventListener(o,m,!1)}function gu(r,o,m,y,k){var O=y;if(!(o&1)&&!(o&2)&&y!==null)e:for(;;){if(y===null)return;var I=y.tag;if(I===3||I===4){var te=y.stateNode.containerInfo;if(te===k||te.nodeType===8&&te.parentNode===k)break;if(I===4)for(I=y.return;I!==null;){var ae=I.tag;if((ae===3||ae===4)&&(ae=I.stateNode.containerInfo,ae===k||ae.nodeType===8&&ae.parentNode===k))return;I=I.return}for(;te!==null;){if(I=ga(te),I===null)return;if(ae=I.tag,ae===5||ae===6){y=O=I;continue e}te=te.parentNode}}y=y.return}gt(function(){var he=O,be=rn(m),Ne=[];e:{var ve=ah.get(r);if(ve!==void 0){var Le=Ja,Re=r;switch(r){case"keypress":if(Ga(m)===0)break e;case"keydown":case"keyup":Le=Mg;break;case"focusin":Re="focus",Le=Jc;break;case"focusout":Re="blur",Le=Jc;break;case"beforeblur":case"afterblur":Le=Jc;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=bi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=Sg;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=Im;break;case th:case nh:case sh:Le=Zc;break;case rh:Le=Og;break;case"scroll":Le=Xc;break;case"wheel":Le=Pg;break;case"copy":case"cut":case"paste":Le=qw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=Rm}var Be=(o&4)!==0,vn=!Be&&r==="scroll",ie=Be?ve!==null?ve+"Capture":null:ve;Be=[];for(var oe=he,ue;oe!==null;){ue=oe;var Se=ue.stateNode;if(ue.tag===5&&Se!==null&&(ue=Se,ie!==null&&(Se=xt(oe,ie),Se!=null&&Be.push(ul(oe,Se,ue)))),vn)break;oe=oe.return}0<Be.length&&(ve=new Le(ve,Re,null,m,be),Ne.push({event:ve,listeners:Be}))}}if(!(o&7)){e:{if(ve=r==="mouseover"||r==="pointerover",Le=r==="mouseout"||r==="pointerout",ve&&m!==Mt&&(Re=m.relatedTarget||m.fromElement)&&(ga(Re)||Re[Cr]))break e;if((Le||ve)&&(ve=be.window===be?be:(ve=be.ownerDocument)?ve.defaultView||ve.parentWindow:window,Le?(Re=m.relatedTarget||m.toElement,Le=he,Re=Re?ga(Re):null,Re!==null&&(vn=Nn(Re),Re!==vn||Re.tag!==5&&Re.tag!==6)&&(Re=null)):(Le=null,Re=he),Le!==Re)){if(Be=bi,Se="onMouseLeave",ie="onMouseEnter",oe="mouse",(r==="pointerout"||r==="pointerover")&&(Be=Rm,Se="onPointerLeave",ie="onPointerEnter",oe="pointer"),vn=Le==null?ve:oo(Le),ue=Re==null?ve:oo(Re),ve=new Be(Se,oe+"leave",Le,m,be),ve.target=vn,ve.relatedTarget=ue,Se=null,ga(be)===he&&(Be=new Be(ie,oe+"enter",Re,m,be),Be.target=ue,Be.relatedTarget=vn,Se=Be),vn=Se,Le&&Re)t:{for(Be=Le,ie=Re,oe=0,ue=Be;ue;ue=so(ue))oe++;for(ue=0,Se=ie;Se;Se=so(Se))ue++;for(;0<oe-ue;)Be=so(Be),oe--;for(;0<ue-oe;)ie=so(ie),ue--;for(;oe--;){if(Be===ie||ie!==null&&Be===ie.alternate)break t;Be=so(Be),ie=so(ie)}Be=null}else Be=null;Le!==null&&ch(Ne,ve,Le,Be,!1),Re!==null&&vn!==null&&ch(Ne,vn,Re,Be,!0)}}e:{if(ve=he?oo(he):window,Le=ve.nodeName&&ve.nodeName.toLowerCase(),Le==="select"||Le==="input"&&ve.type==="file")var qe=Lg;else if(ru(ve))if(Km)qe=Ym;else{qe=lu;var Qe=Ci}else(Le=ve.nodeName)&&Le.toLowerCase()==="input"&&(ve.type==="checkbox"||ve.type==="radio")&&(qe=ma);if(qe&&(qe=qe(r,he))){au(Ne,qe,m,be);break e}Qe&&Qe(r,ve,he),r==="focusout"&&(Qe=ve._wrapperState)&&Qe.controlled&&ve.type==="number"&&xe(ve,"number",ve.value)}switch(Qe=he?oo(he):window,r){case"focusin":(ru(Qe)||Qe.contentEditable==="true")&&(ha=Qe,Ei=he,Hr=null);break;case"focusout":Hr=Ei=ha=null;break;case"mousedown":ki=!0;break;case"contextmenu":case"mouseup":case"dragend":ki=!1,Zm(Ne,m,be);break;case"selectionchange":if(uu)break;case"keydown":case"keyup":Zm(Ne,m,be)}var Xe;if(ns)e:{switch(r){case"compositionstart":var at="onCompositionStart";break e;case"compositionend":at="onCompositionEnd";break e;case"compositionupdate":at="onCompositionUpdate";break e}at=void 0}else jr?qm(r,m)&&(at="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(at="onCompositionStart");at&&(eo&&m.locale!=="ko"&&(jr||at!=="onCompositionStart"?at==="onCompositionEnd"&&jr&&(Xe=Ya()):(zs=be,Ka="value"in zs?zs.value:zs.textContent,jr=!0)),Qe=Pi(he,at),0<Qe.length&&(at=new tu(at,r,null,m,be),Ne.push({event:at,listeners:Qe}),Xe?at.data=Xe:(Xe=Hm(m),Xe!==null&&(at.data=Xe)))),(Xe=Tg?su(r,m):Vm(r,m))&&(he=Pi(he,"onBeforeInput"),0<he.length&&(be=new tu("onBeforeInput","beforeinput",null,m,be),Ne.push({event:be,listeners:he}),be.data=Xe))}lh(Ne,o)})}function ul(r,o,m){return{instance:r,listener:o,currentTarget:m}}function Pi(r,o){for(var m=o+"Capture",y=[];r!==null;){var k=r,O=k.stateNode;k.tag===5&&O!==null&&(k=O,O=xt(r,m),O!=null&&y.unshift(ul(r,O,k)),O=xt(r,o),O!=null&&y.push(ul(r,O,k))),r=r.return}return y}function so(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function ch(r,o,m,y,k){for(var O=o._reactName,I=[];m!==null&&m!==y;){var te=m,ae=te.alternate,he=te.stateNode;if(ae!==null&&ae===y)break;te.tag===5&&he!==null&&(te=he,k?(ae=xt(m,O),ae!=null&&I.unshift(ul(m,ae,te))):k||(ae=xt(m,O),ae!=null&&I.push(ul(m,ae,te)))),m=m.return}I.length!==0&&r.push({event:o,listeners:I})}var Fg=/\r\n?/g,Ig=/\u0000|\uFFFD/g;function _u(r){return(typeof r=="string"?r:""+r).replace(Fg,`
`).replace(Ig,"")}function Ti(r,o,m){if(o=_u(o),_u(r)!==o&&m)throw Error(n(425))}function ro(){}var ao=null,dl=null;function vu(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var yu=typeof setTimeout=="function"?setTimeout:void 0,Bg=typeof clearTimeout=="function"?clearTimeout:void 0,Hn=typeof Promise=="function"?Promise:void 0,uh=typeof queueMicrotask=="function"?queueMicrotask:typeof Hn<"u"?function(r){return Hn.resolve(null).then(r).catch(dh)}:yu;function dh(r){setTimeout(function(){throw r})}function bu(r,o){var m=o,y=0;do{var k=m.nextSibling;if(r.removeChild(m),k&&k.nodeType===8)if(m=k.data,m==="/$"){if(y===0){r.removeChild(k),Sn(o);return}y--}else m!=="$"&&m!=="$?"&&m!=="$!"||y++;m=k}while(m);Sn(o)}function Nr(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function mh(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(o===0)return r;o--}else m==="/$"&&o++}r=r.previousSibling}return null}var pa=Math.random().toString(36).slice(2),ur="__reactFiber$"+pa,ml="__reactProps$"+pa,Cr="__reactContainer$"+pa,xu="__reactEvents$"+pa,Ug="__reactListeners$"+pa,qg="__reactHandles$"+pa;function ga(r){var o=r[ur];if(o)return o;for(var m=r.parentNode;m;){if(o=m[Cr]||m[ur]){if(m=o.alternate,o.child!==null||m!==null&&m.child!==null)for(r=mh(r);r!==null;){if(m=r[ur])return m;r=mh(r)}return o}r=m,m=r.parentNode}return null}function hl(r){return r=r[ur]||r[Cr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function oo(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function fl(r){return r[ml]||null}var $i=[],lo=-1;function Sr(r){return{current:r}}function Vt(r){0>lo||(r.current=$i[lo],$i[lo]=null,lo--)}function Bt(r,o){lo++,$i[lo]=r.current,r.current=o}var Wr={},Ln=Sr(Wr),ss=Sr(!1),Rs=Wr;function _a(r,o){var m=r.type.contextTypes;if(!m)return Wr;var y=r.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===o)return y.__reactInternalMemoizedMaskedChildContext;var k={},O;for(O in m)k[O]=o[O];return y&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=k),k}function ms(r){return r=r.childContextTypes,r!=null}function pl(){Vt(ss),Vt(Ln)}function wu(r,o,m){if(Ln.current!==Wr)throw Error(n(168));Bt(Ln,o),Bt(ss,m)}function hh(r,o,m){var y=r.stateNode;if(o=o.childContextTypes,typeof y.getChildContext!="function")return m;y=y.getChildContext();for(var k in y)if(!(k in o))throw Error(n(108,X(r)||"Unknown",k));return q({},m,y)}function gl(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Wr,Rs=Ln.current,Bt(Ln,r),Bt(ss,ss.current),!0}function ju(r,o,m){var y=r.stateNode;if(!y)throw Error(n(169));m?(r=hh(r,o,Rs),y.__reactInternalMemoizedMergedChildContext=r,Vt(ss),Vt(Ln),Bt(Ln,r)):Vt(ss),Bt(ss,m)}var Er=null,io=!1,Nu=!1;function _l(r){Er===null?Er=[r]:Er.push(r)}function Cu(r){io=!0,_l(r)}function Kr(){if(!Nu&&Er!==null){Nu=!0;var r=0,o=yt;try{var m=Er;for(yt=1;r<m.length;r++){var y=m[r];do y=y(!0);while(y!==null)}Er=null,io=!1}catch(k){throw Er!==null&&(Er=Er.slice(r+1)),Xs(Un,Kr),k}finally{yt=o,Nu=!1}}return null}var co=[],uo=0,Li=null,zi=0,bs=[],Fs=0,va=null,kr=1,Mr="";function ya(r,o){co[uo++]=zi,co[uo++]=Li,Li=r,zi=o}function fh(r,o,m){bs[Fs++]=kr,bs[Fs++]=Mr,bs[Fs++]=va,va=r;var y=kr;r=Mr;var k=32-je(y)-1;y&=~(1<<k),m+=1;var O=32-je(o)+k;if(30<O){var I=k-k%5;O=(y&(1<<I)-1).toString(32),y>>=I,k-=I,kr=1<<32-je(o)+k|m<<k|y,Mr=O+r}else kr=1<<O|m<<k|y,Mr=r}function Su(r){r.return!==null&&(ya(r,1),fh(r,1,0))}function Eu(r){for(;r===Li;)Li=co[--uo],co[uo]=null,zi=co[--uo],co[uo]=null;for(;r===va;)va=bs[--Fs],bs[Fs]=null,Mr=bs[--Fs],bs[Fs]=null,kr=bs[--Fs],bs[Fs]=null}var xs=null,ws=null,Gt=!1,tr=null;function ph(r,o){var m=pr(5,null,null,0);m.elementType="DELETED",m.stateNode=o,m.return=r,o=r.deletions,o===null?(r.deletions=[m],r.flags|=16):o.push(m)}function gh(r,o){switch(r.tag){case 5:var m=r.type;return o=o.nodeType!==1||m.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,xs=r,ws=Nr(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,xs=r,ws=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(m=va!==null?{id:kr,overflow:Mr}:null,r.memoizedState={dehydrated:o,treeContext:m,retryLane:1073741824},m=pr(18,null,null,0),m.stateNode=o,m.return=r,r.child=m,xs=r,ws=null,!0):!1;default:return!1}}function ku(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Mu(r){if(Gt){var o=ws;if(o){var m=o;if(!gh(r,o)){if(ku(r))throw Error(n(418));o=Nr(m.nextSibling);var y=xs;o&&gh(r,o)?ph(y,m):(r.flags=r.flags&-4097|2,Gt=!1,xs=r)}}else{if(ku(r))throw Error(n(418));r.flags=r.flags&-4097|2,Gt=!1,xs=r}}}function _h(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;xs=r}function Di(r){if(r!==xs)return!1;if(!Gt)return _h(r),Gt=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!vu(r.type,r.memoizedProps)),o&&(o=ws)){if(ku(r))throw vh(),Error(n(418));for(;o;)ph(r,o),o=Nr(o.nextSibling)}if(_h(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="/$"){if(o===0){ws=Nr(r.nextSibling);break e}o--}else m!=="$"&&m!=="$!"&&m!=="$?"||o++}r=r.nextSibling}ws=null}}else ws=xs?Nr(r.stateNode.nextSibling):null;return!0}function vh(){for(var r=ws;r;)r=Nr(r.nextSibling)}function mo(){ws=xs=null,Gt=!1}function Au(r){tr===null?tr=[r]:tr.push(r)}var Hg=j.ReactCurrentBatchConfig;function vl(r,o,m){if(r=m.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(n(309));var y=m.stateNode}if(!y)throw Error(n(147,r));var k=y,O=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===O?o.ref:(o=function(I){var te=k.refs;I===null?delete te[O]:te[O]=I},o._stringRef=O,o)}if(typeof r!="string")throw Error(n(284));if(!m._owner)throw Error(n(290,r))}return r}function Ri(r,o){throw r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function yh(r){var o=r._init;return o(r._payload)}function Ou(r){function o(ie,oe){if(r){var ue=ie.deletions;ue===null?(ie.deletions=[oe],ie.flags|=16):ue.push(oe)}}function m(ie,oe){if(!r)return null;for(;oe!==null;)o(ie,oe),oe=oe.sibling;return null}function y(ie,oe){for(ie=new Map;oe!==null;)oe.key!==null?ie.set(oe.key,oe):ie.set(oe.index,oe),oe=oe.sibling;return ie}function k(ie,oe){return ie=wo(ie,oe),ie.index=0,ie.sibling=null,ie}function O(ie,oe,ue){return ie.index=ue,r?(ue=ie.alternate,ue!==null?(ue=ue.index,ue<oe?(ie.flags|=2,oe):ue):(ie.flags|=2,oe)):(ie.flags|=1048576,oe)}function I(ie){return r&&ie.alternate===null&&(ie.flags|=2),ie}function te(ie,oe,ue,Se){return oe===null||oe.tag!==6?(oe=f_(ue,ie.mode,Se),oe.return=ie,oe):(oe=k(oe,ue),oe.return=ie,oe)}function ae(ie,oe,ue,Se){var qe=ue.type;return qe===$?be(ie,oe,ue.props.children,Se,ue.key):oe!==null&&(oe.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===U&&yh(qe)===oe.type)?(Se=k(oe,ue.props),Se.ref=vl(ie,oe,ue),Se.return=ie,Se):(Se=yf(ue.type,ue.key,ue.props,null,ie.mode,Se),Se.ref=vl(ie,oe,ue),Se.return=ie,Se)}function he(ie,oe,ue,Se){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==ue.containerInfo||oe.stateNode.implementation!==ue.implementation?(oe=p_(ue,ie.mode,Se),oe.return=ie,oe):(oe=k(oe,ue.children||[]),oe.return=ie,oe)}function be(ie,oe,ue,Se,qe){return oe===null||oe.tag!==7?(oe=Dl(ue,ie.mode,Se,qe),oe.return=ie,oe):(oe=k(oe,ue),oe.return=ie,oe)}function Ne(ie,oe,ue){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=f_(""+oe,ie.mode,ue),oe.return=ie,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case C:return ue=yf(oe.type,oe.key,oe.props,null,ie.mode,ue),ue.ref=vl(ie,null,oe),ue.return=ie,ue;case S:return oe=p_(oe,ie.mode,ue),oe.return=ie,oe;case U:var Se=oe._init;return Ne(ie,Se(oe._payload),ue)}if(ke(oe)||G(oe))return oe=Dl(oe,ie.mode,ue,null),oe.return=ie,oe;Ri(ie,oe)}return null}function ve(ie,oe,ue,Se){var qe=oe!==null?oe.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return qe!==null?null:te(ie,oe,""+ue,Se);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case C:return ue.key===qe?ae(ie,oe,ue,Se):null;case S:return ue.key===qe?he(ie,oe,ue,Se):null;case U:return qe=ue._init,ve(ie,oe,qe(ue._payload),Se)}if(ke(ue)||G(ue))return qe!==null?null:be(ie,oe,ue,Se,null);Ri(ie,ue)}return null}function Le(ie,oe,ue,Se,qe){if(typeof Se=="string"&&Se!==""||typeof Se=="number")return ie=ie.get(ue)||null,te(oe,ie,""+Se,qe);if(typeof Se=="object"&&Se!==null){switch(Se.$$typeof){case C:return ie=ie.get(Se.key===null?ue:Se.key)||null,ae(oe,ie,Se,qe);case S:return ie=ie.get(Se.key===null?ue:Se.key)||null,he(oe,ie,Se,qe);case U:var Qe=Se._init;return Le(ie,oe,ue,Qe(Se._payload),qe)}if(ke(Se)||G(Se))return ie=ie.get(ue)||null,be(oe,ie,Se,qe,null);Ri(oe,Se)}return null}function Re(ie,oe,ue,Se){for(var qe=null,Qe=null,Xe=oe,at=oe=0,Kn=null;Xe!==null&&at<ue.length;at++){Xe.index>at?(Kn=Xe,Xe=null):Kn=Xe.sibling;var Tt=ve(ie,Xe,ue[at],Se);if(Tt===null){Xe===null&&(Xe=Kn);break}r&&Xe&&Tt.alternate===null&&o(ie,Xe),oe=O(Tt,oe,at),Qe===null?qe=Tt:Qe.sibling=Tt,Qe=Tt,Xe=Kn}if(at===ue.length)return m(ie,Xe),Gt&&ya(ie,at),qe;if(Xe===null){for(;at<ue.length;at++)Xe=Ne(ie,ue[at],Se),Xe!==null&&(oe=O(Xe,oe,at),Qe===null?qe=Xe:Qe.sibling=Xe,Qe=Xe);return Gt&&ya(ie,at),qe}for(Xe=y(ie,Xe);at<ue.length;at++)Kn=Le(Xe,ie,at,ue[at],Se),Kn!==null&&(r&&Kn.alternate!==null&&Xe.delete(Kn.key===null?at:Kn.key),oe=O(Kn,oe,at),Qe===null?qe=Kn:Qe.sibling=Kn,Qe=Kn);return r&&Xe.forEach(function(jo){return o(ie,jo)}),Gt&&ya(ie,at),qe}function Be(ie,oe,ue,Se){var qe=G(ue);if(typeof qe!="function")throw Error(n(150));if(ue=qe.call(ue),ue==null)throw Error(n(151));for(var Qe=qe=null,Xe=oe,at=oe=0,Kn=null,Tt=ue.next();Xe!==null&&!Tt.done;at++,Tt=ue.next()){Xe.index>at?(Kn=Xe,Xe=null):Kn=Xe.sibling;var jo=ve(ie,Xe,Tt.value,Se);if(jo===null){Xe===null&&(Xe=Kn);break}r&&Xe&&jo.alternate===null&&o(ie,Xe),oe=O(jo,oe,at),Qe===null?qe=jo:Qe.sibling=jo,Qe=jo,Xe=Kn}if(Tt.done)return m(ie,Xe),Gt&&ya(ie,at),qe;if(Xe===null){for(;!Tt.done;at++,Tt=ue.next())Tt=Ne(ie,Tt.value,Se),Tt!==null&&(oe=O(Tt,oe,at),Qe===null?qe=Tt:Qe.sibling=Tt,Qe=Tt);return Gt&&ya(ie,at),qe}for(Xe=y(ie,Xe);!Tt.done;at++,Tt=ue.next())Tt=Le(Xe,ie,at,Tt.value,Se),Tt!==null&&(r&&Tt.alternate!==null&&Xe.delete(Tt.key===null?at:Tt.key),oe=O(Tt,oe,at),Qe===null?qe=Tt:Qe.sibling=Tt,Qe=Tt);return r&&Xe.forEach(function(dD){return o(ie,dD)}),Gt&&ya(ie,at),qe}function vn(ie,oe,ue,Se){if(typeof ue=="object"&&ue!==null&&ue.type===$&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case C:e:{for(var qe=ue.key,Qe=oe;Qe!==null;){if(Qe.key===qe){if(qe=ue.type,qe===$){if(Qe.tag===7){m(ie,Qe.sibling),oe=k(Qe,ue.props.children),oe.return=ie,ie=oe;break e}}else if(Qe.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===U&&yh(qe)===Qe.type){m(ie,Qe.sibling),oe=k(Qe,ue.props),oe.ref=vl(ie,Qe,ue),oe.return=ie,ie=oe;break e}m(ie,Qe);break}else o(ie,Qe);Qe=Qe.sibling}ue.type===$?(oe=Dl(ue.props.children,ie.mode,Se,ue.key),oe.return=ie,ie=oe):(Se=yf(ue.type,ue.key,ue.props,null,ie.mode,Se),Se.ref=vl(ie,oe,ue),Se.return=ie,ie=Se)}return I(ie);case S:e:{for(Qe=ue.key;oe!==null;){if(oe.key===Qe)if(oe.tag===4&&oe.stateNode.containerInfo===ue.containerInfo&&oe.stateNode.implementation===ue.implementation){m(ie,oe.sibling),oe=k(oe,ue.children||[]),oe.return=ie,ie=oe;break e}else{m(ie,oe);break}else o(ie,oe);oe=oe.sibling}oe=p_(ue,ie.mode,Se),oe.return=ie,ie=oe}return I(ie);case U:return Qe=ue._init,vn(ie,oe,Qe(ue._payload),Se)}if(ke(ue))return Re(ie,oe,ue,Se);if(G(ue))return Be(ie,oe,ue,Se);Ri(ie,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,oe!==null&&oe.tag===6?(m(ie,oe.sibling),oe=k(oe,ue),oe.return=ie,ie=oe):(m(ie,oe),oe=f_(ue,ie.mode,Se),oe.return=ie,ie=oe),I(ie)):m(ie,oe)}return vn}var ho=Ou(!0),Pu=Ou(!1),Fi=Sr(null),Ii=null,ba=null,Tu=null;function yl(){Tu=ba=Ii=null}function $u(r){var o=Fi.current;Vt(Fi),r._currentValue=o}function Lu(r,o,m){for(;r!==null;){var y=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,y!==null&&(y.childLanes|=o)):y!==null&&(y.childLanes&o)!==o&&(y.childLanes|=o),r===m)break;r=r.return}}function fo(r,o){Ii=r,Tu=ba=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&o&&(hs=!0),r.firstContext=null)}function Is(r){var o=r._currentValue;if(Tu!==r)if(r={context:r,memoizedValue:o,next:null},ba===null){if(Ii===null)throw Error(n(308));ba=r,Ii.dependencies={lanes:0,firstContext:r}}else ba=ba.next=r;return o}var xa=null;function zu(r){xa===null?xa=[r]:xa.push(r)}function bh(r,o,m,y){var k=o.interleaved;return k===null?(m.next=m,zu(o)):(m.next=k.next,k.next=m),o.interleaved=m,Ar(r,y)}function Ar(r,o){r.lanes|=o;var m=r.alternate;for(m!==null&&(m.lanes|=o),m=r,r=r.return;r!==null;)r.childLanes|=o,m=r.alternate,m!==null&&(m.childLanes|=o),m=r,r=r.return;return m.tag===3?m.stateNode:null}var Yr=!1;function Du(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xh(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function Or(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function Gr(r,o,m){var y=r.updateQueue;if(y===null)return null;if(y=y.shared,wt&2){var k=y.pending;return k===null?o.next=o:(o.next=k.next,k.next=o),y.pending=o,Ar(r,m)}return k=y.interleaved,k===null?(o.next=o,zu(y)):(o.next=k.next,k.next=o),y.interleaved=o,Ar(r,m)}function Bi(r,o,m){if(o=o.updateQueue,o!==null&&(o=o.shared,(m&4194240)!==0)){var y=o.lanes;y&=r.pendingLanes,m|=y,o.lanes=m,tl(r,m)}}function wh(r,o){var m=r.updateQueue,y=r.alternate;if(y!==null&&(y=y.updateQueue,m===y)){var k=null,O=null;if(m=m.firstBaseUpdate,m!==null){do{var I={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};O===null?k=O=I:O=O.next=I,m=m.next}while(m!==null);O===null?k=O=o:O=O.next=o}else k=O=o;m={baseState:y.baseState,firstBaseUpdate:k,lastBaseUpdate:O,shared:y.shared,effects:y.effects},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=o:r.next=o,m.lastBaseUpdate=o}function Ui(r,o,m,y){var k=r.updateQueue;Yr=!1;var O=k.firstBaseUpdate,I=k.lastBaseUpdate,te=k.shared.pending;if(te!==null){k.shared.pending=null;var ae=te,he=ae.next;ae.next=null,I===null?O=he:I.next=he,I=ae;var be=r.alternate;be!==null&&(be=be.updateQueue,te=be.lastBaseUpdate,te!==I&&(te===null?be.firstBaseUpdate=he:te.next=he,be.lastBaseUpdate=ae))}if(O!==null){var Ne=k.baseState;I=0,be=he=ae=null,te=O;do{var ve=te.lane,Le=te.eventTime;if((y&ve)===ve){be!==null&&(be=be.next={eventTime:Le,lane:0,tag:te.tag,payload:te.payload,callback:te.callback,next:null});e:{var Re=r,Be=te;switch(ve=o,Le=m,Be.tag){case 1:if(Re=Be.payload,typeof Re=="function"){Ne=Re.call(Le,Ne,ve);break e}Ne=Re;break e;case 3:Re.flags=Re.flags&-65537|128;case 0:if(Re=Be.payload,ve=typeof Re=="function"?Re.call(Le,Ne,ve):Re,ve==null)break e;Ne=q({},Ne,ve);break e;case 2:Yr=!0}}te.callback!==null&&te.lane!==0&&(r.flags|=64,ve=k.effects,ve===null?k.effects=[te]:ve.push(te))}else Le={eventTime:Le,lane:ve,tag:te.tag,payload:te.payload,callback:te.callback,next:null},be===null?(he=be=Le,ae=Ne):be=be.next=Le,I|=ve;if(te=te.next,te===null){if(te=k.shared.pending,te===null)break;ve=te,te=ve.next,ve.next=null,k.lastBaseUpdate=ve,k.shared.pending=null}}while(!0);if(be===null&&(ae=Ne),k.baseState=ae,k.firstBaseUpdate=he,k.lastBaseUpdate=be,o=k.shared.interleaved,o!==null){k=o;do I|=k.lane,k=k.next;while(k!==o)}else O===null&&(k.shared.lanes=0);Tl|=I,r.lanes=I,r.memoizedState=Ne}}function jh(r,o,m){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var y=r[o],k=y.callback;if(k!==null){if(y.callback=null,y=m,typeof k!="function")throw Error(n(191,k));k.call(y)}}}var bl={},dr=Sr(bl),xl=Sr(bl),wl=Sr(bl);function wa(r){if(r===bl)throw Error(n(174));return r}function Ru(r,o){switch(Bt(wl,o),Bt(xl,r),Bt(dr,bl),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:mt(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=mt(o,r)}Vt(dr),Bt(dr,o)}function po(){Vt(dr),Vt(xl),Vt(wl)}function Nh(r){wa(wl.current);var o=wa(dr.current),m=mt(o,r.type);o!==m&&(Bt(xl,r),Bt(dr,m))}function Fu(r){xl.current===r&&(Vt(dr),Vt(xl))}var Xt=Sr(0);function jl(r){for(var o=r;o!==null;){if(o.tag===13){var m=o.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Iu=[];function Bu(){for(var r=0;r<Iu.length;r++)Iu[r]._workInProgressVersionPrimary=null;Iu.length=0}var qi=j.ReactCurrentDispatcher,Uu=j.ReactCurrentBatchConfig,ja=0,Jt=null,$t=null,kn=null,Nl=!1,Na=!1,Cl=0,qu=0;function zn(){throw Error(n(321))}function Hu(r,o){if(o===null)return!1;for(var m=0;m<o.length&&m<r.length;m++)if(!Ds(r[m],o[m]))return!1;return!0}function Vu(r,o,m,y,k,O){if(ja=O,Jt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,qi.current=r===null||r.memoizedState===null?Kg:Yg,r=m(y,k),Na){O=0;do{if(Na=!1,Cl=0,25<=O)throw Error(n(301));O+=1,kn=$t=null,o.updateQueue=null,qi.current=Gg,r=m(y,k)}while(Na)}if(qi.current=Wi,o=$t!==null&&$t.next!==null,ja=0,kn=$t=Jt=null,Nl=!1,o)throw Error(n(300));return r}function Wu(){var r=Cl!==0;return Cl=0,r}function mr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kn===null?Jt.memoizedState=kn=r:kn=kn.next=r,kn}function Bs(){if($t===null){var r=Jt.alternate;r=r!==null?r.memoizedState:null}else r=$t.next;var o=kn===null?Jt.memoizedState:kn.next;if(o!==null)kn=o,$t=r;else{if(r===null)throw Error(n(310));$t=r,r={memoizedState:$t.memoizedState,baseState:$t.baseState,baseQueue:$t.baseQueue,queue:$t.queue,next:null},kn===null?Jt.memoizedState=kn=r:kn=kn.next=r}return kn}function Sl(r,o){return typeof o=="function"?o(r):o}function Ku(r){var o=Bs(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var y=$t,k=y.baseQueue,O=m.pending;if(O!==null){if(k!==null){var I=k.next;k.next=O.next,O.next=I}y.baseQueue=k=O,m.pending=null}if(k!==null){O=k.next,y=y.baseState;var te=I=null,ae=null,he=O;do{var be=he.lane;if((ja&be)===be)ae!==null&&(ae=ae.next={lane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),y=he.hasEagerState?he.eagerState:r(y,he.action);else{var Ne={lane:be,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null};ae===null?(te=ae=Ne,I=y):ae=ae.next=Ne,Jt.lanes|=be,Tl|=be}he=he.next}while(he!==null&&he!==O);ae===null?I=y:ae.next=te,Ds(y,o.memoizedState)||(hs=!0),o.memoizedState=y,o.baseState=I,o.baseQueue=ae,m.lastRenderedState=y}if(r=m.interleaved,r!==null){k=r;do O=k.lane,Jt.lanes|=O,Tl|=O,k=k.next;while(k!==r)}else k===null&&(m.lanes=0);return[o.memoizedState,m.dispatch]}function Yu(r){var o=Bs(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var y=m.dispatch,k=m.pending,O=o.memoizedState;if(k!==null){m.pending=null;var I=k=k.next;do O=r(O,I.action),I=I.next;while(I!==k);Ds(O,o.memoizedState)||(hs=!0),o.memoizedState=O,o.baseQueue===null&&(o.baseState=O),m.lastRenderedState=O}return[O,y]}function Ch(){}function Sh(r,o){var m=Jt,y=Bs(),k=o(),O=!Ds(y.memoizedState,k);if(O&&(y.memoizedState=k,hs=!0),y=y.queue,Gu(Mh.bind(null,m,y,r),[r]),y.getSnapshot!==o||O||kn!==null&&kn.memoizedState.tag&1){if(m.flags|=2048,El(9,kh.bind(null,m,y,k,o),void 0,null),nt===null)throw Error(n(349));ja&30||Eh(m,o,k)}return k}function Eh(r,o,m){r.flags|=16384,r={getSnapshot:o,value:m},o=Jt.updateQueue,o===null?(o={lastEffect:null,stores:null},Jt.updateQueue=o,o.stores=[r]):(m=o.stores,m===null?o.stores=[r]:m.push(r))}function kh(r,o,m,y){o.value=m,o.getSnapshot=y,Ah(o)&&Oh(r)}function Mh(r,o,m){return m(function(){Ah(o)&&Oh(r)})}function Ah(r){var o=r.getSnapshot;r=r.value;try{var m=o();return!Ds(r,m)}catch{return!0}}function Oh(r){var o=Ar(r,1);o!==null&&Lr(o,r,1,-1)}function Ph(r){var o=mr();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:r},o.queue=r,r=r.dispatch=kl.bind(null,Jt,r),[o.memoizedState,r]}function El(r,o,m,y){return r={tag:r,create:o,destroy:m,deps:y,next:null},o=Jt.updateQueue,o===null?(o={lastEffect:null,stores:null},Jt.updateQueue=o,o.lastEffect=r.next=r):(m=o.lastEffect,m===null?o.lastEffect=r.next=r:(y=m.next,m.next=r,r.next=y,o.lastEffect=r)),r}function Th(){return Bs().memoizedState}function Hi(r,o,m,y){var k=mr();Jt.flags|=r,k.memoizedState=El(1|o,m,void 0,y===void 0?null:y)}function Vi(r,o,m,y){var k=Bs();y=y===void 0?null:y;var O=void 0;if($t!==null){var I=$t.memoizedState;if(O=I.destroy,y!==null&&Hu(y,I.deps)){k.memoizedState=El(o,m,O,y);return}}Jt.flags|=r,k.memoizedState=El(1|o,m,O,y)}function $h(r,o){return Hi(8390656,8,r,o)}function Gu(r,o){return Vi(2048,8,r,o)}function Lh(r,o){return Vi(4,2,r,o)}function zh(r,o){return Vi(4,4,r,o)}function Dh(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function Rh(r,o,m){return m=m!=null?m.concat([r]):null,Vi(4,4,Dh.bind(null,o,r),m)}function Qu(){}function Fh(r,o){var m=Bs();o=o===void 0?null:o;var y=m.memoizedState;return y!==null&&o!==null&&Hu(o,y[1])?y[0]:(m.memoizedState=[r,o],r)}function Ih(r,o){var m=Bs();o=o===void 0?null:o;var y=m.memoizedState;return y!==null&&o!==null&&Hu(o,y[1])?y[0]:(r=r(),m.memoizedState=[r,o],r)}function Xu(r,o,m){return ja&21?(Ds(m,o)||(m=Pn(),Jt.lanes|=m,Tl|=m,r.baseState=!0),o):(r.baseState&&(r.baseState=!1,hs=!0),r.memoizedState=m)}function Vg(r,o){var m=yt;yt=m!==0&&4>m?m:4,r(!0);var y=Uu.transition;Uu.transition={};try{r(!1),o()}finally{yt=m,Uu.transition=y}}function Bh(){return Bs().memoizedState}function Wg(r,o,m){var y=bo(r);if(m={lane:y,action:m,hasEagerState:!1,eagerState:null,next:null},Ju(r))Uh(o,m);else if(m=bh(r,o,m,y),m!==null){var k=Ns();Lr(m,r,y,k),Zu(m,o,y)}}function kl(r,o,m){var y=bo(r),k={lane:y,action:m,hasEagerState:!1,eagerState:null,next:null};if(Ju(r))Uh(o,k);else{var O=r.alternate;if(r.lanes===0&&(O===null||O.lanes===0)&&(O=o.lastRenderedReducer,O!==null))try{var I=o.lastRenderedState,te=O(I,m);if(k.hasEagerState=!0,k.eagerState=te,Ds(te,I)){var ae=o.interleaved;ae===null?(k.next=k,zu(o)):(k.next=ae.next,ae.next=k),o.interleaved=k;return}}catch{}finally{}m=bh(r,o,k,y),m!==null&&(k=Ns(),Lr(m,r,y,k),Zu(m,o,y))}}function Ju(r){var o=r.alternate;return r===Jt||o!==null&&o===Jt}function Uh(r,o){Na=Nl=!0;var m=r.pending;m===null?o.next=o:(o.next=m.next,m.next=o),r.pending=o}function Zu(r,o,m){if(m&4194240){var y=o.lanes;y&=r.pendingLanes,m|=y,o.lanes=m,tl(r,m)}}var Wi={readContext:Is,useCallback:zn,useContext:zn,useEffect:zn,useImperativeHandle:zn,useInsertionEffect:zn,useLayoutEffect:zn,useMemo:zn,useReducer:zn,useRef:zn,useState:zn,useDebugValue:zn,useDeferredValue:zn,useTransition:zn,useMutableSource:zn,useSyncExternalStore:zn,useId:zn,unstable_isNewReconciler:!1},Kg={readContext:Is,useCallback:function(r,o){return mr().memoizedState=[r,o===void 0?null:o],r},useContext:Is,useEffect:$h,useImperativeHandle:function(r,o,m){return m=m!=null?m.concat([r]):null,Hi(4194308,4,Dh.bind(null,o,r),m)},useLayoutEffect:function(r,o){return Hi(4194308,4,r,o)},useInsertionEffect:function(r,o){return Hi(4,2,r,o)},useMemo:function(r,o){var m=mr();return o=o===void 0?null:o,r=r(),m.memoizedState=[r,o],r},useReducer:function(r,o,m){var y=mr();return o=m!==void 0?m(o):o,y.memoizedState=y.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},y.queue=r,r=r.dispatch=Wg.bind(null,Jt,r),[y.memoizedState,r]},useRef:function(r){var o=mr();return r={current:r},o.memoizedState=r},useState:Ph,useDebugValue:Qu,useDeferredValue:function(r){return mr().memoizedState=r},useTransition:function(){var r=Ph(!1),o=r[0];return r=Vg.bind(null,r[1]),mr().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,m){var y=Jt,k=mr();if(Gt){if(m===void 0)throw Error(n(407));m=m()}else{if(m=o(),nt===null)throw Error(n(349));ja&30||Eh(y,o,m)}k.memoizedState=m;var O={value:m,getSnapshot:o};return k.queue=O,$h(Mh.bind(null,y,O,r),[r]),y.flags|=2048,El(9,kh.bind(null,y,O,m,o),void 0,null),m},useId:function(){var r=mr(),o=nt.identifierPrefix;if(Gt){var m=Mr,y=kr;m=(y&~(1<<32-je(y)-1)).toString(32)+m,o=":"+o+"R"+m,m=Cl++,0<m&&(o+="H"+m.toString(32)),o+=":"}else m=qu++,o=":"+o+"r"+m.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},Yg={readContext:Is,useCallback:Fh,useContext:Is,useEffect:Gu,useImperativeHandle:Rh,useInsertionEffect:Lh,useLayoutEffect:zh,useMemo:Ih,useReducer:Ku,useRef:Th,useState:function(){return Ku(Sl)},useDebugValue:Qu,useDeferredValue:function(r){var o=Bs();return Xu(o,$t.memoizedState,r)},useTransition:function(){var r=Ku(Sl)[0],o=Bs().memoizedState;return[r,o]},useMutableSource:Ch,useSyncExternalStore:Sh,useId:Bh,unstable_isNewReconciler:!1},Gg={readContext:Is,useCallback:Fh,useContext:Is,useEffect:Gu,useImperativeHandle:Rh,useInsertionEffect:Lh,useLayoutEffect:zh,useMemo:Ih,useReducer:Yu,useRef:Th,useState:function(){return Yu(Sl)},useDebugValue:Qu,useDeferredValue:function(r){var o=Bs();return $t===null?o.memoizedState=r:Xu(o,$t.memoizedState,r)},useTransition:function(){var r=Yu(Sl)[0],o=Bs().memoizedState;return[r,o]},useMutableSource:Ch,useSyncExternalStore:Sh,useId:Bh,unstable_isNewReconciler:!1};function nr(r,o){if(r&&r.defaultProps){o=q({},o),r=r.defaultProps;for(var m in r)o[m]===void 0&&(o[m]=r[m]);return o}return o}function ed(r,o,m,y){o=r.memoizedState,m=m(y,o),m=m==null?o:q({},o,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Ki={isMounted:function(r){return(r=r._reactInternals)?Nn(r)===r:!1},enqueueSetState:function(r,o,m){r=r._reactInternals;var y=Ns(),k=bo(r),O=Or(y,k);O.payload=o,m!=null&&(O.callback=m),o=Gr(r,O,k),o!==null&&(Lr(o,r,k,y),Bi(o,r,k))},enqueueReplaceState:function(r,o,m){r=r._reactInternals;var y=Ns(),k=bo(r),O=Or(y,k);O.tag=1,O.payload=o,m!=null&&(O.callback=m),o=Gr(r,O,k),o!==null&&(Lr(o,r,k,y),Bi(o,r,k))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var m=Ns(),y=bo(r),k=Or(m,y);k.tag=2,o!=null&&(k.callback=o),o=Gr(r,k,y),o!==null&&(Lr(o,r,y,m),Bi(o,r,y))}};function qh(r,o,m,y,k,O,I){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(y,O,I):o.prototype&&o.prototype.isPureReactComponent?!no(m,y)||!no(k,O):!0}function Hh(r,o,m){var y=!1,k=Wr,O=o.contextType;return typeof O=="object"&&O!==null?O=Is(O):(k=ms(o)?Rs:Ln.current,y=o.contextTypes,O=(y=y!=null)?_a(r,k):Wr),o=new o(m,O),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Ki,r.stateNode=o,o._reactInternals=r,y&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=k,r.__reactInternalMemoizedMaskedChildContext=O),o}function Vh(r,o,m,y){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(m,y),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(m,y),o.state!==r&&Ki.enqueueReplaceState(o,o.state,null)}function td(r,o,m,y){var k=r.stateNode;k.props=m,k.state=r.memoizedState,k.refs={},Du(r);var O=o.contextType;typeof O=="object"&&O!==null?k.context=Is(O):(O=ms(o)?Rs:Ln.current,k.context=_a(r,O)),k.state=r.memoizedState,O=o.getDerivedStateFromProps,typeof O=="function"&&(ed(r,o,O,m),k.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(o=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),o!==k.state&&Ki.enqueueReplaceState(k,k.state,null),Ui(r,m,k,y),k.state=r.memoizedState),typeof k.componentDidMount=="function"&&(r.flags|=4194308)}function go(r,o){try{var m="",y=o;do m+=H(y),y=y.return;while(y);var k=m}catch(O){k=`
Error generating stack: `+O.message+`
`+O.stack}return{value:r,source:o,stack:k,digest:null}}function nd(r,o,m){return{value:r,source:null,stack:m??null,digest:o??null}}function sd(r,o){try{console.error(o.value)}catch(m){setTimeout(function(){throw m})}}var Qg=typeof WeakMap=="function"?WeakMap:Map;function Wh(r,o,m){m=Or(-1,m),m.tag=3,m.payload={element:null};var y=o.value;return m.callback=function(){hf||(hf=!0,o_=y),sd(r,o)},m}function Kh(r,o,m){m=Or(-1,m),m.tag=3;var y=r.type.getDerivedStateFromError;if(typeof y=="function"){var k=o.value;m.payload=function(){return y(k)},m.callback=function(){sd(r,o)}}var O=r.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(m.callback=function(){sd(r,o),typeof y!="function"&&(vo===null?vo=new Set([this]):vo.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),m}function Yh(r,o,m){var y=r.pingCache;if(y===null){y=r.pingCache=new Qg;var k=new Set;y.set(o,k)}else k=y.get(o),k===void 0&&(k=new Set,y.set(o,k));k.has(m)||(k.add(m),r=eD.bind(null,r,o,m),o.then(r,r))}function Gh(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function Qh(r,o,m,y,k){return r.mode&1?(r.flags|=65536,r.lanes=k,r):(r===o?r.flags|=65536:(r.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(o=Or(-1,1),o.tag=2,Gr(m,o,1))),m.lanes|=1),r)}var Xg=j.ReactCurrentOwner,hs=!1;function on(r,o,m,y){o.child=r===null?Pu(o,null,m,y):ho(o,r.child,m,y)}function Yi(r,o,m,y,k){m=m.render;var O=o.ref;return fo(o,k),y=Vu(r,o,m,y,O,k),m=Wu(),r!==null&&!hs?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~k,Tr(r,o,k)):(Gt&&m&&Su(o),o.flags|=1,on(r,o,y,k),o.child)}function rd(r,o,m,y,k){if(r===null){var O=m.type;return typeof O=="function"&&!h_(O)&&O.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(o.tag=15,o.type=O,ad(r,o,O,y,k)):(r=yf(m.type,null,y,o,o.mode,k),r.ref=o.ref,r.return=o,o.child=r)}if(O=r.child,!(r.lanes&k)){var I=O.memoizedProps;if(m=m.compare,m=m!==null?m:no,m(I,y)&&r.ref===o.ref)return Tr(r,o,k)}return o.flags|=1,r=wo(O,y),r.ref=o.ref,r.return=o,o.child=r}function ad(r,o,m,y,k){if(r!==null){var O=r.memoizedProps;if(no(O,y)&&r.ref===o.ref)if(hs=!1,o.pendingProps=y=O,(r.lanes&k)!==0)r.flags&131072&&(hs=!0);else return o.lanes=r.lanes,Tr(r,o,k)}return id(r,o,m,y,k)}function od(r,o,m){var y=o.pendingProps,k=y.children,O=r!==null?r.memoizedState:null;if(y.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Bt($r,rs),rs|=m;else{if(!(m&1073741824))return r=O!==null?O.baseLanes|m:m,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,Bt($r,rs),rs|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=O!==null?O.baseLanes:m,Bt($r,rs),rs|=y}else O!==null?(y=O.baseLanes|m,o.memoizedState=null):y=m,Bt($r,rs),rs|=y;return on(r,o,k,m),o.child}function ld(r,o){var m=o.ref;(r===null&&m!==null||r!==null&&r.ref!==m)&&(o.flags|=512,o.flags|=2097152)}function id(r,o,m,y,k){var O=ms(m)?Rs:Ln.current;return O=_a(o,O),fo(o,k),m=Vu(r,o,m,y,O,k),y=Wu(),r!==null&&!hs?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~k,Tr(r,o,k)):(Gt&&y&&Su(o),o.flags|=1,on(r,o,m,k),o.child)}function Pr(r,o,m,y,k){if(ms(m)){var O=!0;gl(o)}else O=!1;if(fo(o,k),o.stateNode===null)Ji(r,o),Hh(o,m,y),td(o,m,y,k),y=!0;else if(r===null){var I=o.stateNode,te=o.memoizedProps;I.props=te;var ae=I.context,he=m.contextType;typeof he=="object"&&he!==null?he=Is(he):(he=ms(m)?Rs:Ln.current,he=_a(o,he));var be=m.getDerivedStateFromProps,Ne=typeof be=="function"||typeof I.getSnapshotBeforeUpdate=="function";Ne||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(te!==y||ae!==he)&&Vh(o,I,y,he),Yr=!1;var ve=o.memoizedState;I.state=ve,Ui(o,y,I,k),ae=o.memoizedState,te!==y||ve!==ae||ss.current||Yr?(typeof be=="function"&&(ed(o,m,be,y),ae=o.memoizedState),(te=Yr||qh(o,m,te,y,ve,ae,he))?(Ne||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=y,o.memoizedState=ae),I.props=y,I.state=ae,I.context=he,y=te):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),y=!1)}else{I=o.stateNode,xh(r,o),te=o.memoizedProps,he=o.type===o.elementType?te:nr(o.type,te),I.props=he,Ne=o.pendingProps,ve=I.context,ae=m.contextType,typeof ae=="object"&&ae!==null?ae=Is(ae):(ae=ms(m)?Rs:Ln.current,ae=_a(o,ae));var Le=m.getDerivedStateFromProps;(be=typeof Le=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(te!==Ne||ve!==ae)&&Vh(o,I,y,ae),Yr=!1,ve=o.memoizedState,I.state=ve,Ui(o,y,I,k);var Re=o.memoizedState;te!==Ne||ve!==Re||ss.current||Yr?(typeof Le=="function"&&(ed(o,m,Le,y),Re=o.memoizedState),(he=Yr||qh(o,m,he,y,ve,Re,ae)||!1)?(be||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(y,Re,ae),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(y,Re,ae)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||te===r.memoizedProps&&ve===r.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||te===r.memoizedProps&&ve===r.memoizedState||(o.flags|=1024),o.memoizedProps=y,o.memoizedState=Re),I.props=y,I.state=Re,I.context=ae,y=he):(typeof I.componentDidUpdate!="function"||te===r.memoizedProps&&ve===r.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||te===r.memoizedProps&&ve===r.memoizedState||(o.flags|=1024),y=!1)}return Gi(r,o,m,y,O,k)}function Gi(r,o,m,y,k,O){ld(r,o);var I=(o.flags&128)!==0;if(!y&&!I)return k&&ju(o,m,!1),Tr(r,o,O);y=o.stateNode,Xg.current=o;var te=I&&typeof m.getDerivedStateFromError!="function"?null:y.render();return o.flags|=1,r!==null&&I?(o.child=ho(o,r.child,null,O),o.child=ho(o,null,te,O)):on(r,o,te,O),o.memoizedState=y.state,k&&ju(o,m,!0),o.child}function cd(r){var o=r.stateNode;o.pendingContext?wu(r,o.pendingContext,o.pendingContext!==o.context):o.context&&wu(r,o.context,!1),Ru(r,o.containerInfo)}function ud(r,o,m,y,k){return mo(),Au(k),o.flags|=256,on(r,o,m,y),o.child}var Qi={dehydrated:null,treeContext:null,retryLane:0};function Ml(r){return{baseLanes:r,cachePool:null,transitions:null}}function dd(r,o,m){var y=o.pendingProps,k=Xt.current,O=!1,I=(o.flags&128)!==0,te;if((te=I)||(te=r!==null&&r.memoizedState===null?!1:(k&2)!==0),te?(O=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(k|=1),Bt(Xt,k&1),r===null)return Mu(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(o.mode&1?r.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(I=y.children,r=y.fallback,O?(y=o.mode,O=o.child,I={mode:"hidden",children:I},!(y&1)&&O!==null?(O.childLanes=0,O.pendingProps=I):O=bf(I,y,0,null),r=Dl(r,y,m,null),O.return=o,r.return=o,O.sibling=r,o.child=O,o.child.memoizedState=Ml(m),o.memoizedState=Qi,r):Xi(o,I));if(k=r.memoizedState,k!==null&&(te=k.dehydrated,te!==null))return Jg(r,o,I,y,te,k,m);if(O){O=y.fallback,I=o.mode,k=r.child,te=k.sibling;var ae={mode:"hidden",children:y.children};return!(I&1)&&o.child!==k?(y=o.child,y.childLanes=0,y.pendingProps=ae,o.deletions=null):(y=wo(k,ae),y.subtreeFlags=k.subtreeFlags&14680064),te!==null?O=wo(te,O):(O=Dl(O,I,m,null),O.flags|=2),O.return=o,y.return=o,y.sibling=O,o.child=y,y=O,O=o.child,I=r.child.memoizedState,I=I===null?Ml(m):{baseLanes:I.baseLanes|m,cachePool:null,transitions:I.transitions},O.memoizedState=I,O.childLanes=r.childLanes&~m,o.memoizedState=Qi,y}return O=r.child,r=O.sibling,y=wo(O,{mode:"visible",children:y.children}),!(o.mode&1)&&(y.lanes=m),y.return=o,y.sibling=null,r!==null&&(m=o.deletions,m===null?(o.deletions=[r],o.flags|=16):m.push(r)),o.child=y,o.memoizedState=null,y}function Xi(r,o){return o=bf({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function Al(r,o,m,y){return y!==null&&Au(y),ho(o,r.child,null,m),r=Xi(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function Jg(r,o,m,y,k,O,I){if(m)return o.flags&256?(o.flags&=-257,y=nd(Error(n(422))),Al(r,o,I,y)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):(O=y.fallback,k=o.mode,y=bf({mode:"visible",children:y.children},k,0,null),O=Dl(O,k,I,null),O.flags|=2,y.return=o,O.return=o,y.sibling=O,o.child=y,o.mode&1&&ho(o,r.child,null,I),o.child.memoizedState=Ml(I),o.memoizedState=Qi,O);if(!(o.mode&1))return Al(r,o,I,null);if(k.data==="$!"){if(y=k.nextSibling&&k.nextSibling.dataset,y)var te=y.dgst;return y=te,O=Error(n(419)),y=nd(O,y,void 0),Al(r,o,I,y)}if(te=(I&r.childLanes)!==0,hs||te){if(y=nt,y!==null){switch(I&-I){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=k&(y.suspendedLanes|I)?0:k,k!==0&&k!==O.retryLane&&(O.retryLane=k,Ar(r,k),Lr(y,r,k,-1))}return m_(),y=nd(Error(n(421))),Al(r,o,I,y)}return k.data==="$?"?(o.flags|=128,o.child=r.child,o=tD.bind(null,r),k._reactRetry=o,null):(r=O.treeContext,ws=Nr(k.nextSibling),xs=o,Gt=!0,tr=null,r!==null&&(bs[Fs++]=kr,bs[Fs++]=Mr,bs[Fs++]=va,kr=r.id,Mr=r.overflow,va=o),o=Xi(o,y.children),o.flags|=4096,o)}function Xh(r,o,m){r.lanes|=o;var y=r.alternate;y!==null&&(y.lanes|=o),Lu(r.return,o,m)}function md(r,o,m,y,k){var O=r.memoizedState;O===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:y,tail:m,tailMode:k}:(O.isBackwards=o,O.rendering=null,O.renderingStartTime=0,O.last=y,O.tail=m,O.tailMode=k)}function Jh(r,o,m){var y=o.pendingProps,k=y.revealOrder,O=y.tail;if(on(r,o,y.children,m),y=Xt.current,y&2)y=y&1|2,o.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&Xh(r,m,o);else if(r.tag===19)Xh(r,m,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}y&=1}if(Bt(Xt,y),!(o.mode&1))o.memoizedState=null;else switch(k){case"forwards":for(m=o.child,k=null;m!==null;)r=m.alternate,r!==null&&jl(r)===null&&(k=m),m=m.sibling;m=k,m===null?(k=o.child,o.child=null):(k=m.sibling,m.sibling=null),md(o,!1,k,m,O);break;case"backwards":for(m=null,k=o.child,o.child=null;k!==null;){if(r=k.alternate,r!==null&&jl(r)===null){o.child=k;break}r=k.sibling,k.sibling=m,m=k,k=r}md(o,!0,m,null,O);break;case"together":md(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Ji(r,o){!(o.mode&1)&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function Tr(r,o,m){if(r!==null&&(o.dependencies=r.dependencies),Tl|=o.lanes,!(m&o.childLanes))return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,m=wo(r,r.pendingProps),o.child=m,m.return=o;r.sibling!==null;)r=r.sibling,m=m.sibling=wo(r,r.pendingProps),m.return=o;m.sibling=null}return o.child}function Zi(r,o,m){switch(o.tag){case 3:cd(o),mo();break;case 5:Nh(o);break;case 1:ms(o.type)&&gl(o);break;case 4:Ru(o,o.stateNode.containerInfo);break;case 10:var y=o.type._context,k=o.memoizedProps.value;Bt(Fi,y._currentValue),y._currentValue=k;break;case 13:if(y=o.memoizedState,y!==null)return y.dehydrated!==null?(Bt(Xt,Xt.current&1),o.flags|=128,null):m&o.child.childLanes?dd(r,o,m):(Bt(Xt,Xt.current&1),r=Tr(r,o,m),r!==null?r.sibling:null);Bt(Xt,Xt.current&1);break;case 19:if(y=(m&o.childLanes)!==0,r.flags&128){if(y)return Jh(r,o,m);o.flags|=128}if(k=o.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Bt(Xt,Xt.current),y)break;return null;case 22:case 23:return o.lanes=0,od(r,o,m)}return Tr(r,o,m)}var hd,fd,Zh,ef;hd=function(r,o){for(var m=o.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},fd=function(){},Zh=function(r,o,m,y){var k=r.memoizedProps;if(k!==y){r=o.stateNode,wa(dr.current);var O=null;switch(m){case"input":k=Fe(r,k),y=Fe(r,y),O=[];break;case"select":k=q({},k,{value:void 0}),y=q({},y,{value:void 0}),O=[];break;case"textarea":k=ce(r,k),y=ce(r,y),O=[];break;default:typeof k.onClick!="function"&&typeof y.onClick=="function"&&(r.onclick=ro)}sn(m,y);var I;m=null;for(he in k)if(!y.hasOwnProperty(he)&&k.hasOwnProperty(he)&&k[he]!=null)if(he==="style"){var te=k[he];for(I in te)te.hasOwnProperty(I)&&(m||(m={}),m[I]="")}else he!=="dangerouslySetInnerHTML"&&he!=="children"&&he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&he!=="autoFocus"&&(l.hasOwnProperty(he)?O||(O=[]):(O=O||[]).push(he,null));for(he in y){var ae=y[he];if(te=k!=null?k[he]:void 0,y.hasOwnProperty(he)&&ae!==te&&(ae!=null||te!=null))if(he==="style")if(te){for(I in te)!te.hasOwnProperty(I)||ae&&ae.hasOwnProperty(I)||(m||(m={}),m[I]="");for(I in ae)ae.hasOwnProperty(I)&&te[I]!==ae[I]&&(m||(m={}),m[I]=ae[I])}else m||(O||(O=[]),O.push(he,m)),m=ae;else he==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,te=te?te.__html:void 0,ae!=null&&te!==ae&&(O=O||[]).push(he,ae)):he==="children"?typeof ae!="string"&&typeof ae!="number"||(O=O||[]).push(he,""+ae):he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&(l.hasOwnProperty(he)?(ae!=null&&he==="onScroll"&&Kt("scroll",r),O||te===ae||(O=[])):(O=O||[]).push(he,ae))}m&&(O=O||[]).push("style",m);var he=O;(o.updateQueue=he)&&(o.flags|=4)}},ef=function(r,o,m,y){m!==y&&(o.flags|=4)};function Ol(r,o){if(!Gt)switch(r.tailMode){case"hidden":o=r.tail;for(var m=null;o!==null;)o.alternate!==null&&(m=o),o=o.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var y=null;m!==null;)m.alternate!==null&&(y=m),m=m.sibling;y===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:y.sibling=null}}function Vn(r){var o=r.alternate!==null&&r.alternate.child===r.child,m=0,y=0;if(o)for(var k=r.child;k!==null;)m|=k.lanes|k.childLanes,y|=k.subtreeFlags&14680064,y|=k.flags&14680064,k.return=r,k=k.sibling;else for(k=r.child;k!==null;)m|=k.lanes|k.childLanes,y|=k.subtreeFlags,y|=k.flags,k.return=r,k=k.sibling;return r.subtreeFlags|=y,r.childLanes=m,o}function Zg(r,o,m){var y=o.pendingProps;switch(Eu(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vn(o),null;case 1:return ms(o.type)&&pl(),Vn(o),null;case 3:return y=o.stateNode,po(),Vt(ss),Vt(Ln),Bu(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(r===null||r.child===null)&&(Di(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,tr!==null&&(c_(tr),tr=null))),fd(r,o),Vn(o),null;case 5:Fu(o);var k=wa(wl.current);if(m=o.type,r!==null&&o.stateNode!=null)Zh(r,o,m,y,k),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!y){if(o.stateNode===null)throw Error(n(166));return Vn(o),null}if(r=wa(dr.current),Di(o)){y=o.stateNode,m=o.type;var O=o.memoizedProps;switch(y[ur]=o,y[ml]=O,r=(o.mode&1)!==0,m){case"dialog":Kt("cancel",y),Kt("close",y);break;case"iframe":case"object":case"embed":Kt("load",y);break;case"video":case"audio":for(k=0;k<il.length;k++)Kt(il[k],y);break;case"source":Kt("error",y);break;case"img":case"image":case"link":Kt("error",y),Kt("load",y);break;case"details":Kt("toggle",y);break;case"input":Ke(y,O),Kt("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!O.multiple},Kt("invalid",y);break;case"textarea":Oe(y,O),Kt("invalid",y)}sn(m,O),k=null;for(var I in O)if(O.hasOwnProperty(I)){var te=O[I];I==="children"?typeof te=="string"?y.textContent!==te&&(O.suppressHydrationWarning!==!0&&Ti(y.textContent,te,r),k=["children",te]):typeof te=="number"&&y.textContent!==""+te&&(O.suppressHydrationWarning!==!0&&Ti(y.textContent,te,r),k=["children",""+te]):l.hasOwnProperty(I)&&te!=null&&I==="onScroll"&&Kt("scroll",y)}switch(m){case"input":we(y),pe(y,O,!0);break;case"textarea":we(y),ct(y);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(y.onclick=ro)}y=k,o.updateQueue=y,y!==null&&(o.flags|=4)}else{I=k.nodeType===9?k:k.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Je(m)),r==="http://www.w3.org/1999/xhtml"?m==="script"?(r=I.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof y.is=="string"?r=I.createElement(m,{is:y.is}):(r=I.createElement(m),m==="select"&&(I=r,y.multiple?I.multiple=!0:y.size&&(I.size=y.size))):r=I.createElementNS(r,m),r[ur]=o,r[ml]=y,hd(r,o,!1,!1),o.stateNode=r;e:{switch(I=wn(m,y),m){case"dialog":Kt("cancel",r),Kt("close",r),k=y;break;case"iframe":case"object":case"embed":Kt("load",r),k=y;break;case"video":case"audio":for(k=0;k<il.length;k++)Kt(il[k],r);k=y;break;case"source":Kt("error",r),k=y;break;case"img":case"image":case"link":Kt("error",r),Kt("load",r),k=y;break;case"details":Kt("toggle",r),k=y;break;case"input":Ke(r,y),k=Fe(r,y),Kt("invalid",r);break;case"option":k=y;break;case"select":r._wrapperState={wasMultiple:!!y.multiple},k=q({},y,{value:void 0}),Kt("invalid",r);break;case"textarea":Oe(r,y),k=ce(r,y),Kt("invalid",r);break;default:k=y}sn(m,k),te=k;for(O in te)if(te.hasOwnProperty(O)){var ae=te[O];O==="style"?ht(r,ae):O==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&ot(r,ae)):O==="children"?typeof ae=="string"?(m!=="textarea"||ae!=="")&&Et(r,ae):typeof ae=="number"&&Et(r,""+ae):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(l.hasOwnProperty(O)?ae!=null&&O==="onScroll"&&Kt("scroll",r):ae!=null&&M(r,O,ae,I))}switch(m){case"input":we(r),pe(r,y,!1);break;case"textarea":we(r),ct(r);break;case"option":y.value!=null&&r.setAttribute("value",""+ee(y.value));break;case"select":r.multiple=!!y.multiple,O=y.value,O!=null?De(r,!!y.multiple,O,!1):y.defaultValue!=null&&De(r,!!y.multiple,y.defaultValue,!0);break;default:typeof k.onClick=="function"&&(r.onclick=ro)}switch(m){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Vn(o),null;case 6:if(r&&o.stateNode!=null)ef(r,o,r.memoizedProps,y);else{if(typeof y!="string"&&o.stateNode===null)throw Error(n(166));if(m=wa(wl.current),wa(dr.current),Di(o)){if(y=o.stateNode,m=o.memoizedProps,y[ur]=o,(O=y.nodeValue!==m)&&(r=xs,r!==null))switch(r.tag){case 3:Ti(y.nodeValue,m,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Ti(y.nodeValue,m,(r.mode&1)!==0)}O&&(o.flags|=4)}else y=(m.nodeType===9?m:m.ownerDocument).createTextNode(y),y[ur]=o,o.stateNode=y}return Vn(o),null;case 13:if(Vt(Xt),y=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(Gt&&ws!==null&&o.mode&1&&!(o.flags&128))vh(),mo(),o.flags|=98560,O=!1;else if(O=Di(o),y!==null&&y.dehydrated!==null){if(r===null){if(!O)throw Error(n(318));if(O=o.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(n(317));O[ur]=o}else mo(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Vn(o),O=!1}else tr!==null&&(c_(tr),tr=null),O=!0;if(!O)return o.flags&65536?o:null}return o.flags&128?(o.lanes=m,o):(y=y!==null,y!==(r!==null&&r.memoizedState!==null)&&y&&(o.child.flags|=8192,o.mode&1&&(r===null||Xt.current&1?ln===0&&(ln=3):m_())),o.updateQueue!==null&&(o.flags|=4),Vn(o),null);case 4:return po(),fd(r,o),r===null&&cl(o.stateNode.containerInfo),Vn(o),null;case 10:return $u(o.type._context),Vn(o),null;case 17:return ms(o.type)&&pl(),Vn(o),null;case 19:if(Vt(Xt),O=o.memoizedState,O===null)return Vn(o),null;if(y=(o.flags&128)!==0,I=O.rendering,I===null)if(y)Ol(O,!1);else{if(ln!==0||r!==null&&r.flags&128)for(r=o.child;r!==null;){if(I=jl(r),I!==null){for(o.flags|=128,Ol(O,!1),y=I.updateQueue,y!==null&&(o.updateQueue=y,o.flags|=4),o.subtreeFlags=0,y=m,m=o.child;m!==null;)O=m,r=y,O.flags&=14680066,I=O.alternate,I===null?(O.childLanes=0,O.lanes=r,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=I.childLanes,O.lanes=I.lanes,O.child=I.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=I.memoizedProps,O.memoizedState=I.memoizedState,O.updateQueue=I.updateQueue,O.type=I.type,r=I.dependencies,O.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),m=m.sibling;return Bt(Xt,Xt.current&1|2),o.child}r=r.sibling}O.tail!==null&&st()>rc&&(o.flags|=128,y=!0,Ol(O,!1),o.lanes=4194304)}else{if(!y)if(r=jl(I),r!==null){if(o.flags|=128,y=!0,m=r.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),Ol(O,!0),O.tail===null&&O.tailMode==="hidden"&&!I.alternate&&!Gt)return Vn(o),null}else 2*st()-O.renderingStartTime>rc&&m!==1073741824&&(o.flags|=128,y=!0,Ol(O,!1),o.lanes=4194304);O.isBackwards?(I.sibling=o.child,o.child=I):(m=O.last,m!==null?m.sibling=I:o.child=I,O.last=I)}return O.tail!==null?(o=O.tail,O.rendering=o,O.tail=o.sibling,O.renderingStartTime=st(),o.sibling=null,m=Xt.current,Bt(Xt,y?m&1|2:m&1),o):(Vn(o),null);case 22:case 23:return d_(),y=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==y&&(o.flags|=8192),y&&o.mode&1?rs&1073741824&&(Vn(o),o.subtreeFlags&6&&(o.flags|=8192)):Vn(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function e_(r,o){switch(Eu(o),o.tag){case 1:return ms(o.type)&&pl(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return po(),Vt(ss),Vt(Ln),Bu(),r=o.flags,r&65536&&!(r&128)?(o.flags=r&-65537|128,o):null;case 5:return Fu(o),null;case 13:if(Vt(Xt),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));mo()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Vt(Xt),null;case 4:return po(),null;case 10:return $u(o.type._context),null;case 22:case 23:return d_(),null;case 24:return null;default:return null}}var ec=!1,Wn=!1,t_=typeof WeakSet=="function"?WeakSet:Set,ze=null;function _o(r,o){var m=r.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(y){pn(r,o,y)}else m.current=null}function pd(r,o,m){try{m()}catch(y){pn(r,o,y)}}var tf=!1;function n_(r,o){if(ao=Ls,r=cu(),Si(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var y=m.getSelection&&m.getSelection();if(y&&y.rangeCount!==0){m=y.anchorNode;var k=y.anchorOffset,O=y.focusNode;y=y.focusOffset;try{m.nodeType,O.nodeType}catch{m=null;break e}var I=0,te=-1,ae=-1,he=0,be=0,Ne=r,ve=null;t:for(;;){for(var Le;Ne!==m||k!==0&&Ne.nodeType!==3||(te=I+k),Ne!==O||y!==0&&Ne.nodeType!==3||(ae=I+y),Ne.nodeType===3&&(I+=Ne.nodeValue.length),(Le=Ne.firstChild)!==null;)ve=Ne,Ne=Le;for(;;){if(Ne===r)break t;if(ve===m&&++he===k&&(te=I),ve===O&&++be===y&&(ae=I),(Le=Ne.nextSibling)!==null)break;Ne=ve,ve=Ne.parentNode}Ne=Le}m=te===-1||ae===-1?null:{start:te,end:ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(dl={focusedElem:r,selectionRange:m},Ls=!1,ze=o;ze!==null;)if(o=ze,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,ze=r;else for(;ze!==null;){o=ze;try{var Re=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Re!==null){var Be=Re.memoizedProps,vn=Re.memoizedState,ie=o.stateNode,oe=ie.getSnapshotBeforeUpdate(o.elementType===o.type?Be:nr(o.type,Be),vn);ie.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var ue=o.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Se){pn(o,o.return,Se)}if(r=o.sibling,r!==null){r.return=o.return,ze=r;break}ze=o.return}return Re=tf,tf=!1,Re}function Pl(r,o,m){var y=o.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var k=y=y.next;do{if((k.tag&r)===r){var O=k.destroy;k.destroy=void 0,O!==void 0&&pd(o,m,O)}k=k.next}while(k!==y)}}function tc(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var m=o=o.next;do{if((m.tag&r)===r){var y=m.create;m.destroy=y()}m=m.next}while(m!==o)}}function gd(r){var o=r.ref;if(o!==null){var m=r.stateNode;switch(r.tag){case 5:r=m;break;default:r=m}typeof o=="function"?o(r):o.current=r}}function nf(r){var o=r.alternate;o!==null&&(r.alternate=null,nf(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[ur],delete o[ml],delete o[xu],delete o[Ug],delete o[qg])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function sf(r){return r.tag===5||r.tag===3||r.tag===4}function rf(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||sf(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function _d(r,o,m){var y=r.tag;if(y===5||y===6)r=r.stateNode,o?m.nodeType===8?m.parentNode.insertBefore(r,o):m.insertBefore(r,o):(m.nodeType===8?(o=m.parentNode,o.insertBefore(r,m)):(o=m,o.appendChild(r)),m=m._reactRootContainer,m!=null||o.onclick!==null||(o.onclick=ro));else if(y!==4&&(r=r.child,r!==null))for(_d(r,o,m),r=r.sibling;r!==null;)_d(r,o,m),r=r.sibling}function vd(r,o,m){var y=r.tag;if(y===5||y===6)r=r.stateNode,o?m.insertBefore(r,o):m.appendChild(r);else if(y!==4&&(r=r.child,r!==null))for(vd(r,o,m),r=r.sibling;r!==null;)vd(r,o,m),r=r.sibling}var Dn=null,sr=!1;function Qr(r,o,m){for(m=m.child;m!==null;)af(r,o,m),m=m.sibling}function af(r,o,m){if($e&&typeof $e.onCommitFiberUnmount=="function")try{$e.onCommitFiberUnmount(_e,m)}catch{}switch(m.tag){case 5:Wn||_o(m,o);case 6:var y=Dn,k=sr;Dn=null,Qr(r,o,m),Dn=y,sr=k,Dn!==null&&(sr?(r=Dn,m=m.stateNode,r.nodeType===8?r.parentNode.removeChild(m):r.removeChild(m)):Dn.removeChild(m.stateNode));break;case 18:Dn!==null&&(sr?(r=Dn,m=m.stateNode,r.nodeType===8?bu(r.parentNode,m):r.nodeType===1&&bu(r,m),Sn(r)):bu(Dn,m.stateNode));break;case 4:y=Dn,k=sr,Dn=m.stateNode.containerInfo,sr=!0,Qr(r,o,m),Dn=y,sr=k;break;case 0:case 11:case 14:case 15:if(!Wn&&(y=m.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){k=y=y.next;do{var O=k,I=O.destroy;O=O.tag,I!==void 0&&(O&2||O&4)&&pd(m,o,I),k=k.next}while(k!==y)}Qr(r,o,m);break;case 1:if(!Wn&&(_o(m,o),y=m.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=m.memoizedProps,y.state=m.memoizedState,y.componentWillUnmount()}catch(te){pn(m,o,te)}Qr(r,o,m);break;case 21:Qr(r,o,m);break;case 22:m.mode&1?(Wn=(y=Wn)||m.memoizedState!==null,Qr(r,o,m),Wn=y):Qr(r,o,m);break;default:Qr(r,o,m)}}function of(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var m=r.stateNode;m===null&&(m=r.stateNode=new t_),o.forEach(function(y){var k=nD.bind(null,r,y);m.has(y)||(m.add(y),y.then(k,k))})}}function rr(r,o){var m=o.deletions;if(m!==null)for(var y=0;y<m.length;y++){var k=m[y];try{var O=r,I=o,te=I;e:for(;te!==null;){switch(te.tag){case 5:Dn=te.stateNode,sr=!1;break e;case 3:Dn=te.stateNode.containerInfo,sr=!0;break e;case 4:Dn=te.stateNode.containerInfo,sr=!0;break e}te=te.return}if(Dn===null)throw Error(n(160));af(O,I,k),Dn=null,sr=!1;var ae=k.alternate;ae!==null&&(ae.return=null),k.return=null}catch(he){pn(k,o,he)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)lf(o,r),o=o.sibling}function lf(r,o){var m=r.alternate,y=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(rr(o,r),hr(r),y&4){try{Pl(3,r,r.return),tc(3,r)}catch(Be){pn(r,r.return,Be)}try{Pl(5,r,r.return)}catch(Be){pn(r,r.return,Be)}}break;case 1:rr(o,r),hr(r),y&512&&m!==null&&_o(m,m.return);break;case 5:if(rr(o,r),hr(r),y&512&&m!==null&&_o(m,m.return),r.flags&32){var k=r.stateNode;try{Et(k,"")}catch(Be){pn(r,r.return,Be)}}if(y&4&&(k=r.stateNode,k!=null)){var O=r.memoizedProps,I=m!==null?m.memoizedProps:O,te=r.type,ae=r.updateQueue;if(r.updateQueue=null,ae!==null)try{te==="input"&&O.type==="radio"&&O.name!=null&&Ue(k,O),wn(te,I);var he=wn(te,O);for(I=0;I<ae.length;I+=2){var be=ae[I],Ne=ae[I+1];be==="style"?ht(k,Ne):be==="dangerouslySetInnerHTML"?ot(k,Ne):be==="children"?Et(k,Ne):M(k,be,Ne,he)}switch(te){case"input":de(k,O);break;case"textarea":Ye(k,O);break;case"select":var ve=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!O.multiple;var Le=O.value;Le!=null?De(k,!!O.multiple,Le,!1):ve!==!!O.multiple&&(O.defaultValue!=null?De(k,!!O.multiple,O.defaultValue,!0):De(k,!!O.multiple,O.multiple?[]:"",!1))}k[ml]=O}catch(Be){pn(r,r.return,Be)}}break;case 6:if(rr(o,r),hr(r),y&4){if(r.stateNode===null)throw Error(n(162));k=r.stateNode,O=r.memoizedProps;try{k.nodeValue=O}catch(Be){pn(r,r.return,Be)}}break;case 3:if(rr(o,r),hr(r),y&4&&m!==null&&m.memoizedState.isDehydrated)try{Sn(o.containerInfo)}catch(Be){pn(r,r.return,Be)}break;case 4:rr(o,r),hr(r);break;case 13:rr(o,r),hr(r),k=r.child,k.flags&8192&&(O=k.memoizedState!==null,k.stateNode.isHidden=O,!O||k.alternate!==null&&k.alternate.memoizedState!==null||(a_=st())),y&4&&of(r);break;case 22:if(be=m!==null&&m.memoizedState!==null,r.mode&1?(Wn=(he=Wn)||be,rr(o,r),Wn=he):rr(o,r),hr(r),y&8192){if(he=r.memoizedState!==null,(r.stateNode.isHidden=he)&&!be&&r.mode&1)for(ze=r,be=r.child;be!==null;){for(Ne=ze=be;ze!==null;){switch(ve=ze,Le=ve.child,ve.tag){case 0:case 11:case 14:case 15:Pl(4,ve,ve.return);break;case 1:_o(ve,ve.return);var Re=ve.stateNode;if(typeof Re.componentWillUnmount=="function"){y=ve,m=ve.return;try{o=y,Re.props=o.memoizedProps,Re.state=o.memoizedState,Re.componentWillUnmount()}catch(Be){pn(y,m,Be)}}break;case 5:_o(ve,ve.return);break;case 22:if(ve.memoizedState!==null){df(Ne);continue}}Le!==null?(Le.return=ve,ze=Le):df(Ne)}be=be.sibling}e:for(be=null,Ne=r;;){if(Ne.tag===5){if(be===null){be=Ne;try{k=Ne.stateNode,he?(O=k.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(te=Ne.stateNode,ae=Ne.memoizedProps.style,I=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,te.style.display=Dt("display",I))}catch(Be){pn(r,r.return,Be)}}}else if(Ne.tag===6){if(be===null)try{Ne.stateNode.nodeValue=he?"":Ne.memoizedProps}catch(Be){pn(r,r.return,Be)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===r)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===r)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===r)break e;be===Ne&&(be=null),Ne=Ne.return}be===Ne&&(be=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:rr(o,r),hr(r),y&4&&of(r);break;case 21:break;default:rr(o,r),hr(r)}}function hr(r){var o=r.flags;if(o&2){try{e:{for(var m=r.return;m!==null;){if(sf(m)){var y=m;break e}m=m.return}throw Error(n(160))}switch(y.tag){case 5:var k=y.stateNode;y.flags&32&&(Et(k,""),y.flags&=-33);var O=rf(r);vd(r,O,k);break;case 3:case 4:var I=y.stateNode.containerInfo,te=rf(r);_d(r,te,I);break;default:throw Error(n(161))}}catch(ae){pn(r,r.return,ae)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function s_(r,o,m){ze=r,cf(r)}function cf(r,o,m){for(var y=(r.mode&1)!==0;ze!==null;){var k=ze,O=k.child;if(k.tag===22&&y){var I=k.memoizedState!==null||ec;if(!I){var te=k.alternate,ae=te!==null&&te.memoizedState!==null||Wn;te=ec;var he=Wn;if(ec=I,(Wn=ae)&&!he)for(ze=k;ze!==null;)I=ze,ae=I.child,I.tag===22&&I.memoizedState!==null?fr(k):ae!==null?(ae.return=I,ze=ae):fr(k);for(;O!==null;)ze=O,cf(O),O=O.sibling;ze=k,ec=te,Wn=he}uf(r)}else k.subtreeFlags&8772&&O!==null?(O.return=k,ze=O):uf(r)}}function uf(r){for(;ze!==null;){var o=ze;if(o.flags&8772){var m=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Wn||tc(5,o);break;case 1:var y=o.stateNode;if(o.flags&4&&!Wn)if(m===null)y.componentDidMount();else{var k=o.elementType===o.type?m.memoizedProps:nr(o.type,m.memoizedProps);y.componentDidUpdate(k,m.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var O=o.updateQueue;O!==null&&jh(o,O,y);break;case 3:var I=o.updateQueue;if(I!==null){if(m=null,o.child!==null)switch(o.child.tag){case 5:m=o.child.stateNode;break;case 1:m=o.child.stateNode}jh(o,I,m)}break;case 5:var te=o.stateNode;if(m===null&&o.flags&4){m=te;var ae=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&m.focus();break;case"img":ae.src&&(m.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var he=o.alternate;if(he!==null){var be=he.memoizedState;if(be!==null){var Ne=be.dehydrated;Ne!==null&&Sn(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}Wn||o.flags&512&&gd(o)}catch(ve){pn(o,o.return,ve)}}if(o===r){ze=null;break}if(m=o.sibling,m!==null){m.return=o.return,ze=m;break}ze=o.return}}function df(r){for(;ze!==null;){var o=ze;if(o===r){ze=null;break}var m=o.sibling;if(m!==null){m.return=o.return,ze=m;break}ze=o.return}}function fr(r){for(;ze!==null;){var o=ze;try{switch(o.tag){case 0:case 11:case 15:var m=o.return;try{tc(4,o)}catch(ae){pn(o,m,ae)}break;case 1:var y=o.stateNode;if(typeof y.componentDidMount=="function"){var k=o.return;try{y.componentDidMount()}catch(ae){pn(o,k,ae)}}var O=o.return;try{gd(o)}catch(ae){pn(o,O,ae)}break;case 5:var I=o.return;try{gd(o)}catch(ae){pn(o,I,ae)}}}catch(ae){pn(o,o.return,ae)}if(o===r){ze=null;break}var te=o.sibling;if(te!==null){te.return=o.return,ze=te;break}ze=o.return}}var Ft=Math.ceil,nc=j.ReactCurrentDispatcher,sc=j.ReactCurrentOwner,js=j.ReactCurrentBatchConfig,wt=0,nt=null,Pt=null,nn=0,rs=0,$r=Sr(0),ln=0,yd=null,Tl=0,mf=0,r_=0,bd=null,Us=null,a_=0,rc=1/0,Ca=null,hf=!1,o_=null,vo=null,ff=!1,yo=null,pf=0,xd=0,l_=null,gf=-1,_f=0;function Ns(){return wt&6?st():gf!==-1?gf:gf=st()}function bo(r){return r.mode&1?wt&2&&nn!==0?nn&-nn:Hg.transition!==null?(_f===0&&(_f=Pn()),_f):(r=yt,r!==0||(r=window.event,r=r===void 0?16:Wa(r.type)),r):1}function Lr(r,o,m,y){if(50<xd)throw xd=0,l_=null,Error(n(185));es(r,m,y),(!(wt&2)||r!==nt)&&(r===nt&&(!(wt&2)&&(mf|=m),ln===4&&xo(r,nn)),qs(r,y),m===1&&wt===0&&!(o.mode&1)&&(rc=st()+500,io&&Kr()))}function qs(r,o){var m=r.callbackNode;Zn(r,o);var y=fn(r,r===nt?nn:0);if(y===0)m!==null&&Jn(m),r.callbackNode=null,r.callbackPriority=0;else if(o=y&-y,r.callbackPriority!==o){if(m!=null&&Jn(m),o===1)r.tag===0?Cu(Ww.bind(null,r)):_l(Ww.bind(null,r)),uh(function(){!(wt&6)&&Kr()}),m=null;else{switch(_i(y)){case 1:m=Un;break;case 4:m=Js;break;case 16:m=cs;break;case 536870912:m=le;break;default:m=cs}m=ej(m,Vw.bind(null,r))}r.callbackPriority=o,r.callbackNode=m}}function Vw(r,o){if(gf=-1,_f=0,wt&6)throw Error(n(327));var m=r.callbackNode;if(ac()&&r.callbackNode!==m)return null;var y=fn(r,r===nt?nn:0);if(y===0)return null;if(y&30||y&r.expiredLanes||o)o=vf(r,y);else{o=y;var k=wt;wt|=2;var O=Yw();(nt!==r||nn!==o)&&(Ca=null,rc=st()+500,Ll(r,o));do try{Jz();break}catch(te){Kw(r,te)}while(!0);yl(),nc.current=O,wt=k,Pt!==null?o=0:(nt=null,nn=0,o=ln)}if(o!==0){if(o===2&&(k=Cn(r),k!==0&&(y=k,o=i_(r,k))),o===1)throw m=yd,Ll(r,0),xo(r,y),qs(r,st()),m;if(o===6)xo(r,y);else{if(k=r.current.alternate,!(y&30)&&!Qz(k)&&(o=vf(r,y),o===2&&(O=Cn(r),O!==0&&(y=O,o=i_(r,O))),o===1))throw m=yd,Ll(r,0),xo(r,y),qs(r,st()),m;switch(r.finishedWork=k,r.finishedLanes=y,o){case 0:case 1:throw Error(n(345));case 2:zl(r,Us,Ca);break;case 3:if(xo(r,y),(y&130023424)===y&&(o=a_+500-st(),10<o)){if(fn(r,0)!==0)break;if(k=r.suspendedLanes,(k&y)!==y){Ns(),r.pingedLanes|=r.suspendedLanes&k;break}r.timeoutHandle=yu(zl.bind(null,r,Us,Ca),o);break}zl(r,Us,Ca);break;case 4:if(xo(r,y),(y&4194240)===y)break;for(o=r.eventTimes,k=-1;0<y;){var I=31-je(y);O=1<<I,I=o[I],I>k&&(k=I),y&=~O}if(y=k,y=st()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*Ft(y/1960))-y,10<y){r.timeoutHandle=yu(zl.bind(null,r,Us,Ca),y);break}zl(r,Us,Ca);break;case 5:zl(r,Us,Ca);break;default:throw Error(n(329))}}}return qs(r,st()),r.callbackNode===m?Vw.bind(null,r):null}function i_(r,o){var m=bd;return r.current.memoizedState.isDehydrated&&(Ll(r,o).flags|=256),r=vf(r,o),r!==2&&(o=Us,Us=m,o!==null&&c_(o)),r}function c_(r){Us===null?Us=r:Us.push.apply(Us,r)}function Qz(r){for(var o=r;;){if(o.flags&16384){var m=o.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var y=0;y<m.length;y++){var k=m[y],O=k.getSnapshot;k=k.value;try{if(!Ds(O(),k))return!1}catch{return!1}}}if(m=o.child,o.subtreeFlags&16384&&m!==null)m.return=o,o=m;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function xo(r,o){for(o&=~r_,o&=~mf,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var m=31-je(o),y=1<<m;r[m]=-1,o&=~y}}function Ww(r){if(wt&6)throw Error(n(327));ac();var o=fn(r,0);if(!(o&1))return qs(r,st()),null;var m=vf(r,o);if(r.tag!==0&&m===2){var y=Cn(r);y!==0&&(o=y,m=i_(r,y))}if(m===1)throw m=yd,Ll(r,0),xo(r,o),qs(r,st()),m;if(m===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,zl(r,Us,Ca),qs(r,st()),null}function u_(r,o){var m=wt;wt|=1;try{return r(o)}finally{wt=m,wt===0&&(rc=st()+500,io&&Kr())}}function $l(r){yo!==null&&yo.tag===0&&!(wt&6)&&ac();var o=wt;wt|=1;var m=js.transition,y=yt;try{if(js.transition=null,yt=1,r)return r()}finally{yt=y,js.transition=m,wt=o,!(wt&6)&&Kr()}}function d_(){rs=$r.current,Vt($r)}function Ll(r,o){r.finishedWork=null,r.finishedLanes=0;var m=r.timeoutHandle;if(m!==-1&&(r.timeoutHandle=-1,Bg(m)),Pt!==null)for(m=Pt.return;m!==null;){var y=m;switch(Eu(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&pl();break;case 3:po(),Vt(ss),Vt(Ln),Bu();break;case 5:Fu(y);break;case 4:po();break;case 13:Vt(Xt);break;case 19:Vt(Xt);break;case 10:$u(y.type._context);break;case 22:case 23:d_()}m=m.return}if(nt=r,Pt=r=wo(r.current,null),nn=rs=o,ln=0,yd=null,r_=mf=Tl=0,Us=bd=null,xa!==null){for(o=0;o<xa.length;o++)if(m=xa[o],y=m.interleaved,y!==null){m.interleaved=null;var k=y.next,O=m.pending;if(O!==null){var I=O.next;O.next=k,y.next=I}m.pending=y}xa=null}return r}function Kw(r,o){do{var m=Pt;try{if(yl(),qi.current=Wi,Nl){for(var y=Jt.memoizedState;y!==null;){var k=y.queue;k!==null&&(k.pending=null),y=y.next}Nl=!1}if(ja=0,kn=$t=Jt=null,Na=!1,Cl=0,sc.current=null,m===null||m.return===null){ln=1,yd=o,Pt=null;break}e:{var O=r,I=m.return,te=m,ae=o;if(o=nn,te.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var he=ae,be=te,Ne=be.tag;if(!(be.mode&1)&&(Ne===0||Ne===11||Ne===15)){var ve=be.alternate;ve?(be.updateQueue=ve.updateQueue,be.memoizedState=ve.memoizedState,be.lanes=ve.lanes):(be.updateQueue=null,be.memoizedState=null)}var Le=Gh(I);if(Le!==null){Le.flags&=-257,Qh(Le,I,te,O,o),Le.mode&1&&Yh(O,he,o),o=Le,ae=he;var Re=o.updateQueue;if(Re===null){var Be=new Set;Be.add(ae),o.updateQueue=Be}else Re.add(ae);break e}else{if(!(o&1)){Yh(O,he,o),m_();break e}ae=Error(n(426))}}else if(Gt&&te.mode&1){var vn=Gh(I);if(vn!==null){!(vn.flags&65536)&&(vn.flags|=256),Qh(vn,I,te,O,o),Au(go(ae,te));break e}}O=ae=go(ae,te),ln!==4&&(ln=2),bd===null?bd=[O]:bd.push(O),O=I;do{switch(O.tag){case 3:O.flags|=65536,o&=-o,O.lanes|=o;var ie=Wh(O,ae,o);wh(O,ie);break e;case 1:te=ae;var oe=O.type,ue=O.stateNode;if(!(O.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(vo===null||!vo.has(ue)))){O.flags|=65536,o&=-o,O.lanes|=o;var Se=Kh(O,te,o);wh(O,Se);break e}}O=O.return}while(O!==null)}Qw(m)}catch(qe){o=qe,Pt===m&&m!==null&&(Pt=m=m.return);continue}break}while(!0)}function Yw(){var r=nc.current;return nc.current=Wi,r===null?Wi:r}function m_(){(ln===0||ln===3||ln===2)&&(ln=4),nt===null||!(Tl&268435455)&&!(mf&268435455)||xo(nt,nn)}function vf(r,o){var m=wt;wt|=2;var y=Yw();(nt!==r||nn!==o)&&(Ca=null,Ll(r,o));do try{Xz();break}catch(k){Kw(r,k)}while(!0);if(yl(),wt=m,nc.current=y,Pt!==null)throw Error(n(261));return nt=null,nn=0,ln}function Xz(){for(;Pt!==null;)Gw(Pt)}function Jz(){for(;Pt!==null&&!Qt();)Gw(Pt)}function Gw(r){var o=Zw(r.alternate,r,rs);r.memoizedProps=r.pendingProps,o===null?Qw(r):Pt=o,sc.current=null}function Qw(r){var o=r;do{var m=o.alternate;if(r=o.return,o.flags&32768){if(m=e_(m,o),m!==null){m.flags&=32767,Pt=m;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{ln=6,Pt=null;return}}else if(m=Zg(m,o,rs),m!==null){Pt=m;return}if(o=o.sibling,o!==null){Pt=o;return}Pt=o=r}while(o!==null);ln===0&&(ln=5)}function zl(r,o,m){var y=yt,k=js.transition;try{js.transition=null,yt=1,Zz(r,o,m,y)}finally{js.transition=k,yt=y}return null}function Zz(r,o,m,y){do ac();while(yo!==null);if(wt&6)throw Error(n(327));m=r.finishedWork;var k=r.finishedLanes;if(m===null)return null;if(r.finishedWork=null,r.finishedLanes=0,m===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var O=m.lanes|m.childLanes;if(Ha(r,O),r===nt&&(Pt=nt=null,nn=0),!(m.subtreeFlags&2064)&&!(m.flags&2064)||ff||(ff=!0,ej(cs,function(){return ac(),null})),O=(m.flags&15990)!==0,m.subtreeFlags&15990||O){O=js.transition,js.transition=null;var I=yt;yt=1;var te=wt;wt|=4,sc.current=null,n_(r,m),lf(m,r),Jm(dl),Ls=!!ao,dl=ao=null,r.current=m,s_(m),At(),wt=te,yt=I,js.transition=O}else r.current=m;if(ff&&(ff=!1,yo=r,pf=k),O=r.pendingLanes,O===0&&(vo=null),Ct(m.stateNode),qs(r,st()),o!==null)for(y=r.onRecoverableError,m=0;m<o.length;m++)k=o[m],y(k.value,{componentStack:k.stack,digest:k.digest});if(hf)throw hf=!1,r=o_,o_=null,r;return pf&1&&r.tag!==0&&ac(),O=r.pendingLanes,O&1?r===l_?xd++:(xd=0,l_=r):xd=0,Kr(),null}function ac(){if(yo!==null){var r=_i(pf),o=js.transition,m=yt;try{if(js.transition=null,yt=16>r?16:r,yo===null)var y=!1;else{if(r=yo,yo=null,pf=0,wt&6)throw Error(n(331));var k=wt;for(wt|=4,ze=r.current;ze!==null;){var O=ze,I=O.child;if(ze.flags&16){var te=O.deletions;if(te!==null){for(var ae=0;ae<te.length;ae++){var he=te[ae];for(ze=he;ze!==null;){var be=ze;switch(be.tag){case 0:case 11:case 15:Pl(8,be,O)}var Ne=be.child;if(Ne!==null)Ne.return=be,ze=Ne;else for(;ze!==null;){be=ze;var ve=be.sibling,Le=be.return;if(nf(be),be===he){ze=null;break}if(ve!==null){ve.return=Le,ze=ve;break}ze=Le}}}var Re=O.alternate;if(Re!==null){var Be=Re.child;if(Be!==null){Re.child=null;do{var vn=Be.sibling;Be.sibling=null,Be=vn}while(Be!==null)}}ze=O}}if(O.subtreeFlags&2064&&I!==null)I.return=O,ze=I;else e:for(;ze!==null;){if(O=ze,O.flags&2048)switch(O.tag){case 0:case 11:case 15:Pl(9,O,O.return)}var ie=O.sibling;if(ie!==null){ie.return=O.return,ze=ie;break e}ze=O.return}}var oe=r.current;for(ze=oe;ze!==null;){I=ze;var ue=I.child;if(I.subtreeFlags&2064&&ue!==null)ue.return=I,ze=ue;else e:for(I=oe;ze!==null;){if(te=ze,te.flags&2048)try{switch(te.tag){case 0:case 11:case 15:tc(9,te)}}catch(qe){pn(te,te.return,qe)}if(te===I){ze=null;break e}var Se=te.sibling;if(Se!==null){Se.return=te.return,ze=Se;break e}ze=te.return}}if(wt=k,Kr(),$e&&typeof $e.onPostCommitFiberRoot=="function")try{$e.onPostCommitFiberRoot(_e,r)}catch{}y=!0}return y}finally{yt=m,js.transition=o}}return!1}function Xw(r,o,m){o=go(m,o),o=Wh(r,o,1),r=Gr(r,o,1),o=Ns(),r!==null&&(es(r,1,o),qs(r,o))}function pn(r,o,m){if(r.tag===3)Xw(r,r,m);else for(;o!==null;){if(o.tag===3){Xw(o,r,m);break}else if(o.tag===1){var y=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(vo===null||!vo.has(y))){r=go(m,r),r=Kh(o,r,1),o=Gr(o,r,1),r=Ns(),o!==null&&(es(o,1,r),qs(o,r));break}}o=o.return}}function eD(r,o,m){var y=r.pingCache;y!==null&&y.delete(o),o=Ns(),r.pingedLanes|=r.suspendedLanes&m,nt===r&&(nn&m)===m&&(ln===4||ln===3&&(nn&130023424)===nn&&500>st()-a_?Ll(r,0):r_|=m),qs(r,o)}function Jw(r,o){o===0&&(r.mode&1?(o=an,an<<=1,!(an&130023424)&&(an=4194304)):o=1);var m=Ns();r=Ar(r,o),r!==null&&(es(r,o,m),qs(r,m))}function tD(r){var o=r.memoizedState,m=0;o!==null&&(m=o.retryLane),Jw(r,m)}function nD(r,o){var m=0;switch(r.tag){case 13:var y=r.stateNode,k=r.memoizedState;k!==null&&(m=k.retryLane);break;case 19:y=r.stateNode;break;default:throw Error(n(314))}y!==null&&y.delete(o),Jw(r,m)}var Zw;Zw=function(r,o,m){if(r!==null)if(r.memoizedProps!==o.pendingProps||ss.current)hs=!0;else{if(!(r.lanes&m)&&!(o.flags&128))return hs=!1,Zi(r,o,m);hs=!!(r.flags&131072)}else hs=!1,Gt&&o.flags&1048576&&fh(o,zi,o.index);switch(o.lanes=0,o.tag){case 2:var y=o.type;Ji(r,o),r=o.pendingProps;var k=_a(o,Ln.current);fo(o,m),k=Vu(null,o,y,r,k,m);var O=Wu();return o.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ms(y)?(O=!0,gl(o)):O=!1,o.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Du(o),k.updater=Ki,o.stateNode=k,k._reactInternals=o,td(o,y,r,m),o=Gi(null,o,y,!0,O,m)):(o.tag=0,Gt&&O&&Su(o),on(null,o,k,m),o=o.child),o;case 16:y=o.elementType;e:{switch(Ji(r,o),r=o.pendingProps,k=y._init,y=k(y._payload),o.type=y,k=o.tag=rD(y),r=nr(y,r),k){case 0:o=id(null,o,y,r,m);break e;case 1:o=Pr(null,o,y,r,m);break e;case 11:o=Yi(null,o,y,r,m);break e;case 14:o=rd(null,o,y,nr(y.type,r),m);break e}throw Error(n(306,y,""))}return o;case 0:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:nr(y,k),id(r,o,y,k,m);case 1:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:nr(y,k),Pr(r,o,y,k,m);case 3:e:{if(cd(o),r===null)throw Error(n(387));y=o.pendingProps,O=o.memoizedState,k=O.element,xh(r,o),Ui(o,y,null,m);var I=o.memoizedState;if(y=I.element,O.isDehydrated)if(O={element:y,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=O,o.memoizedState=O,o.flags&256){k=go(Error(n(423)),o),o=ud(r,o,y,m,k);break e}else if(y!==k){k=go(Error(n(424)),o),o=ud(r,o,y,m,k);break e}else for(ws=Nr(o.stateNode.containerInfo.firstChild),xs=o,Gt=!0,tr=null,m=Pu(o,null,y,m),o.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(mo(),y===k){o=Tr(r,o,m);break e}on(r,o,y,m)}o=o.child}return o;case 5:return Nh(o),r===null&&Mu(o),y=o.type,k=o.pendingProps,O=r!==null?r.memoizedProps:null,I=k.children,vu(y,k)?I=null:O!==null&&vu(y,O)&&(o.flags|=32),ld(r,o),on(r,o,I,m),o.child;case 6:return r===null&&Mu(o),null;case 13:return dd(r,o,m);case 4:return Ru(o,o.stateNode.containerInfo),y=o.pendingProps,r===null?o.child=ho(o,null,y,m):on(r,o,y,m),o.child;case 11:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:nr(y,k),Yi(r,o,y,k,m);case 7:return on(r,o,o.pendingProps,m),o.child;case 8:return on(r,o,o.pendingProps.children,m),o.child;case 12:return on(r,o,o.pendingProps.children,m),o.child;case 10:e:{if(y=o.type._context,k=o.pendingProps,O=o.memoizedProps,I=k.value,Bt(Fi,y._currentValue),y._currentValue=I,O!==null)if(Ds(O.value,I)){if(O.children===k.children&&!ss.current){o=Tr(r,o,m);break e}}else for(O=o.child,O!==null&&(O.return=o);O!==null;){var te=O.dependencies;if(te!==null){I=O.child;for(var ae=te.firstContext;ae!==null;){if(ae.context===y){if(O.tag===1){ae=Or(-1,m&-m),ae.tag=2;var he=O.updateQueue;if(he!==null){he=he.shared;var be=he.pending;be===null?ae.next=ae:(ae.next=be.next,be.next=ae),he.pending=ae}}O.lanes|=m,ae=O.alternate,ae!==null&&(ae.lanes|=m),Lu(O.return,m,o),te.lanes|=m;break}ae=ae.next}}else if(O.tag===10)I=O.type===o.type?null:O.child;else if(O.tag===18){if(I=O.return,I===null)throw Error(n(341));I.lanes|=m,te=I.alternate,te!==null&&(te.lanes|=m),Lu(I,m,o),I=O.sibling}else I=O.child;if(I!==null)I.return=O;else for(I=O;I!==null;){if(I===o){I=null;break}if(O=I.sibling,O!==null){O.return=I.return,I=O;break}I=I.return}O=I}on(r,o,k.children,m),o=o.child}return o;case 9:return k=o.type,y=o.pendingProps.children,fo(o,m),k=Is(k),y=y(k),o.flags|=1,on(r,o,y,m),o.child;case 14:return y=o.type,k=nr(y,o.pendingProps),k=nr(y.type,k),rd(r,o,y,k,m);case 15:return ad(r,o,o.type,o.pendingProps,m);case 17:return y=o.type,k=o.pendingProps,k=o.elementType===y?k:nr(y,k),Ji(r,o),o.tag=1,ms(y)?(r=!0,gl(o)):r=!1,fo(o,m),Hh(o,y,k),td(o,y,k,m),Gi(null,o,y,!0,r,m);case 19:return Jh(r,o,m);case 22:return od(r,o,m)}throw Error(n(156,o.tag))};function ej(r,o){return Xs(r,o)}function sD(r,o,m,y){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function pr(r,o,m,y){return new sD(r,o,m,y)}function h_(r){return r=r.prototype,!(!r||!r.isReactComponent)}function rD(r){if(typeof r=="function")return h_(r)?1:0;if(r!=null){if(r=r.$$typeof,r===z)return 11;if(r===R)return 14}return 2}function wo(r,o){var m=r.alternate;return m===null?(m=pr(r.tag,o,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=o,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&14680064,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,o=r.dependencies,m.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m}function yf(r,o,m,y,k,O){var I=2;if(y=r,typeof r=="function")h_(r)&&(I=1);else if(typeof r=="string")I=5;else e:switch(r){case $:return Dl(m.children,k,O,o);case A:I=8,k|=8;break;case L:return r=pr(12,m,o,k|2),r.elementType=L,r.lanes=O,r;case W:return r=pr(13,m,o,k),r.elementType=W,r.lanes=O,r;case D:return r=pr(19,m,o,k),r.elementType=D,r.lanes=O,r;case V:return bf(m,k,O,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case T:I=10;break e;case P:I=9;break e;case z:I=11;break e;case R:I=14;break e;case U:I=16,y=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return o=pr(I,m,o,k),o.elementType=r,o.type=y,o.lanes=O,o}function Dl(r,o,m,y){return r=pr(7,r,y,o),r.lanes=m,r}function bf(r,o,m,y){return r=pr(22,r,y,o),r.elementType=V,r.lanes=m,r.stateNode={isHidden:!1},r}function f_(r,o,m){return r=pr(6,r,null,o),r.lanes=m,r}function p_(r,o,m){return o=pr(4,r.children!==null?r.children:[],r.key,o),o.lanes=m,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function aD(r,o,m,y,k){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=us(0),this.expirationTimes=us(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=us(0),this.identifierPrefix=y,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function g_(r,o,m,y,k,O,I,te,ae){return r=new aD(r,o,m,te,ae),o===1?(o=1,O===!0&&(o|=8)):o=0,O=pr(3,null,null,o),r.current=O,O.stateNode=r,O.memoizedState={element:y,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Du(O),r}function oD(r,o,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:S,key:y==null?null:""+y,children:r,containerInfo:o,implementation:m}}function tj(r){if(!r)return Wr;r=r._reactInternals;e:{if(Nn(r)!==r||r.tag!==1)throw Error(n(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ms(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(r.tag===1){var m=r.type;if(ms(m))return hh(r,m,o)}return o}function nj(r,o,m,y,k,O,I,te,ae){return r=g_(m,y,!0,r,k,O,I,te,ae),r.context=tj(null),m=r.current,y=Ns(),k=bo(m),O=Or(y,k),O.callback=o??null,Gr(m,O,k),r.current.lanes=k,es(r,k,y),qs(r,y),r}function xf(r,o,m,y){var k=o.current,O=Ns(),I=bo(k);return m=tj(m),o.context===null?o.context=m:o.pendingContext=m,o=Or(O,I),o.payload={element:r},y=y===void 0?null:y,y!==null&&(o.callback=y),r=Gr(k,o,I),r!==null&&(Lr(r,k,I,O),Bi(r,k,I)),I}function wf(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function sj(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<o?m:o}}function __(r,o){sj(r,o),(r=r.alternate)&&sj(r,o)}function lD(){return null}var rj=typeof reportError=="function"?reportError:function(r){console.error(r)};function v_(r){this._internalRoot=r}jf.prototype.render=v_.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));xf(r,o,null,null)},jf.prototype.unmount=v_.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;$l(function(){xf(null,r,null,null)}),o[Cr]=null}};function jf(r){this._internalRoot=r}jf.prototype.unstable_scheduleHydration=function(r){if(r){var o=yi();r={blockedOn:null,target:r,priority:o};for(var m=0;m<Ce.length&&o!==0&&o<Ce[m].priority;m++);Ce.splice(m,0,r),m===0&&rt(r)}};function y_(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function Nf(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function aj(){}function iD(r,o,m,y,k){if(k){if(typeof y=="function"){var O=y;y=function(){var he=wf(I);O.call(he)}}var I=nj(o,y,r,0,null,!1,!1,"",aj);return r._reactRootContainer=I,r[Cr]=I.current,cl(r.nodeType===8?r.parentNode:r),$l(),I}for(;k=r.lastChild;)r.removeChild(k);if(typeof y=="function"){var te=y;y=function(){var he=wf(ae);te.call(he)}}var ae=g_(r,0,!1,null,null,!1,!1,"",aj);return r._reactRootContainer=ae,r[Cr]=ae.current,cl(r.nodeType===8?r.parentNode:r),$l(function(){xf(o,ae,m,y)}),ae}function Cf(r,o,m,y,k){var O=m._reactRootContainer;if(O){var I=O;if(typeof k=="function"){var te=k;k=function(){var ae=wf(I);te.call(ae)}}xf(o,I,r,k)}else I=iD(m,o,r,k,y);return wf(I)}nl=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var m=qt(o.pendingLanes);m!==0&&(tl(o,m|1),qs(o,st()),!(wt&6)&&(rc=st()+500,Kr()))}break;case 13:$l(function(){var y=Ar(r,1);if(y!==null){var k=Ns();Lr(y,r,1,k)}}),__(r,1)}},sl=function(r){if(r.tag===13){var o=Ar(r,134217728);if(o!==null){var m=Ns();Lr(o,r,134217728,m)}__(r,134217728)}},vi=function(r){if(r.tag===13){var o=bo(r),m=Ar(r,o);if(m!==null){var y=Ns();Lr(m,r,o,y)}__(r,o)}},yi=function(){return yt},rl=function(r,o){var m=yt;try{return yt=r,o()}finally{yt=m}},Fn=function(r,o,m){switch(o){case"input":if(de(r,m),o=m.name,m.type==="radio"&&o!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<m.length;o++){var y=m[o];if(y!==r&&y.form===r.form){var k=fl(y);if(!k)throw Error(n(90));Pe(y),de(y,k)}}}break;case"textarea":Ye(r,m);break;case"select":o=m.value,o!=null&&De(r,!!m.multiple,o,!1)}},ft=u_,Os=$l;var cD={usingClientEntryPoint:!1,Events:[hl,oo,fl,Zt,gn,u_]},wd={findFiberByHostInstance:ga,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uD={bundleType:wd.bundleType,version:wd.version,rendererPackageName:wd.rendererPackageName,rendererConfig:wd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=_s(r),r===null?null:r.stateNode},findFiberByHostInstance:wd.findFiberByHostInstance||lD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sf.isDisabled&&Sf.supportsFiber)try{_e=Sf.inject(uD),$e=Sf}catch{}}return Cs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cD,Cs.createPortal=function(r,o){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!y_(o))throw Error(n(200));return oD(r,o,null,m)},Cs.createRoot=function(r,o){if(!y_(r))throw Error(n(299));var m=!1,y="",k=rj;return o!=null&&(o.unstable_strictMode===!0&&(m=!0),o.identifierPrefix!==void 0&&(y=o.identifierPrefix),o.onRecoverableError!==void 0&&(k=o.onRecoverableError)),o=g_(r,1,!1,null,null,m,!1,y,k),r[Cr]=o.current,cl(r.nodeType===8?r.parentNode:r),new v_(o)},Cs.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=_s(o),r=r===null?null:r.stateNode,r},Cs.flushSync=function(r){return $l(r)},Cs.hydrate=function(r,o,m){if(!Nf(o))throw Error(n(200));return Cf(null,r,o,!0,m)},Cs.hydrateRoot=function(r,o,m){if(!y_(r))throw Error(n(405));var y=m!=null&&m.hydratedSources||null,k=!1,O="",I=rj;if(m!=null&&(m.unstable_strictMode===!0&&(k=!0),m.identifierPrefix!==void 0&&(O=m.identifierPrefix),m.onRecoverableError!==void 0&&(I=m.onRecoverableError)),o=nj(o,null,r,1,m??null,k,!1,O,I),r[Cr]=o.current,cl(r),y)for(r=0;r<y.length;r++)m=y[r],k=m._getVersion,k=k(m._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[m,k]:o.mutableSourceEagerHydrationData.push(m,k);return new jf(o)},Cs.render=function(r,o,m){if(!Nf(o))throw Error(n(200));return Cf(null,r,o,!1,m)},Cs.unmountComponentAtNode=function(r){if(!Nf(r))throw Error(n(40));return r._reactRootContainer?($l(function(){Cf(null,null,r,!1,function(){r._reactRootContainer=null,r[Cr]=null})}),!0):!1},Cs.unstable_batchedUpdates=u_,Cs.unstable_renderSubtreeIntoContainer=function(r,o,m,y){if(!Nf(m))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return Cf(r,o,m,!1,y)},Cs.version="18.3.1-next-f1338f8080-20240426",Cs}function L_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(L_)}catch(e){console.error(e)}}L_(),O_.exports=mj();var z_=O_.exports,D_=z_;Mf.createRoot=D_.createRoot,Mf.hydrateRoot=D_.hydrateRoot;var Rl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},hj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},fj=(Pw=class{constructor(){He(this,La,hj);He(this,Ng,!1)}setTimeoutProvider(e){Te(this,La,e)}setTimeout(e,t){return ne(this,La).setTimeout(e,t)}clearTimeout(e){ne(this,La).clearTimeout(e)}setInterval(e,t){return ne(this,La).setInterval(e,t)}clearInterval(e){ne(this,La).clearInterval(e)}},La=new WeakMap,Ng=new WeakMap,Pw),So=new fj;function pj(e){setTimeout(e,0)}var Eo=typeof window>"u"||"Deno"in globalThis;function fs(){}function gj(e,t){return typeof e=="function"?e(t):e}function Pf(e){return typeof e=="number"&&e>=0&&e!==1/0}function R_(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ea(e,t){return typeof e=="function"?e(t):e}function ar(e,t){return typeof e=="function"?e(t):e}function F_(e,t){const{type:n="all",exact:s,fetchStatus:l,predicate:i,queryKey:c,stale:u}=e;if(c){if(s){if(t.queryHash!==Tf(c,t.options))return!1}else if(!oc(t.queryKey,c))return!1}if(n!=="all"){const d=t.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||l&&l!==t.state.fetchStatus||i&&!i(t))}function I_(e,t){const{exact:n,status:s,predicate:l,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(ko(t.options.mutationKey)!==ko(i))return!1}else if(!oc(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||l&&!l(t))}function Tf(e,t){return((t==null?void 0:t.queryKeyHashFn)||ko)(e)}function ko(e){return JSON.stringify(e,(t,n)=>$f(n)?Object.keys(n).sort().reduce((s,l)=>(s[l]=n[l],s),{}):n)}function oc(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>oc(e[n],t[n])):!1}var _j=Object.prototype.hasOwnProperty;function B_(e,t){if(e===t)return e;const n=U_(e)&&U_(t);if(!n&&!($f(e)&&$f(t)))return t;const l=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),c=i.length,u=n?new Array(c):{};let d=0;for(let p=0;p<c;p++){const h=n?p:i[p],f=e[h],g=t[h];if(f===g){u[h]=f,(n?p<l:_j.call(e,h))&&d++;continue}if(f===null||g===null||typeof f!="object"||typeof g!="object"){u[h]=g;continue}const w=B_(f,g);u[h]=w,w===f&&d++}return l===c&&d===l?e:u}function Nd(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function U_(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function $f(e){if(!q_(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!q_(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function q_(e){return Object.prototype.toString.call(e)==="[object Object]"}function vj(e){return new Promise(t=>{So.setTimeout(t,e)})}function Lf(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?B_(e,t):t}function yj(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function bj(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var zf=Symbol();function H_(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===zf?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function V_(e,t){return typeof e=="function"?e(...t):!!e}var xj=(Tw=class extends Rl{constructor(){super();He(this,Wo);He(this,za);He(this,ai);Te(this,ai,t=>{if(!Eo&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ne(this,za)||this.setEventListener(ne(this,ai))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,za))==null||t.call(this),Te(this,za,void 0))}setEventListener(t){var n;Te(this,ai,t),(n=ne(this,za))==null||n.call(this),Te(this,za,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){ne(this,Wo)!==t&&(Te(this,Wo,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof ne(this,Wo)=="boolean"?ne(this,Wo):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Wo=new WeakMap,za=new WeakMap,ai=new WeakMap,Tw),Df=new xj;function Rf(){let e,t;const n=new Promise((l,i)=>{e=l,t=i});n.status="pending",n.catch(()=>{});function s(l){Object.assign(n,l),delete n.resolve,delete n.reject}return n.resolve=l=>{s({status:"fulfilled",value:l}),e(l)},n.reject=l=>{s({status:"rejected",reason:l}),t(l)},n}var wj=pj;function jj(){let e=[],t=0,n=u=>{u()},s=u=>{u()},l=wj;const i=u=>{t?e.push(u):l(()=>{n(u)})},c=()=>{const u=e;e=[],u.length&&l(()=>{s(()=>{u.forEach(d=>{n(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{i(()=>{u(...d)})},schedule:i,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{l=u}}}var Mn=jj(),Nj=($w=class extends Rl{constructor(){super();He(this,oi,!0);He(this,Da);He(this,li);Te(this,li,t=>{if(!Eo&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){ne(this,Da)||this.setEventListener(ne(this,li))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,Da))==null||t.call(this),Te(this,Da,void 0))}setEventListener(t){var n;Te(this,li,t),(n=ne(this,Da))==null||n.call(this),Te(this,Da,t(this.setOnline.bind(this)))}setOnline(t){ne(this,oi)!==t&&(Te(this,oi,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return ne(this,oi)}},oi=new WeakMap,Da=new WeakMap,li=new WeakMap,$w),Cd=new Nj;function Cj(e){return Math.min(1e3*2**e,3e4)}function W_(e){return(e??"online")==="online"?Cd.isOnline():!0}var Ff=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function K_(e){let t=!1,n=0,s;const l=Rf(),i=()=>l.status!=="pending",c=b=>{var x;if(!i()){const N=new Ff(b);g(N),(x=e.onCancel)==null||x.call(e,N)}},u=()=>{t=!0},d=()=>{t=!1},p=()=>Df.isFocused()&&(e.networkMode==="always"||Cd.isOnline())&&e.canRun(),h=()=>W_(e.networkMode)&&e.canRun(),f=b=>{i()||(s==null||s(),l.resolve(b))},g=b=>{i()||(s==null||s(),l.reject(b))},w=()=>new Promise(b=>{var x;s=N=>{(i()||p())&&b(N)},(x=e.onPause)==null||x.call(e)}).then(()=>{var b;s=void 0,i()||(b=e.onContinue)==null||b.call(e)}),_=()=>{if(i())return;let b;const x=n===0?e.initialPromise:void 0;try{b=x??e.fn()}catch(N){b=Promise.reject(N)}Promise.resolve(b).then(f).catch(N=>{var S;if(i())return;const E=e.retry??(Eo?0:3),M=e.retryDelay??Cj,j=typeof M=="function"?M(n,N):M,C=E===!0||typeof E=="number"&&n<E||typeof E=="function"&&E(n,N);if(t||!C){g(N);return}n++,(S=e.onFail)==null||S.call(e,n,N),vj(j).then(()=>p()?void 0:w()).then(()=>{t?g(N):_()})})};return{promise:l,status:()=>l.status,cancel:c,continue:()=>(s==null||s(),l),cancelRetry:u,continueRetry:d,canStart:h,start:()=>(h()?_():w().then(_),l)}}var Y_=(Lw=class{constructor(){He(this,Ko)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Pf(this.gcTime)&&Te(this,Ko,So.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Eo?1/0:5*60*1e3))}clearGcTimeout(){ne(this,Ko)&&(So.clearTimeout(ne(this,Ko)),Te(this,Ko,void 0))}},Ko=new WeakMap,Lw),Sj={NODE_ENV:"production"},Ej=(zw=class extends Y_{constructor(t){super();He(this,br);He(this,Yo);He(this,ii);He(this,or);He(this,Go);He(this,Rn);He(this,Wc);He(this,Qo);Te(this,Qo,!1),Te(this,Wc,t.defaultOptions),this.setOptions(t.options),this.observers=[],Te(this,Go,t.client),Te(this,or,ne(this,Go).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Te(this,Yo,Q_(this.options)),this.state=t.state??ne(this,Yo),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ne(this,Rn))==null?void 0:t.promise}setOptions(t){if(this.options={...ne(this,Wc),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=Q_(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),Te(this,Yo,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ne(this,or).remove(this)}setData(t,n){const s=Lf(this.state.data,t,this.options);return vt(this,br,Sa).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){vt(this,br,Sa).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,l;const n=(s=ne(this,Rn))==null?void 0:s.promise;return(l=ne(this,Rn))==null||l.cancel(t),n?n.then(fs).catch(fs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ne(this,Yo))}isActive(){return this.observers.some(t=>ar(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===zf||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Ea(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!R_(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,Rn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,Rn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ne(this,or).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(ne(this,Rn)&&(ne(this,Qo)?ne(this,Rn).cancel({revert:!0}):ne(this,Rn).cancelRetry()),this.scheduleGc()),ne(this,or).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vt(this,br,Sa).call(this,{type:"invalidate"})}async fetch(t,n){var d,p,h,f,g,w,_,b,x,N,E,M;if(this.state.fetchStatus!=="idle"&&((d=ne(this,Rn))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ne(this,Rn))return ne(this,Rn).continueRetry(),ne(this,Rn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(C=>C.options.queryFn);j&&this.setOptions(j.options)}const s=new AbortController,l=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(Te(this,Qo,!0),s.signal)})},i=()=>{const j=H_(this.options,n),S=(()=>{const $={client:ne(this,Go),queryKey:this.queryKey,meta:this.meta};return l($),$})();return Te(this,Qo,!1),this.options.persister?this.options.persister(j,S,this):j(S)},u=(()=>{const j={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:ne(this,Go),state:this.state,fetchFn:i};return l(j),j})();(p=this.options.behavior)==null||p.onFetch(u,this),Te(this,ii,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=u.fetchOptions)==null?void 0:h.meta))&&vt(this,br,Sa).call(this,{type:"fetch",meta:(f=u.fetchOptions)==null?void 0:f.meta}),Te(this,Rn,K_({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,onCancel:j=>{j instanceof Ff&&j.revert&&this.setState({...ne(this,ii),fetchStatus:"idle"}),s.abort()},onFail:(j,C)=>{vt(this,br,Sa).call(this,{type:"failed",failureCount:j,error:C})},onPause:()=>{vt(this,br,Sa).call(this,{type:"pause"})},onContinue:()=>{vt(this,br,Sa).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const j=await ne(this,Rn).start();if(j===void 0)throw Sj.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(j),(w=(g=ne(this,or).config).onSuccess)==null||w.call(g,j,this),(b=(_=ne(this,or).config).onSettled)==null||b.call(_,j,this.state.error,this),j}catch(j){if(j instanceof Ff){if(j.silent)return ne(this,Rn).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw vt(this,br,Sa).call(this,{type:"error",error:j}),(N=(x=ne(this,or).config).onError)==null||N.call(x,j,this),(M=(E=ne(this,or).config).onSettled)==null||M.call(E,this.state.data,j,this),j}finally{this.scheduleGc()}}},Yo=new WeakMap,ii=new WeakMap,or=new WeakMap,Go=new WeakMap,Rn=new WeakMap,Wc=new WeakMap,Qo=new WeakMap,br=new WeakSet,Sa=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...G_(s.data,this.options),fetchMeta:t.meta??null};case"success":const l={...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Te(this,ii,t.manual?l:void 0),l;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),Mn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),ne(this,or).notify({query:this,type:"updated",action:t})})},zw);function G_(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:W_(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function Q_(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var kj=(Dw=class extends Rl{constructor(t,n){super();He(this,Lt);He(this,Ms);He(this,jt);He(this,Kc);He(this,ps);He(this,Xo);He(this,ci);He(this,ra);He(this,Ra);He(this,Yc);He(this,ui);He(this,di);He(this,Jo);He(this,Zo);He(this,Fa);He(this,mi,new Set);this.options=n,Te(this,Ms,t),Te(this,Ra,null),Te(this,ra,Rf()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ne(this,jt).addObserver(this),X_(ne(this,jt),this.options)?vt(this,Lt,jd).call(this):this.updateResult(),vt(this,Lt,N_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return If(ne(this,jt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return If(ne(this,jt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,vt(this,Lt,C_).call(this),vt(this,Lt,S_).call(this),ne(this,jt).removeObserver(this)}setOptions(t){const n=this.options,s=ne(this,jt);if(this.options=ne(this,Ms).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof ar(this.options.enabled,ne(this,jt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");vt(this,Lt,E_).call(this),ne(this,jt).setOptions(this.options),n._defaulted&&!Nd(this.options,n)&&ne(this,Ms).getQueryCache().notify({type:"observerOptionsUpdated",query:ne(this,jt),observer:this});const l=this.hasListeners();l&&J_(ne(this,jt),s,this.options,n)&&vt(this,Lt,jd).call(this),this.updateResult(),l&&(ne(this,jt)!==s||ar(this.options.enabled,ne(this,jt))!==ar(n.enabled,ne(this,jt))||Ea(this.options.staleTime,ne(this,jt))!==Ea(n.staleTime,ne(this,jt)))&&vt(this,Lt,x_).call(this);const i=vt(this,Lt,w_).call(this);l&&(ne(this,jt)!==s||ar(this.options.enabled,ne(this,jt))!==ar(n.enabled,ne(this,jt))||i!==ne(this,Fa))&&vt(this,Lt,j_).call(this,i)}getOptimisticResult(t){const n=ne(this,Ms).getQueryCache().build(ne(this,Ms),t),s=this.createResult(n,t);return Aj(this,s)&&(Te(this,ps,s),Te(this,ci,this.options),Te(this,Xo,ne(this,jt).state)),s}getCurrentResult(){return ne(this,ps)}trackResult(t,n){return new Proxy(t,{get:(s,l)=>(this.trackProp(l),n==null||n(l),l==="promise"&&!this.options.experimental_prefetchInRender&&ne(this,ra).status==="pending"&&ne(this,ra).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(s,l))})}trackProp(t){ne(this,mi).add(t)}getCurrentQuery(){return ne(this,jt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=ne(this,Ms).defaultQueryOptions(t),s=ne(this,Ms).getQueryCache().build(ne(this,Ms),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(t){return vt(this,Lt,jd).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ne(this,ps)))}createResult(t,n){var L;const s=ne(this,jt),l=this.options,i=ne(this,ps),c=ne(this,Xo),u=ne(this,ci),p=t!==s?t.state:ne(this,Kc),{state:h}=t;let f={...h},g=!1,w;if(n._optimisticResults){const T=this.hasListeners(),P=!T&&X_(t,n),z=T&&J_(t,s,n,l);(P||z)&&(f={...f,...G_(h.data,t.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:_,errorUpdatedAt:b,status:x}=f;w=f.data;let N=!1;if(n.placeholderData!==void 0&&w===void 0&&x==="pending"){let T;i!=null&&i.isPlaceholderData&&n.placeholderData===(u==null?void 0:u.placeholderData)?(T=i.data,N=!0):T=typeof n.placeholderData=="function"?n.placeholderData((L=ne(this,di))==null?void 0:L.state.data,ne(this,di)):n.placeholderData,T!==void 0&&(x="success",w=Lf(i==null?void 0:i.data,T,n),g=!0)}if(n.select&&w!==void 0&&!N)if(i&&w===(c==null?void 0:c.data)&&n.select===ne(this,Yc))w=ne(this,ui);else try{Te(this,Yc,n.select),w=n.select(w),w=Lf(i==null?void 0:i.data,w,n),Te(this,ui,w),Te(this,Ra,null)}catch(T){Te(this,Ra,T)}ne(this,Ra)&&(_=ne(this,Ra),w=ne(this,ui),b=Date.now(),x="error");const E=f.fetchStatus==="fetching",M=x==="pending",j=x==="error",C=M&&E,S=w!==void 0,A={status:x,fetchStatus:f.fetchStatus,isPending:M,isSuccess:x==="success",isError:j,isInitialLoading:C,isLoading:C,data:w,dataUpdatedAt:f.dataUpdatedAt,error:_,errorUpdatedAt:b,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>p.dataUpdateCount||f.errorUpdateCount>p.errorUpdateCount,isFetching:E,isRefetching:E&&!M,isLoadingError:j&&!S,isPaused:f.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:j&&S,isStale:Bf(t,n),refetch:this.refetch,promise:ne(this,ra),isEnabled:ar(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=W=>{A.status==="error"?W.reject(A.error):A.data!==void 0&&W.resolve(A.data)},P=()=>{const W=Te(this,ra,A.promise=Rf());T(W)},z=ne(this,ra);switch(z.status){case"pending":t.queryHash===s.queryHash&&T(z);break;case"fulfilled":(A.status==="error"||A.data!==z.value)&&P();break;case"rejected":(A.status!=="error"||A.error!==z.reason)&&P();break}}return A}updateResult(){const t=ne(this,ps),n=this.createResult(ne(this,jt),this.options);if(Te(this,Xo,ne(this,jt).state),Te(this,ci,this.options),ne(this,Xo).data!==void 0&&Te(this,di,ne(this,jt)),Nd(n,t))return;Te(this,ps,n);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,i=typeof l=="function"?l():l;if(i==="all"||!i&&!ne(this,mi).size)return!0;const c=new Set(i??ne(this,mi));return this.options.throwOnError&&c.add("error"),Object.keys(ne(this,ps)).some(u=>{const d=u;return ne(this,ps)[d]!==t[d]&&c.has(d)})};vt(this,Lt,lj).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&vt(this,Lt,N_).call(this)}},Ms=new WeakMap,jt=new WeakMap,Kc=new WeakMap,ps=new WeakMap,Xo=new WeakMap,ci=new WeakMap,ra=new WeakMap,Ra=new WeakMap,Yc=new WeakMap,ui=new WeakMap,di=new WeakMap,Jo=new WeakMap,Zo=new WeakMap,Fa=new WeakMap,mi=new WeakMap,Lt=new WeakSet,jd=function(t){vt(this,Lt,E_).call(this);let n=ne(this,jt).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(fs)),n},x_=function(){vt(this,Lt,C_).call(this);const t=Ea(this.options.staleTime,ne(this,jt));if(Eo||ne(this,ps).isStale||!Pf(t))return;const s=R_(ne(this,ps).dataUpdatedAt,t)+1;Te(this,Jo,So.setTimeout(()=>{ne(this,ps).isStale||this.updateResult()},s))},w_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ne(this,jt)):this.options.refetchInterval)??!1},j_=function(t){vt(this,Lt,S_).call(this),Te(this,Fa,t),!(Eo||ar(this.options.enabled,ne(this,jt))===!1||!Pf(ne(this,Fa))||ne(this,Fa)===0)&&Te(this,Zo,So.setInterval(()=>{(this.options.refetchIntervalInBackground||Df.isFocused())&&vt(this,Lt,jd).call(this)},ne(this,Fa)))},N_=function(){vt(this,Lt,x_).call(this),vt(this,Lt,j_).call(this,vt(this,Lt,w_).call(this))},C_=function(){ne(this,Jo)&&(So.clearTimeout(ne(this,Jo)),Te(this,Jo,void 0))},S_=function(){ne(this,Zo)&&(So.clearInterval(ne(this,Zo)),Te(this,Zo,void 0))},E_=function(){const t=ne(this,Ms).getQueryCache().build(ne(this,Ms),this.options);if(t===ne(this,jt))return;const n=ne(this,jt);Te(this,jt,t),Te(this,Kc,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},lj=function(t){Mn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(ne(this,ps))}),ne(this,Ms).getQueryCache().notify({query:ne(this,jt),type:"observerResultsUpdated"})})},Dw);function Mj(e,t){return ar(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function X_(e,t){return Mj(e,t)||e.state.data!==void 0&&If(e,t,t.refetchOnMount)}function If(e,t,n){if(ar(t.enabled,e)!==!1&&Ea(t.staleTime,e)!=="static"){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&Bf(e,t)}return!1}function J_(e,t,n,s){return(e!==t||ar(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Bf(e,n)}function Bf(e,t){return ar(t.enabled,e)!==!1&&e.isStaleByTime(Ea(t.staleTime,e))}function Aj(e,t){return!Nd(e.getCurrentResult(),t)}function Z_(e){return{onFetch:(t,n)=>{var h,f,g,w,_;const s=t.options,l=(g=(f=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:g.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],c=((_=t.state.data)==null?void 0:_.pageParams)||[];let u={pages:[],pageParams:[]},d=0;const p=async()=>{let b=!1;const x=M=>{Object.defineProperty(M,"signal",{enumerable:!0,get:()=>(t.signal.aborted?b=!0:t.signal.addEventListener("abort",()=>{b=!0}),t.signal)})},N=H_(t.options,t.fetchOptions),E=async(M,j,C)=>{if(b)return Promise.reject();if(j==null&&M.pages.length)return Promise.resolve(M);const $=(()=>{const P={client:t.client,queryKey:t.queryKey,pageParam:j,direction:C?"backward":"forward",meta:t.options.meta};return x(P),P})(),A=await N($),{maxPages:L}=t.options,T=C?bj:yj;return{pages:T(M.pages,A,L),pageParams:T(M.pageParams,j,L)}};if(l&&i.length){const M=l==="backward",j=M?Oj:ev,C={pages:i,pageParams:c},S=j(s,C);u=await E(C,S,M)}else{const M=e??i.length;do{const j=d===0?c[0]??s.initialPageParam:ev(s,u);if(d>0&&j==null)break;u=await E(u,j),d++}while(d<M)}return u};t.options.persister?t.fetchFn=()=>{var b,x;return(x=(b=t.options).persister)==null?void 0:x.call(b,p,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=p}}}function ev(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function Oj(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var Pj=(Rw=class extends Y_{constructor(t){super();He(this,Br);He(this,Gc);He(this,Ir);He(this,gs);He(this,el);Te(this,Gc,t.client),this.mutationId=t.mutationId,Te(this,gs,t.mutationCache),Te(this,Ir,[]),this.state=t.state||tv(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ne(this,Ir).includes(t)||(ne(this,Ir).push(t),this.clearGcTimeout(),ne(this,gs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Te(this,Ir,ne(this,Ir).filter(n=>n!==t)),this.scheduleGc(),ne(this,gs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ne(this,Ir).length||(this.state.status==="pending"?this.scheduleGc():ne(this,gs).remove(this))}continue(){var t;return((t=ne(this,el))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var c,u,d,p,h,f,g,w,_,b,x,N,E,M,j,C,S,$,A,L;const n=()=>{vt(this,Br,No).call(this,{type:"continue"})},s={client:ne(this,Gc),meta:this.options.meta,mutationKey:this.options.mutationKey};Te(this,el,K_({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(T,P)=>{vt(this,Br,No).call(this,{type:"failed",failureCount:T,error:P})},onPause:()=>{vt(this,Br,No).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ne(this,gs).canRun(this)}));const l=this.state.status==="pending",i=!ne(this,el).canStart();try{if(l)n();else{vt(this,Br,No).call(this,{type:"pending",variables:t,isPaused:i}),await((u=(c=ne(this,gs).config).onMutate)==null?void 0:u.call(c,t,this,s));const P=await((p=(d=this.options).onMutate)==null?void 0:p.call(d,t,s));P!==this.state.context&&vt(this,Br,No).call(this,{type:"pending",context:P,variables:t,isPaused:i})}const T=await ne(this,el).start();return await((f=(h=ne(this,gs).config).onSuccess)==null?void 0:f.call(h,T,t,this.state.context,this,s)),await((w=(g=this.options).onSuccess)==null?void 0:w.call(g,T,t,this.state.context,s)),await((b=(_=ne(this,gs).config).onSettled)==null?void 0:b.call(_,T,null,this.state.variables,this.state.context,this,s)),await((N=(x=this.options).onSettled)==null?void 0:N.call(x,T,null,t,this.state.context,s)),vt(this,Br,No).call(this,{type:"success",data:T}),T}catch(T){try{throw await((M=(E=ne(this,gs).config).onError)==null?void 0:M.call(E,T,t,this.state.context,this,s)),await((C=(j=this.options).onError)==null?void 0:C.call(j,T,t,this.state.context,s)),await(($=(S=ne(this,gs).config).onSettled)==null?void 0:$.call(S,void 0,T,this.state.variables,this.state.context,this,s)),await((L=(A=this.options).onSettled)==null?void 0:L.call(A,void 0,T,t,this.state.context,s)),T}finally{vt(this,Br,No).call(this,{type:"error",error:T})}}finally{ne(this,gs).runNext(this)}}},Gc=new WeakMap,Ir=new WeakMap,gs=new WeakMap,el=new WeakMap,Br=new WeakSet,No=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Mn.batch(()=>{ne(this,Ir).forEach(s=>{s.onMutationUpdate(t)}),ne(this,gs).notify({mutation:this,type:"updated",action:t})})},Rw);function tv(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Tj=(Fw=class extends Rl{constructor(t={}){super();He(this,aa);He(this,xr);He(this,Qc);this.config=t,Te(this,aa,new Set),Te(this,xr,new Map),Te(this,Qc,0)}build(t,n,s){const l=new Pj({client:t,mutationCache:this,mutationId:++Ef(this,Qc)._,options:t.defaultMutationOptions(n),state:s});return this.add(l),l}add(t){ne(this,aa).add(t);const n=Sd(t);if(typeof n=="string"){const s=ne(this,xr).get(n);s?s.push(t):ne(this,xr).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ne(this,aa).delete(t)){const n=Sd(t);if(typeof n=="string"){const s=ne(this,xr).get(n);if(s)if(s.length>1){const l=s.indexOf(t);l!==-1&&s.splice(l,1)}else s[0]===t&&ne(this,xr).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Sd(t);if(typeof n=="string"){const s=ne(this,xr).get(n),l=s==null?void 0:s.find(i=>i.state.status==="pending");return!l||l===t}else return!0}runNext(t){var s;const n=Sd(t);if(typeof n=="string"){const l=(s=ne(this,xr).get(n))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(l==null?void 0:l.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Mn.batch(()=>{ne(this,aa).forEach(t=>{this.notify({type:"removed",mutation:t})}),ne(this,aa).clear(),ne(this,xr).clear()})}getAll(){return Array.from(ne(this,aa))}find(t){const n={exact:!0,...t};return this.getAll().find(s=>I_(n,s))}findAll(t={}){return this.getAll().filter(n=>I_(t,n))}notify(t){Mn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Mn.batch(()=>Promise.all(t.map(n=>n.continue().catch(fs))))}},aa=new WeakMap,xr=new WeakMap,Qc=new WeakMap,Fw);function Sd(e){var t;return(t=e.options.scope)==null?void 0:t.id}var $j=(Iw=class extends Rl{constructor(t,n){super();He(this,ia);He(this,oa);He(this,Ia);He(this,As);He(this,la);Te(this,oa,t),this.setOptions(n),this.bindMethods(),vt(this,ia,kf).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const n=this.options;this.options=ne(this,oa).defaultMutationOptions(t),Nd(this.options,n)||ne(this,oa).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ne(this,As),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&ko(n.mutationKey)!==ko(this.options.mutationKey)?this.reset():((s=ne(this,As))==null?void 0:s.state.status)==="pending"&&ne(this,As).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=ne(this,As))==null||t.removeObserver(this)}onMutationUpdate(t){vt(this,ia,kf).call(this),vt(this,ia,k_).call(this,t)}getCurrentResult(){return ne(this,Ia)}reset(){var t;(t=ne(this,As))==null||t.removeObserver(this),Te(this,As,void 0),vt(this,ia,kf).call(this),vt(this,ia,k_).call(this)}mutate(t,n){var s;return Te(this,la,n),(s=ne(this,As))==null||s.removeObserver(this),Te(this,As,ne(this,oa).getMutationCache().build(ne(this,oa),this.options)),ne(this,As).addObserver(this),ne(this,As).execute(t)}},oa=new WeakMap,Ia=new WeakMap,As=new WeakMap,la=new WeakMap,ia=new WeakSet,kf=function(){var n;const t=((n=ne(this,As))==null?void 0:n.state)??tv();Te(this,Ia,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},k_=function(t){Mn.batch(()=>{var n,s,l,i,c,u,d,p;if(ne(this,la)&&this.hasListeners()){const h=ne(this,Ia).variables,f=ne(this,Ia).context,g={client:ne(this,oa),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((s=(n=ne(this,la)).onSuccess)==null||s.call(n,t.data,h,f,g),(i=(l=ne(this,la)).onSettled)==null||i.call(l,t.data,null,h,f,g)):(t==null?void 0:t.type)==="error"&&((u=(c=ne(this,la)).onError)==null||u.call(c,t.error,h,f,g),(p=(d=ne(this,la)).onSettled)==null||p.call(d,void 0,t.error,h,f,g))}this.listeners.forEach(h=>{h(ne(this,Ia))})})},Iw),Lj=(Bw=class extends Rl{constructor(t={}){super();He(this,Ur);this.config=t,Te(this,Ur,new Map)}build(t,n,s){const l=n.queryKey,i=n.queryHash??Tf(l,n);let c=this.get(i);return c||(c=new Ej({client:t,queryKey:l,queryHash:i,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(l)}),this.add(c)),c}add(t){ne(this,Ur).has(t.queryHash)||(ne(this,Ur).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=ne(this,Ur).get(t.queryHash);n&&(t.destroy(),n===t&&ne(this,Ur).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Mn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ne(this,Ur).get(t)}getAll(){return[...ne(this,Ur).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>F_(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>F_(t,s)):n}notify(t){Mn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Mn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Mn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ur=new WeakMap,Bw),zj=(Uw=class{constructor(e={}){He(this,un);He(this,Ba);He(this,Ua);He(this,hi);He(this,fi);He(this,qa);He(this,pi);He(this,gi);Te(this,un,e.queryCache||new Lj),Te(this,Ba,e.mutationCache||new Tj),Te(this,Ua,e.defaultOptions||{}),Te(this,hi,new Map),Te(this,fi,new Map),Te(this,qa,0)}mount(){Ef(this,qa)._++,ne(this,qa)===1&&(Te(this,pi,Df.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,un).onFocus())})),Te(this,gi,Cd.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,un).onOnline())})))}unmount(){var e,t;Ef(this,qa)._--,ne(this,qa)===0&&((e=ne(this,pi))==null||e.call(this),Te(this,pi,void 0),(t=ne(this,gi))==null||t.call(this),Te(this,gi,void 0))}isFetching(e){return ne(this,un).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ne(this,Ba).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,un).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=ne(this,un).build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Ea(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return ne(this,un).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),l=ne(this,un).get(s.queryHash),i=l==null?void 0:l.state.data,c=gj(t,i);if(c!==void 0)return ne(this,un).build(this,s).setData(c,{...n,manual:!0})}setQueriesData(e,t,n){return Mn.batch(()=>ne(this,un).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,un).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=ne(this,un);Mn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=ne(this,un);return Mn.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=Mn.batch(()=>ne(this,un).findAll(e).map(l=>l.cancel(n)));return Promise.all(s).then(fs).catch(fs)}invalidateQueries(e,t={}){return Mn.batch(()=>(ne(this,un).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=Mn.batch(()=>ne(this,un).findAll(e).filter(l=>!l.isDisabled()&&!l.isStatic()).map(l=>{let i=l.fetch(void 0,n);return n.throwOnError||(i=i.catch(fs)),l.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(fs)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=ne(this,un).build(this,t);return n.isStaleByTime(Ea(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(fs).catch(fs)}fetchInfiniteQuery(e){return e.behavior=Z_(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(fs).catch(fs)}ensureInfiniteQueryData(e){return e.behavior=Z_(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Cd.isOnline()?ne(this,Ba).resumePausedMutations():Promise.resolve()}getQueryCache(){return ne(this,un)}getMutationCache(){return ne(this,Ba)}getDefaultOptions(){return ne(this,Ua)}setDefaultOptions(e){Te(this,Ua,e)}setQueryDefaults(e,t){ne(this,hi).set(ko(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ne(this,hi).values()],n={};return t.forEach(s=>{oc(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){ne(this,fi).set(ko(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ne(this,fi).values()],n={};return t.forEach(s=>{oc(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ne(this,Ua).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Tf(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===zf&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ne(this,Ua).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ne(this,un).clear(),ne(this,Ba).clear()}},un=new WeakMap,Ba=new WeakMap,Ua=new WeakMap,hi=new WeakMap,fi=new WeakMap,qa=new WeakMap,pi=new WeakMap,gi=new WeakMap,Uw),nv=v.createContext(void 0),Mo=e=>{const t=v.useContext(nv);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Dj=({client:e,children:t})=>(v.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(nv.Provider,{value:e,children:t})),sv=v.createContext(!1),Rj=()=>v.useContext(sv);sv.Provider;function Fj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Ij=v.createContext(Fj()),Bj=()=>v.useContext(Ij),Uj=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},qj=e=>{v.useEffect(()=>{e.clearReset()},[e])},Hj=({result:e,errorResetBoundary:t,throwOnError:n,query:s,suspense:l})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(l&&e.data===void 0||V_(n,[e.error,s])),Vj=e=>{if(e.suspense){const n=l=>l==="static"?l:Math.max(l??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...l)=>n(s(...l)):n(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Wj=(e,t)=>e.isLoading&&e.isFetching&&!t,Kj=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,rv=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Yj(e,t,n){var f,g,w,_,b;const s=Rj(),l=Bj(),i=Mo(),c=i.defaultQueryOptions(e);(g=(f=i.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||g.call(f,c),c._optimisticResults=s?"isRestoring":"optimistic",Vj(c),Uj(c,l),qj(l);const u=!i.getQueryCache().get(c.queryHash),[d]=v.useState(()=>new t(i,c)),p=d.getOptimisticResult(c),h=!s&&e.subscribed!==!1;if(v.useSyncExternalStore(v.useCallback(x=>{const N=h?d.subscribe(Mn.batchCalls(x)):fs;return d.updateResult(),N},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),v.useEffect(()=>{d.setOptions(c)},[c,d]),Kj(c,p))throw rv(c,d,l);if(Hj({result:p,errorResetBoundary:l,throwOnError:c.throwOnError,query:i.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;if((_=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||_.call(w,c,p),c.experimental_prefetchInRender&&!Eo&&Wj(p,s)){const x=u?rv(c,d,l):(b=i.getQueryCache().get(c.queryHash))==null?void 0:b.promise;x==null||x.catch(fs).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?p:d.trackResult(p)}function Hs(e,t){return Yj(e,kj)}function Ed(e,t){const n=Mo(),[s]=v.useState(()=>new $j(n,e));v.useEffect(()=>{s.setOptions(e)},[s,e]);const l=v.useSyncExternalStore(v.useCallback(c=>s.subscribe(Mn.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((c,u)=>{s.mutate(c,u).catch(fs)},[s]);if(l.error&&V_(s.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:i,mutateAsync:l.mutate}}function Gj(e){let t;const n=new Set,s=(p,h)=>{const f=typeof p=="function"?p(t):p;if(f!==t){const g=t;t=h?f:Object.assign({},t,f),n.forEach(w=>w(t,g))}},l=()=>t,i=(p,h=l,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let g=h(t);function w(){const _=h(t);if(!f(g,_)){const b=g;p(g=_,b)}}return n.add(w),()=>n.delete(w)},d={setState:s,getState:l,subscribe:(p,h,f)=>h||f?i(p,h,f):(n.add(p),()=>n.delete(p)),destroy:()=>n.clear()};return t=e(s,l,d),d}const av=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?v.useEffect:v.useLayoutEffect;function Qj(e){const t=typeof e=="function"?Gj(e):e,n=(s=t.getState,l=Object.is)=>{const[,i]=v.useReducer(x=>x+1,0),c=t.getState(),u=v.useRef(c),d=v.useRef(s),p=v.useRef(l),h=v.useRef(!1),f=v.useRef();f.current===void 0&&(f.current=s(c));let g,w=!1;(u.current!==c||d.current!==s||p.current!==l||h.current)&&(g=s(c),w=!l(f.current,g)),av(()=>{w&&(f.current=g),u.current=c,d.current=s,p.current=l,h.current=!1});const _=v.useRef(c);av(()=>{const x=()=>{try{const E=t.getState(),M=d.current(E);p.current(f.current,M)||(u.current=E,f.current=M,i())}catch{h.current=!0,i()}},N=t.subscribe(x);return t.getState()!==_.current&&x(),N},[]);const b=w?g:f.current;return v.useDebugValue(b),b};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[n,t];return{next(){const l=s.length<=0;return{value:s.shift(),done:l}}}},n}function Xj(){const e=v.createContext(void 0);return{Provider:({initialStore:l,createStore:i,children:c})=>{const u=v.useRef();return u.current||(l&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),i||(i=()=>l)),u.current=i()),v.createElement(e.Provider,{value:u.current},c)},useStore:(l,i=Object.is)=>{const c=v.useContext(e);if(!c)throw new Error("Seems like you have not used zustand provider as an ancestor.");return c(l,i)},useStoreApi:()=>{const l=v.useContext(e);if(!l)throw new Error("Seems like you have not used zustand provider as an ancestor.");return v.useMemo(()=>({getState:l.getState,setState:l.setState,subscribe:l.subscribe,destroy:l.destroy}),[l])}}}var Jj={value:()=>{}};function kd(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new Md(n)}function Md(e){this._=e}function Zj(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",l=n.indexOf(".");if(l>=0&&(s=n.slice(l+1),n=n.slice(0,l)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}Md.prototype=kd.prototype={constructor:Md,on:function(e,t){var n=this._,s=Zj(e+"",n),l,i=-1,c=s.length;if(arguments.length<2){for(;++i<c;)if((l=(e=s[i]).type)&&(l=eN(n[l],e.name)))return l;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<c;)if(l=(e=s[i]).type)n[l]=ov(n[l],e.name,t);else if(t==null)for(l in n)n[l]=ov(n[l],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Md(e)},call:function(e,t){if((l=arguments.length-2)>0)for(var n=new Array(l),s=0,l,i;s<l;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],s=0,l=i.length;s<l;++s)i[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],l=0,i=s.length;l<i;++l)s[l].value.apply(t,n)}};function eN(e,t){for(var n=0,s=e.length,l;n<s;++n)if((l=e[n]).name===t)return l.value}function ov(e,t,n){for(var s=0,l=e.length;s<l;++s)if(e[s].name===t){e[s]=Jj,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var Uf="http://www.w3.org/1999/xhtml";const lv={svg:"http://www.w3.org/2000/svg",xhtml:Uf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ad(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),lv.hasOwnProperty(t)?{space:lv[t],local:e}:e}function tN(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Uf&&t.documentElement.namespaceURI===Uf?t.createElement(e):t.createElementNS(n,e)}}function nN(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function iv(e){var t=Ad(e);return(t.local?nN:tN)(t)}function sN(){}function qf(e){return e==null?sN:function(){return this.querySelector(e)}}function rN(e){typeof e!="function"&&(e=qf(e));for(var t=this._groups,n=t.length,s=new Array(n),l=0;l<n;++l)for(var i=t[l],c=i.length,u=s[l]=new Array(c),d,p,h=0;h<c;++h)(d=i[h])&&(p=e.call(d,d.__data__,h,i))&&("__data__"in d&&(p.__data__=d.__data__),u[h]=p);return new Vs(s,this._parents)}function aN(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function oN(){return[]}function cv(e){return e==null?oN:function(){return this.querySelectorAll(e)}}function lN(e){return function(){return aN(e.apply(this,arguments))}}function iN(e){typeof e=="function"?e=lN(e):e=cv(e);for(var t=this._groups,n=t.length,s=[],l=[],i=0;i<n;++i)for(var c=t[i],u=c.length,d,p=0;p<u;++p)(d=c[p])&&(s.push(e.call(d,d.__data__,p,c)),l.push(d));return new Vs(s,l)}function uv(e){return function(){return this.matches(e)}}function dv(e){return function(t){return t.matches(e)}}var cN=Array.prototype.find;function uN(e){return function(){return cN.call(this.children,e)}}function dN(){return this.firstElementChild}function mN(e){return this.select(e==null?dN:uN(typeof e=="function"?e:dv(e)))}var hN=Array.prototype.filter;function fN(){return Array.from(this.children)}function pN(e){return function(){return hN.call(this.children,e)}}function gN(e){return this.selectAll(e==null?fN:pN(typeof e=="function"?e:dv(e)))}function _N(e){typeof e!="function"&&(e=uv(e));for(var t=this._groups,n=t.length,s=new Array(n),l=0;l<n;++l)for(var i=t[l],c=i.length,u=s[l]=[],d,p=0;p<c;++p)(d=i[p])&&e.call(d,d.__data__,p,i)&&u.push(d);return new Vs(s,this._parents)}function mv(e){return new Array(e.length)}function vN(){return new Vs(this._enter||this._groups.map(mv),this._parents)}function Od(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Od.prototype={constructor:Od,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function yN(e){return function(){return e}}function bN(e,t,n,s,l,i){for(var c=0,u,d=t.length,p=i.length;c<p;++c)(u=t[c])?(u.__data__=i[c],s[c]=u):n[c]=new Od(e,i[c]);for(;c<d;++c)(u=t[c])&&(l[c]=u)}function xN(e,t,n,s,l,i,c){var u,d,p=new Map,h=t.length,f=i.length,g=new Array(h),w;for(u=0;u<h;++u)(d=t[u])&&(g[u]=w=c.call(d,d.__data__,u,t)+"",p.has(w)?l[u]=d:p.set(w,d));for(u=0;u<f;++u)w=c.call(e,i[u],u,i)+"",(d=p.get(w))?(s[u]=d,d.__data__=i[u],p.delete(w)):n[u]=new Od(e,i[u]);for(u=0;u<h;++u)(d=t[u])&&p.get(g[u])===d&&(l[u]=d)}function wN(e){return e.__data__}function jN(e,t){if(!arguments.length)return Array.from(this,wN);var n=t?xN:bN,s=this._parents,l=this._groups;typeof e!="function"&&(e=yN(e));for(var i=l.length,c=new Array(i),u=new Array(i),d=new Array(i),p=0;p<i;++p){var h=s[p],f=l[p],g=f.length,w=NN(e.call(h,h&&h.__data__,p,s)),_=w.length,b=u[p]=new Array(_),x=c[p]=new Array(_),N=d[p]=new Array(g);n(h,f,b,x,N,w,t);for(var E=0,M=0,j,C;E<_;++E)if(j=b[E]){for(E>=M&&(M=E+1);!(C=x[M])&&++M<_;);j._next=C||null}}return c=new Vs(c,s),c._enter=u,c._exit=d,c}function NN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function CN(){return new Vs(this._exit||this._groups.map(mv),this._parents)}function SN(e,t,n){var s=this.enter(),l=this,i=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(l=t(l),l&&(l=l.selection())),n==null?i.remove():n(i),s&&l?s.merge(l).order():l}function EN(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,l=n.length,i=s.length,c=Math.min(l,i),u=new Array(l),d=0;d<c;++d)for(var p=n[d],h=s[d],f=p.length,g=u[d]=new Array(f),w,_=0;_<f;++_)(w=p[_]||h[_])&&(g[_]=w);for(;d<l;++d)u[d]=n[d];return new Vs(u,this._parents)}function kN(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],l=s.length-1,i=s[l],c;--l>=0;)(c=s[l])&&(i&&c.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(c,i),i=c);return this}function MN(e){e||(e=AN);function t(f,g){return f&&g?e(f.__data__,g.__data__):!f-!g}for(var n=this._groups,s=n.length,l=new Array(s),i=0;i<s;++i){for(var c=n[i],u=c.length,d=l[i]=new Array(u),p,h=0;h<u;++h)(p=c[h])&&(d[h]=p);d.sort(t)}return new Vs(l,this._parents).order()}function AN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ON(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function PN(){return Array.from(this)}function TN(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],l=0,i=s.length;l<i;++l){var c=s[l];if(c)return c}return null}function $N(){let e=0;for(const t of this)++e;return e}function LN(){return!this.node()}function zN(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var l=t[n],i=0,c=l.length,u;i<c;++i)(u=l[i])&&e.call(u,u.__data__,i,l);return this}function DN(e){return function(){this.removeAttribute(e)}}function RN(e){return function(){this.removeAttributeNS(e.space,e.local)}}function FN(e,t){return function(){this.setAttribute(e,t)}}function IN(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function BN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function UN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function qN(e,t){var n=Ad(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?RN:DN:typeof t=="function"?n.local?UN:BN:n.local?IN:FN)(n,t))}function hv(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function HN(e){return function(){this.style.removeProperty(e)}}function VN(e,t,n){return function(){this.style.setProperty(e,t,n)}}function WN(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function KN(e,t,n){return arguments.length>1?this.each((t==null?HN:typeof t=="function"?WN:VN)(e,t,n??"")):Fl(this.node(),e)}function Fl(e,t){return e.style.getPropertyValue(t)||hv(e).getComputedStyle(e,null).getPropertyValue(t)}function YN(e){return function(){delete this[e]}}function GN(e,t){return function(){this[e]=t}}function QN(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function XN(e,t){return arguments.length>1?this.each((t==null?YN:typeof t=="function"?QN:GN)(e,t)):this.node()[e]}function fv(e){return e.trim().split(/^|\s+/)}function Hf(e){return e.classList||new pv(e)}function pv(e){this._node=e,this._names=fv(e.getAttribute("class")||"")}pv.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function gv(e,t){for(var n=Hf(e),s=-1,l=t.length;++s<l;)n.add(t[s])}function _v(e,t){for(var n=Hf(e),s=-1,l=t.length;++s<l;)n.remove(t[s])}function JN(e){return function(){gv(this,e)}}function ZN(e){return function(){_v(this,e)}}function eC(e,t){return function(){(t.apply(this,arguments)?gv:_v)(this,e)}}function tC(e,t){var n=fv(e+"");if(arguments.length<2){for(var s=Hf(this.node()),l=-1,i=n.length;++l<i;)if(!s.contains(n[l]))return!1;return!0}return this.each((typeof t=="function"?eC:t?JN:ZN)(n,t))}function nC(){this.textContent=""}function sC(e){return function(){this.textContent=e}}function rC(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function aC(e){return arguments.length?this.each(e==null?nC:(typeof e=="function"?rC:sC)(e)):this.node().textContent}function oC(){this.innerHTML=""}function lC(e){return function(){this.innerHTML=e}}function iC(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function cC(e){return arguments.length?this.each(e==null?oC:(typeof e=="function"?iC:lC)(e)):this.node().innerHTML}function uC(){this.nextSibling&&this.parentNode.appendChild(this)}function dC(){return this.each(uC)}function mC(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function hC(){return this.each(mC)}function fC(e){var t=typeof e=="function"?e:iv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function pC(){return null}function gC(e,t){var n=typeof e=="function"?e:iv(e),s=t==null?pC:typeof t=="function"?t:qf(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function _C(){var e=this.parentNode;e&&e.removeChild(this)}function vC(){return this.each(_C)}function yC(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function bC(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function xC(e){return this.select(e?bC:yC)}function wC(e){return arguments.length?this.property("__data__",e):this.node().__data__}function jC(e){return function(t){e.call(this,t,this.__data__)}}function NC(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function CC(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,l=t.length,i;n<l;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++s]=i;++s?t.length=s:delete this.__on}}}function SC(e,t,n){return function(){var s=this.__on,l,i=jC(t);if(s){for(var c=0,u=s.length;c<u;++c)if((l=s[c]).type===e.type&&l.name===e.name){this.removeEventListener(l.type,l.listener,l.options),this.addEventListener(l.type,l.listener=i,l.options=n),l.value=t;return}}this.addEventListener(e.type,i,n),l={type:e.type,name:e.name,value:t,listener:i,options:n},s?s.push(l):this.__on=[l]}}function EC(e,t,n){var s=NC(e+""),l,i=s.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var d=0,p=u.length,h;d<p;++d)for(l=0,h=u[d];l<i;++l)if((c=s[l]).type===h.type&&c.name===h.name)return h.value}return}for(u=t?SC:CC,l=0;l<i;++l)this.each(u(s[l],t,n));return this}function vv(e,t,n){var s=hv(e),l=s.CustomEvent;typeof l=="function"?l=new l(t,n):(l=s.document.createEvent("Event"),n?(l.initEvent(t,n.bubbles,n.cancelable),l.detail=n.detail):l.initEvent(t,!1,!1)),e.dispatchEvent(l)}function kC(e,t){return function(){return vv(this,e,t)}}function MC(e,t){return function(){return vv(this,e,t.apply(this,arguments))}}function AC(e,t){return this.each((typeof t=="function"?MC:kC)(e,t))}function*OC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],l=0,i=s.length,c;l<i;++l)(c=s[l])&&(yield c)}var yv=[null];function Vs(e,t){this._groups=e,this._parents=t}function lc(){return new Vs([[document.documentElement]],yv)}function PC(){return this}Vs.prototype=lc.prototype={constructor:Vs,select:rN,selectAll:iN,selectChild:mN,selectChildren:gN,filter:_N,data:jN,enter:vN,exit:CN,join:SN,merge:EN,selection:PC,order:kN,sort:MN,call:ON,nodes:PN,node:TN,size:$N,empty:LN,each:zN,attr:qN,style:KN,property:XN,classed:tC,text:aC,html:cC,raise:dC,lower:hC,append:fC,insert:gC,remove:vC,clone:xC,datum:wC,on:EC,dispatch:AC,[Symbol.iterator]:OC};function gr(e){return typeof e=="string"?new Vs([[document.querySelector(e)]],[document.documentElement]):new Vs([[e]],yv)}function TC(e){let t;for(;t=e.sourceEvent;)e=t;return e}function zr(e,t){if(e=TC(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var l=t.getBoundingClientRect();return[e.clientX-l.left-t.clientLeft,e.clientY-l.top-t.clientTop]}}return[e.pageX,e.pageY]}const $C={passive:!1},ic={capture:!0,passive:!1};function Vf(e){e.stopImmediatePropagation()}function Il(e){e.preventDefault(),e.stopImmediatePropagation()}function bv(e){var t=e.document.documentElement,n=gr(e).on("dragstart.drag",Il,ic);"onselectstart"in t?n.on("selectstart.drag",Il,ic):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function xv(e,t){var n=e.document.documentElement,s=gr(e).on("dragstart.drag",null);t&&(s.on("click.drag",Il,ic),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Pd=e=>()=>e;function Wf(e,{sourceEvent:t,subject:n,target:s,identifier:l,active:i,x:c,y:u,dx:d,dy:p,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:l,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:h}})}Wf.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function LC(e){return!e.ctrlKey&&!e.button}function zC(){return this.parentNode}function DC(e,t){return t??{x:e.x,y:e.y}}function RC(){return navigator.maxTouchPoints||"ontouchstart"in this}function FC(){var e=LC,t=zC,n=DC,s=RC,l={},i=kd("start","drag","end"),c=0,u,d,p,h,f=0;function g(j){j.on("mousedown.drag",w).filter(s).on("touchstart.drag",x).on("touchmove.drag",N,$C).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function w(j,C){if(!(h||!e.call(this,j,C))){var S=M(this,t.call(this,j,C),j,C,"mouse");S&&(gr(j.view).on("mousemove.drag",_,ic).on("mouseup.drag",b,ic),bv(j.view),Vf(j),p=!1,u=j.clientX,d=j.clientY,S("start",j))}}function _(j){if(Il(j),!p){var C=j.clientX-u,S=j.clientY-d;p=C*C+S*S>f}l.mouse("drag",j)}function b(j){gr(j.view).on("mousemove.drag mouseup.drag",null),xv(j.view,p),Il(j),l.mouse("end",j)}function x(j,C){if(e.call(this,j,C)){var S=j.changedTouches,$=t.call(this,j,C),A=S.length,L,T;for(L=0;L<A;++L)(T=M(this,$,j,C,S[L].identifier,S[L]))&&(Vf(j),T("start",j,S[L]))}}function N(j){var C=j.changedTouches,S=C.length,$,A;for($=0;$<S;++$)(A=l[C[$].identifier])&&(Il(j),A("drag",j,C[$]))}function E(j){var C=j.changedTouches,S=C.length,$,A;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),$=0;$<S;++$)(A=l[C[$].identifier])&&(Vf(j),A("end",j,C[$]))}function M(j,C,S,$,A,L){var T=i.copy(),P=zr(L||S,C),z,W,D;if((D=n.call(j,new Wf("beforestart",{sourceEvent:S,target:g,identifier:A,active:c,x:P[0],y:P[1],dx:0,dy:0,dispatch:T}),$))!=null)return z=D.x-P[0]||0,W=D.y-P[1]||0,function R(U,V,B){var G=P,q;switch(U){case"start":l[A]=R,q=c++;break;case"end":delete l[A],--c;case"drag":P=zr(B||V,C),q=c;break}T.call(U,j,new Wf(U,{sourceEvent:V,subject:D,target:g,identifier:A,active:q,x:P[0]+z,y:P[1]+W,dx:P[0]-G[0],dy:P[1]-G[1],dispatch:T}),$)}}return g.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Pd(!!j),g):e},g.container=function(j){return arguments.length?(t=typeof j=="function"?j:Pd(j),g):t},g.subject=function(j){return arguments.length?(n=typeof j=="function"?j:Pd(j),g):n},g.touchable=function(j){return arguments.length?(s=typeof j=="function"?j:Pd(!!j),g):s},g.on=function(){var j=i.on.apply(i,arguments);return j===i?g:j},g.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,g):Math.sqrt(f)},g}function Kf(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function wv(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function cc(){}var uc=.7,Td=1/uc,Bl="\\s*([+-]?\\d+)\\s*",dc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Dr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",IC=/^#([0-9a-f]{3,8})$/,BC=new RegExp(`^rgb\\(${Bl},${Bl},${Bl}\\)$`),UC=new RegExp(`^rgb\\(${Dr},${Dr},${Dr}\\)$`),qC=new RegExp(`^rgba\\(${Bl},${Bl},${Bl},${dc}\\)$`),HC=new RegExp(`^rgba\\(${Dr},${Dr},${Dr},${dc}\\)$`),VC=new RegExp(`^hsl\\(${dc},${Dr},${Dr}\\)$`),WC=new RegExp(`^hsla\\(${dc},${Dr},${Dr},${dc}\\)$`),jv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kf(cc,mc,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Nv,formatHex:Nv,formatHex8:KC,formatHsl:YC,formatRgb:Cv,toString:Cv});function Nv(){return this.rgb().formatHex()}function KC(){return this.rgb().formatHex8()}function YC(){return Av(this).formatHsl()}function Cv(){return this.rgb().formatRgb()}function mc(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=IC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Sv(t):n===3?new Ss(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?$d(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?$d(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=BC.exec(e))?new Ss(t[1],t[2],t[3],1):(t=UC.exec(e))?new Ss(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qC.exec(e))?$d(t[1],t[2],t[3],t[4]):(t=HC.exec(e))?$d(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=VC.exec(e))?Mv(t[1],t[2]/100,t[3]/100,1):(t=WC.exec(e))?Mv(t[1],t[2]/100,t[3]/100,t[4]):jv.hasOwnProperty(e)?Sv(jv[e]):e==="transparent"?new Ss(NaN,NaN,NaN,0):null}function Sv(e){return new Ss(e>>16&255,e>>8&255,e&255,1)}function $d(e,t,n,s){return s<=0&&(e=t=n=NaN),new Ss(e,t,n,s)}function GC(e){return e instanceof cc||(e=mc(e)),e?(e=e.rgb(),new Ss(e.r,e.g,e.b,e.opacity)):new Ss}function Yf(e,t,n,s){return arguments.length===1?GC(e):new Ss(e,t,n,s??1)}function Ss(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}Kf(Ss,Yf,wv(cc,{brighter(e){return e=e==null?Td:Math.pow(Td,e),new Ss(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?uc:Math.pow(uc,e),new Ss(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ss(Ao(this.r),Ao(this.g),Ao(this.b),Ld(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ev,formatHex:Ev,formatHex8:QC,formatRgb:kv,toString:kv}));function Ev(){return`#${Oo(this.r)}${Oo(this.g)}${Oo(this.b)}`}function QC(){return`#${Oo(this.r)}${Oo(this.g)}${Oo(this.b)}${Oo((isNaN(this.opacity)?1:this.opacity)*255)}`}function kv(){const e=Ld(this.opacity);return`${e===1?"rgb(":"rgba("}${Ao(this.r)}, ${Ao(this.g)}, ${Ao(this.b)}${e===1?")":`, ${e})`}`}function Ld(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Ao(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Oo(e){return e=Ao(e),(e<16?"0":"")+e.toString(16)}function Mv(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _r(e,t,n,s)}function Av(e){if(e instanceof _r)return new _r(e.h,e.s,e.l,e.opacity);if(e instanceof cc||(e=mc(e)),!e)return new _r;if(e instanceof _r)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,l=Math.min(t,n,s),i=Math.max(t,n,s),c=NaN,u=i-l,d=(i+l)/2;return u?(t===i?c=(n-s)/u+(n<s)*6:n===i?c=(s-t)/u+2:c=(t-n)/u+4,u/=d<.5?i+l:2-i-l,c*=60):u=d>0&&d<1?0:c,new _r(c,u,d,e.opacity)}function XC(e,t,n,s){return arguments.length===1?Av(e):new _r(e,t,n,s??1)}function _r(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}Kf(_r,XC,wv(cc,{brighter(e){return e=e==null?Td:Math.pow(Td,e),new _r(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?uc:Math.pow(uc,e),new _r(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,l=2*n-s;return new Ss(Gf(e>=240?e-240:e+120,l,s),Gf(e,l,s),Gf(e<120?e+240:e-120,l,s),this.opacity)},clamp(){return new _r(Ov(this.h),zd(this.s),zd(this.l),Ld(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ld(this.opacity);return`${e===1?"hsl(":"hsla("}${Ov(this.h)}, ${zd(this.s)*100}%, ${zd(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Ov(e){return e=(e||0)%360,e<0?e+360:e}function zd(e){return Math.max(0,Math.min(1,e||0))}function Gf(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Pv=e=>()=>e;function JC(e,t){return function(n){return e+n*t}}function ZC(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function eS(e){return(e=+e)==1?Tv:function(t,n){return n-t?ZC(t,n,e):Pv(isNaN(t)?n:t)}}function Tv(e,t){var n=t-e;return n?JC(e,n):Pv(isNaN(e)?t:e)}const $v=function e(t){var n=eS(t);function s(l,i){var c=n((l=Yf(l)).r,(i=Yf(i)).r),u=n(l.g,i.g),d=n(l.b,i.b),p=Tv(l.opacity,i.opacity);return function(h){return l.r=c(h),l.g=u(h),l.b=d(h),l.opacity=p(h),l+""}}return s.gamma=e,s}(1);function ka(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Qf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xf=new RegExp(Qf.source,"g");function tS(e){return function(){return e}}function nS(e){return function(t){return e(t)+""}}function sS(e,t){var n=Qf.lastIndex=Xf.lastIndex=0,s,l,i,c=-1,u=[],d=[];for(e=e+"",t=t+"";(s=Qf.exec(e))&&(l=Xf.exec(t));)(i=l.index)>n&&(i=t.slice(n,i),u[c]?u[c]+=i:u[++c]=i),(s=s[0])===(l=l[0])?u[c]?u[c]+=l:u[++c]=l:(u[++c]=null,d.push({i:c,x:ka(s,l)})),n=Xf.lastIndex;return n<t.length&&(i=t.slice(n),u[c]?u[c]+=i:u[++c]=i),u.length<2?d[0]?nS(d[0].x):tS(t):(t=d.length,function(p){for(var h=0,f;h<t;++h)u[(f=d[h]).i]=f.x(p);return u.join("")})}var Lv=180/Math.PI,Jf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function zv(e,t,n,s,l,i){var c,u,d;return(c=Math.sqrt(e*e+t*t))&&(e/=c,t/=c),(d=e*n+t*s)&&(n-=e*d,s-=t*d),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,d/=u),e*s<t*n&&(e=-e,t=-t,d=-d,c=-c),{translateX:l,translateY:i,rotate:Math.atan2(t,e)*Lv,skewX:Math.atan(d)*Lv,scaleX:c,scaleY:u}}var Dd;function rS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Jf:zv(t.a,t.b,t.c,t.d,t.e,t.f)}function aS(e){return e==null||(Dd||(Dd=document.createElementNS("http://www.w3.org/2000/svg","g")),Dd.setAttribute("transform",e),!(e=Dd.transform.baseVal.consolidate()))?Jf:(e=e.matrix,zv(e.a,e.b,e.c,e.d,e.e,e.f))}function Dv(e,t,n,s){function l(p){return p.length?p.pop()+" ":""}function i(p,h,f,g,w,_){if(p!==f||h!==g){var b=w.push("translate(",null,t,null,n);_.push({i:b-4,x:ka(p,f)},{i:b-2,x:ka(h,g)})}else(f||g)&&w.push("translate("+f+t+g+n)}function c(p,h,f,g){p!==h?(p-h>180?h+=360:h-p>180&&(p+=360),g.push({i:f.push(l(f)+"rotate(",null,s)-2,x:ka(p,h)})):h&&f.push(l(f)+"rotate("+h+s)}function u(p,h,f,g){p!==h?g.push({i:f.push(l(f)+"skewX(",null,s)-2,x:ka(p,h)}):h&&f.push(l(f)+"skewX("+h+s)}function d(p,h,f,g,w,_){if(p!==f||h!==g){var b=w.push(l(w)+"scale(",null,",",null,")");_.push({i:b-4,x:ka(p,f)},{i:b-2,x:ka(h,g)})}else(f!==1||g!==1)&&w.push(l(w)+"scale("+f+","+g+")")}return function(p,h){var f=[],g=[];return p=e(p),h=e(h),i(p.translateX,p.translateY,h.translateX,h.translateY,f,g),c(p.rotate,h.rotate,f,g),u(p.skewX,h.skewX,f,g),d(p.scaleX,p.scaleY,h.scaleX,h.scaleY,f,g),p=h=null,function(w){for(var _=-1,b=g.length,x;++_<b;)f[(x=g[_]).i]=x.x(w);return f.join("")}}}var oS=Dv(rS,"px, ","px)","deg)"),lS=Dv(aS,", ",")",")"),iS=1e-12;function Rv(e){return((e=Math.exp(e))+1/e)/2}function cS(e){return((e=Math.exp(e))-1/e)/2}function uS(e){return((e=Math.exp(2*e))-1)/(e+1)}const dS=function e(t,n,s){function l(i,c){var u=i[0],d=i[1],p=i[2],h=c[0],f=c[1],g=c[2],w=h-u,_=f-d,b=w*w+_*_,x,N;if(b<iS)N=Math.log(g/p)/t,x=function($){return[u+$*w,d+$*_,p*Math.exp(t*$*N)]};else{var E=Math.sqrt(b),M=(g*g-p*p+s*b)/(2*p*n*E),j=(g*g-p*p-s*b)/(2*g*n*E),C=Math.log(Math.sqrt(M*M+1)-M),S=Math.log(Math.sqrt(j*j+1)-j);N=(S-C)/t,x=function($){var A=$*N,L=Rv(C),T=p/(n*E)*(L*uS(t*A+C)-cS(C));return[u+T*w,d+T*_,p*L/Rv(t*A+C)]}}return x.duration=N*1e3*t/Math.SQRT2,x}return l.rho=function(i){var c=Math.max(.001,+i),u=c*c,d=u*u;return e(c,u,d)},l}(Math.SQRT2,2,4);var Ul=0,hc=0,fc=0,Fv=1e3,Rd,pc,Fd=0,Po=0,Id=0,gc=typeof performance=="object"&&performance.now?performance:Date,Iv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Zf(){return Po||(Iv(mS),Po=gc.now()+Id)}function mS(){Po=0}function Bd(){this._call=this._time=this._next=null}Bd.prototype=Bv.prototype={constructor:Bd,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Zf():+n)+(t==null?0:+t),!this._next&&pc!==this&&(pc?pc._next=this:Rd=this,pc=this),this._call=e,this._time=n,ep()},stop:function(){this._call&&(this._call=null,this._time=1/0,ep())}};function Bv(e,t,n){var s=new Bd;return s.restart(e,t,n),s}function hS(){Zf(),++Ul;for(var e=Rd,t;e;)(t=Po-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ul}function Uv(){Po=(Fd=gc.now())+Id,Ul=hc=0;try{hS()}finally{Ul=0,pS(),Po=0}}function fS(){var e=gc.now(),t=e-Fd;t>Fv&&(Id-=t,Fd=e)}function pS(){for(var e,t=Rd,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Rd=n);pc=e,ep(s)}function ep(e){if(!Ul){hc&&(hc=clearTimeout(hc));var t=e-Po;t>24?(e<1/0&&(hc=setTimeout(Uv,e-gc.now()-Id)),fc&&(fc=clearInterval(fc))):(fc||(Fd=gc.now(),fc=setInterval(fS,Fv)),Ul=1,Iv(Uv))}}function qv(e,t,n){var s=new Bd;return t=t==null?0:+t,s.restart(l=>{s.stop(),e(l+t)},t,n),s}var gS=kd("start","end","cancel","interrupt"),_S=[],Hv=0,Vv=1,tp=2,Ud=3,Wv=4,np=5,qd=6;function Hd(e,t,n,s,l,i){var c=e.__transition;if(!c)e.__transition={};else if(n in c)return;vS(e,n,{name:t,index:s,group:l,on:gS,tween:_S,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:Hv})}function sp(e,t){var n=vr(e,t);if(n.state>Hv)throw new Error("too late; already scheduled");return n}function Rr(e,t){var n=vr(e,t);if(n.state>Ud)throw new Error("too late; already running");return n}function vr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function vS(e,t,n){var s=e.__transition,l;s[t]=n,n.timer=Bv(i,0,n.time);function i(p){n.state=Vv,n.timer.restart(c,n.delay,n.time),n.delay<=p&&c(p-n.delay)}function c(p){var h,f,g,w;if(n.state!==Vv)return d();for(h in s)if(w=s[h],w.name===n.name){if(w.state===Ud)return qv(c);w.state===Wv?(w.state=qd,w.timer.stop(),w.on.call("interrupt",e,e.__data__,w.index,w.group),delete s[h]):+h<t&&(w.state=qd,w.timer.stop(),w.on.call("cancel",e,e.__data__,w.index,w.group),delete s[h])}if(qv(function(){n.state===Ud&&(n.state=Wv,n.timer.restart(u,n.delay,n.time),u(p))}),n.state=tp,n.on.call("start",e,e.__data__,n.index,n.group),n.state===tp){for(n.state=Ud,l=new Array(g=n.tween.length),h=0,f=-1;h<g;++h)(w=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(l[++f]=w);l.length=f+1}}function u(p){for(var h=p<n.duration?n.ease.call(null,p/n.duration):(n.timer.restart(d),n.state=np,1),f=-1,g=l.length;++f<g;)l[f].call(e,h);n.state===np&&(n.on.call("end",e,e.__data__,n.index,n.group),d())}function d(){n.state=qd,n.timer.stop(),delete s[t];for(var p in s)return;delete e.__transition}}function Vd(e,t){var n=e.__transition,s,l,i=!0,c;if(n){t=t==null?null:t+"";for(c in n){if((s=n[c]).name!==t){i=!1;continue}l=s.state>tp&&s.state<np,s.state=qd,s.timer.stop(),s.on.call(l?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[c]}i&&delete e.__transition}}function yS(e){return this.each(function(){Vd(this,e)})}function bS(e,t){var n,s;return function(){var l=Rr(this,e),i=l.tween;if(i!==n){s=n=i;for(var c=0,u=s.length;c<u;++c)if(s[c].name===t){s=s.slice(),s.splice(c,1);break}}l.tween=s}}function xS(e,t,n){var s,l;if(typeof n!="function")throw new Error;return function(){var i=Rr(this,e),c=i.tween;if(c!==s){l=(s=c).slice();for(var u={name:t,value:n},d=0,p=l.length;d<p;++d)if(l[d].name===t){l[d]=u;break}d===p&&l.push(u)}i.tween=l}}function wS(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=vr(this.node(),n).tween,l=0,i=s.length,c;l<i;++l)if((c=s[l]).name===e)return c.value;return null}return this.each((t==null?bS:xS)(n,e,t))}function rp(e,t,n){var s=e._id;return e.each(function(){var l=Rr(this,s);(l.value||(l.value={}))[t]=n.apply(this,arguments)}),function(l){return vr(l,s).value[t]}}function Kv(e,t){var n;return(typeof t=="number"?ka:t instanceof mc?$v:(n=mc(t))?(t=n,$v):sS)(e,t)}function jS(e){return function(){this.removeAttribute(e)}}function NS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function CS(e,t,n){var s,l=n+"",i;return function(){var c=this.getAttribute(e);return c===l?null:c===s?i:i=t(s=c,n)}}function SS(e,t,n){var s,l=n+"",i;return function(){var c=this.getAttributeNS(e.space,e.local);return c===l?null:c===s?i:i=t(s=c,n)}}function ES(e,t,n){var s,l,i;return function(){var c,u=n(this),d;return u==null?void this.removeAttribute(e):(c=this.getAttribute(e),d=u+"",c===d?null:c===s&&d===l?i:(l=d,i=t(s=c,u)))}}function kS(e,t,n){var s,l,i;return function(){var c,u=n(this),d;return u==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),d=u+"",c===d?null:c===s&&d===l?i:(l=d,i=t(s=c,u)))}}function MS(e,t){var n=Ad(e),s=n==="transform"?lS:Kv;return this.attrTween(e,typeof t=="function"?(n.local?kS:ES)(n,s,rp(this,"attr."+e,t)):t==null?(n.local?NS:jS)(n):(n.local?SS:CS)(n,s,t))}function AS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function OS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function PS(e,t){var n,s;function l(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&OS(e,i)),n}return l._value=t,l}function TS(e,t){var n,s;function l(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&AS(e,i)),n}return l._value=t,l}function $S(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=Ad(e);return this.tween(n,(s.local?PS:TS)(s,t))}function LS(e,t){return function(){sp(this,e).delay=+t.apply(this,arguments)}}function zS(e,t){return t=+t,function(){sp(this,e).delay=t}}function DS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?LS:zS)(t,e)):vr(this.node(),t).delay}function RS(e,t){return function(){Rr(this,e).duration=+t.apply(this,arguments)}}function FS(e,t){return t=+t,function(){Rr(this,e).duration=t}}function IS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?RS:FS)(t,e)):vr(this.node(),t).duration}function BS(e,t){if(typeof t!="function")throw new Error;return function(){Rr(this,e).ease=t}}function US(e){var t=this._id;return arguments.length?this.each(BS(t,e)):vr(this.node(),t).ease}function qS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Rr(this,e).ease=n}}function HS(e){if(typeof e!="function")throw new Error;return this.each(qS(this._id,e))}function VS(e){typeof e!="function"&&(e=uv(e));for(var t=this._groups,n=t.length,s=new Array(n),l=0;l<n;++l)for(var i=t[l],c=i.length,u=s[l]=[],d,p=0;p<c;++p)(d=i[p])&&e.call(d,d.__data__,p,i)&&u.push(d);return new Xr(s,this._parents,this._name,this._id)}function WS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,l=n.length,i=Math.min(s,l),c=new Array(s),u=0;u<i;++u)for(var d=t[u],p=n[u],h=d.length,f=c[u]=new Array(h),g,w=0;w<h;++w)(g=d[w]||p[w])&&(f[w]=g);for(;u<s;++u)c[u]=t[u];return new Xr(c,this._parents,this._name,this._id)}function KS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function YS(e,t,n){var s,l,i=KS(t)?sp:Rr;return function(){var c=i(this,e),u=c.on;u!==s&&(l=(s=u).copy()).on(t,n),c.on=l}}function GS(e,t){var n=this._id;return arguments.length<2?vr(this.node(),n).on.on(e):this.each(YS(n,e,t))}function QS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function XS(){return this.on("end.remove",QS(this._id))}function JS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=qf(e));for(var s=this._groups,l=s.length,i=new Array(l),c=0;c<l;++c)for(var u=s[c],d=u.length,p=i[c]=new Array(d),h,f,g=0;g<d;++g)(h=u[g])&&(f=e.call(h,h.__data__,g,u))&&("__data__"in h&&(f.__data__=h.__data__),p[g]=f,Hd(p[g],t,n,g,p,vr(h,n)));return new Xr(i,this._parents,t,n)}function ZS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=cv(e));for(var s=this._groups,l=s.length,i=[],c=[],u=0;u<l;++u)for(var d=s[u],p=d.length,h,f=0;f<p;++f)if(h=d[f]){for(var g=e.call(h,h.__data__,f,d),w,_=vr(h,n),b=0,x=g.length;b<x;++b)(w=g[b])&&Hd(w,t,n,b,g,_);i.push(g),c.push(h)}return new Xr(i,c,t,n)}var eE=lc.prototype.constructor;function tE(){return new eE(this._groups,this._parents)}function nE(e,t){var n,s,l;return function(){var i=Fl(this,e),c=(this.style.removeProperty(e),Fl(this,e));return i===c?null:i===n&&c===s?l:l=t(n=i,s=c)}}function Yv(e){return function(){this.style.removeProperty(e)}}function sE(e,t,n){var s,l=n+"",i;return function(){var c=Fl(this,e);return c===l?null:c===s?i:i=t(s=c,n)}}function rE(e,t,n){var s,l,i;return function(){var c=Fl(this,e),u=n(this),d=u+"";return u==null&&(d=u=(this.style.removeProperty(e),Fl(this,e))),c===d?null:c===s&&d===l?i:(l=d,i=t(s=c,u))}}function aE(e,t){var n,s,l,i="style."+t,c="end."+i,u;return function(){var d=Rr(this,e),p=d.on,h=d.value[i]==null?u||(u=Yv(t)):void 0;(p!==n||l!==h)&&(s=(n=p).copy()).on(c,l=h),d.on=s}}function oE(e,t,n){var s=(e+="")=="transform"?oS:Kv;return t==null?this.styleTween(e,nE(e,s)).on("end.style."+e,Yv(e)):typeof t=="function"?this.styleTween(e,rE(e,s,rp(this,"style."+e,t))).each(aE(this._id,e)):this.styleTween(e,sE(e,s,t),n).on("end.style."+e,null)}function lE(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function iE(e,t,n){var s,l;function i(){var c=t.apply(this,arguments);return c!==l&&(s=(l=c)&&lE(e,c,n)),s}return i._value=t,i}function cE(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,iE(e,t,n??""))}function uE(e){return function(){this.textContent=e}}function dE(e){return function(){var t=e(this);this.textContent=t??""}}function mE(e){return this.tween("text",typeof e=="function"?dE(rp(this,"text",e)):uE(e==null?"":e+""))}function hE(e){return function(t){this.textContent=e.call(this,t)}}function fE(e){var t,n;function s(){var l=e.apply(this,arguments);return l!==n&&(t=(n=l)&&hE(l)),t}return s._value=e,s}function pE(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,fE(e))}function gE(){for(var e=this._name,t=this._id,n=Gv(),s=this._groups,l=s.length,i=0;i<l;++i)for(var c=s[i],u=c.length,d,p=0;p<u;++p)if(d=c[p]){var h=vr(d,t);Hd(d,e,n,p,c,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Xr(s,this._parents,e,n)}function _E(){var e,t,n=this,s=n._id,l=n.size();return new Promise(function(i,c){var u={value:c},d={value:function(){--l===0&&i()}};n.each(function(){var p=Rr(this,s),h=p.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(d)),p.on=t}),l===0&&i()})}var vE=0;function Xr(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function Gv(){return++vE}var Jr=lc.prototype;Xr.prototype={constructor:Xr,select:JS,selectAll:ZS,selectChild:Jr.selectChild,selectChildren:Jr.selectChildren,filter:VS,merge:WS,selection:tE,transition:gE,call:Jr.call,nodes:Jr.nodes,node:Jr.node,size:Jr.size,empty:Jr.empty,each:Jr.each,on:GS,attr:MS,attrTween:$S,style:oE,styleTween:cE,text:mE,textTween:pE,remove:XS,tween:wS,delay:DS,duration:IS,ease:US,easeVarying:HS,end:_E,[Symbol.iterator]:Jr[Symbol.iterator]};function yE(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var bE={time:null,delay:0,duration:250,ease:yE};function xE(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function wE(e){var t,n;e instanceof Xr?(t=e._id,e=e._name):(t=Gv(),(n=bE).time=Zf(),e=e==null?null:e+"");for(var s=this._groups,l=s.length,i=0;i<l;++i)for(var c=s[i],u=c.length,d,p=0;p<u;++p)(d=c[p])&&Hd(d,e,t,p,c,n||xE(d,t));return new Xr(s,this._parents,e,t)}lc.prototype.interrupt=yS,lc.prototype.transition=wE;const Wd=e=>()=>e;function jE(e,{sourceEvent:t,target:n,transform:s,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:l}})}function Zr(e,t,n){this.k=e,this.x=t,this.y=n}Zr.prototype={constructor:Zr,scale:function(e){return e===1?this:new Zr(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Zr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var To=new Zr(1,0,0);Zr.prototype;function ap(e){e.stopImmediatePropagation()}function _c(e){e.preventDefault(),e.stopImmediatePropagation()}function NE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function CE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Qv(){return this.__zoom||To}function SE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function EE(){return navigator.maxTouchPoints||"ontouchstart"in this}function kE(e,t,n){var s=e.invertX(t[0][0])-n[0][0],l=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],c=e.invertY(t[1][1])-n[1][1];return e.translate(l>s?(s+l)/2:Math.min(0,s)||Math.max(0,l),c>i?(i+c)/2:Math.min(0,i)||Math.max(0,c))}function ME(){var e=NE,t=CE,n=kE,s=SE,l=EE,i=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=dS,p=kd("start","zoom","end"),h,f,g,w=500,_=150,b=0,x=10;function N(D){D.property("__zoom",Qv).on("wheel.zoom",A,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",T).filter(l).on("touchstart.zoom",P).on("touchmove.zoom",z).on("touchend.zoom touchcancel.zoom",W).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.transform=function(D,R,U,V){var B=D.selection?D.selection():D;B.property("__zoom",Qv),D!==B?C(D,R,U,V):B.interrupt().each(function(){S(this,arguments).event(V).start().zoom(null,typeof R=="function"?R.apply(this,arguments):R).end()})},N.scaleBy=function(D,R,U,V){N.scaleTo(D,function(){var B=this.__zoom.k,G=typeof R=="function"?R.apply(this,arguments):R;return B*G},U,V)},N.scaleTo=function(D,R,U,V){N.transform(D,function(){var B=t.apply(this,arguments),G=this.__zoom,q=U==null?j(B):typeof U=="function"?U.apply(this,arguments):U,F=G.invert(q),K=typeof R=="function"?R.apply(this,arguments):R;return n(M(E(G,K),q,F),B,c)},U,V)},N.translateBy=function(D,R,U,V){N.transform(D,function(){return n(this.__zoom.translate(typeof R=="function"?R.apply(this,arguments):R,typeof U=="function"?U.apply(this,arguments):U),t.apply(this,arguments),c)},null,V)},N.translateTo=function(D,R,U,V,B){N.transform(D,function(){var G=t.apply(this,arguments),q=this.__zoom,F=V==null?j(G):typeof V=="function"?V.apply(this,arguments):V;return n(To.translate(F[0],F[1]).scale(q.k).translate(typeof R=="function"?-R.apply(this,arguments):-R,typeof U=="function"?-U.apply(this,arguments):-U),G,c)},V,B)};function E(D,R){return R=Math.max(i[0],Math.min(i[1],R)),R===D.k?D:new Zr(R,D.x,D.y)}function M(D,R,U){var V=R[0]-U[0]*D.k,B=R[1]-U[1]*D.k;return V===D.x&&B===D.y?D:new Zr(D.k,V,B)}function j(D){return[(+D[0][0]+ +D[1][0])/2,(+D[0][1]+ +D[1][1])/2]}function C(D,R,U,V){D.on("start.zoom",function(){S(this,arguments).event(V).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(V).end()}).tween("zoom",function(){var B=this,G=arguments,q=S(B,G).event(V),F=t.apply(B,G),K=U==null?j(F):typeof U=="function"?U.apply(B,G):U,se=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),Q=B.__zoom,H=typeof R=="function"?R.apply(B,G):R,Y=d(Q.invert(K).concat(se/Q.k),H.invert(K).concat(se/H.k));return function(X){if(X===1)X=H;else{var ee=Y(X),J=se/ee[2];X=new Zr(J,K[0]-ee[0]*J,K[1]-ee[1]*J)}q.zoom(null,X)}})}function S(D,R,U){return!U&&D.__zooming||new $(D,R)}function $(D,R){this.that=D,this.args=R,this.active=0,this.sourceEvent=null,this.extent=t.apply(D,R),this.taps=0}$.prototype={event:function(D){return D&&(this.sourceEvent=D),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(D,R){return this.mouse&&D!=="mouse"&&(this.mouse[1]=R.invert(this.mouse[0])),this.touch0&&D!=="touch"&&(this.touch0[1]=R.invert(this.touch0[0])),this.touch1&&D!=="touch"&&(this.touch1[1]=R.invert(this.touch1[0])),this.that.__zoom=R,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(D){var R=gr(this.that).datum();p.call(D,this.that,new jE(D,{sourceEvent:this.sourceEvent,target:N,transform:this.that.__zoom,dispatch:p}),R)}};function A(D,...R){if(!e.apply(this,arguments))return;var U=S(this,R).event(D),V=this.__zoom,B=Math.max(i[0],Math.min(i[1],V.k*Math.pow(2,s.apply(this,arguments)))),G=zr(D);if(U.wheel)(U.mouse[0][0]!==G[0]||U.mouse[0][1]!==G[1])&&(U.mouse[1]=V.invert(U.mouse[0]=G)),clearTimeout(U.wheel);else{if(V.k===B)return;U.mouse=[G,V.invert(G)],Vd(this),U.start()}_c(D),U.wheel=setTimeout(q,_),U.zoom("mouse",n(M(E(V,B),U.mouse[0],U.mouse[1]),U.extent,c));function q(){U.wheel=null,U.end()}}function L(D,...R){if(g||!e.apply(this,arguments))return;var U=D.currentTarget,V=S(this,R,!0).event(D),B=gr(D.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",se,!0),G=zr(D,U),q=D.clientX,F=D.clientY;bv(D.view),ap(D),V.mouse=[G,this.__zoom.invert(G)],Vd(this),V.start();function K(Q){if(_c(Q),!V.moved){var H=Q.clientX-q,Y=Q.clientY-F;V.moved=H*H+Y*Y>b}V.event(Q).zoom("mouse",n(M(V.that.__zoom,V.mouse[0]=zr(Q,U),V.mouse[1]),V.extent,c))}function se(Q){B.on("mousemove.zoom mouseup.zoom",null),xv(Q.view,V.moved),_c(Q),V.event(Q).end()}}function T(D,...R){if(e.apply(this,arguments)){var U=this.__zoom,V=zr(D.changedTouches?D.changedTouches[0]:D,this),B=U.invert(V),G=U.k*(D.shiftKey?.5:2),q=n(M(E(U,G),V,B),t.apply(this,R),c);_c(D),u>0?gr(this).transition().duration(u).call(C,q,V,D):gr(this).call(N.transform,q,V,D)}}function P(D,...R){if(e.apply(this,arguments)){var U=D.touches,V=U.length,B=S(this,R,D.changedTouches.length===V).event(D),G,q,F,K;for(ap(D),q=0;q<V;++q)F=U[q],K=zr(F,this),K=[K,this.__zoom.invert(K),F.identifier],B.touch0?!B.touch1&&B.touch0[2]!==K[2]&&(B.touch1=K,B.taps=0):(B.touch0=K,G=!0,B.taps=1+!!h);h&&(h=clearTimeout(h)),G&&(B.taps<2&&(f=K[0],h=setTimeout(function(){h=null},w)),Vd(this),B.start())}}function z(D,...R){if(this.__zooming){var U=S(this,R).event(D),V=D.changedTouches,B=V.length,G,q,F,K;for(_c(D),G=0;G<B;++G)q=V[G],F=zr(q,this),U.touch0&&U.touch0[2]===q.identifier?U.touch0[0]=F:U.touch1&&U.touch1[2]===q.identifier&&(U.touch1[0]=F);if(q=U.that.__zoom,U.touch1){var se=U.touch0[0],Q=U.touch0[1],H=U.touch1[0],Y=U.touch1[1],X=(X=H[0]-se[0])*X+(X=H[1]-se[1])*X,ee=(ee=Y[0]-Q[0])*ee+(ee=Y[1]-Q[1])*ee;q=E(q,Math.sqrt(X/ee)),F=[(se[0]+H[0])/2,(se[1]+H[1])/2],K=[(Q[0]+Y[0])/2,(Q[1]+Y[1])/2]}else if(U.touch0)F=U.touch0[0],K=U.touch0[1];else return;U.zoom("touch",n(M(q,F,K),U.extent,c))}}function W(D,...R){if(this.__zooming){var U=S(this,R).event(D),V=D.changedTouches,B=V.length,G,q;for(ap(D),g&&clearTimeout(g),g=setTimeout(function(){g=null},w),G=0;G<B;++G)q=V[G],U.touch0&&U.touch0[2]===q.identifier?delete U.touch0:U.touch1&&U.touch1[2]===q.identifier&&delete U.touch1;if(U.touch1&&!U.touch0&&(U.touch0=U.touch1,delete U.touch1),U.touch0)U.touch0[1]=this.__zoom.invert(U.touch0[0]);else if(U.end(),U.taps===2&&(q=zr(q,this),Math.hypot(f[0]-q[0],f[1]-q[1])<x)){var F=gr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return N.wheelDelta=function(D){return arguments.length?(s=typeof D=="function"?D:Wd(+D),N):s},N.filter=function(D){return arguments.length?(e=typeof D=="function"?D:Wd(!!D),N):e},N.touchable=function(D){return arguments.length?(l=typeof D=="function"?D:Wd(!!D),N):l},N.extent=function(D){return arguments.length?(t=typeof D=="function"?D:Wd([[+D[0][0],+D[0][1]],[+D[1][0],+D[1][1]]]),N):t},N.scaleExtent=function(D){return arguments.length?(i[0]=+D[0],i[1]=+D[1],N):[i[0],i[1]]},N.translateExtent=function(D){return arguments.length?(c[0][0]=+D[0][0],c[1][0]=+D[1][0],c[0][1]=+D[0][1],c[1][1]=+D[1][1],N):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},N.constrain=function(D){return arguments.length?(n=D,N):n},N.duration=function(D){return arguments.length?(u=+D,N):u},N.interpolate=function(D){return arguments.length?(d=D,N):d},N.on=function(){var D=p.on.apply(p,arguments);return D===p?N:D},N.clickDistance=function(D){return arguments.length?(b=(D=+D)*D,N):Math.sqrt(b)},N.tapDistance=function(D){return arguments.length?(x=+D,N):x},N}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function op(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function Xv(e,t){if(e){if(typeof e=="string")return op(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return op(e,t)}}function AE(e){if(Array.isArray(e))return e}function OE(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s=[],l=!0,i=!1,c,u;try{for(n=n.call(e);!(l=(c=n.next()).done)&&(s.push(c.value),!(t&&s.length===t));l=!0);}catch(d){i=!0,u=d}finally{try{!l&&n.return!=null&&n.return()}finally{if(i)throw u}}return s}}function PE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bt(e,t){return AE(e)||OE(e,t)||Xv(e,t)||PE()}var $o;(function(e){e.Strict="strict",e.Loose="loose"})($o||($o={}));var ql;(function(e){e.Lines="lines",e.Dots="dots"})(ql||(ql={}));var Hl;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Hl||(Hl={}));var Ma;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Ma||(Ma={}));var Kd;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(Kd||(Kd={}));var Ae;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Ae||(Ae={}));var lp=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},Vl=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),s)},Jv=function(t,n){return{x:Vl(t.x,n[0][0],n[1][0]),y:Vl(t.y,n[0][1],n[1][1])}},Zv=function(t){var n,s;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((s=window)===null||s===void 0?void 0:s.document)},TE=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},Yd=function(t){var n=t.x,s=t.y,l=t.width,i=t.height;return{x:n,y:s,x2:n+l,y2:s+i}},$E=function(t){var n=t.x,s=t.y,l=t.x2,i=t.y2;return{x:n,y:s,width:l-n,height:i-s}},ey=function(t){return!isNaN(t)&&isFinite(t)},Yn=Symbol("internals");function ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function vc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ty(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ty(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ny(e,t){var n=e.find(function(p){return p.id===t.parentNode});if(n){var s=t.position.x+t.width-n.width,l=t.position.y+t.height-n.height;if(s>0||l>0||t.position.x<0||t.position.y<0){var i,c;if(n.style=vc({},n.style)||{},n.style.width=(i=n.style.width)!==null&&i!==void 0?i:n.width,n.style.height=(c=n.style.height)!==null&&c!==void 0?c:n.height,s>0&&(n.style.width+=s),l>0&&(n.style.height+=l),t.position.x<0){var u=Math.abs(t.position.x);n.position.x=n.position.x-u,n.style.width+=u,t.position.x=0}if(t.position.y<0){var d=Math.abs(t.position.y);n.position.y=n.position.y-d,n.style.height+=d,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function sy(e,t){if(e.some(function(s){return s.type==="reset"}))return e.filter(function(s){return s.type==="reset"}).map(function(s){return s.item});var n=e.filter(function(s){return s.type==="add"}).map(function(s){return s.item});return t.reduce(function(s,l){var i=e.find(function(d){return d.id===l.id});if(i)switch(i.type){case"select":return s.push(vc(vc({},l),{},{selected:i.selected})),s;case"position":{var c=vc({},l);return typeof i.position<"u"&&(c.position=i.position),typeof i.positionAbsolute<"u"&&(c.positionAbsolute=i.positionAbsolute),typeof i.dragging<"u"&&(c.dragging=i.dragging),c.expandParent&&ny(s,c),s.push(c),s}case"dimensions":{var u=vc({},l);return typeof i.dimensions<"u"&&(u.width=i.dimensions.width,u.height=i.dimensions.height),u.expandParent&&ny(s,u),s.push(u),s}case"remove":return s}return s.push(l),s},n)}function ry(e,t){return sy(e,t)}function LE(e,t){return sy(e,t)}var Aa=function(t,n){return{id:t,type:"select",selected:n}};function Wl(e,t){return e.reduce(function(n,s){var l=t.includes(s.id);return!s.selected&&l?(s.selected=!0,n.push(Aa(s.id,!0))):s.selected&&!l&&(s.selected=!1,n.push(Aa(s.id,!1))),n},[])}function ay(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function oy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ay(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ay(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var ly=function(t,n,s){var l=n.querySelectorAll(t);if(!l||!l.length)return null;var i=Array.from(l),c=n.getBoundingClientRect();return i.map(function(u){var d=u.getBoundingClientRect();return oy({id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(d.left-c.left)/s,y:(d.top-c.top)/s},lp(u))})};function yc(e,t,n){return n===void 0?n:function(s){var l=t().nodeInternals.get(e);n(s,oy({},l))}}function iy(e){var t=e.id,n=e.store,s=n.getState(),l=s.addSelectedNodes,i=s.unselectNodesAndEdges,c=s.multiSelectionActive,u=s.nodeInternals,d=u.get(t);n.setState({nodesSelectionActive:!1}),d.selected?d.selected&&c&&i({nodes:[d]}):l([t])}function cy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function bc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var zE=function(t){return"id"in t&&"source"in t&&"target"in t},DE=function(t){var n=t.source,s=t.sourceHandle,l=t.target,i=t.targetHandle;return"reactflow__edge-".concat(n).concat(s||"","-").concat(l).concat(i||"")},ip=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var s=n?"".concat(n,"__"):"";return"".concat(s).concat(Object.keys(t).sort().map(function(l){return"".concat(l,"=").concat(t[l])}).join("&"))},RE=function(t,n){return n.some(function(s){return s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)})},uy=function(t,n){if(!t.source||!t.target)return n;var s;return zE(t)?s=bc({},t):s=bc(bc({},t),{},{id:DE(t)}),RE(s,n)?n:n.concat(s)},dy=function(t,n,s,l){var i=t.x,c=t.y,u=bt(n,3),d=u[0],p=u[1],h=u[2],f=bt(l,2),g=f[0],w=f[1],_={x:(i-d)/h,y:(c-p)/h};return s?{x:g*Math.round(_.x/g),y:w*Math.round(_.y/w)}:_},cp=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(s,l){var i=l.positionAbsolute,c=l.position,u=l.width,d=l.height;return TE(s,Yd({x:i?i.x:c.x,y:i?i.y:c.y,width:u||0,height:d||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return $E(n)},my=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],l=bt(s,3),i=l[0],c=l[1],u=l[2],d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,h=Yd({x:(n.x-i)/u,y:(n.y-c)/u,width:n.width/u,height:n.height/u}),f=[];return t.forEach(function(g){var w=g.positionAbsolute,_=g.width,b=g.height,x=g.selectable,N=x===void 0?!0:x;if(p&&!N)return!1;var E=Yd(bc(bc({},w),{},{width:_||0,height:b||0})),M=Math.max(0,Math.min(h.x2,E.x2)-Math.max(h.x,E.x)),j=Math.max(0,Math.min(h.y2,E.y2)-Math.max(h.y,E.y)),C=Math.ceil(M*j),S=typeof _>"u"||typeof b>"u"||_===null||b===null,$=d&&C>0,A=(_||0)*(b||0),L=S||$||C>=A;L&&f.push(g)}),f},hy=function(t,n){var s=t.map(function(l){return l.id});return n.filter(function(l){return s.includes(l.source)||s.includes(l.target)})},fy=function(t,n,s,l,i){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,u=n/(t.width*(1+c)),d=s/(t.height*(1+c)),p=Math.min(u,d),h=Vl(p,l,i),f=t.x+t.width/2,g=t.y+t.height/2,w=n/2-f*h,_=s/2-g*h;return[w,_,h]},Lo=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function py(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Kl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?py(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):py(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function gy(e,t,n,s){var l,i,c,u,d,p,h,f,g,w,_,b;if(!e.parentNode)return s;var x=t.get(e.parentNode);return gy(x,t,n,{x:((l=s.x)!==null&&l!==void 0?l:0)+((i=(c=x.position)===null||c===void 0?void 0:c.x)!==null&&i!==void 0?i:0),y:((u=s.y)!==null&&u!==void 0?u:0)+((d=(p=x.position)===null||p===void 0?void 0:p.y)!==null&&d!==void 0?d:0),z:((h=(f=x[Yn])===null||f===void 0?void 0:f.z)!==null&&h!==void 0?h:0)>((g=s.z)!==null&&g!==void 0?g:0)?(w=(_=x[Yn])===null||_===void 0?void 0:_.z)!==null&&w!==void 0?w:0:(b=s.z)!==null&&b!==void 0?b:0})}function up(e,t){var n=new Map,s={};return e.forEach(function(l){var i,c=ey(l.zIndex)?l.zIndex:l.selected?1e3:0,u=t.get(l.id),d=Kl(Kl({width:u==null?void 0:u.width,height:u==null?void 0:u.height},l),{},{positionAbsolute:{x:l.position.x,y:l.position.y}});l.parentNode&&(d.parentNode=l.parentNode,s[l.parentNode]=!0),Object.defineProperty(d,Yn,{enumerable:!1,value:{handleBounds:u==null||(i=u[Yn])===null||i===void 0?void 0:i.handleBounds,z:c}}),n.set(l.id,d)}),n.forEach(function(l){if(l.parentNode&&!n.has(l.parentNode))throw new Error("Parent node ".concat(l.parentNode," not found"));if(l.parentNode||s[l.id]){var i,c,u=gy(l,n,s,Kl(Kl({},l.position),{},{z:(i=(c=l[Yn])===null||c===void 0?void 0:c.z)!==null&&i!==void 0?i:0})),d=u.x,p=u.y,h=u.z;l.positionAbsolute={x:d,y:p},l[Yn].z=h,s[l.id]&&(l[Yn].isParent=!0)}}),n}function _y(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),s=n.nodeInternals,l=n.width,i=n.height,c=n.minZoom,u=n.maxZoom,d=n.d3Zoom,p=n.d3Selection,h=n.fitViewOnInitDone,f=n.fitViewOnInit;if((t.initial&&!h&&f||!t.initial)&&d&&p){var g=Array.from(s.values()).filter(function(A){return t.includeHiddenNodes?A.width&&A.height:!A.hidden}),w=g.every(function(A){return A.width&&A.height});if(g.length>0&&w){var _,b,x,N=cp(g),E=fy(N,l,i,(_=t.minZoom)!==null&&_!==void 0?_:c,(b=t.maxZoom)!==null&&b!==void 0?b:u,(x=t.padding)!==null&&x!==void 0?x:.1),M=bt(E,3),j=M[0],C=M[1],S=M[2],$=To.translate(j,C).scale(S);return typeof t.duration=="number"&&t.duration>0?d.transform(Lo(p,t.duration),$):d.transform(p,$),!0}}return!1}function FE(e,t){return e.forEach(function(n){var s=t.get(n.id);if(s){var l;t.set(s.id,Kl(Kl({},s),{},(l={},St(l,Yn,s[Yn]),St(l,"selected",n.selected),l)))}}),new Map(t)}function IE(e,t){return t.map(function(n){var s=e.find(function(l){return l.id===n.id});return s&&(n.selected=s.selected),n})}function Gd(e){var t=e.changedNodes,n=e.changedEdges,s=e.get,l=e.set,i=s(),c=i.nodeInternals,u=i.edges,d=i.onNodesChange,p=i.onEdgesChange,h=i.hasDefaultNodes,f=i.hasDefaultEdges;t!=null&&t.length&&(h&&l({nodeInternals:FE(t,c)}),d==null||d(t)),n!=null&&n.length&&(f&&l({edges:IE(n,u)}),p==null||p(n))}var dp=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],vy={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:dp,nodeExtent:dp,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:$o.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function yy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Fr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var mp=Xj(),by=mp.Provider,xn=mp.useStore,as=mp.useStoreApi,xy=function(){return Qj(function(t,n){return Fr(Fr({},vy),{},{setNodes:function(l){t({nodeInternals:up(l,n().nodeInternals)})},setEdges:function(l){var i=n(),c=i.defaultEdgeOptions,u=c===void 0?{}:c;t({edges:l.map(function(d){return Fr(Fr({},u),d)})})},setDefaultNodesAndEdges:function(l,i){var c=typeof l<"u",u=typeof i<"u",d=c?up(l,new Map):new Map,p=u?i:[];t({nodeInternals:d,edges:p,hasDefaultNodes:c,hasDefaultEdges:u})},updateNodeDimensions:function(l){var i=n(),c=i.onNodesChange,u=i.nodeInternals,d=i.fitViewOnInit,p=i.fitViewOnInitDone,h=i.fitViewOnInitOptions,f=i.domNode,g=f==null?void 0:f.querySelector(".react-flow__viewport");if(g){var w=window.getComputedStyle(g),_=new window.DOMMatrixReadOnly(w.transform),b=_.m22,x=l.reduce(function(E,M){var j=u.get(M.id);if(j){var C=lp(M.nodeElement),S=!!(C.width&&C.height&&(j.width!==C.width||j.height!==C.height||M.forceUpdate));S&&(u.set(j.id,Fr(Fr({},j),{},St({},Yn,Fr(Fr({},j[Yn]),{},{handleBounds:{source:ly(".source",M.nodeElement,b),target:ly(".target",M.nodeElement,b)}})),C)),E.push({id:j.id,type:"dimensions",dimensions:C}))}return E},[]),N=p||d&&!p&&_y(n,Fr({initial:!0},h));t({nodeInternals:new Map(u),fitViewOnInitDone:N}),(x==null?void 0:x.length)>0&&(c==null||c(x))}},updateNodePositions:function(l){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=n(),d=u.onNodesChange,p=u.nodeInternals,h=u.hasDefaultNodes;if(h||d){var f=l.map(function(_){var b={id:_.id,type:"position",dragging:c};return i&&(b.positionAbsolute=_.positionAbsolute,b.position=_.position),b});if(f!=null&&f.length){if(h){var g=ry(f,Array.from(p.values())),w=up(g,p);t({nodeInternals:w})}d==null||d(f)}}},addSelectedNodes:function(l){var i=n(),c=i.multiSelectionActive,u=i.nodeInternals,d=i.edges,p,h=null;c?p=l.map(function(f){return Aa(f,!0)}):(p=Wl(Array.from(u.values()),l),h=Wl(d,[])),Gd({changedNodes:p,changedEdges:h,get:n,set:t})},addSelectedEdges:function(l){var i=n(),c=i.multiSelectionActive,u=i.edges,d=i.nodeInternals,p,h=null;c?p=l.map(function(f){return Aa(f,!0)}):(p=Wl(u,l),h=Wl(Array.from(d.values()),[])),Gd({changedNodes:h,changedEdges:p,get:n,set:t})},unselectNodesAndEdges:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=l.nodes,c=l.edges,u=n(),d=u.nodeInternals,p=u.edges,h=i||Array.from(d.values()),f=c||p,g=h.map(function(_){return _.selected=!1,Aa(_.id,!1)}),w=f.map(function(_){return Aa(_.id,!1)});Gd({changedNodes:g,changedEdges:w,get:n,set:t})},setMinZoom:function(l){var i=n(),c=i.d3Zoom,u=i.maxZoom;c==null||c.scaleExtent([l,u]),t({minZoom:l})},setMaxZoom:function(l){var i=n(),c=i.d3Zoom,u=i.minZoom;c==null||c.scaleExtent([u,l]),t({maxZoom:l})},setTranslateExtent:function(l){var i=n(),c=i.d3Zoom;c==null||c.translateExtent(l),t({translateExtent:l})},resetSelectedElements:function(){var l=n(),i=l.nodeInternals,c=l.edges,u=Array.from(i.values()),d=u.filter(function(h){return h.selected}).map(function(h){return Aa(h.id,!1)}),p=c.filter(function(h){return h.selected}).map(function(h){return Aa(h.id,!1)});Gd({changedNodes:d,changedEdges:p,get:n,set:t})},setNodeExtent:function(l){var i=n(),c=i.nodeInternals;c.forEach(function(u){u.positionAbsolute=Jv(u.position,l)}),t({nodeExtent:l,nodeInternals:new Map(c)})},reset:function(){return t(Fr({},vy))}})})};function Ws(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=Ws(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function Ks(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let s=0;s<n.length;s++)if(!Object.prototype.hasOwnProperty.call(t,n[s])||!Object.is(e[n[s]],t[n[s]]))return!1;return!0}function BE(e){if(Array.isArray(e))return op(e)}function UE(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zo(e){return BE(e)||UE(e)||Xv(e)||qE()}var HE={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},VE=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},WE=function(){var t=as(),n=xn(VE,Ks),s=n.d3Zoom,l=n.d3Selection,i=v.useMemo(function(){return l&&s?{zoomIn:function(u){return s.scaleBy(Lo(l,u==null?void 0:u.duration),1.2)},zoomOut:function(u){return s.scaleBy(Lo(l,u==null?void 0:u.duration),1/1.2)},zoomTo:function(u,d){return s.scaleTo(Lo(l,d==null?void 0:d.duration),u)},getZoom:function(){return t.getState().transform[2]},setViewport:function(u,d){var p,h,f,g=bt(t.getState().transform,3),w=g[0],_=g[1],b=g[2],x=To.translate((p=u.x)!==null&&p!==void 0?p:w,(h=u.y)!==null&&h!==void 0?h:_).scale((f=u.zoom)!==null&&f!==void 0?f:b);s.transform(Lo(l,d==null?void 0:d.duration),x)},getViewport:function(){var u=bt(t.getState().transform,3),d=u[0],p=u[1],h=u[2];return{x:d,y:p,zoom:h}},fitView:function(u){return _y(t.getState,u)},setCenter:function(u,d,p){var h=t.getState(),f=h.width,g=h.height,w=h.maxZoom,_=typeof(p==null?void 0:p.zoom)<"u"?p.zoom:w,b=f/2-u*_,x=g/2-d*_,N=To.translate(b,x).scale(_);s.transform(Lo(l,p==null?void 0:p.duration),N)},fitBounds:function(u,d){var p,h=t.getState(),f=h.width,g=h.height,w=h.minZoom,_=h.maxZoom,b=fy(u,f,g,w,_,(p=d==null?void 0:d.padding)!==null&&p!==void 0?p:.1),x=bt(b,3),N=x[0],E=x[1],M=x[2],j=To.translate(N,E).scale(M);s.transform(Lo(l,d==null?void 0:d.duration),j)},project:function(u){var d=t.getState(),p=d.transform,h=d.snapToGrid,f=d.snapGrid;return dy(u,p,h,f)},viewportInitialized:!0}:HE},[s,l]);return i};function wy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Yl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function hp(){var e=WE(),t=as(),n=v.useCallback(function(){var f=t.getState(),g=f.nodeInternals,w=Array.from(g.values());return w.map(function(_){return Yl({},_)})},[]),s=v.useCallback(function(f){var g=t.getState(),w=g.nodeInternals;return w.get(f)},[]),l=v.useCallback(function(){var f=t.getState(),g=f.edges,w=g===void 0?[]:g;return w.map(function(_){return Yl({},_)})},[]),i=v.useCallback(function(f){var g=t.getState(),w=g.edges,_=w===void 0?[]:w;return _.find(function(b){return b.id===f})},[]),c=v.useCallback(function(f){var g=t.getState(),w=g.nodeInternals,_=g.setNodes,b=g.hasDefaultNodes,x=g.onNodesChange,N=Array.from(w.values()),E=typeof f=="function"?f(N):f;if(b)_(E);else if(x){var M=E.length===0?N.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});x(M)}},[]),u=v.useCallback(function(f){var g=t.getState(),w=g.edges,_=w===void 0?[]:w,b=g.setEdges,x=g.hasDefaultEdges,N=g.onEdgesChange,E=typeof f=="function"?f(_):f;if(x)b(E);else if(N){var M=E.length===0?_.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});N(M)}},[]),d=v.useCallback(function(f){var g=Array.isArray(f)?f:[f],w=t.getState(),_=w.nodeInternals,b=w.setNodes,x=w.hasDefaultNodes,N=w.onNodesChange;if(x){var E=Array.from(_.values()),M=[].concat(E,zo(g));b(M)}else if(N){var j=g.map(function(C){return{item:C,type:"add"}});N(j)}},[]),p=v.useCallback(function(f){var g=Array.isArray(f)?f:[f],w=t.getState(),_=w.edges,b=_===void 0?[]:_,x=w.setEdges,N=w.hasDefaultEdges,E=w.onEdgesChange;if(N)x([].concat(zo(b),zo(g)));else if(E){var M=g.map(function(j){return{item:j,type:"add"}});E(M)}},[]),h=v.useCallback(function(){var f=t.getState(),g=f.nodeInternals,w=f.edges,_=w===void 0?[]:w,b=f.transform,x=Array.from(g.values()),N=bt(b,3),E=N[0],M=N[1],j=N[2];return{nodes:x.map(function(C){return Yl({},C)}),edges:_.map(function(C){return Yl({},C)}),viewport:{x:E,y:M,zoom:j}}},[]);return v.useMemo(function(){return Yl(Yl({},e),{},{getNodes:n,getNode:s,getEdges:l,getEdge:i,setNodes:c,setEdges:u,addNodes:d,addEdges:p,toObject:h})},[e,n,s,l,i,c,u,d,p,h])}function KE(e,t){if(e==null)return{};var n={},s=Object.keys(e),l,i;for(i=0;i<s.length;i++)l=s[i],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function Qd(e,t){if(e==null)return{};var n=KE(e,t),s,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(l=0;l<i.length;l++)s=i[l],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function YE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},ge.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function GE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},ge.createElement("path",{d:"M0 0h32v4.2H0z"}))}function QE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},ge.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function XE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ge.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function JE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ge.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var ZE=["children","className"];function jy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function e1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Xd=function(t){var n=t.children,s=t.className,l=Qd(t,ZE);return ge.createElement("button",e1({type:"button",className:Ws(["react-flow__controls-button",s])},l),n)},t1=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},Ny=function(t){var n=t.style,s=t.showZoom,l=s===void 0?!0:s,i=t.showFitView,c=i===void 0?!0:i,u=t.showInteractive,d=u===void 0?!0:u,p=t.fitViewOptions,h=t.onZoomIn,f=t.onZoomOut,g=t.onFitView,w=t.onInteractiveChange,_=t.className,b=t.children,x=as(),N=v.useState(!1),E=bt(N,2),M=E[0],j=E[1],C=xn(t1),S=hp(),$=S.zoomIn,A=S.zoomOut,L=S.fitView;if(v.useEffect(function(){j(!0)},[]),!M)return null;var T=function(){$==null||$(),h==null||h()},P=function(){A==null||A(),f==null||f()},z=function(){L==null||L(p),g==null||g()},W=function(){x.setState({nodesDraggable:!C,nodesConnectable:!C,elementsSelectable:!C}),w==null||w(!C)};return ge.createElement("div",{className:Ws(["react-flow__controls",_]),style:n},l&&ge.createElement(ge.Fragment,null,ge.createElement(Xd,{onClick:T,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},ge.createElement(YE,null)),ge.createElement(Xd,{onClick:P,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},ge.createElement(GE,null))),c&&ge.createElement(Xd,{className:"react-flow__controls-fitview",onClick:z,title:"fit view","aria-label":"fit view"},ge.createElement(QE,null)),d&&ge.createElement(Xd,{className:"react-flow__controls-interactive",onClick:W,title:"toggle interactivity","aria-label":"toggle interactivity"},C?ge.createElement(JE,null):ge.createElement(XE,null)),b)};Ny.displayName="Controls";var n1=v.memo(Ny),s1=function(t,n,s){return ge.createElement("path",{stroke:s,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},r1=function(t,n){return ge.createElement("circle",{cx:t,cy:t,r:t,fill:n})},Jd;function Cy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Sy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var a1=(Jd={},St(Jd,ql.Dots,"#81818a"),St(Jd,ql.Lines,"#eee"),Jd),o1=function(t){return t.transform},Ey=function(t){var n=t.variant,s=n===void 0?ql.Dots:n,l=t.gap,i=l===void 0?15:l,c=t.size,u=c===void 0?.4:c,d=t.color,p=t.style,h=t.className,f=v.useRef(null),g=v.useState(null),w=bt(g,2),_=w[0],b=w[1],x=xn(o1),N=bt(x,3),E=N[0],M=N[1],j=N[2];v.useEffect(function(){var P=document.querySelectorAll(".react-flow__background"),z=Array.from(P).findIndex(function(W){return W===f.current});b("pattern-".concat(z))},[]);var C=i*j||1,S=E%C,$=M%C,A=s===ql.Lines,L=d||a1[s],T=A?s1(C,u,L):r1(u*j,L);return ge.createElement("svg",{className:Ws(["react-flow__background","react-flow__container",h]),style:Sy(Sy({},p),{},{width:"100%",height:"100%"}),ref:f},_&&ge.createElement(ge.Fragment,null,ge.createElement("pattern",{id:_,x:S,y:$,width:C,height:C,patternUnits:"userSpaceOnUse"},T),ge.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(_,")")})))};Ey.displayName="Background";var l1=v.memo(Ey),i1=function(t){return t.updateNodeDimensions};function c1(){var e=as(),t=xn(i1);return v.useCallback(function(n){var s,l=(s=e.getState().domNode)===null||s===void 0?void 0:s.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));l&&requestAnimationFrame(function(){return t([{id:n,nodeElement:l,forceUpdate:!0}])})},[])}var u1=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function d1(e){var t=e.proOptions,n=e.position,s=n===void 0?"bottom-right":n;if(t!=null&&t.account&&u1.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var l="".concat(s).split("-");return ge.createElement("div",{className:Ws(["react-flow__attribution"].concat(zo(l))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},ge.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var m1=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function ky(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function h1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ky(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ky(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var f1=function(t){var n=t.x,s=t.y,l=t.label,i=t.labelStyle,c=i===void 0?{}:i,u=t.labelShowBg,d=u===void 0?!0:u,p=t.labelBgStyle,h=p===void 0?{}:p,f=t.labelBgPadding,g=f===void 0?[2,4]:f,w=t.labelBgBorderRadius,_=w===void 0?2:w,b=t.children,x=t.className,N=Qd(t,m1),E=v.useRef(null),M=v.useState({x:0,y:0,width:0,height:0}),j=bt(M,2),C=j[0],S=j[1],$=Ws(["react-flow__edge-textwrapper",x]);return v.useEffect(function(){if(E.current){var A=E.current.getBBox();S({x:A.x,y:A.y,width:A.width,height:A.height})}},[l]),typeof l>"u"||!l?null:ge.createElement("g",h1({transform:"translate(".concat(n-C.width/2," ").concat(s-C.height/2,")"),className:$},N),d&&ge.createElement("rect",{width:C.width+2*g[0],x:-g[0],y:-g[1],height:C.height+2*g[1],className:"react-flow__edge-textbg",style:h,rx:_,ry:_}),ge.createElement("text",{className:"react-flow__edge-text",y:C.height/2,dy:"0.3em",ref:E,style:c},l),b)},p1=v.memo(f1),Zd=function(e){var t=e.path,n=e.centerX,s=e.centerY,l=e.label,i=e.labelStyle,c=e.labelShowBg,u=e.labelBgStyle,d=e.labelBgPadding,p=e.labelBgBorderRadius,h=e.style,f=e.markerEnd,g=e.markerStart,w=l?ge.createElement(p1,{x:n,y:s,label:l,labelStyle:i,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:p}):null;return ge.createElement(ge.Fragment,null,ge.createElement("path",{style:h,d:t,className:"react-flow__edge-path",markerEnd:f,markerStart:g}),w)};function em(e){var t=e.pos,n=e.x1,s=e.y1,l=e.x2,i=e.y2,c,u;switch(t){case Ae.Left:case Ae.Right:c=.5*(n+l),u=s;break;case Ae.Top:case Ae.Bottom:c=n,u=.5*(s+i);break}return[c,u]}function My(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=em({pos:l,x1:t,y1:n,x2:i,y2:c}),h=bt(p,2),f=h[0],g=h[1],w=em({pos:d,x1:i,y1:c,x2:t,y2:n}),_=bt(w,2),b=_[0],x=_[1];return"M".concat(t,",").concat(n," C").concat(f,",").concat(g," ").concat(b,",").concat(x," ").concat(i,",").concat(c)}function g1(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=em({pos:l,x1:t,y1:n,x2:i,y2:c}),h=bt(p,2),f=h[0],g=h[1],w=em({pos:d,x1:i,y1:c,x2:t,y2:n}),_=bt(w,2),b=_[0],x=_[1],N=t*.125+f*.375+b*.375+i*.125,E=n*.125+g*.375+x*.375+c*.125,M=Math.abs(N-t),j=Math.abs(E-n);return[N,E,M,j]}var Ay=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.sourcePosition,c=i===void 0?Ae.Bottom:i,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,w=e.labelBgPadding,_=e.labelBgBorderRadius,b=e.style,x=e.markerEnd,N=e.markerStart,E={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:l,targetPosition:d},M=My(E),j=g1(E),C=bt(j,2),S=C[0],$=C[1];return ge.createElement(Zd,{path:M,centerX:S,centerY:$,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:_,style:b,markerEnd:x,markerStart:N})});function Oy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function _1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Oy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Py=[Ae.Left,Ae.Right],Ty=function(t){var n=t.sourceX,s=t.sourceY,l=t.targetX,i=t.targetY,c=t.sourcePosition,u=c===void 0?Ae.Bottom:c,d=t.targetPosition,p=d===void 0?Ae.Top:d,h=Py.includes(u),f=Py.includes(p),g=h&&!f||f&&!h;if(g){var w=h?Math.abs(l-n):0,_=n>l?n-w:n+w,b=h?0:Math.abs(i-s),x=s<i?s+b:s-b;return[_,x,w,b]}var N=Math.abs(l-n)/2,E=l<n?l+N:l-N,M=Math.abs(i-s)/2,j=i<s?i+M:i-M;return[E,j,N,M]};function xc(e,t,n){return n===void 0?n:function(s){var l=t().edges.find(function(i){return i.id===e});n(s,_1({},l))}}var fp=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},pp=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},gp=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},_p=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},vp=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)},yp=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},bp=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},xp=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)};function wp(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.borderRadius,h=p===void 0?5:p,f=e.centerX,g=e.centerY,w=Ty({sourceX:t,sourceY:n,targetX:i,targetY:c}),_=bt(w,4),b=_[0],x=_[1],N=_[2],E=_[3],M=Math.min(h,Math.abs(i-t)),j=Math.min(h,Math.abs(c-n)),C=Math.min(M,j,N,E),S=[Ae.Left,Ae.Right],$=typeof f<"u"?f:b,A=typeof g<"u"?g:x,L=null,T=null;return t<=i?(L=n<=c?fp(t,A,C):yp(t,A,C),T=n<=c?xp(i,A,C):_p(i,A,C)):(L=n<c?gp(t,A,C):bp(t,A,C),T=n<c?vp(i,A,C):pp(i,A,C)),S.includes(l)&&S.includes(d)?t<=i?(L=n<=c?xp($,n,C):_p($,n,C),T=n<=c?fp($,c,C):yp($,c,C)):(l===Ae.Right&&d===Ae.Left||l===Ae.Left&&d===Ae.Right||l===Ae.Left&&d===Ae.Left)&&(L=n<=c?vp($,n,C):pp($,n,C),T=n<=c?gp($,c,C):bp($,c,C)):S.includes(l)&&!S.includes(d)?(t<=i?L=n<=c?xp(i,n,C):_p(i,n,C):L=n<=c?vp(i,n,C):pp(i,n,C),T=""):!S.includes(l)&&S.includes(d)&&(t<=i?L=n<=c?fp(t,c,C):yp(t,c,C):L=n<=c?gp(t,c,C):bp(t,c,C),T=""),"M ".concat(t,",").concat(n).concat(L).concat(T,"L ").concat(i,",").concat(c)}var jp=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.sourcePosition,w=g===void 0?Ae.Bottom:g,_=e.targetPosition,b=_===void 0?Ae.Top:_,x=e.markerEnd,N=e.markerStart,E=e.borderRadius,M=E===void 0?5:E,j=Ty({sourceX:t,sourceY:n,targetX:s,targetY:l,sourcePosition:w,targetPosition:b}),C=bt(j,2),S=C[0],$=C[1],A=wp({sourceX:t,sourceY:n,sourcePosition:w,targetX:s,targetY:l,targetPosition:b,borderRadius:M});return ge.createElement(Zd,{path:A,centerX:S,centerY:$,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:x,markerStart:N})});function $y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Ly(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$y(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$y(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var zy=v.memo(function(e){return ge.createElement(jp,Ly(Ly({},e),{},{borderRadius:0}))}),Dy=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.markerEnd,w=e.markerStart,_=Math.abs(l-n)/2,b=l<n?l+_:l-_,x=Math.abs(s-t)/2,N=s<t?s+x:s-x,E="M ".concat(t,",").concat(n,"L ").concat(s,",").concat(l);return ge.createElement(Zd,{path:E,centerX:N,centerY:b,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:w})});function tm(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function nm(e){var t=e.pos,n=e.x1,s=e.y1,l=e.x2,i=e.y2,c=e.c,u,d;switch(t){case Ae.Left:u=n-tm(n-l,c),d=s;break;case Ae.Right:u=n+tm(l-n,c),d=s;break;case Ae.Top:u=n,d=s-tm(s-i,c);break;case Ae.Bottom:u=n,d=s+tm(i-s,c);break}return[u,d]}function Ry(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.curvature,h=p===void 0?.25:p,f=nm({pos:l,x1:t,y1:n,x2:i,y2:c,c:h}),g=bt(f,2),w=g[0],_=g[1],b=nm({pos:d,x1:i,y1:c,x2:t,y2:n,c:h}),x=bt(b,2),N=x[0],E=x[1];return"M".concat(t,",").concat(n," C").concat(w,",").concat(_," ").concat(N,",").concat(E," ").concat(i,",").concat(c)}function v1(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,l=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.curvature,h=p===void 0?.25:p,f=nm({pos:l,x1:t,y1:n,x2:i,y2:c,c:h}),g=bt(f,2),w=g[0],_=g[1],b=nm({pos:d,x1:i,y1:c,x2:t,y2:n,c:h}),x=bt(b,2),N=x[0],E=x[1],M=t*.125+w*.375+N*.375+i*.125,j=n*.125+_*.375+E*.375+c*.125,C=Math.abs(M-t),S=Math.abs(j-n);return[M,j,C,S]}var Np=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,l=e.targetY,i=e.sourcePosition,c=i===void 0?Ae.Bottom:i,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,w=e.labelBgPadding,_=e.labelBgBorderRadius,b=e.style,x=e.markerEnd,N=e.markerStart,E=e.curvature,M={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:l,targetPosition:d,curvature:E},j=Ry(M),C=v1(M),S=bt(C,2),$=S[0],A=S[1];return ge.createElement(Zd,{path:j,centerX:$,centerY:A,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:_,style:b,markerEnd:x,markerStart:N})}),Cp=v.createContext(null),y1=Cp.Provider;Cp.Consumer;function Sp(e,t,n,s,l,i,c){var u=c.elementFromPoint(e.clientX,e.clientY),d=(u==null?void 0:u.classList.contains("target"))||!1,p=(u==null?void 0:u.classList.contains("source"))||!1,h={elementBelow:u,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(u&&(d||p)){h.isHoveringHandle=!0;var f=u.getAttribute("data-nodeid"),g=u.getAttribute("data-handleid"),w=n?{source:f,sourceHandle:g,target:s,targetHandle:l}:{source:s,sourceHandle:l,target:f,targetHandle:g};h.connection=w;var _=t===$o.Strict?n&&p||!n&&d:!0;_&&(h.isValid=i(w))}return h}function Ep(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function Fy(e){var t=e.event,n=e.handleId,s=e.nodeId,l=e.onConnect,i=e.isTarget,c=e.getState,u=e.setState,d=e.isValidConnection,p=e.elementEdgeUpdaterType,h=e.onEdgeUpdateEnd,f=t.target.closest(".react-flow"),g=Zv(t.target);if(!g)return;var w=g.elementFromPoint(t.clientX,t.clientY),_=w==null?void 0:w.classList.contains("target"),b=w==null?void 0:w.classList.contains("source");if(!f||!_&&!b&&!p)return;var x=c(),N=x.onConnectStart,E=x.connectionMode,M=p||(_?"target":"source"),j=f.getBoundingClientRect(),C;u({connectionPosition:{x:t.clientX-j.left,y:t.clientY-j.top},connectionNodeId:s,connectionHandleId:n,connectionHandleType:M}),N==null||N(t,{nodeId:s,handleId:n,handleType:M});function S(A){u({connectionPosition:{x:A.clientX-j.left,y:A.clientY-j.top}});var L=Sp(A,E,i,s,n,d,g),T=L.connection,P=L.elementBelow,z=L.isValid,W=L.isHoveringHandle;if(!W)return Ep(C);T.source!==T.target&&P&&(Ep(C),C=P,P.classList.add("react-flow__handle-connecting"),P.classList.toggle("react-flow__handle-valid",z))}function $(A){var L=c(),T=L.onConnectStop,P=L.onConnectEnd,z=Sp(A,E,i,s,n,d,g),W=z.connection,D=z.isValid;T==null||T(A),D&&(l==null||l(W)),P==null||P(A),p&&h&&h(A),Ep(C),u({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),g.removeEventListener("mousemove",S),g.removeEventListener("mouseup",$)}g.addEventListener("mousemove",S),g.addEventListener("mouseup",$)}var b1=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function Iy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function kp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Iy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var x1=function(){return!0},w1=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},By=v.forwardRef(function(e,t){var n=e.type,s=n===void 0?"source":n,l=e.position,i=l===void 0?Ae.Top:l,c=e.isValidConnection,u=c===void 0?x1:c,d=e.isConnectable,p=d===void 0?!0:d,h=e.id,f=e.onConnect,g=e.children,w=e.className,_=e.onMouseDown,b=Qd(e,b1),x=as(),N=v.useContext(Cp),E=xn(w1,Ks),M=E.connectionStartHandle,j=E.connectOnClick,C=h||null,S=s==="target",$=function(P){var z=x.getState(),W=z.defaultEdgeOptions,D=z.onConnect,R=z.hasDefaultEdges,U=kp(kp({},W),P);if(R){var V=x.getState(),B=V.edges;x.setState({edges:uy(U,B)})}D==null||D(U),f==null||f(U)},A=function(P){P.button===0&&Fy({event:P,handleId:C,nodeId:N,onConnect:$,isTarget:S,getState:x.getState,setState:x.setState,isValidConnection:u}),_==null||_(P)},L=function(P){var z=x.getState(),W=z.onClickConnectStart,D=z.onClickConnectStop,R=z.onClickConnectEnd,U=z.connectionMode;if(!M){W==null||W(P,{nodeId:N,handleId:C,handleType:s}),x.setState({connectionStartHandle:{nodeId:N,type:s,handleId:C}});return}var V=Zv(P.target),B=Sp(P,U,M.type==="target",M.nodeId,M.handleId||null,u,V),G=B.connection,q=B.isValid;D==null||D(P),q&&$(G),R==null||R(P),x.setState({connectionStartHandle:null})};return ge.createElement("div",kp({"data-handleid":C,"data-nodeid":N,"data-handlepos":i,className:Ws(["react-flow__handle","react-flow__handle-".concat(i),"nodrag",w,{source:!S,target:S,connectable:p,connecting:(M==null?void 0:M.nodeId)===N&&(M==null?void 0:M.handleId)===C&&(M==null?void 0:M.type)===s}]),onMouseDown:A,onClick:j?L:void 0,ref:t},b),g)});By.displayName="Handle";var wc=v.memo(By),Uy=function(t){var n=t.data,s=t.isConnectable,l=t.targetPosition,i=l===void 0?Ae.Top:l,c=t.sourcePosition,u=c===void 0?Ae.Bottom:c;return ge.createElement(ge.Fragment,null,ge.createElement(wc,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label,ge.createElement(wc,{type:"source",position:u,isConnectable:s}))};Uy.displayName="DefaultNode";var Mp=v.memo(Uy),qy=function(t){var n=t.data,s=t.isConnectable,l=t.sourcePosition,i=l===void 0?Ae.Bottom:l;return ge.createElement(ge.Fragment,null,n==null?void 0:n.label,ge.createElement(wc,{type:"source",position:i,isConnectable:s}))};qy.displayName="InputNode";var Hy=v.memo(qy),Vy=function(t){var n=t.data,s=t.isConnectable,l=t.targetPosition,i=l===void 0?Ae.Top:l;return ge.createElement(ge.Fragment,null,ge.createElement(wc,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label)};Vy.displayName="OutputNode";var Wy=v.memo(Vy),j1=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},N1=function(t,n){var s=t.selectedNodes.map(function(u){return u.id}),l=n.selectedNodes.map(function(u){return u.id}),i=t.selectedEdges.map(function(u){return u.id}),c=n.selectedEdges.map(function(u){return u.id});return Ks(s,l)&&Ks(i,c)};function C1(e){var t=e.onSelectionChange,n=xn(j1,N1),s=n.selectedNodes,l=n.selectedEdges;return v.useEffect(function(){t({nodes:s,edges:l})},[s,l]),null}var S1=v.memo(C1),E1=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function Oa(e,t){v.useEffect(function(){typeof e<"u"&&t(e)},[e])}function Wt(e,t,n){v.useEffect(function(){typeof t<"u"&&n(St({},e,t))},[t])}var k1=function(t){var n=t.nodes,s=t.edges,l=t.defaultNodes,i=t.defaultEdges,c=t.onConnect,u=t.onConnectStart,d=t.onConnectStop,p=t.onConnectEnd,h=t.onClickConnectStart,f=t.onClickConnectStop,g=t.onClickConnectEnd,w=t.nodesDraggable,_=t.nodesConnectable,b=t.minZoom,x=t.maxZoom,N=t.nodeExtent,E=t.onNodesChange,M=t.onEdgesChange,j=t.elementsSelectable,C=t.connectionMode,S=t.snapGrid,$=t.snapToGrid,A=t.translateExtent,L=t.connectOnClick,T=t.defaultEdgeOptions,P=t.fitView,z=t.fitViewOptions,W=t.onNodesDelete,D=t.onEdgesDelete,R=t.onNodeDrag,U=t.onNodeDragStart,V=t.onNodeDragStop,B=t.onSelectionDrag,G=t.onSelectionDragStart,q=t.onSelectionDragStop,F=xn(E1,Ks),K=F.setNodes,se=F.setEdges,Q=F.setDefaultNodesAndEdges,H=F.setMinZoom,Y=F.setMaxZoom,X=F.setTranslateExtent,ee=F.setNodeExtent,J=F.reset,re=as();return v.useEffect(function(){return Q(l,i),function(){J()}},[]),Wt("defaultEdgeOptions",T,re.setState),Wt("connectionMode",C,re.setState),Wt("onConnect",c,re.setState),Wt("onConnectStart",u,re.setState),Wt("onConnectStop",d,re.setState),Wt("onConnectEnd",p,re.setState),Wt("onClickConnectStart",h,re.setState),Wt("onClickConnectStop",f,re.setState),Wt("onClickConnectEnd",g,re.setState),Wt("nodesDraggable",w,re.setState),Wt("nodesConnectable",_,re.setState),Wt("elementsSelectable",j,re.setState),Wt("snapToGrid",$,re.setState),Wt("snapGrid",S,re.setState),Wt("onNodesChange",E,re.setState),Wt("onEdgesChange",M,re.setState),Wt("connectOnClick",L,re.setState),Wt("fitViewOnInit",P,re.setState),Wt("fitViewOnInitOptions",z,re.setState),Wt("onNodesDelete",W,re.setState),Wt("onEdgesDelete",D,re.setState),Wt("onNodeDrag",R,re.setState),Wt("onNodeDragStart",U,re.setState),Wt("onNodeDragStop",V,re.setState),Wt("onSelectionDrag",B,re.setState),Wt("onSelectionDragStart",G,re.setState),Wt("onSelectionDragStop",q,re.setState),Oa(n,K),Oa(s,se),Oa(l,K),Oa(i,se),Oa(b,H),Oa(x,Y),Oa(A,X),Oa(N,ee),null},M1=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",A1=M1,O1=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",P1=O1,T1=function(t,n,s){return s===Ae.Left?t-n:s===Ae.Right?t+n:t},$1=function(t,n,s){return s===Ae.Top?t-n:s===Ae.Bottom?t+n:t},Ky=function(t){var n=t.className,s=t.position,l=t.centerX,i=t.centerY,c=t.radius,u=c===void 0?10:c;return ge.createElement("circle",{className:Ws(["react-flow__edgeupdater",n]),cx:T1(l,u,s),cy:$1(i,u,s),r:u,stroke:"transparent",fill:"transparent"})},Gl=function(e){var t=function(s){var l=s.id,i=s.className,c=s.type,u=s.data,d=s.onClick,p=s.onEdgeDoubleClick,h=s.selected,f=s.animated,g=s.label,w=s.labelStyle,_=s.labelShowBg,b=s.labelBgStyle,x=s.labelBgPadding,N=s.labelBgBorderRadius,E=s.style,M=s.source,j=s.target,C=s.sourceX,S=s.sourceY,$=s.targetX,A=s.targetY,L=s.sourcePosition,T=s.targetPosition,P=s.elementsSelectable,z=s.hidden,W=s.sourceHandleId,D=s.targetHandleId,R=s.onContextMenu,U=s.onMouseEnter,V=s.onMouseMove,B=s.onMouseLeave,G=s.edgeUpdaterRadius,q=s.onEdgeUpdate,F=s.onEdgeUpdateStart,K=s.onEdgeUpdateEnd,se=s.markerEnd,Q=s.markerStart,H=s.rfId,Y=v.useState(!1),X=bt(Y,2),ee=X[0],J=X[1],re=as(),we=function(Ze){var ot=re.getState(),Et=ot.edges,zt=ot.addSelectedEdges,We=Et.find(function(Dt){return Dt.id===l});P&&(re.setState({nodesSelectionActive:!1}),zt([l])),d==null||d(Ze,We)},Pe=xc(l,re.getState,p),Me=xc(l,re.getState,R),Fe=xc(l,re.getState,U),Ke=xc(l,re.getState,V),Ue=xc(l,re.getState,B),de=function(Ze,ot){var Et=ot?j:M,zt=(ot?D:W)||null,We=ot?"target":"source",Dt=function(){return!0},ht=ot,kt=re.getState().edges.find(function(Mt){return Mt.id===l});F==null||F(Ze,kt,We);var sn=K?function(Mt){return K(Mt,kt,We)}:void 0,wn=function(rn){return q==null?void 0:q(kt,rn)};Fy({event:Ze,handleId:zt,nodeId:Et,onConnect:wn,isTarget:ht,getState:re.getState,setState:re.setState,isValidConnection:Dt,elementEdgeUpdaterType:We,onEdgeUpdateEnd:sn})},pe=function(Ze){return de(Ze,!0)},xe=function(Ze){return de(Ze,!1)},ke=function(){return J(!0)},De=function(){return J(!1)},ce=v.useMemo(function(){return"url(#".concat(ip(Q,H),")")},[Q,H]),Oe=v.useMemo(function(){return"url(#".concat(ip(se,H),")")},[se,H]);if(z)return null;var Ye=!P&&!d,ct=typeof q<"u",Je=Ws(["react-flow__edge","react-flow__edge-".concat(c),i,{selected:h,animated:f,inactive:Ye,updating:ee}]);return ge.createElement("g",{className:Je,onClick:we,onDoubleClick:Pe,onContextMenu:Me,onMouseEnter:Fe,onMouseMove:Ke,onMouseLeave:Ue},ge.createElement(e,{id:l,source:M,target:j,selected:h,animated:f,label:g,labelStyle:w,labelShowBg:_,labelBgStyle:b,labelBgPadding:x,labelBgBorderRadius:N,data:u,style:E,sourceX:C,sourceY:S,targetX:$,targetY:A,sourcePosition:L,targetPosition:T,sourceHandleId:W,targetHandleId:D,markerStart:ce,markerEnd:Oe,"data-testid":"rf__edge-".concat(l)}),ct&&ge.createElement("g",{onMouseDown:pe,onMouseEnter:ke,onMouseOut:De},ge.createElement(Ky,{position:L,centerX:C,centerY:S,radius:G})),ct&&ge.createElement("g",{onMouseDown:xe,onMouseEnter:ke,onMouseOut:De},ge.createElement(Ky,{position:T,centerX:$,centerY:A,radius:G})))};return t.displayName="EdgeWrapper",v.memo(t)};function Yy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Gy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Yy(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yy(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function L1(e){var t={default:Gl(e.default||Np),straight:Gl(e.bezier||Dy),step:Gl(e.step||zy),smoothstep:Gl(e.step||jp),simplebezier:Gl(e.simplebezier||Ay)},n={},s=Object.keys(e).filter(function(l){return!["default","bezier"].includes(l)}).reduce(function(l,i){return l[i]=Gl(e[i]||Np),l},n);return Gy(Gy({},t),s)}function Qy(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=((n==null?void 0:n.x)||0)+t.x,l=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,c=(n==null?void 0:n.height)||t.height;switch(e){case Ae.Top:return{x:s+i/2,y:l};case Ae.Right:return{x:s+i,y:l+c/2};case Ae.Bottom:return{x:s+i/2,y:l+c};case Ae.Left:return{x:s,y:l+c/2}}}function Xy(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(s){return s.id===t})),typeof n>"u"?null:n}var z1=function(t,n,s,l,i,c){var u=Qy(s,t,n),d=Qy(c,l,i);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y}};function D1(e){var t=e.sourcePos,n=e.targetPos,s=e.sourceWidth,l=e.sourceHeight,i=e.targetWidth,c=e.targetHeight,u=e.width,d=e.height,p=e.transform,h={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+s,n.x+i),y2:Math.max(t.y+l,n.y+c)};h.x===h.x2&&(h.x2+=1),h.y===h.y2&&(h.y2+=1);var f=Yd({x:(0-p[0])/p[2],y:(0-p[1])/p[2],width:u/p[2],height:d/p[2]}),g=Math.max(0,Math.min(f.x2,h.x2)-Math.max(f.x,h.x)),w=Math.max(0,Math.min(f.y2,h.y2)-Math.max(f.y,h.y)),_=Math.ceil(g*w);return _>0}function Jy(e,t){var n,s,l,i,c,u=e.get(t),d=(u==null||(n=u[Yn])===null||n===void 0?void 0:n.handleBounds)||null,p=!u||!d||!u.width||!u.height||typeof((s=u.positionAbsolute)===null||s===void 0?void 0:s.x)>"u"||typeof((l=u.positionAbsolute)===null||l===void 0?void 0:l.y)>"u";return[{x:(u==null||(i=u.positionAbsolute)===null||i===void 0?void 0:i.x)||0,y:(u==null||(c=u.positionAbsolute)===null||c===void 0?void 0:c.y)||0,width:(u==null?void 0:u.width)||0,height:(u==null?void 0:u.height)||0},d,!p]}var R1=typeof document<"u"?document:null,sm=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:R1},n=v.useState(!1),s=bt(n,2),l=s[0],i=s[1],c=v.useRef(new Set([])),u=v.useMemo(function(){if(e!==null){var f=Array.isArray(e)?e:[e],g=f.filter(function(_){return typeof _=="string"}).map(function(_){return _.split("+")}),w=g.reduce(function(_,b){return _.concat.apply(_,zo(b))},[]);return[g,w]}return[[],[]]},[e]),d=bt(u,2),p=d[0],h=d[1];return v.useEffect(function(){if(e!==null){var f,g,w=function(N){if(tb(N))return!1;var E=eb(N.code,h);c.current.add(N[E]),Zy(p,c.current,!1)&&(N.preventDefault(),i(!0))},_=function(N){if(tb(N))return!1;var E=eb(N.code,h);Zy(p,c.current,!0)?(i(!1),c.current.clear()):c.current.delete(N[E])},b=function(){c.current.clear(),i(!1)};return t==null||(f=t.target)===null||f===void 0||f.addEventListener("keydown",w),t==null||(g=t.target)===null||g===void 0||g.addEventListener("keyup",_),window.addEventListener("blur",b),function(){var x,N;t==null||(x=t.target)===null||x===void 0||x.removeEventListener("keydown",w),t==null||(N=t.target)===null||N===void 0||N.removeEventListener("keyup",_),window.removeEventListener("blur",b)}}},[e,i]),l};function Zy(e,t,n){return e.filter(function(s){return n||s.length===t.size}).some(function(s){return s.every(function(l){return t.has(l)})})}function eb(e,t){return t.includes(e)?"code":"key"}function tb(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var F1=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},I1=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,s=as(),l=xn(F1,Ks),i=l.onNodesChange,c=l.onEdgesChange,u=sm(t),d=sm(n);v.useEffect(function(){var p=s.getState(),h=p.nodeInternals,f=p.edges,g=p.hasDefaultNodes,w=p.hasDefaultEdges,_=p.onNodesDelete,b=p.onEdgesDelete,x=Array.from(h.values()),N=x.reduce(function(A,L){return(!L.selected&&L.parentNode&&A.find(function(T){return T.id===L.parentNode})||L.selected)&&A.push(L),A},[]),E=f.filter(function(A){return A.selected});if(u&&(N||E)){var M=hy(N,f),j=[].concat(zo(E),zo(M)),C=j.reduce(function(A,L){return A.includes(L.id)||A.push(L.id),A},[]);if((w||g)&&(w&&s.setState({edges:f.filter(function(A){return!C.includes(A.id)})}),g&&(N.forEach(function(A){h.delete(A.id)}),s.setState({nodeInternals:new Map(h)}))),C.length>0&&(b==null||b(j),c)){var S=C.map(function(A){return{id:A,type:"remove"}});c(S)}if(N.length>0&&(_==null||_(N),i)){var $=N.map(function(A){return{id:A.id,type:"remove"}});i($)}s.setState({nodesSelectionActive:!1})}},[u,i,c]),v.useEffect(function(){s.setState({multiSelectionActive:d})},[d])};function B1(e){var t=as();v.useEffect(function(){var n,s=function(){if(e.current){var i=lp(e.current);t.setState({width:i.width||500,height:i.height||500})}};return s(),window.onresize=s,e.current&&(n=new ResizeObserver(function(){return s()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var U1=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},Ap=function(t){return{x:t.x,y:t.y,zoom:t.k}},rm=function(t,n){return t.target.closest(".".concat(n))},q1=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},H1=function(t){var n=t.onMove,s=t.onMoveStart,l=t.onMoveEnd,i=t.zoomOnScroll,c=i===void 0?!0:i,u=t.zoomOnPinch,d=u===void 0?!0:u,p=t.panOnScroll,h=p===void 0?!1:p,f=t.panOnScrollSpeed,g=f===void 0?.5:f,w=t.panOnScrollMode,_=w===void 0?Hl.Free:w,b=t.zoomOnDoubleClick,x=b===void 0?!0:b,N=t.selectionKeyPressed,E=t.elementsSelectable,M=t.panOnDrag,j=M===void 0?!0:M,C=t.translateExtent,S=t.minZoom,$=t.maxZoom,A=t.defaultZoom,L=A===void 0?1:A,T=t.defaultPosition,P=T===void 0?[0,0]:T,z=t.zoomActivationKeyCode,W=t.preventScrolling,D=W===void 0?!0:W,R=t.children,U=t.noWheelClassName,V=t.noPanClassName,B=as(),G=v.useRef(!1),q=v.useRef(null),F=v.useRef({x:0,y:0,zoom:0}),K=xn(q1,Ks),se=K.d3Zoom,Q=K.d3Selection,H=K.d3ZoomHandler,Y=sm(z);return B1(q),v.useEffect(function(){if(q.current){var X,ee=ME().scaleExtent([S,$]).translateExtent(C),J=gr(q.current).call(ee),re=Vl(P[0],C[0][0],C[1][0]),we=Vl(P[1],C[0][1],C[1][1]),Pe=Vl(L,S,$),Me=To.translate(re,we).scale(Pe);ee.transform(J,Me),B.setState({d3Zoom:ee,d3Selection:J,d3ZoomHandler:J.on("wheel.zoom"),transform:[re,we,Pe],domNode:(X=J.node())===null||X===void 0?void 0:X.closest(".react-flow")})}},[]),v.useEffect(function(){Q&&se&&(h&&!Y?Q.on("wheel",function(X){if(rm(X,U))return!1;X.preventDefault(),X.stopImmediatePropagation();var ee=Q.property("__zoom").k||1;if(X.ctrlKey&&d){var J=zr(X),re=-X.deltaY*(X.deltaMode===1?.05:X.deltaMode?1:.002)*10,we=ee*Math.pow(2,re);se.scaleTo(Q,we,J);return}var Pe=X.deltaMode===1?20:1,Me=_===Hl.Vertical?0:X.deltaX*Pe,Fe=_===Hl.Horizontal?0:X.deltaY*Pe;se.translateBy(Q,-(Me/ee)*g,-(Fe/ee)*g)}).on("wheel.zoom",null):typeof H<"u"&&Q.on("wheel",function(X){if(!D||rm(X,U))return null;X.preventDefault()}).on("wheel.zoom",H))},[h,_,Q,se,H,Y,d,D,U]),v.useEffect(function(){se&&(N&&!G.current?se.on("zoom",null):N||se.on("zoom",function(X){if(B.setState({transform:[X.transform.x,X.transform.y,X.transform.k]}),n){var ee=Ap(X.transform);n(X.sourceEvent,ee)}}))},[N,se,n]),v.useEffect(function(){se&&se.on("start",function(X){if(G.current=!0,s){var ee=Ap(X.transform);F.current=ee,s(X.sourceEvent,ee)}})},[se,s]),v.useEffect(function(){se&&se.on("end",function(X){if(G.current=!1,l&&U1(F.current,X.transform)){var ee=Ap(X.transform);F.current=ee,l(X.sourceEvent,ee)}})},[se,l]),v.useEffect(function(){se&&se.filter(function(X){var ee=Y||c,J=d&&X.ctrlKey;return!j&&!ee&&!h&&!x&&!d||N||!x&&X.type==="dblclick"||rm(X,U)&&X.type==="wheel"||rm(X,V)&&X.type!=="wheel"||!d&&X.ctrlKey&&X.type==="wheel"||!ee&&!h&&!J&&X.type==="wheel"||!j&&(X.type==="mousedown"||X.type==="touchstart")?!1:(!X.ctrlKey||X.type==="wheel")&&!X.button})},[se,c,d,h,x,j,N,E,Y]),ge.createElement("div",{className:"react-flow__renderer react-flow__container",ref:q},R)};function nb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function sb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nb(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function rb(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var V1=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},ab={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},W1=v.memo(function(e){var t=e.selectionKeyPressed,n=as(),s=v.useRef(0),l=v.useRef(0),i=v.useRef(),c=v.useState(ab),u=bt(c,2),d=u[0],p=u[1],h=xn(V1,Ks),f=h.userSelectionActive,g=h.elementsSelectable,w=f||t;if(!g||!w)return null;var _=function(){p(ab),n.setState({userSelectionActive:!1}),s.current=0,l.current=0},b=function(j){var C=j.target.closest(".react-flow");i.current=C.getBoundingClientRect();var S=rb(j,i.current);p({width:0,height:0,startX:S.x,startY:S.y,x:S.x,y:S.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},x=function(j){var C,S;if(!(!t||!d.draw||!i.current)){var $=rb(j,i.current),A=(C=d.startX)!==null&&C!==void 0?C:0,L=(S=d.startY)!==null&&S!==void 0?S:0,T=sb(sb({},d),{},{x:$.x<A?$.x:A,y:$.y<L?$.y:L,width:Math.abs($.x-A),height:Math.abs($.y-L)}),P=n.getState(),z=P.nodeInternals,W=P.edges,D=P.transform,R=P.onNodesChange,U=P.onEdgesChange,V=Array.from(z.values()),B=my(z,T,D,!1,!0),G=hy(B,W).map(function(se){return se.id}),q=B.map(function(se){return se.id});if(s.current!==q.length){s.current=q.length;var F=Wl(V,q);F.length&&(R==null||R(F))}if(l.current!==G.length){l.current=G.length;var K=Wl(W,G);K.length&&(U==null||U(K))}p(T)}},N=function(){n.setState({nodesSelectionActive:s.current>0}),_()},E=function(){n.setState({nodesSelectionActive:!1}),_()};return ge.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:b,onMouseMove:x,onMouseUp:N,onMouseLeave:E},d.draw&&ge.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:d.width,height:d.height,transform:"translate(".concat(d.x,"px, ").concat(d.y,"px)")}}))});function ob(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function lb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ob(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ob(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function ib(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:ib(n,t):!1}function cb(e,t,n){var s=e;do{var l;if((l=s)!==null&&l!==void 0&&l.matches(t))return!0;if(s===n.current)return!1;s=s.parentElement}while(s);return!1}function K1(e,t,n){return Array.from(e.values()).filter(function(s){return(s.selected||s.id===n)&&(!s.parentNode||!ib(s,e))}).map(function(s){var l,i,c,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:t.x-((l=(i=s.positionAbsolute)===null||i===void 0?void 0:i.x)!==null&&l!==void 0?l:0),y:t.y-((c=(u=s.positionAbsolute)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function Y1(e,t,n,s,l,i){var c=bt(s,2),u=c[0],d=c[1],p=e.extent||i,h={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(h.x=u*Math.round(h.x/u),h.y=d*Math.round(h.y/d)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var f=l.get(e.parentNode);p=f!=null&&f.positionAbsolute&&f!==null&&f!==void 0&&f.width&&f!==null&&f!==void 0&&f.height?[[f.positionAbsolute.x,f.positionAbsolute.y],[f.positionAbsolute.x+f.width-e.width,f.positionAbsolute.y+f.height-e.height]]:p}else p=i;else if(e.extent&&e.parentNode){var g,w,_,b,x=l.get(e.parentNode),N=(g=x==null||(w=x.positionAbsolute)===null||w===void 0?void 0:w.x)!==null&&g!==void 0?g:0,E=(_=x==null||(b=x.positionAbsolute)===null||b===void 0?void 0:b.y)!==null&&_!==void 0?_:0;p=[[e.extent[0][0]+N,e.extent[0][1]+E],[e.extent[1][0]+N,e.extent[1][1]+E]]}var M={x:0,y:0};if(e.parentNode){var j,C,S,$,A=l.get(e.parentNode);M={x:(j=A==null||(C=A.positionAbsolute)===null||C===void 0?void 0:C.x)!==null&&j!==void 0?j:0,y:(S=A==null||($=A.positionAbsolute)===null||$===void 0?void 0:$.y)!==null&&S!==void 0?S:0}}return e.positionAbsolute=p?Jv(h,p):h,e.position={x:e.positionAbsolute.x-M.x,y:e.positionAbsolute.y-M.y},e}function Op(e){var t=e.nodeId,n=e.dragItems,s=e.nodeInternals,l=n.map(function(i){var c=s.get(i.id);return lb(lb({},c),{},{position:i.position,positionAbsolute:i.positionAbsolute})});return[t?l.find(function(i){return i.id===t}):l[0],l]}function Pp(e){return function(t,n,s){return e==null?void 0:e(t,s)}}function ub(e){var t=e.nodeRef,n=e.disabled,s=n===void 0?!1:n,l=e.noDragClassName,i=e.handleSelector,c=e.nodeId,u=e.isSelectable,d=e.selectNodesOnDrag,p=v.useState(!1),h=bt(p,2),f=h[0],g=h[1],w=as(),_=v.useRef(),b=v.useRef({x:null,y:null}),x=v.useCallback(function(N){var E=N.sourceEvent,M=w.getState(),j=M.transform,C=M.snapGrid,S=M.snapToGrid,$=E.touches?E.touches[0].clientX:E.clientX,A=E.touches?E.touches[0].clientY:E.clientY,L=dy({x:$,y:A},j,S,C);return L},[]);return v.useEffect(function(){if(t!=null&&t.current){var N=gr(t.current);if(s)N.on(".drag",null);else{var E=FC().on("start",function(M){var j=w.getState(),C=j.nodeInternals,S=j.multiSelectionActive,$=j.unselectNodesAndEdges,A=j.onNodeDragStart,L=j.onSelectionDragStart,T=c?A:Pp(L);if(!d&&!S&&c){var P;(P=C.get(c))!==null&&P!==void 0&&P.selected||$()}c&&u&&d&&iy({id:c,store:w});var z=x(M);if(b.current=z,_.current=K1(C,z,c),T&&_.current){var W=Op({nodeId:c,dragItems:_.current,nodeInternals:C}),D=bt(W,2),R=D[0],U=D[1];T(M.sourceEvent,R,U)}}).on("drag",function(M){var j=w.getState(),C=j.updateNodePositions,S=j.snapToGrid,$=j.snapGrid,A=j.nodeInternals,L=j.nodeExtent,T=j.onNodeDrag,P=j.onSelectionDrag,z=x(M);if((b.current.x!==z.x||b.current.y!==z.y)&&_.current){b.current=z,_.current=_.current.map(function(B){return Y1(B,z,S,$,A,L)});var W=c?T:Pp(P);if(C(_.current,!0,!0),g(!0),W){var D=Op({nodeId:c,dragItems:_.current,nodeInternals:A}),R=bt(D,2),U=R[0],V=R[1];W(M.sourceEvent,U,V)}}M.on("end",function(B){if(g(!1),_.current){var G=w.getState(),q=G.updateNodePositions,F=G.nodeInternals,K=G.onNodeDragStop,se=G.onSelectionDragStop,Q=c?K:Pp(se);if(q(_.current,!1,!1),Q){var H=Op({nodeId:c,dragItems:_.current,nodeInternals:F}),Y=bt(H,2),X=Y[0],ee=Y[1];Q(B.sourceEvent,X,ee)}}})}).filter(function(M){var j=M.target,C=!M.button&&(!l||!cb(j,".".concat(l),t))&&(!i||cb(j,i,t));return C});return N.call(E),function(){N.on(".drag",null)}}}},[t,s,l,i,u,w,c,d,x]),f}function db(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function G1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?db(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):db(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Q1=function(t){return G1({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},cp(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},X1=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(s){return s.selected});return cp(n)};function J1(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,s=as(),l=xn(Q1,Ks),i=l.transformString,c=l.userSelectionActive,u=xn(X1,Ks),d=u.width,p=u.height,h=u.x,f=u.y,g=v.useRef(null);if(ub({nodeRef:g}),c||!d||!p)return null;var w=t?function(_){var b=Array.from(s.getState().nodeInternals.values()).filter(function(x){return x.selected});t(_,b)}:void 0;return ge.createElement("div",{className:Ws(["react-flow__nodesselection","react-flow__container",n]),style:{transform:i}},ge.createElement("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:w,style:{width:d,height:p,top:f,left:h}}))}var Z1=v.memo(J1),ek=function(t){return t.nodesSelectionActive},mb=function(t){var n=t.children,s=t.onPaneClick,l=t.onPaneContextMenu,i=t.onPaneScroll,c=t.deleteKeyCode,u=t.onMove,d=t.onMoveStart,p=t.onMoveEnd,h=t.selectionKeyCode,f=t.multiSelectionKeyCode,g=t.zoomActivationKeyCode,w=t.elementsSelectable,_=t.zoomOnScroll,b=t.zoomOnPinch,x=t.panOnScroll,N=t.panOnScrollSpeed,E=t.panOnScrollMode,M=t.zoomOnDoubleClick,j=t.panOnDrag,C=t.translateExtent,S=t.minZoom,$=t.maxZoom,A=t.defaultZoom,L=t.defaultPosition,T=t.preventScrolling,P=t.onSelectionContextMenu,z=t.noWheelClassName,W=t.noPanClassName,D=as(),R=xn(ek),U=sm(h);I1({deleteKeyCode:c,multiSelectionKeyCode:f});var V=function(F){s==null||s(F),D.getState().resetSelectedElements(),D.setState({nodesSelectionActive:!1})},B=l?function(q){return l(q)}:void 0,G=i?function(q){return i(q)}:void 0;return ge.createElement(H1,{onMove:u,onMoveStart:d,onMoveEnd:p,selectionKeyPressed:U,elementsSelectable:w,zoomOnScroll:_,zoomOnPinch:b,panOnScroll:x,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:M,panOnDrag:j,translateExtent:C,minZoom:S,maxZoom:$,defaultZoom:A,defaultPosition:L,zoomActivationKeyCode:g,preventScrolling:T,noWheelClassName:z,noPanClassName:W},n,ge.createElement(W1,{selectionKeyPressed:U}),R&&ge.createElement(Z1,{onSelectionContextMenu:P,noPanClassName:W}),ge.createElement("div",{className:"react-flow__pane react-flow__container",onClick:V,onContextMenu:B,onWheel:G}))};mb.displayName="FlowRenderer";var tk=v.memo(mb);function nk(e){var t=xn(v.useCallback(function(n){return e?my(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var sk=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},hb=function(t){var n=xn(sk,Ks),s=n.nodesDraggable,l=n.nodesConnectable,i=n.elementsSelectable,c=n.updateNodeDimensions,u=nk(t.onlyRenderVisibleElements),d=v.useRef(),p=v.useMemo(function(){if(typeof ResizeObserver>"u")return null;var h=new ResizeObserver(function(f){var g=f.map(function(w){return{id:w.target.getAttribute("data-id"),nodeElement:w.target,forceUpdate:!0}});c(g)});return d.current=h,h},[]);return v.useEffect(function(){return function(){var h;d==null||(h=d.current)===null||h===void 0||h.disconnect()}},[]),ge.createElement("div",{className:"react-flow__nodes react-flow__container"},u.map(function(h){var f,g,w,_,b,x,N,E=h.type||"default";t.nodeTypes[E]||(E="default");var M=t.nodeTypes[E]||t.nodeTypes.default,j=!!(h.draggable||s&&typeof h.draggable>"u"),C=!!(h.selectable||i&&typeof h.selectable>"u"),S=!!(h.connectable||l&&typeof h.connectable>"u");return ge.createElement(M,{key:h.id,id:h.id,className:h.className,style:h.style,type:E,data:h.data,sourcePosition:h.sourcePosition||Ae.Bottom,targetPosition:h.targetPosition||Ae.Top,hidden:h.hidden,xPos:(f=(g=h.positionAbsolute)===null||g===void 0?void 0:g.x)!==null&&f!==void 0?f:0,yPos:(w=(_=h.positionAbsolute)===null||_===void 0?void 0:_.y)!==null&&w!==void 0?w:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!h.selected,isDraggable:j,isSelectable:C,isConnectable:S,resizeObserver:p,dragHandle:h.dragHandle,zIndex:(b=(x=h[Yn])===null||x===void 0?void 0:x.z)!==null&&b!==void 0?b:0,isParent:!!((N=h[Yn])!==null&&N!==void 0&&N.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!h.width&&!!h.height})}))};hb.displayName="NodeRenderer";var rk=v.memo(hb),Ql;function fb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function pb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fb(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var ak=(Ql={},St(Ql,Ae.Left,Ae.Right),St(Ql,Ae.Right,Ae.Left),St(Ql,Ae.Top,Ae.Bottom),St(Ql,Ae.Bottom,Ae.Top),Ql),ok=function(e){var t,n,s,l,i,c=e.connectionNodeId,u=e.connectionHandleType,d=e.connectionLineStyle,p=e.connectionLineType,h=p===void 0?Ma.Bezier:p,f=e.isConnectable,g=e.CustomConnectionLineComponent,w=xn(v.useCallback(function(G){return{fromNode:G.nodeInternals.get(c),handleId:G.connectionHandleId,toX:(G.connectionPosition.x-G.transform[0])/G.transform[2],toY:(G.connectionPosition.y-G.transform[1])/G.transform[2]}},[c]),Ks),_=w.fromNode,b=w.handleId,x=w.toX,N=w.toY,E=_==null||(t=_[Yn])===null||t===void 0?void 0:t.handleBounds;if(!_||!f||!(E!=null&&E[u]))return null;var M=E[u],j=b?M.find(function(G){return G.id===b}):M[0],C=j?j.x+j.width/2:((n=_==null?void 0:_.width)!==null&&n!==void 0?n:0)/2,S=j?j.y+j.height/2:(s=_==null?void 0:_.height)!==null&&s!==void 0?s:0,$=((_==null||(l=_.positionAbsolute)===null||l===void 0?void 0:l.x)||0)+C,A=((_==null||(i=_.positionAbsolute)===null||i===void 0?void 0:i.y)||0)+S,L=j==null?void 0:j.position;if(!L)return null;var T=ak[L],P,z,W,D,R,U;switch(u){case"source":P=$,z=A,W=L,D=x,R=N,U=T;break;case"target":P=x,z=N,W=T,D=$,R=A,U=L;break}if(g)return ge.createElement("g",{className:"react-flow__connection"},ge.createElement(g,{connectionLineType:h,connectionLineStyle:d,fromNode:_,fromHandle:j,fromX:$,fromY:A,toX:x,toY:N,fromPosition:L,toPosition:T,sourcePosition:W,targetPosition:U,sourceNode:_,sourceHandle:j,targetX:D,targetY:R,sourceX:P,sourceY:z}));var V="",B={sourceX:P,sourceY:z,sourcePosition:W,targetX:D,targetY:R,targetPosition:U};return h===Ma.Bezier?V=Ry(B):h===Ma.Step?V=wp(pb(pb({},B),{},{borderRadius:0})):h===Ma.SmoothStep?V=wp(B):h===Ma.SimpleBezier?V=My(B):V="M".concat(P,",").concat(z," ").concat(D,",").concat(R),ge.createElement("g",{className:"react-flow__connection"},ge.createElement("path",{d:V,className:"react-flow__connection-path",style:d}))};function Tp(e){"@babel/helpers - typeof";return Tp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Tp(e)}var am,lk=function(t){var n=t.color,s=n===void 0?"none":n,l=t.strokeWidth,i=l===void 0?1:l;return ge.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:"none",points:"-5,-4 0,0 -5,4"})},ik=function(t){var n=t.color,s=n===void 0?"none":n,l=t.strokeWidth,i=l===void 0?1:l;return ge.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:s,points:"-5,-4 0,0 -5,4 -5,-4"})},gb=(am={},St(am,Kd.Arrow,lk),St(am,Kd.ArrowClosed,ik),am);function ck(e){var t=v.useMemo(function(){var n=gb.hasOwnProperty(e);return n?gb[e]:function(){return null}},[e]);return t}function _b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function uk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_b(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_b(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var dk=function(t){var n=t.id,s=t.type,l=t.color,i=t.width,c=i===void 0?12.5:i,u=t.height,d=u===void 0?12.5:u,p=t.markerUnits,h=p===void 0?"strokeWidth":p,f=t.strokeWidth,g=t.orient,w=g===void 0?"auto":g,_=ck(s);return ge.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(c),markerHeight:"".concat(d),viewBox:"-10 -10 20 20",markerUnits:h,orient:w,refX:"0",refY:"0"},ge.createElement(_,{color:l,strokeWidth:f}))},mk=function(t){var n=t.defaultColor,s=t.rfId;return function(l){var i=[];return l.edges.reduce(function(c,u){return[u.markerStart,u.markerEnd].forEach(function(d){if(d&&Tp(d)==="object"){var p=ip(d,s);i.includes(p)||(c.push(uk({id:p,color:d.color||n},d)),i.push(p))}}),c},[]).sort(function(c,u){return c.id.localeCompare(u.id)})}},vb=function(t){var n=t.defaultColor,s=t.rfId,l=xn(v.useCallback(mk({defaultColor:n,rfId:s}),[n,s]),function(i,c){return!(i.length!==c.length||i.some(function(u,d){return u.id!==c[d].id}))});return ge.createElement("defs",null,l.map(function(i){return ge.createElement(dk,{id:i.id,key:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient})}))};vb.displayName="MarkerDefinitions";var hk=v.memo(vb),fk=[{level:0,isMaxLevel:!0,edges:[]}];function pk(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=-1,l=e.reduce(function(c,u){var d=ey(u.zIndex),p=d?u.zIndex:0;if(n){var h,f,g,w;p=d?u.zIndex:Math.max(((h=t.get(u.source))===null||h===void 0||(f=h[Yn])===null||f===void 0?void 0:f.z)||0,((g=t.get(u.target))===null||g===void 0||(w=g[Yn])===null||w===void 0?void 0:w.z)||0)}return c[p]?c[p].push(u):c[p]=[u],s=p>s?p:s,c},{}),i=Object.entries(l).map(function(c){var u=bt(c,2),d=u[0],p=u[1],h=+d;return{edges:p,level:h,isMaxLevel:h===s}});return i.length===0?fk:i}function gk(e,t,n){var s=xn(v.useCallback(function(l){return e?l.edges.filter(function(i){var c=t.get(i.source),u=t.get(i.target);return(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&D1({sourcePos:c.positionAbsolute||{x:0,y:0},targetPos:u.positionAbsolute||{x:0,y:0},sourceWidth:c.width,sourceHeight:c.height,targetWidth:u.width,targetHeight:u.height,width:l.width,height:l.height,transform:l.transform})}):l.edges},[e,t]));return pk(s,t,n)}var _k=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},yb=function(t){var n=xn(_k,Ks),s=n.connectionNodeId,l=n.connectionHandleType,i=n.nodesConnectable,c=n.elementsSelectable,u=n.width,d=n.height,p=n.connectionMode,h=n.nodeInternals,f=gk(t.onlyRenderVisibleElements,h,t.elevateEdgesOnSelect);if(!u)return null;var g=t.connectionLineType,w=t.defaultMarkerColor,_=t.connectionLineStyle,b=t.connectionLineComponent,x=t.connectionLineContainerStyle,N=s&&l;return ge.createElement(ge.Fragment,null,f.map(function(E){var M=E.level,j=E.edges,C=E.isMaxLevel;return ge.createElement("svg",{key:M,style:{zIndex:M},width:u,height:d,className:"react-flow__edges react-flow__container"},C&&ge.createElement(hk,{defaultColor:w,rfId:t.rfId}),ge.createElement("g",null,j.map(function(S){var $=Jy(h,S.source),A=bt($,3),L=A[0],T=A[1],P=A[2],z=Jy(h,S.target),W=bt(z,3),D=W[0],R=W[1],U=W[2];if(!P||!U)return null;var V=S.type||"default";t.edgeTypes[V]||(console.warn('[React Flow]: Edge type "'.concat(V,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),V="default");var B=t.edgeTypes[V]||t.edgeTypes.default,G=p===$o.Strict?R.target:R.target||R.source,q=Xy(T.source,S.sourceHandle||null),F=Xy(G,S.targetHandle||null),K=(q==null?void 0:q.position)||Ae.Bottom,se=(F==null?void 0:F.position)||Ae.Top;if(!q||!F)return null;var Q=z1(L,q,K,D,F,se),H=Q.sourceX,Y=Q.sourceY,X=Q.targetX,ee=Q.targetY;return ge.createElement(B,{key:S.id,id:S.id,className:Ws([S.className,t.noPanClassName]),type:V,data:S.data,selected:!!S.selected,animated:!!S.animated,hidden:!!S.hidden,label:S.label,labelStyle:S.labelStyle,labelShowBg:S.labelShowBg,labelBgStyle:S.labelBgStyle,labelBgPadding:S.labelBgPadding,labelBgBorderRadius:S.labelBgBorderRadius,style:S.style,source:S.source,target:S.target,sourceHandleId:S.sourceHandle,targetHandleId:S.targetHandle,markerEnd:S.markerEnd,markerStart:S.markerStart,sourceX:H,sourceY:Y,targetX:X,targetY:ee,sourcePosition:K,targetPosition:se,elementsSelectable:c,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),N&&ge.createElement("svg",{style:x,width:u,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},ge.createElement(ok,{connectionNodeId:s,connectionHandleType:l,connectionLineStyle:_,connectionLineType:g,isConnectable:i,CustomConnectionLineComponent:b})))};yb.displayName="EdgeRenderer";var vk=v.memo(yb),yk=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function bk(e){var t=e.children,n=xn(yk);return ge.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function xk(e){var t=hp(),n=v.useRef(!1);v.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var bb=function(t){var n=t.nodeTypes,s=t.edgeTypes,l=t.onMove,i=t.onMoveStart,c=t.onMoveEnd,u=t.onInit,d=t.onNodeClick,p=t.onEdgeClick,h=t.onNodeDoubleClick,f=t.onEdgeDoubleClick,g=t.onNodeMouseEnter,w=t.onNodeMouseMove,_=t.onNodeMouseLeave,b=t.onNodeContextMenu,x=t.onSelectionContextMenu,N=t.connectionLineType,E=t.connectionLineStyle,M=t.connectionLineComponent,j=t.connectionLineContainerStyle,C=t.selectionKeyCode,S=t.multiSelectionKeyCode,$=t.zoomActivationKeyCode,A=t.deleteKeyCode,L=t.onlyRenderVisibleElements,T=t.elementsSelectable,P=t.selectNodesOnDrag,z=t.translateExtent,W=t.minZoom,D=t.maxZoom,R=t.defaultZoom,U=t.defaultPosition,V=t.preventScrolling,B=t.defaultMarkerColor,G=t.zoomOnScroll,q=t.zoomOnPinch,F=t.panOnScroll,K=t.panOnScrollSpeed,se=t.panOnScrollMode,Q=t.zoomOnDoubleClick,H=t.panOnDrag,Y=t.onPaneClick,X=t.onPaneScroll,ee=t.onPaneContextMenu,J=t.onEdgeUpdate,re=t.onEdgeContextMenu,we=t.onEdgeMouseEnter,Pe=t.onEdgeMouseMove,Me=t.onEdgeMouseLeave,Fe=t.edgeUpdaterRadius,Ke=t.onEdgeUpdateStart,Ue=t.onEdgeUpdateEnd,de=t.noDragClassName,pe=t.noWheelClassName,xe=t.noPanClassName,ke=t.elevateEdgesOnSelect,De=t.id;return xk(u),ge.createElement(tk,{onPaneClick:Y,onPaneContextMenu:ee,onPaneScroll:X,deleteKeyCode:A,selectionKeyCode:C,multiSelectionKeyCode:S,zoomActivationKeyCode:$,elementsSelectable:T,onMove:l,onMoveStart:i,onMoveEnd:c,zoomOnScroll:G,zoomOnPinch:q,zoomOnDoubleClick:Q,panOnScroll:F,panOnScrollSpeed:K,panOnScrollMode:se,panOnDrag:H,translateExtent:z,minZoom:W,maxZoom:D,defaultZoom:R,defaultPosition:U,onSelectionContextMenu:x,preventScrolling:V,noDragClassName:de,noWheelClassName:pe,noPanClassName:xe},ge.createElement(bk,null,ge.createElement(vk,{edgeTypes:s,onEdgeClick:p,onEdgeDoubleClick:f,connectionLineType:N,connectionLineStyle:E,connectionLineComponent:M,connectionLineContainerStyle:j,onEdgeUpdate:J,onlyRenderVisibleElements:L,onEdgeContextMenu:re,onEdgeMouseEnter:we,onEdgeMouseMove:Pe,onEdgeMouseLeave:Me,onEdgeUpdateStart:Ke,onEdgeUpdateEnd:Ue,edgeUpdaterRadius:Fe,defaultMarkerColor:B,noPanClassName:xe,elevateEdgesOnSelect:!!ke,rfId:De}),ge.createElement(rk,{nodeTypes:n,onNodeClick:d,onNodeDoubleClick:h,onNodeMouseEnter:g,onNodeMouseMove:w,onNodeMouseLeave:_,onNodeContextMenu:b,selectNodesOnDrag:P,onlyRenderVisibleElements:L,noPanClassName:xe,noDragClassName:de})))};bb.displayName="GraphView";var wk=v.memo(bb),xb=function(){return null};xb.displayName="GroupNode";function wb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function jb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wb(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var jc=function(e){var t=function(s){var l=s.id,i=s.type,c=s.data,u=s.xPos,d=s.yPos,p=s.selected,h=s.onClick,f=s.onMouseEnter,g=s.onMouseMove,w=s.onMouseLeave,_=s.onContextMenu,b=s.onDoubleClick,x=s.style,N=s.className,E=s.isDraggable,M=s.isSelectable,j=s.isConnectable,C=s.selectNodesOnDrag,S=s.sourcePosition,$=s.targetPosition,A=s.hidden,L=s.resizeObserver,T=s.dragHandle,P=s.zIndex,z=s.isParent,W=s.noPanClassName,D=s.noDragClassName,R=s.initialized,U=as(),V=v.useRef(null),B=v.useRef(S),G=v.useRef($),q=v.useRef(i),F=M||E||h||f||g||w,K=yc(l,U.getState,f),se=yc(l,U.getState,g),Q=yc(l,U.getState,w),H=yc(l,U.getState,_),Y=yc(l,U.getState,b),X=function(re){if(M&&(!C||!E)&&iy({id:l,store:U}),h){var we=U.getState().nodeInternals.get(l);h(re,jb({},we))}};v.useEffect(function(){if(V.current&&!A){var J=V.current;return L==null||L.observe(J),function(){return L==null?void 0:L.unobserve(J)}}},[A]),v.useEffect(function(){var J=q.current!==i,re=B.current!==S,we=G.current!==$;V.current&&(J||re||we)&&(J&&(q.current=i),re&&(B.current=S),we&&(G.current=$),U.getState().updateNodeDimensions([{id:l,nodeElement:V.current,forceUpdate:!0}]))},[l,i,S,$]);var ee=ub({nodeRef:V,disabled:A||!E,noDragClassName:D,handleSelector:T,nodeId:l,isSelectable:M,selectNodesOnDrag:C});return A?null:ge.createElement("div",{className:Ws(["react-flow__node","react-flow__node-".concat(i),W,N,{selected:p,selectable:M,parent:z}]),ref:V,style:jb({zIndex:P,transform:"translate(".concat(u,"px,").concat(d,"px)"),pointerEvents:F?"all":"none",visibility:R?"visible":"hidden"},x),onMouseEnter:K,onMouseMove:se,onMouseLeave:Q,onContextMenu:H,onClick:X,onDoubleClick:Y,"data-testid":"rf__node-".concat(l),"data-id":l},ge.createElement(y1,{value:l},ge.createElement(e,{id:l,data:c,type:i,xPos:u,yPos:d,selected:p,isConnectable:j,sourcePosition:S,targetPosition:$,dragging:ee,dragHandle:T,zIndex:P})))};return t.displayName="NodeWrapper",v.memo(t)};function Nb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Cb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nb(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function jk(e){var t={input:jc(e.input||Hy),default:jc(e.default||Mp),output:jc(e.output||Wy),group:jc(e.group||xb)},n={},s=Object.keys(e).filter(function(l){return!["input","default","output","group"].includes(l)}).reduce(function(l,i){return l[i]=jc(e[i]||Mp),l},n);return Cb(Cb({},t),s)}function Sb(e,t){v.useRef(null);var n=v.useMemo(function(){return t(e)},[e]);return n}function Eb(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var kb=function(t){var n=t.children,s=!0;try{as()}catch{s=!1}return s?ge.createElement(ge.Fragment,null,n):ge.createElement(by,{createStore:xy},n)};kb.displayName="ReactFlowWrapper";var Nk=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function Mb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,s)}return n}function Ab(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mb(Object(n),!0).forEach(function(s){St(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mb(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}Eb(A1),Eb(P1);var Ck={input:Hy,default:Mp,output:Wy},Sk={default:Np,straight:Dy,step:zy,smoothstep:jp,simplebezier:Ay},Ek=[15,15],kk=[0,0],Ob=v.forwardRef(function(e,t){var n=e.nodes,s=e.edges,l=e.defaultNodes,i=e.defaultEdges,c=e.className,u=e.nodeTypes,d=u===void 0?Ck:u,p=e.edgeTypes,h=p===void 0?Sk:p,f=e.onNodeClick,g=e.onEdgeClick,w=e.onInit,_=e.onMove,b=e.onMoveStart,x=e.onMoveEnd,N=e.onConnect,E=e.onConnectStart,M=e.onConnectStop,j=e.onConnectEnd,C=e.onClickConnectStart,S=e.onClickConnectStop,$=e.onClickConnectEnd,A=e.onNodeMouseEnter,L=e.onNodeMouseMove,T=e.onNodeMouseLeave,P=e.onNodeContextMenu,z=e.onNodeDoubleClick,W=e.onNodeDragStart,D=e.onNodeDrag,R=e.onNodeDragStop,U=e.onNodesDelete,V=e.onEdgesDelete,B=e.onSelectionChange,G=e.onSelectionDragStart,q=e.onSelectionDrag,F=e.onSelectionDragStop,K=e.onSelectionContextMenu,se=e.connectionMode,Q=se===void 0?$o.Strict:se,H=e.connectionLineType,Y=H===void 0?Ma.Bezier:H,X=e.connectionLineStyle,ee=e.connectionLineComponent,J=e.connectionLineContainerStyle,re=e.deleteKeyCode,we=re===void 0?"Backspace":re,Pe=e.selectionKeyCode,Me=Pe===void 0?"Shift":Pe,Fe=e.multiSelectionKeyCode,Ke=Fe===void 0?"Meta":Fe,Ue=e.zoomActivationKeyCode,de=Ue===void 0?"Meta":Ue,pe=e.snapToGrid,xe=pe===void 0?!1:pe,ke=e.snapGrid,De=ke===void 0?Ek:ke,ce=e.onlyRenderVisibleElements,Oe=ce===void 0?!1:ce,Ye=e.selectNodesOnDrag,ct=Ye===void 0?!0:Ye,Je=e.nodesDraggable,mt=e.nodesConnectable,Ze=e.elementsSelectable,ot=e.minZoom,Et=ot===void 0?.5:ot,zt=e.maxZoom,We=zt===void 0?2:zt,Dt=e.defaultZoom,ht=Dt===void 0?1:Dt,kt=e.defaultPosition,sn=kt===void 0?kk:kt,wn=e.translateExtent,Mt=wn===void 0?dp:wn,rn=e.preventScrolling,Fn=rn===void 0?!0:rn,Ut=e.nodeExtent,it=e.defaultMarkerColor,In=it===void 0?"#b1b1b7":it,Zt=e.zoomOnScroll,gn=Zt===void 0?!0:Zt,ft=e.zoomOnPinch,Os=ft===void 0?!0:ft,Yt=e.panOnScroll,gt=Yt===void 0?!1:Yt,xt=e.panOnScrollSpeed,ls=xt===void 0?.5:xt,dn=e.panOnScrollMode,jn=dn===void 0?Hl.Free:dn,mn=e.zoomOnDoubleClick,An=mn===void 0?!0:mn,hn=e.panOnDrag,is=hn===void 0?!0:hn,It=e.onPaneClick,Bn=e.onPaneScroll,On=e.onPaneContextMenu,Nn=e.children,lr=e.onEdgeUpdate,Xn=e.onEdgeContextMenu,Ps=e.onEdgeDoubleClick,_s=e.onEdgeMouseEnter,vs=e.onEdgeMouseMove,Xs=e.onEdgeMouseLeave,Jn=e.onEdgeUpdateStart,Qt=e.onEdgeUpdateEnd,At=e.edgeUpdaterRadius,st=At===void 0?10:At,ir=e.onNodesChange,Un=e.onEdgesChange,Js=e.noDragClassName,cs=Js===void 0?"nodrag":Js,wr=e.noWheelClassName,le=wr===void 0?"nowheel":wr,_e=e.noPanClassName,$e=_e===void 0?"nopan":_e,Ct=e.fitView,je=Ct===void 0?!1:Ct,tt=e.fitViewOptions,lt=e.connectOnClick,Rt=lt===void 0?!0:lt,Ot=e.attributionPosition,an=e.proOptions,qt=e.defaultEdgeOptions,fn=e.elevateEdgesOnSelect,Ts=fn===void 0?!1:fn,Zn=Qd(e,Nk),Cn=Sb(d,jk),Pn=Sb(h,L1);return ge.createElement("div",Ab(Ab({},Zn),{},{ref:t,className:Ws(["react-flow",c])}),ge.createElement(kb,null,ge.createElement(wk,{onInit:w,onMove:_,onMoveStart:b,onMoveEnd:x,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:A,onNodeMouseMove:L,onNodeMouseLeave:T,onNodeContextMenu:P,onNodeDoubleClick:z,nodeTypes:Cn,edgeTypes:Pn,connectionLineType:Y,connectionLineStyle:X,connectionLineComponent:ee,connectionLineContainerStyle:J,selectionKeyCode:Me,deleteKeyCode:we,multiSelectionKeyCode:Ke,zoomActivationKeyCode:de,onlyRenderVisibleElements:Oe,selectNodesOnDrag:ct,translateExtent:Mt,minZoom:Et,maxZoom:We,defaultZoom:ht,defaultPosition:sn,preventScrolling:Fn,zoomOnScroll:gn,zoomOnPinch:Os,zoomOnDoubleClick:An,panOnScroll:gt,panOnScrollSpeed:ls,panOnScrollMode:jn,panOnDrag:is,onPaneClick:It,onPaneScroll:Bn,onPaneContextMenu:On,onSelectionContextMenu:K,onEdgeUpdate:lr,onEdgeContextMenu:Xn,onEdgeDoubleClick:Ps,onEdgeMouseEnter:_s,onEdgeMouseMove:vs,onEdgeMouseLeave:Xs,onEdgeUpdateStart:Jn,onEdgeUpdateEnd:Qt,edgeUpdaterRadius:st,defaultMarkerColor:In,noDragClassName:cs,noWheelClassName:le,noPanClassName:$e,elevateEdgesOnSelect:Ts,id:Zn==null?void 0:Zn.id}),ge.createElement(k1,{nodes:n,edges:s,defaultNodes:l,defaultEdges:i,onConnect:N,onConnectStart:E,onConnectStop:M,onConnectEnd:j,onClickConnectStart:C,onClickConnectStop:S,onClickConnectEnd:$,nodesDraggable:Je,nodesConnectable:mt,elementsSelectable:Ze,minZoom:Et,maxZoom:We,nodeExtent:Ut,onNodesChange:ir,onEdgesChange:Un,snapToGrid:xe,snapGrid:De,connectionMode:Q,translateExtent:Mt,connectOnClick:Rt,defaultEdgeOptions:qt,fitView:je,fitViewOptions:tt,onNodesDelete:U,onEdgesDelete:V,onNodeDragStart:W,onNodeDrag:D,onNodeDragStop:R,onSelectionDrag:q,onSelectionDragStart:G,onSelectionDragStop:F}),B&&ge.createElement(S1,{onSelectionChange:B}),Nn,ge.createElement(d1,{proOptions:an,position:Ot})))});Ob.displayName="ReactFlow";var Pb=function(t){var n=t.children;return ge.createElement(by,{createStore:xy},n)};Pb.displayName="ReactFlowProvider";function Tb(e){return function(t){var n=v.useState(t),s=bt(n,2),l=s[0],i=s[1],c=v.useCallback(function(u){return i(function(d){return e(u,d)})},[]);return[l,i,c]}}var Mk=Tb(ry),Ak=Tb(LE);const Ok=e=>Number.isFinite(e),om=e=>Math.round(e*100)/100,Pk=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const l=Math.abs(n-e),i=Math.abs(s-t),c=Math.sqrt(l*l+i*i),u=Math.max(80,Math.min(c*.4,280)),d=Number.isFinite(u)?u:120,p=n>=e?1:-1,h=Math.min(Math.abs(s-t)*.2,50),f=e+p*d,g=t+(s>t?h:-h),w=n-p*d,_=s-(s>t?h:-h);return`M ${e},${t} C ${f},${g} ${w},${_} ${n},${s}`},Tk=({id:e,sourceX:t,sourceY:n,targetX:s,targetY:l,markerEnd:i,style:c})=>{const{setEdges:u}=hp(),[d,p]=v.useState(!1),h=v.useCallback(()=>{p(!0)},[]),f=v.useCallback(()=>{p(!1)},[]),g=v.useMemo(()=>[t,n,s,l].every(T=>Ok(T))?{sourceX:om(t),sourceY:om(n),targetX:om(s),targetY:om(l)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:s,targetY:l}),null),[t,n,s,l,e]),w=v.useMemo(()=>{if(!g)return null;const{sourceX:T,sourceY:P,targetX:z,targetY:W}=g;return Pk(T,P,z,W)},[g]),_=v.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!g||!w)return null;const{sourceX:b,sourceY:x,targetX:N,targetY:E}=g,M=(b+N)/2,j=(x+E)/2,C=32,S=M-C/2,$=j-C/2,A=`animated-edge${d?" animated-edge--hovered":""}`,L=`canvas-edge-remove${d?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:A,onMouseEnter:h,onMouseLeave:f,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:_,gradientUnits:"userSpaceOnUse",x1:b,y1:x,x2:N,y2:E,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:w,fill:"none",stroke:"transparent",strokeWidth:20,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${_})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${_})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:i,className:"animated-edge__base",style:{...c,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${_})`,strokeWidth:d?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:L,x:S,y:$,width:C,height:C,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:T=>{T.stopPropagation(),u(P=>P.filter(z=>z.id!==e))},"aria-label":"Remove connection",children:""})})})]})};async function $b(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function Lb(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function zb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load label encoding recommendations");return c.json()}async function Db(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load ordinal encoding suggestions");return c.json()}async function Rb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load target encoding recommendations");return c.json()}async function Fb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load hash encoding recommendations");return c.json()}async function Ib(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load one-hot encoding recommendations");return c.json()}async function Bb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load dummy encoding recommendations");return c.json()}async function $p(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load column drop recommendations");return c.json()}async function Ub(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,c={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load outlier recommendations");return u.json()}async function qb(e,t={}){const{sampleSize:n=500,transformations:s,graph:l,targetNodeId:i}=t,c={dataset_source_id:e,sample_size:n};Array.isArray(s)?s.length>0&&(c.transformations=JSON.stringify(s)):s&&typeof s=="object"&&Object.keys(s).length>0&&(c.transformations=JSON.stringify(s)),l&&Array.isArray(l.nodes)&&Array.isArray(l.edges)&&(c.graph={nodes:l.nodes,edges:l.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load skewness recommendations");return u.json()}async function Hb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load scaling recommendations");return c.json()}async function Vb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),l&&(i.target_node_id=l);const c=await fetch("/ml-workflow/api/recommendations/binning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load binning recommendations");return c.json()}async function Wb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/analytics/binned-distribution",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){let d="Failed to load binned column distributions";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function Kb(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:l}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c=new URLSearchParams({dataset_source_id:e,sample_size:String(i)});s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&c.set("graph",JSON.stringify({nodes:s.nodes,edges:s.edges})),l&&c.set("target_node_id",l);const u=await fetch(`/ml-workflow/api/analytics/quick-profile?${c.toString()}`);if(!u.ok){let d="Failed to generate dataset profile";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function $k(e,t={}){const{config:n,sampleSize:s,graph:l,targetNodeId:i}=t,c={dataset_source_id:e,sample_size:s==="all"?0:typeof s=="number"&&Number.isFinite(s)?s:300};if(n&&typeof n=="object"){const d=(g,w)=>{const _=Number(g);return Number.isFinite(_)?_<0?0:_>100?100:_:w},p=g=>{if(!g||typeof g!="object")return{};const w={};return Object.entries(g).forEach(([_,b])=>{const x=String(_??"").trim();if(!x)return;let N=null,E=null;if(b&&typeof b=="object"){const M=b.lower??b.min??b.minimum??null,j=b.upper??b.max??b.maximum??null,C=Number(M);Number.isFinite(C)&&(N=C);const S=Number(j);Number.isFinite(S)&&(E=S)}if(!(N===null&&E===null)){if(N!==null&&E!==null&&N>E){const M=N;N=E,E=M}w[x]={lower:N,upper:E}}}),w},h=d(n.lower_percentile,5),f=d(n.upper_percentile,95);c.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:h,upper_percentile:f<=h?Math.min(h+1,100):f,manual_bounds:p(n.manual_bounds)}}l&&Array.isArray(l.nodes)&&Array.isArray(l.edges)&&(c.graph={nodes:l.nodes,edges:l.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){const d=await u.text();throw new Error(d||"Failed to load outlier diagnostics")}return u.json()}async function Yb(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function Gb(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function Qb(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}async function Xb(e,t={}){const{offset:n,limit:s,mode:l}=t,i=new URLSearchParams;typeof n=="number"&&Number.isFinite(n)&&i.set("offset",String(n)),typeof s=="number"&&Number.isFinite(s)&&i.set("limit",String(s)),l&&i.set("mode",l);const c=i.toString(),u=`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/preview/rows${c?`?${c}`:""}`,d=await fetch(u);if(!d.ok){const p=await d.text();throw new Error(p||"Failed to load preview rows")}return d.json()}async function Jb(e){const t=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(n||"Failed to load pipeline preview")}return t.json()}async function Zb(e){const t={...e,sample_size:0},n=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const s=await n.text();throw new Error(s||"Failed to trigger full dataset execution")}return n.json()}async function Lk(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/full-execution/${encodeURIComponent(t)}`);if(!n.ok){const s=await n.text();throw new Error(s||"Failed to fetch full execution status")}return n.json()}async function ex(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,l=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:l}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function tx(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function Nc(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view training jobs.");const l=await s.text();throw new Error(l||"Failed to load training jobs")}return s.json()}async function nx(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const s=await n.text();throw new Error(s||"Failed to evaluate model")}return n.json()}async function sx(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,l=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:l}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function zk(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function Cc(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view tuning jobs.");const l=await s.text();throw new Error(l||"Failed to load tuning jobs")}return s.json()}async function lm(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function rx(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const s=n.toString(),l=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${s?`?${s}`:""}`,{credentials:"include"});if(!l.ok){if(l.status===404)throw new Error(`Model type '${e}' not found`);const i=await l.text();throw new Error(i||"Failed to fetch best hyperparameters")}return l.json()}const Lp=e=>{if(Array.isArray(e))return e.map(t=>Lp(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(s=>{n[s]=Lp(e[s])}),n}return e},Dk=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),Rk=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return Dk(n)},Fk=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],s=t.map(i=>{let c=null;if(i&&i.data&&typeof i.data=="object"){const u=i.data.config;if(u!==void 0)try{c=JSON.parse(JSON.stringify(u))}catch{c=u}}return{id:i&&Object.prototype.hasOwnProperty.call(i,"id")?i.id??null:null,type:i&&Object.prototype.hasOwnProperty.call(i,"type")?i.type??null:null,catalogType:i&&i.data&&Object.prototype.hasOwnProperty.call(i.data,"catalogType")?i.data.catalogType??null:null,config:c}}).sort((i,c)=>{const u=typeof i.id=="string"?i.id:String(i.id??""),d=typeof c.id=="string"?c.id:String(c.id??"");return u.localeCompare(d)}),l=n.map(i=>({source:i&&Object.prototype.hasOwnProperty.call(i,"source")?i.source??null:null,target:i&&Object.prototype.hasOwnProperty.call(i,"target")?i.target??null:null,sourceHandle:i&&Object.prototype.hasOwnProperty.call(i,"sourceHandle")?i.sourceHandle??null:null,targetHandle:i&&Object.prototype.hasOwnProperty.call(i,"targetHandle")?i.targetHandle??null:null})).sort((i,c)=>{const u=String(i.source??"").localeCompare(String(c.source??""));return u!==0?u:String(i.target??"").localeCompare(String(c.target??""))});return{nodes:s,edges:l}};async function Do(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=Fk(t),s=JSON.stringify(Lp(n)),l=await Rk(s);return`${e}_${l.slice(0,8)}`}const Ik=Object.freeze(Object.defineProperty({__proto__:null,createHyperparameterTuningJob:sx,createTrainingJob:ex,evaluateTrainingJob:nx,fetchBestHyperparameters:rx,fetchBinnedDistribution:Wb,fetchBinningRecommendations:Vb,fetchDatasets:Lb,fetchDropColumnRecommendations:$p,fetchDummyEncodingRecommendations:Bb,fetchFullExecutionStatus:Lk,fetchHashEncodingRecommendations:Fb,fetchHyperparameterTuningJob:zk,fetchHyperparameterTuningJobs:Cc,fetchLabelEncodingRecommendations:zb,fetchModelHyperparameters:lm,fetchNodeCatalog:$b,fetchOneHotEncodingRecommendations:Ib,fetchOrdinalEncodingRecommendations:Db,fetchOutlierDiagnostics:$k,fetchOutlierRecommendations:Ub,fetchPipeline:Yb,fetchPipelineHistory:Qb,fetchPipelinePreview:Jb,fetchPipelinePreviewRows:Xb,fetchQuickProfile:Kb,fetchScalingRecommendations:Hb,fetchSkewnessRecommendations:qb,fetchTargetEncodingRecommendations:Rb,fetchTrainingJob:tx,fetchTrainingJobs:Nc,generatePipelineId:Do,savePipeline:Gb,triggerFullDatasetExecution:Zb},Symbol.toStringTag,{value:"Module"})),Bk=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:l,columnTypeMap:i,setAvailableColumns:c,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:p,setColumnSuggestions:h})=>{const[f,g]=v.useState([]),[w,_]=v.useState(null),[b,x]=v.useState([]),[N,E]=v.useState(null),[M,j]=v.useState(!1),[C,S]=v.useState(null),[$,A]=v.useState(null),[L,T]=v.useState(0),P=v.useRef(i);v.useEffect(()=>{P.current=i},[i]),v.useEffect(()=>{let U=!0;const V=B=>{x([]),E(B??null),S(null),A(null),j(!1),g([]),_(null),c([]),u(""),d({}),p({}),h({})};return e?t?l?(j(!0),E(null),$p(t,{graph:s,targetNodeId:n??null}).then(B=>{if(!U)return;const G=Array.isArray(B==null?void 0:B.candidates)?B.candidates:[];x(G),S((B==null?void 0:B.generated_at)??null),A(typeof(B==null?void 0:B.suggested_threshold)=="number"?Number(B.suggested_threshold):null);const q=Array.isArray(B==null?void 0:B.available_filters)?B.available_filters:[];g(q),_(Q=>Q&&q.some(H=>H.id===Q)?Q:null);const F={};B&&typeof B=="object"&&(B!=null&&B.column_missing_map)&&typeof B.column_missing_map=="object"&&Object.entries(B.column_missing_map).forEach(([Q,H])=>{const Y=String(Q??"").trim();if(!Y)return;const X=Number(H);Number.isFinite(X)&&(F[Y]=Number(X))});const K=new Set;Array.isArray(B==null?void 0:B.all_columns)&&B.all_columns.forEach(Q=>{const H=String(Q??"").trim();H&&K.add(H)}),Object.keys(P.current??{}).forEach(Q=>K.add(Q));const se=Array.from(K).sort((Q,H)=>Q.localeCompare(H));se.forEach(Q=>{Object.prototype.hasOwnProperty.call(F,Q)||(F[Q]=0)}),c(se),u(""),d(F),p(Q=>{const H=B==null?void 0:B.column_type_map;if(!H||typeof H!="object")return Q;const Y={...Q};return Object.entries(H).forEach(([X,ee])=>{const J=String(X??"").trim();if(!J)return;const re=String(ee??"").trim();Y[J]=re||Q[J]||""}),Y}),h(Q=>{const H=B==null?void 0:B.column_recommendations;if(!H||typeof H!="object")return Q;const Y={};return Object.entries(H).forEach(([X,ee])=>{const J=String(X??"").trim();if(!J)return;const re=Array.isArray(ee)?ee.map(we=>String(we??"").trim()).filter(Boolean):[];Y[J]=re}),Y})}).catch(B=>{U&&V((B==null?void 0:B.message)??"Unable to load recommendations")}).finally(()=>{U&&j(!1)}),()=>{U=!1}):(V("Connect this step to an upstream output to load recommendations."),()=>{U=!1}):(V(),()=>{U=!1}):(V(),()=>{U=!1})},[P,s,e,l,n,L,c,d,u,h,p,t]);const z=v.useCallback(()=>{!e||!t||!l||T(U=>U+1)},[e,l,t]),W=v.useMemo(()=>{const U=new Map;return f.forEach(V=>{V!=null&&V.id&&U.set(V.id,V.label)}),U},[f]),D=v.useCallback(U=>U?W.has(U)?W.get(U)??null:U.split("_").filter(Boolean).map(B=>B.charAt(0).toUpperCase()+B.slice(1)).join(" ")||U:null,[W]),R=v.useMemo(()=>w?b.filter(U=>Array.isArray(U==null?void 0:U.signals)&&U.signals.includes(w)):b,[w,b]);return{hasDropColumnSource:e,availableFilters:f,activeFilterId:w,setActiveFilterId:_,recommendations:b,filteredRecommendations:R,formatSignalName:D,isFetchingRecommendations:M,recommendationsError:N,recommendationsGeneratedAt:C,suggestedThreshold:$,refreshRecommendations:z}},Uk=({thresholdParameter:e,dropIfAnyParameter:t,renderParameterField:n})=>!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&n(e),t&&n(t)]}),qk="first",Hk=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],Vk=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:s,renderMultiSelectField:l,removeDuplicatesKeepSelectId:i,removeDuplicatesKeep:c,onKeepChange:u})=>{if(!n&&!s)return null;const d=p=>{const h=p.target.value;u(h==="last"||h==="none"?h:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),l(n)]}),s&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:i,className:"canvas-modal__parameter-label",children:s.label??"Keep strategy"}),s.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:s.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:i,value:c,onChange:d,children:Hk.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))})})]})]})},Ve=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],Wk=["float64","Int64","boolean","string","category","datetime64[ns]","object"],Kk=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:s,columnSuggestions:l,selectedColumns:i,previewColumns:c,previewStatus:u,sourceId:d,hasReachableSource:p})=>{const h=v.useMemo(()=>{const j=e==null?void 0:e.column_overrides;if(!j||typeof j!="object"||Array.isArray(j))return{};const C={};return Object.entries(j).forEach(([S,$])=>{const A=String(S??"").trim();if(!A||typeof $!="string")return;const L=$.trim();L&&(C[A]=L)}),C},[e==null?void 0:e.column_overrides]),f=v.useMemo(()=>{const j=e==null?void 0:e.target_dtype;return typeof j=="string"?j.trim():""},[e==null?void 0:e.target_dtype]),g=v.useMemo(()=>{const j=new Set;return n.forEach(S=>j.add(S)),Object.keys(s).forEach(S=>j.add(S)),Object.keys(l).forEach(S=>j.add(S)),Object.keys(h).forEach(S=>j.add(S)),i.forEach(S=>j.add(S)),c.forEach(S=>{typeof S=="string"&&j.add(S)}),Array.from(j).sort((S,$)=>S.localeCompare($)).map(S=>{const $=s[S]??"Unknown",A=l[S]??[],L=A.length?A[0]:null,T=Object.prototype.hasOwnProperty.call(h,S),P=T?h[S]:null,z=typeof P=="string"?P.trim():"",W=T?z:f,D=new Set;W&&D.add(W),A.forEach(q=>D.add(q)),$&&$!=="Unknown"&&D.add($),f&&D.add(f),Wk.forEach(q=>D.add(q));const R=W??"",U=!!(L&&L!==R),V=!!(L&&L===R),B=i.includes(S),G=Array.from(D).sort((q,F)=>q.localeCompare(F));return{column:S,originalType:$,recommended:L,currentTarget:W,suggestions:A,options:G,hasRecommendationGap:U,hasOverride:T,usesDefaultTarget:!T,isRecommendationApplied:V,isSelected:B}})},[n,f,h,l,s,c,i]),w=v.useMemo(()=>{const j=g.filter($=>$.hasRecommendationGap),C=g.filter($=>!$.hasRecommendationGap),S=[];return j.length&&S.push({key:"needs-attention",label:"Needs attention",rows:j}),C.length&&S.push({key:"all-columns",label:j.length?"Other columns":"All columns",rows:C}),S},[g]),_=v.useMemo(()=>g.filter(j=>j.hasRecommendationGap).length,[g]),b=v.useMemo(()=>_>0,[_]),x=v.useMemo(()=>g.filter(j=>j.isSelected).length,[g]),N=v.useCallback((j,C)=>{const S=j.trim();S&&t($=>{const A=$.column_overrides&&typeof $.column_overrides=="object"&&!Array.isArray($.column_overrides)?{...$.column_overrides}:{},L=typeof C=="string"?C.trim():"",T=new Set(Ve($.columns)),P=new Set(Ve($.skipped_columns)),z=P.delete(S);L?(A[S]=L,T.add(S)):delete A[S];const W={...$,columns:Array.from(T).sort((D,R)=>D.localeCompare(R)),column_overrides:A};return z&&(W.skipped_columns=Array.from(P).sort((D,R)=>D.localeCompare(R))),W})},[t]),E=v.useCallback(()=>{const j=Object.entries(l).filter(([,C])=>C.length>0);j.length&&t(C=>{const S=new Set(Ve(C.columns)),$=C.column_overrides&&typeof C.column_overrides=="object"&&!Array.isArray(C.column_overrides)?{...C.column_overrides}:{};return j.forEach(([A,L])=>{const T=A.trim();T&&(S.add(T),L.length&&($[T]=L[0]))}),{...C,columns:Array.from(S).sort((A,L)=>A.localeCompare(L)),column_overrides:$}})},[l,t]),M=v.useCallback((j,C)=>{C==="__default__"?N(j,null):N(j,C)},[N]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:E,disabled:!b,children:"Apply recommendations"})})]}),!d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),d&&!p&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),f?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:f}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),g.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",g.length," column",g.length===1?"":"s","  ",x," mapped in node selection."]}),b?a.jsxs("p",{className:"canvas-modal__note",children:[_," column",_===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):g.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),u==="loading"&&!g.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),g.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:w.map(j=>a.jsxs("div",{className:"canvas-cast__group",children:[j.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:j.label}),a.jsxs("span",{children:[j.rows.length," column",j.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:j.rows.map(C=>{const S=["canvas-cast__row"];C.hasRecommendationGap&&S.push("canvas-cast__row--attention"),C.hasOverride&&S.push("canvas-cast__row--override");const $=C.hasOverride?C.currentTarget||"":"__default__",A=C.isRecommendationApplied,L=C.suggestions.slice(1,4),T=C.hasOverride?C.currentTarget?`Override  ${C.currentTarget}`:"Override cleared (uses original dtype)":f?`Inheriting ${f}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:S.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:C.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[C.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),C.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!C.isSelected&&!C.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:C.originalType})}),a.jsx("td",{children:C.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${C.hasRecommendationGap?" canvas-cast__chip--attention":""}${A?" canvas-cast__chip--applied":""}`,children:C.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:A?"Aligned with target":"Not applied yet"}),L.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",L.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:$,onChange:P=>M(C.column,P.target.value),children:[a.jsx("option",{value:"__default__",children:f?`Inherit global (${f})`:"No override (use original)"}),C.options.map(P=>a.jsx("option",{value:P,children:P},`${C.column}-${P}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:T})]})})]},`cast-row-${C.column}`)})})]})})]},`cast-group-${j.key}`))})]})},Sc=100,Yk=12,Gk={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},ax={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},Qk={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details."},Xk={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},Jk=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},Zk=e=>{if(!e)return"";const t=Qk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},ox=(e,t)=>{if(!e)return null;const n=e.job_status??null,s=Jk(n??e.status??null),l=ax[n??e.status??s]??ax[s],i=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,c=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let u=`Full dataset run: ${l}`;s==="running"&&i&&c?u=`Full dataset run: In progress (${i}/${c})`:s==="running"&&i?u=`Full dataset run: In progress (${i} rows)`:s==="succeeded"&&i?u=`Full dataset run: Completed (${i} rows)`:s==="succeeded"&&c&&(u=`Full dataset run: Completed (${c} rows)`);const d=[],p=[],h=n?Xk[n]??n:null;if(n==="running"?i&&c?d.push(`Processed ${i} of ${c} rows.`):i?d.push(`Processed ${i} rows.`):c&&d.push(`Processing ${c} rows.`):i?d.push(`Processed ${i} rows.`):c&&d.push(`Total rows ${c}.`),e.reason&&d.push(e.reason),h&&p.push({label:"Background job",value:h}),e.job_id&&p.push({label:"Background job ID",value:e.job_id}),c&&p.push({label:"Dataset rows",value:c}),i&&s!=="queued"&&s!=="skipped"&&p.push({label:"Processed rows",value:i}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&p.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const w=new Date(e.last_updated).toLocaleString();p.push({label:"Last updated",value:w})}catch{p.push({label:"Last updated",value:String(e.last_updated)})}const f=Array.isArray(e.warnings)?e.warnings.map(Zk).map(w=>w.trim()).filter(Boolean):[];let g=null;switch(s){case"queued":g=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":g=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(i){const w=e.processed_rows===1?"":"s";g=`Full dataset run processed ${i} row${w}.`}else c?g=`Full dataset run completed (${c} rows).`:g="Full dataset run completed.";break;case"failed":g=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":g="Full dataset run cancelled.";break;case"skipped":g=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":g=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:g=null;break}return{label:u,tone:s,details:d,metadata:p,warnings:f,stepLabel:g,isActive:n==="queued"||n==="running"}},lx=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),eM=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const s=e.split(":",2)[1]??"";return s?`Preview mode "${s}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=Gk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},tM=({preview:e,columns:t,rows:n,tableNote:s,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:p,fullExecutionWarnings:h})=>{const f=e==null?void 0:e.metrics,g=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],w=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],_=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let b=_;const x=p||null;if(x){const j=_.findIndex(C=>typeof C=="string"&&C.toLowerCase().startsWith("full dataset run"));j>=0?b=[..._.slice(0,j),x,..._.slice(j+1)]:_.includes(x)||(b=[..._,x])}const N=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],E=w.reduce((j,C)=>(C&&typeof C.index=="number"&&(j[C.index]=typeof C.missing_percentage=="number"?C.missing_percentage:0),j),{}),M=N.slice(0,Yk);return a.jsxs("div",{className:"canvas-preview",children:[f&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:f.requested_sample_size===0?"Full dataset":i(f.requested_sample_size)})]})]}),b.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:b.map((j,C)=>a.jsx("li",{children:j},`${j}-${C}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(j=>a.jsx("th",{children:j},j))})}),a.jsx("tbody",{children:n.map((j,C)=>a.jsx("tr",{children:t.map(S=>a.jsx("td",{children:l(j==null?void 0:j[S])},`${C}-${S}`))},`row-${C}`))})]}),s?a.jsx("p",{className:"canvas-modal__note",children:s}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),w.length>0&&M.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:M.map((j,C)=>{const S=E[C]??0,$=S%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",C+1]}),a.jsxs("strong",{children:[i(S,$),"%"]})]},`row-missing-${C}`)})})]}),g.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:g.map(j=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:j.name}),j.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",j.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",c(j.missing_percentage)," (",i(j.missing_count),")"]}),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",u(j.mean)]}),typeof j.median=="number"&&!Number.isNaN(j.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",u(j.median)]}),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",d(j.mode)]}),typeof j.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",i(j.distinct_count)]})]},j.name))})]}),h&&h.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:h.map((j,C)=>a.jsx("li",{children:j},`${j}-${C}`))})]})]})},nM=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:s,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d})=>{var V,B,G,q,F;const[p,h]=v.useState(()=>lx()),[f,g]=v.useState(null),[w,_]=v.useState(!1),b=e.status==="loading",x=b||!n,N=v.useMemo(()=>{var se;const K=(se=e.data)==null?void 0:se.columns;return Array.isArray(K)?K.filter(Q=>typeof Q=="string"):[]},[(V=e.data)==null?void 0:V.columns]),E=v.useMemo(()=>{var K;return Array.isArray((K=e.data)==null?void 0:K.sample_rows)?e.data.sample_rows.slice(0,Sc):[]},[(B=e.data)==null?void 0:B.sample_rows]),M=E.length,j=Array.isArray((G=e.data)==null?void 0:G.sample_rows)?e.data.sample_rows.length:0,C=(q=e.data)==null?void 0:q.metrics,S=v.useMemo(()=>C?j>M||typeof C.total_rows=="number"&&C.total_rows>j:!1,[C,M,j]);v.useEffect(()=>{var se;if(e.status!=="success"||!e.data){h(Q=>Q.status==="idle"?Q:lx()),g(null);return}const K=ox((se=e.data.signals)==null?void 0:se.full_execution,i);g(K),h({status:"ready",columns:[...N],rows:[...E],nextOffset:M,hasMore:S,totalRows:typeof(C==null?void 0:C.total_rows)=="number"?C.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[N,E,M,S,i,C==null?void 0:C.total_rows,e.data,e.status]),v.useEffect(()=>{var H,Y;if(!f||!f.isActive)return;const K=(Y=(H=e.data)==null?void 0:H.signals)==null?void 0:Y.full_execution;if(!K||!K.job_id||!t)return;const se=typeof K.poll_after_seconds=="number"&&K.poll_after_seconds>0?K.poll_after_seconds*1e3:5e3,Q=setTimeout(()=>{Promise.resolve().then(()=>Ik).then(X=>X.fetchFullExecutionStatus(t,K.job_id)).then(X=>{const ee=ox(X,i);g(ee),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(X=>{console.error("Failed to poll background job status:",X)})},se);return()=>clearTimeout(Q)},[f,t,i,e.data]);const $=p.columns.length>0?p.columns:N,A=p.rows.length>0?p.rows:E,L=p.totalRows??(typeof(C==null?void 0:C.total_rows)=="number"?C.total_rows:null),T=p.status==="idle"?S:p.hasMore,P=p.status==="loading",z=A.length,W=v.useMemo(()=>{if(!z)return null;const K=i(z);if(L!==null&&L>=0){const se=i(L),Q=`Loaded ${K} of ${se} rows.`;return T&&z<L?`${Q} Load more rows to continue.`:!T&&z<L?`${Q} Preview limited by backend settings.`:Q}return T?`Loaded ${K} rows. Additional rows available.`:`Loaded ${K} rows.`},[T,i,z,L]),D=v.useMemo(()=>(p.status==="idle"?[]:p.samplingAdjustments).map(eM).map(se=>se.trim()).filter(Boolean),[p.samplingAdjustments,p.status]),R=p.status==="idle"?!1:p.largeDataset,U=v.useCallback(()=>{var H;if(!t||!T||p.status==="loading")return;const K=p.rows.length>0?p.rows:E,se=p.status==="idle"?K.length:p.nextOffset??K.length,Q=Array.isArray((H=e.data)==null?void 0:H.sample_rows)?e.data.sample_rows:[];if(se<Q.length){const Y=Q.slice(se,se+Sc),X=K.concat(Y),ee=se+Y.length,J=ee<Q.length||typeof(C==null?void 0:C.total_rows)=="number"&&C.total_rows>Q.length;h({status:"ready",columns:p.columns.length>0?p.columns:N,rows:X,nextOffset:J?ee:null,hasMore:J,totalRows:typeof(C==null?void 0:C.total_rows)=="number"?C.total_rows:null,samplingAdjustments:p.samplingAdjustments,largeDataset:p.largeDataset,error:null});return}h(Y=>({...Y,status:"loading",error:null})),Xb(t,{offset:se,limit:Sc}).then(Y=>{h(X=>{const ee=X.rows.length>0?X.rows:K,J=Array.isArray(Y.columns)&&Y.columns.length>0?Y.columns.map(ke=>String(ke)):X.columns.length>0?X.columns:N,re=typeof Y.offset=="number"&&Y.offset>=0?Y.offset:0,we=Array.isArray(Y.rows)?Y.rows:[],Pe=re<=ee.length?ee.slice(0,re):ee.slice(),Me=re<=ee.length?Pe.concat(we):ee.concat(we),Fe=we.length,Ke=!!Y.has_more,Ue=typeof Y.next_offset=="number"?Y.next_offset:Ke?re+Fe:null,de=typeof Y.total_rows=="number"?Y.total_rows:null,pe=Ke?null:Me.length,xe=de!==null?de:X.totalRows!==null?X.totalRows:pe;return{status:"ready",columns:[...J],rows:Me,nextOffset:Ue,hasMore:Ke,totalRows:xe,samplingAdjustments:Array.isArray(Y.sampling_adjustments)?Y.sampling_adjustments:[],largeDataset:!!Y.large_dataset,error:null}})}).catch(Y=>{h(X=>({...X,status:"error",error:(Y==null?void 0:Y.message)??"Unable to load additional rows."}))})},[N,E,t,T,p,(F=e.data)==null?void 0:F.sample_rows,C]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),f&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${f.tone}`,role:"status","aria-live":f.isActive?"polite":"off",title:f.details.length>0?f.details.join(" "):void 0,children:f.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:x,children:b?"Refreshing":"Refresh"})})]}),f&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[f.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:f.details.map((K,se)=>a.jsx("li",{children:K},`${K}-${se}`))}),f.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>_(!w),"aria-expanded":w,children:[w?"":""," ",w?"Hide":"Show"," job details"]}),w&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:f.metadata.map((K,se)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:K.label}),a.jsx("dd",{children:K.value})]},`${K.label}-${K.value}-${se}`))})]})]}),b&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(tM,{preview:e.data,columns:$,rows:A,tableNote:W,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:(f==null?void 0:f.stepLabel)??null,fullExecutionWarnings:(f==null?void 0:f.warnings)??[]}),p.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:p.error}),R&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",i(Sc)," rows to stay responsive."]}),D.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:D.map((K,se)=>a.jsx("li",{children:K},`${K}-${se}`))})]}),T&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:U,disabled:P,children:P?"Loading rows":`Load next ${i(Sc)} rows`})}),!T&&!b&&L!==null&&z>=L&&z>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},Xl=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],sM=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:s,graphContext:l,profilingGraphSignature:i,formatRelativeTime:c})=>{var U;const[u,d]=v.useState({status:"idle",data:null,error:null}),[p,h]=v.useState(0),[f,g]=v.useState({}),[w,_]=v.useState("500"),[b,x]=v.useState("summary"),[N,E]=v.useState(!1),M=v.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${w}::${i}`,[t,e==null?void 0:e.id,i,w,n]),j=v.useMemo(()=>M?f[M]??null:null,[f,M]);v.useEffect(()=>{_("500"),d({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),v.useEffect(()=>{if(!t){d({status:"idle",data:null,error:null});return}if(!n){d({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!s){d({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(j){d({status:"success",data:j,error:null});return}let V=!0;d({status:"loading",data:null,error:null});const B=Xl.find(q=>q.value===w)??Xl[1]??Xl[0],G=B.value==="all"?"all":Number(B.value);return Kb(n,{sampleSize:G,graph:l,targetNodeId:(e==null?void 0:e.id)??null}).then(q=>{V&&(M&&q&&g(F=>({...F,[M]:q})),d({status:"success",data:q??null,error:null}))}).catch(q=>{V&&d({status:"error",data:null,error:(q==null?void 0:q.message)??"Unable to generate dataset profile"})}),()=>{V=!1}},[j,l,s,t,e==null?void 0:e.id,p,M,w,n]);const C=u.data,S=(C==null?void 0:C.generated_at)??null,$=((U=C==null?void 0:C.correlations)==null?void 0:U.length)??0;v.useEffect(()=>{E(!1),x("summary")},[t,S]),v.useEffect(()=>{b==="correlations"&&$===0&&x("summary")},[b,$]);const A=v.useCallback(()=>{M&&g(V=>{if(!Object.prototype.hasOwnProperty.call(V,M))return V;const B={...V};return delete B[M],B}),h(V=>V+1)},[M]),L=v.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),T=v.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),P=v.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),z=v.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),W=v.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),D=v.useMemo(()=>Xl.find(V=>V.value===w)??Xl[0],[w]),R=v.useMemo(()=>c((C==null?void 0:C.generated_at)??null),[c,C==null?void 0:C.generated_at]);return{profileState:u,profileData:C,profilingSamplePreset:w,setProfilingSamplePreset:_,profilingActiveTab:b,setProfilingActiveTab:x,isProfilingWarningsOpen:N,setIsProfilingWarningsOpen:E,handleRefreshDatasetProfile:A,activeProfilingSamplePreset:D,profilingWarningsListId:L,profilingSummaryPanelId:T,profilingCorrelationsPanelId:P,profilingSummaryTabId:z,profilingCorrelationsTabId:W,profilingCorrelationCount:$,relativeProfilingGeneratedAt:R}},rM=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:s,formatMissingPercentage:l})=>{if(!e)return null;const{profileState:i,profileData:c,profilingSamplePreset:u,setProfilingSamplePreset:d,profilingActiveTab:p,setProfilingActiveTab:h,isProfilingWarningsOpen:f,setIsProfilingWarningsOpen:g,handleRefreshDatasetProfile:w,activeProfilingSamplePreset:_,profilingWarningsListId:b,profilingSummaryPanelId:x,profilingCorrelationsPanelId:N,profilingSummaryTabId:E,profilingCorrelationsTabId:M,profilingCorrelationCount:j,relativeProfilingGeneratedAt:C}=t,S=i.status==="success"&&!!c;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:Xl.map($=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":$.value===u,onClick:()=>d($.value),disabled:i.status==="loading",children:$.label},$.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:w,disabled:i.status==="loading",children:i.status==="loading"?"Refreshing":"Refresh"})]})]}),C&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",C]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:_.label}),"."]}),i.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),i.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i.error}),S&&c&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",c.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",c.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",c.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",c.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",c.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:E,role:"tab","data-active":p==="summary","aria-selected":p==="summary","aria-controls":x,onClick:()=>h("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:M,role:"tab","data-active":p==="correlations","aria-selected":p==="correlations","aria-controls":N,onClick:()=>h("correlations"),disabled:!j,children:"Correlations"})]}),p==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:x,role:"tabpanel","aria-labelledby":E,children:[c.warnings&&c.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>g($=>!$),"aria-expanded":f,"aria-controls":b,children:f?"Hide warnings":`Show warnings (${c.warnings.length})`}),f&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:b,children:c.warnings.map(($,A)=>a.jsx("li",{children:$},`profiling-warning-${A}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:c.columns.map($=>{const A=$.numeric_summary,L=!!A,T=Array.isArray($.top_values)?$.top_values:[],P=Array.isArray($.sample_values)?$.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${$.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:$.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:$.semantic_type??$.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${l($.missing_percentage)} (${$.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:$.distinct_count!==null?$.distinct_count.toLocaleString():""})]})]}),L?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",s(A==null?void 0:A.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",s(A==null?void 0:A.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",s(A==null?void 0:A.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",s(A==null?void 0:A.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",s(A==null?void 0:A.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",s(A==null?void 0:A.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",s(A==null?void 0:A.percentile_75)]})]})]}):null,T.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:T.map((z,W)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(z.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[z.count.toLocaleString()," (",z.percentage.toFixed(1),"%)"]})]},`${$.name}-top-${W}`))})]}):null,P.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:P.slice(0,5).map((z,W)=>a.jsx("li",{children:n(z)},`${$.name}-sample-${W}`))})]}):null]},$.name)})})]}),p==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:N,role:"tabpanel","aria-labelledby":M,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),c.correlations&&c.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:c.correlations.map(($,A)=>{const L=Math.abs($.coefficient);let T="low";L>=.85?T="extreme":L>=.7?T="strong":L>=.55&&(T="moderate");const P=$.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:$.column_a}),a.jsx("td",{children:$.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":T,"data-sign":P,children:$.coefficient.toFixed(2)})]},`profile-correlation-${A}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},aM=({type:e})=>a.jsx("span",{"aria-hidden":"true",className:`canvas-modal__title-glyph${e==="dataset"?" canvas-modal__title-glyph--dataset":""}`,children:e==="dataset"?"":""}),oM=({title:e,isDataset:t,onClose:n,canResetNode:s=!1,onResetNode:l})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx(aM,{type:t?"dataset":"default"}),a.jsxs("div",{children:[a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e}),a.jsx("p",{className:"canvas-modal__subtitle",children:t?"Configure how this dataset feeds the pipeline.":"Adjust parameters to control this transformation."})]})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[s&&l&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,children:"Reset node"}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",children:""})]})]}),lM=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:s,canSave:l,onSave:i,isBusy:c,busyLabel:u})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsx("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":c,children:c&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:u??"Processing"})]})}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,children:"Reset node"}),s&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:i,disabled:!l,children:"Save changes"})]})]}),Ys=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),Gn=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},Es=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return Ys(t,n)},ix=e=>e==null||e===""?"":typeof e=="number"?Es(e):String(e),iM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},cM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},uM=5,dM=4,mM=3,hM="_binned",cx="Missing",fM=5,pM="ordinal",gM="quantile",_M=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],vM=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],zp={equal_width:"Equal-width",equal_frequency:"Equal-frequency",custom:"Custom edges",kbins:"KBins (sklearn)"},yM=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],Ec=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],ux=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",s=Ve(e==null?void 0:e.columns),l=(R,U,V,B)=>{const G=Number(R);if(!Number.isFinite(G))return U;const q=Math.round(G);return Math.max(V,Math.min(B,q))},i=l(e==null?void 0:e.equal_width_bins,uM,2,200),c=l(e==null?void 0:e.equal_frequency_bins,dM,2,200),u=l(e==null?void 0:e.precision,mM,0,8),d=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",p=!!((e==null?void 0:e.include_lowest)??!0),h=!!((e==null?void 0:e.drop_original)??!1),g=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||hM,w=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",_=["range","bin_index","ordinal","column_suffix"].includes(w)?w:"range",x=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",N=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",E=x==="label"&&N||cx,M=l(e==null?void 0:e.kbins_n_bins,fM,2,200),j=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",C=["ordinal","onehot","onehot-dense"].includes(j)?j:pM,S=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",$=["uniform","quantile","kmeans"].includes(S)?S:gM,A=R=>{if(!Array.isArray(R))return[];const V=R.map(B=>{if(typeof B=="number")return B;if(B==null)return Number.NaN;const G=String(B).trim();return G?Number(G):Number.NaN}).filter(B=>Number.isFinite(B)).sort((B,G)=>B-G).filter((B,G,q)=>G===0||B!==q[G-1]);return V.length>=2?V:[]},L=R=>Array.isArray(R)?R.map(U=>String(U).trim()).filter(Boolean):typeof R=="string"?R.split(/[\,\n]/).map(U=>U.trim()).filter(Boolean):[],T=(R,U,V)=>{if(R==null)return null;const B=Number(R);if(!Number.isFinite(B))return null;const G=Math.round(B);return Math.max(U,Math.min(V,G))},P={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([R,U])=>{const V=String(R??"").trim();if(!V)return;const B=A(U);B.length>=2&&(P[V]=B)});const z={};e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([R,U])=>{const V=String(R??"").trim();if(!V)return;const B=L(U);B.length&&(z[V]=B)});const W={},D=e!=null&&e.column_strategies&&typeof e.column_strategies=="object"&&!Array.isArray(e.column_strategies)?e.column_strategies:e!=null&&e.column_overrides&&typeof e.column_overrides=="object"&&!Array.isArray(e.column_overrides)?e.column_overrides:null;return D&&Object.entries(D).forEach(([R,U])=>{const V=String(R??"").trim();if(!V||!U||typeof U!="object"||Array.isArray(U))return;const B=U,G={},q=typeof B.strategy=="string"?B.strategy.trim().toLowerCase():"";["equal_width","equal_frequency","custom","kbins"].includes(q)&&(G.strategy=q);const F=T(B.equal_width_bins,2,200);F!==null&&(G.equalWidthBins=F);const K=T(B.equal_frequency_bins,2,200);K!==null&&(G.equalFrequencyBins=K);const se=T(B.kbins_n_bins,2,200);se!==null&&(G.kbinsNBins=se);const Q=typeof B.kbins_encode=="string"?B.kbins_encode.trim().toLowerCase():"";["ordinal","onehot","onehot-dense"].includes(Q)&&(G.kbinsEncode=Q);const H=typeof B.kbins_strategy=="string"?B.kbins_strategy.trim().toLowerCase():"";["uniform","quantile","kmeans"].includes(H)&&(G.kbinsStrategy=H);const Y=A(B.custom_bins);Y.length>=2&&(G.customBins=Y);const X=L(B.custom_labels);X.length>0&&(G.customLabels=X),Object.keys(G).length>0&&(W[V]=G)}),{strategy:n,columns:s,equalWidthBins:i,equalFrequencyBins:c,includeLowest:p,precision:u,duplicates:d,outputSuffix:g,dropOriginal:h,labelFormat:_,missingStrategy:x,missingLabel:E,customBins:P,customLabels:z,columnStrategies:W,kbinsNBins:M,kbinsEncode:C,kbinsStrategy:$}},bM=(e,t,n,s=zp)=>{if(!e.length)return null;const l=e.map(i=>{const c=t[i],u=(c==null?void 0:c.strategy)??null;if(!u)return i;const d=s[u]??u,p=[];u==="equal_width"&&(c!=null&&c.equalWidthBins)?p.push(`${c.equalWidthBins} bins`):u==="equal_frequency"&&(c!=null&&c.equalFrequencyBins)?p.push(`${c.equalFrequencyBins} bins`):u==="kbins"&&(c!=null&&c.kbinsNBins&&p.push(`${c.kbinsNBins} bins`),c!=null&&c.kbinsStrategy&&p.push(c.kbinsStrategy),c!=null&&c.kbinsEncode&&p.push(c.kbinsEncode));const h=p.length?` (${p.join(", ")})`:"";return`${i} -> ${d}${h}`});return n>e.length&&l.push(""),l.join(", ")},xM=({config:e,fieldIds:t,onIntegerChange:n,onBooleanToggle:s,onSuffixChange:l,onLabelFormatChange:i,onMissingStrategyChange:c,onMissingLabelChange:u})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Global output & labeling"}),a.jsx("p",{className:"canvas-modal__note",children:"Applies to every selected column unless custom bins or labels override the defaults."}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.suffix,className:"canvas-modal__parameter-label",children:"Output suffix"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.suffix,type:"text",className:"canvas-modal__input",value:e.outputSuffix,onChange:d=>l(d.target.value),placeholder:"e.g. _binned"})})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.labelFormat,className:"canvas-modal__parameter-label",children:"Label format"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:t.labelFormat,value:e.labelFormat,onChange:d=>i(d.target.value??"range"),children:vM.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Controls how new bin values are named when custom labels arent provided."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.precision,className:"canvas-modal__parameter-label",children:"Decimal precision"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.precision,type:"number",className:"canvas-modal__input",min:0,max:8,step:1,value:e.precision,onChange:d=>n("precision",d.target.value,0,8)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Sets rounding precision for interval labels."})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.includeLowest,children:"Include lowest edge"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.includeLowest,type:"checkbox",checked:e.includeLowest,onChange:d=>s("include_lowest",d.target.checked)}),"Include the minimum value in the first bin"]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.dropOriginal,children:"Drop original columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.dropOriginal,type:"checkbox",checked:e.dropOriginal,onChange:d=>s("drop_original",d.target.checked)}),"Remove source columns after binning"]})]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:yM.map(d=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===d.value,onClick:()=>c(d.value),children:d.label},d.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:d=>u(d.target.value),placeholder:"e.g. Missing"})})]})]})]}),dx=e=>zp[e]??e.replace(/_/g," "),wM=e=>{switch(e){case"high":return"High confidence";case"medium":return"Medium confidence";case"low":return"Low confidence";default:return"Confidence unknown"}},jM=(e,t,n)=>{if(!e||typeof e!="object")return"No distribution summary";const s=[];typeof e.valid_count=="number"&&Number.isFinite(e.valid_count)&&s.push(`${t(e.valid_count)} valid rows`),typeof e.distinct_count=="number"&&Number.isFinite(e.distinct_count)&&s.push(`${t(e.distinct_count)} distinct values`);const l=typeof e.minimum=="number"&&Number.isFinite(e.minimum),i=typeof e.maximum=="number"&&Number.isFinite(e.maximum);if(l||i){const c=l?n(e.minimum):"",u=i?n(e.maximum):"";s.push(`Range ${c}  ${u}`)}return typeof e.skewness=="number"&&Number.isFinite(e.skewness)&&s.push(`Skew ${n(e.skewness)}`),s.length?s.join("  "):"No distribution summary"},NM=({hasSource:e,hasReachableSource:t,isFetching:n,error:s,relativeGeneratedAt:l,sampleSize:i,binningConfig:c,binningDefaultLabel:u,binningOverrideCount:d,binningOverrideSummary:p,recommendations:h,excludedColumns:f,numericColumnCount:g,canApplyAllNumeric:w,onApplyAllNumeric:_,onApplyStrategies:b,onClearOverrides:x,customEdgeDrafts:N,customLabelDrafts:E,onOverrideStrategyChange:M,onOverrideNumberChange:j,onOverrideKbinsEncodeChange:C,onOverrideKbinsStrategyChange:S,onOverrideClear:$,onCustomBinsChange:A,onCustomLabelsChange:L,onClearCustomColumn:T,formatMetricValue:P,formatNumericStat:z})=>{const W=v.useMemo(()=>e?t?n?"Diagnostics are loading":s?"Diagnostics are unavailable at the moment.":g>0?`Detected ${g} numeric column${g===1?"":"s"} in the current sample.`:f.length>0?`Diagnostics skipped ${f.length} column${f.length===1?"":"s"} (see details).`:"No additional diagnostics were produced for the current sample.":"Connect this step to an upstream output to surface diagnostics.":"Select a dataset to surface diagnostics.",[s,f.length,t,e,n,g]),D=v.useMemo(()=>{const q=f.slice(0,6),F=Math.max(0,f.length-q.length);return{preview:q,remaining:F}},[f]),R=v.useMemo(()=>{const q=new Map;return h.forEach(F=>{const K=typeof(F==null?void 0:F.column)=="string"?F.column.trim():"";K&&q.set(K,F)}),q},[h]),U=v.useMemo(()=>{const q=new Set;return c.columns.forEach(F=>{const K=String(F??"").trim();K&&q.add(K)}),Object.keys(c.columnStrategies).forEach(F=>{const K=String(F??"").trim();K&&q.add(K)}),h.forEach(F=>{const K=typeof(F==null?void 0:F.column)=="string"?F.column.trim():"";K&&q.add(K)}),Array.from(q).sort((F,K)=>F.localeCompare(K))},[c.columnStrategies,c.columns,h]),V=(q,F)=>{var K;return!q||Object.keys(q).length===0?"__default__":q.strategy?q.strategy:(K=q.customBins)!=null&&K.length?"custom":q.kbinsNBins||q.kbinsEncode||q.kbinsStrategy?"kbins":q.equalFrequencyBins?"equal_frequency":q.equalWidthBins?"equal_width":F},B=e&&t,G=q=>{var K,se;if(!q)return[];const F=[];return typeof q.equalWidthBins=="number"&&F.push(`${q.equalWidthBins} bins`),typeof q.equalFrequencyBins=="number"&&F.push(`${q.equalFrequencyBins} bins`),typeof q.kbinsNBins=="number"&&F.push(`${q.kbinsNBins} bins`),q.kbinsStrategy&&F.push(q.kbinsStrategy),q.kbinsEncode&&F.push(q.kbinsEncode),(K=q.customBins)!=null&&K.length&&F.push("Custom bins"),(se=q.customLabels)!=null&&se.length&&F.push("Custom labels"),F};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binning diagnostics"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:x,disabled:!d,children:"Clear"}),b&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:b,disabled:!h.length,children:"Quick apply"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:W}),a.jsxs("p",{className:"canvas-modal__note",children:["Default strategy ",a.jsx("strong",{children:u}),d>0?`  Overrides: ${d}${p?` (${p})`:""}`:"  No column overrides yet"]}),a.jsxs("div",{className:"canvas-modal__collapsible",children:[!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface binning insights and column diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),B&&a.jsxs(a.Fragment,{children:[l&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",l,i!==null?` on ${P(i)} row${i===1?"":"s"}.`:"."]}),_&&g>0&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:_,disabled:!w,children:`Add all numeric columns (${g})`})}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binning diagnostics"}),s&&!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s}),!s&&a.jsxs(a.Fragment,{children:[U.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested strategy"}),a.jsx("th",{scope:"col",children:"Configured strategy"}),a.jsx("th",{scope:"col",children:"Distribution highlights"})]})}),a.jsx("tbody",{children:U.map(q=>{var mt,Ze,ot,Et,zt;const F=R.get(q)??null,K=c.columnStrategies[q],se=V(K,c.strategy),Q=se==="__default__"?c.strategy:se,H=(F==null?void 0:F.recommended_strategy)??null,Y=!!(H&&H!==Q),X=!!(K&&Object.keys(K).length),ee=c.columns.includes(q),J=F==null?void 0:F.recommended_bins,re=typeof J=="number"?J:J!=null?Number(J):null,we=typeof re=="number"&&Number.isFinite(re)&&re>0?re:null,Pe=(K==null?void 0:K.equalWidthBins)??c.equalWidthBins,Me=(K==null?void 0:K.equalFrequencyBins)??c.equalFrequencyBins,Fe=(K==null?void 0:K.kbinsNBins)??c.kbinsNBins,Ke=(K==null?void 0:K.kbinsEncode)??"__default__",Ue=(K==null?void 0:K.kbinsStrategy)??"__default__",de=["canvas-cast__row"];Y&&de.push("canvas-cast__row--attention"),X&&de.push("canvas-cast__row--override"),ee||de.push("canvas-cast__row--muted");const pe=jM(F==null?void 0:F.stats,P,z),xe=((mt=F==null?void 0:F.reasons)==null?void 0:mt.filter(We=>We&&We.trim()))??[],ke=(()=>{const We=G(K),Dt=Array.isArray(c.customBins[q])?c.customBins[q].length>=2:!1,ht=Array.isArray(c.customLabels[q])?c.customLabels[q].length>0:!1,kt=[...We];return Dt&&!kt.includes("Custom bins")&&kt.push("Custom bins"),ht&&!kt.includes("Custom labels")&&kt.push("Custom labels"),kt})(),De=se==="__default__"?`Inheriting ${u}`:`Override  ${dx(Q)}${ke.length?` (${ke.join(", ")})`:""}`,ce=(F==null?void 0:F.dtype)??null,Oe=F?wM(F.confidence):null,Ye=Object.prototype.hasOwnProperty.call(N,q)?N[q]:((Ze=c.customBins[q])==null?void 0:Ze.join(", "))??"",ct=Object.prototype.hasOwnProperty.call(E,q)?E[q]:((ot=c.customLabels[q])==null?void 0:ot.join(", "))??"",Je=(((Et=c.customBins[q])==null?void 0:Et.length)??0)>=2||(((zt=c.customLabels[q])==null?void 0:zt.length)??0)>0;return a.jsxs("tr",{className:de.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:q}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[ce&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",ce]}),!ee&&a.jsx("span",{className:"canvas-cast__muted",children:"Not currently in node"}),X&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),Y&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--attention",children:"Needs review"})]})]})}),a.jsx("td",{children:a.jsx("div",{className:"canvas-cast__recommendation",children:F?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-cast__chip canvas-cast__chip--applied",children:dx(F.recommended_strategy)}),a.jsxs("span",{className:"canvas-cast__recommendation-note",children:[we!==null?`${we} bin${we===1?"":"s"}`:"Bins not provided",Oe?`  ${Oe}`:""]}),xe.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:xe.join("; ")})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:se,onChange:We=>M(q,We.target.value,{recommendedBins:we}),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",u,")"]}),_M.map(We=>a.jsx("option",{value:We.value,children:We.label},`${q}-${We.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:De}),se==="equal_width"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Pe??"",onChange:We=>j(q,"equal_width_bins",We.target.value)})]})}),se==="equal_frequency"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Me??"",onChange:We=>j(q,"equal_frequency_bins",We.target.value)})]})}),se==="kbins"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Max bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Fe??"",onChange:We=>j(q,"kbins_n_bins",We.target.value)})]}),a.jsxs("label",{children:["Encode",a.jsxs("select",{value:Ke,onChange:We=>C(q,We.target.value==="__default__"?null:We.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsEncode,")"]}),a.jsx("option",{value:"ordinal",children:"Ordinal"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})]}),a.jsxs("label",{children:["Strategy",a.jsxs("select",{value:Ue,onChange:We=>S(q,We.target.value==="__default__"?null:We.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsStrategy,")"]}),a.jsx("option",{value:"uniform",children:"Uniform"}),a.jsx("option",{value:"quantile",children:"Quantile"}),a.jsx("option",{value:"kmeans",children:"K-means"})]})]})]}),se==="custom"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Custom edges",a.jsx("input",{type:"text",className:"canvas-modal__input",value:Ye,placeholder:"e.g. 0, 50, 100",onChange:We=>A(q,We.target.value)})]}),a.jsxs("label",{children:["Optional labels",a.jsx("input",{type:"text",className:"canvas-modal__input",value:ct,placeholder:"e.g. Low, Medium, High",onChange:We=>L(q,We.target.value)})]}),Je&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>T(q),children:"Clear custom edges"})]}),X&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>$(q),children:"Clear"})]})}),a.jsx("td",{children:a.jsx("span",{children:pe})})]},`binning-insight-${q}`)})})]})})}),!n&&U.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"No columns met the sampling requirements for binning recommendations."}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",f.length," column",f.length===1?"":"s"," due to non-numeric values or limited variance",D.preview.length>0&&a.jsxs(a.Fragment,{children:[":"," ",D.preview.map(q=>`${q.column}${q.reason?` (${q.reason})`:""}`).join(", "),D.remaining>0?`,  (+${D.remaining} more)`:""]}),"."]})]})]})]})]})},CM=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:s,sampleSize:l,relativeGeneratedAt:i,error:c,onRefresh:u,canRefresh:d})=>{const p=v.useMemo(()=>Ec.find(h=>h.value===t)??Ec[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:Ec.map(h=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":h.value===t,onClick:()=>n(h.value),disabled:s,children:h.label},h.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:u,disabled:s||!d,children:s?"Refreshing":"Refresh"})]})]}),l!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:p.label}),"."," ",p.value==="all"?`Summaries computed from the full dataset (${l.toLocaleString()} rows).`:`Summaries computed from ${l.toLocaleString()} sampled rows.`]}),i&&a.jsxs("p",{className:"canvas-modal__note",children:["Updated ",i]}),s&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!s&&c&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:c}),!s&&!c&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(h=>{const f=h.topPercentage!==null?`${h.topPercentage.toFixed(1)}%`:null,g=h.topCount!==null?`${h.topCount.toLocaleString()}${f?`  ${f}`:""}`:f??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:h.column}),h.sourceColumn&&h.sourceColumn!==h.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:h.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:h.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:g})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:h.bins.map(w=>{const _=w.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",b=Math.min(100,Math.max(0,w.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:_,children:w.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${b}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:w.count.toLocaleString()}),a.jsxs("span",{children:[w.percentage.toFixed(1),"%"]})]})]},`${h.column}-${w.label}`)})}),h.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",h.bins.length," of ",h.totalBinCount," bins."]})]},`binned-card-${h.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},SM=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],EM=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],kM=[...SM,...EM],MM=[0,5,10,20,40,60],AM=["float","double","int","uint","long","short","byte","number","decimal"],OM=["bool","boolean"],PM=["object","string","category","datetime","date","time"],TM=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:PM.some(n=>t.includes(n))?!1:!!(AM.some(n=>t.includes(n))||OM.some(n=>t.includes(n)))},mx=e=>e!=="mode",hx=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},kc=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,s=Number(n);return{neighbors:Number.isFinite(s)?Math.max(1,Math.round(s)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,s=Number(n);return{max_iter:Number.isFinite(s)?Math.max(1,Math.round(s)):10}}},fx=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",s=new Set(t);return e.map(l=>{if(!l||typeof l!="object")return null;const i=typeof l.method=="string"?l.method.trim().toLowerCase():n,c=s.has(i)?i:n;let u=[];Array.isArray(l.columns)?u=l.columns.map(f=>String(f).trim()).filter(Boolean):typeof l.columns=="string"&&(u=l.columns.split(",").map(f=>f.trim()).filter(Boolean));const d=l.options&&typeof l.options=="object"?l.options:{};let p;if(c==="knn"){const f=d.neighbors??l.neighbors,g=Number(f);p={neighbors:Number.isFinite(g)?Math.max(1,Math.round(g)):5}}else if(c==="regression"||c==="mice"){const f=d.max_iter??d.maxIter??l.max_iter??l.maxIter,g=Number(f);p={max_iter:Number.isFinite(g)?Math.max(1,Math.round(g)):10}}const h=kc(c,p??hx(c));return{method:c,columns:u,options:h}}).filter(l=>!!l)},$M=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),LM=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:s,methodOptions:l,missingFilter:i,missingFilterMax:c,missingFilterActive:u,filteredOptionCount:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onMethodChange:w,onOptionNumberChange:_,onColumnsChange:b,onColumnToggle:x,onMissingFilterChange:N,formatMissingPercentage:E,formatNumericStat:M,formatModeStat:j,schemaDiagnostics:C})=>{const S=ge.useMemo(()=>{var T;return(T=C==null?void 0:C.entries)!=null&&T.length?new Map(C.entries.map(P=>[P.index,P])):new Map},[C]),$=Math.max(c,i||0),A=s.length>0,L=T=>{var z,W,D;const P=((z=l.find(R=>R.value===T.method))==null?void 0:z.label)??T.method;return T.method==="knn"&&((W=T.options)!=null&&W.neighbors)?`${P}  k=${T.options.neighbors}`:(T.method==="regression"||T.method==="mice")&&((D=T.options)!=null&&D.max_iter)?`${P}  ${T.options.max_iter} iter`:P};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(C==null?void 0:C.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:C.message}),s.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",d," of ",s.length," column",s.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx("input",{id:"imputer-missing-filter",type:"range",min:0,max:$,step:1,value:i,onChange:T=>N(Number(T.target.value)),className:"canvas-imputer__filter-range"}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[i,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>N(0),disabled:!i,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:MM.map(T=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${i===T?" canvas-imputer__filter-button--active":""}`,onClick:()=>N(T),children:["",T,"%"]},`imputer-missing-preset-${T}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map((T,P)=>{var K,se,Q;const z=T.columns.join(", "),W=mx(T.method),D=s.filter(H=>{if(T.columns.includes(H.name))return!0;if(W&&!TM(H))return!1;const Y=typeof H.missingPercentage=="number"?H.missingPercentage:null;return Y!==null?Y<=0?!1:Y>=i:i===0}),R=L(T),U=T.columns.length?`${T.columns.length} column${T.columns.length===1?"":"s"}`:"No columns yet",V=p.has(P),B=D.filter(H=>!T.columns.includes(H.name)),G=S.get(P),q=(K=G==null?void 0:G.details)!=null&&K.length?G.details.map(H=>H.logical_family?`${H.name} (${H.logical_family})`:H.name).join(", "):"",F=()=>{if(!D.length)return;const H=[...T.columns];D.forEach(Y=>{H.includes(Y.name)||H.push(Y.name)}),b(P,H.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(P),"aria-expanded":!V,"aria-controls":`imputer-strategy-body-${P}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${V?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",P+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[R,"  ",U]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(P),"aria-label":`Remove strategy ${P+1}`,children:"Remove"})]}),!V&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${P}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Method"}),a.jsx("select",{value:T.method,onChange:H=>w(P,H.target.value??"mean"),children:l.map(H=>a.jsx("option",{value:H.value,children:H.label},H.value))})]}),T.method==="knn"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Neighbors (k)"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:50,step:1,value:((se=T.options)==null?void 0:se.neighbors)??5,onChange:H=>_(P,"neighbors",H.target.value)})]}),(T.method==="regression"||T.method==="mice")&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Max iterations"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:100,step:1,value:((Q=T.options)==null?void 0:Q.max_iter)??10,onChange:H=>_(P,"max_iter",H.target.value)})]}),T.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),q&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",q,"."]}),D.length>0&&B.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:F,children:"Select all columns"}),D.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:D.map(H=>{const Y=T.columns.includes(H.name),X=E(H.missingPercentage),ee=typeof H.mean=="number",J=typeof H.median=="number",re=H.mode!==null&&H.mode!==void 0&&H.mode!=="",we=ee||J||re;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Y?" canvas-imputer__column-pill--selected":""}`,onClick:()=>x(P,H.name),"aria-pressed":Y,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:H.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",X]}),H.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:H.dtype})]}),we&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[ee&&a.jsxs("span",{children:["Mean: ",M(H.mean)]}),J&&a.jsxs("span",{children:["Median: ",M(H.median)]}),re&&a.jsxs("span",{children:["Mode: ",j(H.mode)]})]})]},H.name)})}):a.jsx("p",{className:"canvas-modal__note",children:A?u?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${T.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:T.columns.length?T.columns.map(H=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:H},H)):a.jsx("span",{children:"No columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Manual columns (optional)"}),a.jsx("input",{type:"text",className:"canvas-imputer__columns-input",value:z,onChange:H=>b(P,H.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${P}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},zM=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:s,scalingMethodOptions:l,scalingMethodDetailMap:i,scalingDefaultDetail:c,scalingAutoDetectEnabled:u,scalingSelectedCount:d,scalingDefaultLabel:p,scalingOverrideCount:h,scalingOverrideExampleSummary:f,scalingRecommendationRows:g,scalingHasRecommendations:w,scalingStatusMessage:_,scalingError:b,scalingSampleSize:x,relativeScalingGeneratedAt:N,formatMetricValue:E,formatNumericStat:M,formatMissingPercentage:j,onApplyAllRecommendations:C,onClearOverrides:S,onDefaultMethodChange:$,onAutoDetectToggle:A,onOverrideSelect:L})=>{const T=c??i.get(s.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:C,disabled:!w,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:S,disabled:!h,children:"Clear overrides"})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),N&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",N,x!==null?` on ${E(x)} row${x===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:l.map(P=>{const z=i.get(P.value)??null,W=P.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${W?" canvas-scaling__method-button--active":""}`,"aria-pressed":W,onClick:()=>$(P.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:P.label}),(z==null?void 0:z.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:z.description})]},P.value)})}),(T==null?void 0:T.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:T.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:P=>A(P.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"When enabled, recommended numeric features join this node automatically after each refresh."})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",h>0?`  Overrides: ${h}${f?` (${f})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&b&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:b}),!n&&!b&&a.jsxs(a.Fragment,{children:[_&&a.jsx("p",{className:"canvas-modal__note",children:_}),g.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:g.map(P=>{const z=!P.isSkipped&&P.recommendedMethod!==P.currentMethod,W=["canvas-cast__row"];z&&W.push("canvas-cast__row--attention"),P.isOverrideApplied&&W.push("canvas-cast__row--override"),P.isSkipped&&W.push("canvas-cast__row--muted");const D=P.isSkipped?"__skip__":P.isOverrideApplied?P.currentMethod:"__default__",R=P.isOverrideApplied?`Override -> ${P.currentMethodLabel}`:P.isSkipped?"Skipped (column will not be scaled)":P.isSelected?`Inheriting ${p}`:"Pending inclusion",U=P.stats,V=[];typeof U.valid_count=="number"&&Number.isFinite(U.valid_count)&&V.push(`${E(U.valid_count)} valid rows`),typeof U.mean=="number"&&Number.isFinite(U.mean)&&V.push(`Mean ${M(U.mean)}`),typeof U.median=="number"&&Number.isFinite(U.median)&&V.push(`Median ${M(U.median)}`),typeof U.stddev=="number"&&Number.isFinite(U.stddev)&&V.push(` ${M(U.stddev)}`),typeof U.iqr=="number"&&Number.isFinite(U.iqr)&&V.push(`IQR ${M(U.iqr)}`);const B=typeof U.minimum=="number"&&Number.isFinite(U.minimum),G=typeof U.maximum=="number"&&Number.isFinite(U.maximum);if(B||G){const F=B?M(U.minimum):"",K=G?M(U.maximum):"";V.push(`Range ${F}  ${K}`)}typeof U.skewness=="number"&&Number.isFinite(U.skewness)&&V.push(`Skew ${M(U.skewness)}`),typeof U.outlier_ratio=="number"&&Number.isFinite(U.outlier_ratio)&&U.outlier_ratio>0&&V.push(`${j(U.outlier_ratio*100)} outliers`);const q=V.length?V.join("  "):null;return a.jsxs("tr",{className:W.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:P.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[P.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",P.dtype]}),P.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),P.isSelected&&!P.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),P.isSkipped&&!P.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),P.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${z?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:P.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:P.confidenceLabel}),P.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:P.reasons.join("; ")})]})}),a.jsx("td",{children:q?a.jsx("span",{children:q}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:D,onChange:F=>L(P.column,F.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),l.map(F=>a.jsx("option",{value:F.value,children:F.label},`${P.column}-${F.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:R})]})})]},`scaling-row-${P.column}`)})})]})})})]})]})},im=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],DM="log",ea=e=>typeof e=="string"&&im.includes(e),px=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",s=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const l=ea(s)?s:DM;return{column:n,method:l}}).filter(t=>!!t):[],Dp=e=>{const t=new Set,n=[];return e.forEach(s=>{const l=`${s.column}__${s.method}`;t.has(l)||(t.add(l),n.push(s))}),n},gx={left:"Left skew",right:"Right skew"},RM={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},FM=e=>{const t={...RM};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!s||!l||ea(s)&&(t[s]=l)}),t},IM=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:s,transformationMap:l})=>{const i=e==="recommended"?t.map(d=>d!=null&&d.column?d.column:null).filter(d=>!!d):n,c=new Set,u=[];return i.forEach(d=>{const p=typeof d=="string"?d.trim():"";if(!p||c.has(p))return;c.add(p);const h=s.get(p)??null,f=h?h.recommended_methods.filter(ea):[],g=f.length?f[0]:null,w=h!=null&&h.direction?gx[h.direction]??h.direction:null,_=h!=null&&h.magnitude?`${h.magnitude.charAt(0).toUpperCase()}${h.magnitude.slice(1)}`:null,b=h&&typeof h.skewness=="number"&&Number.isFinite(h.skewness)?h.skewness:null,x=(h==null?void 0:h.summary)??null,N=l.get(p)??null;u.push({column:p,recommendedMethods:f,primaryMethod:g,directionLabel:w,magnitudeLabel:_,skewnessValue:b,summary:x,selectedMethod:N})}),u.sort((d,p)=>{const h=typeof d.skewnessValue=="number"?Math.abs(d.skewnessValue):-1/0,f=typeof p.skewnessValue=="number"?Math.abs(p.skewnessValue):-1/0;if(h!==f)return f-h;const g=!!d.primaryMethod,w=!!p.primaryMethod;return g!==w?g?-1:1:d.column.localeCompare(p.column)}),u},BM=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const s="no-recommendation",l=new Map;e.forEach(c=>{const u=c.primaryMethod??null,d=u??s,p=u?n(u):"No recommended action",h=l.get(d)??{key:d,label:p,method:u,rows:[]};h.rows.push(c),l.set(d,h)});const i=Array.from(l.values());return i.sort((c,u)=>{const d=g=>g?im.indexOf(g):im.length,p=d(c.method)-d(u.method);if(p!==0)return p;if(c.rows.length!==u.rows.length)return u.rows.length-c.rows.length;const h=c.label??"",f=u.label??"";return h.localeCompare(f)}),i},UM=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:s,skewnessError:l,skewnessViewMode:i,skewnessRecommendedCount:c,skewnessNumericCount:u,skewnessGroupByMethod:d,skewnessRows:p,skewnessTableGroups:h,hasSkewnessAutoRecommendations:f,skewnessTransformationsCount:g,isFetchingRecommendations:w,getSkewnessMethodLabel:_,getSkewnessMethodStatus:b,onApplyRecommendations:x,onViewModeChange:N,onGroupByToggle:E,onOverrideChange:M,onClearSelections:j})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:x,disabled:w||!f,children:"Apply recommendations"})})]}),s!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",s.toFixed(2)," are surfaced below."]}),n&&p.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&l&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l}),(!n||p.length>0)&&!l&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="recommended",onClick:()=>N("recommended"),disabled:!c,children:["Recommended (",c,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="all",onClick:()=>N("all"),disabled:!u,children:["All numeric (",u,")"]})]}),a.jsxs("label",{className:"canvas-skewness__toggle",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:C=>E(C.target.checked)}),"Group columns by recommended action"]})]}),p.length===0?a.jsx("p",{className:"canvas-modal__note",children:i==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:h.map(C=>a.jsxs("div",{className:"canvas-skewness__group",children:[C.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:C.label}),a.jsxs("span",{children:[C.rows.length," column",C.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:C.rows.map(S=>{const $=[];S.directionLabel&&$.push(S.directionLabel),S.skewnessValue!==null&&$.push(`(${S.skewnessValue.toFixed(2)})`),S.magnitudeLabel&&$.push(` ${S.magnitudeLabel}`);const A=$.length?$.join(" "):"",L=S.selectedMethod??"",T=new Set(S.recommendedMethods),P=[{value:"",label:"No transform",status:null,reason:null}];S.recommendedMethods.forEach(D=>{const R=b(S.column,D);P.push({value:D,label:`${_(D)}${D===S.primaryMethod?" (recommended)":""}`,status:R,reason:(R==null?void 0:R.reason)??null})}),im.forEach(D=>{if(T.has(D))return;const R=b(S.column,D);P.push({value:D,label:_(D),status:R,reason:(R==null?void 0:R.reason)??null})});const z=S.selectedMethod?b(S.column,S.selectedMethod):null,W=!S.selectedMethod&&S.primaryMethod?b(S.column,S.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${S.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:S.column}),S.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:S.summary})]})}),a.jsx("td",{children:S.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${S.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:S.primaryMethod?_(S.primaryMethod):_(S.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:A})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx("select",{value:L,onChange:D=>M(S.column,D.target.value),disabled:w||!t,children:P.map(D=>{var V;const R=D.reason?`${D.label} (caution: ${D.reason})`:D.label,U=((V=D.status)==null?void 0:V.status)??"ready";return a.jsx("option",{value:D.value,"data-status":U,children:R},`skewness-option-${S.column}-${D.value||"none"}`)})}),z&&z.status!=="ready"&&z.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",z.reason]}),!S.selectedMethod&&W&&W.status!=="ready"&&W.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",W.reason]})]})})]},`skewness-row-${S.column}`)})})]})})]},`skewness-group-${C.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:g?`${g} transformation${g===1?"":"s"} configured`:"No transformations configured yet."}),g>0&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:j,children:"Clear selections"})]})]})]}),qM=({counts:e,binEdges:t,className:n})=>{const s=v.useId(),l=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:l,"aria-hidden":"true"});const i=e.reduce((d,p)=>Math.max(d,p),0),c=i>0?i:1,u=100/e.length;return a.jsx("div",{className:l,role:"img","aria-label":"Histogram sparkline",children:a.jsxs("svg",{viewBox:"0 0 100 60",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((d,p)=>{const h=d/c*52,f=p*u,g=58-h,w=Math.max(u-2,1);return a.jsx("rect",{x:f+1,y:g,width:w,height:h,rx:1.2,ry:1.2,fill:`url(#${s})`},`hist-bin-${p}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},HM=({skewnessThreshold:e,isFetchingSkewness:t,skewnessError:n,skewnessDistributionCards:s,skewnessDistributionView:l,setSkewnessDistributionView:i,onRefresh:c,canRefresh:u})=>{const d=(p,h,f)=>{const g=Math.max(0,p.sample_size||0),w=Math.max(0,p.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:h}),f?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:f}):null]}),a.jsx(qM,{counts:p.counts,binEdges:p.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Es(p.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Es(p.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Es(p.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Es(p.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Es(p.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:g.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:w.toLocaleString()})]})]})]},h)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="before",onClick:()=>i("before"),disabled:!s.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="after",onClick:()=>i("after"),disabled:!s.length,children:"After"})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:c,disabled:t||!u,children:t?"Refreshing":"Refresh"})]})]}),e!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",e.toFixed(2)," are visualized below."]}),t&&s.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!t&&n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n}),(!t||s.length>0)&&!n&&(s.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:s.map(p=>{const h=p.distributionAfter,f=l==="before",g=l==="after"&&!!h,w=l==="after"&&!h,_=l==="before"?"Showing the original distribution returned by the skewness analysis.":h?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${p.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:p.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[p.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.directionLabel}),p.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.magnitudeLabel}),p.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",p.recommendedLabel]}),p.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",p.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:p.skewness!==null?Ys(p.skewness,2):""})]})]}),p.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:p.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[f?d(p.distributionBefore,"Before transform"):null,g&&h?d(h,"After transform",p.appliedLabel):null,w?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",_]})]},`skewness-dist-${p.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]})},VM=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:s,flaggedColumnsInDataset:l,conflictCount:i}=t,c=s.length>0,u=e||"(no suffix)",d=l.slice(0,4),p=Math.max(l.length-d.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:s.length})," flag column",s.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:u}),"."]}),l.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",l.length," existing flag column",l.length===1?"":"s"," ","with this suffix",d.length>0?` (examples: ${d.join(", ")}${p>0?", ":""})`:"","."]}),i>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i," generated flag column",i===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),c?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:s.map(h=>{const f=[];h.conflicts.alreadyExists&&f.push("Already exists"),h.conflicts.duplicateFlag&&f.push("Duplicate name");const g=f.length>0,w=g?f.join("  "):"Ready",_=g?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",b=g?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:b,children:[a.jsx("th",{scope:"row",children:h.column}),a.jsx("td",{children:n(h.missingPercentage)}),a.jsx("td",{children:h.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:_,children:w})})]},`missing-indicator-${h.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},_x=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],Rp="canonicalize_country_codes",WM=new Set(_x),KM=["string","object","text","category","mixed","varchar","char"],YM=4,GM=6,Ro=4,QM=3,vx=36,XM=5,Fp={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},yx=_x.map(e=>{var t;return{value:e,label:((t=Fp[e])==null?void 0:t.label)??e}}),JM=new Set(["true","1","yes","y","on"]),ZM=new Set(["false","0","no","n","off"]),eA=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(JM.has(n))return!0;if(ZM.has(n))return!1}return t},Ip=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Ip(e.split(",")):[],bx=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,s=Ip(n.columns),l=eA(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),i=um(typeof n.mode=="string"?n.mode:void 0,t.mode);return!s.length&&!l?null:{mode:i,columns:s,autoDetect:l}},xx=(e,t)=>{const n={mode:t.mode,columns:Ip(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const l=bx(e,n);return l?[l]:[n]}const s=[];return e.forEach(l=>{const i=bx(l,n);i&&s.push(i)}),s.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):s},tA=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),nA=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),cm=e=>e.length<=vx?e:`${e.slice(0,vx-1)}...`,wx=e=>WM.has(e),jx=e=>{if(!e)return!1;const t=e.toLowerCase();return KM.some(n=>t.includes(n))},um=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&wx(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&wx(s)?s:Rp},sA=e=>{const t=Fp[e]??Fp[Rp];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},rA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:s})=>{const l=Array.from(new Set(Ve(e))),i=new Set(l),c=t.filter(h=>jx(n[h]??null)),u=c.filter(h=>!i.has(h)),d=l.filter(h=>!jx(n[h]??null)),p=typeof s=="boolean"?s:l.length===0;return{selectedColumns:l,nonTextSelected:d,autoDetectionActive:p,recommendedColumns:u,textColumnCount:c.length,textColumns:c}},aA=/[\n;,]+/,Jl=(e,t)=>e.slice(0,t),dm=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[s,...l]=n,i=l.join(t);return[s,i]},oA=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],s=[],l=new Map;let i=0;const c=(h,f)=>{const g=String(h??"").trim(),w=String(f??"").trim();if(!g||!w){(g||w)&&n.push(`${g} => ${w}`.trim());return}const _=nA(g);if(!_){n.push(`${g} => ${w}`);return}l.has(_)?t.add(g):(l.set(_,w),s.length<YM&&s.push(`${g} => ${w}`)),i+=1};if(typeof e=="string"){e.split(aA).forEach(_=>{const b=_.trim();if(b){if(b.includes("=>")){const x=dm(b,"=>");x?c(x[0],x[1]):n.push(b);return}if(b.includes(":")){const x=dm(b,":");x?c(x[0],x[1]):n.push(b);return}n.push(b)}});const f=Array.from(t),g=Jl(f,Ro),w=Jl(n,Ro);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:g,duplicateOverflow:Math.max(f.length-g.length,0),invalidEntries:w,invalidOverflow:Math.max(n.length-w.length,0)}}if(Array.isArray(e)){e.forEach(w=>{if(w){if(typeof w=="string"){const _=w.trim();if(!_)return;if(_.includes("=>")){const b=dm(_,"=>");b?c(b[0],b[1]):n.push(_)}else if(_.includes(":")){const b=dm(_,":");b?c(b[0],b[1]):n.push(_)}else n.push(_);return}if(typeof w=="object"){const{alias:_,replacement:b}=w;c(_,b);return}n.push(String(w))}});const h=Array.from(t),f=Jl(h,Ro),g=Jl(n,Ro);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:f,duplicateOverflow:Math.max(h.length-f.length,0),invalidEntries:g,invalidOverflow:Math.max(n.length-g.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([h,f])=>{c(h,f)});const u=Array.from(t),d=Jl(u,Ro),p=Jl(n,Ro);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:d,duplicateOverflow:Math.max(u.length-d.length,0),invalidEntries:p,invalidOverflow:Math.max(n.length-p.length,0)}},lA=e=>{const t=e.slice(0,GM);return{preview:t,remaining:Math.max(e.length-t.length,0)}},iA=e=>{const t=e.slice(0,Ro);return{preview:t,remaining:Math.max(e.length-t.length,0)}},cA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?cm(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?cm(t):null}try{const t=JSON.stringify(e);return t?cm(t):null}catch{return cm(String(e))}},uA=(e,t=QM)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;const u=cA(i);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},dA=(e,t,n=XM)=>{if(!t.length)return[];const s=[];for(const l of t){if(s.length>=n)break;const i=e[l];!i||!i.length||s.push({column:l,values:i,overflow:0})}return s},Bp=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),Nx=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],Cx=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);Nx.forEach(e=>{e.forEach(t=>Cx.add(Bp(t)))});const Sx=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],Ex=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);Sx.forEach(e=>{e.forEach(t=>Ex.add(Bp(t)))});const mA=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],hA=/^[A-Za-z]{2,3}$/,fA=/[^0-9A-Za-z\s]/,pA=/[^0-9A-Za-z]+/,mm={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:Nx},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:Sx},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:mA},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},gA=e=>{const t=[];return e.forEach(n=>{n.split(pA).filter(Boolean).forEach(l=>{t.push(l)})}),t},_A=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(s=>fA.test(s));const n=gA(t).map(s=>Bp(s));return n.length?e==="canonicalize_country_codes"?n.some(s=>Cx.has(s))||t.some(s=>hA.test(s.trim())):e==="normalize_boolean"?n.some(s=>Ex.has(s)):!1:!1},kx=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},vA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:l,sampleMap:i,modeOptions:c=yx,customPairSummary:u,customPairsParameter:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onModeChange:w,onAutoDetectToggle:_,onColumnToggle:b,onColumnsChange:x,renderParameterField:N})=>{const E=n.length>0,M=s.selectedColumns.length,j=v.useMemo(()=>lA(s.recommendedColumns),[s.recommendedColumns]),C=v.useMemo(()=>iA(s.nonTextSelected),[s.nonTextSelected]),S=v.useMemo(()=>dA(i,s.selectedColumns),[s.selectedColumns,i]),$=!e||!t,A=u.duplicates.length+u.duplicateOverflow,L=u.invalidEntries.length+u.invalidOverflow,T=u.duplicates.join(", "),P=u.invalidEntries.join(", "),z=v.useMemo(()=>n.some(Q=>Q.mode==="custom"),[n]),W=v.useMemo(()=>{const Q=new Map;return n.forEach(H=>{H.columns.forEach(Y=>{const X=Y.trim();X&&Q.set(X,(Q.get(X)??0)+1)})}),Q},[n]),[D,R]=v.useState(()=>new Set),U=v.useCallback(Q=>{R(H=>{const Y=new Set(H);return Y.has(Q)?Y.delete(Q):Y.add(Q),Y})},[]);v.useEffect(()=>{R(Q=>{const H=new Set;return Q.forEach(Y=>{Y<n.length&&H.add(Y)}),H.size===Q.size?Q:H})},[n.length]);const[V,B]=v.useState(()=>({index:null,mode:null})),G=v.useMemo(()=>{const Q=new Map;return l.forEach(H=>{const Y=Array.isArray(H.samples)?H.samples:[],X=Array.isArray(i[H.name])?i[H.name]:[],ee=[...Y,...X].map(J=>String(J??"").trim()).filter(J=>J.length>0);Q.set(H.name,ee.slice(0,12))}),Q},[l,i]),q=v.useMemo(()=>{const Q=new Map;return l.forEach(H=>{const Y=G.get(H.name)??[],X=Y.length?Y:[H.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(ee=>{_A(ee,X)&&(Q.has(ee)||Q.set(ee,new Set),Q.get(ee).add(H.name))})}),Q},[l,G]);v.useEffect(()=>{if(V.index===null)return;const Q=n[V.index];(!Q||Q.mode!==V.mode)&&B({index:null,mode:null})},[V.index,V.mode,n]);const F=v.useCallback((Q,H)=>{B({index:Q,mode:H})},[]),K=v.useCallback(()=>{B({index:null,mode:null})},[]);let se=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),s.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:M})," column",M===1?"":"s"," across all strategies."]}),S.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",S.map(Q=>`${Q.column} (${Q.values.join(", ")})`).join("; "),"."]}),s.textColumnCount>0&&j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[C.preview.join(", ")," ",C.preview.length===1?"is":"are"," not text-like.",C.remaining>0?` ${C.remaining} more column${C.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),$?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!E&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),E&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((Q,H)=>{var De;const Y=sA(Q.mode),X=((De=c.find(ce=>ce.value===Q.mode))==null?void 0:De.label)??Y.label,ee=Q.columns.length,J=ee?`${ee} column${ee===1?"":"s"}`:Q.autoDetect?"Auto-detecting columns":"No columns yet",re=p.has(H),we=D.has(H),Pe=Q.columns.join(", "),Me=q.get(Q.mode)??new Set,Fe=Q.mode==="custom"&&!!d&&!se,Ke=Q.mode==="custom"&&!!d&&se;Fe&&(se=!0);const Ue=l.map(ce=>{const Oe=Q.columns.includes(ce.name),Ye=Me.has(ce.name),ct=Oe?0:Ye?1:ce.isRecommended?2:ce.isTextLike?3:4;return{option:ce,priority:ct}}).sort((ce,Oe)=>ce.priority!==Oe.priority?ce.priority-Oe.priority:ce.option.name.localeCompare(Oe.option.name)).map(ce=>ce.option),de=Me.size>0,pe=Ue.filter(ce=>Q.columns.includes(ce.name)?!0:de?Me.has(ce.name):ce.isRecommended||ce.isTextLike),xe=new Set(pe.map(ce=>ce.name)),ke=Ue.filter(ce=>!xe.has(ce.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(H),"aria-expanded":!re,"aria-controls":`alias-strategy-body-${H}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${re?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",H+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[X,Q.autoDetect?"  auto-detect":"",J?`  ${J}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(H),"aria-label":`Remove alias strategy ${H+1}`,children:"Remove"})]}),!re&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${H}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[c.map(ce=>{const Oe=ce.value===Q.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${Oe?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":Oe,onClick:()=>w(H,ce.value),children:ce.label},ce.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>F(H,Q.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:Y.guidance})]}),V.index===H&&V.mode===Q.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:mm[Q.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:K,children:"Close"})]}),a.jsx("p",{children:mm[Q.mode].description}),mm[Q.mode].preview&&a.jsx("ul",{children:mm[Q.mode].preview.map(([ce,Oe])=>a.jsxs("li",{children:[ce," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",Oe]},`${ce}-${Oe}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${H}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${H}-auto-detect`,type:"checkbox",checked:Q.autoDetect,onChange:ce=>_(H,ce.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${H}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),l.length?a.jsxs(a.Fragment,{children:[Me.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",X.toLowerCase()," entries."]}),pe.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${H+1}`,children:pe.map(ce=>{const Oe=Q.columns.includes(ce.name),Ye=kx(ce.samples.length?ce.samples:i[ce.name]??[]),Je=(W.get(ce.name)??0)-(Oe?1:0)>0,mt=Me.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Oe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>b(H,ce.name),"aria-pressed":Oe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),ce.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),mt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),Je&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Ye&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Ye]})]},ce.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),ke.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>U(H),"aria-expanded":we,"aria-controls":`alias-strategy-${H}-other-columns`,children:we?"Hide other columns":`Show other columns (${ke.length})`}),we&&a.jsx("div",{id:`alias-strategy-${H}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${H+1}`,children:ke.map(ce=>{const Oe=Q.columns.includes(ce.name),Ye=kx(ce.samples.length?ce.samples:i[ce.name]??[]),Je=(W.get(ce.name)??0)-(Oe?1:0)>0,mt=Me.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Oe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>b(H,ce.name),"aria-pressed":Oe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),mt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),Je&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Ye&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Ye]})]},ce.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${Q.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:Q.columns.length?Q.columns.map(ce=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:ce},ce)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${H}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${H}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:Pe,onChange:ce=>x(H,ce.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),Q.mode==="custom"&&d&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Fe?N(d):Ke?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${H}`)})}),u.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[u.totalPairs," custom pair",u.totalPairs===1?"":"s"," captured.",z?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",u.previewPairs.length>0?` Examples: ${u.previewPairs.join("; ")}${u.previewOverflow>0?"...":""}`:""]}),u.totalPairs===0&&z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),A>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",T?`: ${T}`:"",u.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),L>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",L," incomplete pair",L===1?"":"s",".",P?` Examples: ${P}${u.invalidOverflow>0?"...":""}`:""]})]})},hm=["iso_date","iso_datetime","month_day_year","day_month_year"],yA="iso_date",bA=["date","time","timestamp","datetime"],xA=3,Mx=36,Mc={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},Up=hm.map(e=>({value:e,label:Mc[e].label,guidance:Mc[e].guidance,example:Mc[e].example})),wA=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],Ax=e=>e.length<=Mx?e:`${e.slice(0,Mx-1)}...`,Ox=e=>{if(!e)return!1;const t=e.toLowerCase();return bA.some(n=>t.includes(n))},jA=e=>wA.some(t=>t.test(e)),Px=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&hm.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&hm.includes(s)?s:yA},NA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s||!s.length)return;const l=s.length;let i=0;if(s.forEach(u=>{jA(u)&&(i+=1)}),!l)return;i/l>=.6&&i>=2&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},CA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ve(e)));l.sort((g,w)=>g.localeCompare(w));const i=new Set(l),c=t.filter(g=>Ox(n[g]??null)),u=NA(s),d=new Set;c.forEach(g=>{i.has(g)||d.add(g)}),u.forEach(g=>{i.has(g)||d.add(g)});const p=Array.from(d);p.sort((g,w)=>g.localeCompare(w));const h=l.filter(g=>!(Ox(n[g]??null)||u.includes(g))),f=u.slice().sort((g,w)=>g.localeCompare(w));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:p,nonDateSelected:h,dateColumnCount:c.length,sampleCandidateCount:u.length,sampleCandidates:f}},SA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&hm.includes(n)?n:t},EA=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},Tx=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,s=e.map(l=>{if(!l||typeof l!="object")return null;const i=Ve(l.columns),c=Array.from(new Set(i.map(h=>h.trim()).filter(Boolean))).sort((h,f)=>h.localeCompare(f)),u=SA(l.mode,t.mode),d=EA(l.auto_detect??l.autoDetect??l.auto),p=`${u}|${c.join(",")}|${d?"auto":"manual"}`;return n.has(p)?null:(n.add(p),{mode:u,columns:c,autoDetect:d})}).filter(l=>!!l);return s.length?s:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},kA=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),MA=e=>{var t;return((t=Mc[e])==null?void 0:t.label)??Mc.iso_date.label},AA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Ax(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?Ax(t):null},OA=(e,t=xA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;const u=AA(i);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},PA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},$x=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},TA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:l,sampleMap:i,collapsedStrategies:c,onToggleStrategy:u,onRemoveStrategy:d,onAddStrategy:p,onModeChange:h,onColumnToggle:f,onColumnsChange:g,onAutoDetectToggle:w,modeOptions:_=Up})=>{const b=n.length>0,x=v.useMemo(()=>n.some(A=>A.autoDetect),[n]),[N,E]=v.useState(()=>new Set),M=v.useCallback(A=>{E(L=>{const T=new Set(L);return T.has(A)?T.delete(A):T.add(A),T})},[]);v.useEffect(()=>{E(A=>{const L=new Set;return A.forEach(T=>{T<n.length&&L.add(T)}),L.size===A.size?A:L})},[n.length]);const j=v.useMemo(()=>{const A=new Map;return n.forEach(L=>{L.columns.forEach(T=>{const P=T.trim();P&&A.set(P,(A.get(P)??0)+1)})}),A},[n]),C=v.useMemo(()=>{const A=s.recommendedColumns.slice(0,6),L=Math.max(s.recommendedColumns.length-A.length,0);return{preview:A,remaining:L}},[s.recommendedColumns]),S=v.useMemo(()=>{const A=s.nonDateSelected.slice(0,4),L=Math.max(s.nonDateSelected.length-A.length,0);return{preview:A,remaining:L}},[s.nonDateSelected]),$=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:p,children:"Add strategy"})})]}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",C.preview.join(", "),C.remaining>0?`,  (${C.remaining} more)`:"",".",x?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),s.sampleCandidates.length===0&&!C.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.preview.join(", ")," ",S.preview.length===1?"looks":"look"," non-date-like.",S.remaining>0?` ${S.remaining} more selected column${S.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),x&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",s.sampleCandidateCount||s.dateColumnCount," date-like columns that are not already assigned."]}),b?a.jsx("div",{className:"canvas-imputer__list",children:n.map((A,L)=>{var K,se;const T=((K=_.find(Q=>Q.value===A.mode))==null?void 0:K.label)??MA(A.mode),P=A.columns.length,z=P?`${P} column${P===1?"":"s"}`:A.autoDetect?"Auto-detecting columns":"No columns yet",W=c.has(L),D=A.columns.join(", "),R=`date-strategy-${L}-toggle`,U=`date-strategy-${L}-auto-detect`,V=l.map(Q=>({option:Q,priority:Q.isRecommended?0:Q.isSampleCandidate?1:2})).sort((Q,H)=>Q.priority!==H.priority?Q.priority-H.priority:Q.option.name.localeCompare(H.option.name)).map(Q=>Q.option),B=V.filter(Q=>A.columns.includes(Q.name)?!0:Q.isRecommended||Q.isSampleCandidate),G=new Set(B.map(Q=>Q.name)),q=V.filter(Q=>!G.has(Q.name)),F=N.has(L);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:R,className:"canvas-imputer__card-toggle",onClick:()=>u(L),"aria-expanded":!W,"aria-controls":`date-strategy-body-${L}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${W?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",L+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[T,A.autoDetect?"  auto-detect":"",z?`  ${z}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(L),"aria-label":`Remove date formatting strategy ${L+1}`,children:"Remove"})]}),!W&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${L}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${L}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${L}-mode`,value:A.mode,onChange:Q=>h(L,Q.target.value),children:_.map(Q=>a.jsx("option",{value:Q.value,children:Q.label},Q.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((se=_.find(Q=>Q.value===A.mode))==null?void 0:se.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:U,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:U,type:"checkbox",checked:A.autoDetect,onChange:Q=>w(L,Q.target.checked)}),a.jsx("label",{htmlFor:U,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),V.length?a.jsxs(a.Fragment,{children:[B.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:B.map(Q=>{const H=A.columns.includes(Q.name),Y=$x(Q.samples.length?Q.samples:i[Q.name]??[]),ee=(j.get(Q.name)??0)-(H?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${H?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(L,Q.name),"aria-pressed":H,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Q.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Q.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Q.dtype}),Q.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!Q.isRecommended&&Q.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),ee&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Y&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Y]})]},Q.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),q.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>M(L),"aria-expanded":F,"aria-controls":`date-strategy-${L}-other-columns`,children:F?"Hide other columns":`Show other columns (${q.length})`}),F&&a.jsx("div",{id:`date-strategy-${L}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:q.map(Q=>{const H=A.columns.includes(Q.name),Y=$x(Q.samples.length?Q.samples:i[Q.name]??[]),ee=(j.get(Q.name)??0)-(H?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${H?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(L,Q.name),"aria-pressed":H,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Q.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Q.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Q.dtype}),ee&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Y&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Y]})]},Q.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${A.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:A.columns.length?A.columns.map(Q=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:Q},Q)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${L}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${L}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:D,onChange:Q=>g(L,Q.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${L}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},Lx=["both","leading","trailing"],zx="both",$A=["string","object","text","category","mixed","varchar","char"],LA=3,Dx=36,Rx=6,zA=4,DA=5,Fx={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},RA=e=>e.length<=Dx?e:`${e.slice(0,Dx-1)}...`,Ix=e=>{if(!e)return!1;const t=e.toLowerCase();return $A.some(n=>t.includes(n))},FA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${RA(t)}'`},IA=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,BA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Lx.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Lx.includes(s)?s:zx},UA=e=>{const t=Fx[e]??Fx[zx];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},qA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s.length)return;const l=s.reduce((c,u)=>u.hasIssue?c+1:c,0);if(!l)return;const i=l/s.length;(l>=2||i>=.5)&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},HA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ve(e)));l.sort((f,g)=>f.localeCompare(g));const i=new Set(l),c=t.filter(f=>Ix(n[f]??null)),u=qA(s),d=new Set;c.forEach(f=>{i.has(f)||d.add(f)}),u.forEach(f=>{i.has(f)||d.add(f)});const p=Array.from(d).sort((f,g)=>f.localeCompare(g)),h=l.filter(f=>!Ix(n[f]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:p,nonTextSelected:h,textColumnCount:c.length,whitespaceCandidateCount:u.length,whitespaceCandidates:u}},qp=(e,t)=>e.slice(0,t),VA=e=>{const t=qp(e,Rx);return{preview:t,remaining:Math.max(e.length-t.length,0)}},WA=e=>{const t=qp(e,zA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},KA=e=>{const t=qp(e,Rx);return{preview:t,remaining:Math.max(e.length-t.length,0)}},YA=(e,t=LA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=IA(u),p=FA(u),h=n[c]??[];h.find(f=>f.value===p)||h.length>=t||(n[c]=[...h,{value:p,hasIssue:d}])})}),n},GA=(e,t,n=DA)=>{if(!t.length)return[];const s=[];for(const l of t){if(s.length>=n)break;const i=e[l];!i||!i.length||s.push({column:l,values:i.map(c=>c.value),overflow:0})}return s},QA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},XA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:l,renderParameterField:i,columnSummary:c,modeDetails:u,sampleMap:d})=>{if(!n&&!s)return null;const p=c.selectedColumns.length,h=VA(c.recommendedColumns),f=WA(c.nonTextSelected),g=KA(c.whitespaceCandidates),w=GA(d,c.selectedColumns),_=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for trimming."]}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",w.map(b=>`${b.column} (${b.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),h.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",h.preview.join(", "),h.remaining>0?`, ... (${h.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[f.preview.join(", ")," ",f.preview.length===1?"is":"are"," not text-like.",f.remaining>0?` ${f.remaining} more column${f.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),_?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),l(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},Bx=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],Ux="keep_alphanumeric",JA=["string","object","text","category","mixed","varchar","char"],ZA=3,qx=36,eO=6,tO=4,nO=5,Hx={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},sO=e=>e.length<=qx?e:`${e.slice(0,qx-1)}...`,rO=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${sO(t)}'`},Vx=e=>{if(!e)return!1;const t=e.toLowerCase();return JA.some(n=>t.includes(n))},aO=e=>/[^0-9A-Za-z\s]/.test(e),oO=e=>/[A-Za-z]/.test(e),lO=e=>/[0-9]/.test(e),iO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Bx.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Bx.includes(s)?s:Ux},cO=e=>{const t=Hx[e]??Hx[Ux];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},uO=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([u,d])=>{if(!d.length)return;let p=0,h=0,f=0;d.forEach(g=>{g.hasSpecial&&(p+=1),g.hasDigits&&(h+=1),g.hasLetters&&(f+=1)}),p>0&&t.add(u),h>0&&f===0&&n.add(u),f>0&&h===0&&s.add(u)});const l=Array.from(t).sort((u,d)=>u.localeCompare(d)),i=Array.from(n).sort((u,d)=>u.localeCompare(d)),c=Array.from(s).sort((u,d)=>u.localeCompare(d));return{specialCandidates:l,digitsOnlyCandidates:i,lettersOnlyCandidates:c}},dO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ve(e)));l.sort((w,_)=>w.localeCompare(_));const i=new Set(l),c=t.filter(w=>Vx(n[w]??null)),{specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}=uO(s),h=new Set;c.forEach(w=>{i.has(w)||h.add(w)}),u.forEach(w=>{i.has(w)||h.add(w)});const f=Array.from(h).sort((w,_)=>w.localeCompare(_)),g=l.filter(w=>!Vx(n[w]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,specialCandidateCount:u.length,specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}},Wx=(e,t)=>e.slice(0,t),mO=e=>{const t=Wx(e,eO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},fm=e=>{const t=Wx(e,tO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},hO=(e,t=ZA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=rO(u),p=aO(u),h={value:d,hasSpecial:p,hasDigits:lO(u),hasLetters:oO(u)},f=n[c]??[];f.find(g=>g.value===d)||f.length>=t||(n[c]=[...f,h])})}),n},fO=(e,t,n=nO)=>{if(!t.length)return[];const s=[];for(const l of t){if(s.length>=n)break;const i=e[l];!i||!i.length||s.push({column:l,values:i.map(c=>c.value),overflow:0})}return s},pO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},gO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,replacementParameter:l,renderMultiSelectField:i,renderParameterField:c,columnSummary:u,modeDetails:d,sampleMap:p})=>{if(!n&&!s&&!l)return null;const h=u.selectedColumns.length,f=mO(u.recommendedColumns),g=fm(u.specialCandidates),w=fm(u.digitsOnlyCandidates),_=fm(u.lettersOnlyCandidates),b=fm(u.nonTextSelected),x=fO(p,u.selectedColumns),N=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for cleanup."]}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",x.map(E=>`${E.column} (${E.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"",". Consider `digits only` mode."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"",". Consider `letters only` mode."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[b.preview.join(", ")," ",b.preview.length===1?"is":"are"," not text-like.",b.remaining>0?` ${b.remaining} more column${b.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),N?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),i(n)]}),(s||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?c(s):null,l?c(l):null]})]})},Kx=["lower","upper","title","sentence"],Yx="lower",_O=["string","object","text","category","mixed","varchar","char"],vO=3,Gx=60,yO=6,bO=4,xO=5,Qx={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},wO=e=>e.length<=Gx?e:`${e.slice(0,Gx-1)}...`,Xx=e=>{if(!e)return!1;const t=e.toLowerCase();return _O.some(n=>t.includes(n))},Ac=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${wO(t)}'`},jO=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),NO=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),CO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Kx.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Kx.includes(s)?s:Yx},SO=e=>{const t=Qx[e]??Qx[Yx];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},EO=(e,t)=>{const n=[];return Object.entries(e).forEach(([s,l])=>{if(!l.length)return;l.some(c=>{const u=c[t];return c.original!==u})&&n.push(s)}),n.sort((s,l)=>s.localeCompare(l)),n},kO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s,mode:l})=>{const i=Array.from(new Set(Ve(e)));i.sort((g,w)=>g.localeCompare(w));const c=new Set(i),u=t.filter(g=>Xx(n[g]??null)),d=EO(s,l),p=new Set;u.forEach(g=>{c.has(g)||p.add(g)}),d.forEach(g=>{c.has(g)||p.add(g)});const h=Array.from(p).sort((g,w)=>g.localeCompare(w)),f=i.filter(g=>!Xx(n[g]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:h,nonTextSelected:f,textColumnCount:u.length,inconsistentColumns:d}},Jx=(e,t)=>e.slice(0,t),MO=e=>{const t=Jx(e,yO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Zx=e=>{const t=Jx(e,bO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},AO=(e,t=vO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=Ac(u),p={original:d,lower:Ac(u.toLowerCase()),upper:Ac(u.toUpperCase()),title:Ac(jO(u)),sentence:Ac(NO(u))},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},OO=(e,t,n,s=xO)=>{if(!t.length)return[];const l=[];for(const i of t){if(l.length>=s)break;const c=e[i];if(!c||!c.length)continue;const u=c.map(d=>`${d.original}  ${d[n]}`);l.push({column:i,values:u,overflow:0})}return l},PO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},TO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:l,renderParameterField:i,columnSummary:c,modeDetails:u,sampleMap:d,selectedMode:p})=>{if(!n&&!s)return null;const h=c.selectedColumns.length,f=MO(c.recommendedColumns),g=Zx(c.inconsistentColumns),w=Zx(c.nonTextSelected),_=OO(d,c.selectedColumns,p),b=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for case normalization."]}),_.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",_.map(x=>`${x.column} (${x.values.join("; ")})`).join(" | "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[w.preview.join(", ")," ",w.preview.length===1?"is":"are"," not text-like.",w.remaining>0?` ${w.remaining} more column${w.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),b?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),l(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},e0=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],t0="preset_digits_only",$O=["string","object","text","category","mixed","varchar","char"],LO=3,n0=60,zO=6,DO=4,RO=5,s0={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},FO=e=>e.length<=n0?e:`${e.slice(0,n0-1)}...`,Oc=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${FO(t)}'`},r0=e=>{if(!e)return!1;const t=e.toLowerCase();return $O.some(n=>t.includes(n))},IO=e=>e.replace(/\s+/g," ").trim(),BO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&e0.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&e0.includes(s)?s:t0},UO=e=>{const t=s0[e]??s0[t0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},qO=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([i,c])=>{c.length&&c.forEach(u=>{u.hasDigits&&t.add(i),u.hasLetters&&n.add(i),u.hasWhitespaceRuns&&s.add(i)})});const l=i=>Array.from(i).sort((c,u)=>c.localeCompare(u));return{digits:l(t),letters:l(n),whitespace:l(s)}},HO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ve(e)));l.sort((w,_)=>w.localeCompare(_));const i=new Set(l),c=t.filter(w=>r0(n[w]??null)),{digits:u,letters:d,whitespace:p}=qO(s),h=new Set;c.forEach(w=>{i.has(w)||h.add(w)}),[...u,...d,...p].forEach(w=>{i.has(w)||h.add(w)});const f=Array.from(h).sort((w,_)=>w.localeCompare(_)),g=l.filter(w=>!r0(n[w]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,digitsCandidates:u,lettersCandidates:d,whitespaceCandidates:p}},a0=(e,t)=>e.slice(0,t),VO=e=>{const t=a0(e,zO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},pm=e=>{const t=a0(e,DO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},WO=(e,t=LO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=Oc(u),p={original:d,presetDigits:Oc(u.replace(/\D+/g,"")),presetLetters:Oc(u.replace(/[^A-Za-z]+/g,"")),presetWhitespace:Oc(IO(u)),hasDigits:/\d/.test(u),hasLetters:/[A-Za-z]/.test(u),hasWhitespaceRuns:/\s{2,}/.test(u)||/\t|\n|\r/.test(u)},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},KO=(e,t,n)=>{const s=n??"",l=i=>i.length?i:"''";switch(t){case"preset_letters_only":return`${l(e.original)}  ${l(e.presetLetters)}`;case"preset_whitespace_collapse":return`${l(e.original)}  ${l(e.presetWhitespace)}`;case"custom":try{const i=new RegExp(s.split("|||")[0]??"",s.split("|||")[1]??""),c=Oc(e.original.replace(i,s.split("|||")[2]??""));return`${l(e.original)}  ${l(c)}`}catch{return`${l(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${l(e.original)}  ${l(e.presetDigits)}`}},YO=(e,t,n,s,l=RO)=>{if(!t.length)return[];const i=[];for(const c of t){if(i.length>=l)break;const u=e[c];if(!u||!u.length)continue;const d=u.map(p=>KO(p,n,s));i.push({column:c,values:d,overflow:0})}return i},GO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},QO=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",s=t[1]??"",l=t[2]??"";return!n.trim()&&!l.trim()?null:`Pattern: /${n||"(empty)"}/${s||"(none)"} Replacement: ${l||"''"}`},XO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,patternParameter:l,replacementParameter:i,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,replacementValue:g})=>{if(!n&&!s&&!l&&!i)return null;const w=d.selectedColumns.length,_=VO(d.recommendedColumns),b=pm(d.digitsCandidates),x=pm(d.lettersCandidates),N=pm(d.whitespaceCandidates),E=pm(d.nonTextSelected),M=QO(g),j=YO(h,d.selectedColumns,f,g),C=!e||!t,S=f==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," mode. ",p.guidance," Example: ",p.example,"."]}),M&&a.jsx("p",{className:"canvas-modal__note",children:M}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:w})," column",w===1?"":"s"," for regex cleanup."]}),j.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",j.map($=>`${$.column} (${$.values.join("; ")})`).join(" | "),"."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",b.preview.join(", "),b.remaining>0?`, ... (${b.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"is":"are"," not text-like.",E.remaining>0?` ${E.remaining} more column${E.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),S&&!M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),C?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||l||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,l?u(l):null,i?u(i):null]})]})},o0=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],l0="negative_to_nan",JO=["int","float","double","numeric","number","decimal","real","long"],ZO=3,eP=6,tP=4,nP=5,i0={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},sP=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},rP=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},aP=e=>{if(!e)return!1;const t=e.toLowerCase();return JO.some(n=>t.includes(n))},oP=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&o0.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&o0.includes(s)?s:l0},lP=e=>{const t=i0[e]??i0[l0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},iP=e=>{const t=new Set,n=new Set,s=new Set,l=new Set;Object.entries(e).forEach(([c,u])=>{u.forEach(d=>{d.isNegative&&t.add(c),d.isZero&&n.add(c),(d.numericValue<0||d.numericValue>100)&&s.add(c),(d.numericValue<0||d.numericValue>120)&&l.add(c)})});const i=c=>Array.from(c).sort((u,d)=>u.localeCompare(d));return{negative:i(t),zeros:i(n),percentage:i(s),age:i(l)}},cP=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const l=Array.from(new Set(Ve(e))).sort((_,b)=>_.localeCompare(b)),i=new Set(l),c=t.filter(_=>aP(n[_]??null)),u=new Set(c),{negative:d,zeros:p,percentage:h,age:f}=iP(s),g=new Set;c.forEach(_=>{i.has(_)||g.add(_)}),[...d,...p,...h,...f].forEach(_=>{i.has(_)||g.add(_)});const w=l.filter(_=>!u.has(_));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:Array.from(g).sort((_,b)=>_.localeCompare(b)),nonNumericSelected:w,numericColumnCount:c.length,negativeCandidates:d,zeroCandidates:p,percentageOutliers:h,ageOutliers:f}},uP=e=>{const t=e.slice(0,eP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Pc=e=>{const t=e.slice(0,tP);return{preview:t,remaining:Math.max(e.length-t.length,0)}},dP=(e,t=ZO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([l,i])=>{const c=typeof l=="string"?l.trim():"";if(!c)return;const u=rP(i);if(u===null)return;const d=sP(String(i)),p={originalDisplay:d,numericValue:u,isNegative:u<0,isZero:Math.abs(u)<=1e-9},h=n[c]??[];h.find(f=>f.originalDisplay===d)||h.length>=t||(n[c]=[...h,p])})}),n},mP=0,hP=100,fP=0,pP=120,gP=(e,t,n,s)=>{switch(t){case"negative_to_nan":{const l=n??0;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:s!==null&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const l=n??mP,i=s??hP;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"age_bounds":{const l=n??fP,i=s??pP;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"custom_range":default:{const l=n!=null,i=s!=null;return!l&&!i?{flagged:!1,reason:null}:l&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:i&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}}},_P=(e,t,n,s)=>{const{flagged:l,reason:i}=gP(e,t,n,s);return l?`${e.originalDisplay}  flagged (${i??"rule match"})`:`${e.originalDisplay}  ok`},vP=(e,t,n,s,l,i=nP)=>{if(!t.length)return[];const c=[];for(const u of t){if(c.length>=i)break;const d=e[u];!d||!d.length||c.push({column:u,values:d.map(p=>_P(p,n,s,l)),overflow:0})}return c},yP={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},bP=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const s=t===null?"-":String(t),l=n===null?"":String(n);return`Custom bounds active: [${s}, ${l}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const s=t??0;return n===null?`Negative-to-missing rule overrides values below ${s}.`:`Negative-to-missing rule overrides values < ${s} or > ${n}.`}return null},xP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,minValueParameter:l,maxValueParameter:i,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,minValue:g,maxValue:w})=>{if(!n&&!s&&!l&&!i)return null;const{selectedColumns:_,autoDetectionActive:b}=d,x=_.length,N=uP(d.recommendedColumns),E=Pc(d.negativeCandidates),M=Pc(d.zeroCandidates),j=Pc(d.percentageOutliers),C=Pc(d.ageOutliers),S=Pc(d.nonNumericSelected),$=vP(h,_,f,g,w),A=bP(f,g,w),L=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," rule. ",p.guidance," Example: ",p.example,"."]}),A&&a.jsx("p",{className:"canvas-modal__note",children:A}),b?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:x})," column",x===1?"":"s"," for invalid value cleanup."]}),$.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",$.map(T=>`${T.column} (${T.values.join("; ")})`).join(" | "),"."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",E.preview.join(", "),E.remaining>0?`, ... (${E.remaining} more)`:"","."]}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",M.preview.join(", "),M.remaining>0?`, ... (${M.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",C.preview.join(", "),C.remaining>0?`, ... (${C.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.preview.join(", ")," ",S.preview.length===1?"is":"are"," not numeric-type columns.",S.remaining>0?` ${S.remaining} more column${S.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),L?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||l||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,l?u(l):null,i?u(i):null]})]})};let wP="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",c0=(e=21)=>{let t="",n=e|0;for(;n--;)t+=wP[Math.random()*64|0];return t};const u0=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],d0=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],Hp=[{value:"token_sort_ratio",label:"Token Sort  Same words, ignore order",description:"Split into words, sort alphabetically, then compare. Great when the same words appear in different order."},{value:"token_set_ratio",label:"Token Set  Unique words, ignore extras",description:"Focus on overlapping unique words and down-weight extras. Best when one string has additional words."},{value:"ratio",label:"Character Ratio  Raw string similarity",description:"Compare characters in order using edit distance. Sensitive to spelling differences."}],gm=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],jP=new Set(gm.map(e=>e.value)),Zl=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],Tc="UTC",_m=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?_m(e.split(",")):[]:[],m0=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(s=>{const l=Number(s);Number.isFinite(l)&&n.push(l)}),n}if(typeof e=="string")return m0(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},Vp=e=>{const t=Number(e);return Number.isFinite(t)?t:null},h0=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},NP=(e,t)=>{var s,l,i,c,u;if(typeof t!="string")return((s=Zl.find(d=>d.value===e))==null?void 0:s.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((i=u0.find(d=>d.value===n))==null?void 0:i.value)??"add":e==="stat"?((c=d0.find(d=>d.value===n))==null?void 0:c.value)??"mean":e==="similarity"?((u=Hp.find(d=>d.value===n))==null?void 0:u.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((l=Zl.find(d=>d.value===e))==null?void 0:l.defaultMethod)??""},CP=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},SP=e=>{const t=_m(e);return t.length?t.filter(n=>jP.has(n)):["year","month","day"]},EP=e=>typeof e!="string"?Tc:e.trim()||Tc,f0=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,s)=>{if(!n||typeof n!="object")return;const l=n,i=CP(l.operation_type??l.type),c=l.operation_id??l.id??`feature_math_${s+1}`,u=typeof c=="string"&&c.trim()?c.trim():`feature_math_${s+1}`,d=NP(i,l.method),p=_m(l.input_columns??l.inputs??l.inputColumns),h=_m(l.secondary_columns??l.denominator??l.secondaryColumns),f=m0(l.constants),g=typeof l.output_column=="string"?l.output_column.trim():"",w=typeof l.output_prefix=="string"?l.output_prefix.trim():"",_=i==="datetime_extract"?SP(l.datetime_features):[],b=i==="datetime_extract"?EP(l.timezone):Tc,x=Vp(l.fillna),N=(()=>{const S=Vp(l.round??l.round_digits);return Number.isInteger(S??NaN),S})(),E=Vp(l.epsilon),M=i==="similarity"?h0(l.normalize,!1):!1,j=l.allow_overwrite===void 0?null:h0(l.allow_overwrite,!1),C=typeof l.description=="string"?l.description:void 0;t.push({id:u,type:i,method:d,inputColumns:p,secondaryColumns:h,constants:f,outputColumn:g,outputPrefix:w,datetimeFeatures:_,timezone:b,fillna:x,roundDigits:N,normalize:M,epsilon:E,allowOverwrite:j,description:C})}),t},kP=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||Tc):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},MP=e=>e.map(t=>kP(t)),AP={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},p0=(e,t)=>{var l;const n=AP[e]??{};let s=`math_${e}_${c0(6)}`;for(;t.has(s);)s=`math_${e}_${c0(6)}`;return{id:s,type:e,method:n.method??((l=Zl.find(i=>i.value===e))==null?void 0:l.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:Tc,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},OP=(e,t)=>{const n=new Map;return t==null||t.forEach(s=>{s.operations.forEach(l=>{n.has(l.operation_id)||n.set(l.operation_id,l)})}),e.map((s,l)=>{const i=n.get(s.id),c=`${l+1}. ${s.type.replace("_"," ")}${s.method?`  ${s.method}`:""}`;return{id:s.id,label:c,status:i==null?void 0:i.status,message:(i==null?void 0:i.message)??void 0,outputColumns:(i==null?void 0:i.output_columns)??[]}})},g0=e=>e==="arithmetic"?u0:e==="stat"?d0:e==="similarity"?Hp:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],PP=e=>{const t=Hp.find(n=>n.value===e);return t!=null&&t.description?t.description:"Compare the input text columns using the selected similarity technique."},TP={applied:"Applied",skipped:"Skipped",failed:"Failed"},$P={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},LP=new Set(gm.map(e=>e.value)),zP=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},_0=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],DP=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],RP=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",FP=({index:e,total:t,operation:n,summary:s,availableColumns:l,isCollapsed:i,onToggleCollapsed:c,onDuplicate:u,onRemove:d,onReorder:p,onChange:h})=>{var ee;const f=v.useMemo(()=>g0(n.type),[n.type]),g=v.useMemo(()=>{var J;return((J=Zl.find(re=>re.value===n.type))==null?void 0:J.label)??n.type},[n.type]),w=v.useMemo(()=>{var J;return((J=f.find(re=>re.value===n.method))==null?void 0:J.label)??n.method},[f,n.method]),_=v.useMemo(()=>n.type==="similarity"?PP(n.method):"",[n.method,n.type]),[b,x]=v.useState(n.inputColumns.join(", ")),[N,E]=v.useState(n.secondaryColumns.join(", ")),[M,j]=v.useState(n.constants.join(", "));v.useEffect(()=>{x(n.inputColumns.join(", "))},[n.inputColumns]),v.useEffect(()=>{E(n.secondaryColumns.join(", "))},[n.secondaryColumns]),v.useEffect(()=>{j(n.constants.join(", "))},[n.constants]);const C=()=>{h(n.id,{inputColumns:_0(b)})},S=()=>{h(n.id,{secondaryColumns:_0(N)})},$=()=>{h(n.id,{constants:DP(M)})},A=`feature-math-toggle-${n.id}`,L=`feature-math-body-${n.id}`,T=`feature-math-input-columns-${n.id}`,P=`feature-math-secondary-columns-${n.id}`,z=s==null?void 0:s.status,W=z?a.jsx("span",{className:`canvas-cast__chip ${$P[z]??""}`,style:{marginLeft:"0.5rem"},children:TP[z]}):null,D=s!=null&&s.message?s.message.trim():"",R=RP(z),U=(ee=s==null?void 0:s.outputColumns)!=null&&ee.length?s.outputColumns.join(", "):"",V=zP(n.inputColumns),B=n.type==="ratio"||n.type==="similarity",G=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",q=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",F=n.type==="similarity",K=n.type==="datetime_extract",se=n.type==="stat"||n.type==="datetime_extract",Q=v.useMemo(()=>{if(!l.length)return"";const J=l.slice(0,6),re=l.length-J.length;return re>0?`${J.join(", ")}  (${re} more)`:J.join(", ")},[l]),H=J=>{if(!J||!LP.has(J))return;const re=new Set(n.datetimeFeatures);re.has(J)?re.delete(J):re.add(J),h(n.id,{datetimeFeatures:Array.from(re)})},Y=J=>re=>{const we=re.target.value;if(we===""){h(n.id,{[J]:null});return}const Pe=Number(we);Number.isFinite(Pe)&&(J==="roundDigits"?h(n.id,{roundDigits:Math.round(Pe)}):J==="fillna"?h(n.id,{fillna:Pe}):h(n.id,{epsilon:Pe}))},X=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:A,className:"canvas-imputer__card-toggle",onClick:()=>c(n.id),"aria-expanded":!i,"aria-controls":L,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${i?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[g,w?`  ${w}`:"",n.outputColumn?`   ${n.outputColumn}`:"",W]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",V]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!i&&a.jsxs("div",{className:"canvas-imputer__card-body",id:L,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>u(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),D&&a.jsx("p",{className:R,children:D}),U&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",U]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:J=>h(n.id,{type:J.target.value}),children:Zl.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:J=>h(n.id,{method:J.target.value}),children:f.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),n.type==="similarity"&&_&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:_}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:b,onChange:J=>x(J.target.value),onBlur:C,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),C())},placeholder:"col_a, col_b",list:T}),a.jsx("datalist",{id:T,children:l.map(J=>a.jsx("option",{value:J},`${n.id}-input-option-${J}`))}),Q&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",Q]})]}),B&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:N,onChange:J=>E(J.target.value),onBlur:S,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),S())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:P}),a.jsx("datalist",{id:P,children:l.map(J=>a.jsx("option",{value:J},`${n.id}-secondary-option-${J}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),G&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:M,onChange:J=>j(J.target.value),onBlur:$,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),$())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:J=>h(n.id,{outputColumn:J.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),se&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:J=>h(n.id,{outputPrefix:J.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),q&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:Y("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:Y("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:Y("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),F&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:J=>h(n.id,{normalize:J.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),K&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:gm.map(J=>{const re=`feature-math-${n.id}-datetime-${J.value}`,we=n.datetimeFeatures.includes(J.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:re,children:[a.jsx("input",{id:re,type:"checkbox",checked:we,onChange:()=>H(J.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:J.label})]},J.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:J=>h(n.id,{timezone:J.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:X,onChange:J=>{const re=J.target.value;re==="inherit"?h(n.id,{allowOverwrite:null}):h(n.id,{allowOverwrite:re==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},IP=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:s,onAddOperation:l,onDuplicateOperation:i,onRemoveOperation:c,onReorderOperation:u,onOperationChange:d,availableColumns:p,signals:h,previewStatus:f,errorHandlingParameter:g,allowOverwriteParameter:w,defaultTimezoneParameter:_,epsilonParameter:b,renderParameterField:x})=>{const[N,E]=v.useState("arithmetic"),M=v.useMemo(()=>{const A=new Map;return t.forEach(L=>{A.set(L.id,L)}),A},[t]),j=v.useMemo(()=>h.length?h[h.length-1]:null,[h]),C=(j==null?void 0:j.warnings)??[],S=j&&j.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",$=()=>{l(N)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("select",{value:N,onChange:A=>E(A.target.value),children:Zl.map(A=>a.jsx("option",{value:A.value,children:A.label},A.value))}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:$,children:"Add operation"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),f==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),j&&a.jsxs("p",{className:S,children:["Preview applied ",j.applied_operations," of ",j.total_operations," operation",j.total_operations===1?"":"s"," (",j.skipped_operations," skipped, ",j.failed_operations," failed)."]}),C.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:C.map((A,L)=>a.jsx("li",{children:A},`feature-math-warning-${L}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((A,L)=>a.jsx(FP,{index:L,total:e.length,operation:A,summary:M.get(A.id),availableColumns:p,isCollapsed:n.has(A.id),onToggleCollapsed:s,onDuplicate:i,onRemove:c,onReorder:u,onChange:d},A.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[g&&x(g),w&&x(w),_&&x(_),b&&x(b)]})]})},BP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},UP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},v0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),qP=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxUniqueParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,missingStrategyParameter:f,missingCodeParameter:g,selectedColumns:w,renderParameterField:_,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const S=new Set;return l.forEach($=>{$.status==="recommended"&&$.selectable&&S.add($.column)}),Array.from(S)},[l]),M=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),j=l.length>0,C=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:M}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((S,$)=>a.jsx("li",{children:S},`label-encoding-note-${$}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(S=>{const $=w.includes(S.column),A=BP[S.status],L=UP[S.status]??"canvas-cast__chip--muted",T=S.sample_values.length?S.sample_values.join(", "):"",P=S.unique_count!==void 0&&S.unique_count!==null?`${v0(S.unique_count)} (${v0(S.unique_percentage)}%)`:"",z=N(S.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:S.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[S.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",S.dtype]}),S.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:S.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",T]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:S.reason})]})}),a.jsx("td",{children:P}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:A})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>b(S.column),disabled:!S.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:S.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${S.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&_(u),d&&_(d),p&&_(p),h&&_(h),f&&_(f),g&&_(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),_(c)]})]})},HP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},VP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},y0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),WP=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,targetColumnParameter:u,autoDetectParameter:d,maxCategoriesParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,smoothingParameter:g,encodeMissingParameter:w,handleUnknownParameter:_,selectedColumns:b,renderParameterField:x,onToggleColumn:N,onApplyRecommended:E,formatMissingPercentage:M})=>{const j=v.useMemo(()=>{if(!l.length)return[];const A=new Set;return l.forEach(L=>{L.status==="recommended"&&L.selectable&&A.add(L.column)}),Array.from(A)},[l]),C=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),S=l.length>0,$=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(j),disabled:!j.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:C}),!u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((A,L)=>a.jsx("li",{children:A},`target-encoding-note-${L}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!S&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&S&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(A=>{const L=b.includes(A.column),T=HP[A.status],P=VP[A.status]??"canvas-cast__chip--muted",z=A.sample_values.length?A.sample_values.join(", "):"",W=A.unique_count!==void 0&&A.unique_count!==null?`${y0(A.unique_count)} (${y0(A.unique_percentage)}%)`:"",D=M(A.missing_percentage),R=A.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:A.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[A.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",A.dtype]}),A.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:A.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",z]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:A.reason})]})}),a.jsx("td",{children:W}),a.jsx("td",{children:D}),a.jsx("td",{children:R}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:T})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:()=>N(A.column),disabled:!A.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:A.selectable?L?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${A.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&x(u),d&&x(d),p&&x(p),h&&x(h),f&&x(f),g&&x(g),w&&x(w),_&&x(_)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(c)]})]})},KP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},YP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},b0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),GP=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,bucketsParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,encodeMissingParameter:g,selectedColumns:w,renderParameterField:_,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const $=new Set;return l.forEach(A=>{A.status==="recommended"&&A.selectable&&$.add(A.column)}),Array.from($)},[l]),M=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),j=l.length>0,C=i.suggestedBucketDefault>0?`Default bucket suggestion: ${i.suggestedBucketDefault.toLocaleString()}.`:null,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:M}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:C}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map(($,A)=>a.jsx("li",{children:$},`hash-encoding-note-${A}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map($=>{const A=w.includes($.column),L=KP[$.status],T=YP[$.status]??"canvas-cast__chip--muted",P=$.sample_values.length?$.sample_values.join(", "):"",z=$.unique_count!==void 0&&$.unique_count!==null?`${b0($.unique_count)} (${b0($.unique_percentage)}%)`:"",W=N($.missing_percentage),D=$.recommended_bucket_count?$.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:$.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[$.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",$.dtype]}),$.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:$.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",P]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:$.reason})]})}),a.jsx("td",{children:z}),a.jsx("td",{children:W}),a.jsx("td",{children:D}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${T}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:()=>b($.column),disabled:!$.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:$.selectable?A?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${$.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&_(u),d&&_(d),p&&_(p),h&&_(h),f&&_(f),g&&_(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),_(c)]})]})},QP=({columnsParameter:e,autoDetectParameter:t,degreeParameter:n,includeBiasParameter:s,interactionOnlyParameter:l,includeInputFeaturesParameter:i,outputPrefixParameter:c,renderParameterField:u,signal:d})=>{const p=v.useMemo(()=>[e,t,n,s,l,i,c].filter(x=>!!x),[e,t,n,s,l,i,c]),h=(d==null?void 0:d.generated_features)??[],f=(d==null?void 0:d.skipped_columns)??[],g=(d==null?void 0:d.filled_columns)??{},w=(d==null?void 0:d.notes)??[],_=(d==null?void 0:d.feature_count)??0,b=v.useMemo(()=>{const x=Object.entries(g);return x.length?x.map(([N,E])=>`${N} (${E.toLocaleString()} missing)`).join(", "):null},[g]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Polynomial feature settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),p.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:p.map(x=>u(x))}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",f.join(", "),"."]}),b&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",b," before generating features."]}),_>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:h.map(x=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:x.column}),a.jsx("td",{children:x.expression||(x.terms.length?x.terms.join("  "):"1")}),a.jsx("td",{children:x.degree})]},`poly-feature-${x.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),w.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:w.map((x,N)=>a.jsx("li",{children:x},`polynomial-note-${N}`))})]})},x0=e=>!!e,$c=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},XP=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},w0=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},JP=({columnsParameter:e,autoDetectParameter:t,targetColumnParameter:n,methodParameter:s,scoreFuncParameter:l,problemTypeParameter:i,kParameter:c,percentileParameter:u,alphaParameter:d,thresholdParameter:p,modeParameter:h,estimatorParameter:f,stepParameter:g,minFeaturesParameter:w,maxFeaturesParameter:_,dropUnselectedParameter:b,renderParameterField:x,signal:N})=>{const E=v.useMemo(()=>[e,t,n,s,l,i].filter(x0),[e,t,n,s,l,i]),M=v.useMemo(()=>[c,u,d,p,h,f,g,w,_,b].filter(x0),[c,u,d,p,h,f,g,w,_,b]),j=(N==null?void 0:N.configured_columns)??[],C=(N==null?void 0:N.evaluated_columns)??[],S=(N==null?void 0:N.selected_columns)??[],$=(N==null?void 0:N.dropped_columns)??[],A=(N==null?void 0:N.feature_summaries)??[],L=(N==null?void 0:N.notes)??[],T=(N==null?void 0:N.drop_unselected)??!1,P=v.useMemo(()=>{if(!C.length&&!j.length)return null;if(C.length===j.length)return`Evaluated ${C.length.toLocaleString()} column(s).`;if(!j.length)return`Evaluated ${C.length.toLocaleString()} column(s) via auto-detect.`;const R=Math.max(C.length-j.length,0);return R>0?`Evaluated ${C.length.toLocaleString()} column(s) (${R.toLocaleString()} auto-detected).`:`Evaluated ${C.length.toLocaleString()} of ${j.length.toLocaleString()} configured column(s).`},[j,C]),z=v.useMemo(()=>{if(!N)return null;const R=[];return N.method&&R.push(`Method: ${N.method}`),N.score_func&&R.push(`Score: ${N.score_func}`),N.estimator&&R.push(`Estimator: ${N.estimator}`),N.problem_type&&N.problem_type!=="auto"&&R.push(`Problem: ${N.problem_type}`),N.target_column&&R.push(`Target: ${N.target_column}`),typeof N.k=="number"&&Number.isFinite(N.k)&&R.push(`k = ${N.k.toLocaleString()}`),typeof N.percentile=="number"&&Number.isFinite(N.percentile)&&R.push(`percentile = ${$c(N.percentile,2)}`),typeof N.alpha=="number"&&Number.isFinite(N.alpha)&&R.push(`alpha = ${$c(N.alpha,4)}`),N.threshold!==null&&N.threshold!==void 0&&Number.isFinite(N.threshold)&&R.push(`threshold = ${$c(N.threshold,4)}`),N.auto_detect&&R.push("Auto-detect enabled"),R.length?R.join("  "):null},[N]),W=v.useMemo(()=>w0(S),[S]),D=v.useMemo(()=>w0($),[$]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Feature selection settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:z}),P&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:P}),E.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:E.map(R=>x(R))}),M.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:M.map(R=>x(R))}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:T?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),S.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",S.length.toLocaleString()," column(s): ",W]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),$.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",$.length.toLocaleString()," column(s): ",D]}),A.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:A.map(R=>{const U=["canvas-cast__row"];return R.selected||U.push("canvas-cast__row--muted"),a.jsxs("tr",{className:U.join(" "),children:[a.jsx("th",{scope:"row",children:R.column}),a.jsx("td",{children:$c(R.score)}),a.jsx("td",{children:XP(R.p_value)}),a.jsx("td",{children:R.rank??""}),a.jsx("td",{children:$c(R.importance,4)}),a.jsx("td",{children:R.selected?"Selected":"Dropped"}),a.jsx("td",{children:R.note??""})]},`feature-selection-summary-${R.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),L.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:L.map((R,U)=>a.jsx("li",{children:R},`feature-selection-note-${U}`))})]})},ZP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},eT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},j0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),tT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,encodeMissingParameter:f,handleUnknownParameter:g,unknownValueParameter:w,selectedColumns:_,renderParameterField:b,onToggleColumn:x,onApplyRecommended:N,formatMissingPercentage:E})=>{const M=v.useMemo(()=>{if(!l.length)return[];const $=new Set;return l.forEach(A=>{A.status==="recommended"&&A.selectable&&$.add(A.column)}),Array.from($)},[l]),j=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),C=l.length>0,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>N(M),disabled:!M.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),j&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:j}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map(($,A)=>a.jsx("li",{children:$},`ordinal-encoding-note-${A}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!C&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&C&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map($=>{const A=_.includes($.column),L=ZP[$.status],T=eT[$.status]??"canvas-cast__chip--muted",P=$.sample_values.length?$.sample_values.join(", "):"",z=$.unique_count!==void 0&&$.unique_count!==null?`${j0($.unique_count)} (${j0($.unique_percentage)}%)`:"",W=E($.missing_percentage),D=$.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:$.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[$.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",$.dtype]}),$.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:$.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",P]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:$.reason})]})}),a.jsx("td",{children:z}),a.jsx("td",{children:W}),a.jsx("td",{children:D}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${T}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:()=>x($.column),disabled:!$.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:$.selectable?A?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${$.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&b(u),d&&b(d),p&&b(p),h&&b(h),f&&b(f),g&&b(g),w&&b(w)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),b(c)]})]})},nT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},sT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},N0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),rT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:w,renderParameterField:_,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const S=new Set;return l.forEach($=>{$.status==="recommended"&&$.selectable&&S.add($.column)}),Array.from(S)},[l]),M=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),j=l.length>0,C=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:M}),i.autoDetectDefault&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((S,$)=>a.jsx("li",{children:S},`dummy-note-${$}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(S=>{const $=w.includes(S.column),A=nT[S.status],L=sT[S.status]??"canvas-cast__chip--muted",T=S.sample_values.length?S.sample_values.join(", "):"",P=S.unique_count!==void 0&&S.unique_count!==null?`${N0(S.unique_count)} (${N0(S.unique_percentage)}%)`:"",z=N(S.missing_percentage),W=S.estimated_dummy_columns?S.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:S.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[S.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",S.dtype]}),S.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:S.text_category}),S.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",T]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:S.reason})]})}),a.jsx("td",{children:P}),a.jsx("td",{children:z}),a.jsx("td",{children:W}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:A})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>b(S.column),disabled:!S.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:S.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${S.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&_(u),d&&_(d),p&&_(p),h&&_(h),f&&_(f),g&&_(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),_(c)]})]})},aT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},oT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},C0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),lT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:l,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:w,renderParameterField:_,onToggleColumn:b,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=v.useMemo(()=>{if(!l.length)return[];const S=new Set;return l.forEach($=>{$.status==="recommended"&&$.selectable&&S.add($.column)}),Array.from(S)},[l]),M=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),j=l.length>0,C=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:M}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((S,$)=>a.jsx("li",{children:S},`one-hot-note-${$}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(S=>{const $=w.includes(S.column),A=aT[S.status],L=oT[S.status]??"canvas-cast__chip--muted",T=S.sample_values.length?S.sample_values.join(", "):"",P=S.unique_count!==void 0&&S.unique_count!==null?`${C0(S.unique_count)} (${C0(S.unique_percentage)}%)`:"",z=N(S.missing_percentage),W=S.estimated_dummy_columns?S.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:S.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[S.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",S.dtype]}),S.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:S.text_category}),S.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",T]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:S.reason})]})}),a.jsx("td",{children:P}),a.jsx("td",{children:z}),a.jsx("td",{children:W}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:A})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>b(S.column),disabled:!S.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:S.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${S.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&_(u),d&&_(d),p&&_(p),h&&_(h),f&&_(f),g&&_(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),_(c)]})]})},S0={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},iT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},E0=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},cT=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(s=>s&&s.split===t)??null:null,Wp=(e,t)=>{const n=cT(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const s=S0[n.action]??n.action,l=E0(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:s}),l&&a.jsx("span",{className:"canvas-cast__muted",children:l})]})},uT=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(s=>s&&!["train","test","validation"].includes(s.split));return t.length&&t.map(s=>{const l=s.label||s.split,i=S0[s.action]??s.action,c=E0(s.rows??null);return c?`${l}: ${i} (${c})`:`${l}: ${i}`}).join("; ")||null},dT=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,mT=({signal:e,previewStatus:t,hasSource:n,hasReachableSource:s,onRefreshPreview:l})=>{const i=v.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),c=(e==null?void 0:e.total_transformers)??i.length,u=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],d=t==="loading",p=c?`Tracking ${c.toLocaleString()} transformer${c===1?"":"s"}.`:null,h=d||!n||!s;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:h,children:d?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),p&&a.jsx("p",{className:"canvas-modal__note",children:p}),!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),n&&!s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),u.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:u.map((f,g)=>a.jsx("li",{children:f},`transformer-audit-note-${g}`))}),d&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!d&&t==="error"&&n&&s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!d&&n&&s&&!i.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!d&&i.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:i.map((f,g)=>{const w=f.storage_key??`${f.transformer_name}-${f.column_name??"all"}-${g}`,_=uT(f),b=f.source_node_label||f.source_node_id||"",x=iT(f.updated_at??f.created_at??null),N=f.column_name??"",E=dT(f);return a.jsxs(ge.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:b})})}),a.jsx("td",{children:f.transformer_name}),a.jsx("td",{children:N}),a.jsx("td",{children:E||""}),a.jsx("td",{children:Wp(f,"train")}),a.jsx("td",{children:Wp(f,"test")}),a.jsx("td",{children:Wp(f,"validation")}),a.jsx("td",{children:x})]}),_&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",_]})})})]},w)})})]})})]})},Kp=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",hT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},fT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},pT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:l,config:i,targetColumnParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p})=>{var se,Q,H,Y;const h=s.data,f=s.status,g=Array.isArray(h==null?void 0:h.applied_steps)?h.applied_steps:[],w=Array.isArray(h==null?void 0:h.columns)?h==null?void 0:h.columns:[],_=Array.isArray((se=h==null?void 0:h.signals)==null?void 0:se.feature_target_split)?(Q=h==null?void 0:h.signals)==null?void 0:Q.feature_target_split:[],b=fT(_,e),x=(i==null?void 0:i.targetColumn)??"",N=(b==null?void 0:b.target_column)??x,E=(i==null?void 0:i.featureColumns)??[],M=v.useMemo(()=>Array.isArray(h==null?void 0:h.column_stats)?h==null?void 0:h.column_stats:[],[h==null?void 0:h.column_stats]),j=v.useMemo(()=>{const X=new Map;return M.forEach(ee=>{ee!=null&&ee.name&&X.set(ee.name,ee)}),X},[M]),C=v.useMemo(()=>{var X;return(X=b==null?void 0:b.feature_columns)!=null&&X.length?b.feature_columns:E.length?E:N?w.filter(ee=>ee!==N):w.slice()},[b==null?void 0:b.feature_columns,E,w,N]),S=(b==null?void 0:b.auto_included_columns)??[],$=(b==null?void 0:b.missing_feature_columns)??[],A=(b==null?void 0:b.excluded_columns)??[],L=(b==null?void 0:b.target_missing_count)??0,T=typeof(b==null?void 0:b.target_missing_percentage)=="number"?b.target_missing_percentage:null,P=(b==null?void 0:b.target_dtype)??(N?((H=j.get(N))==null?void 0:H.dtype)??null:null),z=typeof((Y=h==null?void 0:h.metrics)==null?void 0:Y.row_count)=="number"?h.metrics.row_count:null,W=C.length,D=S.length,R=A.length,U=$.length,V=v.useMemo(()=>hT(g),[g]),B=v.useMemo(()=>{const X=[];if(X.push({label:"Target column",value:N||"Not set"}),X.push({label:"Feature columns",value:d(W)}),z!==null&&X.push({label:"Preview rows",value:d(z)}),D&&X.push({label:"Auto-selected features",value:d(D)}),U&&X.push({label:"Configured features missing",value:d(U)}),R&&X.push({label:"Excluded columns",value:d(R)}),L){const ee=d(L),J=T!==null?p(T):null;X.push({label:"Target missing values",value:J?`${ee} (${J})`:ee})}return X},[D,R,W,d,p,U,z,N,L,T]),G=v.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),q=v.useMemo(()=>!t||!n?null:f==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,f,t]),F=v.useMemo(()=>N?f==="success"&&N&&!w.includes(N)?`Target column "${N}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[w,f,N]),K=!!t&&n&&f!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:!K,children:f==="loading"?"Refreshing...":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),G&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:G}),s.error&&f==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:q}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:F}),U>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",Kp($),"."]}),R>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",Kp(A),"."]}),D>0&&E.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",Kp(S),"."]}),V&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:V}),B.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:B.map(X=>a.jsxs("li",{children:[X.label,": ",a.jsx("strong",{children:X.value})]},`feature-target-summary-${X.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:c&&u(c)}),f==="success"&&W===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",P?a.jsx("strong",{children:P}):a.jsx("span",{children:"Unknown"}),L?` - Missing rows flagged for review: ${d(L)}.`:""]})]})},gT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},ta=e=>`${(e*100).toFixed(1)}%`,_T=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:l,config:i,parameters:c,renderParameterField:u,formatMetricValue:d})=>{var T,P;const p=s.data,h=s.status,f=Array.isArray((T=p==null?void 0:p.signals)==null?void 0:T.train_test_split)?(P=p==null?void 0:p.signals)==null?void 0:P.train_test_split:[],g=gT(f,e),w=(i==null?void 0:i.test_size)??.2,_=(i==null?void 0:i.validation_size)??0,b=i==null?void 0:i.random_state;i==null||i.shuffle;const x=(i==null?void 0:i.stratify)??!1,N=(i==null?void 0:i.target_column)??"",E=_>0,M=v.useMemo(()=>g?{trainSize:g.train_size??0,validationSize:g.validation_size??0,testSize:g.test_size??0,totalSize:g.total_size??0,trainRatio:g.train_size&&g.total_size?g.train_size/g.total_size:0,validationRatio:g.validation_ratio??0,testRatio:g.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-w-_,validationRatio:_,testRatio:w},[g,w,_]),j=c.find(z=>z.name==="test_size"),C=c.find(z=>z.name==="validation_size"),S=c.find(z=>z.name==="random_state"),$=c.find(z=>z.name==="shuffle"),A=c.find(z=>z.name==="stratify"),L=c.find(z=>z.name==="target_column");return a.jsxs("div",{className:"node-settings__section",children:[a.jsx("div",{className:"node-settings__section-header",children:a.jsx("h3",{children:"Train/Test Split Configuration"})}),a.jsxs("div",{className:"node-settings__field-group",children:[j&&u(j),C&&u(C),S&&u(S),$&&u($),A&&u(A),x&&L&&u(L)]}),h==="success"&&g&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:ta(M.trainRatio)},title:`Training: ${M.trainSize} rows (${ta(M.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),E&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:ta(M.validationRatio)},title:`Validation: ${M.validationSize} rows (${ta(M.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:ta(M.testRatio)},title:`Test: ${M.testSize} rows (${ta(M.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:d(M.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(M.trainSize,0)," (",ta(M.trainRatio),")"]})]}),E&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(M.validationSize,0)," (",ta(M.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(M.testSize,0)," (",ta(M.testRatio),")"]})]}),x&&N&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:N})]}),b!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:b})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",children:[a.jsx("span",{className:"node-settings__warning-icon",children:""}),"Connect this node to a data source to configure the split."]}),h==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),h==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},vT={classification:"Classification",regression:"Regression"},yT=e=>e==="numeric"||e==="integer",bT=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},Yp=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,xT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},wT=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:s,config:l,targetColumnParameter:i,problemTypeParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p,schemaColumns:h})=>{var H;const f=n.data,g=n.status,w=Array.isArray(f==null?void 0:f.applied_steps)?f.applied_steps:[],_=Array.isArray(f==null?void 0:f.column_stats)?f.column_stats:[],b=(f==null?void 0:f.metrics)??null,x=v.useMemo(()=>Array.isArray(f==null?void 0:f.columns)?f.columns.filter(Y=>typeof Y=="string"&&Y.trim().length>0):[],[f==null?void 0:f.columns]),N=v.useMemo(()=>{var Y;return h.length?h:Array.isArray((Y=f==null?void 0:f.schema)==null?void 0:Y.columns)?f.schema.columns:x.length>0?x.map(X=>({name:X,pandas_dtype:null,logical_family:"unknown",nullable:!0})):[]},[(H=f==null?void 0:f.schema)==null?void 0:H.columns,x,h]),E=v.useMemo(()=>{const Y=new Map;return N.forEach(X=>{X!=null&&X.name&&Y.set(X.name,X)}),Y},[N]),M=(l==null?void 0:l.targetColumn)??"",j=(l==null?void 0:l.problemType)??"classification",C=M?_.find(Y=>(Y==null?void 0:Y.name)===M)??null:null,$=!!(M?E.get(M)??null:null),A=v.useMemo(()=>{const Y=new Set;return _.forEach(X=>{X!=null&&X.name&&X.name!==M&&Y.add(X.name)}),N.forEach(X=>{X!=null&&X.name&&X.name!==M&&Y.add(X.name)}),Array.from(Y).sort()},[_,N,M]),L=v.useMemo(()=>A.filter(Y=>{const X=E.get(Y);if(X&&yT(X.logical_family))return!0;const ee=_.find(J=>J.name===Y);return bT((ee==null?void 0:ee.dtype)??null)}),[_,A,E]),T=v.useMemo(()=>new Set(L),[L]),P=v.useMemo(()=>A.filter(Y=>!T.has(Y)),[A,T]),z=v.useMemo(()=>_.filter(Y=>(Y==null?void 0:Y.name)&&Y.name!==M&&(Y.missing_count??0)>0).map(Y=>Y.name),[_,M]),W=typeof(b==null?void 0:b.row_count)=="number"?b.row_count:null,D=typeof(C==null?void 0:C.distinct_count)=="number"&&Number.isFinite(C.distinct_count)?C.distinct_count:null,R=typeof(C==null?void 0:C.missing_count)=="number"?C.missing_count:0,U=typeof(C==null?void 0:C.missing_percentage)=="number"?C.missing_percentage:null,V=v.useMemo(()=>{const Y=[];return M?g!=="success"?Y:!C&&!$&&!A.length?(Y.push(`Target column "${M}" is not present in the preview output, and no feature columns were found.`),Y):(A.length||Y.push("Add at least one feature column in addition to the target before training."),C&&R>0&&Y.push(`Target column includes ${R} missing value${R===1?"":"s"}.`),j==="classification"&&C&&(D??0)<2&&Y.push("Classification tasks require at least two distinct target classes."),j==="regression"&&L.length===0&&Y.push("Regression tasks need at least one numeric feature column."),z.length>0&&Y.push(`Feature columns with missing values: ${Yp(z)}.`),W!==null&&W===0&&Y.push("Preview returned zero rows after upstream transformations."),Y):(Y.push("Set a target column to evaluate downstream modeling constraints."),Y)},[z,A.length,R,L.length,W,g,j,M,D,C,$]),B=v.useMemo(()=>vT[j],[j]),G=v.useMemo(()=>{const Y=[{label:"Problem type",value:B},{label:"Target column",value:M||"Not set"}];if(g==="success"){if(D!==null&&Y.push({label:"Target distinct values",value:d(D)}),C){const X=d(R),ee=U!==null?p(U):null;Y.push({label:"Target missing values",value:ee?`${X} (${ee})`:X})}z.length>0&&Y.push({label:"Features with missing values",value:d(z.length)})}return Y},[B,z.length,d,p,R,g,M,D,U,C]),q=v.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),F=v.useMemo(()=>!e||!t?null:g==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,g,e]),K=v.useMemo(()=>xT(w),[w]),se=!!e&&t&&g!=="loading",Q=v.useMemo(()=>!M||g!=="success"||V.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[g,V.length,M]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:!se,children:g==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:q}),n.error&&g==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:F}),V.map((Y,X)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Y},`train-model-issue-${X}`)),Q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:Q}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:K}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[i&&u(i),c&&u(c)]}),G.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:G.map(Y=>a.jsxs("li",{children:[Y.label,": ",a.jsx("strong",{children:Y.value})]},`train-model-summary-${Y.label}`))}),g==="success"&&z.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",Yp(z),"."]}),g==="success"&&j==="regression"&&P.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",Yp(P),". Consider encoding or casting them before training regression models."]})]})},k0=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?Ys(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},jT=e=>e||"Unknown",NT=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},Qn=e=>{const t=NT(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const s=Math.round(n/60);if(s===1)return"1 hour ago";if(s<24)return`${s} hours ago`;const l=Math.round(s/24);return l===1?"1 day ago":`${l} days ago`},M0=e=>typeof e!="number"||!Number.isFinite(e)?"":Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3),CT=({presets:e,isOpen:t,onClose:n,onApply:s,activePresetId:l,fieldMetadata:i})=>{const[c,u]=v.useState(null);v.useEffect(()=>{var f;if(!t){u(null);return}c&&e.some(g=>g.id===c)||u(((f=e[0])==null?void 0:f.id)??null)},[t,e,c]),v.useEffect(()=>{if(!t)return;const f=g=>{g.key==="Escape"&&n()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[t,n]);const d=v.useMemo(()=>c?e.find(f=>f.id===c)??e[0]??null:e[0]??null,[e,c]),p=v.useMemo(()=>!l||!d?!1:l===d.id,[l,d]),h=v.useMemo(()=>{var x,N;if(!t||!e.length)return null;const f=((x=d==null?void 0:d.modelType)==null?void 0:x.toLowerCase())==="logistic_regression"?(N=d==null?void 0:d.params)==null?void 0:N.solver:null,g=typeof f=="string"?f.trim().toLowerCase():null,w=g&&(g==="sag"||g==="saga")?"SAG and SAGA solvers expect standardized features. Scale inputs before training to improve convergence and avoid repeated warnings.":null,_=d?Object.entries(d.params??{}).sort(([E],[M])=>E.localeCompare(M)).map(([E,M])=>{const j=i==null?void 0:i[E],C=P=>{var z;return(z=j==null?void 0:j.options)!=null&&z.length?j.options.find(W=>{const D=W.value;return P==null?D===null||typeof D=="string"&&D.trim().toLowerCase()==="none":typeof P=="string"&&typeof D=="string"?D===P?!0:D.trim().toLowerCase()===P.trim().toLowerCase():String(D)===String(P)})??null:null},S=P=>{if(P===null)return j!=null&&j.nullable?"None":"";if(P===void 0)return"";if(typeof P=="boolean")return P?"true":"false";if(typeof P=="number")return Number.isFinite(P)?P.toString():String(P);if(P&&typeof P=="object")try{return JSON.stringify(P)}catch{return"[object]"}return String(P??"")},$=P=>{var R;if(!P)return null;const z=P.value,W=(R=P.label)==null?void 0:R.trim(),D=S(z);return W&&D&&W!==D?`${W} (${D})`:W||D},A=()=>{if(j&&j.default!==void 0){const P=L(j.default,!1);if(P.text)return{text:P.text,note:"Using estimator default"}}return{text:"",note:"Using estimator default"}},L=(P,z=!0)=>{const W=C(P);return W?{text:$(W)??"",note:null}:Array.isArray(P)?P.length===0?z?A():{text:"",note:null}:{text:P.map(R=>L(R,!1)).map(R=>R.text).filter(Boolean).join(", "),note:null}:P===void 0||typeof P=="string"&&P.trim()===""?z?A():{text:"",note:null}:P===null?j!=null&&j.nullable?{text:"None",note:null}:z?A():{text:"",note:null}:{text:S(P),note:null}},T=L(M);return{key:E,label:(j==null?void 0:j.label)??E,description:(j==null?void 0:j.description)??null,value:T.text,note:T.note}}):[],b=d!=null&&d.finishedAt?Qn(d.finishedAt):null;return a.jsxs("div",{className:"canvas-modal best-param-modal",role:"dialog","aria-modal":"true",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:n}),a.jsxs("div",{className:"canvas-modal__panel best-param-modal__panel",role:"document",children:[a.jsxs("header",{className:"best-param-modal__header",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"best-param-modal__title",children:"Tuned Hyperparameter Presets"}),a.jsx("p",{className:"best-param-modal__subtitle",children:"Review hyperparameter sets discovered by recent tuning runs and apply them to the current model."})]}),a.jsx("button",{type:"button",className:"best-param-modal__close",onClick:n,children:"Close"})]}),a.jsxs("div",{className:"best-param-modal__layout",children:[a.jsx("aside",{className:"best-param-modal__list","aria-label":"Tuned presets",children:e.map(E=>{const M=E.id===(d==null?void 0:d.id),j=E.finishedAt?Qn(E.finishedAt):null;return a.jsxs("button",{type:"button",className:`best-param-modal__list-button${M?" best-param-modal__list-button--active":""}`,onClick:()=>u(E.id),children:[a.jsx("span",{className:"best-param-modal__list-title",children:E.label}),a.jsxs("span",{className:"best-param-modal__list-meta",children:[E.runNumber?`Run ${E.runNumber}`:"Tuning run",j?`  ${j}`:""]}),E.scoring&&a.jsxs("span",{className:"best-param-modal__list-score",children:[E.scoring,": ",M0(E.score)]}),E.targetColumn&&a.jsxs("span",{className:"best-param-modal__list-target",children:["Target: ",E.targetColumn]})]},E.id)})}),a.jsx("section",{className:"best-param-modal__details",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"best-param-modal__summary",children:[a.jsxs("div",{className:"best-param-modal__summary-main",children:[a.jsx("h4",{children:d.label}),a.jsxs("p",{children:[d.runNumber?`Run ${d.runNumber}`:"Tuning run",b?`  ${b}`:"",d.searchStrategy?`  ${d.searchStrategy}`:""]}),a.jsxs("p",{children:["Model: ",a.jsx("strong",{children:d.modelType}),d.targetColumn?a.jsxs(a.Fragment,{children:[" "," Target: ",a.jsx("strong",{children:d.targetColumn})]}):null,d.scoring?a.jsxs(a.Fragment,{children:[" "," ",d.scoring,": ",a.jsx("strong",{children:M0(d.score)})]}):null]})]}),a.jsx("div",{className:"best-param-modal__summary-actions",children:a.jsx("button",{type:"button",className:"best-param-modal__apply",onClick:()=>s(d),disabled:!_.length,children:p?"Already applied":"Apply preset"})})]}),d.description&&a.jsx("p",{className:"best-param-modal__note",children:d.description}),w&&a.jsxs("div",{className:"best-param-modal__notice best-param-modal__notice--warning",children:[a.jsx("strong",{children:"Tip:"})," ",w]}),a.jsx("div",{className:"best-param-modal__param-grid",role:"table",children:_.length?_.map(E=>a.jsxs("div",{className:"best-param-modal__param-row",role:"row",children:[a.jsxs("div",{className:"best-param-modal__param-name",role:"cell",children:[a.jsxs("div",{className:"best-param-modal__param-label",children:[E.label,E.label!==E.key&&a.jsx("span",{className:"best-param-modal__param-key",children:a.jsx("code",{children:E.key})})]}),E.description&&a.jsx("div",{className:"best-param-modal__param-description",children:E.description})]}),a.jsxs("div",{className:"best-param-modal__param-value",role:"cell",children:[a.jsx("code",{children:E.value}),E.note&&a.jsx("span",{className:"best-param-modal__param-note",children:E.note})]})]},E.key)):a.jsx("p",{className:"best-param-modal__empty",children:"No hyperparameters available for this preset."})})]}):a.jsx("p",{className:"best-param-modal__empty",children:"Select a tuning run to inspect its hyperparameters."})})]})]})]})},[l,p,i,t,s,n,e,d]);return h?z_.createPortal(h,document.body):null},ST=new Set(["scale_numeric_features","scaling","scale_numeric"]),ET=[/convergencewarning/i,/failed to converge/i,/did not converge/i,/optimizer failed to converge/i,/increase the number of iterations/i,/scale your features/i,/standardize your features/i,/consider scaling your (data|features)/i,/feature scaling is (recommended|required)/i],kT=["forest","tree","boost","xgboost","lightgbm","catboost","gradient","histgradient","bagging"],MT=["bayes","naive_bayes","gaussian_nb"],AT=e=>{const t=e.trim().toLowerCase();return t?kT.some(s=>t.includes(s))?{required:!1,reason:null}:MT.some(s=>t.includes(s))?{required:!1,reason:null}:t.includes("logistic")?{required:!0,reason:"logistic"}:t.includes("svm")||t.includes("svc")||t.includes("svr")?{required:!0,reason:"svm"}:t.includes("knn")||t.includes("nearest")?{required:!0,reason:"knn"}:t.includes("sgd")||t.includes("perceptron")?{required:!0,reason:"sgd"}:["linear","ridge","lasso","elastic","regression"].some(s=>t.includes(s))?{required:!0,reason:"linear"}:{required:!1,reason:null}:{required:!1,reason:null}},OT=(e,t)=>{const n=new Set;if(!e||!t)return n;const s=Array.isArray(e.edges)?e.edges:[],l=[t];for(;l.length;){const i=l.pop();if(i)for(const c of s){if(!c)continue;const u=typeof c.source=="string"?c.source.trim():"",d=typeof c.target=="string"?c.target.trim():"";!u||!d||d===i&&!n.has(u)&&(n.add(u),l.push(u))}}return n},PT=(e,t)=>{if(!e||!t)return!1;const n=OT(e,t);return n.size?(Array.isArray(e.nodes)?e.nodes:[]).some(l=>{var c;if(!l||typeof l.id!="string"||!n.has(l.id))return!1;const i=String(((c=l==null?void 0:l.data)==null?void 0:c.catalogType)??(l==null?void 0:l.type)??"").toLowerCase();return i?ST.has(i)?!0:i.includes("scale")&&i.includes("numeric"):!1}):!1},TT=(e,t)=>{const n=t.find(s=>(s==null?void 0:s.value)===e);return n!=null&&n.label?n.label:e.replace(/_/g," ").replace(/\s+/g," ").trim()},Gp=(e,t=new Set,n=0)=>{if(e==null)return[];if(typeof e=="string")return[e];if(typeof e=="number"||typeof e=="boolean")return[];if(n>3)return[];if(Array.isArray(e)){if(!e.length)return[];const s=32,l=[];for(let i=0;i<e.length&&i<s;i+=1)l.push(...Gp(e[i],t,n+1));return l}if(typeof e=="object"){if(t.has(e))return[];t.add(e);const s=Object.values(e);if(!s.length)return[];const l=32,i=[];for(let c=0;c<s.length&&c<l;c+=1)i.push(...Gp(s[c],t,n+1));return i}return[]},ei=e=>{if(!e)return!1;const t=Gp(e);return t.length?t.some(n=>ET.some(s=>s.test(n))):!1},Lc=e=>{var n,s,l,i,c,u,d,p,h,f,g,w,_,b;if(!e)return!1;const t=[e.error_message,e.warning_message,e.message,e.details,e.notes,e.status_reason,e.status_message,e.error,(n=e.metadata)==null?void 0:n.warnings,(s=e.metadata)==null?void 0:s.warning,(l=e.metadata)==null?void 0:l.notes,(i=e.metadata)==null?void 0:i.messages,(c=e.metadata)==null?void 0:c.message,(u=e.metadata)==null?void 0:u.errors,(d=e.metrics)==null?void 0:d.warnings,(p=e.metrics)==null?void 0:p.warning,(h=e.metrics)==null?void 0:h.messages,(f=e.metrics)==null?void 0:f.message,(g=e.job_metadata)==null?void 0:g.warnings,(w=e.job_metadata)==null?void 0:w.warning,(_=e.job_metadata)==null?void 0:_.messages,(b=e.job_metadata)==null?void 0:b.notes];for(const x of t)if(ei(x))return!0;return!!(ei(e.metadata)||ei(e.metrics))},$T=(e,t,n)=>{const s=t||"This model";switch(e){case"logistic":return{headline:`${s} needs scaled numeric features`,summary:'Standardize numeric inputs before launching jobs to keep the logistic solver stable and avoid repeated "scale your features" warnings.',details:["Insert a Scale numeric features step before this node or reuse an upstream scaler.","StandardScaler works for most datasets; RobustScaler can help when outliers dominate.","Once scaling is in place, re-run tuning or training so the solver converges cleanly."]};case"svm":return{headline:`${s} is sensitive to feature scale`,summary:"Support Vector Machines depend on distance calculations. Keep numeric features on comparable scales to preserve margin geometry.",details:["Add the Scale numeric features step upstream of this node.","Try StandardScaler or MinMaxScaler depending on the kernel and expected ranges.","Retrain after scaling to refresh support vectors and hyperparameters."]};case"knn":return{headline:`${s} uses distance-based comparisons`,summary:"k-NN models weigh distances directly, so unscaled columns dominate neighbors. Scale numeric fields to keep votes balanced.",details:["Drop in a Scale numeric features step before launching jobs.","MinMaxScaler keeps features in [0, 1]; StandardScaler works when values are roughly normal.","Requeue jobs after scaling so neighbor search reflects the new feature space."]};case"sgd":return{headline:`${s} benefits from normalized inputs`,summary:"Stochastic gradient models converge faster and produce steadier coefficients when numeric inputs share a common scale.",details:["Insert a Scale numeric features node prior to this step.","StandardScaler plus optional RobustScaler for heavy-tailed features keeps gradients stable.","Re-run jobs after scaling to avoid exploding or vanishing updates."]};default:return{headline:`${s} prefers standardized numeric features`,summary:n==="regression"?"Linear regression families rely on comparable feature magnitudes. Scaling keeps coefficients well-conditioned and improves R stability.":"Linear classification models respond better when numeric inputs share a common scale. Scaling prevents any single column from dominating the loss.",details:["Add the Scale numeric features step ahead of this node or reuse an existing scaler.","StandardScaler is a safe default; RobustScaler helps when outliers skew distributions.","Re-launch jobs once scaling is applied so coefficients represent the standardized space."]}}},A0=({graph:e,nodeId:t,modelType:n,problemType:s,modelTypeOptions:l,enabled:i})=>v.useMemo(()=>{if(!i||!n||!n.trim()||PT(e,t))return null;const c=n.trim().toLowerCase(),{required:u,reason:d}=AT(c);if(!u||!d)return null;const p=TT(n,l);return $T(d,p,s)},[i,e,n,l,t,s]),LT={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},ti={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},Qp=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([s,l])=>{t.has(s)&&(n[s]=l)}),n},O0=(e,t)=>{if(e===t||typeof e=="number"&&typeof t=="number"&&Number.isNaN(e)&&Number.isNaN(t))return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length!==t.length?!1:e.every((n,s)=>O0(n,t[s]));if(e&&t&&typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1},zT=(e,t,n)=>{if(!e)return{};const s={};return Object.entries(e).forEach(([l,i])=>{if(!t.has(l)||i===""||i===null||i===void 0)return;const c=n==null?void 0:n[l];let u=i;if(c){if(typeof u=="string"){const d=u.trim();if(!d)return;c.type==="select"&&(u=d)}if(c.name==="multi_class"&&typeof u=="string"){const d=u.trim().toLowerCase();if(d==="auto")return;(d==="ovr"||d==="multinomial")&&(u=d)}if(c.default!==void 0){if(typeof c.default=="string"&&typeof u=="string"){const d=c.default.trim(),p=u.trim();if(d===p)return}else if(O0(c.default,u))return}}s[l]=u}),s},P0=e=>!!e&&typeof e=="object"&&!Array.isArray(e),zc=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},DT=e=>{if(!e)return ti.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return ti.regression;if(t.includes("classifier")||t.includes("classification"))return ti.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?ti.regression:n==="classification"?ti.classification:ti.fallback},RT=e=>{var i,c,u;if(!e)return null;const t=[],n=(c=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:c.mean;P0(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const s=[e.test,e.validation,e.train];for(const d of s)P0(d)&&t.push({dataset:d,labelPrefix:""});const l=DT(e);for(const d of t)for(const p of l){const h=d.dataset[p];if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h}}for(const d of t)for(const[p,h]of Object.entries(d.dataset))if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h};return null},T0=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",FT=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:l,cvConfig:i,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,hyperparametersParameter:h,cvEnabledParameter:f,cvStrategyParameter:g,cvFoldsParameter:w,cvShuffleParameter:_,cvRandomStateParameter:b,cvRefitStrategyParameter:x,onSaveDraftConfig:N})=>{var Un,Js,cs,wr;const E=Mo(),[M,j]=v.useState(null),[C,S]=v.useState(null),[$,A]=v.useState(null),[L,T]=v.useState(0),[P,z]=v.useState({}),[W,D]=v.useState(!1),R=v.useRef(!1),[U,V]=v.useState(null),[B,G]=v.useState(!1),[q,F]=v.useState(!1),[K,se]=v.useState(null),[Q,H]=v.useState(null),[Y,X]=v.useState(!1),ee=((s==null?void 0:s.targetColumn)??"").trim(),J=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",re=((l==null?void 0:l.modelType)??"").trim(),we=(l==null?void 0:l.hyperparameters)??null,Pe=(l==null?void 0:l.hyperparametersError)??null,Me=!!(i!=null&&i.enabled),Fe=(i==null?void 0:i.strategy)??"auto",Ke=typeof(i==null?void 0:i.folds)=="number"?i.folds:0,Ue=!!(i!=null&&i.shuffle),de=(i==null?void 0:i.randomState)??null,pe=(i==null?void 0:i.refitStrategy)??"train_plus_validation",xe=v.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),ke=Hs({queryKey:["model-hyperparameters",re],queryFn:()=>lm(re),enabled:!!re,staleTime:5*60*1e3}),De=Hs({queryKey:["best-hyperparameters",re,U,t],queryFn:()=>rx(re,{pipelineId:U||void 0,datasetSourceId:t||void 0}),enabled:!!(re&&t),staleTime:30*1e3,retry:1}),ce=((Un=ke.data)==null?void 0:Un.fields)??[],Oe=((Js=ke.data)==null?void 0:Js.defaults)??{},Ye=v.useMemo(()=>ce.length?new Set(ce.map(le=>le.name)):new Set,[ce]),ct=v.useMemo(()=>ce.length?ce.reduce((le,_e)=>(_e!=null&&_e.name&&(le[_e.name]=_e),le),{}):{},[ce]),Je=v.useMemo(()=>{if(!re||!we||Ye.size===0)return null;const le=Qp(we,Ye);return Object.keys(le).length>0?le:null},[Ye,we,re]);v.useEffect(()=>{z({}),D(!1),R.current=!1},[re]),v.useEffect(()=>{Je&&(z(le=>{const _e=Object.keys(le),$e=Object.keys(Je);return _e.length===$e.length&&$e.every(je=>Object.is(le[je],Je[je]))?le:Je}),R.current||(D(!0),R.current=!0))},[Je]),v.useEffect(()=>{if(!re||Je||Ye.size===0||!Oe||Object.keys(Oe).length===0)return;const le=Qp(Oe,Ye);Object.keys(le).length!==0&&z(_e=>Object.keys(_e).length>0?_e:le)},[Ye,Je,Oe,re]);const mt=v.useMemo(()=>{if(Ye.size===0)return null;const le=zT(P,Ye,ct);return Object.keys(le).length>0?le:null},[Ye,P]),Ze=v.useCallback(()=>{D(le=>{const _e=!le;return _e&&(R.current=!0),_e})},[]),ot=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),Et=v.useMemo(()=>{if(!ot)return null;if(!c||Object.keys(c).length===0)return ot;const le=zc(ot);return!le||!Array.isArray(le.nodes)||(le.nodes=le.nodes.map(_e=>{if(!_e||_e.id!==e)return _e;const $e=(_e==null?void 0:_e.data)??{},je={...($e==null?void 0:$e.config)??{},...c};return{..._e,data:{...$e,config:je,isConfigured:!0}}})),le},[c,ot,e]);v.useEffect(()=>{let le=!1;return!t||!ot?(V(null),()=>{le=!0}):(Do(t,ot).then(_e=>{le||V(_e)}).catch(()=>{le||V(null)}),()=>{le=!0})},[ot,t]),v.useEffect(()=>{let le=!1;S(null);const _e=Et??ot;return!t||!_e?(j(null),()=>{le=!0}):(Do(t,_e).then($e=>{le||j($e)}).catch($e=>{le||(S(($e==null?void 0:$e.message)??"Unable to compute pipeline ID"),j(null))}),()=>{le=!0})},[ot,Et,t]),v.useEffect(()=>{if(!M||!U){G(!1);return}G(M!==U)},[M,U]);const zt=v.useMemo(()=>["feature-canvas","training-jobs",t??"none",M??"pending",e],[e,M,t]),We=v.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",M??"pending",e],[e,M,t]),Dt=!!(t&&e),ht=Hs({queryKey:We,queryFn:async()=>{var _e;const le={datasetSourceId:t||void 0,limit:5};if(M){const $e=await Cc({...le,pipelineId:M});if((((_e=$e==null?void 0:$e.jobs)==null?void 0:_e.length)??0)>0)return $e}return Cc(le)},enabled:Dt,retry:(le,_e)=>_e.message.includes("Sign in")?!1:le<2,refetchInterval:le=>{const _e=le.state.data;return((_e==null?void 0:_e.jobs)??[]).some(je=>je.status==="queued"||je.status==="running")?5e3:!1}}),kt=Hs({queryKey:zt,queryFn:async()=>{var _e;const le={datasetSourceId:t||void 0,nodeId:e,limit:5};if(M){const $e=await Nc({...le,pipelineId:M});if((((_e=$e==null?void 0:$e.jobs)==null?void 0:_e.length)??0)>0)return $e}return Nc(le)},enabled:Dt,retry:(le,_e)=>_e.message.includes("Sign in")?!1:le<2,refetchInterval:le=>{const _e=le.state.data;return((_e==null?void 0:_e.jobs)??[]).some(je=>je.status==="queued"||je.status==="running")?5e3:!1}}),{mutateAsync:sn,isPending:wn,error:Mt}=Ed({mutationFn:ex,onSuccess:le=>{const _e=Array.isArray(le.jobs)?le.jobs.length:0,$e=_e>0?le.jobs[0]:null;A($e),T(_e),E.invalidateQueries({queryKey:zt})}}),rn=ht.error,Fn=ht.isLoading||ht.isFetching,Ut=((cs=ht.data)==null?void 0:cs.jobs)??[],it=De.data,In=v.useCallback(le=>{if(!le)return null;const _e=Object.keys(le);if(_e.length===0)return null;if(Ye.size===0)return{params:le,hasUnmapped:!1};const $e=Qp(le,Ye),Ct=Object.keys($e);return Ct.length>0?{params:$e,hasUnmapped:Ct.length!==_e.length}:{params:le,hasUnmapped:!0}},[Ye]),Zt=v.useMemo(()=>Ut.length?Ut.filter(le=>le.status==="succeeded"):[],[Ut]),gn=v.useMemo(()=>{if(!re)return[];const le=[],_e=new Set,$e=ee?ee.trim().toLowerCase():"",Ct=je=>!$e||!je?!0:je.trim().toLowerCase()===$e;if(it!=null&&it.available&&it.best_params&&(!it.model_type||it.model_type===re)){const je=In(it.best_params);if(je){const tt=it.job_id??null;if(!tt||!_e.has(tt)){const lt=["Most recent tuned run"];it.run_number&&lt.push(`#${it.run_number}`);const Rt=`best-api-${tt??re}`;le.push({id:Rt,label:lt.join(" "),source:"best-api",modelType:it.model_type??re,params:je.params,jobId:tt,nodeId:it.node_id??null,runNumber:it.run_number??null,score:it.best_score??null,scoring:it.scoring??null,finishedAt:it.finished_at??null,searchStrategy:it.search_strategy??null,nIterations:it.n_iterations??null,targetColumn:ee||null,pipelineId:it.pipeline_id??null,datasetSourceId:t??null,description:je.hasUnmapped?"Includes parameters outside the current template. They will be stored as custom overrides.":null}),tt&&_e.add(tt)}}}return Zt.forEach(je=>{var fn,Ts,Zn,Cn,Pn;if(!je.best_params||je.model_type!==re||t&&je.dataset_source_id&&je.dataset_source_id!==t||_e.has(je.id))return;const tt=In(je.best_params);if(!tt)return;const lt=typeof((fn=je.metadata)==null?void 0:fn.target_column)=="string"?je.metadata.target_column:typeof((Ts=je.metadata)==null?void 0:Ts.targetColumn)=="string"?je.metadata.targetColumn:null;if(!Ct(lt))return;const Rt=`job-${je.id}`,Ot=(()=>{var es;const us=typeof((es=je.metadata)==null?void 0:es.label)=="string"?je.metadata.label.trim():"";return us||(je.run_number?`Run ${je.run_number}`:`Job ${je.id.slice(0,6)}`)})(),an=typeof((Zn=je.metadata)==null?void 0:Zn.scoring)=="string"?je.metadata.scoring:typeof((Cn=je.metrics)==null?void 0:Cn.scoring)=="string"?je.metrics.scoring:null,qt=typeof((Pn=je.metadata)==null?void 0:Pn.n_iterations)=="number"?je.metadata.n_iterations:null;le.push({id:Rt,label:Ot,source:"tuning-job",modelType:je.model_type,params:tt.params,jobId:je.id,nodeId:je.node_id,runNumber:je.run_number??null,score:je.best_score??null,scoring:an,finishedAt:je.updated_at??je.created_at??null,searchStrategy:je.search_strategy??null,nIterations:qt,targetColumn:lt??(ee||null),pipelineId:je.pipeline_id??null,datasetSourceId:je.dataset_source_id??null,description:tt.hasUnmapped?"Some tuned parameters fall outside the current template and will be saved as custom overrides.":null}),_e.add(je.id)}),le.sort((je,tt)=>{const lt=je.finishedAt?Date.parse(je.finishedAt):0,Rt=tt.finishedAt?Date.parse(tt.finishedAt):0;return lt!==Rt?Rt-lt:(tt.runNumber??0)-(je.runNumber??0)}),le},[it,In,re,t,ee,Zt]),ft=gn[0]??null,Os=gn.length>0,Yt=!ft,gt=!Os,xt=v.useMemo(()=>Zt.length?Zt.slice().sort((le,_e)=>{const $e=Date.parse(le.updated_at||le.created_at||"0");return Date.parse(_e.updated_at||_e.created_at||"0")-$e})[0]:Ut.length?Ut.slice().sort((le,_e)=>{const $e=Date.parse(le.updated_at||le.created_at||"0");return Date.parse(_e.updated_at||_e.created_at||"0")-$e})[0]:null,[Zt,Ut]),ls=xt&&(xt.updated_at||xt.created_at)||null,dn=ls?Qn(ls):null,jn=(xt==null?void 0:xt.run_number)??null,mn=ft!=null&&ft.finishedAt?Qn(ft.finishedAt):null,An=ft&&ft.scoring&&typeof ft.score=="number"&&Number.isFinite(ft.score)?`${ft.scoring}: ${T0(ft.score)}`:null;v.useEffect(()=>{if(!gn.length){K&&se(null),(Q==null?void 0:Q.tone)==="success"&&H(null);return}K&&!gn.some(le=>le.id===K)&&(se(null),H(null))},[Q,gn,K]);const hn=v.useCallback((le,_e)=>{if(!le||Object.keys(le.params??{}).length===0){H({message:"Selected preset does not include any hyperparameters to apply.",tone:"warning"});return}z(()=>zc(le.params)),D(!0),R.current=!0,se(le.id),H({message:_e??`Applied tuned parameters from ${le.label}.`,tone:"success"})},[z,D,H,se]),is=v.useCallback(()=>{if(!ft){const _e=xt&&xt.model_type&&xt.model_type!==re?`Latest tuning run targeted ${xt.model_type}. Switch the model template to reuse its parameters.`:"No tuning job results available to apply.";H({message:_e,tone:"warning"});return}const le=ft.runNumber?`Applied tuned parameters from run ${ft.runNumber}.`:`Applied tuned parameters from ${ft.label}.`;hn(ft,le)},[hn,xt,re,ft,H]),It=v.useMemo(()=>{if(!Q)return"rgba(148, 163, 184, 0.75)";switch(Q.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[Q]),Bn=v.useMemo(()=>{const le=[];return t||le.push("Select a dataset before launching training jobs."),(!ot||!ot.nodes.length)&&le.push("Connect this node to an upstream pipeline before training."),ee||le.push("Set a target column in the Train model readiness section."),re||le.push("Choose a model type before enqueuing training jobs."),Me&&Ke<2&&le.push("Cross-validation requires at least 2 folds."),C&&le.push(C),Pe&&le.push(Pe),le},[Me,Ke,ot,Pe,re,C,t,ee]),On=((wr=kt.data)==null?void 0:wr.jobs)??[],Nn=v.useMemo(()=>{if(!On.length)return On;const le=J==null?void 0:J.toLowerCase();return On.filter(_e=>{if(!le)return!0;const $e=(()=>{var Rt,Ot,an,qt;const je=typeof _e.problem_type=="string"?_e.problem_type:null,tt=typeof((Rt=_e.metadata)==null?void 0:Rt.problem_type)=="string"?(Ot=_e.metadata)==null?void 0:Ot.problem_type:null,lt=typeof((an=_e.metadata)==null?void 0:an.resolved_problem_type)=="string"?(qt=_e.metadata)==null?void 0:qt.resolved_problem_type:null;return(je||lt||tt||"").toLowerCase()})();if($e)return $e===le;const Ct=String(_e.model_type||"").toLowerCase();return le==="regression"?Ct.includes("regress"):le==="classification"?Ct.includes("classif"):!0})},[On,J]),lr=v.useMemo(()=>!!(Mt instanceof Error&&ei(Mt.message)||$&&Lc($)||On.some(le=>Lc(le))||Ut.some(le=>Lc(le))),[Mt,On,$,Ut]),Xn=A0({graph:n,nodeId:e,modelType:re,problemType:J,modelTypeOptions:p,enabled:lr});v.useEffect(()=>{Xn||X(!1)},[Xn]);const Ps=Math.max(On.length-Nn.length,0),_s=kt.isLoading||kt.isFetching,vs=kt.error,Xs=Bn.length>0||!M||!t||!ot||wn,Jn=v.useCallback((le,_e)=>{z($e=>({...$e,[le]:_e}))},[]),Qt=v.useCallback(le=>{var Ct;const _e=P[le.name]??le.default,$e=`hyperparam-${e}-${le.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:$e,className:"canvas-modal__parameter-label",children:[le.label,le.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:le.description})]}),le.type==="number"&&a.jsx("input",{id:$e,type:"number",className:"canvas-modal__parameter-input",value:_e??"",onChange:je=>{const tt=je.target.value;if(tt===""&&le.nullable)Jn(le.name,null);else{const lt=parseFloat(tt);isNaN(lt)||Jn(le.name,lt)}},min:le.min,max:le.max,step:le.step,placeholder:le.nullable?"Empty = default":""}),le.type==="select"&&a.jsx("select",{id:$e,className:"canvas-modal__parameter-select",value:_e??"",onChange:je=>Jn(le.name,je.target.value),children:(Ct=le.options)==null?void 0:Ct.map(je=>a.jsx("option",{value:je.value,children:je.label},je.value))}),le.type==="boolean"&&a.jsx("input",{id:$e,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!_e,onChange:je=>Jn(le.name,je.target.checked)}),le.type==="text"&&a.jsx("input",{id:$e,type:"text",className:"canvas-modal__parameter-input",value:_e??"",onChange:je=>Jn(le.name,je.target.value),placeholder:le.nullable?"Empty = default":""})]},le.name)},[P,Jn,e]),At=v.useCallback(async()=>{if(!M||!t||!re)return;if(B&&N){try{const lt=N({closeModal:!1});lt&&typeof lt.then=="function"&&await lt,G(!1)}catch{}await new Promise(lt=>setTimeout(lt,100))}const le=Et??ot;if(!le)return;const _e={};ee&&(_e.target_column=ee),_e.problem_type=J,_e.cross_validation={enabled:Me,strategy:Fe,folds:Ke,shuffle:Ue,random_state:de,refit_strategy:pe};const $e=Object.keys(_e).length?_e:void 0,Ct=zc(le);Ct&&Array.isArray(Ct.nodes)&&(Ct.nodes=Ct.nodes.map(lt=>{if(!lt||lt.id!==e)return lt;const Rt=(lt==null?void 0:lt.data)??{},Ot=(Rt==null?void 0:Rt.config)??{},an=c?{...Ot,...c}:Ot;return{...lt,data:{...Rt,config:an,isConfigured:!0}}}));const je=re?[re]:[],tt={dataset_source_id:t,pipeline_id:M,node_id:e,model_type:re||void 0,model_types:je.length?je:void 0,hyperparameters:W&&mt?zc(mt):void 0,metadata:$e,job_metadata:$e,run_training:!0,graph:Ct??zc(le),target_node_id:e};try{await sn(tt)}catch{}},[Me,Ke,de,pe,Ue,Fe,c,sn,ot,Et,B,re,e,N,M,J,mt,W,t,ee]),st=v.useCallback(()=>{Dt&&kt.refetch()},[Dt,kt]),ir=le=>{var fn,Ts,Zn,Cn;const _e=RT(le.metrics??null),$e=le.updated_at?Qn(le.updated_at):null,Ct=le.updated_at||le.created_at,je=Ct?$e??new Date(Ct).toLocaleString():null,tt=LT[le.status]??le.status,lt=(le.problem_type||((fn=le.metadata)==null?void 0:fn.resolved_problem_type)||((Ts=le.metadata)==null?void 0:Ts.problem_type)||"").toString(),Rt=((Zn=le.metadata)==null?void 0:Zn.cross_validation)??null,Ot=((Cn=le.metrics)==null?void 0:Cn.cross_validation)??null,an=typeof le.error_message=="string"?le.error_message.trim():"",qt=[];if(qt.push(`Model ${le.model_type}`),lt&&qt.push(lt.charAt(0).toUpperCase()+lt.slice(1)),Rt!=null&&Rt.enabled){const Pn=String(Rt.strategy??"auto"),us=Pn==="stratified_kfold"?"Stratified KFold":Pn==="kfold"?"KFold":"Auto CV",es=typeof Rt.folds=="number"?`${Rt.folds} folds`:"CV enabled";if(qt.push(`${us} (${es})`),(Ot==null?void 0:Ot.status)==="skipped"){const Ha=String((Ot==null?void 0:Ot.reason)??"unknown reason").replace(/_/g," ");qt.push(`CV skipped (${Ha})`)}}else if((Ot==null?void 0:Ot.status)==="skipped"){const Pn=String((Ot==null?void 0:Ot.reason)??"unknown reason").replace(/_/g," ");qt.push(`CV skipped (${Pn})`)}if(_e&&qt.push(`${_e.label}: ${T0(_e.value)}`),le.status==="failed"&&an){const Pn=an.replace(/\s+/g," ");qt.push(`Error: ${Pn}`)}return je&&qt.push(`Updated ${je}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["v",le.version]}),"  ",tt,qt.length>0?`  ${qt.join("  ")}`:""]},le.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:st,disabled:!Dt||_s,children:_s?"Refreshing":"Refresh jobs"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),M&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:M})]}),B&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]}),Bn.map((le,_e)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:le},`training-prereq-${_e}`)),Mt instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Mt.message}),vs&&!(Mt instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:vs.message||"Unable to load training jobs."}),rn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:rn.message||"Unable to load tuning jobs."}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:L>1?a.jsxs("span",{children:["Queued ",L," training jobs. Latest job ",$.id," (version ",$.version,")."]}):a.jsxs("span",{children:["Training job ",$.id," queued (version ",$.version,")."]})}),Fn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[xe&&u(xe),f&&u(f),Me&&a.jsxs(a.Fragment,{children:[g&&u(g),w&&u(w),_&&u(_),b&&u(b),x&&u(x)]}),re&&ce.length>0&&a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:W?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),(ft||xt)&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:ft?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:ft.modelType}),ft.runNumber?` (run ${ft.runNumber})`:"",mn?`  ${mn}`:"",ft.targetColumn?`  Target: ${ft.targetColumn}`:"",An?`  ${An}`:""]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",jn||"N/A",dn?`  ${dn}`:"",xt!=null&&xt.model_type&&xt.model_type!==re?` targeted ${xt.model_type}.`:" did not produce reusable parameters for this configuration yet."]})}),Q&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:It},children:Q.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",onClick:is,disabled:Yt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:Yt?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:Yt?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:Yt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:Yt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:Yt?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply tuned params"}),a.jsx("button",{type:"button",onClick:()=>F(!0),disabled:gt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:gt?"rgba(148, 163, 184, 0.55)":"rgba(168, 85, 247, 0.95)",background:gt?"rgba(15, 23, 42, 0.35)":"rgba(76, 29, 149, 0.18)",border:gt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(168, 85, 247, 0.45)",borderRadius:"4px",cursor:gt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"150px"},children:"Browse tuned params"}),a.jsx("button",{type:"button",onClick:Ze,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:W?"#fff":"rgba(148, 163, 184, 0.85)",background:W?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(15, 23, 42, 0.6)",border:W?"none":"1px solid rgba(148, 163, 184, 0.45)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:W?"0 4px 12px rgba(118, 75, 162, 0.25)":"none"},onMouseEnter:le=>{W?le.currentTarget.style.boxShadow="0 6px 16px rgba(118, 75, 162, 0.35)":(le.currentTarget.style.borderColor="rgba(148, 163, 184, 0.65)",le.currentTarget.style.background="rgba(15, 23, 42, 0.8)")},onMouseLeave:le=>{W?le.currentTarget.style.boxShadow="0 4px 12px rgba(118, 75, 162, 0.25)":(le.currentTarget.style.borderColor="rgba(148, 163, 184, 0.45)",le.currentTarget.style.background="rgba(15, 23, 42, 0.6)")},children:W?" Advanced":"Default"})]})]})}),re&&ke.isLoading&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),re&&ke.error&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",ke.error.message]}),re&&W&&ce.length>0&&a.jsxs("div",{style:{gridColumn:"1 / -1",padding:"1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginTop:"0.5rem"},children:[a.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid rgba(102, 126, 234, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600",color:"#e2e8f0"},children:"Advanced Hyperparameters"}),a.jsxs("p",{style:{margin:"0",fontSize:"0.875rem",color:"rgba(148, 163, 184, 0.85)",lineHeight:"1.5"},children:["Configure ",re.replace(/_/g," ")," hyperparameters. Leave empty to use recommended defaults."]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:ce.map(Qt)})]}),!re&&h&&u(h)]}),Me&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",Ke," folds before refitting on"," ",pe==="train_plus_validation"?"training plus validation data.":"training data only."]}),Xn&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",Xn.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:Xn.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>X(le=>!le),style:{whiteSpace:"nowrap"},children:Y?"Hide tips":"Show tips"})]}),Y&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:Xn.details.map((le,_e)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:le},`scaling-tip-${_e}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:At,disabled:Xs,children:wn?"Queuing":"Launch training job"})}),_s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),Ps>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:Ps===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${Ps} training jobs use a different problem type. Switch the problem type to view them.`}),!_s&&Nn.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),Nn.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Nn.map(ir)}),a.jsx(CT,{presets:gn,isOpen:q,onClose:()=>F(!1),onApply:le=>{hn(le),F(!1)},activePresetId:K,fieldMetadata:ct})]})},IT=new Set(["true","1","yes","on"]),BT=new Set(["false","0","no","off"]),UT=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],$0=new Set(["true","1","yes","y","on","t"]),L0=new Set(["false","0","no","n","off","f"]),Fo=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(IT.has(t))return!0;if(BT.has(t))return!1}return null},ni=e=>{if(!(!e||typeof e!="object")){for(const t of UT)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},Xp=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},Jp=e=>Array.isArray(e)?e.map(t=>Jp(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=Jp(e[n]),t),{}):e,Dc=e=>e===void 0?"":JSON.stringify(Jp(e)),z0=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},qT=(e,t)=>{const n=[],s=f=>{n.includes(f)||n.push(f)},l=(e??"").toLowerCase();if(!t.length)return n;const i=t.filter(f=>f!=null);if(!i.length)return n;const c=i.reduce((f,g)=>{if(typeof g=="number"&&Number.isFinite(g))return f+1;if(typeof g=="string"){const w=g.trim();if(!w)return f;const _=Number(w);if(!Number.isNaN(_)&&Number.isFinite(_))return f+1}return f},0),u=i.reduce((f,g)=>{const w=String(g).trim().toLowerCase();return w&&($0.has(w)||L0.has(w))?f+1:f},0),d=(()=>{const f=new Set;return i.forEach(g=>{f.add(String(g).trim().toLowerCase())}),f.size})(),p=c/i.length,h=u/i.length;if(l.includes("object")||l.includes("string"))return h>=.7&&s("boolean"),p>=.7&&s("float64"),d>0&&d<=20&&s("category"),n;if(l.includes("float")){const f=i.reduce((g,w)=>{if(typeof w=="number")return Number.isInteger(w)?g+1:g;if(typeof w=="string"){const _=w.trim();if(!_)return g;const b=Number(_);if(!Number.isNaN(b)&&Number.isFinite(b)&&Number.isInteger(b))return g+1}return g},0);return h>=.8&&s("boolean"),i.length>0&&f/i.length>=.9&&s("Int64"),n}return l.includes("int")&&h>=.7&&s("boolean"),n},vm=[{value:"train",label:"Train",accent:"train"},{value:"test",label:"Test",accent:"test"},{value:"validation",label:"Validation",accent:"validation"}],ym={train:0,test:1,validation:2},HT=["train","test","validation"],Zp=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],Rc=e=>{const t=new Set(vm.map(l=>l.value)),n=[];e.forEach(l=>{if(l){if(l==="training"&&(l="train"),l==="valid"||l==="val"){n.push("validation");return}t.has(l)&&n.push(l)}});const s=new Set;return n.filter(l=>s.has(l)?!1:(s.add(l),!0)).sort((l,i)=>ym[l]-ym[i])},VT=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},eg=(e,t)=>{const n=Fo(e);return n===null?t:n},D0=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},R0=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},F0=e=>{const t=vm.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},WT=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},KT=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${WT(e.status)}`);const n=Qn(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},bm=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,I0=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,s])=>{typeof s=="number"&&Number.isFinite(s)&&t.push({key:n,value:s})}),t.sort((n,s)=>n.key.localeCompare(s.key)),t},B0=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},YT=({nodeId:e,sourceId:t,graph:n,config:s,setConfigState:l,renderParameterField:i,formatMetricValue:c,connectedSplitHandles:u})=>{var Ue;const d=Mo(),p=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),h=v.useMemo(()=>{if(!p)return[];const de=new Map;p.nodes.forEach(xe=>{xe!=null&&xe.id&&de.set(xe.id,xe)});const pe=new Set;return p.edges.forEach(xe=>{var De;if(!xe||xe.target!==e)return;const ke=de.get(xe.source);((De=ke==null?void 0:ke.data)==null?void 0:De.catalogType)==="train_model_draft"&&pe.add(ke.id)}),pe.size>0?Array.from(pe):p.nodes.filter(xe=>{var ke;return((ke=xe==null?void 0:xe.data)==null?void 0:ke.catalogType)==="train_model_draft"}).map(xe=>xe.id)},[p,e]),f=v.useMemo(()=>h.length?h.slice().sort().join("|"):"all",[h]),[g,w]=v.useState(null),[_,b]=v.useState(null);v.useEffect(()=>{let de=!1;return b(null),!t||!p?(w(null),()=>{de=!0}):(Do(t,p).then(pe=>{de||w(pe)}).catch(pe=>{de||(b((pe==null?void 0:pe.message)??"Unable to compute pipeline signature."),w(null))}),()=>{de=!0})},[p,t]);const x=v.useMemo(()=>{const de=s==null?void 0:s.training_job_id;return typeof de=="string"?de.trim():typeof de=="number"?String(de):""},[s==null?void 0:s.training_job_id]),N=v.useMemo(()=>Rc(Zp(s==null?void 0:s.splits)),[s==null?void 0:s.splits]),E=v.useMemo(()=>N.length?N:HT,[N]);v.useEffect(()=>{u&&l(de=>{const pe=de??{},xe=Rc(Zp(pe.splits)),ke=xe.filter(ce=>u[ce]!==!1);if(ke.length===xe.length&&ke.every((ce,Oe)=>ce===xe[Oe]))return de;const De={...pe};return ke.length?De.splits=ke:delete De.splits,De})},[u,l]);const M=v.useMemo(()=>u?E.filter(de=>u[de]!==!1):E,[u,E]),j=v.useMemo(()=>u?vm.filter(de=>u[de.value]===!1).map(de=>de.label):[],[u]),C=v.useMemo(()=>{if(!j.length)return"";if(j.length===1)return j[0];if(j.length===2)return`${j[0]} and ${j[1]}`;const de=j[j.length-1];return`${j.slice(0,-1).join(", ")}, and ${de}`},[j]),S=M.length>0,$=eg(s==null?void 0:s.include_confusion,!0),A=eg(s==null?void 0:s.include_curves,!0),L=eg(s==null?void 0:s.include_residuals,!0),T=D0(s==null?void 0:s.max_curve_points,500),P=D0(s==null?void 0:s.max_scatter_points,750),z=typeof(s==null?void 0:s.last_evaluated_at)=="string"?s.last_evaluated_at:null,[W,D]=v.useState(null),[R,U]=v.useState("details"),V=v.useRef(!1);v.useEffect(()=>{D(null),V.current=!1},[x]),v.useEffect(()=>{U("details")},[W==null?void 0:W.job_id]);const B=v.useMemo(()=>["feature-canvas","model-evaluation",t??"none",g??"pending",f],[g,t,f]),G=Hs({queryKey:B,queryFn:async()=>{const de={datasetSourceId:t||void 0,limit:50},pe=new Map,xe=[];let ke=null;const De=ct=>{Array.isArray(ct)&&ct.forEach(Je=>{Je&&!pe.has(Je.id)&&pe.set(Je.id,Je)})},ce=async ct=>{try{const Je=await Nc(ct);return De(Je==null?void 0:Je.jobs),Je}catch(Je){return Je instanceof Error&&xe.push(Je),null}};if(g&&await ce({...de,pipelineId:g}),h.length&&await Promise.all(h.map(ct=>ce({...de,nodeId:ct}))),ke=await ce(de),!pe.size){if(ke)return ke;if(xe.length)throw xe[0];return{jobs:[],total:0}}const Oe=Array.from(pe.values());Oe.sort((ct,Je)=>R0(Je.updated_at??Je.created_at)-R0(ct.updated_at??ct.created_at));const Ye=(ke==null?void 0:ke.total)??Oe.length;return{jobs:Oe,total:Ye}},enabled:!!t,staleTime:30*1e3,retry:(de,pe)=>pe.message.includes("Sign in")?!1:de<2,refetchInterval:de=>{const pe=de.state.data;return((pe==null?void 0:pe.jobs)??[]).some(De=>De.status==="queued"||De.status==="running")?5e3:!1}}),q=((Ue=G.data)==null?void 0:Ue.jobs)??[],F=v.useMemo(()=>{const de=new Map;return q.forEach(pe=>{de.set(pe.id,pe)}),de},[q]),K=v.useMemo(()=>q.filter(de=>de.status==="succeeded"),[q]),se=v.useMemo(()=>K.map(de=>({value:de.id,label:KT(de)})),[K]),Q=x?F.get(x)??null:null,H=Hs({queryKey:["feature-canvas","training-job",x||"none"],queryFn:()=>tx(x),enabled:!!x,staleTime:30*1e3});v.useEffect(()=>{var ct,Je;const de=H.data;if(!de)return;const pe=(ct=de.metrics)==null?void 0:ct.evaluation;if(!pe||typeof pe!="object")return;const xe=pe.splits;if(!xe||typeof xe!="object")return;const ke={};Object.entries(xe).forEach(([mt,Ze])=>{Ze&&typeof Ze=="object"&&(ke[mt]=Ze)});const De=typeof pe.generated_at=="string"?pe.generated_at:z??de.updated_at??de.created_at??new Date().toISOString(),ce=pe.problem_type==="regression"?"regression":"classification",Oe={job_id:de.id,pipeline_id:de.pipeline_id,node_id:de.node_id,generated_at:De,problem_type:ce,target_column:pe.target_column??((Je=de.metadata)==null?void 0:Je.target_column)??null,splits:ke};D(Oe),De&&De!==z&&l(mt=>({...mt??{},last_evaluated_at:De}));const Ye=Rc(Object.keys(ke));Ye.length&&!V.current&&!VT(N,Ye)&&l(mt=>({...mt??{},splits:Ye}))},[H.data,z,l,N]);const Y=Ed({mutationFn:async de=>{if(!x)throw new Error("Select a training job before running evaluation.");return nx(x,de)},onSuccess:de=>{D(de),l(pe=>({...pe??{},training_job_id:x,splits:de.splits?Object.keys(de.splits):M,include_confusion:$,include_curves:A,include_residuals:L,max_curve_points:T,max_scatter_points:P,last_evaluated_at:de.generated_at})),d.invalidateQueries({queryKey:["feature-canvas","training-job",x]})}}),X=v.useCallback(de=>{const pe=de.target.value;Y.reset(),l(xe=>{const ke={...xe??{}};return pe?ke.training_job_id=pe:delete ke.training_job_id,ke})},[Y,l]),ee=v.useCallback(de=>{u&&u[de]===!1||(Y.reset(),V.current=!0,l(pe=>{const xe=Rc(Zp(pe==null?void 0:pe.splits)),ke=xe.includes(de);let De;if(ke){if(xe.length<=1)return pe??{};De=xe.filter(ce=>ce!==de)}else De=Rc([...xe,de]);return{...pe??{},splits:De}}))},[u,Y,l]),J=v.useCallback((de,pe)=>{Y.reset(),l(xe=>({...xe??{},[de]:pe}))},[Y,l]),re=v.useCallback(()=>{if(!x)return;const de={splits:M,include_confusion:$,include_curves:A,include_residuals:L,max_curve_points:A?T:void 0,max_scatter_points:L?P:void 0};Y.mutate(de)},[Y,$,A,L,T,P,x,M]),we=W?Qn(W.generated_at):z?Qn(z):null,Pe=v.useMemo(()=>W?Object.entries(W.splits).sort((de,pe)=>{const[xe]=de,[ke]=pe,De=ym[xe]??99,ce=ym[ke]??99;return De-ce}):[],[W]),Me=v.useMemo(()=>{if(!W||!Pe.length)return null;const de=Pe.map(([xe,ke])=>{const De=I0(ke.metrics).reduce((ce,Oe)=>(ce[Oe.key]=Oe.value,ce),{});return{key:xe,label:F0(xe),rowCount:typeof ke.row_count=="number"?ke.row_count:null,metrics:De}}),pe=Array.from(new Set(de.flatMap(xe=>Object.keys(xe.metrics)))).sort((xe,ke)=>xe.localeCompare(ke));return{splits:de,metricKeys:pe}},[Pe,W]),Fe=v.useMemo(()=>Me?Me.splits.length<=1?"Connect at least two splits to compare results.":Me.metricKeys.length?null:"No numeric metrics available for comparison yet.":"Run an evaluation to compare metrics.",[Me]);v.useEffect(()=>{R==="comparison"&&Fe&&U("details")},[R,Fe]);const Ke=v.useCallback(de=>{de==="comparison"&&Fe||U(de)},[Fe]);return a.jsxs("div",{className:"node-settings__section node-settings__evaluation",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:we&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",we]})})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:x,onChange:X,disabled:G.isLoading||G.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),se.map(de=>a.jsx("option",{value:de.value,children:de.label},de.value))]}),G.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),G.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:G.error.message}),!G.isLoading&&!se.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),_&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:_})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:vm.map(de=>{const pe=u?u[de.value]!==!1:!0,xe=pe&&M.includes(de.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${de.accent} ${xe?"evaluation-chip--active":""}`,"aria-disabled":!pe,title:pe?void 0:`${de.label} split is not connected`,style:pe?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:xe,disabled:!pe,onChange:()=>ee(de.value)}),a.jsx("span",{children:de.label})]},de.value)})}),j.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",C," split",j.length>1?"s":""," to enable diagnostics."]}),!S&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a train, validation, or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:de=>J("include_confusion",de.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:de=>J("include_curves",de.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:de=>J("include_residuals",de.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:re,disabled:!x||Y.isPending||!S,children:Y.isPending?"Running":"Run evaluation"}),Q&&Q.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!S&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),Y.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:Y.error.message}),Y.isSuccess&&W&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",Qn(W.generated_at),"."]}),H.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:H.error.message})]}),W?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:W.problem_type==="regression"?"Regression":"Classification"})]}),W.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:W.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:Qn(W.generated_at)??W.generated_at})]})]}),a.jsxs("div",{className:"evaluation-tabs",role:"tablist","aria-label":"Evaluation views",children:[a.jsx("button",{type:"button",className:`evaluation-tab ${R==="details"?"evaluation-tab--active":""}`,role:"tab","aria-selected":R==="details",onClick:()=>Ke("details"),children:"Split details"}),a.jsx("button",{type:"button",className:`evaluation-tab ${R==="comparison"?"evaluation-tab--active":""}`,role:"tab","aria-selected":R==="comparison","aria-disabled":!!Fe,disabled:!!Fe,title:Fe??void 0,onClick:()=>Ke("comparison"),children:"Split comparison"})]}),R==="comparison"&&Me?a.jsx(GT,{comparison:Me,formatMetricValue:c}):Pe.map(([de,pe])=>a.jsx(QT,{splitKey:de,payload:pe,problemType:W.problem_type,formatMetricValue:c},de))]}):a.jsx("div",{className:"evaluation-placeholder",children:x?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},GT=({comparison:e,formatMetricValue:t})=>e.metricKeys.length?a.jsx("section",{className:"evaluation-comparison",children:a.jsx("div",{className:"evaluation-comparison__table-wrapper",children:a.jsxs("table",{className:"evaluation-comparison__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Metric"}),e.splits.map(n=>a.jsx("th",{children:n.label},n.key))]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"evaluation-comparison__row evaluation-comparison__row--muted",children:[a.jsx("td",{children:"Rows evaluated"}),e.splits.map(n=>a.jsx("td",{children:typeof n.rowCount=="number"?n.rowCount.toLocaleString():""},`${n.key}-rows`))]}),e.metricKeys.map(n=>a.jsxs("tr",{className:"evaluation-comparison__row",children:[a.jsx("td",{children:n}),e.splits.map(s=>a.jsx("td",{children:typeof s.metrics[n]=="number"?t(s.metrics[n]):""},`${s.key}-${n}`))]},n))]})]})})}):a.jsx("div",{className:"evaluation-placeholder",children:a.jsx("p",{children:"No numeric metrics were reported across splits for comparison."})}),QT=({splitKey:e,payload:t,problemType:n,formatMetricValue:s})=>{const l=I0(t.metrics),i=l.length>0,c=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[F0(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),i?a.jsx("div",{className:"evaluation-metrics__grid",children:l.map(u=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:u.key}),a.jsx("span",{className:"evaluation-metrics__value",children:s(u.value)})]},u.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(XT,{matrix:t.confusion_matrix,formatMetricValue:s}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(u=>a.jsx(JT,{curve:u,formatMetricValue:s},`roc-${u.label}`)),t.pr_curves.map(u=>a.jsx(ZT,{curve:u,formatMetricValue:s},`pr-${u.label}`))]}),n==="regression"&&t.residuals&&a.jsx(t2,{residuals:t.residuals,formatMetricValue:s})]}),c.length>0&&a.jsx("ul",{className:"evaluation-notes",children:c.map((u,d)=>a.jsx("li",{children:u},`${e}-note-${d}`))})]})},XT=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],s=Array.isArray(e.totals)?e.totals:[],l=Array.isArray(e.normalized)?e.normalized:[],i=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),i!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",B0(i,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((c,u)=>a.jsx("th",{children:c},`pred-${u}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((c,u)=>{const d=l[u]??[],p=s[u]??c.reduce((h,f)=>h+f,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[u]??`Class ${u}`}),c.map((h,f)=>{const g=typeof d[f]=="number"?d[f]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:h}),g!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:B0(g,t)})]},`cell-${u}-${f}`)}),a.jsx("td",{children:p})]},`row-${u}`)})})]})]})},JT=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,s=240,l=28,i=n-l*2,c=s-l*2,u=e.fpr.map((d,p)=>{const h=l+bm(d)*i,f=s-l-bm(e.tpr[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:l,y:l,width:i,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:l,y1:s-l,x2:n-l,y2:l,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:l,y1:l,x2:l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("line",{x1:l,y1:s-l,x2:n-l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},ZT=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,s=240,l=28,i=n-l*2,c=s-l*2,u=e.recall.map((d,p)=>{const h=l+bm(d)*i,f=s-l-bm(e.precision[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:l,y:l,width:i,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:l,y1:l,x2:l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("line",{x1:l,y1:s-l,x2:n-l,y2:s-l,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},e2={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},t2=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(s=>typeof s[1]=="number"&&Number.isFinite(s[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([s,l])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:e2[s]??s}),a.jsx("span",{className:"evaluation-summary__value",children:t(l)})]},s))}),a.jsx(n2,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx(s2,{points:e.scatter})]})},n2=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const s=t.reduce((l,i)=>Math.max(l,i),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((l,i)=>{const c=l/s*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${l} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${c}%`}})},`bin-${i}`)})})},s2=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,s=36,l=e.map(g=>g.actual),i=e.map(g=>g.predicted),c=Math.min(...l,...i),u=Math.max(...l,...i),d=u-c||1,p=g=>(g-c)/d,h=g=>s+p(g)*(t-s*2),f=g=>n-s-p(g)*(n-s*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:s,y:s,width:t-s*2,height:n-s*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:s,y1:n-s,x2:t-s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:s,y1:s,x2:s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:h(c),y1:f(c),x2:h(u),y2:f(u),className:"evaluation-curve__baseline"}),e.map((g,w)=>a.jsx("circle",{cx:h(g.actual),cy:f(g.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${w}`))]})})},r2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},a2={queued:"info",running:"info",succeeded:"success",failed:"danger",cancelled:"neutral"},si={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score"],regression:["rmse","mae","r2","mape"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},U0=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted"],q0=["rmse","mae","r2","mape"],H0=new Set(["rmse","mae","mape","mse"]),V0={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},Gs=e=>!!e&&typeof e=="object"&&!Array.isArray(e),o2=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},tg=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",l2=e=>{if(!e)return si.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return si.regression;if(t.includes("class")||t.includes("classification"))return si.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?si.regression:n==="classification"?si.classification:si.fallback},i2=e=>{var l,i,c;if(!Gs(e))return null;const t=[],n=(i=(l=e==null?void 0:e.cross_validation)==null?void 0:l.metrics)==null?void 0:i.mean;Gs(n)&&((c=e==null?void 0:e.cross_validation)==null?void 0:c.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),Gs(e.test)&&t.push({values:e.test,labelPrefix:""}),Gs(e.validation)&&t.push({values:e.validation,labelPrefix:""}),Gs(e.train)&&t.push({values:e.train,labelPrefix:""});const s=l2(e);for(const u of t)for(const d of s){const p=u.values[d];if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p}}for(const u of t)for(const[d,p]of Object.entries(u.values))if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p};return null},c2=e=>{var n,s;if(!Gs(e))return{label:null,values:{}};if(Gs(e.test))return{label:"Test",values:e.test};if(Gs(e.validation))return{label:"Validation",values:e.validation};const t=(s=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:s.mean;return Gs(t)?{label:"CV mean",values:t}:Gs(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},W0=e=>{if(!e)return"Unknown model";const t=e.trim();return V0[t]?V0[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},u2=e=>{var i,c;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const u of n)if(typeof u=="string"){const d=u.trim().toLowerCase();if(d==="classification"||d==="regression")return d}const s=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(s.includes("classifier")||s.includes("classification"))return"classification";if(s.includes("regress")||s.includes("regression"))return"regression";const l=e.metrics;if(Gs(l)){const u=new Set,d=g=>{Gs(g)&&Object.keys(g).forEach(w=>u.add(w.toLowerCase()))};d(l.test),d(l.validation),d(l.train);const p=(c=(i=l==null?void 0:l.cross_validation)==null?void 0:i.metrics)==null?void 0:c.mean;Gs(p)&&d(p);const h=U0.some(g=>u.has(g)),f=q0.some(g=>u.has(g));if(h&&!f)return"classification";if(f&&!h)return"regression"}return"unknown"},d2=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:u2(t),modelLabel:W0(t.model_type),primaryMetric:i2(n),metricBucket:c2(n)}}),K0=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return H0.has(t)||H0.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},m2=({nodeId:e,sourceId:t,graph:n,parameters:s,config:l,renderParameterField:i})=>{var Q;const c=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),u=v.useMemo(()=>{if(!c)return[];const H=new Map;c.nodes.forEach(ee=>{ee&&ee.id&&H.set(ee.id,ee)});const Y=new Set;return c.edges.forEach(ee=>{var re;if(!ee||ee.target!==e)return;const J=H.get(ee.source);((re=J==null?void 0:J.data)==null?void 0:re.catalogType)==="train_model_draft"&&Y.add(J.id)}),Y.size>0?Array.from(Y):c.nodes.filter(ee=>{var J;return((J=ee==null?void 0:ee.data)==null?void 0:J.catalogType)==="train_model_draft"}).map(ee=>ee.id)},[c,e]),d=v.useMemo(()=>u.length?u.slice().sort().join("|"):"all",[u]),[p,h]=v.useState(null),[f,g]=v.useState(null);v.useEffect(()=>{let H=!1;return g(null),!t||!c?(h(null),()=>{H=!0}):(Do(t,c).then(Y=>{H||h(Y)}).catch(Y=>{H||(g((Y==null?void 0:Y.message)??"Unable to compute pipeline ID"),h(null))}),()=>{H=!0})},[c,t]);const w=o2(l==null?void 0:l.show_non_success,!0),_=v.useMemo(()=>["feature-canvas","model-registry",t??"none",p??"pending",d,w?"all-statuses":"succeeded"],[p,w,t,d]),b=Hs({queryKey:_,queryFn:async()=>{const H={datasetSourceId:t||void 0,limit:50},Y=new Map,X=[];let ee=null;const J=Me=>{!Array.isArray(Me)||!Me.length||Me.forEach(Fe=>{Fe&&!Y.has(Fe.id)&&Y.set(Fe.id,Fe)})},re=async Me=>{try{const Fe=await Nc(Me);return J(Fe==null?void 0:Fe.jobs),Fe}catch(Fe){return Fe instanceof Error&&X.push(Fe),null}};if(p&&await re({...H,pipelineId:p}),u.length===1){const[Me]=u;await re({...H,nodeId:Me})}if(ee=await re(H),!Y.size){if(ee)return ee;if(X.length)throw X[0];return{jobs:[],total:0}}const we=Array.from(Y.values()),Pe=(ee==null?void 0:ee.total)??we.length;return{jobs:we,total:Pe}},enabled:!!t,staleTime:30*1e3,retry:(H,Y)=>Y.message.includes("Sign in")?!1:H<2,refetchInterval:H=>{const Y=H.state.data;return((Y==null?void 0:Y.jobs)??[]).some(J=>J.status==="queued"||J.status==="running")?5e3:!1}}),x=((Q=b.data)==null?void 0:Q.jobs)??[],N=v.useMemo(()=>{if(!x.length)return[];if(!u.length)return x;const H=x.filter(Y=>u.includes(Y.node_id));return H.length?H:x},[x,u]),E=v.useMemo(()=>d2(N),[N]),M=v.useMemo(()=>w?E:E.filter(H=>H.job.status==="succeeded"),[E,w]),j=v.useMemo(()=>M.filter(H=>H.problemType==="classification"),[M]),C=v.useMemo(()=>M.filter(H=>H.problemType==="regression"),[M]),S=v.useMemo(()=>!j.length&&!C.length?"classification":j.length?C.length?j.length>=C.length?"classification":"regression":"classification":"regression",[j.length,C.length]),$=typeof(l==null?void 0:l.default_problem_type)=="string"?l.default_problem_type.trim().toLowerCase():"auto",A=$==="classification"||$==="regression"?$:S,[L,T]=v.useState(A);v.useEffect(()=>{T(A)},[A]);const P=L==="classification"?j:C,z=v.useMemo(()=>{const H=new Map;return P.forEach(Y=>{const X=Y.job.model_type,ee=H.get(X)??{label:Y.modelLabel,count:0};ee.count+=1,H.set(X,ee)}),Array.from(H.entries()).map(([Y,X])=>({value:Y,label:X.label,count:X.count})).sort((Y,X)=>Y.label.localeCompare(X.label))},[P]),W=typeof(l==null?void 0:l.default_method)=="string"?l.default_method.trim().toLowerCase():"",[D,R]=v.useState("all");v.useEffect(()=>{if(!z.length){R("all");return}const H=z.find(Y=>Y.value.toLowerCase()===W);R(H?H.value:"all")},[W,z,L]);const U=v.useMemo(()=>D==="all"?P:P.filter(H=>H.job.model_type===D),[D,P]),V=v.useMemo(()=>U.slice().sort((H,Y)=>{if(Y.job.version!==H.job.version)return Y.job.version-H.job.version;const X=Date.parse(H.job.updated_at??H.job.created_at??"");return Date.parse(Y.job.updated_at??Y.job.created_at??"")-X}),[U]),B=v.useMemo(()=>{if(!P.length)return[];const H=new Map;P.forEach(X=>{const ee=X.job.model_type,J=H.get(ee)??[];J.push(X),H.set(ee,J)});const Y=[];return H.forEach((X,ee)=>{const J=X.reduce((re,we)=>{const Pe=K0(we.primaryMetric);if(Pe===null)return re;if(!re)return we;const Me=K0(re.primaryMetric);return Me===null||Pe>Me?we:re},null);Y.push({modelType:ee,label:W0(ee),bestJob:J})}),Y.sort((X,ee)=>X.label.localeCompare(ee.label))},[P]),G=v.useMemo(()=>s.filter(H=>["default_problem_type","show_non_success"].includes(H.name)),[s]),q=L==="classification"?U0:q0,F=b.isLoading||b.isFetching,K=b.error??null,se=V.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),p&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",p]})]}),f&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:f}),!u.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),G.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:G.map(H=>a.jsx(ge.Fragment,{children:i(H)},H.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(H=>a.jsxs("button",{type:"button",role:"tab","data-active":L===H,className:"model-registry__tab",onClick:()=>T(H),disabled:H==="classification"&&!j.length||H==="regression"&&!C.length,children:[H==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:H==="classification"?j.length:C.length})]},H))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":D==="all",onClick:()=>R("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:P.length})]}),z.map(H=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":D===H.value,onClick:()=>R(H.value),children:[H.label,a.jsx("span",{className:"model-registry__method-count",children:H.count})]},H.value))]})]}),B.length>0&&a.jsx("div",{className:"model-registry__summary",children:B.map(H=>{const Y=H.bestJob,X=Y!=null&&Y.primaryMetric?Y.primaryMetric.label:null,ee=Y!=null&&Y.primaryMetric?tg(Y.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:H.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[X||"No metrics",X&&a.jsx("strong",{children:ee})]}),(Y==null?void 0:Y.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",Y.job.version]})]},H.modelType)})}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:K.message}),!F&&!K&&!se&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),se&&a.jsx("div",{className:"model-registry__table-wrapper",children:a.jsxs("table",{className:"model-registry__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Version"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Model"}),a.jsx("th",{scope:"col",children:"Primary metric"}),q.map(H=>a.jsx("th",{scope:"col",children:H.replace(/_/g," ")},H)),a.jsx("th",{scope:"col",children:"Evaluated"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:V.map(H=>{const{job:Y,primaryMetric:X,metricBucket:ee}=H,J=ee.values||{},re=ee.label??"",we=Y.updated_at??Y.created_at??null;return a.jsxs("tr",{children:[a.jsxs("td",{children:["v",Y.version]}),a.jsx("td",{children:a.jsx("span",{className:`model-registry__status model-registry__status--${a2[Y.status]}`,children:r2[Y.status]})}),a.jsx("td",{children:H.modelLabel}),a.jsx("td",{children:X?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",children:X.label}),a.jsx("span",{className:"model-registry__metric-value",children:tg(X.value)})]}):""}),q.map(Pe=>{const Me=J[Pe];return a.jsx("td",{children:typeof Me=="number"&&Number.isFinite(Me)?tg(Me):""},`${Y.id}-${Pe}`)}),a.jsx("td",{children:re}),a.jsx("td",{children:we?Qn(we)??we:""})]},Y.id)})})]})})]})},h2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},Io="__tuning_strategies",Bo="__active_tuning_strategy_id",Uo="__expanded_tuning_strategy_ids",ng=["random","grid","halving","optuna"],xm=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const s=n.toLowerCase();if(t&&t.length>0){const i=t.find(c=>c.toLowerCase()===s);if(i)return i}const l=ng.find(i=>i.toLowerCase()===s);return l||n},yr=e=>!!e&&typeof e=="object"&&!Array.isArray(e),os=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},Pa=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return yr(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return yr(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},sg=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,s])=>{if(n){if(Array.isArray(s)){const l=s.filter(i=>i!=null);l.length>0&&(t[n]=l.map(i=>os(i)));return}s==null||s===""||(t[n]=[os(s)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},f2=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",p2=new Set(["train","test","validation"]),Y0=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const s=n.trim().toLowerCase();p2.has(s)&&t.add(s)}}),Array.from(t)},rg=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,l])=>{t.has(s)&&(n[s]=l)}),n},ag=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,l])=>{if(t.has(s)){if(Array.isArray(l)){const i=l.map(c=>os(c)).filter(c=>c!=null&&c!=="");i.length>0&&(n[s]=i);return}l!=null&&l!==""&&(n[s]=[os(l)])}}),n},g2=(e,t)=>{const n=t.split(/[\n,]+/).map(d=>d.trim()).filter(d=>d.length>0);if(n.length===0)return{values:[],error:null};const s=[],l=[],i=Array.isArray(e.options)?new Set(e.options.map(d=>d.value)):null;n.forEach(d=>{if(e.type==="number"){const p=Number(d);Number.isFinite(p)?s.push(p):l.push(d);return}if(e.type==="boolean"){const p=d.toLowerCase();if(["true","1","yes","y"].includes(p)){s.push(!0);return}if(["false","0","no","n"].includes(p)){s.push(!1);return}l.push(d);return}if(e.type==="select"){if(i&&!i.has(d)){l.push(d);return}s.push(d);return}s.push(d)});const c=[],u=new Set;if(s.forEach(d=>{const p=typeof d=="object"?JSON.stringify(d):String(d);u.has(p)||(u.add(p),c.push(d))}),l.length>0){const d=l.slice(0,3).join(", "),p=l.length>3?"":"";return{values:c,error:`Invalid value${l.length>1?"s":""}: ${d}${p}`}}return{values:c,error:null}},G0=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),wm=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},jm=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},Fc=(e,t,n)=>{let s=e;return typeof t=="number"&&Number.isFinite(t)&&(s=Math.max(s,t)),typeof n=="number"&&Number.isFinite(n)&&(s=Math.min(s,n)),s},_2=(e,t)=>{const n={},s=e.find(d=>(d==null?void 0:d.name)==="solver"),l=e.find(d=>(d==null?void 0:d.name)==="penalty"),i=!!(s&&l&&Array.isArray(s.options)&&s.options.some(d=>(d==null?void 0:d.value)==="liblinear")&&Array.isArray(l.options)&&l.options.some(d=>(d==null?void 0:d.value)==="elasticnet")),c=new Set(["lbfgs","saga"]),u=new Set(["l2","none"]);return e.forEach(d=>{if(!(d!=null&&d.name))return;const p=new Map,h=w=>{if(w==null||typeof w=="number"&&!Number.isFinite(w))return;const _=typeof w=="object"?JSON.stringify(w):`${typeof w}:${String(w)}`;p.has(_)||p.set(_,os(w))},f=t==null?void 0:t[d.name];if(i&&d.name==="solver")(Array.isArray(d.options)?d.options:[]).forEach(_=>{_!=null&&_.value&&c.has(String(_.value))&&h(_.value)}),!p.size&&typeof f=="string"&&c.has(f)&&h(f),p.size||c.forEach(_=>h(_));else if(i&&d.name==="penalty")(Array.isArray(d.options)?d.options:[]).forEach(_=>{_!=null&&_.value&&u.has(String(_.value))&&h(_.value)}),!p.size&&typeof f=="string"&&u.has(f)&&h(f),p.size||u.forEach(_=>h(_));else if(d.type==="number"){const w=jm(f),_=jm(d.min),b=jm(d.max);if(_!==null&&h(_),w!==null&&h(Fc(w,_,b)),b!==null&&h(b),p.size<=1&&w!==null){const x=jm(d.step);x!==null&&x>0?(h(Fc(w+x,_,b)),h(Fc(w-x,_,b))):(h(Fc(w*1.5,_,b)),h(Fc(w*.5,_,b)))}}else d.type==="boolean"?(h(!0),h(!1),typeof f=="boolean"&&h(f)):(d.type==="select"&&(d.options??[]).slice(0,6).forEach(w=>{(w==null?void 0:w.value)!==void 0&&h(w.value)}),typeof f=="string"&&f.trim().length&&h(f.trim()));const g=Array.from(p.values());g.length>0&&(n[d.name]=g)}),n},v2={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},og=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,Ic=e=>{if(!yr(e))return{};const t=os(e);return yr(t)?(delete t[Io],delete t[Bo],delete t[Uo],t):{}},ri=e=>Ic(e),y2=(e,t,n)=>({id:og(),label:e,config:ri(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),Ta=e=>`Strategy ${e}`,Q0=e=>yr(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},X0=e=>yr(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const s=e[n];return t[n]=s===null?null:String(s),t},{}):{},b2=e=>{if(!yr(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,Io)&&(t[Io]=os(e[Io])),Object.prototype.hasOwnProperty.call(e,Bo)&&(t[Bo]=e[Bo]),Object.prototype.hasOwnProperty.call(e,Uo)&&(t[Uo]=os(e[Uo])),t},x2=()=>({strategies:[],activeId:null,expandedIds:[]}),lg=e=>{var d;const t=x2();if(!yr(e))return t;const n=e[Io];if(Array.isArray(n)){const p=new Set;n.forEach(h=>{if(!yr(h))return;let f=typeof h.id=="string"?h.id.trim():"";(!f||p.has(f))&&(f=og()),p.add(f);const g=typeof h.label=="string"?h.label.trim():"",w=g.length?g:Ta(t.strategies.length+1),_=yr(h.config)?h.config:{},b={id:f,label:w,config:Ic(_),searchSpaceTexts:Q0(h.searchSpaceTexts),searchSpaceFieldErrors:X0(h.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!h.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!h.searchSpaceManuallyCleared};t.strategies.push(b)})}const s=new Set(t.strategies.map(p=>p.id)),l=e[Bo],i=typeof l=="string"?l.trim():"";t.activeId=i&&s.has(i)?i:((d=t.strategies[0])==null?void 0:d.id)??null;const c=e[Uo],u=Array.isArray(c)?c.map(p=>typeof p=="string"?p.trim():"").filter(p=>!!p&&s.has(p)):[];return t.activeId&&!u.includes(t.activeId)&&u.push(t.activeId),t.expandedIds=Array.from(new Set(u)).sort(),t},J0=e=>({id:e.id,label:e.label,config:ri(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),w2=(e,t,n)=>{var u;const s=e.map((d,p)=>({id:typeof d.id=="string"&&d.id.trim().length?d.id:og(),label:typeof d.label=="string"&&d.label.trim().length?d.label:Ta(p+1),config:Ic(d.config),searchSpaceTexts:Q0(d.searchSpaceTexts),searchSpaceFieldErrors:X0(d.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!d.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!d.searchSpaceManuallyCleared})),l=new Set(s.map(d=>d.id)),i=typeof t=="string"&&l.has(t)?t:((u=s[0])==null?void 0:u.id)??null,c=Array.from(n??new Set).filter(d=>l.has(d));return i&&!c.includes(i)&&c.push(i),{strategies:s,activeId:i,expandedIds:Array.from(new Set(c)).sort()}},Z0=(e,t)=>{var n;return t&&e.some(s=>s.id===t)?t:((n=e[0])==null?void 0:n.id)??""},ew=(e,t)=>{const n=new Set(e.map(l=>l.id)),s=t.filter(l=>n.has(l));return!s.length&&e[0]&&s.push(e[0].id),new Set(s)},Nm=e=>Dc(e),tw=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const l of n)if(e[l]!==t[l])return!1;return!0},j2=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:l,cvConfig:i,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,searchStrategyParameter:h,searchIterationsParameter:f,searchRandomStateParameter:g,scoringMetricParameter:w,setDraftConfigState:_,onSaveDraftConfig:b})=>{var rl,Va,ca,Zs;const x=Mo(),[N,E]=v.useState(null),[M,j]=v.useState(null),[C,S]=v.useState(null),[$,A]=v.useState(0),[L,T]=v.useState(null),[P,z]=v.useState(!1),[W,D]=v.useState(null),[R,U]=v.useState(!1),V=((s==null?void 0:s.targetColumn)??"").trim(),B=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",G=(d==null?void 0:d.name)??"model_type",q=(h==null?void 0:h.name)??"search_strategy",F=(f==null?void 0:f.name)??"search_iterations",K=(g==null?void 0:g.name)??"search_random_state",se=(w==null?void 0:w.name)??"scoring_metric",Q=c==null?void 0:c[G],H=typeof Q=="string"&&Q.trim().length?Q.trim():((l==null?void 0:l.modelType)??"").trim(),Y=Hs({queryKey:["model-hyperparameters",H],queryFn:()=>lm(H),enabled:!!H,staleTime:5*60*1e3}),X=((rl=Y.data)==null?void 0:rl.fields)??[],ee=((Va=Y.data)==null?void 0:Va.defaults)??{},J=v.useMemo(()=>{if(!X.length)return new Set;const Z=new Set;return X.forEach(fe=>{fe!=null&&fe.name&&Z.add(fe.name)}),Z},[X]),re=!!(i!=null&&i.enabled),we=(i==null?void 0:i.strategy)??"auto",Pe=typeof(i==null?void 0:i.folds)=="number"?i.folds:5,Me=!!(i!=null&&i.shuffle),Fe=(i==null?void 0:i.randomState)??null,Ke=v.useMemo(()=>{const Z=[];return((h==null?void 0:h.options)??[]).forEach(fe=>{if(!fe||typeof fe.value!="string")return;const me=fe.value.trim();if(!me.length)return;const Ee=me.toLowerCase();Z.some(Ce=>Ce.toLowerCase()===Ee)||Z.push(me)}),Z},[h]),Ue=v.useMemo(()=>Ke.length>0?[...Ke]:[...ng],[Ke]),de=xm(h==null?void 0:h.default,Ke),xe=xm(c==null?void 0:c[q],Ke)??de??Ue[0]??ng[0],ke=c==null?void 0:c[F];let De=null;if(typeof ke=="number"&&Number.isFinite(ke))De=Math.max(1,Math.floor(ke));else if(typeof ke=="string"){const Z=Number(ke.trim());Number.isFinite(Z)&&Z>0&&(De=Math.max(1,Math.floor(Z)))}const ce=c==null?void 0:c[K];let Oe=null;if(typeof ce=="number"&&Number.isFinite(ce))Oe=Math.trunc(ce);else if(typeof ce=="string"){const Z=Number(ce.trim());Number.isFinite(Z)&&(Oe=Math.trunc(Z))}const Ye=typeof(f==null?void 0:f.default)=="number"&&Number.isFinite(f.default)?Math.max(1,Math.floor(f.default)):null,ct=typeof(g==null?void 0:g.default)=="number"&&Number.isFinite(g.default)?Math.trunc(g.default):null,Je=typeof(c==null?void 0:c[se])=="string"?String(c[se]).trim():"",mt=Je.length?Je:null,Ze=v.useMemo(()=>Pa(c==null?void 0:c.baseline_hyperparameters),[c==null?void 0:c.baseline_hyperparameters]),ot=v.useMemo(()=>Pa(c==null?void 0:c.search_space),[c==null?void 0:c.search_space]),Et=v.useMemo(()=>sg(ot.value),[ot.value]),zt=Ze.value,We=Ze.error,Dt=Et.value,ht=ot.error??Et.error,kt=v.useMemo(()=>rg(zt,J),[J,zt]),sn=v.useMemo(()=>ag(Dt,J),[J,Dt]),wn=v.useMemo(()=>Object.keys(kt).length,[kt]),Mt=v.useMemo(()=>Object.keys(sn).length,[sn]),rn=Mt>0,[Fn,Ut]=v.useState({}),[it,In]=v.useState({}),[Zt,gn]=v.useState(!1),[ft,Os]=v.useState(!1),Yt=v.useRef(null);if(!Yt.current){const Z=lg(c);let Ee=Z.strategies.length>0?Z.strategies.map(J0):[];const Ce=Z0(Ee,Z.activeId),ye=ew(Ee,Z.expandedIds);Ce&&!ye.has(Ce)&&Ee.length&&ye.add(Ce);const et=Nm(Z);Yt.current={strategies:Ee,activeId:Ce,expanded:ye,signature:et}}const[gt,xt]=v.useState(()=>Yt.current?Yt.current.strategies:[]),[ls,dn]=v.useState(()=>new Set(Yt.current?Array.from(Yt.current.expanded):[])),[jn,mn]=v.useState(()=>{var Z;return((Z=Yt.current)==null?void 0:Z.activeId)??""}),An=v.useRef(((ca=Yt.current)==null?void 0:ca.signature)??""),hn=v.useRef(null),is=v.useRef(null),It=v.useMemo(()=>gt.length?gt.find(fe=>fe.id===jn)??gt[0]:null,[jn,gt]),Bn=v.useMemo(()=>lg(c),[c]),On=v.useMemo(()=>Nm(Bn),[Bn]);v.useEffect(()=>{if(On===An.current)return;const Z=Bn.strategies.length?Bn.strategies.map(J0):[],fe=Z0(Z,Bn.activeId),me=ew(Z,Bn.expandedIds);fe&&!me.has(fe)&&Z.length&&me.add(fe),hn.current=null,xt(Z),mn(fe),dn(me),An.current=On},[On,Bn,c]),v.useEffect(()=>{if(!gt.length)return;gt.some(fe=>fe.id===jn)||mn(gt[0].id)},[jn,gt]),v.useEffect(()=>{const Z=w2(gt,jn,ls),fe=Nm(Z);An.current!==fe&&_(me=>{const Ee=lg(me),Ce=Nm(Ee);if(Ce===fe)return An.current=Ce,me??{};const ye=me?{...me}:{};return Z.strategies.length?ye[Io]=Z.strategies.map(et=>({...et,config:os(et.config),searchSpaceTexts:{...et.searchSpaceTexts},searchSpaceFieldErrors:{...et.searchSpaceFieldErrors}})):delete ye[Io],Z.activeId?ye[Bo]=Z.activeId:delete ye[Bo],Z.expandedIds.length?ye[Uo]=[...Z.expandedIds]:delete ye[Uo],An.current=fe,ye})},[jn,ls,_,gt]),v.useEffect(()=>{if(!It||hn.current===It.id)return;hn.current=It.id;const Z=ri(It.config);_(me=>({...b2(me),...Z})),Ut(It.searchSpaceTexts??{}),In(It.searchSpaceFieldErrors??{}),gn(It.hasAutoFilledSearchSpace??!1),Os(It.searchSpaceManuallyCleared??!1);const fe=typeof(Z==null?void 0:Z[G])=="string"?String(Z[G]):(l==null?void 0:l.modelType)??"";is.current=fe},[It,G,l==null?void 0:l.modelType,_]),v.useEffect(()=>{if(!It)return;const Z=ri(c),fe=JSON.stringify(Z)!==JSON.stringify(It.config??{}),me=!tw(Fn,It.searchSpaceTexts),Ee=!tw(it,It.searchSpaceFieldErrors),Ce=It.hasAutoFilledSearchSpace!==Zt,ye=It.searchSpaceManuallyCleared!==ft;!fe&&!me&&!Ee&&!Ce&&!ye||xt(et=>et.map(Ie=>Ie.id!==It.id?Ie:{...Ie,config:Z,searchSpaceTexts:{...Fn},searchSpaceFieldErrors:{...it},hasAutoFilledSearchSpace:Zt,searchSpaceManuallyCleared:ft}))},[It,c,Zt,it,ft,Fn]);const Nn=v.useCallback(()=>{const Z=gt.length+1,fe=ri(c),me=new Set;gt.forEach(Ie=>{var rt;const ut=xm((rt=Ie.config)==null?void 0:rt[q],Ue);ut&&me.add(ut)});const Ee=Ue.find(Ie=>!me.has(Ie))??xe,Ce=os(fe),ye=yr(Ce)?Ce:{};if(ye[q]=Ee,Ee==="random"||Ee==="optuna"){const Ie=De!==null?De:Ye;Ie!==null?ye[F]=Ie:delete ye[F];const ut=Oe!==null?Oe:ct;ut!==null?ye[K]=ut:delete ye[K]}else delete ye[F],delete ye[K];const et=y2(Ta(Z),ye,{searchSpaceTexts:{...Fn},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:Zt,searchSpaceManuallyCleared:ft});xt(Ie=>[...Ie,et]),dn(Ie=>new Set([...Ie,et.id])),hn.current=null,mn(et.id)},[Ue,c,Zt,De,Ye,Oe,ct,ft,Fn,xe,q,F,K,xt,mn,dn,gt]),lr=v.useCallback(Z=>{dn(fe=>{const me=new Set(fe);return me.has(Z)?me.delete(Z):me.add(Z),me})},[]),Xn=v.useCallback(Z=>{!Z||Z===jn||(hn.current=null,mn(Z),dn(fe=>{const me=new Set(fe);return me.add(Z),me}))},[jn]),Ps=v.useCallback(Z=>{let fe=null;xt(me=>{if(me.length<=1)return me;const Ee=me.filter(ye=>ye.id!==Z);if(!Ee.length)return me;const Ce=Ee.map((ye,et)=>({...ye,label:Ta(et+1)}));if(Z===jn){hn.current=null;const ye=Ce[0].id;fe=ye,mn(ye)}return Ce}),dn(me=>{const Ee=new Set(me);return Ee.delete(Z),fe&&Ee.add(fe),Ee})},[jn]),_s=v.useMemo(()=>gt.map((Z,fe)=>{var qr,cr;const me=Z.config??{},Ee=me==null?void 0:me[G],Ce=typeof Ee=="string"?Ee.trim():"",ye=((qr=p.find(ts=>ts.value===Ce))==null?void 0:qr.label)??Ce,et=me==null?void 0:me[q],Ie=typeof et=="string"?et.trim():"",ut=(cr=((h==null?void 0:h.options)??[]).find(ts=>ts.value===Ie))==null?void 0:cr.label,rt=me==null?void 0:me[se],Ge=typeof rt=="string"?rt.trim():"",Tn=Pa(me==null?void 0:me.baseline_hyperparameters).error,Ht=Pa(me==null?void 0:me.search_space),Sn=sg(Ht.value),$s=Sn.value?Object.keys(Sn.value).length:0,Ls=Sn.value?Object.values(Sn.value).reduce((ts,ys)=>ts+(Array.isArray(ys)?ys.length:0),0):0,er=Tn!==null||Object.values(Z.searchSpaceFieldErrors).some(ts=>!!ts);return{id:Z.id,label:Z.label||Ta(fe+1),modelLabel:ye||"Select model",searchStrategyLabel:ut??(Ie||"Random search"),scoringLabel:Ge||"Estimator default",parameterCount:$s,candidateCount:Ls,hasErrors:er}}),[p,G,se,h,q,gt]);v.useEffect(()=>{const Z=is.current;if(Z===null){is.current=H;return}Z!==H&&(is.current=H,Ut({}),In({}),gn(!1),Os(!1))},[H]),v.useEffect(()=>{!H||!X.length||Ut(Z=>{const fe={...Z};let me=!1;return X.forEach(Ee=>{if(it[Ee.name])return;const Ce=sn[Ee.name],ye=Array.isArray(Ce)&&Ce.length>0?Ce.map(et=>G0(Ee,et)).join(", "):"";fe[Ee.name]!==ye&&(fe[Ee.name]=ye,me=!0)}),me?fe:Z})},[sn,X,H,it]),v.useEffect(()=>{if(!H||!X.length||ft)return;if(rn){Zt||gn(!0);return}if(Zt)return;const Z=_2(X,ee);Object.keys(Z).length&&(gn(!0),In({}),Ut(()=>{const fe={};return X.forEach(me=>{if(!Z[me.name])return;const Ee=Z[me.name].map(Ce=>G0(me,Ce)).filter(Ce=>Ce.length>0).join(", ");fe[me.name]=Ee}),fe}),_(fe=>{const me=fe?{...fe}:{};return me.search_space=Z,me}))},[Zt,ee,X,H,rn,ft,_]);const[vs,Xs]=v.useState(mt??"");v.useEffect(()=>{Xs(mt??"")},[mt]);const Jn=v.useMemo(()=>v2[B==="regression"?"regression":"classification"],[B]),Qt=(w==null?void 0:w.label)??"Scoring metric",At=(w==null?void 0:w.description)??"Pick the evaluation metric used to rank candidates.",st=v.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),ir=v.useMemo(()=>Object.values(it).some(Z=>!!Z),[it]),Un=v.useCallback((Z,fe)=>{J.has(Z)&&_(me=>{const Ee={...me},Ce=Pa(me==null?void 0:me.baseline_hyperparameters).value??{},et={...rg(Ce,J)};return fe===void 0?delete et[Z]:et[Z]=fe,Object.keys(et).length>0?Ee.baseline_hyperparameters=et:delete Ee.baseline_hyperparameters,Ee})},[J,_]),Js=v.useCallback((Z,fe)=>{Ut(Ce=>({...Ce,[Z.name]:fe}));const{values:me,error:Ee}=g2(Z,fe);In(Ce=>({...Ce,[Z.name]:Ee})),!Ee&&_(Ce=>{const ye={...Ce},et=Pa(Ce==null?void 0:Ce.search_space).value??{},ut={...ag(et,J)};return me.length>0?ut[Z.name]=me.map(rt=>os(rt)):delete ut[Z.name],Object.keys(ut).length>0?ye.search_space=ut:delete ye.search_space,ye})},[J,_]),cs=v.useCallback(Z=>{Un(Z,void 0)},[Un]),wr=v.useCallback(()=>{_(Z=>{if(!Z||!Z.baseline_hyperparameters)return Z??{};const fe={...Z};return delete fe.baseline_hyperparameters,fe})},[_]),le=v.useCallback(()=>{Os(!0),gn(!0),Ut({}),In({}),_(Z=>{if(!Z||!Z.search_space)return Z??{};const fe={...Z};return delete fe.search_space,fe})},[_]),_e=v.useCallback(Z=>{Xs(Z);const fe=Z.trim();_(me=>{const Ee={...me};return fe.length>0?Ee.scoring_metric=fe:delete Ee.scoring_metric,Ee})},[_]),$e=v.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const fe=`baseline-${e}-${Z.name}`,me=kt[Z.name],Ee=me!==void 0,Ce=ee==null?void 0:ee[Z.name],ye=Z.label??Z.name,et=Z.description,Ie=Ce!==void 0?`Default: ${wm(Ce)}`:"Default: estimator setting";let ut;if(Z.type==="number"){const rt=typeof me=="number"?String(me):"";ut=a.jsx("input",{id:fe,type:"number",className:"canvas-modal__parameter-input",value:rt,onChange:Ge=>{const Nt=Ge.target.value;if(!Nt.length){cs(Z.name);return}const Tn=Number(Nt);Number.isFinite(Tn)&&Un(Z.name,Tn)},min:Z.min,max:Z.max,step:Z.step,placeholder:"Leave blank to use default"})}else if(Z.type==="select"){const rt=Ee?String(me):"";ut=a.jsxs("select",{id:fe,className:"canvas-modal__parameter-select",value:rt,onChange:Ge=>{const Nt=Ge.target.value;if(!Nt.length){cs(Z.name);return}Un(Z.name,Nt)},children:[a.jsx("option",{value:"",children:"Use default"}),(Z.options??[]).map(Ge=>a.jsx("option",{value:Ge.value,children:Ge.label},Ge.value))]})}else if(Z.type==="boolean"){const rt=Ee?me?"true":"false":"";ut=a.jsxs("select",{id:fe,className:"canvas-modal__parameter-select",value:rt,onChange:Ge=>{const Nt=Ge.target.value;if(!Nt.length){cs(Z.name);return}Un(Z.name,Nt==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const rt=typeof me=="string"?me:"";ut=a.jsx("input",{id:fe,type:"text",className:"canvas-modal__parameter-input",value:rt,onChange:Ge=>{const Nt=Ge.target.value;if(!Nt.length){cs(Z.name);return}Un(Z.name,Nt)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:fe,className:"canvas-modal__parameter-label",children:[ye,et&&a.jsx("span",{className:"canvas-modal__parameter-description",children:et})]}),ut,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Ee?`Override: ${wm(me)}`:Ie})})]},Z.name)},[J,kt,ee,e,Un]),Ct=v.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const fe=`search-${e}-${Z.name}`,me=Fn[Z.name]??"",Ee=sn[Z.name],Ce=Array.isArray(Ee)?Ee.length:0,ye=it[Z.name],et=ee==null?void 0:ee[Z.name],Ie=Z.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":Z.type==="boolean"?"Enter true/false values, separated by commas or new lines":Z.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",ut=Array.isArray(Ee)?Ee.slice(0,3).map(rt=>wm(rt)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:fe,className:"canvas-modal__parameter-label",children:[Z.label??Z.name,Z.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:Z.description})]}),a.jsx("textarea",{id:fe,className:"canvas-modal__parameter-input",rows:3,value:me,onChange:rt=>Js(Z,rt.target.value),placeholder:Ie,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Ce>0?`Configured ${Ce} value${Ce===1?"":"s"}${ut?` (${ut}${Ce>3?"":""})`:""}`:`Default: ${wm(et)}`})}),ye&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:ye})]},Z.name)},[J,sn,Js,ee,e,it,Fn]),je=v.useMemo(()=>{if(!rn)return{parameterCount:0,candidateProduct:null};const Z=Object.values(sn),fe=Z.length;let me=null;if(Z.length>0){let Ee=1,Ce=!1;Z.forEach(ye=>{Ee*=Math.max(ye.length,1),(!Number.isFinite(Ee)||Ee>1e6)&&(Ce=!0)}),me=Ce?null:Ee}return{parameterCount:fe,candidateProduct:me}},[sn,rn]),tt=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),lt=v.useCallback(Z=>{if(!tt)return null;const fe=os(tt);if(!fe||!Array.isArray(fe.nodes))return tt;const me=Ic(Z),Ee=Object.keys(me).length>0;return fe.nodes=fe.nodes.map(Ce=>{if(!Ce||Ce.id!==e)return Ce;const ye=(Ce==null?void 0:Ce.data)??{},et=(ye==null?void 0:ye.config)??{},Ie=Ic(et),ut=Ee?{...Ie,...me}:Ie;return{...Ce,data:{...ye,config:ut,isConfigured:!0}}}),fe},[tt,e]),Rt=v.useMemo(()=>{const Z=lt(c);return Z||tt},[c,tt,lt]),Ot=v.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const Z=n.nodes,fe=n.edges;return(()=>{var et;const ye=Z.find(Ie=>(Ie==null?void 0:Ie.id)===e);return ye?Y0((et=ye==null?void 0:ye.data)==null?void 0:et.connectedSplits):[]})().includes("validation")||fe.some(ye=>!ye||(typeof ye.target=="string"?ye.target:null)!==e?!1:(typeof ye.sourceHandle=="string"?ye.sourceHandle.toLowerCase():"").includes("validation"))?!0:fe.some(ye=>{var Ge;if(!ye||(typeof ye.target=="string"?ye.target:null)!==e)return!1;const Ie=typeof ye.source=="string"?ye.source:null;if(!Ie)return!1;const ut=Z.find(Nt=>(Nt==null?void 0:Nt.id)===Ie);return ut?Y0((Ge=ut==null?void 0:ut.data)==null?void 0:Ge.activeSplits).includes("validation"):!1})?!1:null},[n,e]);v.useEffect(()=>{let Z=!1;return!t||!tt?(T(null),()=>{Z=!0}):(Do(t,tt).then(fe=>{Z||T(fe)}).catch(()=>{Z||T(null)}),()=>{Z=!0})},[tt,t]),v.useEffect(()=>{let Z=!1;j(null);const fe=Rt??tt;return!t||!fe?(E(null),()=>{Z=!0}):(Do(t,fe).then(me=>{Z||E(me)}).catch(me=>{Z||(j((me==null?void 0:me.message)??"Unable to compute pipeline ID"),E(null))}),()=>{Z=!0})},[tt,Rt,t]),v.useEffect(()=>{if(!N||!L){z(!1);return}z(N!==L)},[N,L]);const an=!!(t&&e),qt=v.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",N??"pending",e],[e,N,t]),fn=Hs({queryKey:qt,queryFn:async()=>{var fe;const Z={datasetSourceId:t||void 0,nodeId:e,limit:5};if(N){const me=await Cc({...Z,pipelineId:N});if((((fe=me==null?void 0:me.jobs)==null?void 0:fe.length)??0)>0)return me}return Cc(Z)},enabled:an,retry:(Z,fe)=>fe.message.includes("Sign in")?!1:Z<2,refetchInterval:Z=>{const fe=Z.state.data;return((fe==null?void 0:fe.jobs)??[]).some(Ce=>Ce.status==="queued"||Ce.status==="running")?5e3:!1}}),{mutateAsync:Ts,isPending:Zn,error:Cn}=Ed({mutationFn:sx,onSuccess:Z=>{const fe=Array.isArray(Z.jobs)?Z.jobs.length:0,me=fe>0?Z.jobs[0]:null;S(me),A(fe),x.invalidateQueries({queryKey:qt})}}),Pn=v.useMemo(()=>{const Z=[];return t||Z.push("Select a dataset before launching tuning jobs."),(!tt||!tt.nodes.length)&&Z.push("Connect this node to an upstream pipeline before tuning."),V||Z.push("Set a target column before tuning."),Ot===!1&&Z.push("Connect the validation split to this node to enable tuning."),H||Z.push("Choose a model type before enqueuing tuning jobs."),gt.length===0&&Z.push("Add a tuning strategy before launching tuning jobs."),rn||Z.push("Define at least one hyperparameter in the search space."),We&&Z.push(We),ht&&Z.push(ht),ir&&Z.push("Resolve invalid candidate values in the search space."),(xe==="random"||xe==="optuna")&&!De&&Z.push("Provide the maximum iterations for random or Optuna search."),re&&Pe<2&&Z.push("Cross-validation requires at least 2 folds."),M&&Z.push(M),Z},[We,re,Pe,tt,rn,ir,H,M,De,ht,xe,t,V,Ot,gt.length]),us=((Zs=fn.data)==null?void 0:Zs.jobs)??[],es=fn.isLoading||fn.isFetching,Ha=fn.error,tl=v.useMemo(()=>!!(Cn instanceof Error&&ei(Cn.message)||W&&ei(W)||C&&Lc(C)||us.some(Z=>Lc(Z))),[W,Cn,C,us]),yt=A0({graph:n,nodeId:e,modelType:H,problemType:B,modelTypeOptions:p,enabled:tl});v.useEffect(()=>{yt||U(!1)},[yt]);const _i=Pn.length>0||ir||!N||!t||!tt||gt.length===0||!rn||Zn,nl=v.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),sl=v.useCallback(async()=>{if(!N||!t||!tt||gt.length===0)return;if(b){try{const Ce=b({closeModal:!1});z(!1),Ce&&typeof Ce.then=="function"&&await Ce}catch{}await new Promise(Ce=>setTimeout(Ce,100))}const Z=async()=>{const Ce=[],ye=[],et=async Ie=>{if(!Ie)return new Set;if(Ie===H)return J;const ut=["model-hyperparameters",Ie],rt=x.getQueryData(ut),Ge=Nt=>{const Tn=new Set;return(Nt??[]).forEach(Ht=>{Ht!=null&&Ht.name&&Tn.add(Ht.name)}),Tn};if(rt)return Ge(rt.fields);try{const Nt=await x.fetchQuery({queryKey:ut,queryFn:()=>lm(Ie)});return Ge(Nt==null?void 0:Nt.fields)}catch{return new Set}};for(let Ie=0;Ie<gt.length;Ie+=1){const ut=gt[Ie],rt=ut.label||Ta(Ie+1),Ge=ri(ut.config),Nt=Ge==null?void 0:Ge[G],Tn=typeof Nt=="string"&&Nt.trim().length?Nt.trim():H;if(!Tn){ye.push(`${rt} is missing a model selection.`);continue}const Ht=xm(Ge==null?void 0:Ge[q],Ue)??de??"random",Sn=await et(Tn),Ls=Pa(Ge==null?void 0:Ge.baseline_hyperparameters).value??{},er=Sn.size>0?rg(Ls,Sn):os(Ls),qr=Pa(Ge==null?void 0:Ge.search_space);if(qr.error){ye.push(`${rt} has invalid search space: ${qr.error}`);continue}const cr=sg(qr.value);if(cr.error){ye.push(`${rt} has invalid search space: ${cr.error}`);continue}const ts=cr.value??{},ys=Sn.size>0?ag(ts,Sn):os(ts);if(!ys||Object.keys(ys).length===0){ye.push(`${rt} requires at least one hyperparameter in the search space.`);continue}if(Object.values(ut.searchSpaceFieldErrors??{}).some(tn=>!!tn)){ye.push(`${rt} has search space entries that need attention.`);continue}const Wa=Object.keys(ys).length;let zs=null;if(Wa>0){let tn=1,En=!1;Object.values(ys).forEach(ds=>{const bi=Array.isArray(ds)?ds.length:0;tn*=Math.max(bi,1),(!Number.isFinite(tn)||tn>1e6)&&(En=!0)}),zs=En?null:tn}const Ka=Ge==null?void 0:Ge[se],ua=typeof Ka=="string"?Ka.trim():"",Ya=ua.length?ua:null,Ga=()=>{const tn=Ge==null?void 0:Ge[F];let En=null;if(typeof tn=="number"&&Number.isFinite(tn))En=Math.max(1,Math.floor(tn));else if(typeof tn=="string"){const ds=Number(tn.trim());Number.isFinite(ds)&&ds>0&&(En=Math.max(1,Math.floor(ds)))}return En===null&&(Ht==="random"||Ht==="optuna")?Ye!==null?Ye:null:En},Qa=()=>{const tn=Ge==null?void 0:Ge[K];let En=null;if(typeof tn=="number"&&Number.isFinite(tn))En=Math.trunc(tn);else if(typeof tn=="string"){const ds=Number(tn.trim());Number.isFinite(ds)&&(En=Math.trunc(ds))}return En===null&&(Ht==="random"||Ht==="optuna")?ct!==null?ct:null:En},Xa=Ga(),$n=Qa(),en={};V&&(en.target_column=V),en.problem_type=B,en.strategy_id=ut.id,en.strategy_label=rt,en.strategy_index=Ie+1,en.search_strategy=Ht,Xa!==null&&(Ht==="random"||Ht==="optuna")&&(en.max_iterations=Xa),Ya&&(en.scoring_metric=Ya),$n!==null&&(en.random_state=$n),en.search_space_keys=Object.keys(ys),Wa>0&&(en.search_space_parameters=Wa),zs!==null&&(en.search_space_candidates=zs),en.cross_validation={enabled:re,strategy:we,folds:Pe,shuffle:Me,random_state:Fe};const Ja=lt(Ge)??tt;if(!Ja){ye.push(`Unable to build pipeline graph for ${rt}.`);continue}const da=er&&Object.keys(er).length>0?os(er):void 0,Xc=os(ys),al={dataset_source_id:t,pipeline_id:N,node_id:e,model_type:Tn,model_types:[Tn],search_strategy:Ht,search_space:Xc,baseline_hyperparameters:da,n_iterations:Ht==="random"||Ht==="optuna"?Xa??void 0:void 0,scoring:Ya??void 0,random_state:$n??void 0,cross_validation:{enabled:re,strategy:we,folds:Pe,shuffle:Me,random_state:Fe},metadata:en,job_metadata:en,run_tuning:!0,graph:Ja,target_node_id:e};Ce.push({payload:al,label:rt})}return{plans:Ce,issues:ye}};D(null);const{plans:fe,issues:me}=await Z();if(!fe.length){me.length&&D(me.join(" "));return}const Ee=[];for(const{payload:Ce}of fe)try{const ye=await Ts(Ce);Array.isArray(ye==null?void 0:ye.jobs)&&ye.jobs.length&&Ee.push(...ye.jobs)}catch(ye){ye instanceof Error&&ye.message?D(ye.message):D("Failed to enqueue one or more tuning jobs.");return}if(Ee.length){const Ce=Ee[Ee.length-1];S(Ce),A(Ee.length)}},[J,re,Pe,Fe,Me,we,Ts,tt,lt,H,G,e,b,de,x,N,B,se,Ye,F,ct,K,q,D,z,t,gt,V]),vi=v.useCallback(()=>{an&&fn.refetch()},[an,fn]),yi=Z=>{var Tn,Ht,Sn,$s,Ls;const fe=h2[Z.status]??Z.status,Ee=(((Tn=p.find(er=>er.value===Z.model_type))==null?void 0:Tn.label)??Z.model_type??"").trim(),Ce=(()=>{switch(Z.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"halving_random":return"Successive halving (randomized)";case"optuna":return"Optuna search";default:return"Random search"}})(),ye=Z.updated_at?Qn(Z.updated_at):null,et=Z.updated_at||Z.created_at,Ie=et?ye??new Date(et).toLocaleString():null,ut=typeof Z.error_message=="string"?Z.error_message.trim():"",rt=[];Ee&&rt.push(`Model ${Ee}`),rt.push(Ce),Array.isArray(Z.results)&&Z.results.length>0&&rt.push(`${Z.results.length} candidates`);const Ge=typeof Z.best_score=="number"&&Number.isFinite(Z.best_score)?Z.best_score:typeof((Ht=Z.metrics)==null?void 0:Ht.best_score)=="number"?Z.metrics.best_score:null;Ge!==null&&rt.push(`Best score ${f2(Ge)}`);const Nt=String(((Sn=Z.metrics)==null?void 0:Sn.scoring)??(($s=Z.metrics)==null?void 0:$s.scorer)??((Ls=Z.metadata)==null?void 0:Ls.scoring_metric)??"").trim();if(Nt&&rt.push(`Scoring ${Nt}`),Z.status==="failed"&&ut){const er=ut.replace(/\s+/g," ");rt.push(`Error: ${er}`)}return Ie&&rt.push(`Updated ${Ie}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["Run ",Z.run_number]}),"  ",fe,rt.length?`  ${rt.join("  ")}`:""]},Z.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Nn,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:vi,disabled:!an||es,children:es?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:N})]}),P&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]}),Pn.map((Z,fe)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Z},`tuning-prereq-${fe}`)),Cn instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Cn.message}),W&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:W}),Ha&&!(Cn instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Ha.message||"Unable to load tuning jobs."}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:$>1?a.jsxs("span",{children:["Queued ",$," tuning jobs. Latest job ",C.id," (run ",C.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",C.id," queued (run ",C.run_number,")."]})}),rn&&je.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",je.parameterCount," hyperparameter",je.parameterCount===1?"":"s",je.candidateProduct!==null?`  up to ${je.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsxs("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:[gt.length===0&&a.jsx("p",{style:{margin:"0",padding:"1rem 1.25rem",border:"1px dashed rgba(148, 163, 184, 0.4)",borderRadius:"6px",color:"rgba(148, 163, 184, 0.85)",background:"rgba(15, 23, 42, 0.35)"},children:'No tuning strategies configured yet. Use "Add strategy" to define your search plan.'}),gt.map((Z,fe)=>{const me=_s[fe],Ee=!!(It&&It.id===Z.id),Ce=ls.has(Z.id),ye=[];if(me!=null&&me.modelLabel&&ye.push(me.modelLabel),me!=null&&me.searchStrategyLabel&&ye.push(me.searchStrategyLabel),me!=null&&me.scoringLabel&&ye.push(`Scoring ${me.scoringLabel}`),me!=null&&me.parameterCount){const Ie=me.candidateCount?`${me.parameterCount} param${me.parameterCount===1?"":"s"}  ${me.candidateCount} candidate${me.candidateCount===1?"":"s"}`:`${me.parameterCount} param${me.parameterCount===1?"":"s"}`;ye.push(Ie)}else ye.includes("Needs attention")||ye.push("No search values");me!=null&&me.hasErrors&&ye.push("Needs attention");const et=ye.length>0?ye.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{lr(Z.id),Ee||Xn(Z.id)},"aria-expanded":Ce,"aria-controls":`tuning-strategy-body-${Z.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${Ce?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(me==null?void 0:me.label)??Ta(fe+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:et})]})]}),gt.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>Ps(Z.id),"aria-label":`Remove ${(me==null?void 0:me.label)??Ta(fe+1)}`,children:"Remove"})]}),Ce&&Ee&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${Z.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[nl&&u(nl),h&&u(h),(xe==="random"||xe==="optuna")&&f&&u(f),(xe==="random"||xe==="optuna")&&g&&u(g)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:Qt}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:At}),a.jsxs("div",{id:st,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:vs||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[Jn.map(Ie=>a.jsx("button",{type:"button",onClick:()=>_e(Ie.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:vs===Ie.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:vs===Ie.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:Ie.label},Ie.value)),a.jsx("button",{type:"button",onClick:()=>_e(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),H&&X.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:wn>0?`${wn} override${wn===1?"":"s"} configured`:"Using template defaults"}),wn>0&&a.jsx("button",{type:"button",onClick:wr,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),We&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:We}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:X.map($e)})]}),H&&X.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Mt>0?`${Mt} parameter${Mt===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:le,disabled:Mt===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Mt===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:Mt===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:Mt===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),ht&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:ht}),ir&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:X.map(Ct)})]})]})]},Z.id)})]}),re&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",Pe," folds before reporting aggregate metrics."]}),yt&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",yt.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:yt.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>U(Z=>!Z),style:{whiteSpace:"nowrap"},children:R?"Hide tips":"Show tips"})]}),R&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:yt.details.map((Z,fe)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:Z},`tuning-scaling-tip-${fe}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:sl,disabled:_i,children:Zn?"Queuing":"Launch tuning job"})}),es&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!es&&us.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),us.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:us.map(yi)})]})},ig={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},N2=(e,t)=>{if(e==null||e==="")return ig[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return ig[t].auto;const s=Math.max(Math.min(e,1),0),l=s*100,i=s.toFixed(s>=.1||s===0?2:3),c=t==="undersampling"?"majority":"majority baseline";return`${i} ratio (${l.toFixed(1)}% of ${c})`}const n=e.trim().toLowerCase();return ig[t][n]??n},C2=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let s=e.length-1;s>=0;s-=1){const l=e[s];if(typeof l!="string")continue;const i=l.toLowerCase();if(n.some(c=>i.includes(c)))return l}return null},S2=(e,t)=>t?"Missing":e.length?e:"Empty string",E2=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:l,config:i,methodParameter:c,targetColumnParameter:u,samplingStrategyParameter:d,randomStateParameter:p,replacementParameter:h,kNeighborsParameter:f,renderParameterField:g,formatMetricValue:w,formatMissingPercentage:_,schemaGuard:b})=>{var F;const x=s.data,N=s.status,E=Array.isArray(x==null?void 0:x.applied_steps)?x==null?void 0:x.applied_steps:[],M=v.useMemo(()=>C2(E,e),[E,e]),j=(i==null?void 0:i.targetColumn)??"",C=(i==null?void 0:i.method)||(typeof(c==null?void 0:c.default)=="string"?c.default:""),S=v.useMemo(()=>{const K=Array.isArray(c==null?void 0:c.options)?c==null?void 0:c.options:[];if(C){const se=K.find(Q=>Q.value===C);return se!=null&&se.label?se.label:C.replace(/_/g," ")}return K.length>0?K[0].label??K[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[C,c==null?void 0:c.options,e]),$=v.useMemo(()=>N2(i==null?void 0:i.samplingStrategy,e),[i==null?void 0:i.samplingStrategy,e]),A=v.useMemo(()=>(i==null?void 0:i.randomState)===null||(i==null?void 0:i.randomState)===void 0?"Not set":Number.isFinite(i.randomState)?String(i.randomState):"Not set",[i==null?void 0:i.randomState]),L=v.useMemo(()=>{if(e!=="oversampling")return null;const K=i==null?void 0:i.kNeighbors;if(typeof K=="number"&&Number.isFinite(K))return String(Math.max(1,Math.round(K)));if(f&&typeof f.default=="number"){const se=f.default;if(Number.isFinite(se))return String(Math.max(1,Math.round(se)))}return"Default"},[i==null?void 0:i.kNeighbors,f,e]),T=(i==null?void 0:i.replacement)===null||(i==null?void 0:i.replacement)===void 0?null:i.replacement?"With replacement":"Without replacement",P=v.useMemo(()=>{if(N!=="success"||!x||!j)return{rows:[],total:0,truncated:!1};const K=Array.isArray(x.sample_rows)?x.sample_rows:[];if(!K.length)return{rows:[],total:0,truncated:!1};const se=new Map;K.forEach(re=>{if(!re||typeof re!="object")return;const we=re[j],Pe=we==null,Me=Pe?"__missing__":String(we),Fe=S2(Pe?"":Me,Pe),Ke=se.get(Me);Ke?Ke.count+=1:se.set(Me,{label:Fe,count:1,percentage:0,isMissing:Pe})});const Q=Array.from(se.values()).sort((re,we)=>we.count-re.count),H=Q.reduce((re,we)=>re+we.count,0),Y=8,X=Q.length>Y;return{rows:(X?Q.slice(0,Y):Q).map(re=>({...re,percentage:H>0?re.count/H*100:0})),total:H,truncated:X}},[x,N,j]),z=((F=x==null?void 0:x.metrics)==null?void 0:F.row_count)??null,W=!!t&&n&&N!=="loading"&&!(b!=null&&b.blocked),D=v.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),R=v.useMemo(()=>!(b!=null&&b.blocked)||!b.details.length?"":b.details.map(K=>K.logical_family?`${K.name} (${K.logical_family})`:K.name).join(", "),[b]),U=!j,V=!!j&&Array.isArray(x==null?void 0:x.columns)&&!(x!=null&&x.columns.includes(j)),B=e==="undersampling"?"Class undersampling":"Class oversampling",G=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",q=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:B}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:!W,children:N==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:G}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:D}),U&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",q,"."]}),(b==null?void 0:b.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[b.message,R&&a.jsxs(a.Fragment,{children:[" ","Columns: ",R,"."]})]}),N==="error"&&s.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),V&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",j," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:M}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:S})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:$})]}),e==="oversampling"&&L&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:L})]}),T&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:T})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:A})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[c&&g(c),d&&g(d),e==="oversampling"&&f&&g(f),p&&g(p),h&&g(h)]}),u&&a.jsx("div",{className:"canvas-modal__parameter-list",children:g(u)}),j&&N==="success"&&!V&&(P.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:P.rows.map(K=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:K.label}),a.jsx("td",{children:w(K.count)}),a.jsx("td",{children:_(K.percentage)})]},`resampling-class-${K.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",w(P.total)," row",P.total===1?"":"s"," from the preview.",P.truncated?" Showing top classes by frequency.":""]}),z!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",w(z),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},k2=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},M2=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),A2=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),O2=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return v.useMemo(()=>{const s=k2(e),l=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",i=t==="missing_value_indicator",c=t==="replace_aliases_typos",u=t==="trim_whitespace",d=t==="remove_special_characters",p=t==="replace_invalid_values",h=t==="regex_replace_fix",f=t==="normalize_text_case",g=t==="standardize_date_formats",w=t==="label_encoding",_=t==="target_encoding",b=t==="hash_encoding",x=t==="train_model_draft",N=t==="model_evaluation",E=t==="model_registry_overview",M=t==="hyperparameter_tuning",j=t==="feature_target_split",C=t==="train_test_split",S=t==="class_undersampling",$=t==="class_oversampling",A=t==="ordinal_encoding",L=t==="dummy_encoding",T=t==="one_hot_encoding",P=t==="feature_math",z=t==="cast_column_types",W=t==="binning_discretization",D=t==="scale_numeric_features",R=t==="polynomial_features",U=t==="feature_selection",V=t==="transformer_audit",B=t==="outlier_removal",G=t==="skewness_transform",q=t==="skewness_distribution",F=t==="binned_distribution",K=A2.has(t),se=M2.has(t),Q=t==="remove_duplicates",H=t==="drop_missing_columns",Y=t==="drop_missing_rows";return{catalogType:t,isDataset:s,isImputerNode:l,isMissingIndicatorNode:i,isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isReplaceInvalidValuesNode:p,isRegexCleanupNode:h,isNormalizeTextCaseNode:f,isStandardizeDatesNode:g,isLabelEncodingNode:w,isTargetEncodingNode:_,isHashEncodingNode:b,isTrainModelDraftNode:x,isModelEvaluationNode:N,isModelRegistryNode:E,isHyperparameterTuningNode:M,isFeatureTargetSplitNode:j,isTrainTestSplitNode:C,isClassUndersamplingNode:S,isClassOversamplingNode:$,isOrdinalEncodingNode:A,isDummyEncodingNode:L,isOneHotEncodingNode:T,isFeatureMathNode:P,isCastNode:z,isBinningNode:W,isScalingNode:D,isPolynomialFeaturesNode:R,isFeatureSelectionNode:U,isTransformerAuditNode:V,isOutlierNode:B,isSkewnessNode:G,isSkewnessDistributionNode:q,isBinnedDistributionNode:F,isDataConsistencyNode:K,isInspectionNode:se,isRemoveDuplicatesNode:Q,isDropMissingColumnsNode:H,isDropMissingRowsNode:Y,isDropMissingNode:H||Y}},[t,e])},P2=({isScalingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(_=>_+1)},[]);return v.useEffect(()=>{let _=!0;return e?t?n?(h(!0),d(null),Hb(t,{graph:s,targetNodeId:l}).then(b=>{_&&c(b??null)}).catch(b=>{_&&(c(null),d((b==null?void 0:b.message)??"Unable to load scaling insights"))}).finally(()=>{_&&h(!1)}),()=>{_=!1}):(c(null),d("Connect this step to an upstream output to load scaling insights."),h(!1),()=>{_=!1}):(c(null),d("Select a dataset to load scaling insights."),h(!1),()=>{_=!1}):(c(null),d(null),h(!1),()=>{_=!1})},[s,n,e,f,t,l]),{scalingData:i,scalingError:u,isFetchingScaling:p,refreshScaling:w}},T2=({isBinningNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(_=>_+1)},[]);return v.useEffect(()=>{let _=!0;return e?t?n?(h(!0),d(null),Vb(t,{graph:s,targetNodeId:l}).then(b=>{_&&c(b??null)}).catch(b=>{_&&(c(null),d((b==null?void 0:b.message)??"Unable to load binning insights"))}).finally(()=>{_&&h(!1)}),()=>{_=!1}):(c(null),d("Connect this step to an upstream output to analyse numeric columns."),h(!1),()=>{_=!1}):(c(null),d("Select a dataset to load binning insights."),h(!1),()=>{_=!1}):(c(null),d(null),h(!1),()=>{_=!1})},[s,n,e,f,t,l]),{binningData:i,binningError:u,isFetchingBinning:p,refreshBinning:w}},$2=({shouldLoad:e,sourceId:t,graphContext:n,targetNodeId:s,transformations:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useRef(null),_=v.useCallback(()=>{g(b=>b+1)},[]);return v.useEffect(()=>{let b=!0;return e?t?(w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{if(!b)return;h(!0),d(null);let x;l.length>0&&(x=l.map(N=>({column:N.column,method:N.method}))),qb(t,{transformations:x,graph:n,targetNodeId:s}).then(N=>{b&&c(N??null)}).catch(N=>{b&&(c(null),d((N==null?void 0:N.message)??"Unable to load skewness insights"))}).finally(()=>{b&&h(!1)})},300),()=>{b=!1,w.current&&clearTimeout(w.current)}):(c(null),d("Select a dataset to load skewness insights."),h(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{b=!1}):(c(null),d(null),h(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{b=!1})},[n,f,e,t,s,l]),{skewnessData:i,skewnessError:u,isFetchingSkewness:p,refreshSkewness:_}},L2=({isBinnedDistributionNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l,samplePreset:i})=>{const[c,u]=v.useState(null),[d,p]=v.useState(null),[h,f]=v.useState(!1),[g,w]=v.useState(0),_=v.useCallback(()=>{w(b=>b+1)},[]);return v.useEffect(()=>{let b=!0;if(!e)return u(null),p(null),f(!1),()=>{b=!1};if(!t)return u(null),p("Select a dataset to load binned column distributions."),f(!1),()=>{b=!1};if(!n)return u(null),p("Connect this step to an upstream output to load binned column distributions."),f(!1),()=>{b=!1};f(!0),p(null);const x=Ec.find(E=>E.value===i)??Ec[0],N=x.value==="all"?"all":Number(x.value);return Wb(t,{sampleSize:N,graph:s,targetNodeId:l}).then(E=>{b&&u(E??null)}).catch(E=>{b&&(u(null),p((E==null?void 0:E.message)??"Unable to load binned column distributions"))}).finally(()=>{b&&f(!1)}),()=>{b=!1}},[s,n,e,g,i,t,l]),{binnedDistributionData:c,binnedDistributionError:d,isFetchingBinnedDistribution:h,refreshBinnedDistribution:_}},z2=(e,t)=>v.useMemo(()=>{if(!e)return[];const s=(Array.isArray(t==null?void 0:t.columns)?t==null?void 0:t.columns:[]).map(l=>{if(!l||!l.column)return null;const i=Number(l.total_rows),c=Number.isFinite(i)?Math.max(0,Math.round(i)):0;if(c<=0)return null;const d=(Array.isArray(l.bins)?l.bins:[]).map(A=>{if(!A)return null;const T=(typeof A.label=="string"?A.label.trim():String(A.label??""))||(A.is_missing?"Missing":"Unlabeled bin"),P=Number(A.count);if(!Number.isFinite(P))return null;const z=Math.max(0,Math.round(P)),W=Number(A.percentage),D=Number.isFinite(W)?Math.min(100,Math.max(0,W)):0,R=Number(D.toFixed(2));return{label:T,count:z,percentage:R,isMissing:!!A.is_missing}}).filter(A=>!!A);if(!d.length)return null;d.sort((A,L)=>A.isMissing!==L.isMissing?A.isMissing?1:-1:A.count!==L.count?L.count-A.count:A.label.localeCompare(L.label));const p=d.length,h=12,f=p>h,g=f?d.slice(0,h):d,w=Number(l.missing_rows),_=Number.isFinite(w)?Math.max(0,Math.round(w)):0,b=Number(l.distinct_bins),x=Number.isFinite(b)?Math.max(0,Math.round(b)):d.length,N=l.top_label;let E=typeof N=="string"?N.trim()||null:N??null;const M=Number(l.top_count);let j=Number.isFinite(M)?Math.max(0,Math.round(M)):null;const C=Number(l.top_percentage);let S=Number.isFinite(C)?Number(Math.min(100,Math.max(0,C)).toFixed(2)):null;(E===null||j===null||S===null)&&g.length&&(E=g[0].label,j=g[0].count,S=g[0].percentage);const $=typeof l.source_column=="string"?l.source_column.trim()||null:l.source_column??null;return{column:l.column,sourceColumn:$,totalRows:c,missingRows:_,distinctBins:x,topLabel:E,topCount:j,topPercentage:S,bins:g,hasMoreBins:f,totalBinCount:p}}).filter(l=>!!l);return s.sort((l,i)=>{const c=(i.topCount??0)-(l.topCount??0);return c!==0?c:l.column.localeCompare(i.column)}),s},[t,e]),D2=({shouldLoad:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l,setAvailableColumns:i,setColumnMissingMap:c})=>{const[u,d]=v.useState(!1),[p,h]=v.useState(null),[f,g]=v.useState(0),w=v.useCallback(()=>{!e||!t||!n||g(_=>_+1)},[n,e,t]);return v.useEffect(()=>{let _=!0;return e?t?n?(d(!0),h(null),$p(t,{graph:s,targetNodeId:l}).then(b=>{if(!_)return;const x={};b&&typeof b=="object"&&(b!=null&&b.column_missing_map)&&typeof b.column_missing_map=="object"&&Object.entries(b.column_missing_map).forEach(([M,j])=>{const C=String(M??"").trim();if(!C)return;const S=Number(j);Number.isNaN(S)||S<0||(x[C]=Number(S))});const N=new Set;Array.isArray(b==null?void 0:b.all_columns)&&b.all_columns.forEach(M=>{const j=String(M??"").trim();j&&N.add(j)}),Object.keys(x).forEach(M=>N.add(M));const E=Array.from(N).sort((M,j)=>M.localeCompare(j));E.forEach(M=>{Object.prototype.hasOwnProperty.call(x,M)||(x[M]=0)}),E.length&&i(E),Object.keys(x).length&&c(M=>({...M,...x}))}).catch(b=>{_&&h((b==null?void 0:b.message)??"Unable to load column metrics.")}).finally(()=>{_&&d(!1)}),()=>{_=!1}):(h("Connect this step to an upstream output to load column metrics."),d(!1),()=>{_=!1}):(h("Select a dataset to load column metrics."),d(!1),()=>{_=!1}):()=>{_=!1}},[s,n,f,i,c,e,t,l]),{isFetching:u,error:p,refreshDropColumnRecommendations:w}},R2=({isOutlierNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(_=>_+1)},[]);return v.useEffect(()=>{let _=!0;return e?t?n?(h(!0),d(null),Ub(t,{graph:s,targetNodeId:l}).then(b=>{_&&c(b??null)}).catch(b=>{_&&(c(null),d((b==null?void 0:b.message)??"Unable to load outlier insights"))}).finally(()=>{_&&h(!1)}),()=>{_=!1}):(c(null),d("Connect this step to an upstream output to load outlier insights."),h(!1),()=>{_=!1}):(c(null),d("Select a dataset to load outlier insights."),h(!1),()=>{_=!1}):(c(null),d(null),h(!1),()=>{_=!1})},[s,n,e,f,t,l]),{outlierData:i,outlierError:u,isFetchingOutliers:p,refreshOutliers:w}},F2=["int","float","double","decimal","number","numeric","long","short"],I2=["datetime","date","time","timestamp"],B2=["object","string","text","category","categorical","char"],U2=({shouldAnalyze:e,availableColumns:t,columnTypeMap:n,previewSampleRows:s})=>{const l=v.useMemo(()=>{if(!e)return{excluded:new Set,reasons:new Map};const i=new Set,c=new Map;return t.forEach(u=>{const d=(n[u]??"").toLowerCase(),p=F2.some(N=>d.includes(N)),h=I2.some(N=>d.includes(N)),f=B2.some(N=>d.includes(N));if(d.includes("bool")){i.add(u),c.set(u,"Boolean dtype");return}if((h||f)&&!p){i.add(u),c.set(u,"Non-numeric dtype");return}const g=s.map(N=>N&&Object.prototype.hasOwnProperty.call(N,u)?N[u]:void 0).filter(N=>N!=null);if(!g.length){p||(i.add(u),c.set(u,"No numeric samples"));return}let w=!0,_=!1,b=!1;const x=new Set;for(const N of g){if(typeof N=="boolean"){x.add(N?"1":"0");continue}if(typeof N=="number"){if(!Number.isFinite(N)){w=!1;break}_=!0,Math.abs(N)<1e-9?x.add("0"):Math.abs(N-1)<1e-9?x.add("1"):b=!0;continue}if(typeof N=="string"){const E=N.trim();if(!E)continue;const M=E.toLowerCase();if($0.has(M)){x.add("1");continue}if(L0.has(M)){x.add("0");continue}const j=Number(E);if(!Number.isNaN(j)&&Number.isFinite(j)){_=!0,Math.abs(j)<1e-9?x.add("0"):Math.abs(j-1)<1e-9?x.add("1"):b=!0;continue}w=!1;break}w=!1;break}if(!w||!_&&!p){i.add(u),c.set(u,"Non-numeric values");return}!b&&x.size>0&&Array.from(x).every(E=>E==="0"||E==="1")&&(i.add(u),c.set(u,"Binary/bool-like values"))}),{excluded:i,reasons:c}},[t,n,s,e]);return{numericExcludedColumns:l.excluded,numericExclusionReasons:l.reasons}},q2=({isImputerNode:e,imputerStrategies:t,availableColumns:n,columnMissingMap:s,previewColumns:l,previewColumnStats:i,nodeColumns:c,imputerMissingFilter:u})=>{const d=v.useMemo(()=>{if(!e)return[];const g=l.length?new Set(l.map(M=>typeof M=="string"?M.trim():"").filter(M=>M.length>0)):null,w=new Set;t.forEach(M=>{M.columns.forEach(j=>{const C=typeof j=="string"?j.trim():"";C&&w.add(C)})}),Ve(c).forEach(M=>{M&&w.add(M)});const _=M=>!g||g.size===0?!1:!g.has(M)&&!w.has(M),b=new Map,x=(M,j)=>{const C=typeof M=="string"?M.trim():"";if(!C||_(C))return;const S=b.get(C)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};j&&(typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)&&(S.missingPercentage=Math.max(0,j.missingPercentage)),j.dtype!==void 0&&(S.dtype=j.dtype),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&(S.mean=j.mean),typeof j.median=="number"&&!Number.isNaN(j.median)&&(S.median=j.median),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&(S.mode=j.mode)),b.set(C,S)};n.forEach(M=>{const j=Object.prototype.hasOwnProperty.call(s,M)?s[M]:null;x(M,{missingPercentage:typeof j=="number"?j:null})}),(Array.isArray(i)?i:[]).forEach(M=>{!M||!M.name||x(M.name,{missingPercentage:typeof M.missing_percentage=="number"?M.missing_percentage:null,dtype:M.dtype??null,mean:typeof M.mean=="number"?M.mean:null,median:typeof M.median=="number"?M.median:null,mode:M.mode??null})}),Ve(c).forEach(M=>x(M)),t.forEach(M=>{M.columns.forEach(j=>x(j))});const E=Array.from(b.entries()).map(([M,j])=>({name:M,missingPercentage:typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)?Math.max(0,j.missingPercentage):null,dtype:j.dtype??null,mean:typeof j.mean=="number"&&!Number.isNaN(j.mean)?j.mean:null,median:typeof j.median=="number"&&!Number.isNaN(j.median)?j.median:null,mode:j.mode!==void 0&&j.mode!==null&&j.mode!==""?j.mode:null}));return E.sort((M,j)=>{const C=typeof M.missingPercentage=="number",S=typeof j.missingPercentage=="number";return C&&S&&M.missingPercentage!==j.missingPercentage?j.missingPercentage-M.missingPercentage:C!==S?C?-1:1:M.name.localeCompare(j.name)}),E},[n,s,t,c,i,l,e]),p=v.useMemo(()=>{if(!d.length)return 100;const g=d.reduce((_,b)=>{const x=typeof b.missingPercentage=="number"?b.missingPercentage:0;return x>_?x:_},0),w=Math.ceil(g/5)*5;return Math.max(100,w||0)},[d]),h=v.useMemo(()=>d.length?d.reduce((g,w)=>{const _=typeof w.missingPercentage=="number"?w.missingPercentage:null;return _!==null?_<=0?g:_>=u?g+1:g:u===0?g+1:g},0):0,[d,u]),f=u>0;return{imputerColumnOptions:d,imputerMissingSliderMax:p,imputerFilteredOptionCount:h,imputerMissingFilterActive:f}},H2=({configState:e,setConfigState:t,isFeatureTargetSplitNode:n,isTrainTestSplitNode:s,isTrainModelDraftNode:l,isHyperparameterTuningNode:i,isClassResamplingNode:c,isClassOversamplingNode:u,isClassUndersamplingNode:d,upstreamTargetColumn:p,nodeId:h,modelTypeOptions:f})=>{const g=l||i,w=v.useMemo(()=>{if(!n)return null;const A=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",L=Ve(e==null?void 0:e.feature_columns).map(T=>typeof T=="string"?T.trim():"").filter(T=>!!T);return{targetColumn:A,featureColumns:L}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,n]),_=v.useMemo(()=>{if(!s)return null;const A=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,L=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,T=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,P=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,z=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,W=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:A,validation_size:L,random_state:T,shuffle:P,stratify:z,target_column:W}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,s]),b=v.useMemo(()=>{if(!c)return null;const A=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",L=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",T=e==null?void 0:e.sampling_strategy;let P=null;if(typeof T=="number"&&Number.isFinite(T))P=T;else if(typeof T=="string"){const U=T.trim();P=U||null}else T===null&&(P=null);const z=e==null?void 0:e.random_state;let W=null;if(typeof z=="number"&&Number.isFinite(z))W=z;else if(typeof z=="string"){const U=Number(z);W=Number.isFinite(U)?U:null}let D=null;if(d){const U=e==null?void 0:e.replacement;D=typeof U=="boolean"?U:typeof U=="string"?U.trim().toLowerCase()==="true":!!U}let R=null;if(u){const U=e==null?void 0:e.k_neighbors;if(typeof U=="number"&&Number.isFinite(U))R=Math.max(1,Math.round(U));else if(typeof U=="string"){const V=Number(U);Number.isFinite(V)&&(R=Math.max(1,Math.round(V)))}}return{method:A,targetColumn:L,samplingStrategy:P,randomState:W,replacement:D,kNeighbors:R}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,u,c,d]),x=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",N=x==="regression"?"regression":"classification",E=v.useMemo(()=>Array.isArray(f)?f.filter(A=>A&&typeof A.value=="string"):[],[f]),M=v.useMemo(()=>{const A={classification:[],regression:[]};return E.forEach(L=>{var P;const T=String(((P=L==null?void 0:L.metadata)==null?void 0:P.problem_type)??"").trim().toLowerCase();T==="regression"?A.regression.push(L):T==="classification"?A.classification.push(L):(A.classification.push(L),A.regression.push(L))}),A},[E]),j=v.useMemo(()=>{if(!E.length)return[];const A=N==="regression"?M.regression:M.classification;return A.length>0?A:E},[E,M,N]),C=v.useMemo(()=>g?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:N}:null,[e==null?void 0:e.target_column,g,N]),S=v.useMemo(()=>{if(!g)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const A=(e==null?void 0:e.cv_enabled)===void 0?!!i:!!e.cv_enabled,L=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",T=["auto","kfold","stratified_kfold"].includes(L)?L:"auto",P=Number(e==null?void 0:e.cv_folds),z=Number.isFinite(P)&&P>=2?Math.floor(P):5,W=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let D=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))D=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const V=Number(e.cv_random_state.trim());D=Number.isFinite(V)?Math.trunc(V):null}const U=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:A,strategy:T,folds:z,shuffle:W,randomState:D,refitStrategy:U}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,i,g]);v.useEffect(()=>{g&&x!==N&&t(A=>({...A,problem_type:N}))},[g,N,x,t]),v.useEffect(()=>{var P;if(!g||!j.length)return;const A=new Set(j.map(z=>z.value)),L=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if(L&&A.has(L))return;const T=((P=j[0])==null?void 0:P.value)??"";T&&t(z=>{const W=typeof(z==null?void 0:z.model_type)=="string"?z.model_type.trim():"";return W&&A.has(W)||W===T?z:{...z,model_type:T}})},[e==null?void 0:e.model_type,j,g,t]);const $=v.useMemo(()=>{if(!g)return null;const A=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",L=e==null?void 0:e.hyperparameters;let T=null,P=null;if(L&&typeof L=="string"){const z=L.trim();if(z.length)try{const W=JSON.parse(z);W&&typeof W=="object"&&!Array.isArray(W)?T=W:P="Hyperparameters JSON must be an object."}catch{P="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else L&&typeof L=="object"&&!Array.isArray(L)&&(T=L);return{modelType:A||null,hyperparameters:T,hyperparametersError:P}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,g]);return v.useEffect(()=>{(s||l||i)&&p&&(s&&(e==null?void 0:e.stratify)!==!0||t(A=>(typeof(A==null?void 0:A.target_column)=="string"?A.target_column.trim():"")?A:{...A,target_column:p}))},[e==null?void 0:e.stratify,i,l,s,h,t,p]),{featureTargetSplitConfig:w,trainTestSplitConfig:_,resamplingConfig:b,trainModelDraftConfig:C,trainModelRuntimeConfig:$,trainModelCVConfig:S,filteredModelTypeOptions:j}},V2=["int","float","double","numeric","number"],nw=e=>{if(!e)return!1;const t=e.toLowerCase();return V2.some(n=>t.includes(n))},W2=({skewnessData:e,shouldLoadInsights:t,skewnessTransformations:n,availableColumns:s,previewColumns:l,columnTypeMap:i,updateSkewnessTransformations:c})=>{const[u,d]=v.useState("recommended"),[p,h]=v.useState(!1),[f,g]=v.useState("before"),w=n.length,_=v.useMemo(()=>e!=null&&e.methods?[...e.methods]:[],[e==null?void 0:e.methods]),b=v.useMemo(()=>FM(_),[_]),x=v.useMemo(()=>e!=null&&e.columns?[...e.columns]:[],[e==null?void 0:e.columns]),N=v.useMemo(()=>{const V=new Map;return x.forEach(B=>{B&&B.column&&V.set(B.column,B)}),V},[x]),E=v.useMemo(()=>{const V=new Set;return x.forEach(B=>{B!=null&&B.column&&V.add(B.column)}),s.forEach(B=>{B&&nw(i[B]??null)&&V.add(B)}),l.forEach(B=>{const G=typeof B=="string"?B.trim():"";G&&nw(i[G]??null)&&V.add(G)}),Array.from(V).sort((B,G)=>B.localeCompare(G))},[s,l,x,i]);v.useEffect(()=>{u==="recommended"&&x.length===0&&E.length>0&&d("all")},[E.length,x.length,u]);const M=(e==null?void 0:e.skewness_threshold)??null,j=v.useCallback(V=>b[V]??V,[b]),C=v.useCallback((V,B)=>{const G=N.get(V);return!G||!G.method_status?{status:"ready",reason:void 0}:G.method_status[B]??{status:"ready",reason:void 0}},[N]),S=v.useCallback(()=>{const V=x.map(B=>{if(!B||!B.column)return null;const G=Array.isArray(B.recommended_methods)?B.recommended_methods.find(ea):void 0;return G?{column:B.column,method:G}:null}).filter(B=>!!B);V.length&&c(B=>{const G=new Map;return B.forEach(q=>{const F=typeof q.column=="string"?q.column.trim():"";F&&ea(q.method)&&G.set(F,q.method)}),V.forEach(q=>{const F=typeof q.column=="string"?q.column.trim():"";F&&G.set(F,q.method)}),Array.from(G.entries()).map(([q,F])=>({column:q,method:F}))})},[x,c]),$=v.useMemo(()=>{const V=new Map;return n.forEach(B=>{const G=typeof B.column=="string"?B.column.trim():"";!G||V.has(G)||V.set(G,B.method)}),V},[n]),A=v.useCallback((V,B)=>{const G=typeof V=="string"?V.trim():"";G&&c(q=>{const F=q.filter(K=>K.column!==G);return B?[...F,{column:G,method:B}]:F})},[c]),L=v.useCallback((V,B)=>{if(V){if(!B){A(V,null);return}ea(B)&&A(V,B)}},[A]),T=v.useCallback(()=>{c(()=>[])},[c]),P=x.length,z=v.useMemo(()=>x.some(V=>V&&typeof V.column=="string"&&Array.isArray(V.recommended_methods)&&V.recommended_methods.some(ea)),[x]),W=E.length,D=v.useMemo(()=>IM({viewMode:u,recommendations:x,columnOptions:E,recommendationMap:N,transformationMap:$}),[u,x,E,N,$]),R=v.useMemo(()=>t?x.map(V=>{var X;if(!V||!V.column)return null;const B=V.distribution_before??V.distribution??null;if(!B||!Array.isArray(B.bin_edges)||!Array.isArray(B.counts)||B.counts.length===0||B.bin_edges.length!==B.counts.length+1)return null;let G=V.distribution_after??null;G&&(!Array.isArray(G.bin_edges)||!Array.isArray(G.counts)||G.counts.length===0||G.bin_edges.length!==G.counts.length+1)&&(G=null);const q=((X=V.recommended_methods)==null?void 0:X.find(ea))??null,F=V.magnitude?`${V.magnitude.charAt(0).toUpperCase()}${V.magnitude.slice(1)}`:null,K=V.direction?gx[V.direction]??V.direction:null,se=V.applied_method&&ea(V.applied_method)?V.applied_method:null,Q=$.get(V.column)??null,H=se??Q??null,Y=H?j(H):null;return{column:V.column,skewness:typeof V.skewness=="number"?V.skewness:null,magnitudeLabel:F,directionLabel:K,summary:V.summary??null,recommendedLabel:Y?null:q?j(q):null,appliedLabel:Y,distributionBefore:B,distributionAfter:G}}).filter(V=>!!V).sort((V,B)=>{const G=V.skewness!==null?Math.abs(V.skewness):-1/0,q=B.skewness!==null?Math.abs(B.skewness):-1/0;return G!==q?q-G:V.column.localeCompare(B.column)}):[],[j,t,x,$]),U=v.useMemo(()=>BM(D,p,j),[D,p,j]);return{skewnessThreshold:M,skewnessViewMode:u,setSkewnessViewMode:d,skewnessGroupByMethod:p,setSkewnessGroupByMethod:h,skewnessDistributionView:f,setSkewnessDistributionView:g,skewnessRecommendedCount:P,skewnessNumericCount:W,skewnessTransformationsCount:w,hasSkewnessAutoRecommendations:z,skewnessRows:D,skewnessTableGroups:U,skewnessDistributionCards:R,getSkewnessMethodLabel:j,getSkewnessMethodStatus:C,applySkewnessRecommendations:S,handleSkewnessOverrideChange:L,clearSkewnessTransformations:T}},K2={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},ks=["iqr","zscore","elliptic_envelope","winsorize","manual"],qo={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},Cm={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},$a={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Sm=(e,{min:t,max:n}={})=>{const s=typeof e=="number"?e:Number(e);if(!Number.isFinite(s))return null;let l=s;return typeof t=="number"&&Number.isFinite(t)&&l<t&&(l=t),typeof n=="number"&&Number.isFinite(n)&&l>n&&(l=n),l},sw=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const s=String(n??"").trim();s&&t.push(s)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,s)=>n.localeCompare(s))},Y2=e=>{const t={iqr:{...$a.iqr},zscore:{...$a.zscore},elliptic_envelope:{...$a.elliptic_envelope},winsorize:{...$a.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,s])=>{const l=n.trim().toLowerCase();if(!ks.includes(l))return;const i=t[l]??{};if(!(!s||typeof s!="object"||Array.isArray(s))){if(Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Cm[l].includes(d))return;let p={};d==="threshold"?p={min:.1}:d==="multiplier"?p={min:.1}:(d==="lower_percentile"||d==="upper_percentile")&&(p={min:0,max:100});const h=Sm(u,p);h!==null&&(i[d]=h)}),l==="winsorize"){const c=Sm(i.lower_percentile,{min:0,max:100}),u=Sm(i.upper_percentile,{min:0,max:100});typeof c=="number"&&typeof u=="number"&&c>=u?(i.lower_percentile=$a.winsorize.lower_percentile,i.upper_percentile=$a.winsorize.upper_percentile):(typeof c=="number"&&(i.lower_percentile=c),typeof u=="number"&&(i.upper_percentile=u))}t[l]=i}}),t},G2=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,s])=>{const l=String(n??"").trim();if(!l||!s||typeof s!="object"||Array.isArray(s))return;const i={};Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Object.values(Cm).some(g=>g.includes(d)))return;let h={};d==="threshold"?h={min:.1}:d==="multiplier"?h={min:.1}:d==="contamination"?h={min:1e-4,max:.49}:(d==="lower_percentile"||d==="upper_percentile")&&(h={min:0,max:100});const f=Sm(u,h);f!==null&&(i[d]=f)}),Object.keys(i).length&&(t[l]=i)}),t},Q2=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=sw(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",l=ks.includes(s)?s:"iqr",i={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([h,f])=>{const g=String(h??"").trim(),w=typeof f=="string"?f.trim().toLowerCase():"";g&&ks.includes(w)&&(i[g]=w)});const c=typeof t.auto_detect=="boolean"?t.auto_detect:!0,u=sw(t.skipped_columns),d=Y2(t.method_parameters),p=G2(t.column_parameters);return{columns:n,defaultMethod:l,columnMethods:i,autoDetect:c,skippedColumns:u,methodParameters:d,columnParameters:p}},X2=e=>{const t={...qo};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&l&&ks.includes(s)&&(t[s]=l)}),t},J2=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&ks.includes(s)&&t.set(s,n)}),t},Z2=e=>ks.map(t=>({value:t,label:e[t]??qo[t]??t})),e$=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:s,skippedColumns:l,excludedColumns:i})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p={};Array.isArray(u==null?void 0:u.method_summaries)&&u.method_summaries.forEach(M=>{const j=M==null?void 0:M.method;j&&ks.includes(j)&&(p[j]=M)});const h=u!=null&&u.recommended_method&&ks.includes(u.recommended_method)?u.recommended_method:null,f=h?n[h]??qo[h]??h:null,g=t.columnMethods[d]??null,w=g??t.defaultMethod,_=n[w]??qo[w]??w,b=l.has(d),x=i.has(d),N=s.has(d),E=!!(u!=null&&u.has_missing);c.push({column:d,dtype:typeof(u==null?void 0:u.dtype)=="string"?u.dtype:null,stats:(u==null?void 0:u.stats)??{},recommendedMethod:h,recommendedLabel:f,recommendedReason:typeof(u==null?void 0:u.recommended_reason)=="string"?u.recommended_reason:null,methodSummaries:p,currentOverride:g,currentMethod:w,currentMethodLabel:_,isOverrideApplied:g!==null,isSelected:N,isSkipped:b,isExcluded:x,hasMissing:E})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},t$=(e,t,n,s)=>{if(!e.length)return null;const l=e.map(i=>{const c=t[i],u=c?n[c]??qo[c]??c:null;return u?`${i} -> ${u}`:i});return s>e.length&&l.push(""),l.join(", ")},n$=(e,t)=>{var l;const n=(l=e==null?void 0:e.parameter_help)==null?void 0:l[t];if(n)return n;const s=t.replace(/_/g," ").trim();return s.charAt(0).toUpperCase()+s.slice(1)},s$=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},r$=(e,t,n,s,l)=>{var p;const i=n[s]??{};if(Object.prototype.hasOwnProperty.call(i,t)){const h=i[t];if(typeof h=="number"&&Number.isFinite(h))return{value:h,fallback:null}}const u=(l[e]??{})[t];return typeof u=="number"&&Number.isFinite(u)?{value:"",fallback:u}:{value:"",fallback:((p=$a[e])==null?void 0:p[t])??null??null}},rw=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",aw={lower_percentile:"%",upper_percentile:"%"},a$=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:s,outlierMethodOptions:l,outlierMethodDetailMap:i,outlierDefaultDetail:c,outlierAutoDetectEnabled:u,outlierSelectedCount:d,outlierDefaultLabel:p,outlierOverrideCount:h,outlierParameterOverrideCount:f,outlierOverrideExampleSummary:g,outlierHasOverrides:w,outlierRecommendationRows:_,outlierHasRecommendations:b,outlierStatusMessage:x,outlierError:N,outlierSampleSize:E,relativeOutlierGeneratedAt:M,outlierPreviewSignal:j,formatMetricValue:C,formatNumericStat:S,onApplyAllRecommendations:$,onClearOverrides:A,onDefaultMethodChange:L,onAutoDetectToggle:T,onOverrideSelect:P,onMethodParameterChange:z,onColumnParameterChange:W})=>{const D=s$(j);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:$,disabled:!b,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:A,disabled:!w,children:"Clear overrides"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),M&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",M,E!==null?` on ${C(E)} row${E===1?"":"s"}.`:"."]}),!M&&E!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",C(E)," row",E===1?"":"s","."]}),D&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",D]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:l.map(R=>{const U=i.get(R.value)??null,V=R.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${V?" canvas-scaling__method-button--active":""}`,"aria-pressed":V,onClick:()=>L(R.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:R.label}),(U==null?void 0:U.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:U.description})]},R.value)})}),(c==null?void 0:c.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:c.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:R=>T(R.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]})]}),a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for each strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:ks.map(R=>{const U=i.get(R)??null,V=Cm[R];if(!V.length)return null;const B=(U==null?void 0:U.label)??qo[R]??R;return a.jsxs("article",{className:"canvas-outlier__method-card",children:[a.jsxs("header",{className:"canvas-outlier__method-header",children:[a.jsx("span",{className:"canvas-outlier__method-title",children:B}),(U==null?void 0:U.description)&&a.jsx("p",{className:"canvas-outlier__method-summary",children:U.description})]}),a.jsx("div",{className:"canvas-outlier__parameter-list",children:V.map(G=>{var K,se;const q=((K=s.methodParameters[R])==null?void 0:K[G])??null,F=aw[G]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:n$(U,G)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx("input",{type:"number",className:"canvas-outlier__method-input-field",value:typeof q=="number"&&Number.isFinite(q)?q:"",placeholder:rw(((se=$a[R])==null?void 0:se[G])??null),onChange:Q=>{const H=Q.target.value;if(H==="")z(R,G,null);else{const Y=Number(H);z(R,G,Number.isFinite(Y)?Y:null)}}}),F&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:F})]})]},`${R}-${G}`)})})]},`outlier-method-${R}`)})})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s","  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",(()=>{if(!(h+f))return"  No overrides yet";const U=[];return h>0&&U.push(g?`${h} method override${h===1?"":"s"} (${g})`:`${h} method override${h===1?"":"s"}`),f>0&&U.push(`${f} parameter override${f===1?"":"s"}`),`  Overrides: ${U.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&N&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:N}),!n&&!N&&a.jsxs(a.Fragment,{children:[x&&a.jsx("p",{className:"canvas-modal__note",children:x}),_.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:_.map(R=>{const U=!R.isSkipped&&!R.isExcluded&&R.recommendedMethod&&R.recommendedMethod!==R.currentMethod,V=["canvas-cast__row"];U&&V.push("canvas-cast__row--attention"),R.isOverrideApplied&&V.push("canvas-cast__row--override"),R.isSkipped&&V.push("canvas-cast__row--muted");const B=R.isSkipped?"__skip__":R.isOverrideApplied?R.currentMethod:"__default__",G=R.isOverrideApplied?`Override -> ${R.currentMethodLabel}`:R.isSkipped?"Skipped (column will not be altered)":R.isSelected?`Inheriting ${p}`:"Pending inclusion",q=R.stats,F=[];typeof q.valid_count=="number"&&Number.isFinite(q.valid_count)&&F.push(`${C(q.valid_count)} valid rows`);const K=typeof q.minimum=="number"&&Number.isFinite(q.minimum),se=typeof q.maximum=="number"&&Number.isFinite(q.maximum);if(K||se){const J=K?S(q.minimum):"",re=se?S(q.maximum):"";F.push(`Range ${J}  ${re}`)}typeof q.mean=="number"&&Number.isFinite(q.mean)&&F.push(`Mean ${S(q.mean)}`),typeof q.median=="number"&&Number.isFinite(q.median)&&F.push(`Median ${S(q.median)}`),typeof q.stddev=="number"&&Number.isFinite(q.stddev)&&F.push(` ${S(q.stddev)}`);const Q=F.length?F.join("  "):null,H=!R.recommendedMethod||!R.recommendedLabel?R.recommendedReason||"No outlier risk detected":R.recommendedReason?`${R.recommendedLabel}  ${R.recommendedReason}`:R.recommendedLabel,Y=s.columnParameters,X=s.methodParameters,ee=Cm[R.currentMethod]??[];return a.jsxs("tr",{className:V.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:R.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[R.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",R.dtype]}),R.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),R.isSelected&&!R.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),R.isSkipped&&!R.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),R.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),R.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[R.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${U?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:R.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),H&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:H})]})}),a.jsx("td",{children:Q?a.jsx("span",{children:Q}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:B,onChange:J=>P(R.column,J.target.value),disabled:R.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),l.map(J=>a.jsx("option",{value:J.value,children:J.label},`${R.column}-${J.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:G}),ee.length>0&&!R.isExcluded&&a.jsx("div",{className:"canvas-outlier__parameters",children:ee.map(J=>{const{value:re,fallback:we}=r$(R.currentMethod,J,Y,R.column,X),Pe=aw[J]??"";return a.jsxs("label",{children:[a.jsx("span",{children:J.replace(/_/g," ")}),a.jsx("input",{type:"number",value:re,placeholder:rw(we),onChange:Me=>{const Fe=Me.target.value;if(Fe==="")W(R.column,J,null);else{const Ke=Number(Fe);W(R.column,J,Number.isFinite(Ke)?Ke:null)}}}),Pe&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:Pe})]},`${R.column}-${R.currentMethod}-${J}`)})})]})})]},`outlier-row-${R.column}`)})})]})})})]})]})},o$=e=>{const t=v.useMemo(()=>{var l,i,c,u,d,p;const s=[];return(l=e==null?void 0:e.data)!=null&&l.label&&s.push({label:"Label",value:String(e.data.label)}),(i=e==null?void 0:e.data)!=null&&i.description&&s.push({label:"Description",value:String(e.data.description)}),(c=e==null?void 0:e.data)!=null&&c.category&&s.push({label:"Category",value:String(e.data.category)}),(u=e==null?void 0:e.data)!=null&&u.catalogType&&s.push({label:"Node type",value:String(e.data.catalogType)}),(d=e==null?void 0:e.data)!=null&&d.inputs&&Array.isArray(e.data.inputs)&&e.data.inputs.length&&s.push({label:"Inputs",value:e.data.inputs.join(", ")}),(p=e==null?void 0:e.data)!=null&&p.outputs&&Array.isArray(e.data.outputs)&&e.data.outputs.length&&s.push({label:"Outputs",value:e.data.outputs.join(", ")}),s},[e]),n=v.useMemo(()=>{var l;const s=((l=e==null?void 0:e.data)==null?void 0:l.label)??(e==null?void 0:e.id);return typeof s=="string"&&s.trim()?s:`Node ${(e==null?void 0:e.id)??""}`},[e]);return{metadata:t,title:n}},l$=({connectionInfo:e,connectedInputHandles:t,connectedOutputHandles:n,connectionReady:s})=>e?a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:s?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",children:[a.jsx("strong",{children:s?"Ready to execute.":"Missing required connections."})," ",s?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]}),e.inputs&&e.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:e.inputs.map(l=>{const i=t.has(l.key),c=l.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:l.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":c?"Missing":"Optional"})]},`inputs-${l.key}`)})})]}),e.outputs&&e.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:e.outputs.map(l=>{const i=n.has(l.key),c=l.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:l.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":c?"Unlinked":"Optional"})]},`outputs-${l.key}`)})})]})]}):null,ow=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},i$=(e,t)=>{var w;const n=typeof(e==null?void 0:e.id)=="string"?e.id:"",s=v.useMemo(()=>{var x;const _=(x=e==null?void 0:e.data)==null?void 0:x.connectionInfo;if(!_)return null;const b=N=>Array.isArray(N)?N.map(E=>({...E})):[];return{inputs:b(_.inputs),outputs:b(_.outputs)}},[e]),l=v.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const _=t.edges.filter(b=>(b==null?void 0:b.target)===n).map(b=>ow(n,b==null?void 0:b.targetHandle)).filter(b=>!!b);return new Set(_)},[t,n]),i=v.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const _=t.edges.filter(b=>(b==null?void 0:b.source)===n).map(b=>ow(n,b==null?void 0:b.sourceHandle)).filter(b=>!!b);return new Set(_)},[t,n]),c=((w=e==null?void 0:e.data)==null?void 0:w.hasRequiredConnections)!==!1,u=v.useMemo(()=>{var _;return(_=s==null?void 0:s.inputs)!=null&&_.length?s.inputs.filter(b=>b.required!==!1):[]},[s==null?void 0:s.inputs]),d=v.useMemo(()=>u.length?u.filter(_=>!l.has(_.key)):[],[l,u]),p=c&&d.length===0,h=v.useMemo(()=>{if(!p)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[p]),f=p?void 0:!0,g=v.useMemo(()=>{if(!(s!=null&&s.inputs)||s.inputs.length===0)return;let _=!1;const b={};return s.inputs.forEach(x=>{if(!Array.isArray(x.accepts)||x.accepts.length===0)return;const N=l.has(x.key);x.accepts.forEach(E=>{(E==="train"||E==="validation"||E==="test")&&(b[E]=N,_=!0)})}),_?b:void 0},[s==null?void 0:s.inputs,l]);return{connectionInfo:s,connectedHandleKeys:l,connectedOutputHandleKeys:i,evaluationSplitConnectivity:g,connectionReady:p,gatedSectionStyle:h,gatedAriaDisabled:f}},c$=(e,t)=>{const{isBinningNode:n,isCastNode:s,isDropMissingColumnsNode:l,isDropMissingRowsNode:i,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:p,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:f,isRegexCleanupNode:g,isNormalizeTextCaseNode:w,isStandardizeDatesNode:_,isScalingNode:b,isClassUndersamplingNode:x,isClassOversamplingNode:N,isTrainModelDraftNode:E,isLabelEncodingNode:M,isOrdinalEncodingNode:j,isDummyEncodingNode:C,isOneHotEncodingNode:S,isRemoveDuplicatesNode:$,isSkewnessNode:A,isFeatureTargetSplitNode:L}=t;return v.useMemo(()=>{let T=e;return T=T.filter(P=>{var z;return((z=P==null?void 0:P.source)==null?void 0:z.type)!=="drop_column_recommendations"}),(l||i)&&(T=T.filter(P=>P.name!=="missing_threshold")),i&&(T=T.filter(P=>P.name!=="drop_if_any_missing")),c&&(T=T.filter(P=>P.name!=="strategies")),A&&(T=T.filter(P=>P.name!=="transformations")),s&&(T=T.filter(P=>P.name!=="columns")),n&&(T=T.filter(P=>P.name!=="columns")),b&&(T=T.filter(P=>!["columns","default_method","auto_detect"].includes(P.name))),$&&(T=T.filter(P=>P.name!=="columns"&&P.name!=="keep")),u&&(T=T.filter(P=>P.name!=="columns"&&P.name!=="flag_suffix")),d&&(T=T.filter(P=>!["columns","mode","custom_pairs"].includes(P.name))),p&&(T=T.filter(P=>!["columns","mode"].includes(P.name))),h&&(T=T.filter(P=>!["columns","mode","replacement"].includes(P.name))),f&&(T=T.filter(P=>!["columns","mode","min_value","max_value"].includes(P.name))),g&&(T=T.filter(P=>!["columns","mode","pattern","replacement"].includes(P.name))),w&&(T=T.filter(P=>!["columns","mode"].includes(P.name))),_&&(T=T.filter(P=>!["columns","mode"].includes(P.name))),x&&(T=T.filter(P=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(P.name))),N&&(T=T.filter(P=>!["method","target_column","sampling_strategy","random_state"].includes(P.name))),E&&(T=T.filter(P=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(P.name))),L&&(T=T.filter(P=>P.name!=="target_column")),M&&(T=T.filter(P=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(P.name))),j&&(T=T.filter(P=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(P.name))),C&&(T=T.filter(P=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(P.name))),S&&(T=T.filter(P=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(P.name))),T},[e,n,s,l,i,c,u,d,p,h,f,g,w,_,b,x,N,E,M,j,C,S,$,A,L])},u$=({node:e})=>{var f;const t=typeof(e==null?void 0:e.id)=="string"?e.id:void 0,n=v.useMemo(()=>{var w;const g=Xp(((w=e==null?void 0:e.data)==null?void 0:w.config)??{});return!g||typeof g!="object"||Array.isArray(g)?{}:((!g.column_overrides||typeof g.column_overrides!="object"||Array.isArray(g.column_overrides))&&(g.column_overrides={}),g)},[e==null?void 0:e.id,(f=e==null?void 0:e.data)==null?void 0:f.config]),[s,l]=v.useState(n),[i,c]=v.useState(0),u=v.useRef(t);v.useEffect(()=>{u.current!==t&&(u.current=t,l(n),c(g=>g+1))},[t]);const d=v.useMemo(()=>Dc(n),[n]),p=v.useMemo(()=>Dc(s),[s]),h=v.useCallback(()=>{l(n)},[n]);return{initialConfig:n,configState:s,setConfigState:l,stableInitialConfig:d,stableCurrentConfig:p,nodeChangeVersion:i,resetToInitialConfig:h}},d$=({setConfigState:e})=>{const t=v.useCallback((c,u)=>{c&&e(d=>{const p={...d};return u===void 0?delete p[c]:p[c]=u,p})},[e]),n=v.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);Number.isNaN(d)||t(c,d)},[t]),s=v.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);if(!Number.isFinite(d))return;const p=Math.min(Math.max(d,0),100);t(c,p)},[t]),l=v.useCallback((c,u)=>{t(c,u)},[t]),i=v.useCallback((c,u)=>{t(c,u)},[t]);return{handleParameterChange:t,handleNumberChange:n,handlePercentileChange:s,handleBooleanChange:l,handleTextChange:i}},cg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},m$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},ug=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],h$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=m$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=ug(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g}}).filter(t=>!!t),f$=e=>{if(!e||typeof e!="object")return{...cg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,c=ug(e.high_cardinality_columns),u=ug(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:i,highCardinalityColumns:c,notes:u}},p$=({isLabelEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...cg}),[w,_]=v.useState(0);v.useEffect(()=>{let E=!0;const M=j=>{h([]),g({...cg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),zb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(h$(j)),g(f$(j)))}).catch(j=>{if(!E)return;const C=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load label encoding suggestions";M(C)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(M("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(M(),()=>{E=!1}):(M(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||_(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},dg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},g$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},mg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],_$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=g$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=mg(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_use_global_fallback:w}}).filter(t=>!!t),v$=e=>{if(!e||typeof e!="object")return{...dg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.enable_global_fallback_default,c=mg(e.high_cardinality_columns),u=mg(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:d,enableGlobalFallbackDefault:i,highCardinalityColumns:c,notes:u}},y$=({isTargetEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...dg}),[w,_]=v.useState(0);v.useEffect(()=>{let E=!0;const M=j=>{h([]),g({...dg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Rb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(_$(j)),g(v$(j)))}).catch(j=>{if(!E)return;const C=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load target encoding suggestions";M(C)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(M("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(M(),()=>{E=!1}):(M(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||_(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},Em={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},b$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},hg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],x$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=b$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=hg(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_bucket_count:w}}).filter(t=>!!t),w$=e=>{if(!e||typeof e!="object")return{...Em};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,c=Number(e.suggested_bucket_default??0)||0,u=hg(e.high_cardinality_columns),d=hg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:i,suggestedBucketDefault:c,highCardinalityColumns:u,notes:d}},j$=({isHashEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Em}),[w,_]=v.useState(0),b=v.useCallback(E=>{h([]),g({...Em}),c(!1),d(E??null)},[]);v.useEffect(()=>{let E=!0;return e?t?n?(c(!0),d(null),Fb(t,{graph:s??null,targetNodeId:l??null}).then(M=>{E&&(h(x$(M)),g(w$(M)))}).catch(M=>{E&&(h([]),g({...Em}),d(M!=null&&M.message?String(M.message):"Unable to load hash encoding suggestions"))}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(b("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(b(),()=>{E=!1}):(b(),()=>{E=!1})},[s,n,e,b,t,l,w]);const x=v.useCallback(()=>{_(E=>E+1)},[]);return v.useMemo(()=>({isFetching:i,error:u,suggestions:p,metadata:f,refresh:x}),[u,i,f,x,p])},fg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},N$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},pg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],C$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=N$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=pg(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_handle_unknown:w}}).filter(t=>!!t),S$=e=>{if(!e||typeof e!="object")return{...fg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.enable_unknown_default,c=pg(e.high_cardinality_columns),u=pg(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,autoDetectDefault:d,enableUnknownDefault:i,highCardinalityColumns:c,notes:u}},E$=({isOrdinalEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...fg}),[w,_]=v.useState(0);v.useEffect(()=>{let E=!0;const M=j=>{h([]),g({...fg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Db(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(C$(j)),g(S$(j)))}).catch(j=>{if(!E)return;const C=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load ordinal encoding suggestions";M(C)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(M("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(M(),()=>{E=!1}):(M(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||_(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},gg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},k$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},_g=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],M$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=k$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=_g(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:w,recommended_drop_first:_}}).filter(t=>!!t),A$=e=>{if(!e||typeof e!="object")return{...gg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,c=_g(e.high_cardinality_columns),u=_g(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,cautionedCount:i,highCardinalityColumns:c,notes:u,autoDetectDefault:d}},O$=({isDummyEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...gg}),[w,_]=v.useState(0);v.useEffect(()=>{let E=!0;const M=j=>{h([]),g({...gg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Bb(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(M$(j)),g(A$(j)))}).catch(j=>{if(!E)return;const C=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load dummy encoding suggestions";M(C)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(M("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(M(),()=>{E=!1}):(M(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||_(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},vg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},P$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},yg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],T$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=P$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=yg(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:s,reason:l,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:w,recommended_drop_first:_}}).filter(t=>!!t),$$=e=>{if(!e||typeof e!="object")return{...vg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,c=yg(e.high_cardinality_columns),u=yg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:l,cautionedCount:i,highCardinalityColumns:c,notes:u}},L$=({isOneHotEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:l})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...vg}),[w,_]=v.useState(0);v.useEffect(()=>{let E=!0;const M=j=>{h([]),g({...vg}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Ib(t,{graph:s??null,targetNodeId:l??null}).then(j=>{E&&(h(T$(j)),g($$(j)))}).catch(j=>{if(!E)return;const C=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load one-hot encoding suggestions";M(C)}).finally(()=>{E&&c(!1)}),()=>{E=!1}):(M("Connect this node to the dataset input to load suggestions."),()=>{E=!1}):(M(),()=>{E=!1}):(M(),()=>{E=!1})},[s,n,e,w,t,l]);const b=v.useCallback(()=>{!e||!t||!n||_(E=>E+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:b}},z$=({isTargetEncodingNode:e,enableGlobalFallbackDefault:t,encodeMissing:n,handleUnknown:s,setConfigState:l,nodeChangeVersion:i})=>{const c=v.useRef(!1);v.useEffect(()=>{c.current=!1},[i]),v.useEffect(()=>{if(!e||!t||c.current)return;const u=typeof n=="boolean"?n:null,d=typeof s=="string"?s.trim().toLowerCase():"";if(u===!0&&d==="global_mean"){c.current=!0;return}l(p=>{const h=typeof(p==null?void 0:p.encode_missing)=="boolean"?p.encode_missing:null,f=typeof(p==null?void 0:p.handle_unknown)=="string"?p.handle_unknown.trim().toLowerCase():"";if(h===!0&&f==="global_mean")return c.current=!0,p;const g={...p};return h!==!0&&(g.encode_missing=!0),f!=="global_mean"&&(g.handle_unknown="global_mean"),c.current=!0,g})},[n,s,e,t,l])},D$=({isLabelEncodingNode:e,isTargetEncodingNode:t,isHashEncodingNode:n,isOrdinalEncodingNode:s,isDummyEncodingNode:l,isOneHotEncodingNode:i,sourceId:c,hasReachableSource:u,graphContext:d,node:p,configState:h,setConfigState:f,nodeChangeVersion:g})=>{const w=(p==null?void 0:p.id)??null,{isFetching:_,error:b,suggestions:x,metadata:N}=p$({isLabelEncodingNode:e,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:E,error:M,suggestions:j,metadata:C}=y$({isTargetEncodingNode:t,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w});z$({isTargetEncodingNode:t,enableGlobalFallbackDefault:C.enableGlobalFallbackDefault,encodeMissing:h==null?void 0:h.encode_missing,handleUnknown:h==null?void 0:h.handle_unknown,setConfigState:f,nodeChangeVersion:g});const{isFetching:S,error:$,suggestions:A,metadata:L}=j$({isHashEncodingNode:n,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:T,error:P,suggestions:z,metadata:W}=E$({isOrdinalEncodingNode:s,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:D,error:R,suggestions:U,metadata:V}=O$({isDummyEncodingNode:l,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w}),{isFetching:B,error:G,suggestions:q,metadata:F}=L$({isOneHotEncodingNode:i,sourceId:c,hasReachableSource:u,graphContext:d,targetNodeId:w});v.useEffect(()=>{e&&(h!=null&&h.auto_detect)&&N.autoDetectDefault&&f(ee=>({...ee,columns:N.autoDetectDefault}))},[h==null?void 0:h.auto_detect,e,N.autoDetectDefault,f]),v.useEffect(()=>{t&&(h!=null&&h.auto_detect)&&C.autoDetectDefault&&f(ee=>({...ee,columns:C.autoDetectDefault}))},[h==null?void 0:h.auto_detect,t,f,C.autoDetectDefault]),v.useEffect(()=>{n&&(h!=null&&h.auto_detect)&&L.autoDetectDefault&&f(ee=>({...ee,columns:L.autoDetectDefault}))},[h==null?void 0:h.auto_detect,L.autoDetectDefault,n,f]),v.useEffect(()=>{n&&L.suggestedBucketDefault&&f(ee=>({...ee,n_buckets:L.suggestedBucketDefault}))},[L.suggestedBucketDefault,n,f]),v.useEffect(()=>{t&&C.enableGlobalFallbackDefault&&f(ee=>{const J={};return ee.encode_missing===void 0&&(J.encode_missing=!0),ee.handle_unknown===void 0&&(J.handle_unknown="value"),Object.keys(J).length>0?{...ee,...J}:ee})},[h==null?void 0:h.encode_missing,h==null?void 0:h.handle_unknown,t,f,C.enableGlobalFallbackDefault]),v.useEffect(()=>{s&&(h!=null&&h.auto_detect)&&W.autoDetectDefault&&f(ee=>({...ee,columns:W.autoDetectDefault}))},[h==null?void 0:h.auto_detect,s,W.autoDetectDefault,f]),v.useEffect(()=>{s&&W.enableUnknownDefault&&f(ee=>ee.handle_unknown===void 0?{...ee,handle_unknown:"use_encoded_value",unknown_value:-1}:ee)},[h==null?void 0:h.handle_unknown,s,W.enableUnknownDefault,f]),v.useEffect(()=>{l&&(h!=null&&h.auto_detect)&&V.autoDetectDefault&&f(ee=>({...ee,columns:V.autoDetectDefault}))},[h==null?void 0:h.auto_detect,V.autoDetectDefault,l,f]);const K=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),se=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),Q=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),H=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),Y=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]),X=v.useCallback(ee=>{f(J=>({...J,columns:ee}))},[f]);return{isFetchingLabelEncoding:_,labelEncodingError:b,labelEncodingSuggestions:x,labelEncodingMetadata:N,isFetchingTargetEncoding:E,targetEncodingError:M,targetEncodingSuggestions:j,targetEncodingMetadata:C,isFetchingHashEncoding:S,hashEncodingError:$,hashEncodingSuggestions:A,hashEncodingMetadata:L,isFetchingOrdinalEncoding:T,ordinalEncodingError:P,ordinalEncodingSuggestions:z,ordinalEncodingMetadata:W,isFetchingDummyEncoding:D,dummyEncodingError:R,dummyEncodingSuggestions:U,dummyEncodingMetadata:V,isFetchingOneHotEncoding:B,oneHotEncodingError:G,oneHotEncodingSuggestions:q,oneHotEncodingMetadata:F,handleApplyLabelEncodingRecommended:K,handleApplyTargetEncodingRecommended:se,handleApplyHashEncodingRecommended:Q,handleApplyOrdinalEncodingRecommended:H,handleApplyDummyEncodingRecommended:Y,handleApplyOneHotEncodingRecommended:X}},Qs=["standard","robust","minmax","maxabs"],Ho={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},lw={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},iw=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],cw=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=iw(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",l=Qs.includes(s)?s:"standard",i={},c=t.column_methods;c&&typeof c=="object"&&!Array.isArray(c)&&Object.entries(c).forEach(([p,h])=>{const f=String(p??"").trim(),g=typeof h=="string"?h.trim().toLowerCase():"";f&&Qs.includes(g)&&(i[f]=g)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=iw(t.skipped_columns);return{columns:n,defaultMethod:l,columnMethods:i,autoDetect:u,skippedColumns:d}},R$=e=>{const t={...Ho};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&Qs.includes(s)&&l&&(t[s]=l)}),t},F$=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&Qs.includes(s)&&t.set(s,n)}),t},I$=e=>Qs.map(t=>({value:t,label:e[t]??Ho[t]??t})),B$=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:s,scalingSkippedColumns:l,scalingExcludedColumns:i})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p=u.recommended_method,h=n[p]??Ho[p]??p,f=Array.isArray(u.fallback_methods)?u.fallback_methods.filter(S=>Qs.includes(S)).map(S=>{const $=S;return n[$]??Ho[$]??$}):[],g=u.confidence??"medium",w=lw[g]??lw.medium,b=t.columnMethods[d]??null,x=b??t.defaultMethod,N=n[x]??Ho[x]??x,E=i.has(d),M=l.has(d),j=s.has(d),C=u.stats;c.push({column:d,dtype:u.dtype??null,recommendedMethod:p,recommendedLabel:h,confidence:g,confidenceLabel:w,reasons:Array.isArray(u.reasons)?u.reasons:[],fallbackLabels:f,stats:C,hasMissing:!!u.has_missing,currentOverride:b,currentMethod:x,currentMethodLabel:N,isOverrideApplied:b!==null,isSelected:j,isExcluded:E,isSkipped:M})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},U$=(e,t,n,s)=>{if(!e.length)return null;const l=e.map(i=>{const c=t[i],u=c?n[c]??Ho[c]??c:null;return u?`${i} -> ${u}`:i});return s>e.length&&l.push(""),l.join(", ")},q$=({isScalingNode:e,configState:t,numericExcludedColumns:n,scalingData:s})=>{const l=v.useMemo(()=>cw(t),[t]),i=v.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),c=v.useMemo(()=>e?n:new Set,[e,n]),u=v.useMemo(()=>e?new Set(l.columns):new Set,[e,l.columns]),d=v.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),p=v.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(z=>!!(z&&z.column)):[],[s==null?void 0:s.columns]),h=v.useMemo(()=>R$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=v.useMemo(()=>F$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=v.useMemo(()=>B$({recommendations:p,scalingConfig:l,scalingMethodLabelMap:h,scalingSelectedSet:u,scalingSkippedColumns:i,scalingExcludedColumns:c}),[p,l,h,u,i,c]),w=v.useMemo(()=>Array.from(d).sort((z,W)=>z.localeCompare(W)),[d]),_=v.useMemo(()=>w.slice(0,4),[w]),b=g.length,x=d.size,N=u.size,E=l.autoDetect,M=v.useMemo(()=>f.get(l.defaultMethod)??null,[l.defaultMethod,f]),j=v.useMemo(()=>{const z=l.defaultMethod;return h[z]??Ho[z]??z},[l.defaultMethod,h]),C=b>0,S=v.useMemo(()=>g.filter(z=>!z.isSkipped&&!z.isExcluded&&z.isSelected&&z.recommendedMethod!==z.currentMethod).length,[g]),$=v.useMemo(()=>g.filter(z=>z.isSelected&&!z.isSkipped&&!z.isExcluded).length,[g]),A=v.useMemo(()=>g.filter(z=>z.isSkipped&&!z.isExcluded).length,[g]),L=v.useMemo(()=>g.length?S>0?`${S} column${S===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:$>0?"All configured columns align with the recommended scalers.":A>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[S,$,g,A]),T=v.useMemo(()=>I$(h),[h]),P=v.useMemo(()=>U$(_,l.columnMethods,h,x),[_,l.columnMethods,h,x]);return{scalingConfig:l,scalingExcludedColumns:c,scalingMethodDetailMap:f,scalingMethodOptions:T,scalingRecommendations:p,scalingRecommendationRows:g,scalingSelectedCount:N,scalingOverrideCount:x,scalingDefaultDetail:M,scalingDefaultLabel:j,scalingAutoDetectEnabled:E,scalingHasRecommendations:C,scalingStatusMessage:L,scalingOverrideExampleSummary:P}},H$=({isOutlierNode:e,configState:t,numericExcludedColumns:n,outlierData:s})=>{const l=v.useMemo(()=>Q2(t),[t]),i=v.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(z=>!!(z&&z.column)):[],[s==null?void 0:s.columns]),c=v.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),u=v.useMemo(()=>e?new Set(l.columns):new Set,[e,l.columns]),d=v.useMemo(()=>{if(!e||!n.size)return new Set;const z=new Set;l.columns.forEach(D=>{const R=String(D??"").trim();R&&z.add(R)}),i.forEach(D=>{const R=String((D==null?void 0:D.column)??"").trim();R&&z.add(R)});const W=new Set;return n.forEach(D=>{z.has(D)||W.add(D)}),W},[e,n,l.columns,i]),p=v.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),h=v.useMemo(()=>X2(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=v.useMemo(()=>J2(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=v.useMemo(()=>e$({insights:i,outlierConfig:l,labelMap:h,selectedColumns:u,skippedColumns:c,excludedColumns:d}),[i,l,h,u,c,d]),w=v.useMemo(()=>Z2(h),[h]),_=v.useMemo(()=>Array.from(p).sort((z,W)=>z.localeCompare(W)),[p]),b=v.useMemo(()=>_.slice(0,4),[_]),x=u.size,N=p.size,E=v.useMemo(()=>Object.keys(l.columnParameters).length,[l.columnParameters]),M=l.autoDetect,j=v.useMemo(()=>f.get(l.defaultMethod)??null,[l.defaultMethod,f]),C=v.useMemo(()=>{const z=l.defaultMethod;return h[z]??qo[z]??z},[l.defaultMethod,h]),S=g.length>0,$=v.useMemo(()=>g.filter(z=>z.isSkipped||z.isExcluded||!z.isSelected||!z.recommendedMethod?!1:z.recommendedMethod!==z.currentMethod).length,[g]),A=v.useMemo(()=>g.filter(z=>z.isSelected&&!z.isSkipped&&!z.isExcluded).length,[g]),L=v.useMemo(()=>g.filter(z=>z.isSkipped&&!z.isExcluded).length,[g]),T=v.useMemo(()=>g.length?$>0?`${$} column${$===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:A>0?"All configured columns align with the recommended outlier handling strategies.":L>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[$,A,g,L]),P=v.useMemo(()=>t$(b,l.columnMethods,h,N),[b,l.columnMethods,h,N]);return{outlierConfig:l,outlierExcludedColumns:d,outlierMethodLabelMap:h,outlierMethodDetailMap:f,outlierMethodOptions:w,outlierRecommendations:i,outlierRecommendationRows:g,outlierSelectedCount:x,outlierOverrideCount:N,outlierParameterOverrideCount:E,outlierDefaultDetail:j,outlierDefaultLabel:C,outlierAutoDetectEnabled:M,outlierHasRecommendations:S,outlierStatusMessage:T,outlierOverrideExampleSummary:P}},V$=({configState:e,nodeId:t})=>{const n=v.useMemo(()=>ux(e),[e]),s=n.columns.length,l=zp[n.strategy]??n.strategy,i=v.useMemo(()=>Object.keys(n.columnStrategies).map(_=>_.trim()).filter(Boolean).sort((_,b)=>_.localeCompare(b)),[n.columnStrategies]),c=i.length,u=v.useMemo(()=>{if(!i.length)return null;const _=i.slice(0,4);return bM(_,n.columnStrategies,c)},[n.columnStrategies,i,c]),d=v.useMemo(()=>`binning-${t||"node"}`,[t]),p=v.useMemo(()=>({equalWidth:`${d}-equal-width-bins`,equalFrequency:`${d}-equal-frequency-bins`,precision:`${d}-precision`,suffix:`${d}-suffix`,missingLabel:`${d}-missing-label`,includeLowest:`${d}-include-lowest`,dropOriginal:`${d}-drop-original`,labelFormat:`${d}-label-format`,duplicates:`${d}-duplicates`,kbinsNBins:`${d}-kbins-n-bins`,kbinsEncode:`${d}-kbins-encode`,kbinsStrategy:`${d}-kbins-strategy`}),[d]),[h,f]=v.useState({}),[g,w]=v.useState({});return v.useEffect(()=>{f(_=>{const b=new Set,x={..._};return n.columns.forEach(N=>{const E=String(N??"").trim();if(!E||(b.add(E),Object.prototype.hasOwnProperty.call(x,E)))return;const M=n.customBins[E]??[];x[E]=M.length>=2?M.join(", "):""}),Object.keys(x).forEach(N=>{b.has(N)||delete x[N]}),x})},[n.columns,n.customBins]),v.useEffect(()=>{w(_=>{const b=new Set,x={..._};return n.columns.forEach(N=>{const E=String(N??"").trim();if(!E||(b.add(E),Object.prototype.hasOwnProperty.call(x,E)))return;const M=n.customLabels[E]??[];x[E]=M.length>0?M.join(", "):""}),Object.keys(x).forEach(N=>{b.has(N)||delete x[N]}),x})},[n.columns,n.customLabels]),{binningConfig:n,binningSelectedCount:s,binningDefaultLabel:l,binningOverrideColumns:i,binningOverrideCount:c,binningOverrideSummary:u,fieldIds:p,customEdgeDrafts:h,setCustomEdgeDrafts:f,customLabelDrafts:g,setCustomLabelDrafts:w}},W$=({setConfigState:e,setBinningCustomEdgeDrafts:t,setBinningCustomLabelDrafts:n,binningConfig:s,binningInsightsRecommendations:l,binningAllNumericColumns:i})=>{const c=v.useCallback((L,T,P,z)=>{e(W=>{const D=typeof(W==null?void 0:W[L])=="number"&&Number.isFinite(W[L])?W[L]:void 0;if(T===""){if(D===void 0)return W;const V={...W};return delete V[L],V}const R=Number(T);if(!Number.isFinite(R))return W;const U=Math.min(Math.max(Math.round(R),P),z);return D===U?W:{...W,[L]:U}})},[e]),u=v.useCallback((L,T)=>{e(P=>!!(P!=null&&P[L])===T?P:{...P,[L]:T})},[e]),d=v.useCallback(L=>{const T=L.trim();e(P=>{const z=typeof(P==null?void 0:P.output_suffix)=="string"?P.output_suffix:"";if(!T){if(!z)return P;const W={...P};return delete W.output_suffix,W}return z===T?P:{...P,output_suffix:T}})},[e]),p=v.useCallback(L=>{e(T=>{const P=typeof(T==null?void 0:T.label_format)=="string"?T.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(P)?P:"range")===L?T:{...T,label_format:L}})},[e]),h=v.useCallback(L=>{e(T=>{if(((T==null?void 0:T.missing_strategy)==="label"?"label":"keep")===L)return T;const z={...T,missing_strategy:L};return L!=="label"&&Object.prototype.hasOwnProperty.call(z,"missing_label")&&delete z.missing_label,z})},[e]),f=v.useCallback(L=>{const T=L.trim();e(P=>{const z=typeof(P==null?void 0:P.missing_label)=="string"?P.missing_label:"";if(!T){if(!z)return P;const W={...P};return delete W.missing_label,W}return z===T?P:{...P,missing_label:T}})},[e]),g=v.useCallback((L,T)=>{const P=String(L??"").trim();P&&(t(z=>({...z,[P]:T})),e(z=>{const W=z==null?void 0:z.custom_bins,D=W&&typeof W=="object"&&!Array.isArray(W)?W:{},R=Array.isArray(D[P])?D[P]:void 0,V=T.split(/[,\n]/).map(F=>F.trim()).filter(Boolean).map(F=>Number(F)).filter(F=>Number.isFinite(F)).sort((F,K)=>F-K).filter((F,K,se)=>K===0||F!==se[K-1]),B=V.length>=2;if(B&&R&&R.length===V.length&&R.every((F,K)=>F===V[K])||!B&&!R)return z;const G={...z},q={...D};return B?q[P]=V:delete q[P],Object.keys(q).length>0?G.custom_bins=q:delete G.custom_bins,G}))},[t,e]),w=v.useCallback((L,T)=>{const P=String(L??"").trim();P&&(n(z=>({...z,[P]:T})),e(z=>{const W=z==null?void 0:z.custom_labels,D=W&&typeof W=="object"&&!Array.isArray(W)?W:{},R=Array.isArray(D[P])?D[P]:void 0,U=T.split(/[,\n]/).map(G=>G.trim()).filter(Boolean);if(U.length>0&&R&&R.length===U.length&&R.every((G,q)=>G===U[q])||U.length===0&&!R)return z;const V={...z},B={...D};return U.length>0?B[P]=U:delete B[P],Object.keys(B).length>0?V.custom_labels=B:delete V.custom_labels,V}))},[n,e]),_=v.useCallback(L=>{const T=String(L??"").trim();T&&(t(P=>{if(!Object.prototype.hasOwnProperty.call(P,T))return P;const z={...P};return delete z[T],z}),n(P=>{if(!Object.prototype.hasOwnProperty.call(P,T))return P;const z={...P};return delete z[T],z}),e(P=>{let z=!1;const W={...P};if(P!=null&&P.custom_bins&&typeof P.custom_bins=="object"&&!Array.isArray(P.custom_bins)&&Object.prototype.hasOwnProperty.call(P.custom_bins,T)){const D={...P.custom_bins};delete D[T],Object.keys(D).length>0?W.custom_bins=D:delete W.custom_bins,z=!0}if(P!=null&&P.custom_labels&&typeof P.custom_labels=="object"&&!Array.isArray(P.custom_labels)&&Object.prototype.hasOwnProperty.call(P.custom_labels,T)){const D={...P.custom_labels};delete D[T],Object.keys(D).length>0?W.custom_labels=D:delete W.custom_labels,z=!0}return z?W:P}))},[t,n,e]),b=v.useCallback((L,T)=>{const P=String(L??"").trim();P&&e(z=>{const D={...z!=null&&z.column_strategies&&typeof z.column_strategies=="object"&&!Array.isArray(z.column_strategies)?z.column_strategies:z!=null&&z.column_overrides&&typeof z.column_overrides=="object"&&!Array.isArray(z.column_overrides)?z.column_overrides:{}},R=D[P],U=R&&typeof R=="object"&&!Array.isArray(R)?{...R}:{},V=T(U),B=!!(V&&Object.keys(V).length);B?D[P]=V:delete D[P];const G={...z};if(B){const q=new Set(Ve(z==null?void 0:z.columns));q.has(P)||(q.add(P),G.columns=Array.from(q).sort((F,K)=>F.localeCompare(K)))}return Object.keys(D).length?(G.column_overrides=D,G.column_strategies=D):(Object.prototype.hasOwnProperty.call(G,"column_overrides")&&delete G.column_overrides,Object.prototype.hasOwnProperty.call(G,"column_strategies")&&delete G.column_strategies),G})},[e]),x=v.useCallback((L,T,P)=>{const z=String(L??"").trim();if(!z)return;if(T==="__default__"){_(z),b(z,()=>null);return}const W=Number.isFinite(P==null?void 0:P.recommendedBins)?Math.round(P.recommendedBins):null;b(z,D=>{const R={...D};R.strategy=T;const U=V=>Math.min(200,Math.max(2,Math.round(W??V)));return T==="equal_width"?(R.equal_width_bins=U(s.equalWidthBins),delete R.equal_frequency_bins,delete R.kbins_n_bins,delete R.kbins_encode,delete R.kbins_strategy):T==="equal_frequency"?(R.equal_frequency_bins=U(s.equalFrequencyBins),delete R.equal_width_bins,delete R.kbins_n_bins,delete R.kbins_encode,delete R.kbins_strategy):T==="kbins"?(R.kbins_n_bins=U(s.kbinsNBins),R.kbins_encode=s.kbinsEncode,R.kbins_strategy=s.kbinsStrategy,delete R.equal_width_bins,delete R.equal_frequency_bins):T==="custom"&&(delete R.equal_width_bins,delete R.equal_frequency_bins,delete R.kbins_n_bins,delete R.kbins_encode,delete R.kbins_strategy),Object.keys(R).length?R:null}),T!=="custom"&&_(z)},[s.equalFrequencyBins,s.equalWidthBins,s.kbinsEncode,s.kbinsNBins,s.kbinsStrategy,_,b]),N=v.useCallback((L,T,P)=>{const z=String(L??"").trim();z&&(b(z,W=>{const D={...W};if(!P.trim())delete D[T];else{const R=Number(P);if(!Number.isFinite(R))return W;const U=Math.min(200,Math.max(2,Math.round(R)));D[T]=U,T==="equal_width_bins"?(D.strategy="equal_width",delete D.equal_frequency_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy):T==="equal_frequency_bins"?(D.strategy="equal_frequency",delete D.equal_width_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy):T==="kbins_n_bins"&&(D.strategy="kbins",delete D.equal_width_bins,delete D.equal_frequency_bins)}return Object.keys(D).length?D:null}),_(z))},[_,b]),E=v.useCallback((L,T)=>{const P=String(L??"").trim();P&&b(P,z=>{const W={...z};return T?(W.strategy="kbins",W.kbins_encode=T):delete W.kbins_encode,Object.keys(W).length?W:null})},[b]),M=v.useCallback((L,T)=>{const P=String(L??"").trim();P&&b(P,z=>{const W={...z};return T?(W.strategy="kbins",W.kbins_strategy=T):delete W.kbins_strategy,Object.keys(W).length?W:null})},[b]),j=v.useCallback(L=>{const T=String(L??"").trim();T&&(_(T),b(T,()=>null))},[_,b]),C=v.useCallback(()=>{e(L=>{if(!((L==null?void 0:L.column_strategies)&&typeof L.column_strategies=="object"&&!Array.isArray(L.column_strategies)&&Object.keys(L.column_strategies).length>0||(L==null?void 0:L.column_overrides)&&typeof L.column_overrides=="object"&&!Array.isArray(L.column_overrides)&&Object.keys(L.column_overrides).length>0))return L;const P={...L};return Object.prototype.hasOwnProperty.call(P,"column_overrides")&&delete P.column_overrides,Object.prototype.hasOwnProperty.call(P,"column_strategies")&&delete P.column_strategies,P})},[e]),S=v.useCallback(()=>{l.length&&l.forEach(L=>{const T=typeof(L==null?void 0:L.column)=="string"?L.column.trim():"";if(!T)return;const P=L.recommended_strategy??"equal_width";x(T,P,{recommendedBins:Number.isFinite(L==null?void 0:L.recommended_bins)?L.recommended_bins:null})})},[l,x]),$=v.useCallback(L=>{if(!L)return;const T=[];for(const P of L){const z=typeof P=="string"?P.trim():"";z&&T.push(z)}T.length&&e(P=>{const z=P&&typeof P=="object"?P:{},W=new Set(Ve(z.columns));let D=!1;if(T.forEach(U=>{W.has(U)||(W.add(U),D=!0)}),!D)return P;const R={...z};return R.columns=Array.from(W).sort((U,V)=>U.localeCompare(V)),R})},[e]),A=v.useCallback(()=>{i.length&&$(i)},[i,$]);return{handleBinningIntegerChange:c,handleBinningBooleanToggle:u,handleBinningSuffixChange:d,handleBinningLabelFormatChange:p,handleBinningMissingStrategyChange:h,handleBinningMissingLabelChange:f,handleBinningCustomBinsChange:g,handleBinningCustomLabelsChange:w,handleBinningClearCustomColumn:_,updateBinningColumnOverride:b,handleBinningOverrideStrategyChange:x,handleBinningOverrideNumberChange:N,handleBinningOverrideKbinsEncodeChange:E,handleBinningOverrideKbinsStrategyChange:M,handleBinningClearOverride:j,handleBinningClearOverrides:C,handleBinningApplyStrategies:S,handleBinningApplyColumns:$,handleApplyAllBinningNumeric:A}},K$=({setConfigState:e,outlierRecommendationRows:t,outlierExcludedColumns:n,outlierConfig:s})=>{const l=v.useCallback(_=>{ks.includes(_)&&e(b=>(b==null?void 0:b.default_method)===_?b:{...b,default_method:_})},[e]),i=v.useCallback(_=>{e(b=>(typeof(b==null?void 0:b.auto_detect)=="boolean"?b.auto_detect:!0)===_?b:{...b,auto_detect:_})},[e]),c=v.useCallback((_,b)=>{const x=String(_??"").trim();x&&e(N=>{if(!N||typeof N!="object")return N;const E=Ve(N.columns),M=new Set(E),j=N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)?{...N.column_methods}:{};let C=!1;if(b){if(!ks.includes(b))return N;j[x]!==b&&(j[x]=b,C=!0),M.has(x)||(M.add(x),C=!0)}else Object.prototype.hasOwnProperty.call(j,x)&&(delete j[x],C=!0);if(!C)return N;const S={...N};return S.columns=Array.from(M).sort(($,A)=>$.localeCompare(A)),Object.keys(j).length?S.column_methods=j:Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods,S})},[e]),u=v.useCallback(()=>{e(_=>{if(!_||typeof _!="object")return _;const b=_.column_methods&&typeof _.column_methods=="object"&&!Array.isArray(_.column_methods)&&Object.keys(_.column_methods).length>0,x=_.column_parameters&&typeof _.column_parameters=="object"&&!Array.isArray(_.column_parameters)&&Object.keys(_.column_parameters).length>0;if(!b&&!x)return _;const N={..._};return b&&delete N.column_methods,x&&delete N.column_parameters,N})},[e]),d=v.useCallback(()=>{t.length&&e(_=>{if(!_||typeof _!="object")return _;const b=new Set(Ve(_.columns)),x=new Set(Ve(_.skipped_columns)),N=_.column_methods&&typeof _.column_methods=="object"&&!Array.isArray(_.column_methods)?{..._.column_methods}:{},E=_.column_parameters&&typeof _.column_parameters=="object"&&!Array.isArray(_.column_parameters)?{..._.column_parameters}:{};let M=!1;if(t.forEach(C=>{if(!C||C.isExcluded||!C.recommendedMethod)return;const S=String(C.column??"").trim();if(!S||n.has(S))return;const $=C.recommendedMethod;ks.includes($)&&(x.has(S)&&(x.delete(S),M=!0),b.has(S)||(b.add(S),M=!0),$===s.defaultMethod?Object.prototype.hasOwnProperty.call(N,S)&&(delete N[S],M=!0):N[S]!==$&&(N[S]=$,M=!0),Object.prototype.hasOwnProperty.call(E,S)&&(delete E[S],M=!0))}),!M)return _;const j={..._,columns:Array.from(b).sort((C,S)=>C.localeCompare(S))};return x.size?j.skipped_columns=Array.from(x).sort((C,S)=>C.localeCompare(S)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,Object.keys(N).length?j.column_methods=N:Object.prototype.hasOwnProperty.call(j,"column_methods")&&delete j.column_methods,Object.keys(E).length?j.column_parameters=E:Object.prototype.hasOwnProperty.call(j,"column_parameters")&&delete j.column_parameters,j})},[s.defaultMethod,n,t,e]),p=v.useCallback(_=>{const b=String(_??"").trim();b&&e(x=>{if(!x||typeof x!="object")return x;const N=Ve(x.columns),E=N.filter(z=>z!==b),M=new Set(Ve(x.skipped_columns)),j=M.size;M.add(b);const C=j!==M.size,S=x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)?{...x.column_methods}:{},$=Object.prototype.hasOwnProperty.call(S,b);$&&delete S[b];const A=x.column_parameters&&typeof x.column_parameters=="object"&&!Array.isArray(x.column_parameters)?{...x.column_parameters}:{},L=Object.prototype.hasOwnProperty.call(A,b);if(L&&delete A[b],!(E.length!==N.length)&&!C&&!$&&!L)return x;const P={...x,columns:E.sort((z,W)=>z.localeCompare(W)),skipped_columns:Array.from(M).sort((z,W)=>z.localeCompare(W))};return Object.keys(S).length?P.column_methods=S:Object.prototype.hasOwnProperty.call(P,"column_methods")&&delete P.column_methods,Object.keys(A).length?P.column_parameters=A:Object.prototype.hasOwnProperty.call(P,"column_parameters")&&delete P.column_parameters,P})},[e]),h=v.useCallback(_=>{const b=String(_??"").trim();b&&e(x=>{if(!x||typeof x!="object")return x;const N=Ve(x.skipped_columns);if(!N.includes(b))return x;const E=N.filter(C=>C!==b),M=new Set(Ve(x.columns));M.has(b)||M.add(b);const j={...x,columns:Array.from(M).sort((C,S)=>C.localeCompare(S))};return E.length?j.skipped_columns=E.sort((C,S)=>C.localeCompare(S)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,j})},[e]),f=v.useCallback((_,b)=>{if(b==="__skip__"){p(_);return}if(b==="__default__"){h(_),c(_,null);return}ks.includes(b)&&(h(_),c(_,b))},[p,h,c]),g=v.useCallback((_,b,x)=>{const N=String(b??"").trim().toLowerCase();e(E=>{if(!E||typeof E!="object")return E;const M=E.method_parameters&&typeof E.method_parameters=="object"&&!Array.isArray(E.method_parameters)?{...E.method_parameters}:{},j={...M[_]??{}},C=typeof x=="number"&&Number.isFinite(x)?x:null;let S=!1;if(C===null?Object.prototype.hasOwnProperty.call(j,N)&&(delete j[N],S=!0):j[N]!==C&&(j[N]=C,S=!0),!S)return E;if(Object.keys(j).length?M[_]=j:delete M[_],!Object.keys(M).length){const $={...E};return Object.prototype.hasOwnProperty.call($,"method_parameters")&&delete $.method_parameters,$}return{...E,method_parameters:M}})},[e]),w=v.useCallback((_,b,x)=>{const N=String(_??"").trim();if(!N)return;const E=String(b??"").trim().toLowerCase();e(M=>{if(!M||typeof M!="object")return M;const j=M.column_parameters&&typeof M.column_parameters=="object"&&!Array.isArray(M.column_parameters)?{...M.column_parameters}:{},C={...j[N]??{}},S=typeof x=="number"&&Number.isFinite(x)?x:null;let $=!1;if(S===null?Object.prototype.hasOwnProperty.call(C,E)&&(delete C[E],$=!0):C[E]!==S&&(C[E]=S,$=!0),!$)return M;if(Object.keys(C).length?j[N]=C:delete j[N],!Object.keys(j).length){const A={...M};return Object.prototype.hasOwnProperty.call(A,"column_parameters")&&delete A.column_parameters,A}return{...M,column_parameters:j}})},[e]);return{handleOutlierDefaultMethodChange:l,handleOutlierAutoDetectToggle:i,setOutlierColumnMethod:c,handleOutlierClearOverrides:u,handleOutlierApplyAllRecommendations:d,handleOutlierSkipColumn:p,handleOutlierUnskipColumn:h,handleOutlierOverrideSelect:f,handleOutlierMethodParameterChange:g,handleOutlierColumnParameterChange:w}},Y$=({setConfigState:e,scalingRecommendations:t})=>{const n=v.useCallback(h=>{Qs.includes(h)&&e(f=>(f==null?void 0:f.default_method)===h?f:{...f,default_method:h})},[e]),s=v.useCallback(h=>{e(f=>(typeof(f==null?void 0:f.auto_detect)=="boolean"?f.auto_detect:!0)===h?f:{...f,auto_detect:h})},[e]),l=v.useCallback((h,f)=>{const g=String(h??"").trim();g&&e(w=>{const _=Ve(w.columns),b=_.includes(g),x=w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)?{...w.column_methods}:{};if(f){if(!Qs.includes(f))return w;const M=(x[g]??null)!==f,j=!b;if(!M&&!j)return w;x[g]=f;const C=j?[..._,g].sort((S,$)=>S.localeCompare($)):_;return{...w,columns:C,column_methods:x}}if(!Object.prototype.hasOwnProperty.call(x,g))return w;if(delete x[g],Object.keys(x).length)return{...w,column_methods:x};const N={...w};return Object.prototype.hasOwnProperty.call(N,"column_methods")&&delete N.column_methods,N})},[e]),i=v.useCallback(()=>{e(h=>{if(!h.column_methods||typeof h.column_methods!="object"||Array.isArray(h.column_methods)||!Object.keys(h.column_methods).length)return h;const f={...h};return delete f.column_methods,f})},[e]),c=v.useCallback(()=>{t.length&&e(h=>{const f=Ve(h.columns),g=new Set(f),w=new Set(Ve(h.skipped_columns)),_=h.column_methods&&typeof h.column_methods=="object"&&!Array.isArray(h.column_methods)?{...h.column_methods}:{};let b=!1;if(t.forEach(N=>{const E=String(N.column??"").trim(),M=N.recommended_method;!E||!Qs.includes(M)||w.has(E)||(_[E]!==M&&(_[E]=M,b=!0),g.has(E)||(g.add(E),b=!0))}),!b)return h;const x=Array.from(g).sort((N,E)=>N.localeCompare(E));return{...h,columns:x,column_methods:_}})},[t,e]),u=v.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const w=Ve(g.columns),_=w.filter(j=>j!==f),b=new Set(Ve(g.skipped_columns)),x=b.size;b.add(f);const N=b.size!==x,E=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{},M=Object.prototype.hasOwnProperty.call(E,f);return M&&delete E[f],!N&&_.length===w.length&&!M?g:{...g,columns:_.sort((j,C)=>j.localeCompare(C)),column_methods:E,skipped_columns:Array.from(b).sort((j,C)=>j.localeCompare(C))}})},[e]),d=v.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const w=Ve(g.skipped_columns);if(!w.includes(f))return g;const _=new Set(w);_.delete(f);const b=new Set(Ve(g.columns));return b.has(f)||b.add(f),{...g,columns:Array.from(b).sort((N,E)=>N.localeCompare(E)),skipped_columns:Array.from(_).sort((N,E)=>N.localeCompare(E))}})},[e]),p=v.useCallback((h,f)=>{if(f==="__skip__"){u(h);return}if(f==="__default__"){d(h),l(h,null);return}Qs.includes(f)&&(d(h),l(h,f))},[u,d,l]);return{handleScalingDefaultMethodChange:n,handleScalingAutoDetectToggle:s,setScalingColumnMethod:l,handleScalingClearOverrides:i,handleScalingApplyAllRecommendations:c,handleScalingSkipColumn:u,handleScalingUnskipColumn:d,handleScalingOverrideSelect:p}},G$=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},Q$=({isBinningNode:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:s,availableColumns:l,recommendedColumns:i})=>{const c=v.useMemo(()=>{if(!i)return null;const h=new Set;for(const f of i){const g=typeof f=="string"?f.trim():"";g&&h.add(g)}return h.size>0?h:null},[i]),u=v.useMemo(()=>{if(!Array.isArray(n)||!n.length)return null;const h=new Set;return n.forEach(f=>{const g=typeof f=="string"?f.trim():"";g&&h.add(g)}),h.size>0?h:null},[n]),d=v.useMemo(()=>{if(!e)return new Set;if(!t.size||!c&&!u)return t;const h=new Set;return t.forEach(f=>{c!=null&&c.has(f)||u!=null&&u.has(f)||h.add(f)}),h},[e,t,c,u]),p=v.useMemo(()=>{if(!e||!s.length)return{};const h={};return l.forEach(f=>{if(d.has(f))return;let g=null,w=null;const _=new Set;if(s.forEach(b=>{if(!b||!Object.prototype.hasOwnProperty.call(b,f))return;const x=G$(b[f]);x!==null&&((g===null||x<g)&&(g=x),(w===null||x>w)&&(w=x),_.size<=1e3&&_.add(x))}),g!==null||w!==null){const b=_.size>0?_.size:null;h[f]={min:g,max:w,distinct:b}}}),h},[l,d,e,s]);return{binningExcludedColumns:d,binningColumnPreviewMap:p,manualBoundColumns:[],manualRangeFallbackMap:{}}},X$=({isScalingNode:e,isBinningNode:t,isOutlierNode:n,scalingExcludedColumns:s,binningExcludedColumns:l,outlierExcludedColumns:i,setConfigState:c})=>{v.useEffect(()=>{!e||s.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ve(u.columns);if(!d.length)return u;const p=d.filter(f=>!s.has(f));if(p.length===d.length||!p.length)return u;const h={...u,columns:p};if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const f={};let g=!1;Object.entries(u.column_methods).forEach(([w,_])=>{const b=String(w??"").trim();if(!b)return;if(s.has(b)){g=!0;return}const x=typeof _=="string"?_.trim():null;x&&Qs.includes(x)&&(f[b]=x)}),g?Object.keys(f).length?h.column_methods=f:h.column_methods={}:h.column_methods=u.column_methods}return h})},[e,s,c]),v.useEffect(()=>{!t||l.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ve(u.columns);if(!d.length)return u;const p=d.filter(g=>!l.has(g));if(p.length===d.length)return u;const h=new Set(d.filter(g=>l.has(g))),f={...u,columns:p};if(u.custom_bins&&typeof u.custom_bins=="object"&&!Array.isArray(u.custom_bins)){const g={};Object.entries(u.custom_bins).forEach(([w,_])=>{!h.has(w)&&Array.isArray(_)&&_.length&&(g[w]=[..._])}),Object.keys(g).length?f.custom_bins=g:Object.prototype.hasOwnProperty.call(f,"custom_bins")&&delete f.custom_bins}if(u.custom_labels&&typeof u.custom_labels=="object"&&!Array.isArray(u.custom_labels)){const g={};Object.entries(u.custom_labels).forEach(([w,_])=>{!h.has(w)&&Array.isArray(_)&&_.length&&(g[w]=_.map(b=>String(b)))}),Object.keys(g).length?f.custom_labels=g:Object.prototype.hasOwnProperty.call(f,"custom_labels")&&delete f.custom_labels}return f})},[l,t,c]),v.useEffect(()=>{!n||i.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ve(u.columns),p=d.filter(E=>!i.has(E)),h=p.length!==d.length,f=Ve(u.skipped_columns),g=f.filter(E=>!i.has(E)),w=g.length!==f.length,_=E=>E??{...u};let b=null;h&&(b=_(b),b.columns=p.sort((E,M)=>E.localeCompare(M))),w&&(b=_(b),g.length?b.skipped_columns=g.sort((E,M)=>E.localeCompare(M)):Object.prototype.hasOwnProperty.call(b,"skipped_columns")&&delete b.skipped_columns);let x=!1;if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const E={};Object.entries(u.column_methods).forEach(([M,j])=>{const C=String(M??"").trim();if(!C||i.has(C)){x=!0;return}const S=typeof j=="string"?j.trim():null;S&&ks.includes(S)?E[C]=S:x=!0}),x&&(b=_(b),Object.keys(E).length?b.column_methods=E:Object.prototype.hasOwnProperty.call(b,"column_methods")&&delete b.column_methods)}let N=!1;if(u.column_parameters&&typeof u.column_parameters=="object"&&!Array.isArray(u.column_parameters)){const E={};Object.entries(u.column_parameters).forEach(([M,j])=>{const C=String(M??"").trim();if(!C||i.has(C)){N=!0;return}if(!j||typeof j!="object"||Array.isArray(j)){N=!0;return}E[C]={...j}}),N&&(b=_(b),Object.keys(E).length?b.column_parameters=E:Object.prototype.hasOwnProperty.call(b,"column_parameters")&&delete b.column_parameters)}return b||u})},[n,i,c])},J$=({isScalingNode:e,isOutlierNode:t,isBinningNode:n,configState:s,setConfigState:l,nodeId:i,numericExcludedColumns:c,scalingData:u,outlierData:d,binningData:p,availableColumns:h,previewSampleRows:f})=>{const{scalingConfig:g,scalingExcludedColumns:w,scalingMethodDetailMap:_,scalingMethodOptions:b,scalingRecommendations:x,scalingRecommendationRows:N,scalingSelectedCount:E,scalingOverrideCount:M,scalingDefaultDetail:j,scalingDefaultLabel:C,scalingAutoDetectEnabled:S,scalingHasRecommendations:$,scalingStatusMessage:A,scalingOverrideExampleSummary:L}=q$({isScalingNode:e,configState:s,numericExcludedColumns:c,scalingData:u}),{outlierConfig:T,outlierExcludedColumns:P,outlierMethodLabelMap:z,outlierMethodDetailMap:W,outlierMethodOptions:D,outlierRecommendations:R,outlierRecommendationRows:U,outlierSelectedCount:V,outlierOverrideCount:B,outlierParameterOverrideCount:G,outlierDefaultDetail:q,outlierDefaultLabel:F,outlierAutoDetectEnabled:K,outlierHasRecommendations:se,outlierStatusMessage:Q,outlierOverrideExampleSummary:H}=H$({isOutlierNode:t,configState:s,numericExcludedColumns:c,outlierData:d}),Y=typeof(d==null?void 0:d.sample_size)=="number"?d.sample_size:null,X=null,ee=B>0||G>0,J=v.useMemo(()=>B>0?H:G>0?`${G} column${G===1?"":"s"} with parameter overrides`:null,[B,G,H]),{binningConfig:re,binningSelectedCount:we,binningDefaultLabel:Pe,binningOverrideColumns:Me,binningOverrideCount:Fe,binningOverrideSummary:Ke,fieldIds:Ue,customEdgeDrafts:de,setCustomEdgeDrafts:pe,customLabelDrafts:xe,setCustomLabelDrafts:ke}=V$({configState:s,nodeId:i}),De=v.useMemo(()=>e?g.columns:n?re.columns:t?T.columns:Ve(s==null?void 0:s.columns),[re.columns,s,n,t,e,T.columns,g.columns]),ce=v.useMemo(()=>{const Qt=p==null?void 0:p.columns;return Array.isArray(Qt)?Qt.filter(At=>!At||typeof At.column!="string"?!1:!!At.column.trim()):[]},[p==null?void 0:p.columns]),Oe=v.useMemo(()=>{if(!ce.length)return new Set;const Qt=new Set;return ce.forEach(At=>{const st=typeof At.column=="string"?At.column.trim():"";st&&Qt.add(st)}),Qt},[ce]),Ye=v.useMemo(()=>{if(!n)return[];const Qt=new Set;return h.forEach(At=>{if(c.has(At))return;const st=At.trim();st&&Qt.add(st)}),ce.forEach(At=>{const st=typeof At.column=="string"?At.column.trim():"";st&&(!c.has(st)||Oe.has(st))&&Qt.add(st)}),De.forEach(At=>{const st=typeof At=="string"?At.trim():"";st&&(!c.has(st)||Oe.has(st))&&Qt.add(st)}),Array.from(Qt).sort((At,st)=>At.localeCompare(st))},[h,ce,Oe,n,c,De]),ct=v.useMemo(()=>!n||!Ye.length?[]:Ye.filter(Qt=>!De.includes(Qt)),[Ye,n,De]),Je=ct.length>0,{handleBinningIntegerChange:mt,handleBinningBooleanToggle:Ze,handleBinningSuffixChange:ot,handleBinningLabelFormatChange:Et,handleBinningMissingStrategyChange:zt,handleBinningMissingLabelChange:We,handleBinningCustomBinsChange:Dt,handleBinningCustomLabelsChange:ht,handleBinningClearCustomColumn:kt,updateBinningColumnOverride:sn,handleBinningOverrideStrategyChange:wn,handleBinningOverrideNumberChange:Mt,handleBinningOverrideKbinsEncodeChange:rn,handleBinningOverrideKbinsStrategyChange:Fn,handleBinningClearOverride:Ut,handleBinningClearOverrides:it,handleBinningApplyStrategies:In,handleBinningApplyColumns:Zt,handleApplyAllBinningNumeric:gn}=W$({setConfigState:l,setBinningCustomEdgeDrafts:pe,setBinningCustomLabelDrafts:ke,binningConfig:re,binningInsightsRecommendations:ce,binningAllNumericColumns:Ye}),{handleOutlierDefaultMethodChange:ft,handleOutlierAutoDetectToggle:Os,setOutlierColumnMethod:Yt,handleOutlierClearOverrides:gt,handleOutlierApplyAllRecommendations:xt,handleOutlierSkipColumn:ls,handleOutlierUnskipColumn:dn,handleOutlierOverrideSelect:jn,handleOutlierMethodParameterChange:mn,handleOutlierColumnParameterChange:An}=K$({setConfigState:l,outlierRecommendationRows:U,outlierExcludedColumns:P,outlierConfig:T}),{handleScalingDefaultMethodChange:hn,handleScalingAutoDetectToggle:is,setScalingColumnMethod:It,handleScalingClearOverrides:Bn,handleScalingApplyAllRecommendations:On,handleScalingSkipColumn:Nn,handleScalingUnskipColumn:lr,handleScalingOverrideSelect:Xn}=Y$({setConfigState:l,scalingRecommendations:x}),{binningExcludedColumns:Ps,binningColumnPreviewMap:_s,manualBoundColumns:vs,manualRangeFallbackMap:Xs}=Q$({isBinningNode:n,numericExcludedColumns:c,selectedColumns:De,previewSampleRows:f,availableColumns:h,recommendedColumns:Oe}),Jn=v.useMemo(()=>{const Qt=p==null?void 0:p.excluded_columns;return Array.isArray(Qt)?Qt.filter(At=>!At||typeof At.column!="string"?!1:!!At.column.trim()):[]},[p==null?void 0:p.excluded_columns]);return X$({isScalingNode:e,isBinningNode:n,isOutlierNode:t,scalingExcludedColumns:w,binningExcludedColumns:Ps,outlierExcludedColumns:P,setConfigState:l}),{scalingConfig:g,scalingExcludedColumns:w,scalingMethodDetailMap:_,scalingMethodOptions:b,scalingRecommendations:x,scalingRecommendationRows:N,scalingSelectedCount:E,scalingOverrideCount:M,scalingDefaultDetail:j,scalingDefaultLabel:C,scalingAutoDetectEnabled:S,scalingHasRecommendations:$,scalingStatusMessage:A,scalingOverrideExampleSummary:L,outlierConfig:T,outlierExcludedColumns:P,outlierMethodLabelMap:z,outlierMethodDetailMap:W,outlierMethodOptions:D,outlierRecommendations:R,outlierRecommendationRows:U,outlierSelectedCount:V,outlierOverrideCount:B,outlierParameterOverrideCount:G,outlierDefaultDetail:q,outlierDefaultLabel:F,outlierAutoDetectEnabled:K,outlierHasRecommendations:se,outlierStatusMessage:Q,outlierOverrideExampleSummary:H,outlierSampleSize:Y,relativeOutlierGeneratedAt:X,outlierHasOverrides:ee,outlierOverrideSummaryDisplay:J,binningConfig:re,binningSelectedCount:we,binningDefaultLabel:Pe,binningOverrideColumns:Me,binningOverrideCount:Fe,binningOverrideSummary:Ke,binningFieldIds:Ue,binningCustomEdgeDrafts:de,setBinningCustomEdgeDrafts:pe,binningCustomLabelDrafts:xe,setBinningCustomLabelDrafts:ke,selectedColumns:De,binningInsightsRecommendations:ce,binningRecommendedColumnSet:Oe,binningAllNumericColumns:Ye,binningNumericColumnsNotSelected:ct,canApplyAllBinningNumeric:Je,binningExcludedColumns:Ps,binningColumnPreviewMap:_s,manualBoundColumns:vs,manualRangeFallbackMap:Xs,handleOutlierDefaultMethodChange:ft,handleOutlierAutoDetectToggle:Os,setOutlierColumnMethod:Yt,handleOutlierClearOverrides:gt,handleOutlierApplyAllRecommendations:xt,handleOutlierSkipColumn:ls,handleOutlierUnskipColumn:dn,handleOutlierOverrideSelect:jn,handleOutlierMethodParameterChange:mn,handleOutlierColumnParameterChange:An,handleScalingDefaultMethodChange:hn,handleScalingAutoDetectToggle:is,setScalingColumnMethod:It,handleScalingClearOverrides:Bn,handleScalingApplyAllRecommendations:On,handleScalingSkipColumn:Nn,handleScalingUnskipColumn:lr,handleScalingOverrideSelect:Xn,binningInsightsExcludedColumns:Jn,handleBinningIntegerChange:mt,handleBinningBooleanToggle:Ze,handleBinningSuffixChange:ot,handleBinningLabelFormatChange:Et,handleBinningMissingStrategyChange:zt,handleBinningMissingLabelChange:We,handleBinningCustomBinsChange:Dt,handleBinningCustomLabelsChange:ht,handleBinningClearCustomColumn:kt,updateBinningColumnOverride:sn,handleBinningOverrideStrategyChange:wn,handleBinningOverrideNumberChange:Mt,handleBinningOverrideKbinsEncodeChange:rn,handleBinningOverrideKbinsStrategyChange:Fn,handleBinningClearOverride:Ut,handleBinningClearOverrides:it,handleBinningApplyStrategies:In,handleBinningApplyColumns:Zt,handleApplyAllBinningNumeric:gn}},uw={enabled:!1,explicit:!1},Z$={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},eL={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},tL={},nL=[],sL=({isReplaceAliasesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:l,previewSampleRows:i})=>{const c=v.useMemo(()=>{if(!e)return uw;const b=ni(t);if(b!==void 0)return{enabled:!!Fo(b),explicit:!0};if(n&&typeof n=="object"){const x=ni(n);if(x!==void 0)return{enabled:!!Fo(x),explicit:!0}}return uw},[t,e,n]),u=v.useMemo(()=>{if(!e)return[];const b=Ve((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),x=um(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),N=(()=>{const M=ni(t);if(M!==void 0){const j=Fo(M);if(j!==null)return j}if(n&&typeof n=="object"){const j=ni(n);if(j!==void 0){const C=Fo(j);if(C!==null)return C}}return b.length===0})(),E=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return xx(E,{mode:x,columns:b,autoDetect:N})},[t,e,n]),d=v.useMemo(()=>e?u.length?Array.from(new Set(u.flatMap(b=>b.columns.map(x=>x.trim()).filter(Boolean)))).sort((b,x)=>b.localeCompare(x)):Ve(t==null?void 0:t.columns):[],[u,t==null?void 0:t.columns,e]),p=v.useMemo(()=>e?u.length?u.some(b=>b.autoDetect):c.explicit?c.enabled:d.length===0:!1,[c.enabled,c.explicit,d.length,u,e]),h=v.useMemo(()=>{if(e)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,e]),f=v.useMemo(()=>e?uA(i):tL,[e,i]),g=v.useMemo(()=>e?rA({selectedColumns:d,availableColumns:s,columnTypeMap:l,autoDetectEnabled:p}):Z$,[p,d,s,l,e]),w=v.useMemo(()=>e?oA(h):eL,[e,h]),_=v.useMemo(()=>{if(!e)return nL;const b=new Set(g.recommendedColumns),x=new Set(g.textColumns);return s.map(N=>{const E=l[N]??null,M=f[N]??[];return{name:N,dtype:E,samples:M.slice(0,3),isRecommended:b.has(N),isTextLike:x.has(N)}})},[g.recommendedColumns,g.textColumns,f,s,l,e]);return{aliasAutoDetectMeta:c,aliasStrategies:u,aliasStrategyCount:u.length,aliasSelectedColumns:d,aliasAutoDetectEnabled:p,replaceAliasesCustomPairsValue:h,aliasColumnSummary:g,aliasCustomPairSummary:w,aliasSampleMap:f,aliasColumnOptions:_}},rL=({isTrimWhitespaceNode:e,isRemoveSpecialCharsNode:t,isRegexCleanupNode:n,isNormalizeTextCaseNode:s,configState:l,nodeConfig:i,availableColumns:c,columnTypeMap:u,previewSampleRows:d})=>{const p=v.useMemo(()=>BA(e?l==null?void 0:l.mode:void 0,e?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,e,i==null?void 0:i.mode]),h=v.useMemo(()=>e?Ve(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,e]),f=v.useMemo(()=>e?YA(d):{},[e,d]),g=v.useMemo(()=>e?HA({selectedColumns:h,availableColumns:c,columnTypeMap:u,sampleMap:f}):QA,[c,u,e,h,f]),w=v.useMemo(()=>UA(p),[p]),_=v.useMemo(()=>iO(t?l==null?void 0:l.mode:void 0,t?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,t,i==null?void 0:i.mode]),b=v.useMemo(()=>t?Ve(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,t]),x=v.useMemo(()=>t?hO(d):{},[t,d]),N=v.useMemo(()=>t?dO({selectedColumns:b,availableColumns:c,columnTypeMap:u,sampleMap:x}):pO,[c,u,t,b,x]),E=v.useMemo(()=>cO(_),[_]),M=v.useMemo(()=>BO(n?l==null?void 0:l.mode:void 0,n?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,n,i==null?void 0:i.mode]),j=v.useMemo(()=>n?Ve(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,n]),C=v.useMemo(()=>n?WO(d):{},[n,d]),S=v.useMemo(()=>n?HO({selectedColumns:j,availableColumns:c,columnTypeMap:u,sampleMap:C}):GO,[c,u,n,j,C]),$=v.useMemo(()=>UO(M),[M]),A=v.useMemo(()=>{if(!n)return null;const D=(l==null?void 0:l.replacement)??(i==null?void 0:i.replacement)??null;return typeof D=="string"?D:null},[l==null?void 0:l.replacement,n,i==null?void 0:i.replacement]),L=v.useMemo(()=>CO(s?l==null?void 0:l.mode:void 0,s?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,s,i==null?void 0:i.mode]),T=v.useMemo(()=>s?Ve(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,s]),P=v.useMemo(()=>s?AO(d):{},[s,d]),z=v.useMemo(()=>s?kO({selectedColumns:T,availableColumns:c,columnTypeMap:u,sampleMap:P,mode:L}):PO,[c,u,s,T,L,P]),W=v.useMemo(()=>SO(L),[L]);return{trimWhitespace:{columnSummary:g,sampleMap:f,modeDetails:w},removeSpecial:{columnSummary:N,sampleMap:x,modeDetails:E,selectedMode:_},regexCleanup:{columnSummary:S,sampleMap:C,modeDetails:$,selectedMode:M,replacementValue:A},normalizeCase:{columnSummary:z,sampleMap:P,modeDetails:W,selectedMode:L}}},aL={},oL=({isReplaceInvalidValuesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:l,previewSampleRows:i})=>{const c=v.useMemo(()=>oP(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),u=v.useMemo(()=>e?Ve(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,e]),d=v.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),_=Number(w);return Number.isFinite(_)?_:null},[t==null?void 0:t.min_value,e,n==null?void 0:n.min_value]),p=v.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),_=Number(w);return Number.isFinite(_)?_:null},[t==null?void 0:t.max_value,e,n==null?void 0:n.max_value]),h=v.useMemo(()=>e?dP(i):aL,[e,i]),f=v.useMemo(()=>e?cP({selectedColumns:u,availableColumns:s,columnTypeMap:l,sampleMap:h}):yP,[s,l,e,h,u]),g=v.useMemo(()=>lP(c),[c]);return{selectedColumns:u,selectedMode:c,modeDetails:g,sampleMap:h,columnSummary:f,minValue:d,maxValue:p}},lL={},iL=({isStandardizeDatesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:l,previewSampleRows:i})=>{const c=v.useMemo(()=>Px(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),u=v.useMemo(()=>e?Ve((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,e,n==null?void 0:n.columns]),d=v.useMemo(()=>{if(!e)return[];const _={columns:u,mode:c,autoDetect:u.length===0};return Tx((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),_)},[t==null?void 0:t.format_strategies,e,u,n==null?void 0:n.format_strategies,c]),p=v.useMemo(()=>{if(!e)return[];const _=new Set;return d.forEach(b=>{b.columns.forEach(x=>{const N=x.trim();N&&_.add(N)})}),Array.from(_).sort((b,x)=>b.localeCompare(x))},[e,d]),h=v.useMemo(()=>d.some(_=>_.autoDetect),[d]),f=v.useMemo(()=>e?OA(i):lL,[e,i]),g=v.useMemo(()=>{if(!e)return PA;const _=CA({selectedColumns:p,availableColumns:s,columnTypeMap:l,sampleMap:f});return h?{..._,autoDetectionActive:!0}:_},[s,l,h,e,f,p]),w=v.useMemo(()=>{if(!e)return[];const _=new Set(g.recommendedColumns),b=new Set(g.sampleCandidates);return s.map(x=>{const N=l[x]??null,E=f[x]??[];return{name:x,dtype:N,samples:E.slice(0,3),isRecommended:_.has(x),isSampleCandidate:b.has(x)}})},[s,g,l,e,f]);return{selectedMode:c,strategies:d,sampleMap:f,columnSummary:g,columnOptions:w}},cL=({isReplaceAliasesNode:e,isTrimWhitespaceNode:t,isRemoveSpecialCharsNode:n,isRegexCleanupNode:s,isNormalizeTextCaseNode:l,isReplaceInvalidValuesNode:i,isStandardizeDatesNode:c,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f})=>{const{aliasAutoDetectMeta:g,aliasStrategies:w,aliasStrategyCount:_,aliasSelectedColumns:b,aliasAutoDetectEnabled:x,replaceAliasesCustomPairsValue:N,aliasColumnSummary:E,aliasCustomPairSummary:M,aliasSampleMap:j,aliasColumnOptions:C}=sL({isReplaceAliasesNode:e,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{trimWhitespace:{columnSummary:S,sampleMap:$,modeDetails:A},removeSpecial:{columnSummary:L,sampleMap:T,modeDetails:P,selectedMode:z},regexCleanup:{columnSummary:W,sampleMap:D,modeDetails:R,selectedMode:U,replacementValue:V},normalizeCase:{columnSummary:B,sampleMap:G,modeDetails:q,selectedMode:F}}=rL({isTrimWhitespaceNode:t,isRemoveSpecialCharsNode:n,isRegexCleanupNode:s,isNormalizeTextCaseNode:l,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{selectedMode:K,modeDetails:se,sampleMap:Q,columnSummary:H,minValue:Y,maxValue:X}=oL({isReplaceInvalidValuesNode:i,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{selectedMode:ee,strategies:J,sampleMap:re,columnSummary:we,columnOptions:Pe}=iL({isStandardizeDatesNode:c,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f});return{aliasAutoDetectMeta:g,aliasStrategies:w,aliasStrategyCount:_,aliasSelectedColumns:b,aliasAutoDetectEnabled:x,replaceAliasesCustomPairsValue:N,aliasColumnSummary:E,aliasCustomPairSummary:M,aliasSampleMap:j,aliasColumnOptions:C,trimWhitespaceColumnSummary:S,trimWhitespaceSampleMap:$,trimWhitespaceModeDetails:A,removeSpecialColumnSummary:L,removeSpecialSampleMap:T,removeSpecialModeDetails:P,removeSpecialMode:z,regexCleanupColumnSummary:W,regexCleanupSampleMap:D,regexCleanupModeDetails:R,regexCleanupMode:U,regexCleanupReplacementValue:V,normalizeCaseColumnSummary:B,normalizeCaseSampleMap:G,normalizeCaseModeDetails:q,normalizeCaseMode:F,replaceInvalidMode:K,replaceInvalidModeDetails:se,replaceInvalidSampleMap:Q,replaceInvalidColumnSummary:H,replaceInvalidMinValue:Y,replaceInvalidMaxValue:X,standardizeDatesMode:ee,dateStrategies:J,standardizeDatesSampleMap:re,standardizeDatesColumnSummary:we,dateColumnOptions:Pe}},uL=({graphSnapshot:e,nodeId:t,isDataset:n})=>{const s=v.useMemo(()=>{if(!e)return null;const f=Array.isArray(e.nodes)?e.nodes:[],g=Array.isArray(e.edges)?e.edges:[];return{nodes:f,edges:g}},[e]),l=v.useMemo(()=>e&&Array.isArray(e.nodes)?e.nodes:[],[e]),i=v.useMemo(()=>e&&Array.isArray(e.edges)?e.edges:[],[e]),c=l.length,u=v.useMemo(()=>{if(!t||!i.length)return[];const f=new Set,g=[t];for(;g.length;){const _=g.pop();_&&i.forEach(b=>{const x=b&&typeof b.source=="string"?b.source.trim():"",N=b&&typeof b.target=="string"?b.target.trim():"";!x||!N||N===_&&!f.has(x)&&(f.add(x),g.push(x))})}const w=Array.from(f);return w.sort(),w},[i,t]),d=v.useMemo(()=>{var w,_,b,x,N;if(!u.length)return"";let f="",g="";for(const E of u){const M=l.find(C=>(C==null?void 0:C.id)===E);if(!M)continue;const j=String(((w=M==null?void 0:M.data)==null?void 0:w.catalogType)??"").toLowerCase().trim();if(j==="feature_target_split"){const C=(b=(_=M==null?void 0:M.data)==null?void 0:_.config)==null?void 0:b.target_column;typeof C=="string"&&C.trim()&&(f=C.trim())}else if(j==="train_test_split"){const C=(N=(x=M==null?void 0:M.data)==null?void 0:x.config)==null?void 0:N.target_column;typeof C=="string"&&C.trim()&&(g=C.trim())}}return f||g||""},[l,u]),p=v.useMemo(()=>{const f=new Set;return l.forEach(g=>{if(!g)return;const w=typeof g.id=="string"?g.id.trim():String((g==null?void 0:g.id)??"").trim();if(!w)return;const _=(g==null?void 0:g.data)??{};(w==="dataset-source"||(_==null?void 0:_.isDataset)===!0||(_==null?void 0:_.catalogType)==="dataset")&&f.add(w)}),f.size||f.add("dataset-source"),Array.from(f)},[l]),h=v.useMemo(()=>{if(!t)return!1;if(n)return!0;if(!i.length)return p.includes(t);const f=new Map;i.forEach(_=>{const b=_==null?void 0:_.source,x=_==null?void 0:_.target,N=typeof b=="string"?b.trim():String(b??"").trim(),E=typeof x=="string"?x.trim():String(x??"").trim();if(!N||!E)return;const M=f.get(N);M?M.push(E):f.set(N,[E])});const g=new Set,w=[...p];for(;w.length;){const _=w.pop();if(!_||g.has(_))continue;g.add(_);const b=f.get(_);b&&b.forEach(x=>{x&&!g.has(x)&&w.push(x)})}return g.has(t)},[p,i,n,t]);return{graphContext:s,graphNodes:l,graphEdges:i,graphNodeCount:c,upstreamNodeIds:u,upstreamTargetColumn:d,hasReachableSource:h}},Bc={status:"idle",data:null,error:null},dL=1e3,mL=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:s,isPreviewNode:l,targetNodeId:i,previewSignature:c,skipPreview:u=!1,requestPreviewRows:d,includeSignals:p})=>{const[h,f]=v.useState(Bc),[g,w]=v.useState(0),_=v.useRef(null),b=v.useRef(-1),x=v.useCallback(()=>{w(N=>N+1)},[]);return v.useEffect(()=>{if(!e){f(Bc),_.current=null,b.current=-1;return}if(u)return;if(!t){f(l?{status:"error",data:null,error:"Select a dataset to generate previews."}:Bc);return}if(!n){f(l?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:Bc);return}if(!s)return;const N=(()=>{const L=Array.isArray(s.nodes)?s.nodes.map(P=>P&&typeof P.id=="string"?P.id:null).filter(P=>!!P).sort():[],T=Array.isArray(s.edges)?s.edges.map(P=>{const z=P&&typeof P.source=="string"?P.source.trim():"",W=P&&typeof P.target=="string"?P.target.trim():"";return z&&W?`${z}->${W}`:null}).filter(P=>!!P).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:i??null,nodeIds:L,edgePairs:T})})(),E=c??N,M=E!==_.current;if(!(b.current!==g)&&!M)return;_.current=E,b.current=g;let C=!0;f(L=>({status:"loading",data:L.data??null,error:null}));const S=d??l,$=p??S,A={dataset_source_id:t,graph:{nodes:s.nodes,edges:s.edges},target_node_id:i??void 0,include_preview_rows:S,include_signals:$};return S&&(A.sample_size=dL),Jb(A).then(L=>{C&&f({status:"success",data:L,error:null})}).catch(L=>{C&&f(l?{status:"error",data:null,error:(L==null?void 0:L.message)??"Unable to generate preview."}:Bc)}),()=>{C=!1}},[n,s,l,u,c,g,e,t,i]),{previewState:h,refreshPreview:x}},hL=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:l,nodeId:i,previewSignature:c,skipPreview:u,isPreviewNode:d,isFeatureMathNode:p,isPolynomialFeaturesNode:h,isFeatureSelectionNode:f,isTrainTestSplitNode:g,isOutlierNode:w,isTransformerAuditNode:_,cachedPreviewSchema:b,setCachedPreviewSchema:x})=>{var $;const N=v.useMemo(()=>!(!e||!t||!n),[t,e,n]),E=v.useMemo(()=>!e||!s||!n?!1:t>0,[t,e,n,s]),M=v.useMemo(()=>d||p||h||f||g||w||_,[p,f,w,h,d,g,_]),{previewState:j,refreshPreview:C}=mL({shouldFetchPreview:N,sourceId:s,canTriggerPreview:E,graphSnapshot:e,isPreviewNode:d,targetNodeId:(l==null?void 0:l.id)??null,previewSignature:c,skipPreview:u,requestPreviewRows:d,includeSignals:M});v.useEffect(()=>{var L;const A=((L=j.data)==null?void 0:L.schema)??null;A&&x(T=>T!=null&&T.signature&&A.signature&&T.signature===A.signature?T:A)},[($=j.data)==null?void 0:$.schema]),v.useEffect(()=>{x(null)},[s]),v.useEffect(()=>{x(null)},[c]);const S=v.useCallback(()=>{x(null)},[]);return{previewState:j,refreshPreview:C,cachedPreviewSchema:b,clearCachedPreviewSchema:S,canTriggerPreview:E}},fL=(e,t,n,s,l)=>{e([]),t({}),n({}),s({}),l("")},pL=({requiresColumnCatalog:e,isImputerNode:t,nodeId:n,sourceId:s,hasReachableSource:l})=>{const[i,c]=v.useState([]),[u,d]=v.useState(""),[p,h]=v.useState({}),[f,g]=v.useState({}),[w,_]=v.useState({}),[b,x]=v.useState(0);return v.useEffect(()=>{!e&&!t||s&&l||fL(c,h,g,_,d)},[l,t,e,s]),v.useEffect(()=>{x(0)},[t,n]),{availableColumns:i,setAvailableColumns:c,columnSearch:u,setColumnSearch:d,columnMissingMap:p,setColumnMissingMap:h,columnTypeMap:f,setColumnTypeMap:g,columnSuggestions:w,setColumnSuggestions:_,imputerMissingFilter:b,setImputerMissingFilter:x}},gL=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:l})=>{var i;v.useEffect(()=>{var h;const c=Array.isArray((h=e.data)==null?void 0:h.column_stats)?e.data.column_stats:[],u=e.status;if(!c.length){if(u==="loading")return;s(f=>Object.keys(f).length?{}:f),l(f=>Object.keys(f).length?{}:f);return}const d={},p={};c.forEach(f=>{if(!f||!f.name)return;const g=String(f.name).trim();if(!g||n&&g.endsWith(n))return;const w=typeof f.dtype=="string"?f.dtype:null;w&&(d[g]=w);const _=t.map(x=>x&&Object.prototype.hasOwnProperty.call(x,g)?x[g]:void 0),b=qT(w,_);b.length&&(p[g]=b)}),s(f=>{const g=Object.entries(f),w=Object.entries(d);return g.length===w.length&&g.every(([_,b])=>Object.prototype.hasOwnProperty.call(d,_)&&d[_]===b)?f:d}),l(f=>{const g=Object.keys(f),w=Object.keys(p);return g.length===w.length&&g.every(_=>{if(!Object.prototype.hasOwnProperty.call(p,_))return!1;const b=f[_]??[],x=p[_]??[];return z0(b,x)})?f:p})},[n,t,(i=e.data)==null?void 0:i.column_stats,e.status,l,s])},_L=({previewState:e,activeFlagSuffix:t,hasReachableSource:n,requiresColumnCatalog:s,nodeColumns:l,selectedColumns:i,setAvailableColumns:c,setColumnMissingMap:u})=>{var d,p;v.useEffect(()=>{var b,x;if(!s||!n)return;const h=new Set;(Array.isArray((b=e.data)==null?void 0:b.columns)?e.data.columns:[]).forEach(N=>{const E=typeof N=="string"?N.trim():"";E&&(t&&E.endsWith(t)||h.add(E))});const g=Array.isArray((x=e.data)==null?void 0:x.column_stats)?e.data.column_stats:[],w={};if(g.forEach(N=>{if(!N||!N.name)return;const E=String(N.name).trim();if(!E||t&&E.endsWith(t))return;h.add(E);const M=Number(N.missing_percentage);!Number.isNaN(M)&&M>=0&&(w[E]=M)}),Ve(l).forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),i.forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),h.size===0)return;const _=Array.from(h).sort((N,E)=>N.localeCompare(E));c(N=>z0(N,_)?N:_),Object.keys(w).length>0&&u(N=>({...N,...w}))},[t,n,l,(d=e.data)==null?void 0:d.column_stats,(p=e.data)==null?void 0:p.columns,s,i,c,u])},vL=({previewState:e,nodeId:t,isFeatureMathNode:n,isPolynomialFeaturesNode:s,isFeatureSelectionNode:l,isOutlierNode:i,isTransformerAuditNode:c})=>{var g,w,_,b,x,N,E,M,j,C;const u=v.useMemo(()=>{var $,A;if(!n)return[];const S=(A=($=e.data)==null?void 0:$.signals)==null?void 0:A.feature_math;return Array.isArray(S)?S:[]},[n,(w=(g=e.data)==null?void 0:g.signals)==null?void 0:w.feature_math]),d=v.useMemo(()=>{var A,L;if(!s)return null;const S=(L=(A=e.data)==null?void 0:A.signals)==null?void 0:L.polynomial_features;return!Array.isArray(S)||S.length===0?null:(t?S.find(T=>T&&typeof T.node_id=="string"&&T.node_id===t):null)??S[0]??null},[s,t,(b=(_=e.data)==null?void 0:_.signals)==null?void 0:b.polynomial_features]),p=v.useMemo(()=>{var A,L;if(!l)return null;const S=(L=(A=e.data)==null?void 0:A.signals)==null?void 0:L.feature_selection;return!Array.isArray(S)||S.length===0?null:(t?S.find(T=>T&&typeof T.node_id=="string"&&T.node_id===t):null)??S[0]??null},[l,t,(N=(x=e.data)==null?void 0:x.signals)==null?void 0:N.feature_selection]),h=v.useMemo(()=>{var A,L;if(!i)return null;const S=(L=(A=e.data)==null?void 0:A.signals)==null?void 0:L.outlier_removal;return!Array.isArray(S)||!S.length?null:t?S.find(T=>T&&T.node_id===t)??S[S.length-1]??null:S[S.length-1]??null},[i,t,(M=(E=e.data)==null?void 0:E.signals)==null?void 0:M.outlier_removal]),f=v.useMemo(()=>{var A,L;if(!c)return null;const S=(L=(A=e.data)==null?void 0:A.signals)==null?void 0:L.transformer_audit;return!Array.isArray(S)||!S.length?null:t?S.find(T=>T&&T.node_id===t)??S[S.length-1]??null:S[S.length-1]??null},[c,t,(C=(j=e.data)==null?void 0:j.signals)==null?void 0:C.transformer_audit]);return{featureMathSignals:u,polynomialSignal:d,featureSelectionSignal:p,outlierPreviewSignal:h,transformerAuditSignal:f}},yL=({isFeatureSelectionNode:e,featureSelectionSignal:t,upstreamTargetColumn:n,setConfigState:s})=>{v.useEffect(()=>{if(!e)return;const l=typeof(t==null?void 0:t.target_column)=="string"?t.target_column.trim():"",i=typeof n=="string"?n.trim():"",c=l||i;c&&s(u=>(typeof(u==null?void 0:u.target_column)=="string"?u.target_column.trim():"")?u:{...u,target_column:c})},[t==null?void 0:t.target_column,e,s,n]),v.useEffect(()=>{if(!e)return;const l=typeof(t==null?void 0:t.k)=="number"&&Number.isFinite(t.k)?Math.max(0,Math.trunc(t.k)):null,i=Array.isArray(t==null?void 0:t.selected_columns)?t.selected_columns.length:null,c=l??i??null;c===null||c<=0||s(u=>{const d=u==null?void 0:u.k;let p=null;if(typeof d=="number"&&Number.isFinite(d))p=Math.trunc(d);else if(typeof d=="string"){const h=Number(d);Number.isFinite(h)&&(p=Math.trunc(h))}return p!==null&&p<=c?u:{...u,k:c}})},[t==null?void 0:t.k,t==null?void 0:t.selected_columns,e,s])},km=e=>String(e??"").trim(),bL=({isBinningNode:e,isScalingNode:t,setConfigState:n,binningExcludedColumns:s,scalingExcludedColumns:l,availableColumns:i,recommendations:c})=>{const u=v.useCallback((_,b,x)=>{const N=km(_);N&&n(E=>{const M=E.manual_bounds&&typeof E.manual_bounds=="object"&&!Array.isArray(E.manual_bounds)?{...E.manual_bounds}:{},j=M[N]&&typeof M[N]=="object"?{...M[N]}:{lower:null,upper:null};if(x==="")b==="lower"?j.lower=null:j.upper=null;else{const $=Number(x);if(!Number.isFinite($))return E;b==="lower"?j.lower=$:j.upper=$}const C=j.lower??null,S=j.upper??null;return C===null&&S===null?delete M[N]:M[N]={lower:C,upper:S},{...E,manual_bounds:M}})},[n]),d=v.useCallback(_=>{const b=km(_);b&&n(x=>{const N=x.manual_bounds&&typeof x.manual_bounds=="object"&&!Array.isArray(x.manual_bounds)?x.manual_bounds:null;if(!N||!Object.prototype.hasOwnProperty.call(N,b))return x;const E={...N};return delete E[b],{...x,manual_bounds:E}})},[n]),p=v.useCallback(_=>{const b=km(_);b&&n(x=>{const N=Ve(x.columns),E=N.includes(b),M=E?N.filter($=>$!==b):[...N,b];let j=!1,C=x.manual_bounds;E&&C&&typeof C=="object"&&!Array.isArray(C)&&Object.prototype.hasOwnProperty.call(C,b)&&(C={...C},delete C[b],j=!0);const S={...x,columns:M};if(j&&(S.manual_bounds=C),e){const $=new Set(M);if(x.custom_bins&&typeof x.custom_bins=="object"&&!Array.isArray(x.custom_bins)){const A={};Object.entries(x.custom_bins).forEach(([L,T])=>{$.has(L)&&Array.isArray(T)&&T.length&&(A[L]=[...T])}),Object.keys(A).length?S.custom_bins=A:"custom_bins"in S&&delete S.custom_bins}else"custom_bins"in S&&delete S.custom_bins;if(x.custom_labels&&typeof x.custom_labels=="object"&&!Array.isArray(x.custom_labels)){const A={};Object.entries(x.custom_labels).forEach(([L,T])=>{$.has(L)&&Array.isArray(T)&&T.length&&(A[L]=T.map(P=>String(P)))}),Object.keys(A).length?S.custom_labels=A:"custom_labels"in S&&delete S.custom_labels}else"custom_labels"in S&&delete S.custom_labels;if(x.column_overrides&&typeof x.column_overrides=="object"&&!Array.isArray(x.column_overrides)){const A={};Object.entries(x.column_overrides).forEach(([L,T])=>{$.has(L)&&T&&typeof T=="object"&&!Array.isArray(T)&&(A[L]={...T})}),Object.keys(A).length?(S.column_overrides=A,S.column_strategies=A):("column_overrides"in S&&delete S.column_overrides,"column_strategies"in S&&delete S.column_strategies)}else"column_overrides"in S&&delete S.column_overrides,"column_strategies"in S&&delete S.column_strategies}if(t){let $=null;x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)&&($={},Object.entries(x.column_methods).forEach(([A,L])=>{const T=typeof L=="string"?L.trim():null;!T||!Qs.includes(T)||E&&A===b||($[A]=T)})),$&&Object.keys($).length?S.column_methods=$:E&&Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods}return S})},[e,t,n]),h=v.useCallback(()=>{c.length&&n(_=>{const b=new Set(Ve(_.columns));return c.forEach(x=>{x!=null&&x.name&&b.add(String(x.name))}),{..._,columns:Array.from(b)}})},[c,n]),f=v.useCallback(()=>{i.length&&n(_=>{const b=new Set(Ve(_.columns));return i.filter(N=>e?!s.has(N):t?!l.has(N):!0).forEach(N=>b.add(N)),{..._,columns:Array.from(b).sort((N,E)=>N.localeCompare(E))}})},[i,s,e,t,l,n]),g=v.useCallback(()=>{n(_=>{const b={..._,columns:[]};return _!=null&&_.manual_bounds&&typeof _.manual_bounds=="object"&&!Array.isArray(_.manual_bounds)&&Object.keys(_.manual_bounds).length&&(b.manual_bounds={}),e&&("custom_bins"in b&&delete b.custom_bins,"custom_labels"in b&&delete b.custom_labels,"column_overrides"in b&&delete b.column_overrides,"column_strategies"in b&&delete b.column_strategies),t&&"column_methods"in b&&delete b.column_methods,b})},[e,t,n]),w=v.useCallback(_=>{const b=km(_);b&&n(x=>{const N=Ve(x.columns);if(!N.includes(b))return x;const E=N.filter(S=>S!==b);let M=!1,j=x.manual_bounds;j&&typeof j=="object"&&!Array.isArray(j)&&Object.prototype.hasOwnProperty.call(j,b)&&(j={...j},delete j[b],M=!0);const C={...x,columns:E};if(M&&(C.manual_bounds=j),e){if(x.custom_bins&&typeof x.custom_bins=="object"&&!Array.isArray(x.custom_bins)){const S={};Object.entries(x.custom_bins).forEach(([$,A])=>{$!==b&&Array.isArray(A)&&A.length&&(S[$]=[...A])}),Object.keys(S).length?C.custom_bins=S:"custom_bins"in C&&delete C.custom_bins}else"custom_bins"in C&&delete C.custom_bins;if(x.custom_labels&&typeof x.custom_labels=="object"&&!Array.isArray(x.custom_labels)){const S={};Object.entries(x.custom_labels).forEach(([$,A])=>{$!==b&&Array.isArray(A)&&A.length&&(S[$]=A.map(L=>String(L)))}),Object.keys(S).length?C.custom_labels=S:"custom_labels"in C&&delete C.custom_labels}else"custom_labels"in C&&delete C.custom_labels;if(x.column_overrides&&typeof x.column_overrides=="object"&&!Array.isArray(x.column_overrides)){const S={};Object.entries(x.column_overrides).forEach(([$,A])=>{$!==b&&A&&typeof A=="object"&&!Array.isArray(A)&&(S[$]={...A})}),Object.keys(S).length?(C.column_overrides=S,C.column_strategies=S):("column_overrides"in C&&delete C.column_overrides,"column_strategies"in C&&delete C.column_strategies)}else"column_overrides"in C&&delete C.column_overrides,"column_strategies"in C&&delete C.column_strategies}if(t)if(x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)){const S={};Object.entries(x.column_methods).forEach(([$,A])=>{const L=typeof A=="string"?A.trim():null;!L||!Qs.includes(L)||$!==b&&(S[$]=L)}),Object.keys(S).length?C.column_methods=S:Object.prototype.hasOwnProperty.call(C,"column_methods")&&delete C.column_methods}else Object.prototype.hasOwnProperty.call(C,"column_methods")&&delete C.column_methods;return C})},[e,t,n]);return{handleManualBoundChange:u,handleClearManualBound:d,handleToggleColumn:p,handleApplyAllRecommended:h,handleSelectAllColumns:f,handleClearColumns:g,handleRemoveColumn:w}},xL=({configState:e,isBinningNode:t,isScalingNode:n,nodeId:s,onUpdateConfig:l,onClose:i,sourceId:c,graphSnapshot:u,isInspectionNode:d,onUpdateNodeData:p,setConfigState:h,canResetNode:f,defaultConfigTemplate:g,onResetConfig:w})=>{const _=v.useCallback(x=>{if(!s)return;let N=Xp(e);if(t){const E=ux(N);N={...N,strategy:E.strategy,columns:E.columns,equal_width_bins:E.equalWidthBins,equal_frequency_bins:E.equalFrequencyBins,include_lowest:E.includeLowest,precision:E.precision,duplicates:E.duplicates,output_suffix:E.outputSuffix,drop_original:E.dropOriginal,label_format:E.labelFormat,missing_strategy:E.missingStrategy},E.missingStrategy==="label"?N.missing_label=E.missingLabel:Object.prototype.hasOwnProperty.call(N,"missing_label")&&delete N.missing_label,Object.keys(E.customBins).length?N.custom_bins=E.customBins:Object.prototype.hasOwnProperty.call(N,"custom_bins")&&delete N.custom_bins,Object.keys(E.customLabels).length?N.custom_labels=E.customLabels:Object.prototype.hasOwnProperty.call(N,"custom_labels")&&delete N.custom_labels}if(n){const E=cw(N);N={...N,columns:E.columns,default_method:E.defaultMethod,auto_detect:E.autoDetect,skipped_columns:E.skippedColumns},Object.keys(E.columnMethods).length>0?N.column_methods=E.columnMethods:Object.prototype.hasOwnProperty.call(N,"column_methods")&&delete N.column_methods}l(s,N),(x==null?void 0:x.closeModal)!==!1&&i(),c&&u&&!d&&(p==null||p(s,{backgroundExecutionStatus:"loading"}),Zb({dataset_source_id:c,graph:{nodes:u.nodes||[],edges:u.edges||[]},target_node_id:s}).then(()=>{p==null||p(s,{backgroundExecutionStatus:"success"})}).catch(E=>{p==null||p(s,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",E)}))},[e,u,t,d,n,s,i,l,p,c]),b=v.useCallback(()=>{if(!f||!s)return;const x=Xp(g??{});h(x),w==null||w(s,x)},[f,g,s,w,h]);return{handleSave:_,handleResetNode:b}},wL=e=>v.useMemo(()=>{const t=new Map;return e.forEach(n=>{n!=null&&n.name&&t.set(n.name,n)}),n=>t.get(n)??null},[e]),jL=e=>{const t=v.useMemo(()=>{var u;const c=(u=e==null?void 0:e.data)==null?void 0:u.parameters;return Array.isArray(c)?c.filter(d=>!!(d!=null&&d.name)).map(d=>({...d})):[]},[e]),n=wL(t),s=v.useCallback((c,u)=>c?n(u):null,[n]),l=v.useMemo(()=>t.some(c=>{var u;return(c==null?void 0:c.type)==="multi_select"&&((u=c==null?void 0:c.source)==null?void 0:u.type)!=="drop_column_recommendations"}),[t]),i=v.useMemo(()=>t.find(c=>{var u;return((u=c==null?void 0:c.source)==null?void 0:u.type)==="drop_column_recommendations"})??null,[t]);return{parameters:t,getParameter:n,getParameterIf:s,requiresColumnCatalog:l,dropColumnParameter:i}},NL=(e,t)=>{const n=(s,l)=>s?e(l):null;return v.useMemo(()=>{const{isBinningNode:s,isScalingNode:l,isRemoveDuplicatesNode:i,isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isReplaceInvalidValuesNode:p,isRegexCleanupNode:h,isNormalizeTextCaseNode:f,isLabelEncodingNode:g,isHashEncodingNode:w,isPolynomialFeaturesNode:_,isFeatureSelectionNode:b,isFeatureMathNode:x,isClassUndersamplingNode:N,isClassOversamplingNode:E,isFeatureTargetSplitNode:M,isTrainModelDraftNode:j,isHyperparameterTuningNode:C,isTargetEncodingNode:S,isOrdinalEncodingNode:$,isDummyEncodingNode:A,isOneHotEncodingNode:L,isMissingIndicatorNode:T,isDropMissingRowsNode:P}=t,z=N||E,W=j||C;return{binningColumnsParameter:n(s,"columns"),scalingColumnsParameter:n(l,"columns"),removeDuplicatesColumnsParameter:n(i,"columns"),removeDuplicatesKeepParameter:n(i,"keep"),replaceAliasesCustomPairsParameter:n(c,"custom_pairs"),trimWhitespaceColumnsParameter:n(u,"columns"),trimWhitespaceModeParameter:n(u,"mode"),removeSpecialColumnsParameter:n(d,"columns"),removeSpecialModeParameter:n(d,"mode"),removeSpecialReplacementParameter:n(d,"replacement"),replaceInvalidColumnsParameter:n(p,"columns"),replaceInvalidModeParameter:n(p,"mode"),replaceInvalidMinValueParameter:n(p,"min_value"),replaceInvalidMaxValueParameter:n(p,"max_value"),regexCleanupColumnsParameter:n(h,"columns"),regexCleanupModeParameter:n(h,"mode"),regexCleanupPatternParameter:n(h,"pattern"),regexCleanupReplacementParameter:n(h,"replacement"),normalizeCaseColumnsParameter:n(f,"columns"),normalizeCaseModeParameter:n(f,"mode"),labelEncodingColumnsParameter:g?e("columns"):null,labelEncodingAutoDetectParameter:g?e("auto_detect"):null,labelEncodingMaxUniqueParameter:g?e("max_unique_values"):null,labelEncodingOutputSuffixParameter:g?e("output_suffix"):null,labelEncodingDropOriginalParameter:g?e("drop_original"):null,labelEncodingMissingStrategyParameter:g?e("missing_strategy"):null,labelEncodingMissingCodeParameter:g?e("missing_code"):null,hashEncodingColumnsParameter:w?e("columns"):null,hashEncodingAutoDetectParameter:w?e("auto_detect"):null,hashEncodingMaxCategoriesParameter:w?e("max_categories"):null,hashEncodingBucketsParameter:w?e("n_buckets"):null,hashEncodingOutputSuffixParameter:w?e("output_suffix"):null,hashEncodingDropOriginalParameter:w?e("drop_original"):null,hashEncodingEncodeMissingParameter:w?e("encode_missing"):null,polynomialColumnsParameter:n(_,"columns"),polynomialAutoDetectParameter:n(_,"auto_detect"),polynomialDegreeParameter:n(_,"degree"),polynomialIncludeBiasParameter:n(_,"include_bias"),polynomialInteractionOnlyParameter:n(_,"interaction_only"),polynomialIncludeInputFeaturesParameter:n(_,"include_input_features"),polynomialOutputPrefixParameter:n(_,"output_prefix"),featureSelectionColumnsParameter:n(b,"columns"),featureSelectionAutoDetectParameter:n(b,"auto_detect"),featureSelectionTargetColumnParameter:n(b,"target_column"),featureSelectionMethodParameter:n(b,"method"),featureSelectionScoreFuncParameter:n(b,"score_func"),featureSelectionProblemTypeParameter:n(b,"problem_type"),featureSelectionKParameter:n(b,"k"),featureSelectionPercentileParameter:n(b,"percentile"),featureSelectionAlphaParameter:n(b,"alpha"),featureSelectionThresholdParameter:n(b,"threshold"),featureSelectionModeParameter:n(b,"mode"),featureSelectionEstimatorParameter:n(b,"estimator"),featureSelectionStepParameter:n(b,"step"),featureSelectionMinFeaturesParameter:n(b,"min_features"),featureSelectionMaxFeaturesParameter:n(b,"max_features"),featureSelectionDropUnselectedParameter:n(b,"drop_unselected"),featureMathErrorHandlingParameter:n(x,"error_handling"),featureMathAllowOverwriteParameter:n(x,"allow_overwrite"),featureMathDefaultTimezoneParameter:n(x,"default_timezone"),featureMathEpsilonParameter:n(x,"epsilon"),resamplingMethodParameter:n(z,"method"),resamplingTargetColumnParameter:n(z,"target_column"),resamplingSamplingStrategyParameter:n(z,"sampling_strategy"),resamplingRandomStateParameter:n(z,"random_state"),resamplingKNeighborsParameter:n(E,"k_neighbors"),resamplingReplacementParameter:n(N,"replacement"),featureTargetSplitTargetColumnParameter:n(M,"target_column"),trainModelTargetColumnParameter:n(W,"target_column"),trainModelProblemTypeParameter:n(W,"problem_type"),trainModelModelTypeParameter:n(W,"model_type"),trainModelHyperparametersParameter:n(j,"hyperparameters"),hyperparameterTuningSearchStrategyParameter:n(C,"search_strategy"),hyperparameterTuningSearchIterationsParameter:n(C,"search_iterations"),hyperparameterTuningSearchRandomStateParameter:n(C,"search_random_state"),hyperparameterTuningScoringMetricParameter:n(C,"scoring_metric"),trainModelCvEnabledParameter:n(W,"cv_enabled"),trainModelCvStrategyParameter:n(W,"cv_strategy"),trainModelCvFoldsParameter:n(W,"cv_folds"),trainModelCvShuffleParameter:n(W,"cv_shuffle"),trainModelCvRandomStateParameter:n(W,"cv_random_state"),trainModelCvRefitStrategyParameter:n(j,"cv_refit_strategy"),targetEncodingColumnsParameter:S?e("columns"):null,targetEncodingTargetColumnParameter:S?e("target_column"):null,targetEncodingAutoDetectParameter:S?e("auto_detect"):null,targetEncodingMaxCategoriesParameter:S?e("max_categories"):null,targetEncodingOutputSuffixParameter:S?e("output_suffix"):null,targetEncodingDropOriginalParameter:S?e("drop_original"):null,targetEncodingSmoothingParameter:S?e("smoothing"):null,targetEncodingEncodeMissingParameter:S?e("encode_missing"):null,targetEncodingHandleUnknownParameter:S?e("handle_unknown"):null,ordinalEncodingColumnsParameter:$?e("columns"):null,ordinalEncodingAutoDetectParameter:$?e("auto_detect"):null,ordinalEncodingMaxCategoriesParameter:$?e("max_categories"):null,ordinalEncodingOutputSuffixParameter:$?e("output_suffix"):null,ordinalEncodingDropOriginalParameter:$?e("drop_original"):null,ordinalEncodingEncodeMissingParameter:$?e("encode_missing"):null,ordinalEncodingHandleUnknownParameter:$?e("handle_unknown"):null,ordinalEncodingUnknownValueParameter:$?e("unknown_value"):null,dummyEncodingColumnsParameter:A?e("columns"):null,dummyEncodingAutoDetectParameter:A?e("auto_detect"):null,dummyEncodingMaxCategoriesParameter:A?e("max_categories"):null,dummyEncodingDropFirstParameter:A?e("drop_first"):null,dummyEncodingIncludeMissingParameter:A?e("include_missing"):null,dummyEncodingDropOriginalParameter:A?e("drop_original"):null,dummyEncodingPrefixSeparatorParameter:A?e("prefix_separator"):null,oneHotEncodingColumnsParameter:L?e("columns"):null,oneHotEncodingAutoDetectParameter:L?e("auto_detect"):null,oneHotEncodingMaxCategoriesParameter:L?e("max_categories"):null,oneHotEncodingDropFirstParameter:L?e("drop_first"):null,oneHotEncodingIncludeMissingParameter:L?e("include_missing"):null,oneHotEncodingDropOriginalParameter:L?e("drop_original"):null,oneHotEncodingPrefixSeparatorParameter:L?e("prefix_separator"):null,missingIndicatorColumnsParameter:n(T,"columns"),missingIndicatorSuffixParameter:n(T,"flag_suffix"),scalingDefaultMethodParameter:n(l,"default_method"),scalingAutoDetectParameter:n(l,"auto_detect"),dropRowsAnyParameter:n(P,"drop_if_any_missing")}},[t,e])},CL=({isResetAvailable:e=!1,isDataset:t,defaultConfigTemplate:n,footerResetFlags:s,isScalingNode:l,isBinningNode:i,isBinnedDistributionNode:c,isSkewnessDistributionNode:u})=>{const d=v.useMemo(()=>!!(e&&!t&&n),[n,t,e]),p=s.some(Boolean),h=c||u;return{canResetNode:d,headerCanResetNode:d&&!(h||l||i||p),footerCanResetNode:d&&!h}},SL=({cachedPreviewSchema:e,isClassOversamplingNode:t,resamplingTargetColumn:n,isImputerNode:s,imputerStrategies:l})=>{const i=v.useMemo(()=>(e==null?void 0:e.columns)??[],[e]),c=v.useMemo(()=>{if(!t||!i.length||!n)return null;const p=new Set(["numeric","integer","boolean"]),h=i.filter(f=>f&&f.name!==n).filter(f=>!p.has(String(f.logical_family??"unknown"))).map(f=>({name:f.name,logical_family:String(f.logical_family??"unknown")}));return h.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:h.map(f=>f.name),details:h}:null},[i,t,n]),u=v.useMemo(()=>{if(!s||!i.length||!l.length)return null;const p=new Set(["numeric","integer"]),h=new Map(i.map(g=>[g.name,g])),f=[];return l.forEach((g,w)=>{if(!mx(g.method)||!Array.isArray(g.columns)||!g.columns.length)return;const _=g.columns.map(b=>h.get(b)).filter(b=>!!b).filter(b=>!p.has(String(b.logical_family??"unknown"))).map(b=>({name:b.name,logical_family:String(b.logical_family??"unknown")}));_.length&&f.push({index:w,columns:_.map(b=>b.name),details:_})}),f.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:f}:null},[i,l,s]),d=!!(c!=null&&c.blocked||u!=null&&u.blocked);return{cachedSchemaColumns:i,oversamplingSchemaGuard:c,imputationSchemaDiagnostics:u,skipPreview:d}},EL=e=>{var l,i,c;const t=v.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.columns;return Array.isArray(u)?u.filter(p=>typeof p=="string"):[]},[(l=e.data)==null?void 0:l.columns]),n=v.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.column_stats;return Array.isArray(u)?u:[]},[(i=e.data)==null?void 0:i.column_stats]),s=v.useMemo(()=>{var u;return Array.isArray((u=e.data)==null?void 0:u.sample_rows)?e.data.sample_rows:[]},[(c=e.data)==null?void 0:c.sample_rows]);return{previewColumns:t,previewColumnStats:n,previewSampleRows:s}},kL=({isProfileLoading:e,isPreviewLoading:t,isFetchingScaling:n,isFetchingBinning:s,isFetchingHashEncoding:l,isFetchingBinnedDistribution:i,isFetchingRecommendations:c,isPreviewNode:u})=>{const d=v.useMemo(()=>e||t||n||s||l||i||c,[i,s,l,n,c,t,e]),p=v.useMemo(()=>e?"Generating dataset profile":n?"Loading scaling insights":s?"Loading binning insights":l?"Loading hash encoding insights":i?"Computing binned distributions":c?"Fetching column recommendations":t?u?"Loading dataset preview":"Analyzing node outputs":null,[i,s,l,c,n,t,u,e]);return{hasActiveAsyncWork:d,busyLabel:p,footerBusyLabel:p??(d?"Processing":null)}},bg=e=>{const t=Number(e);return Number.isFinite(t)?Math.max(0,Math.round(t)):null},ML=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s})=>{const l=v.useMemo(()=>Qn(e??null),[e]),i=v.useMemo(()=>Qn((t==null?void 0:t.generated_at)??null),[t==null?void 0:t.generated_at]),c=v.useMemo(()=>Qn((n==null?void 0:n.generated_at)??null),[n==null?void 0:n.generated_at]),u=v.useMemo(()=>Qn((s==null?void 0:s.generated_at)??null),[s==null?void 0:s.generated_at]),d=v.useMemo(()=>bg((t==null?void 0:t.sample_size)??null),[t==null?void 0:t.sample_size]),p=v.useMemo(()=>bg((n==null?void 0:n.sample_size)??null),[n==null?void 0:n.sample_size]),h=v.useMemo(()=>bg((s==null?void 0:s.sample_size)??null),[s==null?void 0:s.sample_size]);return{relativeGeneratedAt:l,relativeScalingGeneratedAt:i,relativeBinningGeneratedAt:c,relativeBinnedGeneratedAt:u,scalingSampleSize:d,binningSampleSize:p,binnedSampleSize:h}},AL=({suggestedThreshold:e,thresholdParameterName:t,configState:n,handleParameterChange:s})=>{const l=v.useMemo(()=>{if(e===null||Number.isNaN(Number(e)))return null;const d=Number(e);return Math.round(d*10)/10},[e]),i=v.useMemo(()=>{if(t===null||l===null)return!1;const d=Number(n==null?void 0:n[t]);return!Number.isNaN(d)&&d===l},[n,l,t]),c=l!==null&&!i,u=v.useCallback(()=>{l===null||!t||s(t,l)},[s,l,t]);return{normalizedSuggestedThreshold:l,thresholdMatchesSuggestion:i,canApplySuggestedThreshold:c,handleApplySuggestedThreshold:u}},OL=(e,t,n)=>{const[s,l]=v.useState(()=>new Set),i=v.useMemo(()=>e?f0((t==null?void 0:t.operations)??[]):[],[t==null?void 0:t.operations,e]),c=v.useMemo(()=>e?OP(i,n):[],[i,n,e]);return v.useEffect(()=>{if(!e){l(()=>new Set);return}l(u=>{if(!u.size)return u;const d=new Set(i.map(h=>h.id)),p=new Set;return u.forEach(h=>{d.has(h)&&p.add(h)}),p.size===u.size?u:p})},[i,e]),{featureMathOperations:i,featureMathSummaries:c,collapsedFeatureMath:s,setCollapsedFeatureMath:l}},PL="_was_missing",TL=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const s=typeof t=="string"?t.trim():"";return s||PL},$L=(e,t)=>{const n=typeof e=="string"?e.trim():"",s=typeof t=="string"?t:"";return!n||!s?!1:n.endsWith(s)},LL=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:s})=>{const l=typeof s=="string"?s:"",i=Ve(t),c=new Set(i),u=Array.from(new Set(Ve(e))),d=[];if(u.forEach(f=>{const g=`${f}${l}`,w=n[f],_=typeof w=="number"&&Number.isFinite(w)?Math.max(0,w):null;d.push({column:f,missingPercentage:_,flagColumn:g,conflicts:{alreadyExists:c.has(g),duplicateFlag:!1}})}),d.length>0){const f=new Map;d.forEach(g=>{f.set(g.flagColumn,(f.get(g.flagColumn)??0)+1)}),d.forEach(g=>{g.conflicts.duplicateFlag=(f.get(g.flagColumn)??0)>1})}d.sort((f,g)=>{const w=f.missingPercentage,_=g.missingPercentage,b=typeof w=="number",x=typeof _=="number";return b&&x&&w!==_?_-w:b!==x?b?-1:1:f.column.localeCompare(g.column)});const p=l?Array.from(new Set(i.filter(f=>$L(f,l)))):[],h=d.reduce((f,g)=>g.conflicts.alreadyExists||g.conflicts.duplicateFlag?f+1:f,0);return{rows:d,flaggedColumnsInDataset:p,conflictCount:h}},zL=(e,t,n,s,l)=>{var d,p;const i=v.useMemo(()=>{var h,f;return e?TL(t==null?void 0:t.flag_suffix,(f=(h=n==null?void 0:n.data)==null?void 0:h.config)==null?void 0:f.flag_suffix):""},[t==null?void 0:t.flag_suffix,e,(p=(d=n==null?void 0:n.data)==null?void 0:d.config)==null?void 0:p.flag_suffix]),c=v.useMemo(()=>e?Ve(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,e]),u=v.useMemo(()=>e?LL({selectedColumns:c,availableColumns:s,columnMissingMap:l,suffix:i}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[i,s,l,e,c]);return{activeFlagSuffix:i,missingIndicatorColumns:c,missingIndicatorInsights:u}},DL=({node:e,graphContext:t,hasReachableSource:n,sourceId:s,formatRelativeTime:l})=>{var h,f;const i=v.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="data_preview"},[(h=e==null?void 0:e.data)==null?void 0:h.catalogType]),c=v.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="dataset_profile"},[(f=e==null?void 0:e.data)==null?void 0:f.catalogType]),u=v.useMemo(()=>t?Dc(t):"",[t]),d=sM({node:e,isDatasetProfileNode:c,sourceId:s,hasReachableSource:n,graphContext:t,profilingGraphSignature:u,formatRelativeTime:l}),{profileState:p}=d;return{isPreviewNode:i,isDatasetProfileNode:c,datasetProfileController:d,profileState:p}},RL=({parameter:e,nodeId:t,configState:n,handleNumberChange:s,handleBooleanChange:l,handleTextChange:i,thresholdParameterName:c,normalizedSuggestedThreshold:u,showRecommendations:d,canApplySuggestedThreshold:p,thresholdMatchesSuggestion:h,handleApplySuggestedThreshold:f,renderMultiSelect:g})=>{var b;if(!(e!=null&&e.name))return null;if(e.type==="multi_select")return a.jsx(a.Fragment,{children:g(e)});if(e.type==="number"){const x=`node-${t}-${e.name}`,N=n==null?void 0:n[e.name],E=typeof N=="number"?N:N??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx("input",{id:x,type:"number",className:"canvas-modal__input",value:E,min:e.min!==void 0?e.min:void 0,max:e.max!==void 0?e.max:void 0,step:e.step!==void 0?e.step:"any",onChange:M=>s(e.name,M.target.value)}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),c===e.name&&u!==null&&d&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:Gn(u)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:!p,children:h?"Applied":"Apply suggestion"})]})]},e.name)}if(e.type==="boolean"){const x=`node-${t}-${e.name}`,N=!!(n!=null&&n[e.name]);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:x,children:e.label})}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:x,type:"checkbox",checked:N,onChange:E=>l(e.name,E.target.checked)}),a.jsx("span",{children:N?"Enabled":"Disabled"})]})]},e.name)}if(e.type==="select"){const x=`node-${t}-${e.name}`,N=Array.isArray(e.options)?e.options:[],E=n==null?void 0:n[e.name],M=typeof e.default=="string"?e.default:((b=N.find(C=>C&&typeof C.value=="string"))==null?void 0:b.value)??"",j=typeof E=="string"&&E.trim().length?E:M;return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("select",{id:x,className:"canvas-modal__input",value:j,onChange:C=>i(e.name,C.target.value),children:N.map(C=>a.jsx("option",{value:C.value,title:C.description??void 0,children:C.label??C.value},C.value))})]},e.name)}if(e.type==="textarea"){const x=`node-${t}-${e.name}`;if(e.name==="hyperparameters"){let E="",M=n==null?void 0:n[e.name];if(typeof M=="string"&&M.trim())try{const j=JSON.parse(M);j&&typeof j=="object"&&!Array.isArray(j)?E=Object.entries(j).map(([C,S])=>`${C}: ${JSON.stringify(S)}`).join(`
`):E=M}catch{E=M}else M&&typeof M=="object"&&!Array.isArray(M)&&(E=Object.entries(M).map(([j,C])=>`${j}: ${JSON.stringify(C)}`).join(`
`));return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description||"Enter parameters as key: value pairs (one per line)"}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:E,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:j=>{const S=j.target.value.split(`
`).filter(A=>A.trim()),$={};for(const A of S){const L=A.indexOf(":");if(L===-1)continue;const T=A.substring(0,L).trim(),P=A.substring(L+1).trim();if(T)try{$[T]=JSON.parse(P)}catch{$[T]=P}}i(e.name,JSON.stringify($,null,2))},rows:6})]},e.name)}const N=typeof(n==null?void 0:n[e.name])=="string"?n==null?void 0:n[e.name]:"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:N,placeholder:e.placeholder??"",onChange:E=>i(e.name,E.target.value),rows:4})]},e.name)}const w=`node-${t}-${e.name}`,_=(n==null?void 0:n[e.name])??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:w,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("input",{id:w,type:"text",className:"canvas-modal__input canvas-modal__input--wide",value:_,placeholder:e.placeholder??"",onChange:x=>i(e.name,x.target.value)})]},e.name)},FL=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:s,recommendations:l,filteredRecommendations:i,isFetchingRecommendations:c,recommendationsError:u,relativeGeneratedAt:d,formatSignalName:p,formatMissingPercentage:h,getPriorityClass:f,getPriorityLabel:g,handleToggleColumn:w,selectedColumns:_})=>{const b=x=>{if(!(x!=null&&x.name))return null;const N=String(x.name),E=_.includes(N),M=f(x.priority),j=g(x.priority),C=Array.isArray(x==null?void 0:x.signals)?x.signals.map(S=>p(S)).filter(S=>!!S):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:E,onChange:()=>w(N)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:N}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[x.missing_percentage!==void 0&&x.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${h(x.missing_percentage)}`}),M&&j&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${M}`,children:j})]}),C.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:C.map(S=>a.jsx("span",{className:"canvas-modal__signal-badge",children:S},`${N}-${S}`))}),x.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:x.reason})]})]},N)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>s(null),children:["All reasons (",l.length,")"]}),t.map(x=>{const N=n===x.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${N?" canvas-modal__filter-button--active":""}`,onClick:()=>s(E=>E===x.id?null:x.id),title:x.description??void 0,children:[x.label," (",x.count,")"]},x.id)})]}),c&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!c&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!c&&!u&&a.jsxs(a.Fragment,{children:[d&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",d,"."]}),i.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:i.map(x=>b(x))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},IL=({parameter:e,previewStateStatus:t,isBinningNode:n,isScalingNode:s,binningAllNumericColumns:l,binningRecommendedColumnSet:i,selectedColumns:c,availableColumns:u,scalingExcludedColumns:d,normalizedColumnSearch:p,filteredColumnOptions:h,binningExcludedColumns:f,selectionCount:g,isCastNode:w,columnSuggestions:_,sourceId:b,isFetchingRecommendations:x,hasReachableSource:N,refreshRecommendations:E,availableFilters:M,activeFilterId:j,setActiveFilterId:C,recommendations:S,filteredRecommendations:$,recommendationsError:A,relativeGeneratedAt:L,formatSignalName:T,handleToggleColumn:P,handleRemoveColumn:z,handleApplyAllRecommended:W,handleBinningApplyColumns:D,handleSelectAllColumns:R,handleClearColumns:U,columnSearch:V,setColumnSearch:B,columnMissingMap:G,columnTypeMap:q,binningColumnPreviewMap:F,isImputerNode:K,showRecommendations:se})=>{var De;const Q=((De=e==null?void 0:e.source)==null?void 0:De.type)==="drop_column_recommendations",H=!Q,Y=H&&t==="loading",X=n&&e.name==="columns",ee=s&&e.name==="columns",J=(()=>{if(!X)return[];const ce=[...l];return i.size>0&&i.forEach(Oe=>{ce.includes(Oe)||ce.push(Oe)}),c.forEach(Oe=>{Oe&&!ce.includes(Oe)&&ce.push(Oe)}),ce})(),re=X?J:ee?u.filter(ce=>!d.has(ce)):u,we=X?p?J.filter(ce=>ce.toLowerCase().includes(p)):J:ee?h.filter(ce=>!d.has(ce)):h,Pe=X?c.filter(ce=>!f.has(ce)).length:ee?c.filter(ce=>!d.has(ce)).length:g,Me=H&&re.length>0&&Pe>=re.length,Fe=Q||K,Ke=new Set(re),Ue=w&&H?Object.entries(_).filter(([ce,Oe])=>Ke.has(ce)&&Oe.length>0).map(([ce,Oe])=>`${ce}: ${Oe.join(", ")}`).slice(0,4):[],de=X?Array.from(f).slice(0,4):[],pe=ee?Array.from(d).slice(0,4):[],xe=X&&i.size>0,ke=xe?Array.from(i).some(ce=>!c.includes(ce)):!1;return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),Q&&b&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:E,disabled:x||!N,children:x?"Refreshing":"Refresh suggestions"})})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),Ue.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",Ue.join("; ")]}),X&&f.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",f.size," non-numeric column",f.size===1?"":"s",de.length?` (examples: ${de.join(", ")}${f.size>de.length?", ":""})`:""," binning only supports numeric inputs."]}),ee&&d.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",d.size," non-numeric column",d.size===1?"":"s",pe.length?` (examples: ${pe.join(", ")}${d.size>pe.length?", ":""})`:""," scaling only supports numeric inputs."]}),Q&&a.jsx(FL,{sourceId:b,availableFilters:M,activeFilterId:j,setActiveFilterId:C,recommendations:S,filteredRecommendations:$,isFetchingRecommendations:x,recommendationsError:A,relativeGeneratedAt:L,formatSignalName:T,formatMissingPercentage:Gn,getPriorityClass:iM,getPriorityLabel:cM,handleToggleColumn:P,selectedColumns:c}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:Pe})]}),Pe>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:c.map(ce=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[ce,a.jsx("button",{type:"button",onClick:()=>z(ce),"aria-label":`Remove ${ce}`,children:""})]},ce))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[Q&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:W,disabled:!S.length,children:"Use all recommendations"}),xe&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>D(i),disabled:!ke,children:"Add recommended columns"}),H&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:R,disabled:!re.length||Me,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:U,disabled:!g,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:V,onChange:ce=>B(ce.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:we.length?we.map(ce=>{const Oe=c.includes(ce),Ye=Object.prototype.hasOwnProperty.call(G,ce)?G[ce]:void 0,ct=Gn(typeof Ye=="number"?Ye:null),Je=q[ce]??null,mt=_[ce]??[],Ze=X?F[ce]:void 0,ot=!!(Ze&&(Ze.min!==null&&Ze.min!==void 0||Ze.max!==null&&Ze.max!==void 0)),Et=X?(Ze==null?void 0:Ze.distinct)??null:null,zt=X&&Et!==null&&Number.isFinite(Et),We=zt?Et:null,Dt=!X,ht=Dt||Fe||ot||zt,kt=Dt&&mt.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${Oe?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:Oe,onChange:()=>P(ce)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:ce}),ht&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Dt&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",jT(Je)]}),Fe&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",ct]}),ot&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[X?"Sample range":"Range",":"," ",Ze&&Ze.min!==null&&Ze.min!==void 0?Es(Ze.min):""," ",""," ",Ze&&Ze.max!==null&&Ze.max!==void 0?Es(Ze.max):""]}),zt&&We!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",Ys(We)]})]}),kt&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",mt.join(", ")]})]})]},ce)}):a.jsx("p",{className:"canvas-modal__note",children:u.length?X&&re.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":Y?"Loading column catalog":b?N?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},e.name)},BL=({setConfigState:e,imputationMethodValues:t,imputationMethodOptions:n,imputerStrategyCount:s,setCollapsedStrategies:l,setImputerMissingFilter:i})=>{const c=v.useCallback(b=>{e(x=>{const N=fx(x==null?void 0:x.strategies,t),E=b(N).map(M=>({...M,options:kc(M.method,M.options)}));return{...x,strategies:$M(E)}})},[t,e]),u=v.useCallback(()=>{var N;const b=s,x=((N=n[0])==null?void 0:N.value)??"mean";c(E=>[...E,{method:x,columns:[],options:kc(x,hx(x))}]),l(E=>{const M=new Set(E);return M.delete(b),M})},[n,s,c,l]),d=v.useCallback(b=>{c(x=>x.filter((N,E)=>E!==b)),l(x=>{const N=new Set;return x.forEach(E=>{E!==b&&N.add(E>b?E-1:E)}),N})},[c,l]),p=v.useCallback(b=>{l(x=>{const N=new Set(x);return N.has(b)?N.delete(b):N.add(b),N})},[l]),h=v.useCallback((b,x)=>{c(N=>N.map((E,M)=>M===b?{...E,method:x,options:kc(x,E.options)}:E))},[c]),f=v.useCallback((b,x,N)=>{c(E=>E.map((M,j)=>{if(j!==b)return M;const C={...M.options??{}};if(N==="")delete C[x];else{const S=Number(N);if(!Number.isFinite(S))return M;C[x]=S}return{...M,options:kc(M.method,C)}}))},[c]),g=v.useCallback((b,x)=>{const N=x.split(",").map(E=>E.trim()).filter(Boolean);c(E=>E.map((M,j)=>j===b?{...M,columns:N}:M))},[c]),w=v.useCallback((b,x)=>{const N=x.trim();N&&c(E=>E.map((M,j)=>{if(j!==b)return M;const S=M.columns.includes(N)?M.columns.filter($=>$!==N):[...M.columns,N];return S.sort(($,A)=>$.localeCompare(A)),{...M,columns:S}}))},[c]),_=v.useCallback(b=>{i(b)},[i]);return{updateImputerStrategies:c,handleAddImputerStrategy:u,handleRemoveImputerStrategy:d,toggleImputerStrategySection:p,handleImputerMethodChange:h,handleImputerOptionNumberChange:f,handleImputerColumnsChange:g,handleImputerColumnToggle:w,handleImputerMissingFilterChange:_}},UL=({isReplaceAliasesNode:e,node:t,setConfigState:n,setCollapsedStrategies:s,aliasColumnSummary:l,aliasStrategyCount:i})=>{var _;const c=v.useCallback(b=>{e&&n(x=>{var P,z,W,D,R,U,V,B,G;if(!e)return x;const N=Ve((x==null?void 0:x.columns)??((z=(P=t==null?void 0:t.data)==null?void 0:P.config)==null?void 0:z.columns)),E=um(x==null?void 0:x.mode,(D=(W=t==null?void 0:t.data)==null?void 0:W.config)==null?void 0:D.mode),M=(()=>{var K;const q=ni(x);if(q!==void 0){const se=Fo(q);if(se!==null)return se}const F=ni((K=t==null?void 0:t.data)==null?void 0:K.config);if(F!==void 0){const se=Fo(F);if(se!==null)return se}return N.length===0})(),j=(x==null?void 0:x.alias_strategies)??(x==null?void 0:x.strategies)??((U=(R=t==null?void 0:t.data)==null?void 0:R.config)==null?void 0:U.alias_strategies)??((B=(V=t==null?void 0:t.data)==null?void 0:V.config)==null?void 0:B.strategies),C=xx(j,{mode:E,columns:N,autoDetect:M}),S=b(C).map(q=>({mode:um(q.mode,E),columns:Array.from(new Set(q.columns.map(F=>F.trim()).filter(Boolean))).sort((F,K)=>F.localeCompare(K)),autoDetect:!!q.autoDetect})),$=tA(S),A=Array.from(new Set(S.flatMap(q=>q.columns))).sort((q,F)=>q.localeCompare(F)),L=((G=S[0])==null?void 0:G.mode)??E,T=S.length?S.some(q=>q.autoDetect):M;return{...x,alias_strategies:$,columns:A,mode:L,auto_detect:T}})},[e,(_=t==null?void 0:t.data)==null?void 0:_.config,n]),u=v.useCallback(()=>{if(!e)return;const b=i;c(x=>{var C;const N=new Set;x.forEach(S=>{S.columns.forEach($=>{const A=$.trim();A&&N.add(A)})});const E=l.recommendedColumns.find(S=>!N.has(S)),j={mode:x.length?x[x.length-1].mode:((C=yx[0])==null?void 0:C.value)??Rp,columns:E?[E]:[],autoDetect:!E};return[...x,j]}),s(x=>{const N=new Set(x);return N.delete(b),N})},[l.recommendedColumns,i,e,s,c]),d=v.useCallback(b=>{c(x=>x.filter((N,E)=>E!==b)),s(x=>{const N=new Set;return x.forEach(E=>{E!==b&&N.add(E>b?E-1:E)}),N})},[s,c]),p=v.useCallback(b=>{s(x=>{const N=new Set(x);return N.has(b)?N.delete(b):N.add(b),N})},[s]),h=v.useCallback((b,x)=>{c(N=>N.map((E,M)=>M===b?{...E,mode:x}:E))},[c]),f=v.useCallback((b,x)=>{const N=x.trim();N&&c(E=>E.map((M,j)=>{if(j!==b)return M;const S=M.columns.includes(N)?M.columns.filter($=>$!==N):[...M.columns,N];return S.sort(($,A)=>$.localeCompare(A)),{...M,columns:S}}))},[c]),g=v.useCallback((b,x)=>{const N=x.split(",").map(M=>M.trim()).filter(Boolean),E=Array.from(new Set(N)).sort((M,j)=>M.localeCompare(j));c(M=>M.map((j,C)=>C===b?{...j,columns:E}:j))},[c]),w=v.useCallback((b,x)=>{c(N=>N.map((E,M)=>M===b?{...E,autoDetect:x}:E))},[c]);return{updateAliasStrategies:c,handleAddAliasStrategy:u,handleRemoveAliasStrategy:d,toggleAliasStrategySection:p,handleAliasModeChange:h,handleAliasColumnToggle:f,handleAliasColumnsChange:g,handleAliasAutoDetectToggle:w}},qL=({isStandardizeDatesNode:e,node:t,setConfigState:n,setCollapsedStrategies:s,dateStrategies:l,standardizeDatesColumnSummary:i,standardizeDatesMode:c})=>{var b,x,N,E,M,j;const u=v.useCallback(C=>{n(S=>{var R,U,V,B,G,q,F;if(!e)return S;const $=Ve((S==null?void 0:S.columns)??((U=(R=t==null?void 0:t.data)==null?void 0:R.config)==null?void 0:U.columns)),A=Px(S==null?void 0:S.mode,(B=(V=t==null?void 0:t.data)==null?void 0:V.config)==null?void 0:B.mode),L=$.length===0,T=Tx((S==null?void 0:S.format_strategies)??((q=(G=t==null?void 0:t.data)==null?void 0:G.config)==null?void 0:q.format_strategies),{columns:$,mode:A,autoDetect:L}),P=C(T),z=kA(P),W=Array.from(new Set(P.flatMap(K=>K.columns.map(se=>se.trim()).filter(Boolean)))).sort((K,se)=>K.localeCompare(se)),D=((F=P[0])==null?void 0:F.mode)??A;return{...S,format_strategies:z,columns:W,mode:D}})},[e,(x=(b=t==null?void 0:t.data)==null?void 0:b.config)==null?void 0:x.columns,(E=(N=t==null?void 0:t.data)==null?void 0:N.config)==null?void 0:E.format_strategies,(j=(M=t==null?void 0:t.data)==null?void 0:M.config)==null?void 0:j.mode,n]),d=v.useCallback(()=>{const C=l.length;u(S=>{var P;const $=new Set;S.forEach(z=>{z.columns.forEach(W=>{const D=W.trim();D&&$.add(D)})});const A=i.recommendedColumns.find(z=>!$.has(z)),T={mode:S.length?S[S.length-1].mode:((P=Up[0])==null?void 0:P.value)??c,columns:A?[A]:[],autoDetect:!A};return[...S,T]}),s(S=>{const $=new Set(S);return $.delete(C),$})},[l.length,s,i.recommendedColumns,c,u]),p=v.useCallback(C=>{u(S=>S.filter(($,A)=>A!==C)),s(S=>{const $=new Set;return S.forEach(A=>{A!==C&&$.add(A>C?A-1:A)}),$})},[s,u]),h=v.useCallback(C=>{s(S=>{const $=new Set(S);return $.has(C)?$.delete(C):$.add(C),$})},[s]),f=v.useCallback((C,S)=>{u($=>$.map((A,L)=>L===C?{...A,mode:S}:A))},[u]),g=v.useCallback((C,S)=>{const $=S.split(",").map(A=>A.trim()).filter(Boolean).sort((A,L)=>A.localeCompare(L));u(A=>A.map((L,T)=>T===C?{...L,columns:$}:L))},[u]),w=v.useCallback((C,S)=>{const $=S.trim();$&&u(A=>A.map((L,T)=>{if(T!==C)return L;const z=L.columns.includes($)?L.columns.filter(W=>W!==$):[...L.columns,$];return z.sort((W,D)=>W.localeCompare(D)),{...L,columns:z}}))},[u]),_=v.useCallback((C,S)=>{u($=>$.map((A,L)=>L===C?{...A,autoDetect:S}:A))},[u]);return{updateDateStrategies:u,handleAddDateStrategy:d,handleRemoveDateStrategy:p,toggleDateStrategySection:h,handleDateStrategyModeChange:f,handleDateStrategyColumnsChange:g,handleDateStrategyColumnToggle:w,handleDateStrategyAutoDetectToggle:_}},HL=new Set(gm.map(e=>e.value)),Uc=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),dw=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),mw=e=>{const n=Uc(e).filter(s=>HL.has(s));return n.length?n:["year","month","day"]},qc=e=>e==null?null:Number.isFinite(e)?e:null,hw=e=>{const t=qc(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},fw=e=>typeof e!="string"?"UTC":e.trim()||"UTC",VL=({isFeatureMathNode:e,setConfigState:t,setCollapsedFeatureMath:n})=>{const s=v.useCallback(h=>{t(f=>{if(!e)return f;const g=f&&typeof f=="object"&&!Array.isArray(f)?{...f}:{},w=f0(Array.isArray(f==null?void 0:f.operations)?f.operations:[]),_=h(w);return g.operations=MP(_),g})},[e,t]),l=v.useCallback(h=>{if(!e)return;let f="";s(g=>{const w=new Set(g.map(b=>b.id)),_=p0(h,w);return f=_.id,[...g,_]}),f&&n(g=>{const w=new Set(g);return w.delete(f),w})},[e,n,s]),i=v.useCallback(h=>{if(!e)return;let f="";s(g=>{const w=g.findIndex(M=>M.id===h);if(w===-1)return g;const _=g[w],b=new Set(g.map(M=>M.id)),x=p0(_.type,b);f=x.id;const N={..._,id:x.id,inputColumns:[..._.inputColumns],secondaryColumns:[..._.secondaryColumns],constants:[..._.constants],datetimeFeatures:[..._.datetimeFeatures],outputColumn:_.outputColumn?`${_.outputColumn}_copy`:""},E=[...g];return E.splice(w+1,0,N),E}),f&&n(g=>{const w=new Set(g);return w.delete(f),w})},[e,n,s]),c=v.useCallback(h=>{e&&(s(f=>f.filter(g=>g.id!==h)),n(f=>{const g=new Set(f);return g.delete(h),g}))},[e,n,s]),u=v.useCallback((h,f)=>{e&&s(g=>{const w=g.findIndex(N=>N.id===h);if(w===-1)return g;const _=f==="up"?w-1:w+1;if(_<0||_>=g.length)return g;const b=[...g],[x]=b.splice(w,1);return b.splice(_,0,x),b})},[e,s]),d=v.useCallback(h=>{n(f=>{const g=new Set(f);return g.has(h)?g.delete(h):g.add(h),g})},[n]),p=v.useCallback((h,f)=>{e&&s(g=>g.map(w=>{if(w.id!==h)return w;let _={...w};if(f.type&&(_.type=f.type),f.method!==void 0&&(_.method=f.method),f.inputColumns!==void 0&&(_.inputColumns=Uc(f.inputColumns)),f.secondaryColumns!==void 0&&(_.secondaryColumns=Uc(f.secondaryColumns)),f.constants!==void 0&&(_.constants=dw(f.constants)),f.outputColumn!==void 0&&(_.outputColumn=f.outputColumn.trim()),f.outputPrefix!==void 0&&(_.outputPrefix=f.outputPrefix.trim()),f.datetimeFeatures!==void 0&&(_.datetimeFeatures=mw(f.datetimeFeatures)),f.timezone!==void 0&&(_.timezone=fw(f.timezone)),f.fillna!==void 0&&(_.fillna=qc(f.fillna)),f.roundDigits!==void 0&&(_.roundDigits=hw(f.roundDigits)),f.normalize!==void 0&&(_.normalize=f.normalize),f.epsilon!==void 0&&(_.epsilon=qc(f.epsilon)),f.allowOverwrite!==void 0&&(_.allowOverwrite=f.allowOverwrite),f.description!==void 0){const N=typeof f.description=="string"?f.description.trim():"";_.description=N||void 0}const b=_.type,x=g0(b);return x.length?new Set(x.map(E=>E.value)).has(_.method)||(_.method=x[0].value):b==="ratio"?_.method="ratio":b==="datetime_extract"&&(_.method="datetime_extract"),_.inputColumns=Uc(_.inputColumns),b==="ratio"||b==="similarity"?_.secondaryColumns=Uc(_.secondaryColumns):_.secondaryColumns=[],_.constants=dw(_.constants),_.fillna=qc(_.fillna),_.roundDigits=hw(_.roundDigits),_.epsilon=qc(_.epsilon),b==="datetime_extract"?(_.datetimeFeatures=mw(_.datetimeFeatures),_.timezone=fw(_.timezone)):(_.datetimeFeatures=[],_.timezone="UTC"),b!=="similarity"?_.normalize=!1:_.normalize=!!_.normalize,typeof _.allowOverwrite!="boolean"&&(_.allowOverwrite=null),_.outputColumn=_.outputColumn.trim(),_.outputPrefix=_.outputPrefix.trim(),_}))},[e,s]);return{updateFeatureMathOperations:s,handleAddFeatureMathOperation:l,handleDuplicateFeatureMathOperation:i,handleRemoveFeatureMathOperation:c,handleReorderFeatureMathOperation:u,handleToggleFeatureMathOperation:d,handleFeatureMathOperationChange:p}},WL=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:s,sourceId:l,graphSnapshot:i,onResetConfig:c,defaultConfigTemplate:u,isResetAvailable:d=!1})=>{var sc,js,wt;const{metadata:p,title:h}=o$(e),{connectionInfo:f,connectedHandleKeys:g,connectedOutputHandleKeys:w,evaluationSplitConnectivity:_,connectionReady:b,gatedSectionStyle:x,gatedAriaDisabled:N}=i$(e,i??null),E=O2(e),{catalogType:M,isDataset:j,isImputerNode:C,isMissingIndicatorNode:S,isReplaceAliasesNode:$,isTrimWhitespaceNode:A,isRemoveSpecialCharsNode:L,isReplaceInvalidValuesNode:T,isRegexCleanupNode:P,isNormalizeTextCaseNode:z,isStandardizeDatesNode:W,isLabelEncodingNode:D,isTargetEncodingNode:R,isHashEncodingNode:U,isFeatureTargetSplitNode:V,isTrainTestSplitNode:B,isTrainModelDraftNode:G,isModelEvaluationNode:q,isModelRegistryNode:F,isHyperparameterTuningNode:K,isClassUndersamplingNode:se,isClassOversamplingNode:Q,isOrdinalEncodingNode:H,isDummyEncodingNode:Y,isOneHotEncodingNode:X,isFeatureMathNode:ee,isCastNode:J,isBinningNode:re,isScalingNode:we,isPolynomialFeaturesNode:Pe,isFeatureSelectionNode:Me,isTransformerAuditNode:Fe,isOutlierNode:Ke,isSkewnessNode:Ue,isSkewnessDistributionNode:de,isBinnedDistributionNode:pe,isDataConsistencyNode:xe,isInspectionNode:ke,isRemoveDuplicatesNode:De,isDropMissingColumnsNode:ce,isDropMissingRowsNode:Oe,isDropMissingNode:Ye}=E,ct=j,Je=se||Q,mt=v.useMemo(()=>kM,[]),Ze=v.useMemo(()=>mt.map(nt=>nt.value),[mt]),{parameters:ot,getParameter:Et,requiresColumnCatalog:zt,dropColumnParameter:We}=jL(e),Dt=v.useMemo(()=>K2[M]??null,[M]),ht=typeof(e==null?void 0:e.id)=="string"?e.id:"",kt=[ee,V,B,q,U,Pe,Me,xe,G,K,Je,D,R,Y,X,H,C,S,$,A,L,T,P,z,W,J,De,Ye,Ke],{canResetNode:sn,headerCanResetNode:wn,footerCanResetNode:Mt}=CL({isResetAvailable:d,isDataset:j,defaultConfigTemplate:u,footerResetFlags:kt,isScalingNode:we,isBinningNode:re,isBinnedDistributionNode:pe,isSkewnessDistributionNode:de}),{binningColumnsParameter:rn,scalingColumnsParameter:Fn,removeDuplicatesColumnsParameter:Ut,removeDuplicatesKeepParameter:it,replaceAliasesCustomPairsParameter:In,trimWhitespaceColumnsParameter:Zt,trimWhitespaceModeParameter:gn,removeSpecialColumnsParameter:ft,removeSpecialModeParameter:Os,removeSpecialReplacementParameter:Yt,replaceInvalidColumnsParameter:gt,replaceInvalidModeParameter:xt,replaceInvalidMinValueParameter:ls,replaceInvalidMaxValueParameter:dn,regexCleanupColumnsParameter:jn,regexCleanupModeParameter:mn,regexCleanupPatternParameter:An,regexCleanupReplacementParameter:hn,normalizeCaseColumnsParameter:is,normalizeCaseModeParameter:It,labelEncodingColumnsParameter:Bn,labelEncodingAutoDetectParameter:On,labelEncodingMaxUniqueParameter:Nn,labelEncodingOutputSuffixParameter:lr,labelEncodingDropOriginalParameter:Xn,labelEncodingMissingStrategyParameter:Ps,labelEncodingMissingCodeParameter:_s,hashEncodingColumnsParameter:vs,hashEncodingAutoDetectParameter:Xs,hashEncodingMaxCategoriesParameter:Jn,hashEncodingBucketsParameter:Qt,hashEncodingOutputSuffixParameter:At,hashEncodingDropOriginalParameter:st,hashEncodingEncodeMissingParameter:ir,polynomialColumnsParameter:Un,polynomialAutoDetectParameter:Js,polynomialDegreeParameter:cs,polynomialIncludeBiasParameter:wr,polynomialInteractionOnlyParameter:le,polynomialIncludeInputFeaturesParameter:_e,polynomialOutputPrefixParameter:$e,featureSelectionColumnsParameter:Ct,featureSelectionAutoDetectParameter:je,featureSelectionTargetColumnParameter:tt,featureSelectionMethodParameter:lt,featureSelectionScoreFuncParameter:Rt,featureSelectionProblemTypeParameter:Ot,featureSelectionKParameter:an,featureSelectionPercentileParameter:qt,featureSelectionAlphaParameter:fn,featureSelectionThresholdParameter:Ts,featureSelectionModeParameter:Zn,featureSelectionEstimatorParameter:Cn,featureSelectionStepParameter:Pn,featureSelectionMinFeaturesParameter:us,featureSelectionMaxFeaturesParameter:es,featureSelectionDropUnselectedParameter:Ha,featureMathErrorHandlingParameter:tl,featureMathAllowOverwriteParameter:yt,featureMathDefaultTimezoneParameter:_i,featureMathEpsilonParameter:nl,resamplingMethodParameter:sl,resamplingTargetColumnParameter:vi,resamplingSamplingStrategyParameter:yi,resamplingRandomStateParameter:rl,resamplingKNeighborsParameter:Va,resamplingReplacementParameter:ca,featureTargetSplitTargetColumnParameter:Zs,trainModelTargetColumnParameter:Z,trainModelProblemTypeParameter:fe,trainModelModelTypeParameter:me,trainModelHyperparametersParameter:Ee,hyperparameterTuningSearchStrategyParameter:Ce,hyperparameterTuningSearchIterationsParameter:ye,hyperparameterTuningSearchRandomStateParameter:et,hyperparameterTuningScoringMetricParameter:Ie,trainModelCvEnabledParameter:ut,trainModelCvStrategyParameter:rt,trainModelCvFoldsParameter:Ge,trainModelCvShuffleParameter:Nt,trainModelCvRandomStateParameter:Tn,trainModelCvRefitStrategyParameter:Ht,targetEncodingColumnsParameter:Sn,targetEncodingTargetColumnParameter:$s,targetEncodingAutoDetectParameter:Ls,targetEncodingMaxCategoriesParameter:er,targetEncodingOutputSuffixParameter:qr,targetEncodingDropOriginalParameter:cr,targetEncodingSmoothingParameter:ts,targetEncodingEncodeMissingParameter:ys,targetEncodingHandleUnknownParameter:Wa,ordinalEncodingColumnsParameter:zs,ordinalEncodingAutoDetectParameter:Ka,ordinalEncodingMaxCategoriesParameter:ua,ordinalEncodingOutputSuffixParameter:Ya,ordinalEncodingDropOriginalParameter:Ga,ordinalEncodingEncodeMissingParameter:Qa,ordinalEncodingHandleUnknownParameter:Xa,ordinalEncodingUnknownValueParameter:$n,dummyEncodingColumnsParameter:en,dummyEncodingAutoDetectParameter:Ja,dummyEncodingMaxCategoriesParameter:da,dummyEncodingDropFirstParameter:Xc,dummyEncodingIncludeMissingParameter:al,dummyEncodingDropOriginalParameter:tn,dummyEncodingPrefixSeparatorParameter:En,oneHotEncodingColumnsParameter:ds,oneHotEncodingAutoDetectParameter:bi,oneHotEncodingMaxCategoriesParameter:Cg,oneHotEncodingDropFirstParameter:Sg,oneHotEncodingIncludeMissingParameter:Eg,oneHotEncodingDropOriginalParameter:Jc,oneHotEncodingPrefixSeparatorParameter:kg,missingIndicatorColumnsParameter:Zc,missingIndicatorSuffixParameter:eu,scalingDefaultMethodParameter:qw,scalingAutoDetectParameter:Hw,dropRowsAnyParameter:tu}=NL(Et,E),$m=c$(ot,{isBinningNode:re,isCastNode:J,isDropMissingColumnsNode:ce,isDropMissingRowsNode:Oe,isImputerNode:C,isMissingIndicatorNode:S,isReplaceAliasesNode:$,isTrimWhitespaceNode:A,isRemoveSpecialCharsNode:L,isReplaceInvalidValuesNode:T,isRegexCleanupNode:P,isNormalizeTextCaseNode:z,isStandardizeDatesNode:W,isScalingNode:we,isClassUndersamplingNode:se,isClassOversamplingNode:Q,isTrainModelDraftNode:G,isLabelEncodingNode:D,isOrdinalEncodingNode:H,isDummyEncodingNode:Y,isOneHotEncodingNode:X,isRemoveDuplicatesNode:De,isSkewnessNode:Ue,isFeatureTargetSplitNode:V}),Lm=v.useMemo(()=>xe?$m:[],[$m,xe]),zm=Ue||de,{configState:_t,setConfigState:_n,stableInitialConfig:Dm,stableCurrentConfig:Mg,nodeChangeVersion:Ag}=u$({node:e}),{handleParameterChange:Rm,handleNumberChange:Fm,handleBooleanChange:Im,handleTextChange:Bm}=d$({setConfigState:_n}),Og=v.useMemo(()=>F?_t?{..._t}:{}:null,[_t,F]),xi=v.useMemo(()=>fx(_t==null?void 0:_t.strategies,Ze),[_t==null?void 0:_t.strategies,Ze]),Pg=xi.length,Um=v.useMemo(()=>Dp(px(_t==null?void 0:_t.transformations)),[_t==null?void 0:_t.transformations]),{graphContext:ns,graphNodes:Za,graphNodeCount:Tg,upstreamNodeIds:eo,upstreamTargetColumn:nu,hasReachableSource:dt}=uL({graphSnapshot:i??null,nodeId:ht,isDataset:j}),{featureTargetSplitConfig:qm,trainTestSplitConfig:Hm,resamplingConfig:jr,trainModelDraftConfig:su,trainModelRuntimeConfig:Vm,trainModelCVConfig:Wm,filteredModelTypeOptions:ru}=H2({configState:_t,setConfigState:_n,isFeatureTargetSplitNode:V,isTrainTestSplitNode:B,isTrainModelDraftNode:G,isHyperparameterTuningNode:K,isClassResamplingNode:Je,isClassOversamplingNode:Q,isClassUndersamplingNode:se,upstreamTargetColumn:nu,nodeId:ht,modelTypeOptions:(me==null?void 0:me.options)??null}),au=v.useMemo(()=>{if(!eo.length)return{};const nt={};return eo.forEach(Pt=>{var $r;const nn=Za.find(ln=>ln&&typeof ln.id=="string"&&ln.id===Pt);if(!nn)return;const rs=(($r=nn==null?void 0:nn.data)==null?void 0:$r.config)??null;nt[Pt]=rs}),nt},[Za,eo]),ol=v.useMemo(()=>Dc({sourceId:l??null,nodeId:ht||null,config:_t,upstreamIds:eo,upstreamConfig:au}),[_t,ht,l,au,eo]),[to,$g]=v.useState(null),{cachedSchemaColumns:wi,oversamplingSchemaGuard:Lg,imputationSchemaDiagnostics:Km,skipPreview:ou}=SL({cachedPreviewSchema:to,isClassOversamplingNode:Q,resamplingTargetColumn:(jr==null?void 0:jr.targetColumn)??null,isImputerNode:C,imputerStrategies:xi}),{availableColumns:qn,setAvailableColumns:ji,columnSearch:ll,setColumnSearch:Ni,columnMissingMap:Ci,setColumnMissingMap:lu,columnTypeMap:ma,setColumnTypeMap:Ym,columnSuggestions:iu,setColumnSuggestions:Ds,imputerMissingFilter:no,setImputerMissingFilter:Gm}=pL({requiresColumnCatalog:zt,isImputerNode:C,nodeId:ht,sourceId:l,hasReachableSource:dt}),Qm=!!We,{hasDropColumnSource:Xm,availableFilters:cu,activeFilterId:Si,setActiveFilterId:Jm,recommendations:uu,filteredRecommendations:ha,formatSignalName:Ei,isFetchingRecommendations:Hr,recommendationsError:ki,recommendationsGeneratedAt:Zm,suggestedThreshold:Mi,refreshRecommendations:fa}=Bk({hasDropColumnSource:Qm,sourceId:l,nodeId:ht,graphContext:ns,hasReachableSource:dt,columnTypeMap:ma,setAvailableColumns:ji,setColumnSearch:Ni,setColumnMissingMap:lu,setColumnTypeMap:Ym,setColumnSuggestions:Ds});D2({shouldLoad:C,sourceId:l,hasReachableSource:dt,graphContext:ns,targetNodeId:(e==null?void 0:e.id)??null,setAvailableColumns:ji,setColumnMissingMap:lu});const{isFetchingLabelEncoding:du,labelEncodingError:eh,labelEncodingSuggestions:Ai,labelEncodingMetadata:th,isFetchingTargetEncoding:nh,targetEncodingError:sh,targetEncodingSuggestions:rh,targetEncodingMetadata:ah,isFetchingHashEncoding:mu,hashEncodingError:Vr,hashEncodingSuggestions:hu,hashEncodingMetadata:fu,isFetchingOrdinalEncoding:zg,ordinalEncodingError:Dg,ordinalEncodingSuggestions:il,ordinalEncodingMetadata:Rg,isFetchingDummyEncoding:oh,dummyEncodingError:lh,dummyEncodingSuggestions:Kt,dummyEncodingMetadata:pu,isFetchingOneHotEncoding:Oi,oneHotEncodingError:cl,oneHotEncodingSuggestions:ih,oneHotEncodingMetadata:gu,handleApplyLabelEncodingRecommended:ul,handleApplyTargetEncodingRecommended:Pi,handleApplyHashEncodingRecommended:so,handleApplyOrdinalEncodingRecommended:ch,handleApplyDummyEncodingRecommended:Fg,handleApplyOneHotEncodingRecommended:Ig}=D$({isLabelEncodingNode:D,isTargetEncodingNode:R,isHashEncodingNode:U,isOrdinalEncodingNode:H,isDummyEncodingNode:Y,isOneHotEncodingNode:X,sourceId:l,hasReachableSource:dt,graphContext:ns,node:e,configState:_t,setConfigState:_n,nodeChangeVersion:Ag}),[_u,Ti]=v.useState("500"),[ro,ao]=v.useState(()=>new Set);v.useEffect(()=>{ao(new Set)},[Dm]);const{isPreviewNode:dl,isDatasetProfileNode:vu,datasetProfileController:yu,profileState:Bg}=DL({node:e,graphContext:ns,hasReachableSource:dt,sourceId:l,formatRelativeTime:Qn}),{previewState:Hn,refreshPreview:uh,clearCachedPreviewSchema:dh,canTriggerPreview:bu}=hL({graphSnapshot:i??null,graphNodeCount:Tg,hasReachableSource:dt,sourceId:l,node:e,nodeId:ht,previewSignature:ol,skipPreview:ou,cachedPreviewSchema:to,setCachedPreviewSchema:$g,isPreviewNode:dl,isFeatureMathNode:ee,isPolynomialFeaturesNode:Pe,isFeatureSelectionNode:Me,isTrainTestSplitNode:B,isOutlierNode:Ke,isTransformerAuditNode:Fe}),{featureMathSignals:Nr,polynomialSignal:mh,featureSelectionSignal:pa,outlierPreviewSignal:ur,transformerAuditSignal:ml}=vL({previewState:Hn,nodeId:ht,isFeatureMathNode:ee,isPolynomialFeaturesNode:Pe,isFeatureSelectionNode:Me,isOutlierNode:Ke,isTransformerAuditNode:Fe});yL({isFeatureSelectionNode:Me,featureSelectionSignal:pa,upstreamTargetColumn:nu,setConfigState:_n});const{featureMathOperations:Cr,featureMathSummaries:xu,collapsedFeatureMath:Ug,setCollapsedFeatureMath:qg}=OL(ee,_t,Nr),{outlierData:ga,outlierError:hl,isFetchingOutliers:oo,refreshOutliers:fl}=R2({isOutlierNode:Ke,sourceId:l,hasReachableSource:dt,graphContext:ns,targetNodeId:ht||null}),{scalingData:$i,scalingError:lo,isFetchingScaling:Sr,refreshScaling:Vt}=P2({isScalingNode:we,sourceId:l,hasReachableSource:dt,graphContext:ns,targetNodeId:(e==null?void 0:e.id)??null}),{binningData:Bt,binningError:Wr,isFetchingBinning:Ln,refreshBinning:ss}=T2({isBinningNode:re,sourceId:l,hasReachableSource:dt,graphContext:ns,targetNodeId:(e==null?void 0:e.id)??null}),Rs=v.useCallback(()=>{dh(),uh(),we&&Vt(),re&&ss(),Ke&&fl()},[re,Ke,we,ss,fl,dh,uh,Vt]),{binnedDistributionData:_a,binnedDistributionError:ms,isFetchingBinnedDistribution:pl,refreshBinnedDistribution:wu}=L2({isBinnedDistributionNode:pe,sourceId:l,hasReachableSource:dt,graphContext:ns,targetNodeId:(e==null?void 0:e.id)??null,samplePreset:_u}),{skewnessData:hh,skewnessError:gl,isFetchingSkewness:ju,refreshSkewness:Er}=$2({shouldLoad:zm,sourceId:l,graphContext:ns,targetNodeId:(e==null?void 0:e.id)??null,transformations:Um}),{previewColumns:io,previewColumnStats:Nu,previewSampleRows:_l}=EL(Hn),{activeFlagSuffix:Cu,missingIndicatorInsights:Kr}=zL(S,_t,e,qn,Ci),co=!!l&&dt,uo=v.useMemo(()=>{var nt;return Ve((nt=e==null?void 0:e.data)==null?void 0:nt.columns)},[(sc=e==null?void 0:e.data)==null?void 0:sc.columns]),{aliasStrategies:Li,aliasStrategyCount:zi,aliasColumnSummary:bs,aliasCustomPairSummary:Fs,aliasSampleMap:va,aliasColumnOptions:kr,trimWhitespaceColumnSummary:Mr,trimWhitespaceSampleMap:ya,trimWhitespaceModeDetails:fh,removeSpecialColumnSummary:Su,removeSpecialSampleMap:Eu,removeSpecialModeDetails:xs,regexCleanupColumnSummary:ws,regexCleanupSampleMap:Gt,regexCleanupModeDetails:tr,regexCleanupMode:ph,regexCleanupReplacementValue:gh,normalizeCaseColumnSummary:ku,normalizeCaseSampleMap:Mu,normalizeCaseModeDetails:_h,normalizeCaseMode:Di,replaceInvalidMode:vh,replaceInvalidModeDetails:mo,replaceInvalidSampleMap:Au,replaceInvalidColumnSummary:Hg,replaceInvalidMinValue:vl,replaceInvalidMaxValue:Ri,standardizeDatesMode:yh,dateStrategies:Ou,standardizeDatesSampleMap:ho,standardizeDatesColumnSummary:Pu,dateColumnOptions:Fi}=cL({isReplaceAliasesNode:$,isTrimWhitespaceNode:A,isRemoveSpecialCharsNode:L,isRegexCleanupNode:P,isNormalizeTextCaseNode:z,isReplaceInvalidValuesNode:T,isStandardizeDatesNode:W,configState:_t,nodeConfig:((js=e==null?void 0:e.data)==null?void 0:js.config)??null,availableColumns:qn,columnTypeMap:ma,previewSampleRows:_l}),Ii=re||we||Ke,{numericExcludedColumns:ba}=U2({shouldAnalyze:Ii,availableColumns:qn,columnTypeMap:ma,previewSampleRows:_l}),{scalingConfig:Tu,scalingExcludedColumns:yl,scalingMethodDetailMap:$u,scalingMethodOptions:Lu,scalingRecommendationRows:fo,scalingSelectedCount:Is,scalingOverrideCount:xa,scalingDefaultDetail:zu,scalingDefaultLabel:bh,scalingAutoDetectEnabled:Ar,scalingHasRecommendations:Yr,scalingStatusMessage:Du,scalingOverrideExampleSummary:xh,outlierConfig:Or,outlierMethodDetailMap:Gr,outlierMethodOptions:Bi,outlierRecommendationRows:wh,outlierSelectedCount:Ui,outlierOverrideCount:jh,outlierParameterOverrideCount:bl,outlierDefaultDetail:dr,outlierDefaultLabel:xl,outlierAutoDetectEnabled:wl,outlierHasRecommendations:wa,outlierStatusMessage:Ru,outlierSampleSize:po,relativeOutlierGeneratedAt:Nh,outlierHasOverrides:Fu,outlierOverrideSummaryDisplay:Xt,binningConfig:jl,binningDefaultLabel:Iu,binningOverrideCount:Bu,binningOverrideSummary:qi,binningFieldIds:Uu,binningCustomEdgeDrafts:ja,binningCustomLabelDrafts:Jt,selectedColumns:$t,binningInsightsRecommendations:kn,binningRecommendedColumnSet:Nl,binningAllNumericColumns:Na,canApplyAllBinningNumeric:Cl,binningExcludedColumns:qu,binningColumnPreviewMap:zn,binningInsightsExcludedColumns:Hu,handleScalingDefaultMethodChange:Vu,handleScalingAutoDetectToggle:Wu,handleScalingClearOverrides:mr,handleScalingApplyAllRecommendations:Bs,handleScalingOverrideSelect:Sl,handleOutlierDefaultMethodChange:Ku,handleOutlierAutoDetectToggle:Yu,handleOutlierClearOverrides:Ch,handleOutlierApplyAllRecommendations:Sh,handleOutlierOverrideSelect:Eh,handleOutlierMethodParameterChange:kh,handleOutlierColumnParameterChange:Mh,handleBinningIntegerChange:Ah,handleBinningBooleanToggle:Oh,handleBinningSuffixChange:Ph,handleBinningLabelFormatChange:El,handleBinningMissingStrategyChange:Th,handleBinningMissingLabelChange:Hi,handleBinningCustomBinsChange:Vi,handleBinningCustomLabelsChange:$h,handleBinningClearCustomColumn:Gu,handleBinningOverrideStrategyChange:Lh,handleBinningOverrideNumberChange:zh,handleBinningOverrideKbinsEncodeChange:Dh,handleBinningOverrideKbinsStrategyChange:Rh,handleBinningClearOverride:Qu,handleBinningClearOverrides:Fh,handleBinningApplyStrategies:Ih,handleBinningApplyColumns:Xu,handleApplyAllBinningNumeric:Vg}=J$({isScalingNode:we,isOutlierNode:Ke,isBinningNode:re,configState:_t,setConfigState:_n,nodeId:ht,numericExcludedColumns:ba,scalingData:$i,outlierData:ga,binningData:Bt,availableColumns:qn,previewSampleRows:_l});gL({previewState:Hn,previewSampleRows:_l,activeFlagSuffix:Cu??"",setColumnTypeMap:Ym,setColumnSuggestions:Ds}),_L({previewState:Hn,activeFlagSuffix:Cu??"",hasReachableSource:dt,requiresColumnCatalog:zt,nodeColumns:uo,selectedColumns:$t,setAvailableColumns:ji,setColumnMissingMap:lu});const Bh=`${ht||"node"}-remove-duplicates-keep`,Wg=v.useMemo(()=>{const nt=typeof(_t==null?void 0:_t.keep)=="string"?_t.keep.trim().toLowerCase():"";return nt==="last"||nt==="none"?nt:qk},[_t==null?void 0:_t.keep]),kl=v.useMemo(()=>ll.trim().toLowerCase(),[ll]),Ju=v.useMemo(()=>kl?qn.filter(nt=>nt.toLowerCase().includes(kl)):qn,[qn,kl]),Uh=v.useCallback(nt=>{_n(Pt=>{const nn=Dp(px(Pt==null?void 0:Pt.transformations)),rs=Dp(nt(nn));return{...Pt,transformations:rs.map($r=>({...$r}))}})},[]),{skewnessThreshold:Zu,skewnessViewMode:Wi,setSkewnessViewMode:Kg,skewnessGroupByMethod:Yg,setSkewnessGroupByMethod:Gg,skewnessDistributionView:nr,setSkewnessDistributionView:ed,skewnessRecommendedCount:Ki,skewnessNumericCount:qh,skewnessTransformationsCount:Hh,hasSkewnessAutoRecommendations:Vh,skewnessRows:td,skewnessTableGroups:go,skewnessDistributionCards:nd,getSkewnessMethodLabel:sd,getSkewnessMethodStatus:Qg,applySkewnessRecommendations:Wh,handleSkewnessOverrideChange:Kh,clearSkewnessTransformations:Yh}=W2({skewnessData:hh,shouldLoadInsights:zm,skewnessTransformations:Um,availableColumns:qn,previewColumns:io,columnTypeMap:ma,updateSkewnessTransformations:Uh}),{imputerColumnOptions:Gh,imputerMissingSliderMax:Qh,imputerFilteredOptionCount:Xg,imputerMissingFilterActive:hs}=q2({isImputerNode:C,imputerStrategies:xi,availableColumns:qn,columnMissingMap:Ci,previewColumns:io,previewColumnStats:Nu,nodeColumns:(wt=e==null?void 0:e.data)==null?void 0:wt.columns,imputerMissingFilter:no}),on=Et("missing_threshold"),Yi=(on==null?void 0:on.name)??null,{normalizedSuggestedThreshold:rd,thresholdMatchesSuggestion:ad,canApplySuggestedThreshold:od,handleApplySuggestedThreshold:ld}=AL({suggestedThreshold:Mi,thresholdParameterName:Yi,configState:_t,handleParameterChange:Rm}),id=Oe&&!!(on||tu),{handleToggleColumn:Pr,handleApplyAllRecommended:Gi,handleSelectAllColumns:cd,handleClearColumns:ud,handleRemoveColumn:Qi}=bL({isBinningNode:re,isScalingNode:we,setConfigState:_n,binningExcludedColumns:qu,scalingExcludedColumns:yl,availableColumns:qn,recommendations:uu}),{handleSave:Ml,handleResetNode:dd}=xL({configState:_t,isBinningNode:re,isScalingNode:we,nodeId:ht,onUpdateConfig:n,onClose:t,sourceId:l,graphSnapshot:i??null,isInspectionNode:ke,onUpdateNodeData:s,setConfigState:_n,canResetNode:sn,defaultConfigTemplate:u,onResetConfig:c}),Xi=$t.length,{relativeGeneratedAt:Al,relativeScalingGeneratedAt:Jg,relativeBinningGeneratedAt:Xh,relativeBinnedGeneratedAt:md,scalingSampleSize:Jh,binningSampleSize:Ji,binnedSampleSize:Tr}=ML({recommendationsGeneratedAt:Zm,scalingData:$i,binningData:Bt,binnedDistributionData:_a}),Zi=Xm&&!!l&&dt,hd=!ct&&!ke,fd=hd&&Dm!==Mg,Zh=Bg.status==="loading",ef=Hn.status==="loading",{hasActiveAsyncWork:Ol,footerBusyLabel:Vn}=kL({isProfileLoading:Zh,isPreviewLoading:ef,isFetchingScaling:Sr,isFetchingBinning:Ln,isFetchingHashEncoding:mu,isFetchingBinnedDistribution:pl,isFetchingRecommendations:Hr,isPreviewNode:dl}),{handleAddImputerStrategy:Zg,handleRemoveImputerStrategy:e_,toggleImputerStrategySection:ec,handleImputerMethodChange:Wn,handleImputerOptionNumberChange:t_,handleImputerColumnsChange:ze,handleImputerColumnToggle:_o,handleImputerMissingFilterChange:pd}=BL({setConfigState:_n,imputationMethodValues:Ze,imputationMethodOptions:mt,imputerStrategyCount:Pg,setCollapsedStrategies:ao,setImputerMissingFilter:Gm}),{handleAddAliasStrategy:tf,handleRemoveAliasStrategy:n_,toggleAliasStrategySection:Pl,handleAliasModeChange:tc,handleAliasColumnToggle:gd,handleAliasColumnsChange:nf,handleAliasAutoDetectToggle:sf}=UL({isReplaceAliasesNode:$,node:e,setConfigState:_n,setCollapsedStrategies:ao,aliasColumnSummary:bs,aliasStrategyCount:zi}),{handleAddDateStrategy:rf,handleRemoveDateStrategy:_d,toggleDateStrategySection:vd,handleDateStrategyModeChange:Dn,handleDateStrategyColumnsChange:sr,handleDateStrategyColumnToggle:Qr,handleDateStrategyAutoDetectToggle:af}=qL({isStandardizeDatesNode:W,node:e,setConfigState:_n,setCollapsedStrategies:ao,dateStrategies:Ou,standardizeDatesColumnSummary:Pu,standardizeDatesMode:yh}),{handleAddFeatureMathOperation:of,handleDuplicateFeatureMathOperation:rr,handleRemoveFeatureMathOperation:lf,handleReorderFeatureMathOperation:hr,handleToggleFeatureMathOperation:s_,handleFeatureMathOperationChange:cf}=VL({isFeatureMathNode:ee,setConfigState:_n,setCollapsedFeatureMath:qg}),uf=v.useCallback(()=>{l&&wu()},[wu,l]),df=z2(pe,_a),fr=v.useCallback(nt=>a.jsx(IL,{parameter:nt,previewStateStatus:Hn.status,isBinningNode:re,isScalingNode:we,binningAllNumericColumns:Na,binningRecommendedColumnSet:Nl,selectedColumns:$t,availableColumns:qn,scalingExcludedColumns:yl,normalizedColumnSearch:kl,filteredColumnOptions:Ju,binningExcludedColumns:qu,selectionCount:Xi,isCastNode:J,columnSuggestions:iu,sourceId:l,isFetchingRecommendations:Hr,hasReachableSource:dt,refreshRecommendations:fa,availableFilters:cu,activeFilterId:Si,setActiveFilterId:Jm,recommendations:uu,filteredRecommendations:ha,recommendationsError:ki,relativeGeneratedAt:Al,formatSignalName:Ei,handleToggleColumn:Pr,handleRemoveColumn:Qi,handleApplyAllRecommended:Gi,handleBinningApplyColumns:Xu,handleSelectAllColumns:cd,handleClearColumns:ud,columnSearch:ll,setColumnSearch:Ni,columnMissingMap:Ci,columnTypeMap:ma,binningColumnPreviewMap:zn,isImputerNode:C,showRecommendations:Zi}),[Si,qn,cu,Ci,ll,iu,ma,Na,ba,Ju,ha,Ei,Gi,Xu,ud,Qi,cd,Pr,dt,J,Hr,re,Nl,zn,C,we,qu,Hn.status,uu,ki,Al,$t,Xi,Jm,Ni,yl,Zi,l,fa,kl]),Ft=v.useCallback(nt=>a.jsx(RL,{parameter:nt,nodeId:e.id,configState:_t,handleNumberChange:Fm,handleBooleanChange:Im,handleTextChange:Bm,thresholdParameterName:Yi,normalizedSuggestedThreshold:rd,showRecommendations:Zi,canApplySuggestedThreshold:od,thresholdMatchesSuggestion:ad,handleApplySuggestedThreshold:ld,renderMultiSelect:fr}),[od,_t,ld,Im,Fm,Bm,e.id,rd,fr,Zi,ad,Yi]),nc=v.useCallback(nt=>{_n(Pt=>({...Pt,keep:nt}))},[_n]);return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(oM,{title:h,isDataset:ct,onClose:t,canResetNode:wn,onResetNode:dd}),a.jsxs("div",{className:"canvas-modal__body",children:[f&&a.jsx(l$,{connectionInfo:f,connectedInputHandles:g,connectedOutputHandles:w,connectionReady:b}),id&&a.jsx(Uk,{thresholdParameter:on??null,dropIfAnyParameter:tu,renderParameterField:Ft}),We&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),on&&Ft(on),fr(We)]}),S&&a.jsxs(a.Fragment,{children:[a.jsx(VM,{suffix:Cu,insights:Kr,formatMissingPercentage:Gn}),(Zc||eu)&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[Zc?Ft(Zc):null,eu?Ft(eu):null]})]})]}),dl&&a.jsx(nM,{previewState:Hn,datasetSourceId:l??null,canTriggerPreview:bu,onRefresh:Rs,formatCellValue:k0,formatMetricValue:Ys,formatMissingPercentage:Gn,formatNumericStat:Es,formatModeStat:ix}),a.jsx(rM,{isDatasetProfileNode:vu,controller:yu,formatCellValue:k0,formatNumericStat:Es,formatMissingPercentage:Gn}),Dt&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",children:[a.jsxs("strong",{children:[Dt.title,"."]})," ",Dt.body]})}),A&&a.jsx(XA,{sourceId:l,hasReachableSource:dt,columnsParameter:Zt,modeParameter:gn,renderMultiSelectField:fr,renderParameterField:Ft,columnSummary:Mr,modeDetails:fh,sampleMap:ya}),L&&a.jsx(gO,{sourceId:l,hasReachableSource:dt,columnsParameter:ft,modeParameter:Os,replacementParameter:Yt,renderMultiSelectField:fr,renderParameterField:Ft,columnSummary:Su,modeDetails:xs,sampleMap:Eu}),T&&a.jsx(xP,{sourceId:l,hasReachableSource:dt,columnsParameter:gt,modeParameter:xt,minValueParameter:ls,maxValueParameter:dn,renderMultiSelectField:fr,renderParameterField:Ft,columnSummary:Hg,modeDetails:mo,sampleMap:Au,selectedMode:vh,minValue:vl,maxValue:Ri}),P&&a.jsx(XO,{sourceId:l,hasReachableSource:dt,columnsParameter:jn,modeParameter:mn,patternParameter:An,replacementParameter:hn,renderMultiSelectField:fr,renderParameterField:Ft,columnSummary:ws,modeDetails:tr,sampleMap:Gt,selectedMode:ph,replacementValue:gh}),z&&a.jsx(TO,{sourceId:l,hasReachableSource:dt,columnsParameter:is,modeParameter:It,renderMultiSelectField:fr,renderParameterField:Ft,columnSummary:ku,modeDetails:_h,sampleMap:Mu,selectedMode:Di}),ee&&a.jsx(IP,{operations:Cr,summaries:xu,collapsed:Ug,onToggleCollapsed:s_,onAddOperation:of,onDuplicateOperation:rr,onRemoveOperation:lf,onReorderOperation:hr,onOperationChange:cf,availableColumns:qn,signals:Nr,previewStatus:Hn.status,errorHandlingParameter:tl,allowOverwriteParameter:yt,defaultTimezoneParameter:_i,epsilonParameter:nl,renderParameterField:Ft}),H&&a.jsx(tT,{sourceId:l,hasReachableSource:dt,isFetching:zg,error:Dg,suggestions:il,metadata:Rg,columnsParameter:zs,autoDetectParameter:Ka,maxCategoriesParameter:ua,outputSuffixParameter:Ya,dropOriginalParameter:Ga,encodeMissingParameter:Qa,handleUnknownParameter:Xa,unknownValueParameter:$n,selectedColumns:$t,renderParameterField:Ft,onToggleColumn:Pr,onApplyRecommended:ch,formatMissingPercentage:Gn}),R&&a.jsx(WP,{sourceId:l,hasReachableSource:dt,isFetching:nh,error:sh,suggestions:rh,metadata:ah,columnsParameter:Sn,targetColumnParameter:$s,autoDetectParameter:Ls,maxCategoriesParameter:er,outputSuffixParameter:qr,dropOriginalParameter:cr,smoothingParameter:ts,encodeMissingParameter:ys,handleUnknownParameter:Wa,selectedColumns:$t,renderParameterField:Ft,onToggleColumn:Pr,onApplyRecommended:Pi,formatMissingPercentage:Gn}),Y&&a.jsx(rT,{sourceId:l,hasReachableSource:dt,isFetching:oh,error:lh,suggestions:Kt,metadata:pu,columnsParameter:en,autoDetectParameter:Ja,maxCategoriesParameter:da,dropFirstParameter:Xc,includeMissingParameter:al,dropOriginalParameter:tn,prefixSeparatorParameter:En,selectedColumns:$t,renderParameterField:Ft,onToggleColumn:Pr,onApplyRecommended:Fg,formatMissingPercentage:Gn}),X&&a.jsx(lT,{sourceId:l,hasReachableSource:dt,isFetching:Oi,error:cl,suggestions:ih,metadata:gu,columnsParameter:ds,autoDetectParameter:bi,maxCategoriesParameter:Cg,dropFirstParameter:Sg,includeMissingParameter:Eg,dropOriginalParameter:Jc,prefixSeparatorParameter:kg,selectedColumns:$t,renderParameterField:Ft,onToggleColumn:Pr,onApplyRecommended:Ig,formatMissingPercentage:Gn}),V&&a.jsx(pT,{nodeId:ht,sourceId:l,hasReachableSource:dt,previewState:Hn,onRefreshPreview:Rs,config:qm,targetColumnParameter:Zs,renderParameterField:Ft,formatMetricValue:Ys,formatMissingPercentage:Gn}),B&&a.jsx(_T,{nodeId:ht,sourceId:l,hasReachableSource:dt,previewState:Hn,onRefreshPreview:Rs,config:Hm,parameters:ot,renderParameterField:Ft,formatMetricValue:Ys}),Je&&a.jsx(E2,{mode:Q?"oversampling":"undersampling",sourceId:l,hasReachableSource:dt,previewState:Hn,onRefreshPreview:Rs,config:jr,methodParameter:sl,targetColumnParameter:vi,samplingStrategyParameter:yi,randomStateParameter:rl,kNeighborsParameter:Q?Va:null,replacementParameter:se?ca:null,renderParameterField:Ft,formatMetricValue:Ys,formatMissingPercentage:Gn,schemaGuard:Lg}),(G||K)&&a.jsx(wT,{sourceId:l,hasReachableSource:dt,previewState:Hn,onRefreshPreview:Rs,config:su,targetColumnParameter:Z,problemTypeParameter:fe,renderParameterField:Ft,formatMetricValue:Ys,formatMissingPercentage:Gn,schemaColumns:wi}),G&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(FT,{nodeId:ht,sourceId:l,graph:ns,config:su,runtimeConfig:Vm,cvConfig:Wm,draftConfigState:_t,renderParameterField:Ft,modelTypeParameter:me,modelTypeOptions:ru,hyperparametersParameter:Ee,cvEnabledParameter:ut,cvStrategyParameter:rt,cvFoldsParameter:Ge,cvShuffleParameter:Nt,cvRandomStateParameter:Tn,cvRefitStrategyParameter:Ht,onSaveDraftConfig:Ml})}),q&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(YT,{nodeId:ht,sourceId:l,graph:ns,config:_t,setConfigState:_n,renderParameterField:Ft,formatMetricValue:Ys,connectedSplitHandles:_})}),F&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(m2,{nodeId:ht,sourceId:l,graph:ns,parameters:ot,config:Og,renderParameterField:Ft})}),K&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(j2,{nodeId:ht,sourceId:l,graph:ns,config:su,runtimeConfig:Vm,cvConfig:Wm,draftConfigState:_t,renderParameterField:Ft,modelTypeParameter:me,modelTypeOptions:ru,searchStrategyParameter:Ce,searchIterationsParameter:ye,searchRandomStateParameter:et,scoringMetricParameter:Ie,setDraftConfigState:_n,onSaveDraftConfig:Ml})}),D&&a.jsx(qP,{sourceId:l,hasReachableSource:dt,isFetching:du,error:eh,suggestions:Ai,metadata:th,columnsParameter:Bn,autoDetectParameter:On,maxUniqueParameter:Nn,outputSuffixParameter:lr,dropOriginalParameter:Xn,missingStrategyParameter:Ps,missingCodeParameter:_s,selectedColumns:$t,renderParameterField:Ft,onToggleColumn:Pr,onApplyRecommended:ul,formatMissingPercentage:Gn}),U&&a.jsx(GP,{sourceId:l,hasReachableSource:dt,isFetching:mu,error:Vr,suggestions:hu,metadata:fu,columnsParameter:vs,autoDetectParameter:Xs,maxCategoriesParameter:Jn,bucketsParameter:Qt,outputSuffixParameter:At,dropOriginalParameter:st,encodeMissingParameter:ir,selectedColumns:$t,renderParameterField:Ft,onToggleColumn:Pr,onApplyRecommended:so,formatMissingPercentage:Gn}),Pe&&a.jsx(QP,{columnsParameter:Un,autoDetectParameter:Js,degreeParameter:cs,includeBiasParameter:wr,interactionOnlyParameter:le,includeInputFeaturesParameter:_e,outputPrefixParameter:$e,renderParameterField:Ft,signal:mh}),Me&&a.jsx(JP,{columnsParameter:Ct,autoDetectParameter:je,targetColumnParameter:tt,methodParameter:lt,scoreFuncParameter:Rt,problemTypeParameter:Ot,kParameter:an,percentileParameter:qt,alphaParameter:fn,thresholdParameter:Ts,modeParameter:Zn,estimatorParameter:Cn,stepParameter:Pn,minFeaturesParameter:us,maxFeaturesParameter:es,dropUnselectedParameter:Ha,renderParameterField:Ft,signal:pa}),W&&a.jsx(TA,{hasSource:!!l,hasReachableSource:dt,strategies:Ou,columnSummary:Pu,columnOptions:Fi,sampleMap:ho,collapsedStrategies:ro,onToggleStrategy:vd,onRemoveStrategy:_d,onAddStrategy:rf,onModeChange:Dn,onColumnToggle:Qr,onColumnsChange:sr,onAutoDetectToggle:af,modeOptions:Up}),$&&a.jsx(vA,{hasSource:!!l,hasReachableSource:dt,strategies:Li,columnSummary:bs,columnOptions:kr,sampleMap:va,customPairSummary:Fs,customPairsParameter:In,collapsedStrategies:ro,onToggleStrategy:Pl,onRemoveStrategy:n_,onAddStrategy:tf,onModeChange:tc,onAutoDetectToggle:sf,onColumnToggle:gd,onColumnsChange:nf,renderParameterField:Ft}),C&&a.jsx(LM,{hasSource:!!l,hasReachableSource:dt,strategies:xi,columnOptions:Gh,methodOptions:mt,missingFilter:no,missingFilterMax:Qh,missingFilterActive:hs,filteredOptionCount:Xg,collapsedStrategies:ro,onToggleStrategy:ec,onRemoveStrategy:e_,onAddStrategy:Zg,onMethodChange:Wn,onOptionNumberChange:t_,onColumnsChange:ze,onColumnToggle:_o,onMissingFilterChange:pd,formatMissingPercentage:Gn,formatNumericStat:Es,formatModeStat:ix,schemaDiagnostics:Km}),J&&a.jsx(Kk,{configState:_t,setConfigState:_n,availableColumns:qn,columnTypeMap:ma,columnSuggestions:iu,selectedColumns:$t,previewColumns:io,previewStatus:Hn.status,sourceId:l,hasReachableSource:dt}),Ke&&a.jsx(a$,{sourceId:l,hasReachableSource:dt,isFetchingOutliers:oo,outlierConfig:Or,outlierMethodOptions:Bi,outlierMethodDetailMap:Gr,outlierDefaultDetail:dr,outlierAutoDetectEnabled:wl,outlierSelectedCount:Ui,outlierDefaultLabel:xl,outlierOverrideCount:jh,outlierParameterOverrideCount:bl,outlierOverrideExampleSummary:Xt,outlierHasOverrides:Fu,outlierRecommendationRows:wh,outlierHasRecommendations:wa,outlierStatusMessage:Ru,outlierError:hl,outlierSampleSize:po,relativeOutlierGeneratedAt:Nh,outlierPreviewSignal:ur,formatMetricValue:Ys,formatNumericStat:Es,onApplyAllRecommendations:Sh,onClearOverrides:Ch,onDefaultMethodChange:Ku,onAutoDetectToggle:Yu,onOverrideSelect:Eh,onMethodParameterChange:kh,onColumnParameterChange:Mh}),we&&a.jsx(zM,{sourceId:l,hasReachableSource:dt,isFetchingScaling:Sr,scalingConfig:Tu,scalingMethodOptions:Lu,scalingMethodDetailMap:$u,scalingDefaultDetail:zu,scalingAutoDetectEnabled:Ar,scalingSelectedCount:Is,scalingDefaultLabel:bh,scalingOverrideCount:xa,scalingOverrideExampleSummary:xh,scalingRecommendationRows:fo,scalingHasRecommendations:Yr,scalingStatusMessage:Du,scalingError:lo,scalingSampleSize:Jh,relativeScalingGeneratedAt:Jg,formatMetricValue:Ys,formatNumericStat:Es,formatMissingPercentage:Gn,onApplyAllRecommendations:Bs,onClearOverrides:mr,onDefaultMethodChange:Vu,onAutoDetectToggle:Wu,onOverrideSelect:Sl}),re&&a.jsxs(a.Fragment,{children:[a.jsx(NM,{hasSource:!!l,hasReachableSource:dt,isFetching:Ln,error:Wr,relativeGeneratedAt:Xh,sampleSize:Ji,binningConfig:jl,binningDefaultLabel:Iu,binningOverrideCount:Bu,binningOverrideSummary:qi,recommendations:kn,excludedColumns:Hu,numericColumnCount:Na.length,canApplyAllNumeric:Cl,onApplyAllNumeric:Vg,onApplyStrategies:Ih,onClearOverrides:Fh,customEdgeDrafts:ja,customLabelDrafts:Jt,onOverrideStrategyChange:Lh,onOverrideNumberChange:zh,onOverrideKbinsEncodeChange:Dh,onOverrideKbinsStrategyChange:Rh,onOverrideClear:Qu,onCustomBinsChange:Vi,onCustomLabelsChange:$h,onClearCustomColumn:Gu,formatMetricValue:Ys,formatNumericStat:Es}),a.jsx(xM,{config:jl,fieldIds:Uu,onIntegerChange:Ah,onBooleanToggle:Oh,onSuffixChange:Ph,onLabelFormatChange:El,onMissingStrategyChange:Th,onMissingLabelChange:Hi})]}),Ue&&a.jsx(UM,{sourceId:l,hasReachableSource:dt,isFetchingSkewness:ju,skewnessThreshold:Zu,skewnessError:gl,skewnessViewMode:Wi,skewnessRecommendedCount:Ki,skewnessNumericCount:qh,skewnessGroupByMethod:Yg,skewnessRows:td,skewnessTableGroups:go,hasSkewnessAutoRecommendations:Vh,skewnessTransformationsCount:Hh,isFetchingRecommendations:Hr,getSkewnessMethodLabel:sd,getSkewnessMethodStatus:Qg,onApplyRecommendations:Wh,onViewModeChange:Kg,onGroupByToggle:Gg,onOverrideChange:Kh,onClearSelections:Yh}),de&&a.jsx(HM,{skewnessThreshold:Zu,isFetchingSkewness:ju,skewnessError:gl,skewnessDistributionCards:nd,skewnessDistributionView:nr,setSkewnessDistributionView:ed,onRefresh:Er,canRefresh:co}),pe&&a.jsx(CM,{cards:df,selectedPreset:_u,onSelectPreset:nt=>Ti(nt),isFetching:pl,sampleSize:Tr,relativeGeneratedAt:md,error:ms,onRefresh:uf,canRefresh:!!l}),De&&a.jsx(Vk,{sourceId:l,hasReachableSource:dt,removeDuplicatesColumnsParameter:Ut,removeDuplicatesKeepParameter:it,renderMultiSelectField:fr,removeDuplicatesKeepSelectId:Bh,removeDuplicatesKeep:Wg,onKeepChange:nc}),xe&&Lm.length>0&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Data consistency settings"})}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Lm.map(nt=>Ft(nt))})]}),Fe&&a.jsx(mT,{signal:ml,previewStatus:Hn.status,hasSource:!!l,hasReachableSource:dt,onRefreshPreview:Rs}),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("h3",{children:"Node details"}),p.length?a.jsx("dl",{className:"canvas-modal__metadata",children:p.map((nt,Pt)=>a.jsxs("div",{className:"canvas-modal__metadata-row",children:[a.jsx("dt",{children:nt.label}),a.jsx("dd",{children:nt.value})]},`${nt.label}-${Pt}`))}):a.jsx("p",{className:"canvas-modal__empty",children:"No metadata available for this node."})]})]}),a.jsx(lM,{onClose:t,canResetNode:Mt,onResetNode:dd,showSaveButton:hd,canSave:fd,onSave:Ml,isBusy:Ol,busyLabel:Vn})]})]})},pw=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],na=pw.map(e=>e.key),KL=pw.reduce((e,t)=>({...e,[t.key]:t.label}),{}),YL=e=>typeof e=="string"&&na.includes(e),sa=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{YL(n)&&t.add(n)}),na.filter(n=>t.has(n))},gw=(e,t)=>{const n=sa(e),s=sa(t);return n.length!==s.length?!1:n.every((l,i)=>l===s[i])},_w=e=>!e||typeof e!="string"?null:na.find(t=>e.endsWith(`-${t}`))??null,vw=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},GL={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},Hc={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"train-in",label:"Train Split",position:20,required:!1,accepts:["train"]},{key:"test-in",label:"Test Split",position:40,required:!1,accepts:["test"]},{key:"validation-in",label:"Validation Split",position:60,required:!1,accepts:["validation"]},{key:"models-in",label:"Model",position:80,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},yw=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:vw(t,n),QL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,XL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,bw=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},xw=28,ww=320,JL=170,jw="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",Nw="Drop columns",Cw=new Set(["transformer_audit"]),ZL=e=>({width:`${xw}px`,height:`${xw}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),ez=({id:e,data:t,selected:n})=>{var j;const s=(t==null?void 0:t.label)??e,l=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),i=(t==null?void 0:t.isRemovable)??!l,c=(t==null?void 0:t.catalogType)==="train_test_split",u=l?"Primary dataset input":void 0,d=(t==null?void 0:t.description)??u,h=(t==null?void 0:t.catalogType)==="drop_missing_columns"||d===jw?Nw:d,f=(t==null?void 0:t.backgroundExecutionStatus)??"idle",w=!((t==null?void 0:t.hasRequiredConnections)??!0),_=(t==null?void 0:t.catalogType)??"",b=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(_),x=v.useCallback(C=>{var S;C.stopPropagation(),(S=t==null?void 0:t.onRemoveNode)==null||S.call(t,e)},[t,e]),N=v.useMemo(()=>{if(l)return[];const C=(t==null?void 0:t.catalogType)??"",S=C?Hc[C]:void 0;if(S!=null&&S.inputs&&S.inputs.length){const $=S.inputs.length;return S.inputs.map((A,L)=>({position:Ae.Left,id:`${e}-${A.key}`,label:QL(A),style:{top:yw(A,L,$)}}))}return[{position:Ae.Left,id:`${e}-target`},{position:Ae.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,l]),E=v.useMemo(()=>{if(l)return[{position:Ae.Left,id:`${e}-source-left`},{position:Ae.Right,id:`${e}-source`},{position:Ae.Top,id:`${e}-source-top`},{position:Ae.Bottom,id:`${e}-source-bottom`}];const C=(t==null?void 0:t.catalogType)??"",S=C?Hc[C]:void 0;if(S!=null&&S.outputs&&S.outputs.length){const L=S.outputs.length;return S.outputs.map((T,P)=>({position:Ae.Right,id:`${e}-${T.key}`,label:T.label,style:{top:yw(T,P,L)}}))}const $=c?na:sa((t==null?void 0:t.activeSplits)??[]),A=sa((t==null?void 0:t.connectedSplits)??[]);if($.length){const L=$.length;return $.map((T,P)=>({position:Ae.Right,id:`${e}-${T}`,style:{top:vw(P,L)},label:(()=>{var W;const z=KL[T];if(c){if(T==="validation"&&!(Number(((W=t==null?void 0:t.config)==null?void 0:W.validation_size)??0)>0))return`${z} (disabled)`;if(!A.includes(T))return`${z} (not set)`}return z})()}))}return[{position:Ae.Right,id:`${e}-source`},{position:Ae.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(j=t==null?void 0:t.config)==null?void 0:j.validation_size,e,l,c]),M=v.useCallback((C,S)=>{const{position:$,id:A,style:L,label:T}=C,P=A.includes("-train")||A.includes("-test")||A.includes("-validation");return a.jsxs(ge.Fragment,{children:[a.jsx(wc,{type:S,position:$,id:A,className:`feature-node__handle feature-node__handle--${S}`,style:{...ZL(S),...L??{},...P?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),T&&S==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(L==null?void 0:L.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:T}),T&&S==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(L==null?void 0:L.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:T})]},A)},[]);return a.jsxs("div",{className:`feature-node${n?" feature-node--selected":""}${l?" feature-node--dataset":""}`,children:[N.map(C=>M(C,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:s})]}),a.jsxs("div",{className:"feature-node__controls",children:[w&&b&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)"},children:""}),f==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:"Loading full dataset in background...",children:a.jsx("svg",{className:"feature-node__spinner",viewBox:"0 0 24 24",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60",strokeDashoffset:"30",strokeLinecap:"round"})})}),f==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",children:""}),f==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",children:"!"}),i&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:x,title:"Remove node",children:""})]})]}),h&&a.jsx("p",{className:"feature-node__description",children:h}),E.map(C=>M(C,"source"))]})},Vo="__pending_confirmation__",tz=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],nz=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],Mm=e=>e&&typeof e=="object"&&!Array.isArray(e),Vc=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},Am=e=>typeof e=="string"&&Cw.has(e),Om=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",s=!Cw.has(n),l=c=>(s?c[Vo]=!0:delete c[Vo],c);if(t==null)return l({});const i=Vc(t);if(!Mm(i))return l(i&&typeof i=="object"?i:{});switch(Object.entries(i).forEach(([c,u])=>{Array.isArray(u)?tz.some(p=>p.test(c))&&(i[c]=[]):Mm(u)&&nz.some(p=>p.test(c))&&(i[c]={})}),"auto_detect"in i&&(i.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.column_methods=Mm(i.column_methods)?i.column_methods:{},i.skipped_columns=Array.isArray(i.skipped_columns)?i.skipped_columns:[],i.default_method=typeof i.default_method=="string"&&i.default_method.trim()?i.default_method:"standard";break;case"polynomial_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.auto_detect=!!i.auto_detect,i.include_bias=!!i.include_bias,i.interaction_only=!!i.interaction_only,i.include_input_features=!!i.include_input_features,i.degree=typeof i.degree=="number"&&Number.isFinite(i.degree)?i.degree:2,i.output_prefix=typeof i.output_prefix=="string"&&i.output_prefix.trim()?i.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in i&&(i.missing_threshold=null),i.columns=Array.isArray(i.columns)?i.columns:[];break;case"drop_missing_rows":"missing_threshold"in i&&(i.missing_threshold=null),"drop_if_any_missing"in i&&(i.drop_if_any_missing=!1);break;case"outlier_removal":i.method="manual",i.columns=Array.isArray(i.columns)?i.columns:[],i.manual_bounds=Mm(i.manual_bounds)?i.manual_bounds:{};break;case"missing_value_indicator":i.columns=Array.isArray(i.columns)?i.columns:[];break;case"remove_duplicates":if(i.columns=Array.isArray(i.columns)?i.columns:[],typeof i.keep=="string"){const c=i.keep.trim().toLowerCase();i.keep=c==="last"||c==="none"?c:"first"}else i.keep="first";break}return l(i)},sz=(e,t)=>t==="drop_missing_columns"||e===jw?Nw:e,rz=e=>Array.isArray(e)?e.map(t=>({...t})):[],az=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],oz=[],lz=e=>({...e,data:{...e.data??{}}}),Pm=()=>az.map(e=>lz(e)),iz=()=>oz.map(e=>({...e})),cz=12,uz=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},dz=(e,t,n)=>{if(!t||typeof t.project!="function"||!n)return;const s=n.getBoundingClientRect(),l=t.project({x:s.width/2,y:s.height/2});if(!l)return;const i=e.filter(f=>f.id!=="dataset-source").length,c=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],u=i%c.length,d=Math.floor(i/c.length),p=c[u],h=d+1;return{x:l.x+p.x*h,y:l.y+p.y*h}},mz=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),Sw=(e,t)=>{if(!e)return!1;if(mz.has(e))return!0;const n=t==null?void 0:t.get(e);return n?(typeof n.category=="string"?n.category.toLowerCase():"").includes("preprocess"):!1},Ew=(e,t)=>{var j,C,S,$,A,L;const{handleOpenSettings:n,handleRemoveNode:s,catalogEntryMap:l}=t,i=e.data??{},c=i.isDataset??e.id==="dataset-source",u={...e.style??{}},d=i.catalogType??i.type??e.id;let h=Array.isArray(i.parameters)?i.parameters:null;if((!h||h.length===0)&&typeof d=="string"){const T=l.get(d)??null;(j=T==null?void 0:T.parameters)!=null&&j.length&&(h=T.parameters)}const f=rz(h);let g;if(f.length||i.config&&typeof i.config=="object"){const T=Vc(i.config);f.forEach(P=>{P!=null&&P.name&&T[P.name]===void 0&&P.default!==void 0&&(Array.isArray(P.default)?T[P.name]=[...P.default]:P.type==="boolean"?T[P.name]=!!P.default:T[P.name]=P.default)}),g=T}u.width||(u.width=c?ww+20:ww),u.minHeight||(u.minHeight=JL),u.padding||(u.padding=12),u.borderRadius||(u.borderRadius=16),u.boxSizing=u.boxSizing??"border-box",u.whiteSpace=u.whiteSpace??"pre-line",u.background||(u.background=c?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),u.border||(u.border=c?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),u.boxShadow||(u.boxShadow=c?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),u.color||(u.color=c?"#e0f2fe":"#e2e8f0"),u.fontWeight||(u.fontWeight=c?600:500);const w=sz(i.description,d),_=Am(d),b=g??(i.config&&typeof i.config=="object"?Vc(i.config):void 0);b&&typeof b=="object"&&_&&delete b[Vo];const x={...i,label:i.label??e.id,description:w,isDataset:c,isRemovable:i.isRemovable??!c,isConfigured:c||i.isConfigured===!0?!0:i.config&&typeof i.config=="object"?_?!0:!i.config[Vo]:!1,inputs:Array.isArray(i.inputs)?[...i.inputs]:i.inputs,outputs:Array.isArray(i.outputs)?[...i.outputs]:i.outputs,category:i.category,parameters:f,config:b,catalogType:d,onRemoveNode:s,onOpenSettings:n},N=typeof d=="string"?Hc[d]:void 0;if(N){const T=((C=N.inputs)==null?void 0:C.map(z=>XL(z)))??[],P=((S=N.outputs)==null?void 0:S.map(z=>z.label))??[];T.length?x.inputs=T:delete x.inputs,P.length?x.outputs=P:delete x.outputs,x.connectionInfo={inputs:(($=N.inputs)==null?void 0:$.map(z=>({...z})))??[],outputs:((A=N.outputs)==null?void 0:A.map(z=>({...z})))??[]}}else(!x.inputs||x.inputs.length===0)&&delete x.inputs,(!x.outputs||x.outputs.length===0)&&delete x.outputs,delete x.connectionInfo;const E=sa(x.activeSplits);E.length?x.activeSplits=E:delete x.activeSplits;const M=sa(x.connectedSplits);return M.length?x.connectedSplits=M:delete x.connectedSplits,d==="train_test_split"&&(x.activeSplits=[...na],M.length||delete x.connectedSplits),(L=x.parameters)!=null&&L.length||delete x.parameters,x.config===void 0&&delete x.config,{...e,type:"featureNode",position:e.position??{x:0,y:0},data:x,style:u}},hz=(e,t,n,s,l)=>{const i=(e==null?void 0:e.label)??(e==null?void 0:e.type)??s,c=typeof i=="string"&&i.trim()?i:s,u=Om(e),d=Am((e==null?void 0:e.type)??null);return Ew({id:t,type:"featureNode",position:n,data:{label:c,description:e==null?void 0:e.description,inputs:e==null?void 0:e.inputs,outputs:e==null?void 0:e.outputs,category:e==null?void 0:e.category,parameters:e==null?void 0:e.parameters,config:u,catalogType:e==null?void 0:e.type,isConfigured:!!d}},l)},fz=(e,t)=>{const n=e.map(l=>{const{data:i,...c}=l,u=i?{...i}:void 0;return u&&(delete u.onRemoveNode,delete u.onOpenSettings),JSON.parse(JSON.stringify({...c,data:u}))}),s=t.map(l=>JSON.parse(JSON.stringify(l)));return{nodes:n,edges:s}},pz=()=>{var h;const[e,t]=v.useState(!1),n=v.useRef(new Map),s=Hs({queryKey:["feature-canvas","node-catalog"],queryFn:$b,staleTime:5*60*1e3}),l=s.data??[],i=s.isLoading||s.isFetching,c=s.error?((h=s.error)==null?void 0:h.message)??"Unable to load node catalog":null;v.useEffect(()=>{const f=new Map;l.forEach(g=>{g&&typeof g.type=="string"&&g.type.trim()&&f.set(g.type,g)}),n.current=f},[l]);const u=v.useCallback(()=>t(!0),[]),d=v.useCallback(()=>t(!1),[]),p=v.useCallback(()=>t(f=>!f),[]);return{nodeCatalog:l,catalogEntryMapRef:n,isCatalogOpen:e,openCatalog:u,closeCatalog:d,toggleCatalog:p,isCatalogLoading:i,catalogErrorMessage:c}},Tm=e=>!e||!e.length?"":e.join(", "),gz=({nodes:e,onAddNode:t})=>{const[n,s]=v.useState(""),[l,i]=v.useState([]),c=n.trim().toLowerCase(),u=v.useMemo(()=>c?e.filter(g=>{const w=[g.label,g.type,g.description];return g.category&&w.push(g.category),g.tags&&g.tags.length&&w.push(g.tags.join(" ")),w.some(_=>_==null?void 0:_.toLowerCase().includes(c))}):e,[e,c]),d=v.useMemo(()=>{const g=new Map;return u.forEach(w=>{var x;const _=((x=w.category)==null?void 0:x.trim())||"Other",b=g.get(_)??[];b.push(w),g.set(_,b)}),Array.from(g.entries()).sort(([w],[_])=>w.localeCompare(_)).map(([w,_])=>({category:w,entries:_.sort((b,x)=>(b.label||b.type).localeCompare(x.label||x.type))}))},[u]);v.useEffect(()=>{if(!c){i([]);return}i(g=>{const w=new Set(g);let _=!1;return d.forEach(({category:b})=>{w.has(b)||(w.add(b),_=!0)}),_?Array.from(w):g})},[d,c]);const p=g=>{i(w=>{const _=new Set(w);return _.has(g)?_.delete(g):_.add(g),Array.from(_)})},h=u.length,f=h>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsx("h3",{children:"Available steps"}),a.jsxs("div",{className:"feature-canvas-sidebar__search",children:[a.jsx("input",{type:"search",value:n,onChange:g=>s(g.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps"}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>s(""),"aria-label":"Clear search",children:""})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",h," ",h===1?"step":"steps",c?` matching ${n.trim()}`:""]})]}),f?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:d.map(({category:g,entries:w})=>{const _=l.includes(g);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>p(g),"aria-expanded":_,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:g.charAt(0).toUpperCase()+g.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[w.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":_,children:""})]})]}),_&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:w.map(b=>{var x,N;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(b),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:b.label||b.type}),b.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:b.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(x=b.inputs)!=null&&x.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${Tm(b.inputs)}`,children:["In: ",Tm(b.inputs)]}):null,(N=b.outputs)!=null&&N.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${Tm(b.outputs)}`,children:["Out: ",Tm(b.outputs)]}):null,b.parameters&&b.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",children:[b.parameters.length," param",b.parameters.length>1?"s":""]}):null]})]})},b.type)})})]},g)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})},_z=({nodeCatalog:e,isCatalogLoading:t,catalogErrorMessage:n,handleAddNode:s})=>({sidebarContent:v.useMemo(()=>t?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):n?a.jsx("p",{className:"text-danger",children:n}):e.length?a.jsx(gz,{nodes:e,onAddNode:s}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[n,s,t,e])}),vz=({setNodes:e,setEdges:t,setSelectedNodeId:n,setIsSettingsModalOpen:s,catalogEntryMapRef:l,handleOpenSettings:i,reactFlowInstanceRef:c,canvasViewportRef:u,scheduleFitView:d})=>{const p=v.useRef(0),h=v.useCallback(M=>{M!=="dataset-source"&&(e(j=>j.filter(C=>C.id!==M)),t(j=>j.filter(C=>C.source!==M&&C.target!==M)),n(j=>j===M?(s(!1),null):j))},[t,s,e,n]),f=v.useCallback(M=>Ew(M,{handleOpenSettings:i,handleRemoveNode:h,catalogEntryMap:l.current}),[l,i,h]),g=v.useCallback(M=>{const j=M.reduce((C,S)=>{if(typeof S.id=="string"&&S.id.startsWith("node-")){const $=Number(S.id.replace("node-",""));if(!Number.isNaN($))return Math.max(C,$)}return C},0);j>p.current&&(p.current=j)},[]),w=v.useCallback((M,j)=>{const C=p.current+1,S=`node-${C}`;p.current=C;const $=j??{x:160+(C-1)%4*220,y:40+Math.floor((C-1)/4)*160};return f(hz(M??null,S,$,`Step ${C}`,{handleOpenSettings:i,handleRemoveNode:h,catalogEntryMap:l.current}))},[l,i,h,f]),_=v.useCallback(M=>{e(j=>{const C=dz(j,c.current,u.current),S=w(M,C);return[...j,S]}),d()},[u,w,c,d,e]),b=v.useCallback((M,j)=>{e(C=>C.map(S=>{if(S.id!==M)return S;const $=Vc(j);$&&typeof $=="object"&&delete $[Vo];const A={...S.data??{},config:$,isConfigured:!0};return f({...S,data:A})}))},[f,e]),x=v.useCallback((M,j)=>{e(C=>C.map(S=>{if(S.id!==M)return S;const $={...S.data??{},...j};return f({...S,data:$})}))},[f,e]),N=v.useCallback((M,j)=>{e(C=>C.map(S=>{var P;if(S.id!==M)return S;const $=(P=S==null?void 0:S.data)==null?void 0:P.catalogType,A=$?l.current.get($)??null:null,L=j&&typeof j=="object"?Vc(j):Om(A??null),T={...S.data??{},config:L,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...S,data:T})}))},[l,f,e]),E=v.useCallback(()=>{e(M=>M.map(j=>{var L,T;if(!Sw((L=j==null?void 0:j.data)==null?void 0:L.catalogType,l.current))return j;const C=(T=j==null?void 0:j.data)==null?void 0:T.catalogType,S=C?l.current.get(C)??null:null,$=Om(S??null),A={...j.data??{},config:$,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...j,data:A})}))},[l,f,e]);return{registerNode:f,createNode:w,handleAddNode:_,handleRemoveNode:h,handleUpdateNodeConfig:b,handleUpdateNodeData:x,handleResetNodeConfig:N,handleResetAllNodes:E,updateNodeCounter:g}},yz=({sourceId:e,datasetDisplayLabel:t,registerNode:n,prepareNodes:s,setNodes:l,setEdges:i,updateNodeCounter:c,scheduleFitView:u,onPipelineHydrated:d,onPipelineError:p})=>{const h=v.useRef(!1),f=Hs({queryKey:["feature-canvas","pipeline",e],queryFn:()=>Yb(e),enabled:!!e,staleTime:60*1e3,retry:1});return v.useEffect(()=>{const g=`Dataset input
(${t})`;if(!e){if(h.current)l(w=>{let _=!1;const b=w.map(x=>{var E;return x.id!=="dataset-source"||(((E=x==null?void 0:x.data)==null?void 0:E.label)??"")===g?x:(_=!0,n({...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}))});return _?b:w});else{const w=uz(t),_=s(w.nodes);h.current=!0,l(_),i(w.edges),c(_),u(),d==null||d({nodes:_,edges:w.edges,pipeline:null,context:"sample"})}return}if(h.current=!1,f.isLoading){l(w=>w.map(_=>_.id==="dataset-source"?n({..._,data:{..._.data??{},label:g,isDataset:!0,isRemovable:!1}}):_));return}if(f.isError){const w=f.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",w),p==null||p(w);const _=Pm().map(x=>x.id==="dataset-source"?{...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}:x),b=s(_);l(b),i([]),c(b),u(),d==null||d({nodes:b,edges:[],pipeline:null,context:"reset"});return}if(f.data){const w=f.data.graph??{},_=Array.isArray(w==null?void 0:w.nodes)&&w.nodes.length?w.nodes:Pm(),b=s(_),N=(Array.isArray(w==null?void 0:w.edges)?w.edges:[]).map(E=>{var T;const M=E==null?void 0:E.type,j=!M||M==="smoothstep"||M==="default"?"animatedEdge":M,C=E==null?void 0:E.source,S=E==null?void 0:E.target,$=b.find(P=>P.id===S),A=(E==null?void 0:E.sourceHandle)??(C?`${C}-source`:void 0),L=(E==null?void 0:E.targetHandle)??((T=$==null?void 0:$.data)!=null&&T.isDataset?void 0:S?`${S}-target`:void 0);return{...E,animated:(E==null?void 0:E.animated)??!0,type:j,sourceHandle:A,targetHandle:L}});l(b),i(N),c(b),u(),d==null||d({nodes:b,edges:N,pipeline:f.data??null,context:"stored"});return}if(f.isFetched&&!f.data){const w=Pm().map(b=>b.id==="dataset-source"?{...b,data:{...b.data??{},label:g,isDataset:!0,isRemovable:!1}}:b),_=s(w);l(_),i([]),c(_),u(),d==null||d({nodes:_,edges:[],pipeline:null,context:"sample"})}},[t,d,p,f.data,f.error,f.isError,f.isFetched,f.isLoading,s,n,u,i,l,e,c]),{isPipelineLoading:f.isLoading||f.isFetching}},bz=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),xz=e=>{var n;const t=e?Hc[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(s=>s.required!==!1).map(s=>s.key):[]},wz=(e,t,n)=>{const s=xz(t);if(s.length===0)return!0;const l=n.filter(c=>c.target===e),i=new Set(l.map(c=>bw(e,c.targetHandle)).filter(c=>!!c));return s.every(c=>i.has(c))},jz=(e,t)=>{const n=new Map,s=new Set;e.forEach(d=>{var h;const p=(h=d==null?void 0:d.data)==null?void 0:h.catalogType;if(p&&bz.has(p)){s.add(d.id);return}p==="train_test_split"&&n.set(d.id,new Set(na))});let l=!0,i=0;const c=e.length*3;for(;l&&i<c;)l=!1,i++,t.forEach(d=>{if(s.has(d.source)||s.has(d.target))return;const p=n.get(d.source),h=_w(d.sourceHandle);if(!p||p.size===0)return;n.has(d.target)||n.set(d.target,new Set);const f=n.get(d.target),g=f.size;h?p.has(h)&&f.add(h):p.forEach(w=>f.add(w)),f.size>g&&(l=!0)});const u=new Map;return n.forEach((d,p)=>{!d.size||s.has(p)||u.set(p,na.filter(h=>d.has(h)))}),u},Nz=e=>{const t=new Map;e.forEach(s=>{const l=_w(s.sourceHandle);l&&(t.has(s.source)||t.set(s.source,new Set),t.get(s.source).add(l))});const n=new Map;return t.forEach((s,l)=>{n.set(l,na.filter(i=>s.has(i)))}),n},Cz=({edges:e,setNodes:t,scheduleNodeInternalsUpdate:n})=>{v.useEffect(()=>{const s=[];t(l=>{const i=jz(l,e),c=Nz(e);let u=!1;const d=l.map(p=>{var S,$,A,L,T;const f=((S=p==null?void 0:p.data)==null?void 0:S.catalogType)==="train_test_split"?[...na]:i.get(p.id)??[],g=sa(($=p.data)==null?void 0:$.activeSplits),w=sa(c.get(p.id)),_=sa((A=p.data)==null?void 0:A.connectedSplits),b=((L=p==null?void 0:p.data)==null?void 0:L.catalogType)??"",x=wz(p.id,b,e),N=((T=p.data)==null?void 0:T.hasRequiredConnections)??!0,E=!gw(g,f),M=!gw(_,w);if(!E&&!M&&!(x!==N))return p;const C={...p.data,hasRequiredConnections:x};return f.length?C.activeSplits=f:delete C.activeSplits,w.length?C.connectedSplits=w:delete C.connectedSplits,(E||M)&&s.push(p.id),u=!0,{...p,data:C}});return u?d:l}),s.length&&n(s)},[e,n,t])},Sz=({nodes:e,setEdges:t,scheduleNodeInternalsUpdate:n})=>{const s=v.useCallback(i=>{var w,_;const{source:c,target:u,sourceHandle:d,targetHandle:p}=i;if(!c||!u||!p||c===u)return!1;const h=e.find(b=>b.id===u);if(!h)return!1;const f=((w=h==null?void 0:h.data)==null?void 0:w.catalogType)??"",g=f?Hc[f]:void 0;if((_=g==null?void 0:g.inputs)!=null&&_.length){const b=bw(u,p);if(!b)return!1;const x=g.inputs.find(N=>N.key===b);return!x||!d?!1:x.accepts&&x.accepts.length>0?x.accepts.some(N=>{const E=GL[N];return E?E(d):!1}):!0}return!0},[e]),l=v.useCallback(i=>{t(u=>uy({...i,type:"animatedEdge",animated:!0},u));const c=[i.source,i.target].filter(u=>!!u);c.length&&n(c)},[n,t]);return{isValidConnection:s,onConnect:l}},Ez=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const l=Math.abs(n-e),i=Math.max(64,Math.min(l*.45,240)),c=Number.isFinite(i)?i:100,u=n>=e?1:-1,d=e+u*c,p=t,h=n-u*c;return`M ${e},${t} C ${d},${p} ${h},${s} ${n},${s}`},kz=({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:l,targetPosition:i})=>{const c=Ez(e,t,n,s),u="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:u,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:s,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:s,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},Mz=({nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:l,onEdgesChange:i,onConnect:c,isValidConnection:u,onNodeClick:d,reactFlowInstanceRef:p,canvasViewportRef:h,handleResetAllNodes:f,openCatalog:g})=>a.jsxs("div",{className:"canvas-stage__viewport",ref:h,children:[a.jsxs(Ob,{style:{width:"100%",height:"100%"},nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:l,onEdgesChange:i,onConnect:c,isValidConnection:u,onNodeClick:d,onInit:w=>{p.current=w,requestAnimationFrame(()=>w.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:$o.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:kz,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(n1,{position:"bottom-left"}),a.jsx(l1,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:f,"aria-label":"Reset preprocessing nodes",children:""}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:g,"aria-label":"Open node catalog",children:"+"})]}),Az=v.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:s,onPipelineError:l},i)=>{const c=v.useMemo(()=>({featureNode:ez}),[]),u=v.useMemo(()=>({animatedEdge:Tk}),[]),[d,p,h]=Mk(Pm().map(Ue=>({...Ue,type:"featureNode"}))),[f,g,w]=Ak(iz()),[_,b]=v.useState(null),[x,N]=v.useState(!1),E=v.useRef(null),M=v.useRef(null),j=v.useRef(!1),C=t??e??"Demo dataset",S=c1(),{nodeCatalog:$,catalogEntryMapRef:A,isCatalogOpen:L,openCatalog:T,closeCatalog:P,isCatalogLoading:z,catalogErrorMessage:W}=pz(),D=v.useCallback(Ue=>{const de=(Array.isArray(Ue)?Ue:[Ue]).filter(Boolean);if(!de.length)return;const pe=Array.from(new Set(de));requestAnimationFrame(()=>{requestAnimationFrame(()=>{pe.forEach(xe=>{S(xe)})})})},[S]);Cz({edges:f,setNodes:p,scheduleNodeInternalsUpdate:D});const R=v.useMemo(()=>d.find(Ue=>Ue.id===_)??null,[d,_]),U=v.useMemo(()=>fz(d,f),[f,d]),V=v.useCallback(Ue=>{b(Ue),N(!0)},[]),B=v.useCallback(()=>{N(!1),b(null)},[]),G=v.useCallback(()=>{j.current=!0},[]);v.useEffect(()=>{j.current&&(j.current=!1,requestAnimationFrame(()=>{var Ue;(Ue=E.current)==null||Ue.fitView({padding:.25,duration:350})}))},[f,d]);const{registerNode:q,handleAddNode:F,handleUpdateNodeConfig:K,handleUpdateNodeData:se,handleResetNodeConfig:Q,handleResetAllNodes:H,updateNodeCounter:Y}=vz({setNodes:p,setEdges:g,setSelectedNodeId:b,setIsSettingsModalOpen:N,catalogEntryMapRef:A,handleOpenSettings:V,reactFlowInstanceRef:E,canvasViewportRef:M,scheduleFitView:G});v.useEffect(()=>{Y(d)},[d,Y]);const X=v.useCallback(Ue=>Ue.map(de=>{const pe={...de.data??{}};de.id==="dataset-source"&&(pe.label=`Dataset input
(${C})`,pe.isDataset=!0,pe.isRemovable=!1,pe.isConfigured=!0);const xe=pe.catalogType??pe.type??de.id;return pe.config&&typeof pe.config=="object"&&Am(xe)&&delete pe.config[Vo],pe.isConfigured===void 0&&(pe.config&&typeof pe.config=="object"?pe.isConfigured=Am(xe)?!0:!pe.config[Vo]:pe.isConfigured=!0),q({...de,data:pe})}),[C,q]),{isPipelineLoading:ee}=yz({sourceId:e,datasetDisplayLabel:C,registerNode:q,prepareNodes:X,setNodes:p,setEdges:g,updateNodeCounter:Y,scheduleFitView:G,onPipelineHydrated:s,onPipelineError:l}),J=v.useCallback(()=>{p(Ue=>{const de=Ue.find(xe=>xe.id==="dataset-source");return[q(de?{...de,data:{...de.data??{},label:`Dataset input
(${C})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${C})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),g([]),b(null),N(!1),G()},[C,q,G,g,p,b,N]);v.useImperativeHandle(i,()=>({openCatalog:T,closeCatalog:P,clearGraph:J}),[J,P,T]);const{isValidConnection:re,onConnect:we}=Sz({nodes:d,setEdges:g,scheduleNodeInternalsUpdate:D});v.useEffect(()=>{n==null||n(d,f)},[f,d,n]);const Pe=v.useMemo(()=>{var pe;if(!R)return null;const Ue=(pe=R==null?void 0:R.data)==null?void 0:pe.catalogType;if(!Ue)return null;const de=A.current.get(Ue);return de?Om(de):null},[R]),Me=v.useMemo(()=>{var de,pe;if(!R||(de=R.data)!=null&&de.isDataset)return!1;const Ue=(pe=R==null?void 0:R.data)==null?void 0:pe.catalogType;return Sw(typeof Ue=="string"?Ue:null,A.current)},[R]),{sidebarContent:Fe}=_z({nodeCatalog:$,isCatalogLoading:z,catalogErrorMessage:W,handleAddNode:F}),Ke=v.useCallback((Ue,de)=>{V(de.id)},[V]);return a.jsxs("div",{className:"canvas-stage","data-pipeline-loading":ee?"true":"false","aria-busy":ee,children:[a.jsx(Mz,{nodes:d,edges:f,nodeTypes:c,edgeTypes:u,onNodesChange:h,onEdgesChange:w,onConnect:we,isValidConnection:re,onNodeClick:Ke,reactFlowInstanceRef:E,canvasViewportRef:M,handleResetAllNodes:H,openCatalog:T}),a.jsxs("div",{className:`canvas-drawer${L?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:P,"aria-label":"Close catalog",children:""})]}),a.jsx("div",{className:"canvas-drawer__body",children:Fe})]}),L&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:P}),x&&R&&a.jsx(WL,{node:R,sourceId:e??null,graphSnapshot:U,onClose:B,onUpdateConfig:K,onUpdateNodeData:se,onResetConfig:Q,defaultConfigTemplate:Pe,isResetAvailable:Me})]})}),kw=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},xg=e=>{const t=kw(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},wg=e=>{const t=kw(e);if(!t)return null;const n=t.getTime(),s=Date.now()-n,l=Math.round(s/6e4);if(l<1)return"just now";if(l===1)return"1 minute ago";if(l<60)return`${l} minutes ago`;const i=Math.round(l/60);if(i===1)return"1 hour ago";if(i<24)return`${i} hours ago`;const c=Math.round(i/24);if(c===1)return"1 day ago";if(c<7)return`${c} days ago`;const u=Math.round(c/7);return u===1?"1 week ago":`${u} weeks ago`},Oz=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:l,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:_,historyErrorMessage:b,historyItems:x,activePipelineId:N,isDirty:E,isSaveDisabled:M,saveButtonLabel:j,saveFeedback:C,feedbackIcon:S,feedbackClass:$,onSelectHistory:A})=>{const L=d?(u==null?void 0:u.name)??d:null;return a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),e&&a.jsx("span",{className:"canvas-sidepanel__meta",children:wg(e)??xg(e)})]}),t?a.jsx("p",{className:"text-danger",children:t}):l?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:d??"",onChange:T=>h(T.target.value),disabled:n||!i,"aria-label":"Select dataset",children:c.map(T=>a.jsx("option",{value:T.value,disabled:!T.isOwned,children:`${T.label}${T.isOwned?"":" (locked)"}`},T.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),n&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!n&&!s&&!t&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:u.description}),L&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:L})]}),!i&&l>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:f,disabled:!p,"aria-label":"Clean all nodes",title:p?"Remove all nodes and edges from the canvas":"Nothing to clean yet",children:[a.jsx("span",{"aria-hidden":"true",children:""}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:g,disabled:_||!d,"aria-label":"Refresh history",title:"Refresh history",children:""}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:w,disabled:M,"aria-label":j,title:j,children:""})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:_?a.jsx("p",{className:"text-muted",children:"Loading history"}):b?a.jsx("p",{className:"text-danger",children:b}):x.length?x.map(T=>{const z=wg(T.updated_at)??xg(T.updated_at),W=T.id===N,D=W&&!E;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${W?" canvas-sidepanel__history-item--active":""}`,onClick:()=>A(T),disabled:D,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:T.name||`Pipeline #${T.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:z}),W&&E&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},T.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),C&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${$}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:S}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:C.message})]})]})},Pz=e=>{var w;const[t,n]=v.useState(e??null),[s,l]=v.useState(null),i=Hs({queryKey:["feature-canvas","datasets"],queryFn:()=>Lb(12),staleTime:5*60*1e3}),c=i.data??[],u=v.useMemo(()=>c.filter(_=>(_==null?void 0:_.is_owned)!==!1),[c]);v.useEffect(()=>{if(!c.length){l(null);return}if(t){const b=c.find(x=>x.source_id===t);if(b){l(x=>(x==null?void 0:x.id)===b.id?x:b);return}}const _=u[0]??c[0];_&&(t||n(_.source_id??String(_.id)),l(_))},[t,c,u]);const d=v.useMemo(()=>c.map(_=>({value:_.source_id,label:_.name??_.source_id,isOwned:_.is_owned!==!1})),[c]),p=u.length>1,h=c.length>0,f=u.length,g=i.error?((w=i.error)==null?void 0:w.message)??"Unable to load datasets":null;return{datasets:c,ownedDatasets:u,selectedDataset:s,setSelectedDataset:l,activeSourceId:t,setActiveSourceId:n,datasetOptions:d,canSelectDatasets:p,hasDatasets:h,ownedDatasetsCount:f,isDatasetLoading:i.isLoading,datasetErrorMessage:g}},Tz=({sourceId:e,setIsDirty:t,setSaveFeedback:n,isHydratingRef:s})=>{const l=Pz(e),{datasets:i,setActiveSourceId:c,setSelectedDataset:u}=l,d=v.useCallback(p=>{const h=i.find(f=>f.source_id===p)??null;if(!h){n({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(h.is_owned===!1){n({message:"Only datasets you own can be selected.",tone:"error"});return}c(p),u(h),s.current=!0,t(!1),n(null)},[i,s,c,t,n,u]);return{...l,handleDatasetSelection:d}},Mw=(e,t)=>({nodes:JSON.parse(JSON.stringify(e??[])),edges:JSON.parse(JSON.stringify(t??[]))}),Aw=e=>Array.isArray(e)?e.some(t=>(t==null?void 0:t.id)&&t.id!=="dataset-source"):!1,Ow=e=>Array.isArray(e)?e.length>0:!1,$z=({setIsDirty:e,setSaveFeedback:t,isHydratingRef:n})=>{const s=v.useRef({nodes:[],edges:[]}),[l,i]=v.useState(!1),c=v.useCallback((d,p)=>{const h=Mw(d,p);s.current=h;const f=Aw(h.nodes),g=Ow(h.edges);return i(f||g),{hasCustomNodes:f,hasEdges:g}},[]),u=v.useCallback((d,p)=>{const h=Mw(d,p),f=s.current,g=JSON.stringify(f.nodes??[])===JSON.stringify(h.nodes??[])&&JSON.stringify(f.edges??[])===JSON.stringify(h.edges??[]);s.current=h;const w=Aw(h.nodes),_=Ow(h.edges);i(w||_),!(n.current||g)&&(e(!0),t(null))},[n,e,t]);return{graphSnapshotRef:s,canClearCanvas:l,handleGraphChange:u,applyHydratedSnapshot:c}},Lz=({canvasShellRef:e,canClearCanvas:t,setSaveFeedback:n})=>v.useCallback(()=>{var s;t&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((s=e.current)==null||s.clearGraph(),n(l=>(l==null?void 0:l.tone)==="error"?l:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[e,t,n]),zz=({activeSourceId:e,isDirty:t,setSaveFeedback:n,pipelineQueryKey:s,pendingHistoryIdRef:l,isHydratingRef:i,historyLimit:c=cz})=>{var h;const u=Mo(),d=Hs({queryKey:["feature-canvas","pipeline-history",e],queryFn:()=>Qb(e,c),enabled:!!e,staleTime:30*1e3,retry:1}),p=v.useCallback(f=>{if(!(f!=null&&f.graph)){n({message:"Selected revision is missing pipeline data.",tone:"error"});return}t&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(l.current=f.id??null,i.current=!0,n({message:`Loading revision ${f.name??`#${f.id}`}`,tone:"info"}),u.setQueryData(s,f))},[t,i,l,s,u,n]);return{historyItems:d.data??[],isHistoryLoading:d.isLoading||d.isFetching,historyErrorMessage:d.error?((h=d.error)==null?void 0:h.message)??"Unable to load history":null,refetchHistory:d.refetch,handleHistorySelection:p}},Dz=({applyHydratedSnapshot:e,selectedDataset:t,activeSourceId:n,setActivePipelineId:s,setActivePipelineName:l,setActivePipelineUpdatedAt:i,setIsDirty:c,setSaveFeedback:u,pendingHistoryIdRef:d,isHydratingRef:p})=>{const h=v.useCallback(g=>{const{nodes:w,edges:_,pipeline:b,context:x}=g,{hasCustomNodes:N}=e(w,_),E=(b==null?void 0:b.id)??null;if(s(E),l((b==null?void 0:b.name)??null),i((b==null?void 0:b.updated_at)??null),x==="stored"&&b)if(d.current===b.id){const j=wg(b.updated_at)??xg(b.updated_at);u({message:`Saved revision ${b.name??`#${b.id}`} (${j})`,tone:"info"}),d.current=null}else p.current&&u(M=>(M==null?void 0:M.tone)==="error"?M:N?{message:"Loaded saved pipeline",tone:"info"}:M);else x==="sample"?(d.current=null,u(M=>(M==null?void 0:M.tone)==="error"||N?M:{message:`Showing starter pipeline for ${(t==null?void 0:t.name)??(t==null?void 0:t.source_id)??n??"demo dataset"}`,tone:"info"})):x==="reset"?d.current=null:b||(d.current=null,u(M=>(M==null?void 0:M.tone)==="error"?M:null));p.current&&c(!1),b&&d.current&&d.current!==b.id&&(d.current=null),p.current=!1},[n,e,d,t,s,l,i,c,u,p]),f=v.useCallback(g=>{u({message:(g==null?void 0:g.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[u]);return{handlePipelineHydrated:h,handlePipelineError:f}},Rz=({queryClient:e,setSaveFeedback:t,setIsDirty:n,setActivePipelineId:s,setActivePipelineName:l,setActivePipelineUpdatedAt:i,pendingHistoryIdRef:c})=>{const{mutate:u,isPending:d}=Ed({mutationFn:async({sourceId:p,payload:h})=>Gb(p,h),onSuccess:(p,h)=>{t({message:"Draft saved successfully.",tone:"success"}),n(!1),s(p.id??null),l(p.name??null),i(p.updated_at??null),c.current=p.id??null,e.setQueryData(["feature-canvas","pipeline",h.sourceId],p),e.invalidateQueries({queryKey:["feature-canvas","pipeline-history",h.sourceId],exact:!1})},onError:p=>{t({message:(p==null?void 0:p.message)??"Failed to save pipeline.",tone:"error"})}});return{triggerSave:u,isSaving:d}},Fz=e=>e==="success"?"":e==="error"?"":"",Iz=e=>e==="error"?"text-danger":e==="success"?"text-success":"text-muted",Bz=()=>{const[e,t]=v.useState(null);v.useEffect(()=>{if(!e||e.tone==="error"||typeof window>"u")return;const l=window.setTimeout(()=>t(null),e.tone==="success"?4e3:2500);return()=>window.clearTimeout(l)},[e]);const n=v.useMemo(()=>Fz(e==null?void 0:e.tone),[e]),s=v.useMemo(()=>Iz(e==null?void 0:e.tone),[e]);return{saveFeedback:e,setSaveFeedback:t,feedbackIcon:n,feedbackClass:s}},Uz=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:l,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:_,historyErrorMessage:b,historyItems:x,activePipelineId:N,isDirty:E,isSaving:M,saveFeedback:j,feedbackIcon:C,feedbackClass:S,onSelectHistory:$})=>({sidepanelProps:{activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:l,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:_,historyErrorMessage:b,historyItems:x,activePipelineId:N,isDirty:E,isSaveDisabled:!d||M,saveButtonLabel:M?"Saving":E?"Save draft*":"Save draft",saveFeedback:j,feedbackIcon:C,feedbackClass:S,onSelectHistory:$}}),qz=(e=!0)=>{const[t,n]=v.useState(e),s=v.useCallback(()=>{n(l=>!l)},[]);return{isSidepanelExpanded:t,handleToggleSidepanel:s}},Hz=e=>{const t=e==null?void 0:e.type;return!t||t==="smoothstep"||t==="default"?"animatedEdge":t},Vz=({snapshot:e,selectedDataset:t,activeSourceId:n})=>{const s=e.nodes??[],l=e.edges??[];return{name:t!=null&&t.name?`Draft pipeline for ${t.name}`:`Draft pipeline for ${n}`,graph:{nodes:s,edges:l.map(i=>({...i,animated:(i==null?void 0:i.animated)??!0,type:Hz(i)}))},metadata:{lastClientSave:new Date().toISOString(),nodeCount:s.length,edgeCount:l.length}}},Wz=({sourceId:e})=>{const t=Mo(),n=v.useRef(null),s=v.useRef(!0),{isSidepanelExpanded:l,handleToggleSidepanel:i}=qz(!0),[c,u]=v.useState(!1),{saveFeedback:d,setSaveFeedback:p,feedbackIcon:h,feedbackClass:f}=Bz(),{selectedDataset:g,activeSourceId:w,datasetOptions:_,canSelectDatasets:b,hasDatasets:x,ownedDatasetsCount:N,isDatasetLoading:E,datasetErrorMessage:M,handleDatasetSelection:j}=Tz({sourceId:e,setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),[C,S]=v.useState(null),[$,A]=v.useState(null),[L,T]=v.useState(null),P=v.useMemo(()=>["feature-canvas","pipeline",w],[w]),z=v.useRef(null),{graphSnapshotRef:W,canClearCanvas:D,handleGraphChange:R,applyHydratedSnapshot:U}=$z({setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),V=Lz({canvasShellRef:n,canClearCanvas:D,setSaveFeedback:p}),{historyItems:B,isHistoryLoading:G,historyErrorMessage:q,refetchHistory:F,handleHistorySelection:K}=zz({activeSourceId:w,isDirty:c,setSaveFeedback:p,pipelineQueryKey:P,pendingHistoryIdRef:z,isHydratingRef:s}),{triggerSave:se,isSaving:Q}=Rz({queryClient:t,setSaveFeedback:p,setIsDirty:u,setActivePipelineId:S,setActivePipelineName:T,setActivePipelineUpdatedAt:A,pendingHistoryIdRef:z}),{handlePipelineHydrated:H,handlePipelineError:Y}=Dz({applyHydratedSnapshot:U,selectedDataset:g,activeSourceId:w,setActivePipelineId:S,setActivePipelineName:T,setActivePipelineUpdatedAt:A,setIsDirty:u,setSaveFeedback:p,pendingHistoryIdRef:z,isHydratingRef:s}),X=v.useCallback(()=>{if(!w){p({message:"Select a dataset before saving.",tone:"error"});return}const J=W.current;if(!J.nodes||!J.nodes.length){p({message:"Add nodes to the canvas before saving.",tone:"error"});return}const re=Vz({snapshot:J,selectedDataset:g,activeSourceId:w});p({message:"Saving draft",tone:"info"}),se({sourceId:w,payload:re})},[w,g==null?void 0:g.name,se]),{sidepanelProps:ee}=Uz({activePipelineUpdatedAt:$,datasetErrorMessage:M,isDatasetLoading:E,hasDatasets:x,ownedDatasetsCount:N,canSelectDatasets:b,datasetOptions:_,selectedDataset:g,activeSourceId:w,canClearCanvas:D,onDatasetSelection:j,onClearCanvas:V,onRefreshHistory:()=>{F()},onSaveClick:X,isHistoryLoading:G,historyErrorMessage:q,historyItems:B,activePipelineId:C,isDirty:c,isSaving:Q,saveFeedback:d,feedbackIcon:h,feedbackClass:f,onSelectHistory:K});return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":l?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:i,"aria-label":l?"Collapse details panel":"Expand details panel","aria-expanded":l,"aria-controls":"feature-canvas-sidepanel",children:l?"":""}),!l&&d&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${f}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:h}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:d.message})]}),l&&a.jsx(Oz,{...ee}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(Pb,{children:a.jsx(Az,{ref:n,sourceId:w,datasetName:(g==null?void 0:g.name)??(g==null?void 0:g.source_id)??null,onGraphChange:R,onPipelineHydrated:H,onPipelineError:Y})})})]})},Kz=new zj,jg=document.getElementById("ml-workflow-root");if(!jg)throw new Error("ML workflow root element not found");const Yz=Mf.createRoot(jg),Gz=jg.getAttribute("data-source-id")||void 0;Yz.render(a.jsx(ge.StrictMode,{children:a.jsx(Dj,{client:Kz,children:a.jsx(Wz,{sourceId:Gz})})}))})();
//# sourceMappingURL=feature-canvas.js.map
