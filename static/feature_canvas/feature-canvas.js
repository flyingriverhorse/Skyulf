var zw=pn=>{throw TypeError(pn)};var $p=(pn,wn,jn)=>wn.has(pn)||zw("Cannot "+jn);var ne=(pn,wn,jn)=>($p(pn,wn,"read from private field"),jn?jn.call(pn):wn.get(pn)),Ke=(pn,wn,jn)=>wn.has(pn)?zw("Cannot add the same private member more than once"):wn instanceof WeakSet?wn.add(pn):wn.set(pn,jn),$e=(pn,wn,jn,io)=>($p(pn,wn,"write to private field"),io?io.call(pn,jn):wn.set(pn,jn),jn),yt=(pn,wn,jn)=>($p(pn,wn,"access private method"),jn);var cm=(pn,wn,jn,io)=>({set _(pt){$e(pn,wn,pt,jn)},get _(){return ne(pn,wn,io)}});(function(){"use strict";var ka,af,Vx,Ao,Ma,Ml,Wx,Al,Aa,Ol,Kx,Oo,Yx,To,Tl,nr,$o,Dn,Zi,Po,pr,ya,Gx,ws,St,ec,fs,Lo,$l,Gr,Oa,tc,Pl,Ll,zo,Ro,Ta,zl,Ft,Dc,Pp,Lp,zp,Rp,Dp,Fp,Ip,Rw,Qx,nc,Mr,ps,Do,Ar,lo,Xx,Qr,gr,sc,Jx,Xr,$a,js,Jr,Zr,um,Bp,Zx,Or,e0,gn,Pa,La,Rl,Dl,za,Fl,Il,t0;function pn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var wn={exports:{}},jn={},io={exports:{}},pt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up;function Dw(){if(Up)return pt;Up=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(F){return F===null||typeof F!="object"?null:(F=f&&F[f]||F["@@iterator"],typeof F=="function"?F:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function x(F,K,re){this.props=F,this.context=K,this.refs=_,this.updater=re||w}x.prototype.isReactComponent={},x.prototype.setState=function(F,K){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,K,"setState")},x.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function N(){}N.prototype=x.prototype;function C(F,K,re){this.props=F,this.context=K,this.refs=_,this.updater=re||w}var E=C.prototype=new N;E.constructor=C,b(E,x.prototype),E.isPureReactComponent=!0;var j=Array.isArray,S=Object.prototype.hasOwnProperty,M={current:null},T={key:!0,ref:!0,__self:!0,__source:!0};function P(F,K,re){var Y,V={},G=null,X=null;if(K!=null)for(Y in K.ref!==void 0&&(X=K.ref),K.key!==void 0&&(G=""+K.key),K)S.call(K,Y)&&!T.hasOwnProperty(Y)&&(V[Y]=K[Y]);var se=arguments.length-2;if(se===1)V.children=re;else if(1<se){for(var J=Array(se),te=0;te<se;te++)J[te]=arguments[te+2];V.children=J}if(F&&F.defaultProps)for(Y in se=F.defaultProps,se)V[Y]===void 0&&(V[Y]=se[Y]);return{$$typeof:e,type:F,key:G,ref:X,props:V,_owner:M.current}}function L(F,K){return{$$typeof:e,type:F.type,key:K,ref:F.ref,props:F.props,_owner:F._owner}}function $(F){return typeof F=="object"&&F!==null&&F.$$typeof===e}function A(F){var K={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(re){return K[re]})}var R=/\/+/g;function W(F,K){return typeof F=="object"&&F!==null&&F.key!=null?A(""+F.key):K.toString(36)}function z(F,K,re,Y,V){var G=typeof F;(G==="undefined"||G==="boolean")&&(F=null);var X=!1;if(F===null)X=!0;else switch(G){case"string":case"number":X=!0;break;case"object":switch(F.$$typeof){case e:case t:X=!0}}if(X)return X=F,V=V(X),F=Y===""?"."+W(X,0):Y,j(V)?(re="",F!=null&&(re=F.replace(R,"$&/")+"/"),z(V,K,re,"",function(te){return te})):V!=null&&($(V)&&(V=L(V,re+(!V.key||X&&X.key===V.key?"":(""+V.key).replace(R,"$&/")+"/")+F)),K.push(V)),1;if(X=0,Y=Y===""?".":Y+":",j(F))for(var se=0;se<F.length;se++){G=F[se];var J=Y+W(G,se);X+=z(G,K,re,J,V)}else if(J=g(F),typeof J=="function")for(F=J.call(F),se=0;!(G=F.next()).done;)G=G.value,J=Y+W(G,se++),X+=z(G,K,re,J,V);else if(G==="object")throw K=String(F),Error("Objects are not valid as a React child (found: "+(K==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":K)+"). If you meant to render a collection of children, use an array instead.");return X}function D(F,K,re){if(F==null)return F;var Y=[],V=0;return z(F,Y,"","",function(G){return K.call(re,G,V++)}),Y}function H(F){if(F._status===-1){var K=F._result;K=K(),K.then(function(re){(F._status===0||F._status===-1)&&(F._status=1,F._result=re)},function(re){(F._status===0||F._status===-1)&&(F._status=2,F._result=re)}),F._status===-1&&(F._status=0,F._result=K)}if(F._status===1)return F._result.default;throw F._result}var q={current:null},I={transition:null},Q={ReactCurrentDispatcher:q,ReactCurrentBatchConfig:I,ReactCurrentOwner:M};function U(){throw Error("act(...) is not supported in production builds of React.")}return pt.Children={map:D,forEach:function(F,K,re){D(F,function(){K.apply(this,arguments)},re)},count:function(F){var K=0;return D(F,function(){K++}),K},toArray:function(F){return D(F,function(K){return K})||[]},only:function(F){if(!$(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},pt.Component=x,pt.Fragment=n,pt.Profiler=o,pt.PureComponent=C,pt.StrictMode=s,pt.Suspense=d,pt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Q,pt.act=U,pt.cloneElement=function(F,K,re){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var Y=b({},F.props),V=F.key,G=F.ref,X=F._owner;if(K!=null){if(K.ref!==void 0&&(G=K.ref,X=M.current),K.key!==void 0&&(V=""+K.key),F.type&&F.type.defaultProps)var se=F.type.defaultProps;for(J in K)S.call(K,J)&&!T.hasOwnProperty(J)&&(Y[J]=K[J]===void 0&&se!==void 0?se[J]:K[J])}var J=arguments.length-2;if(J===1)Y.children=re;else if(1<J){se=Array(J);for(var te=0;te<J;te++)se[te]=arguments[te+2];Y.children=se}return{$$typeof:e,type:F.type,key:V,ref:G,props:Y,_owner:X}},pt.createContext=function(F){return F={$$typeof:c,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:i,_context:F},F.Consumer=F},pt.createElement=P,pt.createFactory=function(F){var K=P.bind(null,F);return K.type=F,K},pt.createRef=function(){return{current:null}},pt.forwardRef=function(F){return{$$typeof:u,render:F}},pt.isValidElement=$,pt.lazy=function(F){return{$$typeof:h,_payload:{_status:-1,_result:F},_init:H}},pt.memo=function(F,K){return{$$typeof:p,type:F,compare:K===void 0?null:K}},pt.startTransition=function(F){var K=I.transition;I.transition={};try{F()}finally{I.transition=K}},pt.unstable_act=U,pt.useCallback=function(F,K){return q.current.useCallback(F,K)},pt.useContext=function(F){return q.current.useContext(F)},pt.useDebugValue=function(){},pt.useDeferredValue=function(F){return q.current.useDeferredValue(F)},pt.useEffect=function(F,K){return q.current.useEffect(F,K)},pt.useId=function(){return q.current.useId()},pt.useImperativeHandle=function(F,K,re){return q.current.useImperativeHandle(F,K,re)},pt.useInsertionEffect=function(F,K){return q.current.useInsertionEffect(F,K)},pt.useLayoutEffect=function(F,K){return q.current.useLayoutEffect(F,K)},pt.useMemo=function(F,K){return q.current.useMemo(F,K)},pt.useReducer=function(F,K,re){return q.current.useReducer(F,K,re)},pt.useRef=function(F){return q.current.useRef(F)},pt.useState=function(F){return q.current.useState(F)},pt.useSyncExternalStore=function(F,K,re){return q.current.useSyncExternalStore(F,K,re)},pt.useTransition=function(){return q.current.useTransition()},pt.version="18.3.1",pt}io.exports=Dw();var v=io.exports;const ve=pn(v);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qp;function Fw(){if(qp)return jn;qp=1;var e=v,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function c(u,d,p){var h,f={},g=null,w=null;p!==void 0&&(g=""+p),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(w=d.ref);for(h in d)s.call(d,h)&&!i.hasOwnProperty(h)&&(f[h]=d[h]);if(u&&u.defaultProps)for(h in d=u.defaultProps,d)f[h]===void 0&&(f[h]=d[h]);return{$$typeof:t,type:u,key:g,ref:w,props:f,_owner:o.current}}return jn.Fragment=n,jn.jsx=c,jn.jsxs=c,jn}wn.exports=Fw();var a=wn.exports,dm={},Hp={exports:{}},vs={},mm={exports:{}},hm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vp;function Iw(){return Vp||(Vp=1,function(e){function t(I,Q){var U=I.length;I.push(Q);e:for(;0<U;){var F=U-1>>>1,K=I[F];if(0<o(K,Q))I[F]=Q,I[U]=K,U=F;else break e}}function n(I){return I.length===0?null:I[0]}function s(I){if(I.length===0)return null;var Q=I[0],U=I.pop();if(U!==Q){I[0]=U;e:for(var F=0,K=I.length,re=K>>>1;F<re;){var Y=2*(F+1)-1,V=I[Y],G=Y+1,X=I[G];if(0>o(V,U))G<K&&0>o(X,V)?(I[F]=X,I[G]=U,F=G):(I[F]=V,I[Y]=U,F=Y);else if(G<K&&0>o(X,U))I[F]=X,I[G]=U,F=G;else break e}}return Q}function o(I,Q){var U=I.sortIndex-Q.sortIndex;return U!==0?U:I.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],p=[],h=1,f=null,g=3,w=!1,b=!1,_=!1,x=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function E(I){for(var Q=n(p);Q!==null;){if(Q.callback===null)s(p);else if(Q.startTime<=I)s(p),Q.sortIndex=Q.expirationTime,t(d,Q);else break;Q=n(p)}}function j(I){if(_=!1,E(I),!b)if(n(d)!==null)b=!0,H(S);else{var Q=n(p);Q!==null&&q(j,Q.startTime-I)}}function S(I,Q){b=!1,_&&(_=!1,N(P),P=-1),w=!0;var U=g;try{for(E(Q),f=n(d);f!==null&&(!(f.expirationTime>Q)||I&&!A());){var F=f.callback;if(typeof F=="function"){f.callback=null,g=f.priorityLevel;var K=F(f.expirationTime<=Q);Q=e.unstable_now(),typeof K=="function"?f.callback=K:f===n(d)&&s(d),E(Q)}else s(d);f=n(d)}if(f!==null)var re=!0;else{var Y=n(p);Y!==null&&q(j,Y.startTime-Q),re=!1}return re}finally{f=null,g=U,w=!1}}var M=!1,T=null,P=-1,L=5,$=-1;function A(){return!(e.unstable_now()-$<L)}function R(){if(T!==null){var I=e.unstable_now();$=I;var Q=!0;try{Q=T(!0,I)}finally{Q?W():(M=!1,T=null)}}else M=!1}var W;if(typeof C=="function")W=function(){C(R)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,D=z.port2;z.port1.onmessage=R,W=function(){D.postMessage(null)}}else W=function(){x(R,0)};function H(I){T=I,M||(M=!0,W())}function q(I,Q){P=x(function(){I(e.unstable_now())},Q)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_continueExecution=function(){b||w||(b=!0,H(S))},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(I){switch(g){case 1:case 2:case 3:var Q=3;break;default:Q=g}var U=g;g=Q;try{return I()}finally{g=U}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(I,Q){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var U=g;g=I;try{return Q()}finally{g=U}},e.unstable_scheduleCallback=function(I,Q,U){var F=e.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?F+U:F):U=F,I){case 1:var K=-1;break;case 2:K=250;break;case 5:K=1073741823;break;case 4:K=1e4;break;default:K=5e3}return K=U+K,I={id:h++,callback:Q,priorityLevel:I,startTime:U,expirationTime:K,sortIndex:-1},U>F?(I.sortIndex=U,t(p,I),n(d)===null&&I===n(p)&&(_?(N(P),P=-1):_=!0,q(j,U-F))):(I.sortIndex=K,t(d,I),b||w||(b=!0,H(S))),I},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(I){var Q=g;return function(){var U=g;g=Q;try{return I.apply(this,arguments)}finally{g=U}}}}(hm)),hm}var Wp;function Bw(){return Wp||(Wp=1,mm.exports=Iw()),mm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kp;function Uw(){if(Kp)return vs;Kp=1;var e=v,t=Bw();function n(r){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+r,m=1;m<arguments.length;m++)l+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+r+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,o={};function i(r,l){c(r,l),c(r+"Capture",l)}function c(r,l){for(o[r]=l,r=0;r<l.length;r++)s.add(l[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(r){return d.call(f,r)?!0:d.call(h,r)?!1:p.test(r)?f[r]=!0:(h[r]=!0,!1)}function w(r,l,m,y){if(m!==null&&m.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return y?!1:m!==null?!m.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function b(r,l,m,y){if(l===null||typeof l>"u"||w(r,l,m,y))return!0;if(y)return!1;if(m!==null)switch(m.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function _(r,l,m,y,k,O,B){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=y,this.attributeNamespace=k,this.mustUseProperty=m,this.propertyName=r,this.type=l,this.sanitizeURL=O,this.removeEmptyString=B}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){x[r]=new _(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var l=r[0];x[l]=new _(l,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){x[r]=new _(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){x[r]=new _(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){x[r]=new _(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){x[r]=new _(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){x[r]=new _(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){x[r]=new _(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){x[r]=new _(r,5,!1,r.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function C(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var l=r.replace(N,C);x[l]=new _(l,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var l=r.replace(N,C);x[l]=new _(l,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var l=r.replace(N,C);x[l]=new _(l,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){x[r]=new _(r,1,!1,r.toLowerCase(),null,!1,!1)}),x.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){x[r]=new _(r,1,!1,r.toLowerCase(),null,!0,!0)});function E(r,l,m,y){var k=x.hasOwnProperty(l)?x[l]:null;(k!==null?k.type!==0:y||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(b(l,m,k,y)&&(m=null),y||k===null?g(l)&&(m===null?r.removeAttribute(l):r.setAttribute(l,""+m)):k.mustUseProperty?r[k.propertyName]=m===null?k.type===3?!1:"":m:(l=k.attributeName,y=k.attributeNamespace,m===null?r.removeAttribute(l):(k=k.type,m=k===3||k===4&&m===!0?"":""+m,y?r.setAttributeNS(y,l,m):r.setAttribute(l,m))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),M=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),P=Symbol.for("react.strict_mode"),L=Symbol.for("react.profiler"),$=Symbol.for("react.provider"),A=Symbol.for("react.context"),R=Symbol.for("react.forward_ref"),W=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),H=Symbol.for("react.lazy"),q=Symbol.for("react.offscreen"),I=Symbol.iterator;function Q(r){return r===null||typeof r!="object"?null:(r=I&&r[I]||r["@@iterator"],typeof r=="function"?r:null)}var U=Object.assign,F;function K(r){if(F===void 0)try{throw Error()}catch(m){var l=m.stack.trim().match(/\n( *(at )?)/);F=l&&l[1]||""}return`
`+F+r}var re=!1;function Y(r,l){if(!r||re)return"";re=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(he){var y=he}Reflect.construct(r,[],l)}else{try{l.call()}catch(he){y=he}r.call(l.prototype)}else{try{throw Error()}catch(he){y=he}r()}}catch(he){if(he&&y&&typeof he.stack=="string"){for(var k=he.stack.split(`
`),O=y.stack.split(`
`),B=k.length-1,ee=O.length-1;1<=B&&0<=ee&&k[B]!==O[ee];)ee--;for(;1<=B&&0<=ee;B--,ee--)if(k[B]!==O[ee]){if(B!==1||ee!==1)do if(B--,ee--,0>ee||k[B]!==O[ee]){var ae=`
`+k[B].replace(" at new "," at ");return r.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",r.displayName)),ae}while(1<=B&&0<=ee);break}}}finally{re=!1,Error.prepareStackTrace=m}return(r=r?r.displayName||r.name:"")?K(r):""}function V(r){switch(r.tag){case 5:return K(r.type);case 16:return K("Lazy");case 13:return K("Suspense");case 19:return K("SuspenseList");case 0:case 2:case 15:return r=Y(r.type,!1),r;case 11:return r=Y(r.type.render,!1),r;case 1:return r=Y(r.type,!0),r;default:return""}}function G(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case T:return"Fragment";case M:return"Portal";case L:return"Profiler";case P:return"StrictMode";case W:return"Suspense";case z:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case A:return(r.displayName||"Context")+".Consumer";case $:return(r._context.displayName||"Context")+".Provider";case R:var l=r.render;return r=r.displayName,r||(r=l.displayName||l.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case D:return l=r.displayName||null,l!==null?l:G(r.type)||"Memo";case H:l=r._payload,r=r._init;try{return G(r(l))}catch{}}return null}function X(r){var l=r.type;switch(r.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=l.render,r=r.displayName||r.name||"",l.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G(l);case 8:return l===P?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function se(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function J(r){var l=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function te(r){var l=J(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,l),y=""+r[l];if(!r.hasOwnProperty(l)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var k=m.get,O=m.set;return Object.defineProperty(r,l,{configurable:!0,get:function(){return k.call(this)},set:function(B){y=""+B,O.call(this,B)}}),Object.defineProperty(r,l,{enumerable:m.enumerable}),{getValue:function(){return y},setValue:function(B){y=""+B},stopTracking:function(){r._valueTracker=null,delete r[l]}}}}function Se(r){r._valueTracker||(r._valueTracker=te(r))}function ze(r){if(!r)return!1;var l=r._valueTracker;if(!l)return!0;var m=l.getValue(),y="";return r&&(y=J(r)?r.checked?"true":"false":r.value),r=y,r!==m?(l.setValue(r),!0):!1}function Oe(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Ue(r,l){var m=l.checked;return U({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??r._wrapperState.initialChecked})}function nt(r,l){var m=l.defaultValue==null?"":l.defaultValue,y=l.checked!=null?l.checked:l.defaultChecked;m=se(l.value!=null?l.value:m),r._wrapperState={initialChecked:y,initialValue:m,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function He(r,l){l=l.checked,l!=null&&E(r,"checked",l,!1)}function de(r,l){He(r,l);var m=se(l.value),y=l.type;if(m!=null)y==="number"?(m===0&&r.value===""||r.value!=m)&&(r.value=""+m):r.value!==""+m&&(r.value=""+m);else if(y==="submit"||y==="reset"){r.removeAttribute("value");return}l.hasOwnProperty("value")?je(r,l.type,m):l.hasOwnProperty("defaultValue")&&je(r,l.type,se(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(r.defaultChecked=!!l.defaultChecked)}function _e(r,l,m){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var y=l.type;if(!(y!=="submit"&&y!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+r._wrapperState.initialValue,m||l===r.value||(r.value=l),r.defaultValue=l}m=r.name,m!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,m!==""&&(r.name=m)}function je(r,l,m){(l!=="number"||Oe(r.ownerDocument)!==r)&&(m==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+m&&(r.defaultValue=""+m))}var Me=Array.isArray;function De(r,l,m,y){if(r=r.options,l){l={};for(var k=0;k<m.length;k++)l["$"+m[k]]=!0;for(m=0;m<r.length;m++)k=l.hasOwnProperty("$"+r[m].value),r[m].selected!==k&&(r[m].selected=k),k&&y&&(r[m].defaultSelected=!0)}else{for(m=""+se(m),l=null,k=0;k<r.length;k++){if(r[k].value===m){r[k].selected=!0,y&&(r[k].defaultSelected=!0);return}l!==null||r[k].disabled||(l=r[k])}l!==null&&(l.selected=!0)}}function ce(r,l){if(l.dangerouslySetInnerHTML!=null)throw Error(n(91));return U({},l,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Te(r,l){var m=l.value;if(m==null){if(m=l.children,l=l.defaultValue,m!=null){if(l!=null)throw Error(n(92));if(Me(m)){if(1<m.length)throw Error(n(93));m=m[0]}l=m}l==null&&(l=""),m=l}r._wrapperState={initialValue:se(m)}}function Qe(r,l){var m=se(l.value),y=se(l.defaultValue);m!=null&&(m=""+m,m!==r.value&&(r.value=m),l.defaultValue==null&&r.defaultValue!==m&&(r.defaultValue=m)),y!=null&&(r.defaultValue=""+y)}function ht(r){var l=r.textContent;l===r._wrapperState.initialValue&&l!==""&&l!==null&&(r.value=l)}function rt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gt(r,l){return r==null||r==="http://www.w3.org/1999/xhtml"?rt(l):r==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var at,ut=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,m,y,k){MSApp.execUnsafeLocalFunction(function(){return r(l,m,y,k)})}:r}(function(r,l){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=l;else{for(at=at||document.createElement("div"),at.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=at.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;l.firstChild;)r.appendChild(l.firstChild)}});function Ot(r,l){if(l){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=l;return}}r.textContent=l}var Rt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Xe=["Webkit","ms","Moz","O"];Object.keys(Rt).forEach(function(r){Xe.forEach(function(l){l=l+r.charAt(0).toUpperCase()+r.substring(1),Rt[l]=Rt[r]})});function Bt(r,l,m){return l==null||typeof l=="boolean"||l===""?"":m||typeof l!="number"||l===0||Rt.hasOwnProperty(r)&&Rt[r]?(""+l).trim():l+"px"}function Kt(r,l){r=r.style;for(var m in l)if(l.hasOwnProperty(m)){var y=m.indexOf("--")===0,k=Bt(m,l[m],y);m==="float"&&(m="cssFloat"),y?r.setProperty(m,k):r[m]=k}}var kt=U({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function _t(r,l){if(l){if(kt[r]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(n(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(n(61))}if(l.style!=null&&typeof l.style!="object")throw Error(n(62))}}function Cn(r,l){if(r.indexOf("-")===-1)return typeof l.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Lt=null;function rn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var fe=null,Ut=null,dt=null;function Tn(r){if(r=jc(r)){if(typeof fe!="function")throw Error(n(280));var l=r.stateNode;l&&(l=Nd(l),fe(r.stateNode,r.type,l))}}function qe(r){Ut?dt?dt.push(r):dt=[r]:Ut=r}function wt(){if(Ut){var r=Ut,l=dt;if(dt=Ut=null,Tn(r),l)for(r=0;r<l.length;r++)Tn(l[r])}}function mt(r,l){return r(l)}function Ns(){}var Gt=!1;function vt(r,l,m){if(Gt)return r(l,m);Gt=!0;try{return mt(r,l,m)}finally{Gt=!1,(Ut!==null||dt!==null)&&(Ns(),wt())}}function jt(r,l){var m=r.stateNode;if(m===null)return null;var y=Nd(m);if(y===null)return null;m=y[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(y=!y.disabled)||(r=r.type,y=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!y;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(n(231,l,typeof m));return m}var Gn=!1;if(u)try{var on={};Object.defineProperty(on,"passive",{get:function(){Gn=!0}}),window.addEventListener("test",on,on),window.removeEventListener("test",on,on)}catch{Gn=!1}function Sn(r,l,m,y,k,O,B,ee,ae){var he=Array.prototype.slice.call(arguments,3);try{l.apply(m,he)}catch(xe){this.onError(xe)}}var Zt=!1,$n=null,ln=!1,Ht=null,It={onError:function(r){Zt=!0,$n=r}};function Fn(r,l,m,y,k,O,B,ee,ae){Zt=!1,$n=null,Sn.apply(It,arguments)}function cn(r,l,m,y,k,O,B,ee,ae){if(Fn.apply(this,arguments),Zt){if(Zt){var he=$n;Zt=!1,$n=null}else throw Error(n(198));ln||(ln=!0,Ht=he)}}function vn(r){var l=r,m=r;if(r.alternate)for(;l.return;)l=l.return;else{r=l;do l=r,l.flags&4098&&(m=l.return),r=l.return;while(r)}return l.tag===3?m:null}function et(r){if(r.tag===13){var l=r.memoizedState;if(l===null&&(r=r.alternate,r!==null&&(l=r.memoizedState)),l!==null)return l.dehydrated}return null}function Qn(r){if(vn(r)!==r)throw Error(n(188))}function Cs(r){var l=r.alternate;if(!l){if(l=vn(r),l===null)throw Error(n(188));return l!==r?null:r}for(var m=r,y=l;;){var k=m.return;if(k===null)break;var O=k.alternate;if(O===null){if(y=k.return,y!==null){m=y;continue}break}if(k.child===O.child){for(O=k.child;O;){if(O===m)return Qn(k),r;if(O===y)return Qn(k),l;O=O.sibling}throw Error(n(188))}if(m.return!==y.return)m=k,y=O;else{for(var B=!1,ee=k.child;ee;){if(ee===m){B=!0,m=k,y=O;break}if(ee===y){B=!0,y=k,m=O;break}ee=ee.sibling}if(!B){for(ee=O.child;ee;){if(ee===m){B=!0,m=O,y=k;break}if(ee===y){B=!0,y=O,m=k;break}ee=ee.sibling}if(!B)throw Error(n(189))}}if(m.alternate!==y)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?r:l}function In(r){return r=Cs(r),r!==null?Xn(r):null}function Xn(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var l=Xn(r);if(l!==null)return l;r=r.sibling}return null}var Ss=t.unstable_scheduleCallback,Bn=t.unstable_cancelCallback,Qt=t.unstable_shouldYield,Tt=t.unstable_requestPaint,lt=t.unstable_now,Ks=t.unstable_getCurrentPriorityLevel,Un=t.unstable_ImmediatePriority,Ys=t.unstable_UserBlockingPriority,os=t.unstable_NormalPriority,_r=t.unstable_LowPriority,le=t.unstable_IdlePriority,ge=null,Pe=null;function Nt(r){if(Pe&&typeof Pe.onCommitFiberRoot=="function")try{Pe.onCommitFiberRoot(ge,r,void 0,(r.current.flags&128)===128)}catch{}}var we=Math.clz32?Math.clz32:Ct,tt=Math.log,it=Math.LN2;function Ct(r){return r>>>=0,r===0?32:31-(tt(r)/it|0)|0}var $t=64,en=4194304;function qt(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function un(r,l){var m=r.pendingLanes;if(m===0)return 0;var y=0,k=r.suspendedLanes,O=r.pingedLanes,B=m&268435455;if(B!==0){var ee=B&~k;ee!==0?y=qt(ee):(O&=B,O!==0&&(y=qt(O)))}else B=m&~k,B!==0?y=qt(B):O!==0&&(y=qt(O));if(y===0)return 0;if(l!==0&&l!==y&&!(l&k)&&(k=y&-y,O=l&-l,k>=O||k===16&&(O&4194240)!==0))return l;if(y&4&&(y|=m&16),l=r.entangledLanes,l!==0)for(r=r.entanglements,l&=y;0<l;)m=31-we(l),k=1<<m,y|=r[m],l&=~k;return y}function Es(r,l){switch(r){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jn(r,l){for(var m=r.suspendedLanes,y=r.pingedLanes,k=r.expirationTimes,O=r.pendingLanes;0<O;){var B=31-we(O),ee=1<<B,ae=k[B];ae===-1?(!(ee&m)||ee&y)&&(k[B]=Es(ee,l)):ae<=l&&(r.expiredLanes|=ee),O&=~ee}}function En(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function kn(){var r=$t;return $t<<=1,!($t&4194240)&&($t=64),r}function Zn(r){for(var l=[],m=0;31>m;m++)l.push(r);return l}function qn(r,l,m){r.pendingLanes|=l,l!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,l=31-we(l),r[l]=m}function Tr(r,l){var m=r.pendingLanes&~l;r.pendingLanes=l,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=l,r.mutableReadLanes&=l,r.entangledLanes&=l,l=r.entanglements;var y=r.eventTimes;for(r=r.expirationTimes;0<m;){var k=31-we(m),O=1<<k;l[k]=0,y[k]=-1,r[k]=-1,m&=~O}}function Ra(r,l){var m=r.entangledLanes|=l;for(r=r.entanglements;m;){var y=31-we(m),k=1<<y;k&l|r[y]&l&&(r[y]|=l),m&=~k}}var bt=0;function ea(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Da,Fo,Bl,Io,vr,sr=!1,ks=[],es=null,Z=null,pe=null,me=new Map,ke=new Map,Ce=[],ye="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function st(r,l){switch(r){case"focusin":case"focusout":es=null;break;case"dragenter":case"dragleave":Z=null;break;case"mouseover":case"mouseout":pe=null;break;case"pointerover":case"pointerout":me.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":ke.delete(l.pointerId)}}function Ie(r,l,m,y,k,O){return r===null||r.nativeEvent!==O?(r={blockedOn:l,domEventName:m,eventSystemFlags:y,nativeEvent:O,targetContainers:[k]},l!==null&&(l=jc(l),l!==null&&Fo(l)),r):(r.eventSystemFlags|=y,l=r.targetContainers,k!==null&&l.indexOf(k)===-1&&l.push(k),r)}function We(r,l,m,y,k){switch(l){case"focusin":return es=Ie(es,r,l,m,y,k),!0;case"dragenter":return Z=Ie(Z,r,l,m,y,k),!0;case"mouseover":return pe=Ie(pe,r,l,m,y,k),!0;case"pointerover":var O=k.pointerId;return me.set(O,Ie(me.get(O)||null,r,l,m,y,k)),!0;case"gotpointercapture":return O=k.pointerId,ke.set(O,Ie(ke.get(O)||null,r,l,m,y,k)),!0}return!1}function ot(r){var l=Qo(r.target);if(l!==null){var m=vn(l);if(m!==null){if(l=m.tag,l===13){if(l=et(m),l!==null){r.blockedOn=l,vr(r.priority,function(){Bl(m)});return}}else if(l===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Ge(r){if(r.blockedOn!==null)return!1;for(var l=r.targetContainers;0<l.length;){var m=ls(r.domEventName,r.eventSystemFlags,l[0],r.nativeEvent);if(m===null){m=r.nativeEvent;var y=new m.constructor(m.type,m);Lt=y,m.target.dispatchEvent(y),Lt=null}else return l=jc(m),l!==null&&Fo(l),r.blockedOn=m,!1;l.shift()}return!0}function Et(r,l,m){Ge(r)&&m.delete(l)}function Mn(){sr=!1,es!==null&&Ge(es)&&(es=null),Z!==null&&Ge(Z)&&(Z=null),pe!==null&&Ge(pe)&&(pe=null),me.forEach(Et),ke.forEach(Et)}function Vt(r,l){r.blockedOn===l&&(r.blockedOn=null,sr||(sr=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Mn)))}function yn(r){function l(k){return Vt(k,r)}if(0<ks.length){Vt(ks[0],r);for(var m=1;m<ks.length;m++){var y=ks[m];y.blockedOn===r&&(y.blockedOn=null)}}for(es!==null&&Vt(es,r),Z!==null&&Vt(Z,r),pe!==null&&Vt(pe,r),me.forEach(l),ke.forEach(l),m=0;m<Ce.length;m++)y=Ce[m],y.blockedOn===r&&(y.blockedOn=null);for(;0<Ce.length&&(m=Ce[0],m.blockedOn===null);)ot(m),m.blockedOn===null&&Ce.shift()}var Ms=j.ReactCurrentBatchConfig,As=!0;function Gs(r,l,m,y){var k=bt,O=Ms.transition;Ms.transition=null;try{bt=1,rr(r,l,m,y)}finally{bt=k,Ms.transition=O}}function $r(r,l,m,y){var k=bt,O=Ms.transition;Ms.transition=null;try{bt=4,rr(r,l,m,y)}finally{bt=k,Ms.transition=O}}function rr(r,l,m,y){if(As){var k=ls(r,l,m,y);if(k===null)Ql(r,l,y,ts,m),st(r,y);else if(We(k,r,l,m,y))y.stopPropagation();else if(st(r,y),l&4&&-1<ye.indexOf(r)){for(;k!==null;){var O=jc(k);if(O!==null&&Da(O),O=ls(r,l,m,y),O===null&&Ql(r,l,y,ts,m),O===k)break;k=O}k!==null&&y.stopPropagation()}else Ql(r,l,y,null,m)}}var ts=null;function ls(r,l,m,y){if(ts=null,r=rn(y),r=Qo(r),r!==null)if(l=vn(r),l===null)r=null;else if(m=l.tag,m===13){if(r=et(l),r!==null)return r;r=null}else if(m===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;r=null}else l!==r&&(r=null);return ts=r,null}function Fa(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ks()){case Un:return 1;case Ys:return 4;case os:case _r:return 16;case le:return 536870912;default:return 16}default:return 16}}var Os=null,ta=null,Pr=null;function Ia(){if(Pr)return Pr;var r,l=ta,m=l.length,y,k="value"in Os?Os.value:Os.textContent,O=k.length;for(r=0;r<m&&l[r]===k[r];r++);var B=m-r;for(y=1;y<=B&&l[m-y]===k[O-y];y++);return Pr=k.slice(r,1<y?1-y:void 0)}function na(r){var l=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&l===13&&(r=13)):r=l,r===10&&(r=13),32<=r||r===13?r:0}function sa(){return!0}function ra(){return!1}function Pn(r){function l(m,y,k,O,B){this._reactName=m,this._targetInst=k,this.type=y,this.nativeEvent=O,this.target=B,this.currentTarget=null;for(var ee in r)r.hasOwnProperty(ee)&&(m=r[ee],this[ee]=m?m(O):O[ee]);return this.isDefaultPrevented=(O.defaultPrevented!=null?O.defaultPrevented:O.returnValue===!1)?sa:ra,this.isPropagationStopped=ra,this}return U(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=sa)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=sa)},persist:function(){},isPersistent:sa}),l}var tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},aa=Pn(tn),Ts=U({},tn,{view:0,detail:0}),Ul=Pn(Ts),Bo,nn,bn,is=U({},Ts,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==bn&&(bn&&r.type==="mousemove"?(Bo=r.screenX-bn.screenX,nn=r.screenY-bn.screenY):nn=Bo=0,bn=r),Bo)},movementY:function(r){return"movementY"in r?r.movementY:nn}}),Uo=Pn(is),Qu=U({},is,{dataTransfer:0}),of=Pn(Qu),rc=U({},Ts,{relatedTarget:0}),ac=Pn(rc),ql=U({},tn,{animationName:0,elapsedTime:0,pseudoElement:0}),oc=Pn(ql),lf=U({},tn,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),cf=Pn(lf),uf=U({},tn,{data:0}),Lr=Pn(uf),lc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ic={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qo={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Hl(r){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(r):(r=qo[r])?!!l[r]:!1}function zr(){return Hl}var oa=U({},Ts,{key:function(r){if(r.key){var l=lc[r.key]||r.key;if(l!=="Unidentified")return l}return r.type==="keypress"?(r=na(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ic[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zr,charCode:function(r){return r.type==="keypress"?na(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?na(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),df=Pn(oa),Xu=U({},is,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dn=Pn(Xu),mn=U({},Ts,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zr}),ft=Pn(mn),Qs=U({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0}),mf=Pn(Qs),hf=U({},is,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),Ho=Pn(hf),Ju=[9,13,27,32],cc=u&&"CompositionEvent"in window,Xt=null;u&&"documentMode"in document&&(Xt=document.documentMode);var ff=u&&"TextEvent"in window&&!Xt,Zu=u&&(!cc||Xt&&8<Xt&&11>=Xt),ed=" ",td=!1;function Vl(r,l){switch(r){case"keyup":return Ju.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var la=!1;function nd(r,l){switch(r){case"compositionend":return uc(l);case"keypress":return l.which!==32?null:(td=!0,ed);case"textInput":return r=l.data,r===ed&&td?null:r;default:return null}}function sd(r,l){if(la)return r==="compositionend"||!cc&&Vl(r,l)?(r=Ia(),Pr=ta=Os=null,la=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return Zu&&l.locale!=="ko"?null:l.data;default:return null}}var pf={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function yr(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l==="input"?!!pf[r.type]:l==="textarea"}function dc(r,l,m,y){qe(y),l=Yo(l,"onChange"),0<l.length&&(m=new aa("onChange","change",null,m,y),r.push({event:m,listeners:l}))}var Ba=null,Ua=null;function rd(r){wd(r,0)}function qa(r){var l=Jl(r);if(ze(l))return r}function ad(r,l){if(r==="change")return l}var mc=!1;if(u){var Wl;if(u){var hc="oninput"in document;if(!hc){var od=document.createElement("div");od.setAttribute("oninput","return;"),hc=typeof od.oninput=="function"}Wl=hc}else Wl=!1;mc=Wl&&(!document.documentMode||9<document.documentMode)}function ld(){Ba&&(Ba.detachEvent("onpropertychange",id),Ua=Ba=null)}function id(r){if(r.propertyName==="value"&&qa(Ua)){var l=[];dc(l,Ua,r,rn(r)),vt(rd,l)}}function gf(r,l,m){r==="focusin"?(ld(),Ba=l,Ua=m,Ba.attachEvent("onpropertychange",id)):r==="focusout"&&ld()}function _f(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return qa(Ua)}function vf(r,l){if(r==="click")return qa(l)}function yf(r,l){if(r==="input"||r==="change")return qa(l)}function Kl(r,l){return r===l&&(r!==0||1/r===1/l)||r!==r&&l!==l}var $s=typeof Object.is=="function"?Object.is:Kl;function Vo(r,l){if($s(r,l))return!0;if(typeof r!="object"||r===null||typeof l!="object"||l===null)return!1;var m=Object.keys(r),y=Object.keys(l);if(m.length!==y.length)return!1;for(y=0;y<m.length;y++){var k=m[y];if(!d.call(l,k)||!$s(r[k],l[k]))return!1}return!0}function cd(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ud(r,l){var m=cd(r);r=0;for(var y;m;){if(m.nodeType===3){if(y=r+m.textContent.length,r<=l&&y>=l)return{node:m,offset:l-r};r=y}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=cd(m)}}function dd(r,l){return r&&l?r===l?!0:r&&r.nodeType===3?!1:l&&l.nodeType===3?dd(r,l.parentNode):"contains"in r?r.contains(l):r.compareDocumentPosition?!!(r.compareDocumentPosition(l)&16):!1:!1}function md(){for(var r=window,l=Oe();l instanceof r.HTMLIFrameElement;){try{var m=typeof l.contentWindow.location.href=="string"}catch{m=!1}if(m)r=l.contentWindow;else break;l=Oe(r.document)}return l}function fc(r){var l=r&&r.nodeName&&r.nodeName.toLowerCase();return l&&(l==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||l==="textarea"||r.contentEditable==="true")}function bf(r){var l=md(),m=r.focusedElem,y=r.selectionRange;if(l!==m&&m&&m.ownerDocument&&dd(m.ownerDocument.documentElement,m)){if(y!==null&&fc(m)){if(l=y.start,r=y.end,r===void 0&&(r=l),"selectionStart"in m)m.selectionStart=l,m.selectionEnd=Math.min(r,m.value.length);else if(r=(l=m.ownerDocument||document)&&l.defaultView||window,r.getSelection){r=r.getSelection();var k=m.textContent.length,O=Math.min(y.start,k);y=y.end===void 0?O:Math.min(y.end,k),!r.extend&&O>y&&(k=y,y=O,O=k),k=ud(m,O);var B=ud(m,y);k&&B&&(r.rangeCount!==1||r.anchorNode!==k.node||r.anchorOffset!==k.offset||r.focusNode!==B.node||r.focusOffset!==B.offset)&&(l=l.createRange(),l.setStart(k.node,k.offset),r.removeAllRanges(),O>y?(r.addRange(l),r.extend(B.node,B.offset)):(l.setEnd(B.node,B.offset),r.addRange(l)))}}for(l=[],r=m;r=r.parentNode;)r.nodeType===1&&l.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<l.length;m++)r=l[m],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var xf=u&&"documentMode"in document&&11>=document.documentMode,Ha=null,pc=null,Wo=null,gc=!1;function hd(r,l,m){var y=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;gc||Ha==null||Ha!==Oe(y)||(y=Ha,"selectionStart"in y&&fc(y)?y={start:y.selectionStart,end:y.selectionEnd}:(y=(y.ownerDocument&&y.ownerDocument.defaultView||window).getSelection(),y={anchorNode:y.anchorNode,anchorOffset:y.anchorOffset,focusNode:y.focusNode,focusOffset:y.focusOffset}),Wo&&Vo(Wo,y)||(Wo=y,y=Yo(pc,"onSelect"),0<y.length&&(l=new aa("onSelect","select",null,l,m),r.push({event:l,listeners:y}),l.target=Ha)))}function Yl(r,l){var m={};return m[r.toLowerCase()]=l.toLowerCase(),m["Webkit"+r]="webkit"+l,m["Moz"+r]="moz"+l,m}var Va={animationend:Yl("Animation","AnimationEnd"),animationiteration:Yl("Animation","AnimationIteration"),animationstart:Yl("Animation","AnimationStart"),transitionend:Yl("Transition","TransitionEnd")},_c={},fd={};u&&(fd=document.createElement("div").style,"AnimationEvent"in window||(delete Va.animationend.animation,delete Va.animationiteration.animation,delete Va.animationstart.animation),"TransitionEvent"in window||delete Va.transitionend.transition);function Gl(r){if(_c[r])return _c[r];if(!Va[r])return r;var l=Va[r],m;for(m in l)if(l.hasOwnProperty(m)&&m in fd)return _c[r]=l[m];return r}var pd=Gl("animationend"),gd=Gl("animationiteration"),_d=Gl("animationstart"),vd=Gl("transitionend"),yd=new Map,bd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(r,l){yd.set(r,l),i(l,[r])}for(var vc=0;vc<bd.length;vc++){var yc=bd[vc],wf=yc.toLowerCase(),jf=yc[0].toUpperCase()+yc.slice(1);Rr(wf,"on"+jf)}Rr(pd,"onAnimationEnd"),Rr(gd,"onAnimationIteration"),Rr(_d,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(vd,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ko="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ko));function xd(r,l,m){var y=r.type||"unknown-event";r.currentTarget=m,cn(y,l,void 0,r),r.currentTarget=null}function wd(r,l){l=(l&4)!==0;for(var m=0;m<r.length;m++){var y=r[m],k=y.event;y=y.listeners;e:{var O=void 0;if(l)for(var B=y.length-1;0<=B;B--){var ee=y[B],ae=ee.instance,he=ee.currentTarget;if(ee=ee.listener,ae!==O&&k.isPropagationStopped())break e;xd(k,ee,he),O=ae}else for(B=0;B<y.length;B++){if(ee=y[B],ae=ee.instance,he=ee.currentTarget,ee=ee.listener,ae!==O&&k.isPropagationStopped())break e;xd(k,ee,he),O=ae}}}if(ln)throw r=Ht,ln=!1,Ht=null,r}function Yt(r,l){var m=l[Mf];m===void 0&&(m=l[Mf]=new Set);var y=r+"__bubble";m.has(y)||(jd(l,r,2,!1),m.add(y))}function bc(r,l,m){var y=0;l&&(y|=4),jd(m,r,y,l)}var Ps="_reactListening"+Math.random().toString(36).slice(2);function Mt(r){if(!r[Ps]){r[Ps]=!0,s.forEach(function(m){m!=="selectionchange"&&(Nf.has(m)||bc(m,!1,r),bc(m,!0,r))});var l=r.nodeType===9?r:r.ownerDocument;l===null||l[Ps]||(l[Ps]=!0,bc("selectionchange",!1,l))}}function jd(r,l,m,y){switch(Fa(l)){case 1:var k=Gs;break;case 4:k=$r;break;default:k=rr}m=k.bind(null,l,m,r),k=void 0,!Gn||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(k=!0),y?k!==void 0?r.addEventListener(l,m,{capture:!0,passive:k}):r.addEventListener(l,m,!0):k!==void 0?r.addEventListener(l,m,{passive:k}):r.addEventListener(l,m,!1)}function Ql(r,l,m,y,k){var O=y;if(!(l&1)&&!(l&2)&&y!==null)e:for(;;){if(y===null)return;var B=y.tag;if(B===3||B===4){var ee=y.stateNode.containerInfo;if(ee===k||ee.nodeType===8&&ee.parentNode===k)break;if(B===4)for(B=y.return;B!==null;){var ae=B.tag;if((ae===3||ae===4)&&(ae=B.stateNode.containerInfo,ae===k||ae.nodeType===8&&ae.parentNode===k))return;B=B.return}for(;ee!==null;){if(B=Qo(ee),B===null)return;if(ae=B.tag,ae===5||ae===6){y=O=B;continue e}ee=ee.parentNode}}y=y.return}vt(function(){var he=O,xe=rn(m),Ne=[];e:{var be=yd.get(r);if(be!==void 0){var Le=aa,Fe=r;switch(r){case"keypress":if(na(m)===0)break e;case"keydown":case"keyup":Le=df;break;case"focusin":Fe="focus",Le=ac;break;case"focusout":Fe="blur",Le=ac;break;case"beforeblur":case"afterblur":Le=ac;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=Uo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=of;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=ft;break;case pd:case gd:case _d:Le=oc;break;case vd:Le=mf;break;case"scroll":Le=Ul;break;case"wheel":Le=Ho;break;case"copy":case"cut":case"paste":Le=cf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=dn}var Be=(l&4)!==0,xn=!Be&&r==="scroll",ie=Be?be!==null?be+"Capture":null:be;Be=[];for(var oe=he,ue;oe!==null;){ue=oe;var Ee=ue.stateNode;if(ue.tag===5&&Ee!==null&&(ue=Ee,ie!==null&&(Ee=jt(oe,ie),Ee!=null&&Be.push(Wa(oe,Ee,ue)))),xn)break;oe=oe.return}0<Be.length&&(be=new Le(be,Fe,null,m,xe),Ne.push({event:be,listeners:Be}))}}if(!(l&7)){e:{if(be=r==="mouseover"||r==="pointerover",Le=r==="mouseout"||r==="pointerout",be&&m!==Lt&&(Fe=m.relatedTarget||m.fromElement)&&(Qo(Fe)||Fe[da]))break e;if((Le||be)&&(be=xe.window===xe?xe:(be=xe.ownerDocument)?be.defaultView||be.parentWindow:window,Le?(Fe=m.relatedTarget||m.toElement,Le=he,Fe=Fe?Qo(Fe):null,Fe!==null&&(xn=vn(Fe),Fe!==xn||Fe.tag!==5&&Fe.tag!==6)&&(Fe=null)):(Le=null,Fe=he),Le!==Fe)){if(Be=Uo,Ee="onMouseLeave",ie="onMouseEnter",oe="mouse",(r==="pointerout"||r==="pointerover")&&(Be=dn,Ee="onPointerLeave",ie="onPointerEnter",oe="pointer"),xn=Le==null?be:Jl(Le),ue=Fe==null?be:Jl(Fe),be=new Be(Ee,oe+"leave",Le,m,xe),be.target=xn,be.relatedTarget=ue,Ee=null,Qo(xe)===he&&(Be=new Be(ie,oe+"enter",Fe,m,xe),Be.target=ue,Be.relatedTarget=xn,Ee=Be),xn=Ee,Le&&Fe)t:{for(Be=Le,ie=Fe,oe=0,ue=Be;ue;ue=ia(ue))oe++;for(ue=0,Ee=ie;Ee;Ee=ia(Ee))ue++;for(;0<oe-ue;)Be=ia(Be),oe--;for(;0<ue-oe;)ie=ia(ie),ue--;for(;oe--;){if(Be===ie||ie!==null&&Be===ie.alternate)break t;Be=ia(Be),ie=ia(ie)}Be=null}else Be=null;Le!==null&&xc(Ne,be,Le,Be,!1),Fe!==null&&xn!==null&&xc(Ne,xn,Fe,Be,!0)}}e:{if(be=he?Jl(he):window,Le=be.nodeName&&be.nodeName.toLowerCase(),Le==="select"||Le==="input"&&be.type==="file")var Ve=ad;else if(yr(be))if(mc)Ve=yf;else{Ve=_f;var Je=gf}else(Le=be.nodeName)&&Le.toLowerCase()==="input"&&(be.type==="checkbox"||be.type==="radio")&&(Ve=vf);if(Ve&&(Ve=Ve(r,he))){dc(Ne,Ve,m,xe);break e}Je&&Je(r,be,he),r==="focusout"&&(Je=be._wrapperState)&&Je.controlled&&be.type==="number"&&je(be,"number",be.value)}switch(Je=he?Jl(he):window,r){case"focusin":(yr(Je)||Je.contentEditable==="true")&&(Ha=Je,pc=he,Wo=null);break;case"focusout":Wo=pc=Ha=null;break;case"mousedown":gc=!0;break;case"contextmenu":case"mouseup":case"dragend":gc=!1,hd(Ne,m,xe);break;case"selectionchange":if(xf)break;case"keydown":case"keyup":hd(Ne,m,xe)}var Ze;if(cc)e:{switch(r){case"compositionstart":var ct="onCompositionStart";break e;case"compositionend":ct="onCompositionEnd";break e;case"compositionupdate":ct="onCompositionUpdate";break e}ct=void 0}else la?Vl(r,m)&&(ct="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(ct="onCompositionStart");ct&&(Zu&&m.locale!=="ko"&&(la||ct!=="onCompositionStart"?ct==="onCompositionEnd"&&la&&(Ze=Ia()):(Os=xe,ta="value"in Os?Os.value:Os.textContent,la=!0)),Je=Yo(he,ct),0<Je.length&&(ct=new Lr(ct,r,null,m,xe),Ne.push({event:ct,listeners:Je}),Ze?ct.data=Ze:(Ze=uc(m),Ze!==null&&(ct.data=Ze)))),(Ze=ff?nd(r,m):sd(r,m))&&(he=Yo(he,"onBeforeInput"),0<he.length&&(xe=new Lr("onBeforeInput","beforeinput",null,m,xe),Ne.push({event:xe,listeners:he}),xe.data=Ze))}wd(Ne,l)})}function Wa(r,l,m){return{instance:r,listener:l,currentTarget:m}}function Yo(r,l){for(var m=l+"Capture",y=[];r!==null;){var k=r,O=k.stateNode;k.tag===5&&O!==null&&(k=O,O=jt(r,m),O!=null&&y.unshift(Wa(r,O,k)),O=jt(r,l),O!=null&&y.push(Wa(r,O,k))),r=r.return}return y}function ia(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function xc(r,l,m,y,k){for(var O=l._reactName,B=[];m!==null&&m!==y;){var ee=m,ae=ee.alternate,he=ee.stateNode;if(ae!==null&&ae===y)break;ee.tag===5&&he!==null&&(ee=he,k?(ae=jt(m,O),ae!=null&&B.unshift(Wa(m,ae,ee))):k||(ae=jt(m,O),ae!=null&&B.push(Wa(m,ae,ee)))),m=m.return}B.length!==0&&r.push({event:l,listeners:B})}var Dt=/\r\n?/g,Xs=/\u0000|\uFFFD/g;function ca(r){return(typeof r=="string"?r:""+r).replace(Dt,`
`).replace(Xs,"")}function Ka(r,l,m){if(l=ca(l),ca(r)!==l&&m)throw Error(n(425))}function ua(){}var Go=null,Cf=null;function Sf(r,l){return r==="textarea"||r==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Ef=typeof setTimeout=="function"?setTimeout:void 0,Sz=typeof clearTimeout=="function"?clearTimeout:void 0,n0=typeof Promise=="function"?Promise:void 0,Ez=typeof queueMicrotask=="function"?queueMicrotask:typeof n0<"u"?function(r){return n0.resolve(null).then(r).catch(kz)}:Ef;function kz(r){setTimeout(function(){throw r})}function kf(r,l){var m=l,y=0;do{var k=m.nextSibling;if(r.removeChild(m),k&&k.nodeType===8)if(m=k.data,m==="/$"){if(y===0){r.removeChild(k),yn(l);return}y--}else m!=="$"&&m!=="$?"&&m!=="$!"||y++;m=k}while(m);yn(l)}function Ya(r){for(;r!=null;r=r.nextSibling){var l=r.nodeType;if(l===1||l===3)break;if(l===8){if(l=r.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return r}function s0(r){r=r.previousSibling;for(var l=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(l===0)return r;l--}else m==="/$"&&l++}r=r.previousSibling}return null}var Xl=Math.random().toString(36).slice(2),Dr="__reactFiber$"+Xl,wc="__reactProps$"+Xl,da="__reactContainer$"+Xl,Mf="__reactEvents$"+Xl,Mz="__reactListeners$"+Xl,Az="__reactHandles$"+Xl;function Qo(r){var l=r[Dr];if(l)return l;for(var m=r.parentNode;m;){if(l=m[da]||m[Dr]){if(m=l.alternate,l.child!==null||m!==null&&m.child!==null)for(r=s0(r);r!==null;){if(m=r[Dr])return m;r=s0(r)}return l}r=m,m=r.parentNode}return null}function jc(r){return r=r[Dr]||r[da],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Jl(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function Nd(r){return r[wc]||null}var Af=[],Zl=-1;function Ga(r){return{current:r}}function sn(r){0>Zl||(r.current=Af[Zl],Af[Zl]=null,Zl--)}function Jt(r,l){Zl++,Af[Zl]=r.current,r.current=l}var Qa={},cs=Ga(Qa),Ls=Ga(!1),Xo=Qa;function ei(r,l){var m=r.type.contextTypes;if(!m)return Qa;var y=r.stateNode;if(y&&y.__reactInternalMemoizedUnmaskedChildContext===l)return y.__reactInternalMemoizedMaskedChildContext;var k={},O;for(O in m)k[O]=l[O];return y&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=l,r.__reactInternalMemoizedMaskedChildContext=k),k}function zs(r){return r=r.childContextTypes,r!=null}function Cd(){sn(Ls),sn(cs)}function r0(r,l,m){if(cs.current!==Qa)throw Error(n(168));Jt(cs,l),Jt(Ls,m)}function a0(r,l,m){var y=r.stateNode;if(l=l.childContextTypes,typeof y.getChildContext!="function")return m;y=y.getChildContext();for(var k in y)if(!(k in l))throw Error(n(108,X(r)||"Unknown",k));return U({},m,y)}function Sd(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Qa,Xo=cs.current,Jt(cs,r),Jt(Ls,Ls.current),!0}function o0(r,l,m){var y=r.stateNode;if(!y)throw Error(n(169));m?(r=a0(r,l,Xo),y.__reactInternalMemoizedMergedChildContext=r,sn(Ls),sn(cs),Jt(cs,r)):sn(Ls),Jt(Ls,m)}var ma=null,Ed=!1,Of=!1;function l0(r){ma===null?ma=[r]:ma.push(r)}function Oz(r){Ed=!0,l0(r)}function Xa(){if(!Of&&ma!==null){Of=!0;var r=0,l=bt;try{var m=ma;for(bt=1;r<m.length;r++){var y=m[r];do y=y(!0);while(y!==null)}ma=null,Ed=!1}catch(k){throw ma!==null&&(ma=ma.slice(r+1)),Ss(Un,Xa),k}finally{bt=l,Of=!1}}return null}var ti=[],ni=0,kd=null,Md=0,ar=[],or=0,Jo=null,ha=1,fa="";function Zo(r,l){ti[ni++]=Md,ti[ni++]=kd,kd=r,Md=l}function i0(r,l,m){ar[or++]=ha,ar[or++]=fa,ar[or++]=Jo,Jo=r;var y=ha;r=fa;var k=32-we(y)-1;y&=~(1<<k),m+=1;var O=32-we(l)+k;if(30<O){var B=k-k%5;O=(y&(1<<B)-1).toString(32),y>>=B,k-=B,ha=1<<32-we(l)+k|m<<k|y,fa=O+r}else ha=1<<O|m<<k|y,fa=r}function Tf(r){r.return!==null&&(Zo(r,1),i0(r,1,0))}function $f(r){for(;r===kd;)kd=ti[--ni],ti[ni]=null,Md=ti[--ni],ti[ni]=null;for(;r===Jo;)Jo=ar[--or],ar[or]=null,fa=ar[--or],ar[or]=null,ha=ar[--or],ar[or]=null}var Js=null,Zs=null,an=!1,br=null;function c0(r,l){var m=ur(5,null,null,0);m.elementType="DELETED",m.stateNode=l,m.return=r,l=r.deletions,l===null?(r.deletions=[m],r.flags|=16):l.push(m)}function u0(r,l){switch(r.tag){case 5:var m=r.type;return l=l.nodeType!==1||m.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(r.stateNode=l,Js=r,Zs=Ya(l.firstChild),!0):!1;case 6:return l=r.pendingProps===""||l.nodeType!==3?null:l,l!==null?(r.stateNode=l,Js=r,Zs=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(m=Jo!==null?{id:ha,overflow:fa}:null,r.memoizedState={dehydrated:l,treeContext:m,retryLane:1073741824},m=ur(18,null,null,0),m.stateNode=l,m.return=r,r.child=m,Js=r,Zs=null,!0):!1;default:return!1}}function Pf(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Lf(r){if(an){var l=Zs;if(l){var m=l;if(!u0(r,l)){if(Pf(r))throw Error(n(418));l=Ya(m.nextSibling);var y=Js;l&&u0(r,l)?c0(y,m):(r.flags=r.flags&-4097|2,an=!1,Js=r)}}else{if(Pf(r))throw Error(n(418));r.flags=r.flags&-4097|2,an=!1,Js=r}}}function d0(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Js=r}function Ad(r){if(r!==Js)return!1;if(!an)return d0(r),an=!0,!1;var l;if((l=r.tag!==3)&&!(l=r.tag!==5)&&(l=r.type,l=l!=="head"&&l!=="body"&&!Sf(r.type,r.memoizedProps)),l&&(l=Zs)){if(Pf(r))throw m0(),Error(n(418));for(;l;)c0(r,l),l=Ya(l.nextSibling)}if(d0(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,l=0;r;){if(r.nodeType===8){var m=r.data;if(m==="/$"){if(l===0){Zs=Ya(r.nextSibling);break e}l--}else m!=="$"&&m!=="$!"&&m!=="$?"||l++}r=r.nextSibling}Zs=null}}else Zs=Js?Ya(r.stateNode.nextSibling):null;return!0}function m0(){for(var r=Zs;r;)r=Ya(r.nextSibling)}function si(){Zs=Js=null,an=!1}function zf(r){br===null?br=[r]:br.push(r)}var Tz=j.ReactCurrentBatchConfig;function Nc(r,l,m){if(r=m.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(n(309));var y=m.stateNode}if(!y)throw Error(n(147,r));var k=y,O=""+r;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===O?l.ref:(l=function(B){var ee=k.refs;B===null?delete ee[O]:ee[O]=B},l._stringRef=O,l)}if(typeof r!="string")throw Error(n(284));if(!m._owner)throw Error(n(290,r))}return r}function Od(r,l){throw r=Object.prototype.toString.call(l),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":r))}function h0(r){var l=r._init;return l(r._payload)}function f0(r){function l(ie,oe){if(r){var ue=ie.deletions;ue===null?(ie.deletions=[oe],ie.flags|=16):ue.push(oe)}}function m(ie,oe){if(!r)return null;for(;oe!==null;)l(ie,oe),oe=oe.sibling;return null}function y(ie,oe){for(ie=new Map;oe!==null;)oe.key!==null?ie.set(oe.key,oe):ie.set(oe.index,oe),oe=oe.sibling;return ie}function k(ie,oe){return ie=ao(ie,oe),ie.index=0,ie.sibling=null,ie}function O(ie,oe,ue){return ie.index=ue,r?(ue=ie.alternate,ue!==null?(ue=ue.index,ue<oe?(ie.flags|=2,oe):ue):(ie.flags|=2,oe)):(ie.flags|=1048576,oe)}function B(ie){return r&&ie.alternate===null&&(ie.flags|=2),ie}function ee(ie,oe,ue,Ee){return oe===null||oe.tag!==6?(oe=Ep(ue,ie.mode,Ee),oe.return=ie,oe):(oe=k(oe,ue),oe.return=ie,oe)}function ae(ie,oe,ue,Ee){var Ve=ue.type;return Ve===T?xe(ie,oe,ue.props.children,Ee,ue.key):oe!==null&&(oe.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===H&&h0(Ve)===oe.type)?(Ee=k(oe,ue.props),Ee.ref=Nc(ie,oe,ue),Ee.return=ie,Ee):(Ee=tm(ue.type,ue.key,ue.props,null,ie.mode,Ee),Ee.ref=Nc(ie,oe,ue),Ee.return=ie,Ee)}function he(ie,oe,ue,Ee){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==ue.containerInfo||oe.stateNode.implementation!==ue.implementation?(oe=kp(ue,ie.mode,Ee),oe.return=ie,oe):(oe=k(oe,ue.children||[]),oe.return=ie,oe)}function xe(ie,oe,ue,Ee,Ve){return oe===null||oe.tag!==7?(oe=ll(ue,ie.mode,Ee,Ve),oe.return=ie,oe):(oe=k(oe,ue),oe.return=ie,oe)}function Ne(ie,oe,ue){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Ep(""+oe,ie.mode,ue),oe.return=ie,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case S:return ue=tm(oe.type,oe.key,oe.props,null,ie.mode,ue),ue.ref=Nc(ie,null,oe),ue.return=ie,ue;case M:return oe=kp(oe,ie.mode,ue),oe.return=ie,oe;case H:var Ee=oe._init;return Ne(ie,Ee(oe._payload),ue)}if(Me(oe)||Q(oe))return oe=ll(oe,ie.mode,ue,null),oe.return=ie,oe;Od(ie,oe)}return null}function be(ie,oe,ue,Ee){var Ve=oe!==null?oe.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return Ve!==null?null:ee(ie,oe,""+ue,Ee);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case S:return ue.key===Ve?ae(ie,oe,ue,Ee):null;case M:return ue.key===Ve?he(ie,oe,ue,Ee):null;case H:return Ve=ue._init,be(ie,oe,Ve(ue._payload),Ee)}if(Me(ue)||Q(ue))return Ve!==null?null:xe(ie,oe,ue,Ee,null);Od(ie,ue)}return null}function Le(ie,oe,ue,Ee,Ve){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return ie=ie.get(ue)||null,ee(oe,ie,""+Ee,Ve);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case S:return ie=ie.get(Ee.key===null?ue:Ee.key)||null,ae(oe,ie,Ee,Ve);case M:return ie=ie.get(Ee.key===null?ue:Ee.key)||null,he(oe,ie,Ee,Ve);case H:var Je=Ee._init;return Le(ie,oe,ue,Je(Ee._payload),Ve)}if(Me(Ee)||Q(Ee))return ie=ie.get(ue)||null,xe(oe,ie,Ee,Ve,null);Od(oe,Ee)}return null}function Fe(ie,oe,ue,Ee){for(var Ve=null,Je=null,Ze=oe,ct=oe=0,Wn=null;Ze!==null&&ct<ue.length;ct++){Ze.index>ct?(Wn=Ze,Ze=null):Wn=Ze.sibling;var zt=be(ie,Ze,ue[ct],Ee);if(zt===null){Ze===null&&(Ze=Wn);break}r&&Ze&&zt.alternate===null&&l(ie,Ze),oe=O(zt,oe,ct),Je===null?Ve=zt:Je.sibling=zt,Je=zt,Ze=Wn}if(ct===ue.length)return m(ie,Ze),an&&Zo(ie,ct),Ve;if(Ze===null){for(;ct<ue.length;ct++)Ze=Ne(ie,ue[ct],Ee),Ze!==null&&(oe=O(Ze,oe,ct),Je===null?Ve=Ze:Je.sibling=Ze,Je=Ze);return an&&Zo(ie,ct),Ve}for(Ze=y(ie,Ze);ct<ue.length;ct++)Wn=Le(Ze,ie,ct,ue[ct],Ee),Wn!==null&&(r&&Wn.alternate!==null&&Ze.delete(Wn.key===null?ct:Wn.key),oe=O(Wn,oe,ct),Je===null?Ve=Wn:Je.sibling=Wn,Je=Wn);return r&&Ze.forEach(function(oo){return l(ie,oo)}),an&&Zo(ie,ct),Ve}function Be(ie,oe,ue,Ee){var Ve=Q(ue);if(typeof Ve!="function")throw Error(n(150));if(ue=Ve.call(ue),ue==null)throw Error(n(151));for(var Je=Ve=null,Ze=oe,ct=oe=0,Wn=null,zt=ue.next();Ze!==null&&!zt.done;ct++,zt=ue.next()){Ze.index>ct?(Wn=Ze,Ze=null):Wn=Ze.sibling;var oo=be(ie,Ze,zt.value,Ee);if(oo===null){Ze===null&&(Ze=Wn);break}r&&Ze&&oo.alternate===null&&l(ie,Ze),oe=O(oo,oe,ct),Je===null?Ve=oo:Je.sibling=oo,Je=oo,Ze=Wn}if(zt.done)return m(ie,Ze),an&&Zo(ie,ct),Ve;if(Ze===null){for(;!zt.done;ct++,zt=ue.next())zt=Ne(ie,zt.value,Ee),zt!==null&&(oe=O(zt,oe,ct),Je===null?Ve=zt:Je.sibling=zt,Je=zt);return an&&Zo(ie,ct),Ve}for(Ze=y(ie,Ze);!zt.done;ct++,zt=ue.next())zt=Le(Ze,ie,ct,zt.value,Ee),zt!==null&&(r&&zt.alternate!==null&&Ze.delete(zt.key===null?ct:zt.key),oe=O(zt,oe,ct),Je===null?Ve=zt:Je.sibling=zt,Je=zt);return r&&Ze.forEach(function(dR){return l(ie,dR)}),an&&Zo(ie,ct),Ve}function xn(ie,oe,ue,Ee){if(typeof ue=="object"&&ue!==null&&ue.type===T&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case S:e:{for(var Ve=ue.key,Je=oe;Je!==null;){if(Je.key===Ve){if(Ve=ue.type,Ve===T){if(Je.tag===7){m(ie,Je.sibling),oe=k(Je,ue.props.children),oe.return=ie,ie=oe;break e}}else if(Je.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===H&&h0(Ve)===Je.type){m(ie,Je.sibling),oe=k(Je,ue.props),oe.ref=Nc(ie,Je,ue),oe.return=ie,ie=oe;break e}m(ie,Je);break}else l(ie,Je);Je=Je.sibling}ue.type===T?(oe=ll(ue.props.children,ie.mode,Ee,ue.key),oe.return=ie,ie=oe):(Ee=tm(ue.type,ue.key,ue.props,null,ie.mode,Ee),Ee.ref=Nc(ie,oe,ue),Ee.return=ie,ie=Ee)}return B(ie);case M:e:{for(Je=ue.key;oe!==null;){if(oe.key===Je)if(oe.tag===4&&oe.stateNode.containerInfo===ue.containerInfo&&oe.stateNode.implementation===ue.implementation){m(ie,oe.sibling),oe=k(oe,ue.children||[]),oe.return=ie,ie=oe;break e}else{m(ie,oe);break}else l(ie,oe);oe=oe.sibling}oe=kp(ue,ie.mode,Ee),oe.return=ie,ie=oe}return B(ie);case H:return Je=ue._init,xn(ie,oe,Je(ue._payload),Ee)}if(Me(ue))return Fe(ie,oe,ue,Ee);if(Q(ue))return Be(ie,oe,ue,Ee);Od(ie,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,oe!==null&&oe.tag===6?(m(ie,oe.sibling),oe=k(oe,ue),oe.return=ie,ie=oe):(m(ie,oe),oe=Ep(ue,ie.mode,Ee),oe.return=ie,ie=oe),B(ie)):m(ie,oe)}return xn}var ri=f0(!0),p0=f0(!1),Td=Ga(null),$d=null,ai=null,Rf=null;function Df(){Rf=ai=$d=null}function Ff(r){var l=Td.current;sn(Td),r._currentValue=l}function If(r,l,m){for(;r!==null;){var y=r.alternate;if((r.childLanes&l)!==l?(r.childLanes|=l,y!==null&&(y.childLanes|=l)):y!==null&&(y.childLanes&l)!==l&&(y.childLanes|=l),r===m)break;r=r.return}}function oi(r,l){$d=r,Rf=ai=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&l&&(Rs=!0),r.firstContext=null)}function lr(r){var l=r._currentValue;if(Rf!==r)if(r={context:r,memoizedValue:l,next:null},ai===null){if($d===null)throw Error(n(308));ai=r,$d.dependencies={lanes:0,firstContext:r}}else ai=ai.next=r;return l}var el=null;function Bf(r){el===null?el=[r]:el.push(r)}function g0(r,l,m,y){var k=l.interleaved;return k===null?(m.next=m,Bf(l)):(m.next=k.next,k.next=m),l.interleaved=m,pa(r,y)}function pa(r,l){r.lanes|=l;var m=r.alternate;for(m!==null&&(m.lanes|=l),m=r,r=r.return;r!==null;)r.childLanes|=l,m=r.alternate,m!==null&&(m.childLanes|=l),m=r,r=r.return;return m.tag===3?m.stateNode:null}var Ja=!1;function Uf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _0(r,l){r=r.updateQueue,l.updateQueue===r&&(l.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function ga(r,l){return{eventTime:r,lane:l,tag:0,payload:null,callback:null,next:null}}function Za(r,l,m){var y=r.updateQueue;if(y===null)return null;if(y=y.shared,Pt&2){var k=y.pending;return k===null?l.next=l:(l.next=k.next,k.next=l),y.pending=l,pa(r,m)}return k=y.interleaved,k===null?(l.next=l,Bf(y)):(l.next=k.next,k.next=l),y.interleaved=l,pa(r,m)}function Pd(r,l,m){if(l=l.updateQueue,l!==null&&(l=l.shared,(m&4194240)!==0)){var y=l.lanes;y&=r.pendingLanes,m|=y,l.lanes=m,Ra(r,m)}}function v0(r,l){var m=r.updateQueue,y=r.alternate;if(y!==null&&(y=y.updateQueue,m===y)){var k=null,O=null;if(m=m.firstBaseUpdate,m!==null){do{var B={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};O===null?k=O=B:O=O.next=B,m=m.next}while(m!==null);O===null?k=O=l:O=O.next=l}else k=O=l;m={baseState:y.baseState,firstBaseUpdate:k,lastBaseUpdate:O,shared:y.shared,effects:y.effects},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=l:r.next=l,m.lastBaseUpdate=l}function Ld(r,l,m,y){var k=r.updateQueue;Ja=!1;var O=k.firstBaseUpdate,B=k.lastBaseUpdate,ee=k.shared.pending;if(ee!==null){k.shared.pending=null;var ae=ee,he=ae.next;ae.next=null,B===null?O=he:B.next=he,B=ae;var xe=r.alternate;xe!==null&&(xe=xe.updateQueue,ee=xe.lastBaseUpdate,ee!==B&&(ee===null?xe.firstBaseUpdate=he:ee.next=he,xe.lastBaseUpdate=ae))}if(O!==null){var Ne=k.baseState;B=0,xe=he=ae=null,ee=O;do{var be=ee.lane,Le=ee.eventTime;if((y&be)===be){xe!==null&&(xe=xe.next={eventTime:Le,lane:0,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null});e:{var Fe=r,Be=ee;switch(be=l,Le=m,Be.tag){case 1:if(Fe=Be.payload,typeof Fe=="function"){Ne=Fe.call(Le,Ne,be);break e}Ne=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=Be.payload,be=typeof Fe=="function"?Fe.call(Le,Ne,be):Fe,be==null)break e;Ne=U({},Ne,be);break e;case 2:Ja=!0}}ee.callback!==null&&ee.lane!==0&&(r.flags|=64,be=k.effects,be===null?k.effects=[ee]:be.push(ee))}else Le={eventTime:Le,lane:be,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},xe===null?(he=xe=Le,ae=Ne):xe=xe.next=Le,B|=be;if(ee=ee.next,ee===null){if(ee=k.shared.pending,ee===null)break;be=ee,ee=be.next,be.next=null,k.lastBaseUpdate=be,k.shared.pending=null}}while(!0);if(xe===null&&(ae=Ne),k.baseState=ae,k.firstBaseUpdate=he,k.lastBaseUpdate=xe,l=k.shared.interleaved,l!==null){k=l;do B|=k.lane,k=k.next;while(k!==l)}else O===null&&(k.shared.lanes=0);sl|=B,r.lanes=B,r.memoizedState=Ne}}function y0(r,l,m){if(r=l.effects,l.effects=null,r!==null)for(l=0;l<r.length;l++){var y=r[l],k=y.callback;if(k!==null){if(y.callback=null,y=m,typeof k!="function")throw Error(n(191,k));k.call(y)}}}var Cc={},Fr=Ga(Cc),Sc=Ga(Cc),Ec=Ga(Cc);function tl(r){if(r===Cc)throw Error(n(174));return r}function qf(r,l){switch(Jt(Ec,l),Jt(Sc,r),Jt(Fr,Cc),r=l.nodeType,r){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:gt(null,"");break;default:r=r===8?l.parentNode:l,l=r.namespaceURI||null,r=r.tagName,l=gt(l,r)}sn(Fr),Jt(Fr,l)}function li(){sn(Fr),sn(Sc),sn(Ec)}function b0(r){tl(Ec.current);var l=tl(Fr.current),m=gt(l,r.type);l!==m&&(Jt(Sc,r),Jt(Fr,m))}function Hf(r){Sc.current===r&&(sn(Fr),sn(Sc))}var hn=Ga(0);function zd(r){for(var l=r;l!==null;){if(l.tag===13){var m=l.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Vf=[];function Wf(){for(var r=0;r<Vf.length;r++)Vf[r]._workInProgressVersionPrimary=null;Vf.length=0}var Rd=j.ReactCurrentDispatcher,Kf=j.ReactCurrentBatchConfig,nl=0,fn=null,Ln=null,Hn=null,Dd=!1,kc=!1,Mc=0,$z=0;function us(){throw Error(n(321))}function Yf(r,l){if(l===null)return!1;for(var m=0;m<l.length&&m<r.length;m++)if(!$s(r[m],l[m]))return!1;return!0}function Gf(r,l,m,y,k,O){if(nl=O,fn=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,Rd.current=r===null||r.memoizedState===null?Rz:Dz,r=m(y,k),kc){O=0;do{if(kc=!1,Mc=0,25<=O)throw Error(n(301));O+=1,Hn=Ln=null,l.updateQueue=null,Rd.current=Fz,r=m(y,k)}while(kc)}if(Rd.current=Bd,l=Ln!==null&&Ln.next!==null,nl=0,Hn=Ln=fn=null,Dd=!1,l)throw Error(n(300));return r}function Qf(){var r=Mc!==0;return Mc=0,r}function Ir(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Hn===null?fn.memoizedState=Hn=r:Hn=Hn.next=r,Hn}function ir(){if(Ln===null){var r=fn.alternate;r=r!==null?r.memoizedState:null}else r=Ln.next;var l=Hn===null?fn.memoizedState:Hn.next;if(l!==null)Hn=l,Ln=r;else{if(r===null)throw Error(n(310));Ln=r,r={memoizedState:Ln.memoizedState,baseState:Ln.baseState,baseQueue:Ln.baseQueue,queue:Ln.queue,next:null},Hn===null?fn.memoizedState=Hn=r:Hn=Hn.next=r}return Hn}function Ac(r,l){return typeof l=="function"?l(r):l}function Xf(r){var l=ir(),m=l.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var y=Ln,k=y.baseQueue,O=m.pending;if(O!==null){if(k!==null){var B=k.next;k.next=O.next,O.next=B}y.baseQueue=k=O,m.pending=null}if(k!==null){O=k.next,y=y.baseState;var ee=B=null,ae=null,he=O;do{var xe=he.lane;if((nl&xe)===xe)ae!==null&&(ae=ae.next={lane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),y=he.hasEagerState?he.eagerState:r(y,he.action);else{var Ne={lane:xe,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null};ae===null?(ee=ae=Ne,B=y):ae=ae.next=Ne,fn.lanes|=xe,sl|=xe}he=he.next}while(he!==null&&he!==O);ae===null?B=y:ae.next=ee,$s(y,l.memoizedState)||(Rs=!0),l.memoizedState=y,l.baseState=B,l.baseQueue=ae,m.lastRenderedState=y}if(r=m.interleaved,r!==null){k=r;do O=k.lane,fn.lanes|=O,sl|=O,k=k.next;while(k!==r)}else k===null&&(m.lanes=0);return[l.memoizedState,m.dispatch]}function Jf(r){var l=ir(),m=l.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var y=m.dispatch,k=m.pending,O=l.memoizedState;if(k!==null){m.pending=null;var B=k=k.next;do O=r(O,B.action),B=B.next;while(B!==k);$s(O,l.memoizedState)||(Rs=!0),l.memoizedState=O,l.baseQueue===null&&(l.baseState=O),m.lastRenderedState=O}return[O,y]}function x0(){}function w0(r,l){var m=fn,y=ir(),k=l(),O=!$s(y.memoizedState,k);if(O&&(y.memoizedState=k,Rs=!0),y=y.queue,Zf(C0.bind(null,m,y,r),[r]),y.getSnapshot!==l||O||Hn!==null&&Hn.memoizedState.tag&1){if(m.flags|=2048,Oc(9,N0.bind(null,m,y,k,l),void 0,null),Vn===null)throw Error(n(349));nl&30||j0(m,l,k)}return k}function j0(r,l,m){r.flags|=16384,r={getSnapshot:l,value:m},l=fn.updateQueue,l===null?(l={lastEffect:null,stores:null},fn.updateQueue=l,l.stores=[r]):(m=l.stores,m===null?l.stores=[r]:m.push(r))}function N0(r,l,m,y){l.value=m,l.getSnapshot=y,S0(l)&&E0(r)}function C0(r,l,m){return m(function(){S0(l)&&E0(r)})}function S0(r){var l=r.getSnapshot;r=r.value;try{var m=l();return!$s(r,m)}catch{return!0}}function E0(r){var l=pa(r,1);l!==null&&Nr(l,r,1,-1)}function k0(r){var l=Ir();return typeof r=="function"&&(r=r()),l.memoizedState=l.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ac,lastRenderedState:r},l.queue=r,r=r.dispatch=zz.bind(null,fn,r),[l.memoizedState,r]}function Oc(r,l,m,y){return r={tag:r,create:l,destroy:m,deps:y,next:null},l=fn.updateQueue,l===null?(l={lastEffect:null,stores:null},fn.updateQueue=l,l.lastEffect=r.next=r):(m=l.lastEffect,m===null?l.lastEffect=r.next=r:(y=m.next,m.next=r,r.next=y,l.lastEffect=r)),r}function M0(){return ir().memoizedState}function Fd(r,l,m,y){var k=Ir();fn.flags|=r,k.memoizedState=Oc(1|l,m,void 0,y===void 0?null:y)}function Id(r,l,m,y){var k=ir();y=y===void 0?null:y;var O=void 0;if(Ln!==null){var B=Ln.memoizedState;if(O=B.destroy,y!==null&&Yf(y,B.deps)){k.memoizedState=Oc(l,m,O,y);return}}fn.flags|=r,k.memoizedState=Oc(1|l,m,O,y)}function A0(r,l){return Fd(8390656,8,r,l)}function Zf(r,l){return Id(2048,8,r,l)}function O0(r,l){return Id(4,2,r,l)}function T0(r,l){return Id(4,4,r,l)}function $0(r,l){if(typeof l=="function")return r=r(),l(r),function(){l(null)};if(l!=null)return r=r(),l.current=r,function(){l.current=null}}function P0(r,l,m){return m=m!=null?m.concat([r]):null,Id(4,4,$0.bind(null,l,r),m)}function ep(){}function L0(r,l){var m=ir();l=l===void 0?null:l;var y=m.memoizedState;return y!==null&&l!==null&&Yf(l,y[1])?y[0]:(m.memoizedState=[r,l],r)}function z0(r,l){var m=ir();l=l===void 0?null:l;var y=m.memoizedState;return y!==null&&l!==null&&Yf(l,y[1])?y[0]:(r=r(),m.memoizedState=[r,l],r)}function R0(r,l,m){return nl&21?($s(m,l)||(m=kn(),fn.lanes|=m,sl|=m,r.baseState=!0),l):(r.baseState&&(r.baseState=!1,Rs=!0),r.memoizedState=m)}function Pz(r,l){var m=bt;bt=m!==0&&4>m?m:4,r(!0);var y=Kf.transition;Kf.transition={};try{r(!1),l()}finally{bt=m,Kf.transition=y}}function D0(){return ir().memoizedState}function Lz(r,l,m){var y=so(r);if(m={lane:y,action:m,hasEagerState:!1,eagerState:null,next:null},F0(r))I0(l,m);else if(m=g0(r,l,m,y),m!==null){var k=_s();Nr(m,r,y,k),B0(m,l,y)}}function zz(r,l,m){var y=so(r),k={lane:y,action:m,hasEagerState:!1,eagerState:null,next:null};if(F0(r))I0(l,k);else{var O=r.alternate;if(r.lanes===0&&(O===null||O.lanes===0)&&(O=l.lastRenderedReducer,O!==null))try{var B=l.lastRenderedState,ee=O(B,m);if(k.hasEagerState=!0,k.eagerState=ee,$s(ee,B)){var ae=l.interleaved;ae===null?(k.next=k,Bf(l)):(k.next=ae.next,ae.next=k),l.interleaved=k;return}}catch{}finally{}m=g0(r,l,k,y),m!==null&&(k=_s(),Nr(m,r,y,k),B0(m,l,y))}}function F0(r){var l=r.alternate;return r===fn||l!==null&&l===fn}function I0(r,l){kc=Dd=!0;var m=r.pending;m===null?l.next=l:(l.next=m.next,m.next=l),r.pending=l}function B0(r,l,m){if(m&4194240){var y=l.lanes;y&=r.pendingLanes,m|=y,l.lanes=m,Ra(r,m)}}var Bd={readContext:lr,useCallback:us,useContext:us,useEffect:us,useImperativeHandle:us,useInsertionEffect:us,useLayoutEffect:us,useMemo:us,useReducer:us,useRef:us,useState:us,useDebugValue:us,useDeferredValue:us,useTransition:us,useMutableSource:us,useSyncExternalStore:us,useId:us,unstable_isNewReconciler:!1},Rz={readContext:lr,useCallback:function(r,l){return Ir().memoizedState=[r,l===void 0?null:l],r},useContext:lr,useEffect:A0,useImperativeHandle:function(r,l,m){return m=m!=null?m.concat([r]):null,Fd(4194308,4,$0.bind(null,l,r),m)},useLayoutEffect:function(r,l){return Fd(4194308,4,r,l)},useInsertionEffect:function(r,l){return Fd(4,2,r,l)},useMemo:function(r,l){var m=Ir();return l=l===void 0?null:l,r=r(),m.memoizedState=[r,l],r},useReducer:function(r,l,m){var y=Ir();return l=m!==void 0?m(l):l,y.memoizedState=y.baseState=l,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:l},y.queue=r,r=r.dispatch=Lz.bind(null,fn,r),[y.memoizedState,r]},useRef:function(r){var l=Ir();return r={current:r},l.memoizedState=r},useState:k0,useDebugValue:ep,useDeferredValue:function(r){return Ir().memoizedState=r},useTransition:function(){var r=k0(!1),l=r[0];return r=Pz.bind(null,r[1]),Ir().memoizedState=r,[l,r]},useMutableSource:function(){},useSyncExternalStore:function(r,l,m){var y=fn,k=Ir();if(an){if(m===void 0)throw Error(n(407));m=m()}else{if(m=l(),Vn===null)throw Error(n(349));nl&30||j0(y,l,m)}k.memoizedState=m;var O={value:m,getSnapshot:l};return k.queue=O,A0(C0.bind(null,y,O,r),[r]),y.flags|=2048,Oc(9,N0.bind(null,y,O,m,l),void 0,null),m},useId:function(){var r=Ir(),l=Vn.identifierPrefix;if(an){var m=fa,y=ha;m=(y&~(1<<32-we(y)-1)).toString(32)+m,l=":"+l+"R"+m,m=Mc++,0<m&&(l+="H"+m.toString(32)),l+=":"}else m=$z++,l=":"+l+"r"+m.toString(32)+":";return r.memoizedState=l},unstable_isNewReconciler:!1},Dz={readContext:lr,useCallback:L0,useContext:lr,useEffect:Zf,useImperativeHandle:P0,useInsertionEffect:O0,useLayoutEffect:T0,useMemo:z0,useReducer:Xf,useRef:M0,useState:function(){return Xf(Ac)},useDebugValue:ep,useDeferredValue:function(r){var l=ir();return R0(l,Ln.memoizedState,r)},useTransition:function(){var r=Xf(Ac)[0],l=ir().memoizedState;return[r,l]},useMutableSource:x0,useSyncExternalStore:w0,useId:D0,unstable_isNewReconciler:!1},Fz={readContext:lr,useCallback:L0,useContext:lr,useEffect:Zf,useImperativeHandle:P0,useInsertionEffect:O0,useLayoutEffect:T0,useMemo:z0,useReducer:Jf,useRef:M0,useState:function(){return Jf(Ac)},useDebugValue:ep,useDeferredValue:function(r){var l=ir();return Ln===null?l.memoizedState=r:R0(l,Ln.memoizedState,r)},useTransition:function(){var r=Jf(Ac)[0],l=ir().memoizedState;return[r,l]},useMutableSource:x0,useSyncExternalStore:w0,useId:D0,unstable_isNewReconciler:!1};function xr(r,l){if(r&&r.defaultProps){l=U({},l),r=r.defaultProps;for(var m in r)l[m]===void 0&&(l[m]=r[m]);return l}return l}function tp(r,l,m,y){l=r.memoizedState,m=m(y,l),m=m==null?l:U({},l,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Ud={isMounted:function(r){return(r=r._reactInternals)?vn(r)===r:!1},enqueueSetState:function(r,l,m){r=r._reactInternals;var y=_s(),k=so(r),O=ga(y,k);O.payload=l,m!=null&&(O.callback=m),l=Za(r,O,k),l!==null&&(Nr(l,r,k,y),Pd(l,r,k))},enqueueReplaceState:function(r,l,m){r=r._reactInternals;var y=_s(),k=so(r),O=ga(y,k);O.tag=1,O.payload=l,m!=null&&(O.callback=m),l=Za(r,O,k),l!==null&&(Nr(l,r,k,y),Pd(l,r,k))},enqueueForceUpdate:function(r,l){r=r._reactInternals;var m=_s(),y=so(r),k=ga(m,y);k.tag=2,l!=null&&(k.callback=l),l=Za(r,k,y),l!==null&&(Nr(l,r,y,m),Pd(l,r,y))}};function U0(r,l,m,y,k,O,B){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(y,O,B):l.prototype&&l.prototype.isPureReactComponent?!Vo(m,y)||!Vo(k,O):!0}function q0(r,l,m){var y=!1,k=Qa,O=l.contextType;return typeof O=="object"&&O!==null?O=lr(O):(k=zs(l)?Xo:cs.current,y=l.contextTypes,O=(y=y!=null)?ei(r,k):Qa),l=new l(m,O),r.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=Ud,r.stateNode=l,l._reactInternals=r,y&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=k,r.__reactInternalMemoizedMaskedChildContext=O),l}function H0(r,l,m,y){r=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(m,y),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(m,y),l.state!==r&&Ud.enqueueReplaceState(l,l.state,null)}function np(r,l,m,y){var k=r.stateNode;k.props=m,k.state=r.memoizedState,k.refs={},Uf(r);var O=l.contextType;typeof O=="object"&&O!==null?k.context=lr(O):(O=zs(l)?Xo:cs.current,k.context=ei(r,O)),k.state=r.memoizedState,O=l.getDerivedStateFromProps,typeof O=="function"&&(tp(r,l,O,m),k.state=r.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(l=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),l!==k.state&&Ud.enqueueReplaceState(k,k.state,null),Ld(r,m,k,y),k.state=r.memoizedState),typeof k.componentDidMount=="function"&&(r.flags|=4194308)}function ii(r,l){try{var m="",y=l;do m+=V(y),y=y.return;while(y);var k=m}catch(O){k=`
Error generating stack: `+O.message+`
`+O.stack}return{value:r,source:l,stack:k,digest:null}}function sp(r,l,m){return{value:r,source:null,stack:m??null,digest:l??null}}function rp(r,l){try{console.error(l.value)}catch(m){setTimeout(function(){throw m})}}var Iz=typeof WeakMap=="function"?WeakMap:Map;function V0(r,l,m){m=ga(-1,m),m.tag=3,m.payload={element:null};var y=l.value;return m.callback=function(){Gd||(Gd=!0,yp=y),rp(r,l)},m}function W0(r,l,m){m=ga(-1,m),m.tag=3;var y=r.type.getDerivedStateFromError;if(typeof y=="function"){var k=l.value;m.payload=function(){return y(k)},m.callback=function(){rp(r,l)}}var O=r.stateNode;return O!==null&&typeof O.componentDidCatch=="function"&&(m.callback=function(){rp(r,l),typeof y!="function"&&(to===null?to=new Set([this]):to.add(this));var B=l.stack;this.componentDidCatch(l.value,{componentStack:B!==null?B:""})}),m}function K0(r,l,m){var y=r.pingCache;if(y===null){y=r.pingCache=new Iz;var k=new Set;y.set(l,k)}else k=y.get(l),k===void 0&&(k=new Set,y.set(l,k));k.has(m)||(k.add(m),r=eR.bind(null,r,l,m),l.then(r,r))}function Y0(r){do{var l;if((l=r.tag===13)&&(l=r.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return r;r=r.return}while(r!==null);return null}function G0(r,l,m,y,k){return r.mode&1?(r.flags|=65536,r.lanes=k,r):(r===l?r.flags|=65536:(r.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(l=ga(-1,1),l.tag=2,Za(m,l,1))),m.lanes|=1),r)}var Bz=j.ReactCurrentOwner,Rs=!1;function gs(r,l,m,y){l.child=r===null?p0(l,null,m,y):ri(l,r.child,m,y)}function Q0(r,l,m,y,k){m=m.render;var O=l.ref;return oi(l,k),y=Gf(r,l,m,y,O,k),m=Qf(),r!==null&&!Rs?(l.updateQueue=r.updateQueue,l.flags&=-2053,r.lanes&=~k,_a(r,l,k)):(an&&m&&Tf(l),l.flags|=1,gs(r,l,y,k),l.child)}function X0(r,l,m,y,k){if(r===null){var O=m.type;return typeof O=="function"&&!Sp(O)&&O.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(l.tag=15,l.type=O,J0(r,l,O,y,k)):(r=tm(m.type,null,y,l,l.mode,k),r.ref=l.ref,r.return=l,l.child=r)}if(O=r.child,!(r.lanes&k)){var B=O.memoizedProps;if(m=m.compare,m=m!==null?m:Vo,m(B,y)&&r.ref===l.ref)return _a(r,l,k)}return l.flags|=1,r=ao(O,y),r.ref=l.ref,r.return=l,l.child=r}function J0(r,l,m,y,k){if(r!==null){var O=r.memoizedProps;if(Vo(O,y)&&r.ref===l.ref)if(Rs=!1,l.pendingProps=y=O,(r.lanes&k)!==0)r.flags&131072&&(Rs=!0);else return l.lanes=r.lanes,_a(r,l,k)}return ap(r,l,m,y,k)}function Z0(r,l,m){var y=l.pendingProps,k=y.children,O=r!==null?r.memoizedState:null;if(y.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(ui,er),er|=m;else{if(!(m&1073741824))return r=O!==null?O.baseLanes|m:m,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:r,cachePool:null,transitions:null},l.updateQueue=null,Jt(ui,er),er|=r,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},y=O!==null?O.baseLanes:m,Jt(ui,er),er|=y}else O!==null?(y=O.baseLanes|m,l.memoizedState=null):y=m,Jt(ui,er),er|=y;return gs(r,l,k,m),l.child}function ew(r,l){var m=l.ref;(r===null&&m!==null||r!==null&&r.ref!==m)&&(l.flags|=512,l.flags|=2097152)}function ap(r,l,m,y,k){var O=zs(m)?Xo:cs.current;return O=ei(l,O),oi(l,k),m=Gf(r,l,m,y,O,k),y=Qf(),r!==null&&!Rs?(l.updateQueue=r.updateQueue,l.flags&=-2053,r.lanes&=~k,_a(r,l,k)):(an&&y&&Tf(l),l.flags|=1,gs(r,l,m,k),l.child)}function tw(r,l,m,y,k){if(zs(m)){var O=!0;Sd(l)}else O=!1;if(oi(l,k),l.stateNode===null)Hd(r,l),q0(l,m,y),np(l,m,y,k),y=!0;else if(r===null){var B=l.stateNode,ee=l.memoizedProps;B.props=ee;var ae=B.context,he=m.contextType;typeof he=="object"&&he!==null?he=lr(he):(he=zs(m)?Xo:cs.current,he=ei(l,he));var xe=m.getDerivedStateFromProps,Ne=typeof xe=="function"||typeof B.getSnapshotBeforeUpdate=="function";Ne||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(ee!==y||ae!==he)&&H0(l,B,y,he),Ja=!1;var be=l.memoizedState;B.state=be,Ld(l,y,B,k),ae=l.memoizedState,ee!==y||be!==ae||Ls.current||Ja?(typeof xe=="function"&&(tp(l,m,xe,y),ae=l.memoizedState),(ee=Ja||U0(l,m,ee,y,be,ae,he))?(Ne||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(l.flags|=4194308)):(typeof B.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=y,l.memoizedState=ae),B.props=y,B.state=ae,B.context=he,y=ee):(typeof B.componentDidMount=="function"&&(l.flags|=4194308),y=!1)}else{B=l.stateNode,_0(r,l),ee=l.memoizedProps,he=l.type===l.elementType?ee:xr(l.type,ee),B.props=he,Ne=l.pendingProps,be=B.context,ae=m.contextType,typeof ae=="object"&&ae!==null?ae=lr(ae):(ae=zs(m)?Xo:cs.current,ae=ei(l,ae));var Le=m.getDerivedStateFromProps;(xe=typeof Le=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(ee!==Ne||be!==ae)&&H0(l,B,y,ae),Ja=!1,be=l.memoizedState,B.state=be,Ld(l,y,B,k);var Fe=l.memoizedState;ee!==Ne||be!==Fe||Ls.current||Ja?(typeof Le=="function"&&(tp(l,m,Le,y),Fe=l.memoizedState),(he=Ja||U0(l,m,he,y,be,Fe,ae)||!1)?(xe||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(y,Fe,ae),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(y,Fe,ae)),typeof B.componentDidUpdate=="function"&&(l.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof B.componentDidUpdate!="function"||ee===r.memoizedProps&&be===r.memoizedState||(l.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&be===r.memoizedState||(l.flags|=1024),l.memoizedProps=y,l.memoizedState=Fe),B.props=y,B.state=Fe,B.context=ae,y=he):(typeof B.componentDidUpdate!="function"||ee===r.memoizedProps&&be===r.memoizedState||(l.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&be===r.memoizedState||(l.flags|=1024),y=!1)}return op(r,l,m,y,O,k)}function op(r,l,m,y,k,O){ew(r,l);var B=(l.flags&128)!==0;if(!y&&!B)return k&&o0(l,m,!1),_a(r,l,O);y=l.stateNode,Bz.current=l;var ee=B&&typeof m.getDerivedStateFromError!="function"?null:y.render();return l.flags|=1,r!==null&&B?(l.child=ri(l,r.child,null,O),l.child=ri(l,null,ee,O)):gs(r,l,ee,O),l.memoizedState=y.state,k&&o0(l,m,!0),l.child}function nw(r){var l=r.stateNode;l.pendingContext?r0(r,l.pendingContext,l.pendingContext!==l.context):l.context&&r0(r,l.context,!1),qf(r,l.containerInfo)}function sw(r,l,m,y,k){return si(),zf(k),l.flags|=256,gs(r,l,m,y),l.child}var lp={dehydrated:null,treeContext:null,retryLane:0};function ip(r){return{baseLanes:r,cachePool:null,transitions:null}}function rw(r,l,m){var y=l.pendingProps,k=hn.current,O=!1,B=(l.flags&128)!==0,ee;if((ee=B)||(ee=r!==null&&r.memoizedState===null?!1:(k&2)!==0),ee?(O=!0,l.flags&=-129):(r===null||r.memoizedState!==null)&&(k|=1),Jt(hn,k&1),r===null)return Lf(l),r=l.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(l.mode&1?r.data==="$!"?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(B=y.children,r=y.fallback,O?(y=l.mode,O=l.child,B={mode:"hidden",children:B},!(y&1)&&O!==null?(O.childLanes=0,O.pendingProps=B):O=nm(B,y,0,null),r=ll(r,y,m,null),O.return=l,r.return=l,O.sibling=r,l.child=O,l.child.memoizedState=ip(m),l.memoizedState=lp,r):cp(l,B));if(k=r.memoizedState,k!==null&&(ee=k.dehydrated,ee!==null))return Uz(r,l,B,y,ee,k,m);if(O){O=y.fallback,B=l.mode,k=r.child,ee=k.sibling;var ae={mode:"hidden",children:y.children};return!(B&1)&&l.child!==k?(y=l.child,y.childLanes=0,y.pendingProps=ae,l.deletions=null):(y=ao(k,ae),y.subtreeFlags=k.subtreeFlags&14680064),ee!==null?O=ao(ee,O):(O=ll(O,B,m,null),O.flags|=2),O.return=l,y.return=l,y.sibling=O,l.child=y,y=O,O=l.child,B=r.child.memoizedState,B=B===null?ip(m):{baseLanes:B.baseLanes|m,cachePool:null,transitions:B.transitions},O.memoizedState=B,O.childLanes=r.childLanes&~m,l.memoizedState=lp,y}return O=r.child,r=O.sibling,y=ao(O,{mode:"visible",children:y.children}),!(l.mode&1)&&(y.lanes=m),y.return=l,y.sibling=null,r!==null&&(m=l.deletions,m===null?(l.deletions=[r],l.flags|=16):m.push(r)),l.child=y,l.memoizedState=null,y}function cp(r,l){return l=nm({mode:"visible",children:l},r.mode,0,null),l.return=r,r.child=l}function qd(r,l,m,y){return y!==null&&zf(y),ri(l,r.child,null,m),r=cp(l,l.pendingProps.children),r.flags|=2,l.memoizedState=null,r}function Uz(r,l,m,y,k,O,B){if(m)return l.flags&256?(l.flags&=-257,y=sp(Error(n(422))),qd(r,l,B,y)):l.memoizedState!==null?(l.child=r.child,l.flags|=128,null):(O=y.fallback,k=l.mode,y=nm({mode:"visible",children:y.children},k,0,null),O=ll(O,k,B,null),O.flags|=2,y.return=l,O.return=l,y.sibling=O,l.child=y,l.mode&1&&ri(l,r.child,null,B),l.child.memoizedState=ip(B),l.memoizedState=lp,O);if(!(l.mode&1))return qd(r,l,B,null);if(k.data==="$!"){if(y=k.nextSibling&&k.nextSibling.dataset,y)var ee=y.dgst;return y=ee,O=Error(n(419)),y=sp(O,y,void 0),qd(r,l,B,y)}if(ee=(B&r.childLanes)!==0,Rs||ee){if(y=Vn,y!==null){switch(B&-B){case 4:k=2;break;case 16:k=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:k=32;break;case 536870912:k=268435456;break;default:k=0}k=k&(y.suspendedLanes|B)?0:k,k!==0&&k!==O.retryLane&&(O.retryLane=k,pa(r,k),Nr(y,r,k,-1))}return Cp(),y=sp(Error(n(421))),qd(r,l,B,y)}return k.data==="$?"?(l.flags|=128,l.child=r.child,l=tR.bind(null,r),k._reactRetry=l,null):(r=O.treeContext,Zs=Ya(k.nextSibling),Js=l,an=!0,br=null,r!==null&&(ar[or++]=ha,ar[or++]=fa,ar[or++]=Jo,ha=r.id,fa=r.overflow,Jo=l),l=cp(l,y.children),l.flags|=4096,l)}function aw(r,l,m){r.lanes|=l;var y=r.alternate;y!==null&&(y.lanes|=l),If(r.return,l,m)}function up(r,l,m,y,k){var O=r.memoizedState;O===null?r.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:y,tail:m,tailMode:k}:(O.isBackwards=l,O.rendering=null,O.renderingStartTime=0,O.last=y,O.tail=m,O.tailMode=k)}function ow(r,l,m){var y=l.pendingProps,k=y.revealOrder,O=y.tail;if(gs(r,l,y.children,m),y=hn.current,y&2)y=y&1|2,l.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=l.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&aw(r,m,l);else if(r.tag===19)aw(r,m,l);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===l)break e;for(;r.sibling===null;){if(r.return===null||r.return===l)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}y&=1}if(Jt(hn,y),!(l.mode&1))l.memoizedState=null;else switch(k){case"forwards":for(m=l.child,k=null;m!==null;)r=m.alternate,r!==null&&zd(r)===null&&(k=m),m=m.sibling;m=k,m===null?(k=l.child,l.child=null):(k=m.sibling,m.sibling=null),up(l,!1,k,m,O);break;case"backwards":for(m=null,k=l.child,l.child=null;k!==null;){if(r=k.alternate,r!==null&&zd(r)===null){l.child=k;break}r=k.sibling,k.sibling=m,m=k,k=r}up(l,!0,m,null,O);break;case"together":up(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Hd(r,l){!(l.mode&1)&&r!==null&&(r.alternate=null,l.alternate=null,l.flags|=2)}function _a(r,l,m){if(r!==null&&(l.dependencies=r.dependencies),sl|=l.lanes,!(m&l.childLanes))return null;if(r!==null&&l.child!==r.child)throw Error(n(153));if(l.child!==null){for(r=l.child,m=ao(r,r.pendingProps),l.child=m,m.return=l;r.sibling!==null;)r=r.sibling,m=m.sibling=ao(r,r.pendingProps),m.return=l;m.sibling=null}return l.child}function qz(r,l,m){switch(l.tag){case 3:nw(l),si();break;case 5:b0(l);break;case 1:zs(l.type)&&Sd(l);break;case 4:qf(l,l.stateNode.containerInfo);break;case 10:var y=l.type._context,k=l.memoizedProps.value;Jt(Td,y._currentValue),y._currentValue=k;break;case 13:if(y=l.memoizedState,y!==null)return y.dehydrated!==null?(Jt(hn,hn.current&1),l.flags|=128,null):m&l.child.childLanes?rw(r,l,m):(Jt(hn,hn.current&1),r=_a(r,l,m),r!==null?r.sibling:null);Jt(hn,hn.current&1);break;case 19:if(y=(m&l.childLanes)!==0,r.flags&128){if(y)return ow(r,l,m);l.flags|=128}if(k=l.memoizedState,k!==null&&(k.rendering=null,k.tail=null,k.lastEffect=null),Jt(hn,hn.current),y)break;return null;case 22:case 23:return l.lanes=0,Z0(r,l,m)}return _a(r,l,m)}var lw,dp,iw,cw;lw=function(r,l){for(var m=l.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===l)break;for(;m.sibling===null;){if(m.return===null||m.return===l)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},dp=function(){},iw=function(r,l,m,y){var k=r.memoizedProps;if(k!==y){r=l.stateNode,tl(Fr.current);var O=null;switch(m){case"input":k=Ue(r,k),y=Ue(r,y),O=[];break;case"select":k=U({},k,{value:void 0}),y=U({},y,{value:void 0}),O=[];break;case"textarea":k=ce(r,k),y=ce(r,y),O=[];break;default:typeof k.onClick!="function"&&typeof y.onClick=="function"&&(r.onclick=ua)}_t(m,y);var B;m=null;for(he in k)if(!y.hasOwnProperty(he)&&k.hasOwnProperty(he)&&k[he]!=null)if(he==="style"){var ee=k[he];for(B in ee)ee.hasOwnProperty(B)&&(m||(m={}),m[B]="")}else he!=="dangerouslySetInnerHTML"&&he!=="children"&&he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&he!=="autoFocus"&&(o.hasOwnProperty(he)?O||(O=[]):(O=O||[]).push(he,null));for(he in y){var ae=y[he];if(ee=k!=null?k[he]:void 0,y.hasOwnProperty(he)&&ae!==ee&&(ae!=null||ee!=null))if(he==="style")if(ee){for(B in ee)!ee.hasOwnProperty(B)||ae&&ae.hasOwnProperty(B)||(m||(m={}),m[B]="");for(B in ae)ae.hasOwnProperty(B)&&ee[B]!==ae[B]&&(m||(m={}),m[B]=ae[B])}else m||(O||(O=[]),O.push(he,m)),m=ae;else he==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ee=ee?ee.__html:void 0,ae!=null&&ee!==ae&&(O=O||[]).push(he,ae)):he==="children"?typeof ae!="string"&&typeof ae!="number"||(O=O||[]).push(he,""+ae):he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&(o.hasOwnProperty(he)?(ae!=null&&he==="onScroll"&&Yt("scroll",r),O||ee===ae||(O=[])):(O=O||[]).push(he,ae))}m&&(O=O||[]).push("style",m);var he=O;(l.updateQueue=he)&&(l.flags|=4)}},cw=function(r,l,m,y){m!==y&&(l.flags|=4)};function Tc(r,l){if(!an)switch(r.tailMode){case"hidden":l=r.tail;for(var m=null;l!==null;)l.alternate!==null&&(m=l),l=l.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var y=null;m!==null;)m.alternate!==null&&(y=m),m=m.sibling;y===null?l||r.tail===null?r.tail=null:r.tail.sibling=null:y.sibling=null}}function ds(r){var l=r.alternate!==null&&r.alternate.child===r.child,m=0,y=0;if(l)for(var k=r.child;k!==null;)m|=k.lanes|k.childLanes,y|=k.subtreeFlags&14680064,y|=k.flags&14680064,k.return=r,k=k.sibling;else for(k=r.child;k!==null;)m|=k.lanes|k.childLanes,y|=k.subtreeFlags,y|=k.flags,k.return=r,k=k.sibling;return r.subtreeFlags|=y,r.childLanes=m,l}function Hz(r,l,m){var y=l.pendingProps;switch($f(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(l),null;case 1:return zs(l.type)&&Cd(),ds(l),null;case 3:return y=l.stateNode,li(),sn(Ls),sn(cs),Wf(),y.pendingContext&&(y.context=y.pendingContext,y.pendingContext=null),(r===null||r.child===null)&&(Ad(l)?l.flags|=4:r===null||r.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,br!==null&&(wp(br),br=null))),dp(r,l),ds(l),null;case 5:Hf(l);var k=tl(Ec.current);if(m=l.type,r!==null&&l.stateNode!=null)iw(r,l,m,y,k),r.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!y){if(l.stateNode===null)throw Error(n(166));return ds(l),null}if(r=tl(Fr.current),Ad(l)){y=l.stateNode,m=l.type;var O=l.memoizedProps;switch(y[Dr]=l,y[wc]=O,r=(l.mode&1)!==0,m){case"dialog":Yt("cancel",y),Yt("close",y);break;case"iframe":case"object":case"embed":Yt("load",y);break;case"video":case"audio":for(k=0;k<Ko.length;k++)Yt(Ko[k],y);break;case"source":Yt("error",y);break;case"img":case"image":case"link":Yt("error",y),Yt("load",y);break;case"details":Yt("toggle",y);break;case"input":nt(y,O),Yt("invalid",y);break;case"select":y._wrapperState={wasMultiple:!!O.multiple},Yt("invalid",y);break;case"textarea":Te(y,O),Yt("invalid",y)}_t(m,O),k=null;for(var B in O)if(O.hasOwnProperty(B)){var ee=O[B];B==="children"?typeof ee=="string"?y.textContent!==ee&&(O.suppressHydrationWarning!==!0&&Ka(y.textContent,ee,r),k=["children",ee]):typeof ee=="number"&&y.textContent!==""+ee&&(O.suppressHydrationWarning!==!0&&Ka(y.textContent,ee,r),k=["children",""+ee]):o.hasOwnProperty(B)&&ee!=null&&B==="onScroll"&&Yt("scroll",y)}switch(m){case"input":Se(y),_e(y,O,!0);break;case"textarea":Se(y),ht(y);break;case"select":case"option":break;default:typeof O.onClick=="function"&&(y.onclick=ua)}y=k,l.updateQueue=y,y!==null&&(l.flags|=4)}else{B=k.nodeType===9?k:k.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=rt(m)),r==="http://www.w3.org/1999/xhtml"?m==="script"?(r=B.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof y.is=="string"?r=B.createElement(m,{is:y.is}):(r=B.createElement(m),m==="select"&&(B=r,y.multiple?B.multiple=!0:y.size&&(B.size=y.size))):r=B.createElementNS(r,m),r[Dr]=l,r[wc]=y,lw(r,l,!1,!1),l.stateNode=r;e:{switch(B=Cn(m,y),m){case"dialog":Yt("cancel",r),Yt("close",r),k=y;break;case"iframe":case"object":case"embed":Yt("load",r),k=y;break;case"video":case"audio":for(k=0;k<Ko.length;k++)Yt(Ko[k],r);k=y;break;case"source":Yt("error",r),k=y;break;case"img":case"image":case"link":Yt("error",r),Yt("load",r),k=y;break;case"details":Yt("toggle",r),k=y;break;case"input":nt(r,y),k=Ue(r,y),Yt("invalid",r);break;case"option":k=y;break;case"select":r._wrapperState={wasMultiple:!!y.multiple},k=U({},y,{value:void 0}),Yt("invalid",r);break;case"textarea":Te(r,y),k=ce(r,y),Yt("invalid",r);break;default:k=y}_t(m,k),ee=k;for(O in ee)if(ee.hasOwnProperty(O)){var ae=ee[O];O==="style"?Kt(r,ae):O==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&ut(r,ae)):O==="children"?typeof ae=="string"?(m!=="textarea"||ae!=="")&&Ot(r,ae):typeof ae=="number"&&Ot(r,""+ae):O!=="suppressContentEditableWarning"&&O!=="suppressHydrationWarning"&&O!=="autoFocus"&&(o.hasOwnProperty(O)?ae!=null&&O==="onScroll"&&Yt("scroll",r):ae!=null&&E(r,O,ae,B))}switch(m){case"input":Se(r),_e(r,y,!1);break;case"textarea":Se(r),ht(r);break;case"option":y.value!=null&&r.setAttribute("value",""+se(y.value));break;case"select":r.multiple=!!y.multiple,O=y.value,O!=null?De(r,!!y.multiple,O,!1):y.defaultValue!=null&&De(r,!!y.multiple,y.defaultValue,!0);break;default:typeof k.onClick=="function"&&(r.onclick=ua)}switch(m){case"button":case"input":case"select":case"textarea":y=!!y.autoFocus;break e;case"img":y=!0;break e;default:y=!1}}y&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return ds(l),null;case 6:if(r&&l.stateNode!=null)cw(r,l,r.memoizedProps,y);else{if(typeof y!="string"&&l.stateNode===null)throw Error(n(166));if(m=tl(Ec.current),tl(Fr.current),Ad(l)){if(y=l.stateNode,m=l.memoizedProps,y[Dr]=l,(O=y.nodeValue!==m)&&(r=Js,r!==null))switch(r.tag){case 3:Ka(y.nodeValue,m,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Ka(y.nodeValue,m,(r.mode&1)!==0)}O&&(l.flags|=4)}else y=(m.nodeType===9?m:m.ownerDocument).createTextNode(y),y[Dr]=l,l.stateNode=y}return ds(l),null;case 13:if(sn(hn),y=l.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(an&&Zs!==null&&l.mode&1&&!(l.flags&128))m0(),si(),l.flags|=98560,O=!1;else if(O=Ad(l),y!==null&&y.dehydrated!==null){if(r===null){if(!O)throw Error(n(318));if(O=l.memoizedState,O=O!==null?O.dehydrated:null,!O)throw Error(n(317));O[Dr]=l}else si(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;ds(l),O=!1}else br!==null&&(wp(br),br=null),O=!0;if(!O)return l.flags&65536?l:null}return l.flags&128?(l.lanes=m,l):(y=y!==null,y!==(r!==null&&r.memoizedState!==null)&&y&&(l.child.flags|=8192,l.mode&1&&(r===null||hn.current&1?zn===0&&(zn=3):Cp())),l.updateQueue!==null&&(l.flags|=4),ds(l),null);case 4:return li(),dp(r,l),r===null&&Mt(l.stateNode.containerInfo),ds(l),null;case 10:return Ff(l.type._context),ds(l),null;case 17:return zs(l.type)&&Cd(),ds(l),null;case 19:if(sn(hn),O=l.memoizedState,O===null)return ds(l),null;if(y=(l.flags&128)!==0,B=O.rendering,B===null)if(y)Tc(O,!1);else{if(zn!==0||r!==null&&r.flags&128)for(r=l.child;r!==null;){if(B=zd(r),B!==null){for(l.flags|=128,Tc(O,!1),y=B.updateQueue,y!==null&&(l.updateQueue=y,l.flags|=4),l.subtreeFlags=0,y=m,m=l.child;m!==null;)O=m,r=y,O.flags&=14680066,B=O.alternate,B===null?(O.childLanes=0,O.lanes=r,O.child=null,O.subtreeFlags=0,O.memoizedProps=null,O.memoizedState=null,O.updateQueue=null,O.dependencies=null,O.stateNode=null):(O.childLanes=B.childLanes,O.lanes=B.lanes,O.child=B.child,O.subtreeFlags=0,O.deletions=null,O.memoizedProps=B.memoizedProps,O.memoizedState=B.memoizedState,O.updateQueue=B.updateQueue,O.type=B.type,r=B.dependencies,O.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),m=m.sibling;return Jt(hn,hn.current&1|2),l.child}r=r.sibling}O.tail!==null&&lt()>di&&(l.flags|=128,y=!0,Tc(O,!1),l.lanes=4194304)}else{if(!y)if(r=zd(B),r!==null){if(l.flags|=128,y=!0,m=r.updateQueue,m!==null&&(l.updateQueue=m,l.flags|=4),Tc(O,!0),O.tail===null&&O.tailMode==="hidden"&&!B.alternate&&!an)return ds(l),null}else 2*lt()-O.renderingStartTime>di&&m!==1073741824&&(l.flags|=128,y=!0,Tc(O,!1),l.lanes=4194304);O.isBackwards?(B.sibling=l.child,l.child=B):(m=O.last,m!==null?m.sibling=B:l.child=B,O.last=B)}return O.tail!==null?(l=O.tail,O.rendering=l,O.tail=l.sibling,O.renderingStartTime=lt(),l.sibling=null,m=hn.current,Jt(hn,y?m&1|2:m&1),l):(ds(l),null);case 22:case 23:return Np(),y=l.memoizedState!==null,r!==null&&r.memoizedState!==null!==y&&(l.flags|=8192),y&&l.mode&1?er&1073741824&&(ds(l),l.subtreeFlags&6&&(l.flags|=8192)):ds(l),null;case 24:return null;case 25:return null}throw Error(n(156,l.tag))}function Vz(r,l){switch($f(l),l.tag){case 1:return zs(l.type)&&Cd(),r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 3:return li(),sn(Ls),sn(cs),Wf(),r=l.flags,r&65536&&!(r&128)?(l.flags=r&-65537|128,l):null;case 5:return Hf(l),null;case 13:if(sn(hn),r=l.memoizedState,r!==null&&r.dehydrated!==null){if(l.alternate===null)throw Error(n(340));si()}return r=l.flags,r&65536?(l.flags=r&-65537|128,l):null;case 19:return sn(hn),null;case 4:return li(),null;case 10:return Ff(l.type._context),null;case 22:case 23:return Np(),null;case 24:return null;default:return null}}var Vd=!1,ms=!1,Wz=typeof WeakSet=="function"?WeakSet:Set,Re=null;function ci(r,l){var m=r.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(y){_n(r,l,y)}else m.current=null}function mp(r,l,m){try{m()}catch(y){_n(r,l,y)}}var uw=!1;function Kz(r,l){if(Go=As,r=md(),fc(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var y=m.getSelection&&m.getSelection();if(y&&y.rangeCount!==0){m=y.anchorNode;var k=y.anchorOffset,O=y.focusNode;y=y.focusOffset;try{m.nodeType,O.nodeType}catch{m=null;break e}var B=0,ee=-1,ae=-1,he=0,xe=0,Ne=r,be=null;t:for(;;){for(var Le;Ne!==m||k!==0&&Ne.nodeType!==3||(ee=B+k),Ne!==O||y!==0&&Ne.nodeType!==3||(ae=B+y),Ne.nodeType===3&&(B+=Ne.nodeValue.length),(Le=Ne.firstChild)!==null;)be=Ne,Ne=Le;for(;;){if(Ne===r)break t;if(be===m&&++he===k&&(ee=B),be===O&&++xe===y&&(ae=B),(Le=Ne.nextSibling)!==null)break;Ne=be,be=Ne.parentNode}Ne=Le}m=ee===-1||ae===-1?null:{start:ee,end:ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(Cf={focusedElem:r,selectionRange:m},As=!1,Re=l;Re!==null;)if(l=Re,r=l.child,(l.subtreeFlags&1028)!==0&&r!==null)r.return=l,Re=r;else for(;Re!==null;){l=Re;try{var Fe=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(Fe!==null){var Be=Fe.memoizedProps,xn=Fe.memoizedState,ie=l.stateNode,oe=ie.getSnapshotBeforeUpdate(l.elementType===l.type?Be:xr(l.type,Be),xn);ie.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var ue=l.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Ee){_n(l,l.return,Ee)}if(r=l.sibling,r!==null){r.return=l.return,Re=r;break}Re=l.return}return Fe=uw,uw=!1,Fe}function $c(r,l,m){var y=l.updateQueue;if(y=y!==null?y.lastEffect:null,y!==null){var k=y=y.next;do{if((k.tag&r)===r){var O=k.destroy;k.destroy=void 0,O!==void 0&&mp(l,m,O)}k=k.next}while(k!==y)}}function Wd(r,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var m=l=l.next;do{if((m.tag&r)===r){var y=m.create;m.destroy=y()}m=m.next}while(m!==l)}}function hp(r){var l=r.ref;if(l!==null){var m=r.stateNode;switch(r.tag){case 5:r=m;break;default:r=m}typeof l=="function"?l(r):l.current=r}}function dw(r){var l=r.alternate;l!==null&&(r.alternate=null,dw(l)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(l=r.stateNode,l!==null&&(delete l[Dr],delete l[wc],delete l[Mf],delete l[Mz],delete l[Az])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function mw(r){return r.tag===5||r.tag===3||r.tag===4}function hw(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||mw(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function fp(r,l,m){var y=r.tag;if(y===5||y===6)r=r.stateNode,l?m.nodeType===8?m.parentNode.insertBefore(r,l):m.insertBefore(r,l):(m.nodeType===8?(l=m.parentNode,l.insertBefore(r,m)):(l=m,l.appendChild(r)),m=m._reactRootContainer,m!=null||l.onclick!==null||(l.onclick=ua));else if(y!==4&&(r=r.child,r!==null))for(fp(r,l,m),r=r.sibling;r!==null;)fp(r,l,m),r=r.sibling}function pp(r,l,m){var y=r.tag;if(y===5||y===6)r=r.stateNode,l?m.insertBefore(r,l):m.appendChild(r);else if(y!==4&&(r=r.child,r!==null))for(pp(r,l,m),r=r.sibling;r!==null;)pp(r,l,m),r=r.sibling}var ns=null,wr=!1;function eo(r,l,m){for(m=m.child;m!==null;)fw(r,l,m),m=m.sibling}function fw(r,l,m){if(Pe&&typeof Pe.onCommitFiberUnmount=="function")try{Pe.onCommitFiberUnmount(ge,m)}catch{}switch(m.tag){case 5:ms||ci(m,l);case 6:var y=ns,k=wr;ns=null,eo(r,l,m),ns=y,wr=k,ns!==null&&(wr?(r=ns,m=m.stateNode,r.nodeType===8?r.parentNode.removeChild(m):r.removeChild(m)):ns.removeChild(m.stateNode));break;case 18:ns!==null&&(wr?(r=ns,m=m.stateNode,r.nodeType===8?kf(r.parentNode,m):r.nodeType===1&&kf(r,m),yn(r)):kf(ns,m.stateNode));break;case 4:y=ns,k=wr,ns=m.stateNode.containerInfo,wr=!0,eo(r,l,m),ns=y,wr=k;break;case 0:case 11:case 14:case 15:if(!ms&&(y=m.updateQueue,y!==null&&(y=y.lastEffect,y!==null))){k=y=y.next;do{var O=k,B=O.destroy;O=O.tag,B!==void 0&&(O&2||O&4)&&mp(m,l,B),k=k.next}while(k!==y)}eo(r,l,m);break;case 1:if(!ms&&(ci(m,l),y=m.stateNode,typeof y.componentWillUnmount=="function"))try{y.props=m.memoizedProps,y.state=m.memoizedState,y.componentWillUnmount()}catch(ee){_n(m,l,ee)}eo(r,l,m);break;case 21:eo(r,l,m);break;case 22:m.mode&1?(ms=(y=ms)||m.memoizedState!==null,eo(r,l,m),ms=y):eo(r,l,m);break;default:eo(r,l,m)}}function pw(r){var l=r.updateQueue;if(l!==null){r.updateQueue=null;var m=r.stateNode;m===null&&(m=r.stateNode=new Wz),l.forEach(function(y){var k=nR.bind(null,r,y);m.has(y)||(m.add(y),y.then(k,k))})}}function jr(r,l){var m=l.deletions;if(m!==null)for(var y=0;y<m.length;y++){var k=m[y];try{var O=r,B=l,ee=B;e:for(;ee!==null;){switch(ee.tag){case 5:ns=ee.stateNode,wr=!1;break e;case 3:ns=ee.stateNode.containerInfo,wr=!0;break e;case 4:ns=ee.stateNode.containerInfo,wr=!0;break e}ee=ee.return}if(ns===null)throw Error(n(160));fw(O,B,k),ns=null,wr=!1;var ae=k.alternate;ae!==null&&(ae.return=null),k.return=null}catch(he){_n(k,l,he)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)gw(l,r),l=l.sibling}function gw(r,l){var m=r.alternate,y=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(jr(l,r),Br(r),y&4){try{$c(3,r,r.return),Wd(3,r)}catch(Be){_n(r,r.return,Be)}try{$c(5,r,r.return)}catch(Be){_n(r,r.return,Be)}}break;case 1:jr(l,r),Br(r),y&512&&m!==null&&ci(m,m.return);break;case 5:if(jr(l,r),Br(r),y&512&&m!==null&&ci(m,m.return),r.flags&32){var k=r.stateNode;try{Ot(k,"")}catch(Be){_n(r,r.return,Be)}}if(y&4&&(k=r.stateNode,k!=null)){var O=r.memoizedProps,B=m!==null?m.memoizedProps:O,ee=r.type,ae=r.updateQueue;if(r.updateQueue=null,ae!==null)try{ee==="input"&&O.type==="radio"&&O.name!=null&&He(k,O),Cn(ee,B);var he=Cn(ee,O);for(B=0;B<ae.length;B+=2){var xe=ae[B],Ne=ae[B+1];xe==="style"?Kt(k,Ne):xe==="dangerouslySetInnerHTML"?ut(k,Ne):xe==="children"?Ot(k,Ne):E(k,xe,Ne,he)}switch(ee){case"input":de(k,O);break;case"textarea":Qe(k,O);break;case"select":var be=k._wrapperState.wasMultiple;k._wrapperState.wasMultiple=!!O.multiple;var Le=O.value;Le!=null?De(k,!!O.multiple,Le,!1):be!==!!O.multiple&&(O.defaultValue!=null?De(k,!!O.multiple,O.defaultValue,!0):De(k,!!O.multiple,O.multiple?[]:"",!1))}k[wc]=O}catch(Be){_n(r,r.return,Be)}}break;case 6:if(jr(l,r),Br(r),y&4){if(r.stateNode===null)throw Error(n(162));k=r.stateNode,O=r.memoizedProps;try{k.nodeValue=O}catch(Be){_n(r,r.return,Be)}}break;case 3:if(jr(l,r),Br(r),y&4&&m!==null&&m.memoizedState.isDehydrated)try{yn(l.containerInfo)}catch(Be){_n(r,r.return,Be)}break;case 4:jr(l,r),Br(r);break;case 13:jr(l,r),Br(r),k=r.child,k.flags&8192&&(O=k.memoizedState!==null,k.stateNode.isHidden=O,!O||k.alternate!==null&&k.alternate.memoizedState!==null||(vp=lt())),y&4&&pw(r);break;case 22:if(xe=m!==null&&m.memoizedState!==null,r.mode&1?(ms=(he=ms)||xe,jr(l,r),ms=he):jr(l,r),Br(r),y&8192){if(he=r.memoizedState!==null,(r.stateNode.isHidden=he)&&!xe&&r.mode&1)for(Re=r,xe=r.child;xe!==null;){for(Ne=Re=xe;Re!==null;){switch(be=Re,Le=be.child,be.tag){case 0:case 11:case 14:case 15:$c(4,be,be.return);break;case 1:ci(be,be.return);var Fe=be.stateNode;if(typeof Fe.componentWillUnmount=="function"){y=be,m=be.return;try{l=y,Fe.props=l.memoizedProps,Fe.state=l.memoizedState,Fe.componentWillUnmount()}catch(Be){_n(y,m,Be)}}break;case 5:ci(be,be.return);break;case 22:if(be.memoizedState!==null){yw(Ne);continue}}Le!==null?(Le.return=be,Re=Le):yw(Ne)}xe=xe.sibling}e:for(xe=null,Ne=r;;){if(Ne.tag===5){if(xe===null){xe=Ne;try{k=Ne.stateNode,he?(O=k.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none"):(ee=Ne.stateNode,ae=Ne.memoizedProps.style,B=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,ee.style.display=Bt("display",B))}catch(Be){_n(r,r.return,Be)}}}else if(Ne.tag===6){if(xe===null)try{Ne.stateNode.nodeValue=he?"":Ne.memoizedProps}catch(Be){_n(r,r.return,Be)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===r)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===r)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===r)break e;xe===Ne&&(xe=null),Ne=Ne.return}xe===Ne&&(xe=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:jr(l,r),Br(r),y&4&&pw(r);break;case 21:break;default:jr(l,r),Br(r)}}function Br(r){var l=r.flags;if(l&2){try{e:{for(var m=r.return;m!==null;){if(mw(m)){var y=m;break e}m=m.return}throw Error(n(160))}switch(y.tag){case 5:var k=y.stateNode;y.flags&32&&(Ot(k,""),y.flags&=-33);var O=hw(r);pp(r,O,k);break;case 3:case 4:var B=y.stateNode.containerInfo,ee=hw(r);fp(r,ee,B);break;default:throw Error(n(161))}}catch(ae){_n(r,r.return,ae)}r.flags&=-3}l&4096&&(r.flags&=-4097)}function Yz(r,l,m){Re=r,_w(r)}function _w(r,l,m){for(var y=(r.mode&1)!==0;Re!==null;){var k=Re,O=k.child;if(k.tag===22&&y){var B=k.memoizedState!==null||Vd;if(!B){var ee=k.alternate,ae=ee!==null&&ee.memoizedState!==null||ms;ee=Vd;var he=ms;if(Vd=B,(ms=ae)&&!he)for(Re=k;Re!==null;)B=Re,ae=B.child,B.tag===22&&B.memoizedState!==null?bw(k):ae!==null?(ae.return=B,Re=ae):bw(k);for(;O!==null;)Re=O,_w(O),O=O.sibling;Re=k,Vd=ee,ms=he}vw(r)}else k.subtreeFlags&8772&&O!==null?(O.return=k,Re=O):vw(r)}}function vw(r){for(;Re!==null;){var l=Re;if(l.flags&8772){var m=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:ms||Wd(5,l);break;case 1:var y=l.stateNode;if(l.flags&4&&!ms)if(m===null)y.componentDidMount();else{var k=l.elementType===l.type?m.memoizedProps:xr(l.type,m.memoizedProps);y.componentDidUpdate(k,m.memoizedState,y.__reactInternalSnapshotBeforeUpdate)}var O=l.updateQueue;O!==null&&y0(l,O,y);break;case 3:var B=l.updateQueue;if(B!==null){if(m=null,l.child!==null)switch(l.child.tag){case 5:m=l.child.stateNode;break;case 1:m=l.child.stateNode}y0(l,B,m)}break;case 5:var ee=l.stateNode;if(m===null&&l.flags&4){m=ee;var ae=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&m.focus();break;case"img":ae.src&&(m.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var he=l.alternate;if(he!==null){var xe=he.memoizedState;if(xe!==null){var Ne=xe.dehydrated;Ne!==null&&yn(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ms||l.flags&512&&hp(l)}catch(be){_n(l,l.return,be)}}if(l===r){Re=null;break}if(m=l.sibling,m!==null){m.return=l.return,Re=m;break}Re=l.return}}function yw(r){for(;Re!==null;){var l=Re;if(l===r){Re=null;break}var m=l.sibling;if(m!==null){m.return=l.return,Re=m;break}Re=l.return}}function bw(r){for(;Re!==null;){var l=Re;try{switch(l.tag){case 0:case 11:case 15:var m=l.return;try{Wd(4,l)}catch(ae){_n(l,m,ae)}break;case 1:var y=l.stateNode;if(typeof y.componentDidMount=="function"){var k=l.return;try{y.componentDidMount()}catch(ae){_n(l,k,ae)}}var O=l.return;try{hp(l)}catch(ae){_n(l,O,ae)}break;case 5:var B=l.return;try{hp(l)}catch(ae){_n(l,B,ae)}}}catch(ae){_n(l,l.return,ae)}if(l===r){Re=null;break}var ee=l.sibling;if(ee!==null){ee.return=l.return,Re=ee;break}Re=l.return}}var Gz=Math.ceil,Kd=j.ReactCurrentDispatcher,gp=j.ReactCurrentOwner,cr=j.ReactCurrentBatchConfig,Pt=0,Vn=null,An=null,ss=0,er=0,ui=Ga(0),zn=0,Pc=null,sl=0,Yd=0,_p=0,Lc=null,Ds=null,vp=0,di=1/0,va=null,Gd=!1,yp=null,to=null,Qd=!1,no=null,Xd=0,zc=0,bp=null,Jd=-1,Zd=0;function _s(){return Pt&6?lt():Jd!==-1?Jd:Jd=lt()}function so(r){return r.mode&1?Pt&2&&ss!==0?ss&-ss:Tz.transition!==null?(Zd===0&&(Zd=kn()),Zd):(r=bt,r!==0||(r=window.event,r=r===void 0?16:Fa(r.type)),r):1}function Nr(r,l,m,y){if(50<zc)throw zc=0,bp=null,Error(n(185));qn(r,m,y),(!(Pt&2)||r!==Vn)&&(r===Vn&&(!(Pt&2)&&(Yd|=m),zn===4&&ro(r,ss)),Fs(r,y),m===1&&Pt===0&&!(l.mode&1)&&(di=lt()+500,Ed&&Xa()))}function Fs(r,l){var m=r.callbackNode;Jn(r,l);var y=un(r,r===Vn?ss:0);if(y===0)m!==null&&Bn(m),r.callbackNode=null,r.callbackPriority=0;else if(l=y&-y,r.callbackPriority!==l){if(m!=null&&Bn(m),l===1)r.tag===0?Oz(ww.bind(null,r)):l0(ww.bind(null,r)),Ez(function(){!(Pt&6)&&Xa()}),m=null;else{switch(ea(y)){case 1:m=Un;break;case 4:m=Ys;break;case 16:m=os;break;case 536870912:m=le;break;default:m=os}m=Aw(m,xw.bind(null,r))}r.callbackPriority=l,r.callbackNode=m}}function xw(r,l){if(Jd=-1,Zd=0,Pt&6)throw Error(n(327));var m=r.callbackNode;if(mi()&&r.callbackNode!==m)return null;var y=un(r,r===Vn?ss:0);if(y===0)return null;if(y&30||y&r.expiredLanes||l)l=em(r,y);else{l=y;var k=Pt;Pt|=2;var O=Nw();(Vn!==r||ss!==l)&&(va=null,di=lt()+500,al(r,l));do try{Jz();break}catch(ee){jw(r,ee)}while(!0);Df(),Kd.current=O,Pt=k,An!==null?l=0:(Vn=null,ss=0,l=zn)}if(l!==0){if(l===2&&(k=En(r),k!==0&&(y=k,l=xp(r,k))),l===1)throw m=Pc,al(r,0),ro(r,y),Fs(r,lt()),m;if(l===6)ro(r,y);else{if(k=r.current.alternate,!(y&30)&&!Qz(k)&&(l=em(r,y),l===2&&(O=En(r),O!==0&&(y=O,l=xp(r,O))),l===1))throw m=Pc,al(r,0),ro(r,y),Fs(r,lt()),m;switch(r.finishedWork=k,r.finishedLanes=y,l){case 0:case 1:throw Error(n(345));case 2:ol(r,Ds,va);break;case 3:if(ro(r,y),(y&130023424)===y&&(l=vp+500-lt(),10<l)){if(un(r,0)!==0)break;if(k=r.suspendedLanes,(k&y)!==y){_s(),r.pingedLanes|=r.suspendedLanes&k;break}r.timeoutHandle=Ef(ol.bind(null,r,Ds,va),l);break}ol(r,Ds,va);break;case 4:if(ro(r,y),(y&4194240)===y)break;for(l=r.eventTimes,k=-1;0<y;){var B=31-we(y);O=1<<B,B=l[B],B>k&&(k=B),y&=~O}if(y=k,y=lt()-y,y=(120>y?120:480>y?480:1080>y?1080:1920>y?1920:3e3>y?3e3:4320>y?4320:1960*Gz(y/1960))-y,10<y){r.timeoutHandle=Ef(ol.bind(null,r,Ds,va),y);break}ol(r,Ds,va);break;case 5:ol(r,Ds,va);break;default:throw Error(n(329))}}}return Fs(r,lt()),r.callbackNode===m?xw.bind(null,r):null}function xp(r,l){var m=Lc;return r.current.memoizedState.isDehydrated&&(al(r,l).flags|=256),r=em(r,l),r!==2&&(l=Ds,Ds=m,l!==null&&wp(l)),r}function wp(r){Ds===null?Ds=r:Ds.push.apply(Ds,r)}function Qz(r){for(var l=r;;){if(l.flags&16384){var m=l.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var y=0;y<m.length;y++){var k=m[y],O=k.getSnapshot;k=k.value;try{if(!$s(O(),k))return!1}catch{return!1}}}if(m=l.child,l.subtreeFlags&16384&&m!==null)m.return=l,l=m;else{if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function ro(r,l){for(l&=~_p,l&=~Yd,r.suspendedLanes|=l,r.pingedLanes&=~l,r=r.expirationTimes;0<l;){var m=31-we(l),y=1<<m;r[m]=-1,l&=~y}}function ww(r){if(Pt&6)throw Error(n(327));mi();var l=un(r,0);if(!(l&1))return Fs(r,lt()),null;var m=em(r,l);if(r.tag!==0&&m===2){var y=En(r);y!==0&&(l=y,m=xp(r,y))}if(m===1)throw m=Pc,al(r,0),ro(r,l),Fs(r,lt()),m;if(m===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=l,ol(r,Ds,va),Fs(r,lt()),null}function jp(r,l){var m=Pt;Pt|=1;try{return r(l)}finally{Pt=m,Pt===0&&(di=lt()+500,Ed&&Xa())}}function rl(r){no!==null&&no.tag===0&&!(Pt&6)&&mi();var l=Pt;Pt|=1;var m=cr.transition,y=bt;try{if(cr.transition=null,bt=1,r)return r()}finally{bt=y,cr.transition=m,Pt=l,!(Pt&6)&&Xa()}}function Np(){er=ui.current,sn(ui)}function al(r,l){r.finishedWork=null,r.finishedLanes=0;var m=r.timeoutHandle;if(m!==-1&&(r.timeoutHandle=-1,Sz(m)),An!==null)for(m=An.return;m!==null;){var y=m;switch($f(y),y.tag){case 1:y=y.type.childContextTypes,y!=null&&Cd();break;case 3:li(),sn(Ls),sn(cs),Wf();break;case 5:Hf(y);break;case 4:li();break;case 13:sn(hn);break;case 19:sn(hn);break;case 10:Ff(y.type._context);break;case 22:case 23:Np()}m=m.return}if(Vn=r,An=r=ao(r.current,null),ss=er=l,zn=0,Pc=null,_p=Yd=sl=0,Ds=Lc=null,el!==null){for(l=0;l<el.length;l++)if(m=el[l],y=m.interleaved,y!==null){m.interleaved=null;var k=y.next,O=m.pending;if(O!==null){var B=O.next;O.next=k,y.next=B}m.pending=y}el=null}return r}function jw(r,l){do{var m=An;try{if(Df(),Rd.current=Bd,Dd){for(var y=fn.memoizedState;y!==null;){var k=y.queue;k!==null&&(k.pending=null),y=y.next}Dd=!1}if(nl=0,Hn=Ln=fn=null,kc=!1,Mc=0,gp.current=null,m===null||m.return===null){zn=1,Pc=l,An=null;break}e:{var O=r,B=m.return,ee=m,ae=l;if(l=ss,ee.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var he=ae,xe=ee,Ne=xe.tag;if(!(xe.mode&1)&&(Ne===0||Ne===11||Ne===15)){var be=xe.alternate;be?(xe.updateQueue=be.updateQueue,xe.memoizedState=be.memoizedState,xe.lanes=be.lanes):(xe.updateQueue=null,xe.memoizedState=null)}var Le=Y0(B);if(Le!==null){Le.flags&=-257,G0(Le,B,ee,O,l),Le.mode&1&&K0(O,he,l),l=Le,ae=he;var Fe=l.updateQueue;if(Fe===null){var Be=new Set;Be.add(ae),l.updateQueue=Be}else Fe.add(ae);break e}else{if(!(l&1)){K0(O,he,l),Cp();break e}ae=Error(n(426))}}else if(an&&ee.mode&1){var xn=Y0(B);if(xn!==null){!(xn.flags&65536)&&(xn.flags|=256),G0(xn,B,ee,O,l),zf(ii(ae,ee));break e}}O=ae=ii(ae,ee),zn!==4&&(zn=2),Lc===null?Lc=[O]:Lc.push(O),O=B;do{switch(O.tag){case 3:O.flags|=65536,l&=-l,O.lanes|=l;var ie=V0(O,ae,l);v0(O,ie);break e;case 1:ee=ae;var oe=O.type,ue=O.stateNode;if(!(O.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(to===null||!to.has(ue)))){O.flags|=65536,l&=-l,O.lanes|=l;var Ee=W0(O,ee,l);v0(O,Ee);break e}}O=O.return}while(O!==null)}Sw(m)}catch(Ve){l=Ve,An===m&&m!==null&&(An=m=m.return);continue}break}while(!0)}function Nw(){var r=Kd.current;return Kd.current=Bd,r===null?Bd:r}function Cp(){(zn===0||zn===3||zn===2)&&(zn=4),Vn===null||!(sl&268435455)&&!(Yd&268435455)||ro(Vn,ss)}function em(r,l){var m=Pt;Pt|=2;var y=Nw();(Vn!==r||ss!==l)&&(va=null,al(r,l));do try{Xz();break}catch(k){jw(r,k)}while(!0);if(Df(),Pt=m,Kd.current=y,An!==null)throw Error(n(261));return Vn=null,ss=0,zn}function Xz(){for(;An!==null;)Cw(An)}function Jz(){for(;An!==null&&!Qt();)Cw(An)}function Cw(r){var l=Mw(r.alternate,r,er);r.memoizedProps=r.pendingProps,l===null?Sw(r):An=l,gp.current=null}function Sw(r){var l=r;do{var m=l.alternate;if(r=l.return,l.flags&32768){if(m=Vz(m,l),m!==null){m.flags&=32767,An=m;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{zn=6,An=null;return}}else if(m=Hz(m,l,er),m!==null){An=m;return}if(l=l.sibling,l!==null){An=l;return}An=l=r}while(l!==null);zn===0&&(zn=5)}function ol(r,l,m){var y=bt,k=cr.transition;try{cr.transition=null,bt=1,Zz(r,l,m,y)}finally{cr.transition=k,bt=y}return null}function Zz(r,l,m,y){do mi();while(no!==null);if(Pt&6)throw Error(n(327));m=r.finishedWork;var k=r.finishedLanes;if(m===null)return null;if(r.finishedWork=null,r.finishedLanes=0,m===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var O=m.lanes|m.childLanes;if(Tr(r,O),r===Vn&&(An=Vn=null,ss=0),!(m.subtreeFlags&2064)&&!(m.flags&2064)||Qd||(Qd=!0,Aw(os,function(){return mi(),null})),O=(m.flags&15990)!==0,m.subtreeFlags&15990||O){O=cr.transition,cr.transition=null;var B=bt;bt=1;var ee=Pt;Pt|=4,gp.current=null,Kz(r,m),gw(m,r),bf(Cf),As=!!Go,Cf=Go=null,r.current=m,Yz(m),Tt(),Pt=ee,bt=B,cr.transition=O}else r.current=m;if(Qd&&(Qd=!1,no=r,Xd=k),O=r.pendingLanes,O===0&&(to=null),Nt(m.stateNode),Fs(r,lt()),l!==null)for(y=r.onRecoverableError,m=0;m<l.length;m++)k=l[m],y(k.value,{componentStack:k.stack,digest:k.digest});if(Gd)throw Gd=!1,r=yp,yp=null,r;return Xd&1&&r.tag!==0&&mi(),O=r.pendingLanes,O&1?r===bp?zc++:(zc=0,bp=r):zc=0,Xa(),null}function mi(){if(no!==null){var r=ea(Xd),l=cr.transition,m=bt;try{if(cr.transition=null,bt=16>r?16:r,no===null)var y=!1;else{if(r=no,no=null,Xd=0,Pt&6)throw Error(n(331));var k=Pt;for(Pt|=4,Re=r.current;Re!==null;){var O=Re,B=O.child;if(Re.flags&16){var ee=O.deletions;if(ee!==null){for(var ae=0;ae<ee.length;ae++){var he=ee[ae];for(Re=he;Re!==null;){var xe=Re;switch(xe.tag){case 0:case 11:case 15:$c(8,xe,O)}var Ne=xe.child;if(Ne!==null)Ne.return=xe,Re=Ne;else for(;Re!==null;){xe=Re;var be=xe.sibling,Le=xe.return;if(dw(xe),xe===he){Re=null;break}if(be!==null){be.return=Le,Re=be;break}Re=Le}}}var Fe=O.alternate;if(Fe!==null){var Be=Fe.child;if(Be!==null){Fe.child=null;do{var xn=Be.sibling;Be.sibling=null,Be=xn}while(Be!==null)}}Re=O}}if(O.subtreeFlags&2064&&B!==null)B.return=O,Re=B;else e:for(;Re!==null;){if(O=Re,O.flags&2048)switch(O.tag){case 0:case 11:case 15:$c(9,O,O.return)}var ie=O.sibling;if(ie!==null){ie.return=O.return,Re=ie;break e}Re=O.return}}var oe=r.current;for(Re=oe;Re!==null;){B=Re;var ue=B.child;if(B.subtreeFlags&2064&&ue!==null)ue.return=B,Re=ue;else e:for(B=oe;Re!==null;){if(ee=Re,ee.flags&2048)try{switch(ee.tag){case 0:case 11:case 15:Wd(9,ee)}}catch(Ve){_n(ee,ee.return,Ve)}if(ee===B){Re=null;break e}var Ee=ee.sibling;if(Ee!==null){Ee.return=ee.return,Re=Ee;break e}Re=ee.return}}if(Pt=k,Xa(),Pe&&typeof Pe.onPostCommitFiberRoot=="function")try{Pe.onPostCommitFiberRoot(ge,r)}catch{}y=!0}return y}finally{bt=m,cr.transition=l}}return!1}function Ew(r,l,m){l=ii(m,l),l=V0(r,l,1),r=Za(r,l,1),l=_s(),r!==null&&(qn(r,1,l),Fs(r,l))}function _n(r,l,m){if(r.tag===3)Ew(r,r,m);else for(;l!==null;){if(l.tag===3){Ew(l,r,m);break}else if(l.tag===1){var y=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof y.componentDidCatch=="function"&&(to===null||!to.has(y))){r=ii(m,r),r=W0(l,r,1),l=Za(l,r,1),r=_s(),l!==null&&(qn(l,1,r),Fs(l,r));break}}l=l.return}}function eR(r,l,m){var y=r.pingCache;y!==null&&y.delete(l),l=_s(),r.pingedLanes|=r.suspendedLanes&m,Vn===r&&(ss&m)===m&&(zn===4||zn===3&&(ss&130023424)===ss&&500>lt()-vp?al(r,0):_p|=m),Fs(r,l)}function kw(r,l){l===0&&(r.mode&1?(l=en,en<<=1,!(en&130023424)&&(en=4194304)):l=1);var m=_s();r=pa(r,l),r!==null&&(qn(r,l,m),Fs(r,m))}function tR(r){var l=r.memoizedState,m=0;l!==null&&(m=l.retryLane),kw(r,m)}function nR(r,l){var m=0;switch(r.tag){case 13:var y=r.stateNode,k=r.memoizedState;k!==null&&(m=k.retryLane);break;case 19:y=r.stateNode;break;default:throw Error(n(314))}y!==null&&y.delete(l),kw(r,m)}var Mw;Mw=function(r,l,m){if(r!==null)if(r.memoizedProps!==l.pendingProps||Ls.current)Rs=!0;else{if(!(r.lanes&m)&&!(l.flags&128))return Rs=!1,qz(r,l,m);Rs=!!(r.flags&131072)}else Rs=!1,an&&l.flags&1048576&&i0(l,Md,l.index);switch(l.lanes=0,l.tag){case 2:var y=l.type;Hd(r,l),r=l.pendingProps;var k=ei(l,cs.current);oi(l,m),k=Gf(null,l,y,r,k,m);var O=Qf();return l.flags|=1,typeof k=="object"&&k!==null&&typeof k.render=="function"&&k.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,zs(y)?(O=!0,Sd(l)):O=!1,l.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,Uf(l),k.updater=Ud,l.stateNode=k,k._reactInternals=l,np(l,y,r,m),l=op(null,l,y,!0,O,m)):(l.tag=0,an&&O&&Tf(l),gs(null,l,k,m),l=l.child),l;case 16:y=l.elementType;e:{switch(Hd(r,l),r=l.pendingProps,k=y._init,y=k(y._payload),l.type=y,k=l.tag=rR(y),r=xr(y,r),k){case 0:l=ap(null,l,y,r,m);break e;case 1:l=tw(null,l,y,r,m);break e;case 11:l=Q0(null,l,y,r,m);break e;case 14:l=X0(null,l,y,xr(y.type,r),m);break e}throw Error(n(306,y,""))}return l;case 0:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:xr(y,k),ap(r,l,y,k,m);case 1:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:xr(y,k),tw(r,l,y,k,m);case 3:e:{if(nw(l),r===null)throw Error(n(387));y=l.pendingProps,O=l.memoizedState,k=O.element,_0(r,l),Ld(l,y,null,m);var B=l.memoizedState;if(y=B.element,O.isDehydrated)if(O={element:y,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},l.updateQueue.baseState=O,l.memoizedState=O,l.flags&256){k=ii(Error(n(423)),l),l=sw(r,l,y,m,k);break e}else if(y!==k){k=ii(Error(n(424)),l),l=sw(r,l,y,m,k);break e}else for(Zs=Ya(l.stateNode.containerInfo.firstChild),Js=l,an=!0,br=null,m=p0(l,null,y,m),l.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(si(),y===k){l=_a(r,l,m);break e}gs(r,l,y,m)}l=l.child}return l;case 5:return b0(l),r===null&&Lf(l),y=l.type,k=l.pendingProps,O=r!==null?r.memoizedProps:null,B=k.children,Sf(y,k)?B=null:O!==null&&Sf(y,O)&&(l.flags|=32),ew(r,l),gs(r,l,B,m),l.child;case 6:return r===null&&Lf(l),null;case 13:return rw(r,l,m);case 4:return qf(l,l.stateNode.containerInfo),y=l.pendingProps,r===null?l.child=ri(l,null,y,m):gs(r,l,y,m),l.child;case 11:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:xr(y,k),Q0(r,l,y,k,m);case 7:return gs(r,l,l.pendingProps,m),l.child;case 8:return gs(r,l,l.pendingProps.children,m),l.child;case 12:return gs(r,l,l.pendingProps.children,m),l.child;case 10:e:{if(y=l.type._context,k=l.pendingProps,O=l.memoizedProps,B=k.value,Jt(Td,y._currentValue),y._currentValue=B,O!==null)if($s(O.value,B)){if(O.children===k.children&&!Ls.current){l=_a(r,l,m);break e}}else for(O=l.child,O!==null&&(O.return=l);O!==null;){var ee=O.dependencies;if(ee!==null){B=O.child;for(var ae=ee.firstContext;ae!==null;){if(ae.context===y){if(O.tag===1){ae=ga(-1,m&-m),ae.tag=2;var he=O.updateQueue;if(he!==null){he=he.shared;var xe=he.pending;xe===null?ae.next=ae:(ae.next=xe.next,xe.next=ae),he.pending=ae}}O.lanes|=m,ae=O.alternate,ae!==null&&(ae.lanes|=m),If(O.return,m,l),ee.lanes|=m;break}ae=ae.next}}else if(O.tag===10)B=O.type===l.type?null:O.child;else if(O.tag===18){if(B=O.return,B===null)throw Error(n(341));B.lanes|=m,ee=B.alternate,ee!==null&&(ee.lanes|=m),If(B,m,l),B=O.sibling}else B=O.child;if(B!==null)B.return=O;else for(B=O;B!==null;){if(B===l){B=null;break}if(O=B.sibling,O!==null){O.return=B.return,B=O;break}B=B.return}O=B}gs(r,l,k.children,m),l=l.child}return l;case 9:return k=l.type,y=l.pendingProps.children,oi(l,m),k=lr(k),y=y(k),l.flags|=1,gs(r,l,y,m),l.child;case 14:return y=l.type,k=xr(y,l.pendingProps),k=xr(y.type,k),X0(r,l,y,k,m);case 15:return J0(r,l,l.type,l.pendingProps,m);case 17:return y=l.type,k=l.pendingProps,k=l.elementType===y?k:xr(y,k),Hd(r,l),l.tag=1,zs(y)?(r=!0,Sd(l)):r=!1,oi(l,m),q0(l,y,k),np(l,y,k,m),op(null,l,y,!0,r,m);case 19:return ow(r,l,m);case 22:return Z0(r,l,m)}throw Error(n(156,l.tag))};function Aw(r,l){return Ss(r,l)}function sR(r,l,m,y){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=y,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(r,l,m,y){return new sR(r,l,m,y)}function Sp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function rR(r){if(typeof r=="function")return Sp(r)?1:0;if(r!=null){if(r=r.$$typeof,r===R)return 11;if(r===D)return 14}return 2}function ao(r,l){var m=r.alternate;return m===null?(m=ur(r.tag,l,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=l,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&14680064,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,l=r.dependencies,m.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m}function tm(r,l,m,y,k,O){var B=2;if(y=r,typeof r=="function")Sp(r)&&(B=1);else if(typeof r=="string")B=5;else e:switch(r){case T:return ll(m.children,k,O,l);case P:B=8,k|=8;break;case L:return r=ur(12,m,l,k|2),r.elementType=L,r.lanes=O,r;case W:return r=ur(13,m,l,k),r.elementType=W,r.lanes=O,r;case z:return r=ur(19,m,l,k),r.elementType=z,r.lanes=O,r;case q:return nm(m,k,O,l);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case $:B=10;break e;case A:B=9;break e;case R:B=11;break e;case D:B=14;break e;case H:B=16,y=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return l=ur(B,m,l,k),l.elementType=r,l.type=y,l.lanes=O,l}function ll(r,l,m,y){return r=ur(7,r,y,l),r.lanes=m,r}function nm(r,l,m,y){return r=ur(22,r,y,l),r.elementType=q,r.lanes=m,r.stateNode={isHidden:!1},r}function Ep(r,l,m){return r=ur(6,r,null,l),r.lanes=m,r}function kp(r,l,m){return l=ur(4,r.children!==null?r.children:[],r.key,l),l.lanes=m,l.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},l}function aR(r,l,m,y,k){this.tag=l,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Zn(0),this.expirationTimes=Zn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Zn(0),this.identifierPrefix=y,this.onRecoverableError=k,this.mutableSourceEagerHydrationData=null}function Mp(r,l,m,y,k,O,B,ee,ae){return r=new aR(r,l,m,ee,ae),l===1?(l=1,O===!0&&(l|=8)):l=0,O=ur(3,null,null,l),r.current=O,O.stateNode=r,O.memoizedState={element:y,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uf(O),r}function oR(r,l,m){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:M,key:y==null?null:""+y,children:r,containerInfo:l,implementation:m}}function Ow(r){if(!r)return Qa;r=r._reactInternals;e:{if(vn(r)!==r||r.tag!==1)throw Error(n(170));var l=r;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(zs(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(n(171))}if(r.tag===1){var m=r.type;if(zs(m))return a0(r,m,l)}return l}function Tw(r,l,m,y,k,O,B,ee,ae){return r=Mp(m,y,!0,r,k,O,B,ee,ae),r.context=Ow(null),m=r.current,y=_s(),k=so(m),O=ga(y,k),O.callback=l??null,Za(m,O,k),r.current.lanes=k,qn(r,k,y),Fs(r,y),r}function sm(r,l,m,y){var k=l.current,O=_s(),B=so(k);return m=Ow(m),l.context===null?l.context=m:l.pendingContext=m,l=ga(O,B),l.payload={element:r},y=y===void 0?null:y,y!==null&&(l.callback=y),r=Za(k,l,B),r!==null&&(Nr(r,k,B,O),Pd(r,k,B)),B}function rm(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function $w(r,l){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<l?m:l}}function Ap(r,l){$w(r,l),(r=r.alternate)&&$w(r,l)}function lR(){return null}var Pw=typeof reportError=="function"?reportError:function(r){console.error(r)};function Op(r){this._internalRoot=r}am.prototype.render=Op.prototype.render=function(r){var l=this._internalRoot;if(l===null)throw Error(n(409));sm(r,l,null,null)},am.prototype.unmount=Op.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var l=r.containerInfo;rl(function(){sm(null,r,null,null)}),l[da]=null}};function am(r){this._internalRoot=r}am.prototype.unstable_scheduleHydration=function(r){if(r){var l=Io();r={blockedOn:null,target:r,priority:l};for(var m=0;m<Ce.length&&l!==0&&l<Ce[m].priority;m++);Ce.splice(m,0,r),m===0&&ot(r)}};function Tp(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function om(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Lw(){}function iR(r,l,m,y,k){if(k){if(typeof y=="function"){var O=y;y=function(){var he=rm(B);O.call(he)}}var B=Tw(l,y,r,0,null,!1,!1,"",Lw);return r._reactRootContainer=B,r[da]=B.current,Mt(r.nodeType===8?r.parentNode:r),rl(),B}for(;k=r.lastChild;)r.removeChild(k);if(typeof y=="function"){var ee=y;y=function(){var he=rm(ae);ee.call(he)}}var ae=Mp(r,0,!1,null,null,!1,!1,"",Lw);return r._reactRootContainer=ae,r[da]=ae.current,Mt(r.nodeType===8?r.parentNode:r),rl(function(){sm(l,ae,m,y)}),ae}function lm(r,l,m,y,k){var O=m._reactRootContainer;if(O){var B=O;if(typeof k=="function"){var ee=k;k=function(){var ae=rm(B);ee.call(ae)}}sm(l,B,r,k)}else B=iR(m,l,r,k,y);return rm(B)}Da=function(r){switch(r.tag){case 3:var l=r.stateNode;if(l.current.memoizedState.isDehydrated){var m=qt(l.pendingLanes);m!==0&&(Ra(l,m|1),Fs(l,lt()),!(Pt&6)&&(di=lt()+500,Xa()))}break;case 13:rl(function(){var y=pa(r,1);if(y!==null){var k=_s();Nr(y,r,1,k)}}),Ap(r,1)}},Fo=function(r){if(r.tag===13){var l=pa(r,134217728);if(l!==null){var m=_s();Nr(l,r,134217728,m)}Ap(r,134217728)}},Bl=function(r){if(r.tag===13){var l=so(r),m=pa(r,l);if(m!==null){var y=_s();Nr(m,r,l,y)}Ap(r,l)}},Io=function(){return bt},vr=function(r,l){var m=bt;try{return bt=r,l()}finally{bt=m}},fe=function(r,l,m){switch(l){case"input":if(de(r,m),l=m.name,m.type==="radio"&&l!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<m.length;l++){var y=m[l];if(y!==r&&y.form===r.form){var k=Nd(y);if(!k)throw Error(n(90));ze(y),de(y,k)}}}break;case"textarea":Qe(r,m);break;case"select":l=m.value,l!=null&&De(r,!!m.multiple,l,!1)}},mt=jp,Ns=rl;var cR={usingClientEntryPoint:!1,Events:[jc,Jl,Nd,qe,wt,jp]},Rc={findFiberByHostInstance:Qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uR={bundleType:Rc.bundleType,version:Rc.version,rendererPackageName:Rc.rendererPackageName,rendererConfig:Rc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=In(r),r===null?null:r.stateNode},findFiberByHostInstance:Rc.findFiberByHostInstance||lR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var im=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!im.isDisabled&&im.supportsFiber)try{ge=im.inject(uR),Pe=im}catch{}}return vs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cR,vs.createPortal=function(r,l){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tp(l))throw Error(n(200));return oR(r,l,null,m)},vs.createRoot=function(r,l){if(!Tp(r))throw Error(n(299));var m=!1,y="",k=Pw;return l!=null&&(l.unstable_strictMode===!0&&(m=!0),l.identifierPrefix!==void 0&&(y=l.identifierPrefix),l.onRecoverableError!==void 0&&(k=l.onRecoverableError)),l=Mp(r,1,!1,null,null,m,!1,y,k),r[da]=l.current,Mt(r.nodeType===8?r.parentNode:r),new Op(l)},vs.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var l=r._reactInternals;if(l===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=In(l),r=r===null?null:r.stateNode,r},vs.flushSync=function(r){return rl(r)},vs.hydrate=function(r,l,m){if(!om(l))throw Error(n(200));return lm(null,r,l,!0,m)},vs.hydrateRoot=function(r,l,m){if(!Tp(r))throw Error(n(405));var y=m!=null&&m.hydratedSources||null,k=!1,O="",B=Pw;if(m!=null&&(m.unstable_strictMode===!0&&(k=!0),m.identifierPrefix!==void 0&&(O=m.identifierPrefix),m.onRecoverableError!==void 0&&(B=m.onRecoverableError)),l=Tw(l,null,r,1,m??null,k,!1,O,B),r[da]=l.current,Mt(r),y)for(r=0;r<y.length;r++)m=y[r],k=m._getVersion,k=k(m._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[m,k]:l.mutableSourceEagerHydrationData.push(m,k);return new am(l)},vs.render=function(r,l,m){if(!om(l))throw Error(n(200));return lm(null,r,l,!1,m)},vs.unmountComponentAtNode=function(r){if(!om(r))throw Error(n(40));return r._reactRootContainer?(rl(function(){lm(null,null,r,!1,function(){r._reactRootContainer=null,r[da]=null})}),!0):!1},vs.unstable_batchedUpdates=jp,vs.unstable_renderSubtreeIntoContainer=function(r,l,m,y){if(!om(m))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return lm(r,l,m,!1,y)},vs.version="18.3.1-next-f1338f8080-20240426",vs}function Yp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yp)}catch(e){console.error(e)}}Yp(),Hp.exports=Uw();var Gp=Hp.exports,Qp=Gp;dm.createRoot=Qp.createRoot,dm.hydrateRoot=Qp.hydrateRoot;var il=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},qw={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Hw=(Vx=class{constructor(){Ke(this,ka,qw);Ke(this,af,!1)}setTimeoutProvider(e){$e(this,ka,e)}setTimeout(e,t){return ne(this,ka).setTimeout(e,t)}clearTimeout(e){ne(this,ka).clearTimeout(e)}setInterval(e,t){return ne(this,ka).setInterval(e,t)}clearInterval(e){ne(this,ka).clearInterval(e)}},ka=new WeakMap,af=new WeakMap,Vx),co=new Hw;function Vw(e){setTimeout(e,0)}var uo=typeof window>"u"||"Deno"in globalThis;function hs(){}function Ww(e,t){return typeof e=="function"?e(t):e}function fm(e){return typeof e=="number"&&e>=0&&e!==1/0}function Xp(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ba(e,t){return typeof e=="function"?e(t):e}function tr(e,t){return typeof e=="function"?e(t):e}function Jp(e,t){const{type:n="all",exact:s,fetchStatus:o,predicate:i,queryKey:c,stale:u}=e;if(c){if(s){if(t.queryHash!==pm(c,t.options))return!1}else if(!hi(t.queryKey,c))return!1}if(n!=="all"){const d=t.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||o&&o!==t.state.fetchStatus||i&&!i(t))}function Zp(e,t){const{exact:n,status:s,predicate:o,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(mo(t.options.mutationKey)!==mo(i))return!1}else if(!hi(t.options.mutationKey,i))return!1}return!(s&&t.state.status!==s||o&&!o(t))}function pm(e,t){return((t==null?void 0:t.queryKeyHashFn)||mo)(e)}function mo(e){return JSON.stringify(e,(t,n)=>gm(n)?Object.keys(n).sort().reduce((s,o)=>(s[o]=n[o],s),{}):n)}function hi(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>hi(e[n],t[n])):!1}var Kw=Object.prototype.hasOwnProperty;function eg(e,t){if(e===t)return e;const n=tg(e)&&tg(t);if(!n&&!(gm(e)&&gm(t)))return t;const o=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),c=i.length,u=n?new Array(c):{};let d=0;for(let p=0;p<c;p++){const h=n?p:i[p],f=e[h],g=t[h];if(f===g){u[h]=f,(n?p<o:Kw.call(e,h))&&d++;continue}if(f===null||g===null||typeof f!="object"||typeof g!="object"){u[h]=g;continue}const w=eg(f,g);u[h]=w,w===f&&d++}return o===c&&d===o?e:u}function Fc(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function tg(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function gm(e){if(!ng(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!ng(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ng(e){return Object.prototype.toString.call(e)==="[object Object]"}function Yw(e){return new Promise(t=>{co.setTimeout(t,e)})}function _m(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?eg(e,t):t}function Gw(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function Qw(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var vm=Symbol();function sg(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===vm?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function rg(e,t){return typeof e=="function"?e(...t):!!e}var Xw=(Wx=class extends il{constructor(){super();Ke(this,Ao);Ke(this,Ma);Ke(this,Ml);$e(this,Ml,t=>{if(!uo&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ne(this,Ma)||this.setEventListener(ne(this,Ml))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,Ma))==null||t.call(this),$e(this,Ma,void 0))}setEventListener(t){var n;$e(this,Ml,t),(n=ne(this,Ma))==null||n.call(this),$e(this,Ma,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){ne(this,Ao)!==t&&($e(this,Ao,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof ne(this,Ao)=="boolean"?ne(this,Ao):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ao=new WeakMap,Ma=new WeakMap,Ml=new WeakMap,Wx),ym=new Xw;function bm(){let e,t;const n=new Promise((o,i)=>{e=o,t=i});n.status="pending",n.catch(()=>{});function s(o){Object.assign(n,o),delete n.resolve,delete n.reject}return n.resolve=o=>{s({status:"fulfilled",value:o}),e(o)},n.reject=o=>{s({status:"rejected",reason:o}),t(o)},n}var Jw=Vw;function Zw(){let e=[],t=0,n=u=>{u()},s=u=>{u()},o=Jw;const i=u=>{t?e.push(u):o(()=>{n(u)})},c=()=>{const u=e;e=[],u.length&&o(()=>{s(()=>{u.forEach(d=>{n(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{i(()=>{u(...d)})},schedule:i,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{o=u}}}var On=Zw(),ej=(Kx=class extends il{constructor(){super();Ke(this,Al,!0);Ke(this,Aa);Ke(this,Ol);$e(this,Ol,t=>{if(!uo&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){ne(this,Aa)||this.setEventListener(ne(this,Ol))}onUnsubscribe(){var t;this.hasListeners()||((t=ne(this,Aa))==null||t.call(this),$e(this,Aa,void 0))}setEventListener(t){var n;$e(this,Ol,t),(n=ne(this,Aa))==null||n.call(this),$e(this,Aa,t(this.setOnline.bind(this)))}setOnline(t){ne(this,Al)!==t&&($e(this,Al,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return ne(this,Al)}},Al=new WeakMap,Aa=new WeakMap,Ol=new WeakMap,Kx),Ic=new ej;function tj(e){return Math.min(1e3*2**e,3e4)}function ag(e){return(e??"online")==="online"?Ic.isOnline():!0}var xm=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function og(e){let t=!1,n=0,s;const o=bm(),i=()=>o.status!=="pending",c=_=>{var x;if(!i()){const N=new xm(_);g(N),(x=e.onCancel)==null||x.call(e,N)}},u=()=>{t=!0},d=()=>{t=!1},p=()=>ym.isFocused()&&(e.networkMode==="always"||Ic.isOnline())&&e.canRun(),h=()=>ag(e.networkMode)&&e.canRun(),f=_=>{i()||(s==null||s(),o.resolve(_))},g=_=>{i()||(s==null||s(),o.reject(_))},w=()=>new Promise(_=>{var x;s=N=>{(i()||p())&&_(N)},(x=e.onPause)==null||x.call(e)}).then(()=>{var _;s=void 0,i()||(_=e.onContinue)==null||_.call(e)}),b=()=>{if(i())return;let _;const x=n===0?e.initialPromise:void 0;try{_=x??e.fn()}catch(N){_=Promise.reject(N)}Promise.resolve(_).then(f).catch(N=>{var M;if(i())return;const C=e.retry??(uo?0:3),E=e.retryDelay??tj,j=typeof E=="function"?E(n,N):E,S=C===!0||typeof C=="number"&&n<C||typeof C=="function"&&C(n,N);if(t||!S){g(N);return}n++,(M=e.onFail)==null||M.call(e,n,N),Yw(j).then(()=>p()?void 0:w()).then(()=>{t?g(N):b()})})};return{promise:o,status:()=>o.status,cancel:c,continue:()=>(s==null||s(),o),cancelRetry:u,continueRetry:d,canStart:h,start:()=>(h()?b():w().then(b),o)}}var lg=(Yx=class{constructor(){Ke(this,Oo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),fm(this.gcTime)&&$e(this,Oo,co.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(uo?1/0:5*60*1e3))}clearGcTimeout(){ne(this,Oo)&&(co.clearTimeout(ne(this,Oo)),$e(this,Oo,void 0))}},Oo=new WeakMap,Yx),nj={NODE_ENV:"production"},sj=(Gx=class extends lg{constructor(t){super();Ke(this,pr);Ke(this,To);Ke(this,Tl);Ke(this,nr);Ke(this,$o);Ke(this,Dn);Ke(this,Zi);Ke(this,Po);$e(this,Po,!1),$e(this,Zi,t.defaultOptions),this.setOptions(t.options),this.observers=[],$e(this,$o,t.client),$e(this,nr,ne(this,$o).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,$e(this,To,cg(this.options)),this.state=t.state??ne(this,To),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ne(this,Dn))==null?void 0:t.promise}setOptions(t){if(this.options={...ne(this,Zi),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=cg(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),$e(this,To,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ne(this,nr).remove(this)}setData(t,n){const s=_m(this.state.data,t,this.options);return yt(this,pr,ya).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){yt(this,pr,ya).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,o;const n=(s=ne(this,Dn))==null?void 0:s.promise;return(o=ne(this,Dn))==null||o.cancel(t),n?n.then(hs).catch(hs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ne(this,To))}isActive(){return this.observers.some(t=>tr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===vm||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ba(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Xp(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,Dn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=ne(this,Dn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ne(this,nr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(ne(this,Dn)&&(ne(this,Po)?ne(this,Dn).cancel({revert:!0}):ne(this,Dn).cancelRetry()),this.scheduleGc()),ne(this,nr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||yt(this,pr,ya).call(this,{type:"invalidate"})}async fetch(t,n){var d,p,h,f,g,w,b,_,x,N,C,E;if(this.state.fetchStatus!=="idle"&&((d=ne(this,Dn))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ne(this,Dn))return ne(this,Dn).continueRetry(),ne(this,Dn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(S=>S.options.queryFn);j&&this.setOptions(j.options)}const s=new AbortController,o=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>($e(this,Po,!0),s.signal)})},i=()=>{const j=sg(this.options,n),M=(()=>{const T={client:ne(this,$o),queryKey:this.queryKey,meta:this.meta};return o(T),T})();return $e(this,Po,!1),this.options.persister?this.options.persister(j,M,this):j(M)},u=(()=>{const j={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:ne(this,$o),state:this.state,fetchFn:i};return o(j),j})();(p=this.options.behavior)==null||p.onFetch(u,this),$e(this,Tl,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=u.fetchOptions)==null?void 0:h.meta))&&yt(this,pr,ya).call(this,{type:"fetch",meta:(f=u.fetchOptions)==null?void 0:f.meta}),$e(this,Dn,og({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,onCancel:j=>{j instanceof xm&&j.revert&&this.setState({...ne(this,Tl),fetchStatus:"idle"}),s.abort()},onFail:(j,S)=>{yt(this,pr,ya).call(this,{type:"failed",failureCount:j,error:S})},onPause:()=>{yt(this,pr,ya).call(this,{type:"pause"})},onContinue:()=>{yt(this,pr,ya).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const j=await ne(this,Dn).start();if(j===void 0)throw nj.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(j),(w=(g=ne(this,nr).config).onSuccess)==null||w.call(g,j,this),(_=(b=ne(this,nr).config).onSettled)==null||_.call(b,j,this.state.error,this),j}catch(j){if(j instanceof xm){if(j.silent)return ne(this,Dn).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw yt(this,pr,ya).call(this,{type:"error",error:j}),(N=(x=ne(this,nr).config).onError)==null||N.call(x,j,this),(E=(C=ne(this,nr).config).onSettled)==null||E.call(C,this.state.data,j,this),j}finally{this.scheduleGc()}}},To=new WeakMap,Tl=new WeakMap,nr=new WeakMap,$o=new WeakMap,Dn=new WeakMap,Zi=new WeakMap,Po=new WeakMap,pr=new WeakSet,ya=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...ig(s.data,this.options),fetchMeta:t.meta??null};case"success":const o={...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return $e(this,Tl,t.manual?o:void 0),o;case"error":const i=t.error;return{...s,error:i,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),On.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),ne(this,nr).notify({query:this,type:"updated",action:t})})},Gx);function ig(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ag(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function cg(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var rj=(Qx=class extends il{constructor(t,n){super();Ke(this,Ft);Ke(this,ws);Ke(this,St);Ke(this,ec);Ke(this,fs);Ke(this,Lo);Ke(this,$l);Ke(this,Gr);Ke(this,Oa);Ke(this,tc);Ke(this,Pl);Ke(this,Ll);Ke(this,zo);Ke(this,Ro);Ke(this,Ta);Ke(this,zl,new Set);this.options=n,$e(this,ws,t),$e(this,Oa,null),$e(this,Gr,bm()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ne(this,St).addObserver(this),ug(ne(this,St),this.options)?yt(this,Ft,Dc).call(this):this.updateResult(),yt(this,Ft,Rp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return wm(ne(this,St),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return wm(ne(this,St),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,yt(this,Ft,Dp).call(this),yt(this,Ft,Fp).call(this),ne(this,St).removeObserver(this)}setOptions(t){const n=this.options,s=ne(this,St);if(this.options=ne(this,ws).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof tr(this.options.enabled,ne(this,St))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");yt(this,Ft,Ip).call(this),ne(this,St).setOptions(this.options),n._defaulted&&!Fc(this.options,n)&&ne(this,ws).getQueryCache().notify({type:"observerOptionsUpdated",query:ne(this,St),observer:this});const o=this.hasListeners();o&&dg(ne(this,St),s,this.options,n)&&yt(this,Ft,Dc).call(this),this.updateResult(),o&&(ne(this,St)!==s||tr(this.options.enabled,ne(this,St))!==tr(n.enabled,ne(this,St))||ba(this.options.staleTime,ne(this,St))!==ba(n.staleTime,ne(this,St)))&&yt(this,Ft,Pp).call(this);const i=yt(this,Ft,Lp).call(this);o&&(ne(this,St)!==s||tr(this.options.enabled,ne(this,St))!==tr(n.enabled,ne(this,St))||i!==ne(this,Ta))&&yt(this,Ft,zp).call(this,i)}getOptimisticResult(t){const n=ne(this,ws).getQueryCache().build(ne(this,ws),t),s=this.createResult(n,t);return oj(this,s)&&($e(this,fs,s),$e(this,$l,this.options),$e(this,Lo,ne(this,St).state)),s}getCurrentResult(){return ne(this,fs)}trackResult(t,n){return new Proxy(t,{get:(s,o)=>(this.trackProp(o),n==null||n(o),o==="promise"&&!this.options.experimental_prefetchInRender&&ne(this,Gr).status==="pending"&&ne(this,Gr).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(s,o))})}trackProp(t){ne(this,zl).add(t)}getCurrentQuery(){return ne(this,St)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=ne(this,ws).defaultQueryOptions(t),s=ne(this,ws).getQueryCache().build(ne(this,ws),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(t){return yt(this,Ft,Dc).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ne(this,fs)))}createResult(t,n){var L;const s=ne(this,St),o=this.options,i=ne(this,fs),c=ne(this,Lo),u=ne(this,$l),p=t!==s?t.state:ne(this,ec),{state:h}=t;let f={...h},g=!1,w;if(n._optimisticResults){const $=this.hasListeners(),A=!$&&ug(t,n),R=$&&dg(t,s,n,o);(A||R)&&(f={...f,...ig(h.data,t.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:b,errorUpdatedAt:_,status:x}=f;w=f.data;let N=!1;if(n.placeholderData!==void 0&&w===void 0&&x==="pending"){let $;i!=null&&i.isPlaceholderData&&n.placeholderData===(u==null?void 0:u.placeholderData)?($=i.data,N=!0):$=typeof n.placeholderData=="function"?n.placeholderData((L=ne(this,Ll))==null?void 0:L.state.data,ne(this,Ll)):n.placeholderData,$!==void 0&&(x="success",w=_m(i==null?void 0:i.data,$,n),g=!0)}if(n.select&&w!==void 0&&!N)if(i&&w===(c==null?void 0:c.data)&&n.select===ne(this,tc))w=ne(this,Pl);else try{$e(this,tc,n.select),w=n.select(w),w=_m(i==null?void 0:i.data,w,n),$e(this,Pl,w),$e(this,Oa,null)}catch($){$e(this,Oa,$)}ne(this,Oa)&&(b=ne(this,Oa),w=ne(this,Pl),_=Date.now(),x="error");const C=f.fetchStatus==="fetching",E=x==="pending",j=x==="error",S=E&&C,M=w!==void 0,P={status:x,fetchStatus:f.fetchStatus,isPending:E,isSuccess:x==="success",isError:j,isInitialLoading:S,isLoading:S,data:w,dataUpdatedAt:f.dataUpdatedAt,error:b,errorUpdatedAt:_,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>p.dataUpdateCount||f.errorUpdateCount>p.errorUpdateCount,isFetching:C,isRefetching:C&&!E,isLoadingError:j&&!M,isPaused:f.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:j&&M,isStale:jm(t,n),refetch:this.refetch,promise:ne(this,Gr),isEnabled:tr(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const $=W=>{P.status==="error"?W.reject(P.error):P.data!==void 0&&W.resolve(P.data)},A=()=>{const W=$e(this,Gr,P.promise=bm());$(W)},R=ne(this,Gr);switch(R.status){case"pending":t.queryHash===s.queryHash&&$(R);break;case"fulfilled":(P.status==="error"||P.data!==R.value)&&A();break;case"rejected":(P.status!=="error"||P.error!==R.reason)&&A();break}}return P}updateResult(){const t=ne(this,fs),n=this.createResult(ne(this,St),this.options);if($e(this,Lo,ne(this,St).state),$e(this,$l,this.options),ne(this,Lo).data!==void 0&&$e(this,Ll,ne(this,St)),Fc(n,t))return;$e(this,fs,n);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:o}=this.options,i=typeof o=="function"?o():o;if(i==="all"||!i&&!ne(this,zl).size)return!0;const c=new Set(i??ne(this,zl));return this.options.throwOnError&&c.add("error"),Object.keys(ne(this,fs)).some(u=>{const d=u;return ne(this,fs)[d]!==t[d]&&c.has(d)})};yt(this,Ft,Rw).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&yt(this,Ft,Rp).call(this)}},ws=new WeakMap,St=new WeakMap,ec=new WeakMap,fs=new WeakMap,Lo=new WeakMap,$l=new WeakMap,Gr=new WeakMap,Oa=new WeakMap,tc=new WeakMap,Pl=new WeakMap,Ll=new WeakMap,zo=new WeakMap,Ro=new WeakMap,Ta=new WeakMap,zl=new WeakMap,Ft=new WeakSet,Dc=function(t){yt(this,Ft,Ip).call(this);let n=ne(this,St).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(hs)),n},Pp=function(){yt(this,Ft,Dp).call(this);const t=ba(this.options.staleTime,ne(this,St));if(uo||ne(this,fs).isStale||!fm(t))return;const s=Xp(ne(this,fs).dataUpdatedAt,t)+1;$e(this,zo,co.setTimeout(()=>{ne(this,fs).isStale||this.updateResult()},s))},Lp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ne(this,St)):this.options.refetchInterval)??!1},zp=function(t){yt(this,Ft,Fp).call(this),$e(this,Ta,t),!(uo||tr(this.options.enabled,ne(this,St))===!1||!fm(ne(this,Ta))||ne(this,Ta)===0)&&$e(this,Ro,co.setInterval(()=>{(this.options.refetchIntervalInBackground||ym.isFocused())&&yt(this,Ft,Dc).call(this)},ne(this,Ta)))},Rp=function(){yt(this,Ft,Pp).call(this),yt(this,Ft,zp).call(this,yt(this,Ft,Lp).call(this))},Dp=function(){ne(this,zo)&&(co.clearTimeout(ne(this,zo)),$e(this,zo,void 0))},Fp=function(){ne(this,Ro)&&(co.clearInterval(ne(this,Ro)),$e(this,Ro,void 0))},Ip=function(){const t=ne(this,ws).getQueryCache().build(ne(this,ws),this.options);if(t===ne(this,St))return;const n=ne(this,St);$e(this,St,t),$e(this,ec,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},Rw=function(t){On.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(ne(this,fs))}),ne(this,ws).getQueryCache().notify({query:ne(this,St),type:"observerResultsUpdated"})})},Qx);function aj(e,t){return tr(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function ug(e,t){return aj(e,t)||e.state.data!==void 0&&wm(e,t,t.refetchOnMount)}function wm(e,t,n){if(tr(t.enabled,e)!==!1&&ba(t.staleTime,e)!=="static"){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&jm(e,t)}return!1}function dg(e,t,n,s){return(e!==t||tr(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&jm(e,n)}function jm(e,t){return tr(t.enabled,e)!==!1&&e.isStaleByTime(ba(t.staleTime,e))}function oj(e,t){return!Fc(e.getCurrentResult(),t)}function mg(e){return{onFetch:(t,n)=>{var h,f,g,w,b;const s=t.options,o=(g=(f=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:g.direction,i=((w=t.state.data)==null?void 0:w.pages)||[],c=((b=t.state.data)==null?void 0:b.pageParams)||[];let u={pages:[],pageParams:[]},d=0;const p=async()=>{let _=!1;const x=E=>{Object.defineProperty(E,"signal",{enumerable:!0,get:()=>(t.signal.aborted?_=!0:t.signal.addEventListener("abort",()=>{_=!0}),t.signal)})},N=sg(t.options,t.fetchOptions),C=async(E,j,S)=>{if(_)return Promise.reject();if(j==null&&E.pages.length)return Promise.resolve(E);const T=(()=>{const A={client:t.client,queryKey:t.queryKey,pageParam:j,direction:S?"backward":"forward",meta:t.options.meta};return x(A),A})(),P=await N(T),{maxPages:L}=t.options,$=S?Qw:Gw;return{pages:$(E.pages,P,L),pageParams:$(E.pageParams,j,L)}};if(o&&i.length){const E=o==="backward",j=E?lj:hg,S={pages:i,pageParams:c},M=j(s,S);u=await C(S,M,E)}else{const E=e??i.length;do{const j=d===0?c[0]??s.initialPageParam:hg(s,u);if(d>0&&j==null)break;u=await C(u,j),d++}while(d<E)}return u};t.options.persister?t.fetchFn=()=>{var _,x;return(x=(_=t.options).persister)==null?void 0:x.call(_,p,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=p}}}function hg(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function lj(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var ij=(Xx=class extends lg{constructor(t){super();Ke(this,Ar);Ke(this,nc);Ke(this,Mr);Ke(this,ps);Ke(this,Do);$e(this,nc,t.client),this.mutationId=t.mutationId,$e(this,ps,t.mutationCache),$e(this,Mr,[]),this.state=t.state||fg(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ne(this,Mr).includes(t)||(ne(this,Mr).push(t),this.clearGcTimeout(),ne(this,ps).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){$e(this,Mr,ne(this,Mr).filter(n=>n!==t)),this.scheduleGc(),ne(this,ps).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ne(this,Mr).length||(this.state.status==="pending"?this.scheduleGc():ne(this,ps).remove(this))}continue(){var t;return((t=ne(this,Do))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var c,u,d,p,h,f,g,w,b,_,x,N,C,E,j,S,M,T,P,L;const n=()=>{yt(this,Ar,lo).call(this,{type:"continue"})},s={client:ne(this,nc),meta:this.options.meta,mutationKey:this.options.mutationKey};$e(this,Do,og({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:($,A)=>{yt(this,Ar,lo).call(this,{type:"failed",failureCount:$,error:A})},onPause:()=>{yt(this,Ar,lo).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ne(this,ps).canRun(this)}));const o=this.state.status==="pending",i=!ne(this,Do).canStart();try{if(o)n();else{yt(this,Ar,lo).call(this,{type:"pending",variables:t,isPaused:i}),await((u=(c=ne(this,ps).config).onMutate)==null?void 0:u.call(c,t,this,s));const A=await((p=(d=this.options).onMutate)==null?void 0:p.call(d,t,s));A!==this.state.context&&yt(this,Ar,lo).call(this,{type:"pending",context:A,variables:t,isPaused:i})}const $=await ne(this,Do).start();return await((f=(h=ne(this,ps).config).onSuccess)==null?void 0:f.call(h,$,t,this.state.context,this,s)),await((w=(g=this.options).onSuccess)==null?void 0:w.call(g,$,t,this.state.context,s)),await((_=(b=ne(this,ps).config).onSettled)==null?void 0:_.call(b,$,null,this.state.variables,this.state.context,this,s)),await((N=(x=this.options).onSettled)==null?void 0:N.call(x,$,null,t,this.state.context,s)),yt(this,Ar,lo).call(this,{type:"success",data:$}),$}catch($){try{throw await((E=(C=ne(this,ps).config).onError)==null?void 0:E.call(C,$,t,this.state.context,this,s)),await((S=(j=this.options).onError)==null?void 0:S.call(j,$,t,this.state.context,s)),await((T=(M=ne(this,ps).config).onSettled)==null?void 0:T.call(M,void 0,$,this.state.variables,this.state.context,this,s)),await((L=(P=this.options).onSettled)==null?void 0:L.call(P,void 0,$,t,this.state.context,s)),$}finally{yt(this,Ar,lo).call(this,{type:"error",error:$})}}finally{ne(this,ps).runNext(this)}}},nc=new WeakMap,Mr=new WeakMap,ps=new WeakMap,Do=new WeakMap,Ar=new WeakSet,lo=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),On.batch(()=>{ne(this,Mr).forEach(s=>{s.onMutationUpdate(t)}),ne(this,ps).notify({mutation:this,type:"updated",action:t})})},Xx);function fg(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var cj=(Jx=class extends il{constructor(t={}){super();Ke(this,Qr);Ke(this,gr);Ke(this,sc);this.config=t,$e(this,Qr,new Set),$e(this,gr,new Map),$e(this,sc,0)}build(t,n,s){const o=new ij({client:t,mutationCache:this,mutationId:++cm(this,sc)._,options:t.defaultMutationOptions(n),state:s});return this.add(o),o}add(t){ne(this,Qr).add(t);const n=Bc(t);if(typeof n=="string"){const s=ne(this,gr).get(n);s?s.push(t):ne(this,gr).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ne(this,Qr).delete(t)){const n=Bc(t);if(typeof n=="string"){const s=ne(this,gr).get(n);if(s)if(s.length>1){const o=s.indexOf(t);o!==-1&&s.splice(o,1)}else s[0]===t&&ne(this,gr).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Bc(t);if(typeof n=="string"){const s=ne(this,gr).get(n),o=s==null?void 0:s.find(i=>i.state.status==="pending");return!o||o===t}else return!0}runNext(t){var s;const n=Bc(t);if(typeof n=="string"){const o=(s=ne(this,gr).get(n))==null?void 0:s.find(i=>i!==t&&i.state.isPaused);return(o==null?void 0:o.continue())??Promise.resolve()}else return Promise.resolve()}clear(){On.batch(()=>{ne(this,Qr).forEach(t=>{this.notify({type:"removed",mutation:t})}),ne(this,Qr).clear(),ne(this,gr).clear()})}getAll(){return Array.from(ne(this,Qr))}find(t){const n={exact:!0,...t};return this.getAll().find(s=>Zp(n,s))}findAll(t={}){return this.getAll().filter(n=>Zp(t,n))}notify(t){On.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return On.batch(()=>Promise.all(t.map(n=>n.continue().catch(hs))))}},Qr=new WeakMap,gr=new WeakMap,sc=new WeakMap,Jx);function Bc(e){var t;return(t=e.options.scope)==null?void 0:t.id}var uj=(Zx=class extends il{constructor(t,n){super();Ke(this,Zr);Ke(this,Xr);Ke(this,$a);Ke(this,js);Ke(this,Jr);$e(this,Xr,t),this.setOptions(n),this.bindMethods(),yt(this,Zr,um).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const n=this.options;this.options=ne(this,Xr).defaultMutationOptions(t),Fc(this.options,n)||ne(this,Xr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ne(this,js),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&mo(n.mutationKey)!==mo(this.options.mutationKey)?this.reset():((s=ne(this,js))==null?void 0:s.state.status)==="pending"&&ne(this,js).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=ne(this,js))==null||t.removeObserver(this)}onMutationUpdate(t){yt(this,Zr,um).call(this),yt(this,Zr,Bp).call(this,t)}getCurrentResult(){return ne(this,$a)}reset(){var t;(t=ne(this,js))==null||t.removeObserver(this),$e(this,js,void 0),yt(this,Zr,um).call(this),yt(this,Zr,Bp).call(this)}mutate(t,n){var s;return $e(this,Jr,n),(s=ne(this,js))==null||s.removeObserver(this),$e(this,js,ne(this,Xr).getMutationCache().build(ne(this,Xr),this.options)),ne(this,js).addObserver(this),ne(this,js).execute(t)}},Xr=new WeakMap,$a=new WeakMap,js=new WeakMap,Jr=new WeakMap,Zr=new WeakSet,um=function(){var n;const t=((n=ne(this,js))==null?void 0:n.state)??fg();$e(this,$a,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Bp=function(t){On.batch(()=>{var n,s,o,i,c,u,d,p;if(ne(this,Jr)&&this.hasListeners()){const h=ne(this,$a).variables,f=ne(this,$a).context,g={client:ne(this,Xr),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((s=(n=ne(this,Jr)).onSuccess)==null||s.call(n,t.data,h,f,g),(i=(o=ne(this,Jr)).onSettled)==null||i.call(o,t.data,null,h,f,g)):(t==null?void 0:t.type)==="error"&&((u=(c=ne(this,Jr)).onError)==null||u.call(c,t.error,h,f,g),(p=(d=ne(this,Jr)).onSettled)==null||p.call(d,void 0,t.error,h,f,g))}this.listeners.forEach(h=>{h(ne(this,$a))})})},Zx),dj=(e0=class extends il{constructor(t={}){super();Ke(this,Or);this.config=t,$e(this,Or,new Map)}build(t,n,s){const o=n.queryKey,i=n.queryHash??pm(o,n);let c=this.get(i);return c||(c=new sj({client:t,queryKey:o,queryHash:i,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(o)}),this.add(c)),c}add(t){ne(this,Or).has(t.queryHash)||(ne(this,Or).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=ne(this,Or).get(t.queryHash);n&&(t.destroy(),n===t&&ne(this,Or).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){On.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ne(this,Or).get(t)}getAll(){return[...ne(this,Or).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>Jp(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>Jp(t,s)):n}notify(t){On.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){On.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){On.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Or=new WeakMap,e0),mj=(t0=class{constructor(e={}){Ke(this,gn);Ke(this,Pa);Ke(this,La);Ke(this,Rl);Ke(this,Dl);Ke(this,za);Ke(this,Fl);Ke(this,Il);$e(this,gn,e.queryCache||new dj),$e(this,Pa,e.mutationCache||new cj),$e(this,La,e.defaultOptions||{}),$e(this,Rl,new Map),$e(this,Dl,new Map),$e(this,za,0)}mount(){cm(this,za)._++,ne(this,za)===1&&($e(this,Fl,ym.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,gn).onFocus())})),$e(this,Il,Ic.subscribe(async e=>{e&&(await this.resumePausedMutations(),ne(this,gn).onOnline())})))}unmount(){var e,t;cm(this,za)._--,ne(this,za)===0&&((e=ne(this,Fl))==null||e.call(this),$e(this,Fl,void 0),(t=ne(this,Il))==null||t.call(this),$e(this,Il,void 0))}isFetching(e){return ne(this,gn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ne(this,Pa).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,gn).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=ne(this,gn).build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(ba(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return ne(this,gn).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),o=ne(this,gn).get(s.queryHash),i=o==null?void 0:o.state.data,c=Ww(t,i);if(c!==void 0)return ne(this,gn).build(this,s).setData(c,{...n,manual:!0})}setQueriesData(e,t,n){return On.batch(()=>ne(this,gn).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ne(this,gn).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=ne(this,gn);On.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=ne(this,gn);return On.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=On.batch(()=>ne(this,gn).findAll(e).map(o=>o.cancel(n)));return Promise.all(s).then(hs).catch(hs)}invalidateQueries(e,t={}){return On.batch(()=>(ne(this,gn).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=On.batch(()=>ne(this,gn).findAll(e).filter(o=>!o.isDisabled()&&!o.isStatic()).map(o=>{let i=o.fetch(void 0,n);return n.throwOnError||(i=i.catch(hs)),o.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(s).then(hs)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=ne(this,gn).build(this,t);return n.isStaleByTime(ba(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(hs).catch(hs)}fetchInfiniteQuery(e){return e.behavior=mg(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(hs).catch(hs)}ensureInfiniteQueryData(e){return e.behavior=mg(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Ic.isOnline()?ne(this,Pa).resumePausedMutations():Promise.resolve()}getQueryCache(){return ne(this,gn)}getMutationCache(){return ne(this,Pa)}getDefaultOptions(){return ne(this,La)}setDefaultOptions(e){$e(this,La,e)}setQueryDefaults(e,t){ne(this,Rl).set(mo(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ne(this,Rl).values()],n={};return t.forEach(s=>{hi(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){ne(this,Dl).set(mo(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ne(this,Dl).values()],n={};return t.forEach(s=>{hi(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ne(this,La).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=pm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===vm&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ne(this,La).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ne(this,gn).clear(),ne(this,Pa).clear()}},gn=new WeakMap,Pa=new WeakMap,La=new WeakMap,Rl=new WeakMap,Dl=new WeakMap,za=new WeakMap,Fl=new WeakMap,Il=new WeakMap,t0),pg=v.createContext(void 0),ho=e=>{const t=v.useContext(pg);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},hj=({client:e,children:t})=>(v.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(pg.Provider,{value:e,children:t})),gg=v.createContext(!1),fj=()=>v.useContext(gg);gg.Provider;function pj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var gj=v.createContext(pj()),_j=()=>v.useContext(gj),vj=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},yj=e=>{v.useEffect(()=>{e.clearReset()},[e])},bj=({result:e,errorResetBoundary:t,throwOnError:n,query:s,suspense:o})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(o&&e.data===void 0||rg(n,[e.error,s])),xj=e=>{if(e.suspense){const n=o=>o==="static"?o:Math.max(o??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...o)=>n(s(...o)):n(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},wj=(e,t)=>e.isLoading&&e.isFetching&&!t,jj=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,_g=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Nj(e,t,n){var f,g,w,b,_;const s=fj(),o=_j(),i=ho(),c=i.defaultQueryOptions(e);(g=(f=i.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||g.call(f,c),c._optimisticResults=s?"isRestoring":"optimistic",xj(c),vj(c,o),yj(o);const u=!i.getQueryCache().get(c.queryHash),[d]=v.useState(()=>new t(i,c)),p=d.getOptimisticResult(c),h=!s&&e.subscribed!==!1;if(v.useSyncExternalStore(v.useCallback(x=>{const N=h?d.subscribe(On.batchCalls(x)):hs;return d.updateResult(),N},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),v.useEffect(()=>{d.setOptions(c)},[c,d]),jj(c,p))throw _g(c,d,o);if(bj({result:p,errorResetBoundary:o,throwOnError:c.throwOnError,query:i.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;if((b=(w=i.getDefaultOptions().queries)==null?void 0:w._experimental_afterQuery)==null||b.call(w,c,p),c.experimental_prefetchInRender&&!uo&&wj(p,s)){const x=u?_g(c,d,o):(_=i.getQueryCache().get(c.queryHash))==null?void 0:_.promise;x==null||x.catch(hs).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?p:d.trackResult(p)}function Is(e,t){return Nj(e,rj)}function Uc(e,t){const n=ho(),[s]=v.useState(()=>new uj(n,e));v.useEffect(()=>{s.setOptions(e)},[s,e]);const o=v.useSyncExternalStore(v.useCallback(c=>s.subscribe(On.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),i=v.useCallback((c,u)=>{s.mutate(c,u).catch(hs)},[s]);if(o.error&&rg(s.options.throwOnError,[o.error]))throw o.error;return{...o,mutate:i,mutateAsync:o.mutate}}function Cj(e){let t;const n=new Set,s=(p,h)=>{const f=typeof p=="function"?p(t):p;if(f!==t){const g=t;t=h?f:Object.assign({},t,f),n.forEach(w=>w(t,g))}},o=()=>t,i=(p,h=o,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let g=h(t);function w(){const b=h(t);if(!f(g,b)){const _=g;p(g=b,_)}}return n.add(w),()=>n.delete(w)},d={setState:s,getState:o,subscribe:(p,h,f)=>h||f?i(p,h,f):(n.add(p),()=>n.delete(p)),destroy:()=>n.clear()};return t=e(s,o,d),d}const vg=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?v.useEffect:v.useLayoutEffect;function Sj(e){const t=typeof e=="function"?Cj(e):e,n=(s=t.getState,o=Object.is)=>{const[,i]=v.useReducer(x=>x+1,0),c=t.getState(),u=v.useRef(c),d=v.useRef(s),p=v.useRef(o),h=v.useRef(!1),f=v.useRef();f.current===void 0&&(f.current=s(c));let g,w=!1;(u.current!==c||d.current!==s||p.current!==o||h.current)&&(g=s(c),w=!o(f.current,g)),vg(()=>{w&&(f.current=g),u.current=c,d.current=s,p.current=o,h.current=!1});const b=v.useRef(c);vg(()=>{const x=()=>{try{const C=t.getState(),E=d.current(C);p.current(f.current,E)||(u.current=C,f.current=E,i())}catch{h.current=!0,i()}},N=t.subscribe(x);return t.getState()!==b.current&&x(),N},[]);const _=w?g:f.current;return v.useDebugValue(_),_};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[n,t];return{next(){const o=s.length<=0;return{value:s.shift(),done:o}}}},n}function Ej(){const e=v.createContext(void 0);return{Provider:({initialStore:o,createStore:i,children:c})=>{const u=v.useRef();return u.current||(o&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),i||(i=()=>o)),u.current=i()),v.createElement(e.Provider,{value:u.current},c)},useStore:(o,i=Object.is)=>{const c=v.useContext(e);if(!c)throw new Error("Seems like you have not used zustand provider as an ancestor.");return c(o,i)},useStoreApi:()=>{const o=v.useContext(e);if(!o)throw new Error("Seems like you have not used zustand provider as an ancestor.");return v.useMemo(()=>({getState:o.getState,setState:o.setState,subscribe:o.subscribe,destroy:o.destroy}),[o])}}}var kj={value:()=>{}};function qc(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new Hc(n)}function Hc(e){this._=e}function Mj(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",o=n.indexOf(".");if(o>=0&&(s=n.slice(o+1),n=n.slice(0,o)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}Hc.prototype=qc.prototype={constructor:Hc,on:function(e,t){var n=this._,s=Mj(e+"",n),o,i=-1,c=s.length;if(arguments.length<2){for(;++i<c;)if((o=(e=s[i]).type)&&(o=Aj(n[o],e.name)))return o;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<c;)if(o=(e=s[i]).type)n[o]=yg(n[o],e.name,t);else if(t==null)for(o in n)n[o]=yg(n[o],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Hc(e)},call:function(e,t){if((o=arguments.length-2)>0)for(var n=new Array(o),s=0,o,i;s<o;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],s=0,o=i.length;s<o;++s)i[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],o=0,i=s.length;o<i;++o)s[o].value.apply(t,n)}};function Aj(e,t){for(var n=0,s=e.length,o;n<s;++n)if((o=e[n]).name===t)return o.value}function yg(e,t,n){for(var s=0,o=e.length;s<o;++s)if(e[s].name===t){e[s]=kj,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var Nm="http://www.w3.org/1999/xhtml";const bg={svg:"http://www.w3.org/2000/svg",xhtml:Nm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Vc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),bg.hasOwnProperty(t)?{space:bg[t],local:e}:e}function Oj(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Nm&&t.documentElement.namespaceURI===Nm?t.createElement(e):t.createElementNS(n,e)}}function Tj(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xg(e){var t=Vc(e);return(t.local?Tj:Oj)(t)}function $j(){}function Cm(e){return e==null?$j:function(){return this.querySelector(e)}}function Pj(e){typeof e!="function"&&(e=Cm(e));for(var t=this._groups,n=t.length,s=new Array(n),o=0;o<n;++o)for(var i=t[o],c=i.length,u=s[o]=new Array(c),d,p,h=0;h<c;++h)(d=i[h])&&(p=e.call(d,d.__data__,h,i))&&("__data__"in d&&(p.__data__=d.__data__),u[h]=p);return new Bs(s,this._parents)}function Lj(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function zj(){return[]}function wg(e){return e==null?zj:function(){return this.querySelectorAll(e)}}function Rj(e){return function(){return Lj(e.apply(this,arguments))}}function Dj(e){typeof e=="function"?e=Rj(e):e=wg(e);for(var t=this._groups,n=t.length,s=[],o=[],i=0;i<n;++i)for(var c=t[i],u=c.length,d,p=0;p<u;++p)(d=c[p])&&(s.push(e.call(d,d.__data__,p,c)),o.push(d));return new Bs(s,o)}function jg(e){return function(){return this.matches(e)}}function Ng(e){return function(t){return t.matches(e)}}var Fj=Array.prototype.find;function Ij(e){return function(){return Fj.call(this.children,e)}}function Bj(){return this.firstElementChild}function Uj(e){return this.select(e==null?Bj:Ij(typeof e=="function"?e:Ng(e)))}var qj=Array.prototype.filter;function Hj(){return Array.from(this.children)}function Vj(e){return function(){return qj.call(this.children,e)}}function Wj(e){return this.selectAll(e==null?Hj:Vj(typeof e=="function"?e:Ng(e)))}function Kj(e){typeof e!="function"&&(e=jg(e));for(var t=this._groups,n=t.length,s=new Array(n),o=0;o<n;++o)for(var i=t[o],c=i.length,u=s[o]=[],d,p=0;p<c;++p)(d=i[p])&&e.call(d,d.__data__,p,i)&&u.push(d);return new Bs(s,this._parents)}function Cg(e){return new Array(e.length)}function Yj(){return new Bs(this._enter||this._groups.map(Cg),this._parents)}function Wc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Wc.prototype={constructor:Wc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Gj(e){return function(){return e}}function Qj(e,t,n,s,o,i){for(var c=0,u,d=t.length,p=i.length;c<p;++c)(u=t[c])?(u.__data__=i[c],s[c]=u):n[c]=new Wc(e,i[c]);for(;c<d;++c)(u=t[c])&&(o[c]=u)}function Xj(e,t,n,s,o,i,c){var u,d,p=new Map,h=t.length,f=i.length,g=new Array(h),w;for(u=0;u<h;++u)(d=t[u])&&(g[u]=w=c.call(d,d.__data__,u,t)+"",p.has(w)?o[u]=d:p.set(w,d));for(u=0;u<f;++u)w=c.call(e,i[u],u,i)+"",(d=p.get(w))?(s[u]=d,d.__data__=i[u],p.delete(w)):n[u]=new Wc(e,i[u]);for(u=0;u<h;++u)(d=t[u])&&p.get(g[u])===d&&(o[u]=d)}function Jj(e){return e.__data__}function Zj(e,t){if(!arguments.length)return Array.from(this,Jj);var n=t?Xj:Qj,s=this._parents,o=this._groups;typeof e!="function"&&(e=Gj(e));for(var i=o.length,c=new Array(i),u=new Array(i),d=new Array(i),p=0;p<i;++p){var h=s[p],f=o[p],g=f.length,w=eN(e.call(h,h&&h.__data__,p,s)),b=w.length,_=u[p]=new Array(b),x=c[p]=new Array(b),N=d[p]=new Array(g);n(h,f,_,x,N,w,t);for(var C=0,E=0,j,S;C<b;++C)if(j=_[C]){for(C>=E&&(E=C+1);!(S=x[E])&&++E<b;);j._next=S||null}}return c=new Bs(c,s),c._enter=u,c._exit=d,c}function eN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tN(){return new Bs(this._exit||this._groups.map(Cg),this._parents)}function nN(e,t,n){var s=this.enter(),o=this,i=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(o=t(o),o&&(o=o.selection())),n==null?i.remove():n(i),s&&o?s.merge(o).order():o}function sN(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,o=n.length,i=s.length,c=Math.min(o,i),u=new Array(o),d=0;d<c;++d)for(var p=n[d],h=s[d],f=p.length,g=u[d]=new Array(f),w,b=0;b<f;++b)(w=p[b]||h[b])&&(g[b]=w);for(;d<o;++d)u[d]=n[d];return new Bs(u,this._parents)}function rN(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],o=s.length-1,i=s[o],c;--o>=0;)(c=s[o])&&(i&&c.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(c,i),i=c);return this}function aN(e){e||(e=oN);function t(f,g){return f&&g?e(f.__data__,g.__data__):!f-!g}for(var n=this._groups,s=n.length,o=new Array(s),i=0;i<s;++i){for(var c=n[i],u=c.length,d=o[i]=new Array(u),p,h=0;h<u;++h)(p=c[h])&&(d[h]=p);d.sort(t)}return new Bs(o,this._parents).order()}function oN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function lN(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function iN(){return Array.from(this)}function cN(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],o=0,i=s.length;o<i;++o){var c=s[o];if(c)return c}return null}function uN(){let e=0;for(const t of this)++e;return e}function dN(){return!this.node()}function mN(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var o=t[n],i=0,c=o.length,u;i<c;++i)(u=o[i])&&e.call(u,u.__data__,i,o);return this}function hN(e){return function(){this.removeAttribute(e)}}function fN(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pN(e,t){return function(){this.setAttribute(e,t)}}function gN(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function _N(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function vN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function yN(e,t){var n=Vc(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?fN:hN:typeof t=="function"?n.local?vN:_N:n.local?gN:pN)(n,t))}function Sg(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function bN(e){return function(){this.style.removeProperty(e)}}function xN(e,t,n){return function(){this.style.setProperty(e,t,n)}}function wN(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function jN(e,t,n){return arguments.length>1?this.each((t==null?bN:typeof t=="function"?wN:xN)(e,t,n??"")):cl(this.node(),e)}function cl(e,t){return e.style.getPropertyValue(t)||Sg(e).getComputedStyle(e,null).getPropertyValue(t)}function NN(e){return function(){delete this[e]}}function CN(e,t){return function(){this[e]=t}}function SN(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function EN(e,t){return arguments.length>1?this.each((t==null?NN:typeof t=="function"?SN:CN)(e,t)):this.node()[e]}function Eg(e){return e.trim().split(/^|\s+/)}function Sm(e){return e.classList||new kg(e)}function kg(e){this._node=e,this._names=Eg(e.getAttribute("class")||"")}kg.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Mg(e,t){for(var n=Sm(e),s=-1,o=t.length;++s<o;)n.add(t[s])}function Ag(e,t){for(var n=Sm(e),s=-1,o=t.length;++s<o;)n.remove(t[s])}function kN(e){return function(){Mg(this,e)}}function MN(e){return function(){Ag(this,e)}}function AN(e,t){return function(){(t.apply(this,arguments)?Mg:Ag)(this,e)}}function ON(e,t){var n=Eg(e+"");if(arguments.length<2){for(var s=Sm(this.node()),o=-1,i=n.length;++o<i;)if(!s.contains(n[o]))return!1;return!0}return this.each((typeof t=="function"?AN:t?kN:MN)(n,t))}function TN(){this.textContent=""}function $N(e){return function(){this.textContent=e}}function PN(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function LN(e){return arguments.length?this.each(e==null?TN:(typeof e=="function"?PN:$N)(e)):this.node().textContent}function zN(){this.innerHTML=""}function RN(e){return function(){this.innerHTML=e}}function DN(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function FN(e){return arguments.length?this.each(e==null?zN:(typeof e=="function"?DN:RN)(e)):this.node().innerHTML}function IN(){this.nextSibling&&this.parentNode.appendChild(this)}function BN(){return this.each(IN)}function UN(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qN(){return this.each(UN)}function HN(e){var t=typeof e=="function"?e:xg(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function VN(){return null}function WN(e,t){var n=typeof e=="function"?e:xg(e),s=t==null?VN:typeof t=="function"?t:Cm(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function KN(){var e=this.parentNode;e&&e.removeChild(this)}function YN(){return this.each(KN)}function GN(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function QN(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function XN(e){return this.select(e?QN:GN)}function JN(e){return arguments.length?this.property("__data__",e):this.node().__data__}function ZN(e){return function(t){e.call(this,t,this.__data__)}}function eC(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function tC(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,o=t.length,i;n<o;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++s]=i;++s?t.length=s:delete this.__on}}}function nC(e,t,n){return function(){var s=this.__on,o,i=ZN(t);if(s){for(var c=0,u=s.length;c<u;++c)if((o=s[c]).type===e.type&&o.name===e.name){this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=i,o.options=n),o.value=t;return}}this.addEventListener(e.type,i,n),o={type:e.type,name:e.name,value:t,listener:i,options:n},s?s.push(o):this.__on=[o]}}function sC(e,t,n){var s=eC(e+""),o,i=s.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var d=0,p=u.length,h;d<p;++d)for(o=0,h=u[d];o<i;++o)if((c=s[o]).type===h.type&&c.name===h.name)return h.value}return}for(u=t?nC:tC,o=0;o<i;++o)this.each(u(s[o],t,n));return this}function Og(e,t,n){var s=Sg(e),o=s.CustomEvent;typeof o=="function"?o=new o(t,n):(o=s.document.createEvent("Event"),n?(o.initEvent(t,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(t,!1,!1)),e.dispatchEvent(o)}function rC(e,t){return function(){return Og(this,e,t)}}function aC(e,t){return function(){return Og(this,e,t.apply(this,arguments))}}function oC(e,t){return this.each((typeof t=="function"?aC:rC)(e,t))}function*lC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],o=0,i=s.length,c;o<i;++o)(c=s[o])&&(yield c)}var Tg=[null];function Bs(e,t){this._groups=e,this._parents=t}function fi(){return new Bs([[document.documentElement]],Tg)}function iC(){return this}Bs.prototype=fi.prototype={constructor:Bs,select:Pj,selectAll:Dj,selectChild:Uj,selectChildren:Wj,filter:Kj,data:Zj,enter:Yj,exit:tN,join:nN,merge:sN,selection:iC,order:rN,sort:aN,call:lN,nodes:iN,node:cN,size:uN,empty:dN,each:mN,attr:yN,style:jN,property:EN,classed:ON,text:LN,html:FN,raise:BN,lower:qN,append:HN,insert:WN,remove:YN,clone:XN,datum:JN,on:sC,dispatch:oC,[Symbol.iterator]:lC};function dr(e){return typeof e=="string"?new Bs([[document.querySelector(e)]],[document.documentElement]):new Bs([[e]],Tg)}function cC(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Cr(e,t){if(e=cC(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const uC={passive:!1},pi={capture:!0,passive:!1};function Em(e){e.stopImmediatePropagation()}function ul(e){e.preventDefault(),e.stopImmediatePropagation()}function $g(e){var t=e.document.documentElement,n=dr(e).on("dragstart.drag",ul,pi);"onselectstart"in t?n.on("selectstart.drag",ul,pi):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Pg(e,t){var n=e.document.documentElement,s=dr(e).on("dragstart.drag",null);t&&(s.on("click.drag",ul,pi),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Kc=e=>()=>e;function km(e,{sourceEvent:t,subject:n,target:s,identifier:o,active:i,x:c,y:u,dx:d,dy:p,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:h}})}km.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function dC(e){return!e.ctrlKey&&!e.button}function mC(){return this.parentNode}function hC(e,t){return t??{x:e.x,y:e.y}}function fC(){return navigator.maxTouchPoints||"ontouchstart"in this}function pC(){var e=dC,t=mC,n=hC,s=fC,o={},i=qc("start","drag","end"),c=0,u,d,p,h,f=0;function g(j){j.on("mousedown.drag",w).filter(s).on("touchstart.drag",x).on("touchmove.drag",N,uC).on("touchend.drag touchcancel.drag",C).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function w(j,S){if(!(h||!e.call(this,j,S))){var M=E(this,t.call(this,j,S),j,S,"mouse");M&&(dr(j.view).on("mousemove.drag",b,pi).on("mouseup.drag",_,pi),$g(j.view),Em(j),p=!1,u=j.clientX,d=j.clientY,M("start",j))}}function b(j){if(ul(j),!p){var S=j.clientX-u,M=j.clientY-d;p=S*S+M*M>f}o.mouse("drag",j)}function _(j){dr(j.view).on("mousemove.drag mouseup.drag",null),Pg(j.view,p),ul(j),o.mouse("end",j)}function x(j,S){if(e.call(this,j,S)){var M=j.changedTouches,T=t.call(this,j,S),P=M.length,L,$;for(L=0;L<P;++L)($=E(this,T,j,S,M[L].identifier,M[L]))&&(Em(j),$("start",j,M[L]))}}function N(j){var S=j.changedTouches,M=S.length,T,P;for(T=0;T<M;++T)(P=o[S[T].identifier])&&(ul(j),P("drag",j,S[T]))}function C(j){var S=j.changedTouches,M=S.length,T,P;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),T=0;T<M;++T)(P=o[S[T].identifier])&&(Em(j),P("end",j,S[T]))}function E(j,S,M,T,P,L){var $=i.copy(),A=Cr(L||M,S),R,W,z;if((z=n.call(j,new km("beforestart",{sourceEvent:M,target:g,identifier:P,active:c,x:A[0],y:A[1],dx:0,dy:0,dispatch:$}),T))!=null)return R=z.x-A[0]||0,W=z.y-A[1]||0,function D(H,q,I){var Q=A,U;switch(H){case"start":o[P]=D,U=c++;break;case"end":delete o[P],--c;case"drag":A=Cr(I||q,S),U=c;break}$.call(H,j,new km(H,{sourceEvent:q,subject:z,target:g,identifier:P,active:U,x:A[0]+R,y:A[1]+W,dx:A[0]-Q[0],dy:A[1]-Q[1],dispatch:$}),T)}}return g.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Kc(!!j),g):e},g.container=function(j){return arguments.length?(t=typeof j=="function"?j:Kc(j),g):t},g.subject=function(j){return arguments.length?(n=typeof j=="function"?j:Kc(j),g):n},g.touchable=function(j){return arguments.length?(s=typeof j=="function"?j:Kc(!!j),g):s},g.on=function(){var j=i.on.apply(i,arguments);return j===i?g:j},g.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,g):Math.sqrt(f)},g}function Mm(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Lg(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function gi(){}var _i=.7,Yc=1/_i,dl="\\s*([+-]?\\d+)\\s*",vi="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Sr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gC=/^#([0-9a-f]{3,8})$/,_C=new RegExp(`^rgb\\(${dl},${dl},${dl}\\)$`),vC=new RegExp(`^rgb\\(${Sr},${Sr},${Sr}\\)$`),yC=new RegExp(`^rgba\\(${dl},${dl},${dl},${vi}\\)$`),bC=new RegExp(`^rgba\\(${Sr},${Sr},${Sr},${vi}\\)$`),xC=new RegExp(`^hsl\\(${vi},${Sr},${Sr}\\)$`),wC=new RegExp(`^hsla\\(${vi},${Sr},${Sr},${vi}\\)$`),zg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Mm(gi,yi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Rg,formatHex:Rg,formatHex8:jC,formatHsl:NC,formatRgb:Dg,toString:Dg});function Rg(){return this.rgb().formatHex()}function jC(){return this.rgb().formatHex8()}function NC(){return qg(this).formatHsl()}function Dg(){return this.rgb().formatRgb()}function yi(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=gC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fg(t):n===3?new ys(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Gc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Gc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=_C.exec(e))?new ys(t[1],t[2],t[3],1):(t=vC.exec(e))?new ys(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yC.exec(e))?Gc(t[1],t[2],t[3],t[4]):(t=bC.exec(e))?Gc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xC.exec(e))?Ug(t[1],t[2]/100,t[3]/100,1):(t=wC.exec(e))?Ug(t[1],t[2]/100,t[3]/100,t[4]):zg.hasOwnProperty(e)?Fg(zg[e]):e==="transparent"?new ys(NaN,NaN,NaN,0):null}function Fg(e){return new ys(e>>16&255,e>>8&255,e&255,1)}function Gc(e,t,n,s){return s<=0&&(e=t=n=NaN),new ys(e,t,n,s)}function CC(e){return e instanceof gi||(e=yi(e)),e?(e=e.rgb(),new ys(e.r,e.g,e.b,e.opacity)):new ys}function Am(e,t,n,s){return arguments.length===1?CC(e):new ys(e,t,n,s??1)}function ys(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}Mm(ys,Am,Lg(gi,{brighter(e){return e=e==null?Yc:Math.pow(Yc,e),new ys(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?_i:Math.pow(_i,e),new ys(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new ys(fo(this.r),fo(this.g),fo(this.b),Qc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ig,formatHex:Ig,formatHex8:SC,formatRgb:Bg,toString:Bg}));function Ig(){return`#${po(this.r)}${po(this.g)}${po(this.b)}`}function SC(){return`#${po(this.r)}${po(this.g)}${po(this.b)}${po((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bg(){const e=Qc(this.opacity);return`${e===1?"rgb(":"rgba("}${fo(this.r)}, ${fo(this.g)}, ${fo(this.b)}${e===1?")":`, ${e})`}`}function Qc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function fo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function po(e){return e=fo(e),(e<16?"0":"")+e.toString(16)}function Ug(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new mr(e,t,n,s)}function qg(e){if(e instanceof mr)return new mr(e.h,e.s,e.l,e.opacity);if(e instanceof gi||(e=yi(e)),!e)return new mr;if(e instanceof mr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,o=Math.min(t,n,s),i=Math.max(t,n,s),c=NaN,u=i-o,d=(i+o)/2;return u?(t===i?c=(n-s)/u+(n<s)*6:n===i?c=(s-t)/u+2:c=(t-n)/u+4,u/=d<.5?i+o:2-i-o,c*=60):u=d>0&&d<1?0:c,new mr(c,u,d,e.opacity)}function EC(e,t,n,s){return arguments.length===1?qg(e):new mr(e,t,n,s??1)}function mr(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}Mm(mr,EC,Lg(gi,{brighter(e){return e=e==null?Yc:Math.pow(Yc,e),new mr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?_i:Math.pow(_i,e),new mr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,o=2*n-s;return new ys(Om(e>=240?e-240:e+120,o,s),Om(e,o,s),Om(e<120?e+240:e-120,o,s),this.opacity)},clamp(){return new mr(Hg(this.h),Xc(this.s),Xc(this.l),Qc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Qc(this.opacity);return`${e===1?"hsl(":"hsla("}${Hg(this.h)}, ${Xc(this.s)*100}%, ${Xc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Hg(e){return e=(e||0)%360,e<0?e+360:e}function Xc(e){return Math.max(0,Math.min(1,e||0))}function Om(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Vg=e=>()=>e;function kC(e,t){return function(n){return e+n*t}}function MC(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function AC(e){return(e=+e)==1?Wg:function(t,n){return n-t?MC(t,n,e):Vg(isNaN(t)?n:t)}}function Wg(e,t){var n=t-e;return n?kC(e,n):Vg(isNaN(e)?t:e)}const Kg=function e(t){var n=AC(t);function s(o,i){var c=n((o=Am(o)).r,(i=Am(i)).r),u=n(o.g,i.g),d=n(o.b,i.b),p=Wg(o.opacity,i.opacity);return function(h){return o.r=c(h),o.g=u(h),o.b=d(h),o.opacity=p(h),o+""}}return s.gamma=e,s}(1);function xa(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Tm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,$m=new RegExp(Tm.source,"g");function OC(e){return function(){return e}}function TC(e){return function(t){return e(t)+""}}function $C(e,t){var n=Tm.lastIndex=$m.lastIndex=0,s,o,i,c=-1,u=[],d=[];for(e=e+"",t=t+"";(s=Tm.exec(e))&&(o=$m.exec(t));)(i=o.index)>n&&(i=t.slice(n,i),u[c]?u[c]+=i:u[++c]=i),(s=s[0])===(o=o[0])?u[c]?u[c]+=o:u[++c]=o:(u[++c]=null,d.push({i:c,x:xa(s,o)})),n=$m.lastIndex;return n<t.length&&(i=t.slice(n),u[c]?u[c]+=i:u[++c]=i),u.length<2?d[0]?TC(d[0].x):OC(t):(t=d.length,function(p){for(var h=0,f;h<t;++h)u[(f=d[h]).i]=f.x(p);return u.join("")})}var Yg=180/Math.PI,Pm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Gg(e,t,n,s,o,i){var c,u,d;return(c=Math.sqrt(e*e+t*t))&&(e/=c,t/=c),(d=e*n+t*s)&&(n-=e*d,s-=t*d),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,d/=u),e*s<t*n&&(e=-e,t=-t,d=-d,c=-c),{translateX:o,translateY:i,rotate:Math.atan2(t,e)*Yg,skewX:Math.atan(d)*Yg,scaleX:c,scaleY:u}}var Jc;function PC(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Pm:Gg(t.a,t.b,t.c,t.d,t.e,t.f)}function LC(e){return e==null||(Jc||(Jc=document.createElementNS("http://www.w3.org/2000/svg","g")),Jc.setAttribute("transform",e),!(e=Jc.transform.baseVal.consolidate()))?Pm:(e=e.matrix,Gg(e.a,e.b,e.c,e.d,e.e,e.f))}function Qg(e,t,n,s){function o(p){return p.length?p.pop()+" ":""}function i(p,h,f,g,w,b){if(p!==f||h!==g){var _=w.push("translate(",null,t,null,n);b.push({i:_-4,x:xa(p,f)},{i:_-2,x:xa(h,g)})}else(f||g)&&w.push("translate("+f+t+g+n)}function c(p,h,f,g){p!==h?(p-h>180?h+=360:h-p>180&&(p+=360),g.push({i:f.push(o(f)+"rotate(",null,s)-2,x:xa(p,h)})):h&&f.push(o(f)+"rotate("+h+s)}function u(p,h,f,g){p!==h?g.push({i:f.push(o(f)+"skewX(",null,s)-2,x:xa(p,h)}):h&&f.push(o(f)+"skewX("+h+s)}function d(p,h,f,g,w,b){if(p!==f||h!==g){var _=w.push(o(w)+"scale(",null,",",null,")");b.push({i:_-4,x:xa(p,f)},{i:_-2,x:xa(h,g)})}else(f!==1||g!==1)&&w.push(o(w)+"scale("+f+","+g+")")}return function(p,h){var f=[],g=[];return p=e(p),h=e(h),i(p.translateX,p.translateY,h.translateX,h.translateY,f,g),c(p.rotate,h.rotate,f,g),u(p.skewX,h.skewX,f,g),d(p.scaleX,p.scaleY,h.scaleX,h.scaleY,f,g),p=h=null,function(w){for(var b=-1,_=g.length,x;++b<_;)f[(x=g[b]).i]=x.x(w);return f.join("")}}}var zC=Qg(PC,"px, ","px)","deg)"),RC=Qg(LC,", ",")",")"),DC=1e-12;function Xg(e){return((e=Math.exp(e))+1/e)/2}function FC(e){return((e=Math.exp(e))-1/e)/2}function IC(e){return((e=Math.exp(2*e))-1)/(e+1)}const BC=function e(t,n,s){function o(i,c){var u=i[0],d=i[1],p=i[2],h=c[0],f=c[1],g=c[2],w=h-u,b=f-d,_=w*w+b*b,x,N;if(_<DC)N=Math.log(g/p)/t,x=function(T){return[u+T*w,d+T*b,p*Math.exp(t*T*N)]};else{var C=Math.sqrt(_),E=(g*g-p*p+s*_)/(2*p*n*C),j=(g*g-p*p-s*_)/(2*g*n*C),S=Math.log(Math.sqrt(E*E+1)-E),M=Math.log(Math.sqrt(j*j+1)-j);N=(M-S)/t,x=function(T){var P=T*N,L=Xg(S),$=p/(n*C)*(L*IC(t*P+S)-FC(S));return[u+$*w,d+$*b,p*L/Xg(t*P+S)]}}return x.duration=N*1e3*t/Math.SQRT2,x}return o.rho=function(i){var c=Math.max(.001,+i),u=c*c,d=u*u;return e(c,u,d)},o}(Math.SQRT2,2,4);var ml=0,bi=0,xi=0,Jg=1e3,Zc,wi,eu=0,go=0,tu=0,ji=typeof performance=="object"&&performance.now?performance:Date,Zg=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Lm(){return go||(Zg(UC),go=ji.now()+tu)}function UC(){go=0}function nu(){this._call=this._time=this._next=null}nu.prototype=e_.prototype={constructor:nu,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Lm():+n)+(t==null?0:+t),!this._next&&wi!==this&&(wi?wi._next=this:Zc=this,wi=this),this._call=e,this._time=n,zm()},stop:function(){this._call&&(this._call=null,this._time=1/0,zm())}};function e_(e,t,n){var s=new nu;return s.restart(e,t,n),s}function qC(){Lm(),++ml;for(var e=Zc,t;e;)(t=go-e._time)>=0&&e._call.call(void 0,t),e=e._next;--ml}function t_(){go=(eu=ji.now())+tu,ml=bi=0;try{qC()}finally{ml=0,VC(),go=0}}function HC(){var e=ji.now(),t=e-eu;t>Jg&&(tu-=t,eu=e)}function VC(){for(var e,t=Zc,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Zc=n);wi=e,zm(s)}function zm(e){if(!ml){bi&&(bi=clearTimeout(bi));var t=e-go;t>24?(e<1/0&&(bi=setTimeout(t_,e-ji.now()-tu)),xi&&(xi=clearInterval(xi))):(xi||(eu=ji.now(),xi=setInterval(HC,Jg)),ml=1,Zg(t_))}}function n_(e,t,n){var s=new nu;return t=t==null?0:+t,s.restart(o=>{s.stop(),e(o+t)},t,n),s}var WC=qc("start","end","cancel","interrupt"),KC=[],s_=0,r_=1,Rm=2,su=3,a_=4,Dm=5,ru=6;function au(e,t,n,s,o,i){var c=e.__transition;if(!c)e.__transition={};else if(n in c)return;YC(e,n,{name:t,index:s,group:o,on:WC,tween:KC,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:s_})}function Fm(e,t){var n=hr(e,t);if(n.state>s_)throw new Error("too late; already scheduled");return n}function Er(e,t){var n=hr(e,t);if(n.state>su)throw new Error("too late; already running");return n}function hr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function YC(e,t,n){var s=e.__transition,o;s[t]=n,n.timer=e_(i,0,n.time);function i(p){n.state=r_,n.timer.restart(c,n.delay,n.time),n.delay<=p&&c(p-n.delay)}function c(p){var h,f,g,w;if(n.state!==r_)return d();for(h in s)if(w=s[h],w.name===n.name){if(w.state===su)return n_(c);w.state===a_?(w.state=ru,w.timer.stop(),w.on.call("interrupt",e,e.__data__,w.index,w.group),delete s[h]):+h<t&&(w.state=ru,w.timer.stop(),w.on.call("cancel",e,e.__data__,w.index,w.group),delete s[h])}if(n_(function(){n.state===su&&(n.state=a_,n.timer.restart(u,n.delay,n.time),u(p))}),n.state=Rm,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Rm){for(n.state=su,o=new Array(g=n.tween.length),h=0,f=-1;h<g;++h)(w=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(o[++f]=w);o.length=f+1}}function u(p){for(var h=p<n.duration?n.ease.call(null,p/n.duration):(n.timer.restart(d),n.state=Dm,1),f=-1,g=o.length;++f<g;)o[f].call(e,h);n.state===Dm&&(n.on.call("end",e,e.__data__,n.index,n.group),d())}function d(){n.state=ru,n.timer.stop(),delete s[t];for(var p in s)return;delete e.__transition}}function ou(e,t){var n=e.__transition,s,o,i=!0,c;if(n){t=t==null?null:t+"";for(c in n){if((s=n[c]).name!==t){i=!1;continue}o=s.state>Rm&&s.state<Dm,s.state=ru,s.timer.stop(),s.on.call(o?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[c]}i&&delete e.__transition}}function GC(e){return this.each(function(){ou(this,e)})}function QC(e,t){var n,s;return function(){var o=Er(this,e),i=o.tween;if(i!==n){s=n=i;for(var c=0,u=s.length;c<u;++c)if(s[c].name===t){s=s.slice(),s.splice(c,1);break}}o.tween=s}}function XC(e,t,n){var s,o;if(typeof n!="function")throw new Error;return function(){var i=Er(this,e),c=i.tween;if(c!==s){o=(s=c).slice();for(var u={name:t,value:n},d=0,p=o.length;d<p;++d)if(o[d].name===t){o[d]=u;break}d===p&&o.push(u)}i.tween=o}}function JC(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=hr(this.node(),n).tween,o=0,i=s.length,c;o<i;++o)if((c=s[o]).name===e)return c.value;return null}return this.each((t==null?QC:XC)(n,e,t))}function Im(e,t,n){var s=e._id;return e.each(function(){var o=Er(this,s);(o.value||(o.value={}))[t]=n.apply(this,arguments)}),function(o){return hr(o,s).value[t]}}function o_(e,t){var n;return(typeof t=="number"?xa:t instanceof yi?Kg:(n=yi(t))?(t=n,Kg):$C)(e,t)}function ZC(e){return function(){this.removeAttribute(e)}}function eS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tS(e,t,n){var s,o=n+"",i;return function(){var c=this.getAttribute(e);return c===o?null:c===s?i:i=t(s=c,n)}}function nS(e,t,n){var s,o=n+"",i;return function(){var c=this.getAttributeNS(e.space,e.local);return c===o?null:c===s?i:i=t(s=c,n)}}function sS(e,t,n){var s,o,i;return function(){var c,u=n(this),d;return u==null?void this.removeAttribute(e):(c=this.getAttribute(e),d=u+"",c===d?null:c===s&&d===o?i:(o=d,i=t(s=c,u)))}}function rS(e,t,n){var s,o,i;return function(){var c,u=n(this),d;return u==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),d=u+"",c===d?null:c===s&&d===o?i:(o=d,i=t(s=c,u)))}}function aS(e,t){var n=Vc(e),s=n==="transform"?RC:o_;return this.attrTween(e,typeof t=="function"?(n.local?rS:sS)(n,s,Im(this,"attr."+e,t)):t==null?(n.local?eS:ZC)(n):(n.local?nS:tS)(n,s,t))}function oS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function lS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function iS(e,t){var n,s;function o(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&lS(e,i)),n}return o._value=t,o}function cS(e,t){var n,s;function o(){var i=t.apply(this,arguments);return i!==s&&(n=(s=i)&&oS(e,i)),n}return o._value=t,o}function uS(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=Vc(e);return this.tween(n,(s.local?iS:cS)(s,t))}function dS(e,t){return function(){Fm(this,e).delay=+t.apply(this,arguments)}}function mS(e,t){return t=+t,function(){Fm(this,e).delay=t}}function hS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dS:mS)(t,e)):hr(this.node(),t).delay}function fS(e,t){return function(){Er(this,e).duration=+t.apply(this,arguments)}}function pS(e,t){return t=+t,function(){Er(this,e).duration=t}}function gS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fS:pS)(t,e)):hr(this.node(),t).duration}function _S(e,t){if(typeof t!="function")throw new Error;return function(){Er(this,e).ease=t}}function vS(e){var t=this._id;return arguments.length?this.each(_S(t,e)):hr(this.node(),t).ease}function yS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Er(this,e).ease=n}}function bS(e){if(typeof e!="function")throw new Error;return this.each(yS(this._id,e))}function xS(e){typeof e!="function"&&(e=jg(e));for(var t=this._groups,n=t.length,s=new Array(n),o=0;o<n;++o)for(var i=t[o],c=i.length,u=s[o]=[],d,p=0;p<c;++p)(d=i[p])&&e.call(d,d.__data__,p,i)&&u.push(d);return new Ur(s,this._parents,this._name,this._id)}function wS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,o=n.length,i=Math.min(s,o),c=new Array(s),u=0;u<i;++u)for(var d=t[u],p=n[u],h=d.length,f=c[u]=new Array(h),g,w=0;w<h;++w)(g=d[w]||p[w])&&(f[w]=g);for(;u<s;++u)c[u]=t[u];return new Ur(c,this._parents,this._name,this._id)}function jS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function NS(e,t,n){var s,o,i=jS(t)?Fm:Er;return function(){var c=i(this,e),u=c.on;u!==s&&(o=(s=u).copy()).on(t,n),c.on=o}}function CS(e,t){var n=this._id;return arguments.length<2?hr(this.node(),n).on.on(e):this.each(NS(n,e,t))}function SS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ES(){return this.on("end.remove",SS(this._id))}function kS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Cm(e));for(var s=this._groups,o=s.length,i=new Array(o),c=0;c<o;++c)for(var u=s[c],d=u.length,p=i[c]=new Array(d),h,f,g=0;g<d;++g)(h=u[g])&&(f=e.call(h,h.__data__,g,u))&&("__data__"in h&&(f.__data__=h.__data__),p[g]=f,au(p[g],t,n,g,p,hr(h,n)));return new Ur(i,this._parents,t,n)}function MS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wg(e));for(var s=this._groups,o=s.length,i=[],c=[],u=0;u<o;++u)for(var d=s[u],p=d.length,h,f=0;f<p;++f)if(h=d[f]){for(var g=e.call(h,h.__data__,f,d),w,b=hr(h,n),_=0,x=g.length;_<x;++_)(w=g[_])&&au(w,t,n,_,g,b);i.push(g),c.push(h)}return new Ur(i,c,t,n)}var AS=fi.prototype.constructor;function OS(){return new AS(this._groups,this._parents)}function TS(e,t){var n,s,o;return function(){var i=cl(this,e),c=(this.style.removeProperty(e),cl(this,e));return i===c?null:i===n&&c===s?o:o=t(n=i,s=c)}}function l_(e){return function(){this.style.removeProperty(e)}}function $S(e,t,n){var s,o=n+"",i;return function(){var c=cl(this,e);return c===o?null:c===s?i:i=t(s=c,n)}}function PS(e,t,n){var s,o,i;return function(){var c=cl(this,e),u=n(this),d=u+"";return u==null&&(d=u=(this.style.removeProperty(e),cl(this,e))),c===d?null:c===s&&d===o?i:(o=d,i=t(s=c,u))}}function LS(e,t){var n,s,o,i="style."+t,c="end."+i,u;return function(){var d=Er(this,e),p=d.on,h=d.value[i]==null?u||(u=l_(t)):void 0;(p!==n||o!==h)&&(s=(n=p).copy()).on(c,o=h),d.on=s}}function zS(e,t,n){var s=(e+="")=="transform"?zC:o_;return t==null?this.styleTween(e,TS(e,s)).on("end.style."+e,l_(e)):typeof t=="function"?this.styleTween(e,PS(e,s,Im(this,"style."+e,t))).each(LS(this._id,e)):this.styleTween(e,$S(e,s,t),n).on("end.style."+e,null)}function RS(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function DS(e,t,n){var s,o;function i(){var c=t.apply(this,arguments);return c!==o&&(s=(o=c)&&RS(e,c,n)),s}return i._value=t,i}function FS(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,DS(e,t,n??""))}function IS(e){return function(){this.textContent=e}}function BS(e){return function(){var t=e(this);this.textContent=t??""}}function US(e){return this.tween("text",typeof e=="function"?BS(Im(this,"text",e)):IS(e==null?"":e+""))}function qS(e){return function(t){this.textContent=e.call(this,t)}}function HS(e){var t,n;function s(){var o=e.apply(this,arguments);return o!==n&&(t=(n=o)&&qS(o)),t}return s._value=e,s}function VS(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,HS(e))}function WS(){for(var e=this._name,t=this._id,n=i_(),s=this._groups,o=s.length,i=0;i<o;++i)for(var c=s[i],u=c.length,d,p=0;p<u;++p)if(d=c[p]){var h=hr(d,t);au(d,e,n,p,c,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Ur(s,this._parents,e,n)}function KS(){var e,t,n=this,s=n._id,o=n.size();return new Promise(function(i,c){var u={value:c},d={value:function(){--o===0&&i()}};n.each(function(){var p=Er(this,s),h=p.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(d)),p.on=t}),o===0&&i()})}var YS=0;function Ur(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function i_(){return++YS}var qr=fi.prototype;Ur.prototype={constructor:Ur,select:kS,selectAll:MS,selectChild:qr.selectChild,selectChildren:qr.selectChildren,filter:xS,merge:wS,selection:OS,transition:WS,call:qr.call,nodes:qr.nodes,node:qr.node,size:qr.size,empty:qr.empty,each:qr.each,on:CS,attr:aS,attrTween:uS,style:zS,styleTween:FS,text:US,textTween:VS,remove:ES,tween:JC,delay:hS,duration:gS,ease:vS,easeVarying:bS,end:KS,[Symbol.iterator]:qr[Symbol.iterator]};function GS(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var QS={time:null,delay:0,duration:250,ease:GS};function XS(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function JS(e){var t,n;e instanceof Ur?(t=e._id,e=e._name):(t=i_(),(n=QS).time=Lm(),e=e==null?null:e+"");for(var s=this._groups,o=s.length,i=0;i<o;++i)for(var c=s[i],u=c.length,d,p=0;p<u;++p)(d=c[p])&&au(d,e,t,p,c,n||XS(d,t));return new Ur(s,this._parents,e,t)}fi.prototype.interrupt=GC,fi.prototype.transition=JS;const lu=e=>()=>e;function ZS(e,{sourceEvent:t,target:n,transform:s,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:o}})}function Hr(e,t,n){this.k=e,this.x=t,this.y=n}Hr.prototype={constructor:Hr,scale:function(e){return e===1?this:new Hr(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Hr(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var _o=new Hr(1,0,0);Hr.prototype;function Bm(e){e.stopImmediatePropagation()}function Ni(e){e.preventDefault(),e.stopImmediatePropagation()}function eE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function tE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function c_(){return this.__zoom||_o}function nE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function sE(){return navigator.maxTouchPoints||"ontouchstart"in this}function rE(e,t,n){var s=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],c=e.invertY(t[1][1])-n[1][1];return e.translate(o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o),c>i?(i+c)/2:Math.min(0,i)||Math.max(0,c))}function aE(){var e=eE,t=tE,n=rE,s=nE,o=sE,i=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=BC,p=qc("start","zoom","end"),h,f,g,w=500,b=150,_=0,x=10;function N(z){z.property("__zoom",c_).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",L).on("dblclick.zoom",$).filter(o).on("touchstart.zoom",A).on("touchmove.zoom",R).on("touchend.zoom touchcancel.zoom",W).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.transform=function(z,D,H,q){var I=z.selection?z.selection():z;I.property("__zoom",c_),z!==I?S(z,D,H,q):I.interrupt().each(function(){M(this,arguments).event(q).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},N.scaleBy=function(z,D,H,q){N.scaleTo(z,function(){var I=this.__zoom.k,Q=typeof D=="function"?D.apply(this,arguments):D;return I*Q},H,q)},N.scaleTo=function(z,D,H,q){N.transform(z,function(){var I=t.apply(this,arguments),Q=this.__zoom,U=H==null?j(I):typeof H=="function"?H.apply(this,arguments):H,F=Q.invert(U),K=typeof D=="function"?D.apply(this,arguments):D;return n(E(C(Q,K),U,F),I,c)},H,q)},N.translateBy=function(z,D,H,q){N.transform(z,function(){return n(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof H=="function"?H.apply(this,arguments):H),t.apply(this,arguments),c)},null,q)},N.translateTo=function(z,D,H,q,I){N.transform(z,function(){var Q=t.apply(this,arguments),U=this.__zoom,F=q==null?j(Q):typeof q=="function"?q.apply(this,arguments):q;return n(_o.translate(F[0],F[1]).scale(U.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof H=="function"?-H.apply(this,arguments):-H),Q,c)},q,I)};function C(z,D){return D=Math.max(i[0],Math.min(i[1],D)),D===z.k?z:new Hr(D,z.x,z.y)}function E(z,D,H){var q=D[0]-H[0]*z.k,I=D[1]-H[1]*z.k;return q===z.x&&I===z.y?z:new Hr(z.k,q,I)}function j(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function S(z,D,H,q){z.on("start.zoom",function(){M(this,arguments).event(q).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(q).end()}).tween("zoom",function(){var I=this,Q=arguments,U=M(I,Q).event(q),F=t.apply(I,Q),K=H==null?j(F):typeof H=="function"?H.apply(I,Q):H,re=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),Y=I.__zoom,V=typeof D=="function"?D.apply(I,Q):D,G=d(Y.invert(K).concat(re/Y.k),V.invert(K).concat(re/V.k));return function(X){if(X===1)X=V;else{var se=G(X),J=re/se[2];X=new Hr(J,K[0]-se[0]*J,K[1]-se[1]*J)}U.zoom(null,X)}})}function M(z,D,H){return!H&&z.__zooming||new T(z,D)}function T(z,D){this.that=z,this.args=D,this.active=0,this.sourceEvent=null,this.extent=t.apply(z,D),this.taps=0}T.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,D){return this.mouse&&z!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var D=dr(this.that).datum();p.call(z,this.that,new ZS(z,{sourceEvent:this.sourceEvent,target:N,transform:this.that.__zoom,dispatch:p}),D)}};function P(z,...D){if(!e.apply(this,arguments))return;var H=M(this,D).event(z),q=this.__zoom,I=Math.max(i[0],Math.min(i[1],q.k*Math.pow(2,s.apply(this,arguments)))),Q=Cr(z);if(H.wheel)(H.mouse[0][0]!==Q[0]||H.mouse[0][1]!==Q[1])&&(H.mouse[1]=q.invert(H.mouse[0]=Q)),clearTimeout(H.wheel);else{if(q.k===I)return;H.mouse=[Q,q.invert(Q)],ou(this),H.start()}Ni(z),H.wheel=setTimeout(U,b),H.zoom("mouse",n(E(C(q,I),H.mouse[0],H.mouse[1]),H.extent,c));function U(){H.wheel=null,H.end()}}function L(z,...D){if(g||!e.apply(this,arguments))return;var H=z.currentTarget,q=M(this,D,!0).event(z),I=dr(z.view).on("mousemove.zoom",K,!0).on("mouseup.zoom",re,!0),Q=Cr(z,H),U=z.clientX,F=z.clientY;$g(z.view),Bm(z),q.mouse=[Q,this.__zoom.invert(Q)],ou(this),q.start();function K(Y){if(Ni(Y),!q.moved){var V=Y.clientX-U,G=Y.clientY-F;q.moved=V*V+G*G>_}q.event(Y).zoom("mouse",n(E(q.that.__zoom,q.mouse[0]=Cr(Y,H),q.mouse[1]),q.extent,c))}function re(Y){I.on("mousemove.zoom mouseup.zoom",null),Pg(Y.view,q.moved),Ni(Y),q.event(Y).end()}}function $(z,...D){if(e.apply(this,arguments)){var H=this.__zoom,q=Cr(z.changedTouches?z.changedTouches[0]:z,this),I=H.invert(q),Q=H.k*(z.shiftKey?.5:2),U=n(E(C(H,Q),q,I),t.apply(this,D),c);Ni(z),u>0?dr(this).transition().duration(u).call(S,U,q,z):dr(this).call(N.transform,U,q,z)}}function A(z,...D){if(e.apply(this,arguments)){var H=z.touches,q=H.length,I=M(this,D,z.changedTouches.length===q).event(z),Q,U,F,K;for(Bm(z),U=0;U<q;++U)F=H[U],K=Cr(F,this),K=[K,this.__zoom.invert(K),F.identifier],I.touch0?!I.touch1&&I.touch0[2]!==K[2]&&(I.touch1=K,I.taps=0):(I.touch0=K,Q=!0,I.taps=1+!!h);h&&(h=clearTimeout(h)),Q&&(I.taps<2&&(f=K[0],h=setTimeout(function(){h=null},w)),ou(this),I.start())}}function R(z,...D){if(this.__zooming){var H=M(this,D).event(z),q=z.changedTouches,I=q.length,Q,U,F,K;for(Ni(z),Q=0;Q<I;++Q)U=q[Q],F=Cr(U,this),H.touch0&&H.touch0[2]===U.identifier?H.touch0[0]=F:H.touch1&&H.touch1[2]===U.identifier&&(H.touch1[0]=F);if(U=H.that.__zoom,H.touch1){var re=H.touch0[0],Y=H.touch0[1],V=H.touch1[0],G=H.touch1[1],X=(X=V[0]-re[0])*X+(X=V[1]-re[1])*X,se=(se=G[0]-Y[0])*se+(se=G[1]-Y[1])*se;U=C(U,Math.sqrt(X/se)),F=[(re[0]+V[0])/2,(re[1]+V[1])/2],K=[(Y[0]+G[0])/2,(Y[1]+G[1])/2]}else if(H.touch0)F=H.touch0[0],K=H.touch0[1];else return;H.zoom("touch",n(E(U,F,K),H.extent,c))}}function W(z,...D){if(this.__zooming){var H=M(this,D).event(z),q=z.changedTouches,I=q.length,Q,U;for(Bm(z),g&&clearTimeout(g),g=setTimeout(function(){g=null},w),Q=0;Q<I;++Q)U=q[Q],H.touch0&&H.touch0[2]===U.identifier?delete H.touch0:H.touch1&&H.touch1[2]===U.identifier&&delete H.touch1;if(H.touch1&&!H.touch0&&(H.touch0=H.touch1,delete H.touch1),H.touch0)H.touch0[1]=this.__zoom.invert(H.touch0[0]);else if(H.end(),H.taps===2&&(U=Cr(U,this),Math.hypot(f[0]-U[0],f[1]-U[1])<x)){var F=dr(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return N.wheelDelta=function(z){return arguments.length?(s=typeof z=="function"?z:lu(+z),N):s},N.filter=function(z){return arguments.length?(e=typeof z=="function"?z:lu(!!z),N):e},N.touchable=function(z){return arguments.length?(o=typeof z=="function"?z:lu(!!z),N):o},N.extent=function(z){return arguments.length?(t=typeof z=="function"?z:lu([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),N):t},N.scaleExtent=function(z){return arguments.length?(i[0]=+z[0],i[1]=+z[1],N):[i[0],i[1]]},N.translateExtent=function(z){return arguments.length?(c[0][0]=+z[0][0],c[1][0]=+z[1][0],c[0][1]=+z[0][1],c[1][1]=+z[1][1],N):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},N.constrain=function(z){return arguments.length?(n=z,N):n},N.duration=function(z){return arguments.length?(u=+z,N):u},N.interpolate=function(z){return arguments.length?(d=z,N):d},N.on=function(){var z=p.on.apply(p,arguments);return z===p?N:z},N.clickDistance=function(z){return arguments.length?(_=(z=+z)*z,N):Math.sqrt(_)},N.tapDistance=function(z){return arguments.length?(x=+z,N):x},N}function At(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Um(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function u_(e,t){if(e){if(typeof e=="string")return Um(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Um(e,t)}}function oE(e){if(Array.isArray(e))return e}function lE(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s=[],o=!0,i=!1,c,u;try{for(n=n.call(e);!(o=(c=n.next()).done)&&(s.push(c.value),!(t&&s.length===t));o=!0);}catch(d){i=!0,u=d}finally{try{!o&&n.return!=null&&n.return()}finally{if(i)throw u}}return s}}function iE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xt(e,t){return oE(e)||lE(e,t)||u_(e,t)||iE()}var vo;(function(e){e.Strict="strict",e.Loose="loose"})(vo||(vo={}));var hl;(function(e){e.Lines="lines",e.Dots="dots"})(hl||(hl={}));var fl;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(fl||(fl={}));var wa;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(wa||(wa={}));var iu;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(iu||(iu={}));var Ae;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Ae||(Ae={}));var qm=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},pl=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),s)},d_=function(t,n){return{x:pl(t.x,n[0][0],n[1][0]),y:pl(t.y,n[0][1],n[1][1])}},m_=function(t){var n,s;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((s=window)===null||s===void 0?void 0:s.document)},cE=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},cu=function(t){var n=t.x,s=t.y,o=t.width,i=t.height;return{x:n,y:s,x2:n+o,y2:s+i}},uE=function(t){var n=t.x,s=t.y,o=t.x2,i=t.y2;return{x:n,y:s,width:o-n,height:i-s}},h_=function(t){return!isNaN(t)&&isFinite(t)},Kn=Symbol("internals");function f_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function Ci(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function p_(e,t){var n=e.find(function(p){return p.id===t.parentNode});if(n){var s=t.position.x+t.width-n.width,o=t.position.y+t.height-n.height;if(s>0||o>0||t.position.x<0||t.position.y<0){var i,c;if(n.style=Ci({},n.style)||{},n.style.width=(i=n.style.width)!==null&&i!==void 0?i:n.width,n.style.height=(c=n.style.height)!==null&&c!==void 0?c:n.height,s>0&&(n.style.width+=s),o>0&&(n.style.height+=o),t.position.x<0){var u=Math.abs(t.position.x);n.position.x=n.position.x-u,n.style.width+=u,t.position.x=0}if(t.position.y<0){var d=Math.abs(t.position.y);n.position.y=n.position.y-d,n.style.height+=d,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function g_(e,t){if(e.some(function(s){return s.type==="reset"}))return e.filter(function(s){return s.type==="reset"}).map(function(s){return s.item});var n=e.filter(function(s){return s.type==="add"}).map(function(s){return s.item});return t.reduce(function(s,o){var i=e.find(function(d){return d.id===o.id});if(i)switch(i.type){case"select":return s.push(Ci(Ci({},o),{},{selected:i.selected})),s;case"position":{var c=Ci({},o);return typeof i.position<"u"&&(c.position=i.position),typeof i.positionAbsolute<"u"&&(c.positionAbsolute=i.positionAbsolute),typeof i.dragging<"u"&&(c.dragging=i.dragging),c.expandParent&&p_(s,c),s.push(c),s}case"dimensions":{var u=Ci({},o);return typeof i.dimensions<"u"&&(u.width=i.dimensions.width,u.height=i.dimensions.height),u.expandParent&&p_(s,u),s.push(u),s}case"remove":return s}return s.push(o),s},n)}function __(e,t){return g_(e,t)}function dE(e,t){return g_(e,t)}var ja=function(t,n){return{id:t,type:"select",selected:n}};function gl(e,t){return e.reduce(function(n,s){var o=t.includes(s.id);return!s.selected&&o?(s.selected=!0,n.push(ja(s.id,!0))):s.selected&&!o&&(s.selected=!1,n.push(ja(s.id,!1))),n},[])}function v_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function y_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?v_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var b_=function(t,n,s){var o=n.querySelectorAll(t);if(!o||!o.length)return null;var i=Array.from(o),c=n.getBoundingClientRect();return i.map(function(u){var d=u.getBoundingClientRect();return y_({id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(d.left-c.left)/s,y:(d.top-c.top)/s},qm(u))})};function Si(e,t,n){return n===void 0?n:function(s){var o=t().nodeInternals.get(e);n(s,y_({},o))}}function x_(e){var t=e.id,n=e.store,s=n.getState(),o=s.addSelectedNodes,i=s.unselectNodesAndEdges,c=s.multiSelectionActive,u=s.nodeInternals,d=u.get(t);n.setState({nodesSelectionActive:!1}),d.selected?d.selected&&c&&i({nodes:[d]}):o([t])}function w_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function Ei(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var mE=function(t){return"id"in t&&"source"in t&&"target"in t},hE=function(t){var n=t.source,s=t.sourceHandle,o=t.target,i=t.targetHandle;return"reactflow__edge-".concat(n).concat(s||"","-").concat(o).concat(i||"")},Hm=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var s=n?"".concat(n,"__"):"";return"".concat(s).concat(Object.keys(t).sort().map(function(o){return"".concat(o,"=").concat(t[o])}).join("&"))},fE=function(t,n){return n.some(function(s){return s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)})},j_=function(t,n){if(!t.source||!t.target)return n;var s;return mE(t)?s=Ei({},t):s=Ei(Ei({},t),{},{id:hE(t)}),fE(s,n)?n:n.concat(s)},N_=function(t,n,s,o){var i=t.x,c=t.y,u=xt(n,3),d=u[0],p=u[1],h=u[2],f=xt(o,2),g=f[0],w=f[1],b={x:(i-d)/h,y:(c-p)/h};return s?{x:g*Math.round(b.x/g),y:w*Math.round(b.y/w)}:b},Vm=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(s,o){var i=o.positionAbsolute,c=o.position,u=o.width,d=o.height;return cE(s,cu({x:i?i.x:c.x,y:i?i.y:c.y,width:u||0,height:d||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return uE(n)},C_=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],o=xt(s,3),i=o[0],c=o[1],u=o[2],d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,h=cu({x:(n.x-i)/u,y:(n.y-c)/u,width:n.width/u,height:n.height/u}),f=[];return t.forEach(function(g){var w=g.positionAbsolute,b=g.width,_=g.height,x=g.selectable,N=x===void 0?!0:x;if(p&&!N)return!1;var C=cu(Ei(Ei({},w),{},{width:b||0,height:_||0})),E=Math.max(0,Math.min(h.x2,C.x2)-Math.max(h.x,C.x)),j=Math.max(0,Math.min(h.y2,C.y2)-Math.max(h.y,C.y)),S=Math.ceil(E*j),M=typeof b>"u"||typeof _>"u"||b===null||_===null,T=d&&S>0,P=(b||0)*(_||0),L=M||T||S>=P;L&&f.push(g)}),f},S_=function(t,n){var s=t.map(function(o){return o.id});return n.filter(function(o){return s.includes(o.source)||s.includes(o.target)})},E_=function(t,n,s,o,i){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,u=n/(t.width*(1+c)),d=s/(t.height*(1+c)),p=Math.min(u,d),h=pl(p,o,i),f=t.x+t.width/2,g=t.y+t.height/2,w=n/2-f*h,b=s/2-g*h;return[w,b,h]},yo=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function k_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function _l(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function M_(e,t,n,s){var o,i,c,u,d,p,h,f,g,w,b,_;if(!e.parentNode)return s;var x=t.get(e.parentNode);return M_(x,t,n,{x:((o=s.x)!==null&&o!==void 0?o:0)+((i=(c=x.position)===null||c===void 0?void 0:c.x)!==null&&i!==void 0?i:0),y:((u=s.y)!==null&&u!==void 0?u:0)+((d=(p=x.position)===null||p===void 0?void 0:p.y)!==null&&d!==void 0?d:0),z:((h=(f=x[Kn])===null||f===void 0?void 0:f.z)!==null&&h!==void 0?h:0)>((g=s.z)!==null&&g!==void 0?g:0)?(w=(b=x[Kn])===null||b===void 0?void 0:b.z)!==null&&w!==void 0?w:0:(_=s.z)!==null&&_!==void 0?_:0})}function Wm(e,t){var n=new Map,s={};return e.forEach(function(o){var i,c=h_(o.zIndex)?o.zIndex:o.selected?1e3:0,u=t.get(o.id),d=_l(_l({width:u==null?void 0:u.width,height:u==null?void 0:u.height},o),{},{positionAbsolute:{x:o.position.x,y:o.position.y}});o.parentNode&&(d.parentNode=o.parentNode,s[o.parentNode]=!0),Object.defineProperty(d,Kn,{enumerable:!1,value:{handleBounds:u==null||(i=u[Kn])===null||i===void 0?void 0:i.handleBounds,z:c}}),n.set(o.id,d)}),n.forEach(function(o){if(o.parentNode&&!n.has(o.parentNode))throw new Error("Parent node ".concat(o.parentNode," not found"));if(o.parentNode||s[o.id]){var i,c,u=M_(o,n,s,_l(_l({},o.position),{},{z:(i=(c=o[Kn])===null||c===void 0?void 0:c.z)!==null&&i!==void 0?i:0})),d=u.x,p=u.y,h=u.z;o.positionAbsolute={x:d,y:p},o[Kn].z=h,s[o.id]&&(o[Kn].isParent=!0)}}),n}function A_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),s=n.nodeInternals,o=n.width,i=n.height,c=n.minZoom,u=n.maxZoom,d=n.d3Zoom,p=n.d3Selection,h=n.fitViewOnInitDone,f=n.fitViewOnInit;if((t.initial&&!h&&f||!t.initial)&&d&&p){var g=Array.from(s.values()).filter(function(P){return t.includeHiddenNodes?P.width&&P.height:!P.hidden}),w=g.every(function(P){return P.width&&P.height});if(g.length>0&&w){var b,_,x,N=Vm(g),C=E_(N,o,i,(b=t.minZoom)!==null&&b!==void 0?b:c,(_=t.maxZoom)!==null&&_!==void 0?_:u,(x=t.padding)!==null&&x!==void 0?x:.1),E=xt(C,3),j=E[0],S=E[1],M=E[2],T=_o.translate(j,S).scale(M);return typeof t.duration=="number"&&t.duration>0?d.transform(yo(p,t.duration),T):d.transform(p,T),!0}}return!1}function pE(e,t){return e.forEach(function(n){var s=t.get(n.id);if(s){var o;t.set(s.id,_l(_l({},s),{},(o={},At(o,Kn,s[Kn]),At(o,"selected",n.selected),o)))}}),new Map(t)}function gE(e,t){return t.map(function(n){var s=e.find(function(o){return o.id===n.id});return s&&(n.selected=s.selected),n})}function uu(e){var t=e.changedNodes,n=e.changedEdges,s=e.get,o=e.set,i=s(),c=i.nodeInternals,u=i.edges,d=i.onNodesChange,p=i.onEdgesChange,h=i.hasDefaultNodes,f=i.hasDefaultEdges;t!=null&&t.length&&(h&&o({nodeInternals:pE(t,c)}),d==null||d(t)),n!=null&&n.length&&(f&&o({edges:gE(n,u)}),p==null||p(n))}var Km=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],O_={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Km,nodeExtent:Km,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:vo.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function T_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function kr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?T_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Ym=Ej(),$_=Ym.Provider,Nn=Ym.useStore,rs=Ym.useStoreApi,P_=function(){return Sj(function(t,n){return kr(kr({},O_),{},{setNodes:function(o){t({nodeInternals:Wm(o,n().nodeInternals)})},setEdges:function(o){var i=n(),c=i.defaultEdgeOptions,u=c===void 0?{}:c;t({edges:o.map(function(d){return kr(kr({},u),d)})})},setDefaultNodesAndEdges:function(o,i){var c=typeof o<"u",u=typeof i<"u",d=c?Wm(o,new Map):new Map,p=u?i:[];t({nodeInternals:d,edges:p,hasDefaultNodes:c,hasDefaultEdges:u})},updateNodeDimensions:function(o){var i=n(),c=i.onNodesChange,u=i.nodeInternals,d=i.fitViewOnInit,p=i.fitViewOnInitDone,h=i.fitViewOnInitOptions,f=i.domNode,g=f==null?void 0:f.querySelector(".react-flow__viewport");if(g){var w=window.getComputedStyle(g),b=new window.DOMMatrixReadOnly(w.transform),_=b.m22,x=o.reduce(function(C,E){var j=u.get(E.id);if(j){var S=qm(E.nodeElement),M=!!(S.width&&S.height&&(j.width!==S.width||j.height!==S.height||E.forceUpdate));M&&(u.set(j.id,kr(kr({},j),{},At({},Kn,kr(kr({},j[Kn]),{},{handleBounds:{source:b_(".source",E.nodeElement,_),target:b_(".target",E.nodeElement,_)}})),S)),C.push({id:j.id,type:"dimensions",dimensions:S}))}return C},[]),N=p||d&&!p&&A_(n,kr({initial:!0},h));t({nodeInternals:new Map(u),fitViewOnInitDone:N}),(x==null?void 0:x.length)>0&&(c==null||c(x))}},updateNodePositions:function(o){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=n(),d=u.onNodesChange,p=u.nodeInternals,h=u.hasDefaultNodes;if(h||d){var f=o.map(function(b){var _={id:b.id,type:"position",dragging:c};return i&&(_.positionAbsolute=b.positionAbsolute,_.position=b.position),_});if(f!=null&&f.length){if(h){var g=__(f,Array.from(p.values())),w=Wm(g,p);t({nodeInternals:w})}d==null||d(f)}}},addSelectedNodes:function(o){var i=n(),c=i.multiSelectionActive,u=i.nodeInternals,d=i.edges,p,h=null;c?p=o.map(function(f){return ja(f,!0)}):(p=gl(Array.from(u.values()),o),h=gl(d,[])),uu({changedNodes:p,changedEdges:h,get:n,set:t})},addSelectedEdges:function(o){var i=n(),c=i.multiSelectionActive,u=i.edges,d=i.nodeInternals,p,h=null;c?p=o.map(function(f){return ja(f,!0)}):(p=gl(u,o),h=gl(Array.from(d.values()),[])),uu({changedNodes:h,changedEdges:p,get:n,set:t})},unselectNodesAndEdges:function(){var o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=o.nodes,c=o.edges,u=n(),d=u.nodeInternals,p=u.edges,h=i||Array.from(d.values()),f=c||p,g=h.map(function(b){return b.selected=!1,ja(b.id,!1)}),w=f.map(function(b){return ja(b.id,!1)});uu({changedNodes:g,changedEdges:w,get:n,set:t})},setMinZoom:function(o){var i=n(),c=i.d3Zoom,u=i.maxZoom;c==null||c.scaleExtent([o,u]),t({minZoom:o})},setMaxZoom:function(o){var i=n(),c=i.d3Zoom,u=i.minZoom;c==null||c.scaleExtent([u,o]),t({maxZoom:o})},setTranslateExtent:function(o){var i=n(),c=i.d3Zoom;c==null||c.translateExtent(o),t({translateExtent:o})},resetSelectedElements:function(){var o=n(),i=o.nodeInternals,c=o.edges,u=Array.from(i.values()),d=u.filter(function(h){return h.selected}).map(function(h){return ja(h.id,!1)}),p=c.filter(function(h){return h.selected}).map(function(h){return ja(h.id,!1)});uu({changedNodes:d,changedEdges:p,get:n,set:t})},setNodeExtent:function(o){var i=n(),c=i.nodeInternals;c.forEach(function(u){u.positionAbsolute=d_(u.position,o)}),t({nodeExtent:o,nodeInternals:new Map(c)})},reset:function(){return t(kr({},O_))}})})};function Us(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=Us(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function qs(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let s=0;s<n.length;s++)if(!Object.prototype.hasOwnProperty.call(t,n[s])||!Object.is(e[n[s]],t[n[s]]))return!1;return!0}function _E(e){if(Array.isArray(e))return Um(e)}function vE(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bo(e){return _E(e)||vE(e)||u_(e)||yE()}var bE={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},xE=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},wE=function(){var t=rs(),n=Nn(xE,qs),s=n.d3Zoom,o=n.d3Selection,i=v.useMemo(function(){return o&&s?{zoomIn:function(u){return s.scaleBy(yo(o,u==null?void 0:u.duration),1.2)},zoomOut:function(u){return s.scaleBy(yo(o,u==null?void 0:u.duration),1/1.2)},zoomTo:function(u,d){return s.scaleTo(yo(o,d==null?void 0:d.duration),u)},getZoom:function(){return t.getState().transform[2]},setViewport:function(u,d){var p,h,f,g=xt(t.getState().transform,3),w=g[0],b=g[1],_=g[2],x=_o.translate((p=u.x)!==null&&p!==void 0?p:w,(h=u.y)!==null&&h!==void 0?h:b).scale((f=u.zoom)!==null&&f!==void 0?f:_);s.transform(yo(o,d==null?void 0:d.duration),x)},getViewport:function(){var u=xt(t.getState().transform,3),d=u[0],p=u[1],h=u[2];return{x:d,y:p,zoom:h}},fitView:function(u){return A_(t.getState,u)},setCenter:function(u,d,p){var h=t.getState(),f=h.width,g=h.height,w=h.maxZoom,b=typeof(p==null?void 0:p.zoom)<"u"?p.zoom:w,_=f/2-u*b,x=g/2-d*b,N=_o.translate(_,x).scale(b);s.transform(yo(o,p==null?void 0:p.duration),N)},fitBounds:function(u,d){var p,h=t.getState(),f=h.width,g=h.height,w=h.minZoom,b=h.maxZoom,_=E_(u,f,g,w,b,(p=d==null?void 0:d.padding)!==null&&p!==void 0?p:.1),x=xt(_,3),N=x[0],C=x[1],E=x[2],j=_o.translate(N,C).scale(E);s.transform(yo(o,d==null?void 0:d.duration),j)},project:function(u){var d=t.getState(),p=d.transform,h=d.snapToGrid,f=d.snapGrid;return N_(u,p,h,f)},viewportInitialized:!0}:bE},[s,o]);return i};function L_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function vl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Gm(){var e=wE(),t=rs(),n=v.useCallback(function(){var f=t.getState(),g=f.nodeInternals,w=Array.from(g.values());return w.map(function(b){return vl({},b)})},[]),s=v.useCallback(function(f){var g=t.getState(),w=g.nodeInternals;return w.get(f)},[]),o=v.useCallback(function(){var f=t.getState(),g=f.edges,w=g===void 0?[]:g;return w.map(function(b){return vl({},b)})},[]),i=v.useCallback(function(f){var g=t.getState(),w=g.edges,b=w===void 0?[]:w;return b.find(function(_){return _.id===f})},[]),c=v.useCallback(function(f){var g=t.getState(),w=g.nodeInternals,b=g.setNodes,_=g.hasDefaultNodes,x=g.onNodesChange,N=Array.from(w.values()),C=typeof f=="function"?f(N):f;if(_)b(C);else if(x){var E=C.length===0?N.map(function(j){return{type:"remove",id:j.id}}):C.map(function(j){return{item:j,type:"reset"}});x(E)}},[]),u=v.useCallback(function(f){var g=t.getState(),w=g.edges,b=w===void 0?[]:w,_=g.setEdges,x=g.hasDefaultEdges,N=g.onEdgesChange,C=typeof f=="function"?f(b):f;if(x)_(C);else if(N){var E=C.length===0?b.map(function(j){return{type:"remove",id:j.id}}):C.map(function(j){return{item:j,type:"reset"}});N(E)}},[]),d=v.useCallback(function(f){var g=Array.isArray(f)?f:[f],w=t.getState(),b=w.nodeInternals,_=w.setNodes,x=w.hasDefaultNodes,N=w.onNodesChange;if(x){var C=Array.from(b.values()),E=[].concat(C,bo(g));_(E)}else if(N){var j=g.map(function(S){return{item:S,type:"add"}});N(j)}},[]),p=v.useCallback(function(f){var g=Array.isArray(f)?f:[f],w=t.getState(),b=w.edges,_=b===void 0?[]:b,x=w.setEdges,N=w.hasDefaultEdges,C=w.onEdgesChange;if(N)x([].concat(bo(_),bo(g)));else if(C){var E=g.map(function(j){return{item:j,type:"add"}});C(E)}},[]),h=v.useCallback(function(){var f=t.getState(),g=f.nodeInternals,w=f.edges,b=w===void 0?[]:w,_=f.transform,x=Array.from(g.values()),N=xt(_,3),C=N[0],E=N[1],j=N[2];return{nodes:x.map(function(S){return vl({},S)}),edges:b.map(function(S){return vl({},S)}),viewport:{x:C,y:E,zoom:j}}},[]);return v.useMemo(function(){return vl(vl({},e),{},{getNodes:n,getNode:s,getEdges:o,getEdge:i,setNodes:c,setEdges:u,addNodes:d,addEdges:p,toObject:h})},[e,n,s,o,i,c,u,d,p,h])}function jE(e,t){if(e==null)return{};var n={},s=Object.keys(e),o,i;for(i=0;i<s.length;i++)o=s[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}function du(e,t){if(e==null)return{};var n=jE(e,t),s,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)s=i[o],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function NE(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},ve.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function CE(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},ve.createElement("path",{d:"M0 0h32v4.2H0z"}))}function SE(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},ve.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function EE(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ve.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function kE(){return ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ve.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var ME=["children","className"];function z_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function AE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var mu=function(t){var n=t.children,s=t.className,o=du(t,ME);return ve.createElement("button",AE({type:"button",className:Us(["react-flow__controls-button",s])},o),n)},OE=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},R_=function(t){var n=t.style,s=t.showZoom,o=s===void 0?!0:s,i=t.showFitView,c=i===void 0?!0:i,u=t.showInteractive,d=u===void 0?!0:u,p=t.fitViewOptions,h=t.onZoomIn,f=t.onZoomOut,g=t.onFitView,w=t.onInteractiveChange,b=t.className,_=t.children,x=rs(),N=v.useState(!1),C=xt(N,2),E=C[0],j=C[1],S=Nn(OE),M=Gm(),T=M.zoomIn,P=M.zoomOut,L=M.fitView;if(v.useEffect(function(){j(!0)},[]),!E)return null;var $=function(){T==null||T(),h==null||h()},A=function(){P==null||P(),f==null||f()},R=function(){L==null||L(p),g==null||g()},W=function(){x.setState({nodesDraggable:!S,nodesConnectable:!S,elementsSelectable:!S}),w==null||w(!S)};return ve.createElement("div",{className:Us(["react-flow__controls",b]),style:n},o&&ve.createElement(ve.Fragment,null,ve.createElement(mu,{onClick:$,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},ve.createElement(NE,null)),ve.createElement(mu,{onClick:A,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},ve.createElement(CE,null))),c&&ve.createElement(mu,{className:"react-flow__controls-fitview",onClick:R,title:"fit view","aria-label":"fit view"},ve.createElement(SE,null)),d&&ve.createElement(mu,{className:"react-flow__controls-interactive",onClick:W,title:"toggle interactivity","aria-label":"toggle interactivity"},S?ve.createElement(kE,null):ve.createElement(EE,null)),_)};R_.displayName="Controls";var TE=v.memo(R_),$E=function(t,n,s){return ve.createElement("path",{stroke:s,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},PE=function(t,n){return ve.createElement("circle",{cx:t,cy:t,r:t,fill:n})},hu;function D_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function F_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var LE=(hu={},At(hu,hl.Dots,"#81818a"),At(hu,hl.Lines,"#eee"),hu),zE=function(t){return t.transform},I_=function(t){var n=t.variant,s=n===void 0?hl.Dots:n,o=t.gap,i=o===void 0?15:o,c=t.size,u=c===void 0?.4:c,d=t.color,p=t.style,h=t.className,f=v.useRef(null),g=v.useState(null),w=xt(g,2),b=w[0],_=w[1],x=Nn(zE),N=xt(x,3),C=N[0],E=N[1],j=N[2];v.useEffect(function(){var A=document.querySelectorAll(".react-flow__background"),R=Array.from(A).findIndex(function(W){return W===f.current});_("pattern-".concat(R))},[]);var S=i*j||1,M=C%S,T=E%S,P=s===hl.Lines,L=d||LE[s],$=P?$E(S,u,L):PE(u*j,L);return ve.createElement("svg",{className:Us(["react-flow__background","react-flow__container",h]),style:F_(F_({},p),{},{width:"100%",height:"100%"}),ref:f},b&&ve.createElement(ve.Fragment,null,ve.createElement("pattern",{id:b,x:M,y:T,width:S,height:S,patternUnits:"userSpaceOnUse"},$),ve.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(b,")")})))};I_.displayName="Background";var RE=v.memo(I_),DE=function(t){return t.updateNodeDimensions};function FE(){var e=rs(),t=Nn(DE);return v.useCallback(function(n){var s,o=(s=e.getState().domNode)===null||s===void 0?void 0:s.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));o&&requestAnimationFrame(function(){return t([{id:n,nodeElement:o,forceUpdate:!0}])})},[])}var IE=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function BE(e){var t=e.proOptions,n=e.position,s=n===void 0?"bottom-right":n;if(t!=null&&t.account&&IE.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var o="".concat(s).split("-");return ve.createElement("div",{className:Us(["react-flow__attribution"].concat(bo(o))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},ve.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var UE=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function B_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function qE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var HE=function(t){var n=t.x,s=t.y,o=t.label,i=t.labelStyle,c=i===void 0?{}:i,u=t.labelShowBg,d=u===void 0?!0:u,p=t.labelBgStyle,h=p===void 0?{}:p,f=t.labelBgPadding,g=f===void 0?[2,4]:f,w=t.labelBgBorderRadius,b=w===void 0?2:w,_=t.children,x=t.className,N=du(t,UE),C=v.useRef(null),E=v.useState({x:0,y:0,width:0,height:0}),j=xt(E,2),S=j[0],M=j[1],T=Us(["react-flow__edge-textwrapper",x]);return v.useEffect(function(){if(C.current){var P=C.current.getBBox();M({x:P.x,y:P.y,width:P.width,height:P.height})}},[o]),typeof o>"u"||!o?null:ve.createElement("g",qE({transform:"translate(".concat(n-S.width/2," ").concat(s-S.height/2,")"),className:T},N),d&&ve.createElement("rect",{width:S.width+2*g[0],x:-g[0],y:-g[1],height:S.height+2*g[1],className:"react-flow__edge-textbg",style:h,rx:b,ry:b}),ve.createElement("text",{className:"react-flow__edge-text",y:S.height/2,dy:"0.3em",ref:C,style:c},o),_)},VE=v.memo(HE),fu=function(e){var t=e.path,n=e.centerX,s=e.centerY,o=e.label,i=e.labelStyle,c=e.labelShowBg,u=e.labelBgStyle,d=e.labelBgPadding,p=e.labelBgBorderRadius,h=e.style,f=e.markerEnd,g=e.markerStart,w=o?ve.createElement(VE,{x:n,y:s,label:o,labelStyle:i,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:p}):null;return ve.createElement(ve.Fragment,null,ve.createElement("path",{style:h,d:t,className:"react-flow__edge-path",markerEnd:f,markerStart:g}),w)};function pu(e){var t=e.pos,n=e.x1,s=e.y1,o=e.x2,i=e.y2,c,u;switch(t){case Ae.Left:case Ae.Right:c=.5*(n+o),u=s;break;case Ae.Top:case Ae.Bottom:c=n,u=.5*(s+i);break}return[c,u]}function U_(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,o=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=pu({pos:o,x1:t,y1:n,x2:i,y2:c}),h=xt(p,2),f=h[0],g=h[1],w=pu({pos:d,x1:i,y1:c,x2:t,y2:n}),b=xt(w,2),_=b[0],x=b[1];return"M".concat(t,",").concat(n," C").concat(f,",").concat(g," ").concat(_,",").concat(x," ").concat(i,",").concat(c)}function WE(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,o=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=pu({pos:o,x1:t,y1:n,x2:i,y2:c}),h=xt(p,2),f=h[0],g=h[1],w=pu({pos:d,x1:i,y1:c,x2:t,y2:n}),b=xt(w,2),_=b[0],x=b[1],N=t*.125+f*.375+_*.375+i*.125,C=n*.125+g*.375+x*.375+c*.125,E=Math.abs(N-t),j=Math.abs(C-n);return[N,C,E,j]}var q_=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,o=e.targetY,i=e.sourcePosition,c=i===void 0?Ae.Bottom:i,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,w=e.labelBgPadding,b=e.labelBgBorderRadius,_=e.style,x=e.markerEnd,N=e.markerStart,C={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:o,targetPosition:d},E=U_(C),j=WE(C),S=xt(j,2),M=S[0],T=S[1];return ve.createElement(fu,{path:E,centerX:M,centerY:T,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:b,style:_,markerEnd:x,markerStart:N})});function H_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function KE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var V_=[Ae.Left,Ae.Right],W_=function(t){var n=t.sourceX,s=t.sourceY,o=t.targetX,i=t.targetY,c=t.sourcePosition,u=c===void 0?Ae.Bottom:c,d=t.targetPosition,p=d===void 0?Ae.Top:d,h=V_.includes(u),f=V_.includes(p),g=h&&!f||f&&!h;if(g){var w=h?Math.abs(o-n):0,b=n>o?n-w:n+w,_=h?0:Math.abs(i-s),x=s<i?s+_:s-_;return[b,x,w,_]}var N=Math.abs(o-n)/2,C=o<n?o+N:o-N,E=Math.abs(i-s)/2,j=i<s?i+E:i-E;return[C,j,N,E]};function ki(e,t,n){return n===void 0?n:function(s){var o=t().edges.find(function(i){return i.id===e});n(s,KE({},o))}}var Qm=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},Xm=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},Jm=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},Zm=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},eh=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)},th=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},nh=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},sh=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)};function rh(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,o=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.borderRadius,h=p===void 0?5:p,f=e.centerX,g=e.centerY,w=W_({sourceX:t,sourceY:n,targetX:i,targetY:c}),b=xt(w,4),_=b[0],x=b[1],N=b[2],C=b[3],E=Math.min(h,Math.abs(i-t)),j=Math.min(h,Math.abs(c-n)),S=Math.min(E,j,N,C),M=[Ae.Left,Ae.Right],T=typeof f<"u"?f:_,P=typeof g<"u"?g:x,L=null,$=null;return t<=i?(L=n<=c?Qm(t,P,S):th(t,P,S),$=n<=c?sh(i,P,S):Zm(i,P,S)):(L=n<c?Jm(t,P,S):nh(t,P,S),$=n<c?eh(i,P,S):Xm(i,P,S)),M.includes(o)&&M.includes(d)?t<=i?(L=n<=c?sh(T,n,S):Zm(T,n,S),$=n<=c?Qm(T,c,S):th(T,c,S)):(o===Ae.Right&&d===Ae.Left||o===Ae.Left&&d===Ae.Right||o===Ae.Left&&d===Ae.Left)&&(L=n<=c?eh(T,n,S):Xm(T,n,S),$=n<=c?Jm(T,c,S):nh(T,c,S)):M.includes(o)&&!M.includes(d)?(t<=i?L=n<=c?sh(i,n,S):Zm(i,n,S):L=n<=c?eh(i,n,S):Xm(i,n,S),$=""):!M.includes(o)&&M.includes(d)&&(t<=i?L=n<=c?Qm(t,c,S):th(t,c,S):L=n<=c?Jm(t,c,S):nh(t,c,S),$=""),"M ".concat(t,",").concat(n).concat(L).concat($,"L ").concat(i,",").concat(c)}var ah=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,o=e.targetY,i=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.sourcePosition,w=g===void 0?Ae.Bottom:g,b=e.targetPosition,_=b===void 0?Ae.Top:b,x=e.markerEnd,N=e.markerStart,C=e.borderRadius,E=C===void 0?5:C,j=W_({sourceX:t,sourceY:n,targetX:s,targetY:o,sourcePosition:w,targetPosition:_}),S=xt(j,2),M=S[0],T=S[1],P=rh({sourceX:t,sourceY:n,sourcePosition:w,targetX:s,targetY:o,targetPosition:_,borderRadius:E});return ve.createElement(fu,{path:P,centerX:M,centerY:T,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:x,markerStart:N})});function K_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function Y_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var G_=v.memo(function(e){return ve.createElement(ah,Y_(Y_({},e),{},{borderRadius:0}))}),Q_=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,o=e.targetY,i=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.markerEnd,w=e.markerStart,b=Math.abs(o-n)/2,_=o<n?o+b:o-b,x=Math.abs(s-t)/2,N=s<t?s+x:s-x,C="M ".concat(t,",").concat(n,"L ").concat(s,",").concat(o);return ve.createElement(fu,{path:C,centerX:N,centerY:_,label:i,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:w})});function gu(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function _u(e){var t=e.pos,n=e.x1,s=e.y1,o=e.x2,i=e.y2,c=e.c,u,d;switch(t){case Ae.Left:u=n-gu(n-o,c),d=s;break;case Ae.Right:u=n+gu(o-n,c),d=s;break;case Ae.Top:u=n,d=s-gu(s-i,c);break;case Ae.Bottom:u=n,d=s+gu(i-s,c);break}return[u,d]}function X_(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,o=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.curvature,h=p===void 0?.25:p,f=_u({pos:o,x1:t,y1:n,x2:i,y2:c,c:h}),g=xt(f,2),w=g[0],b=g[1],_=_u({pos:d,x1:i,y1:c,x2:t,y2:n,c:h}),x=xt(_,2),N=x[0],C=x[1];return"M".concat(t,",").concat(n," C").concat(w,",").concat(b," ").concat(N,",").concat(C," ").concat(i,",").concat(c)}function YE(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,o=s===void 0?Ae.Bottom:s,i=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.curvature,h=p===void 0?.25:p,f=_u({pos:o,x1:t,y1:n,x2:i,y2:c,c:h}),g=xt(f,2),w=g[0],b=g[1],_=_u({pos:d,x1:i,y1:c,x2:t,y2:n,c:h}),x=xt(_,2),N=x[0],C=x[1],E=t*.125+w*.375+N*.375+i*.125,j=n*.125+b*.375+C*.375+c*.125,S=Math.abs(E-t),M=Math.abs(j-n);return[E,j,S,M]}var oh=v.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,o=e.targetY,i=e.sourcePosition,c=i===void 0?Ae.Bottom:i,u=e.targetPosition,d=u===void 0?Ae.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,w=e.labelBgPadding,b=e.labelBgBorderRadius,_=e.style,x=e.markerEnd,N=e.markerStart,C=e.curvature,E={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:o,targetPosition:d,curvature:C},j=X_(E),S=YE(E),M=xt(S,2),T=M[0],P=M[1];return ve.createElement(fu,{path:j,centerX:T,centerY:P,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:w,labelBgBorderRadius:b,style:_,markerEnd:x,markerStart:N})}),lh=v.createContext(null),GE=lh.Provider;lh.Consumer;function ih(e,t,n,s,o,i,c){var u=c.elementFromPoint(e.clientX,e.clientY),d=(u==null?void 0:u.classList.contains("target"))||!1,p=(u==null?void 0:u.classList.contains("source"))||!1,h={elementBelow:u,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(u&&(d||p)){h.isHoveringHandle=!0;var f=u.getAttribute("data-nodeid"),g=u.getAttribute("data-handleid"),w=n?{source:f,sourceHandle:g,target:s,targetHandle:o}:{source:s,sourceHandle:o,target:f,targetHandle:g};h.connection=w;var b=t===vo.Strict?n&&p||!n&&d:!0;b&&(h.isValid=i(w))}return h}function ch(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function J_(e){var t=e.event,n=e.handleId,s=e.nodeId,o=e.onConnect,i=e.isTarget,c=e.getState,u=e.setState,d=e.isValidConnection,p=e.elementEdgeUpdaterType,h=e.onEdgeUpdateEnd,f=t.target.closest(".react-flow"),g=m_(t.target);if(!g)return;var w=g.elementFromPoint(t.clientX,t.clientY),b=w==null?void 0:w.classList.contains("target"),_=w==null?void 0:w.classList.contains("source");if(!f||!b&&!_&&!p)return;var x=c(),N=x.onConnectStart,C=x.connectionMode,E=p||(b?"target":"source"),j=f.getBoundingClientRect(),S;u({connectionPosition:{x:t.clientX-j.left,y:t.clientY-j.top},connectionNodeId:s,connectionHandleId:n,connectionHandleType:E}),N==null||N(t,{nodeId:s,handleId:n,handleType:E});function M(P){u({connectionPosition:{x:P.clientX-j.left,y:P.clientY-j.top}});var L=ih(P,C,i,s,n,d,g),$=L.connection,A=L.elementBelow,R=L.isValid,W=L.isHoveringHandle;if(!W)return ch(S);$.source!==$.target&&A&&(ch(S),S=A,A.classList.add("react-flow__handle-connecting"),A.classList.toggle("react-flow__handle-valid",R))}function T(P){var L=c(),$=L.onConnectStop,A=L.onConnectEnd,R=ih(P,C,i,s,n,d,g),W=R.connection,z=R.isValid;$==null||$(P),z&&(o==null||o(W)),A==null||A(P),p&&h&&h(P),ch(S),u({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),g.removeEventListener("mousemove",M),g.removeEventListener("mouseup",T)}g.addEventListener("mousemove",M),g.addEventListener("mouseup",T)}var QE=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function Z_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function uh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z_(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var XE=function(){return!0},JE=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},ev=v.forwardRef(function(e,t){var n=e.type,s=n===void 0?"source":n,o=e.position,i=o===void 0?Ae.Top:o,c=e.isValidConnection,u=c===void 0?XE:c,d=e.isConnectable,p=d===void 0?!0:d,h=e.id,f=e.onConnect,g=e.children,w=e.className,b=e.onMouseDown,_=du(e,QE),x=rs(),N=v.useContext(lh),C=Nn(JE,qs),E=C.connectionStartHandle,j=C.connectOnClick,S=h||null,M=s==="target",T=function(A){var R=x.getState(),W=R.defaultEdgeOptions,z=R.onConnect,D=R.hasDefaultEdges,H=uh(uh({},W),A);if(D){var q=x.getState(),I=q.edges;x.setState({edges:j_(H,I)})}z==null||z(H),f==null||f(H)},P=function(A){A.button===0&&J_({event:A,handleId:S,nodeId:N,onConnect:T,isTarget:M,getState:x.getState,setState:x.setState,isValidConnection:u}),b==null||b(A)},L=function(A){var R=x.getState(),W=R.onClickConnectStart,z=R.onClickConnectStop,D=R.onClickConnectEnd,H=R.connectionMode;if(!E){W==null||W(A,{nodeId:N,handleId:S,handleType:s}),x.setState({connectionStartHandle:{nodeId:N,type:s,handleId:S}});return}var q=m_(A.target),I=ih(A,H,E.type==="target",E.nodeId,E.handleId||null,u,q),Q=I.connection,U=I.isValid;z==null||z(A),U&&T(Q),D==null||D(A),x.setState({connectionStartHandle:null})};return ve.createElement("div",uh({"data-handleid":S,"data-nodeid":N,"data-handlepos":i,className:Us(["react-flow__handle","react-flow__handle-".concat(i),"nodrag",w,{source:!M,target:M,connectable:p,connecting:(E==null?void 0:E.nodeId)===N&&(E==null?void 0:E.handleId)===S&&(E==null?void 0:E.type)===s}]),onMouseDown:P,onClick:j?L:void 0,ref:t},_),g)});ev.displayName="Handle";var Mi=v.memo(ev),tv=function(t){var n=t.data,s=t.isConnectable,o=t.targetPosition,i=o===void 0?Ae.Top:o,c=t.sourcePosition,u=c===void 0?Ae.Bottom:c;return ve.createElement(ve.Fragment,null,ve.createElement(Mi,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label,ve.createElement(Mi,{type:"source",position:u,isConnectable:s}))};tv.displayName="DefaultNode";var dh=v.memo(tv),nv=function(t){var n=t.data,s=t.isConnectable,o=t.sourcePosition,i=o===void 0?Ae.Bottom:o;return ve.createElement(ve.Fragment,null,n==null?void 0:n.label,ve.createElement(Mi,{type:"source",position:i,isConnectable:s}))};nv.displayName="InputNode";var sv=v.memo(nv),rv=function(t){var n=t.data,s=t.isConnectable,o=t.targetPosition,i=o===void 0?Ae.Top:o;return ve.createElement(ve.Fragment,null,ve.createElement(Mi,{type:"target",position:i,isConnectable:s}),n==null?void 0:n.label)};rv.displayName="OutputNode";var av=v.memo(rv),ZE=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},e1=function(t,n){var s=t.selectedNodes.map(function(u){return u.id}),o=n.selectedNodes.map(function(u){return u.id}),i=t.selectedEdges.map(function(u){return u.id}),c=n.selectedEdges.map(function(u){return u.id});return qs(s,o)&&qs(i,c)};function t1(e){var t=e.onSelectionChange,n=Nn(ZE,e1),s=n.selectedNodes,o=n.selectedEdges;return v.useEffect(function(){t({nodes:s,edges:o})},[s,o]),null}var n1=v.memo(t1),s1=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function Na(e,t){v.useEffect(function(){typeof e<"u"&&t(e)},[e])}function Wt(e,t,n){v.useEffect(function(){typeof t<"u"&&n(At({},e,t))},[t])}var r1=function(t){var n=t.nodes,s=t.edges,o=t.defaultNodes,i=t.defaultEdges,c=t.onConnect,u=t.onConnectStart,d=t.onConnectStop,p=t.onConnectEnd,h=t.onClickConnectStart,f=t.onClickConnectStop,g=t.onClickConnectEnd,w=t.nodesDraggable,b=t.nodesConnectable,_=t.minZoom,x=t.maxZoom,N=t.nodeExtent,C=t.onNodesChange,E=t.onEdgesChange,j=t.elementsSelectable,S=t.connectionMode,M=t.snapGrid,T=t.snapToGrid,P=t.translateExtent,L=t.connectOnClick,$=t.defaultEdgeOptions,A=t.fitView,R=t.fitViewOptions,W=t.onNodesDelete,z=t.onEdgesDelete,D=t.onNodeDrag,H=t.onNodeDragStart,q=t.onNodeDragStop,I=t.onSelectionDrag,Q=t.onSelectionDragStart,U=t.onSelectionDragStop,F=Nn(s1,qs),K=F.setNodes,re=F.setEdges,Y=F.setDefaultNodesAndEdges,V=F.setMinZoom,G=F.setMaxZoom,X=F.setTranslateExtent,se=F.setNodeExtent,J=F.reset,te=rs();return v.useEffect(function(){return Y(o,i),function(){J()}},[]),Wt("defaultEdgeOptions",$,te.setState),Wt("connectionMode",S,te.setState),Wt("onConnect",c,te.setState),Wt("onConnectStart",u,te.setState),Wt("onConnectStop",d,te.setState),Wt("onConnectEnd",p,te.setState),Wt("onClickConnectStart",h,te.setState),Wt("onClickConnectStop",f,te.setState),Wt("onClickConnectEnd",g,te.setState),Wt("nodesDraggable",w,te.setState),Wt("nodesConnectable",b,te.setState),Wt("elementsSelectable",j,te.setState),Wt("snapToGrid",T,te.setState),Wt("snapGrid",M,te.setState),Wt("onNodesChange",C,te.setState),Wt("onEdgesChange",E,te.setState),Wt("connectOnClick",L,te.setState),Wt("fitViewOnInit",A,te.setState),Wt("fitViewOnInitOptions",R,te.setState),Wt("onNodesDelete",W,te.setState),Wt("onEdgesDelete",z,te.setState),Wt("onNodeDrag",D,te.setState),Wt("onNodeDragStart",H,te.setState),Wt("onNodeDragStop",q,te.setState),Wt("onSelectionDrag",I,te.setState),Wt("onSelectionDragStart",Q,te.setState),Wt("onSelectionDragStop",U,te.setState),Na(n,K),Na(s,re),Na(o,K),Na(i,re),Na(_,V),Na(x,G),Na(P,X),Na(N,se),null},a1=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",o1=a1,l1=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",i1=l1,c1=function(t,n,s){return s===Ae.Left?t-n:s===Ae.Right?t+n:t},u1=function(t,n,s){return s===Ae.Top?t-n:s===Ae.Bottom?t+n:t},ov=function(t){var n=t.className,s=t.position,o=t.centerX,i=t.centerY,c=t.radius,u=c===void 0?10:c;return ve.createElement("circle",{className:Us(["react-flow__edgeupdater",n]),cx:c1(o,u,s),cy:u1(i,u,s),r:u,stroke:"transparent",fill:"transparent"})},yl=function(e){var t=function(s){var o=s.id,i=s.className,c=s.type,u=s.data,d=s.onClick,p=s.onEdgeDoubleClick,h=s.selected,f=s.animated,g=s.label,w=s.labelStyle,b=s.labelShowBg,_=s.labelBgStyle,x=s.labelBgPadding,N=s.labelBgBorderRadius,C=s.style,E=s.source,j=s.target,S=s.sourceX,M=s.sourceY,T=s.targetX,P=s.targetY,L=s.sourcePosition,$=s.targetPosition,A=s.elementsSelectable,R=s.hidden,W=s.sourceHandleId,z=s.targetHandleId,D=s.onContextMenu,H=s.onMouseEnter,q=s.onMouseMove,I=s.onMouseLeave,Q=s.edgeUpdaterRadius,U=s.onEdgeUpdate,F=s.onEdgeUpdateStart,K=s.onEdgeUpdateEnd,re=s.markerEnd,Y=s.markerStart,V=s.rfId,G=v.useState(!1),X=xt(G,2),se=X[0],J=X[1],te=rs(),Se=function(at){var ut=te.getState(),Ot=ut.edges,Rt=ut.addSelectedEdges,Xe=Ot.find(function(Bt){return Bt.id===o});A&&(te.setState({nodesSelectionActive:!1}),Rt([o])),d==null||d(at,Xe)},ze=ki(o,te.getState,p),Oe=ki(o,te.getState,D),Ue=ki(o,te.getState,H),nt=ki(o,te.getState,q),He=ki(o,te.getState,I),de=function(at,ut){var Ot=ut?j:E,Rt=(ut?z:W)||null,Xe=ut?"target":"source",Bt=function(){return!0},Kt=ut,kt=te.getState().edges.find(function(Lt){return Lt.id===o});F==null||F(at,kt,Xe);var _t=K?function(Lt){return K(Lt,kt,Xe)}:void 0,Cn=function(rn){return U==null?void 0:U(kt,rn)};J_({event:at,handleId:Rt,nodeId:Ot,onConnect:Cn,isTarget:Kt,getState:te.getState,setState:te.setState,isValidConnection:Bt,elementEdgeUpdaterType:Xe,onEdgeUpdateEnd:_t})},_e=function(at){return de(at,!0)},je=function(at){return de(at,!1)},Me=function(){return J(!0)},De=function(){return J(!1)},ce=v.useMemo(function(){return"url(#".concat(Hm(Y,V),")")},[Y,V]),Te=v.useMemo(function(){return"url(#".concat(Hm(re,V),")")},[re,V]);if(R)return null;var Qe=!A&&!d,ht=typeof U<"u",rt=Us(["react-flow__edge","react-flow__edge-".concat(c),i,{selected:h,animated:f,inactive:Qe,updating:se}]);return ve.createElement("g",{className:rt,onClick:Se,onDoubleClick:ze,onContextMenu:Oe,onMouseEnter:Ue,onMouseMove:nt,onMouseLeave:He},ve.createElement(e,{id:o,source:E,target:j,selected:h,animated:f,label:g,labelStyle:w,labelShowBg:b,labelBgStyle:_,labelBgPadding:x,labelBgBorderRadius:N,data:u,style:C,sourceX:S,sourceY:M,targetX:T,targetY:P,sourcePosition:L,targetPosition:$,sourceHandleId:W,targetHandleId:z,markerStart:ce,markerEnd:Te,"data-testid":"rf__edge-".concat(o)}),ht&&ve.createElement("g",{onMouseDown:_e,onMouseEnter:Me,onMouseOut:De},ve.createElement(ov,{position:L,centerX:S,centerY:M,radius:Q})),ht&&ve.createElement("g",{onMouseDown:je,onMouseEnter:Me,onMouseOut:De},ve.createElement(ov,{position:$,centerX:T,centerY:P,radius:Q})))};return t.displayName="EdgeWrapper",v.memo(t)};function lv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function iv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lv(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function d1(e){var t={default:yl(e.default||oh),straight:yl(e.bezier||Q_),step:yl(e.step||G_),smoothstep:yl(e.step||ah),simplebezier:yl(e.simplebezier||q_)},n={},s=Object.keys(e).filter(function(o){return!["default","bezier"].includes(o)}).reduce(function(o,i){return o[i]=yl(e[i]||oh),o},n);return iv(iv({},t),s)}function cv(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=((n==null?void 0:n.x)||0)+t.x,o=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,c=(n==null?void 0:n.height)||t.height;switch(e){case Ae.Top:return{x:s+i/2,y:o};case Ae.Right:return{x:s+i,y:o+c/2};case Ae.Bottom:return{x:s+i/2,y:o+c};case Ae.Left:return{x:s,y:o+c/2}}}function uv(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(s){return s.id===t})),typeof n>"u"?null:n}var m1=function(t,n,s,o,i,c){var u=cv(s,t,n),d=cv(c,o,i);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y}};function h1(e){var t=e.sourcePos,n=e.targetPos,s=e.sourceWidth,o=e.sourceHeight,i=e.targetWidth,c=e.targetHeight,u=e.width,d=e.height,p=e.transform,h={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+s,n.x+i),y2:Math.max(t.y+o,n.y+c)};h.x===h.x2&&(h.x2+=1),h.y===h.y2&&(h.y2+=1);var f=cu({x:(0-p[0])/p[2],y:(0-p[1])/p[2],width:u/p[2],height:d/p[2]}),g=Math.max(0,Math.min(f.x2,h.x2)-Math.max(f.x,h.x)),w=Math.max(0,Math.min(f.y2,h.y2)-Math.max(f.y,h.y)),b=Math.ceil(g*w);return b>0}function dv(e,t){var n,s,o,i,c,u=e.get(t),d=(u==null||(n=u[Kn])===null||n===void 0?void 0:n.handleBounds)||null,p=!u||!d||!u.width||!u.height||typeof((s=u.positionAbsolute)===null||s===void 0?void 0:s.x)>"u"||typeof((o=u.positionAbsolute)===null||o===void 0?void 0:o.y)>"u";return[{x:(u==null||(i=u.positionAbsolute)===null||i===void 0?void 0:i.x)||0,y:(u==null||(c=u.positionAbsolute)===null||c===void 0?void 0:c.y)||0,width:(u==null?void 0:u.width)||0,height:(u==null?void 0:u.height)||0},d,!p]}var f1=typeof document<"u"?document:null,vu=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:f1},n=v.useState(!1),s=xt(n,2),o=s[0],i=s[1],c=v.useRef(new Set([])),u=v.useMemo(function(){if(e!==null){var f=Array.isArray(e)?e:[e],g=f.filter(function(b){return typeof b=="string"}).map(function(b){return b.split("+")}),w=g.reduce(function(b,_){return b.concat.apply(b,bo(_))},[]);return[g,w]}return[[],[]]},[e]),d=xt(u,2),p=d[0],h=d[1];return v.useEffect(function(){if(e!==null){var f,g,w=function(N){if(fv(N))return!1;var C=hv(N.code,h);c.current.add(N[C]),mv(p,c.current,!1)&&(N.preventDefault(),i(!0))},b=function(N){if(fv(N))return!1;var C=hv(N.code,h);mv(p,c.current,!0)?(i(!1),c.current.clear()):c.current.delete(N[C])},_=function(){c.current.clear(),i(!1)};return t==null||(f=t.target)===null||f===void 0||f.addEventListener("keydown",w),t==null||(g=t.target)===null||g===void 0||g.addEventListener("keyup",b),window.addEventListener("blur",_),function(){var x,N;t==null||(x=t.target)===null||x===void 0||x.removeEventListener("keydown",w),t==null||(N=t.target)===null||N===void 0||N.removeEventListener("keyup",b),window.removeEventListener("blur",_)}}},[e,i]),o};function mv(e,t,n){return e.filter(function(s){return n||s.length===t.size}).some(function(s){return s.every(function(o){return t.has(o)})})}function hv(e,t){return t.includes(e)?"code":"key"}function fv(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var p1=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},g1=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,s=rs(),o=Nn(p1,qs),i=o.onNodesChange,c=o.onEdgesChange,u=vu(t),d=vu(n);v.useEffect(function(){var p=s.getState(),h=p.nodeInternals,f=p.edges,g=p.hasDefaultNodes,w=p.hasDefaultEdges,b=p.onNodesDelete,_=p.onEdgesDelete,x=Array.from(h.values()),N=x.reduce(function(P,L){return(!L.selected&&L.parentNode&&P.find(function($){return $.id===L.parentNode})||L.selected)&&P.push(L),P},[]),C=f.filter(function(P){return P.selected});if(u&&(N||C)){var E=S_(N,f),j=[].concat(bo(C),bo(E)),S=j.reduce(function(P,L){return P.includes(L.id)||P.push(L.id),P},[]);if((w||g)&&(w&&s.setState({edges:f.filter(function(P){return!S.includes(P.id)})}),g&&(N.forEach(function(P){h.delete(P.id)}),s.setState({nodeInternals:new Map(h)}))),S.length>0&&(_==null||_(j),c)){var M=S.map(function(P){return{id:P,type:"remove"}});c(M)}if(N.length>0&&(b==null||b(N),i)){var T=N.map(function(P){return{id:P.id,type:"remove"}});i(T)}s.setState({nodesSelectionActive:!1})}},[u,i,c]),v.useEffect(function(){s.setState({multiSelectionActive:d})},[d])};function _1(e){var t=rs();v.useEffect(function(){var n,s=function(){if(e.current){var i=qm(e.current);t.setState({width:i.width||500,height:i.height||500})}};return s(),window.onresize=s,e.current&&(n=new ResizeObserver(function(){return s()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var v1=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},mh=function(t){return{x:t.x,y:t.y,zoom:t.k}},yu=function(t,n){return t.target.closest(".".concat(n))},y1=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},b1=function(t){var n=t.onMove,s=t.onMoveStart,o=t.onMoveEnd,i=t.zoomOnScroll,c=i===void 0?!0:i,u=t.zoomOnPinch,d=u===void 0?!0:u,p=t.panOnScroll,h=p===void 0?!1:p,f=t.panOnScrollSpeed,g=f===void 0?.5:f,w=t.panOnScrollMode,b=w===void 0?fl.Free:w,_=t.zoomOnDoubleClick,x=_===void 0?!0:_,N=t.selectionKeyPressed,C=t.elementsSelectable,E=t.panOnDrag,j=E===void 0?!0:E,S=t.translateExtent,M=t.minZoom,T=t.maxZoom,P=t.defaultZoom,L=P===void 0?1:P,$=t.defaultPosition,A=$===void 0?[0,0]:$,R=t.zoomActivationKeyCode,W=t.preventScrolling,z=W===void 0?!0:W,D=t.children,H=t.noWheelClassName,q=t.noPanClassName,I=rs(),Q=v.useRef(!1),U=v.useRef(null),F=v.useRef({x:0,y:0,zoom:0}),K=Nn(y1,qs),re=K.d3Zoom,Y=K.d3Selection,V=K.d3ZoomHandler,G=vu(R);return _1(U),v.useEffect(function(){if(U.current){var X,se=aE().scaleExtent([M,T]).translateExtent(S),J=dr(U.current).call(se),te=pl(A[0],S[0][0],S[1][0]),Se=pl(A[1],S[0][1],S[1][1]),ze=pl(L,M,T),Oe=_o.translate(te,Se).scale(ze);se.transform(J,Oe),I.setState({d3Zoom:se,d3Selection:J,d3ZoomHandler:J.on("wheel.zoom"),transform:[te,Se,ze],domNode:(X=J.node())===null||X===void 0?void 0:X.closest(".react-flow")})}},[]),v.useEffect(function(){Y&&re&&(h&&!G?Y.on("wheel",function(X){if(yu(X,H))return!1;X.preventDefault(),X.stopImmediatePropagation();var se=Y.property("__zoom").k||1;if(X.ctrlKey&&d){var J=Cr(X),te=-X.deltaY*(X.deltaMode===1?.05:X.deltaMode?1:.002)*10,Se=se*Math.pow(2,te);re.scaleTo(Y,Se,J);return}var ze=X.deltaMode===1?20:1,Oe=b===fl.Vertical?0:X.deltaX*ze,Ue=b===fl.Horizontal?0:X.deltaY*ze;re.translateBy(Y,-(Oe/se)*g,-(Ue/se)*g)}).on("wheel.zoom",null):typeof V<"u"&&Y.on("wheel",function(X){if(!z||yu(X,H))return null;X.preventDefault()}).on("wheel.zoom",V))},[h,b,Y,re,V,G,d,z,H]),v.useEffect(function(){re&&(N&&!Q.current?re.on("zoom",null):N||re.on("zoom",function(X){if(I.setState({transform:[X.transform.x,X.transform.y,X.transform.k]}),n){var se=mh(X.transform);n(X.sourceEvent,se)}}))},[N,re,n]),v.useEffect(function(){re&&re.on("start",function(X){if(Q.current=!0,s){var se=mh(X.transform);F.current=se,s(X.sourceEvent,se)}})},[re,s]),v.useEffect(function(){re&&re.on("end",function(X){if(Q.current=!1,o&&v1(F.current,X.transform)){var se=mh(X.transform);F.current=se,o(X.sourceEvent,se)}})},[re,o]),v.useEffect(function(){re&&re.filter(function(X){var se=G||c,J=d&&X.ctrlKey;return!j&&!se&&!h&&!x&&!d||N||!x&&X.type==="dblclick"||yu(X,H)&&X.type==="wheel"||yu(X,q)&&X.type!=="wheel"||!d&&X.ctrlKey&&X.type==="wheel"||!se&&!h&&!J&&X.type==="wheel"||!j&&(X.type==="mousedown"||X.type==="touchstart")?!1:(!X.ctrlKey||X.type==="wheel")&&!X.button})},[re,c,d,h,x,j,N,C,G]),ve.createElement("div",{className:"react-flow__renderer react-flow__container",ref:U},D)};function pv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function gv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pv(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function _v(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var x1=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},vv={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},w1=v.memo(function(e){var t=e.selectionKeyPressed,n=rs(),s=v.useRef(0),o=v.useRef(0),i=v.useRef(),c=v.useState(vv),u=xt(c,2),d=u[0],p=u[1],h=Nn(x1,qs),f=h.userSelectionActive,g=h.elementsSelectable,w=f||t;if(!g||!w)return null;var b=function(){p(vv),n.setState({userSelectionActive:!1}),s.current=0,o.current=0},_=function(j){var S=j.target.closest(".react-flow");i.current=S.getBoundingClientRect();var M=_v(j,i.current);p({width:0,height:0,startX:M.x,startY:M.y,x:M.x,y:M.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},x=function(j){var S,M;if(!(!t||!d.draw||!i.current)){var T=_v(j,i.current),P=(S=d.startX)!==null&&S!==void 0?S:0,L=(M=d.startY)!==null&&M!==void 0?M:0,$=gv(gv({},d),{},{x:T.x<P?T.x:P,y:T.y<L?T.y:L,width:Math.abs(T.x-P),height:Math.abs(T.y-L)}),A=n.getState(),R=A.nodeInternals,W=A.edges,z=A.transform,D=A.onNodesChange,H=A.onEdgesChange,q=Array.from(R.values()),I=C_(R,$,z,!1,!0),Q=S_(I,W).map(function(re){return re.id}),U=I.map(function(re){return re.id});if(s.current!==U.length){s.current=U.length;var F=gl(q,U);F.length&&(D==null||D(F))}if(o.current!==Q.length){o.current=Q.length;var K=gl(W,Q);K.length&&(H==null||H(K))}p($)}},N=function(){n.setState({nodesSelectionActive:s.current>0}),b()},C=function(){n.setState({nodesSelectionActive:!1}),b()};return ve.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:_,onMouseMove:x,onMouseUp:N,onMouseLeave:C},d.draw&&ve.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:d.width,height:d.height,transform:"translate(".concat(d.x,"px, ").concat(d.y,"px)")}}))});function yv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function bv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yv(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xv(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:xv(n,t):!1}function wv(e,t,n){var s=e;do{var o;if((o=s)!==null&&o!==void 0&&o.matches(t))return!0;if(s===n.current)return!1;s=s.parentElement}while(s);return!1}function j1(e,t,n){return Array.from(e.values()).filter(function(s){return(s.selected||s.id===n)&&(!s.parentNode||!xv(s,e))}).map(function(s){var o,i,c,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:t.x-((o=(i=s.positionAbsolute)===null||i===void 0?void 0:i.x)!==null&&o!==void 0?o:0),y:t.y-((c=(u=s.positionAbsolute)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function N1(e,t,n,s,o,i){var c=xt(s,2),u=c[0],d=c[1],p=e.extent||i,h={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(h.x=u*Math.round(h.x/u),h.y=d*Math.round(h.y/d)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var f=o.get(e.parentNode);p=f!=null&&f.positionAbsolute&&f!==null&&f!==void 0&&f.width&&f!==null&&f!==void 0&&f.height?[[f.positionAbsolute.x,f.positionAbsolute.y],[f.positionAbsolute.x+f.width-e.width,f.positionAbsolute.y+f.height-e.height]]:p}else p=i;else if(e.extent&&e.parentNode){var g,w,b,_,x=o.get(e.parentNode),N=(g=x==null||(w=x.positionAbsolute)===null||w===void 0?void 0:w.x)!==null&&g!==void 0?g:0,C=(b=x==null||(_=x.positionAbsolute)===null||_===void 0?void 0:_.y)!==null&&b!==void 0?b:0;p=[[e.extent[0][0]+N,e.extent[0][1]+C],[e.extent[1][0]+N,e.extent[1][1]+C]]}var E={x:0,y:0};if(e.parentNode){var j,S,M,T,P=o.get(e.parentNode);E={x:(j=P==null||(S=P.positionAbsolute)===null||S===void 0?void 0:S.x)!==null&&j!==void 0?j:0,y:(M=P==null||(T=P.positionAbsolute)===null||T===void 0?void 0:T.y)!==null&&M!==void 0?M:0}}return e.positionAbsolute=p?d_(h,p):h,e.position={x:e.positionAbsolute.x-E.x,y:e.positionAbsolute.y-E.y},e}function hh(e){var t=e.nodeId,n=e.dragItems,s=e.nodeInternals,o=n.map(function(i){var c=s.get(i.id);return bv(bv({},c),{},{position:i.position,positionAbsolute:i.positionAbsolute})});return[t?o.find(function(i){return i.id===t}):o[0],o]}function fh(e){return function(t,n,s){return e==null?void 0:e(t,s)}}function jv(e){var t=e.nodeRef,n=e.disabled,s=n===void 0?!1:n,o=e.noDragClassName,i=e.handleSelector,c=e.nodeId,u=e.isSelectable,d=e.selectNodesOnDrag,p=v.useState(!1),h=xt(p,2),f=h[0],g=h[1],w=rs(),b=v.useRef(),_=v.useRef({x:null,y:null}),x=v.useCallback(function(N){var C=N.sourceEvent,E=w.getState(),j=E.transform,S=E.snapGrid,M=E.snapToGrid,T=C.touches?C.touches[0].clientX:C.clientX,P=C.touches?C.touches[0].clientY:C.clientY,L=N_({x:T,y:P},j,M,S);return L},[]);return v.useEffect(function(){if(t!=null&&t.current){var N=dr(t.current);if(s)N.on(".drag",null);else{var C=pC().on("start",function(E){var j=w.getState(),S=j.nodeInternals,M=j.multiSelectionActive,T=j.unselectNodesAndEdges,P=j.onNodeDragStart,L=j.onSelectionDragStart,$=c?P:fh(L);if(!d&&!M&&c){var A;(A=S.get(c))!==null&&A!==void 0&&A.selected||T()}c&&u&&d&&x_({id:c,store:w});var R=x(E);if(_.current=R,b.current=j1(S,R,c),$&&b.current){var W=hh({nodeId:c,dragItems:b.current,nodeInternals:S}),z=xt(W,2),D=z[0],H=z[1];$(E.sourceEvent,D,H)}}).on("drag",function(E){var j=w.getState(),S=j.updateNodePositions,M=j.snapToGrid,T=j.snapGrid,P=j.nodeInternals,L=j.nodeExtent,$=j.onNodeDrag,A=j.onSelectionDrag,R=x(E);if((_.current.x!==R.x||_.current.y!==R.y)&&b.current){_.current=R,b.current=b.current.map(function(I){return N1(I,R,M,T,P,L)});var W=c?$:fh(A);if(S(b.current,!0,!0),g(!0),W){var z=hh({nodeId:c,dragItems:b.current,nodeInternals:P}),D=xt(z,2),H=D[0],q=D[1];W(E.sourceEvent,H,q)}}E.on("end",function(I){if(g(!1),b.current){var Q=w.getState(),U=Q.updateNodePositions,F=Q.nodeInternals,K=Q.onNodeDragStop,re=Q.onSelectionDragStop,Y=c?K:fh(re);if(U(b.current,!1,!1),Y){var V=hh({nodeId:c,dragItems:b.current,nodeInternals:F}),G=xt(V,2),X=G[0],se=G[1];Y(I.sourceEvent,X,se)}}})}).filter(function(E){var j=E.target,S=!E.button&&(!o||!wv(j,".".concat(o),t))&&(!i||wv(j,i,t));return S});return N.call(C),function(){N.on(".drag",null)}}}},[t,s,o,i,u,w,c,d,x]),f}function Nv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function C1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nv(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var S1=function(t){return C1({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},Vm(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},E1=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(s){return s.selected});return Vm(n)};function k1(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,s=rs(),o=Nn(S1,qs),i=o.transformString,c=o.userSelectionActive,u=Nn(E1,qs),d=u.width,p=u.height,h=u.x,f=u.y,g=v.useRef(null);if(jv({nodeRef:g}),c||!d||!p)return null;var w=t?function(b){var _=Array.from(s.getState().nodeInternals.values()).filter(function(x){return x.selected});t(b,_)}:void 0;return ve.createElement("div",{className:Us(["react-flow__nodesselection","react-flow__container",n]),style:{transform:i}},ve.createElement("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:w,style:{width:d,height:p,top:f,left:h}}))}var M1=v.memo(k1),A1=function(t){return t.nodesSelectionActive},Cv=function(t){var n=t.children,s=t.onPaneClick,o=t.onPaneContextMenu,i=t.onPaneScroll,c=t.deleteKeyCode,u=t.onMove,d=t.onMoveStart,p=t.onMoveEnd,h=t.selectionKeyCode,f=t.multiSelectionKeyCode,g=t.zoomActivationKeyCode,w=t.elementsSelectable,b=t.zoomOnScroll,_=t.zoomOnPinch,x=t.panOnScroll,N=t.panOnScrollSpeed,C=t.panOnScrollMode,E=t.zoomOnDoubleClick,j=t.panOnDrag,S=t.translateExtent,M=t.minZoom,T=t.maxZoom,P=t.defaultZoom,L=t.defaultPosition,$=t.preventScrolling,A=t.onSelectionContextMenu,R=t.noWheelClassName,W=t.noPanClassName,z=rs(),D=Nn(A1),H=vu(h);g1({deleteKeyCode:c,multiSelectionKeyCode:f});var q=function(F){s==null||s(F),z.getState().resetSelectedElements(),z.setState({nodesSelectionActive:!1})},I=o?function(U){return o(U)}:void 0,Q=i?function(U){return i(U)}:void 0;return ve.createElement(b1,{onMove:u,onMoveStart:d,onMoveEnd:p,selectionKeyPressed:H,elementsSelectable:w,zoomOnScroll:b,zoomOnPinch:_,panOnScroll:x,panOnScrollSpeed:N,panOnScrollMode:C,zoomOnDoubleClick:E,panOnDrag:j,translateExtent:S,minZoom:M,maxZoom:T,defaultZoom:P,defaultPosition:L,zoomActivationKeyCode:g,preventScrolling:$,noWheelClassName:R,noPanClassName:W},n,ve.createElement(w1,{selectionKeyPressed:H}),D&&ve.createElement(M1,{onSelectionContextMenu:A,noPanClassName:W}),ve.createElement("div",{className:"react-flow__pane react-flow__container",onClick:q,onContextMenu:I,onWheel:Q}))};Cv.displayName="FlowRenderer";var O1=v.memo(Cv);function T1(e){var t=Nn(v.useCallback(function(n){return e?C_(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var $1=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},Sv=function(t){var n=Nn($1,qs),s=n.nodesDraggable,o=n.nodesConnectable,i=n.elementsSelectable,c=n.updateNodeDimensions,u=T1(t.onlyRenderVisibleElements),d=v.useRef(),p=v.useMemo(function(){if(typeof ResizeObserver>"u")return null;var h=new ResizeObserver(function(f){var g=f.map(function(w){return{id:w.target.getAttribute("data-id"),nodeElement:w.target,forceUpdate:!0}});c(g)});return d.current=h,h},[]);return v.useEffect(function(){return function(){var h;d==null||(h=d.current)===null||h===void 0||h.disconnect()}},[]),ve.createElement("div",{className:"react-flow__nodes react-flow__container"},u.map(function(h){var f,g,w,b,_,x,N,C=h.type||"default";t.nodeTypes[C]||(C="default");var E=t.nodeTypes[C]||t.nodeTypes.default,j=!!(h.draggable||s&&typeof h.draggable>"u"),S=!!(h.selectable||i&&typeof h.selectable>"u"),M=!!(h.connectable||o&&typeof h.connectable>"u");return ve.createElement(E,{key:h.id,id:h.id,className:h.className,style:h.style,type:C,data:h.data,sourcePosition:h.sourcePosition||Ae.Bottom,targetPosition:h.targetPosition||Ae.Top,hidden:h.hidden,xPos:(f=(g=h.positionAbsolute)===null||g===void 0?void 0:g.x)!==null&&f!==void 0?f:0,yPos:(w=(b=h.positionAbsolute)===null||b===void 0?void 0:b.y)!==null&&w!==void 0?w:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!h.selected,isDraggable:j,isSelectable:S,isConnectable:M,resizeObserver:p,dragHandle:h.dragHandle,zIndex:(_=(x=h[Kn])===null||x===void 0?void 0:x.z)!==null&&_!==void 0?_:0,isParent:!!((N=h[Kn])!==null&&N!==void 0&&N.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!h.width&&!!h.height})}))};Sv.displayName="NodeRenderer";var P1=v.memo(Sv),bl;function Ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function kv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ev(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ev(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var L1=(bl={},At(bl,Ae.Left,Ae.Right),At(bl,Ae.Right,Ae.Left),At(bl,Ae.Top,Ae.Bottom),At(bl,Ae.Bottom,Ae.Top),bl),z1=function(e){var t,n,s,o,i,c=e.connectionNodeId,u=e.connectionHandleType,d=e.connectionLineStyle,p=e.connectionLineType,h=p===void 0?wa.Bezier:p,f=e.isConnectable,g=e.CustomConnectionLineComponent,w=Nn(v.useCallback(function(Q){return{fromNode:Q.nodeInternals.get(c),handleId:Q.connectionHandleId,toX:(Q.connectionPosition.x-Q.transform[0])/Q.transform[2],toY:(Q.connectionPosition.y-Q.transform[1])/Q.transform[2]}},[c]),qs),b=w.fromNode,_=w.handleId,x=w.toX,N=w.toY,C=b==null||(t=b[Kn])===null||t===void 0?void 0:t.handleBounds;if(!b||!f||!(C!=null&&C[u]))return null;var E=C[u],j=_?E.find(function(Q){return Q.id===_}):E[0],S=j?j.x+j.width/2:((n=b==null?void 0:b.width)!==null&&n!==void 0?n:0)/2,M=j?j.y+j.height/2:(s=b==null?void 0:b.height)!==null&&s!==void 0?s:0,T=((b==null||(o=b.positionAbsolute)===null||o===void 0?void 0:o.x)||0)+S,P=((b==null||(i=b.positionAbsolute)===null||i===void 0?void 0:i.y)||0)+M,L=j==null?void 0:j.position;if(!L)return null;var $=L1[L],A,R,W,z,D,H;switch(u){case"source":A=T,R=P,W=L,z=x,D=N,H=$;break;case"target":A=x,R=N,W=$,z=T,D=P,H=L;break}if(g)return ve.createElement("g",{className:"react-flow__connection"},ve.createElement(g,{connectionLineType:h,connectionLineStyle:d,fromNode:b,fromHandle:j,fromX:T,fromY:P,toX:x,toY:N,fromPosition:L,toPosition:$,sourcePosition:W,targetPosition:H,sourceNode:b,sourceHandle:j,targetX:z,targetY:D,sourceX:A,sourceY:R}));var q="",I={sourceX:A,sourceY:R,sourcePosition:W,targetX:z,targetY:D,targetPosition:H};return h===wa.Bezier?q=X_(I):h===wa.Step?q=rh(kv(kv({},I),{},{borderRadius:0})):h===wa.SmoothStep?q=rh(I):h===wa.SimpleBezier?q=U_(I):q="M".concat(A,",").concat(R," ").concat(z,",").concat(D),ve.createElement("g",{className:"react-flow__connection"},ve.createElement("path",{d:q,className:"react-flow__connection-path",style:d}))};function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}var bu,R1=function(t){var n=t.color,s=n===void 0?"none":n,o=t.strokeWidth,i=o===void 0?1:o;return ve.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:"none",points:"-5,-4 0,0 -5,4"})},D1=function(t){var n=t.color,s=n===void 0?"none":n,o=t.strokeWidth,i=o===void 0?1:o;return ve.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:s,points:"-5,-4 0,0 -5,4 -5,-4"})},Mv=(bu={},At(bu,iu.Arrow,R1),At(bu,iu.ArrowClosed,D1),bu);function F1(e){var t=v.useMemo(function(){var n=Mv.hasOwnProperty(e);return n?Mv[e]:function(){return null}},[e]);return t}function Av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function I1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Av(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Av(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var B1=function(t){var n=t.id,s=t.type,o=t.color,i=t.width,c=i===void 0?12.5:i,u=t.height,d=u===void 0?12.5:u,p=t.markerUnits,h=p===void 0?"strokeWidth":p,f=t.strokeWidth,g=t.orient,w=g===void 0?"auto":g,b=F1(s);return ve.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(c),markerHeight:"".concat(d),viewBox:"-10 -10 20 20",markerUnits:h,orient:w,refX:"0",refY:"0"},ve.createElement(b,{color:o,strokeWidth:f}))},U1=function(t){var n=t.defaultColor,s=t.rfId;return function(o){var i=[];return o.edges.reduce(function(c,u){return[u.markerStart,u.markerEnd].forEach(function(d){if(d&&ph(d)==="object"){var p=Hm(d,s);i.includes(p)||(c.push(I1({id:p,color:d.color||n},d)),i.push(p))}}),c},[]).sort(function(c,u){return c.id.localeCompare(u.id)})}},Ov=function(t){var n=t.defaultColor,s=t.rfId,o=Nn(v.useCallback(U1({defaultColor:n,rfId:s}),[n,s]),function(i,c){return!(i.length!==c.length||i.some(function(u,d){return u.id!==c[d].id}))});return ve.createElement("defs",null,o.map(function(i){return ve.createElement(B1,{id:i.id,key:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient})}))};Ov.displayName="MarkerDefinitions";var q1=v.memo(Ov),H1=[{level:0,isMaxLevel:!0,edges:[]}];function V1(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=-1,o=e.reduce(function(c,u){var d=h_(u.zIndex),p=d?u.zIndex:0;if(n){var h,f,g,w;p=d?u.zIndex:Math.max(((h=t.get(u.source))===null||h===void 0||(f=h[Kn])===null||f===void 0?void 0:f.z)||0,((g=t.get(u.target))===null||g===void 0||(w=g[Kn])===null||w===void 0?void 0:w.z)||0)}return c[p]?c[p].push(u):c[p]=[u],s=p>s?p:s,c},{}),i=Object.entries(o).map(function(c){var u=xt(c,2),d=u[0],p=u[1],h=+d;return{edges:p,level:h,isMaxLevel:h===s}});return i.length===0?H1:i}function W1(e,t,n){var s=Nn(v.useCallback(function(o){return e?o.edges.filter(function(i){var c=t.get(i.source),u=t.get(i.target);return(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&h1({sourcePos:c.positionAbsolute||{x:0,y:0},targetPos:u.positionAbsolute||{x:0,y:0},sourceWidth:c.width,sourceHeight:c.height,targetWidth:u.width,targetHeight:u.height,width:o.width,height:o.height,transform:o.transform})}):o.edges},[e,t]));return V1(s,t,n)}var K1=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},Tv=function(t){var n=Nn(K1,qs),s=n.connectionNodeId,o=n.connectionHandleType,i=n.nodesConnectable,c=n.elementsSelectable,u=n.width,d=n.height,p=n.connectionMode,h=n.nodeInternals,f=W1(t.onlyRenderVisibleElements,h,t.elevateEdgesOnSelect);if(!u)return null;var g=t.connectionLineType,w=t.defaultMarkerColor,b=t.connectionLineStyle,_=t.connectionLineComponent,x=t.connectionLineContainerStyle,N=s&&o;return ve.createElement(ve.Fragment,null,f.map(function(C){var E=C.level,j=C.edges,S=C.isMaxLevel;return ve.createElement("svg",{key:E,style:{zIndex:E},width:u,height:d,className:"react-flow__edges react-flow__container"},S&&ve.createElement(q1,{defaultColor:w,rfId:t.rfId}),ve.createElement("g",null,j.map(function(M){var T=dv(h,M.source),P=xt(T,3),L=P[0],$=P[1],A=P[2],R=dv(h,M.target),W=xt(R,3),z=W[0],D=W[1],H=W[2];if(!A||!H)return null;var q=M.type||"default";t.edgeTypes[q]||(console.warn('[React Flow]: Edge type "'.concat(q,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),q="default");var I=t.edgeTypes[q]||t.edgeTypes.default,Q=p===vo.Strict?D.target:D.target||D.source,U=uv($.source,M.sourceHandle||null),F=uv(Q,M.targetHandle||null),K=(U==null?void 0:U.position)||Ae.Bottom,re=(F==null?void 0:F.position)||Ae.Top;if(!U||!F)return null;var Y=m1(L,U,K,z,F,re),V=Y.sourceX,G=Y.sourceY,X=Y.targetX,se=Y.targetY;return ve.createElement(I,{key:M.id,id:M.id,className:Us([M.className,t.noPanClassName]),type:q,data:M.data,selected:!!M.selected,animated:!!M.animated,hidden:!!M.hidden,label:M.label,labelStyle:M.labelStyle,labelShowBg:M.labelShowBg,labelBgStyle:M.labelBgStyle,labelBgPadding:M.labelBgPadding,labelBgBorderRadius:M.labelBgBorderRadius,style:M.style,source:M.source,target:M.target,sourceHandleId:M.sourceHandle,targetHandleId:M.targetHandle,markerEnd:M.markerEnd,markerStart:M.markerStart,sourceX:V,sourceY:G,targetX:X,targetY:se,sourcePosition:K,targetPosition:re,elementsSelectable:c,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),N&&ve.createElement("svg",{style:x,width:u,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},ve.createElement(z1,{connectionNodeId:s,connectionHandleType:o,connectionLineStyle:b,connectionLineType:g,isConnectable:i,CustomConnectionLineComponent:_})))};Tv.displayName="EdgeRenderer";var Y1=v.memo(Tv),G1=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function Q1(e){var t=e.children,n=Nn(G1);return ve.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function X1(e){var t=Gm(),n=v.useRef(!1);v.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var $v=function(t){var n=t.nodeTypes,s=t.edgeTypes,o=t.onMove,i=t.onMoveStart,c=t.onMoveEnd,u=t.onInit,d=t.onNodeClick,p=t.onEdgeClick,h=t.onNodeDoubleClick,f=t.onEdgeDoubleClick,g=t.onNodeMouseEnter,w=t.onNodeMouseMove,b=t.onNodeMouseLeave,_=t.onNodeContextMenu,x=t.onSelectionContextMenu,N=t.connectionLineType,C=t.connectionLineStyle,E=t.connectionLineComponent,j=t.connectionLineContainerStyle,S=t.selectionKeyCode,M=t.multiSelectionKeyCode,T=t.zoomActivationKeyCode,P=t.deleteKeyCode,L=t.onlyRenderVisibleElements,$=t.elementsSelectable,A=t.selectNodesOnDrag,R=t.translateExtent,W=t.minZoom,z=t.maxZoom,D=t.defaultZoom,H=t.defaultPosition,q=t.preventScrolling,I=t.defaultMarkerColor,Q=t.zoomOnScroll,U=t.zoomOnPinch,F=t.panOnScroll,K=t.panOnScrollSpeed,re=t.panOnScrollMode,Y=t.zoomOnDoubleClick,V=t.panOnDrag,G=t.onPaneClick,X=t.onPaneScroll,se=t.onPaneContextMenu,J=t.onEdgeUpdate,te=t.onEdgeContextMenu,Se=t.onEdgeMouseEnter,ze=t.onEdgeMouseMove,Oe=t.onEdgeMouseLeave,Ue=t.edgeUpdaterRadius,nt=t.onEdgeUpdateStart,He=t.onEdgeUpdateEnd,de=t.noDragClassName,_e=t.noWheelClassName,je=t.noPanClassName,Me=t.elevateEdgesOnSelect,De=t.id;return X1(u),ve.createElement(O1,{onPaneClick:G,onPaneContextMenu:se,onPaneScroll:X,deleteKeyCode:P,selectionKeyCode:S,multiSelectionKeyCode:M,zoomActivationKeyCode:T,elementsSelectable:$,onMove:o,onMoveStart:i,onMoveEnd:c,zoomOnScroll:Q,zoomOnPinch:U,zoomOnDoubleClick:Y,panOnScroll:F,panOnScrollSpeed:K,panOnScrollMode:re,panOnDrag:V,translateExtent:R,minZoom:W,maxZoom:z,defaultZoom:D,defaultPosition:H,onSelectionContextMenu:x,preventScrolling:q,noDragClassName:de,noWheelClassName:_e,noPanClassName:je},ve.createElement(Q1,null,ve.createElement(Y1,{edgeTypes:s,onEdgeClick:p,onEdgeDoubleClick:f,connectionLineType:N,connectionLineStyle:C,connectionLineComponent:E,connectionLineContainerStyle:j,onEdgeUpdate:J,onlyRenderVisibleElements:L,onEdgeContextMenu:te,onEdgeMouseEnter:Se,onEdgeMouseMove:ze,onEdgeMouseLeave:Oe,onEdgeUpdateStart:nt,onEdgeUpdateEnd:He,edgeUpdaterRadius:Ue,defaultMarkerColor:I,noPanClassName:je,elevateEdgesOnSelect:!!Me,rfId:De}),ve.createElement(P1,{nodeTypes:n,onNodeClick:d,onNodeDoubleClick:h,onNodeMouseEnter:g,onNodeMouseMove:w,onNodeMouseLeave:b,onNodeContextMenu:_,selectNodesOnDrag:A,onlyRenderVisibleElements:L,noPanClassName:je,noDragClassName:de})))};$v.displayName="GraphView";var J1=v.memo($v),Pv=function(){return null};Pv.displayName="GroupNode";function Lv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function zv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lv(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Ai=function(e){var t=function(s){var o=s.id,i=s.type,c=s.data,u=s.xPos,d=s.yPos,p=s.selected,h=s.onClick,f=s.onMouseEnter,g=s.onMouseMove,w=s.onMouseLeave,b=s.onContextMenu,_=s.onDoubleClick,x=s.style,N=s.className,C=s.isDraggable,E=s.isSelectable,j=s.isConnectable,S=s.selectNodesOnDrag,M=s.sourcePosition,T=s.targetPosition,P=s.hidden,L=s.resizeObserver,$=s.dragHandle,A=s.zIndex,R=s.isParent,W=s.noPanClassName,z=s.noDragClassName,D=s.initialized,H=rs(),q=v.useRef(null),I=v.useRef(M),Q=v.useRef(T),U=v.useRef(i),F=E||C||h||f||g||w,K=Si(o,H.getState,f),re=Si(o,H.getState,g),Y=Si(o,H.getState,w),V=Si(o,H.getState,b),G=Si(o,H.getState,_),X=function(te){if(E&&(!S||!C)&&x_({id:o,store:H}),h){var Se=H.getState().nodeInternals.get(o);h(te,zv({},Se))}};v.useEffect(function(){if(q.current&&!P){var J=q.current;return L==null||L.observe(J),function(){return L==null?void 0:L.unobserve(J)}}},[P]),v.useEffect(function(){var J=U.current!==i,te=I.current!==M,Se=Q.current!==T;q.current&&(J||te||Se)&&(J&&(U.current=i),te&&(I.current=M),Se&&(Q.current=T),H.getState().updateNodeDimensions([{id:o,nodeElement:q.current,forceUpdate:!0}]))},[o,i,M,T]);var se=jv({nodeRef:q,disabled:P||!C,noDragClassName:z,handleSelector:$,nodeId:o,isSelectable:E,selectNodesOnDrag:S});return P?null:ve.createElement("div",{className:Us(["react-flow__node","react-flow__node-".concat(i),W,N,{selected:p,selectable:E,parent:R}]),ref:q,style:zv({zIndex:A,transform:"translate(".concat(u,"px,").concat(d,"px)"),pointerEvents:F?"all":"none",visibility:D?"visible":"hidden"},x),onMouseEnter:K,onMouseMove:re,onMouseLeave:Y,onContextMenu:V,onClick:X,onDoubleClick:G,"data-testid":"rf__node-".concat(o),"data-id":o},ve.createElement(GE,{value:o},ve.createElement(e,{id:o,data:c,type:i,xPos:u,yPos:d,selected:p,isConnectable:j,sourcePosition:M,targetPosition:T,dragging:se,dragHandle:$,zIndex:A})))};return t.displayName="NodeWrapper",v.memo(t)};function Rv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function Dv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rv(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Z1(e){var t={input:Ai(e.input||sv),default:Ai(e.default||dh),output:Ai(e.output||av),group:Ai(e.group||Pv)},n={},s=Object.keys(e).filter(function(o){return!["input","default","output","group"].includes(o)}).reduce(function(o,i){return o[i]=Ai(e[i]||dh),o},n);return Dv(Dv({},t),s)}function Fv(e,t){v.useRef(null);var n=v.useMemo(function(){return t(e)},[e]);return n}function Iv(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var Bv=function(t){var n=t.children,s=!0;try{rs()}catch{s=!1}return s?ve.createElement(ve.Fragment,null,n):ve.createElement($_,{createStore:P_},n)};Bv.displayName="ReactFlowWrapper";var ek=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function Uv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(o){return Object.getOwnPropertyDescriptor(e,o).enumerable})),n.push.apply(n,s)}return n}function qv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Uv(Object(n),!0).forEach(function(s){At(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}Iv(o1),Iv(i1);var tk={input:sv,default:dh,output:av},nk={default:oh,straight:Q_,step:G_,smoothstep:ah,simplebezier:q_},sk=[15,15],rk=[0,0],Hv=v.forwardRef(function(e,t){var n=e.nodes,s=e.edges,o=e.defaultNodes,i=e.defaultEdges,c=e.className,u=e.nodeTypes,d=u===void 0?tk:u,p=e.edgeTypes,h=p===void 0?nk:p,f=e.onNodeClick,g=e.onEdgeClick,w=e.onInit,b=e.onMove,_=e.onMoveStart,x=e.onMoveEnd,N=e.onConnect,C=e.onConnectStart,E=e.onConnectStop,j=e.onConnectEnd,S=e.onClickConnectStart,M=e.onClickConnectStop,T=e.onClickConnectEnd,P=e.onNodeMouseEnter,L=e.onNodeMouseMove,$=e.onNodeMouseLeave,A=e.onNodeContextMenu,R=e.onNodeDoubleClick,W=e.onNodeDragStart,z=e.onNodeDrag,D=e.onNodeDragStop,H=e.onNodesDelete,q=e.onEdgesDelete,I=e.onSelectionChange,Q=e.onSelectionDragStart,U=e.onSelectionDrag,F=e.onSelectionDragStop,K=e.onSelectionContextMenu,re=e.connectionMode,Y=re===void 0?vo.Strict:re,V=e.connectionLineType,G=V===void 0?wa.Bezier:V,X=e.connectionLineStyle,se=e.connectionLineComponent,J=e.connectionLineContainerStyle,te=e.deleteKeyCode,Se=te===void 0?"Backspace":te,ze=e.selectionKeyCode,Oe=ze===void 0?"Shift":ze,Ue=e.multiSelectionKeyCode,nt=Ue===void 0?"Meta":Ue,He=e.zoomActivationKeyCode,de=He===void 0?"Meta":He,_e=e.snapToGrid,je=_e===void 0?!1:_e,Me=e.snapGrid,De=Me===void 0?sk:Me,ce=e.onlyRenderVisibleElements,Te=ce===void 0?!1:ce,Qe=e.selectNodesOnDrag,ht=Qe===void 0?!0:Qe,rt=e.nodesDraggable,gt=e.nodesConnectable,at=e.elementsSelectable,ut=e.minZoom,Ot=ut===void 0?.5:ut,Rt=e.maxZoom,Xe=Rt===void 0?2:Rt,Bt=e.defaultZoom,Kt=Bt===void 0?1:Bt,kt=e.defaultPosition,_t=kt===void 0?rk:kt,Cn=e.translateExtent,Lt=Cn===void 0?Km:Cn,rn=e.preventScrolling,fe=rn===void 0?!0:rn,Ut=e.nodeExtent,dt=e.defaultMarkerColor,Tn=dt===void 0?"#b1b1b7":dt,qe=e.zoomOnScroll,wt=qe===void 0?!0:qe,mt=e.zoomOnPinch,Ns=mt===void 0?!0:mt,Gt=e.panOnScroll,vt=Gt===void 0?!1:Gt,jt=e.panOnScrollSpeed,Gn=jt===void 0?.5:jt,on=e.panOnScrollMode,Sn=on===void 0?fl.Free:on,Zt=e.zoomOnDoubleClick,$n=Zt===void 0?!0:Zt,ln=e.panOnDrag,Ht=ln===void 0?!0:ln,It=e.onPaneClick,Fn=e.onPaneScroll,cn=e.onPaneContextMenu,vn=e.children,et=e.onEdgeUpdate,Qn=e.onEdgeContextMenu,Cs=e.onEdgeDoubleClick,In=e.onEdgeMouseEnter,Xn=e.onEdgeMouseMove,Ss=e.onEdgeMouseLeave,Bn=e.onEdgeUpdateStart,Qt=e.onEdgeUpdateEnd,Tt=e.edgeUpdaterRadius,lt=Tt===void 0?10:Tt,Ks=e.onNodesChange,Un=e.onEdgesChange,Ys=e.noDragClassName,os=Ys===void 0?"nodrag":Ys,_r=e.noWheelClassName,le=_r===void 0?"nowheel":_r,ge=e.noPanClassName,Pe=ge===void 0?"nopan":ge,Nt=e.fitView,we=Nt===void 0?!1:Nt,tt=e.fitViewOptions,it=e.connectOnClick,Ct=it===void 0?!0:it,$t=e.attributionPosition,en=e.proOptions,qt=e.defaultEdgeOptions,un=e.elevateEdgesOnSelect,Es=un===void 0?!1:un,Jn=du(e,ek),En=Fv(d,Z1),kn=Fv(h,d1);return ve.createElement("div",qv(qv({},Jn),{},{ref:t,className:Us(["react-flow",c])}),ve.createElement(Bv,null,ve.createElement(J1,{onInit:w,onMove:b,onMoveStart:_,onMoveEnd:x,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:P,onNodeMouseMove:L,onNodeMouseLeave:$,onNodeContextMenu:A,onNodeDoubleClick:R,nodeTypes:En,edgeTypes:kn,connectionLineType:G,connectionLineStyle:X,connectionLineComponent:se,connectionLineContainerStyle:J,selectionKeyCode:Oe,deleteKeyCode:Se,multiSelectionKeyCode:nt,zoomActivationKeyCode:de,onlyRenderVisibleElements:Te,selectNodesOnDrag:ht,translateExtent:Lt,minZoom:Ot,maxZoom:Xe,defaultZoom:Kt,defaultPosition:_t,preventScrolling:fe,zoomOnScroll:wt,zoomOnPinch:Ns,zoomOnDoubleClick:$n,panOnScroll:vt,panOnScrollSpeed:Gn,panOnScrollMode:Sn,panOnDrag:Ht,onPaneClick:It,onPaneScroll:Fn,onPaneContextMenu:cn,onSelectionContextMenu:K,onEdgeUpdate:et,onEdgeContextMenu:Qn,onEdgeDoubleClick:Cs,onEdgeMouseEnter:In,onEdgeMouseMove:Xn,onEdgeMouseLeave:Ss,onEdgeUpdateStart:Bn,onEdgeUpdateEnd:Qt,edgeUpdaterRadius:lt,defaultMarkerColor:Tn,noDragClassName:os,noWheelClassName:le,noPanClassName:Pe,elevateEdgesOnSelect:Es,id:Jn==null?void 0:Jn.id}),ve.createElement(r1,{nodes:n,edges:s,defaultNodes:o,defaultEdges:i,onConnect:N,onConnectStart:C,onConnectStop:E,onConnectEnd:j,onClickConnectStart:S,onClickConnectStop:M,onClickConnectEnd:T,nodesDraggable:rt,nodesConnectable:gt,elementsSelectable:at,minZoom:Ot,maxZoom:Xe,nodeExtent:Ut,onNodesChange:Ks,onEdgesChange:Un,snapToGrid:je,snapGrid:De,connectionMode:Y,translateExtent:Lt,connectOnClick:Ct,defaultEdgeOptions:qt,fitView:we,fitViewOptions:tt,onNodesDelete:H,onEdgesDelete:q,onNodeDragStart:W,onNodeDrag:z,onNodeDragStop:D,onSelectionDrag:U,onSelectionDragStart:Q,onSelectionDragStop:F}),I&&ve.createElement(n1,{onSelectionChange:I}),vn,ve.createElement(BE,{proOptions:en,position:$t})))});Hv.displayName="ReactFlow";var Vv=function(t){var n=t.children;return ve.createElement($_,{createStore:P_},n)};Vv.displayName="ReactFlowProvider";function Wv(e){return function(t){var n=v.useState(t),s=xt(n,2),o=s[0],i=s[1],c=v.useCallback(function(u){return i(function(d){return e(u,d)})},[]);return[o,i,c]}}var ak=Wv(__),ok=Wv(dE);const lk=e=>Number.isFinite(e),xu=e=>Math.round(e*100)/100,ik=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const o=Math.abs(n-e),i=Math.abs(s-t),c=Math.sqrt(o*o+i*i),u=Math.max(80,Math.min(c*.4,280)),d=Number.isFinite(u)?u:120,p=n>=e?1:-1,h=Math.min(Math.abs(s-t)*.2,50),f=e+p*d,g=t+(s>t?h:-h),w=n-p*d,b=s-(s>t?h:-h);return`M ${e},${t} C ${f},${g} ${w},${b} ${n},${s}`},ck=({id:e,sourceX:t,sourceY:n,targetX:s,targetY:o,markerEnd:i,style:c})=>{const{setEdges:u}=Gm(),[d,p]=v.useState(!1),h=v.useCallback(()=>{p(!0)},[]),f=v.useCallback(()=>{p(!1)},[]),g=v.useMemo(()=>[t,n,s,o].every($=>lk($))?{sourceX:xu(t),sourceY:xu(n),targetX:xu(s),targetY:xu(o)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:s,targetY:o}),null),[t,n,s,o,e]),w=v.useMemo(()=>{if(!g)return null;const{sourceX:$,sourceY:A,targetX:R,targetY:W}=g;return ik($,A,R,W)},[g]),b=v.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!g||!w)return null;const{sourceX:_,sourceY:x,targetX:N,targetY:C}=g,E=(_+N)/2,j=(x+C)/2,S=32,M=E-S/2,T=j-S/2,P=`animated-edge${d?" animated-edge--hovered":""}`,L=`canvas-edge-remove${d?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:P,onMouseEnter:h,onMouseLeave:f,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:b,gradientUnits:"userSpaceOnUse",x1:_,y1:x,x2:N,y2:C,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:w,fill:"none",stroke:"transparent",strokeWidth:20,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${b})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${b})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:i,className:"animated-edge__base",style:{...c,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:`url(#${b})`,strokeWidth:d?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:w,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:L,x:M,y:T,width:S,height:S,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:$=>{$.stopPropagation(),u(A=>A.filter(R=>R.id!==e))},"aria-label":"Remove connection",children:""})})})]})};async function Kv(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function Yv(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function Gv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load label encoding recommendations");return c.json()}async function Qv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load ordinal encoding suggestions");return c.json()}async function Xv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load target encoding recommendations");return c.json()}async function Jv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load hash encoding recommendations");return c.json()}async function Zv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load one-hot encoding recommendations");return c.json()}async function ey(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load dummy encoding recommendations");return c.json()}async function gh(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load column drop recommendations");return c.json()}async function ty(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,c={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),o&&(c.target_node_id=o);const u=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load outlier recommendations");return u.json()}async function ny(e,t={}){const{sampleSize:n=500,transformations:s,graph:o,targetNodeId:i}=t,c={dataset_source_id:e,sample_size:n};Array.isArray(s)?s.length>0&&(c.transformations=JSON.stringify(s)):s&&typeof s=="object"&&Object.keys(s).length>0&&(c.transformations=JSON.stringify(s)),o&&Array.isArray(o.nodes)&&Array.isArray(o.edges)&&(c.graph={nodes:o.nodes,edges:o.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load skewness recommendations");return u.json()}async function sy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load scaling recommendations");return c.json()}async function ry(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(i.graph={nodes:s.nodes,edges:s.edges}),o&&(i.target_node_id=o);const c=await fetch("/ml-workflow/api/recommendations/binning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!c.ok)throw new Error("Failed to load binning recommendations");return c.json()}async function ay(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c={dataset_source_id:e,sample_size:i};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),o&&(c.target_node_id=o);const u=await fetch("/ml-workflow/api/analytics/binned-distribution",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){let d="Failed to load binned column distributions";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function oy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:o}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c=new URLSearchParams({dataset_source_id:e,sample_size:String(i)});s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&c.set("graph",JSON.stringify({nodes:s.nodes,edges:s.edges})),o&&c.set("target_node_id",o);const u=await fetch(`/ml-workflow/api/analytics/quick-profile?${c.toString()}`);if(!u.ok){let d="Failed to generate dataset profile";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function uk(e,t={}){const{config:n,sampleSize:s,graph:o,targetNodeId:i}=t,c={dataset_source_id:e,sample_size:s==="all"?0:typeof s=="number"&&Number.isFinite(s)?s:300};if(n&&typeof n=="object"){const d=(g,w)=>{const b=Number(g);return Number.isFinite(b)?b<0?0:b>100?100:b:w},p=g=>{if(!g||typeof g!="object")return{};const w={};return Object.entries(g).forEach(([b,_])=>{const x=String(b??"").trim();if(!x)return;let N=null,C=null;if(_&&typeof _=="object"){const E=_.lower??_.min??_.minimum??null,j=_.upper??_.max??_.maximum??null,S=Number(E);Number.isFinite(S)&&(N=S);const M=Number(j);Number.isFinite(M)&&(C=M)}if(!(N===null&&C===null)){if(N!==null&&C!==null&&N>C){const E=N;N=C,C=E}w[x]={lower:N,upper:C}}}),w},h=d(n.lower_percentile,5),f=d(n.upper_percentile,95);c.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:h,upper_percentile:f<=h?Math.min(h+1,100):f,manual_bounds:p(n.manual_bounds)}}o&&Array.isArray(o.nodes)&&Array.isArray(o.edges)&&(c.graph={nodes:o.nodes,edges:o.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){const d=await u.text();throw new Error(d||"Failed to load outlier diagnostics")}return u.json()}async function ly(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function iy(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function cy(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}async function uy(e,t={}){const{offset:n,limit:s,mode:o}=t,i=new URLSearchParams;typeof n=="number"&&Number.isFinite(n)&&i.set("offset",String(n)),typeof s=="number"&&Number.isFinite(s)&&i.set("limit",String(s)),o&&i.set("mode",o);const c=i.toString(),u=`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/preview/rows${c?`?${c}`:""}`,d=await fetch(u);if(!d.ok){const p=await d.text();throw new Error(p||"Failed to load preview rows")}return d.json()}async function dy(e){const t=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(n||"Failed to load pipeline preview")}return t.json()}async function my(e){const t={...e,sample_size:0},n=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const s=await n.text();throw new Error(s||"Failed to trigger full dataset execution")}return n.json()}async function dk(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/full-execution/${encodeURIComponent(t)}`);if(!n.ok){const s=await n.text();throw new Error(s||"Failed to fetch full execution status")}return n.json()}async function hy(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,o=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:o}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function fy(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function Oi(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view training jobs.");const o=await s.text();throw new Error(o||"Failed to load training jobs")}return s.json()}async function py(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const s=await n.text();throw new Error(s||"Failed to evaluate model")}return n.json()}async function gy(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,o=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:o}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function mk(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function Ti(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view tuning jobs.");const o=await s.text();throw new Error(o||"Failed to load tuning jobs")}return s.json()}async function wu(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function _y(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const s=n.toString(),o=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${s?`?${s}`:""}`,{credentials:"include"});if(!o.ok){if(o.status===404)throw new Error(`Model type '${e}' not found`);const i=await o.text();throw new Error(i||"Failed to fetch best hyperparameters")}return o.json()}const _h=e=>{if(Array.isArray(e))return e.map(t=>_h(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(s=>{n[s]=_h(e[s])}),n}return e},hk=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),fk=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return hk(n)},pk=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],s=t.map(i=>{let c=null;if(i&&i.data&&typeof i.data=="object"){const u=i.data.config;if(u!==void 0)try{c=JSON.parse(JSON.stringify(u))}catch{c=u}}return{id:i&&Object.prototype.hasOwnProperty.call(i,"id")?i.id??null:null,type:i&&Object.prototype.hasOwnProperty.call(i,"type")?i.type??null:null,catalogType:i&&i.data&&Object.prototype.hasOwnProperty.call(i.data,"catalogType")?i.data.catalogType??null:null,config:c}}).sort((i,c)=>{const u=typeof i.id=="string"?i.id:String(i.id??""),d=typeof c.id=="string"?c.id:String(c.id??"");return u.localeCompare(d)}),o=n.map(i=>({source:i&&Object.prototype.hasOwnProperty.call(i,"source")?i.source??null:null,target:i&&Object.prototype.hasOwnProperty.call(i,"target")?i.target??null:null,sourceHandle:i&&Object.prototype.hasOwnProperty.call(i,"sourceHandle")?i.sourceHandle??null:null,targetHandle:i&&Object.prototype.hasOwnProperty.call(i,"targetHandle")?i.targetHandle??null:null})).sort((i,c)=>{const u=String(i.source??"").localeCompare(String(c.source??""));return u!==0?u:String(i.target??"").localeCompare(String(c.target??""))});return{nodes:s,edges:o}};async function xo(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=pk(t),s=JSON.stringify(_h(n)),o=await fk(s);return`${e}_${o.slice(0,8)}`}const gk=Object.freeze(Object.defineProperty({__proto__:null,createHyperparameterTuningJob:gy,createTrainingJob:hy,evaluateTrainingJob:py,fetchBestHyperparameters:_y,fetchBinnedDistribution:ay,fetchBinningRecommendations:ry,fetchDatasets:Yv,fetchDropColumnRecommendations:gh,fetchDummyEncodingRecommendations:ey,fetchFullExecutionStatus:dk,fetchHashEncodingRecommendations:Jv,fetchHyperparameterTuningJob:mk,fetchHyperparameterTuningJobs:Ti,fetchLabelEncodingRecommendations:Gv,fetchModelHyperparameters:wu,fetchNodeCatalog:Kv,fetchOneHotEncodingRecommendations:Zv,fetchOrdinalEncodingRecommendations:Qv,fetchOutlierDiagnostics:uk,fetchOutlierRecommendations:ty,fetchPipeline:ly,fetchPipelineHistory:cy,fetchPipelinePreview:dy,fetchPipelinePreviewRows:uy,fetchQuickProfile:oy,fetchScalingRecommendations:sy,fetchSkewnessRecommendations:ny,fetchTargetEncodingRecommendations:Xv,fetchTrainingJob:fy,fetchTrainingJobs:Oi,generatePipelineId:xo,savePipeline:iy,triggerFullDatasetExecution:my},Symbol.toStringTag,{value:"Module"})),_k=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:o,columnTypeMap:i,setAvailableColumns:c,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:p,setColumnSuggestions:h})=>{const[f,g]=v.useState([]),[w,b]=v.useState(null),[_,x]=v.useState([]),[N,C]=v.useState(null),[E,j]=v.useState(!1),[S,M]=v.useState(null),[T,P]=v.useState(null),[L,$]=v.useState(0),A=v.useRef(i);v.useEffect(()=>{A.current=i},[i]),v.useEffect(()=>{let H=!0;const q=I=>{x([]),C(I??null),M(null),P(null),j(!1),g([]),b(null),c([]),u(""),d({}),p({}),h({})};return e?t?o?(j(!0),C(null),gh(t,{graph:s,targetNodeId:n??null}).then(I=>{if(!H)return;const Q=Array.isArray(I==null?void 0:I.candidates)?I.candidates:[];x(Q),M((I==null?void 0:I.generated_at)??null),P(typeof(I==null?void 0:I.suggested_threshold)=="number"?Number(I.suggested_threshold):null);const U=Array.isArray(I==null?void 0:I.available_filters)?I.available_filters:[];g(U),b(Y=>Y&&U.some(V=>V.id===Y)?Y:null);const F={};I&&typeof I=="object"&&(I!=null&&I.column_missing_map)&&typeof I.column_missing_map=="object"&&Object.entries(I.column_missing_map).forEach(([Y,V])=>{const G=String(Y??"").trim();if(!G)return;const X=Number(V);Number.isFinite(X)&&(F[G]=Number(X))});const K=new Set;Array.isArray(I==null?void 0:I.all_columns)&&I.all_columns.forEach(Y=>{const V=String(Y??"").trim();V&&K.add(V)}),Object.keys(A.current??{}).forEach(Y=>K.add(Y));const re=Array.from(K).sort((Y,V)=>Y.localeCompare(V));re.forEach(Y=>{Object.prototype.hasOwnProperty.call(F,Y)||(F[Y]=0)}),c(re),u(""),d(F),p(Y=>{const V=I==null?void 0:I.column_type_map;if(!V||typeof V!="object")return Y;const G={...Y};return Object.entries(V).forEach(([X,se])=>{const J=String(X??"").trim();if(!J)return;const te=String(se??"").trim();G[J]=te||Y[J]||""}),G}),h(Y=>{const V=I==null?void 0:I.column_recommendations;if(!V||typeof V!="object")return Y;const G={};return Object.entries(V).forEach(([X,se])=>{const J=String(X??"").trim();if(!J)return;const te=Array.isArray(se)?se.map(Se=>String(Se??"").trim()).filter(Boolean):[];G[J]=te}),G})}).catch(I=>{H&&q((I==null?void 0:I.message)??"Unable to load recommendations")}).finally(()=>{H&&j(!1)}),()=>{H=!1}):(q("Connect this step to an upstream output to load recommendations."),()=>{H=!1}):(q(),()=>{H=!1}):(q(),()=>{H=!1})},[A,s,e,o,n,L,c,d,u,h,p,t]);const R=v.useCallback(()=>{!e||!t||!o||$(H=>H+1)},[e,o,t]),W=v.useMemo(()=>{const H=new Map;return f.forEach(q=>{q!=null&&q.id&&H.set(q.id,q.label)}),H},[f]),z=v.useCallback(H=>H?W.has(H)?W.get(H)??null:H.split("_").filter(Boolean).map(I=>I.charAt(0).toUpperCase()+I.slice(1)).join(" ")||H:null,[W]),D=v.useMemo(()=>w?_.filter(H=>Array.isArray(H==null?void 0:H.signals)&&H.signals.includes(w)):_,[w,_]);return{hasDropColumnSource:e,availableFilters:f,activeFilterId:w,setActiveFilterId:b,recommendations:_,filteredRecommendations:D,formatSignalName:z,isFetchingRecommendations:E,recommendationsError:N,recommendationsGeneratedAt:S,suggestedThreshold:T,refreshRecommendations:R}},vk=({thresholdParameter:e,dropIfAnyParameter:t,renderParameterField:n})=>!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&n(e),t&&n(t)]}),yk="first",bk=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],xk=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:s,renderMultiSelectField:o,removeDuplicatesKeepSelectId:i,removeDuplicatesKeep:c,onKeepChange:u})=>{if(!n&&!s)return null;const d=p=>{const h=p.target.value;u(h==="last"||h==="none"?h:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),o(n)]}),s&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:i,className:"canvas-modal__parameter-label",children:s.label??"Keep strategy"}),s.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:s.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:i,value:c,onChange:d,children:bk.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))})})]})]})},Ye=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],wk=["float64","Int64","boolean","string","category","datetime64[ns]","object"],jk=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:s,columnSuggestions:o,selectedColumns:i,previewColumns:c,previewStatus:u,sourceId:d,hasReachableSource:p})=>{const h=v.useMemo(()=>{const j=e==null?void 0:e.column_overrides;if(!j||typeof j!="object"||Array.isArray(j))return{};const S={};return Object.entries(j).forEach(([M,T])=>{const P=String(M??"").trim();if(!P||typeof T!="string")return;const L=T.trim();L&&(S[P]=L)}),S},[e==null?void 0:e.column_overrides]),f=v.useMemo(()=>{const j=e==null?void 0:e.target_dtype;return typeof j=="string"?j.trim():""},[e==null?void 0:e.target_dtype]),g=v.useMemo(()=>{const j=new Set;return n.forEach(M=>j.add(M)),Object.keys(s).forEach(M=>j.add(M)),Object.keys(o).forEach(M=>j.add(M)),Object.keys(h).forEach(M=>j.add(M)),i.forEach(M=>j.add(M)),c.forEach(M=>{typeof M=="string"&&j.add(M)}),Array.from(j).sort((M,T)=>M.localeCompare(T)).map(M=>{const T=s[M]??"Unknown",P=o[M]??[],L=P.length?P[0]:null,$=Object.prototype.hasOwnProperty.call(h,M),A=$?h[M]:null,R=typeof A=="string"?A.trim():"",W=$?R:f,z=new Set;W&&z.add(W),P.forEach(U=>z.add(U)),T&&T!=="Unknown"&&z.add(T),f&&z.add(f),wk.forEach(U=>z.add(U));const D=W??"",H=!!(L&&L!==D),q=!!(L&&L===D),I=i.includes(M),Q=Array.from(z).sort((U,F)=>U.localeCompare(F));return{column:M,originalType:T,recommended:L,currentTarget:W,suggestions:P,options:Q,hasRecommendationGap:H,hasOverride:$,usesDefaultTarget:!$,isRecommendationApplied:q,isSelected:I}})},[n,f,h,o,s,c,i]),w=v.useMemo(()=>{const j=g.filter(T=>T.hasRecommendationGap),S=g.filter(T=>!T.hasRecommendationGap),M=[];return j.length&&M.push({key:"needs-attention",label:"Needs attention",rows:j}),S.length&&M.push({key:"all-columns",label:j.length?"Other columns":"All columns",rows:S}),M},[g]),b=v.useMemo(()=>g.filter(j=>j.hasRecommendationGap).length,[g]),_=v.useMemo(()=>b>0,[b]),x=v.useMemo(()=>g.filter(j=>j.isSelected).length,[g]),N=v.useCallback((j,S)=>{const M=j.trim();M&&t(T=>{const P=T.column_overrides&&typeof T.column_overrides=="object"&&!Array.isArray(T.column_overrides)?{...T.column_overrides}:{},L=typeof S=="string"?S.trim():"",$=new Set(Ye(T.columns)),A=new Set(Ye(T.skipped_columns)),R=A.delete(M);L?(P[M]=L,$.add(M)):delete P[M];const W={...T,columns:Array.from($).sort((z,D)=>z.localeCompare(D)),column_overrides:P};return R&&(W.skipped_columns=Array.from(A).sort((z,D)=>z.localeCompare(D))),W})},[t]),C=v.useCallback(()=>{const j=Object.entries(o).filter(([,S])=>S.length>0);j.length&&t(S=>{const M=new Set(Ye(S.columns)),T=S.column_overrides&&typeof S.column_overrides=="object"&&!Array.isArray(S.column_overrides)?{...S.column_overrides}:{};return j.forEach(([P,L])=>{const $=P.trim();$&&(M.add($),L.length&&(T[$]=L[0]))}),{...S,columns:Array.from(M).sort((P,L)=>P.localeCompare(L)),column_overrides:T}})},[o,t]),E=v.useCallback((j,S)=>{S==="__default__"?N(j,null):N(j,S)},[N]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:C,disabled:!_,children:"Apply recommendations"})})]}),!d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),d&&!p&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),f?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:f}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),g.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",g.length," column",g.length===1?"":"s","  ",x," mapped in node selection."]}),_?a.jsxs("p",{className:"canvas-modal__note",children:[b," column",b===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):g.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),u==="loading"&&!g.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),g.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:w.map(j=>a.jsxs("div",{className:"canvas-cast__group",children:[j.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:j.label}),a.jsxs("span",{children:[j.rows.length," column",j.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:j.rows.map(S=>{const M=["canvas-cast__row"];S.hasRecommendationGap&&M.push("canvas-cast__row--attention"),S.hasOverride&&M.push("canvas-cast__row--override");const T=S.hasOverride?S.currentTarget||"":"__default__",P=S.isRecommendationApplied,L=S.suggestions.slice(1,4),$=S.hasOverride?S.currentTarget?`Override  ${S.currentTarget}`:"Override cleared (uses original dtype)":f?`Inheriting ${f}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:M.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:S.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[S.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),S.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!S.isSelected&&!S.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:S.originalType})}),a.jsx("td",{children:S.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${S.hasRecommendationGap?" canvas-cast__chip--attention":""}${P?" canvas-cast__chip--applied":""}`,children:S.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:P?"Aligned with target":"Not applied yet"}),L.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",L.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:T,onChange:A=>E(S.column,A.target.value),children:[a.jsx("option",{value:"__default__",children:f?`Inherit global (${f})`:"No override (use original)"}),S.options.map(A=>a.jsx("option",{value:A,children:A},`${S.column}-${A}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:$})]})})]},`cast-row-${S.column}`)})})]})})]},`cast-group-${j.key}`))})]})},$i=100,Nk=12,Ck={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},vy={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},Sk={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details."},Ek={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},kk=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},Mk=e=>{if(!e)return"";const t=Sk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},yy=(e,t)=>{if(!e)return null;const n=e.job_status??null,s=kk(n??e.status??null),o=vy[n??e.status??s]??vy[s],i=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,c=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let u=`Full dataset run: ${o}`;s==="running"&&i&&c?u=`Full dataset run: In progress (${i}/${c})`:s==="running"&&i?u=`Full dataset run: In progress (${i} rows)`:s==="succeeded"&&i?u=`Full dataset run: Completed (${i} rows)`:s==="succeeded"&&c&&(u=`Full dataset run: Completed (${c} rows)`);const d=[],p=[],h=n?Ek[n]??n:null;if(n==="running"?i&&c?d.push(`Processed ${i} of ${c} rows.`):i?d.push(`Processed ${i} rows.`):c&&d.push(`Processing ${c} rows.`):i?d.push(`Processed ${i} rows.`):c&&d.push(`Total rows ${c}.`),e.reason&&d.push(e.reason),h&&p.push({label:"Background job",value:h}),e.job_id&&p.push({label:"Background job ID",value:e.job_id}),c&&p.push({label:"Dataset rows",value:c}),i&&s!=="queued"&&s!=="skipped"&&p.push({label:"Processed rows",value:i}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&p.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const w=new Date(e.last_updated).toLocaleString();p.push({label:"Last updated",value:w})}catch{p.push({label:"Last updated",value:String(e.last_updated)})}const f=Array.isArray(e.warnings)?e.warnings.map(Mk).map(w=>w.trim()).filter(Boolean):[];let g=null;switch(s){case"queued":g=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":g=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(i){const w=e.processed_rows===1?"":"s";g=`Full dataset run processed ${i} row${w}.`}else c?g=`Full dataset run completed (${c} rows).`:g="Full dataset run completed.";break;case"failed":g=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":g="Full dataset run cancelled.";break;case"skipped":g=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":g=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:g=null;break}return{label:u,tone:s,details:d,metadata:p,warnings:f,stepLabel:g,isActive:n==="queued"||n==="running"}},by=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),Ak=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const s=e.split(":",2)[1]??"";return s?`Preview mode "${s}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=Ck[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},Ok=({preview:e,columns:t,rows:n,tableNote:s,formatCellValue:o,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:p,fullExecutionWarnings:h})=>{const f=e==null?void 0:e.metrics,g=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],w=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],b=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let _=b;const x=p||null;if(x){const j=b.findIndex(S=>typeof S=="string"&&S.toLowerCase().startsWith("full dataset run"));j>=0?_=[...b.slice(0,j),x,...b.slice(j+1)]:b.includes(x)||(_=[...b,x])}const N=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],C=w.reduce((j,S)=>(S&&typeof S.index=="number"&&(j[S.index]=typeof S.missing_percentage=="number"?S.missing_percentage:0),j),{}),E=N.slice(0,Nk);return a.jsxs("div",{className:"canvas-preview",children:[f&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(f.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:f.requested_sample_size===0?"Full dataset":i(f.requested_sample_size)})]})]}),_.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:_.map((j,S)=>a.jsx("li",{children:j},`${j}-${S}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(j=>a.jsx("th",{children:j},j))})}),a.jsx("tbody",{children:n.map((j,S)=>a.jsx("tr",{children:t.map(M=>a.jsx("td",{children:o(j==null?void 0:j[M])},`${S}-${M}`))},`row-${S}`))})]}),s?a.jsx("p",{className:"canvas-modal__note",children:s}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),w.length>0&&E.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:E.map((j,S)=>{const M=C[S]??0,T=M%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",S+1]}),a.jsxs("strong",{children:[i(M,T),"%"]})]},`row-missing-${S}`)})})]}),g.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:g.map(j=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:j.name}),j.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",j.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",c(j.missing_percentage)," (",i(j.missing_count),")"]}),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",u(j.mean)]}),typeof j.median=="number"&&!Number.isNaN(j.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",u(j.median)]}),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",d(j.mode)]}),typeof j.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",i(j.distinct_count)]})]},j.name))})]}),h&&h.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:h.map((j,S)=>a.jsx("li",{children:j},`${j}-${S}`))})]})]})},Tk=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:s,formatCellValue:o,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d})=>{var q,I,Q,U,F;const[p,h]=v.useState(()=>by()),[f,g]=v.useState(null),[w,b]=v.useState(!1),_=e.status==="loading",x=_||!n,N=v.useMemo(()=>{var re;const K=(re=e.data)==null?void 0:re.columns;return Array.isArray(K)?K.filter(Y=>typeof Y=="string"):[]},[(q=e.data)==null?void 0:q.columns]),C=v.useMemo(()=>{var K;return Array.isArray((K=e.data)==null?void 0:K.sample_rows)?e.data.sample_rows.slice(0,$i):[]},[(I=e.data)==null?void 0:I.sample_rows]),E=C.length,j=Array.isArray((Q=e.data)==null?void 0:Q.sample_rows)?e.data.sample_rows.length:0,S=(U=e.data)==null?void 0:U.metrics,M=v.useMemo(()=>S?j>E||typeof S.total_rows=="number"&&S.total_rows>j:!1,[S,E,j]);v.useEffect(()=>{var re;if(e.status!=="success"||!e.data){h(Y=>Y.status==="idle"?Y:by()),g(null);return}const K=yy((re=e.data.signals)==null?void 0:re.full_execution,i);g(K),h({status:"ready",columns:[...N],rows:[...C],nextOffset:E,hasMore:M,totalRows:typeof(S==null?void 0:S.total_rows)=="number"?S.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[N,C,E,M,i,S==null?void 0:S.total_rows,e.data,e.status]),v.useEffect(()=>{var V,G;if(!f||!f.isActive)return;const K=(G=(V=e.data)==null?void 0:V.signals)==null?void 0:G.full_execution;if(!K||!K.job_id||!t)return;const re=typeof K.poll_after_seconds=="number"&&K.poll_after_seconds>0?K.poll_after_seconds*1e3:5e3,Y=setTimeout(()=>{Promise.resolve().then(()=>gk).then(X=>X.fetchFullExecutionStatus(t,K.job_id)).then(X=>{const se=yy(X,i);g(se),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(X=>{console.error("Failed to poll background job status:",X)})},re);return()=>clearTimeout(Y)},[f,t,i,e.data]);const T=p.columns.length>0?p.columns:N,P=p.rows.length>0?p.rows:C,L=p.totalRows??(typeof(S==null?void 0:S.total_rows)=="number"?S.total_rows:null),$=p.status==="idle"?M:p.hasMore,A=p.status==="loading",R=P.length,W=v.useMemo(()=>{if(!R)return null;const K=i(R);if(L!==null&&L>=0){const re=i(L),Y=`Loaded ${K} of ${re} rows.`;return $&&R<L?`${Y} Load more rows to continue.`:!$&&R<L?`${Y} Preview limited by backend settings.`:Y}return $?`Loaded ${K} rows. Additional rows available.`:`Loaded ${K} rows.`},[$,i,R,L]),z=v.useMemo(()=>(p.status==="idle"?[]:p.samplingAdjustments).map(Ak).map(re=>re.trim()).filter(Boolean),[p.samplingAdjustments,p.status]),D=p.status==="idle"?!1:p.largeDataset,H=v.useCallback(()=>{var V;if(!t||!$||p.status==="loading")return;const K=p.rows.length>0?p.rows:C,re=p.status==="idle"?K.length:p.nextOffset??K.length,Y=Array.isArray((V=e.data)==null?void 0:V.sample_rows)?e.data.sample_rows:[];if(re<Y.length){const G=Y.slice(re,re+$i),X=K.concat(G),se=re+G.length,J=se<Y.length||typeof(S==null?void 0:S.total_rows)=="number"&&S.total_rows>Y.length;h({status:"ready",columns:p.columns.length>0?p.columns:N,rows:X,nextOffset:J?se:null,hasMore:J,totalRows:typeof(S==null?void 0:S.total_rows)=="number"?S.total_rows:null,samplingAdjustments:p.samplingAdjustments,largeDataset:p.largeDataset,error:null});return}h(G=>({...G,status:"loading",error:null})),uy(t,{offset:re,limit:$i}).then(G=>{h(X=>{const se=X.rows.length>0?X.rows:K,J=Array.isArray(G.columns)&&G.columns.length>0?G.columns.map(Me=>String(Me)):X.columns.length>0?X.columns:N,te=typeof G.offset=="number"&&G.offset>=0?G.offset:0,Se=Array.isArray(G.rows)?G.rows:[],ze=te<=se.length?se.slice(0,te):se.slice(),Oe=te<=se.length?ze.concat(Se):se.concat(Se),Ue=Se.length,nt=!!G.has_more,He=typeof G.next_offset=="number"?G.next_offset:nt?te+Ue:null,de=typeof G.total_rows=="number"?G.total_rows:null,_e=nt?null:Oe.length,je=de!==null?de:X.totalRows!==null?X.totalRows:_e;return{status:"ready",columns:[...J],rows:Oe,nextOffset:He,hasMore:nt,totalRows:je,samplingAdjustments:Array.isArray(G.sampling_adjustments)?G.sampling_adjustments:[],largeDataset:!!G.large_dataset,error:null}})}).catch(G=>{h(X=>({...X,status:"error",error:(G==null?void 0:G.message)??"Unable to load additional rows."}))})},[N,C,t,$,p,(F=e.data)==null?void 0:F.sample_rows,S]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),f&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${f.tone}`,role:"status","aria-live":f.isActive?"polite":"off",title:f.details.length>0?f.details.join(" "):void 0,children:f.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:x,children:_?"Refreshing":"Refresh"})})]}),f&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[f.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:f.details.map((K,re)=>a.jsx("li",{children:K},`${K}-${re}`))}),f.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>b(!w),"aria-expanded":w,children:[w?"":""," ",w?"Hide":"Show"," job details"]}),w&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:f.metadata.map((K,re)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:K.label}),a.jsx("dd",{children:K.value})]},`${K.label}-${K.value}-${re}`))})]})]}),_&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(Ok,{preview:e.data,columns:T,rows:P,tableNote:W,formatCellValue:o,formatMetricValue:i,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:(f==null?void 0:f.stepLabel)??null,fullExecutionWarnings:(f==null?void 0:f.warnings)??[]}),p.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:p.error}),D&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",i($i)," rows to stay responsive."]}),z.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:z.map((K,re)=>a.jsx("li",{children:K},`${K}-${re}`))})]}),$&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:H,disabled:A,children:A?"Loading rows":`Load next ${i($i)} rows`})}),!$&&!_&&L!==null&&R>=L&&R>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},xl=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],$k=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:s,graphContext:o,profilingGraphSignature:i,formatRelativeTime:c})=>{var H;const[u,d]=v.useState({status:"idle",data:null,error:null}),[p,h]=v.useState(0),[f,g]=v.useState({}),[w,b]=v.useState("500"),[_,x]=v.useState("summary"),[N,C]=v.useState(!1),E=v.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${w}::${i}`,[t,e==null?void 0:e.id,i,w,n]),j=v.useMemo(()=>E?f[E]??null:null,[f,E]);v.useEffect(()=>{b("500"),d({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),v.useEffect(()=>{if(!t){d({status:"idle",data:null,error:null});return}if(!n){d({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!s){d({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(j){d({status:"success",data:j,error:null});return}let q=!0;d({status:"loading",data:null,error:null});const I=xl.find(U=>U.value===w)??xl[1]??xl[0],Q=I.value==="all"?"all":Number(I.value);return oy(n,{sampleSize:Q,graph:o,targetNodeId:(e==null?void 0:e.id)??null}).then(U=>{q&&(E&&U&&g(F=>({...F,[E]:U})),d({status:"success",data:U??null,error:null}))}).catch(U=>{q&&d({status:"error",data:null,error:(U==null?void 0:U.message)??"Unable to generate dataset profile"})}),()=>{q=!1}},[j,o,s,t,e==null?void 0:e.id,p,E,w,n]);const S=u.data,M=(S==null?void 0:S.generated_at)??null,T=((H=S==null?void 0:S.correlations)==null?void 0:H.length)??0;v.useEffect(()=>{C(!1),x("summary")},[t,M]),v.useEffect(()=>{_==="correlations"&&T===0&&x("summary")},[_,T]);const P=v.useCallback(()=>{E&&g(q=>{if(!Object.prototype.hasOwnProperty.call(q,E))return q;const I={...q};return delete I[E],I}),h(q=>q+1)},[E]),L=v.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),$=v.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),A=v.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),R=v.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),W=v.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),z=v.useMemo(()=>xl.find(q=>q.value===w)??xl[0],[w]),D=v.useMemo(()=>c((S==null?void 0:S.generated_at)??null),[c,S==null?void 0:S.generated_at]);return{profileState:u,profileData:S,profilingSamplePreset:w,setProfilingSamplePreset:b,profilingActiveTab:_,setProfilingActiveTab:x,isProfilingWarningsOpen:N,setIsProfilingWarningsOpen:C,handleRefreshDatasetProfile:P,activeProfilingSamplePreset:z,profilingWarningsListId:L,profilingSummaryPanelId:$,profilingCorrelationsPanelId:A,profilingSummaryTabId:R,profilingCorrelationsTabId:W,profilingCorrelationCount:T,relativeProfilingGeneratedAt:D}},Pk=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:s,formatMissingPercentage:o})=>{if(!e)return null;const{profileState:i,profileData:c,profilingSamplePreset:u,setProfilingSamplePreset:d,profilingActiveTab:p,setProfilingActiveTab:h,isProfilingWarningsOpen:f,setIsProfilingWarningsOpen:g,handleRefreshDatasetProfile:w,activeProfilingSamplePreset:b,profilingWarningsListId:_,profilingSummaryPanelId:x,profilingCorrelationsPanelId:N,profilingSummaryTabId:C,profilingCorrelationsTabId:E,profilingCorrelationCount:j,relativeProfilingGeneratedAt:S}=t,M=i.status==="success"&&!!c;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:xl.map(T=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":T.value===u,onClick:()=>d(T.value),disabled:i.status==="loading",children:T.label},T.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:w,disabled:i.status==="loading",children:i.status==="loading"?"Refreshing":"Refresh"})]})]}),S&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",S]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:b.label}),"."]}),i.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),i.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i.error}),M&&c&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",c.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",c.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",c.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",c.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",c.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:C,role:"tab","data-active":p==="summary","aria-selected":p==="summary","aria-controls":x,onClick:()=>h("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:E,role:"tab","data-active":p==="correlations","aria-selected":p==="correlations","aria-controls":N,onClick:()=>h("correlations"),disabled:!j,children:"Correlations"})]}),p==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:x,role:"tabpanel","aria-labelledby":C,children:[c.warnings&&c.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>g(T=>!T),"aria-expanded":f,"aria-controls":_,children:f?"Hide warnings":`Show warnings (${c.warnings.length})`}),f&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:_,children:c.warnings.map((T,P)=>a.jsx("li",{children:T},`profiling-warning-${P}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:c.columns.map(T=>{const P=T.numeric_summary,L=!!P,$=Array.isArray(T.top_values)?T.top_values:[],A=Array.isArray(T.sample_values)?T.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${T.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:T.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:T.semantic_type??T.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${o(T.missing_percentage)} (${T.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:T.distinct_count!==null?T.distinct_count.toLocaleString():""})]})]}),L?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",s(P==null?void 0:P.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",s(P==null?void 0:P.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",s(P==null?void 0:P.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",s(P==null?void 0:P.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",s(P==null?void 0:P.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",s(P==null?void 0:P.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",s(P==null?void 0:P.percentile_75)]})]})]}):null,$.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:$.map((R,W)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(R.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[R.count.toLocaleString()," (",R.percentage.toFixed(1),"%)"]})]},`${T.name}-top-${W}`))})]}):null,A.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:A.slice(0,5).map((R,W)=>a.jsx("li",{children:n(R)},`${T.name}-sample-${W}`))})]}):null]},T.name)})})]}),p==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:N,role:"tabpanel","aria-labelledby":E,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),c.correlations&&c.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:c.correlations.map((T,P)=>{const L=Math.abs(T.coefficient);let $="low";L>=.85?$="extreme":L>=.7?$="strong":L>=.55&&($="moderate");const A=T.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:T.column_a}),a.jsx("td",{children:T.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":$,"data-sign":A,children:T.coefficient.toFixed(2)})]},`profile-correlation-${P}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},Lk=({type:e})=>a.jsx("span",{"aria-hidden":"true",className:`canvas-modal__title-glyph${e==="dataset"?" canvas-modal__title-glyph--dataset":""}`,children:e==="dataset"?"":""}),zk=({title:e,isDataset:t,onClose:n,canResetNode:s=!1,onResetNode:o})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx(Lk,{type:t?"dataset":"default"}),a.jsxs("div",{children:[a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e}),a.jsx("p",{className:"canvas-modal__subtitle",children:t?"Configure how this dataset feeds the pipeline.":"Adjust parameters to control this transformation."})]})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[s&&o&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:o,children:"Reset node"}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",children:""})]})]}),Rk=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:s,canSave:o,onSave:i,isBusy:c,busyLabel:u})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsx("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":c,children:c&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:u??"Processing"})]})}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,children:"Reset node"}),s&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:i,disabled:!o,children:"Save changes"})]})]}),Hs=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),Yn=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},bs=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return Hs(t,n)},xy=e=>e==null||e===""?"":typeof e=="number"?bs(e):String(e),Dk=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},Fk=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},Ik=5,Bk=4,Uk=3,qk="_binned",wy="Missing",Hk=5,Vk="ordinal",Wk="quantile",Kk=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],Yk=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],vh={equal_width:"Equal-width",equal_frequency:"Equal-frequency",custom:"Custom edges",kbins:"KBins (sklearn)"},Gk=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],Pi=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],jy=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",s=Ye(e==null?void 0:e.columns),o=(D,H,q,I)=>{const Q=Number(D);if(!Number.isFinite(Q))return H;const U=Math.round(Q);return Math.max(q,Math.min(I,U))},i=o(e==null?void 0:e.equal_width_bins,Ik,2,200),c=o(e==null?void 0:e.equal_frequency_bins,Bk,2,200),u=o(e==null?void 0:e.precision,Uk,0,8),d=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",p=!!((e==null?void 0:e.include_lowest)??!0),h=!!((e==null?void 0:e.drop_original)??!1),g=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||qk,w=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",b=["range","bin_index","ordinal","column_suffix"].includes(w)?w:"range",x=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",N=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",C=x==="label"&&N||wy,E=o(e==null?void 0:e.kbins_n_bins,Hk,2,200),j=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",S=["ordinal","onehot","onehot-dense"].includes(j)?j:Vk,M=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",T=["uniform","quantile","kmeans"].includes(M)?M:Wk,P=D=>{if(!Array.isArray(D))return[];const q=D.map(I=>{if(typeof I=="number")return I;if(I==null)return Number.NaN;const Q=String(I).trim();return Q?Number(Q):Number.NaN}).filter(I=>Number.isFinite(I)).sort((I,Q)=>I-Q).filter((I,Q,U)=>Q===0||I!==U[Q-1]);return q.length>=2?q:[]},L=D=>Array.isArray(D)?D.map(H=>String(H).trim()).filter(Boolean):typeof D=="string"?D.split(/[\,\n]/).map(H=>H.trim()).filter(Boolean):[],$=(D,H,q)=>{if(D==null)return null;const I=Number(D);if(!Number.isFinite(I))return null;const Q=Math.round(I);return Math.max(H,Math.min(q,Q))},A={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([D,H])=>{const q=String(D??"").trim();if(!q)return;const I=P(H);I.length>=2&&(A[q]=I)});const R={};e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([D,H])=>{const q=String(D??"").trim();if(!q)return;const I=L(H);I.length&&(R[q]=I)});const W={},z=e!=null&&e.column_strategies&&typeof e.column_strategies=="object"&&!Array.isArray(e.column_strategies)?e.column_strategies:e!=null&&e.column_overrides&&typeof e.column_overrides=="object"&&!Array.isArray(e.column_overrides)?e.column_overrides:null;return z&&Object.entries(z).forEach(([D,H])=>{const q=String(D??"").trim();if(!q||!H||typeof H!="object"||Array.isArray(H))return;const I=H,Q={},U=typeof I.strategy=="string"?I.strategy.trim().toLowerCase():"";["equal_width","equal_frequency","custom","kbins"].includes(U)&&(Q.strategy=U);const F=$(I.equal_width_bins,2,200);F!==null&&(Q.equalWidthBins=F);const K=$(I.equal_frequency_bins,2,200);K!==null&&(Q.equalFrequencyBins=K);const re=$(I.kbins_n_bins,2,200);re!==null&&(Q.kbinsNBins=re);const Y=typeof I.kbins_encode=="string"?I.kbins_encode.trim().toLowerCase():"";["ordinal","onehot","onehot-dense"].includes(Y)&&(Q.kbinsEncode=Y);const V=typeof I.kbins_strategy=="string"?I.kbins_strategy.trim().toLowerCase():"";["uniform","quantile","kmeans"].includes(V)&&(Q.kbinsStrategy=V);const G=P(I.custom_bins);G.length>=2&&(Q.customBins=G);const X=L(I.custom_labels);X.length>0&&(Q.customLabels=X),Object.keys(Q).length>0&&(W[q]=Q)}),{strategy:n,columns:s,equalWidthBins:i,equalFrequencyBins:c,includeLowest:p,precision:u,duplicates:d,outputSuffix:g,dropOriginal:h,labelFormat:b,missingStrategy:x,missingLabel:C,customBins:A,customLabels:R,columnStrategies:W,kbinsNBins:E,kbinsEncode:S,kbinsStrategy:T}},Qk=(e,t,n,s=vh)=>{if(!e.length)return null;const o=e.map(i=>{const c=t[i],u=(c==null?void 0:c.strategy)??null;if(!u)return i;const d=s[u]??u,p=[];u==="equal_width"&&(c!=null&&c.equalWidthBins)?p.push(`${c.equalWidthBins} bins`):u==="equal_frequency"&&(c!=null&&c.equalFrequencyBins)?p.push(`${c.equalFrequencyBins} bins`):u==="kbins"&&(c!=null&&c.kbinsNBins&&p.push(`${c.kbinsNBins} bins`),c!=null&&c.kbinsStrategy&&p.push(c.kbinsStrategy),c!=null&&c.kbinsEncode&&p.push(c.kbinsEncode));const h=p.length?` (${p.join(", ")})`:"";return`${i} -> ${d}${h}`});return n>e.length&&o.push(""),o.join(", ")},Xk=({config:e,fieldIds:t,onIntegerChange:n,onBooleanToggle:s,onSuffixChange:o,onLabelFormatChange:i,onMissingStrategyChange:c,onMissingLabelChange:u})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Global output & labeling"}),a.jsx("p",{className:"canvas-modal__note",children:"Applies to every selected column unless custom bins or labels override the defaults."}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.suffix,className:"canvas-modal__parameter-label",children:"Output suffix"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.suffix,type:"text",className:"canvas-modal__input",value:e.outputSuffix,onChange:d=>o(d.target.value),placeholder:"e.g. _binned"})})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.labelFormat,className:"canvas-modal__parameter-label",children:"Label format"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:t.labelFormat,value:e.labelFormat,onChange:d=>i(d.target.value??"range"),children:Yk.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Controls how new bin values are named when custom labels arent provided."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.precision,className:"canvas-modal__parameter-label",children:"Decimal precision"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.precision,type:"number",className:"canvas-modal__input",min:0,max:8,step:1,value:e.precision,onChange:d=>n("precision",d.target.value,0,8)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Sets rounding precision for interval labels."})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.includeLowest,children:"Include lowest edge"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.includeLowest,type:"checkbox",checked:e.includeLowest,onChange:d=>s("include_lowest",d.target.checked)}),"Include the minimum value in the first bin"]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.dropOriginal,children:"Drop original columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.dropOriginal,type:"checkbox",checked:e.dropOriginal,onChange:d=>s("drop_original",d.target.checked)}),"Remove source columns after binning"]})]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:Gk.map(d=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===d.value,onClick:()=>c(d.value),children:d.label},d.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:d=>u(d.target.value),placeholder:"e.g. Missing"})})]})]})]}),Ny=e=>vh[e]??e.replace(/_/g," "),Jk=e=>{switch(e){case"high":return"High confidence";case"medium":return"Medium confidence";case"low":return"Low confidence";default:return"Confidence unknown"}},Zk=(e,t,n)=>{if(!e||typeof e!="object")return"No distribution summary";const s=[];typeof e.valid_count=="number"&&Number.isFinite(e.valid_count)&&s.push(`${t(e.valid_count)} valid rows`),typeof e.distinct_count=="number"&&Number.isFinite(e.distinct_count)&&s.push(`${t(e.distinct_count)} distinct values`);const o=typeof e.minimum=="number"&&Number.isFinite(e.minimum),i=typeof e.maximum=="number"&&Number.isFinite(e.maximum);if(o||i){const c=o?n(e.minimum):"",u=i?n(e.maximum):"";s.push(`Range ${c}  ${u}`)}return typeof e.skewness=="number"&&Number.isFinite(e.skewness)&&s.push(`Skew ${n(e.skewness)}`),s.length?s.join("  "):"No distribution summary"},eM=({hasSource:e,hasReachableSource:t,isFetching:n,error:s,relativeGeneratedAt:o,sampleSize:i,binningConfig:c,binningDefaultLabel:u,binningOverrideCount:d,binningOverrideSummary:p,recommendations:h,excludedColumns:f,numericColumnCount:g,canApplyAllNumeric:w,onApplyAllNumeric:b,onApplyStrategies:_,onClearOverrides:x,customEdgeDrafts:N,customLabelDrafts:C,onOverrideStrategyChange:E,onOverrideNumberChange:j,onOverrideKbinsEncodeChange:S,onOverrideKbinsStrategyChange:M,onOverrideClear:T,onCustomBinsChange:P,onCustomLabelsChange:L,onClearCustomColumn:$,formatMetricValue:A,formatNumericStat:R})=>{const W=v.useMemo(()=>e?t?n?"Diagnostics are loading":s?"Diagnostics are unavailable at the moment.":g>0?`Detected ${g} numeric column${g===1?"":"s"} in the current sample.`:f.length>0?`Diagnostics skipped ${f.length} column${f.length===1?"":"s"} (see details).`:"No additional diagnostics were produced for the current sample.":"Connect this step to an upstream output to surface diagnostics.":"Select a dataset to surface diagnostics.",[s,f.length,t,e,n,g]),z=v.useMemo(()=>{const U=f.slice(0,6),F=Math.max(0,f.length-U.length);return{preview:U,remaining:F}},[f]),D=v.useMemo(()=>{const U=new Map;return h.forEach(F=>{const K=typeof(F==null?void 0:F.column)=="string"?F.column.trim():"";K&&U.set(K,F)}),U},[h]),H=v.useMemo(()=>{const U=new Set;return c.columns.forEach(F=>{const K=String(F??"").trim();K&&U.add(K)}),Object.keys(c.columnStrategies).forEach(F=>{const K=String(F??"").trim();K&&U.add(K)}),h.forEach(F=>{const K=typeof(F==null?void 0:F.column)=="string"?F.column.trim():"";K&&U.add(K)}),Array.from(U).sort((F,K)=>F.localeCompare(K))},[c.columnStrategies,c.columns,h]),q=(U,F)=>{var K;return!U||Object.keys(U).length===0?"__default__":U.strategy?U.strategy:(K=U.customBins)!=null&&K.length?"custom":U.kbinsNBins||U.kbinsEncode||U.kbinsStrategy?"kbins":U.equalFrequencyBins?"equal_frequency":U.equalWidthBins?"equal_width":F},I=e&&t,Q=U=>{var K,re;if(!U)return[];const F=[];return typeof U.equalWidthBins=="number"&&F.push(`${U.equalWidthBins} bins`),typeof U.equalFrequencyBins=="number"&&F.push(`${U.equalFrequencyBins} bins`),typeof U.kbinsNBins=="number"&&F.push(`${U.kbinsNBins} bins`),U.kbinsStrategy&&F.push(U.kbinsStrategy),U.kbinsEncode&&F.push(U.kbinsEncode),(K=U.customBins)!=null&&K.length&&F.push("Custom bins"),(re=U.customLabels)!=null&&re.length&&F.push("Custom labels"),F};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binning diagnostics"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:x,disabled:!d,children:"Clear"}),_&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:_,disabled:!h.length,children:"Quick apply"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:W}),a.jsxs("p",{className:"canvas-modal__note",children:["Default strategy ",a.jsx("strong",{children:u}),d>0?`  Overrides: ${d}${p?` (${p})`:""}`:"  No column overrides yet"]}),a.jsxs("div",{className:"canvas-modal__collapsible",children:[!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface binning insights and column diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),I&&a.jsxs(a.Fragment,{children:[o&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",o,i!==null?` on ${A(i)} row${i===1?"":"s"}.`:"."]}),b&&g>0&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:b,disabled:!w,children:`Add all numeric columns (${g})`})}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binning diagnostics"}),s&&!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s}),!s&&a.jsxs(a.Fragment,{children:[H.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested strategy"}),a.jsx("th",{scope:"col",children:"Configured strategy"}),a.jsx("th",{scope:"col",children:"Distribution highlights"})]})}),a.jsx("tbody",{children:H.map(U=>{var gt,at,ut,Ot,Rt;const F=D.get(U)??null,K=c.columnStrategies[U],re=q(K,c.strategy),Y=re==="__default__"?c.strategy:re,V=(F==null?void 0:F.recommended_strategy)??null,G=!!(V&&V!==Y),X=!!(K&&Object.keys(K).length),se=c.columns.includes(U),J=F==null?void 0:F.recommended_bins,te=typeof J=="number"?J:J!=null?Number(J):null,Se=typeof te=="number"&&Number.isFinite(te)&&te>0?te:null,ze=(K==null?void 0:K.equalWidthBins)??c.equalWidthBins,Oe=(K==null?void 0:K.equalFrequencyBins)??c.equalFrequencyBins,Ue=(K==null?void 0:K.kbinsNBins)??c.kbinsNBins,nt=(K==null?void 0:K.kbinsEncode)??"__default__",He=(K==null?void 0:K.kbinsStrategy)??"__default__",de=["canvas-cast__row"];G&&de.push("canvas-cast__row--attention"),X&&de.push("canvas-cast__row--override"),se||de.push("canvas-cast__row--muted");const _e=Zk(F==null?void 0:F.stats,A,R),je=((gt=F==null?void 0:F.reasons)==null?void 0:gt.filter(Xe=>Xe&&Xe.trim()))??[],Me=(()=>{const Xe=Q(K),Bt=Array.isArray(c.customBins[U])?c.customBins[U].length>=2:!1,Kt=Array.isArray(c.customLabels[U])?c.customLabels[U].length>0:!1,kt=[...Xe];return Bt&&!kt.includes("Custom bins")&&kt.push("Custom bins"),Kt&&!kt.includes("Custom labels")&&kt.push("Custom labels"),kt})(),De=re==="__default__"?`Inheriting ${u}`:`Override  ${Ny(Y)}${Me.length?` (${Me.join(", ")})`:""}`,ce=(F==null?void 0:F.dtype)??null,Te=F?Jk(F.confidence):null,Qe=Object.prototype.hasOwnProperty.call(N,U)?N[U]:((at=c.customBins[U])==null?void 0:at.join(", "))??"",ht=Object.prototype.hasOwnProperty.call(C,U)?C[U]:((ut=c.customLabels[U])==null?void 0:ut.join(", "))??"",rt=(((Ot=c.customBins[U])==null?void 0:Ot.length)??0)>=2||(((Rt=c.customLabels[U])==null?void 0:Rt.length)??0)>0;return a.jsxs("tr",{className:de.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:U}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[ce&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",ce]}),!se&&a.jsx("span",{className:"canvas-cast__muted",children:"Not currently in node"}),X&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),G&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--attention",children:"Needs review"})]})]})}),a.jsx("td",{children:a.jsx("div",{className:"canvas-cast__recommendation",children:F?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-cast__chip canvas-cast__chip--applied",children:Ny(F.recommended_strategy)}),a.jsxs("span",{className:"canvas-cast__recommendation-note",children:[Se!==null?`${Se} bin${Se===1?"":"s"}`:"Bins not provided",Te?`  ${Te}`:""]}),je.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:je.join("; ")})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:re,onChange:Xe=>E(U,Xe.target.value,{recommendedBins:Se}),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",u,")"]}),Kk.map(Xe=>a.jsx("option",{value:Xe.value,children:Xe.label},`${U}-${Xe.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:De}),re==="equal_width"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:ze??"",onChange:Xe=>j(U,"equal_width_bins",Xe.target.value)})]})}),re==="equal_frequency"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Oe??"",onChange:Xe=>j(U,"equal_frequency_bins",Xe.target.value)})]})}),re==="kbins"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Max bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Ue??"",onChange:Xe=>j(U,"kbins_n_bins",Xe.target.value)})]}),a.jsxs("label",{children:["Encode",a.jsxs("select",{value:nt,onChange:Xe=>S(U,Xe.target.value==="__default__"?null:Xe.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsEncode,")"]}),a.jsx("option",{value:"ordinal",children:"Ordinal"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})]}),a.jsxs("label",{children:["Strategy",a.jsxs("select",{value:He,onChange:Xe=>M(U,Xe.target.value==="__default__"?null:Xe.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsStrategy,")"]}),a.jsx("option",{value:"uniform",children:"Uniform"}),a.jsx("option",{value:"quantile",children:"Quantile"}),a.jsx("option",{value:"kmeans",children:"K-means"})]})]})]}),re==="custom"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Custom edges",a.jsx("input",{type:"text",className:"canvas-modal__input",value:Qe,placeholder:"e.g. 0, 50, 100",onChange:Xe=>P(U,Xe.target.value)})]}),a.jsxs("label",{children:["Optional labels",a.jsx("input",{type:"text",className:"canvas-modal__input",value:ht,placeholder:"e.g. Low, Medium, High",onChange:Xe=>L(U,Xe.target.value)})]}),rt&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>$(U),children:"Clear custom edges"})]}),X&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>T(U),children:"Clear"})]})}),a.jsx("td",{children:a.jsx("span",{children:_e})})]},`binning-insight-${U}`)})})]})})}),!n&&H.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"No columns met the sampling requirements for binning recommendations."}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",f.length," column",f.length===1?"":"s"," due to non-numeric values or limited variance",z.preview.length>0&&a.jsxs(a.Fragment,{children:[":"," ",z.preview.map(U=>`${U.column}${U.reason?` (${U.reason})`:""}`).join(", "),z.remaining>0?`,  (+${z.remaining} more)`:""]}),"."]})]})]})]})]})},tM=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:s,sampleSize:o,relativeGeneratedAt:i,error:c,onRefresh:u,canRefresh:d})=>{const p=v.useMemo(()=>Pi.find(h=>h.value===t)??Pi[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:Pi.map(h=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":h.value===t,onClick:()=>n(h.value),disabled:s,children:h.label},h.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:u,disabled:s||!d,children:s?"Refreshing":"Refresh"})]})]}),o!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:p.label}),"."," ",p.value==="all"?`Summaries computed from the full dataset (${o.toLocaleString()} rows).`:`Summaries computed from ${o.toLocaleString()} sampled rows.`]}),i&&a.jsxs("p",{className:"canvas-modal__note",children:["Updated ",i]}),s&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!s&&c&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:c}),!s&&!c&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(h=>{const f=h.topPercentage!==null?`${h.topPercentage.toFixed(1)}%`:null,g=h.topCount!==null?`${h.topCount.toLocaleString()}${f?`  ${f}`:""}`:f??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:h.column}),h.sourceColumn&&h.sourceColumn!==h.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:h.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:h.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:g})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:h.bins.map(w=>{const b=w.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",_=Math.min(100,Math.max(0,w.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:b,children:w.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${_}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:w.count.toLocaleString()}),a.jsxs("span",{children:[w.percentage.toFixed(1),"%"]})]})]},`${h.column}-${w.label}`)})}),h.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",h.bins.length," of ",h.totalBinCount," bins."]})]},`binned-card-${h.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},nM=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],sM=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],rM=[...nM,...sM],aM=[0,5,10,20,40,60],oM=["float","double","int","uint","long","short","byte","number","decimal"],lM=["bool","boolean"],iM=["object","string","category","datetime","date","time"],cM=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:iM.some(n=>t.includes(n))?!1:!!(oM.some(n=>t.includes(n))||lM.some(n=>t.includes(n)))},Cy=e=>e!=="mode",Sy=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},Li=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,s=Number(n);return{neighbors:Number.isFinite(s)?Math.max(1,Math.round(s)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,s=Number(n);return{max_iter:Number.isFinite(s)?Math.max(1,Math.round(s)):10}}},Ey=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",s=new Set(t);return e.map(o=>{if(!o||typeof o!="object")return null;const i=typeof o.method=="string"?o.method.trim().toLowerCase():n,c=s.has(i)?i:n;let u=[];Array.isArray(o.columns)?u=o.columns.map(f=>String(f).trim()).filter(Boolean):typeof o.columns=="string"&&(u=o.columns.split(",").map(f=>f.trim()).filter(Boolean));const d=o.options&&typeof o.options=="object"?o.options:{};let p;if(c==="knn"){const f=d.neighbors??o.neighbors,g=Number(f);p={neighbors:Number.isFinite(g)?Math.max(1,Math.round(g)):5}}else if(c==="regression"||c==="mice"){const f=d.max_iter??d.maxIter??o.max_iter??o.maxIter,g=Number(f);p={max_iter:Number.isFinite(g)?Math.max(1,Math.round(g)):10}}const h=Li(c,p??Sy(c));return{method:c,columns:u,options:h}}).filter(o=>!!o)},uM=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),dM=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:s,methodOptions:o,missingFilter:i,missingFilterMax:c,missingFilterActive:u,filteredOptionCount:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onMethodChange:w,onOptionNumberChange:b,onColumnsChange:_,onColumnToggle:x,onMissingFilterChange:N,formatMissingPercentage:C,formatNumericStat:E,formatModeStat:j,schemaDiagnostics:S})=>{const M=ve.useMemo(()=>{var $;return($=S==null?void 0:S.entries)!=null&&$.length?new Map(S.entries.map(A=>[A.index,A])):new Map},[S]),T=Math.max(c,i||0),P=s.length>0,L=$=>{var R,W,z;const A=((R=o.find(D=>D.value===$.method))==null?void 0:R.label)??$.method;return $.method==="knn"&&((W=$.options)!=null&&W.neighbors)?`${A}  k=${$.options.neighbors}`:($.method==="regression"||$.method==="mice")&&((z=$.options)!=null&&z.max_iter)?`${A}  ${$.options.max_iter} iter`:A};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(S==null?void 0:S.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S.message}),s.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",d," of ",s.length," column",s.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx("input",{id:"imputer-missing-filter",type:"range",min:0,max:T,step:1,value:i,onChange:$=>N(Number($.target.value)),className:"canvas-imputer__filter-range"}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[i,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>N(0),disabled:!i,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:aM.map($=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${i===$?" canvas-imputer__filter-button--active":""}`,onClick:()=>N($),children:["",$,"%"]},`imputer-missing-preset-${$}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map(($,A)=>{var K,re,Y;const R=$.columns.join(", "),W=Cy($.method),z=s.filter(V=>{if($.columns.includes(V.name))return!0;if(W&&!cM(V))return!1;const G=typeof V.missingPercentage=="number"?V.missingPercentage:null;return G!==null?G<=0?!1:G>=i:i===0}),D=L($),H=$.columns.length?`${$.columns.length} column${$.columns.length===1?"":"s"}`:"No columns yet",q=p.has(A),I=z.filter(V=>!$.columns.includes(V.name)),Q=M.get(A),U=(K=Q==null?void 0:Q.details)!=null&&K.length?Q.details.map(V=>V.logical_family?`${V.name} (${V.logical_family})`:V.name).join(", "):"",F=()=>{if(!z.length)return;const V=[...$.columns];z.forEach(G=>{V.includes(G.name)||V.push(G.name)}),_(A,V.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(A),"aria-expanded":!q,"aria-controls":`imputer-strategy-body-${A}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${q?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",A+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[D,"  ",H]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(A),"aria-label":`Remove strategy ${A+1}`,children:"Remove"})]}),!q&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${A}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Method"}),a.jsx("select",{value:$.method,onChange:V=>w(A,V.target.value??"mean"),children:o.map(V=>a.jsx("option",{value:V.value,children:V.label},V.value))})]}),$.method==="knn"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Neighbors (k)"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:50,step:1,value:((re=$.options)==null?void 0:re.neighbors)??5,onChange:V=>b(A,"neighbors",V.target.value)})]}),($.method==="regression"||$.method==="mice")&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Max iterations"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:100,step:1,value:((Y=$.options)==null?void 0:Y.max_iter)??10,onChange:V=>b(A,"max_iter",V.target.value)})]}),$.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),U&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",U,"."]}),z.length>0&&I.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:F,children:"Select all columns"}),z.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:z.map(V=>{const G=$.columns.includes(V.name),X=C(V.missingPercentage),se=typeof V.mean=="number",J=typeof V.median=="number",te=V.mode!==null&&V.mode!==void 0&&V.mode!=="",Se=se||J||te;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${G?" canvas-imputer__column-pill--selected":""}`,onClick:()=>x(A,V.name),"aria-pressed":G,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:V.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",X]}),V.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:V.dtype})]}),Se&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[se&&a.jsxs("span",{children:["Mean: ",E(V.mean)]}),J&&a.jsxs("span",{children:["Median: ",E(V.median)]}),te&&a.jsxs("span",{children:["Mode: ",j(V.mode)]})]})]},V.name)})}):a.jsx("p",{className:"canvas-modal__note",children:P?u?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${$.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:$.columns.length?$.columns.map(V=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:V},V)):a.jsx("span",{children:"No columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Manual columns (optional)"}),a.jsx("input",{type:"text",className:"canvas-imputer__columns-input",value:R,onChange:V=>_(A,V.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${A}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},mM=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:s,scalingMethodOptions:o,scalingMethodDetailMap:i,scalingDefaultDetail:c,scalingAutoDetectEnabled:u,scalingSelectedCount:d,scalingDefaultLabel:p,scalingOverrideCount:h,scalingOverrideExampleSummary:f,scalingRecommendationRows:g,scalingHasRecommendations:w,scalingStatusMessage:b,scalingError:_,scalingSampleSize:x,relativeScalingGeneratedAt:N,formatMetricValue:C,formatNumericStat:E,formatMissingPercentage:j,onApplyAllRecommendations:S,onClearOverrides:M,onDefaultMethodChange:T,onAutoDetectToggle:P,onOverrideSelect:L})=>{const $=c??i.get(s.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:S,disabled:!w,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:M,disabled:!h,children:"Clear overrides"})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),N&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",N,x!==null?` on ${C(x)} row${x===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:o.map(A=>{const R=i.get(A.value)??null,W=A.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${W?" canvas-scaling__method-button--active":""}`,"aria-pressed":W,onClick:()=>T(A.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:A.label}),(R==null?void 0:R.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:R.description})]},A.value)})}),($==null?void 0:$.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:$.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:A=>P(A.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"When enabled, recommended numeric features join this node automatically after each refresh."})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",h>0?`  Overrides: ${h}${f?` (${f})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&_&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:_}),!n&&!_&&a.jsxs(a.Fragment,{children:[b&&a.jsx("p",{className:"canvas-modal__note",children:b}),g.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:g.map(A=>{const R=!A.isSkipped&&A.recommendedMethod!==A.currentMethod,W=["canvas-cast__row"];R&&W.push("canvas-cast__row--attention"),A.isOverrideApplied&&W.push("canvas-cast__row--override"),A.isSkipped&&W.push("canvas-cast__row--muted");const z=A.isSkipped?"__skip__":A.isOverrideApplied?A.currentMethod:"__default__",D=A.isOverrideApplied?`Override -> ${A.currentMethodLabel}`:A.isSkipped?"Skipped (column will not be scaled)":A.isSelected?`Inheriting ${p}`:"Pending inclusion",H=A.stats,q=[];typeof H.valid_count=="number"&&Number.isFinite(H.valid_count)&&q.push(`${C(H.valid_count)} valid rows`),typeof H.mean=="number"&&Number.isFinite(H.mean)&&q.push(`Mean ${E(H.mean)}`),typeof H.median=="number"&&Number.isFinite(H.median)&&q.push(`Median ${E(H.median)}`),typeof H.stddev=="number"&&Number.isFinite(H.stddev)&&q.push(` ${E(H.stddev)}`),typeof H.iqr=="number"&&Number.isFinite(H.iqr)&&q.push(`IQR ${E(H.iqr)}`);const I=typeof H.minimum=="number"&&Number.isFinite(H.minimum),Q=typeof H.maximum=="number"&&Number.isFinite(H.maximum);if(I||Q){const F=I?E(H.minimum):"",K=Q?E(H.maximum):"";q.push(`Range ${F}  ${K}`)}typeof H.skewness=="number"&&Number.isFinite(H.skewness)&&q.push(`Skew ${E(H.skewness)}`),typeof H.outlier_ratio=="number"&&Number.isFinite(H.outlier_ratio)&&H.outlier_ratio>0&&q.push(`${j(H.outlier_ratio*100)} outliers`);const U=q.length?q.join("  "):null;return a.jsxs("tr",{className:W.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:A.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[A.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",A.dtype]}),A.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),A.isSelected&&!A.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),A.isSkipped&&!A.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),A.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${R?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:A.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:A.confidenceLabel}),A.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:A.reasons.join("; ")})]})}),a.jsx("td",{children:U?a.jsx("span",{children:U}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:z,onChange:F=>L(A.column,F.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),o.map(F=>a.jsx("option",{value:F.value,children:F.label},`${A.column}-${F.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:D})]})})]},`scaling-row-${A.column}`)})})]})})})]})]})},ju=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],hM="log",Vr=e=>typeof e=="string"&&ju.includes(e),ky=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",s=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const o=Vr(s)?s:hM;return{column:n,method:o}}).filter(t=>!!t):[],yh=e=>{const t=new Set,n=[];return e.forEach(s=>{const o=`${s.column}__${s.method}`;t.has(o)||(t.add(o),n.push(s))}),n},My={left:"Left skew",right:"Right skew"},fM={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},pM=e=>{const t={...fM};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",o=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!s||!o||Vr(s)&&(t[s]=o)}),t},gM=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:s,transformationMap:o})=>{const i=e==="recommended"?t.map(d=>d!=null&&d.column?d.column:null).filter(d=>!!d):n,c=new Set,u=[];return i.forEach(d=>{const p=typeof d=="string"?d.trim():"";if(!p||c.has(p))return;c.add(p);const h=s.get(p)??null,f=h?h.recommended_methods.filter(Vr):[],g=f.length?f[0]:null,w=h!=null&&h.direction?My[h.direction]??h.direction:null,b=h!=null&&h.magnitude?`${h.magnitude.charAt(0).toUpperCase()}${h.magnitude.slice(1)}`:null,_=h&&typeof h.skewness=="number"&&Number.isFinite(h.skewness)?h.skewness:null,x=(h==null?void 0:h.summary)??null,N=o.get(p)??null;u.push({column:p,recommendedMethods:f,primaryMethod:g,directionLabel:w,magnitudeLabel:b,skewnessValue:_,summary:x,selectedMethod:N})}),u.sort((d,p)=>{const h=typeof d.skewnessValue=="number"?Math.abs(d.skewnessValue):-1/0,f=typeof p.skewnessValue=="number"?Math.abs(p.skewnessValue):-1/0;if(h!==f)return f-h;const g=!!d.primaryMethod,w=!!p.primaryMethod;return g!==w?g?-1:1:d.column.localeCompare(p.column)}),u},_M=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const s="no-recommendation",o=new Map;e.forEach(c=>{const u=c.primaryMethod??null,d=u??s,p=u?n(u):"No recommended action",h=o.get(d)??{key:d,label:p,method:u,rows:[]};h.rows.push(c),o.set(d,h)});const i=Array.from(o.values());return i.sort((c,u)=>{const d=g=>g?ju.indexOf(g):ju.length,p=d(c.method)-d(u.method);if(p!==0)return p;if(c.rows.length!==u.rows.length)return u.rows.length-c.rows.length;const h=c.label??"",f=u.label??"";return h.localeCompare(f)}),i},vM=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:s,skewnessError:o,skewnessViewMode:i,skewnessRecommendedCount:c,skewnessNumericCount:u,skewnessGroupByMethod:d,skewnessRows:p,skewnessTableGroups:h,hasSkewnessAutoRecommendations:f,skewnessTransformationsCount:g,isFetchingRecommendations:w,getSkewnessMethodLabel:b,getSkewnessMethodStatus:_,onApplyRecommendations:x,onViewModeChange:N,onGroupByToggle:C,onOverrideChange:E,onClearSelections:j})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:x,disabled:w||!f,children:"Apply recommendations"})})]}),s!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",s.toFixed(2)," are surfaced below."]}),n&&p.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&o&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:o}),(!n||p.length>0)&&!o&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="recommended",onClick:()=>N("recommended"),disabled:!c,children:["Recommended (",c,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="all",onClick:()=>N("all"),disabled:!u,children:["All numeric (",u,")"]})]}),a.jsxs("label",{className:"canvas-skewness__toggle",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:S=>C(S.target.checked)}),"Group columns by recommended action"]})]}),p.length===0?a.jsx("p",{className:"canvas-modal__note",children:i==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:h.map(S=>a.jsxs("div",{className:"canvas-skewness__group",children:[S.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:S.label}),a.jsxs("span",{children:[S.rows.length," column",S.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:S.rows.map(M=>{const T=[];M.directionLabel&&T.push(M.directionLabel),M.skewnessValue!==null&&T.push(`(${M.skewnessValue.toFixed(2)})`),M.magnitudeLabel&&T.push(` ${M.magnitudeLabel}`);const P=T.length?T.join(" "):"",L=M.selectedMethod??"",$=new Set(M.recommendedMethods),A=[{value:"",label:"No transform",status:null,reason:null}];M.recommendedMethods.forEach(z=>{const D=_(M.column,z);A.push({value:z,label:`${b(z)}${z===M.primaryMethod?" (recommended)":""}`,status:D,reason:(D==null?void 0:D.reason)??null})}),ju.forEach(z=>{if($.has(z))return;const D=_(M.column,z);A.push({value:z,label:b(z),status:D,reason:(D==null?void 0:D.reason)??null})});const R=M.selectedMethod?_(M.column,M.selectedMethod):null,W=!M.selectedMethod&&M.primaryMethod?_(M.column,M.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${M.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:M.column}),M.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:M.summary})]})}),a.jsx("td",{children:M.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${M.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:M.primaryMethod?b(M.primaryMethod):b(M.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:P})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx("select",{value:L,onChange:z=>E(M.column,z.target.value),disabled:w||!t,children:A.map(z=>{var q;const D=z.reason?`${z.label} (caution: ${z.reason})`:z.label,H=((q=z.status)==null?void 0:q.status)??"ready";return a.jsx("option",{value:z.value,"data-status":H,children:D},`skewness-option-${M.column}-${z.value||"none"}`)})}),R&&R.status!=="ready"&&R.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",R.reason]}),!M.selectedMethod&&W&&W.status!=="ready"&&W.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",W.reason]})]})})]},`skewness-row-${M.column}`)})})]})})]},`skewness-group-${S.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:g?`${g} transformation${g===1?"":"s"} configured`:"No transformations configured yet."}),g>0&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:j,children:"Clear selections"})]})]})]}),yM=({counts:e,binEdges:t,className:n})=>{const s=v.useId(),o=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:o,"aria-hidden":"true"});const i=e.reduce((d,p)=>Math.max(d,p),0),c=i>0?i:1,u=100/e.length;return a.jsx("div",{className:o,role:"img","aria-label":"Histogram sparkline",children:a.jsxs("svg",{viewBox:"0 0 100 60",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((d,p)=>{const h=d/c*52,f=p*u,g=58-h,w=Math.max(u-2,1);return a.jsx("rect",{x:f+1,y:g,width:w,height:h,rx:1.2,ry:1.2,fill:`url(#${s})`},`hist-bin-${p}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},bM=({skewnessThreshold:e,isFetchingSkewness:t,skewnessError:n,skewnessDistributionCards:s,skewnessDistributionView:o,setSkewnessDistributionView:i,onRefresh:c,canRefresh:u})=>{const d=(p,h,f)=>{const g=Math.max(0,p.sample_size||0),w=Math.max(0,p.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:h}),f?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:f}):null]}),a.jsx(yM,{counts:p.counts,binEdges:p.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:bs(p.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:bs(p.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:bs(p.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:bs(p.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:bs(p.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:g.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:w.toLocaleString()})]})]})]},h)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":o==="before",onClick:()=>i("before"),disabled:!s.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":o==="after",onClick:()=>i("after"),disabled:!s.length,children:"After"})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:c,disabled:t||!u,children:t?"Refreshing":"Refresh"})]})]}),e!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",e.toFixed(2)," are visualized below."]}),t&&s.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!t&&n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n}),(!t||s.length>0)&&!n&&(s.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:s.map(p=>{const h=p.distributionAfter,f=o==="before",g=o==="after"&&!!h,w=o==="after"&&!h,b=o==="before"?"Showing the original distribution returned by the skewness analysis.":h?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${p.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:p.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[p.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.directionLabel}),p.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.magnitudeLabel}),p.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",p.recommendedLabel]}),p.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",p.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:p.skewness!==null?Hs(p.skewness,2):""})]})]}),p.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:p.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[f?d(p.distributionBefore,"Before transform"):null,g&&h?d(h,"After transform",p.appliedLabel):null,w?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",b]})]},`skewness-dist-${p.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]})},xM=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:s,flaggedColumnsInDataset:o,conflictCount:i}=t,c=s.length>0,u=e||"(no suffix)",d=o.slice(0,4),p=Math.max(o.length-d.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:s.length})," flag column",s.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:u}),"."]}),o.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",o.length," existing flag column",o.length===1?"":"s"," ","with this suffix",d.length>0?` (examples: ${d.join(", ")}${p>0?", ":""})`:"","."]}),i>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i," generated flag column",i===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),c?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:s.map(h=>{const f=[];h.conflicts.alreadyExists&&f.push("Already exists"),h.conflicts.duplicateFlag&&f.push("Duplicate name");const g=f.length>0,w=g?f.join("  "):"Ready",b=g?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",_=g?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:_,children:[a.jsx("th",{scope:"row",children:h.column}),a.jsx("td",{children:n(h.missingPercentage)}),a.jsx("td",{children:h.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:b,children:w})})]},`missing-indicator-${h.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},Ay=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],bh="canonicalize_country_codes",wM=new Set(Ay),jM=["string","object","text","category","mixed","varchar","char"],NM=4,CM=6,wo=4,SM=3,Oy=36,EM=5,xh={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},Ty=Ay.map(e=>{var t;return{value:e,label:((t=xh[e])==null?void 0:t.label)??e}}),kM=new Set(["true","1","yes","y","on"]),MM=new Set(["false","0","no","n","off"]),AM=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(kM.has(n))return!0;if(MM.has(n))return!1}return t},wh=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?wh(e.split(",")):[],$y=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,s=wh(n.columns),o=AM(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),i=Cu(typeof n.mode=="string"?n.mode:void 0,t.mode);return!s.length&&!o?null:{mode:i,columns:s,autoDetect:o}},Py=(e,t)=>{const n={mode:t.mode,columns:wh(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const o=$y(e,n);return o?[o]:[n]}const s=[];return e.forEach(o=>{const i=$y(o,n);i&&s.push(i)}),s.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):s},OM=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),TM=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),Nu=e=>e.length<=Oy?e:`${e.slice(0,Oy-1)}...`,Ly=e=>wM.has(e),zy=e=>{if(!e)return!1;const t=e.toLowerCase();return jM.some(n=>t.includes(n))},Cu=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Ly(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Ly(s)?s:bh},$M=e=>{const t=xh[e]??xh[bh];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},PM=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:s})=>{const o=Array.from(new Set(Ye(e))),i=new Set(o),c=t.filter(h=>zy(n[h]??null)),u=c.filter(h=>!i.has(h)),d=o.filter(h=>!zy(n[h]??null)),p=typeof s=="boolean"?s:o.length===0;return{selectedColumns:o,nonTextSelected:d,autoDetectionActive:p,recommendedColumns:u,textColumnCount:c.length,textColumns:c}},LM=/[\n;,]+/,wl=(e,t)=>e.slice(0,t),Su=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[s,...o]=n,i=o.join(t);return[s,i]},zM=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],s=[],o=new Map;let i=0;const c=(h,f)=>{const g=String(h??"").trim(),w=String(f??"").trim();if(!g||!w){(g||w)&&n.push(`${g} => ${w}`.trim());return}const b=TM(g);if(!b){n.push(`${g} => ${w}`);return}o.has(b)?t.add(g):(o.set(b,w),s.length<NM&&s.push(`${g} => ${w}`)),i+=1};if(typeof e=="string"){e.split(LM).forEach(b=>{const _=b.trim();if(_){if(_.includes("=>")){const x=Su(_,"=>");x?c(x[0],x[1]):n.push(_);return}if(_.includes(":")){const x=Su(_,":");x?c(x[0],x[1]):n.push(_);return}n.push(_)}});const f=Array.from(t),g=wl(f,wo),w=wl(n,wo);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:g,duplicateOverflow:Math.max(f.length-g.length,0),invalidEntries:w,invalidOverflow:Math.max(n.length-w.length,0)}}if(Array.isArray(e)){e.forEach(w=>{if(w){if(typeof w=="string"){const b=w.trim();if(!b)return;if(b.includes("=>")){const _=Su(b,"=>");_?c(_[0],_[1]):n.push(b)}else if(b.includes(":")){const _=Su(b,":");_?c(_[0],_[1]):n.push(b)}else n.push(b);return}if(typeof w=="object"){const{alias:b,replacement:_}=w;c(b,_);return}n.push(String(w))}});const h=Array.from(t),f=wl(h,wo),g=wl(n,wo);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:f,duplicateOverflow:Math.max(h.length-f.length,0),invalidEntries:g,invalidOverflow:Math.max(n.length-g.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([h,f])=>{c(h,f)});const u=Array.from(t),d=wl(u,wo),p=wl(n,wo);return{totalPairs:i,previewPairs:s,previewOverflow:Math.max(i-s.length,0),duplicates:d,duplicateOverflow:Math.max(u.length-d.length,0),invalidEntries:p,invalidOverflow:Math.max(n.length-p.length,0)}},RM=e=>{const t=e.slice(0,CM);return{preview:t,remaining:Math.max(e.length-t.length,0)}},DM=e=>{const t=e.slice(0,wo);return{preview:t,remaining:Math.max(e.length-t.length,0)}},FM=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Nu(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?Nu(t):null}try{const t=JSON.stringify(e);return t?Nu(t):null}catch{return Nu(String(e))}},IM=(e,t=SM)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([o,i])=>{const c=typeof o=="string"?o.trim():"";if(!c)return;const u=FM(i);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},BM=(e,t,n=EM)=>{if(!t.length)return[];const s=[];for(const o of t){if(s.length>=n)break;const i=e[o];!i||!i.length||s.push({column:o,values:i,overflow:0})}return s},jh=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),Ry=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],Dy=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);Ry.forEach(e=>{e.forEach(t=>Dy.add(jh(t)))});const Fy=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],Iy=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);Fy.forEach(e=>{e.forEach(t=>Iy.add(jh(t)))});const UM=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],qM=/^[A-Za-z]{2,3}$/,HM=/[^0-9A-Za-z\s]/,VM=/[^0-9A-Za-z]+/,Eu={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:Ry},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:Fy},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:UM},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},WM=e=>{const t=[];return e.forEach(n=>{n.split(VM).filter(Boolean).forEach(o=>{t.push(o)})}),t},KM=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(s=>HM.test(s));const n=WM(t).map(s=>jh(s));return n.length?e==="canonicalize_country_codes"?n.some(s=>Dy.has(s))||t.some(s=>qM.test(s.trim())):e==="normalize_boolean"?n.some(s=>Iy.has(s)):!1:!1},By=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},YM=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:o,sampleMap:i,modeOptions:c=Ty,customPairSummary:u,customPairsParameter:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onModeChange:w,onAutoDetectToggle:b,onColumnToggle:_,onColumnsChange:x,renderParameterField:N})=>{const C=n.length>0,E=s.selectedColumns.length,j=v.useMemo(()=>RM(s.recommendedColumns),[s.recommendedColumns]),S=v.useMemo(()=>DM(s.nonTextSelected),[s.nonTextSelected]),M=v.useMemo(()=>BM(i,s.selectedColumns),[s.selectedColumns,i]),T=!e||!t,P=u.duplicates.length+u.duplicateOverflow,L=u.invalidEntries.length+u.invalidOverflow,$=u.duplicates.join(", "),A=u.invalidEntries.join(", "),R=v.useMemo(()=>n.some(Y=>Y.mode==="custom"),[n]),W=v.useMemo(()=>{const Y=new Map;return n.forEach(V=>{V.columns.forEach(G=>{const X=G.trim();X&&Y.set(X,(Y.get(X)??0)+1)})}),Y},[n]),[z,D]=v.useState(()=>new Set),H=v.useCallback(Y=>{D(V=>{const G=new Set(V);return G.has(Y)?G.delete(Y):G.add(Y),G})},[]);v.useEffect(()=>{D(Y=>{const V=new Set;return Y.forEach(G=>{G<n.length&&V.add(G)}),V.size===Y.size?Y:V})},[n.length]);const[q,I]=v.useState(()=>({index:null,mode:null})),Q=v.useMemo(()=>{const Y=new Map;return o.forEach(V=>{const G=Array.isArray(V.samples)?V.samples:[],X=Array.isArray(i[V.name])?i[V.name]:[],se=[...G,...X].map(J=>String(J??"").trim()).filter(J=>J.length>0);Y.set(V.name,se.slice(0,12))}),Y},[o,i]),U=v.useMemo(()=>{const Y=new Map;return o.forEach(V=>{const G=Q.get(V.name)??[],X=G.length?G:[V.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(se=>{KM(se,X)&&(Y.has(se)||Y.set(se,new Set),Y.get(se).add(V.name))})}),Y},[o,Q]);v.useEffect(()=>{if(q.index===null)return;const Y=n[q.index];(!Y||Y.mode!==q.mode)&&I({index:null,mode:null})},[q.index,q.mode,n]);const F=v.useCallback((Y,V)=>{I({index:Y,mode:V})},[]),K=v.useCallback(()=>{I({index:null,mode:null})},[]);let re=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),s.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:E})," column",E===1?"":"s"," across all strategies."]}),M.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",M.map(Y=>`${Y.column} (${Y.values.join(", ")})`).join("; "),"."]}),s.textColumnCount>0&&j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.preview.join(", ")," ",S.preview.length===1?"is":"are"," not text-like.",S.remaining>0?` ${S.remaining} more column${S.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),T?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!C&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),C&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((Y,V)=>{var De;const G=$M(Y.mode),X=((De=c.find(ce=>ce.value===Y.mode))==null?void 0:De.label)??G.label,se=Y.columns.length,J=se?`${se} column${se===1?"":"s"}`:Y.autoDetect?"Auto-detecting columns":"No columns yet",te=p.has(V),Se=z.has(V),ze=Y.columns.join(", "),Oe=U.get(Y.mode)??new Set,Ue=Y.mode==="custom"&&!!d&&!re,nt=Y.mode==="custom"&&!!d&&re;Ue&&(re=!0);const He=o.map(ce=>{const Te=Y.columns.includes(ce.name),Qe=Oe.has(ce.name),ht=Te?0:Qe?1:ce.isRecommended?2:ce.isTextLike?3:4;return{option:ce,priority:ht}}).sort((ce,Te)=>ce.priority!==Te.priority?ce.priority-Te.priority:ce.option.name.localeCompare(Te.option.name)).map(ce=>ce.option),de=Oe.size>0,_e=He.filter(ce=>Y.columns.includes(ce.name)?!0:de?Oe.has(ce.name):ce.isRecommended||ce.isTextLike),je=new Set(_e.map(ce=>ce.name)),Me=He.filter(ce=>!je.has(ce.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(V),"aria-expanded":!te,"aria-controls":`alias-strategy-body-${V}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${te?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",V+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[X,Y.autoDetect?"  auto-detect":"",J?`  ${J}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(V),"aria-label":`Remove alias strategy ${V+1}`,children:"Remove"})]}),!te&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${V}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[c.map(ce=>{const Te=ce.value===Y.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${Te?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":Te,onClick:()=>w(V,ce.value),children:ce.label},ce.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>F(V,Y.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:G.guidance})]}),q.index===V&&q.mode===Y.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:Eu[Y.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:K,children:"Close"})]}),a.jsx("p",{children:Eu[Y.mode].description}),Eu[Y.mode].preview&&a.jsx("ul",{children:Eu[Y.mode].preview.map(([ce,Te])=>a.jsxs("li",{children:[ce," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",Te]},`${ce}-${Te}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${V}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${V}-auto-detect`,type:"checkbox",checked:Y.autoDetect,onChange:ce=>b(V,ce.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${V}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),o.length?a.jsxs(a.Fragment,{children:[Oe.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",X.toLowerCase()," entries."]}),_e.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${V+1}`,children:_e.map(ce=>{const Te=Y.columns.includes(ce.name),Qe=By(ce.samples.length?ce.samples:i[ce.name]??[]),rt=(W.get(ce.name)??0)-(Te?1:0)>0,gt=Oe.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Te?" canvas-imputer__column-pill--selected":""}`,onClick:()=>_(V,ce.name),"aria-pressed":Te,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),ce.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),gt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),rt&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Qe&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Qe]})]},ce.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),Me.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>H(V),"aria-expanded":Se,"aria-controls":`alias-strategy-${V}-other-columns`,children:Se?"Hide other columns":`Show other columns (${Me.length})`}),Se&&a.jsx("div",{id:`alias-strategy-${V}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${V+1}`,children:Me.map(ce=>{const Te=Y.columns.includes(ce.name),Qe=By(ce.samples.length?ce.samples:i[ce.name]??[]),rt=(W.get(ce.name)??0)-(Te?1:0)>0,gt=Oe.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Te?" canvas-imputer__column-pill--selected":""}`,onClick:()=>_(V,ce.name),"aria-pressed":Te,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),gt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),rt&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Qe&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Qe]})]},ce.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${Y.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:Y.columns.length?Y.columns.map(ce=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:ce},ce)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${V}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${V}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:ze,onChange:ce=>x(V,ce.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),Y.mode==="custom"&&d&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Ue?N(d):nt?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${V}`)})}),u.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[u.totalPairs," custom pair",u.totalPairs===1?"":"s"," captured.",R?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",u.previewPairs.length>0?` Examples: ${u.previewPairs.join("; ")}${u.previewOverflow>0?"...":""}`:""]}),u.totalPairs===0&&R&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),P>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",$?`: ${$}`:"",u.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),L>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",L," incomplete pair",L===1?"":"s",".",A?` Examples: ${A}${u.invalidOverflow>0?"...":""}`:""]})]})},ku=["iso_date","iso_datetime","month_day_year","day_month_year"],GM="iso_date",QM=["date","time","timestamp","datetime"],XM=3,Uy=36,zi={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},Nh=ku.map(e=>({value:e,label:zi[e].label,guidance:zi[e].guidance,example:zi[e].example})),JM=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],qy=e=>e.length<=Uy?e:`${e.slice(0,Uy-1)}...`,Hy=e=>{if(!e)return!1;const t=e.toLowerCase();return QM.some(n=>t.includes(n))},ZM=e=>JM.some(t=>t.test(e)),Vy=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&ku.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&ku.includes(s)?s:GM},eA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s||!s.length)return;const o=s.length;let i=0;if(s.forEach(u=>{ZM(u)&&(i+=1)}),!o)return;i/o>=.6&&i>=2&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},tA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const o=Array.from(new Set(Ye(e)));o.sort((g,w)=>g.localeCompare(w));const i=new Set(o),c=t.filter(g=>Hy(n[g]??null)),u=eA(s),d=new Set;c.forEach(g=>{i.has(g)||d.add(g)}),u.forEach(g=>{i.has(g)||d.add(g)});const p=Array.from(d);p.sort((g,w)=>g.localeCompare(w));const h=o.filter(g=>!(Hy(n[g]??null)||u.includes(g))),f=u.slice().sort((g,w)=>g.localeCompare(w));return{selectedColumns:o,autoDetectionActive:o.length===0,recommendedColumns:p,nonDateSelected:h,dateColumnCount:c.length,sampleCandidateCount:u.length,sampleCandidates:f}},nA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&ku.includes(n)?n:t},sA=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},Wy=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,s=e.map(o=>{if(!o||typeof o!="object")return null;const i=Ye(o.columns),c=Array.from(new Set(i.map(h=>h.trim()).filter(Boolean))).sort((h,f)=>h.localeCompare(f)),u=nA(o.mode,t.mode),d=sA(o.auto_detect??o.autoDetect??o.auto),p=`${u}|${c.join(",")}|${d?"auto":"manual"}`;return n.has(p)?null:(n.add(p),{mode:u,columns:c,autoDetect:d})}).filter(o=>!!o);return s.length?s:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},rA=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),aA=e=>{var t;return((t=zi[e])==null?void 0:t.label)??zi.iso_date.label},oA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?qy(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?qy(t):null},lA=(e,t=XM)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([o,i])=>{const c=typeof o=="string"?o.trim():"";if(!c)return;const u=oA(i);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},iA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},Ky=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},cA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:o,sampleMap:i,collapsedStrategies:c,onToggleStrategy:u,onRemoveStrategy:d,onAddStrategy:p,onModeChange:h,onColumnToggle:f,onColumnsChange:g,onAutoDetectToggle:w,modeOptions:b=Nh})=>{const _=n.length>0,x=v.useMemo(()=>n.some(P=>P.autoDetect),[n]),[N,C]=v.useState(()=>new Set),E=v.useCallback(P=>{C(L=>{const $=new Set(L);return $.has(P)?$.delete(P):$.add(P),$})},[]);v.useEffect(()=>{C(P=>{const L=new Set;return P.forEach($=>{$<n.length&&L.add($)}),L.size===P.size?P:L})},[n.length]);const j=v.useMemo(()=>{const P=new Map;return n.forEach(L=>{L.columns.forEach($=>{const A=$.trim();A&&P.set(A,(P.get(A)??0)+1)})}),P},[n]),S=v.useMemo(()=>{const P=s.recommendedColumns.slice(0,6),L=Math.max(s.recommendedColumns.length-P.length,0);return{preview:P,remaining:L}},[s.recommendedColumns]),M=v.useMemo(()=>{const P=s.nonDateSelected.slice(0,4),L=Math.max(s.nonDateSelected.length-P.length,0);return{preview:P,remaining:L}},[s.nonDateSelected]),T=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:p,children:"Add strategy"})})]}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",S.preview.join(", "),S.remaining>0?`,  (${S.remaining} more)`:"",".",x?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),s.sampleCandidates.length===0&&!S.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[M.preview.join(", ")," ",M.preview.length===1?"looks":"look"," non-date-like.",M.remaining>0?` ${M.remaining} more selected column${M.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),x&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",s.sampleCandidateCount||s.dateColumnCount," date-like columns that are not already assigned."]}),_?a.jsx("div",{className:"canvas-imputer__list",children:n.map((P,L)=>{var K,re;const $=((K=b.find(Y=>Y.value===P.mode))==null?void 0:K.label)??aA(P.mode),A=P.columns.length,R=A?`${A} column${A===1?"":"s"}`:P.autoDetect?"Auto-detecting columns":"No columns yet",W=c.has(L),z=P.columns.join(", "),D=`date-strategy-${L}-toggle`,H=`date-strategy-${L}-auto-detect`,q=o.map(Y=>({option:Y,priority:Y.isRecommended?0:Y.isSampleCandidate?1:2})).sort((Y,V)=>Y.priority!==V.priority?Y.priority-V.priority:Y.option.name.localeCompare(V.option.name)).map(Y=>Y.option),I=q.filter(Y=>P.columns.includes(Y.name)?!0:Y.isRecommended||Y.isSampleCandidate),Q=new Set(I.map(Y=>Y.name)),U=q.filter(Y=>!Q.has(Y.name)),F=N.has(L);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:D,className:"canvas-imputer__card-toggle",onClick:()=>u(L),"aria-expanded":!W,"aria-controls":`date-strategy-body-${L}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${W?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",L+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[$,P.autoDetect?"  auto-detect":"",R?`  ${R}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(L),"aria-label":`Remove date formatting strategy ${L+1}`,children:"Remove"})]}),!W&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${L}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${L}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${L}-mode`,value:P.mode,onChange:Y=>h(L,Y.target.value),children:b.map(Y=>a.jsx("option",{value:Y.value,children:Y.label},Y.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((re=b.find(Y=>Y.value===P.mode))==null?void 0:re.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:H,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:H,type:"checkbox",checked:P.autoDetect,onChange:Y=>w(L,Y.target.checked)}),a.jsx("label",{htmlFor:H,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),q.length?a.jsxs(a.Fragment,{children:[I.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:I.map(Y=>{const V=P.columns.includes(Y.name),G=Ky(Y.samples.length?Y.samples:i[Y.name]??[]),se=(j.get(Y.name)??0)-(V?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${V?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(L,Y.name),"aria-pressed":V,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Y.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Y.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Y.dtype}),Y.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!Y.isRecommended&&Y.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),se&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),G&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",G]})]},Y.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),U.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>E(L),"aria-expanded":F,"aria-controls":`date-strategy-${L}-other-columns`,children:F?"Hide other columns":`Show other columns (${U.length})`}),F&&a.jsx("div",{id:`date-strategy-${L}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:U.map(Y=>{const V=P.columns.includes(Y.name),G=Ky(Y.samples.length?Y.samples:i[Y.name]??[]),se=(j.get(Y.name)??0)-(V?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${V?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(L,Y.name),"aria-pressed":V,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Y.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Y.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Y.dtype}),se&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),G&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",G]})]},Y.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${P.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:P.columns.length?P.columns.map(Y=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:Y},Y)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${L}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${L}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:z,onChange:Y=>g(L,Y.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${L}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},Yy=["both","leading","trailing"],Gy="both",uA=["string","object","text","category","mixed","varchar","char"],dA=3,Qy=36,Xy=6,mA=4,hA=5,Jy={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},fA=e=>e.length<=Qy?e:`${e.slice(0,Qy-1)}...`,Zy=e=>{if(!e)return!1;const t=e.toLowerCase();return uA.some(n=>t.includes(n))},pA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${fA(t)}'`},gA=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,_A=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Yy.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Yy.includes(s)?s:Gy},vA=e=>{const t=Jy[e]??Jy[Gy];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},yA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s.length)return;const o=s.reduce((c,u)=>u.hasIssue?c+1:c,0);if(!o)return;const i=o/s.length;(o>=2||i>=.5)&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},bA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const o=Array.from(new Set(Ye(e)));o.sort((f,g)=>f.localeCompare(g));const i=new Set(o),c=t.filter(f=>Zy(n[f]??null)),u=yA(s),d=new Set;c.forEach(f=>{i.has(f)||d.add(f)}),u.forEach(f=>{i.has(f)||d.add(f)});const p=Array.from(d).sort((f,g)=>f.localeCompare(g)),h=o.filter(f=>!Zy(n[f]??null));return{selectedColumns:o,autoDetectionActive:o.length===0,recommendedColumns:p,nonTextSelected:h,textColumnCount:c.length,whitespaceCandidateCount:u.length,whitespaceCandidates:u}},Ch=(e,t)=>e.slice(0,t),xA=e=>{const t=Ch(e,Xy);return{preview:t,remaining:Math.max(e.length-t.length,0)}},wA=e=>{const t=Ch(e,mA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},jA=e=>{const t=Ch(e,Xy);return{preview:t,remaining:Math.max(e.length-t.length,0)}},NA=(e,t=dA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([o,i])=>{const c=typeof o=="string"?o.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=gA(u),p=pA(u),h=n[c]??[];h.find(f=>f.value===p)||h.length>=t||(n[c]=[...h,{value:p,hasIssue:d}])})}),n},CA=(e,t,n=hA)=>{if(!t.length)return[];const s=[];for(const o of t){if(s.length>=n)break;const i=e[o];!i||!i.length||s.push({column:o,values:i.map(c=>c.value),overflow:0})}return s},SA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},EA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:o,renderParameterField:i,columnSummary:c,modeDetails:u,sampleMap:d})=>{if(!n&&!s)return null;const p=c.selectedColumns.length,h=xA(c.recommendedColumns),f=wA(c.nonTextSelected),g=jA(c.whitespaceCandidates),w=CA(d,c.selectedColumns),b=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for trimming."]}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",w.map(_=>`${_.column} (${_.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),h.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",h.preview.join(", "),h.remaining>0?`, ... (${h.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[f.preview.join(", ")," ",f.preview.length===1?"is":"are"," not text-like.",f.remaining>0?` ${f.remaining} more column${f.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),b?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),o(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},eb=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],tb="keep_alphanumeric",kA=["string","object","text","category","mixed","varchar","char"],MA=3,nb=36,AA=6,OA=4,TA=5,sb={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},$A=e=>e.length<=nb?e:`${e.slice(0,nb-1)}...`,PA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${$A(t)}'`},rb=e=>{if(!e)return!1;const t=e.toLowerCase();return kA.some(n=>t.includes(n))},LA=e=>/[^0-9A-Za-z\s]/.test(e),zA=e=>/[A-Za-z]/.test(e),RA=e=>/[0-9]/.test(e),DA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&eb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&eb.includes(s)?s:tb},FA=e=>{const t=sb[e]??sb[tb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},IA=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([u,d])=>{if(!d.length)return;let p=0,h=0,f=0;d.forEach(g=>{g.hasSpecial&&(p+=1),g.hasDigits&&(h+=1),g.hasLetters&&(f+=1)}),p>0&&t.add(u),h>0&&f===0&&n.add(u),f>0&&h===0&&s.add(u)});const o=Array.from(t).sort((u,d)=>u.localeCompare(d)),i=Array.from(n).sort((u,d)=>u.localeCompare(d)),c=Array.from(s).sort((u,d)=>u.localeCompare(d));return{specialCandidates:o,digitsOnlyCandidates:i,lettersOnlyCandidates:c}},BA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const o=Array.from(new Set(Ye(e)));o.sort((w,b)=>w.localeCompare(b));const i=new Set(o),c=t.filter(w=>rb(n[w]??null)),{specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}=IA(s),h=new Set;c.forEach(w=>{i.has(w)||h.add(w)}),u.forEach(w=>{i.has(w)||h.add(w)});const f=Array.from(h).sort((w,b)=>w.localeCompare(b)),g=o.filter(w=>!rb(n[w]??null));return{selectedColumns:o,autoDetectionActive:o.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,specialCandidateCount:u.length,specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}},ab=(e,t)=>e.slice(0,t),UA=e=>{const t=ab(e,AA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Mu=e=>{const t=ab(e,OA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},qA=(e,t=MA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([o,i])=>{const c=typeof o=="string"?o.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=PA(u),p=LA(u),h={value:d,hasSpecial:p,hasDigits:RA(u),hasLetters:zA(u)},f=n[c]??[];f.find(g=>g.value===d)||f.length>=t||(n[c]=[...f,h])})}),n},HA=(e,t,n=TA)=>{if(!t.length)return[];const s=[];for(const o of t){if(s.length>=n)break;const i=e[o];!i||!i.length||s.push({column:o,values:i.map(c=>c.value),overflow:0})}return s},VA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},WA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,replacementParameter:o,renderMultiSelectField:i,renderParameterField:c,columnSummary:u,modeDetails:d,sampleMap:p})=>{if(!n&&!s&&!o)return null;const h=u.selectedColumns.length,f=UA(u.recommendedColumns),g=Mu(u.specialCandidates),w=Mu(u.digitsOnlyCandidates),b=Mu(u.lettersOnlyCandidates),_=Mu(u.nonTextSelected),x=HA(p,u.selectedColumns),N=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for cleanup."]}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",x.map(C=>`${C.column} (${C.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"",". Consider `digits only` mode."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",b.preview.join(", "),b.remaining>0?`, ... (${b.remaining} more)`:"",". Consider `letters only` mode."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[_.preview.join(", ")," ",_.preview.length===1?"is":"are"," not text-like.",_.remaining>0?` ${_.remaining} more column${_.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),N?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),i(n)]}),(s||o)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?c(s):null,o?c(o):null]})]})},ob=["lower","upper","title","sentence"],lb="lower",KA=["string","object","text","category","mixed","varchar","char"],YA=3,ib=60,GA=6,QA=4,XA=5,cb={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},JA=e=>e.length<=ib?e:`${e.slice(0,ib-1)}...`,ub=e=>{if(!e)return!1;const t=e.toLowerCase();return KA.some(n=>t.includes(n))},Ri=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${JA(t)}'`},ZA=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),eO=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),tO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&ob.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&ob.includes(s)?s:lb},nO=e=>{const t=cb[e]??cb[lb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},sO=(e,t)=>{const n=[];return Object.entries(e).forEach(([s,o])=>{if(!o.length)return;o.some(c=>{const u=c[t];return c.original!==u})&&n.push(s)}),n.sort((s,o)=>s.localeCompare(o)),n},rO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s,mode:o})=>{const i=Array.from(new Set(Ye(e)));i.sort((g,w)=>g.localeCompare(w));const c=new Set(i),u=t.filter(g=>ub(n[g]??null)),d=sO(s,o),p=new Set;u.forEach(g=>{c.has(g)||p.add(g)}),d.forEach(g=>{c.has(g)||p.add(g)});const h=Array.from(p).sort((g,w)=>g.localeCompare(w)),f=i.filter(g=>!ub(n[g]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:h,nonTextSelected:f,textColumnCount:u.length,inconsistentColumns:d}},db=(e,t)=>e.slice(0,t),aO=e=>{const t=db(e,GA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},mb=e=>{const t=db(e,QA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},oO=(e,t=YA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([o,i])=>{const c=typeof o=="string"?o.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=Ri(u),p={original:d,lower:Ri(u.toLowerCase()),upper:Ri(u.toUpperCase()),title:Ri(ZA(u)),sentence:Ri(eO(u))},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},lO=(e,t,n,s=XA)=>{if(!t.length)return[];const o=[];for(const i of t){if(o.length>=s)break;const c=e[i];if(!c||!c.length)continue;const u=c.map(d=>`${d.original}  ${d[n]}`);o.push({column:i,values:u,overflow:0})}return o},iO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},cO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:o,renderParameterField:i,columnSummary:c,modeDetails:u,sampleMap:d,selectedMode:p})=>{if(!n&&!s)return null;const h=c.selectedColumns.length,f=aO(c.recommendedColumns),g=mb(c.inconsistentColumns),w=mb(c.nonTextSelected),b=lO(d,c.selectedColumns,p),_=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for case normalization."]}),b.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",b.map(x=>`${x.column} (${x.values.join("; ")})`).join(" | "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[w.preview.join(", ")," ",w.preview.length===1?"is":"are"," not text-like.",w.remaining>0?` ${w.remaining} more column${w.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),_?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),o(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(s)})]})},hb=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],fb="preset_digits_only",uO=["string","object","text","category","mixed","varchar","char"],dO=3,pb=60,mO=6,hO=4,fO=5,gb={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},pO=e=>e.length<=pb?e:`${e.slice(0,pb-1)}...`,Di=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${pO(t)}'`},_b=e=>{if(!e)return!1;const t=e.toLowerCase();return uO.some(n=>t.includes(n))},gO=e=>e.replace(/\s+/g," ").trim(),_O=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&hb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&hb.includes(s)?s:fb},vO=e=>{const t=gb[e]??gb[fb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},yO=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([i,c])=>{c.length&&c.forEach(u=>{u.hasDigits&&t.add(i),u.hasLetters&&n.add(i),u.hasWhitespaceRuns&&s.add(i)})});const o=i=>Array.from(i).sort((c,u)=>c.localeCompare(u));return{digits:o(t),letters:o(n),whitespace:o(s)}},bO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const o=Array.from(new Set(Ye(e)));o.sort((w,b)=>w.localeCompare(b));const i=new Set(o),c=t.filter(w=>_b(n[w]??null)),{digits:u,letters:d,whitespace:p}=yO(s),h=new Set;c.forEach(w=>{i.has(w)||h.add(w)}),[...u,...d,...p].forEach(w=>{i.has(w)||h.add(w)});const f=Array.from(h).sort((w,b)=>w.localeCompare(b)),g=o.filter(w=>!_b(n[w]??null));return{selectedColumns:o,autoDetectionActive:o.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,digitsCandidates:u,lettersCandidates:d,whitespaceCandidates:p}},vb=(e,t)=>e.slice(0,t),xO=e=>{const t=vb(e,mO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Au=e=>{const t=vb(e,hO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},wO=(e,t=dO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([o,i])=>{const c=typeof o=="string"?o.trim():"";if(!c)return;let u="";if(i==null)u="";else if(typeof i=="string")u=i;else if(typeof i=="number"||typeof i=="boolean")u=String(i);else try{u=JSON.stringify(i)}catch{u=String(i)}if(!u.length)return;const d=Di(u),p={original:d,presetDigits:Di(u.replace(/\D+/g,"")),presetLetters:Di(u.replace(/[^A-Za-z]+/g,"")),presetWhitespace:Di(gO(u)),hasDigits:/\d/.test(u),hasLetters:/[A-Za-z]/.test(u),hasWhitespaceRuns:/\s{2,}/.test(u)||/\t|\n|\r/.test(u)},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},jO=(e,t,n)=>{const s=n??"",o=i=>i.length?i:"''";switch(t){case"preset_letters_only":return`${o(e.original)}  ${o(e.presetLetters)}`;case"preset_whitespace_collapse":return`${o(e.original)}  ${o(e.presetWhitespace)}`;case"custom":try{const i=new RegExp(s.split("|||")[0]??"",s.split("|||")[1]??""),c=Di(e.original.replace(i,s.split("|||")[2]??""));return`${o(e.original)}  ${o(c)}`}catch{return`${o(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${o(e.original)}  ${o(e.presetDigits)}`}},NO=(e,t,n,s,o=fO)=>{if(!t.length)return[];const i=[];for(const c of t){if(i.length>=o)break;const u=e[c];if(!u||!u.length)continue;const d=u.map(p=>jO(p,n,s));i.push({column:c,values:d,overflow:0})}return i},CO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},SO=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",s=t[1]??"",o=t[2]??"";return!n.trim()&&!o.trim()?null:`Pattern: /${n||"(empty)"}/${s||"(none)"} Replacement: ${o||"''"}`},EO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,patternParameter:o,replacementParameter:i,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,replacementValue:g})=>{if(!n&&!s&&!o&&!i)return null;const w=d.selectedColumns.length,b=xO(d.recommendedColumns),_=Au(d.digitsCandidates),x=Au(d.lettersCandidates),N=Au(d.whitespaceCandidates),C=Au(d.nonTextSelected),E=SO(g),j=NO(h,d.selectedColumns,f,g),S=!e||!t,M=f==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," mode. ",p.guidance," Example: ",p.example,"."]}),E&&a.jsx("p",{className:"canvas-modal__note",children:E}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:w})," column",w===1?"":"s"," for regex cleanup."]}),j.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",j.map(T=>`${T.column} (${T.values.join("; ")})`).join(" | "),"."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",b.preview.join(", "),b.remaining>0?`, ... (${b.remaining} more)`:"","."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[C.preview.join(", ")," ",C.preview.length===1?"is":"are"," not text-like.",C.remaining>0?` ${C.remaining} more column${C.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),M&&!E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),S?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||o||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,o?u(o):null,i?u(i):null]})]})},yb=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],bb="negative_to_nan",kO=["int","float","double","numeric","number","decimal","real","long"],MO=3,AO=6,OO=4,TO=5,xb={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},$O=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},PO=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},LO=e=>{if(!e)return!1;const t=e.toLowerCase();return kO.some(n=>t.includes(n))},zO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&yb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&yb.includes(s)?s:bb},RO=e=>{const t=xb[e]??xb[bb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},DO=e=>{const t=new Set,n=new Set,s=new Set,o=new Set;Object.entries(e).forEach(([c,u])=>{u.forEach(d=>{d.isNegative&&t.add(c),d.isZero&&n.add(c),(d.numericValue<0||d.numericValue>100)&&s.add(c),(d.numericValue<0||d.numericValue>120)&&o.add(c)})});const i=c=>Array.from(c).sort((u,d)=>u.localeCompare(d));return{negative:i(t),zeros:i(n),percentage:i(s),age:i(o)}},FO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const o=Array.from(new Set(Ye(e))).sort((b,_)=>b.localeCompare(_)),i=new Set(o),c=t.filter(b=>LO(n[b]??null)),u=new Set(c),{negative:d,zeros:p,percentage:h,age:f}=DO(s),g=new Set;c.forEach(b=>{i.has(b)||g.add(b)}),[...d,...p,...h,...f].forEach(b=>{i.has(b)||g.add(b)});const w=o.filter(b=>!u.has(b));return{selectedColumns:o,autoDetectionActive:o.length===0,recommendedColumns:Array.from(g).sort((b,_)=>b.localeCompare(_)),nonNumericSelected:w,numericColumnCount:c.length,negativeCandidates:d,zeroCandidates:p,percentageOutliers:h,ageOutliers:f}},IO=e=>{const t=e.slice(0,AO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Fi=e=>{const t=e.slice(0,OO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},BO=(e,t=MO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([o,i])=>{const c=typeof o=="string"?o.trim():"";if(!c)return;const u=PO(i);if(u===null)return;const d=$O(String(i)),p={originalDisplay:d,numericValue:u,isNegative:u<0,isZero:Math.abs(u)<=1e-9},h=n[c]??[];h.find(f=>f.originalDisplay===d)||h.length>=t||(n[c]=[...h,p])})}),n},UO=0,qO=100,HO=0,VO=120,WO=(e,t,n,s)=>{switch(t){case"negative_to_nan":{const o=n??0;return e.numericValue<o?{flagged:!0,reason:`value < ${o}`}:s!==null&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const o=n??UO,i=s??qO;return e.numericValue<o?{flagged:!0,reason:`value < ${o}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"age_bounds":{const o=n??HO,i=s??VO;return e.numericValue<o?{flagged:!0,reason:`value < ${o}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"custom_range":default:{const o=n!=null,i=s!=null;return!o&&!i?{flagged:!1,reason:null}:o&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:i&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}}},KO=(e,t,n,s)=>{const{flagged:o,reason:i}=WO(e,t,n,s);return o?`${e.originalDisplay}  flagged (${i??"rule match"})`:`${e.originalDisplay}  ok`},YO=(e,t,n,s,o,i=TO)=>{if(!t.length)return[];const c=[];for(const u of t){if(c.length>=i)break;const d=e[u];!d||!d.length||c.push({column:u,values:d.map(p=>KO(p,n,s,o)),overflow:0})}return c},GO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},QO=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const s=t===null?"-":String(t),o=n===null?"":String(n);return`Custom bounds active: [${s}, ${o}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const s=t??0;return n===null?`Negative-to-missing rule overrides values below ${s}.`:`Negative-to-missing rule overrides values < ${s} or > ${n}.`}return null},XO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,minValueParameter:o,maxValueParameter:i,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,minValue:g,maxValue:w})=>{if(!n&&!s&&!o&&!i)return null;const{selectedColumns:b,autoDetectionActive:_}=d,x=b.length,N=IO(d.recommendedColumns),C=Fi(d.negativeCandidates),E=Fi(d.zeroCandidates),j=Fi(d.percentageOutliers),S=Fi(d.ageOutliers),M=Fi(d.nonNumericSelected),T=YO(h,b,f,g,w),P=QO(f,g,w),L=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," rule. ",p.guidance," Example: ",p.example,"."]}),P&&a.jsx("p",{className:"canvas-modal__note",children:P}),_?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:x})," column",x===1?"":"s"," for invalid value cleanup."]}),T.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",T.map($=>`${$.column} (${$.values.join("; ")})`).join(" | "),"."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",C.preview.join(", "),C.remaining>0?`, ... (${C.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",E.preview.join(", "),E.remaining>0?`, ... (${E.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",S.preview.join(", "),S.remaining>0?`, ... (${S.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[M.preview.join(", ")," ",M.preview.length===1?"is":"are"," not numeric-type columns.",M.remaining>0?` ${M.remaining} more column${M.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),L?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||o||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,o?u(o):null,i?u(i):null]})]})};let JO="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",wb=(e=21)=>{let t="",n=e|0;for(;n--;)t+=JO[Math.random()*64|0];return t};const jb=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],Nb=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],Sh=[{value:"token_sort_ratio",label:"Token Sort  Same words, ignore order",description:"Split into words, sort alphabetically, then compare. Great when the same words appear in different order."},{value:"token_set_ratio",label:"Token Set  Unique words, ignore extras",description:"Focus on overlapping unique words and down-weight extras. Best when one string has additional words."},{value:"ratio",label:"Character Ratio  Raw string similarity",description:"Compare characters in order using edit distance. Sensitive to spelling differences."}],Ou=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],ZO=new Set(Ou.map(e=>e.value)),jl=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],Ii="UTC",Tu=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Tu(e.split(",")):[]:[],Cb=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(s=>{const o=Number(s);Number.isFinite(o)&&n.push(o)}),n}if(typeof e=="string")return Cb(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},Eh=e=>{const t=Number(e);return Number.isFinite(t)?t:null},Sb=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},eT=(e,t)=>{var s,o,i,c,u;if(typeof t!="string")return((s=jl.find(d=>d.value===e))==null?void 0:s.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((i=jb.find(d=>d.value===n))==null?void 0:i.value)??"add":e==="stat"?((c=Nb.find(d=>d.value===n))==null?void 0:c.value)??"mean":e==="similarity"?((u=Sh.find(d=>d.value===n))==null?void 0:u.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((o=jl.find(d=>d.value===e))==null?void 0:o.defaultMethod)??""},tT=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},nT=e=>{const t=Tu(e);return t.length?t.filter(n=>ZO.has(n)):["year","month","day"]},sT=e=>typeof e!="string"?Ii:e.trim()||Ii,Eb=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,s)=>{if(!n||typeof n!="object")return;const o=n,i=tT(o.operation_type??o.type),c=o.operation_id??o.id??`feature_math_${s+1}`,u=typeof c=="string"&&c.trim()?c.trim():`feature_math_${s+1}`,d=eT(i,o.method),p=Tu(o.input_columns??o.inputs??o.inputColumns),h=Tu(o.secondary_columns??o.denominator??o.secondaryColumns),f=Cb(o.constants),g=typeof o.output_column=="string"?o.output_column.trim():"",w=typeof o.output_prefix=="string"?o.output_prefix.trim():"",b=i==="datetime_extract"?nT(o.datetime_features):[],_=i==="datetime_extract"?sT(o.timezone):Ii,x=Eh(o.fillna),N=(()=>{const M=Eh(o.round??o.round_digits);return Number.isInteger(M??NaN),M})(),C=Eh(o.epsilon),E=i==="similarity"?Sb(o.normalize,!1):!1,j=o.allow_overwrite===void 0?null:Sb(o.allow_overwrite,!1),S=typeof o.description=="string"?o.description:void 0;t.push({id:u,type:i,method:d,inputColumns:p,secondaryColumns:h,constants:f,outputColumn:g,outputPrefix:w,datetimeFeatures:b,timezone:_,fillna:x,roundDigits:N,normalize:E,epsilon:C,allowOverwrite:j,description:S})}),t},rT=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||Ii):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},aT=e=>e.map(t=>rT(t)),oT={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},kb=(e,t)=>{var o;const n=oT[e]??{};let s=`math_${e}_${wb(6)}`;for(;t.has(s);)s=`math_${e}_${wb(6)}`;return{id:s,type:e,method:n.method??((o=jl.find(i=>i.value===e))==null?void 0:o.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:Ii,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},lT=(e,t)=>{const n=new Map;return t==null||t.forEach(s=>{s.operations.forEach(o=>{n.has(o.operation_id)||n.set(o.operation_id,o)})}),e.map((s,o)=>{const i=n.get(s.id),c=`${o+1}. ${s.type.replace("_"," ")}${s.method?`  ${s.method}`:""}`;return{id:s.id,label:c,status:i==null?void 0:i.status,message:(i==null?void 0:i.message)??void 0,outputColumns:(i==null?void 0:i.output_columns)??[]}})},Mb=e=>e==="arithmetic"?jb:e==="stat"?Nb:e==="similarity"?Sh:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],iT=e=>{const t=Sh.find(n=>n.value===e);return t!=null&&t.description?t.description:"Compare the input text columns using the selected similarity technique."},cT={applied:"Applied",skipped:"Skipped",failed:"Failed"},uT={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},dT=new Set(Ou.map(e=>e.value)),mT=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},Ab=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],hT=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],fT=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",pT=({index:e,total:t,operation:n,summary:s,availableColumns:o,isCollapsed:i,onToggleCollapsed:c,onDuplicate:u,onRemove:d,onReorder:p,onChange:h})=>{var se;const f=v.useMemo(()=>Mb(n.type),[n.type]),g=v.useMemo(()=>{var J;return((J=jl.find(te=>te.value===n.type))==null?void 0:J.label)??n.type},[n.type]),w=v.useMemo(()=>{var J;return((J=f.find(te=>te.value===n.method))==null?void 0:J.label)??n.method},[f,n.method]),b=v.useMemo(()=>n.type==="similarity"?iT(n.method):"",[n.method,n.type]),[_,x]=v.useState(n.inputColumns.join(", ")),[N,C]=v.useState(n.secondaryColumns.join(", ")),[E,j]=v.useState(n.constants.join(", "));v.useEffect(()=>{x(n.inputColumns.join(", "))},[n.inputColumns]),v.useEffect(()=>{C(n.secondaryColumns.join(", "))},[n.secondaryColumns]),v.useEffect(()=>{j(n.constants.join(", "))},[n.constants]);const S=()=>{h(n.id,{inputColumns:Ab(_)})},M=()=>{h(n.id,{secondaryColumns:Ab(N)})},T=()=>{h(n.id,{constants:hT(E)})},P=`feature-math-toggle-${n.id}`,L=`feature-math-body-${n.id}`,$=`feature-math-input-columns-${n.id}`,A=`feature-math-secondary-columns-${n.id}`,R=s==null?void 0:s.status,W=R?a.jsx("span",{className:`canvas-cast__chip ${uT[R]??""}`,style:{marginLeft:"0.5rem"},children:cT[R]}):null,z=s!=null&&s.message?s.message.trim():"",D=fT(R),H=(se=s==null?void 0:s.outputColumns)!=null&&se.length?s.outputColumns.join(", "):"",q=mT(n.inputColumns),I=n.type==="ratio"||n.type==="similarity",Q=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",U=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",F=n.type==="similarity",K=n.type==="datetime_extract",re=n.type==="stat"||n.type==="datetime_extract",Y=v.useMemo(()=>{if(!o.length)return"";const J=o.slice(0,6),te=o.length-J.length;return te>0?`${J.join(", ")}  (${te} more)`:J.join(", ")},[o]),V=J=>{if(!J||!dT.has(J))return;const te=new Set(n.datetimeFeatures);te.has(J)?te.delete(J):te.add(J),h(n.id,{datetimeFeatures:Array.from(te)})},G=J=>te=>{const Se=te.target.value;if(Se===""){h(n.id,{[J]:null});return}const ze=Number(Se);Number.isFinite(ze)&&(J==="roundDigits"?h(n.id,{roundDigits:Math.round(ze)}):J==="fillna"?h(n.id,{fillna:ze}):h(n.id,{epsilon:ze}))},X=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:P,className:"canvas-imputer__card-toggle",onClick:()=>c(n.id),"aria-expanded":!i,"aria-controls":L,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${i?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[g,w?`  ${w}`:"",n.outputColumn?`   ${n.outputColumn}`:"",W]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",q]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!i&&a.jsxs("div",{className:"canvas-imputer__card-body",id:L,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>u(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),z&&a.jsx("p",{className:D,children:z}),H&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",H]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:J=>h(n.id,{type:J.target.value}),children:jl.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:J=>h(n.id,{method:J.target.value}),children:f.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),n.type==="similarity"&&b&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:b}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:_,onChange:J=>x(J.target.value),onBlur:S,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),S())},placeholder:"col_a, col_b",list:$}),a.jsx("datalist",{id:$,children:o.map(J=>a.jsx("option",{value:J},`${n.id}-input-option-${J}`))}),Y&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",Y]})]}),I&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:N,onChange:J=>C(J.target.value),onBlur:M,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),M())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:A}),a.jsx("datalist",{id:A,children:o.map(J=>a.jsx("option",{value:J},`${n.id}-secondary-option-${J}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),Q&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:E,onChange:J=>j(J.target.value),onBlur:T,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),T())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:J=>h(n.id,{outputColumn:J.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),re&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:J=>h(n.id,{outputPrefix:J.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),U&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:G("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:G("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:G("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),F&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:J=>h(n.id,{normalize:J.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),K&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:Ou.map(J=>{const te=`feature-math-${n.id}-datetime-${J.value}`,Se=n.datetimeFeatures.includes(J.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:te,children:[a.jsx("input",{id:te,type:"checkbox",checked:Se,onChange:()=>V(J.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:J.label})]},J.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:J=>h(n.id,{timezone:J.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:X,onChange:J=>{const te=J.target.value;te==="inherit"?h(n.id,{allowOverwrite:null}):h(n.id,{allowOverwrite:te==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},gT=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:s,onAddOperation:o,onDuplicateOperation:i,onRemoveOperation:c,onReorderOperation:u,onOperationChange:d,availableColumns:p,signals:h,previewStatus:f,errorHandlingParameter:g,allowOverwriteParameter:w,defaultTimezoneParameter:b,epsilonParameter:_,renderParameterField:x})=>{const[N,C]=v.useState("arithmetic"),E=v.useMemo(()=>{const P=new Map;return t.forEach(L=>{P.set(L.id,L)}),P},[t]),j=v.useMemo(()=>h.length?h[h.length-1]:null,[h]),S=(j==null?void 0:j.warnings)??[],M=j&&j.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",T=()=>{o(N)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("select",{value:N,onChange:P=>C(P.target.value),children:jl.map(P=>a.jsx("option",{value:P.value,children:P.label},P.value))}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:T,children:"Add operation"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),f==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),j&&a.jsxs("p",{className:M,children:["Preview applied ",j.applied_operations," of ",j.total_operations," operation",j.total_operations===1?"":"s"," (",j.skipped_operations," skipped, ",j.failed_operations," failed)."]}),S.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:S.map((P,L)=>a.jsx("li",{children:P},`feature-math-warning-${L}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((P,L)=>a.jsx(pT,{index:L,total:e.length,operation:P,summary:E.get(P.id),availableColumns:p,isCollapsed:n.has(P.id),onToggleCollapsed:s,onDuplicate:i,onRemove:c,onReorder:u,onChange:d},P.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[g&&x(g),w&&x(w),b&&x(b),_&&x(_)]})]})},_T={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},vT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Ob=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),yT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:o,metadata:i,columnsParameter:c,autoDetectParameter:u,maxUniqueParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,missingStrategyParameter:f,missingCodeParameter:g,selectedColumns:w,renderParameterField:b,onToggleColumn:_,onApplyRecommended:x,formatMissingPercentage:N})=>{const C=v.useMemo(()=>{if(!o.length)return[];const M=new Set;return o.forEach(T=>{T.status==="recommended"&&T.selectable&&M.add(T.column)}),Array.from(M)},[o]),E=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),j=o.length>0,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(C),disabled:!C.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:E}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((M,T)=>a.jsx("li",{children:M},`label-encoding-note-${T}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:o.map(M=>{const T=w.includes(M.column),P=_T[M.status],L=vT[M.status]??"canvas-cast__chip--muted",$=M.sample_values.length?M.sample_values.join(", "):"",A=M.unique_count!==void 0&&M.unique_count!==null?`${Ob(M.unique_count)} (${Ob(M.unique_percentage)}%)`:"",R=N(M.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:M.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[M.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",M.dtype]}),M.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:M.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",$]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:M.reason})]})}),a.jsx("td",{children:A}),a.jsx("td",{children:R}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:()=>_(M.column),disabled:!M.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:M.selectable?T?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${M.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&b(u),d&&b(d),p&&b(p),h&&b(h),f&&b(f),g&&b(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),b(c)]})]})},bT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},xT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Tb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),wT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:o,metadata:i,columnsParameter:c,targetColumnParameter:u,autoDetectParameter:d,maxCategoriesParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,smoothingParameter:g,encodeMissingParameter:w,handleUnknownParameter:b,selectedColumns:_,renderParameterField:x,onToggleColumn:N,onApplyRecommended:C,formatMissingPercentage:E})=>{const j=v.useMemo(()=>{if(!o.length)return[];const P=new Set;return o.forEach(L=>{L.status==="recommended"&&L.selectable&&P.add(L.column)}),Array.from(P)},[o]),S=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),M=o.length>0,T=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>C(j),disabled:!j.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),!u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((P,L)=>a.jsx("li",{children:P},`target-encoding-note-${L}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!M&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&M&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:o.map(P=>{const L=_.includes(P.column),$=bT[P.status],A=xT[P.status]??"canvas-cast__chip--muted",R=P.sample_values.length?P.sample_values.join(", "):"",W=P.unique_count!==void 0&&P.unique_count!==null?`${Tb(P.unique_count)} (${Tb(P.unique_percentage)}%)`:"",z=E(P.missing_percentage),D=P.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:P.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[P.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",P.dtype]}),P.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:P.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",R]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:P.reason})]})}),a.jsx("td",{children:W}),a.jsx("td",{children:z}),a.jsx("td",{children:D}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${A}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:()=>N(P.column),disabled:!P.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:P.selectable?L?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${P.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&x(u),d&&x(d),p&&x(p),h&&x(h),f&&x(f),g&&x(g),w&&x(w),b&&x(b)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(c)]})]})},jT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},NT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},$b=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),CT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:o,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,bucketsParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,encodeMissingParameter:g,selectedColumns:w,renderParameterField:b,onToggleColumn:_,onApplyRecommended:x,formatMissingPercentage:N})=>{const C=v.useMemo(()=>{if(!o.length)return[];const T=new Set;return o.forEach(P=>{P.status==="recommended"&&P.selectable&&T.add(P.column)}),Array.from(T)},[o]),E=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),j=o.length>0,S=i.suggestedBucketDefault>0?`Default bucket suggestion: ${i.suggestedBucketDefault.toLocaleString()}.`:null,M=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(C),disabled:!C.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:E}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:S}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((T,P)=>a.jsx("li",{children:T},`hash-encoding-note-${P}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:o.map(T=>{const P=w.includes(T.column),L=jT[T.status],$=NT[T.status]??"canvas-cast__chip--muted",A=T.sample_values.length?T.sample_values.join(", "):"",R=T.unique_count!==void 0&&T.unique_count!==null?`${$b(T.unique_count)} (${$b(T.unique_percentage)}%)`:"",W=N(T.missing_percentage),z=T.recommended_bucket_count?T.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:T.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[T.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",T.dtype]}),T.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:T.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",A]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:T.reason})]})}),a.jsx("td",{children:R}),a.jsx("td",{children:W}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${$}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:()=>_(T.column),disabled:!T.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:T.selectable?P?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${T.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&b(u),d&&b(d),p&&b(p),h&&b(h),f&&b(f),g&&b(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),b(c)]})]})},ST=({columnsParameter:e,autoDetectParameter:t,degreeParameter:n,includeBiasParameter:s,interactionOnlyParameter:o,includeInputFeaturesParameter:i,outputPrefixParameter:c,renderParameterField:u,signal:d})=>{const p=v.useMemo(()=>[e,t,n,s,o,i,c].filter(x=>!!x),[e,t,n,s,o,i,c]),h=(d==null?void 0:d.generated_features)??[],f=(d==null?void 0:d.skipped_columns)??[],g=(d==null?void 0:d.filled_columns)??{},w=(d==null?void 0:d.notes)??[],b=(d==null?void 0:d.feature_count)??0,_=v.useMemo(()=>{const x=Object.entries(g);return x.length?x.map(([N,C])=>`${N} (${C.toLocaleString()} missing)`).join(", "):null},[g]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Polynomial feature settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),p.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:p.map(x=>u(x))}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",f.join(", "),"."]}),_&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",_," before generating features."]}),b>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:h.map(x=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:x.column}),a.jsx("td",{children:x.expression||(x.terms.length?x.terms.join("  "):"1")}),a.jsx("td",{children:x.degree})]},`poly-feature-${x.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),w.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:w.map((x,N)=>a.jsx("li",{children:x},`polynomial-note-${N}`))})]})},Pb=e=>!!e,Bi=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},ET=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},Lb=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},kT=({columnsParameter:e,autoDetectParameter:t,targetColumnParameter:n,methodParameter:s,scoreFuncParameter:o,problemTypeParameter:i,kParameter:c,percentileParameter:u,alphaParameter:d,thresholdParameter:p,modeParameter:h,estimatorParameter:f,stepParameter:g,minFeaturesParameter:w,maxFeaturesParameter:b,dropUnselectedParameter:_,renderParameterField:x,signal:N})=>{const C=v.useMemo(()=>[e,t,n,s,o,i].filter(Pb),[e,t,n,s,o,i]),E=v.useMemo(()=>[c,u,d,p,h,f,g,w,b,_].filter(Pb),[c,u,d,p,h,f,g,w,b,_]),j=(N==null?void 0:N.configured_columns)??[],S=(N==null?void 0:N.evaluated_columns)??[],M=(N==null?void 0:N.selected_columns)??[],T=(N==null?void 0:N.dropped_columns)??[],P=(N==null?void 0:N.feature_summaries)??[],L=(N==null?void 0:N.notes)??[],$=(N==null?void 0:N.drop_unselected)??!1,A=v.useMemo(()=>{if(!S.length&&!j.length)return null;if(S.length===j.length)return`Evaluated ${S.length.toLocaleString()} column(s).`;if(!j.length)return`Evaluated ${S.length.toLocaleString()} column(s) via auto-detect.`;const D=Math.max(S.length-j.length,0);return D>0?`Evaluated ${S.length.toLocaleString()} column(s) (${D.toLocaleString()} auto-detected).`:`Evaluated ${S.length.toLocaleString()} of ${j.length.toLocaleString()} configured column(s).`},[j,S]),R=v.useMemo(()=>{if(!N)return null;const D=[];return N.method&&D.push(`Method: ${N.method}`),N.score_func&&D.push(`Score: ${N.score_func}`),N.estimator&&D.push(`Estimator: ${N.estimator}`),N.problem_type&&N.problem_type!=="auto"&&D.push(`Problem: ${N.problem_type}`),N.target_column&&D.push(`Target: ${N.target_column}`),typeof N.k=="number"&&Number.isFinite(N.k)&&D.push(`k = ${N.k.toLocaleString()}`),typeof N.percentile=="number"&&Number.isFinite(N.percentile)&&D.push(`percentile = ${Bi(N.percentile,2)}`),typeof N.alpha=="number"&&Number.isFinite(N.alpha)&&D.push(`alpha = ${Bi(N.alpha,4)}`),N.threshold!==null&&N.threshold!==void 0&&Number.isFinite(N.threshold)&&D.push(`threshold = ${Bi(N.threshold,4)}`),N.auto_detect&&D.push("Auto-detect enabled"),D.length?D.join("  "):null},[N]),W=v.useMemo(()=>Lb(M),[M]),z=v.useMemo(()=>Lb(T),[T]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Feature selection settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),R&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:R}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:A}),C.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:C.map(D=>x(D))}),E.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:E.map(D=>x(D))}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:$?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),M.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",M.length.toLocaleString()," column(s): ",W]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),T.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",T.length.toLocaleString()," column(s): ",z]}),P.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:P.map(D=>{const H=["canvas-cast__row"];return D.selected||H.push("canvas-cast__row--muted"),a.jsxs("tr",{className:H.join(" "),children:[a.jsx("th",{scope:"row",children:D.column}),a.jsx("td",{children:Bi(D.score)}),a.jsx("td",{children:ET(D.p_value)}),a.jsx("td",{children:D.rank??""}),a.jsx("td",{children:Bi(D.importance,4)}),a.jsx("td",{children:D.selected?"Selected":"Dropped"}),a.jsx("td",{children:D.note??""})]},`feature-selection-summary-${D.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),L.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:L.map((D,H)=>a.jsx("li",{children:D},`feature-selection-note-${H}`))})]})},MT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},AT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},zb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),OT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:o,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,encodeMissingParameter:f,handleUnknownParameter:g,unknownValueParameter:w,selectedColumns:b,renderParameterField:_,onToggleColumn:x,onApplyRecommended:N,formatMissingPercentage:C})=>{const E=v.useMemo(()=>{if(!o.length)return[];const T=new Set;return o.forEach(P=>{P.status==="recommended"&&P.selectable&&T.add(P.column)}),Array.from(T)},[o]),j=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),S=o.length>0,M=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>N(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),j&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:j}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((T,P)=>a.jsx("li",{children:T},`ordinal-encoding-note-${P}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),M&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!S&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&S&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:o.map(T=>{const P=b.includes(T.column),L=MT[T.status],$=AT[T.status]??"canvas-cast__chip--muted",A=T.sample_values.length?T.sample_values.join(", "):"",R=T.unique_count!==void 0&&T.unique_count!==null?`${zb(T.unique_count)} (${zb(T.unique_percentage)}%)`:"",W=C(T.missing_percentage),z=T.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:T.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[T.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",T.dtype]}),T.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:T.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",A]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:T.reason})]})}),a.jsx("td",{children:R}),a.jsx("td",{children:W}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${$}`,children:L})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:()=>x(T.column),disabled:!T.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:T.selectable?P?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${T.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&_(u),d&&_(d),p&&_(p),h&&_(h),f&&_(f),g&&_(g),w&&_(w)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),_(c)]})]})},TT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},$T={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Rb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),PT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:o,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:w,renderParameterField:b,onToggleColumn:_,onApplyRecommended:x,formatMissingPercentage:N})=>{const C=v.useMemo(()=>{if(!o.length)return[];const M=new Set;return o.forEach(T=>{T.status==="recommended"&&T.selectable&&M.add(T.column)}),Array.from(M)},[o]),E=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),j=o.length>0,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(C),disabled:!C.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:E}),i.autoDetectDefault&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((M,T)=>a.jsx("li",{children:M},`dummy-note-${T}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:o.map(M=>{const T=w.includes(M.column),P=TT[M.status],L=$T[M.status]??"canvas-cast__chip--muted",$=M.sample_values.length?M.sample_values.join(", "):"",A=M.unique_count!==void 0&&M.unique_count!==null?`${Rb(M.unique_count)} (${Rb(M.unique_percentage)}%)`:"",R=N(M.missing_percentage),W=M.estimated_dummy_columns?M.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:M.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[M.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",M.dtype]}),M.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:M.text_category}),M.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",$]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:M.reason})]})}),a.jsx("td",{children:A}),a.jsx("td",{children:R}),a.jsx("td",{children:W}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:()=>_(M.column),disabled:!M.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:M.selectable?T?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${M.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&b(u),d&&b(d),p&&b(p),h&&b(h),f&&b(f),g&&b(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),b(c)]})]})},LT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},zT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Db=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),RT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:o,metadata:i,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:w,renderParameterField:b,onToggleColumn:_,onApplyRecommended:x,formatMissingPercentage:N})=>{const C=v.useMemo(()=>{if(!o.length)return[];const M=new Set;return o.forEach(T=>{T.status==="recommended"&&T.selectable&&M.add(T.column)}),Array.from(M)},[o]),E=v.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),j=o.length>0,S=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(C),disabled:!C.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:E}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((M,T)=>a.jsx("li",{children:M},`one-hot-note-${T}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:o.map(M=>{const T=w.includes(M.column),P=LT[M.status],L=zT[M.status]??"canvas-cast__chip--muted",$=M.sample_values.length?M.sample_values.join(", "):"",A=M.unique_count!==void 0&&M.unique_count!==null?`${Db(M.unique_count)} (${Db(M.unique_percentage)}%)`:"",R=N(M.missing_percentage),W=M.estimated_dummy_columns?M.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:M.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[M.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",M.dtype]}),M.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:M.text_category}),M.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",$]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:M.reason})]})}),a.jsx("td",{children:A}),a.jsx("td",{children:R}),a.jsx("td",{children:W}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${L}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:()=>_(M.column),disabled:!M.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:M.selectable?T?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${M.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&b(u),d&&b(d),p&&b(p),h&&b(h),f&&b(f),g&&b(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),b(c)]})]})},Fb={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},DT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},Ib=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},FT=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(s=>s&&s.split===t)??null:null,kh=(e,t)=>{const n=FT(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const s=Fb[n.action]??n.action,o=Ib(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:s}),o&&a.jsx("span",{className:"canvas-cast__muted",children:o})]})},IT=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(s=>s&&!["train","test","validation"].includes(s.split));return t.length&&t.map(s=>{const o=s.label||s.split,i=Fb[s.action]??s.action,c=Ib(s.rows??null);return c?`${o}: ${i} (${c})`:`${o}: ${i}`}).join("; ")||null},BT=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,UT=({signal:e,previewStatus:t,hasSource:n,hasReachableSource:s,onRefreshPreview:o})=>{const i=v.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),c=(e==null?void 0:e.total_transformers)??i.length,u=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],d=t==="loading",p=c?`Tracking ${c.toLocaleString()} transformer${c===1?"":"s"}.`:null,h=d||!n||!s;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:o,disabled:h,children:d?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),p&&a.jsx("p",{className:"canvas-modal__note",children:p}),!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),n&&!s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),u.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:u.map((f,g)=>a.jsx("li",{children:f},`transformer-audit-note-${g}`))}),d&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!d&&t==="error"&&n&&s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!d&&n&&s&&!i.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!d&&i.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:i.map((f,g)=>{const w=f.storage_key??`${f.transformer_name}-${f.column_name??"all"}-${g}`,b=IT(f),_=f.source_node_label||f.source_node_id||"",x=DT(f.updated_at??f.created_at??null),N=f.column_name??"",C=BT(f);return a.jsxs(ve.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:_})})}),a.jsx("td",{children:f.transformer_name}),a.jsx("td",{children:N}),a.jsx("td",{children:C||""}),a.jsx("td",{children:kh(f,"train")}),a.jsx("td",{children:kh(f,"test")}),a.jsx("td",{children:kh(f,"validation")}),a.jsx("td",{children:x})]}),b&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",b]})})})]},w)})})]})})]})},Mh=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",qT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},HT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},VT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:o,config:i,targetColumnParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p})=>{var re,Y,V,G;const h=s.data,f=s.status,g=Array.isArray(h==null?void 0:h.applied_steps)?h.applied_steps:[],w=Array.isArray(h==null?void 0:h.columns)?h==null?void 0:h.columns:[],b=Array.isArray((re=h==null?void 0:h.signals)==null?void 0:re.feature_target_split)?(Y=h==null?void 0:h.signals)==null?void 0:Y.feature_target_split:[],_=HT(b,e),x=(i==null?void 0:i.targetColumn)??"",N=(_==null?void 0:_.target_column)??x,C=(i==null?void 0:i.featureColumns)??[],E=v.useMemo(()=>Array.isArray(h==null?void 0:h.column_stats)?h==null?void 0:h.column_stats:[],[h==null?void 0:h.column_stats]),j=v.useMemo(()=>{const X=new Map;return E.forEach(se=>{se!=null&&se.name&&X.set(se.name,se)}),X},[E]),S=v.useMemo(()=>{var X;return(X=_==null?void 0:_.feature_columns)!=null&&X.length?_.feature_columns:C.length?C:N?w.filter(se=>se!==N):w.slice()},[_==null?void 0:_.feature_columns,C,w,N]),M=(_==null?void 0:_.auto_included_columns)??[],T=(_==null?void 0:_.missing_feature_columns)??[],P=(_==null?void 0:_.excluded_columns)??[],L=(_==null?void 0:_.target_missing_count)??0,$=typeof(_==null?void 0:_.target_missing_percentage)=="number"?_.target_missing_percentage:null,A=(_==null?void 0:_.target_dtype)??(N?((V=j.get(N))==null?void 0:V.dtype)??null:null),R=typeof((G=h==null?void 0:h.metrics)==null?void 0:G.row_count)=="number"?h.metrics.row_count:null,W=S.length,z=M.length,D=P.length,H=T.length,q=v.useMemo(()=>qT(g),[g]),I=v.useMemo(()=>{const X=[];if(X.push({label:"Target column",value:N||"Not set"}),X.push({label:"Feature columns",value:d(W)}),R!==null&&X.push({label:"Preview rows",value:d(R)}),z&&X.push({label:"Auto-selected features",value:d(z)}),H&&X.push({label:"Configured features missing",value:d(H)}),D&&X.push({label:"Excluded columns",value:d(D)}),L){const se=d(L),J=$!==null?p($):null;X.push({label:"Target missing values",value:J?`${se} (${J})`:se})}return X},[z,D,W,d,p,H,R,N,L,$]),Q=v.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),U=v.useMemo(()=>!t||!n?null:f==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,f,t]),F=v.useMemo(()=>N?f==="success"&&N&&!w.includes(N)?`Target column "${N}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[w,f,N]),K=!!t&&n&&f!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:o,disabled:!K,children:f==="loading"?"Refreshing...":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),Q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Q}),s.error&&f==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),U&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:U}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:F}),H>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",Mh(T),"."]}),D>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",Mh(P),"."]}),z>0&&C.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",Mh(M),"."]}),q&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:q}),I.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:I.map(X=>a.jsxs("li",{children:[X.label,": ",a.jsx("strong",{children:X.value})]},`feature-target-summary-${X.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:c&&u(c)}),f==="success"&&W===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",A?a.jsx("strong",{children:A}):a.jsx("span",{children:"Unknown"}),L?` - Missing rows flagged for review: ${d(L)}.`:""]})]})},WT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},Wr=e=>`${(e*100).toFixed(1)}%`,KT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:o,config:i,parameters:c,renderParameterField:u,formatMetricValue:d})=>{var $,A;const p=s.data,h=s.status,f=Array.isArray(($=p==null?void 0:p.signals)==null?void 0:$.train_test_split)?(A=p==null?void 0:p.signals)==null?void 0:A.train_test_split:[],g=WT(f,e),w=(i==null?void 0:i.test_size)??.2,b=(i==null?void 0:i.validation_size)??0,_=i==null?void 0:i.random_state;i==null||i.shuffle;const x=(i==null?void 0:i.stratify)??!1,N=(i==null?void 0:i.target_column)??"",C=b>0,E=v.useMemo(()=>g?{trainSize:g.train_size??0,validationSize:g.validation_size??0,testSize:g.test_size??0,totalSize:g.total_size??0,trainRatio:g.train_size&&g.total_size?g.train_size/g.total_size:0,validationRatio:g.validation_ratio??0,testRatio:g.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-w-b,validationRatio:b,testRatio:w},[g,w,b]),j=c.find(R=>R.name==="test_size"),S=c.find(R=>R.name==="validation_size"),M=c.find(R=>R.name==="random_state"),T=c.find(R=>R.name==="shuffle"),P=c.find(R=>R.name==="stratify"),L=c.find(R=>R.name==="target_column");return a.jsxs("div",{className:"node-settings__section",children:[a.jsx("div",{className:"node-settings__section-header",children:a.jsx("h3",{children:"Train/Test Split Configuration"})}),a.jsxs("div",{className:"node-settings__field-group",children:[j&&u(j),S&&u(S),M&&u(M),T&&u(T),P&&u(P),x&&L&&u(L)]}),h==="success"&&g&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:Wr(E.trainRatio)},title:`Training: ${E.trainSize} rows (${Wr(E.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),C&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:Wr(E.validationRatio)},title:`Validation: ${E.validationSize} rows (${Wr(E.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:Wr(E.testRatio)},title:`Test: ${E.testSize} rows (${Wr(E.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:d(E.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(E.trainSize,0)," (",Wr(E.trainRatio),")"]})]}),C&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(E.validationSize,0)," (",Wr(E.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(E.testSize,0)," (",Wr(E.testRatio),")"]})]}),x&&N&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:N})]}),_!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:_})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",children:[a.jsx("span",{className:"node-settings__warning-icon",children:""}),"Connect this node to a data source to configure the split."]}),h==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),h==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},YT={classification:"Classification",regression:"Regression"},GT=e=>e==="numeric"||e==="integer",QT=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},Ah=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,XT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},JT=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:s,config:o,targetColumnParameter:i,problemTypeParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p,schemaColumns:h})=>{var V;const f=n.data,g=n.status,w=Array.isArray(f==null?void 0:f.applied_steps)?f.applied_steps:[],b=Array.isArray(f==null?void 0:f.column_stats)?f.column_stats:[],_=(f==null?void 0:f.metrics)??null,x=v.useMemo(()=>Array.isArray(f==null?void 0:f.columns)?f.columns.filter(G=>typeof G=="string"&&G.trim().length>0):[],[f==null?void 0:f.columns]),N=v.useMemo(()=>{var G;return h.length?h:Array.isArray((G=f==null?void 0:f.schema)==null?void 0:G.columns)?f.schema.columns:x.length>0?x.map(X=>({name:X,pandas_dtype:null,logical_family:"unknown",nullable:!0})):[]},[(V=f==null?void 0:f.schema)==null?void 0:V.columns,x,h]),C=v.useMemo(()=>{const G=new Map;return N.forEach(X=>{X!=null&&X.name&&G.set(X.name,X)}),G},[N]),E=(o==null?void 0:o.targetColumn)??"",j=(o==null?void 0:o.problemType)??"classification",S=E?b.find(G=>(G==null?void 0:G.name)===E)??null:null,T=!!(E?C.get(E)??null:null),P=v.useMemo(()=>{const G=new Set;return b.forEach(X=>{X!=null&&X.name&&X.name!==E&&G.add(X.name)}),N.forEach(X=>{X!=null&&X.name&&X.name!==E&&G.add(X.name)}),Array.from(G).sort()},[b,N,E]),L=v.useMemo(()=>P.filter(G=>{const X=C.get(G);if(X&&GT(X.logical_family))return!0;const se=b.find(J=>J.name===G);return QT((se==null?void 0:se.dtype)??null)}),[b,P,C]),$=v.useMemo(()=>new Set(L),[L]),A=v.useMemo(()=>P.filter(G=>!$.has(G)),[P,$]),R=v.useMemo(()=>b.filter(G=>(G==null?void 0:G.name)&&G.name!==E&&(G.missing_count??0)>0).map(G=>G.name),[b,E]),W=typeof(_==null?void 0:_.row_count)=="number"?_.row_count:null,z=typeof(S==null?void 0:S.distinct_count)=="number"&&Number.isFinite(S.distinct_count)?S.distinct_count:null,D=typeof(S==null?void 0:S.missing_count)=="number"?S.missing_count:0,H=typeof(S==null?void 0:S.missing_percentage)=="number"?S.missing_percentage:null,q=v.useMemo(()=>{const G=[];return E?g!=="success"?G:!S&&!T&&!P.length?(G.push(`Target column "${E}" is not present in the preview output, and no feature columns were found.`),G):(P.length||G.push("Add at least one feature column in addition to the target before training."),S&&D>0&&G.push(`Target column includes ${D} missing value${D===1?"":"s"}.`),j==="classification"&&S&&(z??0)<2&&G.push("Classification tasks require at least two distinct target classes."),j==="regression"&&L.length===0&&G.push("Regression tasks need at least one numeric feature column."),R.length>0&&G.push(`Feature columns with missing values: ${Ah(R)}.`),W!==null&&W===0&&G.push("Preview returned zero rows after upstream transformations."),G):(G.push("Set a target column to evaluate downstream modeling constraints."),G)},[R,P.length,D,L.length,W,g,j,E,z,S,T]),I=v.useMemo(()=>YT[j],[j]),Q=v.useMemo(()=>{const G=[{label:"Problem type",value:I},{label:"Target column",value:E||"Not set"}];if(g==="success"){if(z!==null&&G.push({label:"Target distinct values",value:d(z)}),S){const X=d(D),se=H!==null?p(H):null;G.push({label:"Target missing values",value:se?`${X} (${se})`:X})}R.length>0&&G.push({label:"Features with missing values",value:d(R.length)})}return G},[I,R.length,d,p,D,g,E,z,H,S]),U=v.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),F=v.useMemo(()=>!e||!t?null:g==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,g,e]),K=v.useMemo(()=>XT(w),[w]),re=!!e&&t&&g!=="loading",Y=v.useMemo(()=>!E||g!=="success"||q.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[g,q.length,E]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:!re,children:g==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),U&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:U}),n.error&&g==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:F}),q.map((G,X)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:G},`train-model-issue-${X}`)),Y&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:Y}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:K}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[i&&u(i),c&&u(c)]}),Q.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Q.map(G=>a.jsxs("li",{children:[G.label,": ",a.jsx("strong",{children:G.value})]},`train-model-summary-${G.label}`))}),g==="success"&&R.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",Ah(R),"."]}),g==="success"&&j==="regression"&&A.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",Ah(A),". Consider encoding or casting them before training regression models."]})]})},Bb=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?Hs(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},ZT=e=>e||"Unknown",e2=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},Rn=e=>{const t=e2(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const s=Math.round(n/60);if(s===1)return"1 hour ago";if(s<24)return`${s} hours ago`;const o=Math.round(s/24);return o===1?"1 day ago":`${o} days ago`},Ub=e=>typeof e!="number"||!Number.isFinite(e)?"":Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3),t2=({presets:e,isOpen:t,onClose:n,onApply:s,activePresetId:o,fieldMetadata:i})=>{const[c,u]=v.useState(null);v.useEffect(()=>{var f;if(!t){u(null);return}c&&e.some(g=>g.id===c)||u(((f=e[0])==null?void 0:f.id)??null)},[t,e,c]),v.useEffect(()=>{if(!t)return;const f=g=>{g.key==="Escape"&&n()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[t,n]);const d=v.useMemo(()=>c?e.find(f=>f.id===c)??e[0]??null:e[0]??null,[e,c]),p=v.useMemo(()=>!o||!d?!1:o===d.id,[o,d]),h=v.useMemo(()=>{var x,N;if(!t||!e.length)return null;const f=((x=d==null?void 0:d.modelType)==null?void 0:x.toLowerCase())==="logistic_regression"?(N=d==null?void 0:d.params)==null?void 0:N.solver:null,g=typeof f=="string"?f.trim().toLowerCase():null,w=g&&(g==="sag"||g==="saga")?"SAG and SAGA solvers expect standardized features. Scale inputs before training to improve convergence and avoid repeated warnings.":null,b=d?Object.entries(d.params??{}).sort(([C],[E])=>C.localeCompare(E)).map(([C,E])=>{const j=i==null?void 0:i[C],S=A=>{var R;return(R=j==null?void 0:j.options)!=null&&R.length?j.options.find(W=>{const z=W.value;return A==null?z===null||typeof z=="string"&&z.trim().toLowerCase()==="none":typeof A=="string"&&typeof z=="string"?z===A?!0:z.trim().toLowerCase()===A.trim().toLowerCase():String(z)===String(A)})??null:null},M=A=>{if(A===null)return j!=null&&j.nullable?"None":"";if(A===void 0)return"";if(typeof A=="boolean")return A?"true":"false";if(typeof A=="number")return Number.isFinite(A)?A.toString():String(A);if(A&&typeof A=="object")try{return JSON.stringify(A)}catch{return"[object]"}return String(A??"")},T=A=>{var D;if(!A)return null;const R=A.value,W=(D=A.label)==null?void 0:D.trim(),z=M(R);return W&&z&&W!==z?`${W} (${z})`:W||z},P=()=>{if(j&&j.default!==void 0){const A=L(j.default,!1);if(A.text)return{text:A.text,note:"Using estimator default"}}return{text:"",note:"Using estimator default"}},L=(A,R=!0)=>{const W=S(A);return W?{text:T(W)??"",note:null}:Array.isArray(A)?A.length===0?R?P():{text:"",note:null}:{text:A.map(D=>L(D,!1)).map(D=>D.text).filter(Boolean).join(", "),note:null}:A===void 0||typeof A=="string"&&A.trim()===""?R?P():{text:"",note:null}:A===null?j!=null&&j.nullable?{text:"None",note:null}:R?P():{text:"",note:null}:{text:M(A),note:null}},$=L(E);return{key:C,label:(j==null?void 0:j.label)??C,description:(j==null?void 0:j.description)??null,value:$.text,note:$.note}}):[],_=d!=null&&d.finishedAt?Rn(d.finishedAt):null;return a.jsxs("div",{className:"canvas-modal best-param-modal",role:"dialog","aria-modal":"true",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:n}),a.jsxs("div",{className:"canvas-modal__panel best-param-modal__panel",role:"document",children:[a.jsxs("header",{className:"best-param-modal__header",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"best-param-modal__title",children:"Tuned Hyperparameter Presets"}),a.jsx("p",{className:"best-param-modal__subtitle",children:"Review hyperparameter sets discovered by recent tuning runs and apply them to the current model."})]}),a.jsx("button",{type:"button",className:"best-param-modal__close",onClick:n,children:"Close"})]}),a.jsxs("div",{className:"best-param-modal__layout",children:[a.jsx("aside",{className:"best-param-modal__list","aria-label":"Tuned presets",children:e.map(C=>{const E=C.id===(d==null?void 0:d.id),j=C.finishedAt?Rn(C.finishedAt):null;return a.jsxs("button",{type:"button",className:`best-param-modal__list-button${E?" best-param-modal__list-button--active":""}`,onClick:()=>u(C.id),children:[a.jsx("span",{className:"best-param-modal__list-title",children:C.label}),a.jsxs("span",{className:"best-param-modal__list-meta",children:[C.runNumber?`Run ${C.runNumber}`:"Tuning run",j?`  ${j}`:""]}),C.scoring&&a.jsxs("span",{className:"best-param-modal__list-score",children:[C.scoring,": ",Ub(C.score)]}),C.targetColumn&&a.jsxs("span",{className:"best-param-modal__list-target",children:["Target: ",C.targetColumn]})]},C.id)})}),a.jsx("section",{className:"best-param-modal__details",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"best-param-modal__summary",children:[a.jsxs("div",{className:"best-param-modal__summary-main",children:[a.jsx("h4",{children:d.label}),a.jsxs("p",{children:[d.runNumber?`Run ${d.runNumber}`:"Tuning run",_?`  ${_}`:"",d.searchStrategy?`  ${d.searchStrategy}`:""]}),a.jsxs("p",{children:["Model: ",a.jsx("strong",{children:d.modelType}),d.targetColumn?a.jsxs(a.Fragment,{children:[" "," Target: ",a.jsx("strong",{children:d.targetColumn})]}):null,d.scoring?a.jsxs(a.Fragment,{children:[" "," ",d.scoring,": ",a.jsx("strong",{children:Ub(d.score)})]}):null]})]}),a.jsx("div",{className:"best-param-modal__summary-actions",children:a.jsx("button",{type:"button",className:"best-param-modal__apply",onClick:()=>s(d),disabled:!b.length,children:p?"Already applied":"Apply preset"})})]}),d.description&&a.jsx("p",{className:"best-param-modal__note",children:d.description}),w&&a.jsxs("div",{className:"best-param-modal__notice best-param-modal__notice--warning",children:[a.jsx("strong",{children:"Tip:"})," ",w]}),a.jsx("div",{className:"best-param-modal__param-grid",role:"table",children:b.length?b.map(C=>a.jsxs("div",{className:"best-param-modal__param-row",role:"row",children:[a.jsxs("div",{className:"best-param-modal__param-name",role:"cell",children:[a.jsxs("div",{className:"best-param-modal__param-label",children:[C.label,C.label!==C.key&&a.jsx("span",{className:"best-param-modal__param-key",children:a.jsx("code",{children:C.key})})]}),C.description&&a.jsx("div",{className:"best-param-modal__param-description",children:C.description})]}),a.jsxs("div",{className:"best-param-modal__param-value",role:"cell",children:[a.jsx("code",{children:C.value}),C.note&&a.jsx("span",{className:"best-param-modal__param-note",children:C.note})]})]},C.key)):a.jsx("p",{className:"best-param-modal__empty",children:"No hyperparameters available for this preset."})})]}):a.jsx("p",{className:"best-param-modal__empty",children:"Select a tuning run to inspect its hyperparameters."})})]})]})]})},[o,p,i,t,s,n,e,d]);return h?Gp.createPortal(h,document.body):null},n2=new Set(["scale_numeric_features","scaling","scale_numeric"]),s2=[/convergencewarning/i,/failed to converge/i,/did not converge/i,/optimizer failed to converge/i,/increase the number of iterations/i,/scale your features/i,/standardize your features/i,/consider scaling your (data|features)/i,/feature scaling is (recommended|required)/i],r2=["forest","tree","boost","xgboost","lightgbm","catboost","gradient","histgradient","bagging"],a2=["bayes","naive_bayes","gaussian_nb"],o2=e=>{const t=e.trim().toLowerCase();return t?r2.some(s=>t.includes(s))?{required:!1,reason:null}:a2.some(s=>t.includes(s))?{required:!1,reason:null}:t.includes("logistic")?{required:!0,reason:"logistic"}:t.includes("svm")||t.includes("svc")||t.includes("svr")?{required:!0,reason:"svm"}:t.includes("knn")||t.includes("nearest")?{required:!0,reason:"knn"}:t.includes("sgd")||t.includes("perceptron")?{required:!0,reason:"sgd"}:["linear","ridge","lasso","elastic","regression"].some(s=>t.includes(s))?{required:!0,reason:"linear"}:{required:!1,reason:null}:{required:!1,reason:null}},l2=(e,t)=>{const n=new Set;if(!e||!t)return n;const s=Array.isArray(e.edges)?e.edges:[],o=[t];for(;o.length;){const i=o.pop();if(i)for(const c of s){if(!c)continue;const u=typeof c.source=="string"?c.source.trim():"",d=typeof c.target=="string"?c.target.trim():"";!u||!d||d===i&&!n.has(u)&&(n.add(u),o.push(u))}}return n},i2=(e,t)=>{if(!e||!t)return!1;const n=l2(e,t);return n.size?(Array.isArray(e.nodes)?e.nodes:[]).some(o=>{var c;if(!o||typeof o.id!="string"||!n.has(o.id))return!1;const i=String(((c=o==null?void 0:o.data)==null?void 0:c.catalogType)??(o==null?void 0:o.type)??"").toLowerCase();return i?n2.has(i)?!0:i.includes("scale")&&i.includes("numeric"):!1}):!1},c2=(e,t)=>{const n=t.find(s=>(s==null?void 0:s.value)===e);return n!=null&&n.label?n.label:e.replace(/_/g," ").replace(/\s+/g," ").trim()},Oh=(e,t=new Set,n=0)=>{if(e==null)return[];if(typeof e=="string")return[e];if(typeof e=="number"||typeof e=="boolean")return[];if(n>3)return[];if(Array.isArray(e)){if(!e.length)return[];const s=32,o=[];for(let i=0;i<e.length&&i<s;i+=1)o.push(...Oh(e[i],t,n+1));return o}if(typeof e=="object"){if(t.has(e))return[];t.add(e);const s=Object.values(e);if(!s.length)return[];const o=32,i=[];for(let c=0;c<s.length&&c<o;c+=1)i.push(...Oh(s[c],t,n+1));return i}return[]},Nl=e=>{if(!e)return!1;const t=Oh(e);return t.length?t.some(n=>s2.some(s=>s.test(n))):!1},Ui=e=>{var n,s,o,i,c,u,d,p,h,f,g,w,b,_;if(!e)return!1;const t=[e.error_message,e.warning_message,e.message,e.details,e.notes,e.status_reason,e.status_message,e.error,(n=e.metadata)==null?void 0:n.warnings,(s=e.metadata)==null?void 0:s.warning,(o=e.metadata)==null?void 0:o.notes,(i=e.metadata)==null?void 0:i.messages,(c=e.metadata)==null?void 0:c.message,(u=e.metadata)==null?void 0:u.errors,(d=e.metrics)==null?void 0:d.warnings,(p=e.metrics)==null?void 0:p.warning,(h=e.metrics)==null?void 0:h.messages,(f=e.metrics)==null?void 0:f.message,(g=e.job_metadata)==null?void 0:g.warnings,(w=e.job_metadata)==null?void 0:w.warning,(b=e.job_metadata)==null?void 0:b.messages,(_=e.job_metadata)==null?void 0:_.notes];for(const x of t)if(Nl(x))return!0;return!!(Nl(e.metadata)||Nl(e.metrics))},u2=(e,t,n)=>{const s=t||"This model";switch(e){case"logistic":return{headline:`${s} needs scaled numeric features`,summary:'Standardize numeric inputs before launching jobs to keep the logistic solver stable and avoid repeated "scale your features" warnings.',details:["Insert a Scale numeric features step before this node or reuse an upstream scaler.","StandardScaler works for most datasets; RobustScaler can help when outliers dominate.","Once scaling is in place, re-run tuning or training so the solver converges cleanly."]};case"svm":return{headline:`${s} is sensitive to feature scale`,summary:"Support Vector Machines depend on distance calculations. Keep numeric features on comparable scales to preserve margin geometry.",details:["Add the Scale numeric features step upstream of this node.","Try StandardScaler or MinMaxScaler depending on the kernel and expected ranges.","Retrain after scaling to refresh support vectors and hyperparameters."]};case"knn":return{headline:`${s} uses distance-based comparisons`,summary:"k-NN models weigh distances directly, so unscaled columns dominate neighbors. Scale numeric fields to keep votes balanced.",details:["Drop in a Scale numeric features step before launching jobs.","MinMaxScaler keeps features in [0, 1]; StandardScaler works when values are roughly normal.","Requeue jobs after scaling so neighbor search reflects the new feature space."]};case"sgd":return{headline:`${s} benefits from normalized inputs`,summary:"Stochastic gradient models converge faster and produce steadier coefficients when numeric inputs share a common scale.",details:["Insert a Scale numeric features node prior to this step.","StandardScaler plus optional RobustScaler for heavy-tailed features keeps gradients stable.","Re-run jobs after scaling to avoid exploding or vanishing updates."]};default:return{headline:`${s} prefers standardized numeric features`,summary:n==="regression"?"Linear regression families rely on comparable feature magnitudes. Scaling keeps coefficients well-conditioned and improves R stability.":"Linear classification models respond better when numeric inputs share a common scale. Scaling prevents any single column from dominating the loss.",details:["Add the Scale numeric features step ahead of this node or reuse an existing scaler.","StandardScaler is a safe default; RobustScaler helps when outliers skew distributions.","Re-launch jobs once scaling is applied so coefficients represent the standardized space."]}}},qb=({graph:e,nodeId:t,modelType:n,problemType:s,modelTypeOptions:o,enabled:i})=>v.useMemo(()=>{if(!i||!n||!n.trim()||i2(e,t))return null;const c=n.trim().toLowerCase(),{required:u,reason:d}=o2(c);if(!u||!d)return null;const p=c2(n,o);return u2(d,p,s)},[i,e,n,o,t,s]),d2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},Cl={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},Th=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([s,o])=>{t.has(s)&&(n[s]=o)}),n},Hb=(e,t)=>{if(e===t||typeof e=="number"&&typeof t=="number"&&Number.isNaN(e)&&Number.isNaN(t))return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length!==t.length?!1:e.every((n,s)=>Hb(n,t[s]));if(e&&t&&typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1},m2=(e,t,n)=>{if(!e)return{};const s={};return Object.entries(e).forEach(([o,i])=>{if(!t.has(o)||i===""||i===null||i===void 0)return;const c=n==null?void 0:n[o];let u=i;if(c){if(typeof u=="string"){const d=u.trim();if(!d)return;c.type==="select"&&(u=d)}if(c.name==="multi_class"&&typeof u=="string"){const d=u.trim().toLowerCase();if(d==="auto")return;(d==="ovr"||d==="multinomial")&&(u=d)}if(c.default!==void 0){if(typeof c.default=="string"&&typeof u=="string"){const d=c.default.trim(),p=u.trim();if(d===p)return}else if(Hb(c.default,u))return}}s[o]=u}),s},Vb=e=>!!e&&typeof e=="object"&&!Array.isArray(e),qi=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},h2=e=>{if(!e)return Cl.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return Cl.regression;if(t.includes("classifier")||t.includes("classification"))return Cl.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?Cl.regression:n==="classification"?Cl.classification:Cl.fallback},f2=e=>{var i,c,u;if(!e)return null;const t=[],n=(c=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:c.mean;Vb(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const s=[e.test,e.validation,e.train];for(const d of s)Vb(d)&&t.push({dataset:d,labelPrefix:""});const o=h2(e);for(const d of t)for(const p of o){const h=d.dataset[p];if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h}}for(const d of t)for(const[p,h]of Object.entries(d.dataset))if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h};return null},Wb=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",p2=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:o,cvConfig:i,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,hyperparametersParameter:h,cvEnabledParameter:f,cvStrategyParameter:g,cvFoldsParameter:w,cvShuffleParameter:b,cvRandomStateParameter:_,cvRefitStrategyParameter:x,onSaveDraftConfig:N})=>{var Un,Ys,os,_r;const C=ho(),[E,j]=v.useState(null),[S,M]=v.useState(null),[T,P]=v.useState(null),[L,$]=v.useState(0),[A,R]=v.useState({}),[W,z]=v.useState(!1),D=v.useRef(!1),[H,q]=v.useState(null),[I,Q]=v.useState(!1),[U,F]=v.useState(!1),[K,re]=v.useState(null),[Y,V]=v.useState(null),[G,X]=v.useState(!1),se=((s==null?void 0:s.targetColumn)??"").trim(),J=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",te=((o==null?void 0:o.modelType)??"").trim(),Se=(o==null?void 0:o.hyperparameters)??null,ze=(o==null?void 0:o.hyperparametersError)??null,Oe=!!(i!=null&&i.enabled),Ue=(i==null?void 0:i.strategy)??"auto",nt=typeof(i==null?void 0:i.folds)=="number"?i.folds:0,He=!!(i!=null&&i.shuffle),de=(i==null?void 0:i.randomState)??null,_e=(i==null?void 0:i.refitStrategy)??"train_plus_validation",je=v.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),Me=Is({queryKey:["model-hyperparameters",te],queryFn:()=>wu(te),enabled:!!te,staleTime:5*60*1e3}),De=Is({queryKey:["best-hyperparameters",te,H,t],queryFn:()=>_y(te,{pipelineId:H||void 0,datasetSourceId:t||void 0}),enabled:!!(te&&t),staleTime:30*1e3,retry:1}),ce=((Un=Me.data)==null?void 0:Un.fields)??[],Te=((Ys=Me.data)==null?void 0:Ys.defaults)??{},Qe=v.useMemo(()=>ce.length?new Set(ce.map(le=>le.name)):new Set,[ce]),ht=v.useMemo(()=>ce.length?ce.reduce((le,ge)=>(ge!=null&&ge.name&&(le[ge.name]=ge),le),{}):{},[ce]),rt=v.useMemo(()=>{if(!te||!Se||Qe.size===0)return null;const le=Th(Se,Qe);return Object.keys(le).length>0?le:null},[Qe,Se,te]);v.useEffect(()=>{R({}),z(!1),D.current=!1},[te]),v.useEffect(()=>{rt&&(R(le=>{const ge=Object.keys(le),Pe=Object.keys(rt);return ge.length===Pe.length&&Pe.every(we=>Object.is(le[we],rt[we]))?le:rt}),D.current||(z(!0),D.current=!0))},[rt]),v.useEffect(()=>{if(!te||rt||Qe.size===0||!Te||Object.keys(Te).length===0)return;const le=Th(Te,Qe);Object.keys(le).length!==0&&R(ge=>Object.keys(ge).length>0?ge:le)},[Qe,rt,Te,te]);const gt=v.useMemo(()=>{if(Qe.size===0)return null;const le=m2(A,Qe,ht);return Object.keys(le).length>0?le:null},[Qe,A]),at=v.useCallback(()=>{z(le=>{const ge=!le;return ge&&(D.current=!0),ge})},[]),ut=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),Ot=v.useMemo(()=>{if(!ut)return null;if(!c||Object.keys(c).length===0)return ut;const le=qi(ut);return!le||!Array.isArray(le.nodes)||(le.nodes=le.nodes.map(ge=>{if(!ge||ge.id!==e)return ge;const Pe=(ge==null?void 0:ge.data)??{},we={...(Pe==null?void 0:Pe.config)??{},...c};return{...ge,data:{...Pe,config:we,isConfigured:!0}}})),le},[c,ut,e]);v.useEffect(()=>{let le=!1;return!t||!ut?(q(null),()=>{le=!0}):(xo(t,ut).then(ge=>{le||q(ge)}).catch(()=>{le||q(null)}),()=>{le=!0})},[ut,t]),v.useEffect(()=>{let le=!1;M(null);const ge=Ot??ut;return!t||!ge?(j(null),()=>{le=!0}):(xo(t,ge).then(Pe=>{le||j(Pe)}).catch(Pe=>{le||(M((Pe==null?void 0:Pe.message)??"Unable to compute pipeline ID"),j(null))}),()=>{le=!0})},[ut,Ot,t]),v.useEffect(()=>{if(!E||!H){Q(!1);return}Q(E!==H)},[E,H]);const Rt=v.useMemo(()=>["feature-canvas","training-jobs",t??"none",E??"pending",e],[e,E,t]),Xe=v.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",E??"pending",e],[e,E,t]),Bt=!!(t&&e),Kt=Is({queryKey:Xe,queryFn:async()=>{var ge;const le={datasetSourceId:t||void 0,limit:5};if(E){const Pe=await Ti({...le,pipelineId:E});if((((ge=Pe==null?void 0:Pe.jobs)==null?void 0:ge.length)??0)>0)return Pe}return Ti(le)},enabled:Bt,retry:(le,ge)=>ge.message.includes("Sign in")?!1:le<2,refetchInterval:le=>{const ge=le.state.data;return((ge==null?void 0:ge.jobs)??[]).some(we=>we.status==="queued"||we.status==="running")?5e3:!1}}),kt=Is({queryKey:Rt,queryFn:async()=>{var ge;const le={datasetSourceId:t||void 0,nodeId:e,limit:5};if(E){const Pe=await Oi({...le,pipelineId:E});if((((ge=Pe==null?void 0:Pe.jobs)==null?void 0:ge.length)??0)>0)return Pe}return Oi(le)},enabled:Bt,retry:(le,ge)=>ge.message.includes("Sign in")?!1:le<2,refetchInterval:le=>{const ge=le.state.data;return((ge==null?void 0:ge.jobs)??[]).some(we=>we.status==="queued"||we.status==="running")?5e3:!1}}),{mutateAsync:_t,isPending:Cn,error:Lt}=Uc({mutationFn:hy,onSuccess:le=>{const ge=Array.isArray(le.jobs)?le.jobs.length:0,Pe=ge>0?le.jobs[0]:null;P(Pe),$(ge),C.invalidateQueries({queryKey:Rt})}}),rn=Kt.error,fe=Kt.isLoading||Kt.isFetching,Ut=((os=Kt.data)==null?void 0:os.jobs)??[],dt=De.data,Tn=v.useCallback(le=>{if(!le)return null;const ge=Object.keys(le);if(ge.length===0)return null;if(Qe.size===0)return{params:le,hasUnmapped:!1};const Pe=Th(le,Qe),Nt=Object.keys(Pe);return Nt.length>0?{params:Pe,hasUnmapped:Nt.length!==ge.length}:{params:le,hasUnmapped:!0}},[Qe]),qe=v.useMemo(()=>Ut.length?Ut.filter(le=>le.status==="succeeded"):[],[Ut]),wt=v.useMemo(()=>{if(!te)return[];const le=[],ge=new Set,Pe=se?se.trim().toLowerCase():"",Nt=we=>!Pe||!we?!0:we.trim().toLowerCase()===Pe;if(dt!=null&&dt.available&&dt.best_params&&(!dt.model_type||dt.model_type===te)){const we=Tn(dt.best_params);if(we){const tt=dt.job_id??null;if(!tt||!ge.has(tt)){const it=["Most recent tuned run"];dt.run_number&&it.push(`#${dt.run_number}`);const Ct=`best-api-${tt??te}`;le.push({id:Ct,label:it.join(" "),source:"best-api",modelType:dt.model_type??te,params:we.params,jobId:tt,nodeId:dt.node_id??null,runNumber:dt.run_number??null,score:dt.best_score??null,scoring:dt.scoring??null,finishedAt:dt.finished_at??null,searchStrategy:dt.search_strategy??null,nIterations:dt.n_iterations??null,targetColumn:se||null,pipelineId:dt.pipeline_id??null,datasetSourceId:t??null,description:we.hasUnmapped?"Includes parameters outside the current template. They will be stored as custom overrides.":null}),tt&&ge.add(tt)}}}return qe.forEach(we=>{var un,Es,Jn,En,kn;if(!we.best_params||we.model_type!==te||t&&we.dataset_source_id&&we.dataset_source_id!==t||ge.has(we.id))return;const tt=Tn(we.best_params);if(!tt)return;const it=typeof((un=we.metadata)==null?void 0:un.target_column)=="string"?we.metadata.target_column:typeof((Es=we.metadata)==null?void 0:Es.targetColumn)=="string"?we.metadata.targetColumn:null;if(!Nt(it))return;const Ct=`job-${we.id}`,$t=(()=>{var qn;const Zn=typeof((qn=we.metadata)==null?void 0:qn.label)=="string"?we.metadata.label.trim():"";return Zn||(we.run_number?`Run ${we.run_number}`:`Job ${we.id.slice(0,6)}`)})(),en=typeof((Jn=we.metadata)==null?void 0:Jn.scoring)=="string"?we.metadata.scoring:typeof((En=we.metrics)==null?void 0:En.scoring)=="string"?we.metrics.scoring:null,qt=typeof((kn=we.metadata)==null?void 0:kn.n_iterations)=="number"?we.metadata.n_iterations:null;le.push({id:Ct,label:$t,source:"tuning-job",modelType:we.model_type,params:tt.params,jobId:we.id,nodeId:we.node_id,runNumber:we.run_number??null,score:we.best_score??null,scoring:en,finishedAt:we.updated_at??we.created_at??null,searchStrategy:we.search_strategy??null,nIterations:qt,targetColumn:it??(se||null),pipelineId:we.pipeline_id??null,datasetSourceId:we.dataset_source_id??null,description:tt.hasUnmapped?"Some tuned parameters fall outside the current template and will be saved as custom overrides.":null}),ge.add(we.id)}),le.sort((we,tt)=>{const it=we.finishedAt?Date.parse(we.finishedAt):0,Ct=tt.finishedAt?Date.parse(tt.finishedAt):0;return it!==Ct?Ct-it:(tt.runNumber??0)-(we.runNumber??0)}),le},[dt,Tn,te,t,se,qe]),mt=wt[0]??null,Ns=wt.length>0,Gt=!mt,vt=!Ns,jt=v.useMemo(()=>qe.length?qe.slice().sort((le,ge)=>{const Pe=Date.parse(le.updated_at||le.created_at||"0");return Date.parse(ge.updated_at||ge.created_at||"0")-Pe})[0]:Ut.length?Ut.slice().sort((le,ge)=>{const Pe=Date.parse(le.updated_at||le.created_at||"0");return Date.parse(ge.updated_at||ge.created_at||"0")-Pe})[0]:null,[qe,Ut]),Gn=jt&&(jt.updated_at||jt.created_at)||null,on=Gn?Rn(Gn):null,Sn=(jt==null?void 0:jt.run_number)??null,Zt=mt!=null&&mt.finishedAt?Rn(mt.finishedAt):null,$n=mt&&mt.scoring&&typeof mt.score=="number"&&Number.isFinite(mt.score)?`${mt.scoring}: ${Wb(mt.score)}`:null;v.useEffect(()=>{if(!wt.length){K&&re(null),(Y==null?void 0:Y.tone)==="success"&&V(null);return}K&&!wt.some(le=>le.id===K)&&(re(null),V(null))},[Y,wt,K]);const ln=v.useCallback((le,ge)=>{if(!le||Object.keys(le.params??{}).length===0){V({message:"Selected preset does not include any hyperparameters to apply.",tone:"warning"});return}R(()=>qi(le.params)),z(!0),D.current=!0,re(le.id),V({message:ge??`Applied tuned parameters from ${le.label}.`,tone:"success"})},[R,z,V,re]),Ht=v.useCallback(()=>{if(!mt){const ge=jt&&jt.model_type&&jt.model_type!==te?`Latest tuning run targeted ${jt.model_type}. Switch the model template to reuse its parameters.`:"No tuning job results available to apply.";V({message:ge,tone:"warning"});return}const le=mt.runNumber?`Applied tuned parameters from run ${mt.runNumber}.`:`Applied tuned parameters from ${mt.label}.`;ln(mt,le)},[ln,jt,te,mt,V]),It=v.useMemo(()=>{if(!Y)return"rgba(148, 163, 184, 0.75)";switch(Y.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[Y]),Fn=v.useMemo(()=>{const le=[];return t||le.push("Select a dataset before launching training jobs."),(!ut||!ut.nodes.length)&&le.push("Connect this node to an upstream pipeline before training."),se||le.push("Set a target column in the Train model readiness section."),te||le.push("Choose a model type before enqueuing training jobs."),Oe&&nt<2&&le.push("Cross-validation requires at least 2 folds."),S&&le.push(S),ze&&le.push(ze),le},[Oe,nt,ut,ze,te,S,t,se]),cn=((_r=kt.data)==null?void 0:_r.jobs)??[],vn=v.useMemo(()=>{if(!cn.length)return cn;const le=J==null?void 0:J.toLowerCase();return cn.filter(ge=>{if(!le)return!0;const Pe=(()=>{var Ct,$t,en,qt;const we=typeof ge.problem_type=="string"?ge.problem_type:null,tt=typeof((Ct=ge.metadata)==null?void 0:Ct.problem_type)=="string"?($t=ge.metadata)==null?void 0:$t.problem_type:null,it=typeof((en=ge.metadata)==null?void 0:en.resolved_problem_type)=="string"?(qt=ge.metadata)==null?void 0:qt.resolved_problem_type:null;return(we||it||tt||"").toLowerCase()})();if(Pe)return Pe===le;const Nt=String(ge.model_type||"").toLowerCase();return le==="regression"?Nt.includes("regress"):le==="classification"?Nt.includes("classif"):!0})},[cn,J]),et=v.useMemo(()=>!!(Lt instanceof Error&&Nl(Lt.message)||T&&Ui(T)||cn.some(le=>Ui(le))||Ut.some(le=>Ui(le))),[Lt,cn,T,Ut]),Qn=qb({graph:n,nodeId:e,modelType:te,problemType:J,modelTypeOptions:p,enabled:et});v.useEffect(()=>{Qn||X(!1)},[Qn]);const Cs=Math.max(cn.length-vn.length,0),In=kt.isLoading||kt.isFetching,Xn=kt.error,Ss=Fn.length>0||!E||!t||!ut||Cn,Bn=v.useCallback((le,ge)=>{R(Pe=>({...Pe,[le]:ge}))},[]),Qt=v.useCallback(le=>{var Nt;const ge=A[le.name]??le.default,Pe=`hyperparam-${e}-${le.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Pe,className:"canvas-modal__parameter-label",children:[le.label,le.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:le.description})]}),le.type==="number"&&a.jsx("input",{id:Pe,type:"number",className:"canvas-modal__parameter-input",value:ge??"",onChange:we=>{const tt=we.target.value;if(tt===""&&le.nullable)Bn(le.name,null);else{const it=parseFloat(tt);isNaN(it)||Bn(le.name,it)}},min:le.min,max:le.max,step:le.step,placeholder:le.nullable?"Empty = default":""}),le.type==="select"&&a.jsx("select",{id:Pe,className:"canvas-modal__parameter-select",value:ge??"",onChange:we=>Bn(le.name,we.target.value),children:(Nt=le.options)==null?void 0:Nt.map(we=>a.jsx("option",{value:we.value,children:we.label},we.value))}),le.type==="boolean"&&a.jsx("input",{id:Pe,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!ge,onChange:we=>Bn(le.name,we.target.checked)}),le.type==="text"&&a.jsx("input",{id:Pe,type:"text",className:"canvas-modal__parameter-input",value:ge??"",onChange:we=>Bn(le.name,we.target.value),placeholder:le.nullable?"Empty = default":""})]},le.name)},[A,Bn,e]),Tt=v.useCallback(async()=>{if(!E||!t||!te)return;if(I&&N){try{const it=N({closeModal:!1});it&&typeof it.then=="function"&&await it,Q(!1)}catch{}await new Promise(it=>setTimeout(it,100))}const le=Ot??ut;if(!le)return;const ge={};se&&(ge.target_column=se),ge.problem_type=J,ge.cross_validation={enabled:Oe,strategy:Ue,folds:nt,shuffle:He,random_state:de,refit_strategy:_e};const Pe=Object.keys(ge).length?ge:void 0,Nt=qi(le);Nt&&Array.isArray(Nt.nodes)&&(Nt.nodes=Nt.nodes.map(it=>{if(!it||it.id!==e)return it;const Ct=(it==null?void 0:it.data)??{},$t=(Ct==null?void 0:Ct.config)??{},en=c?{...$t,...c}:$t;return{...it,data:{...Ct,config:en,isConfigured:!0}}}));const we=te?[te]:[],tt={dataset_source_id:t,pipeline_id:E,node_id:e,model_type:te||void 0,model_types:we.length?we:void 0,hyperparameters:W&&gt?qi(gt):void 0,metadata:Pe,job_metadata:Pe,run_training:!0,graph:Nt??qi(le),target_node_id:e};try{await _t(tt)}catch{}},[Oe,nt,de,_e,He,Ue,c,_t,ut,Ot,I,te,e,N,E,J,gt,W,t,se]),lt=v.useCallback(()=>{Bt&&kt.refetch()},[Bt,kt]),Ks=le=>{var un,Es,Jn,En;const ge=f2(le.metrics??null),Pe=le.updated_at?Rn(le.updated_at):null,Nt=le.updated_at||le.created_at,we=Nt?Pe??new Date(Nt).toLocaleString():null,tt=d2[le.status]??le.status,it=(le.problem_type||((un=le.metadata)==null?void 0:un.resolved_problem_type)||((Es=le.metadata)==null?void 0:Es.problem_type)||"").toString(),Ct=((Jn=le.metadata)==null?void 0:Jn.cross_validation)??null,$t=((En=le.metrics)==null?void 0:En.cross_validation)??null,en=typeof le.error_message=="string"?le.error_message.trim():"",qt=[];if(qt.push(`Model ${le.model_type}`),it&&qt.push(it.charAt(0).toUpperCase()+it.slice(1)),Ct!=null&&Ct.enabled){const kn=String(Ct.strategy??"auto"),Zn=kn==="stratified_kfold"?"Stratified KFold":kn==="kfold"?"KFold":"Auto CV",qn=typeof Ct.folds=="number"?`${Ct.folds} folds`:"CV enabled";if(qt.push(`${Zn} (${qn})`),($t==null?void 0:$t.status)==="skipped"){const Tr=String(($t==null?void 0:$t.reason)??"unknown reason").replace(/_/g," ");qt.push(`CV skipped (${Tr})`)}}else if(($t==null?void 0:$t.status)==="skipped"){const kn=String(($t==null?void 0:$t.reason)??"unknown reason").replace(/_/g," ");qt.push(`CV skipped (${kn})`)}if(ge&&qt.push(`${ge.label}: ${Wb(ge.value)}`),le.status==="failed"&&en){const kn=en.replace(/\s+/g," ");qt.push(`Error: ${kn}`)}return we&&qt.push(`Updated ${we}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["v",le.version]}),"  ",tt,qt.length>0?`  ${qt.join("  ")}`:""]},le.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:lt,disabled:!Bt||In,children:In?"Refreshing":"Refresh jobs"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),E&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:E})]}),I&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]}),Fn.map((le,ge)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:le},`training-prereq-${ge}`)),Lt instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Lt.message}),Xn&&!(Lt instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Xn.message||"Unable to load training jobs."}),rn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:rn.message||"Unable to load tuning jobs."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:L>1?a.jsxs("span",{children:["Queued ",L," training jobs. Latest job ",T.id," (version ",T.version,")."]}):a.jsxs("span",{children:["Training job ",T.id," queued (version ",T.version,")."]})}),fe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[je&&u(je),f&&u(f),Oe&&a.jsxs(a.Fragment,{children:[g&&u(g),w&&u(w),b&&u(b),_&&u(_),x&&u(x)]}),te&&ce.length>0&&a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:W?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),(mt||jt)&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:mt?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:mt.modelType}),mt.runNumber?` (run ${mt.runNumber})`:"",Zt?`  ${Zt}`:"",mt.targetColumn?`  Target: ${mt.targetColumn}`:"",$n?`  ${$n}`:""]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",Sn||"N/A",on?`  ${on}`:"",jt!=null&&jt.model_type&&jt.model_type!==te?` targeted ${jt.model_type}.`:" did not produce reusable parameters for this configuration yet."]})}),Y&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:It},children:Y.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",onClick:Ht,disabled:Gt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:Gt?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:Gt?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:Gt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:Gt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:Gt?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply tuned params"}),a.jsx("button",{type:"button",onClick:()=>F(!0),disabled:vt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:vt?"rgba(148, 163, 184, 0.55)":"rgba(168, 85, 247, 0.95)",background:vt?"rgba(15, 23, 42, 0.35)":"rgba(76, 29, 149, 0.18)",border:vt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(168, 85, 247, 0.45)",borderRadius:"4px",cursor:vt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"150px"},children:"Browse tuned params"}),a.jsx("button",{type:"button",onClick:at,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:W?"#fff":"rgba(148, 163, 184, 0.85)",background:W?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(15, 23, 42, 0.6)",border:W?"none":"1px solid rgba(148, 163, 184, 0.45)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:W?"0 4px 12px rgba(118, 75, 162, 0.25)":"none"},onMouseEnter:le=>{W?le.currentTarget.style.boxShadow="0 6px 16px rgba(118, 75, 162, 0.35)":(le.currentTarget.style.borderColor="rgba(148, 163, 184, 0.65)",le.currentTarget.style.background="rgba(15, 23, 42, 0.8)")},onMouseLeave:le=>{W?le.currentTarget.style.boxShadow="0 4px 12px rgba(118, 75, 162, 0.25)":(le.currentTarget.style.borderColor="rgba(148, 163, 184, 0.45)",le.currentTarget.style.background="rgba(15, 23, 42, 0.6)")},children:W?" Advanced":"Default"})]})]})}),te&&Me.isLoading&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),te&&Me.error&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",Me.error.message]}),te&&W&&ce.length>0&&a.jsxs("div",{style:{gridColumn:"1 / -1",padding:"1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginTop:"0.5rem"},children:[a.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid rgba(102, 126, 234, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600",color:"#e2e8f0"},children:"Advanced Hyperparameters"}),a.jsxs("p",{style:{margin:"0",fontSize:"0.875rem",color:"rgba(148, 163, 184, 0.85)",lineHeight:"1.5"},children:["Configure ",te.replace(/_/g," ")," hyperparameters. Leave empty to use recommended defaults."]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:ce.map(Qt)})]}),!te&&h&&u(h)]}),Oe&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",nt," folds before refitting on"," ",_e==="train_plus_validation"?"training plus validation data.":"training data only."]}),Qn&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",Qn.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:Qn.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>X(le=>!le),style:{whiteSpace:"nowrap"},children:G?"Hide tips":"Show tips"})]}),G&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:Qn.details.map((le,ge)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:le},`scaling-tip-${ge}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Tt,disabled:Ss,children:Cn?"Queuing":"Launch training job"})}),In&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),Cs>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:Cs===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${Cs} training jobs use a different problem type. Switch the problem type to view them.`}),!In&&vn.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),vn.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:vn.map(Ks)}),a.jsx(t2,{presets:wt,isOpen:U,onClose:()=>F(!1),onApply:le=>{ln(le),F(!1)},activePresetId:K,fieldMetadata:ht})]})},g2=new Set(["true","1","yes","on"]),_2=new Set(["false","0","no","off"]),v2=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],Kb=new Set(["true","1","yes","y","on","t"]),Yb=new Set(["false","0","no","n","off","f"]),jo=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(g2.has(t))return!0;if(_2.has(t))return!1}return null},Sl=e=>{if(!(!e||typeof e!="object")){for(const t of v2)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},$h=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},Ph=e=>Array.isArray(e)?e.map(t=>Ph(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=Ph(e[n]),t),{}):e,Hi=e=>e===void 0?"":JSON.stringify(Ph(e)),Gb=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},y2=(e,t)=>{const n=[],s=f=>{n.includes(f)||n.push(f)},o=(e??"").toLowerCase();if(!t.length)return n;const i=t.filter(f=>f!=null);if(!i.length)return n;const c=i.reduce((f,g)=>{if(typeof g=="number"&&Number.isFinite(g))return f+1;if(typeof g=="string"){const w=g.trim();if(!w)return f;const b=Number(w);if(!Number.isNaN(b)&&Number.isFinite(b))return f+1}return f},0),u=i.reduce((f,g)=>{const w=String(g).trim().toLowerCase();return w&&(Kb.has(w)||Yb.has(w))?f+1:f},0),d=(()=>{const f=new Set;return i.forEach(g=>{f.add(String(g).trim().toLowerCase())}),f.size})(),p=c/i.length,h=u/i.length;if(o.includes("object")||o.includes("string"))return h>=.7&&s("boolean"),p>=.7&&s("float64"),d>0&&d<=20&&s("category"),n;if(o.includes("float")){const f=i.reduce((g,w)=>{if(typeof w=="number")return Number.isInteger(w)?g+1:g;if(typeof w=="string"){const b=w.trim();if(!b)return g;const _=Number(b);if(!Number.isNaN(_)&&Number.isFinite(_)&&Number.isInteger(_))return g+1}return g},0);return h>=.8&&s("boolean"),i.length>0&&f/i.length>=.9&&s("Int64"),n}return o.includes("int")&&h>=.7&&s("boolean"),n},$u=[{value:"train",label:"Train",accent:"train"},{value:"test",label:"Test",accent:"test"},{value:"validation",label:"Validation",accent:"validation"}],Pu={train:0,test:1,validation:2},b2=["train","test","validation"],Lh=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],Vi=e=>{const t=new Set($u.map(o=>o.value)),n=[];e.forEach(o=>{if(o){if(o==="training"&&(o="train"),o==="valid"||o==="val"){n.push("validation");return}t.has(o)&&n.push(o)}});const s=new Set;return n.filter(o=>s.has(o)?!1:(s.add(o),!0)).sort((o,i)=>Pu[o]-Pu[i])},x2=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},zh=(e,t)=>{const n=jo(e);return n===null?t:n},Qb=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},Xb=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},Jb=e=>{const t=$u.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},w2=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},j2=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${w2(e.status)}`);const n=Rn(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},Lu=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,Zb=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,s])=>{typeof s=="number"&&Number.isFinite(s)&&t.push({key:n,value:s})}),t.sort((n,s)=>n.key.localeCompare(s.key)),t},ex=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},N2=({nodeId:e,sourceId:t,graph:n,config:s,setConfigState:o,renderParameterField:i,formatMetricValue:c,connectedSplitHandles:u})=>{var He;const d=ho(),p=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),h=v.useMemo(()=>{if(!p)return[];const de=new Map;p.nodes.forEach(je=>{je!=null&&je.id&&de.set(je.id,je)});const _e=new Set;return p.edges.forEach(je=>{var De;if(!je||je.target!==e)return;const Me=de.get(je.source);((De=Me==null?void 0:Me.data)==null?void 0:De.catalogType)==="train_model_draft"&&_e.add(Me.id)}),_e.size>0?Array.from(_e):p.nodes.filter(je=>{var Me;return((Me=je==null?void 0:je.data)==null?void 0:Me.catalogType)==="train_model_draft"}).map(je=>je.id)},[p,e]),f=v.useMemo(()=>h.length?h.slice().sort().join("|"):"all",[h]),[g,w]=v.useState(null),[b,_]=v.useState(null);v.useEffect(()=>{let de=!1;return _(null),!t||!p?(w(null),()=>{de=!0}):(xo(t,p).then(_e=>{de||w(_e)}).catch(_e=>{de||(_((_e==null?void 0:_e.message)??"Unable to compute pipeline signature."),w(null))}),()=>{de=!0})},[p,t]);const x=v.useMemo(()=>{const de=s==null?void 0:s.training_job_id;return typeof de=="string"?de.trim():typeof de=="number"?String(de):""},[s==null?void 0:s.training_job_id]),N=v.useMemo(()=>Vi(Lh(s==null?void 0:s.splits)),[s==null?void 0:s.splits]),C=v.useMemo(()=>N.length?N:b2,[N]);v.useEffect(()=>{u&&o(de=>{const _e=de??{},je=Vi(Lh(_e.splits)),Me=je.filter(ce=>u[ce]!==!1);if(Me.length===je.length&&Me.every((ce,Te)=>ce===je[Te]))return de;const De={..._e};return Me.length?De.splits=Me:delete De.splits,De})},[u,o]);const E=v.useMemo(()=>u?C.filter(de=>u[de]!==!1):C,[u,C]),j=v.useMemo(()=>u?$u.filter(de=>u[de.value]===!1).map(de=>de.label):[],[u]),S=v.useMemo(()=>{if(!j.length)return"";if(j.length===1)return j[0];if(j.length===2)return`${j[0]} and ${j[1]}`;const de=j[j.length-1];return`${j.slice(0,-1).join(", ")}, and ${de}`},[j]),M=E.length>0,T=zh(s==null?void 0:s.include_confusion,!0),P=zh(s==null?void 0:s.include_curves,!0),L=zh(s==null?void 0:s.include_residuals,!0),$=Qb(s==null?void 0:s.max_curve_points,500),A=Qb(s==null?void 0:s.max_scatter_points,750),R=typeof(s==null?void 0:s.last_evaluated_at)=="string"?s.last_evaluated_at:null,[W,z]=v.useState(null),[D,H]=v.useState("details"),q=v.useRef(!1);v.useEffect(()=>{z(null),q.current=!1},[x]),v.useEffect(()=>{H("details")},[W==null?void 0:W.job_id]);const I=v.useMemo(()=>["feature-canvas","model-evaluation",t??"none",g??"pending",f],[g,t,f]),Q=Is({queryKey:I,queryFn:async()=>{const de={datasetSourceId:t||void 0,limit:50},_e=new Map,je=[];let Me=null;const De=ht=>{Array.isArray(ht)&&ht.forEach(rt=>{rt&&!_e.has(rt.id)&&_e.set(rt.id,rt)})},ce=async ht=>{try{const rt=await Oi(ht);return De(rt==null?void 0:rt.jobs),rt}catch(rt){return rt instanceof Error&&je.push(rt),null}};if(g&&await ce({...de,pipelineId:g}),h.length&&await Promise.all(h.map(ht=>ce({...de,nodeId:ht}))),Me=await ce(de),!_e.size){if(Me)return Me;if(je.length)throw je[0];return{jobs:[],total:0}}const Te=Array.from(_e.values());Te.sort((ht,rt)=>Xb(rt.updated_at??rt.created_at)-Xb(ht.updated_at??ht.created_at));const Qe=(Me==null?void 0:Me.total)??Te.length;return{jobs:Te,total:Qe}},enabled:!!t,staleTime:30*1e3,retry:(de,_e)=>_e.message.includes("Sign in")?!1:de<2,refetchInterval:de=>{const _e=de.state.data;return((_e==null?void 0:_e.jobs)??[]).some(De=>De.status==="queued"||De.status==="running")?5e3:!1}}),U=((He=Q.data)==null?void 0:He.jobs)??[],F=v.useMemo(()=>{const de=new Map;return U.forEach(_e=>{de.set(_e.id,_e)}),de},[U]),K=v.useMemo(()=>U.filter(de=>de.status==="succeeded"),[U]),re=v.useMemo(()=>K.map(de=>({value:de.id,label:j2(de)})),[K]),Y=x?F.get(x)??null:null,V=Is({queryKey:["feature-canvas","training-job",x||"none"],queryFn:()=>fy(x),enabled:!!x,staleTime:30*1e3});v.useEffect(()=>{var ht,rt;const de=V.data;if(!de)return;const _e=(ht=de.metrics)==null?void 0:ht.evaluation;if(!_e||typeof _e!="object")return;const je=_e.splits;if(!je||typeof je!="object")return;const Me={};Object.entries(je).forEach(([gt,at])=>{at&&typeof at=="object"&&(Me[gt]=at)});const De=typeof _e.generated_at=="string"?_e.generated_at:R??de.updated_at??de.created_at??new Date().toISOString(),ce=_e.problem_type==="regression"?"regression":"classification",Te={job_id:de.id,pipeline_id:de.pipeline_id,node_id:de.node_id,generated_at:De,problem_type:ce,target_column:_e.target_column??((rt=de.metadata)==null?void 0:rt.target_column)??null,splits:Me};z(Te),De&&De!==R&&o(gt=>({...gt??{},last_evaluated_at:De}));const Qe=Vi(Object.keys(Me));Qe.length&&!q.current&&!x2(N,Qe)&&o(gt=>({...gt??{},splits:Qe}))},[V.data,R,o,N]);const G=Uc({mutationFn:async de=>{if(!x)throw new Error("Select a training job before running evaluation.");return py(x,de)},onSuccess:de=>{z(de),o(_e=>({..._e??{},training_job_id:x,splits:de.splits?Object.keys(de.splits):E,include_confusion:T,include_curves:P,include_residuals:L,max_curve_points:$,max_scatter_points:A,last_evaluated_at:de.generated_at})),d.invalidateQueries({queryKey:["feature-canvas","training-job",x]})}}),X=v.useCallback(de=>{const _e=de.target.value;G.reset(),o(je=>{const Me={...je??{}};return _e?Me.training_job_id=_e:delete Me.training_job_id,Me})},[G,o]),se=v.useCallback(de=>{u&&u[de]===!1||(G.reset(),q.current=!0,o(_e=>{const je=Vi(Lh(_e==null?void 0:_e.splits)),Me=je.includes(de);let De;if(Me){if(je.length<=1)return _e??{};De=je.filter(ce=>ce!==de)}else De=Vi([...je,de]);return{..._e??{},splits:De}}))},[u,G,o]),J=v.useCallback((de,_e)=>{G.reset(),o(je=>({...je??{},[de]:_e}))},[G,o]),te=v.useCallback(()=>{if(!x)return;const de={splits:E,include_confusion:T,include_curves:P,include_residuals:L,max_curve_points:P?$:void 0,max_scatter_points:L?A:void 0};G.mutate(de)},[G,T,P,L,$,A,x,E]),Se=W?Rn(W.generated_at):R?Rn(R):null,ze=v.useMemo(()=>W?Object.entries(W.splits).sort((de,_e)=>{const[je]=de,[Me]=_e,De=Pu[je]??99,ce=Pu[Me]??99;return De-ce}):[],[W]),Oe=v.useMemo(()=>{if(!W||!ze.length)return null;const de=ze.map(([je,Me])=>{const De=Zb(Me.metrics).reduce((ce,Te)=>(ce[Te.key]=Te.value,ce),{});return{key:je,label:Jb(je),rowCount:typeof Me.row_count=="number"?Me.row_count:null,metrics:De}}),_e=Array.from(new Set(de.flatMap(je=>Object.keys(je.metrics)))).sort((je,Me)=>je.localeCompare(Me));return{splits:de,metricKeys:_e}},[ze,W]),Ue=v.useMemo(()=>Oe?Oe.splits.length<=1?"Connect at least two splits to compare results.":Oe.metricKeys.length?null:"No numeric metrics available for comparison yet.":"Run an evaluation to compare metrics.",[Oe]);v.useEffect(()=>{D==="comparison"&&Ue&&H("details")},[D,Ue]);const nt=v.useCallback(de=>{de==="comparison"&&Ue||H(de)},[Ue]);return a.jsxs("div",{className:"node-settings__section node-settings__evaluation",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:Se&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",Se]})})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:x,onChange:X,disabled:Q.isLoading||Q.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),re.map(de=>a.jsx("option",{value:de.value,children:de.label},de.value))]}),Q.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),Q.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:Q.error.message}),!Q.isLoading&&!re.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),b&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:b})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:$u.map(de=>{const _e=u?u[de.value]!==!1:!0,je=_e&&E.includes(de.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${de.accent} ${je?"evaluation-chip--active":""}`,"aria-disabled":!_e,title:_e?void 0:`${de.label} split is not connected`,style:_e?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:je,disabled:!_e,onChange:()=>se(de.value)}),a.jsx("span",{children:de.label})]},de.value)})}),j.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",S," split",j.length>1?"s":""," to enable diagnostics."]}),!M&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a train, validation, or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:T,onChange:de=>J("include_confusion",de.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:de=>J("include_curves",de.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:L,onChange:de=>J("include_residuals",de.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:te,disabled:!x||G.isPending||!M,children:G.isPending?"Running":"Run evaluation"}),Y&&Y.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!M&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),G.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:G.error.message}),G.isSuccess&&W&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",Rn(W.generated_at),"."]}),V.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:V.error.message})]}),W?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:W.problem_type==="regression"?"Regression":"Classification"})]}),W.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:W.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:Rn(W.generated_at)??W.generated_at})]})]}),a.jsxs("div",{className:"evaluation-tabs",role:"tablist","aria-label":"Evaluation views",children:[a.jsx("button",{type:"button",className:`evaluation-tab ${D==="details"?"evaluation-tab--active":""}`,role:"tab","aria-selected":D==="details",onClick:()=>nt("details"),children:"Split details"}),a.jsx("button",{type:"button",className:`evaluation-tab ${D==="comparison"?"evaluation-tab--active":""}`,role:"tab","aria-selected":D==="comparison","aria-disabled":!!Ue,disabled:!!Ue,title:Ue??void 0,onClick:()=>nt("comparison"),children:"Split comparison"})]}),D==="comparison"&&Oe?a.jsx(C2,{comparison:Oe,formatMetricValue:c}):ze.map(([de,_e])=>a.jsx(S2,{splitKey:de,payload:_e,problemType:W.problem_type,formatMetricValue:c},de))]}):a.jsx("div",{className:"evaluation-placeholder",children:x?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},C2=({comparison:e,formatMetricValue:t})=>e.metricKeys.length?a.jsx("section",{className:"evaluation-comparison",children:a.jsx("div",{className:"evaluation-comparison__table-wrapper",children:a.jsxs("table",{className:"evaluation-comparison__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Metric"}),e.splits.map(n=>a.jsx("th",{children:n.label},n.key))]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"evaluation-comparison__row evaluation-comparison__row--muted",children:[a.jsx("td",{children:"Rows evaluated"}),e.splits.map(n=>a.jsx("td",{children:typeof n.rowCount=="number"?n.rowCount.toLocaleString():""},`${n.key}-rows`))]}),e.metricKeys.map(n=>a.jsxs("tr",{className:"evaluation-comparison__row",children:[a.jsx("td",{children:n}),e.splits.map(s=>a.jsx("td",{children:typeof s.metrics[n]=="number"?t(s.metrics[n]):""},`${s.key}-${n}`))]},n))]})]})})}):a.jsx("div",{className:"evaluation-placeholder",children:a.jsx("p",{children:"No numeric metrics were reported across splits for comparison."})}),S2=({splitKey:e,payload:t,problemType:n,formatMetricValue:s})=>{const o=Zb(t.metrics),i=o.length>0,c=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[Jb(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),i?a.jsx("div",{className:"evaluation-metrics__grid",children:o.map(u=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:u.key}),a.jsx("span",{className:"evaluation-metrics__value",children:s(u.value)})]},u.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(E2,{matrix:t.confusion_matrix,formatMetricValue:s}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(u=>a.jsx(k2,{curve:u,formatMetricValue:s},`roc-${u.label}`)),t.pr_curves.map(u=>a.jsx(M2,{curve:u,formatMetricValue:s},`pr-${u.label}`))]}),n==="regression"&&t.residuals&&a.jsx(O2,{residuals:t.residuals,formatMetricValue:s})]}),c.length>0&&a.jsx("ul",{className:"evaluation-notes",children:c.map((u,d)=>a.jsx("li",{children:u},`${e}-note-${d}`))})]})},E2=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],s=Array.isArray(e.totals)?e.totals:[],o=Array.isArray(e.normalized)?e.normalized:[],i=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),i!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",ex(i,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((c,u)=>a.jsx("th",{children:c},`pred-${u}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((c,u)=>{const d=o[u]??[],p=s[u]??c.reduce((h,f)=>h+f,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[u]??`Class ${u}`}),c.map((h,f)=>{const g=typeof d[f]=="number"?d[f]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:h}),g!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:ex(g,t)})]},`cell-${u}-${f}`)}),a.jsx("td",{children:p})]},`row-${u}`)})})]})]})},k2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,s=240,o=28,i=n-o*2,c=s-o*2,u=e.fpr.map((d,p)=>{const h=o+Lu(d)*i,f=s-o-Lu(e.tpr[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:o,y:o,width:i,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:o,y1:s-o,x2:n-o,y2:o,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:o,y1:o,x2:o,y2:s-o,className:"evaluation-chart__axis"}),a.jsx("line",{x1:o,y1:s-o,x2:n-o,y2:s-o,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},M2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,s=240,o=28,i=n-o*2,c=s-o*2,u=e.recall.map((d,p)=>{const h=o+Lu(d)*i,f=s-o-Lu(e.precision[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:o,y:o,width:i,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:o,y1:o,x2:o,y2:s-o,className:"evaluation-chart__axis"}),a.jsx("line",{x1:o,y1:s-o,x2:n-o,y2:s-o,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},A2={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},O2=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(s=>typeof s[1]=="number"&&Number.isFinite(s[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([s,o])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:A2[s]??s}),a.jsx("span",{className:"evaluation-summary__value",children:t(o)})]},s))}),a.jsx(T2,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx($2,{points:e.scatter})]})},T2=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const s=t.reduce((o,i)=>Math.max(o,i),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((o,i)=>{const c=o/s*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${o} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${c}%`}})},`bin-${i}`)})})},$2=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,s=36,o=e.map(g=>g.actual),i=e.map(g=>g.predicted),c=Math.min(...o,...i),u=Math.max(...o,...i),d=u-c||1,p=g=>(g-c)/d,h=g=>s+p(g)*(t-s*2),f=g=>n-s-p(g)*(n-s*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:s,y:s,width:t-s*2,height:n-s*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:s,y1:n-s,x2:t-s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:s,y1:s,x2:s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:h(c),y1:f(c),x2:h(u),y2:f(u),className:"evaluation-curve__baseline"}),e.map((g,w)=>a.jsx("circle",{cx:h(g.actual),cy:f(g.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${w}`))]})})},P2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},L2={queued:"info",running:"info",succeeded:"success",failed:"danger",cancelled:"neutral"},El={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score"],regression:["rmse","mae","r2","mape"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},tx=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted"],nx=["rmse","mae","r2","mape"],sx=new Set(["rmse","mae","mape","mse"]),rx={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},Vs=e=>!!e&&typeof e=="object"&&!Array.isArray(e),z2=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},Rh=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",R2=e=>{if(!e)return El.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return El.regression;if(t.includes("class")||t.includes("classification"))return El.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?El.regression:n==="classification"?El.classification:El.fallback},D2=e=>{var o,i,c;if(!Vs(e))return null;const t=[],n=(i=(o=e==null?void 0:e.cross_validation)==null?void 0:o.metrics)==null?void 0:i.mean;Vs(n)&&((c=e==null?void 0:e.cross_validation)==null?void 0:c.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),Vs(e.test)&&t.push({values:e.test,labelPrefix:""}),Vs(e.validation)&&t.push({values:e.validation,labelPrefix:""}),Vs(e.train)&&t.push({values:e.train,labelPrefix:""});const s=R2(e);for(const u of t)for(const d of s){const p=u.values[d];if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p}}for(const u of t)for(const[d,p]of Object.entries(u.values))if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p};return null},F2=e=>{var n,s;if(!Vs(e))return{label:null,values:{}};if(Vs(e.test))return{label:"Test",values:e.test};if(Vs(e.validation))return{label:"Validation",values:e.validation};const t=(s=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:s.mean;return Vs(t)?{label:"CV mean",values:t}:Vs(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},ax=e=>{if(!e)return"Unknown model";const t=e.trim();return rx[t]?rx[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},I2=e=>{var i,c;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const u of n)if(typeof u=="string"){const d=u.trim().toLowerCase();if(d==="classification"||d==="regression")return d}const s=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(s.includes("classifier")||s.includes("classification"))return"classification";if(s.includes("regress")||s.includes("regression"))return"regression";const o=e.metrics;if(Vs(o)){const u=new Set,d=g=>{Vs(g)&&Object.keys(g).forEach(w=>u.add(w.toLowerCase()))};d(o.test),d(o.validation),d(o.train);const p=(c=(i=o==null?void 0:o.cross_validation)==null?void 0:i.metrics)==null?void 0:c.mean;Vs(p)&&d(p);const h=tx.some(g=>u.has(g)),f=nx.some(g=>u.has(g));if(h&&!f)return"classification";if(f&&!h)return"regression"}return"unknown"},B2=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:I2(t),modelLabel:ax(t.model_type),primaryMetric:D2(n),metricBucket:F2(n)}}),ox=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return sx.has(t)||sx.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},U2=({nodeId:e,sourceId:t,graph:n,parameters:s,config:o,renderParameterField:i})=>{var Y;const c=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),u=v.useMemo(()=>{if(!c)return[];const V=new Map;c.nodes.forEach(se=>{se&&se.id&&V.set(se.id,se)});const G=new Set;return c.edges.forEach(se=>{var te;if(!se||se.target!==e)return;const J=V.get(se.source);((te=J==null?void 0:J.data)==null?void 0:te.catalogType)==="train_model_draft"&&G.add(J.id)}),G.size>0?Array.from(G):c.nodes.filter(se=>{var J;return((J=se==null?void 0:se.data)==null?void 0:J.catalogType)==="train_model_draft"}).map(se=>se.id)},[c,e]),d=v.useMemo(()=>u.length?u.slice().sort().join("|"):"all",[u]),[p,h]=v.useState(null),[f,g]=v.useState(null);v.useEffect(()=>{let V=!1;return g(null),!t||!c?(h(null),()=>{V=!0}):(xo(t,c).then(G=>{V||h(G)}).catch(G=>{V||(g((G==null?void 0:G.message)??"Unable to compute pipeline ID"),h(null))}),()=>{V=!0})},[c,t]);const w=z2(o==null?void 0:o.show_non_success,!0),b=v.useMemo(()=>["feature-canvas","model-registry",t??"none",p??"pending",d,w?"all-statuses":"succeeded"],[p,w,t,d]),_=Is({queryKey:b,queryFn:async()=>{const V={datasetSourceId:t||void 0,limit:50},G=new Map,X=[];let se=null;const J=Oe=>{!Array.isArray(Oe)||!Oe.length||Oe.forEach(Ue=>{Ue&&!G.has(Ue.id)&&G.set(Ue.id,Ue)})},te=async Oe=>{try{const Ue=await Oi(Oe);return J(Ue==null?void 0:Ue.jobs),Ue}catch(Ue){return Ue instanceof Error&&X.push(Ue),null}};if(p&&await te({...V,pipelineId:p}),u.length===1){const[Oe]=u;await te({...V,nodeId:Oe})}if(se=await te(V),!G.size){if(se)return se;if(X.length)throw X[0];return{jobs:[],total:0}}const Se=Array.from(G.values()),ze=(se==null?void 0:se.total)??Se.length;return{jobs:Se,total:ze}},enabled:!!t,staleTime:30*1e3,retry:(V,G)=>G.message.includes("Sign in")?!1:V<2,refetchInterval:V=>{const G=V.state.data;return((G==null?void 0:G.jobs)??[]).some(J=>J.status==="queued"||J.status==="running")?5e3:!1}}),x=((Y=_.data)==null?void 0:Y.jobs)??[],N=v.useMemo(()=>{if(!x.length)return[];if(!u.length)return x;const V=x.filter(G=>u.includes(G.node_id));return V.length?V:x},[x,u]),C=v.useMemo(()=>B2(N),[N]),E=v.useMemo(()=>w?C:C.filter(V=>V.job.status==="succeeded"),[C,w]),j=v.useMemo(()=>E.filter(V=>V.problemType==="classification"),[E]),S=v.useMemo(()=>E.filter(V=>V.problemType==="regression"),[E]),M=v.useMemo(()=>!j.length&&!S.length?"classification":j.length?S.length?j.length>=S.length?"classification":"regression":"classification":"regression",[j.length,S.length]),T=typeof(o==null?void 0:o.default_problem_type)=="string"?o.default_problem_type.trim().toLowerCase():"auto",P=T==="classification"||T==="regression"?T:M,[L,$]=v.useState(P);v.useEffect(()=>{$(P)},[P]);const A=L==="classification"?j:S,R=v.useMemo(()=>{const V=new Map;return A.forEach(G=>{const X=G.job.model_type,se=V.get(X)??{label:G.modelLabel,count:0};se.count+=1,V.set(X,se)}),Array.from(V.entries()).map(([G,X])=>({value:G,label:X.label,count:X.count})).sort((G,X)=>G.label.localeCompare(X.label))},[A]),W=typeof(o==null?void 0:o.default_method)=="string"?o.default_method.trim().toLowerCase():"",[z,D]=v.useState("all");v.useEffect(()=>{if(!R.length){D("all");return}const V=R.find(G=>G.value.toLowerCase()===W);D(V?V.value:"all")},[W,R,L]);const H=v.useMemo(()=>z==="all"?A:A.filter(V=>V.job.model_type===z),[z,A]),q=v.useMemo(()=>H.slice().sort((V,G)=>{if(G.job.version!==V.job.version)return G.job.version-V.job.version;const X=Date.parse(V.job.updated_at??V.job.created_at??"");return Date.parse(G.job.updated_at??G.job.created_at??"")-X}),[H]),I=v.useMemo(()=>{if(!A.length)return[];const V=new Map;A.forEach(X=>{const se=X.job.model_type,J=V.get(se)??[];J.push(X),V.set(se,J)});const G=[];return V.forEach((X,se)=>{const J=X.reduce((te,Se)=>{const ze=ox(Se.primaryMetric);if(ze===null)return te;if(!te)return Se;const Oe=ox(te.primaryMetric);return Oe===null||ze>Oe?Se:te},null);G.push({modelType:se,label:ax(se),bestJob:J})}),G.sort((X,se)=>X.label.localeCompare(se.label))},[A]),Q=v.useMemo(()=>s.filter(V=>["default_problem_type","show_non_success"].includes(V.name)),[s]),U=L==="classification"?tx:nx,F=_.isLoading||_.isFetching,K=_.error??null,re=q.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),p&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",p]})]}),f&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:f}),!u.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),Q.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:Q.map(V=>a.jsx(ve.Fragment,{children:i(V)},V.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(V=>a.jsxs("button",{type:"button",role:"tab","data-active":L===V,className:"model-registry__tab",onClick:()=>$(V),disabled:V==="classification"&&!j.length||V==="regression"&&!S.length,children:[V==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:V==="classification"?j.length:S.length})]},V))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z==="all",onClick:()=>D("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:A.length})]}),R.map(V=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z===V.value,onClick:()=>D(V.value),children:[V.label,a.jsx("span",{className:"model-registry__method-count",children:V.count})]},V.value))]})]}),I.length>0&&a.jsx("div",{className:"model-registry__summary",children:I.map(V=>{const G=V.bestJob,X=G!=null&&G.primaryMetric?G.primaryMetric.label:null,se=G!=null&&G.primaryMetric?Rh(G.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:V.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[X||"No metrics",X&&a.jsx("strong",{children:se})]}),(G==null?void 0:G.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",G.job.version]})]},V.modelType)})}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:K.message}),!F&&!K&&!re&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),re&&a.jsx("div",{className:"model-registry__table-wrapper",children:a.jsxs("table",{className:"model-registry__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Version"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Model"}),a.jsx("th",{scope:"col",children:"Primary metric"}),U.map(V=>a.jsx("th",{scope:"col",children:V.replace(/_/g," ")},V)),a.jsx("th",{scope:"col",children:"Evaluated"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:q.map(V=>{const{job:G,primaryMetric:X,metricBucket:se}=V,J=se.values||{},te=se.label??"",Se=G.updated_at??G.created_at??null;return a.jsxs("tr",{children:[a.jsxs("td",{children:["v",G.version]}),a.jsx("td",{children:a.jsx("span",{className:`model-registry__status model-registry__status--${L2[G.status]}`,children:P2[G.status]})}),a.jsx("td",{children:V.modelLabel}),a.jsx("td",{children:X?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",children:X.label}),a.jsx("span",{className:"model-registry__metric-value",children:Rh(X.value)})]}):""}),U.map(ze=>{const Oe=J[ze];return a.jsx("td",{children:typeof Oe=="number"&&Number.isFinite(Oe)?Rh(Oe):""},`${G.id}-${ze}`)}),a.jsx("td",{children:te}),a.jsx("td",{children:Se?Rn(Se)??Se:""})]},G.id)})})]})})]})},q2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},No="__tuning_strategies",Co="__active_tuning_strategy_id",So="__expanded_tuning_strategy_ids",Dh=["random","grid","halving","optuna"],zu=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const s=n.toLowerCase();if(t&&t.length>0){const i=t.find(c=>c.toLowerCase()===s);if(i)return i}const o=Dh.find(i=>i.toLowerCase()===s);return o||n},fr=e=>!!e&&typeof e=="object"&&!Array.isArray(e),as=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},Ca=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return fr(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return fr(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},Fh=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,s])=>{if(n){if(Array.isArray(s)){const o=s.filter(i=>i!=null);o.length>0&&(t[n]=o.map(i=>as(i)));return}s==null||s===""||(t[n]=[as(s)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},H2=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",V2=new Set(["train","test","validation"]),lx=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const s=n.trim().toLowerCase();V2.has(s)&&t.add(s)}}),Array.from(t)},Ih=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,o])=>{t.has(s)&&(n[s]=o)}),n},Bh=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,o])=>{if(t.has(s)){if(Array.isArray(o)){const i=o.map(c=>as(c)).filter(c=>c!=null&&c!=="");i.length>0&&(n[s]=i);return}o!=null&&o!==""&&(n[s]=[as(o)])}}),n},W2=(e,t)=>{const n=t.split(/[\n,]+/).map(d=>d.trim()).filter(d=>d.length>0);if(n.length===0)return{values:[],error:null};const s=[],o=[],i=Array.isArray(e.options)?new Set(e.options.map(d=>d.value)):null;n.forEach(d=>{if(e.type==="number"){const p=Number(d);Number.isFinite(p)?s.push(p):o.push(d);return}if(e.type==="boolean"){const p=d.toLowerCase();if(["true","1","yes","y"].includes(p)){s.push(!0);return}if(["false","0","no","n"].includes(p)){s.push(!1);return}o.push(d);return}if(e.type==="select"){if(i&&!i.has(d)){o.push(d);return}s.push(d);return}s.push(d)});const c=[],u=new Set;if(s.forEach(d=>{const p=typeof d=="object"?JSON.stringify(d):String(d);u.has(p)||(u.add(p),c.push(d))}),o.length>0){const d=o.slice(0,3).join(", "),p=o.length>3?"":"";return{values:c,error:`Invalid value${o.length>1?"s":""}: ${d}${p}`}}return{values:c,error:null}},ix=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),Ru=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},Du=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},Wi=(e,t,n)=>{let s=e;return typeof t=="number"&&Number.isFinite(t)&&(s=Math.max(s,t)),typeof n=="number"&&Number.isFinite(n)&&(s=Math.min(s,n)),s},K2=(e,t)=>{const n={},s=e.find(d=>(d==null?void 0:d.name)==="solver"),o=e.find(d=>(d==null?void 0:d.name)==="penalty"),i=!!(s&&o&&Array.isArray(s.options)&&s.options.some(d=>(d==null?void 0:d.value)==="liblinear")&&Array.isArray(o.options)&&o.options.some(d=>(d==null?void 0:d.value)==="elasticnet")),c=new Set(["lbfgs","saga"]),u=new Set(["l2","none"]);return e.forEach(d=>{if(!(d!=null&&d.name))return;const p=new Map,h=w=>{if(w==null||typeof w=="number"&&!Number.isFinite(w))return;const b=typeof w=="object"?JSON.stringify(w):`${typeof w}:${String(w)}`;p.has(b)||p.set(b,as(w))},f=t==null?void 0:t[d.name];if(i&&d.name==="solver")(Array.isArray(d.options)?d.options:[]).forEach(b=>{b!=null&&b.value&&c.has(String(b.value))&&h(b.value)}),!p.size&&typeof f=="string"&&c.has(f)&&h(f),p.size||c.forEach(b=>h(b));else if(i&&d.name==="penalty")(Array.isArray(d.options)?d.options:[]).forEach(b=>{b!=null&&b.value&&u.has(String(b.value))&&h(b.value)}),!p.size&&typeof f=="string"&&u.has(f)&&h(f),p.size||u.forEach(b=>h(b));else if(d.type==="number"){const w=Du(f),b=Du(d.min),_=Du(d.max);if(b!==null&&h(b),w!==null&&h(Wi(w,b,_)),_!==null&&h(_),p.size<=1&&w!==null){const x=Du(d.step);x!==null&&x>0?(h(Wi(w+x,b,_)),h(Wi(w-x,b,_))):(h(Wi(w*1.5,b,_)),h(Wi(w*.5,b,_)))}}else d.type==="boolean"?(h(!0),h(!1),typeof f=="boolean"&&h(f)):(d.type==="select"&&(d.options??[]).slice(0,6).forEach(w=>{(w==null?void 0:w.value)!==void 0&&h(w.value)}),typeof f=="string"&&f.trim().length&&h(f.trim()));const g=Array.from(p.values());g.length>0&&(n[d.name]=g)}),n},Y2={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},Uh=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,Ki=e=>{if(!fr(e))return{};const t=as(e);return fr(t)?(delete t[No],delete t[Co],delete t[So],t):{}},kl=e=>Ki(e),G2=(e,t,n)=>({id:Uh(),label:e,config:kl(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),Sa=e=>`Strategy ${e}`,cx=e=>fr(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},ux=e=>fr(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const s=e[n];return t[n]=s===null?null:String(s),t},{}):{},Q2=e=>{if(!fr(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,No)&&(t[No]=as(e[No])),Object.prototype.hasOwnProperty.call(e,Co)&&(t[Co]=e[Co]),Object.prototype.hasOwnProperty.call(e,So)&&(t[So]=as(e[So])),t},X2=()=>({strategies:[],activeId:null,expandedIds:[]}),qh=e=>{var d;const t=X2();if(!fr(e))return t;const n=e[No];if(Array.isArray(n)){const p=new Set;n.forEach(h=>{if(!fr(h))return;let f=typeof h.id=="string"?h.id.trim():"";(!f||p.has(f))&&(f=Uh()),p.add(f);const g=typeof h.label=="string"?h.label.trim():"",w=g.length?g:Sa(t.strategies.length+1),b=fr(h.config)?h.config:{},_={id:f,label:w,config:Ki(b),searchSpaceTexts:cx(h.searchSpaceTexts),searchSpaceFieldErrors:ux(h.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!h.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!h.searchSpaceManuallyCleared};t.strategies.push(_)})}const s=new Set(t.strategies.map(p=>p.id)),o=e[Co],i=typeof o=="string"?o.trim():"";t.activeId=i&&s.has(i)?i:((d=t.strategies[0])==null?void 0:d.id)??null;const c=e[So],u=Array.isArray(c)?c.map(p=>typeof p=="string"?p.trim():"").filter(p=>!!p&&s.has(p)):[];return t.activeId&&!u.includes(t.activeId)&&u.push(t.activeId),t.expandedIds=Array.from(new Set(u)).sort(),t},dx=e=>({id:e.id,label:e.label,config:kl(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),J2=(e,t,n)=>{var u;const s=e.map((d,p)=>({id:typeof d.id=="string"&&d.id.trim().length?d.id:Uh(),label:typeof d.label=="string"&&d.label.trim().length?d.label:Sa(p+1),config:Ki(d.config),searchSpaceTexts:cx(d.searchSpaceTexts),searchSpaceFieldErrors:ux(d.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!d.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!d.searchSpaceManuallyCleared})),o=new Set(s.map(d=>d.id)),i=typeof t=="string"&&o.has(t)?t:((u=s[0])==null?void 0:u.id)??null,c=Array.from(n??new Set).filter(d=>o.has(d));return i&&!c.includes(i)&&c.push(i),{strategies:s,activeId:i,expandedIds:Array.from(new Set(c)).sort()}},mx=(e,t)=>{var n;return t&&e.some(s=>s.id===t)?t:((n=e[0])==null?void 0:n.id)??""},hx=(e,t)=>{const n=new Set(e.map(o=>o.id)),s=t.filter(o=>n.has(o));return!s.length&&e[0]&&s.push(e[0].id),new Set(s)},Fu=e=>Hi(e),fx=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const o of n)if(e[o]!==t[o])return!1;return!0},Z2=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:o,cvConfig:i,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,searchStrategyParameter:h,searchIterationsParameter:f,searchRandomStateParameter:g,scoringMetricParameter:w,setDraftConfigState:b,onSaveDraftConfig:_})=>{var vr,sr,ks,es;const x=ho(),[N,C]=v.useState(null),[E,j]=v.useState(null),[S,M]=v.useState(null),[T,P]=v.useState(0),[L,$]=v.useState(null),[A,R]=v.useState(!1),[W,z]=v.useState(null),[D,H]=v.useState(!1),q=((s==null?void 0:s.targetColumn)??"").trim(),I=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",Q=(d==null?void 0:d.name)??"model_type",U=(h==null?void 0:h.name)??"search_strategy",F=(f==null?void 0:f.name)??"search_iterations",K=(g==null?void 0:g.name)??"search_random_state",re=(w==null?void 0:w.name)??"scoring_metric",Y=c==null?void 0:c[Q],V=typeof Y=="string"&&Y.trim().length?Y.trim():((o==null?void 0:o.modelType)??"").trim(),G=Is({queryKey:["model-hyperparameters",V],queryFn:()=>wu(V),enabled:!!V,staleTime:5*60*1e3}),X=((vr=G.data)==null?void 0:vr.fields)??[],se=((sr=G.data)==null?void 0:sr.defaults)??{},J=v.useMemo(()=>{if(!X.length)return new Set;const Z=new Set;return X.forEach(pe=>{pe!=null&&pe.name&&Z.add(pe.name)}),Z},[X]),te=!!(i!=null&&i.enabled),Se=(i==null?void 0:i.strategy)??"auto",ze=typeof(i==null?void 0:i.folds)=="number"?i.folds:5,Oe=!!(i!=null&&i.shuffle),Ue=(i==null?void 0:i.randomState)??null,nt=v.useMemo(()=>{const Z=[];return((h==null?void 0:h.options)??[]).forEach(pe=>{if(!pe||typeof pe.value!="string")return;const me=pe.value.trim();if(!me.length)return;const ke=me.toLowerCase();Z.some(Ce=>Ce.toLowerCase()===ke)||Z.push(me)}),Z},[h]),He=v.useMemo(()=>nt.length>0?[...nt]:[...Dh],[nt]),de=zu(h==null?void 0:h.default,nt),je=zu(c==null?void 0:c[U],nt)??de??He[0]??Dh[0],Me=c==null?void 0:c[F];let De=null;if(typeof Me=="number"&&Number.isFinite(Me))De=Math.max(1,Math.floor(Me));else if(typeof Me=="string"){const Z=Number(Me.trim());Number.isFinite(Z)&&Z>0&&(De=Math.max(1,Math.floor(Z)))}const ce=c==null?void 0:c[K];let Te=null;if(typeof ce=="number"&&Number.isFinite(ce))Te=Math.trunc(ce);else if(typeof ce=="string"){const Z=Number(ce.trim());Number.isFinite(Z)&&(Te=Math.trunc(Z))}const Qe=typeof(f==null?void 0:f.default)=="number"&&Number.isFinite(f.default)?Math.max(1,Math.floor(f.default)):null,ht=typeof(g==null?void 0:g.default)=="number"&&Number.isFinite(g.default)?Math.trunc(g.default):null,rt=typeof(c==null?void 0:c[re])=="string"?String(c[re]).trim():"",gt=rt.length?rt:null,at=v.useMemo(()=>Ca(c==null?void 0:c.baseline_hyperparameters),[c==null?void 0:c.baseline_hyperparameters]),ut=v.useMemo(()=>Ca(c==null?void 0:c.search_space),[c==null?void 0:c.search_space]),Ot=v.useMemo(()=>Fh(ut.value),[ut.value]),Rt=at.value,Xe=at.error,Bt=Ot.value,Kt=ut.error??Ot.error,kt=v.useMemo(()=>Ih(Rt,J),[J,Rt]),_t=v.useMemo(()=>Bh(Bt,J),[J,Bt]),Cn=v.useMemo(()=>Object.keys(kt).length,[kt]),Lt=v.useMemo(()=>Object.keys(_t).length,[_t]),rn=Lt>0,[fe,Ut]=v.useState({}),[dt,Tn]=v.useState({}),[qe,wt]=v.useState(!1),[mt,Ns]=v.useState(!1),Gt=v.useRef(null);if(!Gt.current){const Z=qh(c);let ke=Z.strategies.length>0?Z.strategies.map(dx):[];const Ce=mx(ke,Z.activeId),ye=hx(ke,Z.expandedIds);Ce&&!ye.has(Ce)&&ke.length&&ye.add(Ce);const st=Fu(Z);Gt.current={strategies:ke,activeId:Ce,expanded:ye,signature:st}}const[vt,jt]=v.useState(()=>Gt.current?Gt.current.strategies:[]),[Gn,on]=v.useState(()=>new Set(Gt.current?Array.from(Gt.current.expanded):[])),[Sn,Zt]=v.useState(()=>{var Z;return((Z=Gt.current)==null?void 0:Z.activeId)??""}),$n=v.useRef(((ks=Gt.current)==null?void 0:ks.signature)??""),ln=v.useRef(null),Ht=v.useRef(null),It=v.useMemo(()=>vt.length?vt.find(pe=>pe.id===Sn)??vt[0]:null,[Sn,vt]),Fn=v.useMemo(()=>qh(c),[c]),cn=v.useMemo(()=>Fu(Fn),[Fn]);v.useEffect(()=>{if(cn===$n.current)return;const Z=Fn.strategies.length?Fn.strategies.map(dx):[],pe=mx(Z,Fn.activeId),me=hx(Z,Fn.expandedIds);pe&&!me.has(pe)&&Z.length&&me.add(pe),ln.current=null,jt(Z),Zt(pe),on(me),$n.current=cn},[cn,Fn,c]),v.useEffect(()=>{if(!vt.length)return;vt.some(pe=>pe.id===Sn)||Zt(vt[0].id)},[Sn,vt]),v.useEffect(()=>{const Z=J2(vt,Sn,Gn),pe=Fu(Z);$n.current!==pe&&b(me=>{const ke=qh(me),Ce=Fu(ke);if(Ce===pe)return $n.current=Ce,me??{};const ye=me?{...me}:{};return Z.strategies.length?ye[No]=Z.strategies.map(st=>({...st,config:as(st.config),searchSpaceTexts:{...st.searchSpaceTexts},searchSpaceFieldErrors:{...st.searchSpaceFieldErrors}})):delete ye[No],Z.activeId?ye[Co]=Z.activeId:delete ye[Co],Z.expandedIds.length?ye[So]=[...Z.expandedIds]:delete ye[So],$n.current=pe,ye})},[Sn,Gn,b,vt]),v.useEffect(()=>{if(!It||ln.current===It.id)return;ln.current=It.id;const Z=kl(It.config);b(me=>({...Q2(me),...Z})),Ut(It.searchSpaceTexts??{}),Tn(It.searchSpaceFieldErrors??{}),wt(It.hasAutoFilledSearchSpace??!1),Ns(It.searchSpaceManuallyCleared??!1);const pe=typeof(Z==null?void 0:Z[Q])=="string"?String(Z[Q]):(o==null?void 0:o.modelType)??"";Ht.current=pe},[It,Q,o==null?void 0:o.modelType,b]),v.useEffect(()=>{if(!It)return;const Z=kl(c),pe=JSON.stringify(Z)!==JSON.stringify(It.config??{}),me=!fx(fe,It.searchSpaceTexts),ke=!fx(dt,It.searchSpaceFieldErrors),Ce=It.hasAutoFilledSearchSpace!==qe,ye=It.searchSpaceManuallyCleared!==mt;!pe&&!me&&!ke&&!Ce&&!ye||jt(st=>st.map(Ie=>Ie.id!==It.id?Ie:{...Ie,config:Z,searchSpaceTexts:{...fe},searchSpaceFieldErrors:{...dt},hasAutoFilledSearchSpace:qe,searchSpaceManuallyCleared:mt}))},[It,c,qe,dt,mt,fe]);const vn=v.useCallback(()=>{const Z=vt.length+1,pe=kl(c),me=new Set;vt.forEach(Ie=>{var ot;const We=zu((ot=Ie.config)==null?void 0:ot[U],He);We&&me.add(We)});const ke=He.find(Ie=>!me.has(Ie))??je,Ce=as(pe),ye=fr(Ce)?Ce:{};if(ye[U]=ke,ke==="random"||ke==="optuna"){const Ie=De!==null?De:Qe;Ie!==null?ye[F]=Ie:delete ye[F];const We=Te!==null?Te:ht;We!==null?ye[K]=We:delete ye[K]}else delete ye[F],delete ye[K];const st=G2(Sa(Z),ye,{searchSpaceTexts:{...fe},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:qe,searchSpaceManuallyCleared:mt});jt(Ie=>[...Ie,st]),on(Ie=>new Set([...Ie,st.id])),ln.current=null,Zt(st.id)},[He,c,qe,De,Qe,Te,ht,mt,fe,je,U,F,K,jt,Zt,on,vt]),et=v.useCallback(Z=>{on(pe=>{const me=new Set(pe);return me.has(Z)?me.delete(Z):me.add(Z),me})},[]),Qn=v.useCallback(Z=>{!Z||Z===Sn||(ln.current=null,Zt(Z),on(pe=>{const me=new Set(pe);return me.add(Z),me}))},[Sn]),Cs=v.useCallback(Z=>{let pe=null;jt(me=>{if(me.length<=1)return me;const ke=me.filter(ye=>ye.id!==Z);if(!ke.length)return me;const Ce=ke.map((ye,st)=>({...ye,label:Sa(st+1)}));if(Z===Sn){ln.current=null;const ye=Ce[0].id;pe=ye,Zt(ye)}return Ce}),on(me=>{const ke=new Set(me);return ke.delete(Z),pe&&ke.add(pe),ke})},[Sn]),In=v.useMemo(()=>vt.map((Z,pe)=>{var $r,rr;const me=Z.config??{},ke=me==null?void 0:me[Q],Ce=typeof ke=="string"?ke.trim():"",ye=(($r=p.find(ts=>ts.value===Ce))==null?void 0:$r.label)??Ce,st=me==null?void 0:me[U],Ie=typeof st=="string"?st.trim():"",We=(rr=((h==null?void 0:h.options)??[]).find(ts=>ts.value===Ie))==null?void 0:rr.label,ot=me==null?void 0:me[re],Ge=typeof ot=="string"?ot.trim():"",Mn=Ca(me==null?void 0:me.baseline_hyperparameters).error,Vt=Ca(me==null?void 0:me.search_space),yn=Fh(Vt.value),Ms=yn.value?Object.keys(yn.value).length:0,As=yn.value?Object.values(yn.value).reduce((ts,ls)=>ts+(Array.isArray(ls)?ls.length:0),0):0,Gs=Mn!==null||Object.values(Z.searchSpaceFieldErrors).some(ts=>!!ts);return{id:Z.id,label:Z.label||Sa(pe+1),modelLabel:ye||"Select model",searchStrategyLabel:We??(Ie||"Random search"),scoringLabel:Ge||"Estimator default",parameterCount:Ms,candidateCount:As,hasErrors:Gs}}),[p,Q,re,h,U,vt]);v.useEffect(()=>{const Z=Ht.current;if(Z===null){Ht.current=V;return}Z!==V&&(Ht.current=V,Ut({}),Tn({}),wt(!1),Ns(!1))},[V]),v.useEffect(()=>{!V||!X.length||Ut(Z=>{const pe={...Z};let me=!1;return X.forEach(ke=>{if(dt[ke.name])return;const Ce=_t[ke.name],ye=Array.isArray(Ce)&&Ce.length>0?Ce.map(st=>ix(ke,st)).join(", "):"";pe[ke.name]!==ye&&(pe[ke.name]=ye,me=!0)}),me?pe:Z})},[_t,X,V,dt]),v.useEffect(()=>{if(!V||!X.length||mt)return;if(rn){qe||wt(!0);return}if(qe)return;const Z=K2(X,se);Object.keys(Z).length&&(wt(!0),Tn({}),Ut(()=>{const pe={};return X.forEach(me=>{if(!Z[me.name])return;const ke=Z[me.name].map(Ce=>ix(me,Ce)).filter(Ce=>Ce.length>0).join(", ");pe[me.name]=ke}),pe}),b(pe=>{const me=pe?{...pe}:{};return me.search_space=Z,me}))},[qe,se,X,V,rn,mt,b]);const[Xn,Ss]=v.useState(gt??"");v.useEffect(()=>{Ss(gt??"")},[gt]);const Bn=v.useMemo(()=>Y2[I==="regression"?"regression":"classification"],[I]),Qt=(w==null?void 0:w.label)??"Scoring metric",Tt=(w==null?void 0:w.description)??"Pick the evaluation metric used to rank candidates.",lt=v.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),Ks=v.useMemo(()=>Object.values(dt).some(Z=>!!Z),[dt]),Un=v.useCallback((Z,pe)=>{J.has(Z)&&b(me=>{const ke={...me},Ce=Ca(me==null?void 0:me.baseline_hyperparameters).value??{},st={...Ih(Ce,J)};return pe===void 0?delete st[Z]:st[Z]=pe,Object.keys(st).length>0?ke.baseline_hyperparameters=st:delete ke.baseline_hyperparameters,ke})},[J,b]),Ys=v.useCallback((Z,pe)=>{Ut(Ce=>({...Ce,[Z.name]:pe}));const{values:me,error:ke}=W2(Z,pe);Tn(Ce=>({...Ce,[Z.name]:ke})),!ke&&b(Ce=>{const ye={...Ce},st=Ca(Ce==null?void 0:Ce.search_space).value??{},We={...Bh(st,J)};return me.length>0?We[Z.name]=me.map(ot=>as(ot)):delete We[Z.name],Object.keys(We).length>0?ye.search_space=We:delete ye.search_space,ye})},[J,b]),os=v.useCallback(Z=>{Un(Z,void 0)},[Un]),_r=v.useCallback(()=>{b(Z=>{if(!Z||!Z.baseline_hyperparameters)return Z??{};const pe={...Z};return delete pe.baseline_hyperparameters,pe})},[b]),le=v.useCallback(()=>{Ns(!0),wt(!0),Ut({}),Tn({}),b(Z=>{if(!Z||!Z.search_space)return Z??{};const pe={...Z};return delete pe.search_space,pe})},[b]),ge=v.useCallback(Z=>{Ss(Z);const pe=Z.trim();b(me=>{const ke={...me};return pe.length>0?ke.scoring_metric=pe:delete ke.scoring_metric,ke})},[b]),Pe=v.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const pe=`baseline-${e}-${Z.name}`,me=kt[Z.name],ke=me!==void 0,Ce=se==null?void 0:se[Z.name],ye=Z.label??Z.name,st=Z.description,Ie=Ce!==void 0?`Default: ${Ru(Ce)}`:"Default: estimator setting";let We;if(Z.type==="number"){const ot=typeof me=="number"?String(me):"";We=a.jsx("input",{id:pe,type:"number",className:"canvas-modal__parameter-input",value:ot,onChange:Ge=>{const Et=Ge.target.value;if(!Et.length){os(Z.name);return}const Mn=Number(Et);Number.isFinite(Mn)&&Un(Z.name,Mn)},min:Z.min,max:Z.max,step:Z.step,placeholder:"Leave blank to use default"})}else if(Z.type==="select"){const ot=ke?String(me):"";We=a.jsxs("select",{id:pe,className:"canvas-modal__parameter-select",value:ot,onChange:Ge=>{const Et=Ge.target.value;if(!Et.length){os(Z.name);return}Un(Z.name,Et)},children:[a.jsx("option",{value:"",children:"Use default"}),(Z.options??[]).map(Ge=>a.jsx("option",{value:Ge.value,children:Ge.label},Ge.value))]})}else if(Z.type==="boolean"){const ot=ke?me?"true":"false":"";We=a.jsxs("select",{id:pe,className:"canvas-modal__parameter-select",value:ot,onChange:Ge=>{const Et=Ge.target.value;if(!Et.length){os(Z.name);return}Un(Z.name,Et==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const ot=typeof me=="string"?me:"";We=a.jsx("input",{id:pe,type:"text",className:"canvas-modal__parameter-input",value:ot,onChange:Ge=>{const Et=Ge.target.value;if(!Et.length){os(Z.name);return}Un(Z.name,Et)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:pe,className:"canvas-modal__parameter-label",children:[ye,st&&a.jsx("span",{className:"canvas-modal__parameter-description",children:st})]}),We,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:ke?`Override: ${Ru(me)}`:Ie})})]},Z.name)},[J,kt,se,e,Un]),Nt=v.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const pe=`search-${e}-${Z.name}`,me=fe[Z.name]??"",ke=_t[Z.name],Ce=Array.isArray(ke)?ke.length:0,ye=dt[Z.name],st=se==null?void 0:se[Z.name],Ie=Z.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":Z.type==="boolean"?"Enter true/false values, separated by commas or new lines":Z.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",We=Array.isArray(ke)?ke.slice(0,3).map(ot=>Ru(ot)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:pe,className:"canvas-modal__parameter-label",children:[Z.label??Z.name,Z.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:Z.description})]}),a.jsx("textarea",{id:pe,className:"canvas-modal__parameter-input",rows:3,value:me,onChange:ot=>Ys(Z,ot.target.value),placeholder:Ie,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Ce>0?`Configured ${Ce} value${Ce===1?"":"s"}${We?` (${We}${Ce>3?"":""})`:""}`:`Default: ${Ru(st)}`})}),ye&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:ye})]},Z.name)},[J,_t,Ys,se,e,dt,fe]),we=v.useMemo(()=>{if(!rn)return{parameterCount:0,candidateProduct:null};const Z=Object.values(_t),pe=Z.length;let me=null;if(Z.length>0){let ke=1,Ce=!1;Z.forEach(ye=>{ke*=Math.max(ye.length,1),(!Number.isFinite(ke)||ke>1e6)&&(Ce=!0)}),me=Ce?null:ke}return{parameterCount:pe,candidateProduct:me}},[_t,rn]),tt=v.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),it=v.useCallback(Z=>{if(!tt)return null;const pe=as(tt);if(!pe||!Array.isArray(pe.nodes))return tt;const me=Ki(Z),ke=Object.keys(me).length>0;return pe.nodes=pe.nodes.map(Ce=>{if(!Ce||Ce.id!==e)return Ce;const ye=(Ce==null?void 0:Ce.data)??{},st=(ye==null?void 0:ye.config)??{},Ie=Ki(st),We=ke?{...Ie,...me}:Ie;return{...Ce,data:{...ye,config:We,isConfigured:!0}}}),pe},[tt,e]),Ct=v.useMemo(()=>{const Z=it(c);return Z||tt},[c,tt,it]),$t=v.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const Z=n.nodes,pe=n.edges;return(()=>{var st;const ye=Z.find(Ie=>(Ie==null?void 0:Ie.id)===e);return ye?lx((st=ye==null?void 0:ye.data)==null?void 0:st.connectedSplits):[]})().includes("validation")||pe.some(ye=>!ye||(typeof ye.target=="string"?ye.target:null)!==e?!1:(typeof ye.sourceHandle=="string"?ye.sourceHandle.toLowerCase():"").includes("validation"))?!0:pe.some(ye=>{var Ge;if(!ye||(typeof ye.target=="string"?ye.target:null)!==e)return!1;const Ie=typeof ye.source=="string"?ye.source:null;if(!Ie)return!1;const We=Z.find(Et=>(Et==null?void 0:Et.id)===Ie);return We?lx((Ge=We==null?void 0:We.data)==null?void 0:Ge.activeSplits).includes("validation"):!1})?!1:null},[n,e]);v.useEffect(()=>{let Z=!1;return!t||!tt?($(null),()=>{Z=!0}):(xo(t,tt).then(pe=>{Z||$(pe)}).catch(()=>{Z||$(null)}),()=>{Z=!0})},[tt,t]),v.useEffect(()=>{let Z=!1;j(null);const pe=Ct??tt;return!t||!pe?(C(null),()=>{Z=!0}):(xo(t,pe).then(me=>{Z||C(me)}).catch(me=>{Z||(j((me==null?void 0:me.message)??"Unable to compute pipeline ID"),C(null))}),()=>{Z=!0})},[tt,Ct,t]),v.useEffect(()=>{if(!N||!L){R(!1);return}R(N!==L)},[N,L]);const en=!!(t&&e),qt=v.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",N??"pending",e],[e,N,t]),un=Is({queryKey:qt,queryFn:async()=>{var pe;const Z={datasetSourceId:t||void 0,nodeId:e,limit:5};if(N){const me=await Ti({...Z,pipelineId:N});if((((pe=me==null?void 0:me.jobs)==null?void 0:pe.length)??0)>0)return me}return Ti(Z)},enabled:en,retry:(Z,pe)=>pe.message.includes("Sign in")?!1:Z<2,refetchInterval:Z=>{const pe=Z.state.data;return((pe==null?void 0:pe.jobs)??[]).some(Ce=>Ce.status==="queued"||Ce.status==="running")?5e3:!1}}),{mutateAsync:Es,isPending:Jn,error:En}=Uc({mutationFn:gy,onSuccess:Z=>{const pe=Array.isArray(Z.jobs)?Z.jobs.length:0,me=pe>0?Z.jobs[0]:null;M(me),P(pe),x.invalidateQueries({queryKey:qt})}}),kn=v.useMemo(()=>{const Z=[];return t||Z.push("Select a dataset before launching tuning jobs."),(!tt||!tt.nodes.length)&&Z.push("Connect this node to an upstream pipeline before tuning."),q||Z.push("Set a target column before tuning."),$t===!1&&Z.push("Connect the validation split to this node to enable tuning."),V||Z.push("Choose a model type before enqueuing tuning jobs."),vt.length===0&&Z.push("Add a tuning strategy before launching tuning jobs."),rn||Z.push("Define at least one hyperparameter in the search space."),Xe&&Z.push(Xe),Kt&&Z.push(Kt),Ks&&Z.push("Resolve invalid candidate values in the search space."),(je==="random"||je==="optuna")&&!De&&Z.push("Provide the maximum iterations for random or Optuna search."),te&&ze<2&&Z.push("Cross-validation requires at least 2 folds."),E&&Z.push(E),Z},[Xe,te,ze,tt,rn,Ks,V,E,De,Kt,je,t,q,$t,vt.length]),Zn=((es=un.data)==null?void 0:es.jobs)??[],qn=un.isLoading||un.isFetching,Tr=un.error,Ra=v.useMemo(()=>!!(En instanceof Error&&Nl(En.message)||W&&Nl(W)||S&&Ui(S)||Zn.some(Z=>Ui(Z))),[W,En,S,Zn]),bt=qb({graph:n,nodeId:e,modelType:V,problemType:I,modelTypeOptions:p,enabled:Ra});v.useEffect(()=>{bt||H(!1)},[bt]);const ea=kn.length>0||Ks||!N||!t||!tt||vt.length===0||!rn||Jn,Da=v.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),Fo=v.useCallback(async()=>{if(!N||!t||!tt||vt.length===0)return;if(_){try{const Ce=_({closeModal:!1});R(!1),Ce&&typeof Ce.then=="function"&&await Ce}catch{}await new Promise(Ce=>setTimeout(Ce,100))}const Z=async()=>{const Ce=[],ye=[],st=async Ie=>{if(!Ie)return new Set;if(Ie===V)return J;const We=["model-hyperparameters",Ie],ot=x.getQueryData(We),Ge=Et=>{const Mn=new Set;return(Et??[]).forEach(Vt=>{Vt!=null&&Vt.name&&Mn.add(Vt.name)}),Mn};if(ot)return Ge(ot.fields);try{const Et=await x.fetchQuery({queryKey:We,queryFn:()=>wu(Ie)});return Ge(Et==null?void 0:Et.fields)}catch{return new Set}};for(let Ie=0;Ie<vt.length;Ie+=1){const We=vt[Ie],ot=We.label||Sa(Ie+1),Ge=kl(We.config),Et=Ge==null?void 0:Ge[Q],Mn=typeof Et=="string"&&Et.trim().length?Et.trim():V;if(!Mn){ye.push(`${ot} is missing a model selection.`);continue}const Vt=zu(Ge==null?void 0:Ge[U],He)??de??"random",yn=await st(Mn),As=Ca(Ge==null?void 0:Ge.baseline_hyperparameters).value??{},Gs=yn.size>0?Ih(As,yn):as(As),$r=Ca(Ge==null?void 0:Ge.search_space);if($r.error){ye.push(`${ot} has invalid search space: ${$r.error}`);continue}const rr=Fh($r.value);if(rr.error){ye.push(`${ot} has invalid search space: ${rr.error}`);continue}const ts=rr.value??{},ls=yn.size>0?Bh(ts,yn):as(ts);if(!ls||Object.keys(ls).length===0){ye.push(`${ot} requires at least one hyperparameter in the search space.`);continue}if(Object.values(We.searchSpaceFieldErrors??{}).some(nn=>!!nn)){ye.push(`${ot} has search space entries that need attention.`);continue}const Fa=Object.keys(ls).length;let Os=null;if(Fa>0){let nn=1,bn=!1;Object.values(ls).forEach(is=>{const Uo=Array.isArray(is)?is.length:0;nn*=Math.max(Uo,1),(!Number.isFinite(nn)||nn>1e6)&&(bn=!0)}),Os=bn?null:nn}const ta=Ge==null?void 0:Ge[re],Pr=typeof ta=="string"?ta.trim():"",Ia=Pr.length?Pr:null,na=()=>{const nn=Ge==null?void 0:Ge[F];let bn=null;if(typeof nn=="number"&&Number.isFinite(nn))bn=Math.max(1,Math.floor(nn));else if(typeof nn=="string"){const is=Number(nn.trim());Number.isFinite(is)&&is>0&&(bn=Math.max(1,Math.floor(is)))}return bn===null&&(Vt==="random"||Vt==="optuna")?Qe!==null?Qe:null:bn},sa=()=>{const nn=Ge==null?void 0:Ge[K];let bn=null;if(typeof nn=="number"&&Number.isFinite(nn))bn=Math.trunc(nn);else if(typeof nn=="string"){const is=Number(nn.trim());Number.isFinite(is)&&(bn=Math.trunc(is))}return bn===null&&(Vt==="random"||Vt==="optuna")?ht!==null?ht:null:bn},ra=na(),Pn=sa(),tn={};q&&(tn.target_column=q),tn.problem_type=I,tn.strategy_id=We.id,tn.strategy_label=ot,tn.strategy_index=Ie+1,tn.search_strategy=Vt,ra!==null&&(Vt==="random"||Vt==="optuna")&&(tn.max_iterations=ra),Ia&&(tn.scoring_metric=Ia),Pn!==null&&(tn.random_state=Pn),tn.search_space_keys=Object.keys(ls),Fa>0&&(tn.search_space_parameters=Fa),Os!==null&&(tn.search_space_candidates=Os),tn.cross_validation={enabled:te,strategy:Se,folds:ze,shuffle:Oe,random_state:Ue};const aa=it(Ge)??tt;if(!aa){ye.push(`Unable to build pipeline graph for ${ot}.`);continue}const Ts=Gs&&Object.keys(Gs).length>0?as(Gs):void 0,Ul=as(ls),Bo={dataset_source_id:t,pipeline_id:N,node_id:e,model_type:Mn,model_types:[Mn],search_strategy:Vt,search_space:Ul,baseline_hyperparameters:Ts,n_iterations:Vt==="random"||Vt==="optuna"?ra??void 0:void 0,scoring:Ia??void 0,random_state:Pn??void 0,cross_validation:{enabled:te,strategy:Se,folds:ze,shuffle:Oe,random_state:Ue},metadata:tn,job_metadata:tn,run_tuning:!0,graph:aa,target_node_id:e};Ce.push({payload:Bo,label:ot})}return{plans:Ce,issues:ye}};z(null);const{plans:pe,issues:me}=await Z();if(!pe.length){me.length&&z(me.join(" "));return}const ke=[];for(const{payload:Ce}of pe)try{const ye=await Es(Ce);Array.isArray(ye==null?void 0:ye.jobs)&&ye.jobs.length&&ke.push(...ye.jobs)}catch(ye){ye instanceof Error&&ye.message?z(ye.message):z("Failed to enqueue one or more tuning jobs.");return}if(ke.length){const Ce=ke[ke.length-1];M(Ce),P(ke.length)}},[J,te,ze,Ue,Oe,Se,Es,tt,it,V,Q,e,_,de,x,N,I,re,Qe,F,ht,K,U,z,R,t,vt,q]),Bl=v.useCallback(()=>{en&&un.refetch()},[en,un]),Io=Z=>{var Mn,Vt,yn,Ms,As;const pe=q2[Z.status]??Z.status,ke=(((Mn=p.find(Gs=>Gs.value===Z.model_type))==null?void 0:Mn.label)??Z.model_type??"").trim(),Ce=(()=>{switch(Z.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"halving_random":return"Successive halving (randomized)";case"optuna":return"Optuna search";default:return"Random search"}})(),ye=Z.updated_at?Rn(Z.updated_at):null,st=Z.updated_at||Z.created_at,Ie=st?ye??new Date(st).toLocaleString():null,We=typeof Z.error_message=="string"?Z.error_message.trim():"",ot=[];ke&&ot.push(`Model ${ke}`),ot.push(Ce),Array.isArray(Z.results)&&Z.results.length>0&&ot.push(`${Z.results.length} candidates`);const Ge=typeof Z.best_score=="number"&&Number.isFinite(Z.best_score)?Z.best_score:typeof((Vt=Z.metrics)==null?void 0:Vt.best_score)=="number"?Z.metrics.best_score:null;Ge!==null&&ot.push(`Best score ${H2(Ge)}`);const Et=String(((yn=Z.metrics)==null?void 0:yn.scoring)??((Ms=Z.metrics)==null?void 0:Ms.scorer)??((As=Z.metadata)==null?void 0:As.scoring_metric)??"").trim();if(Et&&ot.push(`Scoring ${Et}`),Z.status==="failed"&&We){const Gs=We.replace(/\s+/g," ");ot.push(`Error: ${Gs}`)}return Ie&&ot.push(`Updated ${Ie}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["Run ",Z.run_number]}),"  ",pe,ot.length?`  ${ot.join("  ")}`:""]},Z.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:vn,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Bl,disabled:!en||qn,children:qn?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:N})]}),A&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]}),kn.map((Z,pe)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Z},`tuning-prereq-${pe}`)),En instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:En.message}),W&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:W}),Tr&&!(En instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Tr.message||"Unable to load tuning jobs."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:T>1?a.jsxs("span",{children:["Queued ",T," tuning jobs. Latest job ",S.id," (run ",S.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",S.id," queued (run ",S.run_number,")."]})}),rn&&we.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",we.parameterCount," hyperparameter",we.parameterCount===1?"":"s",we.candidateProduct!==null?`  up to ${we.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsxs("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:[vt.length===0&&a.jsx("p",{style:{margin:"0",padding:"1rem 1.25rem",border:"1px dashed rgba(148, 163, 184, 0.4)",borderRadius:"6px",color:"rgba(148, 163, 184, 0.85)",background:"rgba(15, 23, 42, 0.35)"},children:'No tuning strategies configured yet. Use "Add strategy" to define your search plan.'}),vt.map((Z,pe)=>{const me=In[pe],ke=!!(It&&It.id===Z.id),Ce=Gn.has(Z.id),ye=[];if(me!=null&&me.modelLabel&&ye.push(me.modelLabel),me!=null&&me.searchStrategyLabel&&ye.push(me.searchStrategyLabel),me!=null&&me.scoringLabel&&ye.push(`Scoring ${me.scoringLabel}`),me!=null&&me.parameterCount){const Ie=me.candidateCount?`${me.parameterCount} param${me.parameterCount===1?"":"s"}  ${me.candidateCount} candidate${me.candidateCount===1?"":"s"}`:`${me.parameterCount} param${me.parameterCount===1?"":"s"}`;ye.push(Ie)}else ye.includes("Needs attention")||ye.push("No search values");me!=null&&me.hasErrors&&ye.push("Needs attention");const st=ye.length>0?ye.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{et(Z.id),ke||Qn(Z.id)},"aria-expanded":Ce,"aria-controls":`tuning-strategy-body-${Z.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${Ce?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(me==null?void 0:me.label)??Sa(pe+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:st})]})]}),vt.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>Cs(Z.id),"aria-label":`Remove ${(me==null?void 0:me.label)??Sa(pe+1)}`,children:"Remove"})]}),Ce&&ke&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${Z.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Da&&u(Da),h&&u(h),(je==="random"||je==="optuna")&&f&&u(f),(je==="random"||je==="optuna")&&g&&u(g)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:Qt}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Tt}),a.jsxs("div",{id:lt,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:Xn||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[Bn.map(Ie=>a.jsx("button",{type:"button",onClick:()=>ge(Ie.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Xn===Ie.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:Xn===Ie.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:Ie.label},Ie.value)),a.jsx("button",{type:"button",onClick:()=>ge(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),V&&X.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Cn>0?`${Cn} override${Cn===1?"":"s"} configured`:"Using template defaults"}),Cn>0&&a.jsx("button",{type:"button",onClick:_r,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),Xe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Xe}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:X.map(Pe)})]}),V&&X.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Lt>0?`${Lt} parameter${Lt===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:le,disabled:Lt===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Lt===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:Lt===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:Lt===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),Kt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Kt}),Ks&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:X.map(Nt)})]})]})]},Z.id)})]}),te&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",ze," folds before reporting aggregate metrics."]}),bt&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",bt.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:bt.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>H(Z=>!Z),style:{whiteSpace:"nowrap"},children:D?"Hide tips":"Show tips"})]}),D&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:bt.details.map((Z,pe)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:Z},`tuning-scaling-tip-${pe}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Fo,disabled:ea,children:Jn?"Queuing":"Launch tuning job"})}),qn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!qn&&Zn.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),Zn.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Zn.map(Io)})]})},Hh={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},e$=(e,t)=>{if(e==null||e==="")return Hh[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return Hh[t].auto;const s=Math.max(Math.min(e,1),0),o=s*100,i=s.toFixed(s>=.1||s===0?2:3),c=t==="undersampling"?"majority":"majority baseline";return`${i} ratio (${o.toFixed(1)}% of ${c})`}const n=e.trim().toLowerCase();return Hh[t][n]??n},t$=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let s=e.length-1;s>=0;s-=1){const o=e[s];if(typeof o!="string")continue;const i=o.toLowerCase();if(n.some(c=>i.includes(c)))return o}return null},n$=(e,t)=>t?"Missing":e.length?e:"Empty string",s$=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:o,config:i,methodParameter:c,targetColumnParameter:u,samplingStrategyParameter:d,randomStateParameter:p,replacementParameter:h,kNeighborsParameter:f,renderParameterField:g,formatMetricValue:w,formatMissingPercentage:b,schemaGuard:_})=>{var F;const x=s.data,N=s.status,C=Array.isArray(x==null?void 0:x.applied_steps)?x==null?void 0:x.applied_steps:[],E=v.useMemo(()=>t$(C,e),[C,e]),j=(i==null?void 0:i.targetColumn)??"",S=(i==null?void 0:i.method)||(typeof(c==null?void 0:c.default)=="string"?c.default:""),M=v.useMemo(()=>{const K=Array.isArray(c==null?void 0:c.options)?c==null?void 0:c.options:[];if(S){const re=K.find(Y=>Y.value===S);return re!=null&&re.label?re.label:S.replace(/_/g," ")}return K.length>0?K[0].label??K[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[S,c==null?void 0:c.options,e]),T=v.useMemo(()=>e$(i==null?void 0:i.samplingStrategy,e),[i==null?void 0:i.samplingStrategy,e]),P=v.useMemo(()=>(i==null?void 0:i.randomState)===null||(i==null?void 0:i.randomState)===void 0?"Not set":Number.isFinite(i.randomState)?String(i.randomState):"Not set",[i==null?void 0:i.randomState]),L=v.useMemo(()=>{if(e!=="oversampling")return null;const K=i==null?void 0:i.kNeighbors;if(typeof K=="number"&&Number.isFinite(K))return String(Math.max(1,Math.round(K)));if(f&&typeof f.default=="number"){const re=f.default;if(Number.isFinite(re))return String(Math.max(1,Math.round(re)))}return"Default"},[i==null?void 0:i.kNeighbors,f,e]),$=(i==null?void 0:i.replacement)===null||(i==null?void 0:i.replacement)===void 0?null:i.replacement?"With replacement":"Without replacement",A=v.useMemo(()=>{if(N!=="success"||!x||!j)return{rows:[],total:0,truncated:!1};const K=Array.isArray(x.sample_rows)?x.sample_rows:[];if(!K.length)return{rows:[],total:0,truncated:!1};const re=new Map;K.forEach(te=>{if(!te||typeof te!="object")return;const Se=te[j],ze=Se==null,Oe=ze?"__missing__":String(Se),Ue=n$(ze?"":Oe,ze),nt=re.get(Oe);nt?nt.count+=1:re.set(Oe,{label:Ue,count:1,percentage:0,isMissing:ze})});const Y=Array.from(re.values()).sort((te,Se)=>Se.count-te.count),V=Y.reduce((te,Se)=>te+Se.count,0),G=8,X=Y.length>G;return{rows:(X?Y.slice(0,G):Y).map(te=>({...te,percentage:V>0?te.count/V*100:0})),total:V,truncated:X}},[x,N,j]),R=((F=x==null?void 0:x.metrics)==null?void 0:F.row_count)??null,W=!!t&&n&&N!=="loading"&&!(_!=null&&_.blocked),z=v.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),D=v.useMemo(()=>!(_!=null&&_.blocked)||!_.details.length?"":_.details.map(K=>K.logical_family?`${K.name} (${K.logical_family})`:K.name).join(", "),[_]),H=!j,q=!!j&&Array.isArray(x==null?void 0:x.columns)&&!(x!=null&&x.columns.includes(j)),I=e==="undersampling"?"Class undersampling":"Class oversampling",Q=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",U=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:I}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:o,disabled:!W,children:N==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:Q}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),H&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",U,"."]}),(_==null?void 0:_.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[_.message,D&&a.jsxs(a.Fragment,{children:[" ","Columns: ",D,"."]})]}),N==="error"&&s.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),q&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",j," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:E}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:M})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:T})]}),e==="oversampling"&&L&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:L})]}),$&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:$})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:P})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[c&&g(c),d&&g(d),e==="oversampling"&&f&&g(f),p&&g(p),h&&g(h)]}),u&&a.jsx("div",{className:"canvas-modal__parameter-list",children:g(u)}),j&&N==="success"&&!q&&(A.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:A.rows.map(K=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:K.label}),a.jsx("td",{children:w(K.count)}),a.jsx("td",{children:b(K.percentage)})]},`resampling-class-${K.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",w(A.total)," row",A.total===1?"":"s"," from the preview.",A.truncated?" Showing top classes by frequency.":""]}),R!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",w(R),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},r$=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},a$=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),o$=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),l$=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return v.useMemo(()=>{const s=r$(e),o=t==="data_preview",i=t==="dataset_profile",c=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",u=t==="missing_value_indicator",d=t==="replace_aliases_typos",p=t==="trim_whitespace",h=t==="remove_special_characters",f=t==="replace_invalid_values",g=t==="regex_replace_fix",w=t==="normalize_text_case",b=t==="standardize_date_formats",_=t==="label_encoding",x=t==="target_encoding",N=t==="hash_encoding",C=t==="train_model_draft",E=t==="model_evaluation",j=t==="model_registry_overview",S=t==="hyperparameter_tuning",M=t==="feature_target_split",T=t==="train_test_split",P=t==="class_undersampling",L=t==="class_oversampling",$=t==="ordinal_encoding",A=t==="dummy_encoding",R=t==="one_hot_encoding",W=t==="feature_math",z=t==="cast_column_types",D=t==="binning_discretization",H=t==="scale_numeric_features",q=t==="polynomial_features",I=t==="feature_selection",Q=t==="transformer_audit",U=t==="outlier_removal",F=t==="skewness_transform",K=t==="skewness_distribution",re=t==="binned_distribution",Y=o$.has(t),V=a$.has(t),G=t==="remove_duplicates",X=t==="drop_missing_columns",se=t==="drop_missing_rows";return{catalogType:t,isDataset:s,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:p,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:f,isRegexCleanupNode:g,isNormalizeTextCaseNode:w,isStandardizeDatesNode:b,isLabelEncodingNode:_,isTargetEncodingNode:x,isHashEncodingNode:N,isTrainModelDraftNode:C,isModelEvaluationNode:E,isModelRegistryNode:j,isHyperparameterTuningNode:S,isFeatureTargetSplitNode:M,isTrainTestSplitNode:T,isClassUndersamplingNode:P,isClassOversamplingNode:L,isOrdinalEncodingNode:$,isDummyEncodingNode:A,isOneHotEncodingNode:R,isFeatureMathNode:W,isCastNode:z,isBinningNode:D,isScalingNode:H,isPolynomialFeaturesNode:q,isFeatureSelectionNode:I,isTransformerAuditNode:Q,isOutlierNode:U,isSkewnessNode:F,isSkewnessDistributionNode:K,isBinnedDistributionNode:re,isDataConsistencyNode:Y,isInspectionNode:V,isRemoveDuplicatesNode:G,isDropMissingColumnsNode:X,isDropMissingRowsNode:se,isDropMissingNode:X||se,isPreviewNode:o,isDatasetProfileNode:i}},[t,e])},i$=({isScalingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(b=>b+1)},[]);return v.useEffect(()=>{let b=!0;return e?t?n?(h(!0),d(null),sy(t,{graph:s,targetNodeId:o}).then(_=>{b&&c(_??null)}).catch(_=>{b&&(c(null),d((_==null?void 0:_.message)??"Unable to load scaling insights"))}).finally(()=>{b&&h(!1)}),()=>{b=!1}):(c(null),d("Connect this step to an upstream output to load scaling insights."),h(!1),()=>{b=!1}):(c(null),d("Select a dataset to load scaling insights."),h(!1),()=>{b=!1}):(c(null),d(null),h(!1),()=>{b=!1})},[s,n,e,f,t,o]),{scalingData:i,scalingError:u,isFetchingScaling:p,refreshScaling:w}},c$=({isBinningNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(b=>b+1)},[]);return v.useEffect(()=>{let b=!0;return e?t?n?(h(!0),d(null),ry(t,{graph:s,targetNodeId:o}).then(_=>{b&&c(_??null)}).catch(_=>{b&&(c(null),d((_==null?void 0:_.message)??"Unable to load binning insights"))}).finally(()=>{b&&h(!1)}),()=>{b=!1}):(c(null),d("Connect this step to an upstream output to analyse numeric columns."),h(!1),()=>{b=!1}):(c(null),d("Select a dataset to load binning insights."),h(!1),()=>{b=!1}):(c(null),d(null),h(!1),()=>{b=!1})},[s,n,e,f,t,o]),{binningData:i,binningError:u,isFetchingBinning:p,refreshBinning:w}},u$=({shouldLoad:e,sourceId:t,graphContext:n,targetNodeId:s,transformations:o})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useRef(null),b=v.useCallback(()=>{g(_=>_+1)},[]);return v.useEffect(()=>{let _=!0;return e?t?(w.current&&clearTimeout(w.current),w.current=setTimeout(()=>{if(!_)return;h(!0),d(null);let x;o.length>0&&(x=o.map(N=>({column:N.column,method:N.method}))),ny(t,{transformations:x,graph:n,targetNodeId:s}).then(N=>{_&&c(N??null)}).catch(N=>{_&&(c(null),d((N==null?void 0:N.message)??"Unable to load skewness insights"))}).finally(()=>{_&&h(!1)})},300),()=>{_=!1,w.current&&clearTimeout(w.current)}):(c(null),d("Select a dataset to load skewness insights."),h(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{_=!1}):(c(null),d(null),h(!1),w.current&&(clearTimeout(w.current),w.current=null),()=>{_=!1})},[n,f,e,t,s,o]),{skewnessData:i,skewnessError:u,isFetchingSkewness:p,refreshSkewness:b}},d$=({isBinnedDistributionNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o,samplePreset:i})=>{const[c,u]=v.useState(null),[d,p]=v.useState(null),[h,f]=v.useState(!1),[g,w]=v.useState(0),b=v.useCallback(()=>{w(_=>_+1)},[]);return v.useEffect(()=>{let _=!0;if(!e)return u(null),p(null),f(!1),()=>{_=!1};if(!t)return u(null),p("Select a dataset to load binned column distributions."),f(!1),()=>{_=!1};if(!n)return u(null),p("Connect this step to an upstream output to load binned column distributions."),f(!1),()=>{_=!1};f(!0),p(null);const x=Pi.find(C=>C.value===i)??Pi[0],N=x.value==="all"?"all":Number(x.value);return ay(t,{sampleSize:N,graph:s,targetNodeId:o}).then(C=>{_&&u(C??null)}).catch(C=>{_&&(u(null),p((C==null?void 0:C.message)??"Unable to load binned column distributions"))}).finally(()=>{_&&f(!1)}),()=>{_=!1}},[s,n,e,g,i,t,o]),{binnedDistributionData:c,binnedDistributionError:d,isFetchingBinnedDistribution:h,refreshBinnedDistribution:b}},m$=(e,t)=>v.useMemo(()=>{if(!e)return[];const s=(Array.isArray(t==null?void 0:t.columns)?t==null?void 0:t.columns:[]).map(o=>{if(!o||!o.column)return null;const i=Number(o.total_rows),c=Number.isFinite(i)?Math.max(0,Math.round(i)):0;if(c<=0)return null;const d=(Array.isArray(o.bins)?o.bins:[]).map(P=>{if(!P)return null;const $=(typeof P.label=="string"?P.label.trim():String(P.label??""))||(P.is_missing?"Missing":"Unlabeled bin"),A=Number(P.count);if(!Number.isFinite(A))return null;const R=Math.max(0,Math.round(A)),W=Number(P.percentage),z=Number.isFinite(W)?Math.min(100,Math.max(0,W)):0,D=Number(z.toFixed(2));return{label:$,count:R,percentage:D,isMissing:!!P.is_missing}}).filter(P=>!!P);if(!d.length)return null;d.sort((P,L)=>P.isMissing!==L.isMissing?P.isMissing?1:-1:P.count!==L.count?L.count-P.count:P.label.localeCompare(L.label));const p=d.length,h=12,f=p>h,g=f?d.slice(0,h):d,w=Number(o.missing_rows),b=Number.isFinite(w)?Math.max(0,Math.round(w)):0,_=Number(o.distinct_bins),x=Number.isFinite(_)?Math.max(0,Math.round(_)):d.length,N=o.top_label;let C=typeof N=="string"?N.trim()||null:N??null;const E=Number(o.top_count);let j=Number.isFinite(E)?Math.max(0,Math.round(E)):null;const S=Number(o.top_percentage);let M=Number.isFinite(S)?Number(Math.min(100,Math.max(0,S)).toFixed(2)):null;(C===null||j===null||M===null)&&g.length&&(C=g[0].label,j=g[0].count,M=g[0].percentage);const T=typeof o.source_column=="string"?o.source_column.trim()||null:o.source_column??null;return{column:o.column,sourceColumn:T,totalRows:c,missingRows:b,distinctBins:x,topLabel:C,topCount:j,topPercentage:M,bins:g,hasMoreBins:f,totalBinCount:p}}).filter(o=>!!o);return s.sort((o,i)=>{const c=(i.topCount??0)-(o.topCount??0);return c!==0?c:o.column.localeCompare(i.column)}),s},[t,e]),h$=({shouldLoad:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o,setAvailableColumns:i,setColumnMissingMap:c})=>{const[u,d]=v.useState(!1),[p,h]=v.useState(null),[f,g]=v.useState(0),w=v.useCallback(()=>{!e||!t||!n||g(b=>b+1)},[n,e,t]);return v.useEffect(()=>{let b=!0;return e?t?n?(d(!0),h(null),gh(t,{graph:s,targetNodeId:o}).then(_=>{if(!b)return;const x={};_&&typeof _=="object"&&(_!=null&&_.column_missing_map)&&typeof _.column_missing_map=="object"&&Object.entries(_.column_missing_map).forEach(([E,j])=>{const S=String(E??"").trim();if(!S)return;const M=Number(j);Number.isNaN(M)||M<0||(x[S]=Number(M))});const N=new Set;Array.isArray(_==null?void 0:_.all_columns)&&_.all_columns.forEach(E=>{const j=String(E??"").trim();j&&N.add(j)}),Object.keys(x).forEach(E=>N.add(E));const C=Array.from(N).sort((E,j)=>E.localeCompare(j));C.forEach(E=>{Object.prototype.hasOwnProperty.call(x,E)||(x[E]=0)}),C.length&&i(C),Object.keys(x).length&&c(E=>({...E,...x}))}).catch(_=>{b&&h((_==null?void 0:_.message)??"Unable to load column metrics.")}).finally(()=>{b&&d(!1)}),()=>{b=!1}):(h("Connect this step to an upstream output to load column metrics."),d(!1),()=>{b=!1}):(h("Select a dataset to load column metrics."),d(!1),()=>{b=!1}):()=>{b=!1}},[s,n,f,i,c,e,t,o]),{isFetching:u,error:p,refreshDropColumnRecommendations:w}},f$=({isOutlierNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(null),[u,d]=v.useState(null),[p,h]=v.useState(!1),[f,g]=v.useState(0),w=v.useCallback(()=>{g(b=>b+1)},[]);return v.useEffect(()=>{let b=!0;return e?t?n?(h(!0),d(null),ty(t,{graph:s,targetNodeId:o}).then(_=>{b&&c(_??null)}).catch(_=>{b&&(c(null),d((_==null?void 0:_.message)??"Unable to load outlier insights"))}).finally(()=>{b&&h(!1)}),()=>{b=!1}):(c(null),d("Connect this step to an upstream output to load outlier insights."),h(!1),()=>{b=!1}):(c(null),d("Select a dataset to load outlier insights."),h(!1),()=>{b=!1}):(c(null),d(null),h(!1),()=>{b=!1})},[s,n,e,f,t,o]),{outlierData:i,outlierError:u,isFetchingOutliers:p,refreshOutliers:w}},p$=["int","float","double","decimal","number","numeric","long","short"],g$=["datetime","date","time","timestamp"],_$=["object","string","text","category","categorical","char"],v$=({shouldAnalyze:e,availableColumns:t,columnTypeMap:n,previewSampleRows:s})=>{const o=v.useMemo(()=>{if(!e)return{excluded:new Set,reasons:new Map};const i=new Set,c=new Map;return t.forEach(u=>{const d=(n[u]??"").toLowerCase(),p=p$.some(N=>d.includes(N)),h=g$.some(N=>d.includes(N)),f=_$.some(N=>d.includes(N));if(d.includes("bool")){i.add(u),c.set(u,"Boolean dtype");return}if((h||f)&&!p){i.add(u),c.set(u,"Non-numeric dtype");return}const g=s.map(N=>N&&Object.prototype.hasOwnProperty.call(N,u)?N[u]:void 0).filter(N=>N!=null);if(!g.length){p||(i.add(u),c.set(u,"No numeric samples"));return}let w=!0,b=!1,_=!1;const x=new Set;for(const N of g){if(typeof N=="boolean"){x.add(N?"1":"0");continue}if(typeof N=="number"){if(!Number.isFinite(N)){w=!1;break}b=!0,Math.abs(N)<1e-9?x.add("0"):Math.abs(N-1)<1e-9?x.add("1"):_=!0;continue}if(typeof N=="string"){const C=N.trim();if(!C)continue;const E=C.toLowerCase();if(Kb.has(E)){x.add("1");continue}if(Yb.has(E)){x.add("0");continue}const j=Number(C);if(!Number.isNaN(j)&&Number.isFinite(j)){b=!0,Math.abs(j)<1e-9?x.add("0"):Math.abs(j-1)<1e-9?x.add("1"):_=!0;continue}w=!1;break}w=!1;break}if(!w||!b&&!p){i.add(u),c.set(u,"Non-numeric values");return}!_&&x.size>0&&Array.from(x).every(C=>C==="0"||C==="1")&&(i.add(u),c.set(u,"Binary/bool-like values"))}),{excluded:i,reasons:c}},[t,n,s,e]);return{numericExcludedColumns:o.excluded,numericExclusionReasons:o.reasons}},y$=({isImputerNode:e,imputerStrategies:t,availableColumns:n,columnMissingMap:s,previewColumns:o,previewColumnStats:i,nodeColumns:c,imputerMissingFilter:u})=>{const d=v.useMemo(()=>{if(!e)return[];const g=o.length?new Set(o.map(E=>typeof E=="string"?E.trim():"").filter(E=>E.length>0)):null,w=new Set;t.forEach(E=>{E.columns.forEach(j=>{const S=typeof j=="string"?j.trim():"";S&&w.add(S)})}),Ye(c).forEach(E=>{E&&w.add(E)});const b=E=>!g||g.size===0?!1:!g.has(E)&&!w.has(E),_=new Map,x=(E,j)=>{const S=typeof E=="string"?E.trim():"";if(!S||b(S))return;const M=_.get(S)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};j&&(typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)&&(M.missingPercentage=Math.max(0,j.missingPercentage)),j.dtype!==void 0&&(M.dtype=j.dtype),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&(M.mean=j.mean),typeof j.median=="number"&&!Number.isNaN(j.median)&&(M.median=j.median),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&(M.mode=j.mode)),_.set(S,M)};n.forEach(E=>{const j=Object.prototype.hasOwnProperty.call(s,E)?s[E]:null;x(E,{missingPercentage:typeof j=="number"?j:null})}),(Array.isArray(i)?i:[]).forEach(E=>{!E||!E.name||x(E.name,{missingPercentage:typeof E.missing_percentage=="number"?E.missing_percentage:null,dtype:E.dtype??null,mean:typeof E.mean=="number"?E.mean:null,median:typeof E.median=="number"?E.median:null,mode:E.mode??null})}),Ye(c).forEach(E=>x(E)),t.forEach(E=>{E.columns.forEach(j=>x(j))});const C=Array.from(_.entries()).map(([E,j])=>({name:E,missingPercentage:typeof j.missingPercentage=="number"&&!Number.isNaN(j.missingPercentage)?Math.max(0,j.missingPercentage):null,dtype:j.dtype??null,mean:typeof j.mean=="number"&&!Number.isNaN(j.mean)?j.mean:null,median:typeof j.median=="number"&&!Number.isNaN(j.median)?j.median:null,mode:j.mode!==void 0&&j.mode!==null&&j.mode!==""?j.mode:null}));return C.sort((E,j)=>{const S=typeof E.missingPercentage=="number",M=typeof j.missingPercentage=="number";return S&&M&&E.missingPercentage!==j.missingPercentage?j.missingPercentage-E.missingPercentage:S!==M?S?-1:1:E.name.localeCompare(j.name)}),C},[n,s,t,c,i,o,e]),p=v.useMemo(()=>{if(!d.length)return 100;const g=d.reduce((b,_)=>{const x=typeof _.missingPercentage=="number"?_.missingPercentage:0;return x>b?x:b},0),w=Math.ceil(g/5)*5;return Math.max(100,w||0)},[d]),h=v.useMemo(()=>d.length?d.reduce((g,w)=>{const b=typeof w.missingPercentage=="number"?w.missingPercentage:null;return b!==null?b<=0?g:b>=u?g+1:g:u===0?g+1:g},0):0,[d,u]),f=u>0;return{imputerColumnOptions:d,imputerMissingSliderMax:p,imputerFilteredOptionCount:h,imputerMissingFilterActive:f}},b$=({configState:e,setConfigState:t,catalogFlags:n,upstreamTargetColumn:s,nodeId:o,modelTypeOptions:i})=>{const{isFeatureTargetSplitNode:c,isTrainTestSplitNode:u,isTrainModelDraftNode:d,isHyperparameterTuningNode:p,isClassOversamplingNode:h,isClassUndersamplingNode:f}=n,g=f||h,w=d||p,b=v.useMemo(()=>{if(!c)return null;const L=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",$=Ye(e==null?void 0:e.feature_columns).map(A=>typeof A=="string"?A.trim():"").filter(A=>!!A);return{targetColumn:L,featureColumns:$}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,c]),_=v.useMemo(()=>{if(!u)return null;const L=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,$=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,A=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,R=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,W=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,z=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:L,validation_size:$,random_state:A,shuffle:R,stratify:W,target_column:z}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,u]),x=v.useMemo(()=>{if(!g)return null;const L=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",$=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",A=e==null?void 0:e.sampling_strategy;let R=null;if(typeof A=="number"&&Number.isFinite(A))R=A;else if(typeof A=="string"){const q=A.trim();R=q||null}else A===null&&(R=null);const W=e==null?void 0:e.random_state;let z=null;if(typeof W=="number"&&Number.isFinite(W))z=W;else if(typeof W=="string"){const q=Number(W);z=Number.isFinite(q)?q:null}let D=null;if(f){const q=e==null?void 0:e.replacement;D=typeof q=="boolean"?q:typeof q=="string"?q.trim().toLowerCase()==="true":!!q}let H=null;if(h){const q=e==null?void 0:e.k_neighbors;if(typeof q=="number"&&Number.isFinite(q))H=Math.max(1,Math.round(q));else if(typeof q=="string"){const I=Number(q);Number.isFinite(I)&&(H=Math.max(1,Math.round(I)))}}return{method:L,targetColumn:$,samplingStrategy:R,randomState:z,replacement:D,kNeighbors:H}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,h,g,f]),N=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",C=N==="regression"?"regression":"classification",E=v.useMemo(()=>Array.isArray(i)?i.filter(L=>L&&typeof L.value=="string"):[],[i]),j=v.useMemo(()=>{const L={classification:[],regression:[]};return E.forEach($=>{var R;const A=String(((R=$==null?void 0:$.metadata)==null?void 0:R.problem_type)??"").trim().toLowerCase();A==="regression"?L.regression.push($):A==="classification"?L.classification.push($):(L.classification.push($),L.regression.push($))}),L},[E]),S=v.useMemo(()=>{if(!E.length)return[];const L=C==="regression"?j.regression:j.classification;return L.length>0?L:E},[E,j,C]),M=v.useMemo(()=>w?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:C}:null,[e==null?void 0:e.target_column,w,C]),T=v.useMemo(()=>{if(!w)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const L=(e==null?void 0:e.cv_enabled)===void 0?!!p:!!e.cv_enabled,$=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",A=["auto","kfold","stratified_kfold"].includes($)?$:"auto",R=Number(e==null?void 0:e.cv_folds),W=Number.isFinite(R)&&R>=2?Math.floor(R):5,z=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let D=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))D=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const I=Number(e.cv_random_state.trim());D=Number.isFinite(I)?Math.trunc(I):null}const q=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:L,strategy:A,folds:W,shuffle:z,randomState:D,refitStrategy:q}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,p,w]);v.useEffect(()=>{w&&N!==C&&t(L=>({...L,problem_type:C}))},[w,C,N,t]),v.useEffect(()=>{var R;if(!w||!S.length)return;const L=new Set(S.map(W=>W.value)),$=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if($&&L.has($))return;const A=((R=S[0])==null?void 0:R.value)??"";A&&t(W=>{const z=typeof(W==null?void 0:W.model_type)=="string"?W.model_type.trim():"";return z&&L.has(z)||z===A?W:{...W,model_type:A}})},[e==null?void 0:e.model_type,S,w,t]);const P=v.useMemo(()=>{if(!w)return null;const L=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",$=e==null?void 0:e.hyperparameters;let A=null,R=null;if($&&typeof $=="string"){const W=$.trim();if(W.length)try{const z=JSON.parse(W);z&&typeof z=="object"&&!Array.isArray(z)?A=z:R="Hyperparameters JSON must be an object."}catch{R="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else $&&typeof $=="object"&&!Array.isArray($)&&(A=$);return{modelType:L||null,hyperparameters:A,hyperparametersError:R}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,w]);return v.useEffect(()=>{(u||d||p)&&s&&(u&&(e==null?void 0:e.stratify)!==!0||t(L=>(typeof(L==null?void 0:L.target_column)=="string"?L.target_column.trim():"")?L:{...L,target_column:s}))},[e==null?void 0:e.stratify,p,d,u,o,t,s]),{featureTargetSplitConfig:b,trainTestSplitConfig:_,resamplingConfig:x,trainModelDraftConfig:M,trainModelRuntimeConfig:P,trainModelCVConfig:T,filteredModelTypeOptions:S}},x$=["int","float","double","numeric","number"],px=e=>{if(!e)return!1;const t=e.toLowerCase();return x$.some(n=>t.includes(n))},w$=({skewnessData:e,shouldLoadInsights:t,skewnessTransformations:n,availableColumns:s,previewColumns:o,columnTypeMap:i,updateSkewnessTransformations:c})=>{const[u,d]=v.useState("recommended"),[p,h]=v.useState(!1),[f,g]=v.useState("before"),w=n.length,b=v.useMemo(()=>e!=null&&e.methods?[...e.methods]:[],[e==null?void 0:e.methods]),_=v.useMemo(()=>pM(b),[b]),x=v.useMemo(()=>e!=null&&e.columns?[...e.columns]:[],[e==null?void 0:e.columns]),N=v.useMemo(()=>{const q=new Map;return x.forEach(I=>{I&&I.column&&q.set(I.column,I)}),q},[x]),C=v.useMemo(()=>{const q=new Set;return x.forEach(I=>{I!=null&&I.column&&q.add(I.column)}),s.forEach(I=>{I&&px(i[I]??null)&&q.add(I)}),o.forEach(I=>{const Q=typeof I=="string"?I.trim():"";Q&&px(i[Q]??null)&&q.add(Q)}),Array.from(q).sort((I,Q)=>I.localeCompare(Q))},[s,o,x,i]);v.useEffect(()=>{u==="recommended"&&x.length===0&&C.length>0&&d("all")},[C.length,x.length,u]);const E=(e==null?void 0:e.skewness_threshold)??null,j=v.useCallback(q=>_[q]??q,[_]),S=v.useCallback((q,I)=>{const Q=N.get(q);return!Q||!Q.method_status?{status:"ready",reason:void 0}:Q.method_status[I]??{status:"ready",reason:void 0}},[N]),M=v.useCallback(()=>{const q=x.map(I=>{if(!I||!I.column)return null;const Q=Array.isArray(I.recommended_methods)?I.recommended_methods.find(Vr):void 0;return Q?{column:I.column,method:Q}:null}).filter(I=>!!I);q.length&&c(I=>{const Q=new Map;return I.forEach(U=>{const F=typeof U.column=="string"?U.column.trim():"";F&&Vr(U.method)&&Q.set(F,U.method)}),q.forEach(U=>{const F=typeof U.column=="string"?U.column.trim():"";F&&Q.set(F,U.method)}),Array.from(Q.entries()).map(([U,F])=>({column:U,method:F}))})},[x,c]),T=v.useMemo(()=>{const q=new Map;return n.forEach(I=>{const Q=typeof I.column=="string"?I.column.trim():"";!Q||q.has(Q)||q.set(Q,I.method)}),q},[n]),P=v.useCallback((q,I)=>{const Q=typeof q=="string"?q.trim():"";Q&&c(U=>{const F=U.filter(K=>K.column!==Q);return I?[...F,{column:Q,method:I}]:F})},[c]),L=v.useCallback((q,I)=>{if(q){if(!I){P(q,null);return}Vr(I)&&P(q,I)}},[P]),$=v.useCallback(()=>{c(()=>[])},[c]),A=x.length,R=v.useMemo(()=>x.some(q=>q&&typeof q.column=="string"&&Array.isArray(q.recommended_methods)&&q.recommended_methods.some(Vr)),[x]),W=C.length,z=v.useMemo(()=>gM({viewMode:u,recommendations:x,columnOptions:C,recommendationMap:N,transformationMap:T}),[u,x,C,N,T]),D=v.useMemo(()=>t?x.map(q=>{var X;if(!q||!q.column)return null;const I=q.distribution_before??q.distribution??null;if(!I||!Array.isArray(I.bin_edges)||!Array.isArray(I.counts)||I.counts.length===0||I.bin_edges.length!==I.counts.length+1)return null;let Q=q.distribution_after??null;Q&&(!Array.isArray(Q.bin_edges)||!Array.isArray(Q.counts)||Q.counts.length===0||Q.bin_edges.length!==Q.counts.length+1)&&(Q=null);const U=((X=q.recommended_methods)==null?void 0:X.find(Vr))??null,F=q.magnitude?`${q.magnitude.charAt(0).toUpperCase()}${q.magnitude.slice(1)}`:null,K=q.direction?My[q.direction]??q.direction:null,re=q.applied_method&&Vr(q.applied_method)?q.applied_method:null,Y=T.get(q.column)??null,V=re??Y??null,G=V?j(V):null;return{column:q.column,skewness:typeof q.skewness=="number"?q.skewness:null,magnitudeLabel:F,directionLabel:K,summary:q.summary??null,recommendedLabel:G?null:U?j(U):null,appliedLabel:G,distributionBefore:I,distributionAfter:Q}}).filter(q=>!!q).sort((q,I)=>{const Q=q.skewness!==null?Math.abs(q.skewness):-1/0,U=I.skewness!==null?Math.abs(I.skewness):-1/0;return Q!==U?U-Q:q.column.localeCompare(I.column)}):[],[j,t,x,T]),H=v.useMemo(()=>_M(z,p,j),[z,p,j]);return{state:{threshold:E,viewMode:u,groupByMethod:p,distributionView:f,recommendedCount:A,numericCount:W,transformationsCount:w,hasAutoRecommendations:R,rows:z,tableGroups:H,distributionCards:D},handlers:{setViewMode:d,setGroupByMethod:h,setDistributionView:g,getMethodLabel:j,getMethodStatus:S,applyRecommendations:M,handleOverrideChange:L,clearTransformations:$}}},j$={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},xs=["iqr","zscore","elliptic_envelope","winsorize","manual"],Eo={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},Iu={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},Ea={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Bu=(e,{min:t,max:n}={})=>{const s=typeof e=="number"?e:Number(e);if(!Number.isFinite(s))return null;let o=s;return typeof t=="number"&&Number.isFinite(t)&&o<t&&(o=t),typeof n=="number"&&Number.isFinite(n)&&o>n&&(o=n),o},gx=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const s=String(n??"").trim();s&&t.push(s)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,s)=>n.localeCompare(s))},N$=e=>{const t={iqr:{...Ea.iqr},zscore:{...Ea.zscore},elliptic_envelope:{...Ea.elliptic_envelope},winsorize:{...Ea.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,s])=>{const o=n.trim().toLowerCase();if(!xs.includes(o))return;const i=t[o]??{};if(!(!s||typeof s!="object"||Array.isArray(s))){if(Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Iu[o].includes(d))return;let p={};d==="threshold"?p={min:.1}:d==="multiplier"?p={min:.1}:(d==="lower_percentile"||d==="upper_percentile")&&(p={min:0,max:100});const h=Bu(u,p);h!==null&&(i[d]=h)}),o==="winsorize"){const c=Bu(i.lower_percentile,{min:0,max:100}),u=Bu(i.upper_percentile,{min:0,max:100});typeof c=="number"&&typeof u=="number"&&c>=u?(i.lower_percentile=Ea.winsorize.lower_percentile,i.upper_percentile=Ea.winsorize.upper_percentile):(typeof c=="number"&&(i.lower_percentile=c),typeof u=="number"&&(i.upper_percentile=u))}t[o]=i}}),t},C$=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,s])=>{const o=String(n??"").trim();if(!o||!s||typeof s!="object"||Array.isArray(s))return;const i={};Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Object.values(Iu).some(g=>g.includes(d)))return;let h={};d==="threshold"?h={min:.1}:d==="multiplier"?h={min:.1}:d==="contamination"?h={min:1e-4,max:.49}:(d==="lower_percentile"||d==="upper_percentile")&&(h={min:0,max:100});const f=Bu(u,h);f!==null&&(i[d]=f)}),Object.keys(i).length&&(t[o]=i)}),t},S$=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=gx(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",o=xs.includes(s)?s:"iqr",i={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([h,f])=>{const g=String(h??"").trim(),w=typeof f=="string"?f.trim().toLowerCase():"";g&&xs.includes(w)&&(i[g]=w)});const c=typeof t.auto_detect=="boolean"?t.auto_detect:!0,u=gx(t.skipped_columns),d=N$(t.method_parameters),p=C$(t.column_parameters);return{columns:n,defaultMethod:o,columnMethods:i,autoDetect:c,skippedColumns:u,methodParameters:d,columnParameters:p}},E$=e=>{const t={...Eo};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,o=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&o&&xs.includes(s)&&(t[s]=o)}),t},k$=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&xs.includes(s)&&t.set(s,n)}),t},M$=e=>xs.map(t=>({value:t,label:e[t]??Eo[t]??t})),A$=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:s,skippedColumns:o,excludedColumns:i})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p={};Array.isArray(u==null?void 0:u.method_summaries)&&u.method_summaries.forEach(E=>{const j=E==null?void 0:E.method;j&&xs.includes(j)&&(p[j]=E)});const h=u!=null&&u.recommended_method&&xs.includes(u.recommended_method)?u.recommended_method:null,f=h?n[h]??Eo[h]??h:null,g=t.columnMethods[d]??null,w=g??t.defaultMethod,b=n[w]??Eo[w]??w,_=o.has(d),x=i.has(d),N=s.has(d),C=!!(u!=null&&u.has_missing);c.push({column:d,dtype:typeof(u==null?void 0:u.dtype)=="string"?u.dtype:null,stats:(u==null?void 0:u.stats)??{},recommendedMethod:h,recommendedLabel:f,recommendedReason:typeof(u==null?void 0:u.recommended_reason)=="string"?u.recommended_reason:null,methodSummaries:p,currentOverride:g,currentMethod:w,currentMethodLabel:b,isOverrideApplied:g!==null,isSelected:N,isSkipped:_,isExcluded:x,hasMissing:C})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},O$=(e,t,n,s)=>{if(!e.length)return null;const o=e.map(i=>{const c=t[i],u=c?n[c]??Eo[c]??c:null;return u?`${i} -> ${u}`:i});return s>e.length&&o.push(""),o.join(", ")},T$=(e,t)=>{var o;const n=(o=e==null?void 0:e.parameter_help)==null?void 0:o[t];if(n)return n;const s=t.replace(/_/g," ").trim();return s.charAt(0).toUpperCase()+s.slice(1)},$$=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},P$=(e,t,n,s,o)=>{var p;const i=n[s]??{};if(Object.prototype.hasOwnProperty.call(i,t)){const h=i[t];if(typeof h=="number"&&Number.isFinite(h))return{value:h,fallback:null}}const u=(o[e]??{})[t];return typeof u=="number"&&Number.isFinite(u)?{value:"",fallback:u}:{value:"",fallback:((p=Ea[e])==null?void 0:p[t])??null??null}},_x=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",vx={lower_percentile:"%",upper_percentile:"%"},L$=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:s,outlierMethodOptions:o,outlierMethodDetailMap:i,outlierDefaultDetail:c,outlierAutoDetectEnabled:u,outlierSelectedCount:d,outlierDefaultLabel:p,outlierOverrideCount:h,outlierParameterOverrideCount:f,outlierOverrideExampleSummary:g,outlierHasOverrides:w,outlierRecommendationRows:b,outlierHasRecommendations:_,outlierStatusMessage:x,outlierError:N,outlierSampleSize:C,relativeOutlierGeneratedAt:E,outlierPreviewSignal:j,formatMetricValue:S,formatNumericStat:M,onApplyAllRecommendations:T,onClearOverrides:P,onDefaultMethodChange:L,onAutoDetectToggle:$,onOverrideSelect:A,onMethodParameterChange:R,onColumnParameterChange:W})=>{const z=$$(j);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:T,disabled:!_,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:P,disabled:!w,children:"Clear overrides"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),E&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",E,C!==null?` on ${S(C)} row${C===1?"":"s"}.`:"."]}),!E&&C!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",S(C)," row",C===1?"":"s","."]}),z&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",z]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:o.map(D=>{const H=i.get(D.value)??null,q=D.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${q?" canvas-scaling__method-button--active":""}`,"aria-pressed":q,onClick:()=>L(D.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:D.label}),(H==null?void 0:H.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:H.description})]},D.value)})}),(c==null?void 0:c.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:c.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:D=>$(D.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]})]}),a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for each strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:xs.map(D=>{const H=i.get(D)??null,q=Iu[D];if(!q.length)return null;const I=(H==null?void 0:H.label)??Eo[D]??D;return a.jsxs("article",{className:"canvas-outlier__method-card",children:[a.jsxs("header",{className:"canvas-outlier__method-header",children:[a.jsx("span",{className:"canvas-outlier__method-title",children:I}),(H==null?void 0:H.description)&&a.jsx("p",{className:"canvas-outlier__method-summary",children:H.description})]}),a.jsx("div",{className:"canvas-outlier__parameter-list",children:q.map(Q=>{var K,re;const U=((K=s.methodParameters[D])==null?void 0:K[Q])??null,F=vx[Q]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:T$(H,Q)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx("input",{type:"number",className:"canvas-outlier__method-input-field",value:typeof U=="number"&&Number.isFinite(U)?U:"",placeholder:_x(((re=Ea[D])==null?void 0:re[Q])??null),onChange:Y=>{const V=Y.target.value;if(V==="")R(D,Q,null);else{const G=Number(V);R(D,Q,Number.isFinite(G)?G:null)}}}),F&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:F})]})]},`${D}-${Q}`)})})]},`outlier-method-${D}`)})})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s","  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",(()=>{if(!(h+f))return"  No overrides yet";const H=[];return h>0&&H.push(g?`${h} method override${h===1?"":"s"} (${g})`:`${h} method override${h===1?"":"s"}`),f>0&&H.push(`${f} parameter override${f===1?"":"s"}`),`  Overrides: ${H.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&N&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:N}),!n&&!N&&a.jsxs(a.Fragment,{children:[x&&a.jsx("p",{className:"canvas-modal__note",children:x}),b.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:b.map(D=>{const H=!D.isSkipped&&!D.isExcluded&&D.recommendedMethod&&D.recommendedMethod!==D.currentMethod,q=["canvas-cast__row"];H&&q.push("canvas-cast__row--attention"),D.isOverrideApplied&&q.push("canvas-cast__row--override"),D.isSkipped&&q.push("canvas-cast__row--muted");const I=D.isSkipped?"__skip__":D.isOverrideApplied?D.currentMethod:"__default__",Q=D.isOverrideApplied?`Override -> ${D.currentMethodLabel}`:D.isSkipped?"Skipped (column will not be altered)":D.isSelected?`Inheriting ${p}`:"Pending inclusion",U=D.stats,F=[];typeof U.valid_count=="number"&&Number.isFinite(U.valid_count)&&F.push(`${S(U.valid_count)} valid rows`);const K=typeof U.minimum=="number"&&Number.isFinite(U.minimum),re=typeof U.maximum=="number"&&Number.isFinite(U.maximum);if(K||re){const J=K?M(U.minimum):"",te=re?M(U.maximum):"";F.push(`Range ${J}  ${te}`)}typeof U.mean=="number"&&Number.isFinite(U.mean)&&F.push(`Mean ${M(U.mean)}`),typeof U.median=="number"&&Number.isFinite(U.median)&&F.push(`Median ${M(U.median)}`),typeof U.stddev=="number"&&Number.isFinite(U.stddev)&&F.push(` ${M(U.stddev)}`);const Y=F.length?F.join("  "):null,V=!D.recommendedMethod||!D.recommendedLabel?D.recommendedReason||"No outlier risk detected":D.recommendedReason?`${D.recommendedLabel}  ${D.recommendedReason}`:D.recommendedLabel,G=s.columnParameters,X=s.methodParameters,se=Iu[D.currentMethod]??[];return a.jsxs("tr",{className:q.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:D.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[D.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",D.dtype]}),D.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),D.isSelected&&!D.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),D.isSkipped&&!D.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),D.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),D.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[D.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${H?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:D.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),V&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:V})]})}),a.jsx("td",{children:Y?a.jsx("span",{children:Y}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:I,onChange:J=>A(D.column,J.target.value),disabled:D.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),o.map(J=>a.jsx("option",{value:J.value,children:J.label},`${D.column}-${J.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:Q}),se.length>0&&!D.isExcluded&&a.jsx("div",{className:"canvas-outlier__parameters",children:se.map(J=>{const{value:te,fallback:Se}=P$(D.currentMethod,J,G,D.column,X),ze=vx[J]??"";return a.jsxs("label",{children:[a.jsx("span",{children:J.replace(/_/g," ")}),a.jsx("input",{type:"number",value:te,placeholder:_x(Se),onChange:Oe=>{const Ue=Oe.target.value;if(Ue==="")W(D.column,J,null);else{const nt=Number(Ue);W(D.column,J,Number.isFinite(nt)?nt:null)}}}),ze&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:ze})]},`${D.column}-${D.currentMethod}-${J}`)})})]})})]},`outlier-row-${D.column}`)})})]})})})]})]})},z$=e=>{const t=v.useMemo(()=>{var o,i,c,u,d,p;const s=[];return(o=e==null?void 0:e.data)!=null&&o.label&&s.push({label:"Label",value:String(e.data.label)}),(i=e==null?void 0:e.data)!=null&&i.description&&s.push({label:"Description",value:String(e.data.description)}),(c=e==null?void 0:e.data)!=null&&c.category&&s.push({label:"Category",value:String(e.data.category)}),(u=e==null?void 0:e.data)!=null&&u.catalogType&&s.push({label:"Node type",value:String(e.data.catalogType)}),(d=e==null?void 0:e.data)!=null&&d.inputs&&Array.isArray(e.data.inputs)&&e.data.inputs.length&&s.push({label:"Inputs",value:e.data.inputs.join(", ")}),(p=e==null?void 0:e.data)!=null&&p.outputs&&Array.isArray(e.data.outputs)&&e.data.outputs.length&&s.push({label:"Outputs",value:e.data.outputs.join(", ")}),s},[e]),n=v.useMemo(()=>{var o;const s=((o=e==null?void 0:e.data)==null?void 0:o.label)??(e==null?void 0:e.id);return typeof s=="string"&&s.trim()?s:`Node ${(e==null?void 0:e.id)??""}`},[e]);return{metadata:t,title:n}},R$=({connectionInfo:e,connectedInputHandles:t,connectedOutputHandles:n,connectionReady:s})=>e?a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:s?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",children:[a.jsx("strong",{children:s?"Ready to execute.":"Missing required connections."})," ",s?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]}),e.inputs&&e.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:e.inputs.map(o=>{const i=t.has(o.key),c=o.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:o.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":c?"Missing":"Optional"})]},`inputs-${o.key}`)})})]}),e.outputs&&e.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:e.outputs.map(o=>{const i=n.has(o.key),c=o.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:o.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:i?"Connected":c?"Unlinked":"Optional"})]},`outputs-${o.key}`)})})]})]}):null,yx=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},D$=(e,t)=>{var w;const n=typeof(e==null?void 0:e.id)=="string"?e.id:"",s=v.useMemo(()=>{var x;const b=(x=e==null?void 0:e.data)==null?void 0:x.connectionInfo;if(!b)return null;const _=N=>Array.isArray(N)?N.map(C=>({...C})):[];return{inputs:_(b.inputs),outputs:_(b.outputs)}},[e]),o=v.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const b=t.edges.filter(_=>(_==null?void 0:_.target)===n).map(_=>yx(n,_==null?void 0:_.targetHandle)).filter(_=>!!_);return new Set(b)},[t,n]),i=v.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const b=t.edges.filter(_=>(_==null?void 0:_.source)===n).map(_=>yx(n,_==null?void 0:_.sourceHandle)).filter(_=>!!_);return new Set(b)},[t,n]),c=((w=e==null?void 0:e.data)==null?void 0:w.hasRequiredConnections)!==!1,u=v.useMemo(()=>{var b;return(b=s==null?void 0:s.inputs)!=null&&b.length?s.inputs.filter(_=>_.required!==!1):[]},[s==null?void 0:s.inputs]),d=v.useMemo(()=>u.length?u.filter(b=>!o.has(b.key)):[],[o,u]),p=c&&d.length===0,h=v.useMemo(()=>{if(!p)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[p]),f=p?void 0:!0,g=v.useMemo(()=>{if(!(s!=null&&s.inputs)||s.inputs.length===0)return;let b=!1;const _={};return s.inputs.forEach(x=>{if(!Array.isArray(x.accepts)||x.accepts.length===0)return;const N=o.has(x.key);x.accepts.forEach(C=>{(C==="train"||C==="validation"||C==="test")&&(_[C]=N,b=!0)})}),b?_:void 0},[s==null?void 0:s.inputs,o]);return{connectionInfo:s,connectedHandleKeys:o,connectedOutputHandleKeys:i,evaluationSplitConnectivity:g,connectionReady:p,gatedSectionStyle:h,gatedAriaDisabled:f}},F$=(e,t)=>{const{isBinningNode:n,isCastNode:s,isDropMissingColumnsNode:o,isDropMissingRowsNode:i,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:p,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:f,isRegexCleanupNode:g,isNormalizeTextCaseNode:w,isStandardizeDatesNode:b,isScalingNode:_,isClassUndersamplingNode:x,isClassOversamplingNode:N,isTrainModelDraftNode:C,isLabelEncodingNode:E,isOrdinalEncodingNode:j,isDummyEncodingNode:S,isOneHotEncodingNode:M,isRemoveDuplicatesNode:T,isSkewnessNode:P,isFeatureTargetSplitNode:L}=t;return v.useMemo(()=>{let $=e;return $=$.filter(A=>{var R;return((R=A==null?void 0:A.source)==null?void 0:R.type)!=="drop_column_recommendations"}),(o||i)&&($=$.filter(A=>A.name!=="missing_threshold")),i&&($=$.filter(A=>A.name!=="drop_if_any_missing")),c&&($=$.filter(A=>A.name!=="strategies")),P&&($=$.filter(A=>A.name!=="transformations")),s&&($=$.filter(A=>A.name!=="columns")),n&&($=$.filter(A=>A.name!=="columns")),_&&($=$.filter(A=>!["columns","default_method","auto_detect"].includes(A.name))),T&&($=$.filter(A=>A.name!=="columns"&&A.name!=="keep")),u&&($=$.filter(A=>A.name!=="columns"&&A.name!=="flag_suffix")),d&&($=$.filter(A=>!["columns","mode","custom_pairs"].includes(A.name))),p&&($=$.filter(A=>!["columns","mode"].includes(A.name))),h&&($=$.filter(A=>!["columns","mode","replacement"].includes(A.name))),f&&($=$.filter(A=>!["columns","mode","min_value","max_value"].includes(A.name))),g&&($=$.filter(A=>!["columns","mode","pattern","replacement"].includes(A.name))),w&&($=$.filter(A=>!["columns","mode"].includes(A.name))),b&&($=$.filter(A=>!["columns","mode"].includes(A.name))),x&&($=$.filter(A=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(A.name))),N&&($=$.filter(A=>!["method","target_column","sampling_strategy","random_state"].includes(A.name))),C&&($=$.filter(A=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(A.name))),L&&($=$.filter(A=>A.name!=="target_column")),E&&($=$.filter(A=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(A.name))),j&&($=$.filter(A=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(A.name))),S&&($=$.filter(A=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(A.name))),M&&($=$.filter(A=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(A.name))),$},[e,n,s,o,i,c,u,d,p,h,f,g,w,b,_,x,N,C,E,j,S,M,T,P,L])},I$=({node:e})=>{var f;const t=typeof(e==null?void 0:e.id)=="string"?e.id:void 0,n=v.useMemo(()=>{var w;const g=$h(((w=e==null?void 0:e.data)==null?void 0:w.config)??{});return!g||typeof g!="object"||Array.isArray(g)?{}:((!g.column_overrides||typeof g.column_overrides!="object"||Array.isArray(g.column_overrides))&&(g.column_overrides={}),g)},[e==null?void 0:e.id,(f=e==null?void 0:e.data)==null?void 0:f.config]),[s,o]=v.useState(n),[i,c]=v.useState(0),u=v.useRef(t);v.useEffect(()=>{u.current!==t&&(u.current=t,o(n),c(g=>g+1))},[t]);const d=v.useMemo(()=>Hi(n),[n]),p=v.useMemo(()=>Hi(s),[s]),h=v.useCallback(()=>{o(n)},[n]);return{initialConfig:n,configState:s,setConfigState:o,stableInitialConfig:d,stableCurrentConfig:p,nodeChangeVersion:i,resetToInitialConfig:h}},B$=({setConfigState:e})=>{const t=v.useCallback((c,u)=>{c&&e(d=>{const p={...d};return u===void 0?delete p[c]:p[c]=u,p})},[e]),n=v.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);Number.isNaN(d)||t(c,d)},[t]),s=v.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);if(!Number.isFinite(d))return;const p=Math.min(Math.max(d,0),100);t(c,p)},[t]),o=v.useCallback((c,u)=>{t(c,u)},[t]),i=v.useCallback((c,u)=>{t(c,u)},[t]);return{handleParameterChange:t,handleNumberChange:n,handlePercentileChange:s,handleBooleanChange:o,handleTextChange:i}},Vh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},U$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Wh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],q$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=U$(t.status),o=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Wh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:s,reason:o,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g}}).filter(t=>!!t),H$=e=>{if(!e||typeof e!="object")return{...Vh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,o=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,c=Wh(e.high_cardinality_columns),u=Wh(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:o,autoDetectDefault:i,highCardinalityColumns:c,notes:u}},V$=({isLabelEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Vh}),[w,b]=v.useState(0);v.useEffect(()=>{let C=!0;const E=j=>{h([]),g({...Vh}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Gv(t,{graph:s??null,targetNodeId:o??null}).then(j=>{C&&(h(q$(j)),g(H$(j)))}).catch(j=>{if(!C)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load label encoding suggestions";E(S)}).finally(()=>{C&&c(!1)}),()=>{C=!1}):(E("Connect this node to the dataset input to load suggestions."),()=>{C=!1}):(E(),()=>{C=!1}):(E(),()=>{C=!1})},[s,n,e,w,t,o]);const _=v.useCallback(()=>{!e||!t||!n||b(C=>C+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:_}},Kh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},W$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Yh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],K$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=W$(t.status),o=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Yh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:o,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_use_global_fallback:w}}).filter(t=>!!t),Y$=e=>{if(!e||typeof e!="object")return{...Kh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,o=Number(e.recommended_count??0)||0,i=!!e.enable_global_fallback_default,c=Yh(e.high_cardinality_columns),u=Yh(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:o,autoDetectDefault:d,enableGlobalFallbackDefault:i,highCardinalityColumns:c,notes:u}},G$=({isTargetEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Kh}),[w,b]=v.useState(0);v.useEffect(()=>{let C=!0;const E=j=>{h([]),g({...Kh}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Xv(t,{graph:s??null,targetNodeId:o??null}).then(j=>{C&&(h(K$(j)),g(Y$(j)))}).catch(j=>{if(!C)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load target encoding suggestions";E(S)}).finally(()=>{C&&c(!1)}),()=>{C=!1}):(E("Connect this node to the dataset input to load suggestions."),()=>{C=!1}):(E(),()=>{C=!1}):(E(),()=>{C=!1})},[s,n,e,w,t,o]);const _=v.useCallback(()=>{!e||!t||!n||b(C=>C+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:_}},Uu={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},Q$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Gh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],X$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=Q$(t.status),o=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Gh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:s,reason:o,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_bucket_count:w}}).filter(t=>!!t),J$=e=>{if(!e||typeof e!="object")return{...Uu};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,o=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,c=Number(e.suggested_bucket_default??0)||0,u=Gh(e.high_cardinality_columns),d=Gh(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:o,autoDetectDefault:i,suggestedBucketDefault:c,highCardinalityColumns:u,notes:d}},Z$=({isHashEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Uu}),[w,b]=v.useState(0),_=v.useCallback(C=>{h([]),g({...Uu}),c(!1),d(C??null)},[]);v.useEffect(()=>{let C=!0;return e?t?n?(c(!0),d(null),Jv(t,{graph:s??null,targetNodeId:o??null}).then(E=>{C&&(h(X$(E)),g(J$(E)))}).catch(E=>{C&&(h([]),g({...Uu}),d(E!=null&&E.message?String(E.message):"Unable to load hash encoding suggestions"))}).finally(()=>{C&&c(!1)}),()=>{C=!1}):(_("Connect this node to the dataset input to load suggestions."),()=>{C=!1}):(_(),()=>{C=!1}):(_(),()=>{C=!1})},[s,n,e,_,t,o,w]);const x=v.useCallback(()=>{b(C=>C+1)},[]);return v.useMemo(()=>({isFetching:i,error:u,suggestions:p,metadata:f,refresh:x}),[u,i,f,x,p])},Qh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},eP=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Xh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],tP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=eP(t.status),o=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Xh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:o,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_handle_unknown:w}}).filter(t=>!!t),nP=e=>{if(!e||typeof e!="object")return{...Qh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,o=Number(e.recommended_count??0)||0,i=!!e.enable_unknown_default,c=Xh(e.high_cardinality_columns),u=Xh(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:o,autoDetectDefault:d,enableUnknownDefault:i,highCardinalityColumns:c,notes:u}},sP=({isOrdinalEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Qh}),[w,b]=v.useState(0);v.useEffect(()=>{let C=!0;const E=j=>{h([]),g({...Qh}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Qv(t,{graph:s??null,targetNodeId:o??null}).then(j=>{C&&(h(tP(j)),g(nP(j)))}).catch(j=>{if(!C)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load ordinal encoding suggestions";E(S)}).finally(()=>{C&&c(!1)}),()=>{C=!1}):(E("Connect this node to the dataset input to load suggestions."),()=>{C=!1}):(E(),()=>{C=!1}):(E(),()=>{C=!1})},[s,n,e,w,t,o]);const _=v.useCallback(()=>{!e||!t||!n||b(C=>C+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:_}},Jh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},rP=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Zh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],aP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=rP(t.status),o=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Zh(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,b=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:s,reason:o,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:w,recommended_drop_first:b}}).filter(t=>!!t),oP=e=>{if(!e||typeof e!="object")return{...Jh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,o=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,c=Zh(e.high_cardinality_columns),u=Zh(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:o,cautionedCount:i,highCardinalityColumns:c,notes:u,autoDetectDefault:d}},lP=({isDummyEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...Jh}),[w,b]=v.useState(0);v.useEffect(()=>{let C=!0;const E=j=>{h([]),g({...Jh}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),ey(t,{graph:s??null,targetNodeId:o??null}).then(j=>{C&&(h(aP(j)),g(oP(j)))}).catch(j=>{if(!C)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load dummy encoding suggestions";E(S)}).finally(()=>{C&&c(!1)}),()=>{C=!1}):(E("Connect this node to the dataset input to load suggestions."),()=>{C=!1}):(E(),()=>{C=!1}):(E(),()=>{C=!1})},[s,n,e,w,t,o]);const _=v.useCallback(()=>{!e||!t||!n||b(C=>C+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:_}},ef={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},iP=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},tf=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],cP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=iP(t.status),o=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=tf(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,w=typeof t.selectable=="boolean"?t.selectable:!0,b=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:s,reason:o,dtype:i,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:w,recommended_drop_first:b}}).filter(t=>!!t),uP=e=>{if(!e||typeof e!="object")return{...ef};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,o=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,c=tf(e.high_cardinality_columns),u=tf(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:o,cautionedCount:i,highCardinalityColumns:c,notes:u}},dP=({isOneHotEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:o})=>{const[i,c]=v.useState(!1),[u,d]=v.useState(null),[p,h]=v.useState([]),[f,g]=v.useState({...ef}),[w,b]=v.useState(0);v.useEffect(()=>{let C=!0;const E=j=>{h([]),g({...ef}),c(!1),d(j??null)};return e?t?n?(c(!0),d(null),Zv(t,{graph:s??null,targetNodeId:o??null}).then(j=>{C&&(h(cP(j)),g(uP(j)))}).catch(j=>{if(!C)return;const S=typeof(j==null?void 0:j.message)=="string"?j.message:"Unable to load one-hot encoding suggestions";E(S)}).finally(()=>{C&&c(!1)}),()=>{C=!1}):(E("Connect this node to the dataset input to load suggestions."),()=>{C=!1}):(E(),()=>{C=!1}):(E(),()=>{C=!1})},[s,n,e,w,t,o]);const _=v.useCallback(()=>{!e||!t||!n||b(C=>C+1)},[n,e,t]),x=v.useMemo(()=>f,[f]),N=v.useMemo(()=>p,[p]);return{isFetching:i,error:u,suggestions:N,metadata:x,refresh:_}},mP=({isTargetEncodingNode:e,enableGlobalFallbackDefault:t,encodeMissing:n,handleUnknown:s,setConfigState:o,nodeChangeVersion:i})=>{const c=v.useRef(!1);v.useEffect(()=>{c.current=!1},[i]),v.useEffect(()=>{if(!e||!t||c.current)return;const u=typeof n=="boolean"?n:null,d=typeof s=="string"?s.trim().toLowerCase():"";if(u===!0&&d==="global_mean"){c.current=!0;return}o(p=>{const h=typeof(p==null?void 0:p.encode_missing)=="boolean"?p.encode_missing:null,f=typeof(p==null?void 0:p.handle_unknown)=="string"?p.handle_unknown.trim().toLowerCase():"";if(h===!0&&f==="global_mean")return c.current=!0,p;const g={...p};return h!==!0&&(g.encode_missing=!0),f!=="global_mean"&&(g.handle_unknown="global_mean"),c.current=!0,g})},[n,s,e,t,o])},hP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,node:o,configState:i,setConfigState:c,nodeChangeVersion:u})=>{const{isLabelEncodingNode:d,isTargetEncodingNode:p,isHashEncodingNode:h,isOrdinalEncodingNode:f,isDummyEncodingNode:g,isOneHotEncodingNode:w}=e,b=(o==null?void 0:o.id)??null,{isFetching:_,error:x,suggestions:N,metadata:C}=V$({isLabelEncodingNode:d,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:b}),{isFetching:E,error:j,suggestions:S,metadata:M}=G$({isTargetEncodingNode:p,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:b});mP({isTargetEncodingNode:p,enableGlobalFallbackDefault:M.enableGlobalFallbackDefault,encodeMissing:i==null?void 0:i.encode_missing,handleUnknown:i==null?void 0:i.handle_unknown,setConfigState:c,nodeChangeVersion:u});const{isFetching:T,error:P,suggestions:L,metadata:$}=Z$({isHashEncodingNode:h,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:b}),{isFetching:A,error:R,suggestions:W,metadata:z}=sP({isOrdinalEncodingNode:f,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:b}),{isFetching:D,error:H,suggestions:q,metadata:I}=lP({isDummyEncodingNode:g,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:b}),{isFetching:Q,error:U,suggestions:F,metadata:K}=dP({isOneHotEncodingNode:w,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:b});v.useEffect(()=>{d&&(i!=null&&i.auto_detect)&&C.autoDetectDefault&&c(J=>({...J,columns:C.autoDetectDefault}))},[i==null?void 0:i.auto_detect,d,C.autoDetectDefault,c]),v.useEffect(()=>{p&&(i!=null&&i.auto_detect)&&M.autoDetectDefault&&c(J=>({...J,columns:M.autoDetectDefault}))},[i==null?void 0:i.auto_detect,p,c,M.autoDetectDefault]),v.useEffect(()=>{h&&(i!=null&&i.auto_detect)&&$.autoDetectDefault&&c(J=>({...J,columns:$.autoDetectDefault}))},[i==null?void 0:i.auto_detect,$.autoDetectDefault,h,c]),v.useEffect(()=>{h&&$.suggestedBucketDefault&&c(J=>({...J,n_buckets:$.suggestedBucketDefault}))},[$.suggestedBucketDefault,h,c]),v.useEffect(()=>{p&&M.enableGlobalFallbackDefault&&c(J=>{const te={};return J.encode_missing===void 0&&(te.encode_missing=!0),J.handle_unknown===void 0&&(te.handle_unknown="value"),Object.keys(te).length>0?{...J,...te}:J})},[i==null?void 0:i.encode_missing,i==null?void 0:i.handle_unknown,p,c,M.enableGlobalFallbackDefault]),v.useEffect(()=>{f&&(i!=null&&i.auto_detect)&&z.autoDetectDefault&&c(J=>({...J,columns:z.autoDetectDefault}))},[i==null?void 0:i.auto_detect,f,z.autoDetectDefault,c]),v.useEffect(()=>{f&&z.enableUnknownDefault&&c(J=>J.handle_unknown===void 0?{...J,handle_unknown:"use_encoded_value",unknown_value:-1}:J)},[i==null?void 0:i.handle_unknown,f,z.enableUnknownDefault,c]),v.useEffect(()=>{g&&(i!=null&&i.auto_detect)&&I.autoDetectDefault&&c(J=>({...J,columns:I.autoDetectDefault}))},[i==null?void 0:i.auto_detect,I.autoDetectDefault,g,c]);const re=v.useCallback(J=>{c(te=>({...te,columns:J}))},[c]),Y=v.useCallback(J=>{c(te=>({...te,columns:J}))},[c]),V=v.useCallback(J=>{c(te=>({...te,columns:J}))},[c]),G=v.useCallback(J=>{c(te=>({...te,columns:J}))},[c]),X=v.useCallback(J=>{c(te=>({...te,columns:J}))},[c]),se=v.useCallback(J=>{c(te=>({...te,columns:J}))},[c]);return{labelEncoding:{isFetching:_,error:x,suggestions:N,metadata:C,handleApplyRecommended:re},targetEncoding:{isFetching:E,error:j,suggestions:S,metadata:M,handleApplyRecommended:Y},hashEncoding:{isFetching:T,error:P,suggestions:L,metadata:$,handleApplyRecommended:V},ordinalEncoding:{isFetching:A,error:R,suggestions:W,metadata:z,handleApplyRecommended:G},dummyEncoding:{isFetching:D,error:H,suggestions:q,metadata:I,handleApplyRecommended:X},oneHotEncoding:{isFetching:Q,error:U,suggestions:F,metadata:K,handleApplyRecommended:se}}},Ws=["standard","robust","minmax","maxabs"],ko={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},bx={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},xx=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],wx=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=xx(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",o=Ws.includes(s)?s:"standard",i={},c=t.column_methods;c&&typeof c=="object"&&!Array.isArray(c)&&Object.entries(c).forEach(([p,h])=>{const f=String(p??"").trim(),g=typeof h=="string"?h.trim().toLowerCase():"";f&&Ws.includes(g)&&(i[f]=g)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=xx(t.skipped_columns);return{columns:n,defaultMethod:o,columnMethods:i,autoDetect:u,skippedColumns:d}},fP=e=>{const t={...ko};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,o=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&Ws.includes(s)&&o&&(t[s]=o)}),t},pP=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&Ws.includes(s)&&t.set(s,n)}),t},gP=e=>Ws.map(t=>({value:t,label:e[t]??ko[t]??t})),_P=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:s,scalingSkippedColumns:o,scalingExcludedColumns:i})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p=u.recommended_method,h=n[p]??ko[p]??p,f=Array.isArray(u.fallback_methods)?u.fallback_methods.filter(M=>Ws.includes(M)).map(M=>{const T=M;return n[T]??ko[T]??T}):[],g=u.confidence??"medium",w=bx[g]??bx.medium,_=t.columnMethods[d]??null,x=_??t.defaultMethod,N=n[x]??ko[x]??x,C=i.has(d),E=o.has(d),j=s.has(d),S=u.stats;c.push({column:d,dtype:u.dtype??null,recommendedMethod:p,recommendedLabel:h,confidence:g,confidenceLabel:w,reasons:Array.isArray(u.reasons)?u.reasons:[],fallbackLabels:f,stats:S,hasMissing:!!u.has_missing,currentOverride:_,currentMethod:x,currentMethodLabel:N,isOverrideApplied:_!==null,isSelected:j,isExcluded:C,isSkipped:E})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},vP=(e,t,n,s)=>{if(!e.length)return null;const o=e.map(i=>{const c=t[i],u=c?n[c]??ko[c]??c:null;return u?`${i} -> ${u}`:i});return s>e.length&&o.push(""),o.join(", ")},yP=({isScalingNode:e,configState:t,numericExcludedColumns:n,scalingData:s})=>{const o=v.useMemo(()=>wx(t),[t]),i=v.useMemo(()=>new Set(o.skippedColumns),[o.skippedColumns]),c=v.useMemo(()=>e?n:new Set,[e,n]),u=v.useMemo(()=>e?new Set(o.columns):new Set,[e,o.columns]),d=v.useMemo(()=>new Set(Object.keys(o.columnMethods)),[o.columnMethods]),p=v.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(R=>!!(R&&R.column)):[],[s==null?void 0:s.columns]),h=v.useMemo(()=>fP(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=v.useMemo(()=>pP(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=v.useMemo(()=>_P({recommendations:p,scalingConfig:o,scalingMethodLabelMap:h,scalingSelectedSet:u,scalingSkippedColumns:i,scalingExcludedColumns:c}),[p,o,h,u,i,c]),w=v.useMemo(()=>Array.from(d).sort((R,W)=>R.localeCompare(W)),[d]),b=v.useMemo(()=>w.slice(0,4),[w]),_=g.length,x=d.size,N=u.size,C=o.autoDetect,E=v.useMemo(()=>f.get(o.defaultMethod)??null,[o.defaultMethod,f]),j=v.useMemo(()=>{const R=o.defaultMethod;return h[R]??ko[R]??R},[o.defaultMethod,h]),S=_>0,M=v.useMemo(()=>g.filter(R=>!R.isSkipped&&!R.isExcluded&&R.isSelected&&R.recommendedMethod!==R.currentMethod).length,[g]),T=v.useMemo(()=>g.filter(R=>R.isSelected&&!R.isSkipped&&!R.isExcluded).length,[g]),P=v.useMemo(()=>g.filter(R=>R.isSkipped&&!R.isExcluded).length,[g]),L=v.useMemo(()=>g.length?M>0?`${M} column${M===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:T>0?"All configured columns align with the recommended scalers.":P>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[M,T,g,P]),$=v.useMemo(()=>gP(h),[h]),A=v.useMemo(()=>vP(b,o.columnMethods,h,x),[b,o.columnMethods,h,x]);return{scalingConfig:o,scalingExcludedColumns:c,scalingMethodDetailMap:f,scalingMethodOptions:$,scalingRecommendations:p,scalingRecommendationRows:g,scalingSelectedCount:N,scalingOverrideCount:x,scalingDefaultDetail:E,scalingDefaultLabel:j,scalingAutoDetectEnabled:C,scalingHasRecommendations:S,scalingStatusMessage:L,scalingOverrideExampleSummary:A}},bP=({isOutlierNode:e,configState:t,numericExcludedColumns:n,outlierData:s})=>{const o=v.useMemo(()=>S$(t),[t]),i=v.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(R=>!!(R&&R.column)):[],[s==null?void 0:s.columns]),c=v.useMemo(()=>new Set(o.skippedColumns),[o.skippedColumns]),u=v.useMemo(()=>e?new Set(o.columns):new Set,[e,o.columns]),d=v.useMemo(()=>{if(!e||!n.size)return new Set;const R=new Set;o.columns.forEach(z=>{const D=String(z??"").trim();D&&R.add(D)}),i.forEach(z=>{const D=String((z==null?void 0:z.column)??"").trim();D&&R.add(D)});const W=new Set;return n.forEach(z=>{R.has(z)||W.add(z)}),W},[e,n,o.columns,i]),p=v.useMemo(()=>new Set(Object.keys(o.columnMethods)),[o.columnMethods]),h=v.useMemo(()=>E$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=v.useMemo(()=>k$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=v.useMemo(()=>A$({insights:i,outlierConfig:o,labelMap:h,selectedColumns:u,skippedColumns:c,excludedColumns:d}),[i,o,h,u,c,d]),w=v.useMemo(()=>M$(h),[h]),b=v.useMemo(()=>Array.from(p).sort((R,W)=>R.localeCompare(W)),[p]),_=v.useMemo(()=>b.slice(0,4),[b]),x=u.size,N=p.size,C=v.useMemo(()=>Object.keys(o.columnParameters).length,[o.columnParameters]),E=o.autoDetect,j=v.useMemo(()=>f.get(o.defaultMethod)??null,[o.defaultMethod,f]),S=v.useMemo(()=>{const R=o.defaultMethod;return h[R]??Eo[R]??R},[o.defaultMethod,h]),M=g.length>0,T=v.useMemo(()=>g.filter(R=>R.isSkipped||R.isExcluded||!R.isSelected||!R.recommendedMethod?!1:R.recommendedMethod!==R.currentMethod).length,[g]),P=v.useMemo(()=>g.filter(R=>R.isSelected&&!R.isSkipped&&!R.isExcluded).length,[g]),L=v.useMemo(()=>g.filter(R=>R.isSkipped&&!R.isExcluded).length,[g]),$=v.useMemo(()=>g.length?T>0?`${T} column${T===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:P>0?"All configured columns align with the recommended outlier handling strategies.":L>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[T,P,g,L]),A=v.useMemo(()=>O$(_,o.columnMethods,h,N),[_,o.columnMethods,h,N]);return{outlierConfig:o,outlierExcludedColumns:d,outlierMethodLabelMap:h,outlierMethodDetailMap:f,outlierMethodOptions:w,outlierRecommendations:i,outlierRecommendationRows:g,outlierSelectedCount:x,outlierOverrideCount:N,outlierParameterOverrideCount:C,outlierDefaultDetail:j,outlierDefaultLabel:S,outlierAutoDetectEnabled:E,outlierHasRecommendations:M,outlierStatusMessage:$,outlierOverrideExampleSummary:A}},xP=({configState:e,nodeId:t})=>{const n=v.useMemo(()=>jy(e),[e]),s=n.columns.length,o=vh[n.strategy]??n.strategy,i=v.useMemo(()=>Object.keys(n.columnStrategies).map(b=>b.trim()).filter(Boolean).sort((b,_)=>b.localeCompare(_)),[n.columnStrategies]),c=i.length,u=v.useMemo(()=>{if(!i.length)return null;const b=i.slice(0,4);return Qk(b,n.columnStrategies,c)},[n.columnStrategies,i,c]),d=v.useMemo(()=>`binning-${t||"node"}`,[t]),p=v.useMemo(()=>({equalWidth:`${d}-equal-width-bins`,equalFrequency:`${d}-equal-frequency-bins`,precision:`${d}-precision`,suffix:`${d}-suffix`,missingLabel:`${d}-missing-label`,includeLowest:`${d}-include-lowest`,dropOriginal:`${d}-drop-original`,labelFormat:`${d}-label-format`,duplicates:`${d}-duplicates`,kbinsNBins:`${d}-kbins-n-bins`,kbinsEncode:`${d}-kbins-encode`,kbinsStrategy:`${d}-kbins-strategy`}),[d]),[h,f]=v.useState({}),[g,w]=v.useState({});return v.useEffect(()=>{f(b=>{const _=new Set,x={...b};return n.columns.forEach(N=>{const C=String(N??"").trim();if(!C||(_.add(C),Object.prototype.hasOwnProperty.call(x,C)))return;const E=n.customBins[C]??[];x[C]=E.length>=2?E.join(", "):""}),Object.keys(x).forEach(N=>{_.has(N)||delete x[N]}),x})},[n.columns,n.customBins]),v.useEffect(()=>{w(b=>{const _=new Set,x={...b};return n.columns.forEach(N=>{const C=String(N??"").trim();if(!C||(_.add(C),Object.prototype.hasOwnProperty.call(x,C)))return;const E=n.customLabels[C]??[];x[C]=E.length>0?E.join(", "):""}),Object.keys(x).forEach(N=>{_.has(N)||delete x[N]}),x})},[n.columns,n.customLabels]),{binningConfig:n,binningSelectedCount:s,binningDefaultLabel:o,binningOverrideColumns:i,binningOverrideCount:c,binningOverrideSummary:u,fieldIds:p,customEdgeDrafts:h,setCustomEdgeDrafts:f,customLabelDrafts:g,setCustomLabelDrafts:w}},wP=({setConfigState:e,setBinningCustomEdgeDrafts:t,setBinningCustomLabelDrafts:n,binningConfig:s,binningInsightsRecommendations:o,binningAllNumericColumns:i})=>{const c=v.useCallback((L,$,A,R)=>{e(W=>{const z=typeof(W==null?void 0:W[L])=="number"&&Number.isFinite(W[L])?W[L]:void 0;if($===""){if(z===void 0)return W;const q={...W};return delete q[L],q}const D=Number($);if(!Number.isFinite(D))return W;const H=Math.min(Math.max(Math.round(D),A),R);return z===H?W:{...W,[L]:H}})},[e]),u=v.useCallback((L,$)=>{e(A=>!!(A!=null&&A[L])===$?A:{...A,[L]:$})},[e]),d=v.useCallback(L=>{const $=L.trim();e(A=>{const R=typeof(A==null?void 0:A.output_suffix)=="string"?A.output_suffix:"";if(!$){if(!R)return A;const W={...A};return delete W.output_suffix,W}return R===$?A:{...A,output_suffix:$}})},[e]),p=v.useCallback(L=>{e($=>{const A=typeof($==null?void 0:$.label_format)=="string"?$.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(A)?A:"range")===L?$:{...$,label_format:L}})},[e]),h=v.useCallback(L=>{e($=>{if((($==null?void 0:$.missing_strategy)==="label"?"label":"keep")===L)return $;const R={...$,missing_strategy:L};return L!=="label"&&Object.prototype.hasOwnProperty.call(R,"missing_label")&&delete R.missing_label,R})},[e]),f=v.useCallback(L=>{const $=L.trim();e(A=>{const R=typeof(A==null?void 0:A.missing_label)=="string"?A.missing_label:"";if(!$){if(!R)return A;const W={...A};return delete W.missing_label,W}return R===$?A:{...A,missing_label:$}})},[e]),g=v.useCallback((L,$)=>{const A=String(L??"").trim();A&&(t(R=>({...R,[A]:$})),e(R=>{const W=R==null?void 0:R.custom_bins,z=W&&typeof W=="object"&&!Array.isArray(W)?W:{},D=Array.isArray(z[A])?z[A]:void 0,q=$.split(/[,\n]/).map(F=>F.trim()).filter(Boolean).map(F=>Number(F)).filter(F=>Number.isFinite(F)).sort((F,K)=>F-K).filter((F,K,re)=>K===0||F!==re[K-1]),I=q.length>=2;if(I&&D&&D.length===q.length&&D.every((F,K)=>F===q[K])||!I&&!D)return R;const Q={...R},U={...z};return I?U[A]=q:delete U[A],Object.keys(U).length>0?Q.custom_bins=U:delete Q.custom_bins,Q}))},[t,e]),w=v.useCallback((L,$)=>{const A=String(L??"").trim();A&&(n(R=>({...R,[A]:$})),e(R=>{const W=R==null?void 0:R.custom_labels,z=W&&typeof W=="object"&&!Array.isArray(W)?W:{},D=Array.isArray(z[A])?z[A]:void 0,H=$.split(/[,\n]/).map(Q=>Q.trim()).filter(Boolean);if(H.length>0&&D&&D.length===H.length&&D.every((Q,U)=>Q===H[U])||H.length===0&&!D)return R;const q={...R},I={...z};return H.length>0?I[A]=H:delete I[A],Object.keys(I).length>0?q.custom_labels=I:delete q.custom_labels,q}))},[n,e]),b=v.useCallback(L=>{const $=String(L??"").trim();$&&(t(A=>{if(!Object.prototype.hasOwnProperty.call(A,$))return A;const R={...A};return delete R[$],R}),n(A=>{if(!Object.prototype.hasOwnProperty.call(A,$))return A;const R={...A};return delete R[$],R}),e(A=>{let R=!1;const W={...A};if(A!=null&&A.custom_bins&&typeof A.custom_bins=="object"&&!Array.isArray(A.custom_bins)&&Object.prototype.hasOwnProperty.call(A.custom_bins,$)){const z={...A.custom_bins};delete z[$],Object.keys(z).length>0?W.custom_bins=z:delete W.custom_bins,R=!0}if(A!=null&&A.custom_labels&&typeof A.custom_labels=="object"&&!Array.isArray(A.custom_labels)&&Object.prototype.hasOwnProperty.call(A.custom_labels,$)){const z={...A.custom_labels};delete z[$],Object.keys(z).length>0?W.custom_labels=z:delete W.custom_labels,R=!0}return R?W:A}))},[t,n,e]),_=v.useCallback((L,$)=>{const A=String(L??"").trim();A&&e(R=>{const z={...R!=null&&R.column_strategies&&typeof R.column_strategies=="object"&&!Array.isArray(R.column_strategies)?R.column_strategies:R!=null&&R.column_overrides&&typeof R.column_overrides=="object"&&!Array.isArray(R.column_overrides)?R.column_overrides:{}},D=z[A],H=D&&typeof D=="object"&&!Array.isArray(D)?{...D}:{},q=$(H),I=!!(q&&Object.keys(q).length);I?z[A]=q:delete z[A];const Q={...R};if(I){const U=new Set(Ye(R==null?void 0:R.columns));U.has(A)||(U.add(A),Q.columns=Array.from(U).sort((F,K)=>F.localeCompare(K)))}return Object.keys(z).length?(Q.column_overrides=z,Q.column_strategies=z):(Object.prototype.hasOwnProperty.call(Q,"column_overrides")&&delete Q.column_overrides,Object.prototype.hasOwnProperty.call(Q,"column_strategies")&&delete Q.column_strategies),Q})},[e]),x=v.useCallback((L,$,A)=>{const R=String(L??"").trim();if(!R)return;if($==="__default__"){b(R),_(R,()=>null);return}const W=Number.isFinite(A==null?void 0:A.recommendedBins)?Math.round(A.recommendedBins):null;_(R,z=>{const D={...z};D.strategy=$;const H=q=>Math.min(200,Math.max(2,Math.round(W??q)));return $==="equal_width"?(D.equal_width_bins=H(s.equalWidthBins),delete D.equal_frequency_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy):$==="equal_frequency"?(D.equal_frequency_bins=H(s.equalFrequencyBins),delete D.equal_width_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy):$==="kbins"?(D.kbins_n_bins=H(s.kbinsNBins),D.kbins_encode=s.kbinsEncode,D.kbins_strategy=s.kbinsStrategy,delete D.equal_width_bins,delete D.equal_frequency_bins):$==="custom"&&(delete D.equal_width_bins,delete D.equal_frequency_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy),Object.keys(D).length?D:null}),$!=="custom"&&b(R)},[s.equalFrequencyBins,s.equalWidthBins,s.kbinsEncode,s.kbinsNBins,s.kbinsStrategy,b,_]),N=v.useCallback((L,$,A)=>{const R=String(L??"").trim();R&&(_(R,W=>{const z={...W};if(!A.trim())delete z[$];else{const D=Number(A);if(!Number.isFinite(D))return W;const H=Math.min(200,Math.max(2,Math.round(D)));z[$]=H,$==="equal_width_bins"?(z.strategy="equal_width",delete z.equal_frequency_bins,delete z.kbins_n_bins,delete z.kbins_encode,delete z.kbins_strategy):$==="equal_frequency_bins"?(z.strategy="equal_frequency",delete z.equal_width_bins,delete z.kbins_n_bins,delete z.kbins_encode,delete z.kbins_strategy):$==="kbins_n_bins"&&(z.strategy="kbins",delete z.equal_width_bins,delete z.equal_frequency_bins)}return Object.keys(z).length?z:null}),b(R))},[b,_]),C=v.useCallback((L,$)=>{const A=String(L??"").trim();A&&_(A,R=>{const W={...R};return $?(W.strategy="kbins",W.kbins_encode=$):delete W.kbins_encode,Object.keys(W).length?W:null})},[_]),E=v.useCallback((L,$)=>{const A=String(L??"").trim();A&&_(A,R=>{const W={...R};return $?(W.strategy="kbins",W.kbins_strategy=$):delete W.kbins_strategy,Object.keys(W).length?W:null})},[_]),j=v.useCallback(L=>{const $=String(L??"").trim();$&&(b($),_($,()=>null))},[b,_]),S=v.useCallback(()=>{e(L=>{if(!((L==null?void 0:L.column_strategies)&&typeof L.column_strategies=="object"&&!Array.isArray(L.column_strategies)&&Object.keys(L.column_strategies).length>0||(L==null?void 0:L.column_overrides)&&typeof L.column_overrides=="object"&&!Array.isArray(L.column_overrides)&&Object.keys(L.column_overrides).length>0))return L;const A={...L};return Object.prototype.hasOwnProperty.call(A,"column_overrides")&&delete A.column_overrides,Object.prototype.hasOwnProperty.call(A,"column_strategies")&&delete A.column_strategies,A})},[e]),M=v.useCallback(()=>{o.length&&o.forEach(L=>{const $=typeof(L==null?void 0:L.column)=="string"?L.column.trim():"";if(!$)return;const A=L.recommended_strategy??"equal_width";x($,A,{recommendedBins:Number.isFinite(L==null?void 0:L.recommended_bins)?L.recommended_bins:null})})},[o,x]),T=v.useCallback(L=>{if(!L)return;const $=[];for(const A of L){const R=typeof A=="string"?A.trim():"";R&&$.push(R)}$.length&&e(A=>{const R=A&&typeof A=="object"?A:{},W=new Set(Ye(R.columns));let z=!1;if($.forEach(H=>{W.has(H)||(W.add(H),z=!0)}),!z)return A;const D={...R};return D.columns=Array.from(W).sort((H,q)=>H.localeCompare(q)),D})},[e]),P=v.useCallback(()=>{i.length&&T(i)},[i,T]);return{handleBinningIntegerChange:c,handleBinningBooleanToggle:u,handleBinningSuffixChange:d,handleBinningLabelFormatChange:p,handleBinningMissingStrategyChange:h,handleBinningMissingLabelChange:f,handleBinningCustomBinsChange:g,handleBinningCustomLabelsChange:w,handleBinningClearCustomColumn:b,updateBinningColumnOverride:_,handleBinningOverrideStrategyChange:x,handleBinningOverrideNumberChange:N,handleBinningOverrideKbinsEncodeChange:C,handleBinningOverrideKbinsStrategyChange:E,handleBinningClearOverride:j,handleBinningClearOverrides:S,handleBinningApplyStrategies:M,handleBinningApplyColumns:T,handleApplyAllBinningNumeric:P}},jP=({setConfigState:e,outlierRecommendationRows:t,outlierExcludedColumns:n,outlierConfig:s})=>{const o=v.useCallback(b=>{xs.includes(b)&&e(_=>(_==null?void 0:_.default_method)===b?_:{..._,default_method:b})},[e]),i=v.useCallback(b=>{e(_=>(typeof(_==null?void 0:_.auto_detect)=="boolean"?_.auto_detect:!0)===b?_:{..._,auto_detect:b})},[e]),c=v.useCallback((b,_)=>{const x=String(b??"").trim();x&&e(N=>{if(!N||typeof N!="object")return N;const C=Ye(N.columns),E=new Set(C),j=N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)?{...N.column_methods}:{};let S=!1;if(_){if(!xs.includes(_))return N;j[x]!==_&&(j[x]=_,S=!0),E.has(x)||(E.add(x),S=!0)}else Object.prototype.hasOwnProperty.call(j,x)&&(delete j[x],S=!0);if(!S)return N;const M={...N};return M.columns=Array.from(E).sort((T,P)=>T.localeCompare(P)),Object.keys(j).length?M.column_methods=j:Object.prototype.hasOwnProperty.call(M,"column_methods")&&delete M.column_methods,M})},[e]),u=v.useCallback(()=>{e(b=>{if(!b||typeof b!="object")return b;const _=b.column_methods&&typeof b.column_methods=="object"&&!Array.isArray(b.column_methods)&&Object.keys(b.column_methods).length>0,x=b.column_parameters&&typeof b.column_parameters=="object"&&!Array.isArray(b.column_parameters)&&Object.keys(b.column_parameters).length>0;if(!_&&!x)return b;const N={...b};return _&&delete N.column_methods,x&&delete N.column_parameters,N})},[e]),d=v.useCallback(()=>{t.length&&e(b=>{if(!b||typeof b!="object")return b;const _=new Set(Ye(b.columns)),x=new Set(Ye(b.skipped_columns)),N=b.column_methods&&typeof b.column_methods=="object"&&!Array.isArray(b.column_methods)?{...b.column_methods}:{},C=b.column_parameters&&typeof b.column_parameters=="object"&&!Array.isArray(b.column_parameters)?{...b.column_parameters}:{};let E=!1;if(t.forEach(S=>{if(!S||S.isExcluded||!S.recommendedMethod)return;const M=String(S.column??"").trim();if(!M||n.has(M))return;const T=S.recommendedMethod;xs.includes(T)&&(x.has(M)&&(x.delete(M),E=!0),_.has(M)||(_.add(M),E=!0),T===s.defaultMethod?Object.prototype.hasOwnProperty.call(N,M)&&(delete N[M],E=!0):N[M]!==T&&(N[M]=T,E=!0),Object.prototype.hasOwnProperty.call(C,M)&&(delete C[M],E=!0))}),!E)return b;const j={...b,columns:Array.from(_).sort((S,M)=>S.localeCompare(M))};return x.size?j.skipped_columns=Array.from(x).sort((S,M)=>S.localeCompare(M)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,Object.keys(N).length?j.column_methods=N:Object.prototype.hasOwnProperty.call(j,"column_methods")&&delete j.column_methods,Object.keys(C).length?j.column_parameters=C:Object.prototype.hasOwnProperty.call(j,"column_parameters")&&delete j.column_parameters,j})},[s.defaultMethod,n,t,e]),p=v.useCallback(b=>{const _=String(b??"").trim();_&&e(x=>{if(!x||typeof x!="object")return x;const N=Ye(x.columns),C=N.filter(R=>R!==_),E=new Set(Ye(x.skipped_columns)),j=E.size;E.add(_);const S=j!==E.size,M=x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)?{...x.column_methods}:{},T=Object.prototype.hasOwnProperty.call(M,_);T&&delete M[_];const P=x.column_parameters&&typeof x.column_parameters=="object"&&!Array.isArray(x.column_parameters)?{...x.column_parameters}:{},L=Object.prototype.hasOwnProperty.call(P,_);if(L&&delete P[_],!(C.length!==N.length)&&!S&&!T&&!L)return x;const A={...x,columns:C.sort((R,W)=>R.localeCompare(W)),skipped_columns:Array.from(E).sort((R,W)=>R.localeCompare(W))};return Object.keys(M).length?A.column_methods=M:Object.prototype.hasOwnProperty.call(A,"column_methods")&&delete A.column_methods,Object.keys(P).length?A.column_parameters=P:Object.prototype.hasOwnProperty.call(A,"column_parameters")&&delete A.column_parameters,A})},[e]),h=v.useCallback(b=>{const _=String(b??"").trim();_&&e(x=>{if(!x||typeof x!="object")return x;const N=Ye(x.skipped_columns);if(!N.includes(_))return x;const C=N.filter(S=>S!==_),E=new Set(Ye(x.columns));E.has(_)||E.add(_);const j={...x,columns:Array.from(E).sort((S,M)=>S.localeCompare(M))};return C.length?j.skipped_columns=C.sort((S,M)=>S.localeCompare(M)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,j})},[e]),f=v.useCallback((b,_)=>{if(_==="__skip__"){p(b);return}if(_==="__default__"){h(b),c(b,null);return}xs.includes(_)&&(h(b),c(b,_))},[p,h,c]),g=v.useCallback((b,_,x)=>{const N=String(_??"").trim().toLowerCase();e(C=>{if(!C||typeof C!="object")return C;const E=C.method_parameters&&typeof C.method_parameters=="object"&&!Array.isArray(C.method_parameters)?{...C.method_parameters}:{},j={...E[b]??{}},S=typeof x=="number"&&Number.isFinite(x)?x:null;let M=!1;if(S===null?Object.prototype.hasOwnProperty.call(j,N)&&(delete j[N],M=!0):j[N]!==S&&(j[N]=S,M=!0),!M)return C;if(Object.keys(j).length?E[b]=j:delete E[b],!Object.keys(E).length){const T={...C};return Object.prototype.hasOwnProperty.call(T,"method_parameters")&&delete T.method_parameters,T}return{...C,method_parameters:E}})},[e]),w=v.useCallback((b,_,x)=>{const N=String(b??"").trim();if(!N)return;const C=String(_??"").trim().toLowerCase();e(E=>{if(!E||typeof E!="object")return E;const j=E.column_parameters&&typeof E.column_parameters=="object"&&!Array.isArray(E.column_parameters)?{...E.column_parameters}:{},S={...j[N]??{}},M=typeof x=="number"&&Number.isFinite(x)?x:null;let T=!1;if(M===null?Object.prototype.hasOwnProperty.call(S,C)&&(delete S[C],T=!0):S[C]!==M&&(S[C]=M,T=!0),!T)return E;if(Object.keys(S).length?j[N]=S:delete j[N],!Object.keys(j).length){const P={...E};return Object.prototype.hasOwnProperty.call(P,"column_parameters")&&delete P.column_parameters,P}return{...E,column_parameters:j}})},[e]);return{handleOutlierDefaultMethodChange:o,handleOutlierAutoDetectToggle:i,setOutlierColumnMethod:c,handleOutlierClearOverrides:u,handleOutlierApplyAllRecommendations:d,handleOutlierSkipColumn:p,handleOutlierUnskipColumn:h,handleOutlierOverrideSelect:f,handleOutlierMethodParameterChange:g,handleOutlierColumnParameterChange:w}},NP=({setConfigState:e,scalingRecommendations:t})=>{const n=v.useCallback(h=>{Ws.includes(h)&&e(f=>(f==null?void 0:f.default_method)===h?f:{...f,default_method:h})},[e]),s=v.useCallback(h=>{e(f=>(typeof(f==null?void 0:f.auto_detect)=="boolean"?f.auto_detect:!0)===h?f:{...f,auto_detect:h})},[e]),o=v.useCallback((h,f)=>{const g=String(h??"").trim();g&&e(w=>{const b=Ye(w.columns),_=b.includes(g),x=w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)?{...w.column_methods}:{};if(f){if(!Ws.includes(f))return w;const E=(x[g]??null)!==f,j=!_;if(!E&&!j)return w;x[g]=f;const S=j?[...b,g].sort((M,T)=>M.localeCompare(T)):b;return{...w,columns:S,column_methods:x}}if(!Object.prototype.hasOwnProperty.call(x,g))return w;if(delete x[g],Object.keys(x).length)return{...w,column_methods:x};const N={...w};return Object.prototype.hasOwnProperty.call(N,"column_methods")&&delete N.column_methods,N})},[e]),i=v.useCallback(()=>{e(h=>{if(!h.column_methods||typeof h.column_methods!="object"||Array.isArray(h.column_methods)||!Object.keys(h.column_methods).length)return h;const f={...h};return delete f.column_methods,f})},[e]),c=v.useCallback(()=>{t.length&&e(h=>{const f=Ye(h.columns),g=new Set(f),w=new Set(Ye(h.skipped_columns)),b=h.column_methods&&typeof h.column_methods=="object"&&!Array.isArray(h.column_methods)?{...h.column_methods}:{};let _=!1;if(t.forEach(N=>{const C=String(N.column??"").trim(),E=N.recommended_method;!C||!Ws.includes(E)||w.has(C)||(b[C]!==E&&(b[C]=E,_=!0),g.has(C)||(g.add(C),_=!0))}),!_)return h;const x=Array.from(g).sort((N,C)=>N.localeCompare(C));return{...h,columns:x,column_methods:b}})},[t,e]),u=v.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const w=Ye(g.columns),b=w.filter(j=>j!==f),_=new Set(Ye(g.skipped_columns)),x=_.size;_.add(f);const N=_.size!==x,C=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{},E=Object.prototype.hasOwnProperty.call(C,f);return E&&delete C[f],!N&&b.length===w.length&&!E?g:{...g,columns:b.sort((j,S)=>j.localeCompare(S)),column_methods:C,skipped_columns:Array.from(_).sort((j,S)=>j.localeCompare(S))}})},[e]),d=v.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const w=Ye(g.skipped_columns);if(!w.includes(f))return g;const b=new Set(w);b.delete(f);const _=new Set(Ye(g.columns));return _.has(f)||_.add(f),{...g,columns:Array.from(_).sort((N,C)=>N.localeCompare(C)),skipped_columns:Array.from(b).sort((N,C)=>N.localeCompare(C))}})},[e]),p=v.useCallback((h,f)=>{if(f==="__skip__"){u(h);return}if(f==="__default__"){d(h),o(h,null);return}Ws.includes(f)&&(d(h),o(h,f))},[u,d,o]);return{handleScalingDefaultMethodChange:n,handleScalingAutoDetectToggle:s,setScalingColumnMethod:o,handleScalingClearOverrides:i,handleScalingApplyAllRecommendations:c,handleScalingSkipColumn:u,handleScalingUnskipColumn:d,handleScalingOverrideSelect:p}},CP=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},SP=({isBinningNode:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:s,availableColumns:o,recommendedColumns:i})=>{const c=v.useMemo(()=>{if(!i)return null;const h=new Set;for(const f of i){const g=typeof f=="string"?f.trim():"";g&&h.add(g)}return h.size>0?h:null},[i]),u=v.useMemo(()=>{if(!Array.isArray(n)||!n.length)return null;const h=new Set;return n.forEach(f=>{const g=typeof f=="string"?f.trim():"";g&&h.add(g)}),h.size>0?h:null},[n]),d=v.useMemo(()=>{if(!e)return new Set;if(!t.size||!c&&!u)return t;const h=new Set;return t.forEach(f=>{c!=null&&c.has(f)||u!=null&&u.has(f)||h.add(f)}),h},[e,t,c,u]),p=v.useMemo(()=>{if(!e||!s.length)return{};const h={};return o.forEach(f=>{if(d.has(f))return;let g=null,w=null;const b=new Set;if(s.forEach(_=>{if(!_||!Object.prototype.hasOwnProperty.call(_,f))return;const x=CP(_[f]);x!==null&&((g===null||x<g)&&(g=x),(w===null||x>w)&&(w=x),b.size<=1e3&&b.add(x))}),g!==null||w!==null){const _=b.size>0?b.size:null;h[f]={min:g,max:w,distinct:_}}}),h},[o,d,e,s]);return{binningExcludedColumns:d,binningColumnPreviewMap:p,manualBoundColumns:[],manualRangeFallbackMap:{}}},EP=({isScalingNode:e,isBinningNode:t,isOutlierNode:n,scalingExcludedColumns:s,binningExcludedColumns:o,outlierExcludedColumns:i,setConfigState:c})=>{v.useEffect(()=>{!e||s.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ye(u.columns);if(!d.length)return u;const p=d.filter(f=>!s.has(f));if(p.length===d.length||!p.length)return u;const h={...u,columns:p};if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const f={};let g=!1;Object.entries(u.column_methods).forEach(([w,b])=>{const _=String(w??"").trim();if(!_)return;if(s.has(_)){g=!0;return}const x=typeof b=="string"?b.trim():null;x&&Ws.includes(x)&&(f[_]=x)}),g?Object.keys(f).length?h.column_methods=f:h.column_methods={}:h.column_methods=u.column_methods}return h})},[e,s,c]),v.useEffect(()=>{!t||o.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ye(u.columns);if(!d.length)return u;const p=d.filter(g=>!o.has(g));if(p.length===d.length)return u;const h=new Set(d.filter(g=>o.has(g))),f={...u,columns:p};if(u.custom_bins&&typeof u.custom_bins=="object"&&!Array.isArray(u.custom_bins)){const g={};Object.entries(u.custom_bins).forEach(([w,b])=>{!h.has(w)&&Array.isArray(b)&&b.length&&(g[w]=[...b])}),Object.keys(g).length?f.custom_bins=g:Object.prototype.hasOwnProperty.call(f,"custom_bins")&&delete f.custom_bins}if(u.custom_labels&&typeof u.custom_labels=="object"&&!Array.isArray(u.custom_labels)){const g={};Object.entries(u.custom_labels).forEach(([w,b])=>{!h.has(w)&&Array.isArray(b)&&b.length&&(g[w]=b.map(_=>String(_)))}),Object.keys(g).length?f.custom_labels=g:Object.prototype.hasOwnProperty.call(f,"custom_labels")&&delete f.custom_labels}return f})},[o,t,c]),v.useEffect(()=>{!n||i.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ye(u.columns),p=d.filter(C=>!i.has(C)),h=p.length!==d.length,f=Ye(u.skipped_columns),g=f.filter(C=>!i.has(C)),w=g.length!==f.length,b=C=>C??{...u};let _=null;h&&(_=b(_),_.columns=p.sort((C,E)=>C.localeCompare(E))),w&&(_=b(_),g.length?_.skipped_columns=g.sort((C,E)=>C.localeCompare(E)):Object.prototype.hasOwnProperty.call(_,"skipped_columns")&&delete _.skipped_columns);let x=!1;if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const C={};Object.entries(u.column_methods).forEach(([E,j])=>{const S=String(E??"").trim();if(!S||i.has(S)){x=!0;return}const M=typeof j=="string"?j.trim():null;M&&xs.includes(M)?C[S]=M:x=!0}),x&&(_=b(_),Object.keys(C).length?_.column_methods=C:Object.prototype.hasOwnProperty.call(_,"column_methods")&&delete _.column_methods)}let N=!1;if(u.column_parameters&&typeof u.column_parameters=="object"&&!Array.isArray(u.column_parameters)){const C={};Object.entries(u.column_parameters).forEach(([E,j])=>{const S=String(E??"").trim();if(!S||i.has(S)){N=!0;return}if(!j||typeof j!="object"||Array.isArray(j)){N=!0;return}C[S]={...j}}),N&&(_=b(_),Object.keys(C).length?_.column_parameters=C:Object.prototype.hasOwnProperty.call(_,"column_parameters")&&delete _.column_parameters)}return _||u})},[n,i,c])},kP=({isScalingNode:e,isOutlierNode:t,isBinningNode:n,configState:s,setConfigState:o,nodeId:i,numericExcludedColumns:c,scalingData:u,outlierData:d,binningData:p,availableColumns:h,previewSampleRows:f})=>{const{scalingConfig:g,scalingExcludedColumns:w,scalingMethodDetailMap:b,scalingMethodOptions:_,scalingRecommendations:x,scalingRecommendationRows:N,scalingSelectedCount:C,scalingOverrideCount:E,scalingDefaultDetail:j,scalingDefaultLabel:S,scalingAutoDetectEnabled:M,scalingHasRecommendations:T,scalingStatusMessage:P,scalingOverrideExampleSummary:L}=yP({isScalingNode:e,configState:s,numericExcludedColumns:c,scalingData:u}),{outlierConfig:$,outlierExcludedColumns:A,outlierMethodLabelMap:R,outlierMethodDetailMap:W,outlierMethodOptions:z,outlierRecommendations:D,outlierRecommendationRows:H,outlierSelectedCount:q,outlierOverrideCount:I,outlierParameterOverrideCount:Q,outlierDefaultDetail:U,outlierDefaultLabel:F,outlierAutoDetectEnabled:K,outlierHasRecommendations:re,outlierStatusMessage:Y,outlierOverrideExampleSummary:V}=bP({isOutlierNode:t,configState:s,numericExcludedColumns:c,outlierData:d}),G=typeof(d==null?void 0:d.sample_size)=="number"?d.sample_size:null,X=null,se=I>0||Q>0,J=v.useMemo(()=>I>0?V:Q>0?`${Q} column${Q===1?"":"s"} with parameter overrides`:null,[I,Q,V]),{binningConfig:te,binningSelectedCount:Se,binningDefaultLabel:ze,binningOverrideColumns:Oe,binningOverrideCount:Ue,binningOverrideSummary:nt,fieldIds:He,customEdgeDrafts:de,setCustomEdgeDrafts:_e,customLabelDrafts:je,setCustomLabelDrafts:Me}=xP({configState:s,nodeId:i}),De=v.useMemo(()=>e?g.columns:n?te.columns:t?$.columns:Ye(s==null?void 0:s.columns),[te.columns,s,n,t,e,$.columns,g.columns]),ce=v.useMemo(()=>{const Qt=p==null?void 0:p.columns;return Array.isArray(Qt)?Qt.filter(Tt=>!Tt||typeof Tt.column!="string"?!1:!!Tt.column.trim()):[]},[p==null?void 0:p.columns]),Te=v.useMemo(()=>{if(!ce.length)return new Set;const Qt=new Set;return ce.forEach(Tt=>{const lt=typeof Tt.column=="string"?Tt.column.trim():"";lt&&Qt.add(lt)}),Qt},[ce]),Qe=v.useMemo(()=>{if(!n)return[];const Qt=new Set;return h.forEach(Tt=>{if(c.has(Tt))return;const lt=Tt.trim();lt&&Qt.add(lt)}),ce.forEach(Tt=>{const lt=typeof Tt.column=="string"?Tt.column.trim():"";lt&&(!c.has(lt)||Te.has(lt))&&Qt.add(lt)}),De.forEach(Tt=>{const lt=typeof Tt=="string"?Tt.trim():"";lt&&(!c.has(lt)||Te.has(lt))&&Qt.add(lt)}),Array.from(Qt).sort((Tt,lt)=>Tt.localeCompare(lt))},[h,ce,Te,n,c,De]),ht=v.useMemo(()=>!n||!Qe.length?[]:Qe.filter(Qt=>!De.includes(Qt)),[Qe,n,De]),rt=ht.length>0,{handleBinningIntegerChange:gt,handleBinningBooleanToggle:at,handleBinningSuffixChange:ut,handleBinningLabelFormatChange:Ot,handleBinningMissingStrategyChange:Rt,handleBinningMissingLabelChange:Xe,handleBinningCustomBinsChange:Bt,handleBinningCustomLabelsChange:Kt,handleBinningClearCustomColumn:kt,updateBinningColumnOverride:_t,handleBinningOverrideStrategyChange:Cn,handleBinningOverrideNumberChange:Lt,handleBinningOverrideKbinsEncodeChange:rn,handleBinningOverrideKbinsStrategyChange:fe,handleBinningClearOverride:Ut,handleBinningClearOverrides:dt,handleBinningApplyStrategies:Tn,handleBinningApplyColumns:qe,handleApplyAllBinningNumeric:wt}=wP({setConfigState:o,setBinningCustomEdgeDrafts:_e,setBinningCustomLabelDrafts:Me,binningConfig:te,binningInsightsRecommendations:ce,binningAllNumericColumns:Qe}),{handleOutlierDefaultMethodChange:mt,handleOutlierAutoDetectToggle:Ns,setOutlierColumnMethod:Gt,handleOutlierClearOverrides:vt,handleOutlierApplyAllRecommendations:jt,handleOutlierSkipColumn:Gn,handleOutlierUnskipColumn:on,handleOutlierOverrideSelect:Sn,handleOutlierMethodParameterChange:Zt,handleOutlierColumnParameterChange:$n}=jP({setConfigState:o,outlierRecommendationRows:H,outlierExcludedColumns:A,outlierConfig:$}),{handleScalingDefaultMethodChange:ln,handleScalingAutoDetectToggle:Ht,setScalingColumnMethod:It,handleScalingClearOverrides:Fn,handleScalingApplyAllRecommendations:cn,handleScalingSkipColumn:vn,handleScalingUnskipColumn:et,handleScalingOverrideSelect:Qn}=NP({setConfigState:o,scalingRecommendations:x}),{binningExcludedColumns:Cs,binningColumnPreviewMap:In,manualBoundColumns:Xn,manualRangeFallbackMap:Ss}=SP({isBinningNode:n,numericExcludedColumns:c,selectedColumns:De,previewSampleRows:f,availableColumns:h,recommendedColumns:Te}),Bn=v.useMemo(()=>{const Qt=p==null?void 0:p.excluded_columns;return Array.isArray(Qt)?Qt.filter(Tt=>!Tt||typeof Tt.column!="string"?!1:!!Tt.column.trim()):[]},[p==null?void 0:p.excluded_columns]);return EP({isScalingNode:e,isBinningNode:n,isOutlierNode:t,scalingExcludedColumns:w,binningExcludedColumns:Cs,outlierExcludedColumns:A,setConfigState:o}),{scaling:{config:g,state:{excludedColumns:w,methodDetailMap:b,methodOptions:_,recommendations:x,recommendationRows:N,selectedCount:C,overrideCount:E,defaultDetail:j,defaultLabel:S,autoDetectEnabled:M,hasRecommendations:T,statusMessage:P,overrideExampleSummary:L},handlers:{handleDefaultMethodChange:ln,handleAutoDetectToggle:Ht,setColumnMethod:It,handleClearOverrides:Fn,handleApplyAllRecommendations:cn,handleSkipColumn:vn,handleUnskipColumn:et,handleOverrideSelect:Qn}},outlier:{config:$,state:{excludedColumns:A,methodLabelMap:R,methodDetailMap:W,methodOptions:z,recommendations:D,recommendationRows:H,selectedCount:q,overrideCount:I,parameterOverrideCount:Q,defaultDetail:U,defaultLabel:F,autoDetectEnabled:K,hasRecommendations:re,statusMessage:Y,overrideExampleSummary:V,sampleSize:G,relativeGeneratedAt:X,hasOverrides:se,overrideSummaryDisplay:J},handlers:{handleDefaultMethodChange:mt,handleAutoDetectToggle:Ns,setColumnMethod:Gt,handleClearOverrides:vt,handleApplyAllRecommendations:jt,handleSkipColumn:Gn,handleUnskipColumn:on,handleOverrideSelect:Sn,handleMethodParameterChange:Zt,handleColumnParameterChange:$n}},binning:{config:te,state:{selectedCount:Se,defaultLabel:ze,overrideColumns:Oe,overrideCount:Ue,overrideSummary:nt,fieldIds:He,customEdgeDrafts:de,customLabelDrafts:je,insightsRecommendations:ce,recommendedColumnSet:Te,allNumericColumns:Qe,numericColumnsNotSelected:ht,canApplyAllNumeric:rt,excludedColumns:Cs,columnPreviewMap:In,manualBoundColumns:Xn,manualRangeFallbackMap:Ss,insightsExcludedColumns:Bn},handlers:{setCustomEdgeDrafts:_e,setCustomLabelDrafts:Me,handleIntegerChange:gt,handleBooleanToggle:at,handleSuffixChange:ut,handleLabelFormatChange:Ot,handleMissingStrategyChange:Rt,handleMissingLabelChange:Xe,handleCustomBinsChange:Bt,handleCustomLabelsChange:Kt,handleClearCustomColumn:kt,updateColumnOverride:_t,handleOverrideStrategyChange:Cn,handleOverrideNumberChange:Lt,handleOverrideKbinsEncodeChange:rn,handleOverrideKbinsStrategyChange:fe,handleClearOverride:Ut,handleClearOverrides:dt,handleApplyStrategies:Tn,handleApplyColumns:qe,handleApplyAllNumeric:wt}},selectedColumns:De}},jx={enabled:!1,explicit:!1},MP={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},AP={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},OP={},TP=[],$P=({isReplaceAliasesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:o,previewSampleRows:i})=>{const c=v.useMemo(()=>{if(!e)return jx;const _=Sl(t);if(_!==void 0)return{enabled:!!jo(_),explicit:!0};if(n&&typeof n=="object"){const x=Sl(n);if(x!==void 0)return{enabled:!!jo(x),explicit:!0}}return jx},[t,e,n]),u=v.useMemo(()=>{if(!e)return[];const _=Ye((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),x=Cu(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),N=(()=>{const E=Sl(t);if(E!==void 0){const j=jo(E);if(j!==null)return j}if(n&&typeof n=="object"){const j=Sl(n);if(j!==void 0){const S=jo(j);if(S!==null)return S}}return _.length===0})(),C=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return Py(C,{mode:x,columns:_,autoDetect:N})},[t,e,n]),d=v.useMemo(()=>e?u.length?Array.from(new Set(u.flatMap(_=>_.columns.map(x=>x.trim()).filter(Boolean)))).sort((_,x)=>_.localeCompare(x)):Ye(t==null?void 0:t.columns):[],[u,t==null?void 0:t.columns,e]),p=v.useMemo(()=>e?u.length?u.some(_=>_.autoDetect):c.explicit?c.enabled:d.length===0:!1,[c.enabled,c.explicit,d.length,u,e]),h=v.useMemo(()=>{if(e)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,e]),f=v.useMemo(()=>e?IM(i):OP,[e,i]),g=v.useMemo(()=>e?PM({selectedColumns:d,availableColumns:s,columnTypeMap:o,autoDetectEnabled:p}):MP,[p,d,s,o,e]),w=v.useMemo(()=>e?zM(h):AP,[e,h]),b=v.useMemo(()=>{if(!e)return TP;const _=new Set(g.recommendedColumns),x=new Set(g.textColumns);return s.map(N=>{const C=o[N]??null,E=f[N]??[];return{name:N,dtype:C,samples:E.slice(0,3),isRecommended:_.has(N),isTextLike:x.has(N)}})},[g.recommendedColumns,g.textColumns,f,s,o,e]);return{aliasAutoDetectMeta:c,aliasStrategies:u,aliasStrategyCount:u.length,aliasSelectedColumns:d,aliasAutoDetectEnabled:p,replaceAliasesCustomPairsValue:h,aliasColumnSummary:g,aliasCustomPairSummary:w,aliasSampleMap:f,aliasColumnOptions:b}},PP=({isTrimWhitespaceNode:e,isRemoveSpecialCharsNode:t,isRegexCleanupNode:n,isNormalizeTextCaseNode:s,configState:o,nodeConfig:i,availableColumns:c,columnTypeMap:u,previewSampleRows:d})=>{const p=v.useMemo(()=>_A(e?o==null?void 0:o.mode:void 0,e?i==null?void 0:i.mode:void 0),[o==null?void 0:o.mode,e,i==null?void 0:i.mode]),h=v.useMemo(()=>e?Ye(o==null?void 0:o.columns):[],[o==null?void 0:o.columns,e]),f=v.useMemo(()=>e?NA(d):{},[e,d]),g=v.useMemo(()=>e?bA({selectedColumns:h,availableColumns:c,columnTypeMap:u,sampleMap:f}):SA,[c,u,e,h,f]),w=v.useMemo(()=>vA(p),[p]),b=v.useMemo(()=>DA(t?o==null?void 0:o.mode:void 0,t?i==null?void 0:i.mode:void 0),[o==null?void 0:o.mode,t,i==null?void 0:i.mode]),_=v.useMemo(()=>t?Ye(o==null?void 0:o.columns):[],[o==null?void 0:o.columns,t]),x=v.useMemo(()=>t?qA(d):{},[t,d]),N=v.useMemo(()=>t?BA({selectedColumns:_,availableColumns:c,columnTypeMap:u,sampleMap:x}):VA,[c,u,t,_,x]),C=v.useMemo(()=>FA(b),[b]),E=v.useMemo(()=>_O(n?o==null?void 0:o.mode:void 0,n?i==null?void 0:i.mode:void 0),[o==null?void 0:o.mode,n,i==null?void 0:i.mode]),j=v.useMemo(()=>n?Ye(o==null?void 0:o.columns):[],[o==null?void 0:o.columns,n]),S=v.useMemo(()=>n?wO(d):{},[n,d]),M=v.useMemo(()=>n?bO({selectedColumns:j,availableColumns:c,columnTypeMap:u,sampleMap:S}):CO,[c,u,n,j,S]),T=v.useMemo(()=>vO(E),[E]),P=v.useMemo(()=>{if(!n)return null;const z=(o==null?void 0:o.replacement)??(i==null?void 0:i.replacement)??null;return typeof z=="string"?z:null},[o==null?void 0:o.replacement,n,i==null?void 0:i.replacement]),L=v.useMemo(()=>tO(s?o==null?void 0:o.mode:void 0,s?i==null?void 0:i.mode:void 0),[o==null?void 0:o.mode,s,i==null?void 0:i.mode]),$=v.useMemo(()=>s?Ye(o==null?void 0:o.columns):[],[o==null?void 0:o.columns,s]),A=v.useMemo(()=>s?oO(d):{},[s,d]),R=v.useMemo(()=>s?rO({selectedColumns:$,availableColumns:c,columnTypeMap:u,sampleMap:A,mode:L}):iO,[c,u,s,$,L,A]),W=v.useMemo(()=>nO(L),[L]);return{trimWhitespace:{columnSummary:g,sampleMap:f,modeDetails:w},removeSpecial:{columnSummary:N,sampleMap:x,modeDetails:C,selectedMode:b},regexCleanup:{columnSummary:M,sampleMap:S,modeDetails:T,selectedMode:E,replacementValue:P},normalizeCase:{columnSummary:R,sampleMap:A,modeDetails:W,selectedMode:L}}},LP={},zP=({isReplaceInvalidValuesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:o,previewSampleRows:i})=>{const c=v.useMemo(()=>zO(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),u=v.useMemo(()=>e?Ye(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,e]),d=v.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),b=Number(w);return Number.isFinite(b)?b:null},[t==null?void 0:t.min_value,e,n==null?void 0:n.min_value]),p=v.useMemo(()=>{if(!e)return null;const w=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),b=Number(w);return Number.isFinite(b)?b:null},[t==null?void 0:t.max_value,e,n==null?void 0:n.max_value]),h=v.useMemo(()=>e?BO(i):LP,[e,i]),f=v.useMemo(()=>e?FO({selectedColumns:u,availableColumns:s,columnTypeMap:o,sampleMap:h}):GO,[s,o,e,h,u]),g=v.useMemo(()=>RO(c),[c]);return{selectedColumns:u,selectedMode:c,modeDetails:g,sampleMap:h,columnSummary:f,minValue:d,maxValue:p}},RP={},DP=({isStandardizeDatesNode:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:o,previewSampleRows:i})=>{const c=v.useMemo(()=>Vy(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),u=v.useMemo(()=>e?Ye((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,e,n==null?void 0:n.columns]),d=v.useMemo(()=>{if(!e)return[];const b={columns:u,mode:c,autoDetect:u.length===0};return Wy((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),b)},[t==null?void 0:t.format_strategies,e,u,n==null?void 0:n.format_strategies,c]),p=v.useMemo(()=>{if(!e)return[];const b=new Set;return d.forEach(_=>{_.columns.forEach(x=>{const N=x.trim();N&&b.add(N)})}),Array.from(b).sort((_,x)=>_.localeCompare(x))},[e,d]),h=v.useMemo(()=>d.some(b=>b.autoDetect),[d]),f=v.useMemo(()=>e?lA(i):RP,[e,i]),g=v.useMemo(()=>{if(!e)return iA;const b=tA({selectedColumns:p,availableColumns:s,columnTypeMap:o,sampleMap:f});return h?{...b,autoDetectionActive:!0}:b},[s,o,h,e,f,p]),w=v.useMemo(()=>{if(!e)return[];const b=new Set(g.recommendedColumns),_=new Set(g.sampleCandidates);return s.map(x=>{const N=o[x]??null,C=f[x]??[];return{name:x,dtype:N,samples:C.slice(0,3),isRecommended:b.has(x),isSampleCandidate:_.has(x)}})},[s,g,o,e,f]);return{selectedMode:c,strategies:d,sampleMap:f,columnSummary:g,columnOptions:w}},FP=({isReplaceAliasesNode:e,isTrimWhitespaceNode:t,isRemoveSpecialCharsNode:n,isRegexCleanupNode:s,isNormalizeTextCaseNode:o,isReplaceInvalidValuesNode:i,isStandardizeDatesNode:c,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f})=>{const{aliasAutoDetectMeta:g,aliasStrategies:w,aliasStrategyCount:b,aliasSelectedColumns:_,aliasAutoDetectEnabled:x,replaceAliasesCustomPairsValue:N,aliasColumnSummary:C,aliasCustomPairSummary:E,aliasSampleMap:j,aliasColumnOptions:S}=$P({isReplaceAliasesNode:e,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{trimWhitespace:M,removeSpecial:T,regexCleanup:P,normalizeCase:L}=PP({isTrimWhitespaceNode:t,isRemoveSpecialCharsNode:n,isRegexCleanupNode:s,isNormalizeTextCaseNode:o,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{selectedMode:$,modeDetails:A,sampleMap:R,columnSummary:W,minValue:z,maxValue:D}=zP({isReplaceInvalidValuesNode:i,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f}),{selectedMode:H,strategies:q,sampleMap:I,columnSummary:Q,columnOptions:U}=DP({isStandardizeDatesNode:c,configState:u,nodeConfig:d,availableColumns:p,columnTypeMap:h,previewSampleRows:f});return{alias:{autoDetectMeta:g,strategies:w,strategyCount:b,selectedColumns:_,autoDetectEnabled:x,customPairsValue:N,columnSummary:C,customPairSummary:E,sampleMap:j,columnOptions:S},trimWhitespace:M,removeSpecial:T,regexCleanup:P,normalizeCase:L,replaceInvalid:{mode:$,modeDetails:A,sampleMap:R,columnSummary:W,minValue:z,maxValue:D},standardizeDates:{mode:H,strategies:q,sampleMap:I,columnSummary:Q,columnOptions:U}}},IP=({graphSnapshot:e,nodeId:t,isDataset:n})=>{const s=v.useMemo(()=>{if(!e)return null;const f=Array.isArray(e.nodes)?e.nodes:[],g=Array.isArray(e.edges)?e.edges:[];return{nodes:f,edges:g}},[e]),o=v.useMemo(()=>e&&Array.isArray(e.nodes)?e.nodes:[],[e]),i=v.useMemo(()=>e&&Array.isArray(e.edges)?e.edges:[],[e]),c=o.length,u=v.useMemo(()=>{if(!t||!i.length)return[];const f=new Set,g=[t];for(;g.length;){const b=g.pop();b&&i.forEach(_=>{const x=_&&typeof _.source=="string"?_.source.trim():"",N=_&&typeof _.target=="string"?_.target.trim():"";!x||!N||N===b&&!f.has(x)&&(f.add(x),g.push(x))})}const w=Array.from(f);return w.sort(),w},[i,t]),d=v.useMemo(()=>{var w,b,_,x,N;if(!u.length)return"";let f="",g="";for(const C of u){const E=o.find(S=>(S==null?void 0:S.id)===C);if(!E)continue;const j=String(((w=E==null?void 0:E.data)==null?void 0:w.catalogType)??"").toLowerCase().trim();if(j==="feature_target_split"){const S=(_=(b=E==null?void 0:E.data)==null?void 0:b.config)==null?void 0:_.target_column;typeof S=="string"&&S.trim()&&(f=S.trim())}else if(j==="train_test_split"){const S=(N=(x=E==null?void 0:E.data)==null?void 0:x.config)==null?void 0:N.target_column;typeof S=="string"&&S.trim()&&(g=S.trim())}}return f||g||""},[o,u]),p=v.useMemo(()=>{const f=new Set;return o.forEach(g=>{if(!g)return;const w=typeof g.id=="string"?g.id.trim():String((g==null?void 0:g.id)??"").trim();if(!w)return;const b=(g==null?void 0:g.data)??{};(w==="dataset-source"||(b==null?void 0:b.isDataset)===!0||(b==null?void 0:b.catalogType)==="dataset")&&f.add(w)}),f.size||f.add("dataset-source"),Array.from(f)},[o]),h=v.useMemo(()=>{if(!t)return!1;if(n)return!0;if(!i.length)return p.includes(t);const f=new Map;i.forEach(b=>{const _=b==null?void 0:b.source,x=b==null?void 0:b.target,N=typeof _=="string"?_.trim():String(_??"").trim(),C=typeof x=="string"?x.trim():String(x??"").trim();if(!N||!C)return;const E=f.get(N);E?E.push(C):f.set(N,[C])});const g=new Set,w=[...p];for(;w.length;){const b=w.pop();if(!b||g.has(b))continue;g.add(b);const _=f.get(b);_&&_.forEach(x=>{x&&!g.has(x)&&w.push(x)})}return g.has(t)},[p,i,n,t]);return{graphContext:s,graphNodes:o,graphEdges:i,graphNodeCount:c,upstreamNodeIds:u,upstreamTargetColumn:d,hasReachableSource:h}},Yi={status:"idle",data:null,error:null},BP=1e3,UP=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:s,isPreviewNode:o,targetNodeId:i,previewSignature:c,skipPreview:u=!1,requestPreviewRows:d,includeSignals:p})=>{const[h,f]=v.useState(Yi),[g,w]=v.useState(0),b=v.useRef(null),_=v.useRef(-1),x=v.useCallback(()=>{w(N=>N+1)},[]);return v.useEffect(()=>{if(!e){f(Yi),b.current=null,_.current=-1;return}if(u)return;if(!t){f(o?{status:"error",data:null,error:"Select a dataset to generate previews."}:Yi);return}if(!n){f(o?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:Yi);return}if(!s)return;const N=(()=>{const L=Array.isArray(s.nodes)?s.nodes.map(A=>A&&typeof A.id=="string"?A.id:null).filter(A=>!!A).sort():[],$=Array.isArray(s.edges)?s.edges.map(A=>{const R=A&&typeof A.source=="string"?A.source.trim():"",W=A&&typeof A.target=="string"?A.target.trim():"";return R&&W?`${R}->${W}`:null}).filter(A=>!!A).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:i??null,nodeIds:L,edgePairs:$})})(),C=c??N,E=C!==b.current;if(!(_.current!==g)&&!E)return;b.current=C,_.current=g;let S=!0;f(L=>({status:"loading",data:L.data??null,error:null}));const M=d??o,T=p??M,P={dataset_source_id:t,graph:{nodes:s.nodes,edges:s.edges},target_node_id:i??void 0,include_preview_rows:M,include_signals:T};return M&&(P.sample_size=BP),dy(P).then(L=>{S&&f({status:"success",data:L,error:null})}).catch(L=>{S&&f(o?{status:"error",data:null,error:(L==null?void 0:L.message)??"Unable to generate preview."}:Yi)}),()=>{S=!1}},[n,s,o,u,c,g,e,t,i]),{previewState:h,refreshPreview:x}},qP=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:o,nodeId:i,previewSignature:c,skipPreview:u,catalogFlags:d,cachedPreviewSchema:p,setCachedPreviewSchema:h})=>{var P;const{isPreviewNode:f,isFeatureMathNode:g,isPolynomialFeaturesNode:w,isFeatureSelectionNode:b,isTrainTestSplitNode:_,isOutlierNode:x,isTransformerAuditNode:N}=d,C=v.useMemo(()=>!(!e||!t||!n),[t,e,n]),E=v.useMemo(()=>!e||!s||!n?!1:t>0,[t,e,n,s]),j=v.useMemo(()=>f||g||w||b||_||x||N,[g,b,x,w,f,_,N]),{previewState:S,refreshPreview:M}=UP({shouldFetchPreview:C,sourceId:s,canTriggerPreview:E,graphSnapshot:e,isPreviewNode:f,targetNodeId:(o==null?void 0:o.id)??null,previewSignature:c,skipPreview:u,requestPreviewRows:f,includeSignals:j});v.useEffect(()=>{var $;const L=(($=S.data)==null?void 0:$.schema)??null;L&&h(A=>A!=null&&A.signature&&L.signature&&A.signature===L.signature?A:L)},[(P=S.data)==null?void 0:P.schema]),v.useEffect(()=>{h(null)},[s]),v.useEffect(()=>{h(null)},[c]);const T=v.useCallback(()=>{h(null)},[]);return{previewState:S,refreshPreview:M,cachedPreviewSchema:p,clearCachedPreviewSchema:T,canTriggerPreview:E}},HP=(e,t,n,s,o)=>{e([]),t({}),n({}),s({}),o("")},VP=({requiresColumnCatalog:e,catalogFlags:t,nodeId:n,sourceId:s,hasReachableSource:o})=>{const{isImputerNode:i}=t,[c,u]=v.useState([]),[d,p]=v.useState(""),[h,f]=v.useState({}),[g,w]=v.useState({}),[b,_]=v.useState({}),[x,N]=v.useState(0);return v.useEffect(()=>{!e&&!i||s&&o||HP(u,f,w,_,p)},[o,i,e,s]),v.useEffect(()=>{N(0)},[i,n]),{availableColumns:c,setAvailableColumns:u,columnSearch:d,setColumnSearch:p,columnMissingMap:h,setColumnMissingMap:f,columnTypeMap:g,setColumnTypeMap:w,columnSuggestions:b,setColumnSuggestions:_,imputerMissingFilter:x,setImputerMissingFilter:N}},WP=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:o})=>{var i;v.useEffect(()=>{var h;const c=Array.isArray((h=e.data)==null?void 0:h.column_stats)?e.data.column_stats:[],u=e.status;if(!c.length){if(u==="loading")return;s(f=>Object.keys(f).length?{}:f),o(f=>Object.keys(f).length?{}:f);return}const d={},p={};c.forEach(f=>{if(!f||!f.name)return;const g=String(f.name).trim();if(!g||n&&g.endsWith(n))return;const w=typeof f.dtype=="string"?f.dtype:null;w&&(d[g]=w);const b=t.map(x=>x&&Object.prototype.hasOwnProperty.call(x,g)?x[g]:void 0),_=y2(w,b);_.length&&(p[g]=_)}),s(f=>{const g=Object.entries(f),w=Object.entries(d);return g.length===w.length&&g.every(([b,_])=>Object.prototype.hasOwnProperty.call(d,b)&&d[b]===_)?f:d}),o(f=>{const g=Object.keys(f),w=Object.keys(p);return g.length===w.length&&g.every(b=>{if(!Object.prototype.hasOwnProperty.call(p,b))return!1;const _=f[b]??[],x=p[b]??[];return Gb(_,x)})?f:p})},[n,t,(i=e.data)==null?void 0:i.column_stats,e.status,o,s])},KP=({previewState:e,activeFlagSuffix:t,hasReachableSource:n,requiresColumnCatalog:s,nodeColumns:o,selectedColumns:i,setAvailableColumns:c,setColumnMissingMap:u})=>{var d,p;v.useEffect(()=>{var _,x;if(!s||!n)return;const h=new Set;(Array.isArray((_=e.data)==null?void 0:_.columns)?e.data.columns:[]).forEach(N=>{const C=typeof N=="string"?N.trim():"";C&&(t&&C.endsWith(t)||h.add(C))});const g=Array.isArray((x=e.data)==null?void 0:x.column_stats)?e.data.column_stats:[],w={};if(g.forEach(N=>{if(!N||!N.name)return;const C=String(N.name).trim();if(!C||t&&C.endsWith(t))return;h.add(C);const E=Number(N.missing_percentage);!Number.isNaN(E)&&E>=0&&(w[C]=E)}),Ye(o).forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),i.forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),h.size===0)return;const b=Array.from(h).sort((N,C)=>N.localeCompare(C));c(N=>Gb(N,b)?N:b),Object.keys(w).length>0&&u(N=>({...N,...w}))},[t,n,o,(d=e.data)==null?void 0:d.column_stats,(p=e.data)==null?void 0:p.columns,s,i,c,u])},YP=({previewState:e,nodeId:t,catalogFlags:n})=>{var w,b,_,x,N,C,E,j,S,M;const{isFeatureMathNode:s,isPolynomialFeaturesNode:o,isFeatureSelectionNode:i,isOutlierNode:c,isTransformerAuditNode:u}=n,d=v.useMemo(()=>{var P,L;if(!s)return[];const T=(L=(P=e.data)==null?void 0:P.signals)==null?void 0:L.feature_math;return Array.isArray(T)?T:[]},[s,(b=(w=e.data)==null?void 0:w.signals)==null?void 0:b.feature_math]),p=v.useMemo(()=>{var L,$;if(!o)return null;const T=($=(L=e.data)==null?void 0:L.signals)==null?void 0:$.polynomial_features;return!Array.isArray(T)||T.length===0?null:(t?T.find(A=>A&&typeof A.node_id=="string"&&A.node_id===t):null)??T[0]??null},[o,t,(x=(_=e.data)==null?void 0:_.signals)==null?void 0:x.polynomial_features]),h=v.useMemo(()=>{var L,$;if(!i)return null;const T=($=(L=e.data)==null?void 0:L.signals)==null?void 0:$.feature_selection;return!Array.isArray(T)||T.length===0?null:(t?T.find(A=>A&&typeof A.node_id=="string"&&A.node_id===t):null)??T[0]??null},[i,t,(C=(N=e.data)==null?void 0:N.signals)==null?void 0:C.feature_selection]),f=v.useMemo(()=>{var L,$;if(!c)return null;const T=($=(L=e.data)==null?void 0:L.signals)==null?void 0:$.outlier_removal;return!Array.isArray(T)||!T.length?null:t?T.find(A=>A&&A.node_id===t)??T[T.length-1]??null:T[T.length-1]??null},[c,t,(j=(E=e.data)==null?void 0:E.signals)==null?void 0:j.outlier_removal]),g=v.useMemo(()=>{var L,$;if(!u)return null;const T=($=(L=e.data)==null?void 0:L.signals)==null?void 0:$.transformer_audit;return!Array.isArray(T)||!T.length?null:t?T.find(A=>A&&A.node_id===t)??T[T.length-1]??null:T[T.length-1]??null},[u,t,(M=(S=e.data)==null?void 0:S.signals)==null?void 0:M.transformer_audit]);return{featureMathSignals:d,polynomialSignal:p,featureSelectionSignal:h,outlierPreviewSignal:f,transformerAuditSignal:g}},GP=({isFeatureSelectionNode:e,featureSelectionSignal:t,upstreamTargetColumn:n,setConfigState:s})=>{v.useEffect(()=>{if(!e)return;const o=typeof(t==null?void 0:t.target_column)=="string"?t.target_column.trim():"",i=typeof n=="string"?n.trim():"",c=o||i;c&&s(u=>(typeof(u==null?void 0:u.target_column)=="string"?u.target_column.trim():"")?u:{...u,target_column:c})},[t==null?void 0:t.target_column,e,s,n]),v.useEffect(()=>{if(!e)return;const o=typeof(t==null?void 0:t.k)=="number"&&Number.isFinite(t.k)?Math.max(0,Math.trunc(t.k)):null,i=Array.isArray(t==null?void 0:t.selected_columns)?t.selected_columns.length:null,c=o??i??null;c===null||c<=0||s(u=>{const d=u==null?void 0:u.k;let p=null;if(typeof d=="number"&&Number.isFinite(d))p=Math.trunc(d);else if(typeof d=="string"){const h=Number(d);Number.isFinite(h)&&(p=Math.trunc(h))}return p!==null&&p<=c?u:{...u,k:c}})},[t==null?void 0:t.k,t==null?void 0:t.selected_columns,e,s])},qu=e=>String(e??"").trim(),QP=({isBinningNode:e,isScalingNode:t,setConfigState:n,binningExcludedColumns:s,scalingExcludedColumns:o,availableColumns:i,recommendations:c})=>{const u=v.useCallback((b,_,x)=>{const N=qu(b);N&&n(C=>{const E=C.manual_bounds&&typeof C.manual_bounds=="object"&&!Array.isArray(C.manual_bounds)?{...C.manual_bounds}:{},j=E[N]&&typeof E[N]=="object"?{...E[N]}:{lower:null,upper:null};if(x==="")_==="lower"?j.lower=null:j.upper=null;else{const T=Number(x);if(!Number.isFinite(T))return C;_==="lower"?j.lower=T:j.upper=T}const S=j.lower??null,M=j.upper??null;return S===null&&M===null?delete E[N]:E[N]={lower:S,upper:M},{...C,manual_bounds:E}})},[n]),d=v.useCallback(b=>{const _=qu(b);_&&n(x=>{const N=x.manual_bounds&&typeof x.manual_bounds=="object"&&!Array.isArray(x.manual_bounds)?x.manual_bounds:null;if(!N||!Object.prototype.hasOwnProperty.call(N,_))return x;const C={...N};return delete C[_],{...x,manual_bounds:C}})},[n]),p=v.useCallback(b=>{const _=qu(b);_&&n(x=>{const N=Ye(x.columns),C=N.includes(_),E=C?N.filter(T=>T!==_):[...N,_];let j=!1,S=x.manual_bounds;C&&S&&typeof S=="object"&&!Array.isArray(S)&&Object.prototype.hasOwnProperty.call(S,_)&&(S={...S},delete S[_],j=!0);const M={...x,columns:E};if(j&&(M.manual_bounds=S),e){const T=new Set(E);if(x.custom_bins&&typeof x.custom_bins=="object"&&!Array.isArray(x.custom_bins)){const P={};Object.entries(x.custom_bins).forEach(([L,$])=>{T.has(L)&&Array.isArray($)&&$.length&&(P[L]=[...$])}),Object.keys(P).length?M.custom_bins=P:"custom_bins"in M&&delete M.custom_bins}else"custom_bins"in M&&delete M.custom_bins;if(x.custom_labels&&typeof x.custom_labels=="object"&&!Array.isArray(x.custom_labels)){const P={};Object.entries(x.custom_labels).forEach(([L,$])=>{T.has(L)&&Array.isArray($)&&$.length&&(P[L]=$.map(A=>String(A)))}),Object.keys(P).length?M.custom_labels=P:"custom_labels"in M&&delete M.custom_labels}else"custom_labels"in M&&delete M.custom_labels;if(x.column_overrides&&typeof x.column_overrides=="object"&&!Array.isArray(x.column_overrides)){const P={};Object.entries(x.column_overrides).forEach(([L,$])=>{T.has(L)&&$&&typeof $=="object"&&!Array.isArray($)&&(P[L]={...$})}),Object.keys(P).length?(M.column_overrides=P,M.column_strategies=P):("column_overrides"in M&&delete M.column_overrides,"column_strategies"in M&&delete M.column_strategies)}else"column_overrides"in M&&delete M.column_overrides,"column_strategies"in M&&delete M.column_strategies}if(t){let T=null;x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)&&(T={},Object.entries(x.column_methods).forEach(([P,L])=>{const $=typeof L=="string"?L.trim():null;!$||!Ws.includes($)||C&&P===_||(T[P]=$)})),T&&Object.keys(T).length?M.column_methods=T:C&&Object.prototype.hasOwnProperty.call(M,"column_methods")&&delete M.column_methods}return M})},[e,t,n]),h=v.useCallback(()=>{c.length&&n(b=>{const _=new Set(Ye(b.columns));return c.forEach(x=>{x!=null&&x.name&&_.add(String(x.name))}),{...b,columns:Array.from(_)}})},[c,n]),f=v.useCallback(()=>{i.length&&n(b=>{const _=new Set(Ye(b.columns));return i.filter(N=>e?!s.has(N):t?!o.has(N):!0).forEach(N=>_.add(N)),{...b,columns:Array.from(_).sort((N,C)=>N.localeCompare(C))}})},[i,s,e,t,o,n]),g=v.useCallback(()=>{n(b=>{const _={...b,columns:[]};return b!=null&&b.manual_bounds&&typeof b.manual_bounds=="object"&&!Array.isArray(b.manual_bounds)&&Object.keys(b.manual_bounds).length&&(_.manual_bounds={}),e&&("custom_bins"in _&&delete _.custom_bins,"custom_labels"in _&&delete _.custom_labels,"column_overrides"in _&&delete _.column_overrides,"column_strategies"in _&&delete _.column_strategies),t&&"column_methods"in _&&delete _.column_methods,_})},[e,t,n]),w=v.useCallback(b=>{const _=qu(b);_&&n(x=>{const N=Ye(x.columns);if(!N.includes(_))return x;const C=N.filter(M=>M!==_);let E=!1,j=x.manual_bounds;j&&typeof j=="object"&&!Array.isArray(j)&&Object.prototype.hasOwnProperty.call(j,_)&&(j={...j},delete j[_],E=!0);const S={...x,columns:C};if(E&&(S.manual_bounds=j),e){if(x.custom_bins&&typeof x.custom_bins=="object"&&!Array.isArray(x.custom_bins)){const M={};Object.entries(x.custom_bins).forEach(([T,P])=>{T!==_&&Array.isArray(P)&&P.length&&(M[T]=[...P])}),Object.keys(M).length?S.custom_bins=M:"custom_bins"in S&&delete S.custom_bins}else"custom_bins"in S&&delete S.custom_bins;if(x.custom_labels&&typeof x.custom_labels=="object"&&!Array.isArray(x.custom_labels)){const M={};Object.entries(x.custom_labels).forEach(([T,P])=>{T!==_&&Array.isArray(P)&&P.length&&(M[T]=P.map(L=>String(L)))}),Object.keys(M).length?S.custom_labels=M:"custom_labels"in S&&delete S.custom_labels}else"custom_labels"in S&&delete S.custom_labels;if(x.column_overrides&&typeof x.column_overrides=="object"&&!Array.isArray(x.column_overrides)){const M={};Object.entries(x.column_overrides).forEach(([T,P])=>{T!==_&&P&&typeof P=="object"&&!Array.isArray(P)&&(M[T]={...P})}),Object.keys(M).length?(S.column_overrides=M,S.column_strategies=M):("column_overrides"in S&&delete S.column_overrides,"column_strategies"in S&&delete S.column_strategies)}else"column_overrides"in S&&delete S.column_overrides,"column_strategies"in S&&delete S.column_strategies}if(t)if(x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)){const M={};Object.entries(x.column_methods).forEach(([T,P])=>{const L=typeof P=="string"?P.trim():null;!L||!Ws.includes(L)||T!==_&&(M[T]=L)}),Object.keys(M).length?S.column_methods=M:Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods}else Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods;return S})},[e,t,n]);return{handleManualBoundChange:u,handleClearManualBound:d,handleToggleColumn:p,handleApplyAllRecommended:h,handleSelectAllColumns:f,handleClearColumns:g,handleRemoveColumn:w}},XP=({configState:e,isBinningNode:t,isScalingNode:n,nodeId:s,onUpdateConfig:o,onClose:i,sourceId:c,graphSnapshot:u,isInspectionNode:d,onUpdateNodeData:p,setConfigState:h,canResetNode:f,defaultConfigTemplate:g,onResetConfig:w})=>{const b=v.useCallback(x=>{if(!s)return;let N=$h(e);if(t){const C=jy(N);N={...N,strategy:C.strategy,columns:C.columns,equal_width_bins:C.equalWidthBins,equal_frequency_bins:C.equalFrequencyBins,include_lowest:C.includeLowest,precision:C.precision,duplicates:C.duplicates,output_suffix:C.outputSuffix,drop_original:C.dropOriginal,label_format:C.labelFormat,missing_strategy:C.missingStrategy},C.missingStrategy==="label"?N.missing_label=C.missingLabel:Object.prototype.hasOwnProperty.call(N,"missing_label")&&delete N.missing_label,Object.keys(C.customBins).length?N.custom_bins=C.customBins:Object.prototype.hasOwnProperty.call(N,"custom_bins")&&delete N.custom_bins,Object.keys(C.customLabels).length?N.custom_labels=C.customLabels:Object.prototype.hasOwnProperty.call(N,"custom_labels")&&delete N.custom_labels}if(n){const C=wx(N);N={...N,columns:C.columns,default_method:C.defaultMethod,auto_detect:C.autoDetect,skipped_columns:C.skippedColumns},Object.keys(C.columnMethods).length>0?N.column_methods=C.columnMethods:Object.prototype.hasOwnProperty.call(N,"column_methods")&&delete N.column_methods}o(s,N),(x==null?void 0:x.closeModal)!==!1&&i(),c&&u&&!d&&(p==null||p(s,{backgroundExecutionStatus:"loading"}),my({dataset_source_id:c,graph:{nodes:u.nodes||[],edges:u.edges||[]},target_node_id:s}).then(()=>{p==null||p(s,{backgroundExecutionStatus:"success"})}).catch(C=>{p==null||p(s,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",C)}))},[e,u,t,d,n,s,i,o,p,c]),_=v.useCallback(()=>{if(!f||!s)return;const x=$h(g??{});h(x),w==null||w(s,x)},[f,g,s,w,h]);return{handleSave:b,handleResetNode:_}},JP=e=>v.useMemo(()=>{const t=new Map;return e.forEach(n=>{n!=null&&n.name&&t.set(n.name,n)}),n=>t.get(n)??null},[e]),ZP=e=>{const t=v.useMemo(()=>{var u;const c=(u=e==null?void 0:e.data)==null?void 0:u.parameters;return Array.isArray(c)?c.filter(d=>!!(d!=null&&d.name)).map(d=>({...d})):[]},[e]),n=JP(t),s=v.useCallback((c,u)=>c?n(u):null,[n]),o=v.useMemo(()=>t.some(c=>{var u;return(c==null?void 0:c.type)==="multi_select"&&((u=c==null?void 0:c.source)==null?void 0:u.type)!=="drop_column_recommendations"}),[t]),i=v.useMemo(()=>t.find(c=>{var u;return((u=c==null?void 0:c.source)==null?void 0:u.type)==="drop_column_recommendations"})??null,[t]);return{parameters:t,getParameter:n,getParameterIf:s,requiresColumnCatalog:o,dropColumnParameter:i}},eL=(e,t)=>{const n=(s,o)=>s?e(o):null;return v.useMemo(()=>{const{isBinningNode:s,isScalingNode:o,isRemoveDuplicatesNode:i,isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isReplaceInvalidValuesNode:p,isRegexCleanupNode:h,isNormalizeTextCaseNode:f,isLabelEncodingNode:g,isHashEncodingNode:w,isPolynomialFeaturesNode:b,isFeatureSelectionNode:_,isFeatureMathNode:x,isClassUndersamplingNode:N,isClassOversamplingNode:C,isFeatureTargetSplitNode:E,isTrainModelDraftNode:j,isHyperparameterTuningNode:S,isTargetEncodingNode:M,isOrdinalEncodingNode:T,isDummyEncodingNode:P,isOneHotEncodingNode:L,isMissingIndicatorNode:$,isDropMissingRowsNode:A,isDropMissingColumnsNode:R}=t,W=N||C,z=j||S;return{binning:{columns:n(s,"columns")},scaling:{columns:n(o,"columns"),defaultMethod:n(o,"default_method"),autoDetect:n(o,"auto_detect")},removeDuplicates:{columns:n(i,"columns"),keep:n(i,"keep")},replaceAliases:{customPairs:n(c,"custom_pairs")},trimWhitespace:{columns:n(u,"columns"),mode:n(u,"mode")},removeSpecial:{columns:n(d,"columns"),mode:n(d,"mode"),replacement:n(d,"replacement")},replaceInvalid:{columns:n(p,"columns"),mode:n(p,"mode"),minValue:n(p,"min_value"),maxValue:n(p,"max_value")},regexCleanup:{columns:n(h,"columns"),mode:n(h,"mode"),pattern:n(h,"pattern"),replacement:n(h,"replacement")},normalizeCase:{columns:n(f,"columns"),mode:n(f,"mode")},labelEncoding:{columns:g?e("columns"):null,autoDetect:g?e("auto_detect"):null,maxUnique:g?e("max_unique_values"):null,outputSuffix:g?e("output_suffix"):null,dropOriginal:g?e("drop_original"):null,missingStrategy:g?e("missing_strategy"):null,missingCode:g?e("missing_code"):null},hashEncoding:{columns:w?e("columns"):null,autoDetect:w?e("auto_detect"):null,maxCategories:w?e("max_categories"):null,buckets:w?e("n_buckets"):null,outputSuffix:w?e("output_suffix"):null,dropOriginal:w?e("drop_original"):null,encodeMissing:w?e("encode_missing"):null},polynomial:{columns:n(b,"columns"),autoDetect:n(b,"auto_detect"),degree:n(b,"degree"),includeBias:n(b,"include_bias"),interactionOnly:n(b,"interaction_only"),includeInputFeatures:n(b,"include_input_features"),outputPrefix:n(b,"output_prefix")},featureSelection:{columns:n(_,"columns"),autoDetect:n(_,"auto_detect"),targetColumn:n(_,"target_column"),method:n(_,"method"),scoreFunc:n(_,"score_func"),problemType:n(_,"problem_type"),k:n(_,"k"),percentile:n(_,"percentile"),alpha:n(_,"alpha"),threshold:n(_,"threshold"),mode:n(_,"mode"),estimator:n(_,"estimator"),step:n(_,"step"),minFeatures:n(_,"min_features"),maxFeatures:n(_,"max_features"),dropUnselected:n(_,"drop_unselected")},featureMath:{errorHandling:n(x,"error_handling"),allowOverwrite:n(x,"allow_overwrite"),defaultTimezone:n(x,"default_timezone"),epsilon:n(x,"epsilon")},resampling:{method:n(W,"method"),targetColumn:n(W,"target_column"),samplingStrategy:n(W,"sampling_strategy"),randomState:n(W,"random_state"),kNeighbors:n(C,"k_neighbors"),replacement:n(N,"replacement")},featureTargetSplit:{targetColumn:n(E,"target_column")},trainModel:{targetColumn:n(z,"target_column"),problemType:n(z,"problem_type"),modelType:n(z,"model_type"),hyperparameters:n(j,"hyperparameters"),cvEnabled:n(z,"cv_enabled"),cvStrategy:n(z,"cv_strategy"),cvFolds:n(z,"cv_folds"),cvShuffle:n(z,"cv_shuffle"),cvRandomState:n(z,"cv_random_state"),cvRefitStrategy:n(j,"cv_refit_strategy")},hyperparameterTuning:{searchStrategy:n(S,"search_strategy"),searchIterations:n(S,"search_iterations"),searchRandomState:n(S,"search_random_state"),scoringMetric:n(S,"scoring_metric")},targetEncoding:{columns:M?e("columns"):null,targetColumn:M?e("target_column"):null,autoDetect:M?e("auto_detect"):null,maxCategories:M?e("max_categories"):null,outputSuffix:M?e("output_suffix"):null,dropOriginal:M?e("drop_original"):null,smoothing:M?e("smoothing"):null,encodeMissing:M?e("encode_missing"):null,handleUnknown:M?e("handle_unknown"):null},ordinalEncoding:{columns:T?e("columns"):null,autoDetect:T?e("auto_detect"):null,maxCategories:T?e("max_categories"):null,outputSuffix:T?e("output_suffix"):null,dropOriginal:T?e("drop_original"):null,encodeMissing:T?e("encode_missing"):null,handleUnknown:T?e("handle_unknown"):null,unknownValue:T?e("unknown_value"):null},dummyEncoding:{columns:P?e("columns"):null,autoDetect:P?e("auto_detect"):null,maxCategories:P?e("max_categories"):null,dropFirst:P?e("drop_first"):null,includeMissing:P?e("include_missing"):null,dropOriginal:P?e("drop_original"):null,prefixSeparator:P?e("prefix_separator"):null},oneHotEncoding:{columns:L?e("columns"):null,autoDetect:L?e("auto_detect"):null,maxCategories:L?e("max_categories"):null,dropFirst:L?e("drop_first"):null,includeMissing:L?e("include_missing"):null,dropOriginal:L?e("drop_original"):null,prefixSeparator:L?e("prefix_separator"):null},missingIndicator:{columns:n($,"columns"),suffix:n($,"flag_suffix")},dropRows:{any:n(A,"drop_if_any_missing")},dropMissing:{threshold:n(R||A,"missing_threshold")}}},[t,e])},tL=({isResetAvailable:e=!1,defaultConfigTemplate:t,catalogFlags:n})=>{const{isDataset:s,isScalingNode:o,isBinningNode:i,isBinnedDistributionNode:c,isSkewnessDistributionNode:u,isFeatureMathNode:d,isFeatureTargetSplitNode:p,isTrainTestSplitNode:h,isModelEvaluationNode:f,isHashEncodingNode:g,isPolynomialFeaturesNode:w,isFeatureSelectionNode:b,isDataConsistencyNode:_,isTrainModelDraftNode:x,isHyperparameterTuningNode:N,isClassUndersamplingNode:C,isClassOversamplingNode:E,isLabelEncodingNode:j,isTargetEncodingNode:S,isDummyEncodingNode:M,isOneHotEncodingNode:T,isOrdinalEncodingNode:P,isImputerNode:L,isMissingIndicatorNode:$,isReplaceAliasesNode:A,isTrimWhitespaceNode:R,isRemoveSpecialCharsNode:W,isReplaceInvalidValuesNode:z,isRegexCleanupNode:D,isNormalizeTextCaseNode:H,isStandardizeDatesNode:q,isCastNode:I,isRemoveDuplicatesNode:Q,isDropMissingNode:U,isOutlierNode:F}=n,K=v.useMemo(()=>!!(e&&!s&&t),[t,s,e]),V=[d,p,h,f,g,w,b,_,x,N,C||E,j,S,M,T,P,L,$,A,R,W,z,D,H,q,I,Q,U,F].some(Boolean),G=c||u;return{canResetNode:K,headerCanResetNode:K&&!(G||o||i||V),footerCanResetNode:K&&!G}},nL=({cachedPreviewSchema:e,catalogFlags:t,resamplingTargetColumn:n,imputerStrategies:s})=>{const{isClassOversamplingNode:o,isImputerNode:i}=t,c=v.useMemo(()=>(e==null?void 0:e.columns)??[],[e]),u=v.useMemo(()=>{if(!o||!c.length||!n)return null;const h=new Set(["numeric","integer","boolean"]),f=c.filter(g=>g&&g.name!==n).filter(g=>!h.has(String(g.logical_family??"unknown"))).map(g=>({name:g.name,logical_family:String(g.logical_family??"unknown")}));return f.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:f.map(g=>g.name),details:f}:null},[c,o,n]),d=v.useMemo(()=>{if(!i||!c.length||!s.length)return null;const h=new Set(["numeric","integer"]),f=new Map(c.map(w=>[w.name,w])),g=[];return s.forEach((w,b)=>{if(!Cy(w.method)||!Array.isArray(w.columns)||!w.columns.length)return;const _=w.columns.map(x=>f.get(x)).filter(x=>!!x).filter(x=>!h.has(String(x.logical_family??"unknown"))).map(x=>({name:x.name,logical_family:String(x.logical_family??"unknown")}));_.length&&g.push({index:b,columns:_.map(x=>x.name),details:_})}),g.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:g}:null},[c,s,i]),p=!!(u!=null&&u.blocked||d!=null&&d.blocked);return{cachedSchemaColumns:c,oversamplingSchemaGuard:u,imputationSchemaDiagnostics:d,skipPreview:p}},sL=e=>{var o,i,c;const t=v.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.columns;return Array.isArray(u)?u.filter(p=>typeof p=="string"):[]},[(o=e.data)==null?void 0:o.columns]),n=v.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.column_stats;return Array.isArray(u)?u:[]},[(i=e.data)==null?void 0:i.column_stats]),s=v.useMemo(()=>{var u;return Array.isArray((u=e.data)==null?void 0:u.sample_rows)?e.data.sample_rows:[]},[(c=e.data)==null?void 0:c.sample_rows]);return{previewColumns:t,previewColumnStats:n,previewSampleRows:s}},rL=({isProfileLoading:e,isPreviewLoading:t,isFetchingScaling:n,isFetchingBinning:s,isFetchingHashEncoding:o,isFetchingBinnedDistribution:i,isFetchingRecommendations:c,catalogFlags:u})=>{const{isPreviewNode:d}=u,p=v.useMemo(()=>e||t||n||s||o||i||c,[i,s,o,n,c,t,e]),h=v.useMemo(()=>e?"Generating dataset profile":n?"Loading scaling insights":s?"Loading binning insights":o?"Loading hash encoding insights":i?"Computing binned distributions":c?"Fetching column recommendations":t?d?"Loading dataset preview":"Analyzing node outputs":null,[i,s,o,c,n,t,d,e]);return{hasActiveAsyncWork:p,busyLabel:h,footerBusyLabel:h??(p?"Processing":null)}},Hu=e=>{const t=Number(e);return Number.isFinite(t)?Math.max(0,Math.round(t)):null},aL=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:o})=>{const i=v.useMemo(()=>Rn(e??null),[e]),c=v.useMemo(()=>Rn((t==null?void 0:t.generated_at)??null),[t==null?void 0:t.generated_at]),u=v.useMemo(()=>Rn((n==null?void 0:n.generated_at)??null),[n==null?void 0:n.generated_at]),d=v.useMemo(()=>Rn((s==null?void 0:s.generated_at)??null),[s==null?void 0:s.generated_at]),p=v.useMemo(()=>Rn((o==null?void 0:o.generated_at)??null),[o==null?void 0:o.generated_at]),h=v.useMemo(()=>Hu((t==null?void 0:t.sample_size)??null),[t==null?void 0:t.sample_size]),f=v.useMemo(()=>Hu((n==null?void 0:n.sample_size)??null),[n==null?void 0:n.sample_size]),g=v.useMemo(()=>Hu((s==null?void 0:s.sample_size)??null),[s==null?void 0:s.sample_size]),w=v.useMemo(()=>Hu((o==null?void 0:o.sample_size)??null),[o==null?void 0:o.sample_size]);return{relativeGeneratedAt:i,relativeScalingGeneratedAt:c,relativeBinningGeneratedAt:u,relativeBinnedGeneratedAt:d,relativeOutlierGeneratedAt:p,scalingSampleSize:h,binningSampleSize:f,binnedSampleSize:g,outlierSampleSize:w}},oL=({suggestedThreshold:e,thresholdParameterName:t,configState:n,handleParameterChange:s})=>{const o=v.useMemo(()=>{if(e===null||Number.isNaN(Number(e)))return null;const d=Number(e);return Math.round(d*10)/10},[e]),i=v.useMemo(()=>{if(t===null||o===null)return!1;const d=Number(n==null?void 0:n[t]);return!Number.isNaN(d)&&d===o},[n,o,t]),c=o!==null&&!i,u=v.useCallback(()=>{o===null||!t||s(t,o)},[s,o,t]);return{normalizedSuggestedThreshold:o,thresholdMatchesSuggestion:i,canApplySuggestedThreshold:c,handleApplySuggestedThreshold:u}},lL=(e,t,n)=>{const{isFeatureMathNode:s}=e,[o,i]=v.useState(()=>new Set),c=v.useMemo(()=>s?Eb((t==null?void 0:t.operations)??[]):[],[t==null?void 0:t.operations,s]),u=v.useMemo(()=>s?lT(c,n):[],[c,n,s]);return v.useEffect(()=>{if(!s){i(()=>new Set);return}i(d=>{if(!d.size)return d;const p=new Set(c.map(f=>f.id)),h=new Set;return d.forEach(f=>{p.has(f)&&h.add(f)}),h.size===d.size?d:h})},[c,s]),{featureMathOperations:c,featureMathSummaries:u,collapsedFeatureMath:o,setCollapsedFeatureMath:i}},iL="_was_missing",cL=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const s=typeof t=="string"?t.trim():"";return s||iL},uL=(e,t)=>{const n=typeof e=="string"?e.trim():"",s=typeof t=="string"?t:"";return!n||!s?!1:n.endsWith(s)},dL=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:s})=>{const o=typeof s=="string"?s:"",i=Ye(t),c=new Set(i),u=Array.from(new Set(Ye(e))),d=[];if(u.forEach(f=>{const g=`${f}${o}`,w=n[f],b=typeof w=="number"&&Number.isFinite(w)?Math.max(0,w):null;d.push({column:f,missingPercentage:b,flagColumn:g,conflicts:{alreadyExists:c.has(g),duplicateFlag:!1}})}),d.length>0){const f=new Map;d.forEach(g=>{f.set(g.flagColumn,(f.get(g.flagColumn)??0)+1)}),d.forEach(g=>{g.conflicts.duplicateFlag=(f.get(g.flagColumn)??0)>1})}d.sort((f,g)=>{const w=f.missingPercentage,b=g.missingPercentage,_=typeof w=="number",x=typeof b=="number";return _&&x&&w!==b?b-w:_!==x?_?-1:1:f.column.localeCompare(g.column)});const p=o?Array.from(new Set(i.filter(f=>uL(f,o)))):[],h=d.reduce((f,g)=>g.conflicts.alreadyExists||g.conflicts.duplicateFlag?f+1:f,0);return{rows:d,flaggedColumnsInDataset:p,conflictCount:h}},mL=({catalogFlags:e,configState:t,node:n,availableColumns:s,columnMissingMap:o})=>{var p,h;const{isMissingIndicatorNode:i}=e,c=v.useMemo(()=>{var f,g;return i?cL(t==null?void 0:t.flag_suffix,(g=(f=n==null?void 0:n.data)==null?void 0:f.config)==null?void 0:g.flag_suffix):""},[t==null?void 0:t.flag_suffix,i,(h=(p=n==null?void 0:n.data)==null?void 0:p.config)==null?void 0:h.flag_suffix]),u=v.useMemo(()=>i?Ye(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,i]),d=v.useMemo(()=>i?dL({selectedColumns:u,availableColumns:s,columnMissingMap:o,suffix:c}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[c,s,o,i,u]);return{activeFlagSuffix:c,missingIndicatorColumns:u,missingIndicatorInsights:d}},hL=({node:e,graphContext:t,hasReachableSource:n,sourceId:s,formatRelativeTime:o,catalogFlags:i})=>{const{isDatasetProfileNode:c}=i,u=v.useMemo(()=>t?Hi(t):"",[t]),d=$k({node:e,isDatasetProfileNode:c,sourceId:s,hasReachableSource:n,graphContext:t,profilingGraphSignature:u,formatRelativeTime:o}),{profileState:p}=d;return{datasetProfileController:d,profileState:p}},fL=({parameter:e,nodeId:t,configState:n,handleNumberChange:s,handleBooleanChange:o,handleTextChange:i,thresholdParameterName:c,normalizedSuggestedThreshold:u,showRecommendations:d,canApplySuggestedThreshold:p,thresholdMatchesSuggestion:h,handleApplySuggestedThreshold:f,renderMultiSelect:g})=>{var _;if(!(e!=null&&e.name))return null;if(e.type==="multi_select")return a.jsx(a.Fragment,{children:g(e)});if(e.type==="number"){const x=`node-${t}-${e.name}`,N=n==null?void 0:n[e.name],C=typeof N=="number"?N:N??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx("input",{id:x,type:"number",className:"canvas-modal__input",value:C,min:e.min!==void 0?e.min:void 0,max:e.max!==void 0?e.max:void 0,step:e.step!==void 0?e.step:"any",onChange:E=>s(e.name,E.target.value)}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),c===e.name&&u!==null&&d&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:Yn(u)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:!p,children:h?"Applied":"Apply suggestion"})]})]},e.name)}if(e.type==="boolean"){const x=`node-${t}-${e.name}`,N=!!(n!=null&&n[e.name]);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:x,children:e.label})}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:x,type:"checkbox",checked:N,onChange:C=>o(e.name,C.target.checked)}),a.jsx("span",{children:N?"Enabled":"Disabled"})]})]},e.name)}if(e.type==="select"){const x=`node-${t}-${e.name}`,N=Array.isArray(e.options)?e.options:[],C=n==null?void 0:n[e.name],E=typeof e.default=="string"?e.default:((_=N.find(S=>S&&typeof S.value=="string"))==null?void 0:_.value)??"",j=typeof C=="string"&&C.trim().length?C:E;return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("select",{id:x,className:"canvas-modal__input",value:j,onChange:S=>i(e.name,S.target.value),children:N.map(S=>a.jsx("option",{value:S.value,title:S.description??void 0,children:S.label??S.value},S.value))})]},e.name)}if(e.type==="textarea"){const x=`node-${t}-${e.name}`;if(e.name==="hyperparameters"){let C="",E=n==null?void 0:n[e.name];if(typeof E=="string"&&E.trim())try{const j=JSON.parse(E);j&&typeof j=="object"&&!Array.isArray(j)?C=Object.entries(j).map(([S,M])=>`${S}: ${JSON.stringify(M)}`).join(`
`):C=E}catch{C=E}else E&&typeof E=="object"&&!Array.isArray(E)&&(C=Object.entries(E).map(([j,S])=>`${j}: ${JSON.stringify(S)}`).join(`
`));return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description||"Enter parameters as key: value pairs (one per line)"}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:C,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:j=>{const M=j.target.value.split(`
`).filter(P=>P.trim()),T={};for(const P of M){const L=P.indexOf(":");if(L===-1)continue;const $=P.substring(0,L).trim(),A=P.substring(L+1).trim();if($)try{T[$]=JSON.parse(A)}catch{T[$]=A}}i(e.name,JSON.stringify(T,null,2))},rows:6})]},e.name)}const N=typeof(n==null?void 0:n[e.name])=="string"?n==null?void 0:n[e.name]:"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:N,placeholder:e.placeholder??"",onChange:C=>i(e.name,C.target.value),rows:4})]},e.name)}const w=`node-${t}-${e.name}`,b=(n==null?void 0:n[e.name])??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:w,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("input",{id:w,type:"text",className:"canvas-modal__input canvas-modal__input--wide",value:b,placeholder:e.placeholder??"",onChange:x=>i(e.name,x.target.value)})]},e.name)},pL=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:s,recommendations:o,filteredRecommendations:i,isFetchingRecommendations:c,recommendationsError:u,relativeGeneratedAt:d,formatSignalName:p,formatMissingPercentage:h,getPriorityClass:f,getPriorityLabel:g,handleToggleColumn:w,selectedColumns:b})=>{const _=x=>{if(!(x!=null&&x.name))return null;const N=String(x.name),C=b.includes(N),E=f(x.priority),j=g(x.priority),S=Array.isArray(x==null?void 0:x.signals)?x.signals.map(M=>p(M)).filter(M=>!!M):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:C,onChange:()=>w(N)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:N}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[x.missing_percentage!==void 0&&x.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${h(x.missing_percentage)}`}),E&&j&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${E}`,children:j})]}),S.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:S.map(M=>a.jsx("span",{className:"canvas-modal__signal-badge",children:M},`${N}-${M}`))}),x.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:x.reason})]})]},N)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>s(null),children:["All reasons (",o.length,")"]}),t.map(x=>{const N=n===x.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${N?" canvas-modal__filter-button--active":""}`,onClick:()=>s(C=>C===x.id?null:x.id),title:x.description??void 0,children:[x.label," (",x.count,")"]},x.id)})]}),c&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!c&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!c&&!u&&a.jsxs(a.Fragment,{children:[d&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",d,"."]}),i.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:i.map(x=>_(x))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},gL=({parameter:e,previewStateStatus:t,isBinningNode:n,isScalingNode:s,binningAllNumericColumns:o,binningRecommendedColumnSet:i,selectedColumns:c,availableColumns:u,scalingExcludedColumns:d,normalizedColumnSearch:p,filteredColumnOptions:h,binningExcludedColumns:f,selectionCount:g,isCastNode:w,columnSuggestions:b,sourceId:_,isFetchingRecommendations:x,hasReachableSource:N,refreshRecommendations:C,availableFilters:E,activeFilterId:j,setActiveFilterId:S,recommendations:M,filteredRecommendations:T,recommendationsError:P,relativeGeneratedAt:L,formatSignalName:$,handleToggleColumn:A,handleRemoveColumn:R,handleApplyAllRecommended:W,handleBinningApplyColumns:z,handleSelectAllColumns:D,handleClearColumns:H,columnSearch:q,setColumnSearch:I,columnMissingMap:Q,columnTypeMap:U,binningColumnPreviewMap:F,isImputerNode:K,showRecommendations:re})=>{var De;const Y=((De=e==null?void 0:e.source)==null?void 0:De.type)==="drop_column_recommendations",V=!Y,G=V&&t==="loading",X=n&&e.name==="columns",se=s&&e.name==="columns",J=(()=>{if(!X)return[];const ce=[...o];return i.size>0&&i.forEach(Te=>{ce.includes(Te)||ce.push(Te)}),c.forEach(Te=>{Te&&!ce.includes(Te)&&ce.push(Te)}),ce})(),te=X?J:se?u.filter(ce=>!d.has(ce)):u,Se=X?p?J.filter(ce=>ce.toLowerCase().includes(p)):J:se?h.filter(ce=>!d.has(ce)):h,ze=X?c.filter(ce=>!f.has(ce)).length:se?c.filter(ce=>!d.has(ce)).length:g,Oe=V&&te.length>0&&ze>=te.length,Ue=Y||K,nt=new Set(te),He=w&&V?Object.entries(b).filter(([ce,Te])=>nt.has(ce)&&Te.length>0).map(([ce,Te])=>`${ce}: ${Te.join(", ")}`).slice(0,4):[],de=X?Array.from(f).slice(0,4):[],_e=se?Array.from(d).slice(0,4):[],je=X&&i.size>0,Me=je?Array.from(i).some(ce=>!c.includes(ce)):!1;return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),Y&&_&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:C,disabled:x||!N,children:x?"Refreshing":"Refresh suggestions"})})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),He.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",He.join("; ")]}),X&&f.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",f.size," non-numeric column",f.size===1?"":"s",de.length?` (examples: ${de.join(", ")}${f.size>de.length?", ":""})`:""," binning only supports numeric inputs."]}),se&&d.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",d.size," non-numeric column",d.size===1?"":"s",_e.length?` (examples: ${_e.join(", ")}${d.size>_e.length?", ":""})`:""," scaling only supports numeric inputs."]}),Y&&a.jsx(pL,{sourceId:_,availableFilters:E,activeFilterId:j,setActiveFilterId:S,recommendations:M,filteredRecommendations:T,isFetchingRecommendations:x,recommendationsError:P,relativeGeneratedAt:L,formatSignalName:$,formatMissingPercentage:Yn,getPriorityClass:Dk,getPriorityLabel:Fk,handleToggleColumn:A,selectedColumns:c}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:ze})]}),ze>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:c.map(ce=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[ce,a.jsx("button",{type:"button",onClick:()=>R(ce),"aria-label":`Remove ${ce}`,children:""})]},ce))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[Y&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:W,disabled:!M.length,children:"Use all recommendations"}),je&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>z(i),disabled:!Me,children:"Add recommended columns"}),V&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:D,disabled:!te.length||Oe,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:H,disabled:!g,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:q,onChange:ce=>I(ce.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:Se.length?Se.map(ce=>{const Te=c.includes(ce),Qe=Object.prototype.hasOwnProperty.call(Q,ce)?Q[ce]:void 0,ht=Yn(typeof Qe=="number"?Qe:null),rt=U[ce]??null,gt=b[ce]??[],at=X?F[ce]:void 0,ut=!!(at&&(at.min!==null&&at.min!==void 0||at.max!==null&&at.max!==void 0)),Ot=X?(at==null?void 0:at.distinct)??null:null,Rt=X&&Ot!==null&&Number.isFinite(Ot),Xe=Rt?Ot:null,Bt=!X,Kt=Bt||Ue||ut||Rt,kt=Bt&&gt.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${Te?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:Te,onChange:()=>A(ce)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:ce}),Kt&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Bt&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",ZT(rt)]}),Ue&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",ht]}),ut&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[X?"Sample range":"Range",":"," ",at&&at.min!==null&&at.min!==void 0?bs(at.min):""," ",""," ",at&&at.max!==null&&at.max!==void 0?bs(at.max):""]}),Rt&&Xe!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",Hs(Xe)]})]}),kt&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",gt.join(", ")]})]})]},ce)}):a.jsx("p",{className:"canvas-modal__note",children:u.length?X&&te.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":G?"Loading column catalog":_?N?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},e.name)},_L=({setConfigState:e,imputationMethodValues:t,imputationMethodOptions:n,imputerStrategyCount:s,setCollapsedStrategies:o,setImputerMissingFilter:i})=>{const c=v.useCallback(_=>{e(x=>{const N=Ey(x==null?void 0:x.strategies,t),C=_(N).map(E=>({...E,options:Li(E.method,E.options)}));return{...x,strategies:uM(C)}})},[t,e]),u=v.useCallback(()=>{var N;const _=s,x=((N=n[0])==null?void 0:N.value)??"mean";c(C=>[...C,{method:x,columns:[],options:Li(x,Sy(x))}]),o(C=>{const E=new Set(C);return E.delete(_),E})},[n,s,c,o]),d=v.useCallback(_=>{c(x=>x.filter((N,C)=>C!==_)),o(x=>{const N=new Set;return x.forEach(C=>{C!==_&&N.add(C>_?C-1:C)}),N})},[c,o]),p=v.useCallback(_=>{o(x=>{const N=new Set(x);return N.has(_)?N.delete(_):N.add(_),N})},[o]),h=v.useCallback((_,x)=>{c(N=>N.map((C,E)=>E===_?{...C,method:x,options:Li(x,C.options)}:C))},[c]),f=v.useCallback((_,x,N)=>{c(C=>C.map((E,j)=>{if(j!==_)return E;const S={...E.options??{}};if(N==="")delete S[x];else{const M=Number(N);if(!Number.isFinite(M))return E;S[x]=M}return{...E,options:Li(E.method,S)}}))},[c]),g=v.useCallback((_,x)=>{const N=x.split(",").map(C=>C.trim()).filter(Boolean);c(C=>C.map((E,j)=>j===_?{...E,columns:N}:E))},[c]),w=v.useCallback((_,x)=>{const N=x.trim();N&&c(C=>C.map((E,j)=>{if(j!==_)return E;const M=E.columns.includes(N)?E.columns.filter(T=>T!==N):[...E.columns,N];return M.sort((T,P)=>T.localeCompare(P)),{...E,columns:M}}))},[c]),b=v.useCallback(_=>{i(_)},[i]);return{updateImputerStrategies:c,handleAddImputerStrategy:u,handleRemoveImputerStrategy:d,toggleImputerStrategySection:p,handleImputerMethodChange:h,handleImputerOptionNumberChange:f,handleImputerColumnsChange:g,handleImputerColumnToggle:w,handleImputerMissingFilterChange:b}},vL=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,aliasColumnSummary:o,aliasStrategyCount:i})=>{var _;const{isReplaceAliasesNode:c}=e,u=v.useCallback(x=>{c&&n(N=>{var R,W,z,D,H,q,I,Q,U;if(!c)return N;const C=Ye((N==null?void 0:N.columns)??((W=(R=t==null?void 0:t.data)==null?void 0:R.config)==null?void 0:W.columns)),E=Cu(N==null?void 0:N.mode,(D=(z=t==null?void 0:t.data)==null?void 0:z.config)==null?void 0:D.mode),j=(()=>{var re;const F=Sl(N);if(F!==void 0){const Y=jo(F);if(Y!==null)return Y}const K=Sl((re=t==null?void 0:t.data)==null?void 0:re.config);if(K!==void 0){const Y=jo(K);if(Y!==null)return Y}return C.length===0})(),S=(N==null?void 0:N.alias_strategies)??(N==null?void 0:N.strategies)??((q=(H=t==null?void 0:t.data)==null?void 0:H.config)==null?void 0:q.alias_strategies)??((Q=(I=t==null?void 0:t.data)==null?void 0:I.config)==null?void 0:Q.strategies),M=Py(S,{mode:E,columns:C,autoDetect:j}),T=x(M).map(F=>({mode:Cu(F.mode,E),columns:Array.from(new Set(F.columns.map(K=>K.trim()).filter(Boolean))).sort((K,re)=>K.localeCompare(re)),autoDetect:!!F.autoDetect})),P=OM(T),L=Array.from(new Set(T.flatMap(F=>F.columns))).sort((F,K)=>F.localeCompare(K)),$=((U=T[0])==null?void 0:U.mode)??E,A=T.length?T.some(F=>F.autoDetect):j;return{...N,alias_strategies:P,columns:L,mode:$,auto_detect:A}})},[c,(_=t==null?void 0:t.data)==null?void 0:_.config,n]),d=v.useCallback(()=>{if(!c)return;const x=i;u(N=>{var M;const C=new Set;N.forEach(T=>{T.columns.forEach(P=>{const L=P.trim();L&&C.add(L)})});const E=o.recommendedColumns.find(T=>!C.has(T)),S={mode:N.length?N[N.length-1].mode:((M=Ty[0])==null?void 0:M.value)??bh,columns:E?[E]:[],autoDetect:!E};return[...N,S]}),s(N=>{const C=new Set(N);return C.delete(x),C})},[o.recommendedColumns,i,c,s,u]),p=v.useCallback(x=>{u(N=>N.filter((C,E)=>E!==x)),s(N=>{const C=new Set;return N.forEach(E=>{E!==x&&C.add(E>x?E-1:E)}),C})},[s,u]),h=v.useCallback(x=>{s(N=>{const C=new Set(N);return C.has(x)?C.delete(x):C.add(x),C})},[s]),f=v.useCallback((x,N)=>{u(C=>C.map((E,j)=>j===x?{...E,mode:N}:E))},[u]),g=v.useCallback((x,N)=>{const C=N.trim();C&&u(E=>E.map((j,S)=>{if(S!==x)return j;const T=j.columns.includes(C)?j.columns.filter(P=>P!==C):[...j.columns,C];return T.sort((P,L)=>P.localeCompare(L)),{...j,columns:T}}))},[u]),w=v.useCallback((x,N)=>{const C=N.split(",").map(j=>j.trim()).filter(Boolean),E=Array.from(new Set(C)).sort((j,S)=>j.localeCompare(S));u(j=>j.map((S,M)=>M===x?{...S,columns:E}:S))},[u]),b=v.useCallback((x,N)=>{u(C=>C.map((E,j)=>j===x?{...E,autoDetect:N}:E))},[u]);return{updateAliasStrategies:u,handleAddAliasStrategy:d,handleRemoveAliasStrategy:p,toggleAliasStrategySection:h,handleAliasModeChange:f,handleAliasColumnToggle:g,handleAliasColumnsChange:w,handleAliasAutoDetectToggle:b}},yL=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,dateStrategies:o,standardizeDatesColumnSummary:i,standardizeDatesMode:c})=>{var x,N,C,E,j,S;const{isStandardizeDatesNode:u}=e,d=v.useCallback(M=>{n(T=>{var H,q,I,Q,U,F,K;if(!u)return T;const P=Ye((T==null?void 0:T.columns)??((q=(H=t==null?void 0:t.data)==null?void 0:H.config)==null?void 0:q.columns)),L=Vy(T==null?void 0:T.mode,(Q=(I=t==null?void 0:t.data)==null?void 0:I.config)==null?void 0:Q.mode),$=P.length===0,A=Wy((T==null?void 0:T.format_strategies)??((F=(U=t==null?void 0:t.data)==null?void 0:U.config)==null?void 0:F.format_strategies),{columns:P,mode:L,autoDetect:$}),R=M(A),W=rA(R),z=Array.from(new Set(R.flatMap(re=>re.columns.map(Y=>Y.trim()).filter(Boolean)))).sort((re,Y)=>re.localeCompare(Y)),D=((K=R[0])==null?void 0:K.mode)??L;return{...T,format_strategies:W,columns:z,mode:D}})},[u,(N=(x=t==null?void 0:t.data)==null?void 0:x.config)==null?void 0:N.columns,(E=(C=t==null?void 0:t.data)==null?void 0:C.config)==null?void 0:E.format_strategies,(S=(j=t==null?void 0:t.data)==null?void 0:j.config)==null?void 0:S.mode,n]),p=v.useCallback(()=>{const M=o.length;d(T=>{var R;const P=new Set;T.forEach(W=>{W.columns.forEach(z=>{const D=z.trim();D&&P.add(D)})});const L=i.recommendedColumns.find(W=>!P.has(W)),A={mode:T.length?T[T.length-1].mode:((R=Nh[0])==null?void 0:R.value)??c,columns:L?[L]:[],autoDetect:!L};return[...T,A]}),s(T=>{const P=new Set(T);return P.delete(M),P})},[o.length,s,i.recommendedColumns,c,d]),h=v.useCallback(M=>{d(T=>T.filter((P,L)=>L!==M)),s(T=>{const P=new Set;return T.forEach(L=>{L!==M&&P.add(L>M?L-1:L)}),P})},[s,d]),f=v.useCallback(M=>{s(T=>{const P=new Set(T);return P.has(M)?P.delete(M):P.add(M),P})},[s]),g=v.useCallback((M,T)=>{d(P=>P.map((L,$)=>$===M?{...L,mode:T}:L))},[d]),w=v.useCallback((M,T)=>{const P=T.split(",").map(L=>L.trim()).filter(Boolean).sort((L,$)=>L.localeCompare($));d(L=>L.map(($,A)=>A===M?{...$,columns:P}:$))},[d]),b=v.useCallback((M,T)=>{const P=T.trim();P&&d(L=>L.map(($,A)=>{if(A!==M)return $;const W=$.columns.includes(P)?$.columns.filter(z=>z!==P):[...$.columns,P];return W.sort((z,D)=>z.localeCompare(D)),{...$,columns:W}}))},[d]),_=v.useCallback((M,T)=>{d(P=>P.map((L,$)=>$===M?{...L,autoDetect:T}:L))},[d]);return{updateDateStrategies:d,handleAddDateStrategy:p,handleRemoveDateStrategy:h,toggleDateStrategySection:f,handleDateStrategyModeChange:g,handleDateStrategyColumnsChange:w,handleDateStrategyColumnToggle:b,handleDateStrategyAutoDetectToggle:_}},bL=new Set(Ou.map(e=>e.value)),Gi=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),Nx=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),Cx=e=>{const n=Gi(e).filter(s=>bL.has(s));return n.length?n:["year","month","day"]},Qi=e=>e==null?null:Number.isFinite(e)?e:null,Sx=e=>{const t=Qi(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},Ex=e=>typeof e!="string"?"UTC":e.trim()||"UTC",xL=({catalogFlags:e,setConfigState:t,setCollapsedFeatureMath:n})=>{const{isFeatureMathNode:s}=e,o=v.useCallback(f=>{t(g=>{if(!s)return g;const w=g&&typeof g=="object"&&!Array.isArray(g)?{...g}:{},b=Eb(Array.isArray(g==null?void 0:g.operations)?g.operations:[]),_=f(b);return w.operations=aT(_),w})},[s,t]),i=v.useCallback(f=>{if(!s)return;let g="";o(w=>{const b=new Set(w.map(x=>x.id)),_=kb(f,b);return g=_.id,[...w,_]}),g&&n(w=>{const b=new Set(w);return b.delete(g),b})},[s,n,o]),c=v.useCallback(f=>{if(!s)return;let g="";o(w=>{const b=w.findIndex(j=>j.id===f);if(b===-1)return w;const _=w[b],x=new Set(w.map(j=>j.id)),N=kb(_.type,x);g=N.id;const C={..._,id:N.id,inputColumns:[..._.inputColumns],secondaryColumns:[..._.secondaryColumns],constants:[..._.constants],datetimeFeatures:[..._.datetimeFeatures],outputColumn:_.outputColumn?`${_.outputColumn}_copy`:""},E=[...w];return E.splice(b+1,0,C),E}),g&&n(w=>{const b=new Set(w);return b.delete(g),b})},[s,n,o]),u=v.useCallback(f=>{s&&(o(g=>g.filter(w=>w.id!==f)),n(g=>{const w=new Set(g);return w.delete(f),w}))},[s,n,o]),d=v.useCallback((f,g)=>{s&&o(w=>{const b=w.findIndex(C=>C.id===f);if(b===-1)return w;const _=g==="up"?b-1:b+1;if(_<0||_>=w.length)return w;const x=[...w],[N]=x.splice(b,1);return x.splice(_,0,N),x})},[s,o]),p=v.useCallback(f=>{n(g=>{const w=new Set(g);return w.has(f)?w.delete(f):w.add(f),w})},[n]),h=v.useCallback((f,g)=>{s&&o(w=>w.map(b=>{if(b.id!==f)return b;let _={...b};if(g.type&&(_.type=g.type),g.method!==void 0&&(_.method=g.method),g.inputColumns!==void 0&&(_.inputColumns=Gi(g.inputColumns)),g.secondaryColumns!==void 0&&(_.secondaryColumns=Gi(g.secondaryColumns)),g.constants!==void 0&&(_.constants=Nx(g.constants)),g.outputColumn!==void 0&&(_.outputColumn=g.outputColumn.trim()),g.outputPrefix!==void 0&&(_.outputPrefix=g.outputPrefix.trim()),g.datetimeFeatures!==void 0&&(_.datetimeFeatures=Cx(g.datetimeFeatures)),g.timezone!==void 0&&(_.timezone=Ex(g.timezone)),g.fillna!==void 0&&(_.fillna=Qi(g.fillna)),g.roundDigits!==void 0&&(_.roundDigits=Sx(g.roundDigits)),g.normalize!==void 0&&(_.normalize=g.normalize),g.epsilon!==void 0&&(_.epsilon=Qi(g.epsilon)),g.allowOverwrite!==void 0&&(_.allowOverwrite=g.allowOverwrite),g.description!==void 0){const C=typeof g.description=="string"?g.description.trim():"";_.description=C||void 0}const x=_.type,N=Mb(x);return N.length?new Set(N.map(E=>E.value)).has(_.method)||(_.method=N[0].value):x==="ratio"?_.method="ratio":x==="datetime_extract"&&(_.method="datetime_extract"),_.inputColumns=Gi(_.inputColumns),x==="ratio"||x==="similarity"?_.secondaryColumns=Gi(_.secondaryColumns):_.secondaryColumns=[],_.constants=Nx(_.constants),_.fillna=Qi(_.fillna),_.roundDigits=Sx(_.roundDigits),_.epsilon=Qi(_.epsilon),x==="datetime_extract"?(_.datetimeFeatures=Cx(_.datetimeFeatures),_.timezone=Ex(_.timezone)):(_.datetimeFeatures=[],_.timezone="UTC"),x!=="similarity"?_.normalize=!1:_.normalize=!!_.normalize,typeof _.allowOverwrite!="boolean"&&(_.allowOverwrite=null),_.outputColumn=_.outputColumn.trim(),_.outputPrefix=_.outputPrefix.trim(),_}))},[s,o]);return{updateFeatureMathOperations:o,handleAddFeatureMathOperation:i,handleDuplicateFeatureMathOperation:c,handleRemoveFeatureMathOperation:u,handleReorderFeatureMathOperation:d,handleToggleFeatureMathOperation:p,handleFeatureMathOperationChange:h}},wL=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:s,sourceId:o,graphSnapshot:i,onResetConfig:c,defaultConfigTemplate:u,isResetAvailable:d=!1})=>{var Ql,Wa,Yo,ia,xc;const{metadata:p,title:h}=z$(e),{connectionInfo:f,connectedHandleKeys:g,connectedOutputHandleKeys:w,evaluationSplitConnectivity:b,connectionReady:_,gatedSectionStyle:x,gatedAriaDisabled:N}=D$(e,i??null),C=l$(e),{catalogType:E,isDataset:j,isImputerNode:S,isMissingIndicatorNode:M,isReplaceAliasesNode:T,isTrimWhitespaceNode:P,isRemoveSpecialCharsNode:L,isReplaceInvalidValuesNode:$,isRegexCleanupNode:A,isNormalizeTextCaseNode:R,isStandardizeDatesNode:W,isLabelEncodingNode:z,isTargetEncodingNode:D,isHashEncodingNode:H,isFeatureTargetSplitNode:q,isTrainTestSplitNode:I,isTrainModelDraftNode:Q,isModelEvaluationNode:U,isModelRegistryNode:F,isHyperparameterTuningNode:K,isClassUndersamplingNode:re,isClassOversamplingNode:Y,isOrdinalEncodingNode:V,isDummyEncodingNode:G,isOneHotEncodingNode:X,isFeatureMathNode:se,isCastNode:J,isBinningNode:te,isScalingNode:Se,isPolynomialFeaturesNode:ze,isFeatureSelectionNode:Oe,isTransformerAuditNode:Ue,isOutlierNode:nt,isSkewnessNode:He,isSkewnessDistributionNode:de,isBinnedDistributionNode:_e,isDataConsistencyNode:je,isInspectionNode:Me,isRemoveDuplicatesNode:De,isDropMissingColumnsNode:ce,isDropMissingRowsNode:Te,isDropMissingNode:Qe,isPreviewNode:ht,isDatasetProfileNode:rt}=C,gt=j,at=re||Y,ut=v.useMemo(()=>rM,[]),Ot=v.useMemo(()=>ut.map(Dt=>Dt.value),[ut]),{parameters:Rt,getParameter:Xe,requiresColumnCatalog:Bt,dropColumnParameter:Kt}=ZP(e),kt=v.useMemo(()=>j$[E]??null,[E]),_t=typeof(e==null?void 0:e.id)=="string"?e.id:"",{canResetNode:Cn,headerCanResetNode:Lt,footerCanResetNode:rn}=tL({isResetAvailable:d,defaultConfigTemplate:u,catalogFlags:C}),fe=eL(Xe,C),Ut=F$(Rt,C),dt=v.useMemo(()=>je?Ut:[],[Ut,je]),Tn=He||de,{configState:qe,setConfigState:wt,stableInitialConfig:mt,stableCurrentConfig:Ns,nodeChangeVersion:Gt}=I$({node:e}),{handleParameterChange:vt,handleNumberChange:jt,handleBooleanChange:Gn,handleTextChange:on}=B$({setConfigState:wt}),Sn=v.useMemo(()=>F?qe?{...qe}:{}:null,[qe,F]),Zt=v.useMemo(()=>Ey(qe==null?void 0:qe.strategies,Ot),[qe==null?void 0:qe.strategies,Ot]),$n=Zt.length,ln=v.useMemo(()=>yh(ky(qe==null?void 0:qe.transformations)),[qe==null?void 0:qe.transformations]),{graphContext:Ht,graphNodes:It,graphNodeCount:Fn,upstreamNodeIds:cn,upstreamTargetColumn:vn,hasReachableSource:et}=IP({graphSnapshot:i??null,nodeId:_t,isDataset:j}),{featureTargetSplitConfig:Qn,trainTestSplitConfig:Cs,resamplingConfig:In,trainModelDraftConfig:Xn,trainModelRuntimeConfig:Ss,trainModelCVConfig:Bn,filteredModelTypeOptions:Qt}=b$({configState:qe,setConfigState:wt,catalogFlags:C,upstreamTargetColumn:vn,nodeId:_t,modelTypeOptions:((Ql=fe.trainModel.modelType)==null?void 0:Ql.options)??null}),Tt=v.useMemo(()=>{if(!cn.length)return{};const Dt={};return cn.forEach(Xs=>{var ua;const ca=It.find(Go=>Go&&typeof Go.id=="string"&&Go.id===Xs);if(!ca)return;const Ka=((ua=ca==null?void 0:ca.data)==null?void 0:ua.config)??null;Dt[Xs]=Ka}),Dt},[It,cn]),lt=v.useMemo(()=>Hi({sourceId:o??null,nodeId:_t||null,config:qe,upstreamIds:cn,upstreamConfig:Tt}),[qe,_t,o,Tt,cn]),[Ks,Un]=v.useState(null),{cachedSchemaColumns:Ys,oversamplingSchemaGuard:os,imputationSchemaDiagnostics:_r,skipPreview:le}=nL({cachedPreviewSchema:Ks,catalogFlags:C,resamplingTargetColumn:(In==null?void 0:In.targetColumn)??null,imputerStrategies:Zt}),{availableColumns:ge,setAvailableColumns:Pe,columnSearch:Nt,setColumnSearch:we,columnMissingMap:tt,setColumnMissingMap:it,columnTypeMap:Ct,setColumnTypeMap:$t,columnSuggestions:en,setColumnSuggestions:qt,imputerMissingFilter:un,setImputerMissingFilter:Es}=VP({requiresColumnCatalog:Bt,catalogFlags:C,nodeId:_t,sourceId:o,hasReachableSource:et}),Jn=!!Kt,{hasDropColumnSource:En,availableFilters:kn,activeFilterId:Zn,setActiveFilterId:qn,recommendations:Tr,filteredRecommendations:Ra,formatSignalName:bt,isFetchingRecommendations:ea,recommendationsError:Da,recommendationsGeneratedAt:Fo,suggestedThreshold:Bl,refreshRecommendations:Io}=_k({hasDropColumnSource:Jn,sourceId:o,nodeId:_t,graphContext:Ht,hasReachableSource:et,columnTypeMap:Ct,setAvailableColumns:Pe,setColumnSearch:we,setColumnMissingMap:it,setColumnTypeMap:$t,setColumnSuggestions:qt});h$({shouldLoad:S,sourceId:o,hasReachableSource:et,graphContext:Ht,targetNodeId:(e==null?void 0:e.id)??null,setAvailableColumns:Pe,setColumnMissingMap:it});const{labelEncoding:vr,targetEncoding:sr,hashEncoding:ks,ordinalEncoding:es,dummyEncoding:Z,oneHotEncoding:pe}=hP({catalogFlags:C,sourceId:o,hasReachableSource:et,graphContext:Ht,node:e,configState:qe,setConfigState:wt,nodeChangeVersion:Gt}),[me,ke]=v.useState("500"),[Ce,ye]=v.useState(()=>new Set);v.useEffect(()=>{ye(new Set)},[mt]);const{datasetProfileController:st,profileState:Ie}=hL({node:e,graphContext:Ht,hasReachableSource:et,sourceId:o,formatRelativeTime:Rn,catalogFlags:C}),{previewState:We,refreshPreview:ot,clearCachedPreviewSchema:Ge,canTriggerPreview:Et}=qP({graphSnapshot:i??null,graphNodeCount:Fn,hasReachableSource:et,sourceId:o,node:e,nodeId:_t,previewSignature:lt,skipPreview:le,cachedPreviewSchema:Ks,setCachedPreviewSchema:Un,catalogFlags:C}),{featureMathSignals:Mn,polynomialSignal:Vt,featureSelectionSignal:yn,outlierPreviewSignal:Ms,transformerAuditSignal:As}=YP({previewState:We,nodeId:_t,catalogFlags:C});GP({isFeatureSelectionNode:Oe,featureSelectionSignal:yn,upstreamTargetColumn:vn,setConfigState:wt});const{featureMathOperations:Gs,featureMathSummaries:$r,collapsedFeatureMath:rr,setCollapsedFeatureMath:ts}=lL(C,qe,Mn),{outlierData:ls,outlierError:Fa,isFetchingOutliers:Os,refreshOutliers:ta}=f$({isOutlierNode:nt,sourceId:o,hasReachableSource:et,graphContext:Ht,targetNodeId:_t||null}),{scalingData:Pr,scalingError:Ia,isFetchingScaling:na,refreshScaling:sa}=i$({isScalingNode:Se,sourceId:o,hasReachableSource:et,graphContext:Ht,targetNodeId:(e==null?void 0:e.id)??null}),{binningData:ra,binningError:Pn,isFetchingBinning:tn,refreshBinning:aa}=c$({isBinningNode:te,sourceId:o,hasReachableSource:et,graphContext:Ht,targetNodeId:(e==null?void 0:e.id)??null}),Ts=v.useCallback(()=>{Ge(),ot(),Se&&sa(),te&&aa(),nt&&ta()},[te,nt,Se,aa,ta,Ge,ot,sa]),{binnedDistributionData:Ul,binnedDistributionError:Bo,isFetchingBinnedDistribution:nn,refreshBinnedDistribution:bn}=d$({isBinnedDistributionNode:_e,sourceId:o,hasReachableSource:et,graphContext:Ht,targetNodeId:(e==null?void 0:e.id)??null,samplePreset:me}),{skewnessData:is,skewnessError:Uo,isFetchingSkewness:Qu,refreshSkewness:of}=u$({shouldLoad:Tn,sourceId:o,graphContext:Ht,targetNodeId:(e==null?void 0:e.id)??null,transformations:ln}),{previewColumns:rc,previewColumnStats:ac,previewSampleRows:ql}=sL(We),{activeFlagSuffix:oc,missingIndicatorInsights:lf}=mL({catalogFlags:C,configState:qe,node:e,availableColumns:ge,columnMissingMap:tt}),cf=!!o&&et,uf=v.useMemo(()=>{var Dt;return Ye((Dt=e==null?void 0:e.data)==null?void 0:Dt.columns)},[(Wa=e==null?void 0:e.data)==null?void 0:Wa.columns]),{alias:Lr,trimWhitespace:lc,removeSpecial:ic,regexCleanup:qo,normalizeCase:Hl,replaceInvalid:zr,standardizeDates:oa}=FP({isReplaceAliasesNode:T,isTrimWhitespaceNode:P,isRemoveSpecialCharsNode:L,isRegexCleanupNode:A,isNormalizeTextCaseNode:R,isReplaceInvalidValuesNode:$,isStandardizeDatesNode:W,configState:qe,nodeConfig:((Yo=e==null?void 0:e.data)==null?void 0:Yo.config)??null,availableColumns:ge,columnTypeMap:Ct,previewSampleRows:ql}),df=te||Se||nt,{numericExcludedColumns:Xu}=v$({shouldAnalyze:df,availableColumns:ge,columnTypeMap:Ct,previewSampleRows:ql}),{scaling:dn,outlier:mn,binning:ft,selectedColumns:Qs}=kP({isScalingNode:Se,isOutlierNode:nt,isBinningNode:te,configState:qe,setConfigState:wt,nodeId:_t,numericExcludedColumns:Xu,scalingData:Pr,outlierData:ls,binningData:ra,availableColumns:ge,previewSampleRows:ql});WP({previewState:We,previewSampleRows:ql,activeFlagSuffix:oc??"",setColumnTypeMap:$t,setColumnSuggestions:qt}),KP({previewState:We,activeFlagSuffix:oc??"",hasReachableSource:et,requiresColumnCatalog:Bt,nodeColumns:uf,selectedColumns:Qs,setAvailableColumns:Pe,setColumnMissingMap:it});const mf=`${_t||"node"}-remove-duplicates-keep`,hf=v.useMemo(()=>{const Dt=typeof(qe==null?void 0:qe.keep)=="string"?qe.keep.trim().toLowerCase():"";return Dt==="last"||Dt==="none"?Dt:yk},[qe==null?void 0:qe.keep]),Ho=v.useMemo(()=>Nt.trim().toLowerCase(),[Nt]),Ju=v.useMemo(()=>Ho?ge.filter(Dt=>Dt.toLowerCase().includes(Ho)):ge,[ge,Ho]),cc=v.useCallback(Dt=>{wt(Xs=>{const ca=yh(ky(Xs==null?void 0:Xs.transformations)),Ka=yh(Dt(ca));return{...Xs,transformations:Ka.map(ua=>({...ua}))}})},[]),Xt=w$({skewnessData:is,shouldLoadInsights:Tn,skewnessTransformations:ln,availableColumns:ge,previewColumns:rc,columnTypeMap:Ct,updateSkewnessTransformations:cc}),{imputerColumnOptions:ff,imputerMissingSliderMax:Zu,imputerFilteredOptionCount:ed,imputerMissingFilterActive:td}=y$({isImputerNode:S,imputerStrategies:Zt,availableColumns:ge,columnMissingMap:tt,previewColumns:rc,previewColumnStats:ac,nodeColumns:(ia=e==null?void 0:e.data)==null?void 0:ia.columns,imputerMissingFilter:un}),Vl=((xc=fe.dropMissing.threshold)==null?void 0:xc.name)??null,{normalizedSuggestedThreshold:uc,thresholdMatchesSuggestion:la,canApplySuggestedThreshold:nd,handleApplySuggestedThreshold:sd}=oL({suggestedThreshold:Bl,thresholdParameterName:Vl,configState:qe,handleParameterChange:vt}),pf=Te&&!!(fe.dropMissing.threshold||fe.dropRows.any),{handleToggleColumn:yr,handleApplyAllRecommended:dc,handleSelectAllColumns:Ba,handleClearColumns:Ua,handleRemoveColumn:rd}=QP({isBinningNode:te,isScalingNode:Se,setConfigState:wt,binningExcludedColumns:ft.state.excludedColumns,scalingExcludedColumns:dn.state.excludedColumns,availableColumns:ge,recommendations:Tr}),{handleSave:qa,handleResetNode:ad}=XP({configState:qe,isBinningNode:te,isScalingNode:Se,nodeId:_t,onUpdateConfig:n,onClose:t,sourceId:o,graphSnapshot:i??null,isInspectionNode:Me,onUpdateNodeData:s,setConfigState:wt,canResetNode:Cn,defaultConfigTemplate:u,onResetConfig:c}),mc=Qs.length,{relativeGeneratedAt:Wl,relativeScalingGeneratedAt:hc,relativeBinningGeneratedAt:od,relativeBinnedGeneratedAt:ld,relativeOutlierGeneratedAt:id,scalingSampleSize:gf,binningSampleSize:_f,binnedSampleSize:vf,outlierSampleSize:yf}=aL({recommendationsGeneratedAt:Fo,scalingData:Pr,binningData:ra,binnedDistributionData:Ul,outlierData:ls}),Kl=En&&!!o&&et,$s=!gt&&!Me,Vo=$s&&mt!==Ns,cd=Ie.status==="loading",ud=We.status==="loading",{hasActiveAsyncWork:dd,footerBusyLabel:md}=rL({isProfileLoading:cd,isPreviewLoading:ud,isFetchingScaling:na,isFetchingBinning:tn,isFetchingHashEncoding:ks.isFetching,isFetchingBinnedDistribution:nn,isFetchingRecommendations:ea,catalogFlags:C}),{handleAddImputerStrategy:fc,handleRemoveImputerStrategy:bf,toggleImputerStrategySection:xf,handleImputerMethodChange:Ha,handleImputerOptionNumberChange:pc,handleImputerColumnsChange:Wo,handleImputerColumnToggle:gc,handleImputerMissingFilterChange:hd}=_L({setConfigState:wt,imputationMethodValues:Ot,imputationMethodOptions:ut,imputerStrategyCount:$n,setCollapsedStrategies:ye,setImputerMissingFilter:Es}),{handleAddAliasStrategy:Yl,handleRemoveAliasStrategy:Va,toggleAliasStrategySection:_c,handleAliasModeChange:fd,handleAliasColumnToggle:Gl,handleAliasColumnsChange:pd,handleAliasAutoDetectToggle:gd}=vL({catalogFlags:C,node:e,setConfigState:wt,setCollapsedStrategies:ye,aliasColumnSummary:Lr.columnSummary,aliasStrategyCount:Lr.strategyCount}),{handleAddDateStrategy:_d,handleRemoveDateStrategy:vd,toggleDateStrategySection:yd,handleDateStrategyModeChange:bd,handleDateStrategyColumnsChange:Rr,handleDateStrategyColumnToggle:vc,handleDateStrategyAutoDetectToggle:yc}=yL({catalogFlags:C,node:e,setConfigState:wt,setCollapsedStrategies:ye,dateStrategies:oa.strategies,standardizeDatesColumnSummary:oa.columnSummary,standardizeDatesMode:oa.mode}),{handleAddFeatureMathOperation:wf,handleDuplicateFeatureMathOperation:jf,handleRemoveFeatureMathOperation:Ko,handleReorderFeatureMathOperation:Nf,handleToggleFeatureMathOperation:xd,handleFeatureMathOperationChange:wd}=xL({catalogFlags:C,setConfigState:wt,setCollapsedFeatureMath:ts}),Yt=v.useCallback(()=>{o&&bn()},[bn,o]),bc=m$(_e,Ul),Ps=v.useCallback(Dt=>a.jsx(gL,{parameter:Dt,previewStateStatus:We.status,isBinningNode:te,isScalingNode:Se,binningAllNumericColumns:ft.state.allNumericColumns,binningRecommendedColumnSet:ft.state.recommendedColumnSet,selectedColumns:Qs,availableColumns:ge,scalingExcludedColumns:dn.state.excludedColumns,normalizedColumnSearch:Ho,filteredColumnOptions:Ju,binningExcludedColumns:ft.state.excludedColumns,selectionCount:mc,isCastNode:J,columnSuggestions:en,sourceId:o,isFetchingRecommendations:ea,hasReachableSource:et,refreshRecommendations:Io,availableFilters:kn,activeFilterId:Zn,setActiveFilterId:qn,recommendations:Tr,filteredRecommendations:Ra,recommendationsError:Da,relativeGeneratedAt:Wl,formatSignalName:bt,handleToggleColumn:yr,handleRemoveColumn:rd,handleApplyAllRecommended:dc,handleBinningApplyColumns:ft.handlers.handleApplyColumns,handleSelectAllColumns:Ba,handleClearColumns:Ua,columnSearch:Nt,setColumnSearch:we,columnMissingMap:tt,columnTypeMap:Ct,binningColumnPreviewMap:ft.state.columnPreviewMap,isImputerNode:S,showRecommendations:Kl}),[Zn,ge,kn,tt,Nt,en,Ct,ft.state.allNumericColumns,Xu,Ju,Ra,bt,dc,ft.handlers.handleApplyColumns,Ua,rd,Ba,yr,et,J,ea,te,ft.state.recommendedColumnSet,ft.state.columnPreviewMap,S,Se,ft.state.excludedColumns,We.status,Tr,Da,Wl,Qs,mc,qn,we,dn.state.excludedColumns,Kl,o,Io,Ho]),Mt=v.useCallback(Dt=>a.jsx(fL,{parameter:Dt,nodeId:e.id,configState:qe,handleNumberChange:jt,handleBooleanChange:Gn,handleTextChange:on,thresholdParameterName:Vl,normalizedSuggestedThreshold:uc,showRecommendations:Kl,canApplySuggestedThreshold:nd,thresholdMatchesSuggestion:la,handleApplySuggestedThreshold:sd,renderMultiSelect:Ps}),[nd,qe,sd,Gn,jt,on,e.id,uc,Ps,Kl,la,Vl]),jd=v.useCallback(Dt=>{wt(Xs=>({...Xs,keep:Dt}))},[wt]);return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(zk,{title:h,isDataset:gt,onClose:t,canResetNode:Lt,onResetNode:ad}),a.jsxs("div",{className:"canvas-modal__body",children:[f&&a.jsx(R$,{connectionInfo:f,connectedInputHandles:g,connectedOutputHandles:w,connectionReady:_}),pf&&a.jsx(vk,{thresholdParameter:fe.dropMissing.threshold??null,dropIfAnyParameter:fe.dropRows.any,renderParameterField:Mt}),Kt&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),fe.dropMissing.threshold&&Mt(fe.dropMissing.threshold),Ps(Kt)]}),M&&a.jsxs(a.Fragment,{children:[a.jsx(xM,{suffix:oc,insights:lf,formatMissingPercentage:Yn}),(fe.missingIndicator.columns||fe.missingIndicator.suffix)&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[fe.missingIndicator.columns?Mt(fe.missingIndicator.columns):null,fe.missingIndicator.suffix?Mt(fe.missingIndicator.suffix):null]})]})]}),ht&&a.jsx(Tk,{previewState:We,datasetSourceId:o??null,canTriggerPreview:Et,onRefresh:Ts,formatCellValue:Bb,formatMetricValue:Hs,formatMissingPercentage:Yn,formatNumericStat:bs,formatModeStat:xy}),a.jsx(Pk,{isDatasetProfileNode:rt,controller:st,formatCellValue:Bb,formatNumericStat:bs,formatMissingPercentage:Yn}),kt&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",children:[a.jsxs("strong",{children:[kt.title,"."]})," ",kt.body]})}),P&&a.jsx(EA,{sourceId:o,hasReachableSource:et,columnsParameter:fe.trimWhitespace.columns,modeParameter:fe.trimWhitespace.mode,renderMultiSelectField:Ps,renderParameterField:Mt,columnSummary:lc.columnSummary,modeDetails:lc.modeDetails,sampleMap:lc.sampleMap}),L&&a.jsx(WA,{sourceId:o,hasReachableSource:et,columnsParameter:fe.removeSpecial.columns,modeParameter:fe.removeSpecial.mode,replacementParameter:fe.removeSpecial.replacement,renderMultiSelectField:Ps,renderParameterField:Mt,columnSummary:ic.columnSummary,modeDetails:ic.modeDetails,sampleMap:ic.sampleMap}),$&&a.jsx(XO,{sourceId:o,hasReachableSource:et,columnsParameter:fe.replaceInvalid.columns,modeParameter:fe.replaceInvalid.mode,minValueParameter:fe.replaceInvalid.minValue,maxValueParameter:fe.replaceInvalid.maxValue,renderMultiSelectField:Ps,renderParameterField:Mt,columnSummary:zr.columnSummary,modeDetails:zr.modeDetails,sampleMap:zr.sampleMap,selectedMode:zr.mode,minValue:zr.minValue,maxValue:zr.maxValue}),A&&a.jsx(EO,{sourceId:o,hasReachableSource:et,columnsParameter:fe.regexCleanup.columns,modeParameter:fe.regexCleanup.mode,patternParameter:fe.regexCleanup.pattern,replacementParameter:fe.regexCleanup.replacement,renderMultiSelectField:Ps,renderParameterField:Mt,columnSummary:qo.columnSummary,modeDetails:qo.modeDetails,sampleMap:qo.sampleMap,selectedMode:qo.selectedMode,replacementValue:qo.replacementValue}),R&&a.jsx(cO,{sourceId:o,hasReachableSource:et,columnsParameter:fe.normalizeCase.columns,modeParameter:fe.normalizeCase.mode,renderMultiSelectField:Ps,renderParameterField:Mt,columnSummary:Hl.columnSummary,modeDetails:Hl.modeDetails,sampleMap:Hl.sampleMap,selectedMode:Hl.selectedMode}),se&&a.jsx(gT,{operations:Gs,summaries:$r,collapsed:rr,onToggleCollapsed:xd,onAddOperation:wf,onDuplicateOperation:jf,onRemoveOperation:Ko,onReorderOperation:Nf,onOperationChange:wd,availableColumns:ge,signals:Mn,previewStatus:We.status,errorHandlingParameter:fe.featureMath.errorHandling,allowOverwriteParameter:fe.featureMath.allowOverwrite,defaultTimezoneParameter:fe.featureMath.defaultTimezone,epsilonParameter:fe.featureMath.epsilon,renderParameterField:Mt}),V&&a.jsx(OT,{sourceId:o,hasReachableSource:et,isFetching:es.isFetching,error:es.error,suggestions:es.suggestions,metadata:es.metadata,columnsParameter:fe.ordinalEncoding.columns,autoDetectParameter:fe.ordinalEncoding.autoDetect,maxCategoriesParameter:fe.ordinalEncoding.maxCategories,outputSuffixParameter:fe.ordinalEncoding.outputSuffix,dropOriginalParameter:fe.ordinalEncoding.dropOriginal,encodeMissingParameter:fe.ordinalEncoding.encodeMissing,handleUnknownParameter:fe.ordinalEncoding.handleUnknown,unknownValueParameter:fe.ordinalEncoding.unknownValue,selectedColumns:Qs,renderParameterField:Mt,onToggleColumn:yr,onApplyRecommended:es.handleApplyRecommended,formatMissingPercentage:Yn}),D&&a.jsx(wT,{sourceId:o,hasReachableSource:et,isFetching:sr.isFetching,error:sr.error,suggestions:sr.suggestions,metadata:sr.metadata,columnsParameter:fe.targetEncoding.columns,targetColumnParameter:fe.targetEncoding.targetColumn,autoDetectParameter:fe.targetEncoding.autoDetect,maxCategoriesParameter:fe.targetEncoding.maxCategories,outputSuffixParameter:fe.targetEncoding.outputSuffix,dropOriginalParameter:fe.targetEncoding.dropOriginal,smoothingParameter:fe.targetEncoding.smoothing,encodeMissingParameter:fe.targetEncoding.encodeMissing,handleUnknownParameter:fe.targetEncoding.handleUnknown,selectedColumns:Qs,renderParameterField:Mt,onToggleColumn:yr,onApplyRecommended:sr.handleApplyRecommended,formatMissingPercentage:Yn}),G&&a.jsx(PT,{sourceId:o,hasReachableSource:et,isFetching:Z.isFetching,error:Z.error,suggestions:Z.suggestions,metadata:Z.metadata,columnsParameter:fe.dummyEncoding.columns,autoDetectParameter:fe.dummyEncoding.autoDetect,maxCategoriesParameter:fe.dummyEncoding.maxCategories,dropFirstParameter:fe.dummyEncoding.dropFirst,includeMissingParameter:fe.dummyEncoding.includeMissing,dropOriginalParameter:fe.dummyEncoding.dropOriginal,prefixSeparatorParameter:fe.dummyEncoding.prefixSeparator,selectedColumns:Qs,renderParameterField:Mt,onToggleColumn:yr,onApplyRecommended:Z.handleApplyRecommended,formatMissingPercentage:Yn}),X&&a.jsx(RT,{sourceId:o,hasReachableSource:et,isFetching:pe.isFetching,error:pe.error,suggestions:pe.suggestions,metadata:pe.metadata,columnsParameter:fe.oneHotEncoding.columns,autoDetectParameter:fe.oneHotEncoding.autoDetect,maxCategoriesParameter:fe.oneHotEncoding.maxCategories,dropFirstParameter:fe.oneHotEncoding.dropFirst,includeMissingParameter:fe.oneHotEncoding.includeMissing,dropOriginalParameter:fe.oneHotEncoding.dropOriginal,prefixSeparatorParameter:fe.oneHotEncoding.prefixSeparator,selectedColumns:Qs,renderParameterField:Mt,onToggleColumn:yr,onApplyRecommended:pe.handleApplyRecommended,formatMissingPercentage:Yn}),q&&a.jsx(VT,{nodeId:_t,sourceId:o,hasReachableSource:et,previewState:We,onRefreshPreview:Ts,config:Qn,targetColumnParameter:fe.featureTargetSplit.targetColumn,renderParameterField:Mt,formatMetricValue:Hs,formatMissingPercentage:Yn}),I&&a.jsx(KT,{nodeId:_t,sourceId:o,hasReachableSource:et,previewState:We,onRefreshPreview:Ts,config:Cs,parameters:Rt,renderParameterField:Mt,formatMetricValue:Hs}),at&&a.jsx(s$,{mode:Y?"oversampling":"undersampling",sourceId:o,hasReachableSource:et,previewState:We,onRefreshPreview:Ts,config:In,methodParameter:fe.resampling.method,targetColumnParameter:fe.resampling.targetColumn,samplingStrategyParameter:fe.resampling.samplingStrategy,randomStateParameter:fe.resampling.randomState,kNeighborsParameter:Y?fe.resampling.kNeighbors:null,replacementParameter:re?fe.resampling.replacement:null,renderParameterField:Mt,formatMetricValue:Hs,formatMissingPercentage:Yn,schemaGuard:os}),(Q||K)&&a.jsx(JT,{sourceId:o,hasReachableSource:et,previewState:We,onRefreshPreview:Ts,config:Xn,targetColumnParameter:fe.trainModel.targetColumn,problemTypeParameter:fe.trainModel.problemType,renderParameterField:Mt,formatMetricValue:Hs,formatMissingPercentage:Yn,schemaColumns:Ys}),Q&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(p2,{nodeId:_t,sourceId:o,graph:Ht,config:Xn,runtimeConfig:Ss,cvConfig:Bn,draftConfigState:qe,renderParameterField:Mt,modelTypeParameter:fe.trainModel.modelType,modelTypeOptions:Qt,hyperparametersParameter:fe.trainModel.hyperparameters,cvEnabledParameter:fe.trainModel.cvEnabled,cvStrategyParameter:fe.trainModel.cvStrategy,cvFoldsParameter:fe.trainModel.cvFolds,cvShuffleParameter:fe.trainModel.cvShuffle,cvRandomStateParameter:fe.trainModel.cvRandomState,cvRefitStrategyParameter:fe.trainModel.cvRefitStrategy,onSaveDraftConfig:qa})}),U&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(N2,{nodeId:_t,sourceId:o,graph:Ht,config:qe,setConfigState:wt,renderParameterField:Mt,formatMetricValue:Hs,connectedSplitHandles:b})}),F&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(U2,{nodeId:_t,sourceId:o,graph:Ht,parameters:Rt,config:Sn,renderParameterField:Mt})}),K&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(Z2,{nodeId:_t,sourceId:o,graph:Ht,config:Xn,runtimeConfig:Ss,cvConfig:Bn,draftConfigState:qe,renderParameterField:Mt,modelTypeParameter:fe.trainModel.modelType,modelTypeOptions:Qt,searchStrategyParameter:fe.hyperparameterTuning.searchStrategy,searchIterationsParameter:fe.hyperparameterTuning.searchIterations,searchRandomStateParameter:fe.hyperparameterTuning.searchRandomState,scoringMetricParameter:fe.hyperparameterTuning.scoringMetric,setDraftConfigState:wt,onSaveDraftConfig:qa})}),z&&a.jsx(yT,{sourceId:o,hasReachableSource:et,isFetching:vr.isFetching,error:vr.error,suggestions:vr.suggestions,metadata:vr.metadata,columnsParameter:fe.labelEncoding.columns,autoDetectParameter:fe.labelEncoding.autoDetect,maxUniqueParameter:fe.labelEncoding.maxUnique,outputSuffixParameter:fe.labelEncoding.outputSuffix,dropOriginalParameter:fe.labelEncoding.dropOriginal,missingStrategyParameter:fe.labelEncoding.missingStrategy,missingCodeParameter:fe.labelEncoding.missingCode,selectedColumns:Qs,renderParameterField:Mt,onToggleColumn:yr,onApplyRecommended:vr.handleApplyRecommended,formatMissingPercentage:Yn}),H&&a.jsx(CT,{sourceId:o,hasReachableSource:et,isFetching:ks.isFetching,error:ks.error,suggestions:ks.suggestions,metadata:ks.metadata,columnsParameter:fe.hashEncoding.columns,autoDetectParameter:fe.hashEncoding.autoDetect,maxCategoriesParameter:fe.hashEncoding.maxCategories,bucketsParameter:fe.hashEncoding.buckets,outputSuffixParameter:fe.hashEncoding.outputSuffix,dropOriginalParameter:fe.hashEncoding.dropOriginal,encodeMissingParameter:fe.hashEncoding.encodeMissing,selectedColumns:Qs,renderParameterField:Mt,onToggleColumn:yr,onApplyRecommended:ks.handleApplyRecommended,formatMissingPercentage:Yn}),ze&&a.jsx(ST,{columnsParameter:fe.polynomial.columns,autoDetectParameter:fe.polynomial.autoDetect,degreeParameter:fe.polynomial.degree,includeBiasParameter:fe.polynomial.includeBias,interactionOnlyParameter:fe.polynomial.interactionOnly,includeInputFeaturesParameter:fe.polynomial.includeInputFeatures,outputPrefixParameter:fe.polynomial.outputPrefix,renderParameterField:Mt,signal:Vt}),Oe&&a.jsx(kT,{columnsParameter:fe.featureSelection.columns,autoDetectParameter:fe.featureSelection.autoDetect,targetColumnParameter:fe.featureSelection.targetColumn,methodParameter:fe.featureSelection.method,scoreFuncParameter:fe.featureSelection.scoreFunc,problemTypeParameter:fe.featureSelection.problemType,kParameter:fe.featureSelection.k,percentileParameter:fe.featureSelection.percentile,alphaParameter:fe.featureSelection.alpha,thresholdParameter:fe.featureSelection.threshold,modeParameter:fe.featureSelection.mode,estimatorParameter:fe.featureSelection.estimator,stepParameter:fe.featureSelection.step,minFeaturesParameter:fe.featureSelection.minFeatures,maxFeaturesParameter:fe.featureSelection.maxFeatures,dropUnselectedParameter:fe.featureSelection.dropUnselected,renderParameterField:Mt,signal:yn}),W&&a.jsx(cA,{hasSource:!!o,hasReachableSource:et,strategies:oa.strategies,columnSummary:oa.columnSummary,columnOptions:oa.columnOptions,sampleMap:oa.sampleMap,collapsedStrategies:Ce,onToggleStrategy:yd,onRemoveStrategy:vd,onAddStrategy:_d,onModeChange:bd,onColumnToggle:vc,onColumnsChange:Rr,onAutoDetectToggle:yc,modeOptions:Nh}),T&&a.jsx(YM,{hasSource:!!o,hasReachableSource:et,strategies:Lr.strategies,columnSummary:Lr.columnSummary,columnOptions:Lr.columnOptions,sampleMap:Lr.sampleMap,customPairSummary:Lr.customPairSummary,customPairsParameter:fe.replaceAliases.customPairs,collapsedStrategies:Ce,onToggleStrategy:_c,onRemoveStrategy:Va,onAddStrategy:Yl,onModeChange:fd,onAutoDetectToggle:gd,onColumnToggle:Gl,onColumnsChange:pd,renderParameterField:Mt}),S&&a.jsx(dM,{hasSource:!!o,hasReachableSource:et,strategies:Zt,columnOptions:ff,methodOptions:ut,missingFilter:un,missingFilterMax:Zu,missingFilterActive:td,filteredOptionCount:ed,collapsedStrategies:Ce,onToggleStrategy:xf,onRemoveStrategy:bf,onAddStrategy:fc,onMethodChange:Ha,onOptionNumberChange:pc,onColumnsChange:Wo,onColumnToggle:gc,onMissingFilterChange:hd,formatMissingPercentage:Yn,formatNumericStat:bs,formatModeStat:xy,schemaDiagnostics:_r}),J&&a.jsx(jk,{configState:qe,setConfigState:wt,availableColumns:ge,columnTypeMap:Ct,columnSuggestions:en,selectedColumns:Qs,previewColumns:rc,previewStatus:We.status,sourceId:o,hasReachableSource:et}),nt&&a.jsx(L$,{sourceId:o,hasReachableSource:et,isFetchingOutliers:Os,outlierConfig:mn.config,outlierMethodOptions:mn.state.methodOptions,outlierMethodDetailMap:mn.state.methodDetailMap,outlierDefaultDetail:mn.state.defaultDetail,outlierAutoDetectEnabled:mn.state.autoDetectEnabled,outlierSelectedCount:mn.state.selectedCount,outlierDefaultLabel:mn.state.defaultLabel,outlierOverrideCount:mn.state.overrideCount,outlierParameterOverrideCount:mn.state.parameterOverrideCount,outlierOverrideExampleSummary:mn.state.overrideExampleSummary,outlierHasOverrides:mn.state.hasOverrides,outlierRecommendationRows:mn.state.recommendationRows,outlierHasRecommendations:mn.state.hasRecommendations,outlierStatusMessage:mn.state.statusMessage,outlierError:Fa,outlierSampleSize:yf,relativeOutlierGeneratedAt:id,outlierPreviewSignal:Ms,formatMetricValue:Hs,formatNumericStat:bs,onApplyAllRecommendations:mn.handlers.handleApplyAllRecommendations,onClearOverrides:mn.handlers.handleClearOverrides,onDefaultMethodChange:mn.handlers.handleDefaultMethodChange,onAutoDetectToggle:mn.handlers.handleAutoDetectToggle,onOverrideSelect:mn.handlers.handleOverrideSelect,onMethodParameterChange:mn.handlers.handleMethodParameterChange,onColumnParameterChange:mn.handlers.handleColumnParameterChange}),Se&&a.jsx(mM,{sourceId:o,hasReachableSource:et,isFetchingScaling:na,scalingConfig:dn.config,scalingMethodOptions:dn.state.methodOptions,scalingMethodDetailMap:dn.state.methodDetailMap,scalingDefaultDetail:dn.state.defaultDetail,scalingAutoDetectEnabled:dn.state.autoDetectEnabled,scalingSelectedCount:dn.state.selectedCount,scalingDefaultLabel:dn.state.defaultLabel,scalingOverrideCount:dn.state.overrideCount,scalingOverrideExampleSummary:dn.state.overrideExampleSummary,scalingRecommendationRows:dn.state.recommendationRows,scalingHasRecommendations:dn.state.hasRecommendations,scalingStatusMessage:dn.state.statusMessage,scalingError:Ia,scalingSampleSize:gf,relativeScalingGeneratedAt:hc,formatMetricValue:Hs,formatNumericStat:bs,formatMissingPercentage:Yn,onApplyAllRecommendations:dn.handlers.handleApplyAllRecommendations,onClearOverrides:dn.handlers.handleClearOverrides,onDefaultMethodChange:dn.handlers.handleDefaultMethodChange,onAutoDetectToggle:dn.handlers.handleAutoDetectToggle,onOverrideSelect:dn.handlers.handleOverrideSelect}),te&&a.jsxs(a.Fragment,{children:[a.jsx(eM,{hasSource:!!o,hasReachableSource:et,isFetching:tn,error:Pn,relativeGeneratedAt:od,sampleSize:_f,binningConfig:ft.config,binningDefaultLabel:ft.state.defaultLabel,binningOverrideCount:ft.state.overrideCount,binningOverrideSummary:ft.state.overrideSummary,recommendations:ft.state.insightsRecommendations,excludedColumns:ft.state.insightsExcludedColumns,numericColumnCount:ft.state.allNumericColumns.length,canApplyAllNumeric:ft.state.canApplyAllNumeric,onApplyAllNumeric:ft.handlers.handleApplyAllNumeric,onApplyStrategies:ft.handlers.handleApplyStrategies,onClearOverrides:ft.handlers.handleClearOverrides,customEdgeDrafts:ft.state.customEdgeDrafts,customLabelDrafts:ft.state.customLabelDrafts,onOverrideStrategyChange:ft.handlers.handleOverrideStrategyChange,onOverrideNumberChange:ft.handlers.handleOverrideNumberChange,onOverrideKbinsEncodeChange:ft.handlers.handleOverrideKbinsEncodeChange,onOverrideKbinsStrategyChange:ft.handlers.handleOverrideKbinsStrategyChange,onOverrideClear:ft.handlers.handleClearOverride,onCustomBinsChange:ft.handlers.handleCustomBinsChange,onCustomLabelsChange:ft.handlers.handleCustomLabelsChange,onClearCustomColumn:ft.handlers.handleClearCustomColumn,formatMetricValue:Hs,formatNumericStat:bs}),a.jsx(Xk,{config:ft.config,fieldIds:ft.state.fieldIds,onIntegerChange:ft.handlers.handleIntegerChange,onBooleanToggle:ft.handlers.handleBooleanToggle,onSuffixChange:ft.handlers.handleSuffixChange,onLabelFormatChange:ft.handlers.handleLabelFormatChange,onMissingStrategyChange:ft.handlers.handleMissingStrategyChange,onMissingLabelChange:ft.handlers.handleMissingLabelChange})]}),He&&a.jsx(vM,{sourceId:o,hasReachableSource:et,isFetchingSkewness:Qu,skewnessThreshold:Xt.state.threshold,skewnessError:Uo,skewnessViewMode:Xt.state.viewMode,skewnessRecommendedCount:Xt.state.recommendedCount,skewnessNumericCount:Xt.state.numericCount,skewnessGroupByMethod:Xt.state.groupByMethod,skewnessRows:Xt.state.rows,skewnessTableGroups:Xt.state.tableGroups,hasSkewnessAutoRecommendations:Xt.state.hasAutoRecommendations,skewnessTransformationsCount:Xt.state.transformationsCount,isFetchingRecommendations:ea,getSkewnessMethodLabel:Xt.handlers.getMethodLabel,getSkewnessMethodStatus:Xt.handlers.getMethodStatus,onApplyRecommendations:Xt.handlers.applyRecommendations,onViewModeChange:Xt.handlers.setViewMode,onGroupByToggle:Xt.handlers.setGroupByMethod,onOverrideChange:Xt.handlers.handleOverrideChange,onClearSelections:Xt.handlers.clearTransformations}),de&&a.jsx(bM,{skewnessThreshold:Xt.state.threshold,isFetchingSkewness:Qu,skewnessError:Uo,skewnessDistributionCards:Xt.state.distributionCards,skewnessDistributionView:Xt.state.distributionView,setSkewnessDistributionView:Xt.handlers.setDistributionView,onRefresh:of,canRefresh:cf}),_e&&a.jsx(tM,{cards:bc,selectedPreset:me,onSelectPreset:Dt=>ke(Dt),isFetching:nn,sampleSize:vf,relativeGeneratedAt:ld,error:Bo,onRefresh:Yt,canRefresh:!!o}),De&&a.jsx(xk,{sourceId:o,hasReachableSource:et,removeDuplicatesColumnsParameter:fe.removeDuplicates.columns,removeDuplicatesKeepParameter:fe.removeDuplicates.keep,renderMultiSelectField:Ps,removeDuplicatesKeepSelectId:mf,removeDuplicatesKeep:hf,onKeepChange:jd}),je&&dt.length>0&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Data consistency settings"})}),a.jsx("div",{className:"canvas-modal__parameter-list",children:dt.map(Dt=>Mt(Dt))})]}),Ue&&a.jsx(UT,{signal:As,previewStatus:We.status,hasSource:!!o,hasReachableSource:et,onRefreshPreview:Ts}),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("h3",{children:"Node details"}),p.length?a.jsx("dl",{className:"canvas-modal__metadata",children:p.map((Dt,Xs)=>a.jsxs("div",{className:"canvas-modal__metadata-row",children:[a.jsx("dt",{children:Dt.label}),a.jsx("dd",{children:Dt.value})]},`${Dt.label}-${Xs}`))}):a.jsx("p",{className:"canvas-modal__empty",children:"No metadata available for this node."})]})]}),a.jsx(Rk,{onClose:t,canResetNode:rn,onResetNode:ad,showSaveButton:$s,canSave:Vo,onSave:qa,isBusy:dd,busyLabel:md})]})]})},kx=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],Kr=kx.map(e=>e.key),jL=kx.reduce((e,t)=>({...e,[t.key]:t.label}),{}),NL=e=>typeof e=="string"&&Kr.includes(e),Yr=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{NL(n)&&t.add(n)}),Kr.filter(n=>t.has(n))},Mx=(e,t)=>{const n=Yr(e),s=Yr(t);return n.length!==s.length?!1:n.every((o,i)=>o===s[i])},Ax=e=>!e||typeof e!="string"?null:Kr.find(t=>e.endsWith(`-${t}`))??null,Ox=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},CL={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},Xi={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"train-in",label:"Train Split",position:20,required:!1,accepts:["train"]},{key:"test-in",label:"Test Split",position:40,required:!1,accepts:["test"]},{key:"validation-in",label:"Validation Split",position:60,required:!1,accepts:["validation"]},{key:"models-in",label:"Model",position:80,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},Tx=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:Ox(t,n),SL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,EL=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,$x=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},Px=28,Lx=320,kL=170,zx="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",Rx="Drop columns",Dx=new Set(["transformer_audit"]),ML=e=>({width:`${Px}px`,height:`${Px}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),AL=({id:e,data:t,selected:n})=>{var j;const s=(t==null?void 0:t.label)??e,o=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),i=(t==null?void 0:t.isRemovable)??!o,c=(t==null?void 0:t.catalogType)==="train_test_split",u=o?"Primary dataset input":void 0,d=(t==null?void 0:t.description)??u,h=(t==null?void 0:t.catalogType)==="drop_missing_columns"||d===zx?Rx:d,f=(t==null?void 0:t.backgroundExecutionStatus)??"idle",w=!((t==null?void 0:t.hasRequiredConnections)??!0),b=(t==null?void 0:t.catalogType)??"",_=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(b),x=v.useCallback(S=>{var M;S.stopPropagation(),(M=t==null?void 0:t.onRemoveNode)==null||M.call(t,e)},[t,e]),N=v.useMemo(()=>{if(o)return[];const S=(t==null?void 0:t.catalogType)??"",M=S?Xi[S]:void 0;if(M!=null&&M.inputs&&M.inputs.length){const T=M.inputs.length;return M.inputs.map((P,L)=>({position:Ae.Left,id:`${e}-${P.key}`,label:SL(P),style:{top:Tx(P,L,T)}}))}return[{position:Ae.Left,id:`${e}-target`},{position:Ae.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,o]),C=v.useMemo(()=>{if(o)return[{position:Ae.Left,id:`${e}-source-left`},{position:Ae.Right,id:`${e}-source`},{position:Ae.Top,id:`${e}-source-top`},{position:Ae.Bottom,id:`${e}-source-bottom`}];const S=(t==null?void 0:t.catalogType)??"",M=S?Xi[S]:void 0;if(M!=null&&M.outputs&&M.outputs.length){const L=M.outputs.length;return M.outputs.map(($,A)=>({position:Ae.Right,id:`${e}-${$.key}`,label:$.label,style:{top:Tx($,A,L)}}))}const T=c?Kr:Yr((t==null?void 0:t.activeSplits)??[]),P=Yr((t==null?void 0:t.connectedSplits)??[]);if(T.length){const L=T.length;return T.map(($,A)=>({position:Ae.Right,id:`${e}-${$}`,style:{top:Ox(A,L)},label:(()=>{var W;const R=jL[$];if(c){if($==="validation"&&!(Number(((W=t==null?void 0:t.config)==null?void 0:W.validation_size)??0)>0))return`${R} (disabled)`;if(!P.includes($))return`${R} (not set)`}return R})()}))}return[{position:Ae.Right,id:`${e}-source`},{position:Ae.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(j=t==null?void 0:t.config)==null?void 0:j.validation_size,e,o,c]),E=v.useCallback((S,M)=>{const{position:T,id:P,style:L,label:$}=S,A=P.includes("-train")||P.includes("-test")||P.includes("-validation");return a.jsxs(ve.Fragment,{children:[a.jsx(Mi,{type:M,position:T,id:P,className:`feature-node__handle feature-node__handle--${M}`,style:{...ML(M),...L??{},...A?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),$&&M==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(L==null?void 0:L.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:$}),$&&M==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(L==null?void 0:L.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:$})]},P)},[]);return a.jsxs("div",{className:`feature-node${n?" feature-node--selected":""}${o?" feature-node--dataset":""}`,children:[N.map(S=>E(S,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:s})]}),a.jsxs("div",{className:"feature-node__controls",children:[w&&_&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)"},children:""}),f==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:"Loading full dataset in background...",children:a.jsx("svg",{className:"feature-node__spinner",viewBox:"0 0 24 24",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60",strokeDashoffset:"30",strokeLinecap:"round"})})}),f==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",children:""}),f==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",children:"!"}),i&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:x,title:"Remove node",children:""})]})]}),h&&a.jsx("p",{className:"feature-node__description",children:h}),C.map(S=>E(S,"source"))]})},Mo="__pending_confirmation__",OL=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],TL=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],Vu=e=>e&&typeof e=="object"&&!Array.isArray(e),Ji=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},Wu=e=>typeof e=="string"&&Dx.has(e),Ku=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",s=!Dx.has(n),o=c=>(s?c[Mo]=!0:delete c[Mo],c);if(t==null)return o({});const i=Ji(t);if(!Vu(i))return o(i&&typeof i=="object"?i:{});switch(Object.entries(i).forEach(([c,u])=>{Array.isArray(u)?OL.some(p=>p.test(c))&&(i[c]=[]):Vu(u)&&TL.some(p=>p.test(c))&&(i[c]={})}),"auto_detect"in i&&(i.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.column_methods=Vu(i.column_methods)?i.column_methods:{},i.skipped_columns=Array.isArray(i.skipped_columns)?i.skipped_columns:[],i.default_method=typeof i.default_method=="string"&&i.default_method.trim()?i.default_method:"standard";break;case"polynomial_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.auto_detect=!!i.auto_detect,i.include_bias=!!i.include_bias,i.interaction_only=!!i.interaction_only,i.include_input_features=!!i.include_input_features,i.degree=typeof i.degree=="number"&&Number.isFinite(i.degree)?i.degree:2,i.output_prefix=typeof i.output_prefix=="string"&&i.output_prefix.trim()?i.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in i&&(i.missing_threshold=null),i.columns=Array.isArray(i.columns)?i.columns:[];break;case"drop_missing_rows":"missing_threshold"in i&&(i.missing_threshold=null),"drop_if_any_missing"in i&&(i.drop_if_any_missing=!1);break;case"outlier_removal":i.method="manual",i.columns=Array.isArray(i.columns)?i.columns:[],i.manual_bounds=Vu(i.manual_bounds)?i.manual_bounds:{};break;case"missing_value_indicator":i.columns=Array.isArray(i.columns)?i.columns:[];break;case"remove_duplicates":if(i.columns=Array.isArray(i.columns)?i.columns:[],typeof i.keep=="string"){const c=i.keep.trim().toLowerCase();i.keep=c==="last"||c==="none"?c:"first"}else i.keep="first";break}return o(i)},$L=(e,t)=>t==="drop_missing_columns"||e===zx?Rx:e,PL=e=>Array.isArray(e)?e.map(t=>({...t})):[],LL=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],zL=[],RL=e=>({...e,data:{...e.data??{}}}),Yu=()=>LL.map(e=>RL(e)),DL=()=>zL.map(e=>({...e})),FL=12,IL=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},BL=(e,t,n)=>{if(!t||typeof t.project!="function"||!n)return;const s=n.getBoundingClientRect(),o=t.project({x:s.width/2,y:s.height/2});if(!o)return;const i=e.filter(f=>f.id!=="dataset-source").length,c=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],u=i%c.length,d=Math.floor(i/c.length),p=c[u],h=d+1;return{x:o.x+p.x*h,y:o.y+p.y*h}},UL=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),Fx=(e,t)=>{if(!e)return!1;if(UL.has(e))return!0;const n=t==null?void 0:t.get(e);return n?(typeof n.category=="string"?n.category.toLowerCase():"").includes("preprocess"):!1},Ix=(e,t)=>{var j,S,M,T,P,L;const{handleOpenSettings:n,handleRemoveNode:s,catalogEntryMap:o}=t,i=e.data??{},c=i.isDataset??e.id==="dataset-source",u={...e.style??{}},d=i.catalogType??i.type??e.id;let h=Array.isArray(i.parameters)?i.parameters:null;if((!h||h.length===0)&&typeof d=="string"){const $=o.get(d)??null;(j=$==null?void 0:$.parameters)!=null&&j.length&&(h=$.parameters)}const f=PL(h);let g;if(f.length||i.config&&typeof i.config=="object"){const $=Ji(i.config);f.forEach(A=>{A!=null&&A.name&&$[A.name]===void 0&&A.default!==void 0&&(Array.isArray(A.default)?$[A.name]=[...A.default]:A.type==="boolean"?$[A.name]=!!A.default:$[A.name]=A.default)}),g=$}u.width||(u.width=c?Lx+20:Lx),u.minHeight||(u.minHeight=kL),u.padding||(u.padding=12),u.borderRadius||(u.borderRadius=16),u.boxSizing=u.boxSizing??"border-box",u.whiteSpace=u.whiteSpace??"pre-line",u.background||(u.background=c?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),u.border||(u.border=c?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),u.boxShadow||(u.boxShadow=c?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),u.color||(u.color=c?"#e0f2fe":"#e2e8f0"),u.fontWeight||(u.fontWeight=c?600:500);const w=$L(i.description,d),b=Wu(d),_=g??(i.config&&typeof i.config=="object"?Ji(i.config):void 0);_&&typeof _=="object"&&b&&delete _[Mo];const x={...i,label:i.label??e.id,description:w,isDataset:c,isRemovable:i.isRemovable??!c,isConfigured:c||i.isConfigured===!0?!0:i.config&&typeof i.config=="object"?b?!0:!i.config[Mo]:!1,inputs:Array.isArray(i.inputs)?[...i.inputs]:i.inputs,outputs:Array.isArray(i.outputs)?[...i.outputs]:i.outputs,category:i.category,parameters:f,config:_,catalogType:d,onRemoveNode:s,onOpenSettings:n},N=typeof d=="string"?Xi[d]:void 0;if(N){const $=((S=N.inputs)==null?void 0:S.map(R=>EL(R)))??[],A=((M=N.outputs)==null?void 0:M.map(R=>R.label))??[];$.length?x.inputs=$:delete x.inputs,A.length?x.outputs=A:delete x.outputs,x.connectionInfo={inputs:((T=N.inputs)==null?void 0:T.map(R=>({...R})))??[],outputs:((P=N.outputs)==null?void 0:P.map(R=>({...R})))??[]}}else(!x.inputs||x.inputs.length===0)&&delete x.inputs,(!x.outputs||x.outputs.length===0)&&delete x.outputs,delete x.connectionInfo;const C=Yr(x.activeSplits);C.length?x.activeSplits=C:delete x.activeSplits;const E=Yr(x.connectedSplits);return E.length?x.connectedSplits=E:delete x.connectedSplits,d==="train_test_split"&&(x.activeSplits=[...Kr],E.length||delete x.connectedSplits),(L=x.parameters)!=null&&L.length||delete x.parameters,x.config===void 0&&delete x.config,{...e,type:"featureNode",position:e.position??{x:0,y:0},data:x,style:u}},qL=(e,t,n,s,o)=>{const i=(e==null?void 0:e.label)??(e==null?void 0:e.type)??s,c=typeof i=="string"&&i.trim()?i:s,u=Ku(e),d=Wu((e==null?void 0:e.type)??null);return Ix({id:t,type:"featureNode",position:n,data:{label:c,description:e==null?void 0:e.description,inputs:e==null?void 0:e.inputs,outputs:e==null?void 0:e.outputs,category:e==null?void 0:e.category,parameters:e==null?void 0:e.parameters,config:u,catalogType:e==null?void 0:e.type,isConfigured:!!d}},o)},HL=(e,t)=>{const n=e.map(o=>{const{data:i,...c}=o,u=i?{...i}:void 0;return u&&(delete u.onRemoveNode,delete u.onOpenSettings),JSON.parse(JSON.stringify({...c,data:u}))}),s=t.map(o=>JSON.parse(JSON.stringify(o)));return{nodes:n,edges:s}},VL=()=>{var h;const[e,t]=v.useState(!1),n=v.useRef(new Map),s=Is({queryKey:["feature-canvas","node-catalog"],queryFn:Kv,staleTime:5*60*1e3}),o=s.data??[],i=s.isLoading||s.isFetching,c=s.error?((h=s.error)==null?void 0:h.message)??"Unable to load node catalog":null;v.useEffect(()=>{const f=new Map;o.forEach(g=>{g&&typeof g.type=="string"&&g.type.trim()&&f.set(g.type,g)}),n.current=f},[o]);const u=v.useCallback(()=>t(!0),[]),d=v.useCallback(()=>t(!1),[]),p=v.useCallback(()=>t(f=>!f),[]);return{nodeCatalog:o,catalogEntryMapRef:n,isCatalogOpen:e,openCatalog:u,closeCatalog:d,toggleCatalog:p,isCatalogLoading:i,catalogErrorMessage:c}},Gu=e=>!e||!e.length?"":e.join(", "),WL=({nodes:e,onAddNode:t})=>{const[n,s]=v.useState(""),[o,i]=v.useState([]),c=n.trim().toLowerCase(),u=v.useMemo(()=>c?e.filter(g=>{const w=[g.label,g.type,g.description];return g.category&&w.push(g.category),g.tags&&g.tags.length&&w.push(g.tags.join(" ")),w.some(b=>b==null?void 0:b.toLowerCase().includes(c))}):e,[e,c]),d=v.useMemo(()=>{const g=new Map;return u.forEach(w=>{var x;const b=((x=w.category)==null?void 0:x.trim())||"Other",_=g.get(b)??[];_.push(w),g.set(b,_)}),Array.from(g.entries()).sort(([w],[b])=>w.localeCompare(b)).map(([w,b])=>({category:w,entries:b.sort((_,x)=>(_.label||_.type).localeCompare(x.label||x.type))}))},[u]);v.useEffect(()=>{if(!c){i([]);return}i(g=>{const w=new Set(g);let b=!1;return d.forEach(({category:_})=>{w.has(_)||(w.add(_),b=!0)}),b?Array.from(w):g})},[d,c]);const p=g=>{i(w=>{const b=new Set(w);return b.has(g)?b.delete(g):b.add(g),Array.from(b)})},h=u.length,f=h>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsx("h3",{children:"Available steps"}),a.jsxs("div",{className:"feature-canvas-sidebar__search",children:[a.jsx("input",{type:"search",value:n,onChange:g=>s(g.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps"}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>s(""),"aria-label":"Clear search",children:""})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",h," ",h===1?"step":"steps",c?` matching ${n.trim()}`:""]})]}),f?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:d.map(({category:g,entries:w})=>{const b=o.includes(g);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>p(g),"aria-expanded":b,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:g.charAt(0).toUpperCase()+g.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[w.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":b,children:""})]})]}),b&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:w.map(_=>{var x,N;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(_),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:_.label||_.type}),_.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:_.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(x=_.inputs)!=null&&x.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${Gu(_.inputs)}`,children:["In: ",Gu(_.inputs)]}):null,(N=_.outputs)!=null&&N.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${Gu(_.outputs)}`,children:["Out: ",Gu(_.outputs)]}):null,_.parameters&&_.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",children:[_.parameters.length," param",_.parameters.length>1?"s":""]}):null]})]})},_.type)})})]},g)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})},KL=({nodeCatalog:e,isCatalogLoading:t,catalogErrorMessage:n,handleAddNode:s})=>({sidebarContent:v.useMemo(()=>t?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):n?a.jsx("p",{className:"text-danger",children:n}):e.length?a.jsx(WL,{nodes:e,onAddNode:s}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[n,s,t,e])}),YL=({setNodes:e,setEdges:t,setSelectedNodeId:n,setIsSettingsModalOpen:s,catalogEntryMapRef:o,handleOpenSettings:i,reactFlowInstanceRef:c,canvasViewportRef:u,scheduleFitView:d})=>{const p=v.useRef(0),h=v.useCallback(E=>{E!=="dataset-source"&&(e(j=>j.filter(S=>S.id!==E)),t(j=>j.filter(S=>S.source!==E&&S.target!==E)),n(j=>j===E?(s(!1),null):j))},[t,s,e,n]),f=v.useCallback(E=>Ix(E,{handleOpenSettings:i,handleRemoveNode:h,catalogEntryMap:o.current}),[o,i,h]),g=v.useCallback(E=>{const j=E.reduce((S,M)=>{if(typeof M.id=="string"&&M.id.startsWith("node-")){const T=Number(M.id.replace("node-",""));if(!Number.isNaN(T))return Math.max(S,T)}return S},0);j>p.current&&(p.current=j)},[]),w=v.useCallback((E,j)=>{const S=p.current+1,M=`node-${S}`;p.current=S;const T=j??{x:160+(S-1)%4*220,y:40+Math.floor((S-1)/4)*160};return f(qL(E??null,M,T,`Step ${S}`,{handleOpenSettings:i,handleRemoveNode:h,catalogEntryMap:o.current}))},[o,i,h,f]),b=v.useCallback(E=>{e(j=>{const S=BL(j,c.current,u.current),M=w(E,S);return[...j,M]}),d()},[u,w,c,d,e]),_=v.useCallback((E,j)=>{e(S=>S.map(M=>{if(M.id!==E)return M;const T=Ji(j);T&&typeof T=="object"&&delete T[Mo];const P={...M.data??{},config:T,isConfigured:!0};return f({...M,data:P})}))},[f,e]),x=v.useCallback((E,j)=>{e(S=>S.map(M=>{if(M.id!==E)return M;const T={...M.data??{},...j};return f({...M,data:T})}))},[f,e]),N=v.useCallback((E,j)=>{e(S=>S.map(M=>{var A;if(M.id!==E)return M;const T=(A=M==null?void 0:M.data)==null?void 0:A.catalogType,P=T?o.current.get(T)??null:null,L=j&&typeof j=="object"?Ji(j):Ku(P??null),$={...M.data??{},config:L,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...M,data:$})}))},[o,f,e]),C=v.useCallback(()=>{e(E=>E.map(j=>{var L,$;if(!Fx((L=j==null?void 0:j.data)==null?void 0:L.catalogType,o.current))return j;const S=($=j==null?void 0:j.data)==null?void 0:$.catalogType,M=S?o.current.get(S)??null:null,T=Ku(M??null),P={...j.data??{},config:T,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...j,data:P})}))},[o,f,e]);return{registerNode:f,createNode:w,handleAddNode:b,handleRemoveNode:h,handleUpdateNodeConfig:_,handleUpdateNodeData:x,handleResetNodeConfig:N,handleResetAllNodes:C,updateNodeCounter:g}},GL=({sourceId:e,datasetDisplayLabel:t,registerNode:n,prepareNodes:s,setNodes:o,setEdges:i,updateNodeCounter:c,scheduleFitView:u,onPipelineHydrated:d,onPipelineError:p})=>{const h=v.useRef(!1),f=Is({queryKey:["feature-canvas","pipeline",e],queryFn:()=>ly(e),enabled:!!e,staleTime:60*1e3,retry:1});return v.useEffect(()=>{const g=`Dataset input
(${t})`;if(!e){if(h.current)o(w=>{let b=!1;const _=w.map(x=>{var C;return x.id!=="dataset-source"||(((C=x==null?void 0:x.data)==null?void 0:C.label)??"")===g?x:(b=!0,n({...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}))});return b?_:w});else{const w=IL(t),b=s(w.nodes);h.current=!0,o(b),i(w.edges),c(b),u(),d==null||d({nodes:b,edges:w.edges,pipeline:null,context:"sample"})}return}if(h.current=!1,f.isLoading){o(w=>w.map(b=>b.id==="dataset-source"?n({...b,data:{...b.data??{},label:g,isDataset:!0,isRemovable:!1}}):b));return}if(f.isError){const w=f.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",w),p==null||p(w);const b=Yu().map(x=>x.id==="dataset-source"?{...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}:x),_=s(b);o(_),i([]),c(_),u(),d==null||d({nodes:_,edges:[],pipeline:null,context:"reset"});return}if(f.data){const w=f.data.graph??{},b=Array.isArray(w==null?void 0:w.nodes)&&w.nodes.length?w.nodes:Yu(),_=s(b),N=(Array.isArray(w==null?void 0:w.edges)?w.edges:[]).map(C=>{var $;const E=C==null?void 0:C.type,j=!E||E==="smoothstep"||E==="default"?"animatedEdge":E,S=C==null?void 0:C.source,M=C==null?void 0:C.target,T=_.find(A=>A.id===M),P=(C==null?void 0:C.sourceHandle)??(S?`${S}-source`:void 0),L=(C==null?void 0:C.targetHandle)??(($=T==null?void 0:T.data)!=null&&$.isDataset?void 0:M?`${M}-target`:void 0);return{...C,animated:(C==null?void 0:C.animated)??!0,type:j,sourceHandle:P,targetHandle:L}});o(_),i(N),c(_),u(),d==null||d({nodes:_,edges:N,pipeline:f.data??null,context:"stored"});return}if(f.isFetched&&!f.data){const w=Yu().map(_=>_.id==="dataset-source"?{..._,data:{..._.data??{},label:g,isDataset:!0,isRemovable:!1}}:_),b=s(w);o(b),i([]),c(b),u(),d==null||d({nodes:b,edges:[],pipeline:null,context:"sample"})}},[t,d,p,f.data,f.error,f.isError,f.isFetched,f.isLoading,s,n,u,i,o,e,c]),{isPipelineLoading:f.isLoading||f.isFetching}},QL=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),XL=e=>{var n;const t=e?Xi[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(s=>s.required!==!1).map(s=>s.key):[]},JL=(e,t,n)=>{const s=XL(t);if(s.length===0)return!0;const o=n.filter(c=>c.target===e),i=new Set(o.map(c=>$x(e,c.targetHandle)).filter(c=>!!c));return s.every(c=>i.has(c))},ZL=(e,t)=>{const n=new Map,s=new Set;e.forEach(d=>{var h;const p=(h=d==null?void 0:d.data)==null?void 0:h.catalogType;if(p&&QL.has(p)){s.add(d.id);return}p==="train_test_split"&&n.set(d.id,new Set(Kr))});let o=!0,i=0;const c=e.length*3;for(;o&&i<c;)o=!1,i++,t.forEach(d=>{if(s.has(d.source)||s.has(d.target))return;const p=n.get(d.source),h=Ax(d.sourceHandle);if(!p||p.size===0)return;n.has(d.target)||n.set(d.target,new Set);const f=n.get(d.target),g=f.size;h?p.has(h)&&f.add(h):p.forEach(w=>f.add(w)),f.size>g&&(o=!0)});const u=new Map;return n.forEach((d,p)=>{!d.size||s.has(p)||u.set(p,Kr.filter(h=>d.has(h)))}),u},ez=e=>{const t=new Map;e.forEach(s=>{const o=Ax(s.sourceHandle);o&&(t.has(s.source)||t.set(s.source,new Set),t.get(s.source).add(o))});const n=new Map;return t.forEach((s,o)=>{n.set(o,Kr.filter(i=>s.has(i)))}),n},tz=({edges:e,setNodes:t,scheduleNodeInternalsUpdate:n})=>{v.useEffect(()=>{const s=[];t(o=>{const i=ZL(o,e),c=ez(e);let u=!1;const d=o.map(p=>{var M,T,P,L,$;const f=((M=p==null?void 0:p.data)==null?void 0:M.catalogType)==="train_test_split"?[...Kr]:i.get(p.id)??[],g=Yr((T=p.data)==null?void 0:T.activeSplits),w=Yr(c.get(p.id)),b=Yr((P=p.data)==null?void 0:P.connectedSplits),_=((L=p==null?void 0:p.data)==null?void 0:L.catalogType)??"",x=JL(p.id,_,e),N=(($=p.data)==null?void 0:$.hasRequiredConnections)??!0,C=!Mx(g,f),E=!Mx(b,w);if(!C&&!E&&!(x!==N))return p;const S={...p.data,hasRequiredConnections:x};return f.length?S.activeSplits=f:delete S.activeSplits,w.length?S.connectedSplits=w:delete S.connectedSplits,(C||E)&&s.push(p.id),u=!0,{...p,data:S}});return u?d:o}),s.length&&n(s)},[e,n,t])},nz=({nodes:e,setEdges:t,scheduleNodeInternalsUpdate:n})=>{const s=v.useCallback(i=>{var w,b;const{source:c,target:u,sourceHandle:d,targetHandle:p}=i;if(!c||!u||!p||c===u)return!1;const h=e.find(_=>_.id===u);if(!h)return!1;const f=((w=h==null?void 0:h.data)==null?void 0:w.catalogType)??"",g=f?Xi[f]:void 0;if((b=g==null?void 0:g.inputs)!=null&&b.length){const _=$x(u,p);if(!_)return!1;const x=g.inputs.find(N=>N.key===_);return!x||!d?!1:x.accepts&&x.accepts.length>0?x.accepts.some(N=>{const C=CL[N];return C?C(d):!1}):!0}return!0},[e]),o=v.useCallback(i=>{t(u=>j_({...i,type:"animatedEdge",animated:!0},u));const c=[i.source,i.target].filter(u=>!!u);c.length&&n(c)},[n,t]);return{isValidConnection:s,onConnect:o}},sz=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const o=Math.abs(n-e),i=Math.max(64,Math.min(o*.45,240)),c=Number.isFinite(i)?i:100,u=n>=e?1:-1,d=e+u*c,p=t,h=n-u*c;return`M ${e},${t} C ${d},${p} ${h},${s} ${n},${s}`},rz=({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:o,targetPosition:i})=>{const c=sz(e,t,n,s),u="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:u,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:s,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:s,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},az=({nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:o,onEdgesChange:i,onConnect:c,isValidConnection:u,onNodeClick:d,reactFlowInstanceRef:p,canvasViewportRef:h,handleResetAllNodes:f,openCatalog:g})=>a.jsxs("div",{className:"canvas-stage__viewport",ref:h,children:[a.jsxs(Hv,{style:{width:"100%",height:"100%"},nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:o,onEdgesChange:i,onConnect:c,isValidConnection:u,onNodeClick:d,onInit:w=>{p.current=w,requestAnimationFrame(()=>w.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:vo.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:rz,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(TE,{position:"bottom-left"}),a.jsx(RE,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:f,"aria-label":"Reset preprocessing nodes",children:""}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:g,"aria-label":"Open node catalog",children:"+"})]}),oz=v.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:s,onPipelineError:o},i)=>{const c=v.useMemo(()=>({featureNode:AL}),[]),u=v.useMemo(()=>({animatedEdge:ck}),[]),[d,p,h]=ak(Yu().map(He=>({...He,type:"featureNode"}))),[f,g,w]=ok(DL()),[b,_]=v.useState(null),[x,N]=v.useState(!1),C=v.useRef(null),E=v.useRef(null),j=v.useRef(!1),S=t??e??"Demo dataset",M=FE(),{nodeCatalog:T,catalogEntryMapRef:P,isCatalogOpen:L,openCatalog:$,closeCatalog:A,isCatalogLoading:R,catalogErrorMessage:W}=VL(),z=v.useCallback(He=>{const de=(Array.isArray(He)?He:[He]).filter(Boolean);if(!de.length)return;const _e=Array.from(new Set(de));requestAnimationFrame(()=>{requestAnimationFrame(()=>{_e.forEach(je=>{M(je)})})})},[M]);tz({edges:f,setNodes:p,scheduleNodeInternalsUpdate:z});const D=v.useMemo(()=>d.find(He=>He.id===b)??null,[d,b]),H=v.useMemo(()=>HL(d,f),[f,d]),q=v.useCallback(He=>{_(He),N(!0)},[]),I=v.useCallback(()=>{N(!1),_(null)},[]),Q=v.useCallback(()=>{j.current=!0},[]);v.useEffect(()=>{j.current&&(j.current=!1,requestAnimationFrame(()=>{var He;(He=C.current)==null||He.fitView({padding:.25,duration:350})}))},[f,d]);const{registerNode:U,handleAddNode:F,handleUpdateNodeConfig:K,handleUpdateNodeData:re,handleResetNodeConfig:Y,handleResetAllNodes:V,updateNodeCounter:G}=YL({setNodes:p,setEdges:g,setSelectedNodeId:_,setIsSettingsModalOpen:N,catalogEntryMapRef:P,handleOpenSettings:q,reactFlowInstanceRef:C,canvasViewportRef:E,scheduleFitView:Q});v.useEffect(()=>{G(d)},[d,G]);const X=v.useCallback(He=>He.map(de=>{const _e={...de.data??{}};de.id==="dataset-source"&&(_e.label=`Dataset input
(${S})`,_e.isDataset=!0,_e.isRemovable=!1,_e.isConfigured=!0);const je=_e.catalogType??_e.type??de.id;return _e.config&&typeof _e.config=="object"&&Wu(je)&&delete _e.config[Mo],_e.isConfigured===void 0&&(_e.config&&typeof _e.config=="object"?_e.isConfigured=Wu(je)?!0:!_e.config[Mo]:_e.isConfigured=!0),U({...de,data:_e})}),[S,U]),{isPipelineLoading:se}=GL({sourceId:e,datasetDisplayLabel:S,registerNode:U,prepareNodes:X,setNodes:p,setEdges:g,updateNodeCounter:G,scheduleFitView:Q,onPipelineHydrated:s,onPipelineError:o}),J=v.useCallback(()=>{p(He=>{const de=He.find(je=>je.id==="dataset-source");return[U(de?{...de,data:{...de.data??{},label:`Dataset input
(${S})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${S})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),g([]),_(null),N(!1),Q()},[S,U,Q,g,p,_,N]);v.useImperativeHandle(i,()=>({openCatalog:$,closeCatalog:A,clearGraph:J}),[J,A,$]);const{isValidConnection:te,onConnect:Se}=nz({nodes:d,setEdges:g,scheduleNodeInternalsUpdate:z});v.useEffect(()=>{n==null||n(d,f)},[f,d,n]);const ze=v.useMemo(()=>{var _e;if(!D)return null;const He=(_e=D==null?void 0:D.data)==null?void 0:_e.catalogType;if(!He)return null;const de=P.current.get(He);return de?Ku(de):null},[D]),Oe=v.useMemo(()=>{var de,_e;if(!D||(de=D.data)!=null&&de.isDataset)return!1;const He=(_e=D==null?void 0:D.data)==null?void 0:_e.catalogType;return Fx(typeof He=="string"?He:null,P.current)},[D]),{sidebarContent:Ue}=KL({nodeCatalog:T,isCatalogLoading:R,catalogErrorMessage:W,handleAddNode:F}),nt=v.useCallback((He,de)=>{q(de.id)},[q]);return a.jsxs("div",{className:"canvas-stage","data-pipeline-loading":se?"true":"false","aria-busy":se,children:[a.jsx(az,{nodes:d,edges:f,nodeTypes:c,edgeTypes:u,onNodesChange:h,onEdgesChange:w,onConnect:Se,isValidConnection:te,onNodeClick:nt,reactFlowInstanceRef:C,canvasViewportRef:E,handleResetAllNodes:V,openCatalog:$}),a.jsxs("div",{className:`canvas-drawer${L?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:A,"aria-label":"Close catalog",children:""})]}),a.jsx("div",{className:"canvas-drawer__body",children:Ue})]}),L&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:A}),x&&D&&a.jsx(wL,{node:D,sourceId:e??null,graphSnapshot:H,onClose:I,onUpdateConfig:K,onUpdateNodeData:re,onResetConfig:Y,defaultConfigTemplate:ze,isResetAvailable:Oe})]})}),Bx=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},nf=e=>{const t=Bx(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},sf=e=>{const t=Bx(e);if(!t)return null;const n=t.getTime(),s=Date.now()-n,o=Math.round(s/6e4);if(o<1)return"just now";if(o===1)return"1 minute ago";if(o<60)return`${o} minutes ago`;const i=Math.round(o/60);if(i===1)return"1 hour ago";if(i<24)return`${i} hours ago`;const c=Math.round(i/24);if(c===1)return"1 day ago";if(c<7)return`${c} days ago`;const u=Math.round(c/7);return u===1?"1 week ago":`${u} weeks ago`},lz=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:o,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:b,historyErrorMessage:_,historyItems:x,activePipelineId:N,isDirty:C,isSaveDisabled:E,saveButtonLabel:j,saveFeedback:S,feedbackIcon:M,feedbackClass:T,onSelectHistory:P})=>{const L=d?(u==null?void 0:u.name)??d:null;return a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),e&&a.jsx("span",{className:"canvas-sidepanel__meta",children:sf(e)??nf(e)})]}),t?a.jsx("p",{className:"text-danger",children:t}):o?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:d??"",onChange:$=>h($.target.value),disabled:n||!i,"aria-label":"Select dataset",children:c.map($=>a.jsx("option",{value:$.value,disabled:!$.isOwned,children:`${$.label}${$.isOwned?"":" (locked)"}`},$.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),n&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!n&&!s&&!t&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:u.description}),L&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:L})]}),!i&&o>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:f,disabled:!p,"aria-label":"Clean all nodes",title:p?"Remove all nodes and edges from the canvas":"Nothing to clean yet",children:[a.jsx("span",{"aria-hidden":"true",children:""}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:g,disabled:b||!d,"aria-label":"Refresh history",title:"Refresh history",children:""}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:w,disabled:E,"aria-label":j,title:j,children:""})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:b?a.jsx("p",{className:"text-muted",children:"Loading history"}):_?a.jsx("p",{className:"text-danger",children:_}):x.length?x.map($=>{const R=sf($.updated_at)??nf($.updated_at),W=$.id===N,z=W&&!C;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${W?" canvas-sidepanel__history-item--active":""}`,onClick:()=>P($),disabled:z,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:$.name||`Pipeline #${$.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:R}),W&&C&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},$.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),S&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${T}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:M}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:S.message})]})]})},iz=e=>{var w;const[t,n]=v.useState(e??null),[s,o]=v.useState(null),i=Is({queryKey:["feature-canvas","datasets"],queryFn:()=>Yv(12),staleTime:5*60*1e3}),c=i.data??[],u=v.useMemo(()=>c.filter(b=>(b==null?void 0:b.is_owned)!==!1),[c]);v.useEffect(()=>{if(!c.length){o(null);return}if(t){const _=c.find(x=>x.source_id===t);if(_){o(x=>(x==null?void 0:x.id)===_.id?x:_);return}}const b=u[0]??c[0];b&&(t||n(b.source_id??String(b.id)),o(b))},[t,c,u]);const d=v.useMemo(()=>c.map(b=>({value:b.source_id,label:b.name??b.source_id,isOwned:b.is_owned!==!1})),[c]),p=u.length>1,h=c.length>0,f=u.length,g=i.error?((w=i.error)==null?void 0:w.message)??"Unable to load datasets":null;return{datasets:c,ownedDatasets:u,selectedDataset:s,setSelectedDataset:o,activeSourceId:t,setActiveSourceId:n,datasetOptions:d,canSelectDatasets:p,hasDatasets:h,ownedDatasetsCount:f,isDatasetLoading:i.isLoading,datasetErrorMessage:g}},cz=({sourceId:e,setIsDirty:t,setSaveFeedback:n,isHydratingRef:s})=>{const o=iz(e),{datasets:i,setActiveSourceId:c,setSelectedDataset:u}=o,d=v.useCallback(p=>{const h=i.find(f=>f.source_id===p)??null;if(!h){n({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(h.is_owned===!1){n({message:"Only datasets you own can be selected.",tone:"error"});return}c(p),u(h),s.current=!0,t(!1),n(null)},[i,s,c,t,n,u]);return{...o,handleDatasetSelection:d}},Ux=(e,t)=>({nodes:JSON.parse(JSON.stringify(e??[])),edges:JSON.parse(JSON.stringify(t??[]))}),qx=e=>Array.isArray(e)?e.some(t=>(t==null?void 0:t.id)&&t.id!=="dataset-source"):!1,Hx=e=>Array.isArray(e)?e.length>0:!1,uz=({setIsDirty:e,setSaveFeedback:t,isHydratingRef:n})=>{const s=v.useRef({nodes:[],edges:[]}),[o,i]=v.useState(!1),c=v.useCallback((d,p)=>{const h=Ux(d,p);s.current=h;const f=qx(h.nodes),g=Hx(h.edges);return i(f||g),{hasCustomNodes:f,hasEdges:g}},[]),u=v.useCallback((d,p)=>{const h=Ux(d,p),f=s.current,g=JSON.stringify(f.nodes??[])===JSON.stringify(h.nodes??[])&&JSON.stringify(f.edges??[])===JSON.stringify(h.edges??[]);s.current=h;const w=qx(h.nodes),b=Hx(h.edges);i(w||b),!(n.current||g)&&(e(!0),t(null))},[n,e,t]);return{graphSnapshotRef:s,canClearCanvas:o,handleGraphChange:u,applyHydratedSnapshot:c}},dz=({canvasShellRef:e,canClearCanvas:t,setSaveFeedback:n})=>v.useCallback(()=>{var s;t&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((s=e.current)==null||s.clearGraph(),n(o=>(o==null?void 0:o.tone)==="error"?o:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[e,t,n]),mz=({activeSourceId:e,isDirty:t,setSaveFeedback:n,pipelineQueryKey:s,pendingHistoryIdRef:o,isHydratingRef:i,historyLimit:c=FL})=>{var h;const u=ho(),d=Is({queryKey:["feature-canvas","pipeline-history",e],queryFn:()=>cy(e,c),enabled:!!e,staleTime:30*1e3,retry:1}),p=v.useCallback(f=>{if(!(f!=null&&f.graph)){n({message:"Selected revision is missing pipeline data.",tone:"error"});return}t&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(o.current=f.id??null,i.current=!0,n({message:`Loading revision ${f.name??`#${f.id}`}`,tone:"info"}),u.setQueryData(s,f))},[t,i,o,s,u,n]);return{historyItems:d.data??[],isHistoryLoading:d.isLoading||d.isFetching,historyErrorMessage:d.error?((h=d.error)==null?void 0:h.message)??"Unable to load history":null,refetchHistory:d.refetch,handleHistorySelection:p}},hz=({applyHydratedSnapshot:e,selectedDataset:t,activeSourceId:n,setActivePipelineId:s,setActivePipelineName:o,setActivePipelineUpdatedAt:i,setIsDirty:c,setSaveFeedback:u,pendingHistoryIdRef:d,isHydratingRef:p})=>{const h=v.useCallback(g=>{const{nodes:w,edges:b,pipeline:_,context:x}=g,{hasCustomNodes:N}=e(w,b),C=(_==null?void 0:_.id)??null;if(s(C),o((_==null?void 0:_.name)??null),i((_==null?void 0:_.updated_at)??null),x==="stored"&&_)if(d.current===_.id){const j=sf(_.updated_at)??nf(_.updated_at);u({message:`Saved revision ${_.name??`#${_.id}`} (${j})`,tone:"info"}),d.current=null}else p.current&&u(E=>(E==null?void 0:E.tone)==="error"?E:N?{message:"Loaded saved pipeline",tone:"info"}:E);else x==="sample"?(d.current=null,u(E=>(E==null?void 0:E.tone)==="error"||N?E:{message:`Showing starter pipeline for ${(t==null?void 0:t.name)??(t==null?void 0:t.source_id)??n??"demo dataset"}`,tone:"info"})):x==="reset"?d.current=null:_||(d.current=null,u(E=>(E==null?void 0:E.tone)==="error"?E:null));p.current&&c(!1),_&&d.current&&d.current!==_.id&&(d.current=null),p.current=!1},[n,e,d,t,s,o,i,c,u,p]),f=v.useCallback(g=>{u({message:(g==null?void 0:g.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[u]);return{handlePipelineHydrated:h,handlePipelineError:f}},fz=({queryClient:e,setSaveFeedback:t,setIsDirty:n,setActivePipelineId:s,setActivePipelineName:o,setActivePipelineUpdatedAt:i,pendingHistoryIdRef:c})=>{const{mutate:u,isPending:d}=Uc({mutationFn:async({sourceId:p,payload:h})=>iy(p,h),onSuccess:(p,h)=>{t({message:"Draft saved successfully.",tone:"success"}),n(!1),s(p.id??null),o(p.name??null),i(p.updated_at??null),c.current=p.id??null,e.setQueryData(["feature-canvas","pipeline",h.sourceId],p),e.invalidateQueries({queryKey:["feature-canvas","pipeline-history",h.sourceId],exact:!1})},onError:p=>{t({message:(p==null?void 0:p.message)??"Failed to save pipeline.",tone:"error"})}});return{triggerSave:u,isSaving:d}},pz=e=>e==="success"?"":e==="error"?"":"",gz=e=>e==="error"?"text-danger":e==="success"?"text-success":"text-muted",_z=()=>{const[e,t]=v.useState(null);v.useEffect(()=>{if(!e||e.tone==="error"||typeof window>"u")return;const o=window.setTimeout(()=>t(null),e.tone==="success"?4e3:2500);return()=>window.clearTimeout(o)},[e]);const n=v.useMemo(()=>pz(e==null?void 0:e.tone),[e]),s=v.useMemo(()=>gz(e==null?void 0:e.tone),[e]);return{saveFeedback:e,setSaveFeedback:t,feedbackIcon:n,feedbackClass:s}},vz=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:o,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:b,historyErrorMessage:_,historyItems:x,activePipelineId:N,isDirty:C,isSaving:E,saveFeedback:j,feedbackIcon:S,feedbackClass:M,onSelectHistory:T})=>({sidepanelProps:{activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:o,canSelectDatasets:i,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:w,isHistoryLoading:b,historyErrorMessage:_,historyItems:x,activePipelineId:N,isDirty:C,isSaveDisabled:!d||E,saveButtonLabel:E?"Saving":C?"Save draft*":"Save draft",saveFeedback:j,feedbackIcon:S,feedbackClass:M,onSelectHistory:T}}),yz=(e=!0)=>{const[t,n]=v.useState(e),s=v.useCallback(()=>{n(o=>!o)},[]);return{isSidepanelExpanded:t,handleToggleSidepanel:s}},bz=e=>{const t=e==null?void 0:e.type;return!t||t==="smoothstep"||t==="default"?"animatedEdge":t},xz=({snapshot:e,selectedDataset:t,activeSourceId:n})=>{const s=e.nodes??[],o=e.edges??[];return{name:t!=null&&t.name?`Draft pipeline for ${t.name}`:`Draft pipeline for ${n}`,graph:{nodes:s,edges:o.map(i=>({...i,animated:(i==null?void 0:i.animated)??!0,type:bz(i)}))},metadata:{lastClientSave:new Date().toISOString(),nodeCount:s.length,edgeCount:o.length}}},wz=({sourceId:e})=>{const t=ho(),n=v.useRef(null),s=v.useRef(!0),{isSidepanelExpanded:o,handleToggleSidepanel:i}=yz(!0),[c,u]=v.useState(!1),{saveFeedback:d,setSaveFeedback:p,feedbackIcon:h,feedbackClass:f}=_z(),{selectedDataset:g,activeSourceId:w,datasetOptions:b,canSelectDatasets:_,hasDatasets:x,ownedDatasetsCount:N,isDatasetLoading:C,datasetErrorMessage:E,handleDatasetSelection:j}=cz({sourceId:e,setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),[S,M]=v.useState(null),[T,P]=v.useState(null),[L,$]=v.useState(null),A=v.useMemo(()=>["feature-canvas","pipeline",w],[w]),R=v.useRef(null),{graphSnapshotRef:W,canClearCanvas:z,handleGraphChange:D,applyHydratedSnapshot:H}=uz({setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),q=dz({canvasShellRef:n,canClearCanvas:z,setSaveFeedback:p}),{historyItems:I,isHistoryLoading:Q,historyErrorMessage:U,refetchHistory:F,handleHistorySelection:K}=mz({activeSourceId:w,isDirty:c,setSaveFeedback:p,pipelineQueryKey:A,pendingHistoryIdRef:R,isHydratingRef:s}),{triggerSave:re,isSaving:Y}=fz({queryClient:t,setSaveFeedback:p,setIsDirty:u,setActivePipelineId:M,setActivePipelineName:$,setActivePipelineUpdatedAt:P,pendingHistoryIdRef:R}),{handlePipelineHydrated:V,handlePipelineError:G}=hz({applyHydratedSnapshot:H,selectedDataset:g,activeSourceId:w,setActivePipelineId:M,setActivePipelineName:$,setActivePipelineUpdatedAt:P,setIsDirty:u,setSaveFeedback:p,pendingHistoryIdRef:R,isHydratingRef:s}),X=v.useCallback(()=>{if(!w){p({message:"Select a dataset before saving.",tone:"error"});return}const J=W.current;if(!J.nodes||!J.nodes.length){p({message:"Add nodes to the canvas before saving.",tone:"error"});return}const te=xz({snapshot:J,selectedDataset:g,activeSourceId:w});p({message:"Saving draft",tone:"info"}),re({sourceId:w,payload:te})},[w,g==null?void 0:g.name,re]),{sidepanelProps:se}=vz({activePipelineUpdatedAt:T,datasetErrorMessage:E,isDatasetLoading:C,hasDatasets:x,ownedDatasetsCount:N,canSelectDatasets:_,datasetOptions:b,selectedDataset:g,activeSourceId:w,canClearCanvas:z,onDatasetSelection:j,onClearCanvas:q,onRefreshHistory:()=>{F()},onSaveClick:X,isHistoryLoading:Q,historyErrorMessage:U,historyItems:I,activePipelineId:S,isDirty:c,isSaving:Y,saveFeedback:d,feedbackIcon:h,feedbackClass:f,onSelectHistory:K});return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":o?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:i,"aria-label":o?"Collapse details panel":"Expand details panel","aria-expanded":o,"aria-controls":"feature-canvas-sidepanel",children:o?"":""}),!o&&d&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${f}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:h}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:d.message})]}),o&&a.jsx(lz,{...se}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(Vv,{children:a.jsx(oz,{ref:n,sourceId:w,datasetName:(g==null?void 0:g.name)??(g==null?void 0:g.source_id)??null,onGraphChange:D,onPipelineHydrated:V,onPipelineError:G})})})]})},jz=new mj,rf=document.getElementById("ml-workflow-root");if(!rf)throw new Error("ML workflow root element not found");const Nz=dm.createRoot(rf),Cz=rf.getAttribute("data-source-id")||void 0;Nz.render(a.jsx(ve.StrictMode,{children:a.jsx(hj,{client:jz,children:a.jsx(wz,{sourceId:Cz})})}))})();
//# sourceMappingURL=feature-canvas.js.map
