var Lw=cn=>{throw TypeError(cn)};var $p=(cn,xn,wn)=>xn.has(cn)||Lw("Cannot "+wn);var se=(cn,xn,wn)=>($p(cn,xn,"read from private field"),wn?wn.call(cn):xn.get(cn)),We=(cn,xn,wn)=>xn.has(cn)?Lw("Cannot add the same private member more than once"):xn instanceof WeakSet?xn.add(cn):xn.set(cn,wn),Re=(cn,xn,wn,oo)=>($p(cn,xn,"write to private field"),oo?oo.call(cn,wn):xn.set(cn,wn),wn),xt=(cn,xn,wn)=>($p(cn,xn,"access private method"),wn);var lm=(cn,xn,wn,oo)=>({set _(_t){Re(cn,xn,_t,wn)},get _(){return se(cn,xn,oo)}});(function(){"use strict";var ja,rf,Vx,ko,Ca,Ai,Wx,Oi,Sa,Ti,Kx,Mo,Yx,Ao,$i,er,Oo,Dn,Jl,To,fr,pa,Gx,Ns,Et,Zl,hs,$o,Pi,Kr,Ea,ec,Ri,Li,Po,Ro,ka,zi,It,Fc,Pp,Rp,Lp,zp,Dp,Fp,Ip,zw,Qx,tc,kr,fs,Lo,Mr,ao,Xx,Yr,pr,nc,Jx,Gr,Ma,js,Qr,Xr,cm,Bp,Zx,Ar,e0,un,Aa,Oa,Di,Fi,Ta,Ii,Bi,t0;function cn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xn={exports:{}},wn={},oo={exports:{}},_t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Up;function Dw(){if(Up)return _t;Up=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;function g(L){return L===null||typeof L!="object"?null:(L=f&&L[f]||L["@@iterator"],typeof L=="function"?L:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,y={};function x(L,U,te){this.props=L,this.context=U,this.refs=y,this.updater=te||b}x.prototype.isReactComponent={},x.prototype.setState=function(L,U){if(typeof L!="object"&&typeof L!="function"&&L!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,L,U,"setState")},x.prototype.forceUpdate=function(L){this.updater.enqueueForceUpdate(this,L,"forceUpdate")};function N(){}N.prototype=x.prototype;function E(L,U,te){this.props=L,this.context=U,this.refs=y,this.updater=te||b}var S=E.prototype=new N;S.constructor=E,w(S,x.prototype),S.isPureReactComponent=!0;var j=Array.isArray,C=Object.prototype.hasOwnProperty,k={current:null},O={key:!0,ref:!0,__self:!0,__source:!0};function R(L,U,te){var K,H={},Y=null,Q=null;if(U!=null)for(K in U.ref!==void 0&&(Q=U.ref),U.key!==void 0&&(Y=""+U.key),U)C.call(U,K)&&!O.hasOwnProperty(K)&&(H[K]=U[K]);var ne=arguments.length-2;if(ne===1)H.children=te;else if(1<ne){for(var J=Array(ne),re=0;re<ne;re++)J[re]=arguments[re+2];H.children=J}if(L&&L.defaultProps)for(K in ne=L.defaultProps,ne)H[K]===void 0&&(H[K]=ne[K]);return{$$typeof:e,type:L,key:Y,ref:Q,props:H,_owner:k.current}}function P(L,U){return{$$typeof:e,type:L.type,key:U,ref:L.ref,props:L.props,_owner:L._owner}}function $(L){return typeof L=="object"&&L!==null&&L.$$typeof===e}function A(L){var U={"=":"=0",":":"=2"};return"$"+L.replace(/[=:]/g,function(te){return U[te]})}var D=/\/+/g;function V(L,U){return typeof L=="object"&&L!==null&&L.key!=null?A(""+L.key):U.toString(36)}function z(L,U,te,K,H){var Y=typeof L;(Y==="undefined"||Y==="boolean")&&(L=null);var Q=!1;if(L===null)Q=!0;else switch(Y){case"string":case"number":Q=!0;break;case"object":switch(L.$$typeof){case e:case t:Q=!0}}if(Q)return Q=L,H=H(Q),L=K===""?"."+V(Q,0):K,j(H)?(te="",L!=null&&(te=L.replace(D,"$&/")+"/"),z(H,U,te,"",function(re){return re})):H!=null&&($(H)&&(H=P(H,te+(!H.key||Q&&Q.key===H.key?"":(""+H.key).replace(D,"$&/")+"/")+L)),U.push(H)),1;if(Q=0,K=K===""?".":K+":",j(L))for(var ne=0;ne<L.length;ne++){Y=L[ne];var J=K+V(Y,ne);Q+=z(Y,U,te,J,H)}else if(J=g(L),typeof J=="function")for(L=J.call(L),ne=0;!(Y=L.next()).done;)Y=Y.value,J=K+V(Y,ne++),Q+=z(Y,U,te,J,H);else if(Y==="object")throw U=String(L),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(L).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return Q}function F(L,U,te){if(L==null)return L;var K=[],H=0;return z(L,K,"","",function(Y){return U.call(te,Y,H++)}),K}function q(L){if(L._status===-1){var U=L._result;U=U(),U.then(function(te){(L._status===0||L._status===-1)&&(L._status=1,L._result=te)},function(te){(L._status===0||L._status===-1)&&(L._status=2,L._result=te)}),L._status===-1&&(L._status=0,L._result=U)}if(L._status===1)return L._result.default;throw L._result}var G={current:null},W={transition:null},X={ReactCurrentDispatcher:G,ReactCurrentBatchConfig:W,ReactCurrentOwner:k};function I(){throw Error("act(...) is not supported in production builds of React.")}return _t.Children={map:F,forEach:function(L,U,te){F(L,function(){U.apply(this,arguments)},te)},count:function(L){var U=0;return F(L,function(){U++}),U},toArray:function(L){return F(L,function(U){return U})||[]},only:function(L){if(!$(L))throw Error("React.Children.only expected to receive a single React element child.");return L}},_t.Component=x,_t.Fragment=n,_t.Profiler=i,_t.PureComponent=E,_t.StrictMode=s,_t.Suspense=d,_t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,_t.act=I,_t.cloneElement=function(L,U,te){if(L==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+L+".");var K=w({},L.props),H=L.key,Y=L.ref,Q=L._owner;if(U!=null){if(U.ref!==void 0&&(Y=U.ref,Q=k.current),U.key!==void 0&&(H=""+U.key),L.type&&L.type.defaultProps)var ne=L.type.defaultProps;for(J in U)C.call(U,J)&&!O.hasOwnProperty(J)&&(K[J]=U[J]===void 0&&ne!==void 0?ne[J]:U[J])}var J=arguments.length-2;if(J===1)K.children=te;else if(1<J){ne=Array(J);for(var re=0;re<J;re++)ne[re]=arguments[re+2];K.children=ne}return{$$typeof:e,type:L.type,key:H,ref:Y,props:K,_owner:Q}},_t.createContext=function(L){return L={$$typeof:c,_currentValue:L,_currentValue2:L,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},L.Provider={$$typeof:l,_context:L},L.Consumer=L},_t.createElement=R,_t.createFactory=function(L){var U=R.bind(null,L);return U.type=L,U},_t.createRef=function(){return{current:null}},_t.forwardRef=function(L){return{$$typeof:u,render:L}},_t.isValidElement=$,_t.lazy=function(L){return{$$typeof:h,_payload:{_status:-1,_result:L},_init:q}},_t.memo=function(L,U){return{$$typeof:p,type:L,compare:U===void 0?null:U}},_t.startTransition=function(L){var U=W.transition;W.transition={};try{L()}finally{W.transition=U}},_t.unstable_act=I,_t.useCallback=function(L,U){return G.current.useCallback(L,U)},_t.useContext=function(L){return G.current.useContext(L)},_t.useDebugValue=function(){},_t.useDeferredValue=function(L){return G.current.useDeferredValue(L)},_t.useEffect=function(L,U){return G.current.useEffect(L,U)},_t.useId=function(){return G.current.useId()},_t.useImperativeHandle=function(L,U,te){return G.current.useImperativeHandle(L,U,te)},_t.useInsertionEffect=function(L,U){return G.current.useInsertionEffect(L,U)},_t.useLayoutEffect=function(L,U){return G.current.useLayoutEffect(L,U)},_t.useMemo=function(L,U){return G.current.useMemo(L,U)},_t.useReducer=function(L,U,te){return G.current.useReducer(L,U,te)},_t.useRef=function(L){return G.current.useRef(L)},_t.useState=function(L){return G.current.useState(L)},_t.useSyncExternalStore=function(L,U,te){return G.current.useSyncExternalStore(L,U,te)},_t.useTransition=function(){return G.current.useTransition()},_t.version="18.3.1",_t}oo.exports=Dw();var _=oo.exports;const _e=cn(_);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qp;function Fw(){if(qp)return wn;qp=1;var e=_,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(u,d,p){var h,f={},g=null,b=null;p!==void 0&&(g=""+p),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(b=d.ref);for(h in d)s.call(d,h)&&!l.hasOwnProperty(h)&&(f[h]=d[h]);if(u&&u.defaultProps)for(h in d=u.defaultProps,d)f[h]===void 0&&(f[h]=d[h]);return{$$typeof:t,type:u,key:g,ref:b,props:f,_owner:i.current}}return wn.Fragment=n,wn.jsx=c,wn.jsxs=c,wn}xn.exports=Fw();var a=xn.exports,um={},Hp={exports:{}},ys={},dm={exports:{}},mm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vp;function Iw(){return Vp||(Vp=1,function(e){function t(W,X){var I=W.length;W.push(X);e:for(;0<I;){var L=I-1>>>1,U=W[L];if(0<i(U,X))W[L]=X,W[I]=U,I=L;else break e}}function n(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var X=W[0],I=W.pop();if(I!==X){W[0]=I;e:for(var L=0,U=W.length,te=U>>>1;L<te;){var K=2*(L+1)-1,H=W[K],Y=K+1,Q=W[Y];if(0>i(H,I))Y<U&&0>i(Q,H)?(W[L]=Q,W[Y]=I,L=Y):(W[L]=H,W[K]=I,L=K);else if(Y<U&&0>i(Q,I))W[L]=Q,W[Y]=I,L=Y;else break e}}return X}function i(W,X){var I=W.sortIndex-X.sortIndex;return I!==0?I:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],p=[],h=1,f=null,g=3,b=!1,w=!1,y=!1,x=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var X=n(p);X!==null;){if(X.callback===null)s(p);else if(X.startTime<=W)s(p),X.sortIndex=X.expirationTime,t(d,X);else break;X=n(p)}}function j(W){if(y=!1,S(W),!w)if(n(d)!==null)w=!0,q(C);else{var X=n(p);X!==null&&G(j,X.startTime-W)}}function C(W,X){w=!1,y&&(y=!1,N(R),R=-1),b=!0;var I=g;try{for(S(X),f=n(d);f!==null&&(!(f.expirationTime>X)||W&&!A());){var L=f.callback;if(typeof L=="function"){f.callback=null,g=f.priorityLevel;var U=L(f.expirationTime<=X);X=e.unstable_now(),typeof U=="function"?f.callback=U:f===n(d)&&s(d),S(X)}else s(d);f=n(d)}if(f!==null)var te=!0;else{var K=n(p);K!==null&&G(j,K.startTime-X),te=!1}return te}finally{f=null,g=I,b=!1}}var k=!1,O=null,R=-1,P=5,$=-1;function A(){return!(e.unstable_now()-$<P)}function D(){if(O!==null){var W=e.unstable_now();$=W;var X=!0;try{X=O(!0,W)}finally{X?V():(k=!1,O=null)}}else k=!1}var V;if(typeof E=="function")V=function(){E(D)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,F=z.port2;z.port1.onmessage=D,V=function(){F.postMessage(null)}}else V=function(){x(D,0)};function q(W){O=W,k||(k=!0,V())}function G(W,X){R=x(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){w||b||(w=!0,q(C))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(W){switch(g){case 1:case 2:case 3:var X=3;break;default:X=g}var I=g;g=X;try{return W()}finally{g=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var I=g;g=W;try{return X()}finally{g=I}},e.unstable_scheduleCallback=function(W,X,I){var L=e.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?L+I:L):I=L,W){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=I+U,W={id:h++,callback:X,priorityLevel:W,startTime:I,expirationTime:U,sortIndex:-1},I>L?(W.sortIndex=I,t(p,W),n(d)===null&&W===n(p)&&(y?(N(R),R=-1):y=!0,G(j,I-L))):(W.sortIndex=U,t(d,W),w||b||(w=!0,q(C))),W},e.unstable_shouldYield=A,e.unstable_wrapCallback=function(W){var X=g;return function(){var I=g;g=X;try{return W.apply(this,arguments)}finally{g=I}}}}(mm)),mm}var Wp;function Bw(){return Wp||(Wp=1,dm.exports=Iw()),dm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kp;function Uw(){if(Kp)return ys;Kp=1;var e=_,t=Bw();function n(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,m=1;m<arguments.length;m++)o+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function l(r,o){c(r,o),c(r+"Capture",o)}function c(r,o){for(i[r]=o,r=0;r<o.length;r++)s.add(o[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},f={};function g(r){return d.call(f,r)?!0:d.call(h,r)?!1:p.test(r)?f[r]=!0:(h[r]=!0,!1)}function b(r,o,m,v){if(m!==null&&m.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return v?!1:m!==null?!m.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function w(r,o,m,v){if(o===null||typeof o>"u"||b(r,o,m,v))return!0;if(v)return!1;if(m!==null)switch(m.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function y(r,o,m,v,M,T,B){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=v,this.attributeNamespace=M,this.mustUseProperty=m,this.propertyName=r,this.type=o,this.sanitizeURL=T,this.removeEmptyString=B}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){x[r]=new y(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];x[o]=new y(o,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){x[r]=new y(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){x[r]=new y(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){x[r]=new y(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){x[r]=new y(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){x[r]=new y(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){x[r]=new y(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){x[r]=new y(r,5,!1,r.toLowerCase(),null,!1,!1)});var N=/[\-:]([a-z])/g;function E(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(N,E);x[o]=new y(o,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(N,E);x[o]=new y(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(N,E);x[o]=new y(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){x[r]=new y(r,1,!1,r.toLowerCase(),null,!1,!1)}),x.xlinkHref=new y("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){x[r]=new y(r,1,!1,r.toLowerCase(),null,!0,!0)});function S(r,o,m,v){var M=x.hasOwnProperty(o)?x[o]:null;(M!==null?M.type!==0:v||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(w(o,m,M,v)&&(m=null),v||M===null?g(o)&&(m===null?r.removeAttribute(o):r.setAttribute(o,""+m)):M.mustUseProperty?r[M.propertyName]=m===null?M.type===3?!1:"":m:(o=M.attributeName,v=M.attributeNamespace,m===null?r.removeAttribute(o):(M=M.type,m=M===3||M===4&&m===!0?"":""+m,v?r.setAttributeNS(v,o,m):r.setAttribute(o,m))))}var j=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,C=Symbol.for("react.element"),k=Symbol.for("react.portal"),O=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),$=Symbol.for("react.provider"),A=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),V=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),F=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),G=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(r){return r===null||typeof r!="object"?null:(r=W&&r[W]||r["@@iterator"],typeof r=="function"?r:null)}var I=Object.assign,L;function U(r){if(L===void 0)try{throw Error()}catch(m){var o=m.stack.trim().match(/\n( *(at )?)/);L=o&&o[1]||""}return`
`+L+r}var te=!1;function K(r,o){if(!r||te)return"";te=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(he){var v=he}Reflect.construct(r,[],o)}else{try{o.call()}catch(he){v=he}r.call(o.prototype)}else{try{throw Error()}catch(he){v=he}r()}}catch(he){if(he&&v&&typeof he.stack=="string"){for(var M=he.stack.split(`
`),T=v.stack.split(`
`),B=M.length-1,ee=T.length-1;1<=B&&0<=ee&&M[B]!==T[ee];)ee--;for(;1<=B&&0<=ee;B--,ee--)if(M[B]!==T[ee]){if(B!==1||ee!==1)do if(B--,ee--,0>ee||M[B]!==T[ee]){var ae=`
`+M[B].replace(" at new "," at ");return r.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",r.displayName)),ae}while(1<=B&&0<=ee);break}}}finally{te=!1,Error.prepareStackTrace=m}return(r=r?r.displayName||r.name:"")?U(r):""}function H(r){switch(r.tag){case 5:return U(r.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return r=K(r.type,!1),r;case 11:return r=K(r.type.render,!1),r;case 1:return r=K(r.type,!0),r;default:return""}}function Y(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case O:return"Fragment";case k:return"Portal";case P:return"Profiler";case R:return"StrictMode";case V:return"Suspense";case z:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case A:return(r.displayName||"Context")+".Consumer";case $:return(r._context.displayName||"Context")+".Provider";case D:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case F:return o=r.displayName||null,o!==null?o:Y(r.type)||"Memo";case q:o=r._payload,r=r._init;try{return Y(r(o))}catch{}}return null}function Q(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(o);case 8:return o===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ne(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function J(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function re(r){var o=J(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),v=""+r[o];if(!r.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var M=m.get,T=m.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return M.call(this)},set:function(B){v=""+B,T.call(this,B)}}),Object.defineProperty(r,o,{enumerable:m.enumerable}),{getValue:function(){return v},setValue:function(B){v=""+B},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Se(r){r._valueTracker||(r._valueTracker=re(r))}function ze(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var m=o.getValue(),v="";return r&&(v=J(r)?r.checked?"true":"false":r.value),r=v,r!==m?(o.setValue(r),!0):!1}function $e(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Be(r,o){var m=o.checked;return I({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??r._wrapperState.initialChecked})}function it(r,o){var m=o.defaultValue==null?"":o.defaultValue,v=o.checked!=null?o.checked:o.defaultChecked;m=ne(o.value!=null?o.value:m),r._wrapperState={initialChecked:v,initialValue:m,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function He(r,o){o=o.checked,o!=null&&S(r,"checked",o,!1)}function de(r,o){He(r,o);var m=ne(o.value),v=o.type;if(m!=null)v==="number"?(m===0&&r.value===""||r.value!=m)&&(r.value=""+m):r.value!==""+m&&(r.value=""+m);else if(v==="submit"||v==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?Ne(r,o.type,m):o.hasOwnProperty("defaultValue")&&Ne(r,o.type,ne(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function ge(r,o,m){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var v=o.type;if(!(v!=="submit"&&v!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,m||o===r.value||(r.value=o),r.defaultValue=o}m=r.name,m!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,m!==""&&(r.name=m)}function Ne(r,o,m){(o!=="number"||$e(r.ownerDocument)!==r)&&(m==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+m&&(r.defaultValue=""+m))}var Me=Array.isArray;function Ue(r,o,m,v){if(r=r.options,o){o={};for(var M=0;M<m.length;M++)o["$"+m[M]]=!0;for(m=0;m<r.length;m++)M=o.hasOwnProperty("$"+r[m].value),r[m].selected!==M&&(r[m].selected=M),M&&v&&(r[m].defaultSelected=!0)}else{for(m=""+ne(m),o=null,M=0;M<r.length;M++){if(r[M].value===m){r[M].selected=!0,v&&(r[M].defaultSelected=!0);return}o!==null||r[M].disabled||(o=r[M])}o!==null&&(o.selected=!0)}}function ce(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return I({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Oe(r,o){var m=o.value;if(m==null){if(m=o.children,o=o.defaultValue,m!=null){if(o!=null)throw Error(n(92));if(Me(m)){if(1<m.length)throw Error(n(93));m=m[0]}o=m}o==null&&(o=""),m=o}r._wrapperState={initialValue:ne(m)}}function Ge(r,o){var m=ne(o.value),v=ne(o.defaultValue);m!=null&&(m=""+m,m!==r.value&&(r.value=m),o.defaultValue==null&&r.defaultValue!==m&&(r.defaultValue=m)),v!=null&&(r.defaultValue=""+v)}function ut(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function rt(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vt(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?rt(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var at,ct=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,m,v,M){MSApp.execUnsafeLocalFunction(function(){return r(o,m,v,M)})}:r}(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for(at=at||document.createElement("div"),at.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=at.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function $t(r,o){if(o){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=o;return}}r.textContent=o}var Dt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Qe=["Webkit","ms","Moz","O"];Object.keys(Dt).forEach(function(r){Qe.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),Dt[o]=Dt[r]})});function Ut(r,o,m){return o==null||typeof o=="boolean"||o===""?"":m||typeof o!="number"||o===0||Dt.hasOwnProperty(r)&&Dt[r]?(""+o).trim():o+"px"}function Yt(r,o){r=r.style;for(var m in o)if(o.hasOwnProperty(m)){var v=m.indexOf("--")===0,M=Ut(m,o[m],v);m==="float"&&(m="cssFloat"),v?r.setProperty(m,M):r[m]=M}}var Mt=I({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function yt(r,o){if(o){if(Mt[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function jn(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rt=null;function tn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var fe=null,qt=null,dt=null;function Ye(r){if(r=jc(r)){if(typeof fe!="function")throw Error(n(280));var o=r.stateNode;o&&(o=Nd(o),fe(r.stateNode,r.type,o))}}function bt(r){qt?dt?dt.push(r):dt=[r]:qt=r}function dn(){if(qt){var r=qt,o=dt;if(dt=qt=null,Ye(r),o)for(r=0;r<o.length;r++)Ye(o[r])}}function ft(r,o){return r(o)}function Cs(){}var Gt=!1;function pt(r,o,m){if(Gt)return r(o,m);Gt=!0;try{return ft(r,o,m)}finally{Gt=!1,(qt!==null||dt!==null)&&(Cs(),dn())}}function Nt(r,o){var m=r.stateNode;if(m===null)return null;var v=Nd(m);if(v===null)return null;m=v[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(r=r.type,v=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!v;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(n(231,o,typeof m));return m}var Yn=!1;if(u)try{var mn={};Object.defineProperty(mn,"passive",{get:function(){Yn=!0}}),window.addEventListener("test",mn,mn),window.removeEventListener("test",mn,mn)}catch{Yn=!1}function rn(r,o,m,v,M,T,B,ee,ae){var he=Array.prototype.slice.call(arguments,3);try{o.apply(m,he)}catch(xe){this.onError(xe)}}var hn=!1,Cn=null,At=!1,Gn=null,Ht={onError:function(r){hn=!0,Cn=r}};function fn(r,o,m,v,M,T,B,ee,ae){hn=!1,Cn=null,rn.apply(Ht,arguments)}function Sn(r,o,m,v,M,T,B,ee,ae){if(fn.apply(this,arguments),hn){if(hn){var he=Cn;hn=!1,Cn=null}else throw Error(n(198));At||(At=!0,Gn=he)}}function Ve(r){var o=r,m=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,o.flags&4098&&(m=o.return),r=o.return;while(r)}return o.tag===3?m:null}function tr(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function Qn(r){if(Ve(r)!==r)throw Error(n(188))}function as(r){var o=r.alternate;if(!o){if(o=Ve(r),o===null)throw Error(n(188));return o!==r?null:r}for(var m=r,v=o;;){var M=m.return;if(M===null)break;var T=M.alternate;if(T===null){if(v=M.return,v!==null){m=v;continue}break}if(M.child===T.child){for(T=M.child;T;){if(T===m)return Qn(M),r;if(T===v)return Qn(M),o;T=T.sibling}throw Error(n(188))}if(m.return!==v.return)m=M,v=T;else{for(var B=!1,ee=M.child;ee;){if(ee===m){B=!0,m=M,v=T;break}if(ee===v){B=!0,v=M,m=T;break}ee=ee.sibling}if(!B){for(ee=T.child;ee;){if(ee===m){B=!0,m=T,v=M;break}if(ee===v){B=!0,v=T,m=M;break}ee=ee.sibling}if(!B)throw Error(n(189))}}if(m.alternate!==v)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?r:o}function Fn(r){return r=as(r),r!==null?os(r):null}function os(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=os(r);if(o!==null)return o;r=r.sibling}return null}var Ss=t.unstable_scheduleCallback,In=t.unstable_cancelCallback,nr=t.unstable_shouldYield,Qt=t.unstable_requestPaint,Xe=t.unstable_now,Bt=t.unstable_getCurrentPriorityLevel,Bn=t.unstable_ImmediatePriority,qs=t.unstable_UserBlockingPriority,is=t.unstable_NormalPriority,gr=t.unstable_LowPriority,ie=t.unstable_IdlePriority,ve=null,Pe=null;function jt(r){if(Pe&&typeof Pe.onCommitFiberRoot=="function")try{Pe.onCommitFiberRoot(ve,r,void 0,(r.current.flags&128)===128)}catch{}}var we=Math.clz32?Math.clz32:Ft,nt=Math.log,tt=Math.LN2;function Ft(r){return r>>>=0,r===0?32:31-(nt(r)/tt|0)|0}var Ot=64,nn=4194304;function Vt(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function pn(r,o){var m=r.pendingLanes;if(m===0)return 0;var v=0,M=r.suspendedLanes,T=r.pingedLanes,B=m&268435455;if(B!==0){var ee=B&~M;ee!==0?v=Vt(ee):(T&=B,T!==0&&(v=Vt(T)))}else B=m&~M,B!==0?v=Vt(B):T!==0&&(v=Vt(T));if(v===0)return 0;if(o!==0&&o!==v&&!(o&M)&&(M=v&-v,T=o&-o,M>=T||M===16&&(T&4194240)!==0))return o;if(v&4&&(v|=m&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=v;0<o;)m=31-we(o),M=1<<m,v|=r[m],o&=~M;return v}function Es(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Xn(r,o){for(var m=r.suspendedLanes,v=r.pingedLanes,M=r.expirationTimes,T=r.pendingLanes;0<T;){var B=31-we(T),ee=1<<B,ae=M[B];ae===-1?(!(ee&m)||ee&v)&&(M[B]=Es(ee,o)):ae<=o&&(r.expiredLanes|=ee),T&=~ee}}function yn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function En(){var r=Ot;return Ot<<=1,!(Ot&4194240)&&(Ot=64),r}function Jn(r){for(var o=[],m=0;31>m;m++)o.push(r);return o}function $n(r,o,m){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-we(o),r[o]=m}function Jr(r,o){var m=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var v=r.eventTimes;for(r=r.expirationTimes;0<m;){var M=31-we(m),T=1<<M;o[M]=0,v[M]=-1,r[M]=-1,m&=~T}}function $a(r,o){var m=r.entangledLanes|=o;for(r=r.entanglements;m;){var v=31-we(m),M=1<<v;M&o|r[v]&o&&(r[v]|=o),m&=~M}}var gt=0;function zo(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Do,Fo,Io,Or,_r,Hs=!1,Vs=[],Zn=null,Z=null,pe=null,me=new Map,ke=new Map,je=[],be="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function st(r,o){switch(r){case"focusin":case"focusout":Zn=null;break;case"dragenter":case"dragleave":Z=null;break;case"mouseover":case"mouseout":pe=null;break;case"pointerover":case"pointerout":me.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":ke.delete(o.pointerId)}}function Ae(r,o,m,v,M,T){return r===null||r.nativeEvent!==T?(r={blockedOn:o,domEventName:m,eventSystemFlags:v,nativeEvent:T,targetContainers:[M]},o!==null&&(o=jc(o),o!==null&&Fo(o)),r):(r.eventSystemFlags|=v,o=r.targetContainers,M!==null&&o.indexOf(M)===-1&&o.push(M),r)}function mt(r,o,m,v,M){switch(o){case"focusin":return Zn=Ae(Zn,r,o,m,v,M),!0;case"dragenter":return Z=Ae(Z,r,o,m,v,M),!0;case"mouseover":return pe=Ae(pe,r,o,m,v,M),!0;case"pointerover":var T=M.pointerId;return me.set(T,Ae(me.get(T)||null,r,o,m,v,M)),!0;case"gotpointercapture":return T=M.pointerId,ke.set(T,Ae(ke.get(T)||null,r,o,m,v,M)),!0}return!1}function ot(r){var o=Xo(r.target);if(o!==null){var m=Ve(o);if(m!==null){if(o=m.tag,o===13){if(o=tr(m),o!==null){r.blockedOn=o,_r(r.priority,function(){Io(m)});return}}else if(o===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Je(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var m=ps(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(m===null){m=r.nativeEvent;var v=new m.constructor(m.type,m);Rt=v,m.target.dispatchEvent(v),Rt=null}else return o=jc(m),o!==null&&Fo(o),r.blockedOn=m,!1;o.shift()}return!0}function Ct(r,o,m){Je(r)&&m.delete(o)}function Pn(){Hs=!1,Zn!==null&&Je(Zn)&&(Zn=null),Z!==null&&Je(Z)&&(Z=null),pe!==null&&Je(pe)&&(pe=null),me.forEach(Ct),ke.forEach(Ct)}function Wt(r,o){r.blockedOn===o&&(r.blockedOn=null,Hs||(Hs=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Pn)))}function kn(r){function o(M){return Wt(M,r)}if(0<Vs.length){Wt(Vs[0],r);for(var m=1;m<Vs.length;m++){var v=Vs[m];v.blockedOn===r&&(v.blockedOn=null)}}for(Zn!==null&&Wt(Zn,r),Z!==null&&Wt(Z,r),pe!==null&&Wt(pe,r),me.forEach(o),ke.forEach(o),m=0;m<je.length;m++)v=je[m],v.blockedOn===r&&(v.blockedOn=null);for(;0<je.length&&(m=je[0],m.blockedOn===null);)ot(m),m.blockedOn===null&&je.shift()}var ks=j.ReactCurrentBatchConfig,Ms=!0;function Ws(r,o,m,v){var M=gt,T=ks.transition;ks.transition=null;try{gt=1,sr(r,o,m,v)}finally{gt=M,ks.transition=T}}function Tr(r,o,m,v){var M=gt,T=ks.transition;ks.transition=null;try{gt=4,sr(r,o,m,v)}finally{gt=M,ks.transition=T}}function sr(r,o,m,v){if(Ms){var M=ps(r,o,m,v);if(M===null)Gi(r,o,v,Un,m),st(r,v);else if(mt(M,r,o,m,v))v.stopPropagation();else if(st(r,v),o&4&&-1<be.indexOf(r)){for(;M!==null;){var T=jc(M);if(T!==null&&Do(T),T=ps(r,o,m,v),T===null&&Gi(r,o,v,Un,m),T===M)break;M=T}M!==null&&v.stopPropagation()}else Gi(r,o,v,null,m)}}var Un=null;function ps(r,o,m,v){if(Un=null,r=tn(v),r=Xo(r),r!==null)if(o=Ve(r),o===null)r=null;else if(m=o.tag,m===13){if(r=tr(o),r!==null)return r;r=null}else if(m===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return Un=r,null}function Pa(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bt()){case Bn:return 1;case qs:return 4;case is:case gr:return 16;case ie:return 536870912;default:return 16}default:return 16}}var gs=null,Zr=null,ea=null;function ta(){if(ea)return ea;var r,o=Zr,m=o.length,v,M="value"in gs?gs.value:gs.textContent,T=M.length;for(r=0;r<m&&o[r]===M[r];r++);var B=m-r;for(v=1;v<=B&&o[m-v]===M[T-v];v++);return ea=M.slice(r,1<v?1-v:void 0)}function na(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function sa(){return!0}function Ra(){return!1}function Mn(r){function o(m,v,M,T,B){this._reactName=m,this._targetInst=M,this.type=v,this.nativeEvent=T,this.target=B,this.currentTarget=null;for(var ee in r)r.hasOwnProperty(ee)&&(m=r[ee],this[ee]=m?m(T):T[ee]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?sa:Ra,this.isPropagationStopped=Ra,this}return I(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=sa)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=sa)},persist:function(){},isPersistent:sa}),o}var Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ks=Mn(Jt),$r=I({},Jt,{view:0,detail:0}),sc=Mn($r),La,Zt,An,es=I({},$r,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vr,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==An&&(An&&r.type==="mousemove"?(La=r.screenX-An.screenX,Zt=r.screenY-An.screenY):Zt=La=0,An=r),La)},movementY:function(r){return"movementY"in r?r.movementY:Zt}}),Bo=Mn(es),af=I({},es,{dataTransfer:0}),rc=Mn(af),of=I({},$r,{relatedTarget:0}),za=Mn(of),ac=I({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0}),lf=Mn(ac),cf=I({},Jt,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),uf=Mn(cf),ra=I({},Jt,{data:0}),Ui=Mn(ra),oc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Uo={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Da(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=qi[r])?!!o[r]:!1}function vr(){return Da}var Xu=I({},$r,{key:function(r){if(r.key){var o=oc[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=na(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?Uo[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vr,charCode:function(r){return r.type==="keypress"?na(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?na(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),gn=Mn(Xu),an=I({},es,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ht=Mn(an),Ys=I({},$r,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vr}),df=Mn(Ys),mf=I({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0}),qo=Mn(mf),Ju=I({},es,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),hf=Mn(Ju),_n=[9,13,27,32],ic=u&&"CompositionEvent"in window,Ho=null;u&&"documentMode"in document&&(Ho=document.documentMode);var ff=u&&"TextEvent"in window&&!Ho,Zu=u&&(!ic||Ho&&8<Ho&&11>=Ho),Hi=" ",lc=!1;function cc(r,o){switch(r){case"keyup":return _n.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uc(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var aa=!1;function pf(r,o){switch(r){case"compositionend":return uc(o);case"keypress":return o.which!==32?null:(lc=!0,Hi);case"textInput":return r=o.data,r===Hi&&lc?null:r;default:return null}}function Pr(r,o){if(aa)return r==="compositionend"||!ic&&cc(r,o)?(r=ta(),ea=Zr=gs=null,aa=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Zu&&o.locale!=="ko"?null:o.data;default:return null}}var ed={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function dc(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!ed[r.type]:o==="textarea"}function mc(r,o,m,v){bt(v),o=Go(o,"onChange"),0<o.length&&(m=new Ks("onChange","change",null,m,v),r.push({event:m,listeners:o}))}var Fa=null,oa=null;function td(r){xd(r,0)}function Vo(r){var o=Xi(r);if(ze(o))return r}function nd(r,o){if(r==="change")return o}var sd=!1;if(u){var hc;if(u){var fc="oninput"in document;if(!fc){var rd=document.createElement("div");rd.setAttribute("oninput","return;"),fc=typeof rd.oninput=="function"}hc=fc}else hc=!1;sd=hc&&(!document.documentMode||9<document.documentMode)}function ad(){Fa&&(Fa.detachEvent("onpropertychange",od),oa=Fa=null)}function od(r){if(r.propertyName==="value"&&Vo(oa)){var o=[];mc(o,oa,r,tn(r)),pt(td,o)}}function gf(r,o,m){r==="focusin"?(ad(),Fa=o,oa=m,Fa.attachEvent("onpropertychange",od)):r==="focusout"&&ad()}function _f(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Vo(oa)}function Vi(r,o){if(r==="click")return Vo(o)}function id(r,o){if(r==="input"||r==="change")return Vo(o)}function vf(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Gs=typeof Object.is=="function"?Object.is:vf;function Wo(r,o){if(Gs(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var m=Object.keys(r),v=Object.keys(o);if(m.length!==v.length)return!1;for(v=0;v<m.length;v++){var M=m[v];if(!d.call(o,M)||!Gs(r[M],o[M]))return!1}return!0}function ld(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function cd(r,o){var m=ld(r);r=0;for(var v;m;){if(m.nodeType===3){if(v=r+m.textContent.length,r<=o&&v>=o)return{node:m,offset:o-r};r=v}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=ld(m)}}function ud(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?ud(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function dd(){for(var r=window,o=$e();o instanceof r.HTMLIFrameElement;){try{var m=typeof o.contentWindow.location.href=="string"}catch{m=!1}if(m)r=o.contentWindow;else break;o=$e(r.document)}return o}function pc(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function yf(r){var o=dd(),m=r.focusedElem,v=r.selectionRange;if(o!==m&&m&&m.ownerDocument&&ud(m.ownerDocument.documentElement,m)){if(v!==null&&pc(m)){if(o=v.start,r=v.end,r===void 0&&(r=o),"selectionStart"in m)m.selectionStart=o,m.selectionEnd=Math.min(r,m.value.length);else if(r=(o=m.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var M=m.textContent.length,T=Math.min(v.start,M);v=v.end===void 0?T:Math.min(v.end,M),!r.extend&&T>v&&(M=v,v=T,T=M),M=cd(m,T);var B=cd(m,v);M&&B&&(r.rangeCount!==1||r.anchorNode!==M.node||r.anchorOffset!==M.offset||r.focusNode!==B.node||r.focusOffset!==B.offset)&&(o=o.createRange(),o.setStart(M.node,M.offset),r.removeAllRanges(),T>v?(r.addRange(o),r.extend(B.node,B.offset)):(o.setEnd(B.node,B.offset),r.addRange(o)))}}for(o=[],r=m;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<o.length;m++)r=o[m],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var bf=u&&"documentMode"in document&&11>=document.documentMode,Ia=null,gc=null,Ko=null,_c=!1;function md(r,o,m){var v=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;_c||Ia==null||Ia!==$e(v)||(v=Ia,"selectionStart"in v&&pc(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Ko&&Wo(Ko,v)||(Ko=v,v=Go(gc,"onSelect"),0<v.length&&(o=new Ks("onSelect","select",null,o,m),r.push({event:o,listeners:v}),o.target=Ia)))}function Wi(r,o){var m={};return m[r.toLowerCase()]=o.toLowerCase(),m["Webkit"+r]="webkit"+o,m["Moz"+r]="moz"+o,m}var Ba={animationend:Wi("Animation","AnimationEnd"),animationiteration:Wi("Animation","AnimationIteration"),animationstart:Wi("Animation","AnimationStart"),transitionend:Wi("Transition","TransitionEnd")},vc={},hd={};u&&(hd=document.createElement("div").style,"AnimationEvent"in window||(delete Ba.animationend.animation,delete Ba.animationiteration.animation,delete Ba.animationstart.animation),"TransitionEvent"in window||delete Ba.transitionend.transition);function Ki(r){if(vc[r])return vc[r];if(!Ba[r])return r;var o=Ba[r],m;for(m in o)if(o.hasOwnProperty(m)&&m in hd)return vc[r]=o[m];return r}var fd=Ki("animationend"),pd=Ki("animationiteration"),gd=Ki("animationstart"),_d=Ki("transitionend"),vd=new Map,yd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Rr(r,o){vd.set(r,o),l(o,[r])}for(var yc=0;yc<yd.length;yc++){var bc=yd[yc],xf=bc.toLowerCase(),wf=bc[0].toUpperCase()+bc.slice(1);Rr(xf,"on"+wf)}Rr(fd,"onAnimationEnd"),Rr(pd,"onAnimationIteration"),Rr(gd,"onAnimationStart"),Rr("dblclick","onDoubleClick"),Rr("focusin","onFocus"),Rr("focusout","onBlur"),Rr(_d,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Yo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Yo));function bd(r,o,m){var v=r.type||"unknown-event";r.currentTarget=m,Sn(v,o,void 0,r),r.currentTarget=null}function xd(r,o){o=(o&4)!==0;for(var m=0;m<r.length;m++){var v=r[m],M=v.event;v=v.listeners;e:{var T=void 0;if(o)for(var B=v.length-1;0<=B;B--){var ee=v[B],ae=ee.instance,he=ee.currentTarget;if(ee=ee.listener,ae!==T&&M.isPropagationStopped())break e;bd(M,ee,he),T=ae}else for(B=0;B<v.length;B++){if(ee=v[B],ae=ee.instance,he=ee.currentTarget,ee=ee.listener,ae!==T&&M.isPropagationStopped())break e;bd(M,ee,he),T=ae}}}if(At)throw r=Gn,At=!1,Gn=null,r}function kt(r,o){var m=o[Mf];m===void 0&&(m=o[Mf]=new Set);var v=r+"__bubble";m.has(v)||(xc(o,r,2,!1),m.add(v))}function Lt(r,o,m){var v=0;o&&(v|=4),xc(m,r,v,o)}var Yi="_reactListening"+Math.random().toString(36).slice(2);function Ua(r){if(!r[Yi]){r[Yi]=!0,s.forEach(function(m){m!=="selectionchange"&&(Nf.has(m)||Lt(m,!1,r),Lt(m,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Yi]||(o[Yi]=!0,Lt("selectionchange",!1,o))}}function xc(r,o,m,v){switch(Pa(o)){case 1:var M=Ws;break;case 4:M=Tr;break;default:M=sr}m=M.bind(null,o,m,r),M=void 0,!Yn||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(M=!0),v?M!==void 0?r.addEventListener(o,m,{capture:!0,passive:M}):r.addEventListener(o,m,!0):M!==void 0?r.addEventListener(o,m,{passive:M}):r.addEventListener(o,m,!1)}function Gi(r,o,m,v,M){var T=v;if(!(o&1)&&!(o&2)&&v!==null)e:for(;;){if(v===null)return;var B=v.tag;if(B===3||B===4){var ee=v.stateNode.containerInfo;if(ee===M||ee.nodeType===8&&ee.parentNode===M)break;if(B===4)for(B=v.return;B!==null;){var ae=B.tag;if((ae===3||ae===4)&&(ae=B.stateNode.containerInfo,ae===M||ae.nodeType===8&&ae.parentNode===M))return;B=B.return}for(;ee!==null;){if(B=Xo(ee),B===null)return;if(ae=B.tag,ae===5||ae===6){v=T=B;continue e}ee=ee.parentNode}}v=v.return}pt(function(){var he=T,xe=tn(m),Ce=[];e:{var ye=vd.get(r);if(ye!==void 0){var Le=Ks,Fe=r;switch(r){case"keypress":if(na(m)===0)break e;case"keydown":case"keyup":Le=gn;break;case"focusin":Fe="focus",Le=za;break;case"focusout":Fe="blur",Le=za;break;case"beforeblur":case"afterblur":Le=za;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Le=Bo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Le=rc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Le=df;break;case fd:case pd:case gd:Le=lf;break;case _d:Le=qo;break;case"scroll":Le=sc;break;case"wheel":Le=hf;break;case"copy":case"cut":case"paste":Le=uf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Le=ht}var Ie=(o&4)!==0,bn=!Ie&&r==="scroll",le=Ie?ye!==null?ye+"Capture":null:ye;Ie=[];for(var oe=he,ue;oe!==null;){ue=oe;var Ee=ue.stateNode;if(ue.tag===5&&Ee!==null&&(ue=Ee,le!==null&&(Ee=Nt(oe,le),Ee!=null&&Ie.push(qa(oe,Ee,ue)))),bn)break;oe=oe.return}0<Ie.length&&(ye=new Le(ye,Fe,null,m,xe),Ce.push({event:ye,listeners:Ie}))}}if(!(o&7)){e:{if(ye=r==="mouseover"||r==="pointerover",Le=r==="mouseout"||r==="pointerout",ye&&m!==Rt&&(Fe=m.relatedTarget||m.fromElement)&&(Xo(Fe)||Fe[ia]))break e;if((Le||ye)&&(ye=xe.window===xe?xe:(ye=xe.ownerDocument)?ye.defaultView||ye.parentWindow:window,Le?(Fe=m.relatedTarget||m.toElement,Le=he,Fe=Fe?Xo(Fe):null,Fe!==null&&(bn=Ve(Fe),Fe!==bn||Fe.tag!==5&&Fe.tag!==6)&&(Fe=null)):(Le=null,Fe=he),Le!==Fe)){if(Ie=Bo,Ee="onMouseLeave",le="onMouseEnter",oe="mouse",(r==="pointerout"||r==="pointerover")&&(Ie=ht,Ee="onPointerLeave",le="onPointerEnter",oe="pointer"),bn=Le==null?ye:Xi(Le),ue=Fe==null?ye:Xi(Fe),ye=new Ie(Ee,oe+"leave",Le,m,xe),ye.target=bn,ye.relatedTarget=ue,Ee=null,Xo(xe)===he&&(Ie=new Ie(le,oe+"enter",Fe,m,xe),Ie.target=ue,Ie.relatedTarget=bn,Ee=Ie),bn=Ee,Le&&Fe)t:{for(Ie=Le,le=Fe,oe=0,ue=Ie;ue;ue=St(ue))oe++;for(ue=0,Ee=le;Ee;Ee=St(Ee))ue++;for(;0<oe-ue;)Ie=St(Ie),oe--;for(;0<ue-oe;)le=St(le),ue--;for(;oe--;){if(Ie===le||le!==null&&Ie===le.alternate)break t;Ie=St(Ie),le=St(le)}Ie=null}else Ie=null;Le!==null&&As(Ce,ye,Le,Ie,!1),Fe!==null&&bn!==null&&As(Ce,bn,Fe,Ie,!0)}}e:{if(ye=he?Xi(he):window,Le=ye.nodeName&&ye.nodeName.toLowerCase(),Le==="select"||Le==="input"&&ye.type==="file")var qe=nd;else if(dc(ye))if(sd)qe=id;else{qe=_f;var Ze=gf}else(Le=ye.nodeName)&&Le.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&(qe=Vi);if(qe&&(qe=qe(r,he))){mc(Ce,qe,m,xe);break e}Ze&&Ze(r,ye,he),r==="focusout"&&(Ze=ye._wrapperState)&&Ze.controlled&&ye.type==="number"&&Ne(ye,"number",ye.value)}switch(Ze=he?Xi(he):window,r){case"focusin":(dc(Ze)||Ze.contentEditable==="true")&&(Ia=Ze,gc=he,Ko=null);break;case"focusout":Ko=gc=Ia=null;break;case"mousedown":_c=!0;break;case"contextmenu":case"mouseup":case"dragend":_c=!1,md(Ce,m,xe);break;case"selectionchange":if(bf)break;case"keydown":case"keyup":md(Ce,m,xe)}var et;if(ic)e:{switch(r){case"compositionstart":var lt="onCompositionStart";break e;case"compositionend":lt="onCompositionEnd";break e;case"compositionupdate":lt="onCompositionUpdate";break e}lt=void 0}else aa?cc(r,m)&&(lt="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(lt="onCompositionStart");lt&&(Zu&&m.locale!=="ko"&&(aa||lt!=="onCompositionStart"?lt==="onCompositionEnd"&&aa&&(et=ta()):(gs=xe,Zr="value"in gs?gs.value:gs.textContent,aa=!0)),Ze=Go(he,lt),0<Ze.length&&(lt=new Ui(lt,r,null,m,xe),Ce.push({event:lt,listeners:Ze}),et?lt.data=et:(et=uc(m),et!==null&&(lt.data=et)))),(et=ff?pf(r,m):Pr(r,m))&&(he=Go(he,"onBeforeInput"),0<he.length&&(xe=new Ui("onBeforeInput","beforeinput",null,m,xe),Ce.push({event:xe,listeners:he}),xe.data=et))}xd(Ce,o)})}function qa(r,o,m){return{instance:r,listener:o,currentTarget:m}}function Go(r,o){for(var m=o+"Capture",v=[];r!==null;){var M=r,T=M.stateNode;M.tag===5&&T!==null&&(M=T,T=Nt(r,m),T!=null&&v.unshift(qa(r,T,M)),T=Nt(r,o),T!=null&&v.push(qa(r,T,M))),r=r.return}return v}function St(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function As(r,o,m,v,M){for(var T=o._reactName,B=[];m!==null&&m!==v;){var ee=m,ae=ee.alternate,he=ee.stateNode;if(ae!==null&&ae===v)break;ee.tag===5&&he!==null&&(ee=he,M?(ae=Nt(m,T),ae!=null&&B.unshift(qa(m,ae,ee))):M||(ae=Nt(m,T),ae!=null&&B.push(qa(m,ae,ee)))),m=m.return}B.length!==0&&r.push({event:o,listeners:B})}var Ha=/\r\n?/g,wc=/\u0000|\uFFFD/g;function Qo(r){return(typeof r=="string"?r:""+r).replace(Ha,`
`).replace(wc,"")}function Va(r,o,m){if(o=Qo(o),Qo(r)!==o&&m)throw Error(n(425))}function wd(){}var jf=null,Cf=null;function Sf(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Ef=typeof setTimeout=="function"?setTimeout:void 0,SL=typeof clearTimeout=="function"?clearTimeout:void 0,n0=typeof Promise=="function"?Promise:void 0,EL=typeof queueMicrotask=="function"?queueMicrotask:typeof n0<"u"?function(r){return n0.resolve(null).then(r).catch(kL)}:Ef;function kL(r){setTimeout(function(){throw r})}function kf(r,o){var m=o,v=0;do{var M=m.nextSibling;if(r.removeChild(m),M&&M.nodeType===8)if(m=M.data,m==="/$"){if(v===0){r.removeChild(M),kn(o);return}v--}else m!=="$"&&m!=="$?"&&m!=="$!"||v++;m=M}while(m);kn(o)}function Wa(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function s0(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(o===0)return r;o--}else m==="/$"&&o++}r=r.previousSibling}return null}var Qi=Math.random().toString(36).slice(2),Lr="__reactFiber$"+Qi,Nc="__reactProps$"+Qi,ia="__reactContainer$"+Qi,Mf="__reactEvents$"+Qi,ML="__reactListeners$"+Qi,AL="__reactHandles$"+Qi;function Xo(r){var o=r[Lr];if(o)return o;for(var m=r.parentNode;m;){if(o=m[ia]||m[Lr]){if(m=o.alternate,o.child!==null||m!==null&&m.child!==null)for(r=s0(r);r!==null;){if(m=r[Lr])return m;r=s0(r)}return o}r=m,m=r.parentNode}return null}function jc(r){return r=r[Lr]||r[ia],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Xi(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function Nd(r){return r[Nc]||null}var Af=[],Ji=-1;function Ka(r){return{current:r}}function en(r){0>Ji||(r.current=Af[Ji],Af[Ji]=null,Ji--)}function Xt(r,o){Ji++,Af[Ji]=r.current,r.current=o}var Ya={},ls=Ka(Ya),Os=Ka(!1),Jo=Ya;function Zi(r,o){var m=r.type.contextTypes;if(!m)return Ya;var v=r.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===o)return v.__reactInternalMemoizedMaskedChildContext;var M={},T;for(T in m)M[T]=o[T];return v&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=M),M}function Ts(r){return r=r.childContextTypes,r!=null}function jd(){en(Os),en(ls)}function r0(r,o,m){if(ls.current!==Ya)throw Error(n(168));Xt(ls,o),Xt(Os,m)}function a0(r,o,m){var v=r.stateNode;if(o=o.childContextTypes,typeof v.getChildContext!="function")return m;v=v.getChildContext();for(var M in v)if(!(M in o))throw Error(n(108,Q(r)||"Unknown",M));return I({},m,v)}function Cd(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Ya,Jo=ls.current,Xt(ls,r),Xt(Os,Os.current),!0}function o0(r,o,m){var v=r.stateNode;if(!v)throw Error(n(169));m?(r=a0(r,o,Jo),v.__reactInternalMemoizedMergedChildContext=r,en(Os),en(ls),Xt(ls,r)):en(Os),Xt(Os,m)}var la=null,Sd=!1,Of=!1;function i0(r){la===null?la=[r]:la.push(r)}function OL(r){Sd=!0,i0(r)}function Ga(){if(!Of&&la!==null){Of=!0;var r=0,o=gt;try{var m=la;for(gt=1;r<m.length;r++){var v=m[r];do v=v(!0);while(v!==null)}la=null,Sd=!1}catch(M){throw la!==null&&(la=la.slice(r+1)),Ss(Bn,Ga),M}finally{gt=o,Of=!1}}return null}var el=[],tl=0,Ed=null,kd=0,rr=[],ar=0,Zo=null,ca=1,ua="";function ei(r,o){el[tl++]=kd,el[tl++]=Ed,Ed=r,kd=o}function l0(r,o,m){rr[ar++]=ca,rr[ar++]=ua,rr[ar++]=Zo,Zo=r;var v=ca;r=ua;var M=32-we(v)-1;v&=~(1<<M),m+=1;var T=32-we(o)+M;if(30<T){var B=M-M%5;T=(v&(1<<B)-1).toString(32),v>>=B,M-=B,ca=1<<32-we(o)+M|m<<M|v,ua=T+r}else ca=1<<T|m<<M|v,ua=r}function Tf(r){r.return!==null&&(ei(r,1),l0(r,1,0))}function $f(r){for(;r===Ed;)Ed=el[--tl],el[tl]=null,kd=el[--tl],el[tl]=null;for(;r===Zo;)Zo=rr[--ar],rr[ar]=null,ua=rr[--ar],rr[ar]=null,ca=rr[--ar],rr[ar]=null}var Qs=null,Xs=null,sn=!1,yr=null;function c0(r,o){var m=cr(5,null,null,0);m.elementType="DELETED",m.stateNode=o,m.return=r,o=r.deletions,o===null?(r.deletions=[m],r.flags|=16):o.push(m)}function u0(r,o){switch(r.tag){case 5:var m=r.type;return o=o.nodeType!==1||m.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,Qs=r,Xs=Wa(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,Qs=r,Xs=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(m=Zo!==null?{id:ca,overflow:ua}:null,r.memoizedState={dehydrated:o,treeContext:m,retryLane:1073741824},m=cr(18,null,null,0),m.stateNode=o,m.return=r,r.child=m,Qs=r,Xs=null,!0):!1;default:return!1}}function Pf(r){return(r.mode&1)!==0&&(r.flags&128)===0}function Rf(r){if(sn){var o=Xs;if(o){var m=o;if(!u0(r,o)){if(Pf(r))throw Error(n(418));o=Wa(m.nextSibling);var v=Qs;o&&u0(r,o)?c0(v,m):(r.flags=r.flags&-4097|2,sn=!1,Qs=r)}}else{if(Pf(r))throw Error(n(418));r.flags=r.flags&-4097|2,sn=!1,Qs=r}}}function d0(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Qs=r}function Md(r){if(r!==Qs)return!1;if(!sn)return d0(r),sn=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!Sf(r.type,r.memoizedProps)),o&&(o=Xs)){if(Pf(r))throw m0(),Error(n(418));for(;o;)c0(r,o),o=Wa(o.nextSibling)}if(d0(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="/$"){if(o===0){Xs=Wa(r.nextSibling);break e}o--}else m!=="$"&&m!=="$!"&&m!=="$?"||o++}r=r.nextSibling}Xs=null}}else Xs=Qs?Wa(r.stateNode.nextSibling):null;return!0}function m0(){for(var r=Xs;r;)r=Wa(r.nextSibling)}function nl(){Xs=Qs=null,sn=!1}function Lf(r){yr===null?yr=[r]:yr.push(r)}var TL=j.ReactCurrentBatchConfig;function Cc(r,o,m){if(r=m.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(n(309));var v=m.stateNode}if(!v)throw Error(n(147,r));var M=v,T=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===T?o.ref:(o=function(B){var ee=M.refs;B===null?delete ee[T]:ee[T]=B},o._stringRef=T,o)}if(typeof r!="string")throw Error(n(284));if(!m._owner)throw Error(n(290,r))}return r}function Ad(r,o){throw r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function h0(r){var o=r._init;return o(r._payload)}function f0(r){function o(le,oe){if(r){var ue=le.deletions;ue===null?(le.deletions=[oe],le.flags|=16):ue.push(oe)}}function m(le,oe){if(!r)return null;for(;oe!==null;)o(le,oe),oe=oe.sibling;return null}function v(le,oe){for(le=new Map;oe!==null;)oe.key!==null?le.set(oe.key,oe):le.set(oe.index,oe),oe=oe.sibling;return le}function M(le,oe){return le=so(le,oe),le.index=0,le.sibling=null,le}function T(le,oe,ue){return le.index=ue,r?(ue=le.alternate,ue!==null?(ue=ue.index,ue<oe?(le.flags|=2,oe):ue):(le.flags|=2,oe)):(le.flags|=1048576,oe)}function B(le){return r&&le.alternate===null&&(le.flags|=2),le}function ee(le,oe,ue,Ee){return oe===null||oe.tag!==6?(oe=Ep(ue,le.mode,Ee),oe.return=le,oe):(oe=M(oe,ue),oe.return=le,oe)}function ae(le,oe,ue,Ee){var qe=ue.type;return qe===O?xe(le,oe,ue.props.children,Ee,ue.key):oe!==null&&(oe.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===q&&h0(qe)===oe.type)?(Ee=M(oe,ue.props),Ee.ref=Cc(le,oe,ue),Ee.return=le,Ee):(Ee=em(ue.type,ue.key,ue.props,null,le.mode,Ee),Ee.ref=Cc(le,oe,ue),Ee.return=le,Ee)}function he(le,oe,ue,Ee){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==ue.containerInfo||oe.stateNode.implementation!==ue.implementation?(oe=kp(ue,le.mode,Ee),oe.return=le,oe):(oe=M(oe,ue.children||[]),oe.return=le,oe)}function xe(le,oe,ue,Ee,qe){return oe===null||oe.tag!==7?(oe=li(ue,le.mode,Ee,qe),oe.return=le,oe):(oe=M(oe,ue),oe.return=le,oe)}function Ce(le,oe,ue){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Ep(""+oe,le.mode,ue),oe.return=le,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case C:return ue=em(oe.type,oe.key,oe.props,null,le.mode,ue),ue.ref=Cc(le,null,oe),ue.return=le,ue;case k:return oe=kp(oe,le.mode,ue),oe.return=le,oe;case q:var Ee=oe._init;return Ce(le,Ee(oe._payload),ue)}if(Me(oe)||X(oe))return oe=li(oe,le.mode,ue,null),oe.return=le,oe;Ad(le,oe)}return null}function ye(le,oe,ue,Ee){var qe=oe!==null?oe.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return qe!==null?null:ee(le,oe,""+ue,Ee);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case C:return ue.key===qe?ae(le,oe,ue,Ee):null;case k:return ue.key===qe?he(le,oe,ue,Ee):null;case q:return qe=ue._init,ye(le,oe,qe(ue._payload),Ee)}if(Me(ue)||X(ue))return qe!==null?null:xe(le,oe,ue,Ee,null);Ad(le,ue)}return null}function Le(le,oe,ue,Ee,qe){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return le=le.get(ue)||null,ee(oe,le,""+Ee,qe);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case C:return le=le.get(Ee.key===null?ue:Ee.key)||null,ae(oe,le,Ee,qe);case k:return le=le.get(Ee.key===null?ue:Ee.key)||null,he(oe,le,Ee,qe);case q:var Ze=Ee._init;return Le(le,oe,ue,Ze(Ee._payload),qe)}if(Me(Ee)||X(Ee))return le=le.get(ue)||null,xe(oe,le,Ee,qe,null);Ad(oe,Ee)}return null}function Fe(le,oe,ue,Ee){for(var qe=null,Ze=null,et=oe,lt=oe=0,Vn=null;et!==null&&lt<ue.length;lt++){et.index>lt?(Vn=et,et=null):Vn=et.sibling;var zt=ye(le,et,ue[lt],Ee);if(zt===null){et===null&&(et=Vn);break}r&&et&&zt.alternate===null&&o(le,et),oe=T(zt,oe,lt),Ze===null?qe=zt:Ze.sibling=zt,Ze=zt,et=Vn}if(lt===ue.length)return m(le,et),sn&&ei(le,lt),qe;if(et===null){for(;lt<ue.length;lt++)et=Ce(le,ue[lt],Ee),et!==null&&(oe=T(et,oe,lt),Ze===null?qe=et:Ze.sibling=et,Ze=et);return sn&&ei(le,lt),qe}for(et=v(le,et);lt<ue.length;lt++)Vn=Le(et,le,lt,ue[lt],Ee),Vn!==null&&(r&&Vn.alternate!==null&&et.delete(Vn.key===null?lt:Vn.key),oe=T(Vn,oe,lt),Ze===null?qe=Vn:Ze.sibling=Vn,Ze=Vn);return r&&et.forEach(function(ro){return o(le,ro)}),sn&&ei(le,lt),qe}function Ie(le,oe,ue,Ee){var qe=X(ue);if(typeof qe!="function")throw Error(n(150));if(ue=qe.call(ue),ue==null)throw Error(n(151));for(var Ze=qe=null,et=oe,lt=oe=0,Vn=null,zt=ue.next();et!==null&&!zt.done;lt++,zt=ue.next()){et.index>lt?(Vn=et,et=null):Vn=et.sibling;var ro=ye(le,et,zt.value,Ee);if(ro===null){et===null&&(et=Vn);break}r&&et&&ro.alternate===null&&o(le,et),oe=T(ro,oe,lt),Ze===null?qe=ro:Ze.sibling=ro,Ze=ro,et=Vn}if(zt.done)return m(le,et),sn&&ei(le,lt),qe;if(et===null){for(;!zt.done;lt++,zt=ue.next())zt=Ce(le,zt.value,Ee),zt!==null&&(oe=T(zt,oe,lt),Ze===null?qe=zt:Ze.sibling=zt,Ze=zt);return sn&&ei(le,lt),qe}for(et=v(le,et);!zt.done;lt++,zt=ue.next())zt=Le(et,le,lt,zt.value,Ee),zt!==null&&(r&&zt.alternate!==null&&et.delete(zt.key===null?lt:zt.key),oe=T(zt,oe,lt),Ze===null?qe=zt:Ze.sibling=zt,Ze=zt);return r&&et.forEach(function(dz){return o(le,dz)}),sn&&ei(le,lt),qe}function bn(le,oe,ue,Ee){if(typeof ue=="object"&&ue!==null&&ue.type===O&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case C:e:{for(var qe=ue.key,Ze=oe;Ze!==null;){if(Ze.key===qe){if(qe=ue.type,qe===O){if(Ze.tag===7){m(le,Ze.sibling),oe=M(Ze,ue.props.children),oe.return=le,le=oe;break e}}else if(Ze.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===q&&h0(qe)===Ze.type){m(le,Ze.sibling),oe=M(Ze,ue.props),oe.ref=Cc(le,Ze,ue),oe.return=le,le=oe;break e}m(le,Ze);break}else o(le,Ze);Ze=Ze.sibling}ue.type===O?(oe=li(ue.props.children,le.mode,Ee,ue.key),oe.return=le,le=oe):(Ee=em(ue.type,ue.key,ue.props,null,le.mode,Ee),Ee.ref=Cc(le,oe,ue),Ee.return=le,le=Ee)}return B(le);case k:e:{for(Ze=ue.key;oe!==null;){if(oe.key===Ze)if(oe.tag===4&&oe.stateNode.containerInfo===ue.containerInfo&&oe.stateNode.implementation===ue.implementation){m(le,oe.sibling),oe=M(oe,ue.children||[]),oe.return=le,le=oe;break e}else{m(le,oe);break}else o(le,oe);oe=oe.sibling}oe=kp(ue,le.mode,Ee),oe.return=le,le=oe}return B(le);case q:return Ze=ue._init,bn(le,oe,Ze(ue._payload),Ee)}if(Me(ue))return Fe(le,oe,ue,Ee);if(X(ue))return Ie(le,oe,ue,Ee);Ad(le,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,oe!==null&&oe.tag===6?(m(le,oe.sibling),oe=M(oe,ue),oe.return=le,le=oe):(m(le,oe),oe=Ep(ue,le.mode,Ee),oe.return=le,le=oe),B(le)):m(le,oe)}return bn}var sl=f0(!0),p0=f0(!1),Od=Ka(null),Td=null,rl=null,zf=null;function Df(){zf=rl=Td=null}function Ff(r){var o=Od.current;en(Od),r._currentValue=o}function If(r,o,m){for(;r!==null;){var v=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,v!==null&&(v.childLanes|=o)):v!==null&&(v.childLanes&o)!==o&&(v.childLanes|=o),r===m)break;r=r.return}}function al(r,o){Td=r,zf=rl=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&o&&($s=!0),r.firstContext=null)}function or(r){var o=r._currentValue;if(zf!==r)if(r={context:r,memoizedValue:o,next:null},rl===null){if(Td===null)throw Error(n(308));rl=r,Td.dependencies={lanes:0,firstContext:r}}else rl=rl.next=r;return o}var ti=null;function Bf(r){ti===null?ti=[r]:ti.push(r)}function g0(r,o,m,v){var M=o.interleaved;return M===null?(m.next=m,Bf(o)):(m.next=M.next,M.next=m),o.interleaved=m,da(r,v)}function da(r,o){r.lanes|=o;var m=r.alternate;for(m!==null&&(m.lanes|=o),m=r,r=r.return;r!==null;)r.childLanes|=o,m=r.alternate,m!==null&&(m.childLanes|=o),m=r,r=r.return;return m.tag===3?m.stateNode:null}var Qa=!1;function Uf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _0(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function ma(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function Xa(r,o,m){var v=r.updateQueue;if(v===null)return null;if(v=v.shared,Pt&2){var M=v.pending;return M===null?o.next=o:(o.next=M.next,M.next=o),v.pending=o,da(r,m)}return M=v.interleaved,M===null?(o.next=o,Bf(v)):(o.next=M.next,M.next=o),v.interleaved=o,da(r,m)}function $d(r,o,m){if(o=o.updateQueue,o!==null&&(o=o.shared,(m&4194240)!==0)){var v=o.lanes;v&=r.pendingLanes,m|=v,o.lanes=m,$a(r,m)}}function v0(r,o){var m=r.updateQueue,v=r.alternate;if(v!==null&&(v=v.updateQueue,m===v)){var M=null,T=null;if(m=m.firstBaseUpdate,m!==null){do{var B={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};T===null?M=T=B:T=T.next=B,m=m.next}while(m!==null);T===null?M=T=o:T=T.next=o}else M=T=o;m={baseState:v.baseState,firstBaseUpdate:M,lastBaseUpdate:T,shared:v.shared,effects:v.effects},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=o:r.next=o,m.lastBaseUpdate=o}function Pd(r,o,m,v){var M=r.updateQueue;Qa=!1;var T=M.firstBaseUpdate,B=M.lastBaseUpdate,ee=M.shared.pending;if(ee!==null){M.shared.pending=null;var ae=ee,he=ae.next;ae.next=null,B===null?T=he:B.next=he,B=ae;var xe=r.alternate;xe!==null&&(xe=xe.updateQueue,ee=xe.lastBaseUpdate,ee!==B&&(ee===null?xe.firstBaseUpdate=he:ee.next=he,xe.lastBaseUpdate=ae))}if(T!==null){var Ce=M.baseState;B=0,xe=he=ae=null,ee=T;do{var ye=ee.lane,Le=ee.eventTime;if((v&ye)===ye){xe!==null&&(xe=xe.next={eventTime:Le,lane:0,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null});e:{var Fe=r,Ie=ee;switch(ye=o,Le=m,Ie.tag){case 1:if(Fe=Ie.payload,typeof Fe=="function"){Ce=Fe.call(Le,Ce,ye);break e}Ce=Fe;break e;case 3:Fe.flags=Fe.flags&-65537|128;case 0:if(Fe=Ie.payload,ye=typeof Fe=="function"?Fe.call(Le,Ce,ye):Fe,ye==null)break e;Ce=I({},Ce,ye);break e;case 2:Qa=!0}}ee.callback!==null&&ee.lane!==0&&(r.flags|=64,ye=M.effects,ye===null?M.effects=[ee]:ye.push(ee))}else Le={eventTime:Le,lane:ye,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},xe===null?(he=xe=Le,ae=Ce):xe=xe.next=Le,B|=ye;if(ee=ee.next,ee===null){if(ee=M.shared.pending,ee===null)break;ye=ee,ee=ye.next,ye.next=null,M.lastBaseUpdate=ye,M.shared.pending=null}}while(!0);if(xe===null&&(ae=Ce),M.baseState=ae,M.firstBaseUpdate=he,M.lastBaseUpdate=xe,o=M.shared.interleaved,o!==null){M=o;do B|=M.lane,M=M.next;while(M!==o)}else T===null&&(M.shared.lanes=0);ri|=B,r.lanes=B,r.memoizedState=Ce}}function y0(r,o,m){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var v=r[o],M=v.callback;if(M!==null){if(v.callback=null,v=m,typeof M!="function")throw Error(n(191,M));M.call(v)}}}var Sc={},zr=Ka(Sc),Ec=Ka(Sc),kc=Ka(Sc);function ni(r){if(r===Sc)throw Error(n(174));return r}function qf(r,o){switch(Xt(kc,o),Xt(Ec,r),Xt(zr,Sc),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:vt(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=vt(o,r)}en(zr),Xt(zr,o)}function ol(){en(zr),en(Ec),en(kc)}function b0(r){ni(kc.current);var o=ni(zr.current),m=vt(o,r.type);o!==m&&(Xt(Ec,r),Xt(zr,m))}function Hf(r){Ec.current===r&&(en(zr),en(Ec))}var on=Ka(0);function Rd(r){for(var o=r;o!==null;){if(o.tag===13){var m=o.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Vf=[];function Wf(){for(var r=0;r<Vf.length;r++)Vf[r]._workInProgressVersionPrimary=null;Vf.length=0}var Ld=j.ReactCurrentDispatcher,Kf=j.ReactCurrentBatchConfig,si=0,ln=null,Rn=null,qn=null,zd=!1,Mc=!1,Ac=0,$L=0;function cs(){throw Error(n(321))}function Yf(r,o){if(o===null)return!1;for(var m=0;m<o.length&&m<r.length;m++)if(!Gs(r[m],o[m]))return!1;return!0}function Gf(r,o,m,v,M,T){if(si=T,ln=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ld.current=r===null||r.memoizedState===null?zL:DL,r=m(v,M),Mc){T=0;do{if(Mc=!1,Ac=0,25<=T)throw Error(n(301));T+=1,qn=Rn=null,o.updateQueue=null,Ld.current=FL,r=m(v,M)}while(Mc)}if(Ld.current=Id,o=Rn!==null&&Rn.next!==null,si=0,qn=Rn=ln=null,zd=!1,o)throw Error(n(300));return r}function Qf(){var r=Ac!==0;return Ac=0,r}function Dr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?ln.memoizedState=qn=r:qn=qn.next=r,qn}function ir(){if(Rn===null){var r=ln.alternate;r=r!==null?r.memoizedState:null}else r=Rn.next;var o=qn===null?ln.memoizedState:qn.next;if(o!==null)qn=o,Rn=r;else{if(r===null)throw Error(n(310));Rn=r,r={memoizedState:Rn.memoizedState,baseState:Rn.baseState,baseQueue:Rn.baseQueue,queue:Rn.queue,next:null},qn===null?ln.memoizedState=qn=r:qn=qn.next=r}return qn}function Oc(r,o){return typeof o=="function"?o(r):o}function Xf(r){var o=ir(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var v=Rn,M=v.baseQueue,T=m.pending;if(T!==null){if(M!==null){var B=M.next;M.next=T.next,T.next=B}v.baseQueue=M=T,m.pending=null}if(M!==null){T=M.next,v=v.baseState;var ee=B=null,ae=null,he=T;do{var xe=he.lane;if((si&xe)===xe)ae!==null&&(ae=ae.next={lane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),v=he.hasEagerState?he.eagerState:r(v,he.action);else{var Ce={lane:xe,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null};ae===null?(ee=ae=Ce,B=v):ae=ae.next=Ce,ln.lanes|=xe,ri|=xe}he=he.next}while(he!==null&&he!==T);ae===null?B=v:ae.next=ee,Gs(v,o.memoizedState)||($s=!0),o.memoizedState=v,o.baseState=B,o.baseQueue=ae,m.lastRenderedState=v}if(r=m.interleaved,r!==null){M=r;do T=M.lane,ln.lanes|=T,ri|=T,M=M.next;while(M!==r)}else M===null&&(m.lanes=0);return[o.memoizedState,m.dispatch]}function Jf(r){var o=ir(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var v=m.dispatch,M=m.pending,T=o.memoizedState;if(M!==null){m.pending=null;var B=M=M.next;do T=r(T,B.action),B=B.next;while(B!==M);Gs(T,o.memoizedState)||($s=!0),o.memoizedState=T,o.baseQueue===null&&(o.baseState=T),m.lastRenderedState=T}return[T,v]}function x0(){}function w0(r,o){var m=ln,v=ir(),M=o(),T=!Gs(v.memoizedState,M);if(T&&(v.memoizedState=M,$s=!0),v=v.queue,Zf(C0.bind(null,m,v,r),[r]),v.getSnapshot!==o||T||qn!==null&&qn.memoizedState.tag&1){if(m.flags|=2048,Tc(9,j0.bind(null,m,v,M,o),void 0,null),Hn===null)throw Error(n(349));si&30||N0(m,o,M)}return M}function N0(r,o,m){r.flags|=16384,r={getSnapshot:o,value:m},o=ln.updateQueue,o===null?(o={lastEffect:null,stores:null},ln.updateQueue=o,o.stores=[r]):(m=o.stores,m===null?o.stores=[r]:m.push(r))}function j0(r,o,m,v){o.value=m,o.getSnapshot=v,S0(o)&&E0(r)}function C0(r,o,m){return m(function(){S0(o)&&E0(r)})}function S0(r){var o=r.getSnapshot;r=r.value;try{var m=o();return!Gs(r,m)}catch{return!0}}function E0(r){var o=da(r,1);o!==null&&Nr(o,r,1,-1)}function k0(r){var o=Dr();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oc,lastRenderedState:r},o.queue=r,r=r.dispatch=LL.bind(null,ln,r),[o.memoizedState,r]}function Tc(r,o,m,v){return r={tag:r,create:o,destroy:m,deps:v,next:null},o=ln.updateQueue,o===null?(o={lastEffect:null,stores:null},ln.updateQueue=o,o.lastEffect=r.next=r):(m=o.lastEffect,m===null?o.lastEffect=r.next=r:(v=m.next,m.next=r,r.next=v,o.lastEffect=r)),r}function M0(){return ir().memoizedState}function Dd(r,o,m,v){var M=Dr();ln.flags|=r,M.memoizedState=Tc(1|o,m,void 0,v===void 0?null:v)}function Fd(r,o,m,v){var M=ir();v=v===void 0?null:v;var T=void 0;if(Rn!==null){var B=Rn.memoizedState;if(T=B.destroy,v!==null&&Yf(v,B.deps)){M.memoizedState=Tc(o,m,T,v);return}}ln.flags|=r,M.memoizedState=Tc(1|o,m,T,v)}function A0(r,o){return Dd(8390656,8,r,o)}function Zf(r,o){return Fd(2048,8,r,o)}function O0(r,o){return Fd(4,2,r,o)}function T0(r,o){return Fd(4,4,r,o)}function $0(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function P0(r,o,m){return m=m!=null?m.concat([r]):null,Fd(4,4,$0.bind(null,o,r),m)}function ep(){}function R0(r,o){var m=ir();o=o===void 0?null:o;var v=m.memoizedState;return v!==null&&o!==null&&Yf(o,v[1])?v[0]:(m.memoizedState=[r,o],r)}function L0(r,o){var m=ir();o=o===void 0?null:o;var v=m.memoizedState;return v!==null&&o!==null&&Yf(o,v[1])?v[0]:(r=r(),m.memoizedState=[r,o],r)}function z0(r,o,m){return si&21?(Gs(m,o)||(m=En(),ln.lanes|=m,ri|=m,r.baseState=!0),o):(r.baseState&&(r.baseState=!1,$s=!0),r.memoizedState=m)}function PL(r,o){var m=gt;gt=m!==0&&4>m?m:4,r(!0);var v=Kf.transition;Kf.transition={};try{r(!1),o()}finally{gt=m,Kf.transition=v}}function D0(){return ir().memoizedState}function RL(r,o,m){var v=to(r);if(m={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null},F0(r))I0(o,m);else if(m=g0(r,o,m,v),m!==null){var M=vs();Nr(m,r,v,M),B0(m,o,v)}}function LL(r,o,m){var v=to(r),M={lane:v,action:m,hasEagerState:!1,eagerState:null,next:null};if(F0(r))I0(o,M);else{var T=r.alternate;if(r.lanes===0&&(T===null||T.lanes===0)&&(T=o.lastRenderedReducer,T!==null))try{var B=o.lastRenderedState,ee=T(B,m);if(M.hasEagerState=!0,M.eagerState=ee,Gs(ee,B)){var ae=o.interleaved;ae===null?(M.next=M,Bf(o)):(M.next=ae.next,ae.next=M),o.interleaved=M;return}}catch{}finally{}m=g0(r,o,M,v),m!==null&&(M=vs(),Nr(m,r,v,M),B0(m,o,v))}}function F0(r){var o=r.alternate;return r===ln||o!==null&&o===ln}function I0(r,o){Mc=zd=!0;var m=r.pending;m===null?o.next=o:(o.next=m.next,m.next=o),r.pending=o}function B0(r,o,m){if(m&4194240){var v=o.lanes;v&=r.pendingLanes,m|=v,o.lanes=m,$a(r,m)}}var Id={readContext:or,useCallback:cs,useContext:cs,useEffect:cs,useImperativeHandle:cs,useInsertionEffect:cs,useLayoutEffect:cs,useMemo:cs,useReducer:cs,useRef:cs,useState:cs,useDebugValue:cs,useDeferredValue:cs,useTransition:cs,useMutableSource:cs,useSyncExternalStore:cs,useId:cs,unstable_isNewReconciler:!1},zL={readContext:or,useCallback:function(r,o){return Dr().memoizedState=[r,o===void 0?null:o],r},useContext:or,useEffect:A0,useImperativeHandle:function(r,o,m){return m=m!=null?m.concat([r]):null,Dd(4194308,4,$0.bind(null,o,r),m)},useLayoutEffect:function(r,o){return Dd(4194308,4,r,o)},useInsertionEffect:function(r,o){return Dd(4,2,r,o)},useMemo:function(r,o){var m=Dr();return o=o===void 0?null:o,r=r(),m.memoizedState=[r,o],r},useReducer:function(r,o,m){var v=Dr();return o=m!==void 0?m(o):o,v.memoizedState=v.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},v.queue=r,r=r.dispatch=RL.bind(null,ln,r),[v.memoizedState,r]},useRef:function(r){var o=Dr();return r={current:r},o.memoizedState=r},useState:k0,useDebugValue:ep,useDeferredValue:function(r){return Dr().memoizedState=r},useTransition:function(){var r=k0(!1),o=r[0];return r=PL.bind(null,r[1]),Dr().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,m){var v=ln,M=Dr();if(sn){if(m===void 0)throw Error(n(407));m=m()}else{if(m=o(),Hn===null)throw Error(n(349));si&30||N0(v,o,m)}M.memoizedState=m;var T={value:m,getSnapshot:o};return M.queue=T,A0(C0.bind(null,v,T,r),[r]),v.flags|=2048,Tc(9,j0.bind(null,v,T,m,o),void 0,null),m},useId:function(){var r=Dr(),o=Hn.identifierPrefix;if(sn){var m=ua,v=ca;m=(v&~(1<<32-we(v)-1)).toString(32)+m,o=":"+o+"R"+m,m=Ac++,0<m&&(o+="H"+m.toString(32)),o+=":"}else m=$L++,o=":"+o+"r"+m.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},DL={readContext:or,useCallback:R0,useContext:or,useEffect:Zf,useImperativeHandle:P0,useInsertionEffect:O0,useLayoutEffect:T0,useMemo:L0,useReducer:Xf,useRef:M0,useState:function(){return Xf(Oc)},useDebugValue:ep,useDeferredValue:function(r){var o=ir();return z0(o,Rn.memoizedState,r)},useTransition:function(){var r=Xf(Oc)[0],o=ir().memoizedState;return[r,o]},useMutableSource:x0,useSyncExternalStore:w0,useId:D0,unstable_isNewReconciler:!1},FL={readContext:or,useCallback:R0,useContext:or,useEffect:Zf,useImperativeHandle:P0,useInsertionEffect:O0,useLayoutEffect:T0,useMemo:L0,useReducer:Jf,useRef:M0,useState:function(){return Jf(Oc)},useDebugValue:ep,useDeferredValue:function(r){var o=ir();return Rn===null?o.memoizedState=r:z0(o,Rn.memoizedState,r)},useTransition:function(){var r=Jf(Oc)[0],o=ir().memoizedState;return[r,o]},useMutableSource:x0,useSyncExternalStore:w0,useId:D0,unstable_isNewReconciler:!1};function br(r,o){if(r&&r.defaultProps){o=I({},o),r=r.defaultProps;for(var m in r)o[m]===void 0&&(o[m]=r[m]);return o}return o}function tp(r,o,m,v){o=r.memoizedState,m=m(v,o),m=m==null?o:I({},o,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Bd={isMounted:function(r){return(r=r._reactInternals)?Ve(r)===r:!1},enqueueSetState:function(r,o,m){r=r._reactInternals;var v=vs(),M=to(r),T=ma(v,M);T.payload=o,m!=null&&(T.callback=m),o=Xa(r,T,M),o!==null&&(Nr(o,r,M,v),$d(o,r,M))},enqueueReplaceState:function(r,o,m){r=r._reactInternals;var v=vs(),M=to(r),T=ma(v,M);T.tag=1,T.payload=o,m!=null&&(T.callback=m),o=Xa(r,T,M),o!==null&&(Nr(o,r,M,v),$d(o,r,M))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var m=vs(),v=to(r),M=ma(m,v);M.tag=2,o!=null&&(M.callback=o),o=Xa(r,M,v),o!==null&&(Nr(o,r,v,m),$d(o,r,v))}};function U0(r,o,m,v,M,T,B){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(v,T,B):o.prototype&&o.prototype.isPureReactComponent?!Wo(m,v)||!Wo(M,T):!0}function q0(r,o,m){var v=!1,M=Ya,T=o.contextType;return typeof T=="object"&&T!==null?T=or(T):(M=Ts(o)?Jo:ls.current,v=o.contextTypes,T=(v=v!=null)?Zi(r,M):Ya),o=new o(m,T),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Bd,r.stateNode=o,o._reactInternals=r,v&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=M,r.__reactInternalMemoizedMaskedChildContext=T),o}function H0(r,o,m,v){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(m,v),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(m,v),o.state!==r&&Bd.enqueueReplaceState(o,o.state,null)}function np(r,o,m,v){var M=r.stateNode;M.props=m,M.state=r.memoizedState,M.refs={},Uf(r);var T=o.contextType;typeof T=="object"&&T!==null?M.context=or(T):(T=Ts(o)?Jo:ls.current,M.context=Zi(r,T)),M.state=r.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(tp(r,o,T,m),M.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(o=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),o!==M.state&&Bd.enqueueReplaceState(M,M.state,null),Pd(r,m,M,v),M.state=r.memoizedState),typeof M.componentDidMount=="function"&&(r.flags|=4194308)}function il(r,o){try{var m="",v=o;do m+=H(v),v=v.return;while(v);var M=m}catch(T){M=`
Error generating stack: `+T.message+`
`+T.stack}return{value:r,source:o,stack:M,digest:null}}function sp(r,o,m){return{value:r,source:null,stack:m??null,digest:o??null}}function rp(r,o){try{console.error(o.value)}catch(m){setTimeout(function(){throw m})}}var IL=typeof WeakMap=="function"?WeakMap:Map;function V0(r,o,m){m=ma(-1,m),m.tag=3,m.payload={element:null};var v=o.value;return m.callback=function(){Yd||(Yd=!0,yp=v),rp(r,o)},m}function W0(r,o,m){m=ma(-1,m),m.tag=3;var v=r.type.getDerivedStateFromError;if(typeof v=="function"){var M=o.value;m.payload=function(){return v(M)},m.callback=function(){rp(r,o)}}var T=r.stateNode;return T!==null&&typeof T.componentDidCatch=="function"&&(m.callback=function(){rp(r,o),typeof v!="function"&&(Za===null?Za=new Set([this]):Za.add(this));var B=o.stack;this.componentDidCatch(o.value,{componentStack:B!==null?B:""})}),m}function K0(r,o,m){var v=r.pingCache;if(v===null){v=r.pingCache=new IL;var M=new Set;v.set(o,M)}else M=v.get(o),M===void 0&&(M=new Set,v.set(o,M));M.has(m)||(M.add(m),r=ez.bind(null,r,o,m),o.then(r,r))}function Y0(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function G0(r,o,m,v,M){return r.mode&1?(r.flags|=65536,r.lanes=M,r):(r===o?r.flags|=65536:(r.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(o=ma(-1,1),o.tag=2,Xa(m,o,1))),m.lanes|=1),r)}var BL=j.ReactCurrentOwner,$s=!1;function _s(r,o,m,v){o.child=r===null?p0(o,null,m,v):sl(o,r.child,m,v)}function Q0(r,o,m,v,M){m=m.render;var T=o.ref;return al(o,M),v=Gf(r,o,m,v,T,M),m=Qf(),r!==null&&!$s?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~M,ha(r,o,M)):(sn&&m&&Tf(o),o.flags|=1,_s(r,o,v,M),o.child)}function X0(r,o,m,v,M){if(r===null){var T=m.type;return typeof T=="function"&&!Sp(T)&&T.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(o.tag=15,o.type=T,J0(r,o,T,v,M)):(r=em(m.type,null,v,o,o.mode,M),r.ref=o.ref,r.return=o,o.child=r)}if(T=r.child,!(r.lanes&M)){var B=T.memoizedProps;if(m=m.compare,m=m!==null?m:Wo,m(B,v)&&r.ref===o.ref)return ha(r,o,M)}return o.flags|=1,r=so(T,v),r.ref=o.ref,r.return=o,o.child=r}function J0(r,o,m,v,M){if(r!==null){var T=r.memoizedProps;if(Wo(T,v)&&r.ref===o.ref)if($s=!1,o.pendingProps=v=T,(r.lanes&M)!==0)r.flags&131072&&($s=!0);else return o.lanes=r.lanes,ha(r,o,M)}return ap(r,o,m,v,M)}function Z0(r,o,m){var v=o.pendingProps,M=v.children,T=r!==null?r.memoizedState:null;if(v.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xt(cl,Js),Js|=m;else{if(!(m&1073741824))return r=T!==null?T.baseLanes|m:m,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,Xt(cl,Js),Js|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=T!==null?T.baseLanes:m,Xt(cl,Js),Js|=v}else T!==null?(v=T.baseLanes|m,o.memoizedState=null):v=m,Xt(cl,Js),Js|=v;return _s(r,o,M,m),o.child}function ew(r,o){var m=o.ref;(r===null&&m!==null||r!==null&&r.ref!==m)&&(o.flags|=512,o.flags|=2097152)}function ap(r,o,m,v,M){var T=Ts(m)?Jo:ls.current;return T=Zi(o,T),al(o,M),m=Gf(r,o,m,v,T,M),v=Qf(),r!==null&&!$s?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~M,ha(r,o,M)):(sn&&v&&Tf(o),o.flags|=1,_s(r,o,m,M),o.child)}function tw(r,o,m,v,M){if(Ts(m)){var T=!0;Cd(o)}else T=!1;if(al(o,M),o.stateNode===null)qd(r,o),q0(o,m,v),np(o,m,v,M),v=!0;else if(r===null){var B=o.stateNode,ee=o.memoizedProps;B.props=ee;var ae=B.context,he=m.contextType;typeof he=="object"&&he!==null?he=or(he):(he=Ts(m)?Jo:ls.current,he=Zi(o,he));var xe=m.getDerivedStateFromProps,Ce=typeof xe=="function"||typeof B.getSnapshotBeforeUpdate=="function";Ce||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(ee!==v||ae!==he)&&H0(o,B,v,he),Qa=!1;var ye=o.memoizedState;B.state=ye,Pd(o,v,B,M),ae=o.memoizedState,ee!==v||ye!==ae||Os.current||Qa?(typeof xe=="function"&&(tp(o,m,xe,v),ae=o.memoizedState),(ee=Qa||U0(o,m,ee,v,ye,ae,he))?(Ce||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount()),typeof B.componentDidMount=="function"&&(o.flags|=4194308)):(typeof B.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=v,o.memoizedState=ae),B.props=v,B.state=ae,B.context=he,v=ee):(typeof B.componentDidMount=="function"&&(o.flags|=4194308),v=!1)}else{B=o.stateNode,_0(r,o),ee=o.memoizedProps,he=o.type===o.elementType?ee:br(o.type,ee),B.props=he,Ce=o.pendingProps,ye=B.context,ae=m.contextType,typeof ae=="object"&&ae!==null?ae=or(ae):(ae=Ts(m)?Jo:ls.current,ae=Zi(o,ae));var Le=m.getDerivedStateFromProps;(xe=typeof Le=="function"||typeof B.getSnapshotBeforeUpdate=="function")||typeof B.UNSAFE_componentWillReceiveProps!="function"&&typeof B.componentWillReceiveProps!="function"||(ee!==Ce||ye!==ae)&&H0(o,B,v,ae),Qa=!1,ye=o.memoizedState,B.state=ye,Pd(o,v,B,M);var Fe=o.memoizedState;ee!==Ce||ye!==Fe||Os.current||Qa?(typeof Le=="function"&&(tp(o,m,Le,v),Fe=o.memoizedState),(he=Qa||U0(o,m,he,v,ye,Fe,ae)||!1)?(xe||typeof B.UNSAFE_componentWillUpdate!="function"&&typeof B.componentWillUpdate!="function"||(typeof B.componentWillUpdate=="function"&&B.componentWillUpdate(v,Fe,ae),typeof B.UNSAFE_componentWillUpdate=="function"&&B.UNSAFE_componentWillUpdate(v,Fe,ae)),typeof B.componentDidUpdate=="function"&&(o.flags|=4),typeof B.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof B.componentDidUpdate!="function"||ee===r.memoizedProps&&ye===r.memoizedState||(o.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&ye===r.memoizedState||(o.flags|=1024),o.memoizedProps=v,o.memoizedState=Fe),B.props=v,B.state=Fe,B.context=ae,v=he):(typeof B.componentDidUpdate!="function"||ee===r.memoizedProps&&ye===r.memoizedState||(o.flags|=4),typeof B.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&ye===r.memoizedState||(o.flags|=1024),v=!1)}return op(r,o,m,v,T,M)}function op(r,o,m,v,M,T){ew(r,o);var B=(o.flags&128)!==0;if(!v&&!B)return M&&o0(o,m,!1),ha(r,o,T);v=o.stateNode,BL.current=o;var ee=B&&typeof m.getDerivedStateFromError!="function"?null:v.render();return o.flags|=1,r!==null&&B?(o.child=sl(o,r.child,null,T),o.child=sl(o,null,ee,T)):_s(r,o,ee,T),o.memoizedState=v.state,M&&o0(o,m,!0),o.child}function nw(r){var o=r.stateNode;o.pendingContext?r0(r,o.pendingContext,o.pendingContext!==o.context):o.context&&r0(r,o.context,!1),qf(r,o.containerInfo)}function sw(r,o,m,v,M){return nl(),Lf(M),o.flags|=256,_s(r,o,m,v),o.child}var ip={dehydrated:null,treeContext:null,retryLane:0};function lp(r){return{baseLanes:r,cachePool:null,transitions:null}}function rw(r,o,m){var v=o.pendingProps,M=on.current,T=!1,B=(o.flags&128)!==0,ee;if((ee=B)||(ee=r!==null&&r.memoizedState===null?!1:(M&2)!==0),ee?(T=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(M|=1),Xt(on,M&1),r===null)return Rf(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(o.mode&1?r.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(B=v.children,r=v.fallback,T?(v=o.mode,T=o.child,B={mode:"hidden",children:B},!(v&1)&&T!==null?(T.childLanes=0,T.pendingProps=B):T=tm(B,v,0,null),r=li(r,v,m,null),T.return=o,r.return=o,T.sibling=r,o.child=T,o.child.memoizedState=lp(m),o.memoizedState=ip,r):cp(o,B));if(M=r.memoizedState,M!==null&&(ee=M.dehydrated,ee!==null))return UL(r,o,B,v,ee,M,m);if(T){T=v.fallback,B=o.mode,M=r.child,ee=M.sibling;var ae={mode:"hidden",children:v.children};return!(B&1)&&o.child!==M?(v=o.child,v.childLanes=0,v.pendingProps=ae,o.deletions=null):(v=so(M,ae),v.subtreeFlags=M.subtreeFlags&14680064),ee!==null?T=so(ee,T):(T=li(T,B,m,null),T.flags|=2),T.return=o,v.return=o,v.sibling=T,o.child=v,v=T,T=o.child,B=r.child.memoizedState,B=B===null?lp(m):{baseLanes:B.baseLanes|m,cachePool:null,transitions:B.transitions},T.memoizedState=B,T.childLanes=r.childLanes&~m,o.memoizedState=ip,v}return T=r.child,r=T.sibling,v=so(T,{mode:"visible",children:v.children}),!(o.mode&1)&&(v.lanes=m),v.return=o,v.sibling=null,r!==null&&(m=o.deletions,m===null?(o.deletions=[r],o.flags|=16):m.push(r)),o.child=v,o.memoizedState=null,v}function cp(r,o){return o=tm({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function Ud(r,o,m,v){return v!==null&&Lf(v),sl(o,r.child,null,m),r=cp(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function UL(r,o,m,v,M,T,B){if(m)return o.flags&256?(o.flags&=-257,v=sp(Error(n(422))),Ud(r,o,B,v)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):(T=v.fallback,M=o.mode,v=tm({mode:"visible",children:v.children},M,0,null),T=li(T,M,B,null),T.flags|=2,v.return=o,T.return=o,v.sibling=T,o.child=v,o.mode&1&&sl(o,r.child,null,B),o.child.memoizedState=lp(B),o.memoizedState=ip,T);if(!(o.mode&1))return Ud(r,o,B,null);if(M.data==="$!"){if(v=M.nextSibling&&M.nextSibling.dataset,v)var ee=v.dgst;return v=ee,T=Error(n(419)),v=sp(T,v,void 0),Ud(r,o,B,v)}if(ee=(B&r.childLanes)!==0,$s||ee){if(v=Hn,v!==null){switch(B&-B){case 4:M=2;break;case 16:M=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:M=32;break;case 536870912:M=268435456;break;default:M=0}M=M&(v.suspendedLanes|B)?0:M,M!==0&&M!==T.retryLane&&(T.retryLane=M,da(r,M),Nr(v,r,M,-1))}return Cp(),v=sp(Error(n(421))),Ud(r,o,B,v)}return M.data==="$?"?(o.flags|=128,o.child=r.child,o=tz.bind(null,r),M._reactRetry=o,null):(r=T.treeContext,Xs=Wa(M.nextSibling),Qs=o,sn=!0,yr=null,r!==null&&(rr[ar++]=ca,rr[ar++]=ua,rr[ar++]=Zo,ca=r.id,ua=r.overflow,Zo=o),o=cp(o,v.children),o.flags|=4096,o)}function aw(r,o,m){r.lanes|=o;var v=r.alternate;v!==null&&(v.lanes|=o),If(r.return,o,m)}function up(r,o,m,v,M){var T=r.memoizedState;T===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:v,tail:m,tailMode:M}:(T.isBackwards=o,T.rendering=null,T.renderingStartTime=0,T.last=v,T.tail=m,T.tailMode=M)}function ow(r,o,m){var v=o.pendingProps,M=v.revealOrder,T=v.tail;if(_s(r,o,v.children,m),v=on.current,v&2)v=v&1|2,o.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&aw(r,m,o);else if(r.tag===19)aw(r,m,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}v&=1}if(Xt(on,v),!(o.mode&1))o.memoizedState=null;else switch(M){case"forwards":for(m=o.child,M=null;m!==null;)r=m.alternate,r!==null&&Rd(r)===null&&(M=m),m=m.sibling;m=M,m===null?(M=o.child,o.child=null):(M=m.sibling,m.sibling=null),up(o,!1,M,m,T);break;case"backwards":for(m=null,M=o.child,o.child=null;M!==null;){if(r=M.alternate,r!==null&&Rd(r)===null){o.child=M;break}r=M.sibling,M.sibling=m,m=M,M=r}up(o,!0,m,null,T);break;case"together":up(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function qd(r,o){!(o.mode&1)&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function ha(r,o,m){if(r!==null&&(o.dependencies=r.dependencies),ri|=o.lanes,!(m&o.childLanes))return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,m=so(r,r.pendingProps),o.child=m,m.return=o;r.sibling!==null;)r=r.sibling,m=m.sibling=so(r,r.pendingProps),m.return=o;m.sibling=null}return o.child}function qL(r,o,m){switch(o.tag){case 3:nw(o),nl();break;case 5:b0(o);break;case 1:Ts(o.type)&&Cd(o);break;case 4:qf(o,o.stateNode.containerInfo);break;case 10:var v=o.type._context,M=o.memoizedProps.value;Xt(Od,v._currentValue),v._currentValue=M;break;case 13:if(v=o.memoizedState,v!==null)return v.dehydrated!==null?(Xt(on,on.current&1),o.flags|=128,null):m&o.child.childLanes?rw(r,o,m):(Xt(on,on.current&1),r=ha(r,o,m),r!==null?r.sibling:null);Xt(on,on.current&1);break;case 19:if(v=(m&o.childLanes)!==0,r.flags&128){if(v)return ow(r,o,m);o.flags|=128}if(M=o.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),Xt(on,on.current),v)break;return null;case 22:case 23:return o.lanes=0,Z0(r,o,m)}return ha(r,o,m)}var iw,dp,lw,cw;iw=function(r,o){for(var m=o.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},dp=function(){},lw=function(r,o,m,v){var M=r.memoizedProps;if(M!==v){r=o.stateNode,ni(zr.current);var T=null;switch(m){case"input":M=Be(r,M),v=Be(r,v),T=[];break;case"select":M=I({},M,{value:void 0}),v=I({},v,{value:void 0}),T=[];break;case"textarea":M=ce(r,M),v=ce(r,v),T=[];break;default:typeof M.onClick!="function"&&typeof v.onClick=="function"&&(r.onclick=wd)}yt(m,v);var B;m=null;for(he in M)if(!v.hasOwnProperty(he)&&M.hasOwnProperty(he)&&M[he]!=null)if(he==="style"){var ee=M[he];for(B in ee)ee.hasOwnProperty(B)&&(m||(m={}),m[B]="")}else he!=="dangerouslySetInnerHTML"&&he!=="children"&&he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&he!=="autoFocus"&&(i.hasOwnProperty(he)?T||(T=[]):(T=T||[]).push(he,null));for(he in v){var ae=v[he];if(ee=M!=null?M[he]:void 0,v.hasOwnProperty(he)&&ae!==ee&&(ae!=null||ee!=null))if(he==="style")if(ee){for(B in ee)!ee.hasOwnProperty(B)||ae&&ae.hasOwnProperty(B)||(m||(m={}),m[B]="");for(B in ae)ae.hasOwnProperty(B)&&ee[B]!==ae[B]&&(m||(m={}),m[B]=ae[B])}else m||(T||(T=[]),T.push(he,m)),m=ae;else he==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ee=ee?ee.__html:void 0,ae!=null&&ee!==ae&&(T=T||[]).push(he,ae)):he==="children"?typeof ae!="string"&&typeof ae!="number"||(T=T||[]).push(he,""+ae):he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&(i.hasOwnProperty(he)?(ae!=null&&he==="onScroll"&&kt("scroll",r),T||ee===ae||(T=[])):(T=T||[]).push(he,ae))}m&&(T=T||[]).push("style",m);var he=T;(o.updateQueue=he)&&(o.flags|=4)}},cw=function(r,o,m,v){m!==v&&(o.flags|=4)};function $c(r,o){if(!sn)switch(r.tailMode){case"hidden":o=r.tail;for(var m=null;o!==null;)o.alternate!==null&&(m=o),o=o.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var v=null;m!==null;)m.alternate!==null&&(v=m),m=m.sibling;v===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:v.sibling=null}}function us(r){var o=r.alternate!==null&&r.alternate.child===r.child,m=0,v=0;if(o)for(var M=r.child;M!==null;)m|=M.lanes|M.childLanes,v|=M.subtreeFlags&14680064,v|=M.flags&14680064,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)m|=M.lanes|M.childLanes,v|=M.subtreeFlags,v|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=v,r.childLanes=m,o}function HL(r,o,m){var v=o.pendingProps;switch($f(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return us(o),null;case 1:return Ts(o.type)&&jd(),us(o),null;case 3:return v=o.stateNode,ol(),en(Os),en(ls),Wf(),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(r===null||r.child===null)&&(Md(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,yr!==null&&(wp(yr),yr=null))),dp(r,o),us(o),null;case 5:Hf(o);var M=ni(kc.current);if(m=o.type,r!==null&&o.stateNode!=null)lw(r,o,m,v,M),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!v){if(o.stateNode===null)throw Error(n(166));return us(o),null}if(r=ni(zr.current),Md(o)){v=o.stateNode,m=o.type;var T=o.memoizedProps;switch(v[Lr]=o,v[Nc]=T,r=(o.mode&1)!==0,m){case"dialog":kt("cancel",v),kt("close",v);break;case"iframe":case"object":case"embed":kt("load",v);break;case"video":case"audio":for(M=0;M<Yo.length;M++)kt(Yo[M],v);break;case"source":kt("error",v);break;case"img":case"image":case"link":kt("error",v),kt("load",v);break;case"details":kt("toggle",v);break;case"input":it(v,T),kt("invalid",v);break;case"select":v._wrapperState={wasMultiple:!!T.multiple},kt("invalid",v);break;case"textarea":Oe(v,T),kt("invalid",v)}yt(m,T),M=null;for(var B in T)if(T.hasOwnProperty(B)){var ee=T[B];B==="children"?typeof ee=="string"?v.textContent!==ee&&(T.suppressHydrationWarning!==!0&&Va(v.textContent,ee,r),M=["children",ee]):typeof ee=="number"&&v.textContent!==""+ee&&(T.suppressHydrationWarning!==!0&&Va(v.textContent,ee,r),M=["children",""+ee]):i.hasOwnProperty(B)&&ee!=null&&B==="onScroll"&&kt("scroll",v)}switch(m){case"input":Se(v),ge(v,T,!0);break;case"textarea":Se(v),ut(v);break;case"select":case"option":break;default:typeof T.onClick=="function"&&(v.onclick=wd)}v=M,o.updateQueue=v,v!==null&&(o.flags|=4)}else{B=M.nodeType===9?M:M.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=rt(m)),r==="http://www.w3.org/1999/xhtml"?m==="script"?(r=B.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof v.is=="string"?r=B.createElement(m,{is:v.is}):(r=B.createElement(m),m==="select"&&(B=r,v.multiple?B.multiple=!0:v.size&&(B.size=v.size))):r=B.createElementNS(r,m),r[Lr]=o,r[Nc]=v,iw(r,o,!1,!1),o.stateNode=r;e:{switch(B=jn(m,v),m){case"dialog":kt("cancel",r),kt("close",r),M=v;break;case"iframe":case"object":case"embed":kt("load",r),M=v;break;case"video":case"audio":for(M=0;M<Yo.length;M++)kt(Yo[M],r);M=v;break;case"source":kt("error",r),M=v;break;case"img":case"image":case"link":kt("error",r),kt("load",r),M=v;break;case"details":kt("toggle",r),M=v;break;case"input":it(r,v),M=Be(r,v),kt("invalid",r);break;case"option":M=v;break;case"select":r._wrapperState={wasMultiple:!!v.multiple},M=I({},v,{value:void 0}),kt("invalid",r);break;case"textarea":Oe(r,v),M=ce(r,v),kt("invalid",r);break;default:M=v}yt(m,M),ee=M;for(T in ee)if(ee.hasOwnProperty(T)){var ae=ee[T];T==="style"?Yt(r,ae):T==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&ct(r,ae)):T==="children"?typeof ae=="string"?(m!=="textarea"||ae!=="")&&$t(r,ae):typeof ae=="number"&&$t(r,""+ae):T!=="suppressContentEditableWarning"&&T!=="suppressHydrationWarning"&&T!=="autoFocus"&&(i.hasOwnProperty(T)?ae!=null&&T==="onScroll"&&kt("scroll",r):ae!=null&&S(r,T,ae,B))}switch(m){case"input":Se(r),ge(r,v,!1);break;case"textarea":Se(r),ut(r);break;case"option":v.value!=null&&r.setAttribute("value",""+ne(v.value));break;case"select":r.multiple=!!v.multiple,T=v.value,T!=null?Ue(r,!!v.multiple,T,!1):v.defaultValue!=null&&Ue(r,!!v.multiple,v.defaultValue,!0);break;default:typeof M.onClick=="function"&&(r.onclick=wd)}switch(m){case"button":case"input":case"select":case"textarea":v=!!v.autoFocus;break e;case"img":v=!0;break e;default:v=!1}}v&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return us(o),null;case 6:if(r&&o.stateNode!=null)cw(r,o,r.memoizedProps,v);else{if(typeof v!="string"&&o.stateNode===null)throw Error(n(166));if(m=ni(kc.current),ni(zr.current),Md(o)){if(v=o.stateNode,m=o.memoizedProps,v[Lr]=o,(T=v.nodeValue!==m)&&(r=Qs,r!==null))switch(r.tag){case 3:Va(v.nodeValue,m,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Va(v.nodeValue,m,(r.mode&1)!==0)}T&&(o.flags|=4)}else v=(m.nodeType===9?m:m.ownerDocument).createTextNode(v),v[Lr]=o,o.stateNode=v}return us(o),null;case 13:if(en(on),v=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(sn&&Xs!==null&&o.mode&1&&!(o.flags&128))m0(),nl(),o.flags|=98560,T=!1;else if(T=Md(o),v!==null&&v.dehydrated!==null){if(r===null){if(!T)throw Error(n(318));if(T=o.memoizedState,T=T!==null?T.dehydrated:null,!T)throw Error(n(317));T[Lr]=o}else nl(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;us(o),T=!1}else yr!==null&&(wp(yr),yr=null),T=!0;if(!T)return o.flags&65536?o:null}return o.flags&128?(o.lanes=m,o):(v=v!==null,v!==(r!==null&&r.memoizedState!==null)&&v&&(o.child.flags|=8192,o.mode&1&&(r===null||on.current&1?Ln===0&&(Ln=3):Cp())),o.updateQueue!==null&&(o.flags|=4),us(o),null);case 4:return ol(),dp(r,o),r===null&&Ua(o.stateNode.containerInfo),us(o),null;case 10:return Ff(o.type._context),us(o),null;case 17:return Ts(o.type)&&jd(),us(o),null;case 19:if(en(on),T=o.memoizedState,T===null)return us(o),null;if(v=(o.flags&128)!==0,B=T.rendering,B===null)if(v)$c(T,!1);else{if(Ln!==0||r!==null&&r.flags&128)for(r=o.child;r!==null;){if(B=Rd(r),B!==null){for(o.flags|=128,$c(T,!1),v=B.updateQueue,v!==null&&(o.updateQueue=v,o.flags|=4),o.subtreeFlags=0,v=m,m=o.child;m!==null;)T=m,r=v,T.flags&=14680066,B=T.alternate,B===null?(T.childLanes=0,T.lanes=r,T.child=null,T.subtreeFlags=0,T.memoizedProps=null,T.memoizedState=null,T.updateQueue=null,T.dependencies=null,T.stateNode=null):(T.childLanes=B.childLanes,T.lanes=B.lanes,T.child=B.child,T.subtreeFlags=0,T.deletions=null,T.memoizedProps=B.memoizedProps,T.memoizedState=B.memoizedState,T.updateQueue=B.updateQueue,T.type=B.type,r=B.dependencies,T.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),m=m.sibling;return Xt(on,on.current&1|2),o.child}r=r.sibling}T.tail!==null&&Xe()>ul&&(o.flags|=128,v=!0,$c(T,!1),o.lanes=4194304)}else{if(!v)if(r=Rd(B),r!==null){if(o.flags|=128,v=!0,m=r.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),$c(T,!0),T.tail===null&&T.tailMode==="hidden"&&!B.alternate&&!sn)return us(o),null}else 2*Xe()-T.renderingStartTime>ul&&m!==1073741824&&(o.flags|=128,v=!0,$c(T,!1),o.lanes=4194304);T.isBackwards?(B.sibling=o.child,o.child=B):(m=T.last,m!==null?m.sibling=B:o.child=B,T.last=B)}return T.tail!==null?(o=T.tail,T.rendering=o,T.tail=o.sibling,T.renderingStartTime=Xe(),o.sibling=null,m=on.current,Xt(on,v?m&1|2:m&1),o):(us(o),null);case 22:case 23:return jp(),v=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==v&&(o.flags|=8192),v&&o.mode&1?Js&1073741824&&(us(o),o.subtreeFlags&6&&(o.flags|=8192)):us(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function VL(r,o){switch($f(o),o.tag){case 1:return Ts(o.type)&&jd(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return ol(),en(Os),en(ls),Wf(),r=o.flags,r&65536&&!(r&128)?(o.flags=r&-65537|128,o):null;case 5:return Hf(o),null;case 13:if(en(on),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));nl()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return en(on),null;case 4:return ol(),null;case 10:return Ff(o.type._context),null;case 22:case 23:return jp(),null;case 24:return null;default:return null}}var Hd=!1,ds=!1,WL=typeof WeakSet=="function"?WeakSet:Set,De=null;function ll(r,o){var m=r.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(v){vn(r,o,v)}else m.current=null}function mp(r,o,m){try{m()}catch(v){vn(r,o,v)}}var uw=!1;function KL(r,o){if(jf=Ms,r=dd(),pc(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var v=m.getSelection&&m.getSelection();if(v&&v.rangeCount!==0){m=v.anchorNode;var M=v.anchorOffset,T=v.focusNode;v=v.focusOffset;try{m.nodeType,T.nodeType}catch{m=null;break e}var B=0,ee=-1,ae=-1,he=0,xe=0,Ce=r,ye=null;t:for(;;){for(var Le;Ce!==m||M!==0&&Ce.nodeType!==3||(ee=B+M),Ce!==T||v!==0&&Ce.nodeType!==3||(ae=B+v),Ce.nodeType===3&&(B+=Ce.nodeValue.length),(Le=Ce.firstChild)!==null;)ye=Ce,Ce=Le;for(;;){if(Ce===r)break t;if(ye===m&&++he===M&&(ee=B),ye===T&&++xe===v&&(ae=B),(Le=Ce.nextSibling)!==null)break;Ce=ye,ye=Ce.parentNode}Ce=Le}m=ee===-1||ae===-1?null:{start:ee,end:ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(Cf={focusedElem:r,selectionRange:m},Ms=!1,De=o;De!==null;)if(o=De,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,De=r;else for(;De!==null;){o=De;try{var Fe=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Fe!==null){var Ie=Fe.memoizedProps,bn=Fe.memoizedState,le=o.stateNode,oe=le.getSnapshotBeforeUpdate(o.elementType===o.type?Ie:br(o.type,Ie),bn);le.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var ue=o.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Ee){vn(o,o.return,Ee)}if(r=o.sibling,r!==null){r.return=o.return,De=r;break}De=o.return}return Fe=uw,uw=!1,Fe}function Pc(r,o,m){var v=o.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var M=v=v.next;do{if((M.tag&r)===r){var T=M.destroy;M.destroy=void 0,T!==void 0&&mp(o,m,T)}M=M.next}while(M!==v)}}function Vd(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var m=o=o.next;do{if((m.tag&r)===r){var v=m.create;m.destroy=v()}m=m.next}while(m!==o)}}function hp(r){var o=r.ref;if(o!==null){var m=r.stateNode;switch(r.tag){case 5:r=m;break;default:r=m}typeof o=="function"?o(r):o.current=r}}function dw(r){var o=r.alternate;o!==null&&(r.alternate=null,dw(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[Lr],delete o[Nc],delete o[Mf],delete o[ML],delete o[AL])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function mw(r){return r.tag===5||r.tag===3||r.tag===4}function hw(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||mw(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function fp(r,o,m){var v=r.tag;if(v===5||v===6)r=r.stateNode,o?m.nodeType===8?m.parentNode.insertBefore(r,o):m.insertBefore(r,o):(m.nodeType===8?(o=m.parentNode,o.insertBefore(r,m)):(o=m,o.appendChild(r)),m=m._reactRootContainer,m!=null||o.onclick!==null||(o.onclick=wd));else if(v!==4&&(r=r.child,r!==null))for(fp(r,o,m),r=r.sibling;r!==null;)fp(r,o,m),r=r.sibling}function pp(r,o,m){var v=r.tag;if(v===5||v===6)r=r.stateNode,o?m.insertBefore(r,o):m.appendChild(r);else if(v!==4&&(r=r.child,r!==null))for(pp(r,o,m),r=r.sibling;r!==null;)pp(r,o,m),r=r.sibling}var ts=null,xr=!1;function Ja(r,o,m){for(m=m.child;m!==null;)fw(r,o,m),m=m.sibling}function fw(r,o,m){if(Pe&&typeof Pe.onCommitFiberUnmount=="function")try{Pe.onCommitFiberUnmount(ve,m)}catch{}switch(m.tag){case 5:ds||ll(m,o);case 6:var v=ts,M=xr;ts=null,Ja(r,o,m),ts=v,xr=M,ts!==null&&(xr?(r=ts,m=m.stateNode,r.nodeType===8?r.parentNode.removeChild(m):r.removeChild(m)):ts.removeChild(m.stateNode));break;case 18:ts!==null&&(xr?(r=ts,m=m.stateNode,r.nodeType===8?kf(r.parentNode,m):r.nodeType===1&&kf(r,m),kn(r)):kf(ts,m.stateNode));break;case 4:v=ts,M=xr,ts=m.stateNode.containerInfo,xr=!0,Ja(r,o,m),ts=v,xr=M;break;case 0:case 11:case 14:case 15:if(!ds&&(v=m.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){M=v=v.next;do{var T=M,B=T.destroy;T=T.tag,B!==void 0&&(T&2||T&4)&&mp(m,o,B),M=M.next}while(M!==v)}Ja(r,o,m);break;case 1:if(!ds&&(ll(m,o),v=m.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=m.memoizedProps,v.state=m.memoizedState,v.componentWillUnmount()}catch(ee){vn(m,o,ee)}Ja(r,o,m);break;case 21:Ja(r,o,m);break;case 22:m.mode&1?(ds=(v=ds)||m.memoizedState!==null,Ja(r,o,m),ds=v):Ja(r,o,m);break;default:Ja(r,o,m)}}function pw(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var m=r.stateNode;m===null&&(m=r.stateNode=new WL),o.forEach(function(v){var M=nz.bind(null,r,v);m.has(v)||(m.add(v),v.then(M,M))})}}function wr(r,o){var m=o.deletions;if(m!==null)for(var v=0;v<m.length;v++){var M=m[v];try{var T=r,B=o,ee=B;e:for(;ee!==null;){switch(ee.tag){case 5:ts=ee.stateNode,xr=!1;break e;case 3:ts=ee.stateNode.containerInfo,xr=!0;break e;case 4:ts=ee.stateNode.containerInfo,xr=!0;break e}ee=ee.return}if(ts===null)throw Error(n(160));fw(T,B,M),ts=null,xr=!1;var ae=M.alternate;ae!==null&&(ae.return=null),M.return=null}catch(he){vn(M,o,he)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)gw(o,r),o=o.sibling}function gw(r,o){var m=r.alternate,v=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(wr(o,r),Fr(r),v&4){try{Pc(3,r,r.return),Vd(3,r)}catch(Ie){vn(r,r.return,Ie)}try{Pc(5,r,r.return)}catch(Ie){vn(r,r.return,Ie)}}break;case 1:wr(o,r),Fr(r),v&512&&m!==null&&ll(m,m.return);break;case 5:if(wr(o,r),Fr(r),v&512&&m!==null&&ll(m,m.return),r.flags&32){var M=r.stateNode;try{$t(M,"")}catch(Ie){vn(r,r.return,Ie)}}if(v&4&&(M=r.stateNode,M!=null)){var T=r.memoizedProps,B=m!==null?m.memoizedProps:T,ee=r.type,ae=r.updateQueue;if(r.updateQueue=null,ae!==null)try{ee==="input"&&T.type==="radio"&&T.name!=null&&He(M,T),jn(ee,B);var he=jn(ee,T);for(B=0;B<ae.length;B+=2){var xe=ae[B],Ce=ae[B+1];xe==="style"?Yt(M,Ce):xe==="dangerouslySetInnerHTML"?ct(M,Ce):xe==="children"?$t(M,Ce):S(M,xe,Ce,he)}switch(ee){case"input":de(M,T);break;case"textarea":Ge(M,T);break;case"select":var ye=M._wrapperState.wasMultiple;M._wrapperState.wasMultiple=!!T.multiple;var Le=T.value;Le!=null?Ue(M,!!T.multiple,Le,!1):ye!==!!T.multiple&&(T.defaultValue!=null?Ue(M,!!T.multiple,T.defaultValue,!0):Ue(M,!!T.multiple,T.multiple?[]:"",!1))}M[Nc]=T}catch(Ie){vn(r,r.return,Ie)}}break;case 6:if(wr(o,r),Fr(r),v&4){if(r.stateNode===null)throw Error(n(162));M=r.stateNode,T=r.memoizedProps;try{M.nodeValue=T}catch(Ie){vn(r,r.return,Ie)}}break;case 3:if(wr(o,r),Fr(r),v&4&&m!==null&&m.memoizedState.isDehydrated)try{kn(o.containerInfo)}catch(Ie){vn(r,r.return,Ie)}break;case 4:wr(o,r),Fr(r);break;case 13:wr(o,r),Fr(r),M=r.child,M.flags&8192&&(T=M.memoizedState!==null,M.stateNode.isHidden=T,!T||M.alternate!==null&&M.alternate.memoizedState!==null||(vp=Xe())),v&4&&pw(r);break;case 22:if(xe=m!==null&&m.memoizedState!==null,r.mode&1?(ds=(he=ds)||xe,wr(o,r),ds=he):wr(o,r),Fr(r),v&8192){if(he=r.memoizedState!==null,(r.stateNode.isHidden=he)&&!xe&&r.mode&1)for(De=r,xe=r.child;xe!==null;){for(Ce=De=xe;De!==null;){switch(ye=De,Le=ye.child,ye.tag){case 0:case 11:case 14:case 15:Pc(4,ye,ye.return);break;case 1:ll(ye,ye.return);var Fe=ye.stateNode;if(typeof Fe.componentWillUnmount=="function"){v=ye,m=ye.return;try{o=v,Fe.props=o.memoizedProps,Fe.state=o.memoizedState,Fe.componentWillUnmount()}catch(Ie){vn(v,m,Ie)}}break;case 5:ll(ye,ye.return);break;case 22:if(ye.memoizedState!==null){yw(Ce);continue}}Le!==null?(Le.return=ye,De=Le):yw(Ce)}xe=xe.sibling}e:for(xe=null,Ce=r;;){if(Ce.tag===5){if(xe===null){xe=Ce;try{M=Ce.stateNode,he?(T=M.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none"):(ee=Ce.stateNode,ae=Ce.memoizedProps.style,B=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,ee.style.display=Ut("display",B))}catch(Ie){vn(r,r.return,Ie)}}}else if(Ce.tag===6){if(xe===null)try{Ce.stateNode.nodeValue=he?"":Ce.memoizedProps}catch(Ie){vn(r,r.return,Ie)}}else if((Ce.tag!==22&&Ce.tag!==23||Ce.memoizedState===null||Ce===r)&&Ce.child!==null){Ce.child.return=Ce,Ce=Ce.child;continue}if(Ce===r)break e;for(;Ce.sibling===null;){if(Ce.return===null||Ce.return===r)break e;xe===Ce&&(xe=null),Ce=Ce.return}xe===Ce&&(xe=null),Ce.sibling.return=Ce.return,Ce=Ce.sibling}}break;case 19:wr(o,r),Fr(r),v&4&&pw(r);break;case 21:break;default:wr(o,r),Fr(r)}}function Fr(r){var o=r.flags;if(o&2){try{e:{for(var m=r.return;m!==null;){if(mw(m)){var v=m;break e}m=m.return}throw Error(n(160))}switch(v.tag){case 5:var M=v.stateNode;v.flags&32&&($t(M,""),v.flags&=-33);var T=hw(r);pp(r,T,M);break;case 3:case 4:var B=v.stateNode.containerInfo,ee=hw(r);fp(r,ee,B);break;default:throw Error(n(161))}}catch(ae){vn(r,r.return,ae)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function YL(r,o,m){De=r,_w(r)}function _w(r,o,m){for(var v=(r.mode&1)!==0;De!==null;){var M=De,T=M.child;if(M.tag===22&&v){var B=M.memoizedState!==null||Hd;if(!B){var ee=M.alternate,ae=ee!==null&&ee.memoizedState!==null||ds;ee=Hd;var he=ds;if(Hd=B,(ds=ae)&&!he)for(De=M;De!==null;)B=De,ae=B.child,B.tag===22&&B.memoizedState!==null?bw(M):ae!==null?(ae.return=B,De=ae):bw(M);for(;T!==null;)De=T,_w(T),T=T.sibling;De=M,Hd=ee,ds=he}vw(r)}else M.subtreeFlags&8772&&T!==null?(T.return=M,De=T):vw(r)}}function vw(r){for(;De!==null;){var o=De;if(o.flags&8772){var m=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:ds||Vd(5,o);break;case 1:var v=o.stateNode;if(o.flags&4&&!ds)if(m===null)v.componentDidMount();else{var M=o.elementType===o.type?m.memoizedProps:br(o.type,m.memoizedProps);v.componentDidUpdate(M,m.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var T=o.updateQueue;T!==null&&y0(o,T,v);break;case 3:var B=o.updateQueue;if(B!==null){if(m=null,o.child!==null)switch(o.child.tag){case 5:m=o.child.stateNode;break;case 1:m=o.child.stateNode}y0(o,B,m)}break;case 5:var ee=o.stateNode;if(m===null&&o.flags&4){m=ee;var ae=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&m.focus();break;case"img":ae.src&&(m.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var he=o.alternate;if(he!==null){var xe=he.memoizedState;if(xe!==null){var Ce=xe.dehydrated;Ce!==null&&kn(Ce)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ds||o.flags&512&&hp(o)}catch(ye){vn(o,o.return,ye)}}if(o===r){De=null;break}if(m=o.sibling,m!==null){m.return=o.return,De=m;break}De=o.return}}function yw(r){for(;De!==null;){var o=De;if(o===r){De=null;break}var m=o.sibling;if(m!==null){m.return=o.return,De=m;break}De=o.return}}function bw(r){for(;De!==null;){var o=De;try{switch(o.tag){case 0:case 11:case 15:var m=o.return;try{Vd(4,o)}catch(ae){vn(o,m,ae)}break;case 1:var v=o.stateNode;if(typeof v.componentDidMount=="function"){var M=o.return;try{v.componentDidMount()}catch(ae){vn(o,M,ae)}}var T=o.return;try{hp(o)}catch(ae){vn(o,T,ae)}break;case 5:var B=o.return;try{hp(o)}catch(ae){vn(o,B,ae)}}}catch(ae){vn(o,o.return,ae)}if(o===r){De=null;break}var ee=o.sibling;if(ee!==null){ee.return=o.return,De=ee;break}De=o.return}}var GL=Math.ceil,Wd=j.ReactCurrentDispatcher,gp=j.ReactCurrentOwner,lr=j.ReactCurrentBatchConfig,Pt=0,Hn=null,On=null,ns=0,Js=0,cl=Ka(0),Ln=0,Rc=null,ri=0,Kd=0,_p=0,Lc=null,Ps=null,vp=0,ul=1/0,fa=null,Yd=!1,yp=null,Za=null,Gd=!1,eo=null,Qd=0,zc=0,bp=null,Xd=-1,Jd=0;function vs(){return Pt&6?Xe():Xd!==-1?Xd:Xd=Xe()}function to(r){return r.mode&1?Pt&2&&ns!==0?ns&-ns:TL.transition!==null?(Jd===0&&(Jd=En()),Jd):(r=gt,r!==0||(r=window.event,r=r===void 0?16:Pa(r.type)),r):1}function Nr(r,o,m,v){if(50<zc)throw zc=0,bp=null,Error(n(185));$n(r,m,v),(!(Pt&2)||r!==Hn)&&(r===Hn&&(!(Pt&2)&&(Kd|=m),Ln===4&&no(r,ns)),Rs(r,v),m===1&&Pt===0&&!(o.mode&1)&&(ul=Xe()+500,Sd&&Ga()))}function Rs(r,o){var m=r.callbackNode;Xn(r,o);var v=pn(r,r===Hn?ns:0);if(v===0)m!==null&&In(m),r.callbackNode=null,r.callbackPriority=0;else if(o=v&-v,r.callbackPriority!==o){if(m!=null&&In(m),o===1)r.tag===0?OL(ww.bind(null,r)):i0(ww.bind(null,r)),EL(function(){!(Pt&6)&&Ga()}),m=null;else{switch(zo(v)){case 1:m=Bn;break;case 4:m=qs;break;case 16:m=is;break;case 536870912:m=ie;break;default:m=is}m=Aw(m,xw.bind(null,r))}r.callbackPriority=o,r.callbackNode=m}}function xw(r,o){if(Xd=-1,Jd=0,Pt&6)throw Error(n(327));var m=r.callbackNode;if(dl()&&r.callbackNode!==m)return null;var v=pn(r,r===Hn?ns:0);if(v===0)return null;if(v&30||v&r.expiredLanes||o)o=Zd(r,v);else{o=v;var M=Pt;Pt|=2;var T=jw();(Hn!==r||ns!==o)&&(fa=null,ul=Xe()+500,oi(r,o));do try{JL();break}catch(ee){Nw(r,ee)}while(!0);Df(),Wd.current=T,Pt=M,On!==null?o=0:(Hn=null,ns=0,o=Ln)}if(o!==0){if(o===2&&(M=yn(r),M!==0&&(v=M,o=xp(r,M))),o===1)throw m=Rc,oi(r,0),no(r,v),Rs(r,Xe()),m;if(o===6)no(r,v);else{if(M=r.current.alternate,!(v&30)&&!QL(M)&&(o=Zd(r,v),o===2&&(T=yn(r),T!==0&&(v=T,o=xp(r,T))),o===1))throw m=Rc,oi(r,0),no(r,v),Rs(r,Xe()),m;switch(r.finishedWork=M,r.finishedLanes=v,o){case 0:case 1:throw Error(n(345));case 2:ii(r,Ps,fa);break;case 3:if(no(r,v),(v&130023424)===v&&(o=vp+500-Xe(),10<o)){if(pn(r,0)!==0)break;if(M=r.suspendedLanes,(M&v)!==v){vs(),r.pingedLanes|=r.suspendedLanes&M;break}r.timeoutHandle=Ef(ii.bind(null,r,Ps,fa),o);break}ii(r,Ps,fa);break;case 4:if(no(r,v),(v&4194240)===v)break;for(o=r.eventTimes,M=-1;0<v;){var B=31-we(v);T=1<<B,B=o[B],B>M&&(M=B),v&=~T}if(v=M,v=Xe()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*GL(v/1960))-v,10<v){r.timeoutHandle=Ef(ii.bind(null,r,Ps,fa),v);break}ii(r,Ps,fa);break;case 5:ii(r,Ps,fa);break;default:throw Error(n(329))}}}return Rs(r,Xe()),r.callbackNode===m?xw.bind(null,r):null}function xp(r,o){var m=Lc;return r.current.memoizedState.isDehydrated&&(oi(r,o).flags|=256),r=Zd(r,o),r!==2&&(o=Ps,Ps=m,o!==null&&wp(o)),r}function wp(r){Ps===null?Ps=r:Ps.push.apply(Ps,r)}function QL(r){for(var o=r;;){if(o.flags&16384){var m=o.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var v=0;v<m.length;v++){var M=m[v],T=M.getSnapshot;M=M.value;try{if(!Gs(T(),M))return!1}catch{return!1}}}if(m=o.child,o.subtreeFlags&16384&&m!==null)m.return=o,o=m;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function no(r,o){for(o&=~_p,o&=~Kd,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var m=31-we(o),v=1<<m;r[m]=-1,o&=~v}}function ww(r){if(Pt&6)throw Error(n(327));dl();var o=pn(r,0);if(!(o&1))return Rs(r,Xe()),null;var m=Zd(r,o);if(r.tag!==0&&m===2){var v=yn(r);v!==0&&(o=v,m=xp(r,v))}if(m===1)throw m=Rc,oi(r,0),no(r,o),Rs(r,Xe()),m;if(m===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,ii(r,Ps,fa),Rs(r,Xe()),null}function Np(r,o){var m=Pt;Pt|=1;try{return r(o)}finally{Pt=m,Pt===0&&(ul=Xe()+500,Sd&&Ga())}}function ai(r){eo!==null&&eo.tag===0&&!(Pt&6)&&dl();var o=Pt;Pt|=1;var m=lr.transition,v=gt;try{if(lr.transition=null,gt=1,r)return r()}finally{gt=v,lr.transition=m,Pt=o,!(Pt&6)&&Ga()}}function jp(){Js=cl.current,en(cl)}function oi(r,o){r.finishedWork=null,r.finishedLanes=0;var m=r.timeoutHandle;if(m!==-1&&(r.timeoutHandle=-1,SL(m)),On!==null)for(m=On.return;m!==null;){var v=m;switch($f(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&jd();break;case 3:ol(),en(Os),en(ls),Wf();break;case 5:Hf(v);break;case 4:ol();break;case 13:en(on);break;case 19:en(on);break;case 10:Ff(v.type._context);break;case 22:case 23:jp()}m=m.return}if(Hn=r,On=r=so(r.current,null),ns=Js=o,Ln=0,Rc=null,_p=Kd=ri=0,Ps=Lc=null,ti!==null){for(o=0;o<ti.length;o++)if(m=ti[o],v=m.interleaved,v!==null){m.interleaved=null;var M=v.next,T=m.pending;if(T!==null){var B=T.next;T.next=M,v.next=B}m.pending=v}ti=null}return r}function Nw(r,o){do{var m=On;try{if(Df(),Ld.current=Id,zd){for(var v=ln.memoizedState;v!==null;){var M=v.queue;M!==null&&(M.pending=null),v=v.next}zd=!1}if(si=0,qn=Rn=ln=null,Mc=!1,Ac=0,gp.current=null,m===null||m.return===null){Ln=1,Rc=o,On=null;break}e:{var T=r,B=m.return,ee=m,ae=o;if(o=ns,ee.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var he=ae,xe=ee,Ce=xe.tag;if(!(xe.mode&1)&&(Ce===0||Ce===11||Ce===15)){var ye=xe.alternate;ye?(xe.updateQueue=ye.updateQueue,xe.memoizedState=ye.memoizedState,xe.lanes=ye.lanes):(xe.updateQueue=null,xe.memoizedState=null)}var Le=Y0(B);if(Le!==null){Le.flags&=-257,G0(Le,B,ee,T,o),Le.mode&1&&K0(T,he,o),o=Le,ae=he;var Fe=o.updateQueue;if(Fe===null){var Ie=new Set;Ie.add(ae),o.updateQueue=Ie}else Fe.add(ae);break e}else{if(!(o&1)){K0(T,he,o),Cp();break e}ae=Error(n(426))}}else if(sn&&ee.mode&1){var bn=Y0(B);if(bn!==null){!(bn.flags&65536)&&(bn.flags|=256),G0(bn,B,ee,T,o),Lf(il(ae,ee));break e}}T=ae=il(ae,ee),Ln!==4&&(Ln=2),Lc===null?Lc=[T]:Lc.push(T),T=B;do{switch(T.tag){case 3:T.flags|=65536,o&=-o,T.lanes|=o;var le=V0(T,ae,o);v0(T,le);break e;case 1:ee=ae;var oe=T.type,ue=T.stateNode;if(!(T.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(Za===null||!Za.has(ue)))){T.flags|=65536,o&=-o,T.lanes|=o;var Ee=W0(T,ee,o);v0(T,Ee);break e}}T=T.return}while(T!==null)}Sw(m)}catch(qe){o=qe,On===m&&m!==null&&(On=m=m.return);continue}break}while(!0)}function jw(){var r=Wd.current;return Wd.current=Id,r===null?Id:r}function Cp(){(Ln===0||Ln===3||Ln===2)&&(Ln=4),Hn===null||!(ri&268435455)&&!(Kd&268435455)||no(Hn,ns)}function Zd(r,o){var m=Pt;Pt|=2;var v=jw();(Hn!==r||ns!==o)&&(fa=null,oi(r,o));do try{XL();break}catch(M){Nw(r,M)}while(!0);if(Df(),Pt=m,Wd.current=v,On!==null)throw Error(n(261));return Hn=null,ns=0,Ln}function XL(){for(;On!==null;)Cw(On)}function JL(){for(;On!==null&&!nr();)Cw(On)}function Cw(r){var o=Mw(r.alternate,r,Js);r.memoizedProps=r.pendingProps,o===null?Sw(r):On=o,gp.current=null}function Sw(r){var o=r;do{var m=o.alternate;if(r=o.return,o.flags&32768){if(m=VL(m,o),m!==null){m.flags&=32767,On=m;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Ln=6,On=null;return}}else if(m=HL(m,o,Js),m!==null){On=m;return}if(o=o.sibling,o!==null){On=o;return}On=o=r}while(o!==null);Ln===0&&(Ln=5)}function ii(r,o,m){var v=gt,M=lr.transition;try{lr.transition=null,gt=1,ZL(r,o,m,v)}finally{lr.transition=M,gt=v}return null}function ZL(r,o,m,v){do dl();while(eo!==null);if(Pt&6)throw Error(n(327));m=r.finishedWork;var M=r.finishedLanes;if(m===null)return null;if(r.finishedWork=null,r.finishedLanes=0,m===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var T=m.lanes|m.childLanes;if(Jr(r,T),r===Hn&&(On=Hn=null,ns=0),!(m.subtreeFlags&2064)&&!(m.flags&2064)||Gd||(Gd=!0,Aw(is,function(){return dl(),null})),T=(m.flags&15990)!==0,m.subtreeFlags&15990||T){T=lr.transition,lr.transition=null;var B=gt;gt=1;var ee=Pt;Pt|=4,gp.current=null,KL(r,m),gw(m,r),yf(Cf),Ms=!!jf,Cf=jf=null,r.current=m,YL(m),Qt(),Pt=ee,gt=B,lr.transition=T}else r.current=m;if(Gd&&(Gd=!1,eo=r,Qd=M),T=r.pendingLanes,T===0&&(Za=null),jt(m.stateNode),Rs(r,Xe()),o!==null)for(v=r.onRecoverableError,m=0;m<o.length;m++)M=o[m],v(M.value,{componentStack:M.stack,digest:M.digest});if(Yd)throw Yd=!1,r=yp,yp=null,r;return Qd&1&&r.tag!==0&&dl(),T=r.pendingLanes,T&1?r===bp?zc++:(zc=0,bp=r):zc=0,Ga(),null}function dl(){if(eo!==null){var r=zo(Qd),o=lr.transition,m=gt;try{if(lr.transition=null,gt=16>r?16:r,eo===null)var v=!1;else{if(r=eo,eo=null,Qd=0,Pt&6)throw Error(n(331));var M=Pt;for(Pt|=4,De=r.current;De!==null;){var T=De,B=T.child;if(De.flags&16){var ee=T.deletions;if(ee!==null){for(var ae=0;ae<ee.length;ae++){var he=ee[ae];for(De=he;De!==null;){var xe=De;switch(xe.tag){case 0:case 11:case 15:Pc(8,xe,T)}var Ce=xe.child;if(Ce!==null)Ce.return=xe,De=Ce;else for(;De!==null;){xe=De;var ye=xe.sibling,Le=xe.return;if(dw(xe),xe===he){De=null;break}if(ye!==null){ye.return=Le,De=ye;break}De=Le}}}var Fe=T.alternate;if(Fe!==null){var Ie=Fe.child;if(Ie!==null){Fe.child=null;do{var bn=Ie.sibling;Ie.sibling=null,Ie=bn}while(Ie!==null)}}De=T}}if(T.subtreeFlags&2064&&B!==null)B.return=T,De=B;else e:for(;De!==null;){if(T=De,T.flags&2048)switch(T.tag){case 0:case 11:case 15:Pc(9,T,T.return)}var le=T.sibling;if(le!==null){le.return=T.return,De=le;break e}De=T.return}}var oe=r.current;for(De=oe;De!==null;){B=De;var ue=B.child;if(B.subtreeFlags&2064&&ue!==null)ue.return=B,De=ue;else e:for(B=oe;De!==null;){if(ee=De,ee.flags&2048)try{switch(ee.tag){case 0:case 11:case 15:Vd(9,ee)}}catch(qe){vn(ee,ee.return,qe)}if(ee===B){De=null;break e}var Ee=ee.sibling;if(Ee!==null){Ee.return=ee.return,De=Ee;break e}De=ee.return}}if(Pt=M,Ga(),Pe&&typeof Pe.onPostCommitFiberRoot=="function")try{Pe.onPostCommitFiberRoot(ve,r)}catch{}v=!0}return v}finally{gt=m,lr.transition=o}}return!1}function Ew(r,o,m){o=il(m,o),o=V0(r,o,1),r=Xa(r,o,1),o=vs(),r!==null&&($n(r,1,o),Rs(r,o))}function vn(r,o,m){if(r.tag===3)Ew(r,r,m);else for(;o!==null;){if(o.tag===3){Ew(o,r,m);break}else if(o.tag===1){var v=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(Za===null||!Za.has(v))){r=il(m,r),r=W0(o,r,1),o=Xa(o,r,1),r=vs(),o!==null&&($n(o,1,r),Rs(o,r));break}}o=o.return}}function ez(r,o,m){var v=r.pingCache;v!==null&&v.delete(o),o=vs(),r.pingedLanes|=r.suspendedLanes&m,Hn===r&&(ns&m)===m&&(Ln===4||Ln===3&&(ns&130023424)===ns&&500>Xe()-vp?oi(r,0):_p|=m),Rs(r,o)}function kw(r,o){o===0&&(r.mode&1?(o=nn,nn<<=1,!(nn&130023424)&&(nn=4194304)):o=1);var m=vs();r=da(r,o),r!==null&&($n(r,o,m),Rs(r,m))}function tz(r){var o=r.memoizedState,m=0;o!==null&&(m=o.retryLane),kw(r,m)}function nz(r,o){var m=0;switch(r.tag){case 13:var v=r.stateNode,M=r.memoizedState;M!==null&&(m=M.retryLane);break;case 19:v=r.stateNode;break;default:throw Error(n(314))}v!==null&&v.delete(o),kw(r,m)}var Mw;Mw=function(r,o,m){if(r!==null)if(r.memoizedProps!==o.pendingProps||Os.current)$s=!0;else{if(!(r.lanes&m)&&!(o.flags&128))return $s=!1,qL(r,o,m);$s=!!(r.flags&131072)}else $s=!1,sn&&o.flags&1048576&&l0(o,kd,o.index);switch(o.lanes=0,o.tag){case 2:var v=o.type;qd(r,o),r=o.pendingProps;var M=Zi(o,ls.current);al(o,m),M=Gf(null,o,v,r,M,m);var T=Qf();return o.flags|=1,typeof M=="object"&&M!==null&&typeof M.render=="function"&&M.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Ts(v)?(T=!0,Cd(o)):T=!1,o.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,Uf(o),M.updater=Bd,o.stateNode=M,M._reactInternals=o,np(o,v,r,m),o=op(null,o,v,!0,T,m)):(o.tag=0,sn&&T&&Tf(o),_s(null,o,M,m),o=o.child),o;case 16:v=o.elementType;e:{switch(qd(r,o),r=o.pendingProps,M=v._init,v=M(v._payload),o.type=v,M=o.tag=rz(v),r=br(v,r),M){case 0:o=ap(null,o,v,r,m);break e;case 1:o=tw(null,o,v,r,m);break e;case 11:o=Q0(null,o,v,r,m);break e;case 14:o=X0(null,o,v,br(v.type,r),m);break e}throw Error(n(306,v,""))}return o;case 0:return v=o.type,M=o.pendingProps,M=o.elementType===v?M:br(v,M),ap(r,o,v,M,m);case 1:return v=o.type,M=o.pendingProps,M=o.elementType===v?M:br(v,M),tw(r,o,v,M,m);case 3:e:{if(nw(o),r===null)throw Error(n(387));v=o.pendingProps,T=o.memoizedState,M=T.element,_0(r,o),Pd(o,v,null,m);var B=o.memoizedState;if(v=B.element,T.isDehydrated)if(T={element:v,isDehydrated:!1,cache:B.cache,pendingSuspenseBoundaries:B.pendingSuspenseBoundaries,transitions:B.transitions},o.updateQueue.baseState=T,o.memoizedState=T,o.flags&256){M=il(Error(n(423)),o),o=sw(r,o,v,m,M);break e}else if(v!==M){M=il(Error(n(424)),o),o=sw(r,o,v,m,M);break e}else for(Xs=Wa(o.stateNode.containerInfo.firstChild),Qs=o,sn=!0,yr=null,m=p0(o,null,v,m),o.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(nl(),v===M){o=ha(r,o,m);break e}_s(r,o,v,m)}o=o.child}return o;case 5:return b0(o),r===null&&Rf(o),v=o.type,M=o.pendingProps,T=r!==null?r.memoizedProps:null,B=M.children,Sf(v,M)?B=null:T!==null&&Sf(v,T)&&(o.flags|=32),ew(r,o),_s(r,o,B,m),o.child;case 6:return r===null&&Rf(o),null;case 13:return rw(r,o,m);case 4:return qf(o,o.stateNode.containerInfo),v=o.pendingProps,r===null?o.child=sl(o,null,v,m):_s(r,o,v,m),o.child;case 11:return v=o.type,M=o.pendingProps,M=o.elementType===v?M:br(v,M),Q0(r,o,v,M,m);case 7:return _s(r,o,o.pendingProps,m),o.child;case 8:return _s(r,o,o.pendingProps.children,m),o.child;case 12:return _s(r,o,o.pendingProps.children,m),o.child;case 10:e:{if(v=o.type._context,M=o.pendingProps,T=o.memoizedProps,B=M.value,Xt(Od,v._currentValue),v._currentValue=B,T!==null)if(Gs(T.value,B)){if(T.children===M.children&&!Os.current){o=ha(r,o,m);break e}}else for(T=o.child,T!==null&&(T.return=o);T!==null;){var ee=T.dependencies;if(ee!==null){B=T.child;for(var ae=ee.firstContext;ae!==null;){if(ae.context===v){if(T.tag===1){ae=ma(-1,m&-m),ae.tag=2;var he=T.updateQueue;if(he!==null){he=he.shared;var xe=he.pending;xe===null?ae.next=ae:(ae.next=xe.next,xe.next=ae),he.pending=ae}}T.lanes|=m,ae=T.alternate,ae!==null&&(ae.lanes|=m),If(T.return,m,o),ee.lanes|=m;break}ae=ae.next}}else if(T.tag===10)B=T.type===o.type?null:T.child;else if(T.tag===18){if(B=T.return,B===null)throw Error(n(341));B.lanes|=m,ee=B.alternate,ee!==null&&(ee.lanes|=m),If(B,m,o),B=T.sibling}else B=T.child;if(B!==null)B.return=T;else for(B=T;B!==null;){if(B===o){B=null;break}if(T=B.sibling,T!==null){T.return=B.return,B=T;break}B=B.return}T=B}_s(r,o,M.children,m),o=o.child}return o;case 9:return M=o.type,v=o.pendingProps.children,al(o,m),M=or(M),v=v(M),o.flags|=1,_s(r,o,v,m),o.child;case 14:return v=o.type,M=br(v,o.pendingProps),M=br(v.type,M),X0(r,o,v,M,m);case 15:return J0(r,o,o.type,o.pendingProps,m);case 17:return v=o.type,M=o.pendingProps,M=o.elementType===v?M:br(v,M),qd(r,o),o.tag=1,Ts(v)?(r=!0,Cd(o)):r=!1,al(o,m),q0(o,v,M),np(o,v,M,m),op(null,o,v,!0,r,m);case 19:return ow(r,o,m);case 22:return Z0(r,o,m)}throw Error(n(156,o.tag))};function Aw(r,o){return Ss(r,o)}function sz(r,o,m,v){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cr(r,o,m,v){return new sz(r,o,m,v)}function Sp(r){return r=r.prototype,!(!r||!r.isReactComponent)}function rz(r){if(typeof r=="function")return Sp(r)?1:0;if(r!=null){if(r=r.$$typeof,r===D)return 11;if(r===F)return 14}return 2}function so(r,o){var m=r.alternate;return m===null?(m=cr(r.tag,o,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=o,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&14680064,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,o=r.dependencies,m.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m}function em(r,o,m,v,M,T){var B=2;if(v=r,typeof r=="function")Sp(r)&&(B=1);else if(typeof r=="string")B=5;else e:switch(r){case O:return li(m.children,M,T,o);case R:B=8,M|=8;break;case P:return r=cr(12,m,o,M|2),r.elementType=P,r.lanes=T,r;case V:return r=cr(13,m,o,M),r.elementType=V,r.lanes=T,r;case z:return r=cr(19,m,o,M),r.elementType=z,r.lanes=T,r;case G:return tm(m,M,T,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case $:B=10;break e;case A:B=9;break e;case D:B=11;break e;case F:B=14;break e;case q:B=16,v=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return o=cr(B,m,o,M),o.elementType=r,o.type=v,o.lanes=T,o}function li(r,o,m,v){return r=cr(7,r,v,o),r.lanes=m,r}function tm(r,o,m,v){return r=cr(22,r,v,o),r.elementType=G,r.lanes=m,r.stateNode={isHidden:!1},r}function Ep(r,o,m){return r=cr(6,r,null,o),r.lanes=m,r}function kp(r,o,m){return o=cr(4,r.children!==null?r.children:[],r.key,o),o.lanes=m,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function az(r,o,m,v,M){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jn(0),this.expirationTimes=Jn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jn(0),this.identifierPrefix=v,this.onRecoverableError=M,this.mutableSourceEagerHydrationData=null}function Mp(r,o,m,v,M,T,B,ee,ae){return r=new az(r,o,m,ee,ae),o===1?(o=1,T===!0&&(o|=8)):o=0,T=cr(3,null,null,o),r.current=T,T.stateNode=r,T.memoizedState={element:v,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Uf(T),r}function oz(r,o,m){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:v==null?null:""+v,children:r,containerInfo:o,implementation:m}}function Ow(r){if(!r)return Ya;r=r._reactInternals;e:{if(Ve(r)!==r||r.tag!==1)throw Error(n(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Ts(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(r.tag===1){var m=r.type;if(Ts(m))return a0(r,m,o)}return o}function Tw(r,o,m,v,M,T,B,ee,ae){return r=Mp(m,v,!0,r,M,T,B,ee,ae),r.context=Ow(null),m=r.current,v=vs(),M=to(m),T=ma(v,M),T.callback=o??null,Xa(m,T,M),r.current.lanes=M,$n(r,M,v),Rs(r,v),r}function nm(r,o,m,v){var M=o.current,T=vs(),B=to(M);return m=Ow(m),o.context===null?o.context=m:o.pendingContext=m,o=ma(T,B),o.payload={element:r},v=v===void 0?null:v,v!==null&&(o.callback=v),r=Xa(M,o,B),r!==null&&(Nr(r,M,B,T),$d(r,M,B)),B}function sm(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function $w(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<o?m:o}}function Ap(r,o){$w(r,o),(r=r.alternate)&&$w(r,o)}function iz(){return null}var Pw=typeof reportError=="function"?reportError:function(r){console.error(r)};function Op(r){this._internalRoot=r}rm.prototype.render=Op.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));nm(r,o,null,null)},rm.prototype.unmount=Op.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;ai(function(){nm(null,r,null,null)}),o[ia]=null}};function rm(r){this._internalRoot=r}rm.prototype.unstable_scheduleHydration=function(r){if(r){var o=Or();r={blockedOn:null,target:r,priority:o};for(var m=0;m<je.length&&o!==0&&o<je[m].priority;m++);je.splice(m,0,r),m===0&&ot(r)}};function Tp(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function am(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Rw(){}function lz(r,o,m,v,M){if(M){if(typeof v=="function"){var T=v;v=function(){var he=sm(B);T.call(he)}}var B=Tw(o,v,r,0,null,!1,!1,"",Rw);return r._reactRootContainer=B,r[ia]=B.current,Ua(r.nodeType===8?r.parentNode:r),ai(),B}for(;M=r.lastChild;)r.removeChild(M);if(typeof v=="function"){var ee=v;v=function(){var he=sm(ae);ee.call(he)}}var ae=Mp(r,0,!1,null,null,!1,!1,"",Rw);return r._reactRootContainer=ae,r[ia]=ae.current,Ua(r.nodeType===8?r.parentNode:r),ai(function(){nm(o,ae,m,v)}),ae}function om(r,o,m,v,M){var T=m._reactRootContainer;if(T){var B=T;if(typeof M=="function"){var ee=M;M=function(){var ae=sm(B);ee.call(ae)}}nm(o,B,r,M)}else B=lz(m,o,r,M,v);return sm(B)}Do=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var m=Vt(o.pendingLanes);m!==0&&($a(o,m|1),Rs(o,Xe()),!(Pt&6)&&(ul=Xe()+500,Ga()))}break;case 13:ai(function(){var v=da(r,1);if(v!==null){var M=vs();Nr(v,r,1,M)}}),Ap(r,1)}},Fo=function(r){if(r.tag===13){var o=da(r,134217728);if(o!==null){var m=vs();Nr(o,r,134217728,m)}Ap(r,134217728)}},Io=function(r){if(r.tag===13){var o=to(r),m=da(r,o);if(m!==null){var v=vs();Nr(m,r,o,v)}Ap(r,o)}},Or=function(){return gt},_r=function(r,o){var m=gt;try{return gt=r,o()}finally{gt=m}},fe=function(r,o,m){switch(o){case"input":if(de(r,m),o=m.name,m.type==="radio"&&o!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<m.length;o++){var v=m[o];if(v!==r&&v.form===r.form){var M=Nd(v);if(!M)throw Error(n(90));ze(v),de(v,M)}}}break;case"textarea":Ge(r,m);break;case"select":o=m.value,o!=null&&Ue(r,!!m.multiple,o,!1)}},ft=Np,Cs=ai;var cz={usingClientEntryPoint:!1,Events:[jc,Xi,Nd,bt,dn,Np]},Dc={findFiberByHostInstance:Xo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},uz={bundleType:Dc.bundleType,version:Dc.version,rendererPackageName:Dc.rendererPackageName,rendererConfig:Dc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:j.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=Fn(r),r===null?null:r.stateNode},findFiberByHostInstance:Dc.findFiberByHostInstance||iz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var im=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!im.isDisabled&&im.supportsFiber)try{ve=im.inject(uz),Pe=im}catch{}}return ys.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cz,ys.createPortal=function(r,o){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tp(o))throw Error(n(200));return oz(r,o,null,m)},ys.createRoot=function(r,o){if(!Tp(r))throw Error(n(299));var m=!1,v="",M=Pw;return o!=null&&(o.unstable_strictMode===!0&&(m=!0),o.identifierPrefix!==void 0&&(v=o.identifierPrefix),o.onRecoverableError!==void 0&&(M=o.onRecoverableError)),o=Mp(r,1,!1,null,null,m,!1,v,M),r[ia]=o.current,Ua(r.nodeType===8?r.parentNode:r),new Op(o)},ys.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=Fn(o),r=r===null?null:r.stateNode,r},ys.flushSync=function(r){return ai(r)},ys.hydrate=function(r,o,m){if(!am(o))throw Error(n(200));return om(null,r,o,!0,m)},ys.hydrateRoot=function(r,o,m){if(!Tp(r))throw Error(n(405));var v=m!=null&&m.hydratedSources||null,M=!1,T="",B=Pw;if(m!=null&&(m.unstable_strictMode===!0&&(M=!0),m.identifierPrefix!==void 0&&(T=m.identifierPrefix),m.onRecoverableError!==void 0&&(B=m.onRecoverableError)),o=Tw(o,null,r,1,m??null,M,!1,T,B),r[ia]=o.current,Ua(r),v)for(r=0;r<v.length;r++)m=v[r],M=m._getVersion,M=M(m._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[m,M]:o.mutableSourceEagerHydrationData.push(m,M);return new rm(o)},ys.render=function(r,o,m){if(!am(o))throw Error(n(200));return om(null,r,o,!1,m)},ys.unmountComponentAtNode=function(r){if(!am(r))throw Error(n(40));return r._reactRootContainer?(ai(function(){om(null,null,r,!1,function(){r._reactRootContainer=null,r[ia]=null})}),!0):!1},ys.unstable_batchedUpdates=Np,ys.unstable_renderSubtreeIntoContainer=function(r,o,m,v){if(!am(m))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return om(r,o,m,!1,v)},ys.version="18.3.1-next-f1338f8080-20240426",ys}function Yp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yp)}catch(e){console.error(e)}}Yp(),Hp.exports=Uw();var Gp=Hp.exports,Qp=Gp;um.createRoot=Qp.createRoot,um.hydrateRoot=Qp.hydrateRoot;var ci=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},qw={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Hw=(Vx=class{constructor(){We(this,ja,qw);We(this,rf,!1)}setTimeoutProvider(e){Re(this,ja,e)}setTimeout(e,t){return se(this,ja).setTimeout(e,t)}clearTimeout(e){se(this,ja).clearTimeout(e)}setInterval(e,t){return se(this,ja).setInterval(e,t)}clearInterval(e){se(this,ja).clearInterval(e)}},ja=new WeakMap,rf=new WeakMap,Vx),io=new Hw;function Vw(e){setTimeout(e,0)}var lo=typeof window>"u"||"Deno"in globalThis;function ms(){}function Ww(e,t){return typeof e=="function"?e(t):e}function hm(e){return typeof e=="number"&&e>=0&&e!==1/0}function Xp(e,t){return Math.max(e+(t||0)-Date.now(),0)}function ga(e,t){return typeof e=="function"?e(t):e}function Zs(e,t){return typeof e=="function"?e(t):e}function Jp(e,t){const{type:n="all",exact:s,fetchStatus:i,predicate:l,queryKey:c,stale:u}=e;if(c){if(s){if(t.queryHash!==fm(c,t.options))return!1}else if(!ml(t.queryKey,c))return!1}if(n!=="all"){const d=t.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||i&&i!==t.state.fetchStatus||l&&!l(t))}function Zp(e,t){const{exact:n,status:s,predicate:i,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(n){if(co(t.options.mutationKey)!==co(l))return!1}else if(!ml(t.options.mutationKey,l))return!1}return!(s&&t.state.status!==s||i&&!i(t))}function fm(e,t){return((t==null?void 0:t.queryKeyHashFn)||co)(e)}function co(e){return JSON.stringify(e,(t,n)=>pm(n)?Object.keys(n).sort().reduce((s,i)=>(s[i]=n[i],s),{}):n)}function ml(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>ml(e[n],t[n])):!1}var Kw=Object.prototype.hasOwnProperty;function eg(e,t){if(e===t)return e;const n=tg(e)&&tg(t);if(!n&&!(pm(e)&&pm(t)))return t;const i=(n?e:Object.keys(e)).length,l=n?t:Object.keys(t),c=l.length,u=n?new Array(c):{};let d=0;for(let p=0;p<c;p++){const h=n?p:l[p],f=e[h],g=t[h];if(f===g){u[h]=f,(n?p<i:Kw.call(e,h))&&d++;continue}if(f===null||g===null||typeof f!="object"||typeof g!="object"){u[h]=g;continue}const b=eg(f,g);u[h]=b,b===f&&d++}return i===c&&d===i?e:u}function Ic(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function tg(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function pm(e){if(!ng(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!ng(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ng(e){return Object.prototype.toString.call(e)==="[object Object]"}function Yw(e){return new Promise(t=>{io.setTimeout(t,e)})}function gm(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?eg(e,t):t}function Gw(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function Qw(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var _m=Symbol();function sg(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===_m?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function rg(e,t){return typeof e=="function"?e(...t):!!e}var Xw=(Wx=class extends ci{constructor(){super();We(this,ko);We(this,Ca);We(this,Ai);Re(this,Ai,t=>{if(!lo&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){se(this,Ca)||this.setEventListener(se(this,Ai))}onUnsubscribe(){var t;this.hasListeners()||((t=se(this,Ca))==null||t.call(this),Re(this,Ca,void 0))}setEventListener(t){var n;Re(this,Ai,t),(n=se(this,Ca))==null||n.call(this),Re(this,Ca,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){se(this,ko)!==t&&(Re(this,ko,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof se(this,ko)=="boolean"?se(this,ko):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ko=new WeakMap,Ca=new WeakMap,Ai=new WeakMap,Wx),vm=new Xw;function ym(){let e,t;const n=new Promise((i,l)=>{e=i,t=l});n.status="pending",n.catch(()=>{});function s(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{s({status:"fulfilled",value:i}),e(i)},n.reject=i=>{s({status:"rejected",reason:i}),t(i)},n}var Jw=Vw;function Zw(){let e=[],t=0,n=u=>{u()},s=u=>{u()},i=Jw;const l=u=>{t?e.push(u):i(()=>{n(u)})},c=()=>{const u=e;e=[],u.length&&i(()=>{s(()=>{u.forEach(d=>{n(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{l(()=>{u(...d)})},schedule:l,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{i=u}}}var Tn=Zw(),eN=(Kx=class extends ci{constructor(){super();We(this,Oi,!0);We(this,Sa);We(this,Ti);Re(this,Ti,t=>{if(!lo&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){se(this,Sa)||this.setEventListener(se(this,Ti))}onUnsubscribe(){var t;this.hasListeners()||((t=se(this,Sa))==null||t.call(this),Re(this,Sa,void 0))}setEventListener(t){var n;Re(this,Ti,t),(n=se(this,Sa))==null||n.call(this),Re(this,Sa,t(this.setOnline.bind(this)))}setOnline(t){se(this,Oi)!==t&&(Re(this,Oi,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return se(this,Oi)}},Oi=new WeakMap,Sa=new WeakMap,Ti=new WeakMap,Kx),Bc=new eN;function tN(e){return Math.min(1e3*2**e,3e4)}function ag(e){return(e??"online")==="online"?Bc.isOnline():!0}var bm=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function og(e){let t=!1,n=0,s;const i=ym(),l=()=>i.status!=="pending",c=y=>{var x;if(!l()){const N=new bm(y);g(N),(x=e.onCancel)==null||x.call(e,N)}},u=()=>{t=!0},d=()=>{t=!1},p=()=>vm.isFocused()&&(e.networkMode==="always"||Bc.isOnline())&&e.canRun(),h=()=>ag(e.networkMode)&&e.canRun(),f=y=>{l()||(s==null||s(),i.resolve(y))},g=y=>{l()||(s==null||s(),i.reject(y))},b=()=>new Promise(y=>{var x;s=N=>{(l()||p())&&y(N)},(x=e.onPause)==null||x.call(e)}).then(()=>{var y;s=void 0,l()||(y=e.onContinue)==null||y.call(e)}),w=()=>{if(l())return;let y;const x=n===0?e.initialPromise:void 0;try{y=x??e.fn()}catch(N){y=Promise.reject(N)}Promise.resolve(y).then(f).catch(N=>{var k;if(l())return;const E=e.retry??(lo?0:3),S=e.retryDelay??tN,j=typeof S=="function"?S(n,N):S,C=E===!0||typeof E=="number"&&n<E||typeof E=="function"&&E(n,N);if(t||!C){g(N);return}n++,(k=e.onFail)==null||k.call(e,n,N),Yw(j).then(()=>p()?void 0:b()).then(()=>{t?g(N):w()})})};return{promise:i,status:()=>i.status,cancel:c,continue:()=>(s==null||s(),i),cancelRetry:u,continueRetry:d,canStart:h,start:()=>(h()?w():b().then(w),i)}}var ig=(Yx=class{constructor(){We(this,Mo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),hm(this.gcTime)&&Re(this,Mo,io.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(lo?1/0:5*60*1e3))}clearGcTimeout(){se(this,Mo)&&(io.clearTimeout(se(this,Mo)),Re(this,Mo,void 0))}},Mo=new WeakMap,Yx),nN={NODE_ENV:"production"},sN=(Gx=class extends ig{constructor(t){super();We(this,fr);We(this,Ao);We(this,$i);We(this,er);We(this,Oo);We(this,Dn);We(this,Jl);We(this,To);Re(this,To,!1),Re(this,Jl,t.defaultOptions),this.setOptions(t.options),this.observers=[],Re(this,Oo,t.client),Re(this,er,se(this,Oo).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Re(this,Ao,cg(this.options)),this.state=t.state??se(this,Ao),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=se(this,Dn))==null?void 0:t.promise}setOptions(t){if(this.options={...se(this,Jl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=cg(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),Re(this,Ao,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&se(this,er).remove(this)}setData(t,n){const s=gm(this.state.data,t,this.options);return xt(this,fr,pa).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){xt(this,fr,pa).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,i;const n=(s=se(this,Dn))==null?void 0:s.promise;return(i=se(this,Dn))==null||i.cancel(t),n?n.then(ms).catch(ms):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(se(this,Ao))}isActive(){return this.observers.some(t=>Zs(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===_m||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ga(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!Xp(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=se(this,Dn))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=se(this,Dn))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),se(this,er).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(se(this,Dn)&&(se(this,To)?se(this,Dn).cancel({revert:!0}):se(this,Dn).cancelRetry()),this.scheduleGc()),se(this,er).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||xt(this,fr,pa).call(this,{type:"invalidate"})}async fetch(t,n){var d,p,h,f,g,b,w,y,x,N,E,S;if(this.state.fetchStatus!=="idle"&&((d=se(this,Dn))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(se(this,Dn))return se(this,Dn).continueRetry(),se(this,Dn).promise}if(t&&this.setOptions(t),!this.options.queryFn){const j=this.observers.find(C=>C.options.queryFn);j&&this.setOptions(j.options)}const s=new AbortController,i=j=>{Object.defineProperty(j,"signal",{enumerable:!0,get:()=>(Re(this,To,!0),s.signal)})},l=()=>{const j=sg(this.options,n),k=(()=>{const O={client:se(this,Oo),queryKey:this.queryKey,meta:this.meta};return i(O),O})();return Re(this,To,!1),this.options.persister?this.options.persister(j,k,this):j(k)},u=(()=>{const j={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:se(this,Oo),state:this.state,fetchFn:l};return i(j),j})();(p=this.options.behavior)==null||p.onFetch(u,this),Re(this,$i,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=u.fetchOptions)==null?void 0:h.meta))&&xt(this,fr,pa).call(this,{type:"fetch",meta:(f=u.fetchOptions)==null?void 0:f.meta}),Re(this,Dn,og({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,onCancel:j=>{j instanceof bm&&j.revert&&this.setState({...se(this,$i),fetchStatus:"idle"}),s.abort()},onFail:(j,C)=>{xt(this,fr,pa).call(this,{type:"failed",failureCount:j,error:C})},onPause:()=>{xt(this,fr,pa).call(this,{type:"pause"})},onContinue:()=>{xt(this,fr,pa).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const j=await se(this,Dn).start();if(j===void 0)throw nN.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(j),(b=(g=se(this,er).config).onSuccess)==null||b.call(g,j,this),(y=(w=se(this,er).config).onSettled)==null||y.call(w,j,this.state.error,this),j}catch(j){if(j instanceof bm){if(j.silent)return se(this,Dn).promise;if(j.revert){if(this.state.data===void 0)throw j;return this.state.data}}throw xt(this,fr,pa).call(this,{type:"error",error:j}),(N=(x=se(this,er).config).onError)==null||N.call(x,j,this),(S=(E=se(this,er).config).onSettled)==null||S.call(E,this.state.data,j,this),j}finally{this.scheduleGc()}}},Ao=new WeakMap,$i=new WeakMap,er=new WeakMap,Oo=new WeakMap,Dn=new WeakMap,Jl=new WeakMap,To=new WeakMap,fr=new WeakSet,pa=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...lg(s.data,this.options),fetchMeta:t.meta??null};case"success":const i={...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Re(this,$i,t.manual?i:void 0),i;case"error":const l=t.error;return{...s,error:l,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),Tn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),se(this,er).notify({query:this,type:"updated",action:t})})},Gx);function lg(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ag(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function cg(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var rN=(Qx=class extends ci{constructor(t,n){super();We(this,It);We(this,Ns);We(this,Et);We(this,Zl);We(this,hs);We(this,$o);We(this,Pi);We(this,Kr);We(this,Ea);We(this,ec);We(this,Ri);We(this,Li);We(this,Po);We(this,Ro);We(this,ka);We(this,zi,new Set);this.options=n,Re(this,Ns,t),Re(this,Ea,null),Re(this,Kr,ym()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(se(this,Et).addObserver(this),ug(se(this,Et),this.options)?xt(this,It,Fc).call(this):this.updateResult(),xt(this,It,zp).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return xm(se(this,Et),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return xm(se(this,Et),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,xt(this,It,Dp).call(this),xt(this,It,Fp).call(this),se(this,Et).removeObserver(this)}setOptions(t){const n=this.options,s=se(this,Et);if(this.options=se(this,Ns).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Zs(this.options.enabled,se(this,Et))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");xt(this,It,Ip).call(this),se(this,Et).setOptions(this.options),n._defaulted&&!Ic(this.options,n)&&se(this,Ns).getQueryCache().notify({type:"observerOptionsUpdated",query:se(this,Et),observer:this});const i=this.hasListeners();i&&dg(se(this,Et),s,this.options,n)&&xt(this,It,Fc).call(this),this.updateResult(),i&&(se(this,Et)!==s||Zs(this.options.enabled,se(this,Et))!==Zs(n.enabled,se(this,Et))||ga(this.options.staleTime,se(this,Et))!==ga(n.staleTime,se(this,Et)))&&xt(this,It,Pp).call(this);const l=xt(this,It,Rp).call(this);i&&(se(this,Et)!==s||Zs(this.options.enabled,se(this,Et))!==Zs(n.enabled,se(this,Et))||l!==se(this,ka))&&xt(this,It,Lp).call(this,l)}getOptimisticResult(t){const n=se(this,Ns).getQueryCache().build(se(this,Ns),t),s=this.createResult(n,t);return oN(this,s)&&(Re(this,hs,s),Re(this,Pi,this.options),Re(this,$o,se(this,Et).state)),s}getCurrentResult(){return se(this,hs)}trackResult(t,n){return new Proxy(t,{get:(s,i)=>(this.trackProp(i),n==null||n(i),i==="promise"&&!this.options.experimental_prefetchInRender&&se(this,Kr).status==="pending"&&se(this,Kr).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(s,i))})}trackProp(t){se(this,zi).add(t)}getCurrentQuery(){return se(this,Et)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=se(this,Ns).defaultQueryOptions(t),s=se(this,Ns).getQueryCache().build(se(this,Ns),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(t){return xt(this,It,Fc).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),se(this,hs)))}createResult(t,n){var P;const s=se(this,Et),i=this.options,l=se(this,hs),c=se(this,$o),u=se(this,Pi),p=t!==s?t.state:se(this,Zl),{state:h}=t;let f={...h},g=!1,b;if(n._optimisticResults){const $=this.hasListeners(),A=!$&&ug(t,n),D=$&&dg(t,s,n,i);(A||D)&&(f={...f,...lg(h.data,t.options)}),n._optimisticResults==="isRestoring"&&(f.fetchStatus="idle")}let{error:w,errorUpdatedAt:y,status:x}=f;b=f.data;let N=!1;if(n.placeholderData!==void 0&&b===void 0&&x==="pending"){let $;l!=null&&l.isPlaceholderData&&n.placeholderData===(u==null?void 0:u.placeholderData)?($=l.data,N=!0):$=typeof n.placeholderData=="function"?n.placeholderData((P=se(this,Li))==null?void 0:P.state.data,se(this,Li)):n.placeholderData,$!==void 0&&(x="success",b=gm(l==null?void 0:l.data,$,n),g=!0)}if(n.select&&b!==void 0&&!N)if(l&&b===(c==null?void 0:c.data)&&n.select===se(this,ec))b=se(this,Ri);else try{Re(this,ec,n.select),b=n.select(b),b=gm(l==null?void 0:l.data,b,n),Re(this,Ri,b),Re(this,Ea,null)}catch($){Re(this,Ea,$)}se(this,Ea)&&(w=se(this,Ea),b=se(this,Ri),y=Date.now(),x="error");const E=f.fetchStatus==="fetching",S=x==="pending",j=x==="error",C=S&&E,k=b!==void 0,R={status:x,fetchStatus:f.fetchStatus,isPending:S,isSuccess:x==="success",isError:j,isInitialLoading:C,isLoading:C,data:b,dataUpdatedAt:f.dataUpdatedAt,error:w,errorUpdatedAt:y,failureCount:f.fetchFailureCount,failureReason:f.fetchFailureReason,errorUpdateCount:f.errorUpdateCount,isFetched:f.dataUpdateCount>0||f.errorUpdateCount>0,isFetchedAfterMount:f.dataUpdateCount>p.dataUpdateCount||f.errorUpdateCount>p.errorUpdateCount,isFetching:E,isRefetching:E&&!S,isLoadingError:j&&!k,isPaused:f.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:j&&k,isStale:wm(t,n),refetch:this.refetch,promise:se(this,Kr),isEnabled:Zs(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const $=V=>{R.status==="error"?V.reject(R.error):R.data!==void 0&&V.resolve(R.data)},A=()=>{const V=Re(this,Kr,R.promise=ym());$(V)},D=se(this,Kr);switch(D.status){case"pending":t.queryHash===s.queryHash&&$(D);break;case"fulfilled":(R.status==="error"||R.data!==D.value)&&A();break;case"rejected":(R.status!=="error"||R.error!==D.reason)&&A();break}}return R}updateResult(){const t=se(this,hs),n=this.createResult(se(this,Et),this.options);if(Re(this,$o,se(this,Et).state),Re(this,Pi,this.options),se(this,$o).data!==void 0&&Re(this,Li,se(this,Et)),Ic(n,t))return;Re(this,hs,n);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,l=typeof i=="function"?i():i;if(l==="all"||!l&&!se(this,zi).size)return!0;const c=new Set(l??se(this,zi));return this.options.throwOnError&&c.add("error"),Object.keys(se(this,hs)).some(u=>{const d=u;return se(this,hs)[d]!==t[d]&&c.has(d)})};xt(this,It,zw).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&xt(this,It,zp).call(this)}},Ns=new WeakMap,Et=new WeakMap,Zl=new WeakMap,hs=new WeakMap,$o=new WeakMap,Pi=new WeakMap,Kr=new WeakMap,Ea=new WeakMap,ec=new WeakMap,Ri=new WeakMap,Li=new WeakMap,Po=new WeakMap,Ro=new WeakMap,ka=new WeakMap,zi=new WeakMap,It=new WeakSet,Fc=function(t){xt(this,It,Ip).call(this);let n=se(this,Et).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(ms)),n},Pp=function(){xt(this,It,Dp).call(this);const t=ga(this.options.staleTime,se(this,Et));if(lo||se(this,hs).isStale||!hm(t))return;const s=Xp(se(this,hs).dataUpdatedAt,t)+1;Re(this,Po,io.setTimeout(()=>{se(this,hs).isStale||this.updateResult()},s))},Rp=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(se(this,Et)):this.options.refetchInterval)??!1},Lp=function(t){xt(this,It,Fp).call(this),Re(this,ka,t),!(lo||Zs(this.options.enabled,se(this,Et))===!1||!hm(se(this,ka))||se(this,ka)===0)&&Re(this,Ro,io.setInterval(()=>{(this.options.refetchIntervalInBackground||vm.isFocused())&&xt(this,It,Fc).call(this)},se(this,ka)))},zp=function(){xt(this,It,Pp).call(this),xt(this,It,Lp).call(this,xt(this,It,Rp).call(this))},Dp=function(){se(this,Po)&&(io.clearTimeout(se(this,Po)),Re(this,Po,void 0))},Fp=function(){se(this,Ro)&&(io.clearInterval(se(this,Ro)),Re(this,Ro,void 0))},Ip=function(){const t=se(this,Ns).getQueryCache().build(se(this,Ns),this.options);if(t===se(this,Et))return;const n=se(this,Et);Re(this,Et,t),Re(this,Zl,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},zw=function(t){Tn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(se(this,hs))}),se(this,Ns).getQueryCache().notify({query:se(this,Et),type:"observerResultsUpdated"})})},Qx);function aN(e,t){return Zs(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function ug(e,t){return aN(e,t)||e.state.data!==void 0&&xm(e,t,t.refetchOnMount)}function xm(e,t,n){if(Zs(t.enabled,e)!==!1&&ga(t.staleTime,e)!=="static"){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&wm(e,t)}return!1}function dg(e,t,n,s){return(e!==t||Zs(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&wm(e,n)}function wm(e,t){return Zs(t.enabled,e)!==!1&&e.isStaleByTime(ga(t.staleTime,e))}function oN(e,t){return!Ic(e.getCurrentResult(),t)}function mg(e){return{onFetch:(t,n)=>{var h,f,g,b,w;const s=t.options,i=(g=(f=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:f.fetchMore)==null?void 0:g.direction,l=((b=t.state.data)==null?void 0:b.pages)||[],c=((w=t.state.data)==null?void 0:w.pageParams)||[];let u={pages:[],pageParams:[]},d=0;const p=async()=>{let y=!1;const x=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(t.signal.aborted?y=!0:t.signal.addEventListener("abort",()=>{y=!0}),t.signal)})},N=sg(t.options,t.fetchOptions),E=async(S,j,C)=>{if(y)return Promise.reject();if(j==null&&S.pages.length)return Promise.resolve(S);const O=(()=>{const A={client:t.client,queryKey:t.queryKey,pageParam:j,direction:C?"backward":"forward",meta:t.options.meta};return x(A),A})(),R=await N(O),{maxPages:P}=t.options,$=C?Qw:Gw;return{pages:$(S.pages,R,P),pageParams:$(S.pageParams,j,P)}};if(i&&l.length){const S=i==="backward",j=S?iN:hg,C={pages:l,pageParams:c},k=j(s,C);u=await E(C,k,S)}else{const S=e??l.length;do{const j=d===0?c[0]??s.initialPageParam:hg(s,u);if(d>0&&j==null)break;u=await E(u,j),d++}while(d<S)}return u};t.options.persister?t.fetchFn=()=>{var y,x;return(x=(y=t.options).persister)==null?void 0:x.call(y,p,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=p}}}function hg(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function iN(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var lN=(Xx=class extends ig{constructor(t){super();We(this,Mr);We(this,tc);We(this,kr);We(this,fs);We(this,Lo);Re(this,tc,t.client),this.mutationId=t.mutationId,Re(this,fs,t.mutationCache),Re(this,kr,[]),this.state=t.state||fg(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){se(this,kr).includes(t)||(se(this,kr).push(t),this.clearGcTimeout(),se(this,fs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Re(this,kr,se(this,kr).filter(n=>n!==t)),this.scheduleGc(),se(this,fs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){se(this,kr).length||(this.state.status==="pending"?this.scheduleGc():se(this,fs).remove(this))}continue(){var t;return((t=se(this,Lo))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var c,u,d,p,h,f,g,b,w,y,x,N,E,S,j,C,k,O,R,P;const n=()=>{xt(this,Mr,ao).call(this,{type:"continue"})},s={client:se(this,tc),meta:this.options.meta,mutationKey:this.options.mutationKey};Re(this,Lo,og({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:($,A)=>{xt(this,Mr,ao).call(this,{type:"failed",failureCount:$,error:A})},onPause:()=>{xt(this,Mr,ao).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>se(this,fs).canRun(this)}));const i=this.state.status==="pending",l=!se(this,Lo).canStart();try{if(i)n();else{xt(this,Mr,ao).call(this,{type:"pending",variables:t,isPaused:l}),await((u=(c=se(this,fs).config).onMutate)==null?void 0:u.call(c,t,this,s));const A=await((p=(d=this.options).onMutate)==null?void 0:p.call(d,t,s));A!==this.state.context&&xt(this,Mr,ao).call(this,{type:"pending",context:A,variables:t,isPaused:l})}const $=await se(this,Lo).start();return await((f=(h=se(this,fs).config).onSuccess)==null?void 0:f.call(h,$,t,this.state.context,this,s)),await((b=(g=this.options).onSuccess)==null?void 0:b.call(g,$,t,this.state.context,s)),await((y=(w=se(this,fs).config).onSettled)==null?void 0:y.call(w,$,null,this.state.variables,this.state.context,this,s)),await((N=(x=this.options).onSettled)==null?void 0:N.call(x,$,null,t,this.state.context,s)),xt(this,Mr,ao).call(this,{type:"success",data:$}),$}catch($){try{throw await((S=(E=se(this,fs).config).onError)==null?void 0:S.call(E,$,t,this.state.context,this,s)),await((C=(j=this.options).onError)==null?void 0:C.call(j,$,t,this.state.context,s)),await((O=(k=se(this,fs).config).onSettled)==null?void 0:O.call(k,void 0,$,this.state.variables,this.state.context,this,s)),await((P=(R=this.options).onSettled)==null?void 0:P.call(R,void 0,$,t,this.state.context,s)),$}finally{xt(this,Mr,ao).call(this,{type:"error",error:$})}}finally{se(this,fs).runNext(this)}}},tc=new WeakMap,kr=new WeakMap,fs=new WeakMap,Lo=new WeakMap,Mr=new WeakSet,ao=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Tn.batch(()=>{se(this,kr).forEach(s=>{s.onMutationUpdate(t)}),se(this,fs).notify({mutation:this,type:"updated",action:t})})},Xx);function fg(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var cN=(Jx=class extends ci{constructor(t={}){super();We(this,Yr);We(this,pr);We(this,nc);this.config=t,Re(this,Yr,new Set),Re(this,pr,new Map),Re(this,nc,0)}build(t,n,s){const i=new lN({client:t,mutationCache:this,mutationId:++lm(this,nc)._,options:t.defaultMutationOptions(n),state:s});return this.add(i),i}add(t){se(this,Yr).add(t);const n=Uc(t);if(typeof n=="string"){const s=se(this,pr).get(n);s?s.push(t):se(this,pr).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(se(this,Yr).delete(t)){const n=Uc(t);if(typeof n=="string"){const s=se(this,pr).get(n);if(s)if(s.length>1){const i=s.indexOf(t);i!==-1&&s.splice(i,1)}else s[0]===t&&se(this,pr).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Uc(t);if(typeof n=="string"){const s=se(this,pr).get(n),i=s==null?void 0:s.find(l=>l.state.status==="pending");return!i||i===t}else return!0}runNext(t){var s;const n=Uc(t);if(typeof n=="string"){const i=(s=se(this,pr).get(n))==null?void 0:s.find(l=>l!==t&&l.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Tn.batch(()=>{se(this,Yr).forEach(t=>{this.notify({type:"removed",mutation:t})}),se(this,Yr).clear(),se(this,pr).clear()})}getAll(){return Array.from(se(this,Yr))}find(t){const n={exact:!0,...t};return this.getAll().find(s=>Zp(n,s))}findAll(t={}){return this.getAll().filter(n=>Zp(t,n))}notify(t){Tn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Tn.batch(()=>Promise.all(t.map(n=>n.continue().catch(ms))))}},Yr=new WeakMap,pr=new WeakMap,nc=new WeakMap,Jx);function Uc(e){var t;return(t=e.options.scope)==null?void 0:t.id}var uN=(Zx=class extends ci{constructor(t,n){super();We(this,Xr);We(this,Gr);We(this,Ma);We(this,js);We(this,Qr);Re(this,Gr,t),this.setOptions(n),this.bindMethods(),xt(this,Xr,cm).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const n=this.options;this.options=se(this,Gr).defaultMutationOptions(t),Ic(this.options,n)||se(this,Gr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:se(this,js),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&co(n.mutationKey)!==co(this.options.mutationKey)?this.reset():((s=se(this,js))==null?void 0:s.state.status)==="pending"&&se(this,js).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=se(this,js))==null||t.removeObserver(this)}onMutationUpdate(t){xt(this,Xr,cm).call(this),xt(this,Xr,Bp).call(this,t)}getCurrentResult(){return se(this,Ma)}reset(){var t;(t=se(this,js))==null||t.removeObserver(this),Re(this,js,void 0),xt(this,Xr,cm).call(this),xt(this,Xr,Bp).call(this)}mutate(t,n){var s;return Re(this,Qr,n),(s=se(this,js))==null||s.removeObserver(this),Re(this,js,se(this,Gr).getMutationCache().build(se(this,Gr),this.options)),se(this,js).addObserver(this),se(this,js).execute(t)}},Gr=new WeakMap,Ma=new WeakMap,js=new WeakMap,Qr=new WeakMap,Xr=new WeakSet,cm=function(){var n;const t=((n=se(this,js))==null?void 0:n.state)??fg();Re(this,Ma,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Bp=function(t){Tn.batch(()=>{var n,s,i,l,c,u,d,p;if(se(this,Qr)&&this.hasListeners()){const h=se(this,Ma).variables,f=se(this,Ma).context,g={client:se(this,Gr),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((s=(n=se(this,Qr)).onSuccess)==null||s.call(n,t.data,h,f,g),(l=(i=se(this,Qr)).onSettled)==null||l.call(i,t.data,null,h,f,g)):(t==null?void 0:t.type)==="error"&&((u=(c=se(this,Qr)).onError)==null||u.call(c,t.error,h,f,g),(p=(d=se(this,Qr)).onSettled)==null||p.call(d,void 0,t.error,h,f,g))}this.listeners.forEach(h=>{h(se(this,Ma))})})},Zx),dN=(e0=class extends ci{constructor(t={}){super();We(this,Ar);this.config=t,Re(this,Ar,new Map)}build(t,n,s){const i=n.queryKey,l=n.queryHash??fm(i,n);let c=this.get(l);return c||(c=new sN({client:t,queryKey:i,queryHash:l,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(i)}),this.add(c)),c}add(t){se(this,Ar).has(t.queryHash)||(se(this,Ar).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=se(this,Ar).get(t.queryHash);n&&(t.destroy(),n===t&&se(this,Ar).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Tn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return se(this,Ar).get(t)}getAll(){return[...se(this,Ar).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>Jp(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>Jp(t,s)):n}notify(t){Tn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Tn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Tn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Ar=new WeakMap,e0),mN=(t0=class{constructor(e={}){We(this,un);We(this,Aa);We(this,Oa);We(this,Di);We(this,Fi);We(this,Ta);We(this,Ii);We(this,Bi);Re(this,un,e.queryCache||new dN),Re(this,Aa,e.mutationCache||new cN),Re(this,Oa,e.defaultOptions||{}),Re(this,Di,new Map),Re(this,Fi,new Map),Re(this,Ta,0)}mount(){lm(this,Ta)._++,se(this,Ta)===1&&(Re(this,Ii,vm.subscribe(async e=>{e&&(await this.resumePausedMutations(),se(this,un).onFocus())})),Re(this,Bi,Bc.subscribe(async e=>{e&&(await this.resumePausedMutations(),se(this,un).onOnline())})))}unmount(){var e,t;lm(this,Ta)._--,se(this,Ta)===0&&((e=se(this,Ii))==null||e.call(this),Re(this,Ii,void 0),(t=se(this,Bi))==null||t.call(this),Re(this,Bi,void 0))}isFetching(e){return se(this,un).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return se(this,Aa).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=se(this,un).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=se(this,un).build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(ga(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return se(this,un).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),i=se(this,un).get(s.queryHash),l=i==null?void 0:i.state.data,c=Ww(t,l);if(c!==void 0)return se(this,un).build(this,s).setData(c,{...n,manual:!0})}setQueriesData(e,t,n){return Tn.batch(()=>se(this,un).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=se(this,un).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=se(this,un);Tn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=se(this,un);return Tn.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=Tn.batch(()=>se(this,un).findAll(e).map(i=>i.cancel(n)));return Promise.all(s).then(ms).catch(ms)}invalidateQueries(e,t={}){return Tn.batch(()=>(se(this,un).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=Tn.batch(()=>se(this,un).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let l=i.fetch(void 0,n);return n.throwOnError||(l=l.catch(ms)),i.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(s).then(ms)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=se(this,un).build(this,t);return n.isStaleByTime(ga(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ms).catch(ms)}fetchInfiniteQuery(e){return e.behavior=mg(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ms).catch(ms)}ensureInfiniteQueryData(e){return e.behavior=mg(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Bc.isOnline()?se(this,Aa).resumePausedMutations():Promise.resolve()}getQueryCache(){return se(this,un)}getMutationCache(){return se(this,Aa)}getDefaultOptions(){return se(this,Oa)}setDefaultOptions(e){Re(this,Oa,e)}setQueryDefaults(e,t){se(this,Di).set(co(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...se(this,Di).values()],n={};return t.forEach(s=>{ml(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){se(this,Fi).set(co(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...se(this,Fi).values()],n={};return t.forEach(s=>{ml(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...se(this,Oa).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=fm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===_m&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...se(this,Oa).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){se(this,un).clear(),se(this,Aa).clear()}},un=new WeakMap,Aa=new WeakMap,Oa=new WeakMap,Di=new WeakMap,Fi=new WeakMap,Ta=new WeakMap,Ii=new WeakMap,Bi=new WeakMap,t0),pg=_.createContext(void 0),uo=e=>{const t=_.useContext(pg);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},hN=({client:e,children:t})=>(_.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(pg.Provider,{value:e,children:t})),gg=_.createContext(!1),fN=()=>_.useContext(gg);gg.Provider;function pN(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var gN=_.createContext(pN()),_N=()=>_.useContext(gN),vN=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},yN=e=>{_.useEffect(()=>{e.clearReset()},[e])},bN=({result:e,errorResetBoundary:t,throwOnError:n,query:s,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(i&&e.data===void 0||rg(n,[e.error,s])),xN=e=>{if(e.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...i)=>n(s(...i)):n(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},wN=(e,t)=>e.isLoading&&e.isFetching&&!t,NN=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,_g=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function jN(e,t,n){var f,g,b,w,y;const s=fN(),i=_N(),l=uo(),c=l.defaultQueryOptions(e);(g=(f=l.getDefaultOptions().queries)==null?void 0:f._experimental_beforeQuery)==null||g.call(f,c),c._optimisticResults=s?"isRestoring":"optimistic",xN(c),vN(c,i),yN(i);const u=!l.getQueryCache().get(c.queryHash),[d]=_.useState(()=>new t(l,c)),p=d.getOptimisticResult(c),h=!s&&e.subscribed!==!1;if(_.useSyncExternalStore(_.useCallback(x=>{const N=h?d.subscribe(Tn.batchCalls(x)):ms;return d.updateResult(),N},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),_.useEffect(()=>{d.setOptions(c)},[c,d]),NN(c,p))throw _g(c,d,i);if(bN({result:p,errorResetBoundary:i,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw p.error;if((w=(b=l.getDefaultOptions().queries)==null?void 0:b._experimental_afterQuery)==null||w.call(b,c,p),c.experimental_prefetchInRender&&!lo&&wN(p,s)){const x=u?_g(c,d,i):(y=l.getQueryCache().get(c.queryHash))==null?void 0:y.promise;x==null||x.catch(ms).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?p:d.trackResult(p)}function Ls(e,t){return jN(e,rN)}function qc(e,t){const n=uo(),[s]=_.useState(()=>new uN(n,e));_.useEffect(()=>{s.setOptions(e)},[s,e]);const i=_.useSyncExternalStore(_.useCallback(c=>s.subscribe(Tn.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=_.useCallback((c,u)=>{s.mutate(c,u).catch(ms)},[s]);if(i.error&&rg(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}function CN(e){let t;const n=new Set,s=(p,h)=>{const f=typeof p=="function"?p(t):p;if(f!==t){const g=t;t=h?f:Object.assign({},t,f),n.forEach(b=>b(t,g))}},i=()=>t,l=(p,h=i,f=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let g=h(t);function b(){const w=h(t);if(!f(g,w)){const y=g;p(g=w,y)}}return n.add(b),()=>n.delete(b)},d={setState:s,getState:i,subscribe:(p,h,f)=>h||f?l(p,h,f):(n.add(p),()=>n.delete(p)),destroy:()=>n.clear()};return t=e(s,i,d),d}const vg=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?_.useEffect:_.useLayoutEffect;function SN(e){const t=typeof e=="function"?CN(e):e,n=(s=t.getState,i=Object.is)=>{const[,l]=_.useReducer(x=>x+1,0),c=t.getState(),u=_.useRef(c),d=_.useRef(s),p=_.useRef(i),h=_.useRef(!1),f=_.useRef();f.current===void 0&&(f.current=s(c));let g,b=!1;(u.current!==c||d.current!==s||p.current!==i||h.current)&&(g=s(c),b=!i(f.current,g)),vg(()=>{b&&(f.current=g),u.current=c,d.current=s,p.current=i,h.current=!1});const w=_.useRef(c);vg(()=>{const x=()=>{try{const E=t.getState(),S=d.current(E);p.current(f.current,S)||(u.current=E,f.current=S,l())}catch{h.current=!0,l()}},N=t.subscribe(x);return t.getState()!==w.current&&x(),N},[]);const y=b?g:f.current;return _.useDebugValue(y),y};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[n,t];return{next(){const i=s.length<=0;return{value:s.shift(),done:i}}}},n}function EN(){const e=_.createContext(void 0);return{Provider:({initialStore:i,createStore:l,children:c})=>{const u=_.useRef();return u.current||(i&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),l||(l=()=>i)),u.current=l()),_.createElement(e.Provider,{value:u.current},c)},useStore:(i,l=Object.is)=>{const c=_.useContext(e);if(!c)throw new Error("Seems like you have not used zustand provider as an ancestor.");return c(i,l)},useStoreApi:()=>{const i=_.useContext(e);if(!i)throw new Error("Seems like you have not used zustand provider as an ancestor.");return _.useMemo(()=>({getState:i.getState,setState:i.setState,subscribe:i.subscribe,destroy:i.destroy}),[i])}}}var kN={value:()=>{}};function Hc(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new Vc(n)}function Vc(e){this._=e}function MN(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",i=n.indexOf(".");if(i>=0&&(s=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}Vc.prototype=Hc.prototype={constructor:Vc,on:function(e,t){var n=this._,s=MN(e+"",n),i,l=-1,c=s.length;if(arguments.length<2){for(;++l<c;)if((i=(e=s[l]).type)&&(i=AN(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<c;)if(i=(e=s[l]).type)n[i]=yg(n[i],e.name,t);else if(t==null)for(i in n)n[i]=yg(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Vc(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),s=0,i,l;s<i;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],s=0,i=l.length;s<i;++s)l[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],i=0,l=s.length;i<l;++i)s[i].value.apply(t,n)}};function AN(e,t){for(var n=0,s=e.length,i;n<s;++n)if((i=e[n]).name===t)return i.value}function yg(e,t,n){for(var s=0,i=e.length;s<i;++s)if(e[s].name===t){e[s]=kN,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var Nm="http://www.w3.org/1999/xhtml";const bg={svg:"http://www.w3.org/2000/svg",xhtml:Nm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Wc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),bg.hasOwnProperty(t)?{space:bg[t],local:e}:e}function ON(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Nm&&t.documentElement.namespaceURI===Nm?t.createElement(e):t.createElementNS(n,e)}}function TN(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xg(e){var t=Wc(e);return(t.local?TN:ON)(t)}function $N(){}function jm(e){return e==null?$N:function(){return this.querySelector(e)}}function PN(e){typeof e!="function"&&(e=jm(e));for(var t=this._groups,n=t.length,s=new Array(n),i=0;i<n;++i)for(var l=t[i],c=l.length,u=s[i]=new Array(c),d,p,h=0;h<c;++h)(d=l[h])&&(p=e.call(d,d.__data__,h,l))&&("__data__"in d&&(p.__data__=d.__data__),u[h]=p);return new zs(s,this._parents)}function RN(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function LN(){return[]}function wg(e){return e==null?LN:function(){return this.querySelectorAll(e)}}function zN(e){return function(){return RN(e.apply(this,arguments))}}function DN(e){typeof e=="function"?e=zN(e):e=wg(e);for(var t=this._groups,n=t.length,s=[],i=[],l=0;l<n;++l)for(var c=t[l],u=c.length,d,p=0;p<u;++p)(d=c[p])&&(s.push(e.call(d,d.__data__,p,c)),i.push(d));return new zs(s,i)}function Ng(e){return function(){return this.matches(e)}}function jg(e){return function(t){return t.matches(e)}}var FN=Array.prototype.find;function IN(e){return function(){return FN.call(this.children,e)}}function BN(){return this.firstElementChild}function UN(e){return this.select(e==null?BN:IN(typeof e=="function"?e:jg(e)))}var qN=Array.prototype.filter;function HN(){return Array.from(this.children)}function VN(e){return function(){return qN.call(this.children,e)}}function WN(e){return this.selectAll(e==null?HN:VN(typeof e=="function"?e:jg(e)))}function KN(e){typeof e!="function"&&(e=Ng(e));for(var t=this._groups,n=t.length,s=new Array(n),i=0;i<n;++i)for(var l=t[i],c=l.length,u=s[i]=[],d,p=0;p<c;++p)(d=l[p])&&e.call(d,d.__data__,p,l)&&u.push(d);return new zs(s,this._parents)}function Cg(e){return new Array(e.length)}function YN(){return new zs(this._enter||this._groups.map(Cg),this._parents)}function Kc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Kc.prototype={constructor:Kc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function GN(e){return function(){return e}}function QN(e,t,n,s,i,l){for(var c=0,u,d=t.length,p=l.length;c<p;++c)(u=t[c])?(u.__data__=l[c],s[c]=u):n[c]=new Kc(e,l[c]);for(;c<d;++c)(u=t[c])&&(i[c]=u)}function XN(e,t,n,s,i,l,c){var u,d,p=new Map,h=t.length,f=l.length,g=new Array(h),b;for(u=0;u<h;++u)(d=t[u])&&(g[u]=b=c.call(d,d.__data__,u,t)+"",p.has(b)?i[u]=d:p.set(b,d));for(u=0;u<f;++u)b=c.call(e,l[u],u,l)+"",(d=p.get(b))?(s[u]=d,d.__data__=l[u],p.delete(b)):n[u]=new Kc(e,l[u]);for(u=0;u<h;++u)(d=t[u])&&p.get(g[u])===d&&(i[u]=d)}function JN(e){return e.__data__}function ZN(e,t){if(!arguments.length)return Array.from(this,JN);var n=t?XN:QN,s=this._parents,i=this._groups;typeof e!="function"&&(e=GN(e));for(var l=i.length,c=new Array(l),u=new Array(l),d=new Array(l),p=0;p<l;++p){var h=s[p],f=i[p],g=f.length,b=ej(e.call(h,h&&h.__data__,p,s)),w=b.length,y=u[p]=new Array(w),x=c[p]=new Array(w),N=d[p]=new Array(g);n(h,f,y,x,N,b,t);for(var E=0,S=0,j,C;E<w;++E)if(j=y[E]){for(E>=S&&(S=E+1);!(C=x[S])&&++S<w;);j._next=C||null}}return c=new zs(c,s),c._enter=u,c._exit=d,c}function ej(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function tj(){return new zs(this._exit||this._groups.map(Cg),this._parents)}function nj(e,t,n){var s=this.enter(),i=this,l=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?l.remove():n(l),s&&i?s.merge(i).order():i}function sj(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,i=n.length,l=s.length,c=Math.min(i,l),u=new Array(i),d=0;d<c;++d)for(var p=n[d],h=s[d],f=p.length,g=u[d]=new Array(f),b,w=0;w<f;++w)(b=p[w]||h[w])&&(g[w]=b);for(;d<i;++d)u[d]=n[d];return new zs(u,this._parents)}function rj(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],i=s.length-1,l=s[i],c;--i>=0;)(c=s[i])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function aj(e){e||(e=oj);function t(f,g){return f&&g?e(f.__data__,g.__data__):!f-!g}for(var n=this._groups,s=n.length,i=new Array(s),l=0;l<s;++l){for(var c=n[l],u=c.length,d=i[l]=new Array(u),p,h=0;h<u;++h)(p=c[h])&&(d[h]=p);d.sort(t)}return new zs(i,this._parents).order()}function oj(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function ij(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function lj(){return Array.from(this)}function cj(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],i=0,l=s.length;i<l;++i){var c=s[i];if(c)return c}return null}function uj(){let e=0;for(const t of this)++e;return e}function dj(){return!this.node()}function mj(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var i=t[n],l=0,c=i.length,u;l<c;++l)(u=i[l])&&e.call(u,u.__data__,l,i);return this}function hj(e){return function(){this.removeAttribute(e)}}function fj(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pj(e,t){return function(){this.setAttribute(e,t)}}function gj(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function _j(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function vj(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function yj(e,t){var n=Wc(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?fj:hj:typeof t=="function"?n.local?vj:_j:n.local?gj:pj)(n,t))}function Sg(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function bj(e){return function(){this.style.removeProperty(e)}}function xj(e,t,n){return function(){this.style.setProperty(e,t,n)}}function wj(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function Nj(e,t,n){return arguments.length>1?this.each((t==null?bj:typeof t=="function"?wj:xj)(e,t,n??"")):ui(this.node(),e)}function ui(e,t){return e.style.getPropertyValue(t)||Sg(e).getComputedStyle(e,null).getPropertyValue(t)}function jj(e){return function(){delete this[e]}}function Cj(e,t){return function(){this[e]=t}}function Sj(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Ej(e,t){return arguments.length>1?this.each((t==null?jj:typeof t=="function"?Sj:Cj)(e,t)):this.node()[e]}function Eg(e){return e.trim().split(/^|\s+/)}function Cm(e){return e.classList||new kg(e)}function kg(e){this._node=e,this._names=Eg(e.getAttribute("class")||"")}kg.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Mg(e,t){for(var n=Cm(e),s=-1,i=t.length;++s<i;)n.add(t[s])}function Ag(e,t){for(var n=Cm(e),s=-1,i=t.length;++s<i;)n.remove(t[s])}function kj(e){return function(){Mg(this,e)}}function Mj(e){return function(){Ag(this,e)}}function Aj(e,t){return function(){(t.apply(this,arguments)?Mg:Ag)(this,e)}}function Oj(e,t){var n=Eg(e+"");if(arguments.length<2){for(var s=Cm(this.node()),i=-1,l=n.length;++i<l;)if(!s.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Aj:t?kj:Mj)(n,t))}function Tj(){this.textContent=""}function $j(e){return function(){this.textContent=e}}function Pj(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Rj(e){return arguments.length?this.each(e==null?Tj:(typeof e=="function"?Pj:$j)(e)):this.node().textContent}function Lj(){this.innerHTML=""}function zj(e){return function(){this.innerHTML=e}}function Dj(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Fj(e){return arguments.length?this.each(e==null?Lj:(typeof e=="function"?Dj:zj)(e)):this.node().innerHTML}function Ij(){this.nextSibling&&this.parentNode.appendChild(this)}function Bj(){return this.each(Ij)}function Uj(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qj(){return this.each(Uj)}function Hj(e){var t=typeof e=="function"?e:xg(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Vj(){return null}function Wj(e,t){var n=typeof e=="function"?e:xg(e),s=t==null?Vj:typeof t=="function"?t:jm(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function Kj(){var e=this.parentNode;e&&e.removeChild(this)}function Yj(){return this.each(Kj)}function Gj(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Qj(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Xj(e){return this.select(e?Qj:Gj)}function Jj(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Zj(e){return function(t){e.call(this,t,this.__data__)}}function eC(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function tC(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,i=t.length,l;n<i;++n)l=t[n],(!e.type||l.type===e.type)&&l.name===e.name?this.removeEventListener(l.type,l.listener,l.options):t[++s]=l;++s?t.length=s:delete this.__on}}}function nC(e,t,n){return function(){var s=this.__on,i,l=Zj(t);if(s){for(var c=0,u=s.length;c<u;++c)if((i=s[c]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=l,i.options=n),i.value=t;return}}this.addEventListener(e.type,l,n),i={type:e.type,name:e.name,value:t,listener:l,options:n},s?s.push(i):this.__on=[i]}}function sC(e,t,n){var s=eC(e+""),i,l=s.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var d=0,p=u.length,h;d<p;++d)for(i=0,h=u[d];i<l;++i)if((c=s[i]).type===h.type&&c.name===h.name)return h.value}return}for(u=t?nC:tC,i=0;i<l;++i)this.each(u(s[i],t,n));return this}function Og(e,t,n){var s=Sg(e),i=s.CustomEvent;typeof i=="function"?i=new i(t,n):(i=s.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function rC(e,t){return function(){return Og(this,e,t)}}function aC(e,t){return function(){return Og(this,e,t.apply(this,arguments))}}function oC(e,t){return this.each((typeof t=="function"?aC:rC)(e,t))}function*iC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],i=0,l=s.length,c;i<l;++i)(c=s[i])&&(yield c)}var Tg=[null];function zs(e,t){this._groups=e,this._parents=t}function hl(){return new zs([[document.documentElement]],Tg)}function lC(){return this}zs.prototype=hl.prototype={constructor:zs,select:PN,selectAll:DN,selectChild:UN,selectChildren:WN,filter:KN,data:ZN,enter:YN,exit:tj,join:nj,merge:sj,selection:lC,order:rj,sort:aj,call:ij,nodes:lj,node:cj,size:uj,empty:dj,each:mj,attr:yj,style:Nj,property:Ej,classed:Oj,text:Rj,html:Fj,raise:Bj,lower:qj,append:Hj,insert:Wj,remove:Yj,clone:Xj,datum:Jj,on:sC,dispatch:oC,[Symbol.iterator]:iC};function ur(e){return typeof e=="string"?new zs([[document.querySelector(e)]],[document.documentElement]):new zs([[e]],Tg)}function cC(e){let t;for(;t=e.sourceEvent;)e=t;return e}function jr(e,t){if(e=cC(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const uC={passive:!1},fl={capture:!0,passive:!1};function Sm(e){e.stopImmediatePropagation()}function di(e){e.preventDefault(),e.stopImmediatePropagation()}function $g(e){var t=e.document.documentElement,n=ur(e).on("dragstart.drag",di,fl);"onselectstart"in t?n.on("selectstart.drag",di,fl):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Pg(e,t){var n=e.document.documentElement,s=ur(e).on("dragstart.drag",null);t&&(s.on("click.drag",di,fl),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Yc=e=>()=>e;function Em(e,{sourceEvent:t,subject:n,target:s,identifier:i,active:l,x:c,y:u,dx:d,dy:p,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:p,enumerable:!0,configurable:!0},_:{value:h}})}Em.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function dC(e){return!e.ctrlKey&&!e.button}function mC(){return this.parentNode}function hC(e,t){return t??{x:e.x,y:e.y}}function fC(){return navigator.maxTouchPoints||"ontouchstart"in this}function pC(){var e=dC,t=mC,n=hC,s=fC,i={},l=Hc("start","drag","end"),c=0,u,d,p,h,f=0;function g(j){j.on("mousedown.drag",b).filter(s).on("touchstart.drag",x).on("touchmove.drag",N,uC).on("touchend.drag touchcancel.drag",E).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function b(j,C){if(!(h||!e.call(this,j,C))){var k=S(this,t.call(this,j,C),j,C,"mouse");k&&(ur(j.view).on("mousemove.drag",w,fl).on("mouseup.drag",y,fl),$g(j.view),Sm(j),p=!1,u=j.clientX,d=j.clientY,k("start",j))}}function w(j){if(di(j),!p){var C=j.clientX-u,k=j.clientY-d;p=C*C+k*k>f}i.mouse("drag",j)}function y(j){ur(j.view).on("mousemove.drag mouseup.drag",null),Pg(j.view,p),di(j),i.mouse("end",j)}function x(j,C){if(e.call(this,j,C)){var k=j.changedTouches,O=t.call(this,j,C),R=k.length,P,$;for(P=0;P<R;++P)($=S(this,O,j,C,k[P].identifier,k[P]))&&(Sm(j),$("start",j,k[P]))}}function N(j){var C=j.changedTouches,k=C.length,O,R;for(O=0;O<k;++O)(R=i[C[O].identifier])&&(di(j),R("drag",j,C[O]))}function E(j){var C=j.changedTouches,k=C.length,O,R;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),O=0;O<k;++O)(R=i[C[O].identifier])&&(Sm(j),R("end",j,C[O]))}function S(j,C,k,O,R,P){var $=l.copy(),A=jr(P||k,C),D,V,z;if((z=n.call(j,new Em("beforestart",{sourceEvent:k,target:g,identifier:R,active:c,x:A[0],y:A[1],dx:0,dy:0,dispatch:$}),O))!=null)return D=z.x-A[0]||0,V=z.y-A[1]||0,function F(q,G,W){var X=A,I;switch(q){case"start":i[R]=F,I=c++;break;case"end":delete i[R],--c;case"drag":A=jr(W||G,C),I=c;break}$.call(q,j,new Em(q,{sourceEvent:G,subject:z,target:g,identifier:R,active:I,x:A[0]+D,y:A[1]+V,dx:A[0]-X[0],dy:A[1]-X[1],dispatch:$}),O)}}return g.filter=function(j){return arguments.length?(e=typeof j=="function"?j:Yc(!!j),g):e},g.container=function(j){return arguments.length?(t=typeof j=="function"?j:Yc(j),g):t},g.subject=function(j){return arguments.length?(n=typeof j=="function"?j:Yc(j),g):n},g.touchable=function(j){return arguments.length?(s=typeof j=="function"?j:Yc(!!j),g):s},g.on=function(){var j=l.on.apply(l,arguments);return j===l?g:j},g.clickDistance=function(j){return arguments.length?(f=(j=+j)*j,g):Math.sqrt(f)},g}function km(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Rg(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function pl(){}var gl=.7,Gc=1/gl,mi="\\s*([+-]?\\d+)\\s*",_l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Cr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gC=/^#([0-9a-f]{3,8})$/,_C=new RegExp(`^rgb\\(${mi},${mi},${mi}\\)$`),vC=new RegExp(`^rgb\\(${Cr},${Cr},${Cr}\\)$`),yC=new RegExp(`^rgba\\(${mi},${mi},${mi},${_l}\\)$`),bC=new RegExp(`^rgba\\(${Cr},${Cr},${Cr},${_l}\\)$`),xC=new RegExp(`^hsl\\(${_l},${Cr},${Cr}\\)$`),wC=new RegExp(`^hsla\\(${_l},${Cr},${Cr},${_l}\\)$`),Lg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};km(pl,vl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:zg,formatHex:zg,formatHex8:NC,formatHsl:jC,formatRgb:Dg,toString:Dg});function zg(){return this.rgb().formatHex()}function NC(){return this.rgb().formatHex8()}function jC(){return qg(this).formatHsl()}function Dg(){return this.rgb().formatRgb()}function vl(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=gC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fg(t):n===3?new bs(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Qc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Qc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=_C.exec(e))?new bs(t[1],t[2],t[3],1):(t=vC.exec(e))?new bs(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=yC.exec(e))?Qc(t[1],t[2],t[3],t[4]):(t=bC.exec(e))?Qc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=xC.exec(e))?Ug(t[1],t[2]/100,t[3]/100,1):(t=wC.exec(e))?Ug(t[1],t[2]/100,t[3]/100,t[4]):Lg.hasOwnProperty(e)?Fg(Lg[e]):e==="transparent"?new bs(NaN,NaN,NaN,0):null}function Fg(e){return new bs(e>>16&255,e>>8&255,e&255,1)}function Qc(e,t,n,s){return s<=0&&(e=t=n=NaN),new bs(e,t,n,s)}function CC(e){return e instanceof pl||(e=vl(e)),e?(e=e.rgb(),new bs(e.r,e.g,e.b,e.opacity)):new bs}function Mm(e,t,n,s){return arguments.length===1?CC(e):new bs(e,t,n,s??1)}function bs(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}km(bs,Mm,Rg(pl,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new bs(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?gl:Math.pow(gl,e),new bs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new bs(mo(this.r),mo(this.g),mo(this.b),Xc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ig,formatHex:Ig,formatHex8:SC,formatRgb:Bg,toString:Bg}));function Ig(){return`#${ho(this.r)}${ho(this.g)}${ho(this.b)}`}function SC(){return`#${ho(this.r)}${ho(this.g)}${ho(this.b)}${ho((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bg(){const e=Xc(this.opacity);return`${e===1?"rgb(":"rgba("}${mo(this.r)}, ${mo(this.g)}, ${mo(this.b)}${e===1?")":`, ${e})`}`}function Xc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function mo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ho(e){return e=mo(e),(e<16?"0":"")+e.toString(16)}function Ug(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new dr(e,t,n,s)}function qg(e){if(e instanceof dr)return new dr(e.h,e.s,e.l,e.opacity);if(e instanceof pl||(e=vl(e)),!e)return new dr;if(e instanceof dr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,i=Math.min(t,n,s),l=Math.max(t,n,s),c=NaN,u=l-i,d=(l+i)/2;return u?(t===l?c=(n-s)/u+(n<s)*6:n===l?c=(s-t)/u+2:c=(t-n)/u+4,u/=d<.5?l+i:2-l-i,c*=60):u=d>0&&d<1?0:c,new dr(c,u,d,e.opacity)}function EC(e,t,n,s){return arguments.length===1?qg(e):new dr(e,t,n,s??1)}function dr(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}km(dr,EC,Rg(pl,{brighter(e){return e=e==null?Gc:Math.pow(Gc,e),new dr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?gl:Math.pow(gl,e),new dr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,i=2*n-s;return new bs(Am(e>=240?e-240:e+120,i,s),Am(e,i,s),Am(e<120?e+240:e-120,i,s),this.opacity)},clamp(){return new dr(Hg(this.h),Jc(this.s),Jc(this.l),Xc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xc(this.opacity);return`${e===1?"hsl(":"hsla("}${Hg(this.h)}, ${Jc(this.s)*100}%, ${Jc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Hg(e){return e=(e||0)%360,e<0?e+360:e}function Jc(e){return Math.max(0,Math.min(1,e||0))}function Am(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Vg=e=>()=>e;function kC(e,t){return function(n){return e+n*t}}function MC(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function AC(e){return(e=+e)==1?Wg:function(t,n){return n-t?MC(t,n,e):Vg(isNaN(t)?n:t)}}function Wg(e,t){var n=t-e;return n?kC(e,n):Vg(isNaN(e)?t:e)}const Kg=function e(t){var n=AC(t);function s(i,l){var c=n((i=Mm(i)).r,(l=Mm(l)).r),u=n(i.g,l.g),d=n(i.b,l.b),p=Wg(i.opacity,l.opacity);return function(h){return i.r=c(h),i.g=u(h),i.b=d(h),i.opacity=p(h),i+""}}return s.gamma=e,s}(1);function _a(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Om=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Tm=new RegExp(Om.source,"g");function OC(e){return function(){return e}}function TC(e){return function(t){return e(t)+""}}function $C(e,t){var n=Om.lastIndex=Tm.lastIndex=0,s,i,l,c=-1,u=[],d=[];for(e=e+"",t=t+"";(s=Om.exec(e))&&(i=Tm.exec(t));)(l=i.index)>n&&(l=t.slice(n,l),u[c]?u[c]+=l:u[++c]=l),(s=s[0])===(i=i[0])?u[c]?u[c]+=i:u[++c]=i:(u[++c]=null,d.push({i:c,x:_a(s,i)})),n=Tm.lastIndex;return n<t.length&&(l=t.slice(n),u[c]?u[c]+=l:u[++c]=l),u.length<2?d[0]?TC(d[0].x):OC(t):(t=d.length,function(p){for(var h=0,f;h<t;++h)u[(f=d[h]).i]=f.x(p);return u.join("")})}var Yg=180/Math.PI,$m={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Gg(e,t,n,s,i,l){var c,u,d;return(c=Math.sqrt(e*e+t*t))&&(e/=c,t/=c),(d=e*n+t*s)&&(n-=e*d,s-=t*d),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,d/=u),e*s<t*n&&(e=-e,t=-t,d=-d,c=-c),{translateX:i,translateY:l,rotate:Math.atan2(t,e)*Yg,skewX:Math.atan(d)*Yg,scaleX:c,scaleY:u}}var Zc;function PC(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?$m:Gg(t.a,t.b,t.c,t.d,t.e,t.f)}function RC(e){return e==null||(Zc||(Zc=document.createElementNS("http://www.w3.org/2000/svg","g")),Zc.setAttribute("transform",e),!(e=Zc.transform.baseVal.consolidate()))?$m:(e=e.matrix,Gg(e.a,e.b,e.c,e.d,e.e,e.f))}function Qg(e,t,n,s){function i(p){return p.length?p.pop()+" ":""}function l(p,h,f,g,b,w){if(p!==f||h!==g){var y=b.push("translate(",null,t,null,n);w.push({i:y-4,x:_a(p,f)},{i:y-2,x:_a(h,g)})}else(f||g)&&b.push("translate("+f+t+g+n)}function c(p,h,f,g){p!==h?(p-h>180?h+=360:h-p>180&&(p+=360),g.push({i:f.push(i(f)+"rotate(",null,s)-2,x:_a(p,h)})):h&&f.push(i(f)+"rotate("+h+s)}function u(p,h,f,g){p!==h?g.push({i:f.push(i(f)+"skewX(",null,s)-2,x:_a(p,h)}):h&&f.push(i(f)+"skewX("+h+s)}function d(p,h,f,g,b,w){if(p!==f||h!==g){var y=b.push(i(b)+"scale(",null,",",null,")");w.push({i:y-4,x:_a(p,f)},{i:y-2,x:_a(h,g)})}else(f!==1||g!==1)&&b.push(i(b)+"scale("+f+","+g+")")}return function(p,h){var f=[],g=[];return p=e(p),h=e(h),l(p.translateX,p.translateY,h.translateX,h.translateY,f,g),c(p.rotate,h.rotate,f,g),u(p.skewX,h.skewX,f,g),d(p.scaleX,p.scaleY,h.scaleX,h.scaleY,f,g),p=h=null,function(b){for(var w=-1,y=g.length,x;++w<y;)f[(x=g[w]).i]=x.x(b);return f.join("")}}}var LC=Qg(PC,"px, ","px)","deg)"),zC=Qg(RC,", ",")",")"),DC=1e-12;function Xg(e){return((e=Math.exp(e))+1/e)/2}function FC(e){return((e=Math.exp(e))-1/e)/2}function IC(e){return((e=Math.exp(2*e))-1)/(e+1)}const BC=function e(t,n,s){function i(l,c){var u=l[0],d=l[1],p=l[2],h=c[0],f=c[1],g=c[2],b=h-u,w=f-d,y=b*b+w*w,x,N;if(y<DC)N=Math.log(g/p)/t,x=function(O){return[u+O*b,d+O*w,p*Math.exp(t*O*N)]};else{var E=Math.sqrt(y),S=(g*g-p*p+s*y)/(2*p*n*E),j=(g*g-p*p-s*y)/(2*g*n*E),C=Math.log(Math.sqrt(S*S+1)-S),k=Math.log(Math.sqrt(j*j+1)-j);N=(k-C)/t,x=function(O){var R=O*N,P=Xg(C),$=p/(n*E)*(P*IC(t*R+C)-FC(C));return[u+$*b,d+$*w,p*P/Xg(t*R+C)]}}return x.duration=N*1e3*t/Math.SQRT2,x}return i.rho=function(l){var c=Math.max(.001,+l),u=c*c,d=u*u;return e(c,u,d)},i}(Math.SQRT2,2,4);var hi=0,yl=0,bl=0,Jg=1e3,eu,xl,tu=0,fo=0,nu=0,wl=typeof performance=="object"&&performance.now?performance:Date,Zg=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Pm(){return fo||(Zg(UC),fo=wl.now()+nu)}function UC(){fo=0}function su(){this._call=this._time=this._next=null}su.prototype=e_.prototype={constructor:su,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Pm():+n)+(t==null?0:+t),!this._next&&xl!==this&&(xl?xl._next=this:eu=this,xl=this),this._call=e,this._time=n,Rm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Rm())}};function e_(e,t,n){var s=new su;return s.restart(e,t,n),s}function qC(){Pm(),++hi;for(var e=eu,t;e;)(t=fo-e._time)>=0&&e._call.call(void 0,t),e=e._next;--hi}function t_(){fo=(tu=wl.now())+nu,hi=yl=0;try{qC()}finally{hi=0,VC(),fo=0}}function HC(){var e=wl.now(),t=e-tu;t>Jg&&(nu-=t,tu=e)}function VC(){for(var e,t=eu,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:eu=n);xl=e,Rm(s)}function Rm(e){if(!hi){yl&&(yl=clearTimeout(yl));var t=e-fo;t>24?(e<1/0&&(yl=setTimeout(t_,e-wl.now()-nu)),bl&&(bl=clearInterval(bl))):(bl||(tu=wl.now(),bl=setInterval(HC,Jg)),hi=1,Zg(t_))}}function n_(e,t,n){var s=new su;return t=t==null?0:+t,s.restart(i=>{s.stop(),e(i+t)},t,n),s}var WC=Hc("start","end","cancel","interrupt"),KC=[],s_=0,r_=1,Lm=2,ru=3,a_=4,zm=5,au=6;function ou(e,t,n,s,i,l){var c=e.__transition;if(!c)e.__transition={};else if(n in c)return;YC(e,n,{name:t,index:s,group:i,on:WC,tween:KC,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:s_})}function Dm(e,t){var n=mr(e,t);if(n.state>s_)throw new Error("too late; already scheduled");return n}function Sr(e,t){var n=mr(e,t);if(n.state>ru)throw new Error("too late; already running");return n}function mr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function YC(e,t,n){var s=e.__transition,i;s[t]=n,n.timer=e_(l,0,n.time);function l(p){n.state=r_,n.timer.restart(c,n.delay,n.time),n.delay<=p&&c(p-n.delay)}function c(p){var h,f,g,b;if(n.state!==r_)return d();for(h in s)if(b=s[h],b.name===n.name){if(b.state===ru)return n_(c);b.state===a_?(b.state=au,b.timer.stop(),b.on.call("interrupt",e,e.__data__,b.index,b.group),delete s[h]):+h<t&&(b.state=au,b.timer.stop(),b.on.call("cancel",e,e.__data__,b.index,b.group),delete s[h])}if(n_(function(){n.state===ru&&(n.state=a_,n.timer.restart(u,n.delay,n.time),u(p))}),n.state=Lm,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Lm){for(n.state=ru,i=new Array(g=n.tween.length),h=0,f=-1;h<g;++h)(b=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++f]=b);i.length=f+1}}function u(p){for(var h=p<n.duration?n.ease.call(null,p/n.duration):(n.timer.restart(d),n.state=zm,1),f=-1,g=i.length;++f<g;)i[f].call(e,h);n.state===zm&&(n.on.call("end",e,e.__data__,n.index,n.group),d())}function d(){n.state=au,n.timer.stop(),delete s[t];for(var p in s)return;delete e.__transition}}function iu(e,t){var n=e.__transition,s,i,l=!0,c;if(n){t=t==null?null:t+"";for(c in n){if((s=n[c]).name!==t){l=!1;continue}i=s.state>Lm&&s.state<zm,s.state=au,s.timer.stop(),s.on.call(i?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[c]}l&&delete e.__transition}}function GC(e){return this.each(function(){iu(this,e)})}function QC(e,t){var n,s;return function(){var i=Sr(this,e),l=i.tween;if(l!==n){s=n=l;for(var c=0,u=s.length;c<u;++c)if(s[c].name===t){s=s.slice(),s.splice(c,1);break}}i.tween=s}}function XC(e,t,n){var s,i;if(typeof n!="function")throw new Error;return function(){var l=Sr(this,e),c=l.tween;if(c!==s){i=(s=c).slice();for(var u={name:t,value:n},d=0,p=i.length;d<p;++d)if(i[d].name===t){i[d]=u;break}d===p&&i.push(u)}l.tween=i}}function JC(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=mr(this.node(),n).tween,i=0,l=s.length,c;i<l;++i)if((c=s[i]).name===e)return c.value;return null}return this.each((t==null?QC:XC)(n,e,t))}function Fm(e,t,n){var s=e._id;return e.each(function(){var i=Sr(this,s);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return mr(i,s).value[t]}}function o_(e,t){var n;return(typeof t=="number"?_a:t instanceof vl?Kg:(n=vl(t))?(t=n,Kg):$C)(e,t)}function ZC(e){return function(){this.removeAttribute(e)}}function eS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function tS(e,t,n){var s,i=n+"",l;return function(){var c=this.getAttribute(e);return c===i?null:c===s?l:l=t(s=c,n)}}function nS(e,t,n){var s,i=n+"",l;return function(){var c=this.getAttributeNS(e.space,e.local);return c===i?null:c===s?l:l=t(s=c,n)}}function sS(e,t,n){var s,i,l;return function(){var c,u=n(this),d;return u==null?void this.removeAttribute(e):(c=this.getAttribute(e),d=u+"",c===d?null:c===s&&d===i?l:(i=d,l=t(s=c,u)))}}function rS(e,t,n){var s,i,l;return function(){var c,u=n(this),d;return u==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),d=u+"",c===d?null:c===s&&d===i?l:(i=d,l=t(s=c,u)))}}function aS(e,t){var n=Wc(e),s=n==="transform"?zC:o_;return this.attrTween(e,typeof t=="function"?(n.local?rS:sS)(n,s,Fm(this,"attr."+e,t)):t==null?(n.local?eS:ZC)(n):(n.local?nS:tS)(n,s,t))}function oS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function iS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function lS(e,t){var n,s;function i(){var l=t.apply(this,arguments);return l!==s&&(n=(s=l)&&iS(e,l)),n}return i._value=t,i}function cS(e,t){var n,s;function i(){var l=t.apply(this,arguments);return l!==s&&(n=(s=l)&&oS(e,l)),n}return i._value=t,i}function uS(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=Wc(e);return this.tween(n,(s.local?lS:cS)(s,t))}function dS(e,t){return function(){Dm(this,e).delay=+t.apply(this,arguments)}}function mS(e,t){return t=+t,function(){Dm(this,e).delay=t}}function hS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?dS:mS)(t,e)):mr(this.node(),t).delay}function fS(e,t){return function(){Sr(this,e).duration=+t.apply(this,arguments)}}function pS(e,t){return t=+t,function(){Sr(this,e).duration=t}}function gS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?fS:pS)(t,e)):mr(this.node(),t).duration}function _S(e,t){if(typeof t!="function")throw new Error;return function(){Sr(this,e).ease=t}}function vS(e){var t=this._id;return arguments.length?this.each(_S(t,e)):mr(this.node(),t).ease}function yS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Sr(this,e).ease=n}}function bS(e){if(typeof e!="function")throw new Error;return this.each(yS(this._id,e))}function xS(e){typeof e!="function"&&(e=Ng(e));for(var t=this._groups,n=t.length,s=new Array(n),i=0;i<n;++i)for(var l=t[i],c=l.length,u=s[i]=[],d,p=0;p<c;++p)(d=l[p])&&e.call(d,d.__data__,p,l)&&u.push(d);return new Ir(s,this._parents,this._name,this._id)}function wS(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,i=n.length,l=Math.min(s,i),c=new Array(s),u=0;u<l;++u)for(var d=t[u],p=n[u],h=d.length,f=c[u]=new Array(h),g,b=0;b<h;++b)(g=d[b]||p[b])&&(f[b]=g);for(;u<s;++u)c[u]=t[u];return new Ir(c,this._parents,this._name,this._id)}function NS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function jS(e,t,n){var s,i,l=NS(t)?Dm:Sr;return function(){var c=l(this,e),u=c.on;u!==s&&(i=(s=u).copy()).on(t,n),c.on=i}}function CS(e,t){var n=this._id;return arguments.length<2?mr(this.node(),n).on.on(e):this.each(jS(n,e,t))}function SS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function ES(){return this.on("end.remove",SS(this._id))}function kS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=jm(e));for(var s=this._groups,i=s.length,l=new Array(i),c=0;c<i;++c)for(var u=s[c],d=u.length,p=l[c]=new Array(d),h,f,g=0;g<d;++g)(h=u[g])&&(f=e.call(h,h.__data__,g,u))&&("__data__"in h&&(f.__data__=h.__data__),p[g]=f,ou(p[g],t,n,g,p,mr(h,n)));return new Ir(l,this._parents,t,n)}function MS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wg(e));for(var s=this._groups,i=s.length,l=[],c=[],u=0;u<i;++u)for(var d=s[u],p=d.length,h,f=0;f<p;++f)if(h=d[f]){for(var g=e.call(h,h.__data__,f,d),b,w=mr(h,n),y=0,x=g.length;y<x;++y)(b=g[y])&&ou(b,t,n,y,g,w);l.push(g),c.push(h)}return new Ir(l,c,t,n)}var AS=hl.prototype.constructor;function OS(){return new AS(this._groups,this._parents)}function TS(e,t){var n,s,i;return function(){var l=ui(this,e),c=(this.style.removeProperty(e),ui(this,e));return l===c?null:l===n&&c===s?i:i=t(n=l,s=c)}}function i_(e){return function(){this.style.removeProperty(e)}}function $S(e,t,n){var s,i=n+"",l;return function(){var c=ui(this,e);return c===i?null:c===s?l:l=t(s=c,n)}}function PS(e,t,n){var s,i,l;return function(){var c=ui(this,e),u=n(this),d=u+"";return u==null&&(d=u=(this.style.removeProperty(e),ui(this,e))),c===d?null:c===s&&d===i?l:(i=d,l=t(s=c,u))}}function RS(e,t){var n,s,i,l="style."+t,c="end."+l,u;return function(){var d=Sr(this,e),p=d.on,h=d.value[l]==null?u||(u=i_(t)):void 0;(p!==n||i!==h)&&(s=(n=p).copy()).on(c,i=h),d.on=s}}function LS(e,t,n){var s=(e+="")=="transform"?LC:o_;return t==null?this.styleTween(e,TS(e,s)).on("end.style."+e,i_(e)):typeof t=="function"?this.styleTween(e,PS(e,s,Fm(this,"style."+e,t))).each(RS(this._id,e)):this.styleTween(e,$S(e,s,t),n).on("end.style."+e,null)}function zS(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function DS(e,t,n){var s,i;function l(){var c=t.apply(this,arguments);return c!==i&&(s=(i=c)&&zS(e,c,n)),s}return l._value=t,l}function FS(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,DS(e,t,n??""))}function IS(e){return function(){this.textContent=e}}function BS(e){return function(){var t=e(this);this.textContent=t??""}}function US(e){return this.tween("text",typeof e=="function"?BS(Fm(this,"text",e)):IS(e==null?"":e+""))}function qS(e){return function(t){this.textContent=e.call(this,t)}}function HS(e){var t,n;function s(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&qS(i)),t}return s._value=e,s}function VS(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,HS(e))}function WS(){for(var e=this._name,t=this._id,n=l_(),s=this._groups,i=s.length,l=0;l<i;++l)for(var c=s[l],u=c.length,d,p=0;p<u;++p)if(d=c[p]){var h=mr(d,t);ou(d,e,n,p,c,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Ir(s,this._parents,e,n)}function KS(){var e,t,n=this,s=n._id,i=n.size();return new Promise(function(l,c){var u={value:c},d={value:function(){--i===0&&l()}};n.each(function(){var p=Sr(this,s),h=p.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(d)),p.on=t}),i===0&&l()})}var YS=0;function Ir(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function l_(){return++YS}var Br=hl.prototype;Ir.prototype={constructor:Ir,select:kS,selectAll:MS,selectChild:Br.selectChild,selectChildren:Br.selectChildren,filter:xS,merge:wS,selection:OS,transition:WS,call:Br.call,nodes:Br.nodes,node:Br.node,size:Br.size,empty:Br.empty,each:Br.each,on:CS,attr:aS,attrTween:uS,style:LS,styleTween:FS,text:US,textTween:VS,remove:ES,tween:JC,delay:hS,duration:gS,ease:vS,easeVarying:bS,end:KS,[Symbol.iterator]:Br[Symbol.iterator]};function GS(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var QS={time:null,delay:0,duration:250,ease:GS};function XS(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function JS(e){var t,n;e instanceof Ir?(t=e._id,e=e._name):(t=l_(),(n=QS).time=Pm(),e=e==null?null:e+"");for(var s=this._groups,i=s.length,l=0;l<i;++l)for(var c=s[l],u=c.length,d,p=0;p<u;++p)(d=c[p])&&ou(d,e,t,p,c,n||XS(d,t));return new Ir(s,this._parents,e,t)}hl.prototype.interrupt=GC,hl.prototype.transition=JS;const lu=e=>()=>e;function ZS(e,{sourceEvent:t,target:n,transform:s,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function Ur(e,t,n){this.k=e,this.x=t,this.y=n}Ur.prototype={constructor:Ur,scale:function(e){return e===1?this:new Ur(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ur(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var po=new Ur(1,0,0);Ur.prototype;function Im(e){e.stopImmediatePropagation()}function Nl(e){e.preventDefault(),e.stopImmediatePropagation()}function eE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function tE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function c_(){return this.__zoom||po}function nE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function sE(){return navigator.maxTouchPoints||"ontouchstart"in this}function rE(e,t,n){var s=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],l=e.invertY(t[0][1])-n[0][1],c=e.invertY(t[1][1])-n[1][1];return e.translate(i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i),c>l?(l+c)/2:Math.min(0,l)||Math.max(0,c))}function aE(){var e=eE,t=tE,n=rE,s=nE,i=sE,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=BC,p=Hc("start","zoom","end"),h,f,g,b=500,w=150,y=0,x=10;function N(z){z.property("__zoom",c_).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",$).filter(i).on("touchstart.zoom",A).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",V).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}N.transform=function(z,F,q,G){var W=z.selection?z.selection():z;W.property("__zoom",c_),z!==W?C(z,F,q,G):W.interrupt().each(function(){k(this,arguments).event(G).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},N.scaleBy=function(z,F,q,G){N.scaleTo(z,function(){var W=this.__zoom.k,X=typeof F=="function"?F.apply(this,arguments):F;return W*X},q,G)},N.scaleTo=function(z,F,q,G){N.transform(z,function(){var W=t.apply(this,arguments),X=this.__zoom,I=q==null?j(W):typeof q=="function"?q.apply(this,arguments):q,L=X.invert(I),U=typeof F=="function"?F.apply(this,arguments):F;return n(S(E(X,U),I,L),W,c)},q,G)},N.translateBy=function(z,F,q,G){N.transform(z,function(){return n(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof q=="function"?q.apply(this,arguments):q),t.apply(this,arguments),c)},null,G)},N.translateTo=function(z,F,q,G,W){N.transform(z,function(){var X=t.apply(this,arguments),I=this.__zoom,L=G==null?j(X):typeof G=="function"?G.apply(this,arguments):G;return n(po.translate(L[0],L[1]).scale(I.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof q=="function"?-q.apply(this,arguments):-q),X,c)},G,W)};function E(z,F){return F=Math.max(l[0],Math.min(l[1],F)),F===z.k?z:new Ur(F,z.x,z.y)}function S(z,F,q){var G=F[0]-q[0]*z.k,W=F[1]-q[1]*z.k;return G===z.x&&W===z.y?z:new Ur(z.k,G,W)}function j(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function C(z,F,q,G){z.on("start.zoom",function(){k(this,arguments).event(G).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(G).end()}).tween("zoom",function(){var W=this,X=arguments,I=k(W,X).event(G),L=t.apply(W,X),U=q==null?j(L):typeof q=="function"?q.apply(W,X):q,te=Math.max(L[1][0]-L[0][0],L[1][1]-L[0][1]),K=W.__zoom,H=typeof F=="function"?F.apply(W,X):F,Y=d(K.invert(U).concat(te/K.k),H.invert(U).concat(te/H.k));return function(Q){if(Q===1)Q=H;else{var ne=Y(Q),J=te/ne[2];Q=new Ur(J,U[0]-ne[0]*J,U[1]-ne[1]*J)}I.zoom(null,Q)}})}function k(z,F,q){return!q&&z.__zooming||new O(z,F)}function O(z,F){this.that=z,this.args=F,this.active=0,this.sourceEvent=null,this.extent=t.apply(z,F),this.taps=0}O.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,F){return this.mouse&&z!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var F=ur(this.that).datum();p.call(z,this.that,new ZS(z,{sourceEvent:this.sourceEvent,target:N,transform:this.that.__zoom,dispatch:p}),F)}};function R(z,...F){if(!e.apply(this,arguments))return;var q=k(this,F).event(z),G=this.__zoom,W=Math.max(l[0],Math.min(l[1],G.k*Math.pow(2,s.apply(this,arguments)))),X=jr(z);if(q.wheel)(q.mouse[0][0]!==X[0]||q.mouse[0][1]!==X[1])&&(q.mouse[1]=G.invert(q.mouse[0]=X)),clearTimeout(q.wheel);else{if(G.k===W)return;q.mouse=[X,G.invert(X)],iu(this),q.start()}Nl(z),q.wheel=setTimeout(I,w),q.zoom("mouse",n(S(E(G,W),q.mouse[0],q.mouse[1]),q.extent,c));function I(){q.wheel=null,q.end()}}function P(z,...F){if(g||!e.apply(this,arguments))return;var q=z.currentTarget,G=k(this,F,!0).event(z),W=ur(z.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",te,!0),X=jr(z,q),I=z.clientX,L=z.clientY;$g(z.view),Im(z),G.mouse=[X,this.__zoom.invert(X)],iu(this),G.start();function U(K){if(Nl(K),!G.moved){var H=K.clientX-I,Y=K.clientY-L;G.moved=H*H+Y*Y>y}G.event(K).zoom("mouse",n(S(G.that.__zoom,G.mouse[0]=jr(K,q),G.mouse[1]),G.extent,c))}function te(K){W.on("mousemove.zoom mouseup.zoom",null),Pg(K.view,G.moved),Nl(K),G.event(K).end()}}function $(z,...F){if(e.apply(this,arguments)){var q=this.__zoom,G=jr(z.changedTouches?z.changedTouches[0]:z,this),W=q.invert(G),X=q.k*(z.shiftKey?.5:2),I=n(S(E(q,X),G,W),t.apply(this,F),c);Nl(z),u>0?ur(this).transition().duration(u).call(C,I,G,z):ur(this).call(N.transform,I,G,z)}}function A(z,...F){if(e.apply(this,arguments)){var q=z.touches,G=q.length,W=k(this,F,z.changedTouches.length===G).event(z),X,I,L,U;for(Im(z),I=0;I<G;++I)L=q[I],U=jr(L,this),U=[U,this.__zoom.invert(U),L.identifier],W.touch0?!W.touch1&&W.touch0[2]!==U[2]&&(W.touch1=U,W.taps=0):(W.touch0=U,X=!0,W.taps=1+!!h);h&&(h=clearTimeout(h)),X&&(W.taps<2&&(f=U[0],h=setTimeout(function(){h=null},b)),iu(this),W.start())}}function D(z,...F){if(this.__zooming){var q=k(this,F).event(z),G=z.changedTouches,W=G.length,X,I,L,U;for(Nl(z),X=0;X<W;++X)I=G[X],L=jr(I,this),q.touch0&&q.touch0[2]===I.identifier?q.touch0[0]=L:q.touch1&&q.touch1[2]===I.identifier&&(q.touch1[0]=L);if(I=q.that.__zoom,q.touch1){var te=q.touch0[0],K=q.touch0[1],H=q.touch1[0],Y=q.touch1[1],Q=(Q=H[0]-te[0])*Q+(Q=H[1]-te[1])*Q,ne=(ne=Y[0]-K[0])*ne+(ne=Y[1]-K[1])*ne;I=E(I,Math.sqrt(Q/ne)),L=[(te[0]+H[0])/2,(te[1]+H[1])/2],U=[(K[0]+Y[0])/2,(K[1]+Y[1])/2]}else if(q.touch0)L=q.touch0[0],U=q.touch0[1];else return;q.zoom("touch",n(S(I,L,U),q.extent,c))}}function V(z,...F){if(this.__zooming){var q=k(this,F).event(z),G=z.changedTouches,W=G.length,X,I;for(Im(z),g&&clearTimeout(g),g=setTimeout(function(){g=null},b),X=0;X<W;++X)I=G[X],q.touch0&&q.touch0[2]===I.identifier?delete q.touch0:q.touch1&&q.touch1[2]===I.identifier&&delete q.touch1;if(q.touch1&&!q.touch0&&(q.touch0=q.touch1,delete q.touch1),q.touch0)q.touch0[1]=this.__zoom.invert(q.touch0[0]);else if(q.end(),q.taps===2&&(I=jr(I,this),Math.hypot(f[0]-I[0],f[1]-I[1])<x)){var L=ur(this).on("dblclick.zoom");L&&L.apply(this,arguments)}}}return N.wheelDelta=function(z){return arguments.length?(s=typeof z=="function"?z:lu(+z),N):s},N.filter=function(z){return arguments.length?(e=typeof z=="function"?z:lu(!!z),N):e},N.touchable=function(z){return arguments.length?(i=typeof z=="function"?z:lu(!!z),N):i},N.extent=function(z){return arguments.length?(t=typeof z=="function"?z:lu([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),N):t},N.scaleExtent=function(z){return arguments.length?(l[0]=+z[0],l[1]=+z[1],N):[l[0],l[1]]},N.translateExtent=function(z){return arguments.length?(c[0][0]=+z[0][0],c[1][0]=+z[1][0],c[0][1]=+z[0][1],c[1][1]=+z[1][1],N):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},N.constrain=function(z){return arguments.length?(n=z,N):n},N.duration=function(z){return arguments.length?(u=+z,N):u},N.interpolate=function(z){return arguments.length?(d=z,N):d},N.on=function(){var z=p.on.apply(p,arguments);return z===p?N:z},N.clickDistance=function(z){return arguments.length?(y=(z=+z)*z,N):Math.sqrt(y)},N.tapDistance=function(z){return arguments.length?(x=+z,N):x},N}function Tt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Bm(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function u_(e,t){if(e){if(typeof e=="string")return Bm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bm(e,t)}}function oE(e){if(Array.isArray(e))return e}function iE(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s=[],i=!0,l=!1,c,u;try{for(n=n.call(e);!(i=(c=n.next()).done)&&(s.push(c.value),!(t&&s.length===t));i=!0);}catch(d){l=!0,u=d}finally{try{!i&&n.return!=null&&n.return()}finally{if(l)throw u}}return s}}function lE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wt(e,t){return oE(e)||iE(e,t)||u_(e,t)||lE()}var go;(function(e){e.Strict="strict",e.Loose="loose"})(go||(go={}));var fi;(function(e){e.Lines="lines",e.Dots="dots"})(fi||(fi={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var va;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(va||(va={}));var cu;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(cu||(cu={}));var Te;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Te||(Te={}));var Um=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},gi=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),s)},d_=function(t,n){return{x:gi(t.x,n[0][0],n[1][0]),y:gi(t.y,n[0][1],n[1][1])}},m_=function(t){var n,s;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((s=window)===null||s===void 0?void 0:s.document)},cE=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},uu=function(t){var n=t.x,s=t.y,i=t.width,l=t.height;return{x:n,y:s,x2:n+i,y2:s+l}},uE=function(t){var n=t.x,s=t.y,i=t.x2,l=t.y2;return{x:n,y:s,width:i-n,height:l-s}},h_=function(t){return!isNaN(t)&&isFinite(t)},Wn=Symbol("internals");function f_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function jl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?f_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function p_(e,t){var n=e.find(function(p){return p.id===t.parentNode});if(n){var s=t.position.x+t.width-n.width,i=t.position.y+t.height-n.height;if(s>0||i>0||t.position.x<0||t.position.y<0){var l,c;if(n.style=jl({},n.style)||{},n.style.width=(l=n.style.width)!==null&&l!==void 0?l:n.width,n.style.height=(c=n.style.height)!==null&&c!==void 0?c:n.height,s>0&&(n.style.width+=s),i>0&&(n.style.height+=i),t.position.x<0){var u=Math.abs(t.position.x);n.position.x=n.position.x-u,n.style.width+=u,t.position.x=0}if(t.position.y<0){var d=Math.abs(t.position.y);n.position.y=n.position.y-d,n.style.height+=d,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function g_(e,t){if(e.some(function(s){return s.type==="reset"}))return e.filter(function(s){return s.type==="reset"}).map(function(s){return s.item});var n=e.filter(function(s){return s.type==="add"}).map(function(s){return s.item});return t.reduce(function(s,i){var l=e.find(function(d){return d.id===i.id});if(l)switch(l.type){case"select":return s.push(jl(jl({},i),{},{selected:l.selected})),s;case"position":{var c=jl({},i);return typeof l.position<"u"&&(c.position=l.position),typeof l.positionAbsolute<"u"&&(c.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(c.dragging=l.dragging),c.expandParent&&p_(s,c),s.push(c),s}case"dimensions":{var u=jl({},i);return typeof l.dimensions<"u"&&(u.width=l.dimensions.width,u.height=l.dimensions.height),u.expandParent&&p_(s,u),s.push(u),s}case"remove":return s}return s.push(i),s},n)}function __(e,t){return g_(e,t)}function dE(e,t){return g_(e,t)}var ya=function(t,n){return{id:t,type:"select",selected:n}};function _i(e,t){return e.reduce(function(n,s){var i=t.includes(s.id);return!s.selected&&i?(s.selected=!0,n.push(ya(s.id,!0))):s.selected&&!i&&(s.selected=!1,n.push(ya(s.id,!1))),n},[])}function v_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function y_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?v_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var b_=function(t,n,s){var i=n.querySelectorAll(t);if(!i||!i.length)return null;var l=Array.from(i),c=n.getBoundingClientRect();return l.map(function(u){var d=u.getBoundingClientRect();return y_({id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(d.left-c.left)/s,y:(d.top-c.top)/s},Um(u))})};function Cl(e,t,n){return n===void 0?n:function(s){var i=t().nodeInternals.get(e);n(s,y_({},i))}}function x_(e){var t=e.id,n=e.store,s=n.getState(),i=s.addSelectedNodes,l=s.unselectNodesAndEdges,c=s.multiSelectionActive,u=s.nodeInternals,d=u.get(t);n.setState({nodesSelectionActive:!1}),d.selected?d.selected&&c&&l({nodes:[d]}):i([t])}function w_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Sl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?w_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var mE=function(t){return"id"in t&&"source"in t&&"target"in t},hE=function(t){var n=t.source,s=t.sourceHandle,i=t.target,l=t.targetHandle;return"reactflow__edge-".concat(n).concat(s||"","-").concat(i).concat(l||"")},qm=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var s=n?"".concat(n,"__"):"";return"".concat(s).concat(Object.keys(t).sort().map(function(i){return"".concat(i,"=").concat(t[i])}).join("&"))},fE=function(t,n){return n.some(function(s){return s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)})},N_=function(t,n){if(!t.source||!t.target)return n;var s;return mE(t)?s=Sl({},t):s=Sl(Sl({},t),{},{id:hE(t)}),fE(s,n)?n:n.concat(s)},j_=function(t,n,s,i){var l=t.x,c=t.y,u=wt(n,3),d=u[0],p=u[1],h=u[2],f=wt(i,2),g=f[0],b=f[1],w={x:(l-d)/h,y:(c-p)/h};return s?{x:g*Math.round(w.x/g),y:b*Math.round(w.y/b)}:w},Hm=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(s,i){var l=i.positionAbsolute,c=i.position,u=i.width,d=i.height;return cE(s,uu({x:l?l.x:c.x,y:l?l.y:c.y,width:u||0,height:d||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return uE(n)},C_=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],i=wt(s,3),l=i[0],c=i[1],u=i[2],d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,p=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,h=uu({x:(n.x-l)/u,y:(n.y-c)/u,width:n.width/u,height:n.height/u}),f=[];return t.forEach(function(g){var b=g.positionAbsolute,w=g.width,y=g.height,x=g.selectable,N=x===void 0?!0:x;if(p&&!N)return!1;var E=uu(Sl(Sl({},b),{},{width:w||0,height:y||0})),S=Math.max(0,Math.min(h.x2,E.x2)-Math.max(h.x,E.x)),j=Math.max(0,Math.min(h.y2,E.y2)-Math.max(h.y,E.y)),C=Math.ceil(S*j),k=typeof w>"u"||typeof y>"u"||w===null||y===null,O=d&&C>0,R=(w||0)*(y||0),P=k||O||C>=R;P&&f.push(g)}),f},S_=function(t,n){var s=t.map(function(i){return i.id});return n.filter(function(i){return s.includes(i.source)||s.includes(i.target)})},E_=function(t,n,s,i,l){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,u=n/(t.width*(1+c)),d=s/(t.height*(1+c)),p=Math.min(u,d),h=gi(p,i,l),f=t.x+t.width/2,g=t.y+t.height/2,b=n/2-f*h,w=s/2-g*h;return[b,w,h]},_o=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function k_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function vi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function M_(e,t,n,s){var i,l,c,u,d,p,h,f,g,b,w,y;if(!e.parentNode)return s;var x=t.get(e.parentNode);return M_(x,t,n,{x:((i=s.x)!==null&&i!==void 0?i:0)+((l=(c=x.position)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0),y:((u=s.y)!==null&&u!==void 0?u:0)+((d=(p=x.position)===null||p===void 0?void 0:p.y)!==null&&d!==void 0?d:0),z:((h=(f=x[Wn])===null||f===void 0?void 0:f.z)!==null&&h!==void 0?h:0)>((g=s.z)!==null&&g!==void 0?g:0)?(b=(w=x[Wn])===null||w===void 0?void 0:w.z)!==null&&b!==void 0?b:0:(y=s.z)!==null&&y!==void 0?y:0})}function Vm(e,t){var n=new Map,s={};return e.forEach(function(i){var l,c=h_(i.zIndex)?i.zIndex:i.selected?1e3:0,u=t.get(i.id),d=vi(vi({width:u==null?void 0:u.width,height:u==null?void 0:u.height},i),{},{positionAbsolute:{x:i.position.x,y:i.position.y}});i.parentNode&&(d.parentNode=i.parentNode,s[i.parentNode]=!0),Object.defineProperty(d,Wn,{enumerable:!1,value:{handleBounds:u==null||(l=u[Wn])===null||l===void 0?void 0:l.handleBounds,z:c}}),n.set(i.id,d)}),n.forEach(function(i){if(i.parentNode&&!n.has(i.parentNode))throw new Error("Parent node ".concat(i.parentNode," not found"));if(i.parentNode||s[i.id]){var l,c,u=M_(i,n,s,vi(vi({},i.position),{},{z:(l=(c=i[Wn])===null||c===void 0?void 0:c.z)!==null&&l!==void 0?l:0})),d=u.x,p=u.y,h=u.z;i.positionAbsolute={x:d,y:p},i[Wn].z=h,s[i.id]&&(i[Wn].isParent=!0)}}),n}function A_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),s=n.nodeInternals,i=n.width,l=n.height,c=n.minZoom,u=n.maxZoom,d=n.d3Zoom,p=n.d3Selection,h=n.fitViewOnInitDone,f=n.fitViewOnInit;if((t.initial&&!h&&f||!t.initial)&&d&&p){var g=Array.from(s.values()).filter(function(R){return t.includeHiddenNodes?R.width&&R.height:!R.hidden}),b=g.every(function(R){return R.width&&R.height});if(g.length>0&&b){var w,y,x,N=Hm(g),E=E_(N,i,l,(w=t.minZoom)!==null&&w!==void 0?w:c,(y=t.maxZoom)!==null&&y!==void 0?y:u,(x=t.padding)!==null&&x!==void 0?x:.1),S=wt(E,3),j=S[0],C=S[1],k=S[2],O=po.translate(j,C).scale(k);return typeof t.duration=="number"&&t.duration>0?d.transform(_o(p,t.duration),O):d.transform(p,O),!0}}return!1}function pE(e,t){return e.forEach(function(n){var s=t.get(n.id);if(s){var i;t.set(s.id,vi(vi({},s),{},(i={},Tt(i,Wn,s[Wn]),Tt(i,"selected",n.selected),i)))}}),new Map(t)}function gE(e,t){return t.map(function(n){var s=e.find(function(i){return i.id===n.id});return s&&(n.selected=s.selected),n})}function du(e){var t=e.changedNodes,n=e.changedEdges,s=e.get,i=e.set,l=s(),c=l.nodeInternals,u=l.edges,d=l.onNodesChange,p=l.onEdgesChange,h=l.hasDefaultNodes,f=l.hasDefaultEdges;t!=null&&t.length&&(h&&i({nodeInternals:pE(t,c)}),d==null||d(t)),n!=null&&n.length&&(f&&i({edges:gE(n,u)}),p==null||p(n))}var Wm=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],O_={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Wm,nodeExtent:Wm,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:go.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function T_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Er(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?T_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Km=EN(),$_=Km.Provider,Nn=Km.useStore,ss=Km.useStoreApi,P_=function(){return SN(function(t,n){return Er(Er({},O_),{},{setNodes:function(i){t({nodeInternals:Vm(i,n().nodeInternals)})},setEdges:function(i){var l=n(),c=l.defaultEdgeOptions,u=c===void 0?{}:c;t({edges:i.map(function(d){return Er(Er({},u),d)})})},setDefaultNodesAndEdges:function(i,l){var c=typeof i<"u",u=typeof l<"u",d=c?Vm(i,new Map):new Map,p=u?l:[];t({nodeInternals:d,edges:p,hasDefaultNodes:c,hasDefaultEdges:u})},updateNodeDimensions:function(i){var l=n(),c=l.onNodesChange,u=l.nodeInternals,d=l.fitViewOnInit,p=l.fitViewOnInitDone,h=l.fitViewOnInitOptions,f=l.domNode,g=f==null?void 0:f.querySelector(".react-flow__viewport");if(g){var b=window.getComputedStyle(g),w=new window.DOMMatrixReadOnly(b.transform),y=w.m22,x=i.reduce(function(E,S){var j=u.get(S.id);if(j){var C=Um(S.nodeElement),k=!!(C.width&&C.height&&(j.width!==C.width||j.height!==C.height||S.forceUpdate));k&&(u.set(j.id,Er(Er({},j),{},Tt({},Wn,Er(Er({},j[Wn]),{},{handleBounds:{source:b_(".source",S.nodeElement,y),target:b_(".target",S.nodeElement,y)}})),C)),E.push({id:j.id,type:"dimensions",dimensions:C}))}return E},[]),N=p||d&&!p&&A_(n,Er({initial:!0},h));t({nodeInternals:new Map(u),fitViewOnInitDone:N}),(x==null?void 0:x.length)>0&&(c==null||c(x))}},updateNodePositions:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=n(),d=u.onNodesChange,p=u.nodeInternals,h=u.hasDefaultNodes;if(h||d){var f=i.map(function(w){var y={id:w.id,type:"position",dragging:c};return l&&(y.positionAbsolute=w.positionAbsolute,y.position=w.position),y});if(f!=null&&f.length){if(h){var g=__(f,Array.from(p.values())),b=Vm(g,p);t({nodeInternals:b})}d==null||d(f)}}},addSelectedNodes:function(i){var l=n(),c=l.multiSelectionActive,u=l.nodeInternals,d=l.edges,p,h=null;c?p=i.map(function(f){return ya(f,!0)}):(p=_i(Array.from(u.values()),i),h=_i(d,[])),du({changedNodes:p,changedEdges:h,get:n,set:t})},addSelectedEdges:function(i){var l=n(),c=l.multiSelectionActive,u=l.edges,d=l.nodeInternals,p,h=null;c?p=i.map(function(f){return ya(f,!0)}):(p=_i(u,i),h=_i(Array.from(d.values()),[])),du({changedNodes:h,changedEdges:p,get:n,set:t})},unselectNodesAndEdges:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=i.nodes,c=i.edges,u=n(),d=u.nodeInternals,p=u.edges,h=l||Array.from(d.values()),f=c||p,g=h.map(function(w){return w.selected=!1,ya(w.id,!1)}),b=f.map(function(w){return ya(w.id,!1)});du({changedNodes:g,changedEdges:b,get:n,set:t})},setMinZoom:function(i){var l=n(),c=l.d3Zoom,u=l.maxZoom;c==null||c.scaleExtent([i,u]),t({minZoom:i})},setMaxZoom:function(i){var l=n(),c=l.d3Zoom,u=l.minZoom;c==null||c.scaleExtent([u,i]),t({maxZoom:i})},setTranslateExtent:function(i){var l=n(),c=l.d3Zoom;c==null||c.translateExtent(i),t({translateExtent:i})},resetSelectedElements:function(){var i=n(),l=i.nodeInternals,c=i.edges,u=Array.from(l.values()),d=u.filter(function(h){return h.selected}).map(function(h){return ya(h.id,!1)}),p=c.filter(function(h){return h.selected}).map(function(h){return ya(h.id,!1)});du({changedNodes:d,changedEdges:p,get:n,set:t})},setNodeExtent:function(i){var l=n(),c=l.nodeInternals;c.forEach(function(u){u.positionAbsolute=d_(u.position,i)}),t({nodeExtent:i,nodeInternals:new Map(c)})},reset:function(){return t(Er({},O_))}})})};function Ds(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=Ds(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function Fs(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let s=0;s<n.length;s++)if(!Object.prototype.hasOwnProperty.call(t,n[s])||!Object.is(e[n[s]],t[n[s]]))return!1;return!0}function _E(e){if(Array.isArray(e))return Bm(e)}function vE(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function yE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vo(e){return _E(e)||vE(e)||u_(e)||yE()}var bE={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},xE=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},wE=function(){var t=ss(),n=Nn(xE,Fs),s=n.d3Zoom,i=n.d3Selection,l=_.useMemo(function(){return i&&s?{zoomIn:function(u){return s.scaleBy(_o(i,u==null?void 0:u.duration),1.2)},zoomOut:function(u){return s.scaleBy(_o(i,u==null?void 0:u.duration),1/1.2)},zoomTo:function(u,d){return s.scaleTo(_o(i,d==null?void 0:d.duration),u)},getZoom:function(){return t.getState().transform[2]},setViewport:function(u,d){var p,h,f,g=wt(t.getState().transform,3),b=g[0],w=g[1],y=g[2],x=po.translate((p=u.x)!==null&&p!==void 0?p:b,(h=u.y)!==null&&h!==void 0?h:w).scale((f=u.zoom)!==null&&f!==void 0?f:y);s.transform(_o(i,d==null?void 0:d.duration),x)},getViewport:function(){var u=wt(t.getState().transform,3),d=u[0],p=u[1],h=u[2];return{x:d,y:p,zoom:h}},fitView:function(u){return A_(t.getState,u)},setCenter:function(u,d,p){var h=t.getState(),f=h.width,g=h.height,b=h.maxZoom,w=typeof(p==null?void 0:p.zoom)<"u"?p.zoom:b,y=f/2-u*w,x=g/2-d*w,N=po.translate(y,x).scale(w);s.transform(_o(i,p==null?void 0:p.duration),N)},fitBounds:function(u,d){var p,h=t.getState(),f=h.width,g=h.height,b=h.minZoom,w=h.maxZoom,y=E_(u,f,g,b,w,(p=d==null?void 0:d.padding)!==null&&p!==void 0?p:.1),x=wt(y,3),N=x[0],E=x[1],S=x[2],j=po.translate(N,E).scale(S);s.transform(_o(i,d==null?void 0:d.duration),j)},project:function(u){var d=t.getState(),p=d.transform,h=d.snapToGrid,f=d.snapGrid;return j_(u,p,h,f)},viewportInitialized:!0}:bE},[s,i]);return l};function R_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function yi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?R_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Ym(){var e=wE(),t=ss(),n=_.useCallback(function(){var f=t.getState(),g=f.nodeInternals,b=Array.from(g.values());return b.map(function(w){return yi({},w)})},[]),s=_.useCallback(function(f){var g=t.getState(),b=g.nodeInternals;return b.get(f)},[]),i=_.useCallback(function(){var f=t.getState(),g=f.edges,b=g===void 0?[]:g;return b.map(function(w){return yi({},w)})},[]),l=_.useCallback(function(f){var g=t.getState(),b=g.edges,w=b===void 0?[]:b;return w.find(function(y){return y.id===f})},[]),c=_.useCallback(function(f){var g=t.getState(),b=g.nodeInternals,w=g.setNodes,y=g.hasDefaultNodes,x=g.onNodesChange,N=Array.from(b.values()),E=typeof f=="function"?f(N):f;if(y)w(E);else if(x){var S=E.length===0?N.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});x(S)}},[]),u=_.useCallback(function(f){var g=t.getState(),b=g.edges,w=b===void 0?[]:b,y=g.setEdges,x=g.hasDefaultEdges,N=g.onEdgesChange,E=typeof f=="function"?f(w):f;if(x)y(E);else if(N){var S=E.length===0?w.map(function(j){return{type:"remove",id:j.id}}):E.map(function(j){return{item:j,type:"reset"}});N(S)}},[]),d=_.useCallback(function(f){var g=Array.isArray(f)?f:[f],b=t.getState(),w=b.nodeInternals,y=b.setNodes,x=b.hasDefaultNodes,N=b.onNodesChange;if(x){var E=Array.from(w.values()),S=[].concat(E,vo(g));y(S)}else if(N){var j=g.map(function(C){return{item:C,type:"add"}});N(j)}},[]),p=_.useCallback(function(f){var g=Array.isArray(f)?f:[f],b=t.getState(),w=b.edges,y=w===void 0?[]:w,x=b.setEdges,N=b.hasDefaultEdges,E=b.onEdgesChange;if(N)x([].concat(vo(y),vo(g)));else if(E){var S=g.map(function(j){return{item:j,type:"add"}});E(S)}},[]),h=_.useCallback(function(){var f=t.getState(),g=f.nodeInternals,b=f.edges,w=b===void 0?[]:b,y=f.transform,x=Array.from(g.values()),N=wt(y,3),E=N[0],S=N[1],j=N[2];return{nodes:x.map(function(C){return yi({},C)}),edges:w.map(function(C){return yi({},C)}),viewport:{x:E,y:S,zoom:j}}},[]);return _.useMemo(function(){return yi(yi({},e),{},{getNodes:n,getNode:s,getEdges:i,getEdge:l,setNodes:c,setEdges:u,addNodes:d,addEdges:p,toObject:h})},[e,n,s,i,l,c,u,d,p,h])}function NE(e,t){if(e==null)return{};var n={},s=Object.keys(e),i,l;for(l=0;l<s.length;l++)i=s[l],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function mu(e,t){if(e==null)return{};var n=NE(e,t),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function jE(){return _e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},_e.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function CE(){return _e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},_e.createElement("path",{d:"M0 0h32v4.2H0z"}))}function SE(){return _e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},_e.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function EE(){return _e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},_e.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function kE(){return _e.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},_e.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var ME=["children","className"];function L_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function AE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?L_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var hu=function(t){var n=t.children,s=t.className,i=mu(t,ME);return _e.createElement("button",AE({type:"button",className:Ds(["react-flow__controls-button",s])},i),n)},OE=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},z_=function(t){var n=t.style,s=t.showZoom,i=s===void 0?!0:s,l=t.showFitView,c=l===void 0?!0:l,u=t.showInteractive,d=u===void 0?!0:u,p=t.fitViewOptions,h=t.onZoomIn,f=t.onZoomOut,g=t.onFitView,b=t.onInteractiveChange,w=t.className,y=t.children,x=ss(),N=_.useState(!1),E=wt(N,2),S=E[0],j=E[1],C=Nn(OE),k=Ym(),O=k.zoomIn,R=k.zoomOut,P=k.fitView;if(_.useEffect(function(){j(!0)},[]),!S)return null;var $=function(){O==null||O(),h==null||h()},A=function(){R==null||R(),f==null||f()},D=function(){P==null||P(p),g==null||g()},V=function(){x.setState({nodesDraggable:!C,nodesConnectable:!C,elementsSelectable:!C}),b==null||b(!C)};return _e.createElement("div",{className:Ds(["react-flow__controls",w]),style:n},i&&_e.createElement(_e.Fragment,null,_e.createElement(hu,{onClick:$,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},_e.createElement(jE,null)),_e.createElement(hu,{onClick:A,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},_e.createElement(CE,null))),c&&_e.createElement(hu,{className:"react-flow__controls-fitview",onClick:D,title:"fit view","aria-label":"fit view"},_e.createElement(SE,null)),d&&_e.createElement(hu,{className:"react-flow__controls-interactive",onClick:V,title:"toggle interactivity","aria-label":"toggle interactivity"},C?_e.createElement(kE,null):_e.createElement(EE,null)),y)};z_.displayName="Controls";var TE=_.memo(z_),$E=function(t,n,s){return _e.createElement("path",{stroke:s,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},PE=function(t,n){return _e.createElement("circle",{cx:t,cy:t,r:t,fill:n})},fu;function D_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function F_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var RE=(fu={},Tt(fu,fi.Dots,"#81818a"),Tt(fu,fi.Lines,"#eee"),fu),LE=function(t){return t.transform},I_=function(t){var n=t.variant,s=n===void 0?fi.Dots:n,i=t.gap,l=i===void 0?15:i,c=t.size,u=c===void 0?.4:c,d=t.color,p=t.style,h=t.className,f=_.useRef(null),g=_.useState(null),b=wt(g,2),w=b[0],y=b[1],x=Nn(LE),N=wt(x,3),E=N[0],S=N[1],j=N[2];_.useEffect(function(){var A=document.querySelectorAll(".react-flow__background"),D=Array.from(A).findIndex(function(V){return V===f.current});y("pattern-".concat(D))},[]);var C=l*j||1,k=E%C,O=S%C,R=s===fi.Lines,P=d||RE[s],$=R?$E(C,u,P):PE(u*j,P);return _e.createElement("svg",{className:Ds(["react-flow__background","react-flow__container",h]),style:F_(F_({},p),{},{width:"100%",height:"100%"}),ref:f},w&&_e.createElement(_e.Fragment,null,_e.createElement("pattern",{id:w,x:k,y:O,width:C,height:C,patternUnits:"userSpaceOnUse"},$),_e.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(w,")")})))};I_.displayName="Background";var zE=_.memo(I_),DE=function(t){return t.updateNodeDimensions};function FE(){var e=ss(),t=Nn(DE);return _.useCallback(function(n){var s,i=(s=e.getState().domNode)===null||s===void 0?void 0:s.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));i&&requestAnimationFrame(function(){return t([{id:n,nodeElement:i,forceUpdate:!0}])})},[])}var IE=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function BE(e){var t=e.proOptions,n=e.position,s=n===void 0?"bottom-right":n;if(t!=null&&t.account&&IE.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var i="".concat(s).split("-");return _e.createElement("div",{className:Ds(["react-flow__attribution"].concat(vo(i))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},_e.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var UE=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function B_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function qE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var HE=function(t){var n=t.x,s=t.y,i=t.label,l=t.labelStyle,c=l===void 0?{}:l,u=t.labelShowBg,d=u===void 0?!0:u,p=t.labelBgStyle,h=p===void 0?{}:p,f=t.labelBgPadding,g=f===void 0?[2,4]:f,b=t.labelBgBorderRadius,w=b===void 0?2:b,y=t.children,x=t.className,N=mu(t,UE),E=_.useRef(null),S=_.useState({x:0,y:0,width:0,height:0}),j=wt(S,2),C=j[0],k=j[1],O=Ds(["react-flow__edge-textwrapper",x]);return _.useEffect(function(){if(E.current){var R=E.current.getBBox();k({x:R.x,y:R.y,width:R.width,height:R.height})}},[i]),typeof i>"u"||!i?null:_e.createElement("g",qE({transform:"translate(".concat(n-C.width/2," ").concat(s-C.height/2,")"),className:O},N),d&&_e.createElement("rect",{width:C.width+2*g[0],x:-g[0],y:-g[1],height:C.height+2*g[1],className:"react-flow__edge-textbg",style:h,rx:w,ry:w}),_e.createElement("text",{className:"react-flow__edge-text",y:C.height/2,dy:"0.3em",ref:E,style:c},i),y)},VE=_.memo(HE),pu=function(e){var t=e.path,n=e.centerX,s=e.centerY,i=e.label,l=e.labelStyle,c=e.labelShowBg,u=e.labelBgStyle,d=e.labelBgPadding,p=e.labelBgBorderRadius,h=e.style,f=e.markerEnd,g=e.markerStart,b=i?_e.createElement(VE,{x:n,y:s,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:p}):null;return _e.createElement(_e.Fragment,null,_e.createElement("path",{style:h,d:t,className:"react-flow__edge-path",markerEnd:f,markerStart:g}),b)};function gu(e){var t=e.pos,n=e.x1,s=e.y1,i=e.x2,l=e.y2,c,u;switch(t){case Te.Left:case Te.Right:c=.5*(n+i),u=s;break;case Te.Top:case Te.Bottom:c=n,u=.5*(s+l);break}return[c,u]}function U_(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Te.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Te.Top:u,p=gu({pos:i,x1:t,y1:n,x2:l,y2:c}),h=wt(p,2),f=h[0],g=h[1],b=gu({pos:d,x1:l,y1:c,x2:t,y2:n}),w=wt(b,2),y=w[0],x=w[1];return"M".concat(t,",").concat(n," C").concat(f,",").concat(g," ").concat(y,",").concat(x," ").concat(l,",").concat(c)}function WE(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Te.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Te.Top:u,p=gu({pos:i,x1:t,y1:n,x2:l,y2:c}),h=wt(p,2),f=h[0],g=h[1],b=gu({pos:d,x1:l,y1:c,x2:t,y2:n}),w=wt(b,2),y=w[0],x=w[1],N=t*.125+f*.375+y*.375+l*.125,E=n*.125+g*.375+x*.375+c*.125,S=Math.abs(N-t),j=Math.abs(E-n);return[N,E,S,j]}var q_=_.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.sourcePosition,c=l===void 0?Te.Bottom:l,u=e.targetPosition,d=u===void 0?Te.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,b=e.labelBgPadding,w=e.labelBgBorderRadius,y=e.style,x=e.markerEnd,N=e.markerStart,E={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:i,targetPosition:d},S=U_(E),j=WE(E),C=wt(j,2),k=C[0],O=C[1];return _e.createElement(pu,{path:S,centerX:k,centerY:O,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:b,labelBgBorderRadius:w,style:y,markerEnd:x,markerStart:N})});function H_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function KE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?H_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var V_=[Te.Left,Te.Right],W_=function(t){var n=t.sourceX,s=t.sourceY,i=t.targetX,l=t.targetY,c=t.sourcePosition,u=c===void 0?Te.Bottom:c,d=t.targetPosition,p=d===void 0?Te.Top:d,h=V_.includes(u),f=V_.includes(p),g=h&&!f||f&&!h;if(g){var b=h?Math.abs(i-n):0,w=n>i?n-b:n+b,y=h?0:Math.abs(l-s),x=s<l?s+y:s-y;return[w,x,b,y]}var N=Math.abs(i-n)/2,E=i<n?i+N:i-N,S=Math.abs(l-s)/2,j=l<s?l+S:l-S;return[E,j,N,S]};function El(e,t,n){return n===void 0?n:function(s){var i=t().edges.find(function(l){return l.id===e});n(s,KE({},i))}}var Gm=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},Qm=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},Xm=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},Jm=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},Zm=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)},eh=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},th=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},nh=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)};function sh(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Te.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Te.Top:u,p=e.borderRadius,h=p===void 0?5:p,f=e.centerX,g=e.centerY,b=W_({sourceX:t,sourceY:n,targetX:l,targetY:c}),w=wt(b,4),y=w[0],x=w[1],N=w[2],E=w[3],S=Math.min(h,Math.abs(l-t)),j=Math.min(h,Math.abs(c-n)),C=Math.min(S,j,N,E),k=[Te.Left,Te.Right],O=typeof f<"u"?f:y,R=typeof g<"u"?g:x,P=null,$=null;return t<=l?(P=n<=c?Gm(t,R,C):eh(t,R,C),$=n<=c?nh(l,R,C):Jm(l,R,C)):(P=n<c?Xm(t,R,C):th(t,R,C),$=n<c?Zm(l,R,C):Qm(l,R,C)),k.includes(i)&&k.includes(d)?t<=l?(P=n<=c?nh(O,n,C):Jm(O,n,C),$=n<=c?Gm(O,c,C):eh(O,c,C)):(i===Te.Right&&d===Te.Left||i===Te.Left&&d===Te.Right||i===Te.Left&&d===Te.Left)&&(P=n<=c?Zm(O,n,C):Qm(O,n,C),$=n<=c?Xm(O,c,C):th(O,c,C)):k.includes(i)&&!k.includes(d)?(t<=l?P=n<=c?nh(l,n,C):Jm(l,n,C):P=n<=c?Zm(l,n,C):Qm(l,n,C),$=""):!k.includes(i)&&k.includes(d)&&(t<=l?P=n<=c?Gm(t,c,C):eh(t,c,C):P=n<=c?Xm(t,c,C):th(t,c,C),$=""),"M ".concat(t,",").concat(n).concat(P).concat($,"L ").concat(l,",").concat(c)}var rh=_.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.sourcePosition,b=g===void 0?Te.Bottom:g,w=e.targetPosition,y=w===void 0?Te.Top:w,x=e.markerEnd,N=e.markerStart,E=e.borderRadius,S=E===void 0?5:E,j=W_({sourceX:t,sourceY:n,targetX:s,targetY:i,sourcePosition:b,targetPosition:y}),C=wt(j,2),k=C[0],O=C[1],R=sh({sourceX:t,sourceY:n,sourcePosition:b,targetX:s,targetY:i,targetPosition:y,borderRadius:S});return _e.createElement(pu,{path:R,centerX:k,centerY:O,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:x,markerStart:N})});function K_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Y_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?K_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):K_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var G_=_.memo(function(e){return _e.createElement(rh,Y_(Y_({},e),{},{borderRadius:0}))}),Q_=_.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,p=e.labelBgPadding,h=e.labelBgBorderRadius,f=e.style,g=e.markerEnd,b=e.markerStart,w=Math.abs(i-n)/2,y=i<n?i+w:i-w,x=Math.abs(s-t)/2,N=s<t?s+x:s-x,E="M ".concat(t,",").concat(n,"L ").concat(s,",").concat(i);return _e.createElement(pu,{path:E,centerX:N,centerY:y,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:p,labelBgBorderRadius:h,style:f,markerEnd:g,markerStart:b})});function _u(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function vu(e){var t=e.pos,n=e.x1,s=e.y1,i=e.x2,l=e.y2,c=e.c,u,d;switch(t){case Te.Left:u=n-_u(n-i,c),d=s;break;case Te.Right:u=n+_u(i-n,c),d=s;break;case Te.Top:u=n,d=s-_u(s-l,c);break;case Te.Bottom:u=n,d=s+_u(l-s,c);break}return[u,d]}function X_(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Te.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Te.Top:u,p=e.curvature,h=p===void 0?.25:p,f=vu({pos:i,x1:t,y1:n,x2:l,y2:c,c:h}),g=wt(f,2),b=g[0],w=g[1],y=vu({pos:d,x1:l,y1:c,x2:t,y2:n,c:h}),x=wt(y,2),N=x[0],E=x[1];return"M".concat(t,",").concat(n," C").concat(b,",").concat(w," ").concat(N,",").concat(E," ").concat(l,",").concat(c)}function YE(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Te.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Te.Top:u,p=e.curvature,h=p===void 0?.25:p,f=vu({pos:i,x1:t,y1:n,x2:l,y2:c,c:h}),g=wt(f,2),b=g[0],w=g[1],y=vu({pos:d,x1:l,y1:c,x2:t,y2:n,c:h}),x=wt(y,2),N=x[0],E=x[1],S=t*.125+b*.375+N*.375+l*.125,j=n*.125+w*.375+E*.375+c*.125,C=Math.abs(S-t),k=Math.abs(j-n);return[S,j,C,k]}var ah=_.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.sourcePosition,c=l===void 0?Te.Bottom:l,u=e.targetPosition,d=u===void 0?Te.Top:u,p=e.label,h=e.labelStyle,f=e.labelShowBg,g=e.labelBgStyle,b=e.labelBgPadding,w=e.labelBgBorderRadius,y=e.style,x=e.markerEnd,N=e.markerStart,E=e.curvature,S={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:i,targetPosition:d,curvature:E},j=X_(S),C=YE(S),k=wt(C,2),O=k[0],R=k[1];return _e.createElement(pu,{path:j,centerX:O,centerY:R,label:p,labelStyle:h,labelShowBg:f,labelBgStyle:g,labelBgPadding:b,labelBgBorderRadius:w,style:y,markerEnd:x,markerStart:N})}),oh=_.createContext(null),GE=oh.Provider;oh.Consumer;function ih(e,t,n,s,i,l,c){var u=c.elementFromPoint(e.clientX,e.clientY),d=(u==null?void 0:u.classList.contains("target"))||!1,p=(u==null?void 0:u.classList.contains("source"))||!1,h={elementBelow:u,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(u&&(d||p)){h.isHoveringHandle=!0;var f=u.getAttribute("data-nodeid"),g=u.getAttribute("data-handleid"),b=n?{source:f,sourceHandle:g,target:s,targetHandle:i}:{source:s,sourceHandle:i,target:f,targetHandle:g};h.connection=b;var w=t===go.Strict?n&&p||!n&&d:!0;w&&(h.isValid=l(b))}return h}function lh(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function J_(e){var t=e.event,n=e.handleId,s=e.nodeId,i=e.onConnect,l=e.isTarget,c=e.getState,u=e.setState,d=e.isValidConnection,p=e.elementEdgeUpdaterType,h=e.onEdgeUpdateEnd,f=t.target.closest(".react-flow"),g=m_(t.target);if(!g)return;var b=g.elementFromPoint(t.clientX,t.clientY),w=b==null?void 0:b.classList.contains("target"),y=b==null?void 0:b.classList.contains("source");if(!f||!w&&!y&&!p)return;var x=c(),N=x.onConnectStart,E=x.connectionMode,S=p||(w?"target":"source"),j=f.getBoundingClientRect(),C;u({connectionPosition:{x:t.clientX-j.left,y:t.clientY-j.top},connectionNodeId:s,connectionHandleId:n,connectionHandleType:S}),N==null||N(t,{nodeId:s,handleId:n,handleType:S});function k(R){u({connectionPosition:{x:R.clientX-j.left,y:R.clientY-j.top}});var P=ih(R,E,l,s,n,d,g),$=P.connection,A=P.elementBelow,D=P.isValid,V=P.isHoveringHandle;if(!V)return lh(C);$.source!==$.target&&A&&(lh(C),C=A,A.classList.add("react-flow__handle-connecting"),A.classList.toggle("react-flow__handle-valid",D))}function O(R){var P=c(),$=P.onConnectStop,A=P.onConnectEnd,D=ih(R,E,l,s,n,d,g),V=D.connection,z=D.isValid;$==null||$(R),z&&(i==null||i(V)),A==null||A(R),p&&h&&h(R),lh(C),u({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),g.removeEventListener("mousemove",k),g.removeEventListener("mouseup",O)}g.addEventListener("mousemove",k),g.addEventListener("mouseup",O)}var QE=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function Z_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function ch(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Z_(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Z_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var XE=function(){return!0},JE=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},ev=_.forwardRef(function(e,t){var n=e.type,s=n===void 0?"source":n,i=e.position,l=i===void 0?Te.Top:i,c=e.isValidConnection,u=c===void 0?XE:c,d=e.isConnectable,p=d===void 0?!0:d,h=e.id,f=e.onConnect,g=e.children,b=e.className,w=e.onMouseDown,y=mu(e,QE),x=ss(),N=_.useContext(oh),E=Nn(JE,Fs),S=E.connectionStartHandle,j=E.connectOnClick,C=h||null,k=s==="target",O=function(A){var D=x.getState(),V=D.defaultEdgeOptions,z=D.onConnect,F=D.hasDefaultEdges,q=ch(ch({},V),A);if(F){var G=x.getState(),W=G.edges;x.setState({edges:N_(q,W)})}z==null||z(q),f==null||f(q)},R=function(A){A.button===0&&J_({event:A,handleId:C,nodeId:N,onConnect:O,isTarget:k,getState:x.getState,setState:x.setState,isValidConnection:u}),w==null||w(A)},P=function(A){var D=x.getState(),V=D.onClickConnectStart,z=D.onClickConnectStop,F=D.onClickConnectEnd,q=D.connectionMode;if(!S){V==null||V(A,{nodeId:N,handleId:C,handleType:s}),x.setState({connectionStartHandle:{nodeId:N,type:s,handleId:C}});return}var G=m_(A.target),W=ih(A,q,S.type==="target",S.nodeId,S.handleId||null,u,G),X=W.connection,I=W.isValid;z==null||z(A),I&&O(X),F==null||F(A),x.setState({connectionStartHandle:null})};return _e.createElement("div",ch({"data-handleid":C,"data-nodeid":N,"data-handlepos":l,className:Ds(["react-flow__handle","react-flow__handle-".concat(l),"nodrag",b,{source:!k,target:k,connectable:p,connecting:(S==null?void 0:S.nodeId)===N&&(S==null?void 0:S.handleId)===C&&(S==null?void 0:S.type)===s}]),onMouseDown:R,onClick:j?P:void 0,ref:t},y),g)});ev.displayName="Handle";var kl=_.memo(ev),tv=function(t){var n=t.data,s=t.isConnectable,i=t.targetPosition,l=i===void 0?Te.Top:i,c=t.sourcePosition,u=c===void 0?Te.Bottom:c;return _e.createElement(_e.Fragment,null,_e.createElement(kl,{type:"target",position:l,isConnectable:s}),n==null?void 0:n.label,_e.createElement(kl,{type:"source",position:u,isConnectable:s}))};tv.displayName="DefaultNode";var uh=_.memo(tv),nv=function(t){var n=t.data,s=t.isConnectable,i=t.sourcePosition,l=i===void 0?Te.Bottom:i;return _e.createElement(_e.Fragment,null,n==null?void 0:n.label,_e.createElement(kl,{type:"source",position:l,isConnectable:s}))};nv.displayName="InputNode";var sv=_.memo(nv),rv=function(t){var n=t.data,s=t.isConnectable,i=t.targetPosition,l=i===void 0?Te.Top:i;return _e.createElement(_e.Fragment,null,_e.createElement(kl,{type:"target",position:l,isConnectable:s}),n==null?void 0:n.label)};rv.displayName="OutputNode";var av=_.memo(rv),ZE=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},e1=function(t,n){var s=t.selectedNodes.map(function(u){return u.id}),i=n.selectedNodes.map(function(u){return u.id}),l=t.selectedEdges.map(function(u){return u.id}),c=n.selectedEdges.map(function(u){return u.id});return Fs(s,i)&&Fs(l,c)};function t1(e){var t=e.onSelectionChange,n=Nn(ZE,e1),s=n.selectedNodes,i=n.selectedEdges;return _.useEffect(function(){t({nodes:s,edges:i})},[s,i]),null}var n1=_.memo(t1),s1=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function ba(e,t){_.useEffect(function(){typeof e<"u"&&t(e)},[e])}function Kt(e,t,n){_.useEffect(function(){typeof t<"u"&&n(Tt({},e,t))},[t])}var r1=function(t){var n=t.nodes,s=t.edges,i=t.defaultNodes,l=t.defaultEdges,c=t.onConnect,u=t.onConnectStart,d=t.onConnectStop,p=t.onConnectEnd,h=t.onClickConnectStart,f=t.onClickConnectStop,g=t.onClickConnectEnd,b=t.nodesDraggable,w=t.nodesConnectable,y=t.minZoom,x=t.maxZoom,N=t.nodeExtent,E=t.onNodesChange,S=t.onEdgesChange,j=t.elementsSelectable,C=t.connectionMode,k=t.snapGrid,O=t.snapToGrid,R=t.translateExtent,P=t.connectOnClick,$=t.defaultEdgeOptions,A=t.fitView,D=t.fitViewOptions,V=t.onNodesDelete,z=t.onEdgesDelete,F=t.onNodeDrag,q=t.onNodeDragStart,G=t.onNodeDragStop,W=t.onSelectionDrag,X=t.onSelectionDragStart,I=t.onSelectionDragStop,L=Nn(s1,Fs),U=L.setNodes,te=L.setEdges,K=L.setDefaultNodesAndEdges,H=L.setMinZoom,Y=L.setMaxZoom,Q=L.setTranslateExtent,ne=L.setNodeExtent,J=L.reset,re=ss();return _.useEffect(function(){return K(i,l),function(){J()}},[]),Kt("defaultEdgeOptions",$,re.setState),Kt("connectionMode",C,re.setState),Kt("onConnect",c,re.setState),Kt("onConnectStart",u,re.setState),Kt("onConnectStop",d,re.setState),Kt("onConnectEnd",p,re.setState),Kt("onClickConnectStart",h,re.setState),Kt("onClickConnectStop",f,re.setState),Kt("onClickConnectEnd",g,re.setState),Kt("nodesDraggable",b,re.setState),Kt("nodesConnectable",w,re.setState),Kt("elementsSelectable",j,re.setState),Kt("snapToGrid",O,re.setState),Kt("snapGrid",k,re.setState),Kt("onNodesChange",E,re.setState),Kt("onEdgesChange",S,re.setState),Kt("connectOnClick",P,re.setState),Kt("fitViewOnInit",A,re.setState),Kt("fitViewOnInitOptions",D,re.setState),Kt("onNodesDelete",V,re.setState),Kt("onEdgesDelete",z,re.setState),Kt("onNodeDrag",F,re.setState),Kt("onNodeDragStart",q,re.setState),Kt("onNodeDragStop",G,re.setState),Kt("onSelectionDrag",W,re.setState),Kt("onSelectionDragStart",X,re.setState),Kt("onSelectionDragStop",I,re.setState),ba(n,U),ba(s,te),ba(i,U),ba(l,te),ba(y,H),ba(x,Y),ba(R,Q),ba(N,ne),null},a1=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",o1=a1,i1=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",l1=i1,c1=function(t,n,s){return s===Te.Left?t-n:s===Te.Right?t+n:t},u1=function(t,n,s){return s===Te.Top?t-n:s===Te.Bottom?t+n:t},ov=function(t){var n=t.className,s=t.position,i=t.centerX,l=t.centerY,c=t.radius,u=c===void 0?10:c;return _e.createElement("circle",{className:Ds(["react-flow__edgeupdater",n]),cx:c1(i,u,s),cy:u1(l,u,s),r:u,stroke:"transparent",fill:"transparent"})},bi=function(e){var t=function(s){var i=s.id,l=s.className,c=s.type,u=s.data,d=s.onClick,p=s.onEdgeDoubleClick,h=s.selected,f=s.animated,g=s.label,b=s.labelStyle,w=s.labelShowBg,y=s.labelBgStyle,x=s.labelBgPadding,N=s.labelBgBorderRadius,E=s.style,S=s.source,j=s.target,C=s.sourceX,k=s.sourceY,O=s.targetX,R=s.targetY,P=s.sourcePosition,$=s.targetPosition,A=s.elementsSelectable,D=s.hidden,V=s.sourceHandleId,z=s.targetHandleId,F=s.onContextMenu,q=s.onMouseEnter,G=s.onMouseMove,W=s.onMouseLeave,X=s.edgeUpdaterRadius,I=s.onEdgeUpdate,L=s.onEdgeUpdateStart,U=s.onEdgeUpdateEnd,te=s.markerEnd,K=s.markerStart,H=s.rfId,Y=_.useState(!1),Q=wt(Y,2),ne=Q[0],J=Q[1],re=ss(),Se=function(at){var ct=re.getState(),$t=ct.edges,Dt=ct.addSelectedEdges,Qe=$t.find(function(Ut){return Ut.id===i});A&&(re.setState({nodesSelectionActive:!1}),Dt([i])),d==null||d(at,Qe)},ze=El(i,re.getState,p),$e=El(i,re.getState,F),Be=El(i,re.getState,q),it=El(i,re.getState,G),He=El(i,re.getState,W),de=function(at,ct){var $t=ct?j:S,Dt=(ct?z:V)||null,Qe=ct?"target":"source",Ut=function(){return!0},Yt=ct,Mt=re.getState().edges.find(function(Rt){return Rt.id===i});L==null||L(at,Mt,Qe);var yt=U?function(Rt){return U(Rt,Mt,Qe)}:void 0,jn=function(tn){return I==null?void 0:I(Mt,tn)};J_({event:at,handleId:Dt,nodeId:$t,onConnect:jn,isTarget:Yt,getState:re.getState,setState:re.setState,isValidConnection:Ut,elementEdgeUpdaterType:Qe,onEdgeUpdateEnd:yt})},ge=function(at){return de(at,!0)},Ne=function(at){return de(at,!1)},Me=function(){return J(!0)},Ue=function(){return J(!1)},ce=_.useMemo(function(){return"url(#".concat(qm(K,H),")")},[K,H]),Oe=_.useMemo(function(){return"url(#".concat(qm(te,H),")")},[te,H]);if(D)return null;var Ge=!A&&!d,ut=typeof I<"u",rt=Ds(["react-flow__edge","react-flow__edge-".concat(c),l,{selected:h,animated:f,inactive:Ge,updating:ne}]);return _e.createElement("g",{className:rt,onClick:Se,onDoubleClick:ze,onContextMenu:$e,onMouseEnter:Be,onMouseMove:it,onMouseLeave:He},_e.createElement(e,{id:i,source:S,target:j,selected:h,animated:f,label:g,labelStyle:b,labelShowBg:w,labelBgStyle:y,labelBgPadding:x,labelBgBorderRadius:N,data:u,style:E,sourceX:C,sourceY:k,targetX:O,targetY:R,sourcePosition:P,targetPosition:$,sourceHandleId:V,targetHandleId:z,markerStart:ce,markerEnd:Oe,"data-testid":"rf__edge-".concat(i)}),ut&&_e.createElement("g",{onMouseDown:ge,onMouseEnter:Me,onMouseOut:Ue},_e.createElement(ov,{position:P,centerX:C,centerY:k,radius:X})),ut&&_e.createElement("g",{onMouseDown:Ne,onMouseEnter:Me,onMouseOut:Ue},_e.createElement(ov,{position:$,centerX:O,centerY:R,radius:X})))};return t.displayName="EdgeWrapper",_.memo(t)};function iv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function lv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iv(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function d1(e){var t={default:bi(e.default||ah),straight:bi(e.bezier||Q_),step:bi(e.step||G_),smoothstep:bi(e.step||rh),simplebezier:bi(e.simplebezier||q_)},n={},s=Object.keys(e).filter(function(i){return!["default","bezier"].includes(i)}).reduce(function(i,l){return i[l]=bi(e[l]||ah),i},n);return lv(lv({},t),s)}function cv(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,l=(n==null?void 0:n.width)||t.width,c=(n==null?void 0:n.height)||t.height;switch(e){case Te.Top:return{x:s+l/2,y:i};case Te.Right:return{x:s+l,y:i+c/2};case Te.Bottom:return{x:s+l/2,y:i+c};case Te.Left:return{x:s,y:i+c/2}}}function uv(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(s){return s.id===t})),typeof n>"u"?null:n}var m1=function(t,n,s,i,l,c){var u=cv(s,t,n),d=cv(c,i,l);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y}};function h1(e){var t=e.sourcePos,n=e.targetPos,s=e.sourceWidth,i=e.sourceHeight,l=e.targetWidth,c=e.targetHeight,u=e.width,d=e.height,p=e.transform,h={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+s,n.x+l),y2:Math.max(t.y+i,n.y+c)};h.x===h.x2&&(h.x2+=1),h.y===h.y2&&(h.y2+=1);var f=uu({x:(0-p[0])/p[2],y:(0-p[1])/p[2],width:u/p[2],height:d/p[2]}),g=Math.max(0,Math.min(f.x2,h.x2)-Math.max(f.x,h.x)),b=Math.max(0,Math.min(f.y2,h.y2)-Math.max(f.y,h.y)),w=Math.ceil(g*b);return w>0}function dv(e,t){var n,s,i,l,c,u=e.get(t),d=(u==null||(n=u[Wn])===null||n===void 0?void 0:n.handleBounds)||null,p=!u||!d||!u.width||!u.height||typeof((s=u.positionAbsolute)===null||s===void 0?void 0:s.x)>"u"||typeof((i=u.positionAbsolute)===null||i===void 0?void 0:i.y)>"u";return[{x:(u==null||(l=u.positionAbsolute)===null||l===void 0?void 0:l.x)||0,y:(u==null||(c=u.positionAbsolute)===null||c===void 0?void 0:c.y)||0,width:(u==null?void 0:u.width)||0,height:(u==null?void 0:u.height)||0},d,!p]}var f1=typeof document<"u"?document:null,yu=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:f1},n=_.useState(!1),s=wt(n,2),i=s[0],l=s[1],c=_.useRef(new Set([])),u=_.useMemo(function(){if(e!==null){var f=Array.isArray(e)?e:[e],g=f.filter(function(w){return typeof w=="string"}).map(function(w){return w.split("+")}),b=g.reduce(function(w,y){return w.concat.apply(w,vo(y))},[]);return[g,b]}return[[],[]]},[e]),d=wt(u,2),p=d[0],h=d[1];return _.useEffect(function(){if(e!==null){var f,g,b=function(N){if(fv(N))return!1;var E=hv(N.code,h);c.current.add(N[E]),mv(p,c.current,!1)&&(N.preventDefault(),l(!0))},w=function(N){if(fv(N))return!1;var E=hv(N.code,h);mv(p,c.current,!0)?(l(!1),c.current.clear()):c.current.delete(N[E])},y=function(){c.current.clear(),l(!1)};return t==null||(f=t.target)===null||f===void 0||f.addEventListener("keydown",b),t==null||(g=t.target)===null||g===void 0||g.addEventListener("keyup",w),window.addEventListener("blur",y),function(){var x,N;t==null||(x=t.target)===null||x===void 0||x.removeEventListener("keydown",b),t==null||(N=t.target)===null||N===void 0||N.removeEventListener("keyup",w),window.removeEventListener("blur",y)}}},[e,l]),i};function mv(e,t,n){return e.filter(function(s){return n||s.length===t.size}).some(function(s){return s.every(function(i){return t.has(i)})})}function hv(e,t){return t.includes(e)?"code":"key"}function fv(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var p1=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},g1=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,s=ss(),i=Nn(p1,Fs),l=i.onNodesChange,c=i.onEdgesChange,u=yu(t),d=yu(n);_.useEffect(function(){var p=s.getState(),h=p.nodeInternals,f=p.edges,g=p.hasDefaultNodes,b=p.hasDefaultEdges,w=p.onNodesDelete,y=p.onEdgesDelete,x=Array.from(h.values()),N=x.reduce(function(R,P){return(!P.selected&&P.parentNode&&R.find(function($){return $.id===P.parentNode})||P.selected)&&R.push(P),R},[]),E=f.filter(function(R){return R.selected});if(u&&(N||E)){var S=S_(N,f),j=[].concat(vo(E),vo(S)),C=j.reduce(function(R,P){return R.includes(P.id)||R.push(P.id),R},[]);if((b||g)&&(b&&s.setState({edges:f.filter(function(R){return!C.includes(R.id)})}),g&&(N.forEach(function(R){h.delete(R.id)}),s.setState({nodeInternals:new Map(h)}))),C.length>0&&(y==null||y(j),c)){var k=C.map(function(R){return{id:R,type:"remove"}});c(k)}if(N.length>0&&(w==null||w(N),l)){var O=N.map(function(R){return{id:R.id,type:"remove"}});l(O)}s.setState({nodesSelectionActive:!1})}},[u,l,c]),_.useEffect(function(){s.setState({multiSelectionActive:d})},[d])};function _1(e){var t=ss();_.useEffect(function(){var n,s=function(){if(e.current){var l=Um(e.current);t.setState({width:l.width||500,height:l.height||500})}};return s(),window.onresize=s,e.current&&(n=new ResizeObserver(function(){return s()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var v1=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},dh=function(t){return{x:t.x,y:t.y,zoom:t.k}},bu=function(t,n){return t.target.closest(".".concat(n))},y1=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},b1=function(t){var n=t.onMove,s=t.onMoveStart,i=t.onMoveEnd,l=t.zoomOnScroll,c=l===void 0?!0:l,u=t.zoomOnPinch,d=u===void 0?!0:u,p=t.panOnScroll,h=p===void 0?!1:p,f=t.panOnScrollSpeed,g=f===void 0?.5:f,b=t.panOnScrollMode,w=b===void 0?pi.Free:b,y=t.zoomOnDoubleClick,x=y===void 0?!0:y,N=t.selectionKeyPressed,E=t.elementsSelectable,S=t.panOnDrag,j=S===void 0?!0:S,C=t.translateExtent,k=t.minZoom,O=t.maxZoom,R=t.defaultZoom,P=R===void 0?1:R,$=t.defaultPosition,A=$===void 0?[0,0]:$,D=t.zoomActivationKeyCode,V=t.preventScrolling,z=V===void 0?!0:V,F=t.children,q=t.noWheelClassName,G=t.noPanClassName,W=ss(),X=_.useRef(!1),I=_.useRef(null),L=_.useRef({x:0,y:0,zoom:0}),U=Nn(y1,Fs),te=U.d3Zoom,K=U.d3Selection,H=U.d3ZoomHandler,Y=yu(D);return _1(I),_.useEffect(function(){if(I.current){var Q,ne=aE().scaleExtent([k,O]).translateExtent(C),J=ur(I.current).call(ne),re=gi(A[0],C[0][0],C[1][0]),Se=gi(A[1],C[0][1],C[1][1]),ze=gi(P,k,O),$e=po.translate(re,Se).scale(ze);ne.transform(J,$e),W.setState({d3Zoom:ne,d3Selection:J,d3ZoomHandler:J.on("wheel.zoom"),transform:[re,Se,ze],domNode:(Q=J.node())===null||Q===void 0?void 0:Q.closest(".react-flow")})}},[]),_.useEffect(function(){K&&te&&(h&&!Y?K.on("wheel",function(Q){if(bu(Q,q))return!1;Q.preventDefault(),Q.stopImmediatePropagation();var ne=K.property("__zoom").k||1;if(Q.ctrlKey&&d){var J=jr(Q),re=-Q.deltaY*(Q.deltaMode===1?.05:Q.deltaMode?1:.002)*10,Se=ne*Math.pow(2,re);te.scaleTo(K,Se,J);return}var ze=Q.deltaMode===1?20:1,$e=w===pi.Vertical?0:Q.deltaX*ze,Be=w===pi.Horizontal?0:Q.deltaY*ze;te.translateBy(K,-($e/ne)*g,-(Be/ne)*g)}).on("wheel.zoom",null):typeof H<"u"&&K.on("wheel",function(Q){if(!z||bu(Q,q))return null;Q.preventDefault()}).on("wheel.zoom",H))},[h,w,K,te,H,Y,d,z,q]),_.useEffect(function(){te&&(N&&!X.current?te.on("zoom",null):N||te.on("zoom",function(Q){if(W.setState({transform:[Q.transform.x,Q.transform.y,Q.transform.k]}),n){var ne=dh(Q.transform);n(Q.sourceEvent,ne)}}))},[N,te,n]),_.useEffect(function(){te&&te.on("start",function(Q){if(X.current=!0,s){var ne=dh(Q.transform);L.current=ne,s(Q.sourceEvent,ne)}})},[te,s]),_.useEffect(function(){te&&te.on("end",function(Q){if(X.current=!1,i&&v1(L.current,Q.transform)){var ne=dh(Q.transform);L.current=ne,i(Q.sourceEvent,ne)}})},[te,i]),_.useEffect(function(){te&&te.filter(function(Q){var ne=Y||c,J=d&&Q.ctrlKey;return!j&&!ne&&!h&&!x&&!d||N||!x&&Q.type==="dblclick"||bu(Q,q)&&Q.type==="wheel"||bu(Q,G)&&Q.type!=="wheel"||!d&&Q.ctrlKey&&Q.type==="wheel"||!ne&&!h&&!J&&Q.type==="wheel"||!j&&(Q.type==="mousedown"||Q.type==="touchstart")?!1:(!Q.ctrlKey||Q.type==="wheel")&&!Q.button})},[te,c,d,h,x,j,N,E,Y]),_e.createElement("div",{className:"react-flow__renderer react-flow__container",ref:I},F)};function pv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function gv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pv(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function _v(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var x1=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},vv={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},w1=_.memo(function(e){var t=e.selectionKeyPressed,n=ss(),s=_.useRef(0),i=_.useRef(0),l=_.useRef(),c=_.useState(vv),u=wt(c,2),d=u[0],p=u[1],h=Nn(x1,Fs),f=h.userSelectionActive,g=h.elementsSelectable,b=f||t;if(!g||!b)return null;var w=function(){p(vv),n.setState({userSelectionActive:!1}),s.current=0,i.current=0},y=function(j){var C=j.target.closest(".react-flow");l.current=C.getBoundingClientRect();var k=_v(j,l.current);p({width:0,height:0,startX:k.x,startY:k.y,x:k.x,y:k.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},x=function(j){var C,k;if(!(!t||!d.draw||!l.current)){var O=_v(j,l.current),R=(C=d.startX)!==null&&C!==void 0?C:0,P=(k=d.startY)!==null&&k!==void 0?k:0,$=gv(gv({},d),{},{x:O.x<R?O.x:R,y:O.y<P?O.y:P,width:Math.abs(O.x-R),height:Math.abs(O.y-P)}),A=n.getState(),D=A.nodeInternals,V=A.edges,z=A.transform,F=A.onNodesChange,q=A.onEdgesChange,G=Array.from(D.values()),W=C_(D,$,z,!1,!0),X=S_(W,V).map(function(te){return te.id}),I=W.map(function(te){return te.id});if(s.current!==I.length){s.current=I.length;var L=_i(G,I);L.length&&(F==null||F(L))}if(i.current!==X.length){i.current=X.length;var U=_i(V,X);U.length&&(q==null||q(U))}p($)}},N=function(){n.setState({nodesSelectionActive:s.current>0}),w()},E=function(){n.setState({nodesSelectionActive:!1}),w()};return _e.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:y,onMouseMove:x,onMouseUp:N,onMouseLeave:E},d.draw&&_e.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:d.width,height:d.height,transform:"translate(".concat(d.x,"px, ").concat(d.y,"px)")}}))});function yv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function bv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yv(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function xv(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:xv(n,t):!1}function wv(e,t,n){var s=e;do{var i;if((i=s)!==null&&i!==void 0&&i.matches(t))return!0;if(s===n.current)return!1;s=s.parentElement}while(s);return!1}function N1(e,t,n){return Array.from(e.values()).filter(function(s){return(s.selected||s.id===n)&&(!s.parentNode||!xv(s,e))}).map(function(s){var i,l,c,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:t.x-((i=(l=s.positionAbsolute)===null||l===void 0?void 0:l.x)!==null&&i!==void 0?i:0),y:t.y-((c=(u=s.positionAbsolute)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function j1(e,t,n,s,i,l){var c=wt(s,2),u=c[0],d=c[1],p=e.extent||l,h={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(h.x=u*Math.round(h.x/u),h.y=d*Math.round(h.y/d)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var f=i.get(e.parentNode);p=f!=null&&f.positionAbsolute&&f!==null&&f!==void 0&&f.width&&f!==null&&f!==void 0&&f.height?[[f.positionAbsolute.x,f.positionAbsolute.y],[f.positionAbsolute.x+f.width-e.width,f.positionAbsolute.y+f.height-e.height]]:p}else p=l;else if(e.extent&&e.parentNode){var g,b,w,y,x=i.get(e.parentNode),N=(g=x==null||(b=x.positionAbsolute)===null||b===void 0?void 0:b.x)!==null&&g!==void 0?g:0,E=(w=x==null||(y=x.positionAbsolute)===null||y===void 0?void 0:y.y)!==null&&w!==void 0?w:0;p=[[e.extent[0][0]+N,e.extent[0][1]+E],[e.extent[1][0]+N,e.extent[1][1]+E]]}var S={x:0,y:0};if(e.parentNode){var j,C,k,O,R=i.get(e.parentNode);S={x:(j=R==null||(C=R.positionAbsolute)===null||C===void 0?void 0:C.x)!==null&&j!==void 0?j:0,y:(k=R==null||(O=R.positionAbsolute)===null||O===void 0?void 0:O.y)!==null&&k!==void 0?k:0}}return e.positionAbsolute=p?d_(h,p):h,e.position={x:e.positionAbsolute.x-S.x,y:e.positionAbsolute.y-S.y},e}function mh(e){var t=e.nodeId,n=e.dragItems,s=e.nodeInternals,i=n.map(function(l){var c=s.get(l.id);return bv(bv({},c),{},{position:l.position,positionAbsolute:l.positionAbsolute})});return[t?i.find(function(l){return l.id===t}):i[0],i]}function hh(e){return function(t,n,s){return e==null?void 0:e(t,s)}}function Nv(e){var t=e.nodeRef,n=e.disabled,s=n===void 0?!1:n,i=e.noDragClassName,l=e.handleSelector,c=e.nodeId,u=e.isSelectable,d=e.selectNodesOnDrag,p=_.useState(!1),h=wt(p,2),f=h[0],g=h[1],b=ss(),w=_.useRef(),y=_.useRef({x:null,y:null}),x=_.useCallback(function(N){var E=N.sourceEvent,S=b.getState(),j=S.transform,C=S.snapGrid,k=S.snapToGrid,O=E.touches?E.touches[0].clientX:E.clientX,R=E.touches?E.touches[0].clientY:E.clientY,P=j_({x:O,y:R},j,k,C);return P},[]);return _.useEffect(function(){if(t!=null&&t.current){var N=ur(t.current);if(s)N.on(".drag",null);else{var E=pC().on("start",function(S){var j=b.getState(),C=j.nodeInternals,k=j.multiSelectionActive,O=j.unselectNodesAndEdges,R=j.onNodeDragStart,P=j.onSelectionDragStart,$=c?R:hh(P);if(!d&&!k&&c){var A;(A=C.get(c))!==null&&A!==void 0&&A.selected||O()}c&&u&&d&&x_({id:c,store:b});var D=x(S);if(y.current=D,w.current=N1(C,D,c),$&&w.current){var V=mh({nodeId:c,dragItems:w.current,nodeInternals:C}),z=wt(V,2),F=z[0],q=z[1];$(S.sourceEvent,F,q)}}).on("drag",function(S){var j=b.getState(),C=j.updateNodePositions,k=j.snapToGrid,O=j.snapGrid,R=j.nodeInternals,P=j.nodeExtent,$=j.onNodeDrag,A=j.onSelectionDrag,D=x(S);if((y.current.x!==D.x||y.current.y!==D.y)&&w.current){y.current=D,w.current=w.current.map(function(W){return j1(W,D,k,O,R,P)});var V=c?$:hh(A);if(C(w.current,!0,!0),g(!0),V){var z=mh({nodeId:c,dragItems:w.current,nodeInternals:R}),F=wt(z,2),q=F[0],G=F[1];V(S.sourceEvent,q,G)}}S.on("end",function(W){if(g(!1),w.current){var X=b.getState(),I=X.updateNodePositions,L=X.nodeInternals,U=X.onNodeDragStop,te=X.onSelectionDragStop,K=c?U:hh(te);if(I(w.current,!1,!1),K){var H=mh({nodeId:c,dragItems:w.current,nodeInternals:L}),Y=wt(H,2),Q=Y[0],ne=Y[1];K(W.sourceEvent,Q,ne)}}})}).filter(function(S){var j=S.target,C=!S.button&&(!i||!wv(j,".".concat(i),t))&&(!l||wv(j,l,t));return C});return N.call(E),function(){N.on(".drag",null)}}}},[t,s,i,l,u,b,c,d,x]),f}function jv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function C1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jv(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var S1=function(t){return C1({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},Hm(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},E1=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(s){return s.selected});return Hm(n)};function k1(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,s=ss(),i=Nn(S1,Fs),l=i.transformString,c=i.userSelectionActive,u=Nn(E1,Fs),d=u.width,p=u.height,h=u.x,f=u.y,g=_.useRef(null);if(Nv({nodeRef:g}),c||!d||!p)return null;var b=t?function(w){var y=Array.from(s.getState().nodeInternals.values()).filter(function(x){return x.selected});t(w,y)}:void 0;return _e.createElement("div",{className:Ds(["react-flow__nodesselection","react-flow__container",n]),style:{transform:l}},_e.createElement("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:b,style:{width:d,height:p,top:f,left:h}}))}var M1=_.memo(k1),A1=function(t){return t.nodesSelectionActive},Cv=function(t){var n=t.children,s=t.onPaneClick,i=t.onPaneContextMenu,l=t.onPaneScroll,c=t.deleteKeyCode,u=t.onMove,d=t.onMoveStart,p=t.onMoveEnd,h=t.selectionKeyCode,f=t.multiSelectionKeyCode,g=t.zoomActivationKeyCode,b=t.elementsSelectable,w=t.zoomOnScroll,y=t.zoomOnPinch,x=t.panOnScroll,N=t.panOnScrollSpeed,E=t.panOnScrollMode,S=t.zoomOnDoubleClick,j=t.panOnDrag,C=t.translateExtent,k=t.minZoom,O=t.maxZoom,R=t.defaultZoom,P=t.defaultPosition,$=t.preventScrolling,A=t.onSelectionContextMenu,D=t.noWheelClassName,V=t.noPanClassName,z=ss(),F=Nn(A1),q=yu(h);g1({deleteKeyCode:c,multiSelectionKeyCode:f});var G=function(L){s==null||s(L),z.getState().resetSelectedElements(),z.setState({nodesSelectionActive:!1})},W=i?function(I){return i(I)}:void 0,X=l?function(I){return l(I)}:void 0;return _e.createElement(b1,{onMove:u,onMoveStart:d,onMoveEnd:p,selectionKeyPressed:q,elementsSelectable:b,zoomOnScroll:w,zoomOnPinch:y,panOnScroll:x,panOnScrollSpeed:N,panOnScrollMode:E,zoomOnDoubleClick:S,panOnDrag:j,translateExtent:C,minZoom:k,maxZoom:O,defaultZoom:R,defaultPosition:P,zoomActivationKeyCode:g,preventScrolling:$,noWheelClassName:D,noPanClassName:V},n,_e.createElement(w1,{selectionKeyPressed:q}),F&&_e.createElement(M1,{onSelectionContextMenu:A,noPanClassName:V}),_e.createElement("div",{className:"react-flow__pane react-flow__container",onClick:G,onContextMenu:W,onWheel:X}))};Cv.displayName="FlowRenderer";var O1=_.memo(Cv);function T1(e){var t=Nn(_.useCallback(function(n){return e?C_(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var $1=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},Sv=function(t){var n=Nn($1,Fs),s=n.nodesDraggable,i=n.nodesConnectable,l=n.elementsSelectable,c=n.updateNodeDimensions,u=T1(t.onlyRenderVisibleElements),d=_.useRef(),p=_.useMemo(function(){if(typeof ResizeObserver>"u")return null;var h=new ResizeObserver(function(f){var g=f.map(function(b){return{id:b.target.getAttribute("data-id"),nodeElement:b.target,forceUpdate:!0}});c(g)});return d.current=h,h},[]);return _.useEffect(function(){return function(){var h;d==null||(h=d.current)===null||h===void 0||h.disconnect()}},[]),_e.createElement("div",{className:"react-flow__nodes react-flow__container"},u.map(function(h){var f,g,b,w,y,x,N,E=h.type||"default";t.nodeTypes[E]||(E="default");var S=t.nodeTypes[E]||t.nodeTypes.default,j=!!(h.draggable||s&&typeof h.draggable>"u"),C=!!(h.selectable||l&&typeof h.selectable>"u"),k=!!(h.connectable||i&&typeof h.connectable>"u");return _e.createElement(S,{key:h.id,id:h.id,className:h.className,style:h.style,type:E,data:h.data,sourcePosition:h.sourcePosition||Te.Bottom,targetPosition:h.targetPosition||Te.Top,hidden:h.hidden,xPos:(f=(g=h.positionAbsolute)===null||g===void 0?void 0:g.x)!==null&&f!==void 0?f:0,yPos:(b=(w=h.positionAbsolute)===null||w===void 0?void 0:w.y)!==null&&b!==void 0?b:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!h.selected,isDraggable:j,isSelectable:C,isConnectable:k,resizeObserver:p,dragHandle:h.dragHandle,zIndex:(y=(x=h[Wn])===null||x===void 0?void 0:x.z)!==null&&y!==void 0?y:0,isParent:!!((N=h[Wn])!==null&&N!==void 0&&N.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!h.width&&!!h.height})}))};Sv.displayName="NodeRenderer";var P1=_.memo(Sv),xi;function Ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function kv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ev(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ev(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var R1=(xi={},Tt(xi,Te.Left,Te.Right),Tt(xi,Te.Right,Te.Left),Tt(xi,Te.Top,Te.Bottom),Tt(xi,Te.Bottom,Te.Top),xi),L1=function(e){var t,n,s,i,l,c=e.connectionNodeId,u=e.connectionHandleType,d=e.connectionLineStyle,p=e.connectionLineType,h=p===void 0?va.Bezier:p,f=e.isConnectable,g=e.CustomConnectionLineComponent,b=Nn(_.useCallback(function(X){return{fromNode:X.nodeInternals.get(c),handleId:X.connectionHandleId,toX:(X.connectionPosition.x-X.transform[0])/X.transform[2],toY:(X.connectionPosition.y-X.transform[1])/X.transform[2]}},[c]),Fs),w=b.fromNode,y=b.handleId,x=b.toX,N=b.toY,E=w==null||(t=w[Wn])===null||t===void 0?void 0:t.handleBounds;if(!w||!f||!(E!=null&&E[u]))return null;var S=E[u],j=y?S.find(function(X){return X.id===y}):S[0],C=j?j.x+j.width/2:((n=w==null?void 0:w.width)!==null&&n!==void 0?n:0)/2,k=j?j.y+j.height/2:(s=w==null?void 0:w.height)!==null&&s!==void 0?s:0,O=((w==null||(i=w.positionAbsolute)===null||i===void 0?void 0:i.x)||0)+C,R=((w==null||(l=w.positionAbsolute)===null||l===void 0?void 0:l.y)||0)+k,P=j==null?void 0:j.position;if(!P)return null;var $=R1[P],A,D,V,z,F,q;switch(u){case"source":A=O,D=R,V=P,z=x,F=N,q=$;break;case"target":A=x,D=N,V=$,z=O,F=R,q=P;break}if(g)return _e.createElement("g",{className:"react-flow__connection"},_e.createElement(g,{connectionLineType:h,connectionLineStyle:d,fromNode:w,fromHandle:j,fromX:O,fromY:R,toX:x,toY:N,fromPosition:P,toPosition:$,sourcePosition:V,targetPosition:q,sourceNode:w,sourceHandle:j,targetX:z,targetY:F,sourceX:A,sourceY:D}));var G="",W={sourceX:A,sourceY:D,sourcePosition:V,targetX:z,targetY:F,targetPosition:q};return h===va.Bezier?G=X_(W):h===va.Step?G=sh(kv(kv({},W),{},{borderRadius:0})):h===va.SmoothStep?G=sh(W):h===va.SimpleBezier?G=U_(W):G="M".concat(A,",").concat(D," ").concat(z,",").concat(F),_e.createElement("g",{className:"react-flow__connection"},_e.createElement("path",{d:G,className:"react-flow__connection-path",style:d}))};function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}var xu,z1=function(t){var n=t.color,s=n===void 0?"none":n,i=t.strokeWidth,l=i===void 0?1:i;return _e.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:l,fill:"none",points:"-5,-4 0,0 -5,4"})},D1=function(t){var n=t.color,s=n===void 0?"none":n,i=t.strokeWidth,l=i===void 0?1:i;return _e.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:l,fill:s,points:"-5,-4 0,0 -5,4 -5,-4"})},Mv=(xu={},Tt(xu,cu.Arrow,z1),Tt(xu,cu.ArrowClosed,D1),xu);function F1(e){var t=_.useMemo(function(){var n=Mv.hasOwnProperty(e);return n?Mv[e]:function(){return null}},[e]);return t}function Av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function I1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Av(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Av(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var B1=function(t){var n=t.id,s=t.type,i=t.color,l=t.width,c=l===void 0?12.5:l,u=t.height,d=u===void 0?12.5:u,p=t.markerUnits,h=p===void 0?"strokeWidth":p,f=t.strokeWidth,g=t.orient,b=g===void 0?"auto":g,w=F1(s);return _e.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(c),markerHeight:"".concat(d),viewBox:"-10 -10 20 20",markerUnits:h,orient:b,refX:"0",refY:"0"},_e.createElement(w,{color:i,strokeWidth:f}))},U1=function(t){var n=t.defaultColor,s=t.rfId;return function(i){var l=[];return i.edges.reduce(function(c,u){return[u.markerStart,u.markerEnd].forEach(function(d){if(d&&fh(d)==="object"){var p=qm(d,s);l.includes(p)||(c.push(I1({id:p,color:d.color||n},d)),l.push(p))}}),c},[]).sort(function(c,u){return c.id.localeCompare(u.id)})}},Ov=function(t){var n=t.defaultColor,s=t.rfId,i=Nn(_.useCallback(U1({defaultColor:n,rfId:s}),[n,s]),function(l,c){return!(l.length!==c.length||l.some(function(u,d){return u.id!==c[d].id}))});return _e.createElement("defs",null,i.map(function(l){return _e.createElement(B1,{id:l.id,key:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient})}))};Ov.displayName="MarkerDefinitions";var q1=_.memo(Ov),H1=[{level:0,isMaxLevel:!0,edges:[]}];function V1(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=-1,i=e.reduce(function(c,u){var d=h_(u.zIndex),p=d?u.zIndex:0;if(n){var h,f,g,b;p=d?u.zIndex:Math.max(((h=t.get(u.source))===null||h===void 0||(f=h[Wn])===null||f===void 0?void 0:f.z)||0,((g=t.get(u.target))===null||g===void 0||(b=g[Wn])===null||b===void 0?void 0:b.z)||0)}return c[p]?c[p].push(u):c[p]=[u],s=p>s?p:s,c},{}),l=Object.entries(i).map(function(c){var u=wt(c,2),d=u[0],p=u[1],h=+d;return{edges:p,level:h,isMaxLevel:h===s}});return l.length===0?H1:l}function W1(e,t,n){var s=Nn(_.useCallback(function(i){return e?i.edges.filter(function(l){var c=t.get(l.source),u=t.get(l.target);return(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&h1({sourcePos:c.positionAbsolute||{x:0,y:0},targetPos:u.positionAbsolute||{x:0,y:0},sourceWidth:c.width,sourceHeight:c.height,targetWidth:u.width,targetHeight:u.height,width:i.width,height:i.height,transform:i.transform})}):i.edges},[e,t]));return V1(s,t,n)}var K1=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},Tv=function(t){var n=Nn(K1,Fs),s=n.connectionNodeId,i=n.connectionHandleType,l=n.nodesConnectable,c=n.elementsSelectable,u=n.width,d=n.height,p=n.connectionMode,h=n.nodeInternals,f=W1(t.onlyRenderVisibleElements,h,t.elevateEdgesOnSelect);if(!u)return null;var g=t.connectionLineType,b=t.defaultMarkerColor,w=t.connectionLineStyle,y=t.connectionLineComponent,x=t.connectionLineContainerStyle,N=s&&i;return _e.createElement(_e.Fragment,null,f.map(function(E){var S=E.level,j=E.edges,C=E.isMaxLevel;return _e.createElement("svg",{key:S,style:{zIndex:S},width:u,height:d,className:"react-flow__edges react-flow__container"},C&&_e.createElement(q1,{defaultColor:b,rfId:t.rfId}),_e.createElement("g",null,j.map(function(k){var O=dv(h,k.source),R=wt(O,3),P=R[0],$=R[1],A=R[2],D=dv(h,k.target),V=wt(D,3),z=V[0],F=V[1],q=V[2];if(!A||!q)return null;var G=k.type||"default";t.edgeTypes[G]||(console.warn('[React Flow]: Edge type "'.concat(G,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),G="default");var W=t.edgeTypes[G]||t.edgeTypes.default,X=p===go.Strict?F.target:F.target||F.source,I=uv($.source,k.sourceHandle||null),L=uv(X,k.targetHandle||null),U=(I==null?void 0:I.position)||Te.Bottom,te=(L==null?void 0:L.position)||Te.Top;if(!I||!L)return null;var K=m1(P,I,U,z,L,te),H=K.sourceX,Y=K.sourceY,Q=K.targetX,ne=K.targetY;return _e.createElement(W,{key:k.id,id:k.id,className:Ds([k.className,t.noPanClassName]),type:G,data:k.data,selected:!!k.selected,animated:!!k.animated,hidden:!!k.hidden,label:k.label,labelStyle:k.labelStyle,labelShowBg:k.labelShowBg,labelBgStyle:k.labelBgStyle,labelBgPadding:k.labelBgPadding,labelBgBorderRadius:k.labelBgBorderRadius,style:k.style,source:k.source,target:k.target,sourceHandleId:k.sourceHandle,targetHandleId:k.targetHandle,markerEnd:k.markerEnd,markerStart:k.markerStart,sourceX:H,sourceY:Y,targetX:Q,targetY:ne,sourcePosition:U,targetPosition:te,elementsSelectable:c,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),N&&_e.createElement("svg",{style:x,width:u,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},_e.createElement(L1,{connectionNodeId:s,connectionHandleType:i,connectionLineStyle:w,connectionLineType:g,isConnectable:l,CustomConnectionLineComponent:y})))};Tv.displayName="EdgeRenderer";var Y1=_.memo(Tv),G1=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function Q1(e){var t=e.children,n=Nn(G1);return _e.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function X1(e){var t=Ym(),n=_.useRef(!1);_.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var $v=function(t){var n=t.nodeTypes,s=t.edgeTypes,i=t.onMove,l=t.onMoveStart,c=t.onMoveEnd,u=t.onInit,d=t.onNodeClick,p=t.onEdgeClick,h=t.onNodeDoubleClick,f=t.onEdgeDoubleClick,g=t.onNodeMouseEnter,b=t.onNodeMouseMove,w=t.onNodeMouseLeave,y=t.onNodeContextMenu,x=t.onSelectionContextMenu,N=t.connectionLineType,E=t.connectionLineStyle,S=t.connectionLineComponent,j=t.connectionLineContainerStyle,C=t.selectionKeyCode,k=t.multiSelectionKeyCode,O=t.zoomActivationKeyCode,R=t.deleteKeyCode,P=t.onlyRenderVisibleElements,$=t.elementsSelectable,A=t.selectNodesOnDrag,D=t.translateExtent,V=t.minZoom,z=t.maxZoom,F=t.defaultZoom,q=t.defaultPosition,G=t.preventScrolling,W=t.defaultMarkerColor,X=t.zoomOnScroll,I=t.zoomOnPinch,L=t.panOnScroll,U=t.panOnScrollSpeed,te=t.panOnScrollMode,K=t.zoomOnDoubleClick,H=t.panOnDrag,Y=t.onPaneClick,Q=t.onPaneScroll,ne=t.onPaneContextMenu,J=t.onEdgeUpdate,re=t.onEdgeContextMenu,Se=t.onEdgeMouseEnter,ze=t.onEdgeMouseMove,$e=t.onEdgeMouseLeave,Be=t.edgeUpdaterRadius,it=t.onEdgeUpdateStart,He=t.onEdgeUpdateEnd,de=t.noDragClassName,ge=t.noWheelClassName,Ne=t.noPanClassName,Me=t.elevateEdgesOnSelect,Ue=t.id;return X1(u),_e.createElement(O1,{onPaneClick:Y,onPaneContextMenu:ne,onPaneScroll:Q,deleteKeyCode:R,selectionKeyCode:C,multiSelectionKeyCode:k,zoomActivationKeyCode:O,elementsSelectable:$,onMove:i,onMoveStart:l,onMoveEnd:c,zoomOnScroll:X,zoomOnPinch:I,zoomOnDoubleClick:K,panOnScroll:L,panOnScrollSpeed:U,panOnScrollMode:te,panOnDrag:H,translateExtent:D,minZoom:V,maxZoom:z,defaultZoom:F,defaultPosition:q,onSelectionContextMenu:x,preventScrolling:G,noDragClassName:de,noWheelClassName:ge,noPanClassName:Ne},_e.createElement(Q1,null,_e.createElement(Y1,{edgeTypes:s,onEdgeClick:p,onEdgeDoubleClick:f,connectionLineType:N,connectionLineStyle:E,connectionLineComponent:S,connectionLineContainerStyle:j,onEdgeUpdate:J,onlyRenderVisibleElements:P,onEdgeContextMenu:re,onEdgeMouseEnter:Se,onEdgeMouseMove:ze,onEdgeMouseLeave:$e,onEdgeUpdateStart:it,onEdgeUpdateEnd:He,edgeUpdaterRadius:Be,defaultMarkerColor:W,noPanClassName:Ne,elevateEdgesOnSelect:!!Me,rfId:Ue}),_e.createElement(P1,{nodeTypes:n,onNodeClick:d,onNodeDoubleClick:h,onNodeMouseEnter:g,onNodeMouseMove:b,onNodeMouseLeave:w,onNodeContextMenu:y,selectNodesOnDrag:A,onlyRenderVisibleElements:P,noPanClassName:Ne,noDragClassName:de})))};$v.displayName="GraphView";var J1=_.memo($v),Pv=function(){return null};Pv.displayName="GroupNode";function Rv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Lv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rv(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Ml=function(e){var t=function(s){var i=s.id,l=s.type,c=s.data,u=s.xPos,d=s.yPos,p=s.selected,h=s.onClick,f=s.onMouseEnter,g=s.onMouseMove,b=s.onMouseLeave,w=s.onContextMenu,y=s.onDoubleClick,x=s.style,N=s.className,E=s.isDraggable,S=s.isSelectable,j=s.isConnectable,C=s.selectNodesOnDrag,k=s.sourcePosition,O=s.targetPosition,R=s.hidden,P=s.resizeObserver,$=s.dragHandle,A=s.zIndex,D=s.isParent,V=s.noPanClassName,z=s.noDragClassName,F=s.initialized,q=ss(),G=_.useRef(null),W=_.useRef(k),X=_.useRef(O),I=_.useRef(l),L=S||E||h||f||g||b,U=Cl(i,q.getState,f),te=Cl(i,q.getState,g),K=Cl(i,q.getState,b),H=Cl(i,q.getState,w),Y=Cl(i,q.getState,y),Q=function(re){if(S&&(!C||!E)&&x_({id:i,store:q}),h){var Se=q.getState().nodeInternals.get(i);h(re,Lv({},Se))}};_.useEffect(function(){if(G.current&&!R){var J=G.current;return P==null||P.observe(J),function(){return P==null?void 0:P.unobserve(J)}}},[R]),_.useEffect(function(){var J=I.current!==l,re=W.current!==k,Se=X.current!==O;G.current&&(J||re||Se)&&(J&&(I.current=l),re&&(W.current=k),Se&&(X.current=O),q.getState().updateNodeDimensions([{id:i,nodeElement:G.current,forceUpdate:!0}]))},[i,l,k,O]);var ne=Nv({nodeRef:G,disabled:R||!E,noDragClassName:z,handleSelector:$,nodeId:i,isSelectable:S,selectNodesOnDrag:C});return R?null:_e.createElement("div",{className:Ds(["react-flow__node","react-flow__node-".concat(l),V,N,{selected:p,selectable:S,parent:D}]),ref:G,style:Lv({zIndex:A,transform:"translate(".concat(u,"px,").concat(d,"px)"),pointerEvents:L?"all":"none",visibility:F?"visible":"hidden"},x),onMouseEnter:U,onMouseMove:te,onMouseLeave:K,onContextMenu:H,onClick:Q,onDoubleClick:Y,"data-testid":"rf__node-".concat(i),"data-id":i},_e.createElement(GE,{value:i},_e.createElement(e,{id:i,data:c,type:l,xPos:u,yPos:d,selected:p,isConnectable:j,sourcePosition:k,targetPosition:O,dragging:ne,dragHandle:$,zIndex:A})))};return t.displayName="NodeWrapper",_.memo(t)};function zv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Dv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zv(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Z1(e){var t={input:Ml(e.input||sv),default:Ml(e.default||uh),output:Ml(e.output||av),group:Ml(e.group||Pv)},n={},s=Object.keys(e).filter(function(i){return!["input","default","output","group"].includes(i)}).reduce(function(i,l){return i[l]=Ml(e[l]||uh),i},n);return Dv(Dv({},t),s)}function Fv(e,t){_.useRef(null);var n=_.useMemo(function(){return t(e)},[e]);return n}function Iv(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var Bv=function(t){var n=t.children,s=!0;try{ss()}catch{s=!1}return s?_e.createElement(_e.Fragment,null,n):_e.createElement($_,{createStore:P_},n)};Bv.displayName="ReactFlowWrapper";var ek=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function Uv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function qv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Uv(Object(n),!0).forEach(function(s){Tt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}Iv(o1),Iv(l1);var tk={input:sv,default:uh,output:av},nk={default:ah,straight:Q_,step:G_,smoothstep:rh,simplebezier:q_},sk=[15,15],rk=[0,0],Hv=_.forwardRef(function(e,t){var n=e.nodes,s=e.edges,i=e.defaultNodes,l=e.defaultEdges,c=e.className,u=e.nodeTypes,d=u===void 0?tk:u,p=e.edgeTypes,h=p===void 0?nk:p,f=e.onNodeClick,g=e.onEdgeClick,b=e.onInit,w=e.onMove,y=e.onMoveStart,x=e.onMoveEnd,N=e.onConnect,E=e.onConnectStart,S=e.onConnectStop,j=e.onConnectEnd,C=e.onClickConnectStart,k=e.onClickConnectStop,O=e.onClickConnectEnd,R=e.onNodeMouseEnter,P=e.onNodeMouseMove,$=e.onNodeMouseLeave,A=e.onNodeContextMenu,D=e.onNodeDoubleClick,V=e.onNodeDragStart,z=e.onNodeDrag,F=e.onNodeDragStop,q=e.onNodesDelete,G=e.onEdgesDelete,W=e.onSelectionChange,X=e.onSelectionDragStart,I=e.onSelectionDrag,L=e.onSelectionDragStop,U=e.onSelectionContextMenu,te=e.connectionMode,K=te===void 0?go.Strict:te,H=e.connectionLineType,Y=H===void 0?va.Bezier:H,Q=e.connectionLineStyle,ne=e.connectionLineComponent,J=e.connectionLineContainerStyle,re=e.deleteKeyCode,Se=re===void 0?"Backspace":re,ze=e.selectionKeyCode,$e=ze===void 0?"Shift":ze,Be=e.multiSelectionKeyCode,it=Be===void 0?"Meta":Be,He=e.zoomActivationKeyCode,de=He===void 0?"Meta":He,ge=e.snapToGrid,Ne=ge===void 0?!1:ge,Me=e.snapGrid,Ue=Me===void 0?sk:Me,ce=e.onlyRenderVisibleElements,Oe=ce===void 0?!1:ce,Ge=e.selectNodesOnDrag,ut=Ge===void 0?!0:Ge,rt=e.nodesDraggable,vt=e.nodesConnectable,at=e.elementsSelectable,ct=e.minZoom,$t=ct===void 0?.5:ct,Dt=e.maxZoom,Qe=Dt===void 0?2:Dt,Ut=e.defaultZoom,Yt=Ut===void 0?1:Ut,Mt=e.defaultPosition,yt=Mt===void 0?rk:Mt,jn=e.translateExtent,Rt=jn===void 0?Wm:jn,tn=e.preventScrolling,fe=tn===void 0?!0:tn,qt=e.nodeExtent,dt=e.defaultMarkerColor,Ye=dt===void 0?"#b1b1b7":dt,bt=e.zoomOnScroll,dn=bt===void 0?!0:bt,ft=e.zoomOnPinch,Cs=ft===void 0?!0:ft,Gt=e.panOnScroll,pt=Gt===void 0?!1:Gt,Nt=e.panOnScrollSpeed,Yn=Nt===void 0?.5:Nt,mn=e.panOnScrollMode,rn=mn===void 0?pi.Free:mn,hn=e.zoomOnDoubleClick,Cn=hn===void 0?!0:hn,At=e.panOnDrag,Gn=At===void 0?!0:At,Ht=e.onPaneClick,fn=e.onPaneScroll,Sn=e.onPaneContextMenu,Ve=e.children,tr=e.onEdgeUpdate,Qn=e.onEdgeContextMenu,as=e.onEdgeDoubleClick,Fn=e.onEdgeMouseEnter,os=e.onEdgeMouseMove,Ss=e.onEdgeMouseLeave,In=e.onEdgeUpdateStart,nr=e.onEdgeUpdateEnd,Qt=e.edgeUpdaterRadius,Xe=Qt===void 0?10:Qt,Bt=e.onNodesChange,Bn=e.onEdgesChange,qs=e.noDragClassName,is=qs===void 0?"nodrag":qs,gr=e.noWheelClassName,ie=gr===void 0?"nowheel":gr,ve=e.noPanClassName,Pe=ve===void 0?"nopan":ve,jt=e.fitView,we=jt===void 0?!1:jt,nt=e.fitViewOptions,tt=e.connectOnClick,Ft=tt===void 0?!0:tt,Ot=e.attributionPosition,nn=e.proOptions,Vt=e.defaultEdgeOptions,pn=e.elevateEdgesOnSelect,Es=pn===void 0?!1:pn,Xn=mu(e,ek),yn=Fv(d,Z1),En=Fv(h,d1);return _e.createElement("div",qv(qv({},Xn),{},{ref:t,className:Ds(["react-flow",c])}),_e.createElement(Bv,null,_e.createElement(J1,{onInit:b,onMove:w,onMoveStart:y,onMoveEnd:x,onNodeClick:f,onEdgeClick:g,onNodeMouseEnter:R,onNodeMouseMove:P,onNodeMouseLeave:$,onNodeContextMenu:A,onNodeDoubleClick:D,nodeTypes:yn,edgeTypes:En,connectionLineType:Y,connectionLineStyle:Q,connectionLineComponent:ne,connectionLineContainerStyle:J,selectionKeyCode:$e,deleteKeyCode:Se,multiSelectionKeyCode:it,zoomActivationKeyCode:de,onlyRenderVisibleElements:Oe,selectNodesOnDrag:ut,translateExtent:Rt,minZoom:$t,maxZoom:Qe,defaultZoom:Yt,defaultPosition:yt,preventScrolling:fe,zoomOnScroll:dn,zoomOnPinch:Cs,zoomOnDoubleClick:Cn,panOnScroll:pt,panOnScrollSpeed:Yn,panOnScrollMode:rn,panOnDrag:Gn,onPaneClick:Ht,onPaneScroll:fn,onPaneContextMenu:Sn,onSelectionContextMenu:U,onEdgeUpdate:tr,onEdgeContextMenu:Qn,onEdgeDoubleClick:as,onEdgeMouseEnter:Fn,onEdgeMouseMove:os,onEdgeMouseLeave:Ss,onEdgeUpdateStart:In,onEdgeUpdateEnd:nr,edgeUpdaterRadius:Xe,defaultMarkerColor:Ye,noDragClassName:is,noWheelClassName:ie,noPanClassName:Pe,elevateEdgesOnSelect:Es,id:Xn==null?void 0:Xn.id}),_e.createElement(r1,{nodes:n,edges:s,defaultNodes:i,defaultEdges:l,onConnect:N,onConnectStart:E,onConnectStop:S,onConnectEnd:j,onClickConnectStart:C,onClickConnectStop:k,onClickConnectEnd:O,nodesDraggable:rt,nodesConnectable:vt,elementsSelectable:at,minZoom:$t,maxZoom:Qe,nodeExtent:qt,onNodesChange:Bt,onEdgesChange:Bn,snapToGrid:Ne,snapGrid:Ue,connectionMode:K,translateExtent:Rt,connectOnClick:Ft,defaultEdgeOptions:Vt,fitView:we,fitViewOptions:nt,onNodesDelete:q,onEdgesDelete:G,onNodeDragStart:V,onNodeDrag:z,onNodeDragStop:F,onSelectionDrag:I,onSelectionDragStart:X,onSelectionDragStop:L}),W&&_e.createElement(n1,{onSelectionChange:W}),Ve,_e.createElement(BE,{proOptions:nn,position:Ot})))});Hv.displayName="ReactFlow";var Vv=function(t){var n=t.children;return _e.createElement($_,{createStore:P_},n)};Vv.displayName="ReactFlowProvider";function Wv(e){return function(t){var n=_.useState(t),s=wt(n,2),i=s[0],l=s[1],c=_.useCallback(function(u){return l(function(d){return e(u,d)})},[]);return[i,l,c]}}var ak=Wv(__),ok=Wv(dE);const ik=e=>Number.isFinite(e),wu=e=>Math.round(e*100)/100,lk=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const i=Math.abs(n-e),l=Math.abs(s-t),c=Math.sqrt(i*i+l*l),u=Math.max(80,Math.min(c*.4,280)),d=Number.isFinite(u)?u:120,p=n>=e?1:-1,h=Math.min(Math.abs(s-t)*.2,50),f=e+p*d,g=t+(s>t?h:-h),b=n-p*d,w=s-(s>t?h:-h);return`M ${e},${t} C ${f},${g} ${b},${w} ${n},${s}`},ck=({id:e,sourceX:t,sourceY:n,targetX:s,targetY:i,markerEnd:l,style:c})=>{const{setEdges:u}=Ym(),[d,p]=_.useState(!1),h=_.useCallback(()=>{p(!0)},[]),f=_.useCallback(()=>{p(!1)},[]),g=_.useMemo(()=>[t,n,s,i].every($=>ik($))?{sourceX:wu(t),sourceY:wu(n),targetX:wu(s),targetY:wu(i)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:s,targetY:i}),null),[t,n,s,i,e]),b=_.useMemo(()=>{if(!g)return null;const{sourceX:$,sourceY:A,targetX:D,targetY:V}=g;return lk($,A,D,V)},[g]),w=_.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!g||!b)return null;const{sourceX:y,sourceY:x,targetX:N,targetY:E}=g,S=(y+N)/2,j=(x+E)/2,C=32,k=S-C/2,O=j-C/2,R=`animated-edge${d?" animated-edge--hovered":""}`,P=`canvas-edge-remove${d?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:R,onMouseEnter:h,onMouseLeave:f,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:w,gradientUnits:"userSpaceOnUse",x1:y,y1:x,x2:N,y2:E,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:b,fill:"none",stroke:"transparent",strokeWidth:20,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:b,fill:"none",stroke:`url(#${w})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:b,fill:"none",stroke:`url(#${w})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:l,className:"animated-edge__base",style:{...c,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:b,fill:"none",stroke:`url(#${w})`,strokeWidth:d?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:b,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:P,x:k,y:O,width:C,height:C,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:$=>{$.stopPropagation(),u(A=>A.filter(D=>D.id!==e))},"aria-label":"Remove connection",children:""})})})]})};async function Kv(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function Yv(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function Gv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load label encoding recommendations");return c.json()}async function Qv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load ordinal encoding suggestions");return c.json()}async function Xv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load target encoding recommendations");return c.json()}async function Jv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load hash encoding recommendations");return c.json()}async function Zv(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load one-hot encoding recommendations");return c.json()}async function ey(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load dummy encoding recommendations");return c.json()}async function ph(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load column drop recommendations");return c.json()}async function ty(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,c={dataset_source_id:e,sample_size:l};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load outlier recommendations");return u.json()}async function ny(e,t={}){const{sampleSize:n=500,transformations:s,graph:i,targetNodeId:l}=t,c={dataset_source_id:e,sample_size:n};Array.isArray(s)?s.length>0&&(c.transformations=JSON.stringify(s)):s&&typeof s=="object"&&Object.keys(s).length>0&&(c.transformations=JSON.stringify(s)),i&&Array.isArray(i.nodes)&&Array.isArray(i.edges)&&(c.graph={nodes:i.nodes,edges:i.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load skewness recommendations");return u.json()}async function sy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load scaling recommendations");return c.json()}async function ry(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/binning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load binning recommendations");return c.json()}async function ay(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c={dataset_source_id:e,sample_size:l};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/analytics/binned-distribution",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){let d="Failed to load binned column distributions";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function oy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c=new URLSearchParams({dataset_source_id:e,sample_size:String(l)});s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&c.set("graph",JSON.stringify({nodes:s.nodes,edges:s.edges})),i&&c.set("target_node_id",i);const u=await fetch(`/ml-workflow/api/analytics/quick-profile?${c.toString()}`);if(!u.ok){let d="Failed to generate dataset profile";try{const p=await u.clone().json(),h=typeof(p==null?void 0:p.detail)=="string"&&p.detail.trim()?p.detail.trim():typeof(p==null?void 0:p.error)=="string"&&p.error.trim()?p.error.trim():typeof(p==null?void 0:p.message)=="string"&&p.message.trim()?p.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function uk(e,t={}){const{config:n,sampleSize:s,graph:i,targetNodeId:l}=t,c={dataset_source_id:e,sample_size:s==="all"?0:typeof s=="number"&&Number.isFinite(s)?s:300};if(n&&typeof n=="object"){const d=(g,b)=>{const w=Number(g);return Number.isFinite(w)?w<0?0:w>100?100:w:b},p=g=>{if(!g||typeof g!="object")return{};const b={};return Object.entries(g).forEach(([w,y])=>{const x=String(w??"").trim();if(!x)return;let N=null,E=null;if(y&&typeof y=="object"){const S=y.lower??y.min??y.minimum??null,j=y.upper??y.max??y.maximum??null,C=Number(S);Number.isFinite(C)&&(N=C);const k=Number(j);Number.isFinite(k)&&(E=k)}if(!(N===null&&E===null)){if(N!==null&&E!==null&&N>E){const S=N;N=E,E=S}b[x]={lower:N,upper:E}}}),b},h=d(n.lower_percentile,5),f=d(n.upper_percentile,95);c.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:h,upper_percentile:f<=h?Math.min(h+1,100):f,manual_bounds:p(n.manual_bounds)}}i&&Array.isArray(i.nodes)&&Array.isArray(i.edges)&&(c.graph={nodes:i.nodes,edges:i.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){const d=await u.text();throw new Error(d||"Failed to load outlier diagnostics")}return u.json()}async function iy(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function ly(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function cy(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}async function uy(e,t={}){const{offset:n,limit:s,mode:i}=t,l=new URLSearchParams;typeof n=="number"&&Number.isFinite(n)&&l.set("offset",String(n)),typeof s=="number"&&Number.isFinite(s)&&l.set("limit",String(s)),i&&l.set("mode",i);const c=l.toString(),u=`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/preview/rows${c?`?${c}`:""}`,d=await fetch(u);if(!d.ok){const p=await d.text();throw new Error(p||"Failed to load preview rows")}return d.json()}async function dy(e){const t=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(n||"Failed to load pipeline preview")}return t.json()}async function my(e){const t={...e,sample_size:0},n=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const s=await n.text();throw new Error(s||"Failed to trigger full dataset execution")}return n.json()}async function dk(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/full-execution/${encodeURIComponent(t)}`);if(!n.ok){const s=await n.text();throw new Error(s||"Failed to fetch full execution status")}return n.json()}async function hy(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,i=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:i}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function fy(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function Al(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view training jobs.");const i=await s.text();throw new Error(i||"Failed to load training jobs")}return s.json()}async function py(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const s=await n.text();throw new Error(s||"Failed to evaluate model")}return n.json()}async function gy(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,i=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:i}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function mk(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function Ol(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view tuning jobs.");const i=await s.text();throw new Error(i||"Failed to load tuning jobs")}return s.json()}async function Nu(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function _y(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const s=n.toString(),i=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${s?`?${s}`:""}`,{credentials:"include"});if(!i.ok){if(i.status===404)throw new Error(`Model type '${e}' not found`);const l=await i.text();throw new Error(l||"Failed to fetch best hyperparameters")}return i.json()}const gh=e=>{if(Array.isArray(e))return e.map(t=>gh(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(s=>{n[s]=gh(e[s])}),n}return e},hk=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),fk=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return hk(n)},pk=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],s=t.map(l=>{let c=null;if(l&&l.data&&typeof l.data=="object"){const u=l.data.config;if(u!==void 0)try{c=JSON.parse(JSON.stringify(u))}catch{c=u}}return{id:l&&Object.prototype.hasOwnProperty.call(l,"id")?l.id??null:null,type:l&&Object.prototype.hasOwnProperty.call(l,"type")?l.type??null:null,catalogType:l&&l.data&&Object.prototype.hasOwnProperty.call(l.data,"catalogType")?l.data.catalogType??null:null,config:c}}).sort((l,c)=>{const u=typeof l.id=="string"?l.id:String(l.id??""),d=typeof c.id=="string"?c.id:String(c.id??"");return u.localeCompare(d)}),i=n.map(l=>({source:l&&Object.prototype.hasOwnProperty.call(l,"source")?l.source??null:null,target:l&&Object.prototype.hasOwnProperty.call(l,"target")?l.target??null:null,sourceHandle:l&&Object.prototype.hasOwnProperty.call(l,"sourceHandle")?l.sourceHandle??null:null,targetHandle:l&&Object.prototype.hasOwnProperty.call(l,"targetHandle")?l.targetHandle??null:null})).sort((l,c)=>{const u=String(l.source??"").localeCompare(String(c.source??""));return u!==0?u:String(l.target??"").localeCompare(String(c.target??""))});return{nodes:s,edges:i}};async function yo(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=pk(t),s=JSON.stringify(gh(n)),i=await fk(s);return`${e}_${i.slice(0,8)}`}const gk=Object.freeze(Object.defineProperty({__proto__:null,createHyperparameterTuningJob:gy,createTrainingJob:hy,evaluateTrainingJob:py,fetchBestHyperparameters:_y,fetchBinnedDistribution:ay,fetchBinningRecommendations:ry,fetchDatasets:Yv,fetchDropColumnRecommendations:ph,fetchDummyEncodingRecommendations:ey,fetchFullExecutionStatus:dk,fetchHashEncodingRecommendations:Jv,fetchHyperparameterTuningJob:mk,fetchHyperparameterTuningJobs:Ol,fetchLabelEncodingRecommendations:Gv,fetchModelHyperparameters:Nu,fetchNodeCatalog:Kv,fetchOneHotEncodingRecommendations:Zv,fetchOrdinalEncodingRecommendations:Qv,fetchOutlierDiagnostics:uk,fetchOutlierRecommendations:ty,fetchPipeline:iy,fetchPipelineHistory:cy,fetchPipelinePreview:dy,fetchPipelinePreviewRows:uy,fetchQuickProfile:oy,fetchScalingRecommendations:sy,fetchSkewnessRecommendations:ny,fetchTargetEncodingRecommendations:Xv,fetchTrainingJob:fy,fetchTrainingJobs:Al,generatePipelineId:yo,savePipeline:ly,triggerFullDatasetExecution:my},Symbol.toStringTag,{value:"Module"})),_k=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:i,columnTypeMap:l,setAvailableColumns:c,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:p,setColumnSuggestions:h})=>{const[f,g]=_.useState([]),[b,w]=_.useState(null),[y,x]=_.useState([]),[N,E]=_.useState(null),[S,j]=_.useState(!1),[C,k]=_.useState(null),[O,R]=_.useState(null),[P,$]=_.useState(0),A=_.useRef(l);_.useEffect(()=>{A.current=l},[l]),_.useEffect(()=>{let q=!0;const G=W=>{x([]),E(W??null),k(null),R(null),j(!1),g([]),w(null),c([]),u(""),d({}),p({}),h({})};return e?t?i?(j(!0),E(null),ph(t,{graph:s,targetNodeId:n??null}).then(W=>{if(!q)return;const X=Array.isArray(W==null?void 0:W.candidates)?W.candidates:[];x(X),k((W==null?void 0:W.generated_at)??null),R(typeof(W==null?void 0:W.suggested_threshold)=="number"?Number(W.suggested_threshold):null);const I=Array.isArray(W==null?void 0:W.available_filters)?W.available_filters:[];g(I),w(K=>K&&I.some(H=>H.id===K)?K:null);const L={};W&&typeof W=="object"&&(W!=null&&W.column_missing_map)&&typeof W.column_missing_map=="object"&&Object.entries(W.column_missing_map).forEach(([K,H])=>{const Y=String(K??"").trim();if(!Y)return;const Q=Number(H);Number.isFinite(Q)&&(L[Y]=Number(Q))});const U=new Set;Array.isArray(W==null?void 0:W.all_columns)&&W.all_columns.forEach(K=>{const H=String(K??"").trim();H&&U.add(H)}),Object.keys(A.current??{}).forEach(K=>U.add(K));const te=Array.from(U).sort((K,H)=>K.localeCompare(H));te.forEach(K=>{Object.prototype.hasOwnProperty.call(L,K)||(L[K]=0)}),c(te),u(""),d(L),p(K=>{const H=W==null?void 0:W.column_type_map;if(!H||typeof H!="object")return K;const Y={...K};return Object.entries(H).forEach(([Q,ne])=>{const J=String(Q??"").trim();if(!J)return;const re=String(ne??"").trim();Y[J]=re||K[J]||""}),Y}),h(K=>{const H=W==null?void 0:W.column_recommendations;if(!H||typeof H!="object")return K;const Y={};return Object.entries(H).forEach(([Q,ne])=>{const J=String(Q??"").trim();if(!J)return;const re=Array.isArray(ne)?ne.map(Se=>String(Se??"").trim()).filter(Boolean):[];Y[J]=re}),Y})}).catch(W=>{q&&G((W==null?void 0:W.message)??"Unable to load recommendations")}).finally(()=>{q&&j(!1)}),()=>{q=!1}):(G("Connect this step to an upstream output to load recommendations."),()=>{q=!1}):(G(),()=>{q=!1}):(G(),()=>{q=!1})},[A,s,e,i,n,P,c,d,u,h,p,t]);const D=_.useCallback(()=>{!e||!t||!i||$(q=>q+1)},[e,i,t]),V=_.useMemo(()=>{const q=new Map;return f.forEach(G=>{G!=null&&G.id&&q.set(G.id,G.label)}),q},[f]),z=_.useCallback(q=>q?V.has(q)?V.get(q)??null:q.split("_").filter(Boolean).map(W=>W.charAt(0).toUpperCase()+W.slice(1)).join(" ")||q:null,[V]),F=_.useMemo(()=>b?y.filter(q=>Array.isArray(q==null?void 0:q.signals)&&q.signals.includes(b)):y,[b,y]);return{hasDropColumnSource:e,availableFilters:f,activeFilterId:b,setActiveFilterId:w,recommendations:y,filteredRecommendations:F,formatSignalName:z,isFetchingRecommendations:S,recommendationsError:N,recommendationsGeneratedAt:C,suggestedThreshold:O,refreshRecommendations:D}},vk=({thresholdParameter:e,dropIfAnyParameter:t,renderParameterField:n})=>!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&n(e),t&&n(t)]}),yk="first",bk=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],xk=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:s,renderMultiSelectField:i,removeDuplicatesKeepSelectId:l,removeDuplicatesKeep:c,onKeepChange:u})=>{if(!n&&!s)return null;const d=p=>{const h=p.target.value;u(h==="last"||h==="none"?h:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),i(n)]}),s&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:l,className:"canvas-modal__parameter-label",children:s.label??"Keep strategy"}),s.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:s.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:l,value:c,onChange:d,children:bk.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))})})]})]})},Ke=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],wk=["float64","Int64","boolean","string","category","datetime64[ns]","object"],Nk=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:s,columnSuggestions:i,selectedColumns:l,previewColumns:c,previewStatus:u,sourceId:d,hasReachableSource:p})=>{const h=_.useMemo(()=>{const j=e==null?void 0:e.column_overrides;if(!j||typeof j!="object"||Array.isArray(j))return{};const C={};return Object.entries(j).forEach(([k,O])=>{const R=String(k??"").trim();if(!R||typeof O!="string")return;const P=O.trim();P&&(C[R]=P)}),C},[e==null?void 0:e.column_overrides]),f=_.useMemo(()=>{const j=e==null?void 0:e.target_dtype;return typeof j=="string"?j.trim():""},[e==null?void 0:e.target_dtype]),g=_.useMemo(()=>{const j=new Set;return n.forEach(k=>j.add(k)),Object.keys(s).forEach(k=>j.add(k)),Object.keys(i).forEach(k=>j.add(k)),Object.keys(h).forEach(k=>j.add(k)),l.forEach(k=>j.add(k)),c.forEach(k=>{typeof k=="string"&&j.add(k)}),Array.from(j).sort((k,O)=>k.localeCompare(O)).map(k=>{const O=s[k]??"Unknown",R=i[k]??[],P=R.length?R[0]:null,$=Object.prototype.hasOwnProperty.call(h,k),A=$?h[k]:null,D=typeof A=="string"?A.trim():"",V=$?D:f,z=new Set;V&&z.add(V),R.forEach(I=>z.add(I)),O&&O!=="Unknown"&&z.add(O),f&&z.add(f),wk.forEach(I=>z.add(I));const F=V??"",q=!!(P&&P!==F),G=!!(P&&P===F),W=l.includes(k),X=Array.from(z).sort((I,L)=>I.localeCompare(L));return{column:k,originalType:O,recommended:P,currentTarget:V,suggestions:R,options:X,hasRecommendationGap:q,hasOverride:$,usesDefaultTarget:!$,isRecommendationApplied:G,isSelected:W}})},[n,f,h,i,s,c,l]),b=_.useMemo(()=>{const j=g.filter(O=>O.hasRecommendationGap),C=g.filter(O=>!O.hasRecommendationGap),k=[];return j.length&&k.push({key:"needs-attention",label:"Needs attention",rows:j}),C.length&&k.push({key:"all-columns",label:j.length?"Other columns":"All columns",rows:C}),k},[g]),w=_.useMemo(()=>g.filter(j=>j.hasRecommendationGap).length,[g]),y=_.useMemo(()=>w>0,[w]),x=_.useMemo(()=>g.filter(j=>j.isSelected).length,[g]),N=_.useCallback((j,C)=>{const k=j.trim();k&&t(O=>{const R=O.column_overrides&&typeof O.column_overrides=="object"&&!Array.isArray(O.column_overrides)?{...O.column_overrides}:{},P=typeof C=="string"?C.trim():"",$=new Set(Ke(O.columns)),A=new Set(Ke(O.skipped_columns)),D=A.delete(k);P?(R[k]=P,$.add(k)):delete R[k];const V={...O,columns:Array.from($).sort((z,F)=>z.localeCompare(F)),column_overrides:R};return D&&(V.skipped_columns=Array.from(A).sort((z,F)=>z.localeCompare(F))),V})},[t]),E=_.useCallback(()=>{const j=Object.entries(i).filter(([,C])=>C.length>0);j.length&&t(C=>{const k=new Set(Ke(C.columns)),O=C.column_overrides&&typeof C.column_overrides=="object"&&!Array.isArray(C.column_overrides)?{...C.column_overrides}:{};return j.forEach(([R,P])=>{const $=R.trim();$&&(k.add($),P.length&&(O[$]=P[0]))}),{...C,columns:Array.from(k).sort((R,P)=>R.localeCompare(P)),column_overrides:O}})},[i,t]),S=_.useCallback((j,C)=>{C==="__default__"?N(j,null):N(j,C)},[N]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:E,disabled:!y,children:"Apply recommendations"})})]}),!d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),d&&!p&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),f?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:f}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),g.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",g.length," column",g.length===1?"":"s","  ",x," mapped in node selection."]}),y?a.jsxs("p",{className:"canvas-modal__note",children:[w," column",w===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):g.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),u==="loading"&&!g.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),g.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:b.map(j=>a.jsxs("div",{className:"canvas-cast__group",children:[j.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:j.label}),a.jsxs("span",{children:[j.rows.length," column",j.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:j.rows.map(C=>{const k=["canvas-cast__row"];C.hasRecommendationGap&&k.push("canvas-cast__row--attention"),C.hasOverride&&k.push("canvas-cast__row--override");const O=C.hasOverride?C.currentTarget||"":"__default__",R=C.isRecommendationApplied,P=C.suggestions.slice(1,4),$=C.hasOverride?C.currentTarget?`Override  ${C.currentTarget}`:"Override cleared (uses original dtype)":f?`Inheriting ${f}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:k.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:C.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[C.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),C.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!C.isSelected&&!C.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:C.originalType})}),a.jsx("td",{children:C.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${C.hasRecommendationGap?" canvas-cast__chip--attention":""}${R?" canvas-cast__chip--applied":""}`,children:C.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:R?"Aligned with target":"Not applied yet"}),P.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",P.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:O,onChange:A=>S(C.column,A.target.value),children:[a.jsx("option",{value:"__default__",children:f?`Inherit global (${f})`:"No override (use original)"}),C.options.map(A=>a.jsx("option",{value:A,children:A},`${C.column}-${A}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:$})]})})]},`cast-row-${C.column}`)})})]})})]},`cast-group-${j.key}`))})]})},Tl=100,jk=12,Ck={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},vy={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},Sk={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details."},Ek={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},kk=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},Mk=e=>{if(!e)return"";const t=Sk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},yy=(e,t)=>{if(!e)return null;const n=e.job_status??null,s=kk(n??e.status??null),i=vy[n??e.status??s]??vy[s],l=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,c=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let u=`Full dataset run: ${i}`;s==="running"&&l&&c?u=`Full dataset run: In progress (${l}/${c})`:s==="running"&&l?u=`Full dataset run: In progress (${l} rows)`:s==="succeeded"&&l?u=`Full dataset run: Completed (${l} rows)`:s==="succeeded"&&c&&(u=`Full dataset run: Completed (${c} rows)`);const d=[],p=[],h=n?Ek[n]??n:null;if(n==="running"?l&&c?d.push(`Processed ${l} of ${c} rows.`):l?d.push(`Processed ${l} rows.`):c&&d.push(`Processing ${c} rows.`):l?d.push(`Processed ${l} rows.`):c&&d.push(`Total rows ${c}.`),e.reason&&d.push(e.reason),h&&p.push({label:"Background job",value:h}),e.job_id&&p.push({label:"Background job ID",value:e.job_id}),c&&p.push({label:"Dataset rows",value:c}),l&&s!=="queued"&&s!=="skipped"&&p.push({label:"Processed rows",value:l}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&p.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const b=new Date(e.last_updated).toLocaleString();p.push({label:"Last updated",value:b})}catch{p.push({label:"Last updated",value:String(e.last_updated)})}const f=Array.isArray(e.warnings)?e.warnings.map(Mk).map(b=>b.trim()).filter(Boolean):[];let g=null;switch(s){case"queued":g=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":g=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(l){const b=e.processed_rows===1?"":"s";g=`Full dataset run processed ${l} row${b}.`}else c?g=`Full dataset run completed (${c} rows).`:g="Full dataset run completed.";break;case"failed":g=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":g="Full dataset run cancelled.";break;case"skipped":g=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":g=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:g=null;break}return{label:u,tone:s,details:d,metadata:p,warnings:f,stepLabel:g,isActive:n==="queued"||n==="running"}},by=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),Ak=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const s=e.split(":",2)[1]??"";return s?`Preview mode "${s}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=Ck[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},Ok=({preview:e,columns:t,rows:n,tableNote:s,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:p,fullExecutionWarnings:h})=>{const f=e==null?void 0:e.metrics,g=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],b=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],w=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let y=w;const x=p||null;if(x){const j=w.findIndex(C=>typeof C=="string"&&C.toLowerCase().startsWith("full dataset run"));j>=0?y=[...w.slice(0,j),x,...w.slice(j+1)]:w.includes(x)||(y=[...w,x])}const N=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],E=b.reduce((j,C)=>(C&&typeof C.index=="number"&&(j[C.index]=typeof C.missing_percentage=="number"?C.missing_percentage:0),j),{}),S=N.slice(0,jk);return a.jsxs("div",{className:"canvas-preview",children:[f&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(f.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(f.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(f.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(f.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(f.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(f.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:f.requested_sample_size===0?"Full dataset":l(f.requested_sample_size)})]})]}),y.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:y.map((j,C)=>a.jsx("li",{children:j},`${j}-${C}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(j=>a.jsx("th",{children:j},j))})}),a.jsx("tbody",{children:n.map((j,C)=>a.jsx("tr",{children:t.map(k=>a.jsx("td",{children:i(j==null?void 0:j[k])},`${C}-${k}`))},`row-${C}`))})]}),s?a.jsx("p",{className:"canvas-modal__note",children:s}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),b.length>0&&S.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:S.map((j,C)=>{const k=E[C]??0,O=k%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",C+1]}),a.jsxs("strong",{children:[l(k,O),"%"]})]},`row-missing-${C}`)})})]}),g.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:g.map(j=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:j.name}),j.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",j.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",c(j.missing_percentage)," (",l(j.missing_count),")"]}),typeof j.mean=="number"&&!Number.isNaN(j.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",u(j.mean)]}),typeof j.median=="number"&&!Number.isNaN(j.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",u(j.median)]}),j.mode!==void 0&&j.mode!==null&&j.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",d(j.mode)]}),typeof j.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",l(j.distinct_count)]})]},j.name))})]}),h&&h.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:h.map((j,C)=>a.jsx("li",{children:j},`${j}-${C}`))})]})]})},Tk=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:s,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d})=>{var G,W,X,I,L;const[p,h]=_.useState(()=>by()),[f,g]=_.useState(null),[b,w]=_.useState(!1),y=e.status==="loading",x=y||!n,N=_.useMemo(()=>{var te;const U=(te=e.data)==null?void 0:te.columns;return Array.isArray(U)?U.filter(K=>typeof K=="string"):[]},[(G=e.data)==null?void 0:G.columns]),E=_.useMemo(()=>{var U;return Array.isArray((U=e.data)==null?void 0:U.sample_rows)?e.data.sample_rows.slice(0,Tl):[]},[(W=e.data)==null?void 0:W.sample_rows]),S=E.length,j=Array.isArray((X=e.data)==null?void 0:X.sample_rows)?e.data.sample_rows.length:0,C=(I=e.data)==null?void 0:I.metrics,k=_.useMemo(()=>C?j>S||typeof C.total_rows=="number"&&C.total_rows>j:!1,[C,S,j]);_.useEffect(()=>{var te;if(e.status!=="success"||!e.data){h(K=>K.status==="idle"?K:by()),g(null);return}const U=yy((te=e.data.signals)==null?void 0:te.full_execution,l);g(U),h({status:"ready",columns:[...N],rows:[...E],nextOffset:S,hasMore:k,totalRows:typeof(C==null?void 0:C.total_rows)=="number"?C.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[N,E,S,k,l,C==null?void 0:C.total_rows,e.data,e.status]),_.useEffect(()=>{var H,Y;if(!f||!f.isActive)return;const U=(Y=(H=e.data)==null?void 0:H.signals)==null?void 0:Y.full_execution;if(!U||!U.job_id||!t)return;const te=typeof U.poll_after_seconds=="number"&&U.poll_after_seconds>0?U.poll_after_seconds*1e3:5e3,K=setTimeout(()=>{Promise.resolve().then(()=>gk).then(Q=>Q.fetchFullExecutionStatus(t,U.job_id)).then(Q=>{const ne=yy(Q,l);g(ne),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(Q=>{console.error("Failed to poll background job status:",Q)})},te);return()=>clearTimeout(K)},[f,t,l,e.data]);const O=p.columns.length>0?p.columns:N,R=p.rows.length>0?p.rows:E,P=p.totalRows??(typeof(C==null?void 0:C.total_rows)=="number"?C.total_rows:null),$=p.status==="idle"?k:p.hasMore,A=p.status==="loading",D=R.length,V=_.useMemo(()=>{if(!D)return null;const U=l(D);if(P!==null&&P>=0){const te=l(P),K=`Loaded ${U} of ${te} rows.`;return $&&D<P?`${K} Load more rows to continue.`:!$&&D<P?`${K} Preview limited by backend settings.`:K}return $?`Loaded ${U} rows. Additional rows available.`:`Loaded ${U} rows.`},[$,l,D,P]),z=_.useMemo(()=>(p.status==="idle"?[]:p.samplingAdjustments).map(Ak).map(te=>te.trim()).filter(Boolean),[p.samplingAdjustments,p.status]),F=p.status==="idle"?!1:p.largeDataset,q=_.useCallback(()=>{var H;if(!t||!$||p.status==="loading")return;const U=p.rows.length>0?p.rows:E,te=p.status==="idle"?U.length:p.nextOffset??U.length,K=Array.isArray((H=e.data)==null?void 0:H.sample_rows)?e.data.sample_rows:[];if(te<K.length){const Y=K.slice(te,te+Tl),Q=U.concat(Y),ne=te+Y.length,J=ne<K.length||typeof(C==null?void 0:C.total_rows)=="number"&&C.total_rows>K.length;h({status:"ready",columns:p.columns.length>0?p.columns:N,rows:Q,nextOffset:J?ne:null,hasMore:J,totalRows:typeof(C==null?void 0:C.total_rows)=="number"?C.total_rows:null,samplingAdjustments:p.samplingAdjustments,largeDataset:p.largeDataset,error:null});return}h(Y=>({...Y,status:"loading",error:null})),uy(t,{offset:te,limit:Tl}).then(Y=>{h(Q=>{const ne=Q.rows.length>0?Q.rows:U,J=Array.isArray(Y.columns)&&Y.columns.length>0?Y.columns.map(Me=>String(Me)):Q.columns.length>0?Q.columns:N,re=typeof Y.offset=="number"&&Y.offset>=0?Y.offset:0,Se=Array.isArray(Y.rows)?Y.rows:[],ze=re<=ne.length?ne.slice(0,re):ne.slice(),$e=re<=ne.length?ze.concat(Se):ne.concat(Se),Be=Se.length,it=!!Y.has_more,He=typeof Y.next_offset=="number"?Y.next_offset:it?re+Be:null,de=typeof Y.total_rows=="number"?Y.total_rows:null,ge=it?null:$e.length,Ne=de!==null?de:Q.totalRows!==null?Q.totalRows:ge;return{status:"ready",columns:[...J],rows:$e,nextOffset:He,hasMore:it,totalRows:Ne,samplingAdjustments:Array.isArray(Y.sampling_adjustments)?Y.sampling_adjustments:[],largeDataset:!!Y.large_dataset,error:null}})}).catch(Y=>{h(Q=>({...Q,status:"error",error:(Y==null?void 0:Y.message)??"Unable to load additional rows."}))})},[N,E,t,$,p,(L=e.data)==null?void 0:L.sample_rows,C]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),f&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${f.tone}`,role:"status","aria-live":f.isActive?"polite":"off",title:f.details.length>0?f.details.join(" "):void 0,children:f.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:x,children:y?"Refreshing":"Refresh"})})]}),f&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[f.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:f.details.map((U,te)=>a.jsx("li",{children:U},`${U}-${te}`))}),f.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>w(!b),"aria-expanded":b,children:[b?"":""," ",b?"Hide":"Show"," job details"]}),b&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:f.metadata.map((U,te)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:U.label}),a.jsx("dd",{children:U.value})]},`${U.label}-${U.value}-${te}`))})]})]}),y&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(Ok,{preview:e.data,columns:O,rows:R,tableNote:V,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:(f==null?void 0:f.stepLabel)??null,fullExecutionWarnings:(f==null?void 0:f.warnings)??[]}),p.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:p.error}),F&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",l(Tl)," rows to stay responsive."]}),z.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:z.map((U,te)=>a.jsx("li",{children:U},`${U}-${te}`))})]}),$&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:q,disabled:A,children:A?"Loading rows":`Load next ${l(Tl)} rows`})}),!$&&!y&&P!==null&&D>=P&&D>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},wi=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],$k=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:s,graphContext:i,profilingGraphSignature:l,formatRelativeTime:c})=>{var q;const[u,d]=_.useState({status:"idle",data:null,error:null}),[p,h]=_.useState(0),[f,g]=_.useState({}),[b,w]=_.useState("500"),[y,x]=_.useState("summary"),[N,E]=_.useState(!1),S=_.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${b}::${l}`,[t,e==null?void 0:e.id,l,b,n]),j=_.useMemo(()=>S?f[S]??null:null,[f,S]);_.useEffect(()=>{w("500"),d({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),_.useEffect(()=>{if(!t){d({status:"idle",data:null,error:null});return}if(!n){d({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!s){d({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(j){d({status:"success",data:j,error:null});return}let G=!0;d({status:"loading",data:null,error:null});const W=wi.find(I=>I.value===b)??wi[1]??wi[0],X=W.value==="all"?"all":Number(W.value);return oy(n,{sampleSize:X,graph:i,targetNodeId:(e==null?void 0:e.id)??null}).then(I=>{G&&(S&&I&&g(L=>({...L,[S]:I})),d({status:"success",data:I??null,error:null}))}).catch(I=>{G&&d({status:"error",data:null,error:(I==null?void 0:I.message)??"Unable to generate dataset profile"})}),()=>{G=!1}},[j,i,s,t,e==null?void 0:e.id,p,S,b,n]);const C=u.data,k=(C==null?void 0:C.generated_at)??null,O=((q=C==null?void 0:C.correlations)==null?void 0:q.length)??0;_.useEffect(()=>{E(!1),x("summary")},[t,k]),_.useEffect(()=>{y==="correlations"&&O===0&&x("summary")},[y,O]);const R=_.useCallback(()=>{S&&g(G=>{if(!Object.prototype.hasOwnProperty.call(G,S))return G;const W={...G};return delete W[S],W}),h(G=>G+1)},[S]),P=_.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),$=_.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),A=_.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),D=_.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),V=_.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),z=_.useMemo(()=>wi.find(G=>G.value===b)??wi[0],[b]),F=_.useMemo(()=>c((C==null?void 0:C.generated_at)??null),[c,C==null?void 0:C.generated_at]);return{profileState:u,profileData:C,profilingSamplePreset:b,setProfilingSamplePreset:w,profilingActiveTab:y,setProfilingActiveTab:x,isProfilingWarningsOpen:N,setIsProfilingWarningsOpen:E,handleRefreshDatasetProfile:R,activeProfilingSamplePreset:z,profilingWarningsListId:P,profilingSummaryPanelId:$,profilingCorrelationsPanelId:A,profilingSummaryTabId:D,profilingCorrelationsTabId:V,profilingCorrelationCount:O,relativeProfilingGeneratedAt:F}},Pk=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:s,formatMissingPercentage:i})=>{if(!e)return null;const{profileState:l,profileData:c,profilingSamplePreset:u,setProfilingSamplePreset:d,profilingActiveTab:p,setProfilingActiveTab:h,isProfilingWarningsOpen:f,setIsProfilingWarningsOpen:g,handleRefreshDatasetProfile:b,activeProfilingSamplePreset:w,profilingWarningsListId:y,profilingSummaryPanelId:x,profilingCorrelationsPanelId:N,profilingSummaryTabId:E,profilingCorrelationsTabId:S,profilingCorrelationCount:j,relativeProfilingGeneratedAt:C}=t,k=l.status==="success"&&!!c;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:wi.map(O=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":O.value===u,onClick:()=>d(O.value),disabled:l.status==="loading",children:O.label},O.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:b,disabled:l.status==="loading",children:l.status==="loading"?"Refreshing":"Refresh"})]})]}),C&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",C]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:w.label}),"."]}),l.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),l.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l.error}),k&&c&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",c.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",c.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",c.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",c.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",c.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:E,role:"tab","data-active":p==="summary","aria-selected":p==="summary","aria-controls":x,onClick:()=>h("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:S,role:"tab","data-active":p==="correlations","aria-selected":p==="correlations","aria-controls":N,onClick:()=>h("correlations"),disabled:!j,children:"Correlations"})]}),p==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:x,role:"tabpanel","aria-labelledby":E,children:[c.warnings&&c.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>g(O=>!O),"aria-expanded":f,"aria-controls":y,children:f?"Hide warnings":`Show warnings (${c.warnings.length})`}),f&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:y,children:c.warnings.map((O,R)=>a.jsx("li",{children:O},`profiling-warning-${R}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:c.columns.map(O=>{const R=O.numeric_summary,P=!!R,$=Array.isArray(O.top_values)?O.top_values:[],A=Array.isArray(O.sample_values)?O.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${O.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:O.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:O.semantic_type??O.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${i(O.missing_percentage)} (${O.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:O.distinct_count!==null?O.distinct_count.toLocaleString():""})]})]}),P?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",s(R==null?void 0:R.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",s(R==null?void 0:R.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",s(R==null?void 0:R.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",s(R==null?void 0:R.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",s(R==null?void 0:R.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",s(R==null?void 0:R.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",s(R==null?void 0:R.percentile_75)]})]})]}):null,$.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:$.map((D,V)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(D.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[D.count.toLocaleString()," (",D.percentage.toFixed(1),"%)"]})]},`${O.name}-top-${V}`))})]}):null,A.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:A.slice(0,5).map((D,V)=>a.jsx("li",{children:n(D)},`${O.name}-sample-${V}`))})]}):null]},O.name)})})]}),p==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:N,role:"tabpanel","aria-labelledby":S,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),c.correlations&&c.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:c.correlations.map((O,R)=>{const P=Math.abs(O.coefficient);let $="low";P>=.85?$="extreme":P>=.7?$="strong":P>=.55&&($="moderate");const A=O.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:O.column_a}),a.jsx("td",{children:O.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":$,"data-sign":A,children:O.coefficient.toFixed(2)})]},`profile-correlation-${R}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},Rk=({type:e})=>a.jsx("span",{"aria-hidden":"true",className:`canvas-modal__title-glyph${e==="dataset"?" canvas-modal__title-glyph--dataset":""}`,children:e==="dataset"?"":""}),Lk=({title:e,isDataset:t,onClose:n,canResetNode:s=!1,onResetNode:i})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx(Rk,{type:t?"dataset":"default"}),a.jsxs("div",{children:[a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e}),a.jsx("p",{className:"canvas-modal__subtitle",children:t?"Configure how this dataset feeds the pipeline.":"Adjust parameters to control this transformation."})]})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[s&&i&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,children:"Reset node"}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",children:""})]})]}),zk=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:s,canSave:i,onSave:l,isBusy:c,busyLabel:u})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsx("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":c,children:c&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:u??"Processing"})]})}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,children:"Reset node"}),s&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:l,disabled:!i,children:"Save changes"})]})]}),Is=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),Kn=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},xs=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return Is(t,n)},xy=e=>e==null||e===""?"":typeof e=="number"?xs(e):String(e),Dk=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},Fk=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},Ik=5,Bk=4,Uk=3,qk="_binned",wy="Missing",Hk=5,Vk="ordinal",Wk="quantile",Kk=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],Yk=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],_h={equal_width:"Equal-width",equal_frequency:"Equal-frequency",custom:"Custom edges",kbins:"KBins (sklearn)"},Gk=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],$l=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],Ny=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",s=Ke(e==null?void 0:e.columns),i=(F,q,G,W)=>{const X=Number(F);if(!Number.isFinite(X))return q;const I=Math.round(X);return Math.max(G,Math.min(W,I))},l=i(e==null?void 0:e.equal_width_bins,Ik,2,200),c=i(e==null?void 0:e.equal_frequency_bins,Bk,2,200),u=i(e==null?void 0:e.precision,Uk,0,8),d=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",p=!!((e==null?void 0:e.include_lowest)??!0),h=!!((e==null?void 0:e.drop_original)??!1),g=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||qk,b=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",w=["range","bin_index","ordinal","column_suffix"].includes(b)?b:"range",x=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",N=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",E=x==="label"&&N||wy,S=i(e==null?void 0:e.kbins_n_bins,Hk,2,200),j=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",C=["ordinal","onehot","onehot-dense"].includes(j)?j:Vk,k=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",O=["uniform","quantile","kmeans"].includes(k)?k:Wk,R=F=>{if(!Array.isArray(F))return[];const G=F.map(W=>{if(typeof W=="number")return W;if(W==null)return Number.NaN;const X=String(W).trim();return X?Number(X):Number.NaN}).filter(W=>Number.isFinite(W)).sort((W,X)=>W-X).filter((W,X,I)=>X===0||W!==I[X-1]);return G.length>=2?G:[]},P=F=>Array.isArray(F)?F.map(q=>String(q).trim()).filter(Boolean):typeof F=="string"?F.split(/[\,\n]/).map(q=>q.trim()).filter(Boolean):[],$=(F,q,G)=>{if(F==null)return null;const W=Number(F);if(!Number.isFinite(W))return null;const X=Math.round(W);return Math.max(q,Math.min(G,X))},A={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([F,q])=>{const G=String(F??"").trim();if(!G)return;const W=R(q);W.length>=2&&(A[G]=W)});const D={};e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([F,q])=>{const G=String(F??"").trim();if(!G)return;const W=P(q);W.length&&(D[G]=W)});const V={},z=e!=null&&e.column_strategies&&typeof e.column_strategies=="object"&&!Array.isArray(e.column_strategies)?e.column_strategies:e!=null&&e.column_overrides&&typeof e.column_overrides=="object"&&!Array.isArray(e.column_overrides)?e.column_overrides:null;return z&&Object.entries(z).forEach(([F,q])=>{const G=String(F??"").trim();if(!G||!q||typeof q!="object"||Array.isArray(q))return;const W=q,X={},I=typeof W.strategy=="string"?W.strategy.trim().toLowerCase():"";["equal_width","equal_frequency","custom","kbins"].includes(I)&&(X.strategy=I);const L=$(W.equal_width_bins,2,200);L!==null&&(X.equalWidthBins=L);const U=$(W.equal_frequency_bins,2,200);U!==null&&(X.equalFrequencyBins=U);const te=$(W.kbins_n_bins,2,200);te!==null&&(X.kbinsNBins=te);const K=typeof W.kbins_encode=="string"?W.kbins_encode.trim().toLowerCase():"";["ordinal","onehot","onehot-dense"].includes(K)&&(X.kbinsEncode=K);const H=typeof W.kbins_strategy=="string"?W.kbins_strategy.trim().toLowerCase():"";["uniform","quantile","kmeans"].includes(H)&&(X.kbinsStrategy=H);const Y=R(W.custom_bins);Y.length>=2&&(X.customBins=Y);const Q=P(W.custom_labels);Q.length>0&&(X.customLabels=Q),Object.keys(X).length>0&&(V[G]=X)}),{strategy:n,columns:s,equalWidthBins:l,equalFrequencyBins:c,includeLowest:p,precision:u,duplicates:d,outputSuffix:g,dropOriginal:h,labelFormat:w,missingStrategy:x,missingLabel:E,customBins:A,customLabels:D,columnStrategies:V,kbinsNBins:S,kbinsEncode:C,kbinsStrategy:O}},Qk=(e,t,n,s=_h)=>{if(!e.length)return null;const i=e.map(l=>{const c=t[l],u=(c==null?void 0:c.strategy)??null;if(!u)return l;const d=s[u]??u,p=[];u==="equal_width"&&(c!=null&&c.equalWidthBins)?p.push(`${c.equalWidthBins} bins`):u==="equal_frequency"&&(c!=null&&c.equalFrequencyBins)?p.push(`${c.equalFrequencyBins} bins`):u==="kbins"&&(c!=null&&c.kbinsNBins&&p.push(`${c.kbinsNBins} bins`),c!=null&&c.kbinsStrategy&&p.push(c.kbinsStrategy),c!=null&&c.kbinsEncode&&p.push(c.kbinsEncode));const h=p.length?` (${p.join(", ")})`:"";return`${l} -> ${d}${h}`});return n>e.length&&i.push(""),i.join(", ")},Xk=({config:e,fieldIds:t,onIntegerChange:n,onBooleanToggle:s,onSuffixChange:i,onLabelFormatChange:l,onMissingStrategyChange:c,onMissingLabelChange:u})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Global output & labeling"}),a.jsx("p",{className:"canvas-modal__note",children:"Applies to every selected column unless custom bins or labels override the defaults."}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.suffix,className:"canvas-modal__parameter-label",children:"Output suffix"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.suffix,type:"text",className:"canvas-modal__input",value:e.outputSuffix,onChange:d=>i(d.target.value),placeholder:"e.g. _binned"})})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.labelFormat,className:"canvas-modal__parameter-label",children:"Label format"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:t.labelFormat,value:e.labelFormat,onChange:d=>l(d.target.value??"range"),children:Yk.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Controls how new bin values are named when custom labels arent provided."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.precision,className:"canvas-modal__parameter-label",children:"Decimal precision"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.precision,type:"number",className:"canvas-modal__input",min:0,max:8,step:1,value:e.precision,onChange:d=>n("precision",d.target.value,0,8)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Sets rounding precision for interval labels."})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.includeLowest,children:"Include lowest edge"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.includeLowest,type:"checkbox",checked:e.includeLowest,onChange:d=>s("include_lowest",d.target.checked)}),"Include the minimum value in the first bin"]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.dropOriginal,children:"Drop original columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.dropOriginal,type:"checkbox",checked:e.dropOriginal,onChange:d=>s("drop_original",d.target.checked)}),"Remove source columns after binning"]})]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:Gk.map(d=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===d.value,onClick:()=>c(d.value),children:d.label},d.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:d=>u(d.target.value),placeholder:"e.g. Missing"})})]})]})]}),jy=e=>_h[e]??e.replace(/_/g," "),Jk=e=>{switch(e){case"high":return"High confidence";case"medium":return"Medium confidence";case"low":return"Low confidence";default:return"Confidence unknown"}},Zk=(e,t,n)=>{if(!e||typeof e!="object")return"No distribution summary";const s=[];typeof e.valid_count=="number"&&Number.isFinite(e.valid_count)&&s.push(`${t(e.valid_count)} valid rows`),typeof e.distinct_count=="number"&&Number.isFinite(e.distinct_count)&&s.push(`${t(e.distinct_count)} distinct values`);const i=typeof e.minimum=="number"&&Number.isFinite(e.minimum),l=typeof e.maximum=="number"&&Number.isFinite(e.maximum);if(i||l){const c=i?n(e.minimum):"",u=l?n(e.maximum):"";s.push(`Range ${c}  ${u}`)}return typeof e.skewness=="number"&&Number.isFinite(e.skewness)&&s.push(`Skew ${n(e.skewness)}`),s.length?s.join("  "):"No distribution summary"},eM=({hasSource:e,hasReachableSource:t,isFetching:n,error:s,relativeGeneratedAt:i,sampleSize:l,binningConfig:c,binningDefaultLabel:u,binningOverrideCount:d,binningOverrideSummary:p,recommendations:h,excludedColumns:f,numericColumnCount:g,canApplyAllNumeric:b,onApplyAllNumeric:w,onApplyStrategies:y,onClearOverrides:x,customEdgeDrafts:N,customLabelDrafts:E,onOverrideStrategyChange:S,onOverrideNumberChange:j,onOverrideKbinsEncodeChange:C,onOverrideKbinsStrategyChange:k,onOverrideClear:O,onCustomBinsChange:R,onCustomLabelsChange:P,onClearCustomColumn:$,formatMetricValue:A,formatNumericStat:D})=>{const V=_.useMemo(()=>e?t?n?"Diagnostics are loading":s?"Diagnostics are unavailable at the moment.":g>0?`Detected ${g} numeric column${g===1?"":"s"} in the current sample.`:f.length>0?`Diagnostics skipped ${f.length} column${f.length===1?"":"s"} (see details).`:"No additional diagnostics were produced for the current sample.":"Connect this step to an upstream output to surface diagnostics.":"Select a dataset to surface diagnostics.",[s,f.length,t,e,n,g]),z=_.useMemo(()=>{const I=f.slice(0,6),L=Math.max(0,f.length-I.length);return{preview:I,remaining:L}},[f]),F=_.useMemo(()=>{const I=new Map;return h.forEach(L=>{const U=typeof(L==null?void 0:L.column)=="string"?L.column.trim():"";U&&I.set(U,L)}),I},[h]),q=_.useMemo(()=>{const I=new Set;return c.columns.forEach(L=>{const U=String(L??"").trim();U&&I.add(U)}),Object.keys(c.columnStrategies).forEach(L=>{const U=String(L??"").trim();U&&I.add(U)}),h.forEach(L=>{const U=typeof(L==null?void 0:L.column)=="string"?L.column.trim():"";U&&I.add(U)}),Array.from(I).sort((L,U)=>L.localeCompare(U))},[c.columnStrategies,c.columns,h]),G=(I,L)=>{var U;return!I||Object.keys(I).length===0?"__default__":I.strategy?I.strategy:(U=I.customBins)!=null&&U.length?"custom":I.kbinsNBins||I.kbinsEncode||I.kbinsStrategy?"kbins":I.equalFrequencyBins?"equal_frequency":I.equalWidthBins?"equal_width":L},W=e&&t,X=I=>{var U,te;if(!I)return[];const L=[];return typeof I.equalWidthBins=="number"&&L.push(`${I.equalWidthBins} bins`),typeof I.equalFrequencyBins=="number"&&L.push(`${I.equalFrequencyBins} bins`),typeof I.kbinsNBins=="number"&&L.push(`${I.kbinsNBins} bins`),I.kbinsStrategy&&L.push(I.kbinsStrategy),I.kbinsEncode&&L.push(I.kbinsEncode),(U=I.customBins)!=null&&U.length&&L.push("Custom bins"),(te=I.customLabels)!=null&&te.length&&L.push("Custom labels"),L};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binning diagnostics"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:x,disabled:!d,children:"Clear"}),y&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:y,disabled:!h.length,children:"Quick apply"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:V}),a.jsxs("p",{className:"canvas-modal__note",children:["Default strategy ",a.jsx("strong",{children:u}),d>0?`  Overrides: ${d}${p?` (${p})`:""}`:"  No column overrides yet"]}),a.jsxs("div",{className:"canvas-modal__collapsible",children:[!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface binning insights and column diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),W&&a.jsxs(a.Fragment,{children:[i&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",i,l!==null?` on ${A(l)} row${l===1?"":"s"}.`:"."]}),w&&g>0&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:w,disabled:!b,children:`Add all numeric columns (${g})`})}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binning diagnostics"}),s&&!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s}),!s&&a.jsxs(a.Fragment,{children:[q.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested strategy"}),a.jsx("th",{scope:"col",children:"Configured strategy"}),a.jsx("th",{scope:"col",children:"Distribution highlights"})]})}),a.jsx("tbody",{children:q.map(I=>{var vt,at,ct,$t,Dt;const L=F.get(I)??null,U=c.columnStrategies[I],te=G(U,c.strategy),K=te==="__default__"?c.strategy:te,H=(L==null?void 0:L.recommended_strategy)??null,Y=!!(H&&H!==K),Q=!!(U&&Object.keys(U).length),ne=c.columns.includes(I),J=L==null?void 0:L.recommended_bins,re=typeof J=="number"?J:J!=null?Number(J):null,Se=typeof re=="number"&&Number.isFinite(re)&&re>0?re:null,ze=(U==null?void 0:U.equalWidthBins)??c.equalWidthBins,$e=(U==null?void 0:U.equalFrequencyBins)??c.equalFrequencyBins,Be=(U==null?void 0:U.kbinsNBins)??c.kbinsNBins,it=(U==null?void 0:U.kbinsEncode)??"__default__",He=(U==null?void 0:U.kbinsStrategy)??"__default__",de=["canvas-cast__row"];Y&&de.push("canvas-cast__row--attention"),Q&&de.push("canvas-cast__row--override"),ne||de.push("canvas-cast__row--muted");const ge=Zk(L==null?void 0:L.stats,A,D),Ne=((vt=L==null?void 0:L.reasons)==null?void 0:vt.filter(Qe=>Qe&&Qe.trim()))??[],Me=(()=>{const Qe=X(U),Ut=Array.isArray(c.customBins[I])?c.customBins[I].length>=2:!1,Yt=Array.isArray(c.customLabels[I])?c.customLabels[I].length>0:!1,Mt=[...Qe];return Ut&&!Mt.includes("Custom bins")&&Mt.push("Custom bins"),Yt&&!Mt.includes("Custom labels")&&Mt.push("Custom labels"),Mt})(),Ue=te==="__default__"?`Inheriting ${u}`:`Override  ${jy(K)}${Me.length?` (${Me.join(", ")})`:""}`,ce=(L==null?void 0:L.dtype)??null,Oe=L?Jk(L.confidence):null,Ge=Object.prototype.hasOwnProperty.call(N,I)?N[I]:((at=c.customBins[I])==null?void 0:at.join(", "))??"",ut=Object.prototype.hasOwnProperty.call(E,I)?E[I]:((ct=c.customLabels[I])==null?void 0:ct.join(", "))??"",rt=((($t=c.customBins[I])==null?void 0:$t.length)??0)>=2||(((Dt=c.customLabels[I])==null?void 0:Dt.length)??0)>0;return a.jsxs("tr",{className:de.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:I}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[ce&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",ce]}),!ne&&a.jsx("span",{className:"canvas-cast__muted",children:"Not currently in node"}),Q&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),Y&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--attention",children:"Needs review"})]})]})}),a.jsx("td",{children:a.jsx("div",{className:"canvas-cast__recommendation",children:L?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-cast__chip canvas-cast__chip--applied",children:jy(L.recommended_strategy)}),a.jsxs("span",{className:"canvas-cast__recommendation-note",children:[Se!==null?`${Se} bin${Se===1?"":"s"}`:"Bins not provided",Oe?`  ${Oe}`:""]}),Ne.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:Ne.join("; ")})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:te,onChange:Qe=>S(I,Qe.target.value,{recommendedBins:Se}),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",u,")"]}),Kk.map(Qe=>a.jsx("option",{value:Qe.value,children:Qe.label},`${I}-${Qe.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:Ue}),te==="equal_width"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:ze??"",onChange:Qe=>j(I,"equal_width_bins",Qe.target.value)})]})}),te==="equal_frequency"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:$e??"",onChange:Qe=>j(I,"equal_frequency_bins",Qe.target.value)})]})}),te==="kbins"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Max bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Be??"",onChange:Qe=>j(I,"kbins_n_bins",Qe.target.value)})]}),a.jsxs("label",{children:["Encode",a.jsxs("select",{value:it,onChange:Qe=>C(I,Qe.target.value==="__default__"?null:Qe.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsEncode,")"]}),a.jsx("option",{value:"ordinal",children:"Ordinal"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})]}),a.jsxs("label",{children:["Strategy",a.jsxs("select",{value:He,onChange:Qe=>k(I,Qe.target.value==="__default__"?null:Qe.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsStrategy,")"]}),a.jsx("option",{value:"uniform",children:"Uniform"}),a.jsx("option",{value:"quantile",children:"Quantile"}),a.jsx("option",{value:"kmeans",children:"K-means"})]})]})]}),te==="custom"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Custom edges",a.jsx("input",{type:"text",className:"canvas-modal__input",value:Ge,placeholder:"e.g. 0, 50, 100",onChange:Qe=>R(I,Qe.target.value)})]}),a.jsxs("label",{children:["Optional labels",a.jsx("input",{type:"text",className:"canvas-modal__input",value:ut,placeholder:"e.g. Low, Medium, High",onChange:Qe=>P(I,Qe.target.value)})]}),rt&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>$(I),children:"Clear custom edges"})]}),Q&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>O(I),children:"Clear"})]})}),a.jsx("td",{children:a.jsx("span",{children:ge})})]},`binning-insight-${I}`)})})]})})}),!n&&q.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"No columns met the sampling requirements for binning recommendations."}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",f.length," column",f.length===1?"":"s"," due to non-numeric values or limited variance",z.preview.length>0&&a.jsxs(a.Fragment,{children:[":"," ",z.preview.map(I=>`${I.column}${I.reason?` (${I.reason})`:""}`).join(", "),z.remaining>0?`,  (+${z.remaining} more)`:""]}),"."]})]})]})]})]})},tM=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:s,sampleSize:i,relativeGeneratedAt:l,error:c,onRefresh:u,canRefresh:d})=>{const p=_.useMemo(()=>$l.find(h=>h.value===t)??$l[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:$l.map(h=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":h.value===t,onClick:()=>n(h.value),disabled:s,children:h.label},h.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:u,disabled:s||!d,children:s?"Refreshing":"Refresh"})]})]}),i!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:p.label}),"."," ",p.value==="all"?`Summaries computed from the full dataset (${i.toLocaleString()} rows).`:`Summaries computed from ${i.toLocaleString()} sampled rows.`]}),l&&a.jsxs("p",{className:"canvas-modal__note",children:["Updated ",l]}),s&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!s&&c&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:c}),!s&&!c&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(h=>{const f=h.topPercentage!==null?`${h.topPercentage.toFixed(1)}%`:null,g=h.topCount!==null?`${h.topCount.toLocaleString()}${f?`  ${f}`:""}`:f??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:h.column}),h.sourceColumn&&h.sourceColumn!==h.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:h.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:h.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:g})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:h.bins.map(b=>{const w=b.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",y=Math.min(100,Math.max(0,b.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:w,children:b.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${y}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:b.count.toLocaleString()}),a.jsxs("span",{children:[b.percentage.toFixed(1),"%"]})]})]},`${h.column}-${b.label}`)})}),h.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",h.bins.length," of ",h.totalBinCount," bins."]})]},`binned-card-${h.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},nM=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],sM=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],rM=[...nM,...sM],aM=[0,5,10,20,40,60],oM=["float","double","int","uint","long","short","byte","number","decimal"],iM=["bool","boolean"],lM=["object","string","category","datetime","date","time"],cM=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:lM.some(n=>t.includes(n))?!1:!!(oM.some(n=>t.includes(n))||iM.some(n=>t.includes(n)))},Cy=e=>e!=="mode",Sy=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},Pl=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,s=Number(n);return{neighbors:Number.isFinite(s)?Math.max(1,Math.round(s)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,s=Number(n);return{max_iter:Number.isFinite(s)?Math.max(1,Math.round(s)):10}}},Ey=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",s=new Set(t);return e.map(i=>{if(!i||typeof i!="object")return null;const l=typeof i.method=="string"?i.method.trim().toLowerCase():n,c=s.has(l)?l:n;let u=[];Array.isArray(i.columns)?u=i.columns.map(f=>String(f).trim()).filter(Boolean):typeof i.columns=="string"&&(u=i.columns.split(",").map(f=>f.trim()).filter(Boolean));const d=i.options&&typeof i.options=="object"?i.options:{};let p;if(c==="knn"){const f=d.neighbors??i.neighbors,g=Number(f);p={neighbors:Number.isFinite(g)?Math.max(1,Math.round(g)):5}}else if(c==="regression"||c==="mice"){const f=d.max_iter??d.maxIter??i.max_iter??i.maxIter,g=Number(f);p={max_iter:Number.isFinite(g)?Math.max(1,Math.round(g)):10}}const h=Pl(c,p??Sy(c));return{method:c,columns:u,options:h}}).filter(i=>!!i)},uM=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),dM=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:s,methodOptions:i,missingFilter:l,missingFilterMax:c,missingFilterActive:u,filteredOptionCount:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onMethodChange:b,onOptionNumberChange:w,onColumnsChange:y,onColumnToggle:x,onMissingFilterChange:N,formatMissingPercentage:E,formatNumericStat:S,formatModeStat:j,schemaDiagnostics:C})=>{const k=_e.useMemo(()=>{var $;return($=C==null?void 0:C.entries)!=null&&$.length?new Map(C.entries.map(A=>[A.index,A])):new Map},[C]),O=Math.max(c,l||0),R=s.length>0,P=$=>{var D,V,z;const A=((D=i.find(F=>F.value===$.method))==null?void 0:D.label)??$.method;return $.method==="knn"&&((V=$.options)!=null&&V.neighbors)?`${A}  k=${$.options.neighbors}`:($.method==="regression"||$.method==="mice")&&((z=$.options)!=null&&z.max_iter)?`${A}  ${$.options.max_iter} iter`:A};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(C==null?void 0:C.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:C.message}),s.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",d," of ",s.length," column",s.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx("input",{id:"imputer-missing-filter",type:"range",min:0,max:O,step:1,value:l,onChange:$=>N(Number($.target.value)),className:"canvas-imputer__filter-range"}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[l,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>N(0),disabled:!l,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:aM.map($=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${l===$?" canvas-imputer__filter-button--active":""}`,onClick:()=>N($),children:["",$,"%"]},`imputer-missing-preset-${$}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map(($,A)=>{var U,te,K;const D=$.columns.join(", "),V=Cy($.method),z=s.filter(H=>{if($.columns.includes(H.name))return!0;if(V&&!cM(H))return!1;const Y=typeof H.missingPercentage=="number"?H.missingPercentage:null;return Y!==null?Y<=0?!1:Y>=l:l===0}),F=P($),q=$.columns.length?`${$.columns.length} column${$.columns.length===1?"":"s"}`:"No columns yet",G=p.has(A),W=z.filter(H=>!$.columns.includes(H.name)),X=k.get(A),I=(U=X==null?void 0:X.details)!=null&&U.length?X.details.map(H=>H.logical_family?`${H.name} (${H.logical_family})`:H.name).join(", "):"",L=()=>{if(!z.length)return;const H=[...$.columns];z.forEach(Y=>{H.includes(Y.name)||H.push(Y.name)}),y(A,H.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(A),"aria-expanded":!G,"aria-controls":`imputer-strategy-body-${A}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${G?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",A+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[F,"  ",q]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(A),"aria-label":`Remove strategy ${A+1}`,children:"Remove"})]}),!G&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${A}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Method"}),a.jsx("select",{value:$.method,onChange:H=>b(A,H.target.value??"mean"),children:i.map(H=>a.jsx("option",{value:H.value,children:H.label},H.value))})]}),$.method==="knn"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Neighbors (k)"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:50,step:1,value:((te=$.options)==null?void 0:te.neighbors)??5,onChange:H=>w(A,"neighbors",H.target.value)})]}),($.method==="regression"||$.method==="mice")&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Max iterations"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:100,step:1,value:((K=$.options)==null?void 0:K.max_iter)??10,onChange:H=>w(A,"max_iter",H.target.value)})]}),$.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),I&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",I,"."]}),z.length>0&&W.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:L,children:"Select all columns"}),z.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:z.map(H=>{const Y=$.columns.includes(H.name),Q=E(H.missingPercentage),ne=typeof H.mean=="number",J=typeof H.median=="number",re=H.mode!==null&&H.mode!==void 0&&H.mode!=="",Se=ne||J||re;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Y?" canvas-imputer__column-pill--selected":""}`,onClick:()=>x(A,H.name),"aria-pressed":Y,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:H.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",Q]}),H.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:H.dtype})]}),Se&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[ne&&a.jsxs("span",{children:["Mean: ",S(H.mean)]}),J&&a.jsxs("span",{children:["Median: ",S(H.median)]}),re&&a.jsxs("span",{children:["Mode: ",j(H.mode)]})]})]},H.name)})}):a.jsx("p",{className:"canvas-modal__note",children:R?u?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${$.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:$.columns.length?$.columns.map(H=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:H},H)):a.jsx("span",{children:"No columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Manual columns (optional)"}),a.jsx("input",{type:"text",className:"canvas-imputer__columns-input",value:D,onChange:H=>y(A,H.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${A}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},mM=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:s,scalingMethodOptions:i,scalingMethodDetailMap:l,scalingDefaultDetail:c,scalingAutoDetectEnabled:u,scalingSelectedCount:d,scalingDefaultLabel:p,scalingOverrideCount:h,scalingOverrideExampleSummary:f,scalingRecommendationRows:g,scalingHasRecommendations:b,scalingStatusMessage:w,scalingError:y,scalingSampleSize:x,relativeScalingGeneratedAt:N,formatMetricValue:E,formatNumericStat:S,formatMissingPercentage:j,onApplyAllRecommendations:C,onClearOverrides:k,onDefaultMethodChange:O,onAutoDetectToggle:R,onOverrideSelect:P})=>{const $=c??l.get(s.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:C,disabled:!b,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:k,disabled:!h,children:"Clear overrides"})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),N&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",N,x!==null?` on ${E(x)} row${x===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:i.map(A=>{const D=l.get(A.value)??null,V=A.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${V?" canvas-scaling__method-button--active":""}`,"aria-pressed":V,onClick:()=>O(A.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:A.label}),(D==null?void 0:D.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:D.description})]},A.value)})}),($==null?void 0:$.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:$.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:A=>R(A.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"When enabled, recommended numeric features join this node automatically after each refresh."})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",h>0?`  Overrides: ${h}${f?` (${f})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&y&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:y}),!n&&!y&&a.jsxs(a.Fragment,{children:[w&&a.jsx("p",{className:"canvas-modal__note",children:w}),g.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:g.map(A=>{const D=!A.isSkipped&&A.recommendedMethod!==A.currentMethod,V=["canvas-cast__row"];D&&V.push("canvas-cast__row--attention"),A.isOverrideApplied&&V.push("canvas-cast__row--override"),A.isSkipped&&V.push("canvas-cast__row--muted");const z=A.isSkipped?"__skip__":A.isOverrideApplied?A.currentMethod:"__default__",F=A.isOverrideApplied?`Override -> ${A.currentMethodLabel}`:A.isSkipped?"Skipped (column will not be scaled)":A.isSelected?`Inheriting ${p}`:"Pending inclusion",q=A.stats,G=[];typeof q.valid_count=="number"&&Number.isFinite(q.valid_count)&&G.push(`${E(q.valid_count)} valid rows`),typeof q.mean=="number"&&Number.isFinite(q.mean)&&G.push(`Mean ${S(q.mean)}`),typeof q.median=="number"&&Number.isFinite(q.median)&&G.push(`Median ${S(q.median)}`),typeof q.stddev=="number"&&Number.isFinite(q.stddev)&&G.push(` ${S(q.stddev)}`),typeof q.iqr=="number"&&Number.isFinite(q.iqr)&&G.push(`IQR ${S(q.iqr)}`);const W=typeof q.minimum=="number"&&Number.isFinite(q.minimum),X=typeof q.maximum=="number"&&Number.isFinite(q.maximum);if(W||X){const L=W?S(q.minimum):"",U=X?S(q.maximum):"";G.push(`Range ${L}  ${U}`)}typeof q.skewness=="number"&&Number.isFinite(q.skewness)&&G.push(`Skew ${S(q.skewness)}`),typeof q.outlier_ratio=="number"&&Number.isFinite(q.outlier_ratio)&&q.outlier_ratio>0&&G.push(`${j(q.outlier_ratio*100)} outliers`);const I=G.length?G.join("  "):null;return a.jsxs("tr",{className:V.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:A.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[A.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",A.dtype]}),A.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),A.isSelected&&!A.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),A.isSkipped&&!A.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),A.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${D?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:A.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:A.confidenceLabel}),A.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:A.reasons.join("; ")})]})}),a.jsx("td",{children:I?a.jsx("span",{children:I}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:z,onChange:L=>P(A.column,L.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),i.map(L=>a.jsx("option",{value:L.value,children:L.label},`${A.column}-${L.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:F})]})})]},`scaling-row-${A.column}`)})})]})})})]})]})},ju=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],hM="log",qr=e=>typeof e=="string"&&ju.includes(e),ky=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",s=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const i=qr(s)?s:hM;return{column:n,method:i}}).filter(t=>!!t):[],vh=e=>{const t=new Set,n=[];return e.forEach(s=>{const i=`${s.column}__${s.method}`;t.has(i)||(t.add(i),n.push(s))}),n},My={left:"Left skew",right:"Right skew"},fM={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},pM=e=>{const t={...fM};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!s||!i||qr(s)&&(t[s]=i)}),t},gM=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:s,transformationMap:i})=>{const l=e==="recommended"?t.map(d=>d!=null&&d.column?d.column:null).filter(d=>!!d):n,c=new Set,u=[];return l.forEach(d=>{const p=typeof d=="string"?d.trim():"";if(!p||c.has(p))return;c.add(p);const h=s.get(p)??null,f=h?h.recommended_methods.filter(qr):[],g=f.length?f[0]:null,b=h!=null&&h.direction?My[h.direction]??h.direction:null,w=h!=null&&h.magnitude?`${h.magnitude.charAt(0).toUpperCase()}${h.magnitude.slice(1)}`:null,y=h&&typeof h.skewness=="number"&&Number.isFinite(h.skewness)?h.skewness:null,x=(h==null?void 0:h.summary)??null,N=i.get(p)??null;u.push({column:p,recommendedMethods:f,primaryMethod:g,directionLabel:b,magnitudeLabel:w,skewnessValue:y,summary:x,selectedMethod:N})}),u.sort((d,p)=>{const h=typeof d.skewnessValue=="number"?Math.abs(d.skewnessValue):-1/0,f=typeof p.skewnessValue=="number"?Math.abs(p.skewnessValue):-1/0;if(h!==f)return f-h;const g=!!d.primaryMethod,b=!!p.primaryMethod;return g!==b?g?-1:1:d.column.localeCompare(p.column)}),u},_M=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const s="no-recommendation",i=new Map;e.forEach(c=>{const u=c.primaryMethod??null,d=u??s,p=u?n(u):"No recommended action",h=i.get(d)??{key:d,label:p,method:u,rows:[]};h.rows.push(c),i.set(d,h)});const l=Array.from(i.values());return l.sort((c,u)=>{const d=g=>g?ju.indexOf(g):ju.length,p=d(c.method)-d(u.method);if(p!==0)return p;if(c.rows.length!==u.rows.length)return u.rows.length-c.rows.length;const h=c.label??"",f=u.label??"";return h.localeCompare(f)}),l},vM=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:s,skewnessError:i,skewnessViewMode:l,skewnessRecommendedCount:c,skewnessNumericCount:u,skewnessGroupByMethod:d,skewnessRows:p,skewnessTableGroups:h,hasSkewnessAutoRecommendations:f,skewnessTransformationsCount:g,isFetchingRecommendations:b,getSkewnessMethodLabel:w,getSkewnessMethodStatus:y,onApplyRecommendations:x,onViewModeChange:N,onGroupByToggle:E,onOverrideChange:S,onClearSelections:j})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:x,disabled:b||!f,children:"Apply recommendations"})})]}),s!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",s.toFixed(2)," are surfaced below."]}),n&&p.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&i&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i}),(!n||p.length>0)&&!i&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="recommended",onClick:()=>N("recommended"),disabled:!c,children:["Recommended (",c,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="all",onClick:()=>N("all"),disabled:!u,children:["All numeric (",u,")"]})]}),a.jsxs("label",{className:"canvas-skewness__toggle",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:C=>E(C.target.checked)}),"Group columns by recommended action"]})]}),p.length===0?a.jsx("p",{className:"canvas-modal__note",children:l==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:h.map(C=>a.jsxs("div",{className:"canvas-skewness__group",children:[C.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:C.label}),a.jsxs("span",{children:[C.rows.length," column",C.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:C.rows.map(k=>{const O=[];k.directionLabel&&O.push(k.directionLabel),k.skewnessValue!==null&&O.push(`(${k.skewnessValue.toFixed(2)})`),k.magnitudeLabel&&O.push(` ${k.magnitudeLabel}`);const R=O.length?O.join(" "):"",P=k.selectedMethod??"",$=new Set(k.recommendedMethods),A=[{value:"",label:"No transform",status:null,reason:null}];k.recommendedMethods.forEach(z=>{const F=y(k.column,z);A.push({value:z,label:`${w(z)}${z===k.primaryMethod?" (recommended)":""}`,status:F,reason:(F==null?void 0:F.reason)??null})}),ju.forEach(z=>{if($.has(z))return;const F=y(k.column,z);A.push({value:z,label:w(z),status:F,reason:(F==null?void 0:F.reason)??null})});const D=k.selectedMethod?y(k.column,k.selectedMethod):null,V=!k.selectedMethod&&k.primaryMethod?y(k.column,k.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${k.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:k.column}),k.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:k.summary})]})}),a.jsx("td",{children:k.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${k.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:k.primaryMethod?w(k.primaryMethod):w(k.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:R})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx("select",{value:P,onChange:z=>S(k.column,z.target.value),disabled:b||!t,children:A.map(z=>{var G;const F=z.reason?`${z.label} (caution: ${z.reason})`:z.label,q=((G=z.status)==null?void 0:G.status)??"ready";return a.jsx("option",{value:z.value,"data-status":q,children:F},`skewness-option-${k.column}-${z.value||"none"}`)})}),D&&D.status!=="ready"&&D.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",D.reason]}),!k.selectedMethod&&V&&V.status!=="ready"&&V.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",V.reason]})]})})]},`skewness-row-${k.column}`)})})]})})]},`skewness-group-${C.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:g?`${g} transformation${g===1?"":"s"} configured`:"No transformations configured yet."}),g>0&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:j,children:"Clear selections"})]})]})]}),yM=({counts:e,binEdges:t,className:n})=>{const s=_.useId(),i=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:i,"aria-hidden":"true"});const l=e.reduce((d,p)=>Math.max(d,p),0),c=l>0?l:1,u=100/e.length;return a.jsx("div",{className:i,role:"img","aria-label":"Histogram sparkline",children:a.jsxs("svg",{viewBox:"0 0 100 60",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((d,p)=>{const h=d/c*52,f=p*u,g=58-h,b=Math.max(u-2,1);return a.jsx("rect",{x:f+1,y:g,width:b,height:h,rx:1.2,ry:1.2,fill:`url(#${s})`},`hist-bin-${p}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},bM=({skewnessThreshold:e,isFetchingSkewness:t,skewnessError:n,skewnessDistributionCards:s,skewnessDistributionView:i,setSkewnessDistributionView:l,onRefresh:c,canRefresh:u})=>{const d=(p,h,f)=>{const g=Math.max(0,p.sample_size||0),b=Math.max(0,p.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:h}),f?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:f}):null]}),a.jsx(yM,{counts:p.counts,binEdges:p.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:xs(p.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:xs(p.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:xs(p.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:xs(p.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:xs(p.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:g.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:b.toLocaleString()})]})]})]},h)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="before",onClick:()=>l("before"),disabled:!s.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="after",onClick:()=>l("after"),disabled:!s.length,children:"After"})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:c,disabled:t||!u,children:t?"Refreshing":"Refresh"})]})]}),e!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",e.toFixed(2)," are visualized below."]}),t&&s.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!t&&n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n}),(!t||s.length>0)&&!n&&(s.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:s.map(p=>{const h=p.distributionAfter,f=i==="before",g=i==="after"&&!!h,b=i==="after"&&!h,w=i==="before"?"Showing the original distribution returned by the skewness analysis.":h?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${p.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:p.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[p.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.directionLabel}),p.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:p.magnitudeLabel}),p.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",p.recommendedLabel]}),p.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",p.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:p.skewness!==null?Is(p.skewness,2):""})]})]}),p.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:p.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[f?d(p.distributionBefore,"Before transform"):null,g&&h?d(h,"After transform",p.appliedLabel):null,b?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",w]})]},`skewness-dist-${p.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]})},xM=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:s,flaggedColumnsInDataset:i,conflictCount:l}=t,c=s.length>0,u=e||"(no suffix)",d=i.slice(0,4),p=Math.max(i.length-d.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:s.length})," flag column",s.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:u}),"."]}),i.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",i.length," existing flag column",i.length===1?"":"s"," ","with this suffix",d.length>0?` (examples: ${d.join(", ")}${p>0?", ":""})`:"","."]}),l>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l," generated flag column",l===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),c?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:s.map(h=>{const f=[];h.conflicts.alreadyExists&&f.push("Already exists"),h.conflicts.duplicateFlag&&f.push("Duplicate name");const g=f.length>0,b=g?f.join("  "):"Ready",w=g?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",y=g?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:y,children:[a.jsx("th",{scope:"row",children:h.column}),a.jsx("td",{children:n(h.missingPercentage)}),a.jsx("td",{children:h.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:w,children:b})})]},`missing-indicator-${h.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},Ay=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],yh="canonicalize_country_codes",wM=new Set(Ay),NM=["string","object","text","category","mixed","varchar","char"],jM=4,CM=6,bo=4,SM=3,Oy=36,EM=5,bh={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},Ty=Ay.map(e=>{var t;return{value:e,label:((t=bh[e])==null?void 0:t.label)??e}}),kM=new Set(["true","1","yes","y","on"]),MM=new Set(["false","0","no","n","off"]),AM=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(kM.has(n))return!0;if(MM.has(n))return!1}return t},xh=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?xh(e.split(",")):[],$y=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,s=xh(n.columns),i=AM(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),l=Su(typeof n.mode=="string"?n.mode:void 0,t.mode);return!s.length&&!i?null:{mode:l,columns:s,autoDetect:i}},Py=(e,t)=>{const n={mode:t.mode,columns:xh(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const i=$y(e,n);return i?[i]:[n]}const s=[];return e.forEach(i=>{const l=$y(i,n);l&&s.push(l)}),s.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):s},OM=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),TM=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),Cu=e=>e.length<=Oy?e:`${e.slice(0,Oy-1)}...`,Ry=e=>wM.has(e),Ly=e=>{if(!e)return!1;const t=e.toLowerCase();return NM.some(n=>t.includes(n))},Su=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Ry(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Ry(s)?s:yh},$M=e=>{const t=bh[e]??bh[yh];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},PM=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:s})=>{const i=Array.from(new Set(Ke(e))),l=new Set(i),c=t.filter(h=>Ly(n[h]??null)),u=c.filter(h=>!l.has(h)),d=i.filter(h=>!Ly(n[h]??null)),p=typeof s=="boolean"?s:i.length===0;return{selectedColumns:i,nonTextSelected:d,autoDetectionActive:p,recommendedColumns:u,textColumnCount:c.length,textColumns:c}},RM=/[\n;,]+/,Ni=(e,t)=>e.slice(0,t),Eu=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[s,...i]=n,l=i.join(t);return[s,l]},LM=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],s=[],i=new Map;let l=0;const c=(h,f)=>{const g=String(h??"").trim(),b=String(f??"").trim();if(!g||!b){(g||b)&&n.push(`${g} => ${b}`.trim());return}const w=TM(g);if(!w){n.push(`${g} => ${b}`);return}i.has(w)?t.add(g):(i.set(w,b),s.length<jM&&s.push(`${g} => ${b}`)),l+=1};if(typeof e=="string"){e.split(RM).forEach(w=>{const y=w.trim();if(y){if(y.includes("=>")){const x=Eu(y,"=>");x?c(x[0],x[1]):n.push(y);return}if(y.includes(":")){const x=Eu(y,":");x?c(x[0],x[1]):n.push(y);return}n.push(y)}});const f=Array.from(t),g=Ni(f,bo),b=Ni(n,bo);return{totalPairs:l,previewPairs:s,previewOverflow:Math.max(l-s.length,0),duplicates:g,duplicateOverflow:Math.max(f.length-g.length,0),invalidEntries:b,invalidOverflow:Math.max(n.length-b.length,0)}}if(Array.isArray(e)){e.forEach(b=>{if(b){if(typeof b=="string"){const w=b.trim();if(!w)return;if(w.includes("=>")){const y=Eu(w,"=>");y?c(y[0],y[1]):n.push(w)}else if(w.includes(":")){const y=Eu(w,":");y?c(y[0],y[1]):n.push(w)}else n.push(w);return}if(typeof b=="object"){const{alias:w,replacement:y}=b;c(w,y);return}n.push(String(b))}});const h=Array.from(t),f=Ni(h,bo),g=Ni(n,bo);return{totalPairs:l,previewPairs:s,previewOverflow:Math.max(l-s.length,0),duplicates:f,duplicateOverflow:Math.max(h.length-f.length,0),invalidEntries:g,invalidOverflow:Math.max(n.length-g.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([h,f])=>{c(h,f)});const u=Array.from(t),d=Ni(u,bo),p=Ni(n,bo);return{totalPairs:l,previewPairs:s,previewOverflow:Math.max(l-s.length,0),duplicates:d,duplicateOverflow:Math.max(u.length-d.length,0),invalidEntries:p,invalidOverflow:Math.max(n.length-p.length,0)}},zM=e=>{const t=e.slice(0,CM);return{preview:t,remaining:Math.max(e.length-t.length,0)}},DM=e=>{const t=e.slice(0,bo);return{preview:t,remaining:Math.max(e.length-t.length,0)}},FM=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Cu(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?Cu(t):null}try{const t=JSON.stringify(e);return t?Cu(t):null}catch{return Cu(String(e))}},IM=(e,t=SM)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;const u=FM(l);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},BM=(e,t,n=EM)=>{if(!t.length)return[];const s=[];for(const i of t){if(s.length>=n)break;const l=e[i];!l||!l.length||s.push({column:i,values:l,overflow:0})}return s},wh=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),zy=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],Dy=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);zy.forEach(e=>{e.forEach(t=>Dy.add(wh(t)))});const Fy=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],Iy=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);Fy.forEach(e=>{e.forEach(t=>Iy.add(wh(t)))});const UM=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],qM=/^[A-Za-z]{2,3}$/,HM=/[^0-9A-Za-z\s]/,VM=/[^0-9A-Za-z]+/,ku={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:zy},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:Fy},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:UM},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},WM=e=>{const t=[];return e.forEach(n=>{n.split(VM).filter(Boolean).forEach(i=>{t.push(i)})}),t},KM=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(s=>HM.test(s));const n=WM(t).map(s=>wh(s));return n.length?e==="canonicalize_country_codes"?n.some(s=>Dy.has(s))||t.some(s=>qM.test(s.trim())):e==="normalize_boolean"?n.some(s=>Iy.has(s)):!1:!1},By=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},YM=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:i,sampleMap:l,modeOptions:c=Ty,customPairSummary:u,customPairsParameter:d,collapsedStrategies:p,onToggleStrategy:h,onRemoveStrategy:f,onAddStrategy:g,onModeChange:b,onAutoDetectToggle:w,onColumnToggle:y,onColumnsChange:x,renderParameterField:N})=>{const E=n.length>0,S=s.selectedColumns.length,j=_.useMemo(()=>zM(s.recommendedColumns),[s.recommendedColumns]),C=_.useMemo(()=>DM(s.nonTextSelected),[s.nonTextSelected]),k=_.useMemo(()=>BM(l,s.selectedColumns),[s.selectedColumns,l]),O=!e||!t,R=u.duplicates.length+u.duplicateOverflow,P=u.invalidEntries.length+u.invalidOverflow,$=u.duplicates.join(", "),A=u.invalidEntries.join(", "),D=_.useMemo(()=>n.some(K=>K.mode==="custom"),[n]),V=_.useMemo(()=>{const K=new Map;return n.forEach(H=>{H.columns.forEach(Y=>{const Q=Y.trim();Q&&K.set(Q,(K.get(Q)??0)+1)})}),K},[n]),[z,F]=_.useState(()=>new Set),q=_.useCallback(K=>{F(H=>{const Y=new Set(H);return Y.has(K)?Y.delete(K):Y.add(K),Y})},[]);_.useEffect(()=>{F(K=>{const H=new Set;return K.forEach(Y=>{Y<n.length&&H.add(Y)}),H.size===K.size?K:H})},[n.length]);const[G,W]=_.useState(()=>({index:null,mode:null})),X=_.useMemo(()=>{const K=new Map;return i.forEach(H=>{const Y=Array.isArray(H.samples)?H.samples:[],Q=Array.isArray(l[H.name])?l[H.name]:[],ne=[...Y,...Q].map(J=>String(J??"").trim()).filter(J=>J.length>0);K.set(H.name,ne.slice(0,12))}),K},[i,l]),I=_.useMemo(()=>{const K=new Map;return i.forEach(H=>{const Y=X.get(H.name)??[],Q=Y.length?Y:[H.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(ne=>{KM(ne,Q)&&(K.has(ne)||K.set(ne,new Set),K.get(ne).add(H.name))})}),K},[i,X]);_.useEffect(()=>{if(G.index===null)return;const K=n[G.index];(!K||K.mode!==G.mode)&&W({index:null,mode:null})},[G.index,G.mode,n]);const L=_.useCallback((K,H)=>{W({index:K,mode:H})},[]),U=_.useCallback(()=>{W({index:null,mode:null})},[]);let te=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),s.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:S})," column",S===1?"":"s"," across all strategies."]}),k.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",k.map(K=>`${K.column} (${K.values.join(", ")})`).join("; "),"."]}),s.textColumnCount>0&&j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[C.preview.join(", ")," ",C.preview.length===1?"is":"are"," not text-like.",C.remaining>0?` ${C.remaining} more column${C.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),O?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!E&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),E&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((K,H)=>{var Ue;const Y=$M(K.mode),Q=((Ue=c.find(ce=>ce.value===K.mode))==null?void 0:Ue.label)??Y.label,ne=K.columns.length,J=ne?`${ne} column${ne===1?"":"s"}`:K.autoDetect?"Auto-detecting columns":"No columns yet",re=p.has(H),Se=z.has(H),ze=K.columns.join(", "),$e=I.get(K.mode)??new Set,Be=K.mode==="custom"&&!!d&&!te,it=K.mode==="custom"&&!!d&&te;Be&&(te=!0);const He=i.map(ce=>{const Oe=K.columns.includes(ce.name),Ge=$e.has(ce.name),ut=Oe?0:Ge?1:ce.isRecommended?2:ce.isTextLike?3:4;return{option:ce,priority:ut}}).sort((ce,Oe)=>ce.priority!==Oe.priority?ce.priority-Oe.priority:ce.option.name.localeCompare(Oe.option.name)).map(ce=>ce.option),de=$e.size>0,ge=He.filter(ce=>K.columns.includes(ce.name)?!0:de?$e.has(ce.name):ce.isRecommended||ce.isTextLike),Ne=new Set(ge.map(ce=>ce.name)),Me=He.filter(ce=>!Ne.has(ce.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(H),"aria-expanded":!re,"aria-controls":`alias-strategy-body-${H}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${re?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",H+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[Q,K.autoDetect?"  auto-detect":"",J?`  ${J}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>f(H),"aria-label":`Remove alias strategy ${H+1}`,children:"Remove"})]}),!re&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${H}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[c.map(ce=>{const Oe=ce.value===K.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${Oe?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":Oe,onClick:()=>b(H,ce.value),children:ce.label},ce.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>L(H,K.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:Y.guidance})]}),G.index===H&&G.mode===K.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:ku[K.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:U,children:"Close"})]}),a.jsx("p",{children:ku[K.mode].description}),ku[K.mode].preview&&a.jsx("ul",{children:ku[K.mode].preview.map(([ce,Oe])=>a.jsxs("li",{children:[ce," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",Oe]},`${ce}-${Oe}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${H}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${H}-auto-detect`,type:"checkbox",checked:K.autoDetect,onChange:ce=>w(H,ce.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${H}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),i.length?a.jsxs(a.Fragment,{children:[$e.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",Q.toLowerCase()," entries."]}),ge.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${H+1}`,children:ge.map(ce=>{const Oe=K.columns.includes(ce.name),Ge=By(ce.samples.length?ce.samples:l[ce.name]??[]),rt=(V.get(ce.name)??0)-(Oe?1:0)>0,vt=$e.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Oe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>y(H,ce.name),"aria-pressed":Oe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),ce.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),vt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),rt&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Ge&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Ge]})]},ce.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),Me.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>q(H),"aria-expanded":Se,"aria-controls":`alias-strategy-${H}-other-columns`,children:Se?"Hide other columns":`Show other columns (${Me.length})`}),Se&&a.jsx("div",{id:`alias-strategy-${H}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${H+1}`,children:Me.map(ce=>{const Oe=K.columns.includes(ce.name),Ge=By(ce.samples.length?ce.samples:l[ce.name]??[]),rt=(V.get(ce.name)??0)-(Oe?1:0)>0,vt=$e.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Oe?" canvas-imputer__column-pill--selected":""}`,onClick:()=>y(H,ce.name),"aria-pressed":Oe,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),vt&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),rt&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Ge&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Ge]})]},ce.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${K.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:K.columns.length?K.columns.map(ce=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:ce},ce)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${H}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${H}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:ze,onChange:ce=>x(H,ce.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),K.mode==="custom"&&d&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Be?N(d):it?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${H}`)})}),u.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[u.totalPairs," custom pair",u.totalPairs===1?"":"s"," captured.",D?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",u.previewPairs.length>0?` Examples: ${u.previewPairs.join("; ")}${u.previewOverflow>0?"...":""}`:""]}),u.totalPairs===0&&D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),R>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",$?`: ${$}`:"",u.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),P>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",P," incomplete pair",P===1?"":"s",".",A?` Examples: ${A}${u.invalidOverflow>0?"...":""}`:""]})]})},Mu=["iso_date","iso_datetime","month_day_year","day_month_year"],GM="iso_date",QM=["date","time","timestamp","datetime"],XM=3,Uy=36,Rl={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},Nh=Mu.map(e=>({value:e,label:Rl[e].label,guidance:Rl[e].guidance,example:Rl[e].example})),JM=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],qy=e=>e.length<=Uy?e:`${e.slice(0,Uy-1)}...`,Hy=e=>{if(!e)return!1;const t=e.toLowerCase();return QM.some(n=>t.includes(n))},ZM=e=>JM.some(t=>t.test(e)),Vy=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Mu.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Mu.includes(s)?s:GM},eA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s||!s.length)return;const i=s.length;let l=0;if(s.forEach(u=>{ZM(u)&&(l+=1)}),!i)return;l/i>=.6&&l>=2&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},tA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(Ke(e)));i.sort((g,b)=>g.localeCompare(b));const l=new Set(i),c=t.filter(g=>Hy(n[g]??null)),u=eA(s),d=new Set;c.forEach(g=>{l.has(g)||d.add(g)}),u.forEach(g=>{l.has(g)||d.add(g)});const p=Array.from(d);p.sort((g,b)=>g.localeCompare(b));const h=i.filter(g=>!(Hy(n[g]??null)||u.includes(g))),f=u.slice().sort((g,b)=>g.localeCompare(b));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:p,nonDateSelected:h,dateColumnCount:c.length,sampleCandidateCount:u.length,sampleCandidates:f}},nA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&Mu.includes(n)?n:t},sA=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},Wy=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,s=e.map(i=>{if(!i||typeof i!="object")return null;const l=Ke(i.columns),c=Array.from(new Set(l.map(h=>h.trim()).filter(Boolean))).sort((h,f)=>h.localeCompare(f)),u=nA(i.mode,t.mode),d=sA(i.auto_detect??i.autoDetect??i.auto),p=`${u}|${c.join(",")}|${d?"auto":"manual"}`;return n.has(p)?null:(n.add(p),{mode:u,columns:c,autoDetect:d})}).filter(i=>!!i);return s.length?s:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},rA=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),aA=e=>{var t;return((t=Rl[e])==null?void 0:t.label)??Rl.iso_date.label},oA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?qy(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?qy(t):null},iA=(e,t=XM)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;const u=oA(l);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},lA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},Ky=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},cA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:i,sampleMap:l,collapsedStrategies:c,onToggleStrategy:u,onRemoveStrategy:d,onAddStrategy:p,onModeChange:h,onColumnToggle:f,onColumnsChange:g,onAutoDetectToggle:b,modeOptions:w=Nh})=>{const y=n.length>0,x=_.useMemo(()=>n.some(R=>R.autoDetect),[n]),[N,E]=_.useState(()=>new Set),S=_.useCallback(R=>{E(P=>{const $=new Set(P);return $.has(R)?$.delete(R):$.add(R),$})},[]);_.useEffect(()=>{E(R=>{const P=new Set;return R.forEach($=>{$<n.length&&P.add($)}),P.size===R.size?R:P})},[n.length]);const j=_.useMemo(()=>{const R=new Map;return n.forEach(P=>{P.columns.forEach($=>{const A=$.trim();A&&R.set(A,(R.get(A)??0)+1)})}),R},[n]),C=_.useMemo(()=>{const R=s.recommendedColumns.slice(0,6),P=Math.max(s.recommendedColumns.length-R.length,0);return{preview:R,remaining:P}},[s.recommendedColumns]),k=_.useMemo(()=>{const R=s.nonDateSelected.slice(0,4),P=Math.max(s.nonDateSelected.length-R.length,0);return{preview:R,remaining:P}},[s.nonDateSelected]),O=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:p,children:"Add strategy"})})]}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",C.preview.join(", "),C.remaining>0?`,  (${C.remaining} more)`:"",".",x?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),s.sampleCandidates.length===0&&!C.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[k.preview.join(", ")," ",k.preview.length===1?"looks":"look"," non-date-like.",k.remaining>0?` ${k.remaining} more selected column${k.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),x&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",s.sampleCandidateCount||s.dateColumnCount," date-like columns that are not already assigned."]}),y?a.jsx("div",{className:"canvas-imputer__list",children:n.map((R,P)=>{var U,te;const $=((U=w.find(K=>K.value===R.mode))==null?void 0:U.label)??aA(R.mode),A=R.columns.length,D=A?`${A} column${A===1?"":"s"}`:R.autoDetect?"Auto-detecting columns":"No columns yet",V=c.has(P),z=R.columns.join(", "),F=`date-strategy-${P}-toggle`,q=`date-strategy-${P}-auto-detect`,G=i.map(K=>({option:K,priority:K.isRecommended?0:K.isSampleCandidate?1:2})).sort((K,H)=>K.priority!==H.priority?K.priority-H.priority:K.option.name.localeCompare(H.option.name)).map(K=>K.option),W=G.filter(K=>R.columns.includes(K.name)?!0:K.isRecommended||K.isSampleCandidate),X=new Set(W.map(K=>K.name)),I=G.filter(K=>!X.has(K.name)),L=N.has(P);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:F,className:"canvas-imputer__card-toggle",onClick:()=>u(P),"aria-expanded":!V,"aria-controls":`date-strategy-body-${P}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${V?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",P+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[$,R.autoDetect?"  auto-detect":"",D?`  ${D}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(P),"aria-label":`Remove date formatting strategy ${P+1}`,children:"Remove"})]}),!V&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${P}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${P}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${P}-mode`,value:R.mode,onChange:K=>h(P,K.target.value),children:w.map(K=>a.jsx("option",{value:K.value,children:K.label},K.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((te=w.find(K=>K.value===R.mode))==null?void 0:te.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:q,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:q,type:"checkbox",checked:R.autoDetect,onChange:K=>b(P,K.target.checked)}),a.jsx("label",{htmlFor:q,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),G.length?a.jsxs(a.Fragment,{children:[W.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:W.map(K=>{const H=R.columns.includes(K.name),Y=Ky(K.samples.length?K.samples:l[K.name]??[]),ne=(j.get(K.name)??0)-(H?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${H?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(P,K.name),"aria-pressed":H,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:K.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[K.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:K.dtype}),K.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!K.isRecommended&&K.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),ne&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Y&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Y]})]},K.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),I.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>S(P),"aria-expanded":L,"aria-controls":`date-strategy-${P}-other-columns`,children:L?"Hide other columns":`Show other columns (${I.length})`}),L&&a.jsx("div",{id:`date-strategy-${P}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:I.map(K=>{const H=R.columns.includes(K.name),Y=Ky(K.samples.length?K.samples:l[K.name]??[]),ne=(j.get(K.name)??0)-(H?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${H?" canvas-imputer__column-pill--selected":""}`,onClick:()=>f(P,K.name),"aria-pressed":H,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:K.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[K.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:K.dtype}),ne&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Y&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Y]})]},K.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${R.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:R.columns.length?R.columns.map(K=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:K},K)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${P}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${P}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:z,onChange:K=>g(P,K.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${P}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},Yy=["both","leading","trailing"],Gy="both",uA=["string","object","text","category","mixed","varchar","char"],dA=3,Qy=36,Xy=6,mA=4,hA=5,Jy={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},fA=e=>e.length<=Qy?e:`${e.slice(0,Qy-1)}...`,Zy=e=>{if(!e)return!1;const t=e.toLowerCase();return uA.some(n=>t.includes(n))},pA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${fA(t)}'`},gA=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,_A=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Yy.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Yy.includes(s)?s:Gy},vA=e=>{const t=Jy[e]??Jy[Gy];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},yA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s.length)return;const i=s.reduce((c,u)=>u.hasIssue?c+1:c,0);if(!i)return;const l=i/s.length;(i>=2||l>=.5)&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},bA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(Ke(e)));i.sort((f,g)=>f.localeCompare(g));const l=new Set(i),c=t.filter(f=>Zy(n[f]??null)),u=yA(s),d=new Set;c.forEach(f=>{l.has(f)||d.add(f)}),u.forEach(f=>{l.has(f)||d.add(f)});const p=Array.from(d).sort((f,g)=>f.localeCompare(g)),h=i.filter(f=>!Zy(n[f]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:p,nonTextSelected:h,textColumnCount:c.length,whitespaceCandidateCount:u.length,whitespaceCandidates:u}},jh=(e,t)=>e.slice(0,t),xA=e=>{const t=jh(e,Xy);return{preview:t,remaining:Math.max(e.length-t.length,0)}},wA=e=>{const t=jh(e,mA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},NA=e=>{const t=jh(e,Xy);return{preview:t,remaining:Math.max(e.length-t.length,0)}},jA=(e,t=dA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=gA(u),p=pA(u),h=n[c]??[];h.find(f=>f.value===p)||h.length>=t||(n[c]=[...h,{value:p,hasIssue:d}])})}),n},CA=(e,t,n=hA)=>{if(!t.length)return[];const s=[];for(const i of t){if(s.length>=n)break;const l=e[i];!l||!l.length||s.push({column:i,values:l.map(c=>c.value),overflow:0})}return s},SA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},EA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:i,renderParameterField:l,columnSummary:c,modeDetails:u,sampleMap:d})=>{if(!n&&!s)return null;const p=c.selectedColumns.length,h=xA(c.recommendedColumns),f=wA(c.nonTextSelected),g=NA(c.whitespaceCandidates),b=CA(d,c.selectedColumns),w=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for trimming."]}),b.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",b.map(y=>`${y.column} (${y.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),h.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",h.preview.join(", "),h.remaining>0?`, ... (${h.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[f.preview.join(", ")," ",f.preview.length===1?"is":"are"," not text-like.",f.remaining>0?` ${f.remaining} more column${f.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),w?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),i(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:l(s)})]})},eb=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],tb="keep_alphanumeric",kA=["string","object","text","category","mixed","varchar","char"],MA=3,nb=36,AA=6,OA=4,TA=5,sb={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},$A=e=>e.length<=nb?e:`${e.slice(0,nb-1)}...`,PA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${$A(t)}'`},rb=e=>{if(!e)return!1;const t=e.toLowerCase();return kA.some(n=>t.includes(n))},RA=e=>/[^0-9A-Za-z\s]/.test(e),LA=e=>/[A-Za-z]/.test(e),zA=e=>/[0-9]/.test(e),DA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&eb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&eb.includes(s)?s:tb},FA=e=>{const t=sb[e]??sb[tb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},IA=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([u,d])=>{if(!d.length)return;let p=0,h=0,f=0;d.forEach(g=>{g.hasSpecial&&(p+=1),g.hasDigits&&(h+=1),g.hasLetters&&(f+=1)}),p>0&&t.add(u),h>0&&f===0&&n.add(u),f>0&&h===0&&s.add(u)});const i=Array.from(t).sort((u,d)=>u.localeCompare(d)),l=Array.from(n).sort((u,d)=>u.localeCompare(d)),c=Array.from(s).sort((u,d)=>u.localeCompare(d));return{specialCandidates:i,digitsOnlyCandidates:l,lettersOnlyCandidates:c}},BA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(Ke(e)));i.sort((b,w)=>b.localeCompare(w));const l=new Set(i),c=t.filter(b=>rb(n[b]??null)),{specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}=IA(s),h=new Set;c.forEach(b=>{l.has(b)||h.add(b)}),u.forEach(b=>{l.has(b)||h.add(b)});const f=Array.from(h).sort((b,w)=>b.localeCompare(w)),g=i.filter(b=>!rb(n[b]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,specialCandidateCount:u.length,specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:p}},ab=(e,t)=>e.slice(0,t),UA=e=>{const t=ab(e,AA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Au=e=>{const t=ab(e,OA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},qA=(e,t=MA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=PA(u),p=RA(u),h={value:d,hasSpecial:p,hasDigits:zA(u),hasLetters:LA(u)},f=n[c]??[];f.find(g=>g.value===d)||f.length>=t||(n[c]=[...f,h])})}),n},HA=(e,t,n=TA)=>{if(!t.length)return[];const s=[];for(const i of t){if(s.length>=n)break;const l=e[i];!l||!l.length||s.push({column:i,values:l.map(c=>c.value),overflow:0})}return s},VA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},WA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,replacementParameter:i,renderMultiSelectField:l,renderParameterField:c,columnSummary:u,modeDetails:d,sampleMap:p})=>{if(!n&&!s&&!i)return null;const h=u.selectedColumns.length,f=UA(u.recommendedColumns),g=Au(u.specialCandidates),b=Au(u.digitsOnlyCandidates),w=Au(u.lettersOnlyCandidates),y=Au(u.nonTextSelected),x=HA(p,u.selectedColumns),N=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for cleanup."]}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",x.map(E=>`${E.column} (${E.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",b.preview.join(", "),b.remaining>0?`, ... (${b.remaining} more)`:"",". Consider `digits only` mode."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"",". Consider `letters only` mode."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),y.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[y.preview.join(", ")," ",y.preview.length===1?"is":"are"," not text-like.",y.remaining>0?` ${y.remaining} more column${y.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),N?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),l(n)]}),(s||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?c(s):null,i?c(i):null]})]})},ob=["lower","upper","title","sentence"],ib="lower",KA=["string","object","text","category","mixed","varchar","char"],YA=3,lb=60,GA=6,QA=4,XA=5,cb={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},JA=e=>e.length<=lb?e:`${e.slice(0,lb-1)}...`,ub=e=>{if(!e)return!1;const t=e.toLowerCase();return KA.some(n=>t.includes(n))},Ll=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${JA(t)}'`},ZA=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),eO=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),tO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&ob.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&ob.includes(s)?s:ib},nO=e=>{const t=cb[e]??cb[ib];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},sO=(e,t)=>{const n=[];return Object.entries(e).forEach(([s,i])=>{if(!i.length)return;i.some(c=>{const u=c[t];return c.original!==u})&&n.push(s)}),n.sort((s,i)=>s.localeCompare(i)),n},rO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s,mode:i})=>{const l=Array.from(new Set(Ke(e)));l.sort((g,b)=>g.localeCompare(b));const c=new Set(l),u=t.filter(g=>ub(n[g]??null)),d=sO(s,i),p=new Set;u.forEach(g=>{c.has(g)||p.add(g)}),d.forEach(g=>{c.has(g)||p.add(g)});const h=Array.from(p).sort((g,b)=>g.localeCompare(b)),f=l.filter(g=>!ub(n[g]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:h,nonTextSelected:f,textColumnCount:u.length,inconsistentColumns:d}},db=(e,t)=>e.slice(0,t),aO=e=>{const t=db(e,GA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},mb=e=>{const t=db(e,QA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},oO=(e,t=YA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=Ll(u),p={original:d,lower:Ll(u.toLowerCase()),upper:Ll(u.toUpperCase()),title:Ll(ZA(u)),sentence:Ll(eO(u))},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},iO=(e,t,n,s=XA)=>{if(!t.length)return[];const i=[];for(const l of t){if(i.length>=s)break;const c=e[l];if(!c||!c.length)continue;const u=c.map(d=>`${d.original}  ${d[n]}`);i.push({column:l,values:u,overflow:0})}return i},lO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},cO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:i,renderParameterField:l,columnSummary:c,modeDetails:u,sampleMap:d,selectedMode:p})=>{if(!n&&!s)return null;const h=c.selectedColumns.length,f=aO(c.recommendedColumns),g=mb(c.inconsistentColumns),b=mb(c.nonTextSelected),w=iO(d,c.selectedColumns,p),y=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for case normalization."]}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",w.map(x=>`${x.column} (${x.values.join("; ")})`).join(" | "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),f.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",f.preview.join(", "),f.remaining>0?`, ... (${f.remaining} more)`:"","."]}),b.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[b.preview.join(", ")," ",b.preview.length===1?"is":"are"," not text-like.",b.remaining>0?` ${b.remaining} more column${b.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),y?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),i(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:l(s)})]})},hb=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],fb="preset_digits_only",uO=["string","object","text","category","mixed","varchar","char"],dO=3,pb=60,mO=6,hO=4,fO=5,gb={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},pO=e=>e.length<=pb?e:`${e.slice(0,pb-1)}...`,zl=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${pO(t)}'`},_b=e=>{if(!e)return!1;const t=e.toLowerCase();return uO.some(n=>t.includes(n))},gO=e=>e.replace(/\s+/g," ").trim(),_O=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&hb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&hb.includes(s)?s:fb},vO=e=>{const t=gb[e]??gb[fb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},yO=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([l,c])=>{c.length&&c.forEach(u=>{u.hasDigits&&t.add(l),u.hasLetters&&n.add(l),u.hasWhitespaceRuns&&s.add(l)})});const i=l=>Array.from(l).sort((c,u)=>c.localeCompare(u));return{digits:i(t),letters:i(n),whitespace:i(s)}},bO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(Ke(e)));i.sort((b,w)=>b.localeCompare(w));const l=new Set(i),c=t.filter(b=>_b(n[b]??null)),{digits:u,letters:d,whitespace:p}=yO(s),h=new Set;c.forEach(b=>{l.has(b)||h.add(b)}),[...u,...d,...p].forEach(b=>{l.has(b)||h.add(b)});const f=Array.from(h).sort((b,w)=>b.localeCompare(w)),g=i.filter(b=>!_b(n[b]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:f,nonTextSelected:g,textColumnCount:c.length,digitsCandidates:u,lettersCandidates:d,whitespaceCandidates:p}},vb=(e,t)=>e.slice(0,t),xO=e=>{const t=vb(e,mO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Ou=e=>{const t=vb(e,hO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},wO=(e,t=dO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=zl(u),p={original:d,presetDigits:zl(u.replace(/\D+/g,"")),presetLetters:zl(u.replace(/[^A-Za-z]+/g,"")),presetWhitespace:zl(gO(u)),hasDigits:/\d/.test(u),hasLetters:/[A-Za-z]/.test(u),hasWhitespaceRuns:/\s{2,}/.test(u)||/\t|\n|\r/.test(u)},h=n[c]??[];h.find(f=>f.original===d)||h.length>=t||(n[c]=[...h,p])})}),n},NO=(e,t,n)=>{const s=n??"",i=l=>l.length?l:"''";switch(t){case"preset_letters_only":return`${i(e.original)}  ${i(e.presetLetters)}`;case"preset_whitespace_collapse":return`${i(e.original)}  ${i(e.presetWhitespace)}`;case"custom":try{const l=new RegExp(s.split("|||")[0]??"",s.split("|||")[1]??""),c=zl(e.original.replace(l,s.split("|||")[2]??""));return`${i(e.original)}  ${i(c)}`}catch{return`${i(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${i(e.original)}  ${i(e.presetDigits)}`}},jO=(e,t,n,s,i=fO)=>{if(!t.length)return[];const l=[];for(const c of t){if(l.length>=i)break;const u=e[c];if(!u||!u.length)continue;const d=u.map(p=>NO(p,n,s));l.push({column:c,values:d,overflow:0})}return l},CO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},SO=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",s=t[1]??"",i=t[2]??"";return!n.trim()&&!i.trim()?null:`Pattern: /${n||"(empty)"}/${s||"(none)"} Replacement: ${i||"''"}`},EO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,patternParameter:i,replacementParameter:l,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,replacementValue:g})=>{if(!n&&!s&&!i&&!l)return null;const b=d.selectedColumns.length,w=xO(d.recommendedColumns),y=Ou(d.digitsCandidates),x=Ou(d.lettersCandidates),N=Ou(d.whitespaceCandidates),E=Ou(d.nonTextSelected),S=SO(g),j=jO(h,d.selectedColumns,f,g),C=!e||!t,k=f==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," mode. ",p.guidance," Example: ",p.example,"."]}),S&&a.jsx("p",{className:"canvas-modal__note",children:S}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:b})," column",b===1?"":"s"," for regex cleanup."]}),j.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",j.map(O=>`${O.column} (${O.values.join("; ")})`).join(" | "),"."]}),y.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",y.preview.join(", "),y.remaining>0?`, ... (${y.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"is":"are"," not text-like.",E.remaining>0?` ${E.remaining} more column${E.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),k&&!S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),C?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||i||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,i?u(i):null,l?u(l):null]})]})},yb=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],bb="negative_to_nan",kO=["int","float","double","numeric","number","decimal","real","long"],MO=3,AO=6,OO=4,TO=5,xb={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},$O=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},PO=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},RO=e=>{if(!e)return!1;const t=e.toLowerCase();return kO.some(n=>t.includes(n))},LO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&yb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&yb.includes(s)?s:bb},zO=e=>{const t=xb[e]??xb[bb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},DO=e=>{const t=new Set,n=new Set,s=new Set,i=new Set;Object.entries(e).forEach(([c,u])=>{u.forEach(d=>{d.isNegative&&t.add(c),d.isZero&&n.add(c),(d.numericValue<0||d.numericValue>100)&&s.add(c),(d.numericValue<0||d.numericValue>120)&&i.add(c)})});const l=c=>Array.from(c).sort((u,d)=>u.localeCompare(d));return{negative:l(t),zeros:l(n),percentage:l(s),age:l(i)}},FO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(Ke(e))).sort((w,y)=>w.localeCompare(y)),l=new Set(i),c=t.filter(w=>RO(n[w]??null)),u=new Set(c),{negative:d,zeros:p,percentage:h,age:f}=DO(s),g=new Set;c.forEach(w=>{l.has(w)||g.add(w)}),[...d,...p,...h,...f].forEach(w=>{l.has(w)||g.add(w)});const b=i.filter(w=>!u.has(w));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:Array.from(g).sort((w,y)=>w.localeCompare(y)),nonNumericSelected:b,numericColumnCount:c.length,negativeCandidates:d,zeroCandidates:p,percentageOutliers:h,ageOutliers:f}},IO=e=>{const t=e.slice(0,AO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Dl=e=>{const t=e.slice(0,OO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},BO=(e,t=MO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;const u=PO(l);if(u===null)return;const d=$O(String(l)),p={originalDisplay:d,numericValue:u,isNegative:u<0,isZero:Math.abs(u)<=1e-9},h=n[c]??[];h.find(f=>f.originalDisplay===d)||h.length>=t||(n[c]=[...h,p])})}),n},UO=0,qO=100,HO=0,VO=120,WO=(e,t,n,s)=>{switch(t){case"negative_to_nan":{const i=n??0;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:s!==null&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const i=n??UO,l=s??qO;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:e.numericValue>l?{flagged:!0,reason:`value > ${l}`}:{flagged:!1,reason:null}}case"age_bounds":{const i=n??HO,l=s??VO;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:e.numericValue>l?{flagged:!0,reason:`value > ${l}`}:{flagged:!1,reason:null}}case"custom_range":default:{const i=n!=null,l=s!=null;return!i&&!l?{flagged:!1,reason:null}:i&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:l&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}}},KO=(e,t,n,s)=>{const{flagged:i,reason:l}=WO(e,t,n,s);return i?`${e.originalDisplay}  flagged (${l??"rule match"})`:`${e.originalDisplay}  ok`},YO=(e,t,n,s,i,l=TO)=>{if(!t.length)return[];const c=[];for(const u of t){if(c.length>=l)break;const d=e[u];!d||!d.length||c.push({column:u,values:d.map(p=>KO(p,n,s,i)),overflow:0})}return c},GO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},QO=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const s=t===null?"-":String(t),i=n===null?"":String(n);return`Custom bounds active: [${s}, ${i}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const s=t??0;return n===null?`Negative-to-missing rule overrides values below ${s}.`:`Negative-to-missing rule overrides values < ${s} or > ${n}.`}return null},XO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,minValueParameter:i,maxValueParameter:l,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:p,sampleMap:h,selectedMode:f,minValue:g,maxValue:b})=>{if(!n&&!s&&!i&&!l)return null;const{selectedColumns:w,autoDetectionActive:y}=d,x=w.length,N=IO(d.recommendedColumns),E=Dl(d.negativeCandidates),S=Dl(d.zeroCandidates),j=Dl(d.percentageOutliers),C=Dl(d.ageOutliers),k=Dl(d.nonNumericSelected),O=YO(h,w,f,g,b),R=QO(f,g,b),P=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:p.label})," rule. ",p.guidance," Example: ",p.example,"."]}),R&&a.jsx("p",{className:"canvas-modal__note",children:R}),y?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:x})," column",x===1?"":"s"," for invalid value cleanup."]}),O.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",O.map($=>`${$.column} (${$.values.join("; ")})`).join(" | "),"."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",E.preview.join(", "),E.remaining>0?`, ... (${E.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",S.preview.join(", "),S.remaining>0?`, ... (${S.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",C.preview.join(", "),C.remaining>0?`, ... (${C.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[k.preview.join(", ")," ",k.preview.length===1?"is":"are"," not numeric-type columns.",k.remaining>0?` ${k.remaining} more column${k.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),P?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||i||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,i?u(i):null,l?u(l):null]})]})};let JO="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",wb=(e=21)=>{let t="",n=e|0;for(;n--;)t+=JO[Math.random()*64|0];return t};const Nb=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],jb=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],Ch=[{value:"token_sort_ratio",label:"Token Sort  Same words, ignore order",description:"Split into words, sort alphabetically, then compare. Great when the same words appear in different order."},{value:"token_set_ratio",label:"Token Set  Unique words, ignore extras",description:"Focus on overlapping unique words and down-weight extras. Best when one string has additional words."},{value:"ratio",label:"Character Ratio  Raw string similarity",description:"Compare characters in order using edit distance. Sensitive to spelling differences."}],Tu=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],ZO=new Set(Tu.map(e=>e.value)),ji=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],Fl="UTC",$u=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?$u(e.split(",")):[]:[],Cb=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(s=>{const i=Number(s);Number.isFinite(i)&&n.push(i)}),n}if(typeof e=="string")return Cb(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},Sh=e=>{const t=Number(e);return Number.isFinite(t)?t:null},Sb=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},eT=(e,t)=>{var s,i,l,c,u;if(typeof t!="string")return((s=ji.find(d=>d.value===e))==null?void 0:s.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((l=Nb.find(d=>d.value===n))==null?void 0:l.value)??"add":e==="stat"?((c=jb.find(d=>d.value===n))==null?void 0:c.value)??"mean":e==="similarity"?((u=Ch.find(d=>d.value===n))==null?void 0:u.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((i=ji.find(d=>d.value===e))==null?void 0:i.defaultMethod)??""},tT=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},nT=e=>{const t=$u(e);return t.length?t.filter(n=>ZO.has(n)):["year","month","day"]},sT=e=>typeof e!="string"?Fl:e.trim()||Fl,Eb=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,s)=>{if(!n||typeof n!="object")return;const i=n,l=tT(i.operation_type??i.type),c=i.operation_id??i.id??`feature_math_${s+1}`,u=typeof c=="string"&&c.trim()?c.trim():`feature_math_${s+1}`,d=eT(l,i.method),p=$u(i.input_columns??i.inputs??i.inputColumns),h=$u(i.secondary_columns??i.denominator??i.secondaryColumns),f=Cb(i.constants),g=typeof i.output_column=="string"?i.output_column.trim():"",b=typeof i.output_prefix=="string"?i.output_prefix.trim():"",w=l==="datetime_extract"?nT(i.datetime_features):[],y=l==="datetime_extract"?sT(i.timezone):Fl,x=Sh(i.fillna),N=(()=>{const k=Sh(i.round??i.round_digits);return Number.isInteger(k??NaN),k})(),E=Sh(i.epsilon),S=l==="similarity"?Sb(i.normalize,!1):!1,j=i.allow_overwrite===void 0?null:Sb(i.allow_overwrite,!1),C=typeof i.description=="string"?i.description:void 0;t.push({id:u,type:l,method:d,inputColumns:p,secondaryColumns:h,constants:f,outputColumn:g,outputPrefix:b,datetimeFeatures:w,timezone:y,fillna:x,roundDigits:N,normalize:S,epsilon:E,allowOverwrite:j,description:C})}),t},rT=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||Fl):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},aT=e=>e.map(t=>rT(t)),oT={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},kb=(e,t)=>{var i;const n=oT[e]??{};let s=`math_${e}_${wb(6)}`;for(;t.has(s);)s=`math_${e}_${wb(6)}`;return{id:s,type:e,method:n.method??((i=ji.find(l=>l.value===e))==null?void 0:i.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:Fl,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},iT=(e,t)=>{const n=new Map;return t==null||t.forEach(s=>{s.operations.forEach(i=>{n.has(i.operation_id)||n.set(i.operation_id,i)})}),e.map((s,i)=>{const l=n.get(s.id),c=`${i+1}. ${s.type.replace("_"," ")}${s.method?`  ${s.method}`:""}`;return{id:s.id,label:c,status:l==null?void 0:l.status,message:(l==null?void 0:l.message)??void 0,outputColumns:(l==null?void 0:l.output_columns)??[]}})},Mb=e=>e==="arithmetic"?Nb:e==="stat"?jb:e==="similarity"?Ch:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],lT=e=>{const t=Ch.find(n=>n.value===e);return t!=null&&t.description?t.description:"Compare the input text columns using the selected similarity technique."},cT={applied:"Applied",skipped:"Skipped",failed:"Failed"},uT={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},dT=new Set(Tu.map(e=>e.value)),mT=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},Ab=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],hT=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],fT=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",pT=({index:e,total:t,operation:n,summary:s,availableColumns:i,isCollapsed:l,onToggleCollapsed:c,onDuplicate:u,onRemove:d,onReorder:p,onChange:h})=>{var ne;const f=_.useMemo(()=>Mb(n.type),[n.type]),g=_.useMemo(()=>{var J;return((J=ji.find(re=>re.value===n.type))==null?void 0:J.label)??n.type},[n.type]),b=_.useMemo(()=>{var J;return((J=f.find(re=>re.value===n.method))==null?void 0:J.label)??n.method},[f,n.method]),w=_.useMemo(()=>n.type==="similarity"?lT(n.method):"",[n.method,n.type]),[y,x]=_.useState(n.inputColumns.join(", ")),[N,E]=_.useState(n.secondaryColumns.join(", ")),[S,j]=_.useState(n.constants.join(", "));_.useEffect(()=>{x(n.inputColumns.join(", "))},[n.inputColumns]),_.useEffect(()=>{E(n.secondaryColumns.join(", "))},[n.secondaryColumns]),_.useEffect(()=>{j(n.constants.join(", "))},[n.constants]);const C=()=>{h(n.id,{inputColumns:Ab(y)})},k=()=>{h(n.id,{secondaryColumns:Ab(N)})},O=()=>{h(n.id,{constants:hT(S)})},R=`feature-math-toggle-${n.id}`,P=`feature-math-body-${n.id}`,$=`feature-math-input-columns-${n.id}`,A=`feature-math-secondary-columns-${n.id}`,D=s==null?void 0:s.status,V=D?a.jsx("span",{className:`canvas-cast__chip ${uT[D]??""}`,style:{marginLeft:"0.5rem"},children:cT[D]}):null,z=s!=null&&s.message?s.message.trim():"",F=fT(D),q=(ne=s==null?void 0:s.outputColumns)!=null&&ne.length?s.outputColumns.join(", "):"",G=mT(n.inputColumns),W=n.type==="ratio"||n.type==="similarity",X=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",I=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",L=n.type==="similarity",U=n.type==="datetime_extract",te=n.type==="stat"||n.type==="datetime_extract",K=_.useMemo(()=>{if(!i.length)return"";const J=i.slice(0,6),re=i.length-J.length;return re>0?`${J.join(", ")}  (${re} more)`:J.join(", ")},[i]),H=J=>{if(!J||!dT.has(J))return;const re=new Set(n.datetimeFeatures);re.has(J)?re.delete(J):re.add(J),h(n.id,{datetimeFeatures:Array.from(re)})},Y=J=>re=>{const Se=re.target.value;if(Se===""){h(n.id,{[J]:null});return}const ze=Number(Se);Number.isFinite(ze)&&(J==="roundDigits"?h(n.id,{roundDigits:Math.round(ze)}):J==="fillna"?h(n.id,{fillna:ze}):h(n.id,{epsilon:ze}))},Q=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:R,className:"canvas-imputer__card-toggle",onClick:()=>c(n.id),"aria-expanded":!l,"aria-controls":P,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${l?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[g,b?`  ${b}`:"",n.outputColumn?`   ${n.outputColumn}`:"",V]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",G]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!l&&a.jsxs("div",{className:"canvas-imputer__card-body",id:P,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>u(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>p(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),z&&a.jsx("p",{className:F,children:z}),q&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",q]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:J=>h(n.id,{type:J.target.value}),children:ji.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:J=>h(n.id,{method:J.target.value}),children:f.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),n.type==="similarity"&&w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:w}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:y,onChange:J=>x(J.target.value),onBlur:C,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),C())},placeholder:"col_a, col_b",list:$}),a.jsx("datalist",{id:$,children:i.map(J=>a.jsx("option",{value:J},`${n.id}-input-option-${J}`))}),K&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",K]})]}),W&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:N,onChange:J=>E(J.target.value),onBlur:k,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),k())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:A}),a.jsx("datalist",{id:A,children:i.map(J=>a.jsx("option",{value:J},`${n.id}-secondary-option-${J}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),X&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:S,onChange:J=>j(J.target.value),onBlur:O,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),O())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:J=>h(n.id,{outputColumn:J.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),te&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:J=>h(n.id,{outputPrefix:J.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),I&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:Y("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:Y("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:Y("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),L&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:J=>h(n.id,{normalize:J.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),U&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:Tu.map(J=>{const re=`feature-math-${n.id}-datetime-${J.value}`,Se=n.datetimeFeatures.includes(J.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:re,children:[a.jsx("input",{id:re,type:"checkbox",checked:Se,onChange:()=>H(J.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:J.label})]},J.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:J=>h(n.id,{timezone:J.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:Q,onChange:J=>{const re=J.target.value;re==="inherit"?h(n.id,{allowOverwrite:null}):h(n.id,{allowOverwrite:re==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},gT=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:s,onAddOperation:i,onDuplicateOperation:l,onRemoveOperation:c,onReorderOperation:u,onOperationChange:d,availableColumns:p,signals:h,previewStatus:f,errorHandlingParameter:g,allowOverwriteParameter:b,defaultTimezoneParameter:w,epsilonParameter:y,renderParameterField:x})=>{const[N,E]=_.useState("arithmetic"),S=_.useMemo(()=>{const R=new Map;return t.forEach(P=>{R.set(P.id,P)}),R},[t]),j=_.useMemo(()=>h.length?h[h.length-1]:null,[h]),C=(j==null?void 0:j.warnings)??[],k=j&&j.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",O=()=>{i(N)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("select",{value:N,onChange:R=>E(R.target.value),children:ji.map(R=>a.jsx("option",{value:R.value,children:R.label},R.value))}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:O,children:"Add operation"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),f==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),j&&a.jsxs("p",{className:k,children:["Preview applied ",j.applied_operations," of ",j.total_operations," operation",j.total_operations===1?"":"s"," (",j.skipped_operations," skipped, ",j.failed_operations," failed)."]}),C.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:C.map((R,P)=>a.jsx("li",{children:R},`feature-math-warning-${P}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((R,P)=>a.jsx(pT,{index:P,total:e.length,operation:R,summary:S.get(R.id),availableColumns:p,isCollapsed:n.has(R.id),onToggleCollapsed:s,onDuplicate:l,onRemove:c,onReorder:u,onChange:d},R.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[g&&x(g),b&&x(b),w&&x(w),y&&x(y)]})]})},_T={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},vT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Ob=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),yT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxUniqueParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,missingStrategyParameter:f,missingCodeParameter:g,selectedColumns:b,renderParameterField:w,onToggleColumn:y,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=_.useMemo(()=>{if(!i.length)return[];const k=new Set;return i.forEach(O=>{O.status==="recommended"&&O.selectable&&k.add(O.column)}),Array.from(k)},[i]),S=_.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),j=i.length>0,C=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((k,O)=>a.jsx("li",{children:k},`label-encoding-note-${O}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(k=>{const O=b.includes(k.column),R=_T[k.status],P=vT[k.status]??"canvas-cast__chip--muted",$=k.sample_values.length?k.sample_values.join(", "):"",A=k.unique_count!==void 0&&k.unique_count!==null?`${Ob(k.unique_count)} (${Ob(k.unique_percentage)}%)`:"",D=N(k.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:k.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[k.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",k.dtype]}),k.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:k.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",$]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:k.reason})]})}),a.jsx("td",{children:A}),a.jsx("td",{children:D}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:R})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:O,onChange:()=>y(k.column),disabled:!k.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:k.selectable?O?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${k.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&w(u),d&&w(d),p&&w(p),h&&w(h),f&&w(f),g&&w(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),w(c)]})]})},bT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},xT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Tb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),wT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,targetColumnParameter:u,autoDetectParameter:d,maxCategoriesParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,smoothingParameter:g,encodeMissingParameter:b,handleUnknownParameter:w,selectedColumns:y,renderParameterField:x,onToggleColumn:N,onApplyRecommended:E,formatMissingPercentage:S})=>{const j=_.useMemo(()=>{if(!i.length)return[];const R=new Set;return i.forEach(P=>{P.status==="recommended"&&P.selectable&&R.add(P.column)}),Array.from(R)},[i]),C=_.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),k=i.length>0,O=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>E(j),disabled:!j.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:C}),!u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((R,P)=>a.jsx("li",{children:R},`target-encoding-note-${P}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!k&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&k&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(R=>{const P=y.includes(R.column),$=bT[R.status],A=xT[R.status]??"canvas-cast__chip--muted",D=R.sample_values.length?R.sample_values.join(", "):"",V=R.unique_count!==void 0&&R.unique_count!==null?`${Tb(R.unique_count)} (${Tb(R.unique_percentage)}%)`:"",z=S(R.missing_percentage),F=R.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:R.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[R.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",R.dtype]}),R.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:R.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",D]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:R.reason})]})}),a.jsx("td",{children:V}),a.jsx("td",{children:z}),a.jsx("td",{children:F}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${A}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:()=>N(R.column),disabled:!R.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:R.selectable?P?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${R.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&x(u),d&&x(d),p&&x(p),h&&x(h),f&&x(f),g&&x(g),b&&x(b),w&&x(w)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(c)]})]})},NT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},jT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},$b=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),CT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,bucketsParameter:p,outputSuffixParameter:h,dropOriginalParameter:f,encodeMissingParameter:g,selectedColumns:b,renderParameterField:w,onToggleColumn:y,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=_.useMemo(()=>{if(!i.length)return[];const O=new Set;return i.forEach(R=>{R.status==="recommended"&&R.selectable&&O.add(R.column)}),Array.from(O)},[i]),S=_.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),j=i.length>0,C=l.suggestedBucketDefault>0?`Default bucket suggestion: ${l.suggestedBucketDefault.toLocaleString()}.`:null,k=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:C}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((O,R)=>a.jsx("li",{children:O},`hash-encoding-note-${R}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(O=>{const R=b.includes(O.column),P=NT[O.status],$=jT[O.status]??"canvas-cast__chip--muted",A=O.sample_values.length?O.sample_values.join(", "):"",D=O.unique_count!==void 0&&O.unique_count!==null?`${$b(O.unique_count)} (${$b(O.unique_percentage)}%)`:"",V=N(O.missing_percentage),z=O.recommended_bucket_count?O.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",O.dtype]}),O.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:O.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",A]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:O.reason})]})}),a.jsx("td",{children:D}),a.jsx("td",{children:V}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${$}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>y(O.column),disabled:!O.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:O.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${O.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&w(u),d&&w(d),p&&w(p),h&&w(h),f&&w(f),g&&w(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),w(c)]})]})},ST=({columnsParameter:e,autoDetectParameter:t,degreeParameter:n,includeBiasParameter:s,interactionOnlyParameter:i,includeInputFeaturesParameter:l,outputPrefixParameter:c,renderParameterField:u,signal:d})=>{const p=_.useMemo(()=>[e,t,n,s,i,l,c].filter(x=>!!x),[e,t,n,s,i,l,c]),h=(d==null?void 0:d.generated_features)??[],f=(d==null?void 0:d.skipped_columns)??[],g=(d==null?void 0:d.filled_columns)??{},b=(d==null?void 0:d.notes)??[],w=(d==null?void 0:d.feature_count)??0,y=_.useMemo(()=>{const x=Object.entries(g);return x.length?x.map(([N,E])=>`${N} (${E.toLocaleString()} missing)`).join(", "):null},[g]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Polynomial feature settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),p.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:p.map(x=>u(x))}),f.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",f.join(", "),"."]}),y&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",y," before generating features."]}),w>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:h.map(x=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:x.column}),a.jsx("td",{children:x.expression||(x.terms.length?x.terms.join("  "):"1")}),a.jsx("td",{children:x.degree})]},`poly-feature-${x.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),b.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:b.map((x,N)=>a.jsx("li",{children:x},`polynomial-note-${N}`))})]})},Pb=e=>!!e,Il=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},ET=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},Rb=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},kT=({columnsParameter:e,autoDetectParameter:t,targetColumnParameter:n,methodParameter:s,scoreFuncParameter:i,problemTypeParameter:l,kParameter:c,percentileParameter:u,alphaParameter:d,thresholdParameter:p,modeParameter:h,estimatorParameter:f,stepParameter:g,minFeaturesParameter:b,maxFeaturesParameter:w,dropUnselectedParameter:y,renderParameterField:x,signal:N})=>{const E=_.useMemo(()=>[e,t,n,s,i,l].filter(Pb),[e,t,n,s,i,l]),S=_.useMemo(()=>[c,u,d,p,h,f,g,b,w,y].filter(Pb),[c,u,d,p,h,f,g,b,w,y]),j=(N==null?void 0:N.configured_columns)??[],C=(N==null?void 0:N.evaluated_columns)??[],k=(N==null?void 0:N.selected_columns)??[],O=(N==null?void 0:N.dropped_columns)??[],R=(N==null?void 0:N.feature_summaries)??[],P=(N==null?void 0:N.notes)??[],$=(N==null?void 0:N.drop_unselected)??!1,A=_.useMemo(()=>{if(!C.length&&!j.length)return null;if(C.length===j.length)return`Evaluated ${C.length.toLocaleString()} column(s).`;if(!j.length)return`Evaluated ${C.length.toLocaleString()} column(s) via auto-detect.`;const F=Math.max(C.length-j.length,0);return F>0?`Evaluated ${C.length.toLocaleString()} column(s) (${F.toLocaleString()} auto-detected).`:`Evaluated ${C.length.toLocaleString()} of ${j.length.toLocaleString()} configured column(s).`},[j,C]),D=_.useMemo(()=>{if(!N)return null;const F=[];return N.method&&F.push(`Method: ${N.method}`),N.score_func&&F.push(`Score: ${N.score_func}`),N.estimator&&F.push(`Estimator: ${N.estimator}`),N.problem_type&&N.problem_type!=="auto"&&F.push(`Problem: ${N.problem_type}`),N.target_column&&F.push(`Target: ${N.target_column}`),typeof N.k=="number"&&Number.isFinite(N.k)&&F.push(`k = ${N.k.toLocaleString()}`),typeof N.percentile=="number"&&Number.isFinite(N.percentile)&&F.push(`percentile = ${Il(N.percentile,2)}`),typeof N.alpha=="number"&&Number.isFinite(N.alpha)&&F.push(`alpha = ${Il(N.alpha,4)}`),N.threshold!==null&&N.threshold!==void 0&&Number.isFinite(N.threshold)&&F.push(`threshold = ${Il(N.threshold,4)}`),N.auto_detect&&F.push("Auto-detect enabled"),F.length?F.join("  "):null},[N]),V=_.useMemo(()=>Rb(k),[k]),z=_.useMemo(()=>Rb(O),[O]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Feature selection settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:D}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:A}),E.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:E.map(F=>x(F))}),S.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:S.map(F=>x(F))}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:$?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),k.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",k.length.toLocaleString()," column(s): ",V]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),O.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",O.length.toLocaleString()," column(s): ",z]}),R.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:R.map(F=>{const q=["canvas-cast__row"];return F.selected||q.push("canvas-cast__row--muted"),a.jsxs("tr",{className:q.join(" "),children:[a.jsx("th",{scope:"row",children:F.column}),a.jsx("td",{children:Il(F.score)}),a.jsx("td",{children:ET(F.p_value)}),a.jsx("td",{children:F.rank??""}),a.jsx("td",{children:Il(F.importance,4)}),a.jsx("td",{children:F.selected?"Selected":"Dropped"}),a.jsx("td",{children:F.note??""})]},`feature-selection-summary-${F.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),P.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:P.map((F,q)=>a.jsx("li",{children:F},`feature-selection-note-${q}`))})]})},MT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},AT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Lb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),OT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,outputSuffixParameter:p,dropOriginalParameter:h,encodeMissingParameter:f,handleUnknownParameter:g,unknownValueParameter:b,selectedColumns:w,renderParameterField:y,onToggleColumn:x,onApplyRecommended:N,formatMissingPercentage:E})=>{const S=_.useMemo(()=>{if(!i.length)return[];const O=new Set;return i.forEach(R=>{R.status==="recommended"&&R.selectable&&O.add(R.column)}),Array.from(O)},[i]),j=_.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),C=i.length>0,k=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>N(S),disabled:!S.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),j&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:j}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((O,R)=>a.jsx("li",{children:O},`ordinal-encoding-note-${R}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),k&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!C&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&C&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(O=>{const R=w.includes(O.column),P=MT[O.status],$=AT[O.status]??"canvas-cast__chip--muted",A=O.sample_values.length?O.sample_values.join(", "):"",D=O.unique_count!==void 0&&O.unique_count!==null?`${Lb(O.unique_count)} (${Lb(O.unique_percentage)}%)`:"",V=E(O.missing_percentage),z=O.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",O.dtype]}),O.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:O.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",A]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:O.reason})]})}),a.jsx("td",{children:D}),a.jsx("td",{children:V}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${$}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>x(O.column),disabled:!O.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:O.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${O.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&y(u),d&&y(d),p&&y(p),h&&y(h),f&&y(f),g&&y(g),b&&y(b)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),y(c)]})]})},TT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},$T={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},zb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),PT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:b,renderParameterField:w,onToggleColumn:y,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=_.useMemo(()=>{if(!i.length)return[];const k=new Set;return i.forEach(O=>{O.status==="recommended"&&O.selectable&&k.add(O.column)}),Array.from(k)},[i]),S=_.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),j=i.length>0,C=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.autoDetectDefault&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l.cautionedCount," column",l.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((k,O)=>a.jsx("li",{children:k},`dummy-note-${O}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(k=>{const O=b.includes(k.column),R=TT[k.status],P=$T[k.status]??"canvas-cast__chip--muted",$=k.sample_values.length?k.sample_values.join(", "):"",A=k.unique_count!==void 0&&k.unique_count!==null?`${zb(k.unique_count)} (${zb(k.unique_percentage)}%)`:"",D=N(k.missing_percentage),V=k.estimated_dummy_columns?k.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:k.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[k.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",k.dtype]}),k.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:k.text_category}),k.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",$]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:k.reason})]})}),a.jsx("td",{children:A}),a.jsx("td",{children:D}),a.jsx("td",{children:V}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:R})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:O,onChange:()=>y(k.column),disabled:!k.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:k.selectable?O?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${k.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&w(u),d&&w(d),p&&w(p),h&&w(h),f&&w(f),g&&w(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),w(c)]})]})},RT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},LT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Db=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),zT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:p,includeMissingParameter:h,dropOriginalParameter:f,prefixSeparatorParameter:g,selectedColumns:b,renderParameterField:w,onToggleColumn:y,onApplyRecommended:x,formatMissingPercentage:N})=>{const E=_.useMemo(()=>{if(!i.length)return[];const k=new Set;return i.forEach(O=>{O.status==="recommended"&&O.selectable&&k.add(O.column)}),Array.from(k)},[i]),S=_.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),j=i.length>0,C=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(E),disabled:!E.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l.cautionedCount," column",l.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((k,O)=>a.jsx("li",{children:k},`one-hot-note-${O}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!j&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&j&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(k=>{const O=b.includes(k.column),R=RT[k.status],P=LT[k.status]??"canvas-cast__chip--muted",$=k.sample_values.length?k.sample_values.join(", "):"",A=k.unique_count!==void 0&&k.unique_count!==null?`${Db(k.unique_count)} (${Db(k.unique_percentage)}%)`:"",D=N(k.missing_percentage),V=k.estimated_dummy_columns?k.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:k.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[k.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",k.dtype]}),k.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:k.text_category}),k.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",$]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:k.reason})]})}),a.jsx("td",{children:A}),a.jsx("td",{children:D}),a.jsx("td",{children:V}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:R})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:O,onChange:()=>y(k.column),disabled:!k.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:k.selectable?O?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${k.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&w(u),d&&w(d),p&&w(p),h&&w(h),f&&w(f),g&&w(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),w(c)]})]})},Fb={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},DT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},Ib=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},FT=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(s=>s&&s.split===t)??null:null,Eh=(e,t)=>{const n=FT(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const s=Fb[n.action]??n.action,i=Ib(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:s}),i&&a.jsx("span",{className:"canvas-cast__muted",children:i})]})},IT=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(s=>s&&!["train","test","validation"].includes(s.split));return t.length&&t.map(s=>{const i=s.label||s.split,l=Fb[s.action]??s.action,c=Ib(s.rows??null);return c?`${i}: ${l} (${c})`:`${i}: ${l}`}).join("; ")||null},BT=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,UT=({signal:e,previewStatus:t,hasSource:n,hasReachableSource:s,onRefreshPreview:i})=>{const l=_.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),c=(e==null?void 0:e.total_transformers)??l.length,u=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],d=t==="loading",p=c?`Tracking ${c.toLocaleString()} transformer${c===1?"":"s"}.`:null,h=d||!n||!s;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:h,children:d?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),p&&a.jsx("p",{className:"canvas-modal__note",children:p}),!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),n&&!s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),u.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:u.map((f,g)=>a.jsx("li",{children:f},`transformer-audit-note-${g}`))}),d&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!d&&t==="error"&&n&&s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!d&&n&&s&&!l.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!d&&l.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:l.map((f,g)=>{const b=f.storage_key??`${f.transformer_name}-${f.column_name??"all"}-${g}`,w=IT(f),y=f.source_node_label||f.source_node_id||"",x=DT(f.updated_at??f.created_at??null),N=f.column_name??"",E=BT(f);return a.jsxs(_e.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:y})})}),a.jsx("td",{children:f.transformer_name}),a.jsx("td",{children:N}),a.jsx("td",{children:E||""}),a.jsx("td",{children:Eh(f,"train")}),a.jsx("td",{children:Eh(f,"test")}),a.jsx("td",{children:Eh(f,"validation")}),a.jsx("td",{children:x})]}),w&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",w]})})})]},b)})})]})})]})},kh=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",qT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},HT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},VT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:i,config:l,targetColumnParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p})=>{var te,K,H,Y;const h=s.data,f=s.status,g=Array.isArray(h==null?void 0:h.applied_steps)?h.applied_steps:[],b=Array.isArray(h==null?void 0:h.columns)?h==null?void 0:h.columns:[],w=Array.isArray((te=h==null?void 0:h.signals)==null?void 0:te.feature_target_split)?(K=h==null?void 0:h.signals)==null?void 0:K.feature_target_split:[],y=HT(w,e),x=(l==null?void 0:l.targetColumn)??"",N=(y==null?void 0:y.target_column)??x,E=(l==null?void 0:l.featureColumns)??[],S=_.useMemo(()=>Array.isArray(h==null?void 0:h.column_stats)?h==null?void 0:h.column_stats:[],[h==null?void 0:h.column_stats]),j=_.useMemo(()=>{const Q=new Map;return S.forEach(ne=>{ne!=null&&ne.name&&Q.set(ne.name,ne)}),Q},[S]),C=_.useMemo(()=>{var Q;return(Q=y==null?void 0:y.feature_columns)!=null&&Q.length?y.feature_columns:E.length?E:N?b.filter(ne=>ne!==N):b.slice()},[y==null?void 0:y.feature_columns,E,b,N]),k=(y==null?void 0:y.auto_included_columns)??[],O=(y==null?void 0:y.missing_feature_columns)??[],R=(y==null?void 0:y.excluded_columns)??[],P=(y==null?void 0:y.target_missing_count)??0,$=typeof(y==null?void 0:y.target_missing_percentage)=="number"?y.target_missing_percentage:null,A=(y==null?void 0:y.target_dtype)??(N?((H=j.get(N))==null?void 0:H.dtype)??null:null),D=typeof((Y=h==null?void 0:h.metrics)==null?void 0:Y.row_count)=="number"?h.metrics.row_count:null,V=C.length,z=k.length,F=R.length,q=O.length,G=_.useMemo(()=>qT(g),[g]),W=_.useMemo(()=>{const Q=[];if(Q.push({label:"Target column",value:N||"Not set"}),Q.push({label:"Feature columns",value:d(V)}),D!==null&&Q.push({label:"Preview rows",value:d(D)}),z&&Q.push({label:"Auto-selected features",value:d(z)}),q&&Q.push({label:"Configured features missing",value:d(q)}),F&&Q.push({label:"Excluded columns",value:d(F)}),P){const ne=d(P),J=$!==null?p($):null;Q.push({label:"Target missing values",value:J?`${ne} (${J})`:ne})}return Q},[z,F,V,d,p,q,D,N,P,$]),X=_.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),I=_.useMemo(()=>!t||!n?null:f==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,f,t]),L=_.useMemo(()=>N?f==="success"&&N&&!b.includes(N)?`Target column "${N}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[b,f,N]),U=!!t&&n&&f!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:!U,children:f==="loading"?"Refreshing...":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),X&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:X}),s.error&&f==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),I&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:I}),L&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:L}),q>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",kh(O),"."]}),F>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",kh(R),"."]}),z>0&&E.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",kh(k),"."]}),G&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:G}),W.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:W.map(Q=>a.jsxs("li",{children:[Q.label,": ",a.jsx("strong",{children:Q.value})]},`feature-target-summary-${Q.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:c&&u(c)}),f==="success"&&V===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",A?a.jsx("strong",{children:A}):a.jsx("span",{children:"Unknown"}),P?` - Missing rows flagged for review: ${d(P)}.`:""]})]})},WT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},Hr=e=>`${(e*100).toFixed(1)}%`,KT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:i,config:l,parameters:c,renderParameterField:u,formatMetricValue:d})=>{var $,A;const p=s.data,h=s.status,f=Array.isArray(($=p==null?void 0:p.signals)==null?void 0:$.train_test_split)?(A=p==null?void 0:p.signals)==null?void 0:A.train_test_split:[],g=WT(f,e),b=(l==null?void 0:l.test_size)??.2,w=(l==null?void 0:l.validation_size)??0,y=l==null?void 0:l.random_state;l==null||l.shuffle;const x=(l==null?void 0:l.stratify)??!1,N=(l==null?void 0:l.target_column)??"",E=w>0,S=_.useMemo(()=>g?{trainSize:g.train_size??0,validationSize:g.validation_size??0,testSize:g.test_size??0,totalSize:g.total_size??0,trainRatio:g.train_size&&g.total_size?g.train_size/g.total_size:0,validationRatio:g.validation_ratio??0,testRatio:g.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-b-w,validationRatio:w,testRatio:b},[g,b,w]),j=c.find(D=>D.name==="test_size"),C=c.find(D=>D.name==="validation_size"),k=c.find(D=>D.name==="random_state"),O=c.find(D=>D.name==="shuffle"),R=c.find(D=>D.name==="stratify"),P=c.find(D=>D.name==="target_column");return a.jsxs("div",{className:"node-settings__section",children:[a.jsx("div",{className:"node-settings__section-header",children:a.jsx("h3",{children:"Train/Test Split Configuration"})}),a.jsxs("div",{className:"node-settings__field-group",children:[j&&u(j),C&&u(C),k&&u(k),O&&u(O),R&&u(R),x&&P&&u(P)]}),h==="success"&&g&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:Hr(S.trainRatio)},title:`Training: ${S.trainSize} rows (${Hr(S.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),E&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:Hr(S.validationRatio)},title:`Validation: ${S.validationSize} rows (${Hr(S.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:Hr(S.testRatio)},title:`Test: ${S.testSize} rows (${Hr(S.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:d(S.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(S.trainSize,0)," (",Hr(S.trainRatio),")"]})]}),E&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(S.validationSize,0)," (",Hr(S.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(S.testSize,0)," (",Hr(S.testRatio),")"]})]}),x&&N&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:N})]}),y!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:y})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",children:[a.jsx("span",{className:"node-settings__warning-icon",children:""}),"Connect this node to a data source to configure the split."]}),h==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),h==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},YT={classification:"Classification",regression:"Regression"},GT=e=>e==="numeric"||e==="integer",QT=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},Mh=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,XT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},JT=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:s,config:i,targetColumnParameter:l,problemTypeParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:p,schemaColumns:h})=>{var H;const f=n.data,g=n.status,b=Array.isArray(f==null?void 0:f.applied_steps)?f.applied_steps:[],w=Array.isArray(f==null?void 0:f.column_stats)?f.column_stats:[],y=(f==null?void 0:f.metrics)??null,x=_.useMemo(()=>Array.isArray(f==null?void 0:f.columns)?f.columns.filter(Y=>typeof Y=="string"&&Y.trim().length>0):[],[f==null?void 0:f.columns]),N=_.useMemo(()=>{var Y;return h.length?h:Array.isArray((Y=f==null?void 0:f.schema)==null?void 0:Y.columns)?f.schema.columns:x.length>0?x.map(Q=>({name:Q,pandas_dtype:null,logical_family:"unknown",nullable:!0})):[]},[(H=f==null?void 0:f.schema)==null?void 0:H.columns,x,h]),E=_.useMemo(()=>{const Y=new Map;return N.forEach(Q=>{Q!=null&&Q.name&&Y.set(Q.name,Q)}),Y},[N]),S=(i==null?void 0:i.targetColumn)??"",j=(i==null?void 0:i.problemType)??"classification",C=S?w.find(Y=>(Y==null?void 0:Y.name)===S)??null:null,O=!!(S?E.get(S)??null:null),R=_.useMemo(()=>{const Y=new Set;return w.forEach(Q=>{Q!=null&&Q.name&&Q.name!==S&&Y.add(Q.name)}),N.forEach(Q=>{Q!=null&&Q.name&&Q.name!==S&&Y.add(Q.name)}),Array.from(Y).sort()},[w,N,S]),P=_.useMemo(()=>R.filter(Y=>{const Q=E.get(Y);if(Q&&GT(Q.logical_family))return!0;const ne=w.find(J=>J.name===Y);return QT((ne==null?void 0:ne.dtype)??null)}),[w,R,E]),$=_.useMemo(()=>new Set(P),[P]),A=_.useMemo(()=>R.filter(Y=>!$.has(Y)),[R,$]),D=_.useMemo(()=>w.filter(Y=>(Y==null?void 0:Y.name)&&Y.name!==S&&(Y.missing_count??0)>0).map(Y=>Y.name),[w,S]),V=typeof(y==null?void 0:y.row_count)=="number"?y.row_count:null,z=typeof(C==null?void 0:C.distinct_count)=="number"&&Number.isFinite(C.distinct_count)?C.distinct_count:null,F=typeof(C==null?void 0:C.missing_count)=="number"?C.missing_count:0,q=typeof(C==null?void 0:C.missing_percentage)=="number"?C.missing_percentage:null,G=_.useMemo(()=>{const Y=[];return S?g!=="success"?Y:!C&&!O&&!R.length?(Y.push(`Target column "${S}" is not present in the preview output, and no feature columns were found.`),Y):(R.length||Y.push("Add at least one feature column in addition to the target before training."),C&&F>0&&Y.push(`Target column includes ${F} missing value${F===1?"":"s"}.`),j==="classification"&&C&&(z??0)<2&&Y.push("Classification tasks require at least two distinct target classes."),j==="regression"&&P.length===0&&Y.push("Regression tasks need at least one numeric feature column."),D.length>0&&Y.push(`Feature columns with missing values: ${Mh(D)}.`),V!==null&&V===0&&Y.push("Preview returned zero rows after upstream transformations."),Y):(Y.push("Set a target column to evaluate downstream modeling constraints."),Y)},[D,R.length,F,P.length,V,g,j,S,z,C,O]),W=_.useMemo(()=>YT[j],[j]),X=_.useMemo(()=>{const Y=[{label:"Problem type",value:W},{label:"Target column",value:S||"Not set"}];if(g==="success"){if(z!==null&&Y.push({label:"Target distinct values",value:d(z)}),C){const Q=d(F),ne=q!==null?p(q):null;Y.push({label:"Target missing values",value:ne?`${Q} (${ne})`:Q})}D.length>0&&Y.push({label:"Features with missing values",value:d(D.length)})}return Y},[W,D.length,d,p,F,g,S,z,q,C]),I=_.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),L=_.useMemo(()=>!e||!t?null:g==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,g,e]),U=_.useMemo(()=>XT(b),[b]),te=!!e&&t&&g!=="loading",K=_.useMemo(()=>!S||g!=="success"||G.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[g,G.length,S]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:!te,children:g==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),I&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:I}),n.error&&g==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),L&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:L}),G.map((Y,Q)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Y},`train-model-issue-${Q}`)),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:K}),U&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:U}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[l&&u(l),c&&u(c)]}),X.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:X.map(Y=>a.jsxs("li",{children:[Y.label,": ",a.jsx("strong",{children:Y.value})]},`train-model-summary-${Y.label}`))}),g==="success"&&D.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",Mh(D),"."]}),g==="success"&&j==="regression"&&A.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",Mh(A),". Consider encoding or casting them before training regression models."]})]})},Bb=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?Is(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},ZT=e=>e||"Unknown",e2=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},zn=e=>{const t=e2(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const s=Math.round(n/60);if(s===1)return"1 hour ago";if(s<24)return`${s} hours ago`;const i=Math.round(s/24);return i===1?"1 day ago":`${i} days ago`},Ub=e=>typeof e!="number"||!Number.isFinite(e)?"":Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3),t2=({presets:e,isOpen:t,onClose:n,onApply:s,activePresetId:i,fieldMetadata:l})=>{const[c,u]=_.useState(null);_.useEffect(()=>{var f;if(!t){u(null);return}c&&e.some(g=>g.id===c)||u(((f=e[0])==null?void 0:f.id)??null)},[t,e,c]),_.useEffect(()=>{if(!t)return;const f=g=>{g.key==="Escape"&&n()};return window.addEventListener("keydown",f),()=>window.removeEventListener("keydown",f)},[t,n]);const d=_.useMemo(()=>c?e.find(f=>f.id===c)??e[0]??null:e[0]??null,[e,c]),p=_.useMemo(()=>!i||!d?!1:i===d.id,[i,d]),h=_.useMemo(()=>{var x,N;if(!t||!e.length)return null;const f=((x=d==null?void 0:d.modelType)==null?void 0:x.toLowerCase())==="logistic_regression"?(N=d==null?void 0:d.params)==null?void 0:N.solver:null,g=typeof f=="string"?f.trim().toLowerCase():null,b=g&&(g==="sag"||g==="saga")?"SAG and SAGA solvers expect standardized features. Scale inputs before training to improve convergence and avoid repeated warnings.":null,w=d?Object.entries(d.params??{}).sort(([E],[S])=>E.localeCompare(S)).map(([E,S])=>{const j=l==null?void 0:l[E],C=A=>{var D;return(D=j==null?void 0:j.options)!=null&&D.length?j.options.find(V=>{const z=V.value;return A==null?z===null||typeof z=="string"&&z.trim().toLowerCase()==="none":typeof A=="string"&&typeof z=="string"?z===A?!0:z.trim().toLowerCase()===A.trim().toLowerCase():String(z)===String(A)})??null:null},k=A=>{if(A===null)return j!=null&&j.nullable?"None":"";if(A===void 0)return"";if(typeof A=="boolean")return A?"true":"false";if(typeof A=="number")return Number.isFinite(A)?A.toString():String(A);if(A&&typeof A=="object")try{return JSON.stringify(A)}catch{return"[object]"}return String(A??"")},O=A=>{var F;if(!A)return null;const D=A.value,V=(F=A.label)==null?void 0:F.trim(),z=k(D);return V&&z&&V!==z?`${V} (${z})`:V||z},R=()=>{if(j&&j.default!==void 0){const A=P(j.default,!1);if(A.text)return{text:A.text,note:"Using estimator default"}}return{text:"",note:"Using estimator default"}},P=(A,D=!0)=>{const V=C(A);return V?{text:O(V)??"",note:null}:Array.isArray(A)?A.length===0?D?R():{text:"",note:null}:{text:A.map(F=>P(F,!1)).map(F=>F.text).filter(Boolean).join(", "),note:null}:A===void 0||typeof A=="string"&&A.trim()===""?D?R():{text:"",note:null}:A===null?j!=null&&j.nullable?{text:"None",note:null}:D?R():{text:"",note:null}:{text:k(A),note:null}},$=P(S);return{key:E,label:(j==null?void 0:j.label)??E,description:(j==null?void 0:j.description)??null,value:$.text,note:$.note}}):[],y=d!=null&&d.finishedAt?zn(d.finishedAt):null;return a.jsxs("div",{className:"canvas-modal best-param-modal",role:"dialog","aria-modal":"true",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:n}),a.jsxs("div",{className:"canvas-modal__panel best-param-modal__panel",role:"document",children:[a.jsxs("header",{className:"best-param-modal__header",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"best-param-modal__title",children:"Tuned Hyperparameter Presets"}),a.jsx("p",{className:"best-param-modal__subtitle",children:"Review hyperparameter sets discovered by recent tuning runs and apply them to the current model."})]}),a.jsx("button",{type:"button",className:"best-param-modal__close",onClick:n,children:"Close"})]}),a.jsxs("div",{className:"best-param-modal__layout",children:[a.jsx("aside",{className:"best-param-modal__list","aria-label":"Tuned presets",children:e.map(E=>{const S=E.id===(d==null?void 0:d.id),j=E.finishedAt?zn(E.finishedAt):null;return a.jsxs("button",{type:"button",className:`best-param-modal__list-button${S?" best-param-modal__list-button--active":""}`,onClick:()=>u(E.id),children:[a.jsx("span",{className:"best-param-modal__list-title",children:E.label}),a.jsxs("span",{className:"best-param-modal__list-meta",children:[E.runNumber?`Run ${E.runNumber}`:"Tuning run",j?`  ${j}`:""]}),E.scoring&&a.jsxs("span",{className:"best-param-modal__list-score",children:[E.scoring,": ",Ub(E.score)]}),E.targetColumn&&a.jsxs("span",{className:"best-param-modal__list-target",children:["Target: ",E.targetColumn]})]},E.id)})}),a.jsx("section",{className:"best-param-modal__details",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"best-param-modal__summary",children:[a.jsxs("div",{className:"best-param-modal__summary-main",children:[a.jsx("h4",{children:d.label}),a.jsxs("p",{children:[d.runNumber?`Run ${d.runNumber}`:"Tuning run",y?`  ${y}`:"",d.searchStrategy?`  ${d.searchStrategy}`:""]}),a.jsxs("p",{children:["Model: ",a.jsx("strong",{children:d.modelType}),d.targetColumn?a.jsxs(a.Fragment,{children:[" "," Target: ",a.jsx("strong",{children:d.targetColumn})]}):null,d.scoring?a.jsxs(a.Fragment,{children:[" "," ",d.scoring,": ",a.jsx("strong",{children:Ub(d.score)})]}):null]})]}),a.jsx("div",{className:"best-param-modal__summary-actions",children:a.jsx("button",{type:"button",className:"best-param-modal__apply",onClick:()=>s(d),disabled:!w.length,children:p?"Already applied":"Apply preset"})})]}),d.description&&a.jsx("p",{className:"best-param-modal__note",children:d.description}),b&&a.jsxs("div",{className:"best-param-modal__notice best-param-modal__notice--warning",children:[a.jsx("strong",{children:"Tip:"})," ",b]}),a.jsx("div",{className:"best-param-modal__param-grid",role:"table",children:w.length?w.map(E=>a.jsxs("div",{className:"best-param-modal__param-row",role:"row",children:[a.jsxs("div",{className:"best-param-modal__param-name",role:"cell",children:[a.jsxs("div",{className:"best-param-modal__param-label",children:[E.label,E.label!==E.key&&a.jsx("span",{className:"best-param-modal__param-key",children:a.jsx("code",{children:E.key})})]}),E.description&&a.jsx("div",{className:"best-param-modal__param-description",children:E.description})]}),a.jsxs("div",{className:"best-param-modal__param-value",role:"cell",children:[a.jsx("code",{children:E.value}),E.note&&a.jsx("span",{className:"best-param-modal__param-note",children:E.note})]})]},E.key)):a.jsx("p",{className:"best-param-modal__empty",children:"No hyperparameters available for this preset."})})]}):a.jsx("p",{className:"best-param-modal__empty",children:"Select a tuning run to inspect its hyperparameters."})})]})]})]})},[i,p,l,t,s,n,e,d]);return h?Gp.createPortal(h,document.body):null},n2=new Set(["scale_numeric_features","scaling","scale_numeric"]),s2=[/convergencewarning/i,/failed to converge/i,/did not converge/i,/optimizer failed to converge/i,/increase the number of iterations/i,/scale your features/i,/standardize your features/i,/consider scaling your (data|features)/i,/feature scaling is (recommended|required)/i],r2=["forest","tree","boost","xgboost","lightgbm","catboost","gradient","histgradient","bagging"],a2=["bayes","naive_bayes","gaussian_nb"],o2=e=>{const t=e.trim().toLowerCase();return t?r2.some(s=>t.includes(s))?{required:!1,reason:null}:a2.some(s=>t.includes(s))?{required:!1,reason:null}:t.includes("logistic")?{required:!0,reason:"logistic"}:t.includes("svm")||t.includes("svc")||t.includes("svr")?{required:!0,reason:"svm"}:t.includes("knn")||t.includes("nearest")?{required:!0,reason:"knn"}:t.includes("sgd")||t.includes("perceptron")?{required:!0,reason:"sgd"}:["linear","ridge","lasso","elastic","regression"].some(s=>t.includes(s))?{required:!0,reason:"linear"}:{required:!1,reason:null}:{required:!1,reason:null}},i2=(e,t)=>{const n=new Set;if(!e||!t)return n;const s=Array.isArray(e.edges)?e.edges:[],i=[t];for(;i.length;){const l=i.pop();if(l)for(const c of s){if(!c)continue;const u=typeof c.source=="string"?c.source.trim():"",d=typeof c.target=="string"?c.target.trim():"";!u||!d||d===l&&!n.has(u)&&(n.add(u),i.push(u))}}return n},l2=(e,t)=>{if(!e||!t)return!1;const n=i2(e,t);return n.size?(Array.isArray(e.nodes)?e.nodes:[]).some(i=>{var c;if(!i||typeof i.id!="string"||!n.has(i.id))return!1;const l=String(((c=i==null?void 0:i.data)==null?void 0:c.catalogType)??(i==null?void 0:i.type)??"").toLowerCase();return l?n2.has(l)?!0:l.includes("scale")&&l.includes("numeric"):!1}):!1},c2=(e,t)=>{const n=t.find(s=>(s==null?void 0:s.value)===e);return n!=null&&n.label?n.label:e.replace(/_/g," ").replace(/\s+/g," ").trim()},Ah=(e,t=new Set,n=0)=>{if(e==null)return[];if(typeof e=="string")return[e];if(typeof e=="number"||typeof e=="boolean")return[];if(n>3)return[];if(Array.isArray(e)){if(!e.length)return[];const s=32,i=[];for(let l=0;l<e.length&&l<s;l+=1)i.push(...Ah(e[l],t,n+1));return i}if(typeof e=="object"){if(t.has(e))return[];t.add(e);const s=Object.values(e);if(!s.length)return[];const i=32,l=[];for(let c=0;c<s.length&&c<i;c+=1)l.push(...Ah(s[c],t,n+1));return l}return[]},Ci=e=>{if(!e)return!1;const t=Ah(e);return t.length?t.some(n=>s2.some(s=>s.test(n))):!1},Bl=e=>{var n,s,i,l,c,u,d,p,h,f,g,b,w,y;if(!e)return!1;const t=[e.error_message,e.warning_message,e.message,e.details,e.notes,e.status_reason,e.status_message,e.error,(n=e.metadata)==null?void 0:n.warnings,(s=e.metadata)==null?void 0:s.warning,(i=e.metadata)==null?void 0:i.notes,(l=e.metadata)==null?void 0:l.messages,(c=e.metadata)==null?void 0:c.message,(u=e.metadata)==null?void 0:u.errors,(d=e.metrics)==null?void 0:d.warnings,(p=e.metrics)==null?void 0:p.warning,(h=e.metrics)==null?void 0:h.messages,(f=e.metrics)==null?void 0:f.message,(g=e.job_metadata)==null?void 0:g.warnings,(b=e.job_metadata)==null?void 0:b.warning,(w=e.job_metadata)==null?void 0:w.messages,(y=e.job_metadata)==null?void 0:y.notes];for(const x of t)if(Ci(x))return!0;return!!(Ci(e.metadata)||Ci(e.metrics))},u2=(e,t,n)=>{const s=t||"This model";switch(e){case"logistic":return{headline:`${s} needs scaled numeric features`,summary:'Standardize numeric inputs before launching jobs to keep the logistic solver stable and avoid repeated "scale your features" warnings.',details:["Insert a Scale numeric features step before this node or reuse an upstream scaler.","StandardScaler works for most datasets; RobustScaler can help when outliers dominate.","Once scaling is in place, re-run tuning or training so the solver converges cleanly."]};case"svm":return{headline:`${s} is sensitive to feature scale`,summary:"Support Vector Machines depend on distance calculations. Keep numeric features on comparable scales to preserve margin geometry.",details:["Add the Scale numeric features step upstream of this node.","Try StandardScaler or MinMaxScaler depending on the kernel and expected ranges.","Retrain after scaling to refresh support vectors and hyperparameters."]};case"knn":return{headline:`${s} uses distance-based comparisons`,summary:"k-NN models weigh distances directly, so unscaled columns dominate neighbors. Scale numeric fields to keep votes balanced.",details:["Drop in a Scale numeric features step before launching jobs.","MinMaxScaler keeps features in [0, 1]; StandardScaler works when values are roughly normal.","Requeue jobs after scaling so neighbor search reflects the new feature space."]};case"sgd":return{headline:`${s} benefits from normalized inputs`,summary:"Stochastic gradient models converge faster and produce steadier coefficients when numeric inputs share a common scale.",details:["Insert a Scale numeric features node prior to this step.","StandardScaler plus optional RobustScaler for heavy-tailed features keeps gradients stable.","Re-run jobs after scaling to avoid exploding or vanishing updates."]};default:return{headline:`${s} prefers standardized numeric features`,summary:n==="regression"?"Linear regression families rely on comparable feature magnitudes. Scaling keeps coefficients well-conditioned and improves R stability.":"Linear classification models respond better when numeric inputs share a common scale. Scaling prevents any single column from dominating the loss.",details:["Add the Scale numeric features step ahead of this node or reuse an existing scaler.","StandardScaler is a safe default; RobustScaler helps when outliers skew distributions.","Re-launch jobs once scaling is applied so coefficients represent the standardized space."]}}},qb=({graph:e,nodeId:t,modelType:n,problemType:s,modelTypeOptions:i,enabled:l})=>_.useMemo(()=>{if(!l||!n||!n.trim()||l2(e,t))return null;const c=n.trim().toLowerCase(),{required:u,reason:d}=o2(c);if(!u||!d)return null;const p=c2(n,i);return u2(d,p,s)},[l,e,n,i,t,s]),d2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},Si={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},Oh=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([s,i])=>{t.has(s)&&(n[s]=i)}),n},Hb=(e,t)=>{if(e===t||typeof e=="number"&&typeof t=="number"&&Number.isNaN(e)&&Number.isNaN(t))return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length!==t.length?!1:e.every((n,s)=>Hb(n,t[s]));if(e&&t&&typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1},m2=(e,t,n)=>{if(!e)return{};const s={};return Object.entries(e).forEach(([i,l])=>{if(!t.has(i)||l===""||l===null||l===void 0)return;const c=n==null?void 0:n[i];let u=l;if(c){if(typeof u=="string"){const d=u.trim();if(!d)return;c.type==="select"&&(u=d)}if(c.name==="multi_class"&&typeof u=="string"){const d=u.trim().toLowerCase();if(d==="auto")return;(d==="ovr"||d==="multinomial")&&(u=d)}if(c.default!==void 0){if(typeof c.default=="string"&&typeof u=="string"){const d=c.default.trim(),p=u.trim();if(d===p)return}else if(Hb(c.default,u))return}}s[i]=u}),s},Vb=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Ul=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},h2=e=>{if(!e)return Si.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return Si.regression;if(t.includes("classifier")||t.includes("classification"))return Si.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?Si.regression:n==="classification"?Si.classification:Si.fallback},f2=e=>{var l,c,u;if(!e)return null;const t=[],n=(c=(l=e==null?void 0:e.cross_validation)==null?void 0:l.metrics)==null?void 0:c.mean;Vb(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const s=[e.test,e.validation,e.train];for(const d of s)Vb(d)&&t.push({dataset:d,labelPrefix:""});const i=h2(e);for(const d of t)for(const p of i){const h=d.dataset[p];if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h}}for(const d of t)for(const[p,h]of Object.entries(d.dataset))if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${p}`:p,value:h};return null},Wb=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",p2=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:i,cvConfig:l,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,hyperparametersParameter:h,cvEnabledParameter:f,cvStrategyParameter:g,cvFoldsParameter:b,cvShuffleParameter:w,cvRandomStateParameter:y,cvRefitStrategyParameter:x,onSaveDraftConfig:N})=>{var Bn,qs,is,gr;const E=uo(),[S,j]=_.useState(null),[C,k]=_.useState(null),[O,R]=_.useState(null),[P,$]=_.useState(0),[A,D]=_.useState({}),[V,z]=_.useState(!1),F=_.useRef(!1),[q,G]=_.useState(null),[W,X]=_.useState(!1),[I,L]=_.useState(!1),[U,te]=_.useState(null),[K,H]=_.useState(null),[Y,Q]=_.useState(!1),ne=((s==null?void 0:s.targetColumn)??"").trim(),J=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",re=((i==null?void 0:i.modelType)??"").trim(),Se=(i==null?void 0:i.hyperparameters)??null,ze=(i==null?void 0:i.hyperparametersError)??null,$e=!!(l!=null&&l.enabled),Be=(l==null?void 0:l.strategy)??"auto",it=typeof(l==null?void 0:l.folds)=="number"?l.folds:0,He=!!(l!=null&&l.shuffle),de=(l==null?void 0:l.randomState)??null,ge=(l==null?void 0:l.refitStrategy)??"train_plus_validation",Ne=_.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),Me=Ls({queryKey:["model-hyperparameters",re],queryFn:()=>Nu(re),enabled:!!re,staleTime:5*60*1e3}),Ue=Ls({queryKey:["best-hyperparameters",re,q,t],queryFn:()=>_y(re,{pipelineId:q||void 0,datasetSourceId:t||void 0}),enabled:!!(re&&t),staleTime:30*1e3,retry:1}),ce=((Bn=Me.data)==null?void 0:Bn.fields)??[],Oe=((qs=Me.data)==null?void 0:qs.defaults)??{},Ge=_.useMemo(()=>ce.length?new Set(ce.map(ie=>ie.name)):new Set,[ce]),ut=_.useMemo(()=>ce.length?ce.reduce((ie,ve)=>(ve!=null&&ve.name&&(ie[ve.name]=ve),ie),{}):{},[ce]),rt=_.useMemo(()=>{if(!re||!Se||Ge.size===0)return null;const ie=Oh(Se,Ge);return Object.keys(ie).length>0?ie:null},[Ge,Se,re]);_.useEffect(()=>{D({}),z(!1),F.current=!1},[re]),_.useEffect(()=>{rt&&(D(ie=>{const ve=Object.keys(ie),Pe=Object.keys(rt);return ve.length===Pe.length&&Pe.every(we=>Object.is(ie[we],rt[we]))?ie:rt}),F.current||(z(!0),F.current=!0))},[rt]),_.useEffect(()=>{if(!re||rt||Ge.size===0||!Oe||Object.keys(Oe).length===0)return;const ie=Oh(Oe,Ge);Object.keys(ie).length!==0&&D(ve=>Object.keys(ve).length>0?ve:ie)},[Ge,rt,Oe,re]);const vt=_.useMemo(()=>{if(Ge.size===0)return null;const ie=m2(A,Ge,ut);return Object.keys(ie).length>0?ie:null},[Ge,A]),at=_.useCallback(()=>{z(ie=>{const ve=!ie;return ve&&(F.current=!0),ve})},[]),ct=_.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),$t=_.useMemo(()=>{if(!ct)return null;if(!c||Object.keys(c).length===0)return ct;const ie=Ul(ct);return!ie||!Array.isArray(ie.nodes)||(ie.nodes=ie.nodes.map(ve=>{if(!ve||ve.id!==e)return ve;const Pe=(ve==null?void 0:ve.data)??{},we={...(Pe==null?void 0:Pe.config)??{},...c};return{...ve,data:{...Pe,config:we,isConfigured:!0}}})),ie},[c,ct,e]);_.useEffect(()=>{let ie=!1;return!t||!ct?(G(null),()=>{ie=!0}):(yo(t,ct).then(ve=>{ie||G(ve)}).catch(()=>{ie||G(null)}),()=>{ie=!0})},[ct,t]),_.useEffect(()=>{let ie=!1;k(null);const ve=$t??ct;return!t||!ve?(j(null),()=>{ie=!0}):(yo(t,ve).then(Pe=>{ie||j(Pe)}).catch(Pe=>{ie||(k((Pe==null?void 0:Pe.message)??"Unable to compute pipeline ID"),j(null))}),()=>{ie=!0})},[ct,$t,t]),_.useEffect(()=>{if(!S||!q){X(!1);return}X(S!==q)},[S,q]);const Dt=_.useMemo(()=>["feature-canvas","training-jobs",t??"none",S??"pending",e],[e,S,t]),Qe=_.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",S??"pending",e],[e,S,t]),Ut=!!(t&&e),Yt=Ls({queryKey:Qe,queryFn:async()=>{var ve;const ie={datasetSourceId:t||void 0,limit:5};if(S){const Pe=await Ol({...ie,pipelineId:S});if((((ve=Pe==null?void 0:Pe.jobs)==null?void 0:ve.length)??0)>0)return Pe}return Ol(ie)},enabled:Ut,retry:(ie,ve)=>ve.message.includes("Sign in")?!1:ie<2,refetchInterval:ie=>{const ve=ie.state.data;return((ve==null?void 0:ve.jobs)??[]).some(we=>we.status==="queued"||we.status==="running")?5e3:!1}}),Mt=Ls({queryKey:Dt,queryFn:async()=>{var ve;const ie={datasetSourceId:t||void 0,nodeId:e,limit:5};if(S){const Pe=await Al({...ie,pipelineId:S});if((((ve=Pe==null?void 0:Pe.jobs)==null?void 0:ve.length)??0)>0)return Pe}return Al(ie)},enabled:Ut,retry:(ie,ve)=>ve.message.includes("Sign in")?!1:ie<2,refetchInterval:ie=>{const ve=ie.state.data;return((ve==null?void 0:ve.jobs)??[]).some(we=>we.status==="queued"||we.status==="running")?5e3:!1}}),{mutateAsync:yt,isPending:jn,error:Rt}=qc({mutationFn:hy,onSuccess:ie=>{const ve=Array.isArray(ie.jobs)?ie.jobs.length:0,Pe=ve>0?ie.jobs[0]:null;R(Pe),$(ve),E.invalidateQueries({queryKey:Dt})}}),tn=Yt.error,fe=Yt.isLoading||Yt.isFetching,qt=((is=Yt.data)==null?void 0:is.jobs)??[],dt=Ue.data,Ye=_.useCallback(ie=>{if(!ie)return null;const ve=Object.keys(ie);if(ve.length===0)return null;if(Ge.size===0)return{params:ie,hasUnmapped:!1};const Pe=Oh(ie,Ge),jt=Object.keys(Pe);return jt.length>0?{params:Pe,hasUnmapped:jt.length!==ve.length}:{params:ie,hasUnmapped:!0}},[Ge]),bt=_.useMemo(()=>qt.length?qt.filter(ie=>ie.status==="succeeded"):[],[qt]),dn=_.useMemo(()=>{if(!re)return[];const ie=[],ve=new Set,Pe=ne?ne.trim().toLowerCase():"",jt=we=>!Pe||!we?!0:we.trim().toLowerCase()===Pe;if(dt!=null&&dt.available&&dt.best_params&&(!dt.model_type||dt.model_type===re)){const we=Ye(dt.best_params);if(we){const nt=dt.job_id??null;if(!nt||!ve.has(nt)){const tt=["Most recent tuned run"];dt.run_number&&tt.push(`#${dt.run_number}`);const Ft=`best-api-${nt??re}`;ie.push({id:Ft,label:tt.join(" "),source:"best-api",modelType:dt.model_type??re,params:we.params,jobId:nt,nodeId:dt.node_id??null,runNumber:dt.run_number??null,score:dt.best_score??null,scoring:dt.scoring??null,finishedAt:dt.finished_at??null,searchStrategy:dt.search_strategy??null,nIterations:dt.n_iterations??null,targetColumn:ne||null,pipelineId:dt.pipeline_id??null,datasetSourceId:t??null,description:we.hasUnmapped?"Includes parameters outside the current template. They will be stored as custom overrides.":null}),nt&&ve.add(nt)}}}return bt.forEach(we=>{var pn,Es,Xn,yn,En;if(!we.best_params||we.model_type!==re||t&&we.dataset_source_id&&we.dataset_source_id!==t||ve.has(we.id))return;const nt=Ye(we.best_params);if(!nt)return;const tt=typeof((pn=we.metadata)==null?void 0:pn.target_column)=="string"?we.metadata.target_column:typeof((Es=we.metadata)==null?void 0:Es.targetColumn)=="string"?we.metadata.targetColumn:null;if(!jt(tt))return;const Ft=`job-${we.id}`,Ot=(()=>{var $n;const Jn=typeof(($n=we.metadata)==null?void 0:$n.label)=="string"?we.metadata.label.trim():"";return Jn||(we.run_number?`Run ${we.run_number}`:`Job ${we.id.slice(0,6)}`)})(),nn=typeof((Xn=we.metadata)==null?void 0:Xn.scoring)=="string"?we.metadata.scoring:typeof((yn=we.metrics)==null?void 0:yn.scoring)=="string"?we.metrics.scoring:null,Vt=typeof((En=we.metadata)==null?void 0:En.n_iterations)=="number"?we.metadata.n_iterations:null;ie.push({id:Ft,label:Ot,source:"tuning-job",modelType:we.model_type,params:nt.params,jobId:we.id,nodeId:we.node_id,runNumber:we.run_number??null,score:we.best_score??null,scoring:nn,finishedAt:we.updated_at??we.created_at??null,searchStrategy:we.search_strategy??null,nIterations:Vt,targetColumn:tt??(ne||null),pipelineId:we.pipeline_id??null,datasetSourceId:we.dataset_source_id??null,description:nt.hasUnmapped?"Some tuned parameters fall outside the current template and will be saved as custom overrides.":null}),ve.add(we.id)}),ie.sort((we,nt)=>{const tt=we.finishedAt?Date.parse(we.finishedAt):0,Ft=nt.finishedAt?Date.parse(nt.finishedAt):0;return tt!==Ft?Ft-tt:(nt.runNumber??0)-(we.runNumber??0)}),ie},[dt,Ye,re,t,ne,bt]),ft=dn[0]??null,Cs=dn.length>0,Gt=!ft,pt=!Cs,Nt=_.useMemo(()=>bt.length?bt.slice().sort((ie,ve)=>{const Pe=Date.parse(ie.updated_at||ie.created_at||"0");return Date.parse(ve.updated_at||ve.created_at||"0")-Pe})[0]:qt.length?qt.slice().sort((ie,ve)=>{const Pe=Date.parse(ie.updated_at||ie.created_at||"0");return Date.parse(ve.updated_at||ve.created_at||"0")-Pe})[0]:null,[bt,qt]),Yn=Nt&&(Nt.updated_at||Nt.created_at)||null,mn=Yn?zn(Yn):null,rn=(Nt==null?void 0:Nt.run_number)??null,hn=ft!=null&&ft.finishedAt?zn(ft.finishedAt):null,Cn=ft&&ft.scoring&&typeof ft.score=="number"&&Number.isFinite(ft.score)?`${ft.scoring}: ${Wb(ft.score)}`:null;_.useEffect(()=>{if(!dn.length){U&&te(null),(K==null?void 0:K.tone)==="success"&&H(null);return}U&&!dn.some(ie=>ie.id===U)&&(te(null),H(null))},[K,dn,U]);const At=_.useCallback((ie,ve)=>{if(!ie||Object.keys(ie.params??{}).length===0){H({message:"Selected preset does not include any hyperparameters to apply.",tone:"warning"});return}D(()=>Ul(ie.params)),z(!0),F.current=!0,te(ie.id),H({message:ve??`Applied tuned parameters from ${ie.label}.`,tone:"success"})},[D,z,H,te]),Gn=_.useCallback(()=>{if(!ft){const ve=Nt&&Nt.model_type&&Nt.model_type!==re?`Latest tuning run targeted ${Nt.model_type}. Switch the model template to reuse its parameters.`:"No tuning job results available to apply.";H({message:ve,tone:"warning"});return}const ie=ft.runNumber?`Applied tuned parameters from run ${ft.runNumber}.`:`Applied tuned parameters from ${ft.label}.`;At(ft,ie)},[At,Nt,re,ft,H]),Ht=_.useMemo(()=>{if(!K)return"rgba(148, 163, 184, 0.75)";switch(K.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[K]),fn=_.useMemo(()=>{const ie=[];return t||ie.push("Select a dataset before launching training jobs."),(!ct||!ct.nodes.length)&&ie.push("Connect this node to an upstream pipeline before training."),ne||ie.push("Set a target column in the Train model readiness section."),re||ie.push("Choose a model type before enqueuing training jobs."),$e&&it<2&&ie.push("Cross-validation requires at least 2 folds."),C&&ie.push(C),ze&&ie.push(ze),ie},[$e,it,ct,ze,re,C,t,ne]),Sn=((gr=Mt.data)==null?void 0:gr.jobs)??[],Ve=_.useMemo(()=>{if(!Sn.length)return Sn;const ie=J==null?void 0:J.toLowerCase();return Sn.filter(ve=>{if(!ie)return!0;const Pe=(()=>{var Ft,Ot,nn,Vt;const we=typeof ve.problem_type=="string"?ve.problem_type:null,nt=typeof((Ft=ve.metadata)==null?void 0:Ft.problem_type)=="string"?(Ot=ve.metadata)==null?void 0:Ot.problem_type:null,tt=typeof((nn=ve.metadata)==null?void 0:nn.resolved_problem_type)=="string"?(Vt=ve.metadata)==null?void 0:Vt.resolved_problem_type:null;return(we||tt||nt||"").toLowerCase()})();if(Pe)return Pe===ie;const jt=String(ve.model_type||"").toLowerCase();return ie==="regression"?jt.includes("regress"):ie==="classification"?jt.includes("classif"):!0})},[Sn,J]),tr=_.useMemo(()=>!!(Rt instanceof Error&&Ci(Rt.message)||O&&Bl(O)||Sn.some(ie=>Bl(ie))||qt.some(ie=>Bl(ie))),[Rt,Sn,O,qt]),Qn=qb({graph:n,nodeId:e,modelType:re,problemType:J,modelTypeOptions:p,enabled:tr});_.useEffect(()=>{Qn||Q(!1)},[Qn]);const as=Math.max(Sn.length-Ve.length,0),Fn=Mt.isLoading||Mt.isFetching,os=Mt.error,Ss=fn.length>0||!S||!t||!ct||jn,In=_.useCallback((ie,ve)=>{D(Pe=>({...Pe,[ie]:ve}))},[]),nr=_.useCallback(ie=>{var jt;const ve=A[ie.name]??ie.default,Pe=`hyperparam-${e}-${ie.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Pe,className:"canvas-modal__parameter-label",children:[ie.label,ie.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:ie.description})]}),ie.type==="number"&&a.jsx("input",{id:Pe,type:"number",className:"canvas-modal__parameter-input",value:ve??"",onChange:we=>{const nt=we.target.value;if(nt===""&&ie.nullable)In(ie.name,null);else{const tt=parseFloat(nt);isNaN(tt)||In(ie.name,tt)}},min:ie.min,max:ie.max,step:ie.step,placeholder:ie.nullable?"Empty = default":""}),ie.type==="select"&&a.jsx("select",{id:Pe,className:"canvas-modal__parameter-select",value:ve??"",onChange:we=>In(ie.name,we.target.value),children:(jt=ie.options)==null?void 0:jt.map(we=>a.jsx("option",{value:we.value,children:we.label},we.value))}),ie.type==="boolean"&&a.jsx("input",{id:Pe,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!ve,onChange:we=>In(ie.name,we.target.checked)}),ie.type==="text"&&a.jsx("input",{id:Pe,type:"text",className:"canvas-modal__parameter-input",value:ve??"",onChange:we=>In(ie.name,we.target.value),placeholder:ie.nullable?"Empty = default":""})]},ie.name)},[A,In,e]),Qt=_.useCallback(async()=>{if(!S||!t||!re)return;if(W&&N){try{const tt=N({closeModal:!1});tt&&typeof tt.then=="function"&&await tt,X(!1)}catch{}await new Promise(tt=>setTimeout(tt,100))}const ie=$t??ct;if(!ie)return;const ve={};ne&&(ve.target_column=ne),ve.problem_type=J,ve.cross_validation={enabled:$e,strategy:Be,folds:it,shuffle:He,random_state:de,refit_strategy:ge};const Pe=Object.keys(ve).length?ve:void 0,jt=Ul(ie);jt&&Array.isArray(jt.nodes)&&(jt.nodes=jt.nodes.map(tt=>{if(!tt||tt.id!==e)return tt;const Ft=(tt==null?void 0:tt.data)??{},Ot=(Ft==null?void 0:Ft.config)??{},nn=c?{...Ot,...c}:Ot;return{...tt,data:{...Ft,config:nn,isConfigured:!0}}}));const we=re?[re]:[],nt={dataset_source_id:t,pipeline_id:S,node_id:e,model_type:re||void 0,model_types:we.length?we:void 0,hyperparameters:V&&vt?Ul(vt):void 0,metadata:Pe,job_metadata:Pe,run_training:!0,graph:jt??Ul(ie),target_node_id:e};try{await yt(nt)}catch{}},[$e,it,de,ge,He,Be,c,yt,ct,$t,W,re,e,N,S,J,vt,V,t,ne]),Xe=_.useCallback(()=>{Ut&&Mt.refetch()},[Ut,Mt]),Bt=ie=>{var pn,Es,Xn,yn;const ve=f2(ie.metrics??null),Pe=ie.updated_at?zn(ie.updated_at):null,jt=ie.updated_at||ie.created_at,we=jt?Pe??new Date(jt).toLocaleString():null,nt=d2[ie.status]??ie.status,tt=(ie.problem_type||((pn=ie.metadata)==null?void 0:pn.resolved_problem_type)||((Es=ie.metadata)==null?void 0:Es.problem_type)||"").toString(),Ft=((Xn=ie.metadata)==null?void 0:Xn.cross_validation)??null,Ot=((yn=ie.metrics)==null?void 0:yn.cross_validation)??null,nn=typeof ie.error_message=="string"?ie.error_message.trim():"",Vt=[];if(Vt.push(`Model ${ie.model_type}`),tt&&Vt.push(tt.charAt(0).toUpperCase()+tt.slice(1)),Ft!=null&&Ft.enabled){const En=String(Ft.strategy??"auto"),Jn=En==="stratified_kfold"?"Stratified KFold":En==="kfold"?"KFold":"Auto CV",$n=typeof Ft.folds=="number"?`${Ft.folds} folds`:"CV enabled";if(Vt.push(`${Jn} (${$n})`),(Ot==null?void 0:Ot.status)==="skipped"){const Jr=String((Ot==null?void 0:Ot.reason)??"unknown reason").replace(/_/g," ");Vt.push(`CV skipped (${Jr})`)}}else if((Ot==null?void 0:Ot.status)==="skipped"){const En=String((Ot==null?void 0:Ot.reason)??"unknown reason").replace(/_/g," ");Vt.push(`CV skipped (${En})`)}if(ve&&Vt.push(`${ve.label}: ${Wb(ve.value)}`),ie.status==="failed"&&nn){const En=nn.replace(/\s+/g," ");Vt.push(`Error: ${En}`)}return we&&Vt.push(`Updated ${we}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["v",ie.version]}),"  ",nt,Vt.length>0?`  ${Vt.join("  ")}`:""]},ie.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Xe,disabled:!Ut||Fn,children:Fn?"Refreshing":"Refresh jobs"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),S&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:S})]}),W&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]}),fn.map((ie,ve)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:ie},`training-prereq-${ve}`)),Rt instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Rt.message}),os&&!(Rt instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:os.message||"Unable to load training jobs."}),tn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:tn.message||"Unable to load tuning jobs."}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:P>1?a.jsxs("span",{children:["Queued ",P," training jobs. Latest job ",O.id," (version ",O.version,")."]}):a.jsxs("span",{children:["Training job ",O.id," queued (version ",O.version,")."]})}),fe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Ne&&u(Ne),f&&u(f),$e&&a.jsxs(a.Fragment,{children:[g&&u(g),b&&u(b),w&&u(w),y&&u(y),x&&u(x)]}),re&&ce.length>0&&a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:V?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),(ft||Nt)&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:ft?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:ft.modelType}),ft.runNumber?` (run ${ft.runNumber})`:"",hn?`  ${hn}`:"",ft.targetColumn?`  Target: ${ft.targetColumn}`:"",Cn?`  ${Cn}`:""]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",rn||"N/A",mn?`  ${mn}`:"",Nt!=null&&Nt.model_type&&Nt.model_type!==re?` targeted ${Nt.model_type}.`:" did not produce reusable parameters for this configuration yet."]})}),K&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:Ht},children:K.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",onClick:Gn,disabled:Gt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:Gt?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:Gt?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:Gt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:Gt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:Gt?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply tuned params"}),a.jsx("button",{type:"button",onClick:()=>L(!0),disabled:pt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:pt?"rgba(148, 163, 184, 0.55)":"rgba(168, 85, 247, 0.95)",background:pt?"rgba(15, 23, 42, 0.35)":"rgba(76, 29, 149, 0.18)",border:pt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(168, 85, 247, 0.45)",borderRadius:"4px",cursor:pt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"150px"},children:"Browse tuned params"}),a.jsx("button",{type:"button",onClick:at,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:V?"#fff":"rgba(148, 163, 184, 0.85)",background:V?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(15, 23, 42, 0.6)",border:V?"none":"1px solid rgba(148, 163, 184, 0.45)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:V?"0 4px 12px rgba(118, 75, 162, 0.25)":"none"},onMouseEnter:ie=>{V?ie.currentTarget.style.boxShadow="0 6px 16px rgba(118, 75, 162, 0.35)":(ie.currentTarget.style.borderColor="rgba(148, 163, 184, 0.65)",ie.currentTarget.style.background="rgba(15, 23, 42, 0.8)")},onMouseLeave:ie=>{V?ie.currentTarget.style.boxShadow="0 4px 12px rgba(118, 75, 162, 0.25)":(ie.currentTarget.style.borderColor="rgba(148, 163, 184, 0.45)",ie.currentTarget.style.background="rgba(15, 23, 42, 0.6)")},children:V?" Advanced":"Default"})]})]})}),re&&Me.isLoading&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),re&&Me.error&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",Me.error.message]}),re&&V&&ce.length>0&&a.jsxs("div",{style:{gridColumn:"1 / -1",padding:"1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginTop:"0.5rem"},children:[a.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid rgba(102, 126, 234, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600",color:"#e2e8f0"},children:"Advanced Hyperparameters"}),a.jsxs("p",{style:{margin:"0",fontSize:"0.875rem",color:"rgba(148, 163, 184, 0.85)",lineHeight:"1.5"},children:["Configure ",re.replace(/_/g," ")," hyperparameters. Leave empty to use recommended defaults."]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:ce.map(nr)})]}),!re&&h&&u(h)]}),$e&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",it," folds before refitting on"," ",ge==="train_plus_validation"?"training plus validation data.":"training data only."]}),Qn&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",Qn.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:Qn.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>Q(ie=>!ie),style:{whiteSpace:"nowrap"},children:Y?"Hide tips":"Show tips"})]}),Y&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:Qn.details.map((ie,ve)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:ie},`scaling-tip-${ve}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Qt,disabled:Ss,children:jn?"Queuing":"Launch training job"})}),Fn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),as>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:as===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${as} training jobs use a different problem type. Switch the problem type to view them.`}),!Fn&&Ve.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),Ve.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Ve.map(Bt)}),a.jsx(t2,{presets:dn,isOpen:I,onClose:()=>L(!1),onApply:ie=>{At(ie),L(!1)},activePresetId:U,fieldMetadata:ut})]})},g2=new Set(["true","1","yes","on"]),_2=new Set(["false","0","no","off"]),v2=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],Kb=new Set(["true","1","yes","y","on","t"]),Yb=new Set(["false","0","no","n","off","f"]),xo=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(g2.has(t))return!0;if(_2.has(t))return!1}return null},Ei=e=>{if(!(!e||typeof e!="object")){for(const t of v2)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},Th=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},$h=e=>Array.isArray(e)?e.map(t=>$h(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=$h(e[n]),t),{}):e,ql=e=>e===void 0?"":JSON.stringify($h(e)),Gb=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},y2=(e,t)=>{const n=[],s=f=>{n.includes(f)||n.push(f)},i=(e??"").toLowerCase();if(!t.length)return n;const l=t.filter(f=>f!=null);if(!l.length)return n;const c=l.reduce((f,g)=>{if(typeof g=="number"&&Number.isFinite(g))return f+1;if(typeof g=="string"){const b=g.trim();if(!b)return f;const w=Number(b);if(!Number.isNaN(w)&&Number.isFinite(w))return f+1}return f},0),u=l.reduce((f,g)=>{const b=String(g).trim().toLowerCase();return b&&(Kb.has(b)||Yb.has(b))?f+1:f},0),d=(()=>{const f=new Set;return l.forEach(g=>{f.add(String(g).trim().toLowerCase())}),f.size})(),p=c/l.length,h=u/l.length;if(i.includes("object")||i.includes("string"))return h>=.7&&s("boolean"),p>=.7&&s("float64"),d>0&&d<=20&&s("category"),n;if(i.includes("float")){const f=l.reduce((g,b)=>{if(typeof b=="number")return Number.isInteger(b)?g+1:g;if(typeof b=="string"){const w=b.trim();if(!w)return g;const y=Number(w);if(!Number.isNaN(y)&&Number.isFinite(y)&&Number.isInteger(y))return g+1}return g},0);return h>=.8&&s("boolean"),l.length>0&&f/l.length>=.9&&s("Int64"),n}return i.includes("int")&&h>=.7&&s("boolean"),n},Pu=[{value:"train",label:"Train",accent:"train"},{value:"test",label:"Test",accent:"test"},{value:"validation",label:"Validation",accent:"validation"}],Ru={train:0,test:1,validation:2},b2=["train","test","validation"],Ph=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],Hl=e=>{const t=new Set(Pu.map(i=>i.value)),n=[];e.forEach(i=>{if(i){if(i==="training"&&(i="train"),i==="valid"||i==="val"){n.push("validation");return}t.has(i)&&n.push(i)}});const s=new Set;return n.filter(i=>s.has(i)?!1:(s.add(i),!0)).sort((i,l)=>Ru[i]-Ru[l])},x2=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},Rh=(e,t)=>{const n=xo(e);return n===null?t:n},Qb=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},Xb=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},Jb=e=>{const t=Pu.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},w2=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},N2=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${w2(e.status)}`);const n=zn(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},Lu=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,Zb=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,s])=>{typeof s=="number"&&Number.isFinite(s)&&t.push({key:n,value:s})}),t.sort((n,s)=>n.key.localeCompare(s.key)),t},ex=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},j2=({nodeId:e,sourceId:t,graph:n,config:s,setConfigState:i,renderParameterField:l,formatMetricValue:c,connectedSplitHandles:u})=>{var He;const d=uo(),p=_.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),h=_.useMemo(()=>{if(!p)return[];const de=new Map;p.nodes.forEach(Ne=>{Ne!=null&&Ne.id&&de.set(Ne.id,Ne)});const ge=new Set;return p.edges.forEach(Ne=>{var Ue;if(!Ne||Ne.target!==e)return;const Me=de.get(Ne.source);((Ue=Me==null?void 0:Me.data)==null?void 0:Ue.catalogType)==="train_model_draft"&&ge.add(Me.id)}),ge.size>0?Array.from(ge):p.nodes.filter(Ne=>{var Me;return((Me=Ne==null?void 0:Ne.data)==null?void 0:Me.catalogType)==="train_model_draft"}).map(Ne=>Ne.id)},[p,e]),f=_.useMemo(()=>h.length?h.slice().sort().join("|"):"all",[h]),[g,b]=_.useState(null),[w,y]=_.useState(null);_.useEffect(()=>{let de=!1;return y(null),!t||!p?(b(null),()=>{de=!0}):(yo(t,p).then(ge=>{de||b(ge)}).catch(ge=>{de||(y((ge==null?void 0:ge.message)??"Unable to compute pipeline signature."),b(null))}),()=>{de=!0})},[p,t]);const x=_.useMemo(()=>{const de=s==null?void 0:s.training_job_id;return typeof de=="string"?de.trim():typeof de=="number"?String(de):""},[s==null?void 0:s.training_job_id]),N=_.useMemo(()=>Hl(Ph(s==null?void 0:s.splits)),[s==null?void 0:s.splits]),E=_.useMemo(()=>N.length?N:b2,[N]);_.useEffect(()=>{u&&i(de=>{const ge=de??{},Ne=Hl(Ph(ge.splits)),Me=Ne.filter(ce=>u[ce]!==!1);if(Me.length===Ne.length&&Me.every((ce,Oe)=>ce===Ne[Oe]))return de;const Ue={...ge};return Me.length?Ue.splits=Me:delete Ue.splits,Ue})},[u,i]);const S=_.useMemo(()=>u?E.filter(de=>u[de]!==!1):E,[u,E]),j=_.useMemo(()=>u?Pu.filter(de=>u[de.value]===!1).map(de=>de.label):[],[u]),C=_.useMemo(()=>{if(!j.length)return"";if(j.length===1)return j[0];if(j.length===2)return`${j[0]} and ${j[1]}`;const de=j[j.length-1];return`${j.slice(0,-1).join(", ")}, and ${de}`},[j]),k=S.length>0,O=Rh(s==null?void 0:s.include_confusion,!0),R=Rh(s==null?void 0:s.include_curves,!0),P=Rh(s==null?void 0:s.include_residuals,!0),$=Qb(s==null?void 0:s.max_curve_points,500),A=Qb(s==null?void 0:s.max_scatter_points,750),D=typeof(s==null?void 0:s.last_evaluated_at)=="string"?s.last_evaluated_at:null,[V,z]=_.useState(null),[F,q]=_.useState("details"),G=_.useRef(!1);_.useEffect(()=>{z(null),G.current=!1},[x]),_.useEffect(()=>{q("details")},[V==null?void 0:V.job_id]);const W=_.useMemo(()=>["feature-canvas","model-evaluation",t??"none",g??"pending",f],[g,t,f]),X=Ls({queryKey:W,queryFn:async()=>{const de={datasetSourceId:t||void 0,limit:50},ge=new Map,Ne=[];let Me=null;const Ue=ut=>{Array.isArray(ut)&&ut.forEach(rt=>{rt&&!ge.has(rt.id)&&ge.set(rt.id,rt)})},ce=async ut=>{try{const rt=await Al(ut);return Ue(rt==null?void 0:rt.jobs),rt}catch(rt){return rt instanceof Error&&Ne.push(rt),null}};if(g&&await ce({...de,pipelineId:g}),h.length&&await Promise.all(h.map(ut=>ce({...de,nodeId:ut}))),Me=await ce(de),!ge.size){if(Me)return Me;if(Ne.length)throw Ne[0];return{jobs:[],total:0}}const Oe=Array.from(ge.values());Oe.sort((ut,rt)=>Xb(rt.updated_at??rt.created_at)-Xb(ut.updated_at??ut.created_at));const Ge=(Me==null?void 0:Me.total)??Oe.length;return{jobs:Oe,total:Ge}},enabled:!!t,staleTime:30*1e3,retry:(de,ge)=>ge.message.includes("Sign in")?!1:de<2,refetchInterval:de=>{const ge=de.state.data;return((ge==null?void 0:ge.jobs)??[]).some(Ue=>Ue.status==="queued"||Ue.status==="running")?5e3:!1}}),I=((He=X.data)==null?void 0:He.jobs)??[],L=_.useMemo(()=>{const de=new Map;return I.forEach(ge=>{de.set(ge.id,ge)}),de},[I]),U=_.useMemo(()=>I.filter(de=>de.status==="succeeded"),[I]),te=_.useMemo(()=>U.map(de=>({value:de.id,label:N2(de)})),[U]),K=x?L.get(x)??null:null,H=Ls({queryKey:["feature-canvas","training-job",x||"none"],queryFn:()=>fy(x),enabled:!!x,staleTime:30*1e3});_.useEffect(()=>{var ut,rt;const de=H.data;if(!de)return;const ge=(ut=de.metrics)==null?void 0:ut.evaluation;if(!ge||typeof ge!="object")return;const Ne=ge.splits;if(!Ne||typeof Ne!="object")return;const Me={};Object.entries(Ne).forEach(([vt,at])=>{at&&typeof at=="object"&&(Me[vt]=at)});const Ue=typeof ge.generated_at=="string"?ge.generated_at:D??de.updated_at??de.created_at??new Date().toISOString(),ce=ge.problem_type==="regression"?"regression":"classification",Oe={job_id:de.id,pipeline_id:de.pipeline_id,node_id:de.node_id,generated_at:Ue,problem_type:ce,target_column:ge.target_column??((rt=de.metadata)==null?void 0:rt.target_column)??null,splits:Me};z(Oe),Ue&&Ue!==D&&i(vt=>({...vt??{},last_evaluated_at:Ue}));const Ge=Hl(Object.keys(Me));Ge.length&&!G.current&&!x2(N,Ge)&&i(vt=>({...vt??{},splits:Ge}))},[H.data,D,i,N]);const Y=qc({mutationFn:async de=>{if(!x)throw new Error("Select a training job before running evaluation.");return py(x,de)},onSuccess:de=>{z(de),i(ge=>({...ge??{},training_job_id:x,splits:de.splits?Object.keys(de.splits):S,include_confusion:O,include_curves:R,include_residuals:P,max_curve_points:$,max_scatter_points:A,last_evaluated_at:de.generated_at})),d.invalidateQueries({queryKey:["feature-canvas","training-job",x]})}}),Q=_.useCallback(de=>{const ge=de.target.value;Y.reset(),i(Ne=>{const Me={...Ne??{}};return ge?Me.training_job_id=ge:delete Me.training_job_id,Me})},[Y,i]),ne=_.useCallback(de=>{u&&u[de]===!1||(Y.reset(),G.current=!0,i(ge=>{const Ne=Hl(Ph(ge==null?void 0:ge.splits)),Me=Ne.includes(de);let Ue;if(Me){if(Ne.length<=1)return ge??{};Ue=Ne.filter(ce=>ce!==de)}else Ue=Hl([...Ne,de]);return{...ge??{},splits:Ue}}))},[u,Y,i]),J=_.useCallback((de,ge)=>{Y.reset(),i(Ne=>({...Ne??{},[de]:ge}))},[Y,i]),re=_.useCallback(()=>{if(!x)return;const de={splits:S,include_confusion:O,include_curves:R,include_residuals:P,max_curve_points:R?$:void 0,max_scatter_points:P?A:void 0};Y.mutate(de)},[Y,O,R,P,$,A,x,S]),Se=V?zn(V.generated_at):D?zn(D):null,ze=_.useMemo(()=>V?Object.entries(V.splits).sort((de,ge)=>{const[Ne]=de,[Me]=ge,Ue=Ru[Ne]??99,ce=Ru[Me]??99;return Ue-ce}):[],[V]),$e=_.useMemo(()=>{if(!V||!ze.length)return null;const de=ze.map(([Ne,Me])=>{const Ue=Zb(Me.metrics).reduce((ce,Oe)=>(ce[Oe.key]=Oe.value,ce),{});return{key:Ne,label:Jb(Ne),rowCount:typeof Me.row_count=="number"?Me.row_count:null,metrics:Ue}}),ge=Array.from(new Set(de.flatMap(Ne=>Object.keys(Ne.metrics)))).sort((Ne,Me)=>Ne.localeCompare(Me));return{splits:de,metricKeys:ge}},[ze,V]),Be=_.useMemo(()=>$e?$e.splits.length<=1?"Connect at least two splits to compare results.":$e.metricKeys.length?null:"No numeric metrics available for comparison yet.":"Run an evaluation to compare metrics.",[$e]);_.useEffect(()=>{F==="comparison"&&Be&&q("details")},[F,Be]);const it=_.useCallback(de=>{de==="comparison"&&Be||q(de)},[Be]);return a.jsxs("div",{className:"node-settings__section node-settings__evaluation",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:Se&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",Se]})})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:x,onChange:Q,disabled:X.isLoading||X.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),te.map(de=>a.jsx("option",{value:de.value,children:de.label},de.value))]}),X.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),X.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:X.error.message}),!X.isLoading&&!te.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),w&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:w})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:Pu.map(de=>{const ge=u?u[de.value]!==!1:!0,Ne=ge&&S.includes(de.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${de.accent} ${Ne?"evaluation-chip--active":""}`,"aria-disabled":!ge,title:ge?void 0:`${de.label} split is not connected`,style:ge?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:Ne,disabled:!ge,onChange:()=>ne(de.value)}),a.jsx("span",{children:de.label})]},de.value)})}),j.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",C," split",j.length>1?"s":""," to enable diagnostics."]}),!k&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a train, validation, or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:O,onChange:de=>J("include_confusion",de.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:de=>J("include_curves",de.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:de=>J("include_residuals",de.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:re,disabled:!x||Y.isPending||!k,children:Y.isPending?"Running":"Run evaluation"}),K&&K.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!k&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),Y.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:Y.error.message}),Y.isSuccess&&V&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",zn(V.generated_at),"."]}),H.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:H.error.message})]}),V?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:V.problem_type==="regression"?"Regression":"Classification"})]}),V.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:V.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:zn(V.generated_at)??V.generated_at})]})]}),a.jsxs("div",{className:"evaluation-tabs",role:"tablist","aria-label":"Evaluation views",children:[a.jsx("button",{type:"button",className:`evaluation-tab ${F==="details"?"evaluation-tab--active":""}`,role:"tab","aria-selected":F==="details",onClick:()=>it("details"),children:"Split details"}),a.jsx("button",{type:"button",className:`evaluation-tab ${F==="comparison"?"evaluation-tab--active":""}`,role:"tab","aria-selected":F==="comparison","aria-disabled":!!Be,disabled:!!Be,title:Be??void 0,onClick:()=>it("comparison"),children:"Split comparison"})]}),F==="comparison"&&$e?a.jsx(C2,{comparison:$e,formatMetricValue:c}):ze.map(([de,ge])=>a.jsx(S2,{splitKey:de,payload:ge,problemType:V.problem_type,formatMetricValue:c},de))]}):a.jsx("div",{className:"evaluation-placeholder",children:x?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},C2=({comparison:e,formatMetricValue:t})=>e.metricKeys.length?a.jsx("section",{className:"evaluation-comparison",children:a.jsx("div",{className:"evaluation-comparison__table-wrapper",children:a.jsxs("table",{className:"evaluation-comparison__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Metric"}),e.splits.map(n=>a.jsx("th",{children:n.label},n.key))]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"evaluation-comparison__row evaluation-comparison__row--muted",children:[a.jsx("td",{children:"Rows evaluated"}),e.splits.map(n=>a.jsx("td",{children:typeof n.rowCount=="number"?n.rowCount.toLocaleString():""},`${n.key}-rows`))]}),e.metricKeys.map(n=>a.jsxs("tr",{className:"evaluation-comparison__row",children:[a.jsx("td",{children:n}),e.splits.map(s=>a.jsx("td",{children:typeof s.metrics[n]=="number"?t(s.metrics[n]):""},`${s.key}-${n}`))]},n))]})]})})}):a.jsx("div",{className:"evaluation-placeholder",children:a.jsx("p",{children:"No numeric metrics were reported across splits for comparison."})}),S2=({splitKey:e,payload:t,problemType:n,formatMetricValue:s})=>{const i=Zb(t.metrics),l=i.length>0,c=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[Jb(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),l?a.jsx("div",{className:"evaluation-metrics__grid",children:i.map(u=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:u.key}),a.jsx("span",{className:"evaluation-metrics__value",children:s(u.value)})]},u.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(E2,{matrix:t.confusion_matrix,formatMetricValue:s}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(u=>a.jsx(k2,{curve:u,formatMetricValue:s},`roc-${u.label}`)),t.pr_curves.map(u=>a.jsx(M2,{curve:u,formatMetricValue:s},`pr-${u.label}`))]}),n==="regression"&&t.residuals&&a.jsx(O2,{residuals:t.residuals,formatMetricValue:s})]}),c.length>0&&a.jsx("ul",{className:"evaluation-notes",children:c.map((u,d)=>a.jsx("li",{children:u},`${e}-note-${d}`))})]})},E2=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],s=Array.isArray(e.totals)?e.totals:[],i=Array.isArray(e.normalized)?e.normalized:[],l=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),l!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",ex(l,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((c,u)=>a.jsx("th",{children:c},`pred-${u}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((c,u)=>{const d=i[u]??[],p=s[u]??c.reduce((h,f)=>h+f,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[u]??`Class ${u}`}),c.map((h,f)=>{const g=typeof d[f]=="number"?d[f]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:h}),g!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:ex(g,t)})]},`cell-${u}-${f}`)}),a.jsx("td",{children:p})]},`row-${u}`)})})]})]})},k2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,s=240,i=28,l=n-i*2,c=s-i*2,u=e.fpr.map((d,p)=>{const h=i+Lu(d)*l,f=s-i-Lu(e.tpr[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:i,y:i,width:l,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:i,y1:s-i,x2:n-i,y2:i,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:i,y1:i,x2:i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("line",{x1:i,y1:s-i,x2:n-i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},M2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,s=240,i=28,l=n-i*2,c=s-i*2,u=e.recall.map((d,p)=>{const h=i+Lu(d)*l,f=s-i-Lu(e.precision[p])*c;return`${p===0?"M":"L"}${h} ${f}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:i,y:i,width:l,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:i,y1:i,x2:i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("line",{x1:i,y1:s-i,x2:n-i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},A2={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},O2=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(s=>typeof s[1]=="number"&&Number.isFinite(s[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([s,i])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:A2[s]??s}),a.jsx("span",{className:"evaluation-summary__value",children:t(i)})]},s))}),a.jsx(T2,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx($2,{points:e.scatter})]})},T2=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const s=t.reduce((i,l)=>Math.max(i,l),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((i,l)=>{const c=i/s*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${i} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${c}%`}})},`bin-${l}`)})})},$2=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,s=36,i=e.map(g=>g.actual),l=e.map(g=>g.predicted),c=Math.min(...i,...l),u=Math.max(...i,...l),d=u-c||1,p=g=>(g-c)/d,h=g=>s+p(g)*(t-s*2),f=g=>n-s-p(g)*(n-s*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:s,y:s,width:t-s*2,height:n-s*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:s,y1:n-s,x2:t-s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:s,y1:s,x2:s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:h(c),y1:f(c),x2:h(u),y2:f(u),className:"evaluation-curve__baseline"}),e.map((g,b)=>a.jsx("circle",{cx:h(g.actual),cy:f(g.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${b}`))]})})},P2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},R2={queued:"info",running:"info",succeeded:"success",failed:"danger",cancelled:"neutral"},ki={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score"],regression:["rmse","mae","r2","mape"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},tx=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted"],nx=["rmse","mae","r2","mape"],sx=new Set(["rmse","mae","mape","mse"]),rx={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},Bs=e=>!!e&&typeof e=="object"&&!Array.isArray(e),L2=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},Lh=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",z2=e=>{if(!e)return ki.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return ki.regression;if(t.includes("class")||t.includes("classification"))return ki.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?ki.regression:n==="classification"?ki.classification:ki.fallback},D2=e=>{var i,l,c;if(!Bs(e))return null;const t=[],n=(l=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:l.mean;Bs(n)&&((c=e==null?void 0:e.cross_validation)==null?void 0:c.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),Bs(e.test)&&t.push({values:e.test,labelPrefix:""}),Bs(e.validation)&&t.push({values:e.validation,labelPrefix:""}),Bs(e.train)&&t.push({values:e.train,labelPrefix:""});const s=z2(e);for(const u of t)for(const d of s){const p=u.values[d];if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p}}for(const u of t)for(const[d,p]of Object.entries(u.values))if(typeof p=="number"&&Number.isFinite(p))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:p};return null},F2=e=>{var n,s;if(!Bs(e))return{label:null,values:{}};if(Bs(e.test))return{label:"Test",values:e.test};if(Bs(e.validation))return{label:"Validation",values:e.validation};const t=(s=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:s.mean;return Bs(t)?{label:"CV mean",values:t}:Bs(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},ax=e=>{if(!e)return"Unknown model";const t=e.trim();return rx[t]?rx[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},I2=e=>{var l,c;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const u of n)if(typeof u=="string"){const d=u.trim().toLowerCase();if(d==="classification"||d==="regression")return d}const s=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(s.includes("classifier")||s.includes("classification"))return"classification";if(s.includes("regress")||s.includes("regression"))return"regression";const i=e.metrics;if(Bs(i)){const u=new Set,d=g=>{Bs(g)&&Object.keys(g).forEach(b=>u.add(b.toLowerCase()))};d(i.test),d(i.validation),d(i.train);const p=(c=(l=i==null?void 0:i.cross_validation)==null?void 0:l.metrics)==null?void 0:c.mean;Bs(p)&&d(p);const h=tx.some(g=>u.has(g)),f=nx.some(g=>u.has(g));if(h&&!f)return"classification";if(f&&!h)return"regression"}return"unknown"},B2=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:I2(t),modelLabel:ax(t.model_type),primaryMetric:D2(n),metricBucket:F2(n)}}),ox=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return sx.has(t)||sx.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},U2=({nodeId:e,sourceId:t,graph:n,parameters:s,config:i,renderParameterField:l})=>{var K;const c=_.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),u=_.useMemo(()=>{if(!c)return[];const H=new Map;c.nodes.forEach(ne=>{ne&&ne.id&&H.set(ne.id,ne)});const Y=new Set;return c.edges.forEach(ne=>{var re;if(!ne||ne.target!==e)return;const J=H.get(ne.source);((re=J==null?void 0:J.data)==null?void 0:re.catalogType)==="train_model_draft"&&Y.add(J.id)}),Y.size>0?Array.from(Y):c.nodes.filter(ne=>{var J;return((J=ne==null?void 0:ne.data)==null?void 0:J.catalogType)==="train_model_draft"}).map(ne=>ne.id)},[c,e]),d=_.useMemo(()=>u.length?u.slice().sort().join("|"):"all",[u]),[p,h]=_.useState(null),[f,g]=_.useState(null);_.useEffect(()=>{let H=!1;return g(null),!t||!c?(h(null),()=>{H=!0}):(yo(t,c).then(Y=>{H||h(Y)}).catch(Y=>{H||(g((Y==null?void 0:Y.message)??"Unable to compute pipeline ID"),h(null))}),()=>{H=!0})},[c,t]);const b=L2(i==null?void 0:i.show_non_success,!0),w=_.useMemo(()=>["feature-canvas","model-registry",t??"none",p??"pending",d,b?"all-statuses":"succeeded"],[p,b,t,d]),y=Ls({queryKey:w,queryFn:async()=>{const H={datasetSourceId:t||void 0,limit:50},Y=new Map,Q=[];let ne=null;const J=$e=>{!Array.isArray($e)||!$e.length||$e.forEach(Be=>{Be&&!Y.has(Be.id)&&Y.set(Be.id,Be)})},re=async $e=>{try{const Be=await Al($e);return J(Be==null?void 0:Be.jobs),Be}catch(Be){return Be instanceof Error&&Q.push(Be),null}};if(p&&await re({...H,pipelineId:p}),u.length===1){const[$e]=u;await re({...H,nodeId:$e})}if(ne=await re(H),!Y.size){if(ne)return ne;if(Q.length)throw Q[0];return{jobs:[],total:0}}const Se=Array.from(Y.values()),ze=(ne==null?void 0:ne.total)??Se.length;return{jobs:Se,total:ze}},enabled:!!t,staleTime:30*1e3,retry:(H,Y)=>Y.message.includes("Sign in")?!1:H<2,refetchInterval:H=>{const Y=H.state.data;return((Y==null?void 0:Y.jobs)??[]).some(J=>J.status==="queued"||J.status==="running")?5e3:!1}}),x=((K=y.data)==null?void 0:K.jobs)??[],N=_.useMemo(()=>{if(!x.length)return[];if(!u.length)return x;const H=x.filter(Y=>u.includes(Y.node_id));return H.length?H:x},[x,u]),E=_.useMemo(()=>B2(N),[N]),S=_.useMemo(()=>b?E:E.filter(H=>H.job.status==="succeeded"),[E,b]),j=_.useMemo(()=>S.filter(H=>H.problemType==="classification"),[S]),C=_.useMemo(()=>S.filter(H=>H.problemType==="regression"),[S]),k=_.useMemo(()=>!j.length&&!C.length?"classification":j.length?C.length?j.length>=C.length?"classification":"regression":"classification":"regression",[j.length,C.length]),O=typeof(i==null?void 0:i.default_problem_type)=="string"?i.default_problem_type.trim().toLowerCase():"auto",R=O==="classification"||O==="regression"?O:k,[P,$]=_.useState(R);_.useEffect(()=>{$(R)},[R]);const A=P==="classification"?j:C,D=_.useMemo(()=>{const H=new Map;return A.forEach(Y=>{const Q=Y.job.model_type,ne=H.get(Q)??{label:Y.modelLabel,count:0};ne.count+=1,H.set(Q,ne)}),Array.from(H.entries()).map(([Y,Q])=>({value:Y,label:Q.label,count:Q.count})).sort((Y,Q)=>Y.label.localeCompare(Q.label))},[A]),V=typeof(i==null?void 0:i.default_method)=="string"?i.default_method.trim().toLowerCase():"",[z,F]=_.useState("all");_.useEffect(()=>{if(!D.length){F("all");return}const H=D.find(Y=>Y.value.toLowerCase()===V);F(H?H.value:"all")},[V,D,P]);const q=_.useMemo(()=>z==="all"?A:A.filter(H=>H.job.model_type===z),[z,A]),G=_.useMemo(()=>q.slice().sort((H,Y)=>{if(Y.job.version!==H.job.version)return Y.job.version-H.job.version;const Q=Date.parse(H.job.updated_at??H.job.created_at??"");return Date.parse(Y.job.updated_at??Y.job.created_at??"")-Q}),[q]),W=_.useMemo(()=>{if(!A.length)return[];const H=new Map;A.forEach(Q=>{const ne=Q.job.model_type,J=H.get(ne)??[];J.push(Q),H.set(ne,J)});const Y=[];return H.forEach((Q,ne)=>{const J=Q.reduce((re,Se)=>{const ze=ox(Se.primaryMetric);if(ze===null)return re;if(!re)return Se;const $e=ox(re.primaryMetric);return $e===null||ze>$e?Se:re},null);Y.push({modelType:ne,label:ax(ne),bestJob:J})}),Y.sort((Q,ne)=>Q.label.localeCompare(ne.label))},[A]),X=_.useMemo(()=>s.filter(H=>["default_problem_type","show_non_success"].includes(H.name)),[s]),I=P==="classification"?tx:nx,L=y.isLoading||y.isFetching,U=y.error??null,te=G.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),p&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",p]})]}),f&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:f}),!u.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),X.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:X.map(H=>a.jsx(_e.Fragment,{children:l(H)},H.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(H=>a.jsxs("button",{type:"button",role:"tab","data-active":P===H,className:"model-registry__tab",onClick:()=>$(H),disabled:H==="classification"&&!j.length||H==="regression"&&!C.length,children:[H==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:H==="classification"?j.length:C.length})]},H))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z==="all",onClick:()=>F("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:A.length})]}),D.map(H=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z===H.value,onClick:()=>F(H.value),children:[H.label,a.jsx("span",{className:"model-registry__method-count",children:H.count})]},H.value))]})]}),W.length>0&&a.jsx("div",{className:"model-registry__summary",children:W.map(H=>{const Y=H.bestJob,Q=Y!=null&&Y.primaryMetric?Y.primaryMetric.label:null,ne=Y!=null&&Y.primaryMetric?Lh(Y.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:H.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[Q||"No metrics",Q&&a.jsx("strong",{children:ne})]}),(Y==null?void 0:Y.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",Y.job.version]})]},H.modelType)})}),L&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),U&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:U.message}),!L&&!U&&!te&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),te&&a.jsx("div",{className:"model-registry__table-wrapper",children:a.jsxs("table",{className:"model-registry__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Version"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Model"}),a.jsx("th",{scope:"col",children:"Primary metric"}),I.map(H=>a.jsx("th",{scope:"col",children:H.replace(/_/g," ")},H)),a.jsx("th",{scope:"col",children:"Evaluated"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:G.map(H=>{const{job:Y,primaryMetric:Q,metricBucket:ne}=H,J=ne.values||{},re=ne.label??"",Se=Y.updated_at??Y.created_at??null;return a.jsxs("tr",{children:[a.jsxs("td",{children:["v",Y.version]}),a.jsx("td",{children:a.jsx("span",{className:`model-registry__status model-registry__status--${R2[Y.status]}`,children:P2[Y.status]})}),a.jsx("td",{children:H.modelLabel}),a.jsx("td",{children:Q?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",children:Q.label}),a.jsx("span",{className:"model-registry__metric-value",children:Lh(Q.value)})]}):""}),I.map(ze=>{const $e=J[ze];return a.jsx("td",{children:typeof $e=="number"&&Number.isFinite($e)?Lh($e):""},`${Y.id}-${ze}`)}),a.jsx("td",{children:re}),a.jsx("td",{children:Se?zn(Se)??Se:""})]},Y.id)})})]})})]})},q2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},wo="__tuning_strategies",No="__active_tuning_strategy_id",jo="__expanded_tuning_strategy_ids",zh=["random","grid","halving","optuna"],zu=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const s=n.toLowerCase();if(t&&t.length>0){const l=t.find(c=>c.toLowerCase()===s);if(l)return l}const i=zh.find(l=>l.toLowerCase()===s);return i||n},hr=e=>!!e&&typeof e=="object"&&!Array.isArray(e),rs=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},xa=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return hr(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return hr(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},Dh=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,s])=>{if(n){if(Array.isArray(s)){const i=s.filter(l=>l!=null);i.length>0&&(t[n]=i.map(l=>rs(l)));return}s==null||s===""||(t[n]=[rs(s)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},H2=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",V2=new Set(["train","test","validation"]),ix=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const s=n.trim().toLowerCase();V2.has(s)&&t.add(s)}}),Array.from(t)},Fh=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,i])=>{t.has(s)&&(n[s]=i)}),n},Ih=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,i])=>{if(t.has(s)){if(Array.isArray(i)){const l=i.map(c=>rs(c)).filter(c=>c!=null&&c!=="");l.length>0&&(n[s]=l);return}i!=null&&i!==""&&(n[s]=[rs(i)])}}),n},W2=(e,t)=>{const n=t.split(/[\n,]+/).map(d=>d.trim()).filter(d=>d.length>0);if(n.length===0)return{values:[],error:null};const s=[],i=[],l=Array.isArray(e.options)?new Set(e.options.map(d=>d.value)):null;n.forEach(d=>{if(e.type==="number"){const p=Number(d);Number.isFinite(p)?s.push(p):i.push(d);return}if(e.type==="boolean"){const p=d.toLowerCase();if(["true","1","yes","y"].includes(p)){s.push(!0);return}if(["false","0","no","n"].includes(p)){s.push(!1);return}i.push(d);return}if(e.type==="select"){if(l&&!l.has(d)){i.push(d);return}s.push(d);return}s.push(d)});const c=[],u=new Set;if(s.forEach(d=>{const p=typeof d=="object"?JSON.stringify(d):String(d);u.has(p)||(u.add(p),c.push(d))}),i.length>0){const d=i.slice(0,3).join(", "),p=i.length>3?"":"";return{values:c,error:`Invalid value${i.length>1?"s":""}: ${d}${p}`}}return{values:c,error:null}},lx=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),Du=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},Fu=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},Vl=(e,t,n)=>{let s=e;return typeof t=="number"&&Number.isFinite(t)&&(s=Math.max(s,t)),typeof n=="number"&&Number.isFinite(n)&&(s=Math.min(s,n)),s},K2=(e,t)=>{const n={},s=e.find(d=>(d==null?void 0:d.name)==="solver"),i=e.find(d=>(d==null?void 0:d.name)==="penalty"),l=!!(s&&i&&Array.isArray(s.options)&&s.options.some(d=>(d==null?void 0:d.value)==="liblinear")&&Array.isArray(i.options)&&i.options.some(d=>(d==null?void 0:d.value)==="elasticnet")),c=new Set(["lbfgs","saga"]),u=new Set(["l2","none"]);return e.forEach(d=>{if(!(d!=null&&d.name))return;const p=new Map,h=b=>{if(b==null||typeof b=="number"&&!Number.isFinite(b))return;const w=typeof b=="object"?JSON.stringify(b):`${typeof b}:${String(b)}`;p.has(w)||p.set(w,rs(b))},f=t==null?void 0:t[d.name];if(l&&d.name==="solver")(Array.isArray(d.options)?d.options:[]).forEach(w=>{w!=null&&w.value&&c.has(String(w.value))&&h(w.value)}),!p.size&&typeof f=="string"&&c.has(f)&&h(f),p.size||c.forEach(w=>h(w));else if(l&&d.name==="penalty")(Array.isArray(d.options)?d.options:[]).forEach(w=>{w!=null&&w.value&&u.has(String(w.value))&&h(w.value)}),!p.size&&typeof f=="string"&&u.has(f)&&h(f),p.size||u.forEach(w=>h(w));else if(d.type==="number"){const b=Fu(f),w=Fu(d.min),y=Fu(d.max);if(w!==null&&h(w),b!==null&&h(Vl(b,w,y)),y!==null&&h(y),p.size<=1&&b!==null){const x=Fu(d.step);x!==null&&x>0?(h(Vl(b+x,w,y)),h(Vl(b-x,w,y))):(h(Vl(b*1.5,w,y)),h(Vl(b*.5,w,y)))}}else d.type==="boolean"?(h(!0),h(!1),typeof f=="boolean"&&h(f)):(d.type==="select"&&(d.options??[]).slice(0,6).forEach(b=>{(b==null?void 0:b.value)!==void 0&&h(b.value)}),typeof f=="string"&&f.trim().length&&h(f.trim()));const g=Array.from(p.values());g.length>0&&(n[d.name]=g)}),n},Y2={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},Bh=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,Wl=e=>{if(!hr(e))return{};const t=rs(e);return hr(t)?(delete t[wo],delete t[No],delete t[jo],t):{}},Mi=e=>Wl(e),G2=(e,t,n)=>({id:Bh(),label:e,config:Mi(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),wa=e=>`Strategy ${e}`,cx=e=>hr(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},ux=e=>hr(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const s=e[n];return t[n]=s===null?null:String(s),t},{}):{},Q2=e=>{if(!hr(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,wo)&&(t[wo]=rs(e[wo])),Object.prototype.hasOwnProperty.call(e,No)&&(t[No]=e[No]),Object.prototype.hasOwnProperty.call(e,jo)&&(t[jo]=rs(e[jo])),t},X2=()=>({strategies:[],activeId:null,expandedIds:[]}),Uh=e=>{var d;const t=X2();if(!hr(e))return t;const n=e[wo];if(Array.isArray(n)){const p=new Set;n.forEach(h=>{if(!hr(h))return;let f=typeof h.id=="string"?h.id.trim():"";(!f||p.has(f))&&(f=Bh()),p.add(f);const g=typeof h.label=="string"?h.label.trim():"",b=g.length?g:wa(t.strategies.length+1),w=hr(h.config)?h.config:{},y={id:f,label:b,config:Wl(w),searchSpaceTexts:cx(h.searchSpaceTexts),searchSpaceFieldErrors:ux(h.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!h.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!h.searchSpaceManuallyCleared};t.strategies.push(y)})}const s=new Set(t.strategies.map(p=>p.id)),i=e[No],l=typeof i=="string"?i.trim():"";t.activeId=l&&s.has(l)?l:((d=t.strategies[0])==null?void 0:d.id)??null;const c=e[jo],u=Array.isArray(c)?c.map(p=>typeof p=="string"?p.trim():"").filter(p=>!!p&&s.has(p)):[];return t.activeId&&!u.includes(t.activeId)&&u.push(t.activeId),t.expandedIds=Array.from(new Set(u)).sort(),t},dx=e=>({id:e.id,label:e.label,config:Mi(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),J2=(e,t,n)=>{var u;const s=e.map((d,p)=>({id:typeof d.id=="string"&&d.id.trim().length?d.id:Bh(),label:typeof d.label=="string"&&d.label.trim().length?d.label:wa(p+1),config:Wl(d.config),searchSpaceTexts:cx(d.searchSpaceTexts),searchSpaceFieldErrors:ux(d.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!d.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!d.searchSpaceManuallyCleared})),i=new Set(s.map(d=>d.id)),l=typeof t=="string"&&i.has(t)?t:((u=s[0])==null?void 0:u.id)??null,c=Array.from(n??new Set).filter(d=>i.has(d));return l&&!c.includes(l)&&c.push(l),{strategies:s,activeId:l,expandedIds:Array.from(new Set(c)).sort()}},mx=(e,t)=>{var n;return t&&e.some(s=>s.id===t)?t:((n=e[0])==null?void 0:n.id)??""},hx=(e,t)=>{const n=new Set(e.map(i=>i.id)),s=t.filter(i=>n.has(i));return!s.length&&e[0]&&s.push(e[0].id),new Set(s)},Iu=e=>ql(e),fx=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0},Z2=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:i,cvConfig:l,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:p,searchStrategyParameter:h,searchIterationsParameter:f,searchRandomStateParameter:g,scoringMetricParameter:b,setDraftConfigState:w,onSaveDraftConfig:y})=>{var _r,Hs,Vs,Zn;const x=uo(),[N,E]=_.useState(null),[S,j]=_.useState(null),[C,k]=_.useState(null),[O,R]=_.useState(0),[P,$]=_.useState(null),[A,D]=_.useState(!1),[V,z]=_.useState(null),[F,q]=_.useState(!1),G=((s==null?void 0:s.targetColumn)??"").trim(),W=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",X=(d==null?void 0:d.name)??"model_type",I=(h==null?void 0:h.name)??"search_strategy",L=(f==null?void 0:f.name)??"search_iterations",U=(g==null?void 0:g.name)??"search_random_state",te=(b==null?void 0:b.name)??"scoring_metric",K=c==null?void 0:c[X],H=typeof K=="string"&&K.trim().length?K.trim():((i==null?void 0:i.modelType)??"").trim(),Y=Ls({queryKey:["model-hyperparameters",H],queryFn:()=>Nu(H),enabled:!!H,staleTime:5*60*1e3}),Q=((_r=Y.data)==null?void 0:_r.fields)??[],ne=((Hs=Y.data)==null?void 0:Hs.defaults)??{},J=_.useMemo(()=>{if(!Q.length)return new Set;const Z=new Set;return Q.forEach(pe=>{pe!=null&&pe.name&&Z.add(pe.name)}),Z},[Q]),re=!!(l!=null&&l.enabled),Se=(l==null?void 0:l.strategy)??"auto",ze=typeof(l==null?void 0:l.folds)=="number"?l.folds:5,$e=!!(l!=null&&l.shuffle),Be=(l==null?void 0:l.randomState)??null,it=_.useMemo(()=>{const Z=[];return((h==null?void 0:h.options)??[]).forEach(pe=>{if(!pe||typeof pe.value!="string")return;const me=pe.value.trim();if(!me.length)return;const ke=me.toLowerCase();Z.some(je=>je.toLowerCase()===ke)||Z.push(me)}),Z},[h]),He=_.useMemo(()=>it.length>0?[...it]:[...zh],[it]),de=zu(h==null?void 0:h.default,it),Ne=zu(c==null?void 0:c[I],it)??de??He[0]??zh[0],Me=c==null?void 0:c[L];let Ue=null;if(typeof Me=="number"&&Number.isFinite(Me))Ue=Math.max(1,Math.floor(Me));else if(typeof Me=="string"){const Z=Number(Me.trim());Number.isFinite(Z)&&Z>0&&(Ue=Math.max(1,Math.floor(Z)))}const ce=c==null?void 0:c[U];let Oe=null;if(typeof ce=="number"&&Number.isFinite(ce))Oe=Math.trunc(ce);else if(typeof ce=="string"){const Z=Number(ce.trim());Number.isFinite(Z)&&(Oe=Math.trunc(Z))}const Ge=typeof(f==null?void 0:f.default)=="number"&&Number.isFinite(f.default)?Math.max(1,Math.floor(f.default)):null,ut=typeof(g==null?void 0:g.default)=="number"&&Number.isFinite(g.default)?Math.trunc(g.default):null,rt=typeof(c==null?void 0:c[te])=="string"?String(c[te]).trim():"",vt=rt.length?rt:null,at=_.useMemo(()=>xa(c==null?void 0:c.baseline_hyperparameters),[c==null?void 0:c.baseline_hyperparameters]),ct=_.useMemo(()=>xa(c==null?void 0:c.search_space),[c==null?void 0:c.search_space]),$t=_.useMemo(()=>Dh(ct.value),[ct.value]),Dt=at.value,Qe=at.error,Ut=$t.value,Yt=ct.error??$t.error,Mt=_.useMemo(()=>Fh(Dt,J),[J,Dt]),yt=_.useMemo(()=>Ih(Ut,J),[J,Ut]),jn=_.useMemo(()=>Object.keys(Mt).length,[Mt]),Rt=_.useMemo(()=>Object.keys(yt).length,[yt]),tn=Rt>0,[fe,qt]=_.useState({}),[dt,Ye]=_.useState({}),[bt,dn]=_.useState(!1),[ft,Cs]=_.useState(!1),Gt=_.useRef(null);if(!Gt.current){const Z=Uh(c);let ke=Z.strategies.length>0?Z.strategies.map(dx):[];const je=mx(ke,Z.activeId),be=hx(ke,Z.expandedIds);je&&!be.has(je)&&ke.length&&be.add(je);const st=Iu(Z);Gt.current={strategies:ke,activeId:je,expanded:be,signature:st}}const[pt,Nt]=_.useState(()=>Gt.current?Gt.current.strategies:[]),[Yn,mn]=_.useState(()=>new Set(Gt.current?Array.from(Gt.current.expanded):[])),[rn,hn]=_.useState(()=>{var Z;return((Z=Gt.current)==null?void 0:Z.activeId)??""}),Cn=_.useRef(((Vs=Gt.current)==null?void 0:Vs.signature)??""),At=_.useRef(null),Gn=_.useRef(null),Ht=_.useMemo(()=>pt.length?pt.find(pe=>pe.id===rn)??pt[0]:null,[rn,pt]),fn=_.useMemo(()=>Uh(c),[c]),Sn=_.useMemo(()=>Iu(fn),[fn]);_.useEffect(()=>{if(Sn===Cn.current)return;const Z=fn.strategies.length?fn.strategies.map(dx):[],pe=mx(Z,fn.activeId),me=hx(Z,fn.expandedIds);pe&&!me.has(pe)&&Z.length&&me.add(pe),At.current=null,Nt(Z),hn(pe),mn(me),Cn.current=Sn},[Sn,fn,c]),_.useEffect(()=>{if(!pt.length)return;pt.some(pe=>pe.id===rn)||hn(pt[0].id)},[rn,pt]),_.useEffect(()=>{const Z=J2(pt,rn,Yn),pe=Iu(Z);Cn.current!==pe&&w(me=>{const ke=Uh(me),je=Iu(ke);if(je===pe)return Cn.current=je,me??{};const be=me?{...me}:{};return Z.strategies.length?be[wo]=Z.strategies.map(st=>({...st,config:rs(st.config),searchSpaceTexts:{...st.searchSpaceTexts},searchSpaceFieldErrors:{...st.searchSpaceFieldErrors}})):delete be[wo],Z.activeId?be[No]=Z.activeId:delete be[No],Z.expandedIds.length?be[jo]=[...Z.expandedIds]:delete be[jo],Cn.current=pe,be})},[rn,Yn,w,pt]),_.useEffect(()=>{if(!Ht||At.current===Ht.id)return;At.current=Ht.id;const Z=Mi(Ht.config);w(me=>({...Q2(me),...Z})),qt(Ht.searchSpaceTexts??{}),Ye(Ht.searchSpaceFieldErrors??{}),dn(Ht.hasAutoFilledSearchSpace??!1),Cs(Ht.searchSpaceManuallyCleared??!1);const pe=typeof(Z==null?void 0:Z[X])=="string"?String(Z[X]):(i==null?void 0:i.modelType)??"";Gn.current=pe},[Ht,X,i==null?void 0:i.modelType,w]),_.useEffect(()=>{if(!Ht)return;const Z=Mi(c),pe=JSON.stringify(Z)!==JSON.stringify(Ht.config??{}),me=!fx(fe,Ht.searchSpaceTexts),ke=!fx(dt,Ht.searchSpaceFieldErrors),je=Ht.hasAutoFilledSearchSpace!==bt,be=Ht.searchSpaceManuallyCleared!==ft;!pe&&!me&&!ke&&!je&&!be||Nt(st=>st.map(Ae=>Ae.id!==Ht.id?Ae:{...Ae,config:Z,searchSpaceTexts:{...fe},searchSpaceFieldErrors:{...dt},hasAutoFilledSearchSpace:bt,searchSpaceManuallyCleared:ft}))},[Ht,c,bt,dt,ft,fe]);const Ve=_.useCallback(()=>{const Z=pt.length+1,pe=Mi(c),me=new Set;pt.forEach(Ae=>{var ot;const mt=zu((ot=Ae.config)==null?void 0:ot[I],He);mt&&me.add(mt)});const ke=He.find(Ae=>!me.has(Ae))??Ne,je=rs(pe),be=hr(je)?je:{};if(be[I]=ke,ke==="random"||ke==="optuna"){const Ae=Ue!==null?Ue:Ge;Ae!==null?be[L]=Ae:delete be[L];const mt=Oe!==null?Oe:ut;mt!==null?be[U]=mt:delete be[U]}else delete be[L],delete be[U];const st=G2(wa(Z),be,{searchSpaceTexts:{...fe},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:bt,searchSpaceManuallyCleared:ft});Nt(Ae=>[...Ae,st]),mn(Ae=>new Set([...Ae,st.id])),At.current=null,hn(st.id)},[He,c,bt,Ue,Ge,Oe,ut,ft,fe,Ne,I,L,U,Nt,hn,mn,pt]),tr=_.useCallback(Z=>{mn(pe=>{const me=new Set(pe);return me.has(Z)?me.delete(Z):me.add(Z),me})},[]),Qn=_.useCallback(Z=>{!Z||Z===rn||(At.current=null,hn(Z),mn(pe=>{const me=new Set(pe);return me.add(Z),me}))},[rn]),as=_.useCallback(Z=>{let pe=null;Nt(me=>{if(me.length<=1)return me;const ke=me.filter(be=>be.id!==Z);if(!ke.length)return me;const je=ke.map((be,st)=>({...be,label:wa(st+1)}));if(Z===rn){At.current=null;const be=je[0].id;pe=be,hn(be)}return je}),mn(me=>{const ke=new Set(me);return ke.delete(Z),pe&&ke.add(pe),ke})},[rn]),Fn=_.useMemo(()=>pt.map((Z,pe)=>{var Tr,sr;const me=Z.config??{},ke=me==null?void 0:me[X],je=typeof ke=="string"?ke.trim():"",be=((Tr=p.find(Un=>Un.value===je))==null?void 0:Tr.label)??je,st=me==null?void 0:me[I],Ae=typeof st=="string"?st.trim():"",mt=(sr=((h==null?void 0:h.options)??[]).find(Un=>Un.value===Ae))==null?void 0:sr.label,ot=me==null?void 0:me[te],Je=typeof ot=="string"?ot.trim():"",Pn=xa(me==null?void 0:me.baseline_hyperparameters).error,Wt=xa(me==null?void 0:me.search_space),kn=Dh(Wt.value),ks=kn.value?Object.keys(kn.value).length:0,Ms=kn.value?Object.values(kn.value).reduce((Un,ps)=>Un+(Array.isArray(ps)?ps.length:0),0):0,Ws=Pn!==null||Object.values(Z.searchSpaceFieldErrors).some(Un=>!!Un);return{id:Z.id,label:Z.label||wa(pe+1),modelLabel:be||"Select model",searchStrategyLabel:mt??(Ae||"Random search"),scoringLabel:Je||"Estimator default",parameterCount:ks,candidateCount:Ms,hasErrors:Ws}}),[p,X,te,h,I,pt]);_.useEffect(()=>{const Z=Gn.current;if(Z===null){Gn.current=H;return}Z!==H&&(Gn.current=H,qt({}),Ye({}),dn(!1),Cs(!1))},[H]),_.useEffect(()=>{!H||!Q.length||qt(Z=>{const pe={...Z};let me=!1;return Q.forEach(ke=>{if(dt[ke.name])return;const je=yt[ke.name],be=Array.isArray(je)&&je.length>0?je.map(st=>lx(ke,st)).join(", "):"";pe[ke.name]!==be&&(pe[ke.name]=be,me=!0)}),me?pe:Z})},[yt,Q,H,dt]),_.useEffect(()=>{if(!H||!Q.length||ft)return;if(tn){bt||dn(!0);return}if(bt)return;const Z=K2(Q,ne);Object.keys(Z).length&&(dn(!0),Ye({}),qt(()=>{const pe={};return Q.forEach(me=>{if(!Z[me.name])return;const ke=Z[me.name].map(je=>lx(me,je)).filter(je=>je.length>0).join(", ");pe[me.name]=ke}),pe}),w(pe=>{const me=pe?{...pe}:{};return me.search_space=Z,me}))},[bt,ne,Q,H,tn,ft,w]);const[os,Ss]=_.useState(vt??"");_.useEffect(()=>{Ss(vt??"")},[vt]);const In=_.useMemo(()=>Y2[W==="regression"?"regression":"classification"],[W]),nr=(b==null?void 0:b.label)??"Scoring metric",Qt=(b==null?void 0:b.description)??"Pick the evaluation metric used to rank candidates.",Xe=_.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),Bt=_.useMemo(()=>Object.values(dt).some(Z=>!!Z),[dt]),Bn=_.useCallback((Z,pe)=>{J.has(Z)&&w(me=>{const ke={...me},je=xa(me==null?void 0:me.baseline_hyperparameters).value??{},st={...Fh(je,J)};return pe===void 0?delete st[Z]:st[Z]=pe,Object.keys(st).length>0?ke.baseline_hyperparameters=st:delete ke.baseline_hyperparameters,ke})},[J,w]),qs=_.useCallback((Z,pe)=>{qt(je=>({...je,[Z.name]:pe}));const{values:me,error:ke}=W2(Z,pe);Ye(je=>({...je,[Z.name]:ke})),!ke&&w(je=>{const be={...je},st=xa(je==null?void 0:je.search_space).value??{},mt={...Ih(st,J)};return me.length>0?mt[Z.name]=me.map(ot=>rs(ot)):delete mt[Z.name],Object.keys(mt).length>0?be.search_space=mt:delete be.search_space,be})},[J,w]),is=_.useCallback(Z=>{Bn(Z,void 0)},[Bn]),gr=_.useCallback(()=>{w(Z=>{if(!Z||!Z.baseline_hyperparameters)return Z??{};const pe={...Z};return delete pe.baseline_hyperparameters,pe})},[w]),ie=_.useCallback(()=>{Cs(!0),dn(!0),qt({}),Ye({}),w(Z=>{if(!Z||!Z.search_space)return Z??{};const pe={...Z};return delete pe.search_space,pe})},[w]),ve=_.useCallback(Z=>{Ss(Z);const pe=Z.trim();w(me=>{const ke={...me};return pe.length>0?ke.scoring_metric=pe:delete ke.scoring_metric,ke})},[w]),Pe=_.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const pe=`baseline-${e}-${Z.name}`,me=Mt[Z.name],ke=me!==void 0,je=ne==null?void 0:ne[Z.name],be=Z.label??Z.name,st=Z.description,Ae=je!==void 0?`Default: ${Du(je)}`:"Default: estimator setting";let mt;if(Z.type==="number"){const ot=typeof me=="number"?String(me):"";mt=a.jsx("input",{id:pe,type:"number",className:"canvas-modal__parameter-input",value:ot,onChange:Je=>{const Ct=Je.target.value;if(!Ct.length){is(Z.name);return}const Pn=Number(Ct);Number.isFinite(Pn)&&Bn(Z.name,Pn)},min:Z.min,max:Z.max,step:Z.step,placeholder:"Leave blank to use default"})}else if(Z.type==="select"){const ot=ke?String(me):"";mt=a.jsxs("select",{id:pe,className:"canvas-modal__parameter-select",value:ot,onChange:Je=>{const Ct=Je.target.value;if(!Ct.length){is(Z.name);return}Bn(Z.name,Ct)},children:[a.jsx("option",{value:"",children:"Use default"}),(Z.options??[]).map(Je=>a.jsx("option",{value:Je.value,children:Je.label},Je.value))]})}else if(Z.type==="boolean"){const ot=ke?me?"true":"false":"";mt=a.jsxs("select",{id:pe,className:"canvas-modal__parameter-select",value:ot,onChange:Je=>{const Ct=Je.target.value;if(!Ct.length){is(Z.name);return}Bn(Z.name,Ct==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const ot=typeof me=="string"?me:"";mt=a.jsx("input",{id:pe,type:"text",className:"canvas-modal__parameter-input",value:ot,onChange:Je=>{const Ct=Je.target.value;if(!Ct.length){is(Z.name);return}Bn(Z.name,Ct)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:pe,className:"canvas-modal__parameter-label",children:[be,st&&a.jsx("span",{className:"canvas-modal__parameter-description",children:st})]}),mt,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:ke?`Override: ${Du(me)}`:Ae})})]},Z.name)},[J,Mt,ne,e,Bn]),jt=_.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const pe=`search-${e}-${Z.name}`,me=fe[Z.name]??"",ke=yt[Z.name],je=Array.isArray(ke)?ke.length:0,be=dt[Z.name],st=ne==null?void 0:ne[Z.name],Ae=Z.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":Z.type==="boolean"?"Enter true/false values, separated by commas or new lines":Z.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",mt=Array.isArray(ke)?ke.slice(0,3).map(ot=>Du(ot)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:pe,className:"canvas-modal__parameter-label",children:[Z.label??Z.name,Z.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:Z.description})]}),a.jsx("textarea",{id:pe,className:"canvas-modal__parameter-input",rows:3,value:me,onChange:ot=>qs(Z,ot.target.value),placeholder:Ae,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:je>0?`Configured ${je} value${je===1?"":"s"}${mt?` (${mt}${je>3?"":""})`:""}`:`Default: ${Du(st)}`})}),be&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:be})]},Z.name)},[J,yt,qs,ne,e,dt,fe]),we=_.useMemo(()=>{if(!tn)return{parameterCount:0,candidateProduct:null};const Z=Object.values(yt),pe=Z.length;let me=null;if(Z.length>0){let ke=1,je=!1;Z.forEach(be=>{ke*=Math.max(be.length,1),(!Number.isFinite(ke)||ke>1e6)&&(je=!0)}),me=je?null:ke}return{parameterCount:pe,candidateProduct:me}},[yt,tn]),nt=_.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),tt=_.useCallback(Z=>{if(!nt)return null;const pe=rs(nt);if(!pe||!Array.isArray(pe.nodes))return nt;const me=Wl(Z),ke=Object.keys(me).length>0;return pe.nodes=pe.nodes.map(je=>{if(!je||je.id!==e)return je;const be=(je==null?void 0:je.data)??{},st=(be==null?void 0:be.config)??{},Ae=Wl(st),mt=ke?{...Ae,...me}:Ae;return{...je,data:{...be,config:mt,isConfigured:!0}}}),pe},[nt,e]),Ft=_.useMemo(()=>{const Z=tt(c);return Z||nt},[c,nt,tt]),Ot=_.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const Z=n.nodes,pe=n.edges;return(()=>{var st;const be=Z.find(Ae=>(Ae==null?void 0:Ae.id)===e);return be?ix((st=be==null?void 0:be.data)==null?void 0:st.connectedSplits):[]})().includes("validation")||pe.some(be=>!be||(typeof be.target=="string"?be.target:null)!==e?!1:(typeof be.sourceHandle=="string"?be.sourceHandle.toLowerCase():"").includes("validation"))?!0:pe.some(be=>{var Je;if(!be||(typeof be.target=="string"?be.target:null)!==e)return!1;const Ae=typeof be.source=="string"?be.source:null;if(!Ae)return!1;const mt=Z.find(Ct=>(Ct==null?void 0:Ct.id)===Ae);return mt?ix((Je=mt==null?void 0:mt.data)==null?void 0:Je.activeSplits).includes("validation"):!1})?!1:null},[n,e]);_.useEffect(()=>{let Z=!1;return!t||!nt?($(null),()=>{Z=!0}):(yo(t,nt).then(pe=>{Z||$(pe)}).catch(()=>{Z||$(null)}),()=>{Z=!0})},[nt,t]),_.useEffect(()=>{let Z=!1;j(null);const pe=Ft??nt;return!t||!pe?(E(null),()=>{Z=!0}):(yo(t,pe).then(me=>{Z||E(me)}).catch(me=>{Z||(j((me==null?void 0:me.message)??"Unable to compute pipeline ID"),E(null))}),()=>{Z=!0})},[nt,Ft,t]),_.useEffect(()=>{if(!N||!P){D(!1);return}D(N!==P)},[N,P]);const nn=!!(t&&e),Vt=_.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",N??"pending",e],[e,N,t]),pn=Ls({queryKey:Vt,queryFn:async()=>{var pe;const Z={datasetSourceId:t||void 0,nodeId:e,limit:5};if(N){const me=await Ol({...Z,pipelineId:N});if((((pe=me==null?void 0:me.jobs)==null?void 0:pe.length)??0)>0)return me}return Ol(Z)},enabled:nn,retry:(Z,pe)=>pe.message.includes("Sign in")?!1:Z<2,refetchInterval:Z=>{const pe=Z.state.data;return((pe==null?void 0:pe.jobs)??[]).some(je=>je.status==="queued"||je.status==="running")?5e3:!1}}),{mutateAsync:Es,isPending:Xn,error:yn}=qc({mutationFn:gy,onSuccess:Z=>{const pe=Array.isArray(Z.jobs)?Z.jobs.length:0,me=pe>0?Z.jobs[0]:null;k(me),R(pe),x.invalidateQueries({queryKey:Vt})}}),En=_.useMemo(()=>{const Z=[];return t||Z.push("Select a dataset before launching tuning jobs."),(!nt||!nt.nodes.length)&&Z.push("Connect this node to an upstream pipeline before tuning."),G||Z.push("Set a target column before tuning."),Ot===!1&&Z.push("Connect the validation split to this node to enable tuning."),H||Z.push("Choose a model type before enqueuing tuning jobs."),pt.length===0&&Z.push("Add a tuning strategy before launching tuning jobs."),tn||Z.push("Define at least one hyperparameter in the search space."),Qe&&Z.push(Qe),Yt&&Z.push(Yt),Bt&&Z.push("Resolve invalid candidate values in the search space."),(Ne==="random"||Ne==="optuna")&&!Ue&&Z.push("Provide the maximum iterations for random or Optuna search."),re&&ze<2&&Z.push("Cross-validation requires at least 2 folds."),S&&Z.push(S),Z},[Qe,re,ze,nt,tn,Bt,H,S,Ue,Yt,Ne,t,G,Ot,pt.length]),Jn=((Zn=pn.data)==null?void 0:Zn.jobs)??[],$n=pn.isLoading||pn.isFetching,Jr=pn.error,$a=_.useMemo(()=>!!(yn instanceof Error&&Ci(yn.message)||V&&Ci(V)||C&&Bl(C)||Jn.some(Z=>Bl(Z))),[V,yn,C,Jn]),gt=qb({graph:n,nodeId:e,modelType:H,problemType:W,modelTypeOptions:p,enabled:$a});_.useEffect(()=>{gt||q(!1)},[gt]);const zo=En.length>0||Bt||!N||!t||!nt||pt.length===0||!tn||Xn,Do=_.useMemo(()=>d?p.length?{...d,options:p}:d:null,[p,d]),Fo=_.useCallback(async()=>{if(!N||!t||!nt||pt.length===0)return;if(y){try{const je=y({closeModal:!1});D(!1),je&&typeof je.then=="function"&&await je}catch{}await new Promise(je=>setTimeout(je,100))}const Z=async()=>{const je=[],be=[],st=async Ae=>{if(!Ae)return new Set;if(Ae===H)return J;const mt=["model-hyperparameters",Ae],ot=x.getQueryData(mt),Je=Ct=>{const Pn=new Set;return(Ct??[]).forEach(Wt=>{Wt!=null&&Wt.name&&Pn.add(Wt.name)}),Pn};if(ot)return Je(ot.fields);try{const Ct=await x.fetchQuery({queryKey:mt,queryFn:()=>Nu(Ae)});return Je(Ct==null?void 0:Ct.fields)}catch{return new Set}};for(let Ae=0;Ae<pt.length;Ae+=1){const mt=pt[Ae],ot=mt.label||wa(Ae+1),Je=Mi(mt.config),Ct=Je==null?void 0:Je[X],Pn=typeof Ct=="string"&&Ct.trim().length?Ct.trim():H;if(!Pn){be.push(`${ot} is missing a model selection.`);continue}const Wt=zu(Je==null?void 0:Je[I],He)??de??"random",kn=await st(Pn),Ms=xa(Je==null?void 0:Je.baseline_hyperparameters).value??{},Ws=kn.size>0?Fh(Ms,kn):rs(Ms),Tr=xa(Je==null?void 0:Je.search_space);if(Tr.error){be.push(`${ot} has invalid search space: ${Tr.error}`);continue}const sr=Dh(Tr.value);if(sr.error){be.push(`${ot} has invalid search space: ${sr.error}`);continue}const Un=sr.value??{},ps=kn.size>0?Ih(Un,kn):rs(Un);if(!ps||Object.keys(ps).length===0){be.push(`${ot} requires at least one hyperparameter in the search space.`);continue}if(Object.values(mt.searchSpaceFieldErrors??{}).some(Zt=>!!Zt)){be.push(`${ot} has search space entries that need attention.`);continue}const Pa=Object.keys(ps).length;let gs=null;if(Pa>0){let Zt=1,An=!1;Object.values(ps).forEach(es=>{const Bo=Array.isArray(es)?es.length:0;Zt*=Math.max(Bo,1),(!Number.isFinite(Zt)||Zt>1e6)&&(An=!0)}),gs=An?null:Zt}const Zr=Je==null?void 0:Je[te],ea=typeof Zr=="string"?Zr.trim():"",ta=ea.length?ea:null,na=()=>{const Zt=Je==null?void 0:Je[L];let An=null;if(typeof Zt=="number"&&Number.isFinite(Zt))An=Math.max(1,Math.floor(Zt));else if(typeof Zt=="string"){const es=Number(Zt.trim());Number.isFinite(es)&&es>0&&(An=Math.max(1,Math.floor(es)))}return An===null&&(Wt==="random"||Wt==="optuna")?Ge!==null?Ge:null:An},sa=()=>{const Zt=Je==null?void 0:Je[U];let An=null;if(typeof Zt=="number"&&Number.isFinite(Zt))An=Math.trunc(Zt);else if(typeof Zt=="string"){const es=Number(Zt.trim());Number.isFinite(es)&&(An=Math.trunc(es))}return An===null&&(Wt==="random"||Wt==="optuna")?ut!==null?ut:null:An},Ra=na(),Mn=sa(),Jt={};G&&(Jt.target_column=G),Jt.problem_type=W,Jt.strategy_id=mt.id,Jt.strategy_label=ot,Jt.strategy_index=Ae+1,Jt.search_strategy=Wt,Ra!==null&&(Wt==="random"||Wt==="optuna")&&(Jt.max_iterations=Ra),ta&&(Jt.scoring_metric=ta),Mn!==null&&(Jt.random_state=Mn),Jt.search_space_keys=Object.keys(ps),Pa>0&&(Jt.search_space_parameters=Pa),gs!==null&&(Jt.search_space_candidates=gs),Jt.cross_validation={enabled:re,strategy:Se,folds:ze,shuffle:$e,random_state:Be};const Ks=tt(Je)??nt;if(!Ks){be.push(`Unable to build pipeline graph for ${ot}.`);continue}const $r=Ws&&Object.keys(Ws).length>0?rs(Ws):void 0,sc=rs(ps),La={dataset_source_id:t,pipeline_id:N,node_id:e,model_type:Pn,model_types:[Pn],search_strategy:Wt,search_space:sc,baseline_hyperparameters:$r,n_iterations:Wt==="random"||Wt==="optuna"?Ra??void 0:void 0,scoring:ta??void 0,random_state:Mn??void 0,cross_validation:{enabled:re,strategy:Se,folds:ze,shuffle:$e,random_state:Be},metadata:Jt,job_metadata:Jt,run_tuning:!0,graph:Ks,target_node_id:e};je.push({payload:La,label:ot})}return{plans:je,issues:be}};z(null);const{plans:pe,issues:me}=await Z();if(!pe.length){me.length&&z(me.join(" "));return}const ke=[];for(const{payload:je}of pe)try{const be=await Es(je);Array.isArray(be==null?void 0:be.jobs)&&be.jobs.length&&ke.push(...be.jobs)}catch(be){be instanceof Error&&be.message?z(be.message):z("Failed to enqueue one or more tuning jobs.");return}if(ke.length){const je=ke[ke.length-1];k(je),R(ke.length)}},[J,re,ze,Be,$e,Se,Es,nt,tt,H,X,e,y,de,x,N,W,te,Ge,L,ut,U,I,z,D,t,pt,G]),Io=_.useCallback(()=>{nn&&pn.refetch()},[nn,pn]),Or=Z=>{var Pn,Wt,kn,ks,Ms;const pe=q2[Z.status]??Z.status,ke=(((Pn=p.find(Ws=>Ws.value===Z.model_type))==null?void 0:Pn.label)??Z.model_type??"").trim(),je=(()=>{switch(Z.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"halving_random":return"Successive halving (randomized)";case"optuna":return"Optuna search";default:return"Random search"}})(),be=Z.updated_at?zn(Z.updated_at):null,st=Z.updated_at||Z.created_at,Ae=st?be??new Date(st).toLocaleString():null,mt=typeof Z.error_message=="string"?Z.error_message.trim():"",ot=[];ke&&ot.push(`Model ${ke}`),ot.push(je),Array.isArray(Z.results)&&Z.results.length>0&&ot.push(`${Z.results.length} candidates`);const Je=typeof Z.best_score=="number"&&Number.isFinite(Z.best_score)?Z.best_score:typeof((Wt=Z.metrics)==null?void 0:Wt.best_score)=="number"?Z.metrics.best_score:null;Je!==null&&ot.push(`Best score ${H2(Je)}`);const Ct=String(((kn=Z.metrics)==null?void 0:kn.scoring)??((ks=Z.metrics)==null?void 0:ks.scorer)??((Ms=Z.metadata)==null?void 0:Ms.scoring_metric)??"").trim();if(Ct&&ot.push(`Scoring ${Ct}`),Z.status==="failed"&&mt){const Ws=mt.replace(/\s+/g," ");ot.push(`Error: ${Ws}`)}return Ae&&ot.push(`Updated ${Ae}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["Run ",Z.run_number]}),"  ",pe,ot.length?`  ${ot.join("  ")}`:""]},Z.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Ve,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Io,disabled:!nn||$n,children:$n?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),N&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:N})]}),A&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]}),En.map((Z,pe)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Z},`tuning-prereq-${pe}`)),yn instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:yn.message}),V&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:V}),Jr&&!(yn instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Jr.message||"Unable to load tuning jobs."}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:O>1?a.jsxs("span",{children:["Queued ",O," tuning jobs. Latest job ",C.id," (run ",C.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",C.id," queued (run ",C.run_number,")."]})}),tn&&we.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",we.parameterCount," hyperparameter",we.parameterCount===1?"":"s",we.candidateProduct!==null?`  up to ${we.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsxs("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:[pt.length===0&&a.jsx("p",{style:{margin:"0",padding:"1rem 1.25rem",border:"1px dashed rgba(148, 163, 184, 0.4)",borderRadius:"6px",color:"rgba(148, 163, 184, 0.85)",background:"rgba(15, 23, 42, 0.35)"},children:'No tuning strategies configured yet. Use "Add strategy" to define your search plan.'}),pt.map((Z,pe)=>{const me=Fn[pe],ke=!!(Ht&&Ht.id===Z.id),je=Yn.has(Z.id),be=[];if(me!=null&&me.modelLabel&&be.push(me.modelLabel),me!=null&&me.searchStrategyLabel&&be.push(me.searchStrategyLabel),me!=null&&me.scoringLabel&&be.push(`Scoring ${me.scoringLabel}`),me!=null&&me.parameterCount){const Ae=me.candidateCount?`${me.parameterCount} param${me.parameterCount===1?"":"s"}  ${me.candidateCount} candidate${me.candidateCount===1?"":"s"}`:`${me.parameterCount} param${me.parameterCount===1?"":"s"}`;be.push(Ae)}else be.includes("Needs attention")||be.push("No search values");me!=null&&me.hasErrors&&be.push("Needs attention");const st=be.length>0?be.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{tr(Z.id),ke||Qn(Z.id)},"aria-expanded":je,"aria-controls":`tuning-strategy-body-${Z.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${je?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(me==null?void 0:me.label)??wa(pe+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:st})]})]}),pt.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>as(Z.id),"aria-label":`Remove ${(me==null?void 0:me.label)??wa(pe+1)}`,children:"Remove"})]}),je&&ke&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${Z.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Do&&u(Do),h&&u(h),(Ne==="random"||Ne==="optuna")&&f&&u(f),(Ne==="random"||Ne==="optuna")&&g&&u(g)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:nr}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Qt}),a.jsxs("div",{id:Xe,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:os||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[In.map(Ae=>a.jsx("button",{type:"button",onClick:()=>ve(Ae.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:os===Ae.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:os===Ae.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:Ae.label},Ae.value)),a.jsx("button",{type:"button",onClick:()=>ve(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),H&&Q.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:jn>0?`${jn} override${jn===1?"":"s"} configured`:"Using template defaults"}),jn>0&&a.jsx("button",{type:"button",onClick:gr,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),Qe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Qe}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:Q.map(Pe)})]}),H&&Q.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Rt>0?`${Rt} parameter${Rt===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:ie,disabled:Rt===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Rt===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:Rt===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:Rt===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),Yt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Yt}),Bt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:Q.map(jt)})]})]})]},Z.id)})]}),re&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",ze," folds before reporting aggregate metrics."]}),gt&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",gt.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:gt.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>q(Z=>!Z),style:{whiteSpace:"nowrap"},children:F?"Hide tips":"Show tips"})]}),F&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:gt.details.map((Z,pe)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:Z},`tuning-scaling-tip-${pe}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Fo,disabled:zo,children:Xn?"Queuing":"Launch tuning job"})}),$n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!$n&&Jn.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),Jn.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Jn.map(Or)})]})},qh={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},e$=(e,t)=>{if(e==null||e==="")return qh[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return qh[t].auto;const s=Math.max(Math.min(e,1),0),i=s*100,l=s.toFixed(s>=.1||s===0?2:3),c=t==="undersampling"?"majority":"majority baseline";return`${l} ratio (${i.toFixed(1)}% of ${c})`}const n=e.trim().toLowerCase();return qh[t][n]??n},t$=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let s=e.length-1;s>=0;s-=1){const i=e[s];if(typeof i!="string")continue;const l=i.toLowerCase();if(n.some(c=>l.includes(c)))return i}return null},n$=(e,t)=>t?"Missing":e.length?e:"Empty string",s$=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:i,config:l,methodParameter:c,targetColumnParameter:u,samplingStrategyParameter:d,randomStateParameter:p,replacementParameter:h,kNeighborsParameter:f,renderParameterField:g,formatMetricValue:b,formatMissingPercentage:w,schemaGuard:y})=>{var L;const x=s.data,N=s.status,E=Array.isArray(x==null?void 0:x.applied_steps)?x==null?void 0:x.applied_steps:[],S=_.useMemo(()=>t$(E,e),[E,e]),j=(l==null?void 0:l.targetColumn)??"",C=(l==null?void 0:l.method)||(typeof(c==null?void 0:c.default)=="string"?c.default:""),k=_.useMemo(()=>{const U=Array.isArray(c==null?void 0:c.options)?c==null?void 0:c.options:[];if(C){const te=U.find(K=>K.value===C);return te!=null&&te.label?te.label:C.replace(/_/g," ")}return U.length>0?U[0].label??U[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[C,c==null?void 0:c.options,e]),O=_.useMemo(()=>e$(l==null?void 0:l.samplingStrategy,e),[l==null?void 0:l.samplingStrategy,e]),R=_.useMemo(()=>(l==null?void 0:l.randomState)===null||(l==null?void 0:l.randomState)===void 0?"Not set":Number.isFinite(l.randomState)?String(l.randomState):"Not set",[l==null?void 0:l.randomState]),P=_.useMemo(()=>{if(e!=="oversampling")return null;const U=l==null?void 0:l.kNeighbors;if(typeof U=="number"&&Number.isFinite(U))return String(Math.max(1,Math.round(U)));if(f&&typeof f.default=="number"){const te=f.default;if(Number.isFinite(te))return String(Math.max(1,Math.round(te)))}return"Default"},[l==null?void 0:l.kNeighbors,f,e]),$=(l==null?void 0:l.replacement)===null||(l==null?void 0:l.replacement)===void 0?null:l.replacement?"With replacement":"Without replacement",A=_.useMemo(()=>{if(N!=="success"||!x||!j)return{rows:[],total:0,truncated:!1};const U=Array.isArray(x.sample_rows)?x.sample_rows:[];if(!U.length)return{rows:[],total:0,truncated:!1};const te=new Map;U.forEach(re=>{if(!re||typeof re!="object")return;const Se=re[j],ze=Se==null,$e=ze?"__missing__":String(Se),Be=n$(ze?"":$e,ze),it=te.get($e);it?it.count+=1:te.set($e,{label:Be,count:1,percentage:0,isMissing:ze})});const K=Array.from(te.values()).sort((re,Se)=>Se.count-re.count),H=K.reduce((re,Se)=>re+Se.count,0),Y=8,Q=K.length>Y;return{rows:(Q?K.slice(0,Y):K).map(re=>({...re,percentage:H>0?re.count/H*100:0})),total:H,truncated:Q}},[x,N,j]),D=((L=x==null?void 0:x.metrics)==null?void 0:L.row_count)??null,V=!!t&&n&&N!=="loading"&&!(y!=null&&y.blocked),z=_.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),F=_.useMemo(()=>!(y!=null&&y.blocked)||!y.details.length?"":y.details.map(U=>U.logical_family?`${U.name} (${U.logical_family})`:U.name).join(", "),[y]),q=!j,G=!!j&&Array.isArray(x==null?void 0:x.columns)&&!(x!=null&&x.columns.includes(j)),W=e==="undersampling"?"Class undersampling":"Class oversampling",X=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",I=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:W}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:!V,children:N==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:X}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),q&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",I,"."]}),(y==null?void 0:y.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[y.message,F&&a.jsxs(a.Fragment,{children:[" ","Columns: ",F,"."]})]}),N==="error"&&s.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),G&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",j," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:S}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:k})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:O})]}),e==="oversampling"&&P&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:P})]}),$&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:$})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:R})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[c&&g(c),d&&g(d),e==="oversampling"&&f&&g(f),p&&g(p),h&&g(h)]}),u&&a.jsx("div",{className:"canvas-modal__parameter-list",children:g(u)}),j&&N==="success"&&!G&&(A.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:A.rows.map(U=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:U.label}),a.jsx("td",{children:b(U.count)}),a.jsx("td",{children:w(U.percentage)})]},`resampling-class-${U.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",b(A.total)," row",A.total===1?"":"s"," from the preview.",A.truncated?" Showing top classes by frequency.":""]}),D!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",b(D),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},r$=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},a$=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),o$=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),i$=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return _.useMemo(()=>{const s=r$(e),i=t==="data_preview",l=t==="dataset_profile",c=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",u=t==="missing_value_indicator",d=t==="replace_aliases_typos",p=t==="trim_whitespace",h=t==="remove_special_characters",f=t==="replace_invalid_values",g=t==="regex_replace_fix",b=t==="normalize_text_case",w=t==="standardize_date_formats",y=t==="label_encoding",x=t==="target_encoding",N=t==="hash_encoding",E=t==="train_model_draft",S=t==="model_evaluation",j=t==="model_registry_overview",C=t==="hyperparameter_tuning",k=t==="feature_target_split",O=t==="train_test_split",R=t==="class_undersampling",P=t==="class_oversampling",$=t==="ordinal_encoding",A=t==="dummy_encoding",D=t==="one_hot_encoding",V=t==="feature_math",z=t==="cast_column_types",F=t==="binning_discretization",q=t==="scale_numeric_features",G=t==="polynomial_features",W=t==="feature_selection",X=t==="transformer_audit",I=t==="outlier_removal",L=t==="skewness_transform",U=t==="skewness_distribution",te=t==="binned_distribution",K=o$.has(t),H=a$.has(t),Y=t==="remove_duplicates",Q=t==="drop_missing_columns",ne=t==="drop_missing_rows";return{catalogType:t,isDataset:s,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:p,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:f,isRegexCleanupNode:g,isNormalizeTextCaseNode:b,isStandardizeDatesNode:w,isLabelEncodingNode:y,isTargetEncodingNode:x,isHashEncodingNode:N,isTrainModelDraftNode:E,isModelEvaluationNode:S,isModelRegistryNode:j,isHyperparameterTuningNode:C,isFeatureTargetSplitNode:k,isTrainTestSplitNode:O,isClassUndersamplingNode:R,isClassOversamplingNode:P,isOrdinalEncodingNode:$,isDummyEncodingNode:A,isOneHotEncodingNode:D,isFeatureMathNode:V,isCastNode:z,isBinningNode:F,isScalingNode:q,isPolynomialFeaturesNode:G,isFeatureSelectionNode:W,isTransformerAuditNode:X,isOutlierNode:I,isSkewnessNode:L,isSkewnessDistributionNode:U,isBinnedDistributionNode:te,isDataConsistencyNode:K,isInspectionNode:H,isRemoveDuplicatesNode:Y,isDropMissingColumnsNode:Q,isDropMissingRowsNode:ne,isDropMissingNode:Q||ne,isPreviewNode:i,isDatasetProfileNode:l}},[t,e])},l$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isScalingNode:l}=e,[c,u]=_.useState(null),[d,p]=_.useState(null),[h,f]=_.useState(!1),[g,b]=_.useState(0),w=_.useCallback(()=>{b(y=>y+1)},[]);return _.useEffect(()=>{let y=!0;return l?t?n?(f(!0),p(null),sy(t,{graph:s,targetNodeId:i}).then(x=>{y&&u(x??null)}).catch(x=>{y&&(u(null),p((x==null?void 0:x.message)??"Unable to load scaling insights"))}).finally(()=>{y&&f(!1)}),()=>{y=!1}):(u(null),p("Connect this step to an upstream output to load scaling insights."),f(!1),()=>{y=!1}):(u(null),p("Select a dataset to load scaling insights."),f(!1),()=>{y=!1}):(u(null),p(null),f(!1),()=>{y=!1})},[s,n,l,g,t,i]),{scalingData:c,scalingError:d,isFetchingScaling:h,refreshScaling:w}},c$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isBinningNode:l}=e,[c,u]=_.useState(null),[d,p]=_.useState(null),[h,f]=_.useState(!1),[g,b]=_.useState(0),w=_.useCallback(()=>{b(y=>y+1)},[]);return _.useEffect(()=>{let y=!0;return l?t?n?(f(!0),p(null),ry(t,{graph:s,targetNodeId:i}).then(x=>{y&&u(x??null)}).catch(x=>{y&&(u(null),p((x==null?void 0:x.message)??"Unable to load binning insights"))}).finally(()=>{y&&f(!1)}),()=>{y=!1}):(u(null),p("Connect this step to an upstream output to analyse numeric columns."),f(!1),()=>{y=!1}):(u(null),p("Select a dataset to load binning insights."),f(!1),()=>{y=!1}):(u(null),p(null),f(!1),()=>{y=!1})},[s,n,l,g,t,i]),{binningData:c,binningError:d,isFetchingBinning:h,refreshBinning:w}},u$=({catalogFlags:e,sourceId:t,graphContext:n,targetNodeId:s,transformations:i})=>{const{isSkewnessNode:l,isSkewnessDistributionNode:c}=e,u=l||c,[d,p]=_.useState(null),[h,f]=_.useState(null),[g,b]=_.useState(!1),[w,y]=_.useState(0),x=_.useRef(null),N=_.useCallback(()=>{y(E=>E+1)},[]);return _.useEffect(()=>{let E=!0;return u?t?(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{if(!E)return;b(!0),f(null);let S;i.length>0&&(S=i.map(j=>({column:j.column,method:j.method}))),ny(t,{transformations:S,graph:n,targetNodeId:s}).then(j=>{E&&p(j??null)}).catch(j=>{E&&(p(null),f((j==null?void 0:j.message)??"Unable to load skewness insights"))}).finally(()=>{E&&b(!1)})},300),()=>{E=!1,x.current&&clearTimeout(x.current)}):(p(null),f("Select a dataset to load skewness insights."),b(!1),x.current&&(clearTimeout(x.current),x.current=null),()=>{E=!1}):(p(null),f(null),b(!1),x.current&&(clearTimeout(x.current),x.current=null),()=>{E=!1})},[n,w,u,t,s,i]),{skewnessData:d,skewnessError:h,isFetchingSkewness:g,refreshSkewness:N}},d$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i,samplePreset:l})=>{const{isBinnedDistributionNode:c}=e,[u,d]=_.useState(null),[p,h]=_.useState(null),[f,g]=_.useState(!1),[b,w]=_.useState(0),y=_.useCallback(()=>{w(x=>x+1)},[]);return _.useEffect(()=>{let x=!0;if(!c)return d(null),h(null),g(!1),()=>{x=!1};if(!t)return d(null),h("Select a dataset to load binned column distributions."),g(!1),()=>{x=!1};if(!n)return d(null),h("Connect this step to an upstream output to load binned column distributions."),g(!1),()=>{x=!1};g(!0),h(null);const N=$l.find(S=>S.value===l)??$l[0],E=N.value==="all"?"all":Number(N.value);return ay(t,{sampleSize:E,graph:s,targetNodeId:i}).then(S=>{x&&d(S??null)}).catch(S=>{x&&(d(null),h((S==null?void 0:S.message)??"Unable to load binned column distributions"))}).finally(()=>{x&&g(!1)}),()=>{x=!1}},[s,n,c,b,l,t,i]),{binnedDistributionData:u,binnedDistributionError:p,isFetchingBinnedDistribution:f,refreshBinnedDistribution:y}},m$=({catalogFlags:e,binnedDistributionData:t})=>{const{isBinnedDistributionNode:n}=e;return _.useMemo(()=>{if(!n)return[];const i=(Array.isArray(t==null?void 0:t.columns)?t==null?void 0:t.columns:[]).map(l=>{if(!l||!l.column)return null;const c=Number(l.total_rows),u=Number.isFinite(c)?Math.max(0,Math.round(c)):0;if(u<=0)return null;const p=(Array.isArray(l.bins)?l.bins:[]).map(P=>{if(!P)return null;const A=(typeof P.label=="string"?P.label.trim():String(P.label??""))||(P.is_missing?"Missing":"Unlabeled bin"),D=Number(P.count);if(!Number.isFinite(D))return null;const V=Math.max(0,Math.round(D)),z=Number(P.percentage),F=Number.isFinite(z)?Math.min(100,Math.max(0,z)):0,q=Number(F.toFixed(2));return{label:A,count:V,percentage:q,isMissing:!!P.is_missing}}).filter(P=>!!P);if(!p.length)return null;p.sort((P,$)=>P.isMissing!==$.isMissing?P.isMissing?1:-1:P.count!==$.count?$.count-P.count:P.label.localeCompare($.label));const h=p.length,f=12,g=h>f,b=g?p.slice(0,f):p,w=Number(l.missing_rows),y=Number.isFinite(w)?Math.max(0,Math.round(w)):0,x=Number(l.distinct_bins),N=Number.isFinite(x)?Math.max(0,Math.round(x)):p.length,E=l.top_label;let S=typeof E=="string"?E.trim()||null:E??null;const j=Number(l.top_count);let C=Number.isFinite(j)?Math.max(0,Math.round(j)):null;const k=Number(l.top_percentage);let O=Number.isFinite(k)?Number(Math.min(100,Math.max(0,k)).toFixed(2)):null;(S===null||C===null||O===null)&&b.length&&(S=b[0].label,C=b[0].count,O=b[0].percentage);const R=typeof l.source_column=="string"?l.source_column.trim()||null:l.source_column??null;return{column:l.column,sourceColumn:R,totalRows:u,missingRows:y,distinctBins:N,topLabel:S,topCount:C,topPercentage:O,bins:b,hasMoreBins:g,totalBinCount:h}}).filter(l=>!!l);return i.sort((l,c)=>{const u=(c.topCount??0)-(l.topCount??0);return u!==0?u:l.column.localeCompare(c.column)}),i},[t,n])},h$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i,setAvailableColumns:l,setColumnMissingMap:c})=>{const{isImputerNode:u}=e,d=u,[p,h]=_.useState(!1),[f,g]=_.useState(null),[b,w]=_.useState(0),y=_.useCallback(()=>{!d||!t||!n||w(x=>x+1)},[n,d,t]);return _.useEffect(()=>{let x=!0;return d?t?n?(h(!0),g(null),ph(t,{graph:s,targetNodeId:i}).then(N=>{if(!x)return;const E={};N&&typeof N=="object"&&(N!=null&&N.column_missing_map)&&typeof N.column_missing_map=="object"&&Object.entries(N.column_missing_map).forEach(([C,k])=>{const O=String(C??"").trim();if(!O)return;const R=Number(k);Number.isNaN(R)||R<0||(E[O]=Number(R))});const S=new Set;Array.isArray(N==null?void 0:N.all_columns)&&N.all_columns.forEach(C=>{const k=String(C??"").trim();k&&S.add(k)}),Object.keys(E).forEach(C=>S.add(C));const j=Array.from(S).sort((C,k)=>C.localeCompare(k));j.forEach(C=>{Object.prototype.hasOwnProperty.call(E,C)||(E[C]=0)}),j.length&&l(j),Object.keys(E).length&&c(C=>({...C,...E}))}).catch(N=>{x&&g((N==null?void 0:N.message)??"Unable to load column metrics.")}).finally(()=>{x&&h(!1)}),()=>{x=!1}):(g("Connect this step to an upstream output to load column metrics."),h(!1),()=>{x=!1}):(g("Select a dataset to load column metrics."),h(!1),()=>{x=!1}):()=>{x=!1}},[s,n,b,l,c,d,t,i]),{isFetching:p,error:f,refreshDropColumnRecommendations:y}},f$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isOutlierNode:l}=e,[c,u]=_.useState(null),[d,p]=_.useState(null),[h,f]=_.useState(!1),[g,b]=_.useState(0),w=_.useCallback(()=>{b(y=>y+1)},[]);return _.useEffect(()=>{let y=!0;return l?t?n?(f(!0),p(null),ty(t,{graph:s,targetNodeId:i}).then(x=>{y&&u(x??null)}).catch(x=>{y&&(u(null),p((x==null?void 0:x.message)??"Unable to load outlier insights"))}).finally(()=>{y&&f(!1)}),()=>{y=!1}):(u(null),p("Connect this step to an upstream output to load outlier insights."),f(!1),()=>{y=!1}):(u(null),p("Select a dataset to load outlier insights."),f(!1),()=>{y=!1}):(u(null),p(null),f(!1),()=>{y=!1})},[s,n,l,g,t,i]),{outlierData:c,outlierError:d,isFetchingOutliers:h,refreshOutliers:w}},p$=["int","float","double","decimal","number","numeric","long","short"],g$=["datetime","date","time","timestamp"],_$=["object","string","text","category","categorical","char"],v$=({catalogFlags:e,availableColumns:t,columnTypeMap:n,previewSampleRows:s})=>{const{isBinningNode:i,isScalingNode:l,isOutlierNode:c}=e,u=i||l||c,d=_.useMemo(()=>{if(!u)return{excluded:new Set,reasons:new Map};const p=new Set,h=new Map;return t.forEach(f=>{const g=(n[f]??"").toLowerCase(),b=p$.some(C=>g.includes(C)),w=g$.some(C=>g.includes(C)),y=_$.some(C=>g.includes(C));if(g.includes("bool")){p.add(f),h.set(f,"Boolean dtype");return}if((w||y)&&!b){p.add(f),h.set(f,"Non-numeric dtype");return}const x=s.map(C=>C&&Object.prototype.hasOwnProperty.call(C,f)?C[f]:void 0).filter(C=>C!=null);if(!x.length){b||(p.add(f),h.set(f,"No numeric samples"));return}let N=!0,E=!1,S=!1;const j=new Set;for(const C of x){if(typeof C=="boolean"){j.add(C?"1":"0");continue}if(typeof C=="number"){if(!Number.isFinite(C)){N=!1;break}E=!0,Math.abs(C)<1e-9?j.add("0"):Math.abs(C-1)<1e-9?j.add("1"):S=!0;continue}if(typeof C=="string"){const k=C.trim();if(!k)continue;const O=k.toLowerCase();if(Kb.has(O)){j.add("1");continue}if(Yb.has(O)){j.add("0");continue}const R=Number(k);if(!Number.isNaN(R)&&Number.isFinite(R)){E=!0,Math.abs(R)<1e-9?j.add("0"):Math.abs(R-1)<1e-9?j.add("1"):S=!0;continue}N=!1;break}N=!1;break}if(!N||!E&&!b){p.add(f),h.set(f,"Non-numeric values");return}!S&&j.size>0&&Array.from(j).every(k=>k==="0"||k==="1")&&(p.add(f),h.set(f,"Binary/bool-like values"))}),{excluded:p,reasons:h}},[t,n,s,u]);return{numericExcludedColumns:d.excluded,numericExclusionReasons:d.reasons}},y$=({catalogFlags:e,imputerStrategies:t,availableColumns:n,columnMissingMap:s,previewColumns:i,previewColumnStats:l,nodeColumns:c,imputerMissingFilter:u})=>{const{isImputerNode:d}=e,p=_.useMemo(()=>{if(!d)return[];const b=i.length?new Set(i.map(j=>typeof j=="string"?j.trim():"").filter(j=>j.length>0)):null,w=new Set;t.forEach(j=>{j.columns.forEach(C=>{const k=typeof C=="string"?C.trim():"";k&&w.add(k)})}),Ke(c).forEach(j=>{j&&w.add(j)});const y=j=>!b||b.size===0?!1:!b.has(j)&&!w.has(j),x=new Map,N=(j,C)=>{const k=typeof j=="string"?j.trim():"";if(!k||y(k))return;const O=x.get(k)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};C&&(typeof C.missingPercentage=="number"&&!Number.isNaN(C.missingPercentage)&&(O.missingPercentage=Math.max(0,C.missingPercentage)),C.dtype!==void 0&&(O.dtype=C.dtype),typeof C.mean=="number"&&!Number.isNaN(C.mean)&&(O.mean=C.mean),typeof C.median=="number"&&!Number.isNaN(C.median)&&(O.median=C.median),C.mode!==void 0&&C.mode!==null&&C.mode!==""&&(O.mode=C.mode)),x.set(k,O)};n.forEach(j=>{const C=Object.prototype.hasOwnProperty.call(s,j)?s[j]:null;N(j,{missingPercentage:typeof C=="number"?C:null})}),(Array.isArray(l)?l:[]).forEach(j=>{!j||!j.name||N(j.name,{missingPercentage:typeof j.missing_percentage=="number"?j.missing_percentage:null,dtype:j.dtype??null,mean:typeof j.mean=="number"?j.mean:null,median:typeof j.median=="number"?j.median:null,mode:j.mode??null})}),Ke(c).forEach(j=>N(j)),t.forEach(j=>{j.columns.forEach(C=>N(C))});const S=Array.from(x.entries()).map(([j,C])=>({name:j,missingPercentage:typeof C.missingPercentage=="number"&&!Number.isNaN(C.missingPercentage)?Math.max(0,C.missingPercentage):null,dtype:C.dtype??null,mean:typeof C.mean=="number"&&!Number.isNaN(C.mean)?C.mean:null,median:typeof C.median=="number"&&!Number.isNaN(C.median)?C.median:null,mode:C.mode!==void 0&&C.mode!==null&&C.mode!==""?C.mode:null}));return S.sort((j,C)=>{const k=typeof j.missingPercentage=="number",O=typeof C.missingPercentage=="number";return k&&O&&j.missingPercentage!==C.missingPercentage?C.missingPercentage-j.missingPercentage:k!==O?k?-1:1:j.name.localeCompare(C.name)}),S},[n,s,t,c,l,i,d]),h=_.useMemo(()=>{if(!p.length)return 100;const b=p.reduce((y,x)=>{const N=typeof x.missingPercentage=="number"?x.missingPercentage:0;return N>y?N:y},0),w=Math.ceil(b/5)*5;return Math.max(100,w||0)},[p]),f=_.useMemo(()=>p.length?p.reduce((b,w)=>{const y=typeof w.missingPercentage=="number"?w.missingPercentage:null;return y!==null?y<=0?b:y>=u?b+1:b:u===0?b+1:b},0):0,[p,u]),g=u>0;return{imputerColumnOptions:p,imputerMissingSliderMax:h,imputerFilteredOptionCount:f,imputerMissingFilterActive:g}},b$=({configState:e,setConfigState:t,catalogFlags:n,upstreamTargetColumn:s,nodeId:i,modelTypeOptions:l})=>{const{isFeatureTargetSplitNode:c,isTrainTestSplitNode:u,isTrainModelDraftNode:d,isHyperparameterTuningNode:p,isClassOversamplingNode:h,isClassUndersamplingNode:f}=n,g=f||h,b=d||p,w=_.useMemo(()=>{if(!c)return null;const P=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",$=Ke(e==null?void 0:e.feature_columns).map(A=>typeof A=="string"?A.trim():"").filter(A=>!!A);return{targetColumn:P,featureColumns:$}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,c]),y=_.useMemo(()=>{if(!u)return null;const P=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,$=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,A=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,D=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,V=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,z=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:P,validation_size:$,random_state:A,shuffle:D,stratify:V,target_column:z}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,u]),x=_.useMemo(()=>{if(!g)return null;const P=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",$=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",A=e==null?void 0:e.sampling_strategy;let D=null;if(typeof A=="number"&&Number.isFinite(A))D=A;else if(typeof A=="string"){const G=A.trim();D=G||null}else A===null&&(D=null);const V=e==null?void 0:e.random_state;let z=null;if(typeof V=="number"&&Number.isFinite(V))z=V;else if(typeof V=="string"){const G=Number(V);z=Number.isFinite(G)?G:null}let F=null;if(f){const G=e==null?void 0:e.replacement;F=typeof G=="boolean"?G:typeof G=="string"?G.trim().toLowerCase()==="true":!!G}let q=null;if(h){const G=e==null?void 0:e.k_neighbors;if(typeof G=="number"&&Number.isFinite(G))q=Math.max(1,Math.round(G));else if(typeof G=="string"){const W=Number(G);Number.isFinite(W)&&(q=Math.max(1,Math.round(W)))}}return{method:P,targetColumn:$,samplingStrategy:D,randomState:z,replacement:F,kNeighbors:q}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,h,g,f]),N=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",E=N==="regression"?"regression":"classification",S=_.useMemo(()=>Array.isArray(l)?l.filter(P=>P&&typeof P.value=="string"):[],[l]),j=_.useMemo(()=>{const P={classification:[],regression:[]};return S.forEach($=>{var D;const A=String(((D=$==null?void 0:$.metadata)==null?void 0:D.problem_type)??"").trim().toLowerCase();A==="regression"?P.regression.push($):A==="classification"?P.classification.push($):(P.classification.push($),P.regression.push($))}),P},[S]),C=_.useMemo(()=>{if(!S.length)return[];const P=E==="regression"?j.regression:j.classification;return P.length>0?P:S},[S,j,E]),k=_.useMemo(()=>b?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:E}:null,[e==null?void 0:e.target_column,b,E]),O=_.useMemo(()=>{if(!b)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const P=(e==null?void 0:e.cv_enabled)===void 0?!!p:!!e.cv_enabled,$=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",A=["auto","kfold","stratified_kfold"].includes($)?$:"auto",D=Number(e==null?void 0:e.cv_folds),V=Number.isFinite(D)&&D>=2?Math.floor(D):5,z=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let F=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))F=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const W=Number(e.cv_random_state.trim());F=Number.isFinite(W)?Math.trunc(W):null}const G=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:P,strategy:A,folds:V,shuffle:z,randomState:F,refitStrategy:G}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,p,b]);_.useEffect(()=>{b&&N!==E&&t(P=>({...P,problem_type:E}))},[b,E,N,t]),_.useEffect(()=>{var D;if(!b||!C.length)return;const P=new Set(C.map(V=>V.value)),$=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if($&&P.has($))return;const A=((D=C[0])==null?void 0:D.value)??"";A&&t(V=>{const z=typeof(V==null?void 0:V.model_type)=="string"?V.model_type.trim():"";return z&&P.has(z)||z===A?V:{...V,model_type:A}})},[e==null?void 0:e.model_type,C,b,t]);const R=_.useMemo(()=>{if(!b)return null;const P=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",$=e==null?void 0:e.hyperparameters;let A=null,D=null;if($&&typeof $=="string"){const V=$.trim();if(V.length)try{const z=JSON.parse(V);z&&typeof z=="object"&&!Array.isArray(z)?A=z:D="Hyperparameters JSON must be an object."}catch{D="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else $&&typeof $=="object"&&!Array.isArray($)&&(A=$);return{modelType:P||null,hyperparameters:A,hyperparametersError:D}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,b]);return _.useEffect(()=>{(u||d||p)&&s&&(u&&(e==null?void 0:e.stratify)!==!0||t(P=>(typeof(P==null?void 0:P.target_column)=="string"?P.target_column.trim():"")?P:{...P,target_column:s}))},[e==null?void 0:e.stratify,p,d,u,i,t,s]),{featureTargetSplitConfig:w,trainTestSplitConfig:y,resamplingConfig:x,trainModelDraftConfig:k,trainModelRuntimeConfig:R,trainModelCVConfig:O,filteredModelTypeOptions:C}},x$=["int","float","double","numeric","number"],px=e=>{if(!e)return!1;const t=e.toLowerCase();return x$.some(n=>t.includes(n))},w$=({catalogFlags:e,skewnessData:t,skewnessTransformations:n,availableColumns:s,previewColumns:i,columnTypeMap:l,updateSkewnessTransformations:c})=>{const{isSkewnessNode:u,isSkewnessDistributionNode:d}=e,p=u||d,[h,f]=_.useState("recommended"),[g,b]=_.useState(!1),[w,y]=_.useState("before"),x=n.length,N=_.useMemo(()=>t!=null&&t.methods?[...t.methods]:[],[t==null?void 0:t.methods]),E=_.useMemo(()=>pM(N),[N]),S=_.useMemo(()=>t!=null&&t.columns?[...t.columns]:[],[t==null?void 0:t.columns]),j=_.useMemo(()=>{const I=new Map;return S.forEach(L=>{L&&L.column&&I.set(L.column,L)}),I},[S]),C=_.useMemo(()=>{const I=new Set;return S.forEach(L=>{L!=null&&L.column&&I.add(L.column)}),s.forEach(L=>{L&&px(l[L]??null)&&I.add(L)}),i.forEach(L=>{const U=typeof L=="string"?L.trim():"";U&&px(l[U]??null)&&I.add(U)}),Array.from(I).sort((L,U)=>L.localeCompare(U))},[s,i,S,l]);_.useEffect(()=>{h==="recommended"&&S.length===0&&C.length>0&&f("all")},[C.length,S.length,h]);const k=(t==null?void 0:t.skewness_threshold)??null,O=_.useCallback(I=>E[I]??I,[E]),R=_.useCallback((I,L)=>{const U=j.get(I);return!U||!U.method_status?{status:"ready",reason:void 0}:U.method_status[L]??{status:"ready",reason:void 0}},[j]),P=_.useCallback(()=>{const I=S.map(L=>{if(!L||!L.column)return null;const U=Array.isArray(L.recommended_methods)?L.recommended_methods.find(qr):void 0;return U?{column:L.column,method:U}:null}).filter(L=>!!L);I.length&&c(L=>{const U=new Map;return L.forEach(te=>{const K=typeof te.column=="string"?te.column.trim():"";K&&qr(te.method)&&U.set(K,te.method)}),I.forEach(te=>{const K=typeof te.column=="string"?te.column.trim():"";K&&U.set(K,te.method)}),Array.from(U.entries()).map(([te,K])=>({column:te,method:K}))})},[S,c]),$=_.useMemo(()=>{const I=new Map;return n.forEach(L=>{const U=typeof L.column=="string"?L.column.trim():"";!U||I.has(U)||I.set(U,L.method)}),I},[n]),A=_.useCallback((I,L)=>{const U=typeof I=="string"?I.trim():"";U&&c(te=>{const K=te.filter(H=>H.column!==U);return L?[...K,{column:U,method:L}]:K})},[c]),D=_.useCallback((I,L)=>{if(I){if(!L){A(I,null);return}qr(L)&&A(I,L)}},[A]),V=_.useCallback(()=>{c(()=>[])},[c]),z=S.length,F=_.useMemo(()=>S.some(I=>I&&typeof I.column=="string"&&Array.isArray(I.recommended_methods)&&I.recommended_methods.some(qr)),[S]),q=C.length,G=_.useMemo(()=>gM({viewMode:h,recommendations:S,columnOptions:C,recommendationMap:j,transformationMap:$}),[h,S,C,j,$]),W=_.useMemo(()=>p?S.map(I=>{var re;if(!I||!I.column)return null;const L=I.distribution_before??I.distribution??null;if(!L||!Array.isArray(L.bin_edges)||!Array.isArray(L.counts)||L.counts.length===0||L.bin_edges.length!==L.counts.length+1)return null;let U=I.distribution_after??null;U&&(!Array.isArray(U.bin_edges)||!Array.isArray(U.counts)||U.counts.length===0||U.bin_edges.length!==U.counts.length+1)&&(U=null);const te=((re=I.recommended_methods)==null?void 0:re.find(qr))??null,K=I.magnitude?`${I.magnitude.charAt(0).toUpperCase()}${I.magnitude.slice(1)}`:null,H=I.direction?My[I.direction]??I.direction:null,Y=I.applied_method&&qr(I.applied_method)?I.applied_method:null,Q=$.get(I.column)??null,ne=Y??Q??null,J=ne?O(ne):null;return{column:I.column,skewness:typeof I.skewness=="number"?I.skewness:null,magnitudeLabel:K,directionLabel:H,summary:I.summary??null,recommendedLabel:J?null:te?O(te):null,appliedLabel:J,distributionBefore:L,distributionAfter:U}}).filter(I=>!!I).sort((I,L)=>{const U=I.skewness!==null?Math.abs(I.skewness):-1/0,te=L.skewness!==null?Math.abs(L.skewness):-1/0;return U!==te?te-U:I.column.localeCompare(L.column)}):[],[O,p,S,$]),X=_.useMemo(()=>_M(G,g,O),[G,g,O]);return{state:{threshold:k,viewMode:h,groupByMethod:g,distributionView:w,recommendedCount:z,numericCount:q,transformationsCount:x,hasAutoRecommendations:F,rows:G,tableGroups:X,distributionCards:W},handlers:{setViewMode:f,setGroupByMethod:b,setDistributionView:y,getMethodLabel:O,getMethodStatus:R,applyRecommendations:P,handleOverrideChange:D,clearTransformations:V}}},N$={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},ws=["iqr","zscore","elliptic_envelope","winsorize","manual"],Co={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},Bu={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},Na={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Uu=(e,{min:t,max:n}={})=>{const s=typeof e=="number"?e:Number(e);if(!Number.isFinite(s))return null;let i=s;return typeof t=="number"&&Number.isFinite(t)&&i<t&&(i=t),typeof n=="number"&&Number.isFinite(n)&&i>n&&(i=n),i},gx=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const s=String(n??"").trim();s&&t.push(s)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,s)=>n.localeCompare(s))},j$=e=>{const t={iqr:{...Na.iqr},zscore:{...Na.zscore},elliptic_envelope:{...Na.elliptic_envelope},winsorize:{...Na.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,s])=>{const i=n.trim().toLowerCase();if(!ws.includes(i))return;const l=t[i]??{};if(!(!s||typeof s!="object"||Array.isArray(s))){if(Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Bu[i].includes(d))return;let p={};d==="threshold"?p={min:.1}:d==="multiplier"?p={min:.1}:(d==="lower_percentile"||d==="upper_percentile")&&(p={min:0,max:100});const h=Uu(u,p);h!==null&&(l[d]=h)}),i==="winsorize"){const c=Uu(l.lower_percentile,{min:0,max:100}),u=Uu(l.upper_percentile,{min:0,max:100});typeof c=="number"&&typeof u=="number"&&c>=u?(l.lower_percentile=Na.winsorize.lower_percentile,l.upper_percentile=Na.winsorize.upper_percentile):(typeof c=="number"&&(l.lower_percentile=c),typeof u=="number"&&(l.upper_percentile=u))}t[i]=l}}),t},C$=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,s])=>{const i=String(n??"").trim();if(!i||!s||typeof s!="object"||Array.isArray(s))return;const l={};Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Object.values(Bu).some(g=>g.includes(d)))return;let h={};d==="threshold"?h={min:.1}:d==="multiplier"?h={min:.1}:d==="contamination"?h={min:1e-4,max:.49}:(d==="lower_percentile"||d==="upper_percentile")&&(h={min:0,max:100});const f=Uu(u,h);f!==null&&(l[d]=f)}),Object.keys(l).length&&(t[i]=l)}),t},S$=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=gx(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",i=ws.includes(s)?s:"iqr",l={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([h,f])=>{const g=String(h??"").trim(),b=typeof f=="string"?f.trim().toLowerCase():"";g&&ws.includes(b)&&(l[g]=b)});const c=typeof t.auto_detect=="boolean"?t.auto_detect:!0,u=gx(t.skipped_columns),d=j$(t.method_parameters),p=C$(t.column_parameters);return{columns:n,defaultMethod:i,columnMethods:l,autoDetect:c,skippedColumns:u,methodParameters:d,columnParameters:p}},E$=e=>{const t={...Co};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&i&&ws.includes(s)&&(t[s]=i)}),t},k$=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&ws.includes(s)&&t.set(s,n)}),t},M$=e=>ws.map(t=>({value:t,label:e[t]??Co[t]??t})),A$=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:s,skippedColumns:i,excludedColumns:l})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p={};Array.isArray(u==null?void 0:u.method_summaries)&&u.method_summaries.forEach(S=>{const j=S==null?void 0:S.method;j&&ws.includes(j)&&(p[j]=S)});const h=u!=null&&u.recommended_method&&ws.includes(u.recommended_method)?u.recommended_method:null,f=h?n[h]??Co[h]??h:null,g=t.columnMethods[d]??null,b=g??t.defaultMethod,w=n[b]??Co[b]??b,y=i.has(d),x=l.has(d),N=s.has(d),E=!!(u!=null&&u.has_missing);c.push({column:d,dtype:typeof(u==null?void 0:u.dtype)=="string"?u.dtype:null,stats:(u==null?void 0:u.stats)??{},recommendedMethod:h,recommendedLabel:f,recommendedReason:typeof(u==null?void 0:u.recommended_reason)=="string"?u.recommended_reason:null,methodSummaries:p,currentOverride:g,currentMethod:b,currentMethodLabel:w,isOverrideApplied:g!==null,isSelected:N,isSkipped:y,isExcluded:x,hasMissing:E})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},O$=(e,t,n,s)=>{if(!e.length)return null;const i=e.map(l=>{const c=t[l],u=c?n[c]??Co[c]??c:null;return u?`${l} -> ${u}`:l});return s>e.length&&i.push(""),i.join(", ")},T$=(e,t)=>{var i;const n=(i=e==null?void 0:e.parameter_help)==null?void 0:i[t];if(n)return n;const s=t.replace(/_/g," ").trim();return s.charAt(0).toUpperCase()+s.slice(1)},$$=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},P$=(e,t,n,s,i)=>{var p;const l=n[s]??{};if(Object.prototype.hasOwnProperty.call(l,t)){const h=l[t];if(typeof h=="number"&&Number.isFinite(h))return{value:h,fallback:null}}const u=(i[e]??{})[t];return typeof u=="number"&&Number.isFinite(u)?{value:"",fallback:u}:{value:"",fallback:((p=Na[e])==null?void 0:p[t])??null??null}},_x=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",vx={lower_percentile:"%",upper_percentile:"%"},R$=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:s,outlierMethodOptions:i,outlierMethodDetailMap:l,outlierDefaultDetail:c,outlierAutoDetectEnabled:u,outlierSelectedCount:d,outlierDefaultLabel:p,outlierOverrideCount:h,outlierParameterOverrideCount:f,outlierOverrideExampleSummary:g,outlierHasOverrides:b,outlierRecommendationRows:w,outlierHasRecommendations:y,outlierStatusMessage:x,outlierError:N,outlierSampleSize:E,relativeOutlierGeneratedAt:S,outlierPreviewSignal:j,formatMetricValue:C,formatNumericStat:k,onApplyAllRecommendations:O,onClearOverrides:R,onDefaultMethodChange:P,onAutoDetectToggle:$,onOverrideSelect:A,onMethodParameterChange:D,onColumnParameterChange:V})=>{const z=$$(j);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:O,disabled:!y,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:R,disabled:!b,children:"Clear overrides"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),S&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",S,E!==null?` on ${C(E)} row${E===1?"":"s"}.`:"."]}),!S&&E!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",C(E)," row",E===1?"":"s","."]}),z&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",z]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:i.map(F=>{const q=l.get(F.value)??null,G=F.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${G?" canvas-scaling__method-button--active":""}`,"aria-pressed":G,onClick:()=>P(F.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:F.label}),(q==null?void 0:q.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:q.description})]},F.value)})}),(c==null?void 0:c.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:c.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:F=>$(F.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]})]}),a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for each strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:ws.map(F=>{const q=l.get(F)??null,G=Bu[F];if(!G.length)return null;const W=(q==null?void 0:q.label)??Co[F]??F;return a.jsxs("article",{className:"canvas-outlier__method-card",children:[a.jsxs("header",{className:"canvas-outlier__method-header",children:[a.jsx("span",{className:"canvas-outlier__method-title",children:W}),(q==null?void 0:q.description)&&a.jsx("p",{className:"canvas-outlier__method-summary",children:q.description})]}),a.jsx("div",{className:"canvas-outlier__parameter-list",children:G.map(X=>{var U,te;const I=((U=s.methodParameters[F])==null?void 0:U[X])??null,L=vx[X]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:T$(q,X)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx("input",{type:"number",className:"canvas-outlier__method-input-field",value:typeof I=="number"&&Number.isFinite(I)?I:"",placeholder:_x(((te=Na[F])==null?void 0:te[X])??null),onChange:K=>{const H=K.target.value;if(H==="")D(F,X,null);else{const Y=Number(H);D(F,X,Number.isFinite(Y)?Y:null)}}}),L&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:L})]})]},`${F}-${X}`)})})]},`outlier-method-${F}`)})})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s","  Default method"," ",a.jsx("strong",{children:p})," ",u?" Auto-detect on":" Auto-detect off",(()=>{if(!(h+f))return"  No overrides yet";const q=[];return h>0&&q.push(g?`${h} method override${h===1?"":"s"} (${g})`:`${h} method override${h===1?"":"s"}`),f>0&&q.push(`${f} parameter override${f===1?"":"s"}`),`  Overrides: ${q.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&N&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:N}),!n&&!N&&a.jsxs(a.Fragment,{children:[x&&a.jsx("p",{className:"canvas-modal__note",children:x}),w.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:w.map(F=>{const q=!F.isSkipped&&!F.isExcluded&&F.recommendedMethod&&F.recommendedMethod!==F.currentMethod,G=["canvas-cast__row"];q&&G.push("canvas-cast__row--attention"),F.isOverrideApplied&&G.push("canvas-cast__row--override"),F.isSkipped&&G.push("canvas-cast__row--muted");const W=F.isSkipped?"__skip__":F.isOverrideApplied?F.currentMethod:"__default__",X=F.isOverrideApplied?`Override -> ${F.currentMethodLabel}`:F.isSkipped?"Skipped (column will not be altered)":F.isSelected?`Inheriting ${p}`:"Pending inclusion",I=F.stats,L=[];typeof I.valid_count=="number"&&Number.isFinite(I.valid_count)&&L.push(`${C(I.valid_count)} valid rows`);const U=typeof I.minimum=="number"&&Number.isFinite(I.minimum),te=typeof I.maximum=="number"&&Number.isFinite(I.maximum);if(U||te){const J=U?k(I.minimum):"",re=te?k(I.maximum):"";L.push(`Range ${J}  ${re}`)}typeof I.mean=="number"&&Number.isFinite(I.mean)&&L.push(`Mean ${k(I.mean)}`),typeof I.median=="number"&&Number.isFinite(I.median)&&L.push(`Median ${k(I.median)}`),typeof I.stddev=="number"&&Number.isFinite(I.stddev)&&L.push(` ${k(I.stddev)}`);const K=L.length?L.join("  "):null,H=!F.recommendedMethod||!F.recommendedLabel?F.recommendedReason||"No outlier risk detected":F.recommendedReason?`${F.recommendedLabel}  ${F.recommendedReason}`:F.recommendedLabel,Y=s.columnParameters,Q=s.methodParameters,ne=Bu[F.currentMethod]??[];return a.jsxs("tr",{className:G.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:F.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[F.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",F.dtype]}),F.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),F.isSelected&&!F.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),F.isSkipped&&!F.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),F.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),F.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[F.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${q?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:F.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),H&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:H})]})}),a.jsx("td",{children:K?a.jsx("span",{children:K}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:W,onChange:J=>A(F.column,J.target.value),disabled:F.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",p,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),i.map(J=>a.jsx("option",{value:J.value,children:J.label},`${F.column}-${J.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:X}),ne.length>0&&!F.isExcluded&&a.jsx("div",{className:"canvas-outlier__parameters",children:ne.map(J=>{const{value:re,fallback:Se}=P$(F.currentMethod,J,Y,F.column,Q),ze=vx[J]??"";return a.jsxs("label",{children:[a.jsx("span",{children:J.replace(/_/g," ")}),a.jsx("input",{type:"number",value:re,placeholder:_x(Se),onChange:$e=>{const Be=$e.target.value;if(Be==="")V(F.column,J,null);else{const it=Number(Be);V(F.column,J,Number.isFinite(it)?it:null)}}}),ze&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:ze})]},`${F.column}-${F.currentMethod}-${J}`)})})]})})]},`outlier-row-${F.column}`)})})]})})})]})]})},L$=e=>{const t=_.useMemo(()=>{var i,l,c,u,d,p;const s=[];return(i=e==null?void 0:e.data)!=null&&i.label&&s.push({label:"Label",value:String(e.data.label)}),(l=e==null?void 0:e.data)!=null&&l.description&&s.push({label:"Description",value:String(e.data.description)}),(c=e==null?void 0:e.data)!=null&&c.category&&s.push({label:"Category",value:String(e.data.category)}),(u=e==null?void 0:e.data)!=null&&u.catalogType&&s.push({label:"Node type",value:String(e.data.catalogType)}),(d=e==null?void 0:e.data)!=null&&d.inputs&&Array.isArray(e.data.inputs)&&e.data.inputs.length&&s.push({label:"Inputs",value:e.data.inputs.join(", ")}),(p=e==null?void 0:e.data)!=null&&p.outputs&&Array.isArray(e.data.outputs)&&e.data.outputs.length&&s.push({label:"Outputs",value:e.data.outputs.join(", ")}),s},[e]),n=_.useMemo(()=>{var i;const s=((i=e==null?void 0:e.data)==null?void 0:i.label)??(e==null?void 0:e.id);return typeof s=="string"&&s.trim()?s:`Node ${(e==null?void 0:e.id)??""}`},[e]);return{metadata:t,title:n}},z$=({connectionInfo:e,connectedInputHandles:t,connectedOutputHandles:n,connectionReady:s})=>e?a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:s?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",children:[a.jsx("strong",{children:s?"Ready to execute.":"Missing required connections."})," ",s?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]}),e.inputs&&e.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:e.inputs.map(i=>{const l=t.has(i.key),c=i.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:i.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:l?"Connected":c?"Missing":"Optional"})]},`inputs-${i.key}`)})})]}),e.outputs&&e.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:e.outputs.map(i=>{const l=n.has(i.key),c=i.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:i.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:l?"Connected":c?"Unlinked":"Optional"})]},`outputs-${i.key}`)})})]})]}):null,yx=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},D$=(e,t)=>{var b;const n=typeof(e==null?void 0:e.id)=="string"?e.id:"",s=_.useMemo(()=>{var x;const w=(x=e==null?void 0:e.data)==null?void 0:x.connectionInfo;if(!w)return null;const y=N=>Array.isArray(N)?N.map(E=>({...E})):[];return{inputs:y(w.inputs),outputs:y(w.outputs)}},[e]),i=_.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const w=t.edges.filter(y=>(y==null?void 0:y.target)===n).map(y=>yx(n,y==null?void 0:y.targetHandle)).filter(y=>!!y);return new Set(w)},[t,n]),l=_.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const w=t.edges.filter(y=>(y==null?void 0:y.source)===n).map(y=>yx(n,y==null?void 0:y.sourceHandle)).filter(y=>!!y);return new Set(w)},[t,n]),c=((b=e==null?void 0:e.data)==null?void 0:b.hasRequiredConnections)!==!1,u=_.useMemo(()=>{var w;return(w=s==null?void 0:s.inputs)!=null&&w.length?s.inputs.filter(y=>y.required!==!1):[]},[s==null?void 0:s.inputs]),d=_.useMemo(()=>u.length?u.filter(w=>!i.has(w.key)):[],[i,u]),p=c&&d.length===0,h=_.useMemo(()=>{if(!p)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[p]),f=p?void 0:!0,g=_.useMemo(()=>{if(!(s!=null&&s.inputs)||s.inputs.length===0)return;let w=!1;const y={};return s.inputs.forEach(x=>{if(!Array.isArray(x.accepts)||x.accepts.length===0)return;const N=i.has(x.key);x.accepts.forEach(E=>{(E==="train"||E==="validation"||E==="test")&&(y[E]=N,w=!0)})}),w?y:void 0},[s==null?void 0:s.inputs,i]);return{connectionInfo:s,connectedHandleKeys:i,connectedOutputHandleKeys:l,evaluationSplitConnectivity:g,connectionReady:p,gatedSectionStyle:h,gatedAriaDisabled:f}},F$=(e,t)=>{const{isBinningNode:n,isCastNode:s,isDropMissingColumnsNode:i,isDropMissingRowsNode:l,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:p,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:f,isRegexCleanupNode:g,isNormalizeTextCaseNode:b,isStandardizeDatesNode:w,isScalingNode:y,isClassUndersamplingNode:x,isClassOversamplingNode:N,isTrainModelDraftNode:E,isLabelEncodingNode:S,isOrdinalEncodingNode:j,isDummyEncodingNode:C,isOneHotEncodingNode:k,isRemoveDuplicatesNode:O,isSkewnessNode:R,isFeatureTargetSplitNode:P}=t;return _.useMemo(()=>{let $=e;return $=$.filter(A=>{var D;return((D=A==null?void 0:A.source)==null?void 0:D.type)!=="drop_column_recommendations"}),(i||l)&&($=$.filter(A=>A.name!=="missing_threshold")),l&&($=$.filter(A=>A.name!=="drop_if_any_missing")),c&&($=$.filter(A=>A.name!=="strategies")),R&&($=$.filter(A=>A.name!=="transformations")),s&&($=$.filter(A=>A.name!=="columns")),n&&($=$.filter(A=>A.name!=="columns")),y&&($=$.filter(A=>!["columns","default_method","auto_detect"].includes(A.name))),O&&($=$.filter(A=>A.name!=="columns"&&A.name!=="keep")),u&&($=$.filter(A=>A.name!=="columns"&&A.name!=="flag_suffix")),d&&($=$.filter(A=>!["columns","mode","custom_pairs"].includes(A.name))),p&&($=$.filter(A=>!["columns","mode"].includes(A.name))),h&&($=$.filter(A=>!["columns","mode","replacement"].includes(A.name))),f&&($=$.filter(A=>!["columns","mode","min_value","max_value"].includes(A.name))),g&&($=$.filter(A=>!["columns","mode","pattern","replacement"].includes(A.name))),b&&($=$.filter(A=>!["columns","mode"].includes(A.name))),w&&($=$.filter(A=>!["columns","mode"].includes(A.name))),x&&($=$.filter(A=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(A.name))),N&&($=$.filter(A=>!["method","target_column","sampling_strategy","random_state"].includes(A.name))),E&&($=$.filter(A=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(A.name))),P&&($=$.filter(A=>A.name!=="target_column")),S&&($=$.filter(A=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(A.name))),j&&($=$.filter(A=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(A.name))),C&&($=$.filter(A=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(A.name))),k&&($=$.filter(A=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(A.name))),$},[e,n,s,i,l,c,u,d,p,h,f,g,b,w,y,x,N,E,S,j,C,k,O,R,P])},I$=({node:e})=>{var f;const t=typeof(e==null?void 0:e.id)=="string"?e.id:void 0,n=_.useMemo(()=>{var b;const g=Th(((b=e==null?void 0:e.data)==null?void 0:b.config)??{});return!g||typeof g!="object"||Array.isArray(g)?{}:((!g.column_overrides||typeof g.column_overrides!="object"||Array.isArray(g.column_overrides))&&(g.column_overrides={}),g)},[e==null?void 0:e.id,(f=e==null?void 0:e.data)==null?void 0:f.config]),[s,i]=_.useState(n),[l,c]=_.useState(0),u=_.useRef(t);_.useEffect(()=>{u.current!==t&&(u.current=t,i(n),c(g=>g+1))},[t]);const d=_.useMemo(()=>ql(n),[n]),p=_.useMemo(()=>ql(s),[s]),h=_.useCallback(()=>{i(n)},[n]);return{initialConfig:n,configState:s,setConfigState:i,stableInitialConfig:d,stableCurrentConfig:p,nodeChangeVersion:l,resetToInitialConfig:h}},B$=({setConfigState:e})=>{const t=_.useCallback((c,u)=>{c&&e(d=>{const p={...d};return u===void 0?delete p[c]:p[c]=u,p})},[e]),n=_.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);Number.isNaN(d)||t(c,d)},[t]),s=_.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);if(!Number.isFinite(d))return;const p=Math.min(Math.max(d,0),100);t(c,p)},[t]),i=_.useCallback((c,u)=>{t(c,u)},[t]),l=_.useCallback((c,u)=>{t(c,u)},[t]);return{handleParameterChange:t,handleNumberChange:n,handlePercentileChange:s,handleBooleanChange:i,handleTextChange:l}},Hh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},U$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Vh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],q$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=U$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Vh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g}}).filter(t=>!!t),H$=e=>{if(!e||typeof e!="object")return{...Hh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.auto_detect_default,c=Vh(e.high_cardinality_columns),u=Vh(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:l,highCardinalityColumns:c,notes:u}},V$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isLabelEncodingNode:l}=e,[c,u]=_.useState(!1),[d,p]=_.useState(null),[h,f]=_.useState([]),[g,b]=_.useState({...Hh}),[w,y]=_.useState(0);_.useEffect(()=>{let S=!0;const j=C=>{f([]),b({...Hh}),u(!1),p(C??null)};return l?t?n?(u(!0),p(null),Gv(t,{graph:s??null,targetNodeId:i??null}).then(C=>{S&&(f(q$(C)),b(H$(C)))}).catch(C=>{if(!S)return;const k=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load label encoding suggestions";j(k)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(j(),()=>{S=!1}):(j(),()=>{S=!1})},[s,n,l,w,t,i]);const x=_.useCallback(()=>{!l||!t||!n||y(S=>S+1)},[n,l,t]),N=_.useMemo(()=>g,[g]),E=_.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:E,metadata:N,refresh:x}},Wh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},W$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Kh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],K$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=W$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Kh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,b=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_use_global_fallback:b}}).filter(t=>!!t),Y$=e=>{if(!e||typeof e!="object")return{...Wh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.enable_global_fallback_default,c=Kh(e.high_cardinality_columns),u=Kh(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:d,enableGlobalFallbackDefault:l,highCardinalityColumns:c,notes:u}},G$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isTargetEncodingNode:l}=e,[c,u]=_.useState(!1),[d,p]=_.useState(null),[h,f]=_.useState([]),[g,b]=_.useState({...Wh}),[w,y]=_.useState(0);_.useEffect(()=>{let S=!0;const j=C=>{f([]),b({...Wh}),u(!1),p(C??null)};return l?t?n?(u(!0),p(null),Xv(t,{graph:s??null,targetNodeId:i??null}).then(C=>{S&&(f(K$(C)),b(Y$(C)))}).catch(C=>{if(!S)return;const k=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load target encoding suggestions";j(k)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(j(),()=>{S=!1}):(j(),()=>{S=!1})},[s,n,l,w,t,i]);const x=_.useCallback(()=>{!l||!t||!n||y(S=>S+1)},[n,l,t]),N=_.useMemo(()=>g,[g]),E=_.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:E,metadata:N,refresh:x}},qu={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},Q$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Yh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],X$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=Q$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Yh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,b=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_bucket_count:b}}).filter(t=>!!t),J$=e=>{if(!e||typeof e!="object")return{...qu};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.auto_detect_default,c=Number(e.suggested_bucket_default??0)||0,u=Yh(e.high_cardinality_columns),d=Yh(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:l,suggestedBucketDefault:c,highCardinalityColumns:u,notes:d}},Z$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isHashEncodingNode:l}=e,[c,u]=_.useState(!1),[d,p]=_.useState(null),[h,f]=_.useState([]),[g,b]=_.useState({...qu}),[w,y]=_.useState(0),x=_.useCallback(S=>{f([]),b({...qu}),u(!1),p(S??null)},[]);_.useEffect(()=>{let S=!0;return l?t?n?(u(!0),p(null),Jv(t,{graph:s??null,targetNodeId:i??null}).then(j=>{S&&(f(X$(j)),b(J$(j)))}).catch(j=>{S&&(f([]),b({...qu}),p(j!=null&&j.message?String(j.message):"Unable to load hash encoding suggestions"))}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(x("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(x(),()=>{S=!1}):(x(),()=>{S=!1})},[s,n,l,x,t,i,w]);const N=_.useCallback(()=>{y(S=>S+1)},[]);return _.useMemo(()=>({isFetching:c,error:d,suggestions:h,metadata:g,refresh:N}),[d,c,g,N,h])},Gh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},eP=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Qh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],tP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=eP(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Qh(t.sample_values),f=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,b=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,score:f,selectable:g,recommended_handle_unknown:b}}).filter(t=>!!t),nP=e=>{if(!e||typeof e!="object")return{...Gh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.enable_unknown_default,c=Qh(e.high_cardinality_columns),u=Qh(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:d,enableUnknownDefault:l,highCardinalityColumns:c,notes:u}},sP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isOrdinalEncodingNode:l}=e,[c,u]=_.useState(!1),[d,p]=_.useState(null),[h,f]=_.useState([]),[g,b]=_.useState({...Gh}),[w,y]=_.useState(0);_.useEffect(()=>{let S=!0;const j=C=>{f([]),b({...Gh}),u(!1),p(C??null)};return l?t?n?(u(!0),p(null),Qv(t,{graph:s??null,targetNodeId:i??null}).then(C=>{S&&(f(tP(C)),b(nP(C)))}).catch(C=>{if(!S)return;const k=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load ordinal encoding suggestions";j(k)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(j(),()=>{S=!1}):(j(),()=>{S=!1})},[s,n,l,w,t,i]);const x=_.useCallback(()=>{!l||!t||!n||y(S=>S+1)},[n,l,t]),N=_.useMemo(()=>g,[g]),E=_.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:E,metadata:N,refresh:x}},Xh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},rP=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Jh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],aP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=rP(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=Jh(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,b=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:b,recommended_drop_first:w}}).filter(t=>!!t),oP=e=>{if(!e||typeof e!="object")return{...Xh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=Number(e.cautioned_count??0)||0,c=Jh(e.high_cardinality_columns),u=Jh(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,cautionedCount:l,highCardinalityColumns:c,notes:u,autoDetectDefault:d}},iP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isDummyEncodingNode:l}=e,[c,u]=_.useState(!1),[d,p]=_.useState(null),[h,f]=_.useState([]),[g,b]=_.useState({...Xh}),[w,y]=_.useState(0);_.useEffect(()=>{let S=!0;const j=C=>{f([]),b({...Xh}),u(!1),p(C??null)};return l?t?n?(u(!0),p(null),ey(t,{graph:s??null,targetNodeId:i??null}).then(C=>{S&&(f(aP(C)),b(oP(C)))}).catch(C=>{if(!S)return;const k=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load dummy encoding suggestions";j(k)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(j(),()=>{S=!1}):(j(),()=>{S=!1})},[s,n,l,w,t,i]);const x=_.useCallback(()=>{!l||!t||!n||y(S=>S+1)},[n,l,t]),N=_.useMemo(()=>g,[g]),E=_.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:E,metadata:N,refresh:x}},Zh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},lP=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},ef=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],cP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=lP(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,p=typeof t.text_category=="string"?t.text_category:null,h=ef(t.sample_values),f=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,b=typeof t.selectable=="boolean"?t.selectable:!0,w=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:p,sample_values:h,estimated_dummy_columns:f,score:g,selectable:b,recommended_drop_first:w}}).filter(t=>!!t),uP=e=>{if(!e||typeof e!="object")return{...Zh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=Number(e.cautioned_count??0)||0,c=ef(e.high_cardinality_columns),u=ef(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,cautionedCount:l,highCardinalityColumns:c,notes:u}},dP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isOneHotEncodingNode:l}=e,[c,u]=_.useState(!1),[d,p]=_.useState(null),[h,f]=_.useState([]),[g,b]=_.useState({...Zh}),[w,y]=_.useState(0);_.useEffect(()=>{let S=!0;const j=C=>{f([]),b({...Zh}),u(!1),p(C??null)};return l?t?n?(u(!0),p(null),Zv(t,{graph:s??null,targetNodeId:i??null}).then(C=>{S&&(f(cP(C)),b(uP(C)))}).catch(C=>{if(!S)return;const k=typeof(C==null?void 0:C.message)=="string"?C.message:"Unable to load one-hot encoding suggestions";j(k)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(j("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(j(),()=>{S=!1}):(j(),()=>{S=!1})},[s,n,l,w,t,i]);const x=_.useCallback(()=>{!l||!t||!n||y(S=>S+1)},[n,l,t]),N=_.useMemo(()=>g,[g]),E=_.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:E,metadata:N,refresh:x}},mP=({catalogFlags:e,enableGlobalFallbackDefault:t,encodeMissing:n,handleUnknown:s,setConfigState:i,nodeChangeVersion:l})=>{const{isTargetEncodingNode:c}=e,u=_.useRef(!1);_.useEffect(()=>{u.current=!1},[l]),_.useEffect(()=>{if(!c||!t||u.current)return;const d=typeof n=="boolean"?n:null,p=typeof s=="string"?s.trim().toLowerCase():"";if(d===!0&&p==="global_mean"){u.current=!0;return}i(h=>{const f=typeof(h==null?void 0:h.encode_missing)=="boolean"?h.encode_missing:null,g=typeof(h==null?void 0:h.handle_unknown)=="string"?h.handle_unknown.trim().toLowerCase():"";if(f===!0&&g==="global_mean")return u.current=!0,h;const b={...h};return f!==!0&&(b.encode_missing=!0),g!=="global_mean"&&(b.handle_unknown="global_mean"),u.current=!0,b})},[n,s,c,t,i])},hP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,node:i,configState:l,setConfigState:c,nodeChangeVersion:u})=>{const{isLabelEncodingNode:d,isTargetEncodingNode:p,isHashEncodingNode:h,isOrdinalEncodingNode:f,isDummyEncodingNode:g,isOneHotEncodingNode:b}=e,w=(i==null?void 0:i.id)??null,{isFetching:y,error:x,suggestions:N,metadata:E}=V$({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:w}),{isFetching:S,error:j,suggestions:C,metadata:k}=G$({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:w});mP({catalogFlags:e,enableGlobalFallbackDefault:k.enableGlobalFallbackDefault,encodeMissing:l==null?void 0:l.encode_missing,handleUnknown:l==null?void 0:l.handle_unknown,setConfigState:c,nodeChangeVersion:u});const{isFetching:O,error:R,suggestions:P,metadata:$}=Z$({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:w}),{isFetching:A,error:D,suggestions:V,metadata:z}=sP({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:w}),{isFetching:F,error:q,suggestions:G,metadata:W}=iP({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:w}),{isFetching:X,error:I,suggestions:L,metadata:U}=dP({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:w});_.useEffect(()=>{d&&(l!=null&&l.auto_detect)&&E.autoDetectDefault&&c(J=>({...J,columns:E.autoDetectDefault}))},[l==null?void 0:l.auto_detect,d,E.autoDetectDefault,c]),_.useEffect(()=>{p&&(l!=null&&l.auto_detect)&&k.autoDetectDefault&&c(J=>({...J,columns:k.autoDetectDefault}))},[l==null?void 0:l.auto_detect,p,c,k.autoDetectDefault]),_.useEffect(()=>{h&&(l!=null&&l.auto_detect)&&$.autoDetectDefault&&c(J=>({...J,columns:$.autoDetectDefault}))},[l==null?void 0:l.auto_detect,$.autoDetectDefault,h,c]),_.useEffect(()=>{h&&$.suggestedBucketDefault&&c(J=>({...J,n_buckets:$.suggestedBucketDefault}))},[$.suggestedBucketDefault,h,c]),_.useEffect(()=>{p&&k.enableGlobalFallbackDefault&&c(J=>{const re={};return J.encode_missing===void 0&&(re.encode_missing=!0),J.handle_unknown===void 0&&(re.handle_unknown="value"),Object.keys(re).length>0?{...J,...re}:J})},[l==null?void 0:l.encode_missing,l==null?void 0:l.handle_unknown,p,c,k.enableGlobalFallbackDefault]),_.useEffect(()=>{f&&(l!=null&&l.auto_detect)&&z.autoDetectDefault&&c(J=>({...J,columns:z.autoDetectDefault}))},[l==null?void 0:l.auto_detect,f,z.autoDetectDefault,c]),_.useEffect(()=>{f&&z.enableUnknownDefault&&c(J=>J.handle_unknown===void 0?{...J,handle_unknown:"use_encoded_value",unknown_value:-1}:J)},[l==null?void 0:l.handle_unknown,f,z.enableUnknownDefault,c]),_.useEffect(()=>{g&&(l!=null&&l.auto_detect)&&W.autoDetectDefault&&c(J=>({...J,columns:W.autoDetectDefault}))},[l==null?void 0:l.auto_detect,W.autoDetectDefault,g,c]);const te=_.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),K=_.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),H=_.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),Y=_.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),Q=_.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),ne=_.useCallback(J=>{c(re=>({...re,columns:J}))},[c]);return{labelEncoding:{isFetching:y,error:x,suggestions:N,metadata:E,handleApplyRecommended:te},targetEncoding:{isFetching:S,error:j,suggestions:C,metadata:k,handleApplyRecommended:K},hashEncoding:{isFetching:O,error:R,suggestions:P,metadata:$,handleApplyRecommended:H},ordinalEncoding:{isFetching:A,error:D,suggestions:V,metadata:z,handleApplyRecommended:Y},dummyEncoding:{isFetching:F,error:q,suggestions:G,metadata:W,handleApplyRecommended:Q},oneHotEncoding:{isFetching:X,error:I,suggestions:L,metadata:U,handleApplyRecommended:ne}}},Us=["standard","robust","minmax","maxabs"],So={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},bx={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},xx=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],wx=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=xx(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",i=Us.includes(s)?s:"standard",l={},c=t.column_methods;c&&typeof c=="object"&&!Array.isArray(c)&&Object.entries(c).forEach(([p,h])=>{const f=String(p??"").trim(),g=typeof h=="string"?h.trim().toLowerCase():"";f&&Us.includes(g)&&(l[f]=g)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=xx(t.skipped_columns);return{columns:n,defaultMethod:i,columnMethods:l,autoDetect:u,skippedColumns:d}},fP=e=>{const t={...So};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&Us.includes(s)&&i&&(t[s]=i)}),t},pP=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&Us.includes(s)&&t.set(s,n)}),t},gP=e=>Us.map(t=>({value:t,label:e[t]??So[t]??t})),_P=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:s,scalingSkippedColumns:i,scalingExcludedColumns:l})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const p=u.recommended_method,h=n[p]??So[p]??p,f=Array.isArray(u.fallback_methods)?u.fallback_methods.filter(k=>Us.includes(k)).map(k=>{const O=k;return n[O]??So[O]??O}):[],g=u.confidence??"medium",b=bx[g]??bx.medium,y=t.columnMethods[d]??null,x=y??t.defaultMethod,N=n[x]??So[x]??x,E=l.has(d),S=i.has(d),j=s.has(d),C=u.stats;c.push({column:d,dtype:u.dtype??null,recommendedMethod:p,recommendedLabel:h,confidence:g,confidenceLabel:b,reasons:Array.isArray(u.reasons)?u.reasons:[],fallbackLabels:f,stats:C,hasMissing:!!u.has_missing,currentOverride:y,currentMethod:x,currentMethodLabel:N,isOverrideApplied:y!==null,isSelected:j,isExcluded:E,isSkipped:S})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},vP=(e,t,n,s)=>{if(!e.length)return null;const i=e.map(l=>{const c=t[l],u=c?n[c]??So[c]??c:null;return u?`${l} -> ${u}`:l});return s>e.length&&i.push(""),i.join(", ")},yP=({isScalingNode:e,configState:t,numericExcludedColumns:n,scalingData:s})=>{const i=_.useMemo(()=>wx(t),[t]),l=_.useMemo(()=>new Set(i.skippedColumns),[i.skippedColumns]),c=_.useMemo(()=>e?n:new Set,[e,n]),u=_.useMemo(()=>e?new Set(i.columns):new Set,[e,i.columns]),d=_.useMemo(()=>new Set(Object.keys(i.columnMethods)),[i.columnMethods]),p=_.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(D=>!!(D&&D.column)):[],[s==null?void 0:s.columns]),h=_.useMemo(()=>fP(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=_.useMemo(()=>pP(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=_.useMemo(()=>_P({recommendations:p,scalingConfig:i,scalingMethodLabelMap:h,scalingSelectedSet:u,scalingSkippedColumns:l,scalingExcludedColumns:c}),[p,i,h,u,l,c]),b=_.useMemo(()=>Array.from(d).sort((D,V)=>D.localeCompare(V)),[d]),w=_.useMemo(()=>b.slice(0,4),[b]),y=g.length,x=d.size,N=u.size,E=i.autoDetect,S=_.useMemo(()=>f.get(i.defaultMethod)??null,[i.defaultMethod,f]),j=_.useMemo(()=>{const D=i.defaultMethod;return h[D]??So[D]??D},[i.defaultMethod,h]),C=y>0,k=_.useMemo(()=>g.filter(D=>!D.isSkipped&&!D.isExcluded&&D.isSelected&&D.recommendedMethod!==D.currentMethod).length,[g]),O=_.useMemo(()=>g.filter(D=>D.isSelected&&!D.isSkipped&&!D.isExcluded).length,[g]),R=_.useMemo(()=>g.filter(D=>D.isSkipped&&!D.isExcluded).length,[g]),P=_.useMemo(()=>g.length?k>0?`${k} column${k===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:O>0?"All configured columns align with the recommended scalers.":R>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[k,O,g,R]),$=_.useMemo(()=>gP(h),[h]),A=_.useMemo(()=>vP(w,i.columnMethods,h,x),[w,i.columnMethods,h,x]);return{scalingConfig:i,scalingExcludedColumns:c,scalingMethodDetailMap:f,scalingMethodOptions:$,scalingRecommendations:p,scalingRecommendationRows:g,scalingSelectedCount:N,scalingOverrideCount:x,scalingDefaultDetail:S,scalingDefaultLabel:j,scalingAutoDetectEnabled:E,scalingHasRecommendations:C,scalingStatusMessage:P,scalingOverrideExampleSummary:A}},bP=({isOutlierNode:e,configState:t,numericExcludedColumns:n,outlierData:s})=>{const i=_.useMemo(()=>S$(t),[t]),l=_.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(D=>!!(D&&D.column)):[],[s==null?void 0:s.columns]),c=_.useMemo(()=>new Set(i.skippedColumns),[i.skippedColumns]),u=_.useMemo(()=>e?new Set(i.columns):new Set,[e,i.columns]),d=_.useMemo(()=>{if(!e||!n.size)return new Set;const D=new Set;i.columns.forEach(z=>{const F=String(z??"").trim();F&&D.add(F)}),l.forEach(z=>{const F=String((z==null?void 0:z.column)??"").trim();F&&D.add(F)});const V=new Set;return n.forEach(z=>{D.has(z)||V.add(z)}),V},[e,n,i.columns,l]),p=_.useMemo(()=>new Set(Object.keys(i.columnMethods)),[i.columnMethods]),h=_.useMemo(()=>E$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),f=_.useMemo(()=>k$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=_.useMemo(()=>A$({insights:l,outlierConfig:i,labelMap:h,selectedColumns:u,skippedColumns:c,excludedColumns:d}),[l,i,h,u,c,d]),b=_.useMemo(()=>M$(h),[h]),w=_.useMemo(()=>Array.from(p).sort((D,V)=>D.localeCompare(V)),[p]),y=_.useMemo(()=>w.slice(0,4),[w]),x=u.size,N=p.size,E=_.useMemo(()=>Object.keys(i.columnParameters).length,[i.columnParameters]),S=i.autoDetect,j=_.useMemo(()=>f.get(i.defaultMethod)??null,[i.defaultMethod,f]),C=_.useMemo(()=>{const D=i.defaultMethod;return h[D]??Co[D]??D},[i.defaultMethod,h]),k=g.length>0,O=_.useMemo(()=>g.filter(D=>D.isSkipped||D.isExcluded||!D.isSelected||!D.recommendedMethod?!1:D.recommendedMethod!==D.currentMethod).length,[g]),R=_.useMemo(()=>g.filter(D=>D.isSelected&&!D.isSkipped&&!D.isExcluded).length,[g]),P=_.useMemo(()=>g.filter(D=>D.isSkipped&&!D.isExcluded).length,[g]),$=_.useMemo(()=>g.length?O>0?`${O} column${O===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:R>0?"All configured columns align with the recommended outlier handling strategies.":P>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[O,R,g,P]),A=_.useMemo(()=>O$(y,i.columnMethods,h,N),[y,i.columnMethods,h,N]);return{outlierConfig:i,outlierExcludedColumns:d,outlierMethodLabelMap:h,outlierMethodDetailMap:f,outlierMethodOptions:b,outlierRecommendations:l,outlierRecommendationRows:g,outlierSelectedCount:x,outlierOverrideCount:N,outlierParameterOverrideCount:E,outlierDefaultDetail:j,outlierDefaultLabel:C,outlierAutoDetectEnabled:S,outlierHasRecommendations:k,outlierStatusMessage:$,outlierOverrideExampleSummary:A}},xP=({configState:e,nodeId:t})=>{const n=_.useMemo(()=>Ny(e),[e]),s=n.columns.length,i=_h[n.strategy]??n.strategy,l=_.useMemo(()=>Object.keys(n.columnStrategies).map(w=>w.trim()).filter(Boolean).sort((w,y)=>w.localeCompare(y)),[n.columnStrategies]),c=l.length,u=_.useMemo(()=>{if(!l.length)return null;const w=l.slice(0,4);return Qk(w,n.columnStrategies,c)},[n.columnStrategies,l,c]),d=_.useMemo(()=>`binning-${t||"node"}`,[t]),p=_.useMemo(()=>({equalWidth:`${d}-equal-width-bins`,equalFrequency:`${d}-equal-frequency-bins`,precision:`${d}-precision`,suffix:`${d}-suffix`,missingLabel:`${d}-missing-label`,includeLowest:`${d}-include-lowest`,dropOriginal:`${d}-drop-original`,labelFormat:`${d}-label-format`,duplicates:`${d}-duplicates`,kbinsNBins:`${d}-kbins-n-bins`,kbinsEncode:`${d}-kbins-encode`,kbinsStrategy:`${d}-kbins-strategy`}),[d]),[h,f]=_.useState({}),[g,b]=_.useState({});return _.useEffect(()=>{f(w=>{const y=new Set,x={...w};return n.columns.forEach(N=>{const E=String(N??"").trim();if(!E||(y.add(E),Object.prototype.hasOwnProperty.call(x,E)))return;const S=n.customBins[E]??[];x[E]=S.length>=2?S.join(", "):""}),Object.keys(x).forEach(N=>{y.has(N)||delete x[N]}),x})},[n.columns,n.customBins]),_.useEffect(()=>{b(w=>{const y=new Set,x={...w};return n.columns.forEach(N=>{const E=String(N??"").trim();if(!E||(y.add(E),Object.prototype.hasOwnProperty.call(x,E)))return;const S=n.customLabels[E]??[];x[E]=S.length>0?S.join(", "):""}),Object.keys(x).forEach(N=>{y.has(N)||delete x[N]}),x})},[n.columns,n.customLabels]),{binningConfig:n,binningSelectedCount:s,binningDefaultLabel:i,binningOverrideColumns:l,binningOverrideCount:c,binningOverrideSummary:u,fieldIds:p,customEdgeDrafts:h,setCustomEdgeDrafts:f,customLabelDrafts:g,setCustomLabelDrafts:b}},wP=({setConfigState:e,setBinningCustomEdgeDrafts:t,setBinningCustomLabelDrafts:n,binningConfig:s,binningInsightsRecommendations:i,binningAllNumericColumns:l})=>{const c=_.useCallback((P,$,A,D)=>{e(V=>{const z=typeof(V==null?void 0:V[P])=="number"&&Number.isFinite(V[P])?V[P]:void 0;if($===""){if(z===void 0)return V;const G={...V};return delete G[P],G}const F=Number($);if(!Number.isFinite(F))return V;const q=Math.min(Math.max(Math.round(F),A),D);return z===q?V:{...V,[P]:q}})},[e]),u=_.useCallback((P,$)=>{e(A=>!!(A!=null&&A[P])===$?A:{...A,[P]:$})},[e]),d=_.useCallback(P=>{const $=P.trim();e(A=>{const D=typeof(A==null?void 0:A.output_suffix)=="string"?A.output_suffix:"";if(!$){if(!D)return A;const V={...A};return delete V.output_suffix,V}return D===$?A:{...A,output_suffix:$}})},[e]),p=_.useCallback(P=>{e($=>{const A=typeof($==null?void 0:$.label_format)=="string"?$.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(A)?A:"range")===P?$:{...$,label_format:P}})},[e]),h=_.useCallback(P=>{e($=>{if((($==null?void 0:$.missing_strategy)==="label"?"label":"keep")===P)return $;const D={...$,missing_strategy:P};return P!=="label"&&Object.prototype.hasOwnProperty.call(D,"missing_label")&&delete D.missing_label,D})},[e]),f=_.useCallback(P=>{const $=P.trim();e(A=>{const D=typeof(A==null?void 0:A.missing_label)=="string"?A.missing_label:"";if(!$){if(!D)return A;const V={...A};return delete V.missing_label,V}return D===$?A:{...A,missing_label:$}})},[e]),g=_.useCallback((P,$)=>{const A=String(P??"").trim();A&&(t(D=>({...D,[A]:$})),e(D=>{const V=D==null?void 0:D.custom_bins,z=V&&typeof V=="object"&&!Array.isArray(V)?V:{},F=Array.isArray(z[A])?z[A]:void 0,G=$.split(/[,\n]/).map(L=>L.trim()).filter(Boolean).map(L=>Number(L)).filter(L=>Number.isFinite(L)).sort((L,U)=>L-U).filter((L,U,te)=>U===0||L!==te[U-1]),W=G.length>=2;if(W&&F&&F.length===G.length&&F.every((L,U)=>L===G[U])||!W&&!F)return D;const X={...D},I={...z};return W?I[A]=G:delete I[A],Object.keys(I).length>0?X.custom_bins=I:delete X.custom_bins,X}))},[t,e]),b=_.useCallback((P,$)=>{const A=String(P??"").trim();A&&(n(D=>({...D,[A]:$})),e(D=>{const V=D==null?void 0:D.custom_labels,z=V&&typeof V=="object"&&!Array.isArray(V)?V:{},F=Array.isArray(z[A])?z[A]:void 0,q=$.split(/[,\n]/).map(X=>X.trim()).filter(Boolean);if(q.length>0&&F&&F.length===q.length&&F.every((X,I)=>X===q[I])||q.length===0&&!F)return D;const G={...D},W={...z};return q.length>0?W[A]=q:delete W[A],Object.keys(W).length>0?G.custom_labels=W:delete G.custom_labels,G}))},[n,e]),w=_.useCallback(P=>{const $=String(P??"").trim();$&&(t(A=>{if(!Object.prototype.hasOwnProperty.call(A,$))return A;const D={...A};return delete D[$],D}),n(A=>{if(!Object.prototype.hasOwnProperty.call(A,$))return A;const D={...A};return delete D[$],D}),e(A=>{let D=!1;const V={...A};if(A!=null&&A.custom_bins&&typeof A.custom_bins=="object"&&!Array.isArray(A.custom_bins)&&Object.prototype.hasOwnProperty.call(A.custom_bins,$)){const z={...A.custom_bins};delete z[$],Object.keys(z).length>0?V.custom_bins=z:delete V.custom_bins,D=!0}if(A!=null&&A.custom_labels&&typeof A.custom_labels=="object"&&!Array.isArray(A.custom_labels)&&Object.prototype.hasOwnProperty.call(A.custom_labels,$)){const z={...A.custom_labels};delete z[$],Object.keys(z).length>0?V.custom_labels=z:delete V.custom_labels,D=!0}return D?V:A}))},[t,n,e]),y=_.useCallback((P,$)=>{const A=String(P??"").trim();A&&e(D=>{const z={...D!=null&&D.column_strategies&&typeof D.column_strategies=="object"&&!Array.isArray(D.column_strategies)?D.column_strategies:D!=null&&D.column_overrides&&typeof D.column_overrides=="object"&&!Array.isArray(D.column_overrides)?D.column_overrides:{}},F=z[A],q=F&&typeof F=="object"&&!Array.isArray(F)?{...F}:{},G=$(q),W=!!(G&&Object.keys(G).length);W?z[A]=G:delete z[A];const X={...D};if(W){const I=new Set(Ke(D==null?void 0:D.columns));I.has(A)||(I.add(A),X.columns=Array.from(I).sort((L,U)=>L.localeCompare(U)))}return Object.keys(z).length?(X.column_overrides=z,X.column_strategies=z):(Object.prototype.hasOwnProperty.call(X,"column_overrides")&&delete X.column_overrides,Object.prototype.hasOwnProperty.call(X,"column_strategies")&&delete X.column_strategies),X})},[e]),x=_.useCallback((P,$,A)=>{const D=String(P??"").trim();if(!D)return;if($==="__default__"){w(D),y(D,()=>null);return}const V=Number.isFinite(A==null?void 0:A.recommendedBins)?Math.round(A.recommendedBins):null;y(D,z=>{const F={...z};F.strategy=$;const q=G=>Math.min(200,Math.max(2,Math.round(V??G)));return $==="equal_width"?(F.equal_width_bins=q(s.equalWidthBins),delete F.equal_frequency_bins,delete F.kbins_n_bins,delete F.kbins_encode,delete F.kbins_strategy):$==="equal_frequency"?(F.equal_frequency_bins=q(s.equalFrequencyBins),delete F.equal_width_bins,delete F.kbins_n_bins,delete F.kbins_encode,delete F.kbins_strategy):$==="kbins"?(F.kbins_n_bins=q(s.kbinsNBins),F.kbins_encode=s.kbinsEncode,F.kbins_strategy=s.kbinsStrategy,delete F.equal_width_bins,delete F.equal_frequency_bins):$==="custom"&&(delete F.equal_width_bins,delete F.equal_frequency_bins,delete F.kbins_n_bins,delete F.kbins_encode,delete F.kbins_strategy),Object.keys(F).length?F:null}),$!=="custom"&&w(D)},[s.equalFrequencyBins,s.equalWidthBins,s.kbinsEncode,s.kbinsNBins,s.kbinsStrategy,w,y]),N=_.useCallback((P,$,A)=>{const D=String(P??"").trim();D&&(y(D,V=>{const z={...V};if(!A.trim())delete z[$];else{const F=Number(A);if(!Number.isFinite(F))return V;const q=Math.min(200,Math.max(2,Math.round(F)));z[$]=q,$==="equal_width_bins"?(z.strategy="equal_width",delete z.equal_frequency_bins,delete z.kbins_n_bins,delete z.kbins_encode,delete z.kbins_strategy):$==="equal_frequency_bins"?(z.strategy="equal_frequency",delete z.equal_width_bins,delete z.kbins_n_bins,delete z.kbins_encode,delete z.kbins_strategy):$==="kbins_n_bins"&&(z.strategy="kbins",delete z.equal_width_bins,delete z.equal_frequency_bins)}return Object.keys(z).length?z:null}),w(D))},[w,y]),E=_.useCallback((P,$)=>{const A=String(P??"").trim();A&&y(A,D=>{const V={...D};return $?(V.strategy="kbins",V.kbins_encode=$):delete V.kbins_encode,Object.keys(V).length?V:null})},[y]),S=_.useCallback((P,$)=>{const A=String(P??"").trim();A&&y(A,D=>{const V={...D};return $?(V.strategy="kbins",V.kbins_strategy=$):delete V.kbins_strategy,Object.keys(V).length?V:null})},[y]),j=_.useCallback(P=>{const $=String(P??"").trim();$&&(w($),y($,()=>null))},[w,y]),C=_.useCallback(()=>{e(P=>{if(!((P==null?void 0:P.column_strategies)&&typeof P.column_strategies=="object"&&!Array.isArray(P.column_strategies)&&Object.keys(P.column_strategies).length>0||(P==null?void 0:P.column_overrides)&&typeof P.column_overrides=="object"&&!Array.isArray(P.column_overrides)&&Object.keys(P.column_overrides).length>0))return P;const A={...P};return Object.prototype.hasOwnProperty.call(A,"column_overrides")&&delete A.column_overrides,Object.prototype.hasOwnProperty.call(A,"column_strategies")&&delete A.column_strategies,A})},[e]),k=_.useCallback(()=>{i.length&&i.forEach(P=>{const $=typeof(P==null?void 0:P.column)=="string"?P.column.trim():"";if(!$)return;const A=P.recommended_strategy??"equal_width";x($,A,{recommendedBins:Number.isFinite(P==null?void 0:P.recommended_bins)?P.recommended_bins:null})})},[i,x]),O=_.useCallback(P=>{if(!P)return;const $=[];for(const A of P){const D=typeof A=="string"?A.trim():"";D&&$.push(D)}$.length&&e(A=>{const D=A&&typeof A=="object"?A:{},V=new Set(Ke(D.columns));let z=!1;if($.forEach(q=>{V.has(q)||(V.add(q),z=!0)}),!z)return A;const F={...D};return F.columns=Array.from(V).sort((q,G)=>q.localeCompare(G)),F})},[e]),R=_.useCallback(()=>{l.length&&O(l)},[l,O]);return{handleBinningIntegerChange:c,handleBinningBooleanToggle:u,handleBinningSuffixChange:d,handleBinningLabelFormatChange:p,handleBinningMissingStrategyChange:h,handleBinningMissingLabelChange:f,handleBinningCustomBinsChange:g,handleBinningCustomLabelsChange:b,handleBinningClearCustomColumn:w,updateBinningColumnOverride:y,handleBinningOverrideStrategyChange:x,handleBinningOverrideNumberChange:N,handleBinningOverrideKbinsEncodeChange:E,handleBinningOverrideKbinsStrategyChange:S,handleBinningClearOverride:j,handleBinningClearOverrides:C,handleBinningApplyStrategies:k,handleBinningApplyColumns:O,handleApplyAllBinningNumeric:R}},NP=({setConfigState:e,outlierRecommendationRows:t,outlierExcludedColumns:n,outlierConfig:s})=>{const i=_.useCallback(w=>{ws.includes(w)&&e(y=>(y==null?void 0:y.default_method)===w?y:{...y,default_method:w})},[e]),l=_.useCallback(w=>{e(y=>(typeof(y==null?void 0:y.auto_detect)=="boolean"?y.auto_detect:!0)===w?y:{...y,auto_detect:w})},[e]),c=_.useCallback((w,y)=>{const x=String(w??"").trim();x&&e(N=>{if(!N||typeof N!="object")return N;const E=Ke(N.columns),S=new Set(E),j=N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)?{...N.column_methods}:{};let C=!1;if(y){if(!ws.includes(y))return N;j[x]!==y&&(j[x]=y,C=!0),S.has(x)||(S.add(x),C=!0)}else Object.prototype.hasOwnProperty.call(j,x)&&(delete j[x],C=!0);if(!C)return N;const k={...N};return k.columns=Array.from(S).sort((O,R)=>O.localeCompare(R)),Object.keys(j).length?k.column_methods=j:Object.prototype.hasOwnProperty.call(k,"column_methods")&&delete k.column_methods,k})},[e]),u=_.useCallback(()=>{e(w=>{if(!w||typeof w!="object")return w;const y=w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)&&Object.keys(w.column_methods).length>0,x=w.column_parameters&&typeof w.column_parameters=="object"&&!Array.isArray(w.column_parameters)&&Object.keys(w.column_parameters).length>0;if(!y&&!x)return w;const N={...w};return y&&delete N.column_methods,x&&delete N.column_parameters,N})},[e]),d=_.useCallback(()=>{t.length&&e(w=>{if(!w||typeof w!="object")return w;const y=new Set(Ke(w.columns)),x=new Set(Ke(w.skipped_columns)),N=w.column_methods&&typeof w.column_methods=="object"&&!Array.isArray(w.column_methods)?{...w.column_methods}:{},E=w.column_parameters&&typeof w.column_parameters=="object"&&!Array.isArray(w.column_parameters)?{...w.column_parameters}:{};let S=!1;if(t.forEach(C=>{if(!C||C.isExcluded||!C.recommendedMethod)return;const k=String(C.column??"").trim();if(!k||n.has(k))return;const O=C.recommendedMethod;ws.includes(O)&&(x.has(k)&&(x.delete(k),S=!0),y.has(k)||(y.add(k),S=!0),O===s.defaultMethod?Object.prototype.hasOwnProperty.call(N,k)&&(delete N[k],S=!0):N[k]!==O&&(N[k]=O,S=!0),Object.prototype.hasOwnProperty.call(E,k)&&(delete E[k],S=!0))}),!S)return w;const j={...w,columns:Array.from(y).sort((C,k)=>C.localeCompare(k))};return x.size?j.skipped_columns=Array.from(x).sort((C,k)=>C.localeCompare(k)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,Object.keys(N).length?j.column_methods=N:Object.prototype.hasOwnProperty.call(j,"column_methods")&&delete j.column_methods,Object.keys(E).length?j.column_parameters=E:Object.prototype.hasOwnProperty.call(j,"column_parameters")&&delete j.column_parameters,j})},[s.defaultMethod,n,t,e]),p=_.useCallback(w=>{const y=String(w??"").trim();y&&e(x=>{if(!x||typeof x!="object")return x;const N=Ke(x.columns),E=N.filter(D=>D!==y),S=new Set(Ke(x.skipped_columns)),j=S.size;S.add(y);const C=j!==S.size,k=x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)?{...x.column_methods}:{},O=Object.prototype.hasOwnProperty.call(k,y);O&&delete k[y];const R=x.column_parameters&&typeof x.column_parameters=="object"&&!Array.isArray(x.column_parameters)?{...x.column_parameters}:{},P=Object.prototype.hasOwnProperty.call(R,y);if(P&&delete R[y],!(E.length!==N.length)&&!C&&!O&&!P)return x;const A={...x,columns:E.sort((D,V)=>D.localeCompare(V)),skipped_columns:Array.from(S).sort((D,V)=>D.localeCompare(V))};return Object.keys(k).length?A.column_methods=k:Object.prototype.hasOwnProperty.call(A,"column_methods")&&delete A.column_methods,Object.keys(R).length?A.column_parameters=R:Object.prototype.hasOwnProperty.call(A,"column_parameters")&&delete A.column_parameters,A})},[e]),h=_.useCallback(w=>{const y=String(w??"").trim();y&&e(x=>{if(!x||typeof x!="object")return x;const N=Ke(x.skipped_columns);if(!N.includes(y))return x;const E=N.filter(C=>C!==y),S=new Set(Ke(x.columns));S.has(y)||S.add(y);const j={...x,columns:Array.from(S).sort((C,k)=>C.localeCompare(k))};return E.length?j.skipped_columns=E.sort((C,k)=>C.localeCompare(k)):Object.prototype.hasOwnProperty.call(j,"skipped_columns")&&delete j.skipped_columns,j})},[e]),f=_.useCallback((w,y)=>{if(y==="__skip__"){p(w);return}if(y==="__default__"){h(w),c(w,null);return}ws.includes(y)&&(h(w),c(w,y))},[p,h,c]),g=_.useCallback((w,y,x)=>{const N=String(y??"").trim().toLowerCase();e(E=>{if(!E||typeof E!="object")return E;const S=E.method_parameters&&typeof E.method_parameters=="object"&&!Array.isArray(E.method_parameters)?{...E.method_parameters}:{},j={...S[w]??{}},C=typeof x=="number"&&Number.isFinite(x)?x:null;let k=!1;if(C===null?Object.prototype.hasOwnProperty.call(j,N)&&(delete j[N],k=!0):j[N]!==C&&(j[N]=C,k=!0),!k)return E;if(Object.keys(j).length?S[w]=j:delete S[w],!Object.keys(S).length){const O={...E};return Object.prototype.hasOwnProperty.call(O,"method_parameters")&&delete O.method_parameters,O}return{...E,method_parameters:S}})},[e]),b=_.useCallback((w,y,x)=>{const N=String(w??"").trim();if(!N)return;const E=String(y??"").trim().toLowerCase();e(S=>{if(!S||typeof S!="object")return S;const j=S.column_parameters&&typeof S.column_parameters=="object"&&!Array.isArray(S.column_parameters)?{...S.column_parameters}:{},C={...j[N]??{}},k=typeof x=="number"&&Number.isFinite(x)?x:null;let O=!1;if(k===null?Object.prototype.hasOwnProperty.call(C,E)&&(delete C[E],O=!0):C[E]!==k&&(C[E]=k,O=!0),!O)return S;if(Object.keys(C).length?j[N]=C:delete j[N],!Object.keys(j).length){const R={...S};return Object.prototype.hasOwnProperty.call(R,"column_parameters")&&delete R.column_parameters,R}return{...S,column_parameters:j}})},[e]);return{handleOutlierDefaultMethodChange:i,handleOutlierAutoDetectToggle:l,setOutlierColumnMethod:c,handleOutlierClearOverrides:u,handleOutlierApplyAllRecommendations:d,handleOutlierSkipColumn:p,handleOutlierUnskipColumn:h,handleOutlierOverrideSelect:f,handleOutlierMethodParameterChange:g,handleOutlierColumnParameterChange:b}},jP=({setConfigState:e,scalingRecommendations:t})=>{const n=_.useCallback(h=>{Us.includes(h)&&e(f=>(f==null?void 0:f.default_method)===h?f:{...f,default_method:h})},[e]),s=_.useCallback(h=>{e(f=>(typeof(f==null?void 0:f.auto_detect)=="boolean"?f.auto_detect:!0)===h?f:{...f,auto_detect:h})},[e]),i=_.useCallback((h,f)=>{const g=String(h??"").trim();g&&e(b=>{const w=Ke(b.columns),y=w.includes(g),x=b.column_methods&&typeof b.column_methods=="object"&&!Array.isArray(b.column_methods)?{...b.column_methods}:{};if(f){if(!Us.includes(f))return b;const S=(x[g]??null)!==f,j=!y;if(!S&&!j)return b;x[g]=f;const C=j?[...w,g].sort((k,O)=>k.localeCompare(O)):w;return{...b,columns:C,column_methods:x}}if(!Object.prototype.hasOwnProperty.call(x,g))return b;if(delete x[g],Object.keys(x).length)return{...b,column_methods:x};const N={...b};return Object.prototype.hasOwnProperty.call(N,"column_methods")&&delete N.column_methods,N})},[e]),l=_.useCallback(()=>{e(h=>{if(!h.column_methods||typeof h.column_methods!="object"||Array.isArray(h.column_methods)||!Object.keys(h.column_methods).length)return h;const f={...h};return delete f.column_methods,f})},[e]),c=_.useCallback(()=>{t.length&&e(h=>{const f=Ke(h.columns),g=new Set(f),b=new Set(Ke(h.skipped_columns)),w=h.column_methods&&typeof h.column_methods=="object"&&!Array.isArray(h.column_methods)?{...h.column_methods}:{};let y=!1;if(t.forEach(N=>{const E=String(N.column??"").trim(),S=N.recommended_method;!E||!Us.includes(S)||b.has(E)||(w[E]!==S&&(w[E]=S,y=!0),g.has(E)||(g.add(E),y=!0))}),!y)return h;const x=Array.from(g).sort((N,E)=>N.localeCompare(E));return{...h,columns:x,column_methods:w}})},[t,e]),u=_.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const b=Ke(g.columns),w=b.filter(j=>j!==f),y=new Set(Ke(g.skipped_columns)),x=y.size;y.add(f);const N=y.size!==x,E=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{},S=Object.prototype.hasOwnProperty.call(E,f);return S&&delete E[f],!N&&w.length===b.length&&!S?g:{...g,columns:w.sort((j,C)=>j.localeCompare(C)),column_methods:E,skipped_columns:Array.from(y).sort((j,C)=>j.localeCompare(C))}})},[e]),d=_.useCallback(h=>{const f=String(h??"").trim();f&&e(g=>{const b=Ke(g.skipped_columns);if(!b.includes(f))return g;const w=new Set(b);w.delete(f);const y=new Set(Ke(g.columns));return y.has(f)||y.add(f),{...g,columns:Array.from(y).sort((N,E)=>N.localeCompare(E)),skipped_columns:Array.from(w).sort((N,E)=>N.localeCompare(E))}})},[e]),p=_.useCallback((h,f)=>{if(f==="__skip__"){u(h);return}if(f==="__default__"){d(h),i(h,null);return}Us.includes(f)&&(d(h),i(h,f))},[u,d,i]);return{handleScalingDefaultMethodChange:n,handleScalingAutoDetectToggle:s,setScalingColumnMethod:i,handleScalingClearOverrides:l,handleScalingApplyAllRecommendations:c,handleScalingSkipColumn:u,handleScalingUnskipColumn:d,handleScalingOverrideSelect:p}},CP=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},SP=({isBinningNode:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:s,availableColumns:i,recommendedColumns:l})=>{const c=_.useMemo(()=>{if(!l)return null;const h=new Set;for(const f of l){const g=typeof f=="string"?f.trim():"";g&&h.add(g)}return h.size>0?h:null},[l]),u=_.useMemo(()=>{if(!Array.isArray(n)||!n.length)return null;const h=new Set;return n.forEach(f=>{const g=typeof f=="string"?f.trim():"";g&&h.add(g)}),h.size>0?h:null},[n]),d=_.useMemo(()=>{if(!e)return new Set;if(!t.size||!c&&!u)return t;const h=new Set;return t.forEach(f=>{c!=null&&c.has(f)||u!=null&&u.has(f)||h.add(f)}),h},[e,t,c,u]),p=_.useMemo(()=>{if(!e||!s.length)return{};const h={};return i.forEach(f=>{if(d.has(f))return;let g=null,b=null;const w=new Set;if(s.forEach(y=>{if(!y||!Object.prototype.hasOwnProperty.call(y,f))return;const x=CP(y[f]);x!==null&&((g===null||x<g)&&(g=x),(b===null||x>b)&&(b=x),w.size<=1e3&&w.add(x))}),g!==null||b!==null){const y=w.size>0?w.size:null;h[f]={min:g,max:b,distinct:y}}}),h},[i,d,e,s]);return{binningExcludedColumns:d,binningColumnPreviewMap:p,manualBoundColumns:[],manualRangeFallbackMap:{}}},EP=({isScalingNode:e,isBinningNode:t,isOutlierNode:n,scalingExcludedColumns:s,binningExcludedColumns:i,outlierExcludedColumns:l,setConfigState:c})=>{_.useEffect(()=>{!e||s.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ke(u.columns);if(!d.length)return u;const p=d.filter(f=>!s.has(f));if(p.length===d.length||!p.length)return u;const h={...u,columns:p};if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const f={};let g=!1;Object.entries(u.column_methods).forEach(([b,w])=>{const y=String(b??"").trim();if(!y)return;if(s.has(y)){g=!0;return}const x=typeof w=="string"?w.trim():null;x&&Us.includes(x)&&(f[y]=x)}),g?Object.keys(f).length?h.column_methods=f:h.column_methods={}:h.column_methods=u.column_methods}return h})},[e,s,c]),_.useEffect(()=>{!t||i.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ke(u.columns);if(!d.length)return u;const p=d.filter(g=>!i.has(g));if(p.length===d.length)return u;const h=new Set(d.filter(g=>i.has(g))),f={...u,columns:p};if(u.custom_bins&&typeof u.custom_bins=="object"&&!Array.isArray(u.custom_bins)){const g={};Object.entries(u.custom_bins).forEach(([b,w])=>{!h.has(b)&&Array.isArray(w)&&w.length&&(g[b]=[...w])}),Object.keys(g).length?f.custom_bins=g:Object.prototype.hasOwnProperty.call(f,"custom_bins")&&delete f.custom_bins}if(u.custom_labels&&typeof u.custom_labels=="object"&&!Array.isArray(u.custom_labels)){const g={};Object.entries(u.custom_labels).forEach(([b,w])=>{!h.has(b)&&Array.isArray(w)&&w.length&&(g[b]=w.map(y=>String(y)))}),Object.keys(g).length?f.custom_labels=g:Object.prototype.hasOwnProperty.call(f,"custom_labels")&&delete f.custom_labels}return f})},[i,t,c]),_.useEffect(()=>{!n||l.size===0||c(u=>{if(!u||typeof u!="object")return u;const d=Ke(u.columns),p=d.filter(E=>!l.has(E)),h=p.length!==d.length,f=Ke(u.skipped_columns),g=f.filter(E=>!l.has(E)),b=g.length!==f.length,w=E=>E??{...u};let y=null;h&&(y=w(y),y.columns=p.sort((E,S)=>E.localeCompare(S))),b&&(y=w(y),g.length?y.skipped_columns=g.sort((E,S)=>E.localeCompare(S)):Object.prototype.hasOwnProperty.call(y,"skipped_columns")&&delete y.skipped_columns);let x=!1;if(u.column_methods&&typeof u.column_methods=="object"&&!Array.isArray(u.column_methods)){const E={};Object.entries(u.column_methods).forEach(([S,j])=>{const C=String(S??"").trim();if(!C||l.has(C)){x=!0;return}const k=typeof j=="string"?j.trim():null;k&&ws.includes(k)?E[C]=k:x=!0}),x&&(y=w(y),Object.keys(E).length?y.column_methods=E:Object.prototype.hasOwnProperty.call(y,"column_methods")&&delete y.column_methods)}let N=!1;if(u.column_parameters&&typeof u.column_parameters=="object"&&!Array.isArray(u.column_parameters)){const E={};Object.entries(u.column_parameters).forEach(([S,j])=>{const C=String(S??"").trim();if(!C||l.has(C)){N=!0;return}if(!j||typeof j!="object"||Array.isArray(j)){N=!0;return}E[C]={...j}}),N&&(y=w(y),Object.keys(E).length?y.column_parameters=E:Object.prototype.hasOwnProperty.call(y,"column_parameters")&&delete y.column_parameters)}return y||u})},[n,l,c])},kP=({catalogFlags:e,configState:t,setConfigState:n,nodeId:s,numericExcludedColumns:i,scalingData:l,outlierData:c,binningData:u,availableColumns:d,previewSampleRows:p})=>{const{isScalingNode:h,isOutlierNode:f,isBinningNode:g}=e,{scalingConfig:b,scalingExcludedColumns:w,scalingMethodDetailMap:y,scalingMethodOptions:x,scalingRecommendations:N,scalingRecommendationRows:E,scalingSelectedCount:S,scalingOverrideCount:j,scalingDefaultDetail:C,scalingDefaultLabel:k,scalingAutoDetectEnabled:O,scalingHasRecommendations:R,scalingStatusMessage:P,scalingOverrideExampleSummary:$}=yP({isScalingNode:h,configState:t,numericExcludedColumns:i,scalingData:l}),{outlierConfig:A,outlierExcludedColumns:D,outlierMethodLabelMap:V,outlierMethodDetailMap:z,outlierMethodOptions:F,outlierRecommendations:q,outlierRecommendationRows:G,outlierSelectedCount:W,outlierOverrideCount:X,outlierParameterOverrideCount:I,outlierDefaultDetail:L,outlierDefaultLabel:U,outlierAutoDetectEnabled:te,outlierHasRecommendations:K,outlierStatusMessage:H,outlierOverrideExampleSummary:Y}=bP({isOutlierNode:f,configState:t,numericExcludedColumns:i,outlierData:c}),Q=typeof(c==null?void 0:c.sample_size)=="number"?c.sample_size:null,ne=null,J=X>0||I>0,re=_.useMemo(()=>X>0?Y:I>0?`${I} column${I===1?"":"s"} with parameter overrides`:null,[X,I,Y]),{binningConfig:Se,binningSelectedCount:ze,binningDefaultLabel:$e,binningOverrideColumns:Be,binningOverrideCount:it,binningOverrideSummary:He,fieldIds:de,customEdgeDrafts:ge,setCustomEdgeDrafts:Ne,customLabelDrafts:Me,setCustomLabelDrafts:Ue}=xP({configState:t,nodeId:s}),ce=_.useMemo(()=>h?b.columns:g?Se.columns:f?A.columns:Ke(t==null?void 0:t.columns),[Se.columns,t,g,f,h,A.columns,b.columns]),Oe=_.useMemo(()=>{const Qt=u==null?void 0:u.columns;return Array.isArray(Qt)?Qt.filter(Xe=>!Xe||typeof Xe.column!="string"?!1:!!Xe.column.trim()):[]},[u==null?void 0:u.columns]),Ge=_.useMemo(()=>{if(!Oe.length)return new Set;const Qt=new Set;return Oe.forEach(Xe=>{const Bt=typeof Xe.column=="string"?Xe.column.trim():"";Bt&&Qt.add(Bt)}),Qt},[Oe]),ut=_.useMemo(()=>{if(!g)return[];const Qt=new Set;return d.forEach(Xe=>{if(i.has(Xe))return;const Bt=Xe.trim();Bt&&Qt.add(Bt)}),Oe.forEach(Xe=>{const Bt=typeof Xe.column=="string"?Xe.column.trim():"";Bt&&(!i.has(Bt)||Ge.has(Bt))&&Qt.add(Bt)}),ce.forEach(Xe=>{const Bt=typeof Xe=="string"?Xe.trim():"";Bt&&(!i.has(Bt)||Ge.has(Bt))&&Qt.add(Bt)}),Array.from(Qt).sort((Xe,Bt)=>Xe.localeCompare(Bt))},[d,Oe,Ge,g,i,ce]),rt=_.useMemo(()=>!g||!ut.length?[]:ut.filter(Qt=>!ce.includes(Qt)),[ut,g,ce]),vt=rt.length>0,{handleBinningIntegerChange:at,handleBinningBooleanToggle:ct,handleBinningSuffixChange:$t,handleBinningLabelFormatChange:Dt,handleBinningMissingStrategyChange:Qe,handleBinningMissingLabelChange:Ut,handleBinningCustomBinsChange:Yt,handleBinningCustomLabelsChange:Mt,handleBinningClearCustomColumn:yt,updateBinningColumnOverride:jn,handleBinningOverrideStrategyChange:Rt,handleBinningOverrideNumberChange:tn,handleBinningOverrideKbinsEncodeChange:fe,handleBinningOverrideKbinsStrategyChange:qt,handleBinningClearOverride:dt,handleBinningClearOverrides:Ye,handleBinningApplyStrategies:bt,handleBinningApplyColumns:dn,handleApplyAllBinningNumeric:ft}=wP({setConfigState:n,setBinningCustomEdgeDrafts:Ne,setBinningCustomLabelDrafts:Ue,binningConfig:Se,binningInsightsRecommendations:Oe,binningAllNumericColumns:ut}),{handleOutlierDefaultMethodChange:Cs,handleOutlierAutoDetectToggle:Gt,setOutlierColumnMethod:pt,handleOutlierClearOverrides:Nt,handleOutlierApplyAllRecommendations:Yn,handleOutlierSkipColumn:mn,handleOutlierUnskipColumn:rn,handleOutlierOverrideSelect:hn,handleOutlierMethodParameterChange:Cn,handleOutlierColumnParameterChange:At}=NP({setConfigState:n,outlierRecommendationRows:G,outlierExcludedColumns:D,outlierConfig:A}),{handleScalingDefaultMethodChange:Gn,handleScalingAutoDetectToggle:Ht,setScalingColumnMethod:fn,handleScalingClearOverrides:Sn,handleScalingApplyAllRecommendations:Ve,handleScalingSkipColumn:tr,handleScalingUnskipColumn:Qn,handleScalingOverrideSelect:as}=jP({setConfigState:n,scalingRecommendations:N}),{binningExcludedColumns:Fn,binningColumnPreviewMap:os,manualBoundColumns:Ss,manualRangeFallbackMap:In}=SP({isBinningNode:g,numericExcludedColumns:i,selectedColumns:ce,previewSampleRows:p,availableColumns:d,recommendedColumns:Ge}),nr=_.useMemo(()=>{const Qt=u==null?void 0:u.excluded_columns;return Array.isArray(Qt)?Qt.filter(Xe=>!Xe||typeof Xe.column!="string"?!1:!!Xe.column.trim()):[]},[u==null?void 0:u.excluded_columns]);return EP({isScalingNode:h,isBinningNode:g,isOutlierNode:f,scalingExcludedColumns:w,binningExcludedColumns:Fn,outlierExcludedColumns:D,setConfigState:n}),{scaling:{config:b,state:{excludedColumns:w,methodDetailMap:y,methodOptions:x,recommendations:N,recommendationRows:E,selectedCount:S,overrideCount:j,defaultDetail:C,defaultLabel:k,autoDetectEnabled:O,hasRecommendations:R,statusMessage:P,overrideExampleSummary:$},handlers:{handleDefaultMethodChange:Gn,handleAutoDetectToggle:Ht,setColumnMethod:fn,handleClearOverrides:Sn,handleApplyAllRecommendations:Ve,handleSkipColumn:tr,handleUnskipColumn:Qn,handleOverrideSelect:as}},outlier:{config:A,state:{excludedColumns:D,methodLabelMap:V,methodDetailMap:z,methodOptions:F,recommendations:q,recommendationRows:G,selectedCount:W,overrideCount:X,parameterOverrideCount:I,defaultDetail:L,defaultLabel:U,autoDetectEnabled:te,hasRecommendations:K,statusMessage:H,overrideExampleSummary:Y,sampleSize:Q,relativeGeneratedAt:ne,hasOverrides:J,overrideSummaryDisplay:re},handlers:{handleDefaultMethodChange:Cs,handleAutoDetectToggle:Gt,setColumnMethod:pt,handleClearOverrides:Nt,handleApplyAllRecommendations:Yn,handleSkipColumn:mn,handleUnskipColumn:rn,handleOverrideSelect:hn,handleMethodParameterChange:Cn,handleColumnParameterChange:At}},binning:{config:Se,state:{selectedCount:ze,defaultLabel:$e,overrideColumns:Be,overrideCount:it,overrideSummary:He,fieldIds:de,customEdgeDrafts:ge,customLabelDrafts:Me,insightsRecommendations:Oe,recommendedColumnSet:Ge,allNumericColumns:ut,numericColumnsNotSelected:rt,canApplyAllNumeric:vt,excludedColumns:Fn,columnPreviewMap:os,manualBoundColumns:Ss,manualRangeFallbackMap:In,insightsExcludedColumns:nr},handlers:{setCustomEdgeDrafts:Ne,setCustomLabelDrafts:Ue,handleIntegerChange:at,handleBooleanToggle:ct,handleSuffixChange:$t,handleLabelFormatChange:Dt,handleMissingStrategyChange:Qe,handleMissingLabelChange:Ut,handleCustomBinsChange:Yt,handleCustomLabelsChange:Mt,handleClearCustomColumn:yt,updateColumnOverride:jn,handleOverrideStrategyChange:Rt,handleOverrideNumberChange:tn,handleOverrideKbinsEncodeChange:fe,handleOverrideKbinsStrategyChange:qt,handleClearOverride:dt,handleClearOverrides:Ye,handleApplyStrategies:bt,handleApplyColumns:dn,handleApplyAllNumeric:ft}},selectedColumns:ce}},Nx={enabled:!1,explicit:!1},MP={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},AP={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},OP={},TP=[],$P=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isReplaceAliasesNode:c}=e,u=_.useMemo(()=>{if(!c)return Nx;const x=Ei(t);if(x!==void 0)return{enabled:!!xo(x),explicit:!0};if(n&&typeof n=="object"){const N=Ei(n);if(N!==void 0)return{enabled:!!xo(N),explicit:!0}}return Nx},[t,c,n]),d=_.useMemo(()=>{if(!c)return[];const x=Ke((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),N=Su(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),E=(()=>{const j=Ei(t);if(j!==void 0){const C=xo(j);if(C!==null)return C}if(n&&typeof n=="object"){const C=Ei(n);if(C!==void 0){const k=xo(C);if(k!==null)return k}}return x.length===0})(),S=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return Py(S,{mode:N,columns:x,autoDetect:E})},[t,c,n]),p=_.useMemo(()=>c?d.length?Array.from(new Set(d.flatMap(x=>x.columns.map(N=>N.trim()).filter(Boolean)))).sort((x,N)=>x.localeCompare(N)):Ke(t==null?void 0:t.columns):[],[d,t==null?void 0:t.columns,c]),h=_.useMemo(()=>c?d.length?d.some(x=>x.autoDetect):u.explicit?u.enabled:p.length===0:!1,[u.enabled,u.explicit,p.length,d,c]),f=_.useMemo(()=>{if(c)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,c]),g=_.useMemo(()=>c?IM(l):OP,[c,l]),b=_.useMemo(()=>c?PM({selectedColumns:p,availableColumns:s,columnTypeMap:i,autoDetectEnabled:h}):MP,[h,p,s,i,c]),w=_.useMemo(()=>c?LM(f):AP,[c,f]),y=_.useMemo(()=>{if(!c)return TP;const x=new Set(b.recommendedColumns),N=new Set(b.textColumns);return s.map(E=>{const S=i[E]??null,j=g[E]??[];return{name:E,dtype:S,samples:j.slice(0,3),isRecommended:x.has(E),isTextLike:N.has(E)}})},[b.recommendedColumns,b.textColumns,g,s,i,c]);return{aliasAutoDetectMeta:u,aliasStrategies:d,aliasStrategyCount:d.length,aliasSelectedColumns:p,aliasAutoDetectEnabled:h,replaceAliasesCustomPairsValue:f,aliasColumnSummary:b,aliasCustomPairSummary:w,aliasSampleMap:g,aliasColumnOptions:y}},PP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isTrimWhitespaceNode:c,isRemoveSpecialCharsNode:u,isRegexCleanupNode:d,isNormalizeTextCaseNode:p}=e,h=_.useMemo(()=>_A(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,c,n==null?void 0:n.mode]),f=_.useMemo(()=>c?Ke(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,c]),g=_.useMemo(()=>c?jA(l):{},[c,l]),b=_.useMemo(()=>c?bA({selectedColumns:f,availableColumns:s,columnTypeMap:i,sampleMap:g}):SA,[s,i,c,f,g]),w=_.useMemo(()=>vA(h),[h]),y=_.useMemo(()=>DA(u?t==null?void 0:t.mode:void 0,u?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,u,n==null?void 0:n.mode]),x=_.useMemo(()=>u?Ke(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,u]),N=_.useMemo(()=>u?qA(l):{},[u,l]),E=_.useMemo(()=>u?BA({selectedColumns:x,availableColumns:s,columnTypeMap:i,sampleMap:N}):VA,[s,i,u,x,N]),S=_.useMemo(()=>FA(y),[y]),j=_.useMemo(()=>_O(d?t==null?void 0:t.mode:void 0,d?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,d,n==null?void 0:n.mode]),C=_.useMemo(()=>d?Ke(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,d]),k=_.useMemo(()=>d?wO(l):{},[d,l]),O=_.useMemo(()=>d?bO({selectedColumns:C,availableColumns:s,columnTypeMap:i,sampleMap:k}):CO,[s,i,d,C,k]),R=_.useMemo(()=>vO(j),[j]),P=_.useMemo(()=>{if(!d)return null;const F=(t==null?void 0:t.replacement)??(n==null?void 0:n.replacement)??null;return typeof F=="string"?F:null},[t==null?void 0:t.replacement,d,n==null?void 0:n.replacement]),$=_.useMemo(()=>tO(p?t==null?void 0:t.mode:void 0,p?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,p,n==null?void 0:n.mode]),A=_.useMemo(()=>p?Ke(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,p]),D=_.useMemo(()=>p?oO(l):{},[p,l]),V=_.useMemo(()=>p?rO({selectedColumns:A,availableColumns:s,columnTypeMap:i,sampleMap:D,mode:$}):lO,[s,i,p,A,$,D]),z=_.useMemo(()=>nO($),[$]);return{trimWhitespace:{columnSummary:b,sampleMap:g,modeDetails:w},removeSpecial:{columnSummary:E,sampleMap:N,modeDetails:S,selectedMode:y},regexCleanup:{columnSummary:O,sampleMap:k,modeDetails:R,selectedMode:j,replacementValue:P},normalizeCase:{columnSummary:V,sampleMap:D,modeDetails:z,selectedMode:$}}},RP={},LP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isReplaceInvalidValuesNode:c}=e,u=_.useMemo(()=>LO(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,c,n==null?void 0:n.mode]),d=_.useMemo(()=>c?Ke(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,c]),p=_.useMemo(()=>{if(!c)return null;const w=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),y=Number(w);return Number.isFinite(y)?y:null},[t==null?void 0:t.min_value,c,n==null?void 0:n.min_value]),h=_.useMemo(()=>{if(!c)return null;const w=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),y=Number(w);return Number.isFinite(y)?y:null},[t==null?void 0:t.max_value,c,n==null?void 0:n.max_value]),f=_.useMemo(()=>c?BO(l):RP,[c,l]),g=_.useMemo(()=>c?FO({selectedColumns:d,availableColumns:s,columnTypeMap:i,sampleMap:f}):GO,[s,i,c,f,d]),b=_.useMemo(()=>zO(u),[u]);return{selectedColumns:d,selectedMode:u,modeDetails:b,sampleMap:f,columnSummary:g,minValue:p,maxValue:h}},zP={},DP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isStandardizeDatesNode:c}=e,u=_.useMemo(()=>Vy(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,c,n==null?void 0:n.mode]),d=_.useMemo(()=>c?Ke((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,c,n==null?void 0:n.columns]),p=_.useMemo(()=>{if(!c)return[];const y={columns:d,mode:u,autoDetect:d.length===0};return Wy((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),y)},[t==null?void 0:t.format_strategies,c,d,n==null?void 0:n.format_strategies,u]),h=_.useMemo(()=>{if(!c)return[];const y=new Set;return p.forEach(x=>{x.columns.forEach(N=>{const E=N.trim();E&&y.add(E)})}),Array.from(y).sort((x,N)=>x.localeCompare(N))},[c,p]),f=_.useMemo(()=>p.some(y=>y.autoDetect),[p]),g=_.useMemo(()=>c?iA(l):zP,[c,l]),b=_.useMemo(()=>{if(!c)return lA;const y=tA({selectedColumns:h,availableColumns:s,columnTypeMap:i,sampleMap:g});return f?{...y,autoDetectionActive:!0}:y},[s,i,f,c,g,h]),w=_.useMemo(()=>{if(!c)return[];const y=new Set(b.recommendedColumns),x=new Set(b.sampleCandidates);return s.map(N=>{const E=i[N]??null,S=g[N]??[];return{name:N,dtype:E,samples:S.slice(0,3),isRecommended:y.has(N),isSampleCandidate:x.has(N)}})},[s,b,i,c,g]);return{selectedMode:u,strategies:p,sampleMap:g,columnSummary:b,columnOptions:w}},FP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isRegexCleanupNode:p,isNormalizeTextCaseNode:h,isReplaceInvalidValuesNode:f,isStandardizeDatesNode:g}=e,{aliasAutoDetectMeta:b,aliasStrategies:w,aliasStrategyCount:y,aliasSelectedColumns:x,aliasAutoDetectEnabled:N,replaceAliasesCustomPairsValue:E,aliasColumnSummary:S,aliasCustomPairSummary:j,aliasSampleMap:C,aliasColumnOptions:k}=$P({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l}),{trimWhitespace:O,removeSpecial:R,regexCleanup:P,normalizeCase:$}=PP({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l}),{selectedMode:A,modeDetails:D,sampleMap:V,columnSummary:z,minValue:F,maxValue:q}=LP({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l}),{selectedMode:G,strategies:W,sampleMap:X,columnSummary:I,columnOptions:L}=DP({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l});return{alias:{autoDetectMeta:b,strategies:w,strategyCount:y,selectedColumns:x,autoDetectEnabled:N,customPairsValue:E,columnSummary:S,customPairSummary:j,sampleMap:C,columnOptions:k},trimWhitespace:O,removeSpecial:R,regexCleanup:P,normalizeCase:$,replaceInvalid:{mode:A,modeDetails:D,sampleMap:V,columnSummary:z,minValue:F,maxValue:q},standardizeDates:{mode:G,strategies:W,sampleMap:X,columnSummary:I,columnOptions:L}}},IP=({graphSnapshot:e,nodeId:t,catalogFlags:n})=>{const{isDataset:s}=n,i=_.useMemo(()=>{if(!e)return null;const g=Array.isArray(e.nodes)?e.nodes:[],b=Array.isArray(e.edges)?e.edges:[];return{nodes:g,edges:b}},[e]),l=_.useMemo(()=>e&&Array.isArray(e.nodes)?e.nodes:[],[e]),c=_.useMemo(()=>e&&Array.isArray(e.edges)?e.edges:[],[e]),u=l.length,d=_.useMemo(()=>{if(!t||!c.length)return[];const g=new Set,b=[t];for(;b.length;){const y=b.pop();y&&c.forEach(x=>{const N=x&&typeof x.source=="string"?x.source.trim():"",E=x&&typeof x.target=="string"?x.target.trim():"";!N||!E||E===y&&!g.has(N)&&(g.add(N),b.push(N))})}const w=Array.from(g);return w.sort(),w},[c,t]),p=_.useMemo(()=>{var w,y,x,N,E;if(!d.length)return"";let g="",b="";for(const S of d){const j=l.find(k=>(k==null?void 0:k.id)===S);if(!j)continue;const C=String(((w=j==null?void 0:j.data)==null?void 0:w.catalogType)??"").toLowerCase().trim();if(C==="feature_target_split"){const k=(x=(y=j==null?void 0:j.data)==null?void 0:y.config)==null?void 0:x.target_column;typeof k=="string"&&k.trim()&&(g=k.trim())}else if(C==="train_test_split"){const k=(E=(N=j==null?void 0:j.data)==null?void 0:N.config)==null?void 0:E.target_column;typeof k=="string"&&k.trim()&&(b=k.trim())}}return g||b||""},[l,d]),h=_.useMemo(()=>{const g=new Set;return l.forEach(b=>{if(!b)return;const w=typeof b.id=="string"?b.id.trim():String((b==null?void 0:b.id)??"").trim();if(!w)return;const y=(b==null?void 0:b.data)??{};(w==="dataset-source"||(y==null?void 0:y.isDataset)===!0||(y==null?void 0:y.catalogType)==="dataset")&&g.add(w)}),g.size||g.add("dataset-source"),Array.from(g)},[l]),f=_.useMemo(()=>{if(!t)return!1;if(s)return!0;if(!c.length)return h.includes(t);const g=new Map;c.forEach(y=>{const x=y==null?void 0:y.source,N=y==null?void 0:y.target,E=typeof x=="string"?x.trim():String(x??"").trim(),S=typeof N=="string"?N.trim():String(N??"").trim();if(!E||!S)return;const j=g.get(E);j?j.push(S):g.set(E,[S])});const b=new Set,w=[...h];for(;w.length;){const y=w.pop();if(!y||b.has(y))continue;b.add(y);const x=g.get(y);x&&x.forEach(N=>{N&&!b.has(N)&&w.push(N)})}return b.has(t)},[h,c,s,t]);return{graphContext:i,graphNodes:l,graphEdges:c,graphNodeCount:u,upstreamNodeIds:d,upstreamTargetColumn:p,hasReachableSource:f}},Kl={status:"idle",data:null,error:null},BP=1e3,UP=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:s,isPreviewNode:i,targetNodeId:l,previewSignature:c,skipPreview:u=!1,requestPreviewRows:d,includeSignals:p})=>{const[h,f]=_.useState(Kl),[g,b]=_.useState(0),w=_.useRef(null),y=_.useRef(-1),x=_.useCallback(()=>{b(N=>N+1)},[]);return _.useEffect(()=>{if(!e){f(Kl),w.current=null,y.current=-1;return}if(u)return;if(!t){f(i?{status:"error",data:null,error:"Select a dataset to generate previews."}:Kl);return}if(!n){f(i?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:Kl);return}if(!s)return;const N=(()=>{const P=Array.isArray(s.nodes)?s.nodes.map(A=>A&&typeof A.id=="string"?A.id:null).filter(A=>!!A).sort():[],$=Array.isArray(s.edges)?s.edges.map(A=>{const D=A&&typeof A.source=="string"?A.source.trim():"",V=A&&typeof A.target=="string"?A.target.trim():"";return D&&V?`${D}->${V}`:null}).filter(A=>!!A).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:l??null,nodeIds:P,edgePairs:$})})(),E=c??N,S=E!==w.current;if(!(y.current!==g)&&!S)return;w.current=E,y.current=g;let C=!0;f(P=>({status:"loading",data:P.data??null,error:null}));const k=d??i,O=p??k,R={dataset_source_id:t,graph:{nodes:s.nodes,edges:s.edges},target_node_id:l??void 0,include_preview_rows:k,include_signals:O};return k&&(R.sample_size=BP),dy(R).then(P=>{C&&f({status:"success",data:P,error:null})}).catch(P=>{C&&f(i?{status:"error",data:null,error:(P==null?void 0:P.message)??"Unable to generate preview."}:Kl)}),()=>{C=!1}},[n,s,i,u,c,g,e,t,l]),{previewState:h,refreshPreview:x}},qP=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:i,nodeId:l,previewSignature:c,skipPreview:u,catalogFlags:d,cachedPreviewSchema:p,setCachedPreviewSchema:h})=>{var R;const{isPreviewNode:f,isFeatureMathNode:g,isPolynomialFeaturesNode:b,isFeatureSelectionNode:w,isTrainTestSplitNode:y,isOutlierNode:x,isTransformerAuditNode:N}=d,E=_.useMemo(()=>!(!e||!t||!n),[t,e,n]),S=_.useMemo(()=>!e||!s||!n?!1:t>0,[t,e,n,s]),j=_.useMemo(()=>f||g||b||w||y||x||N,[g,w,x,b,f,y,N]),{previewState:C,refreshPreview:k}=UP({shouldFetchPreview:E,sourceId:s,canTriggerPreview:S,graphSnapshot:e,isPreviewNode:f,targetNodeId:(i==null?void 0:i.id)??null,previewSignature:c,skipPreview:u,requestPreviewRows:f,includeSignals:j});_.useEffect(()=>{var $;const P=(($=C.data)==null?void 0:$.schema)??null;P&&h(A=>A!=null&&A.signature&&P.signature&&A.signature===P.signature?A:P)},[(R=C.data)==null?void 0:R.schema]),_.useEffect(()=>{h(null)},[s]),_.useEffect(()=>{h(null)},[c]);const O=_.useCallback(()=>{h(null)},[]);return{previewState:C,refreshPreview:k,cachedPreviewSchema:p,clearCachedPreviewSchema:O,canTriggerPreview:S}},HP=(e,t,n,s,i)=>{e([]),t({}),n({}),s({}),i("")},VP=({requiresColumnCatalog:e,catalogFlags:t,nodeId:n,sourceId:s,hasReachableSource:i})=>{const{isImputerNode:l}=t,[c,u]=_.useState([]),[d,p]=_.useState(""),[h,f]=_.useState({}),[g,b]=_.useState({}),[w,y]=_.useState({}),[x,N]=_.useState(0);return _.useEffect(()=>{!e&&!l||s&&i||HP(u,f,b,y,p)},[i,l,e,s]),_.useEffect(()=>{N(0)},[l,n]),{availableColumns:c,setAvailableColumns:u,columnSearch:d,setColumnSearch:p,columnMissingMap:h,setColumnMissingMap:f,columnTypeMap:g,setColumnTypeMap:b,columnSuggestions:w,setColumnSuggestions:y,imputerMissingFilter:x,setImputerMissingFilter:N}},WP=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:i})=>{var l;_.useEffect(()=>{var h;const c=Array.isArray((h=e.data)==null?void 0:h.column_stats)?e.data.column_stats:[],u=e.status;if(!c.length){if(u==="loading")return;s(f=>Object.keys(f).length?{}:f),i(f=>Object.keys(f).length?{}:f);return}const d={},p={};c.forEach(f=>{if(!f||!f.name)return;const g=String(f.name).trim();if(!g||n&&g.endsWith(n))return;const b=typeof f.dtype=="string"?f.dtype:null;b&&(d[g]=b);const w=t.map(x=>x&&Object.prototype.hasOwnProperty.call(x,g)?x[g]:void 0),y=y2(b,w);y.length&&(p[g]=y)}),s(f=>{const g=Object.entries(f),b=Object.entries(d);return g.length===b.length&&g.every(([w,y])=>Object.prototype.hasOwnProperty.call(d,w)&&d[w]===y)?f:d}),i(f=>{const g=Object.keys(f),b=Object.keys(p);return g.length===b.length&&g.every(w=>{if(!Object.prototype.hasOwnProperty.call(p,w))return!1;const y=f[w]??[],x=p[w]??[];return Gb(y,x)})?f:p})},[n,t,(l=e.data)==null?void 0:l.column_stats,e.status,i,s])},KP=({previewState:e,activeFlagSuffix:t,hasReachableSource:n,requiresColumnCatalog:s,nodeColumns:i,selectedColumns:l,setAvailableColumns:c,setColumnMissingMap:u})=>{var d,p;_.useEffect(()=>{var y,x;if(!s||!n)return;const h=new Set;(Array.isArray((y=e.data)==null?void 0:y.columns)?e.data.columns:[]).forEach(N=>{const E=typeof N=="string"?N.trim():"";E&&(t&&E.endsWith(t)||h.add(E))});const g=Array.isArray((x=e.data)==null?void 0:x.column_stats)?e.data.column_stats:[],b={};if(g.forEach(N=>{if(!N||!N.name)return;const E=String(N.name).trim();if(!E||t&&E.endsWith(t))return;h.add(E);const S=Number(N.missing_percentage);!Number.isNaN(S)&&S>=0&&(b[E]=S)}),Ke(i).forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),l.forEach(N=>{N&&!(t&&N.endsWith(t))&&h.add(N)}),h.size===0)return;const w=Array.from(h).sort((N,E)=>N.localeCompare(E));c(N=>Gb(N,w)?N:w),Object.keys(b).length>0&&u(N=>({...N,...b}))},[t,n,i,(d=e.data)==null?void 0:d.column_stats,(p=e.data)==null?void 0:p.columns,s,l,c,u])},YP=({previewState:e,nodeId:t,catalogFlags:n})=>{var b,w,y,x,N,E,S,j,C,k;const{isFeatureMathNode:s,isPolynomialFeaturesNode:i,isFeatureSelectionNode:l,isOutlierNode:c,isTransformerAuditNode:u}=n,d=_.useMemo(()=>{var R,P;if(!s)return[];const O=(P=(R=e.data)==null?void 0:R.signals)==null?void 0:P.feature_math;return Array.isArray(O)?O:[]},[s,(w=(b=e.data)==null?void 0:b.signals)==null?void 0:w.feature_math]),p=_.useMemo(()=>{var P,$;if(!i)return null;const O=($=(P=e.data)==null?void 0:P.signals)==null?void 0:$.polynomial_features;return!Array.isArray(O)||O.length===0?null:(t?O.find(A=>A&&typeof A.node_id=="string"&&A.node_id===t):null)??O[0]??null},[i,t,(x=(y=e.data)==null?void 0:y.signals)==null?void 0:x.polynomial_features]),h=_.useMemo(()=>{var P,$;if(!l)return null;const O=($=(P=e.data)==null?void 0:P.signals)==null?void 0:$.feature_selection;return!Array.isArray(O)||O.length===0?null:(t?O.find(A=>A&&typeof A.node_id=="string"&&A.node_id===t):null)??O[0]??null},[l,t,(E=(N=e.data)==null?void 0:N.signals)==null?void 0:E.feature_selection]),f=_.useMemo(()=>{var P,$;if(!c)return null;const O=($=(P=e.data)==null?void 0:P.signals)==null?void 0:$.outlier_removal;return!Array.isArray(O)||!O.length?null:t?O.find(A=>A&&A.node_id===t)??O[O.length-1]??null:O[O.length-1]??null},[c,t,(j=(S=e.data)==null?void 0:S.signals)==null?void 0:j.outlier_removal]),g=_.useMemo(()=>{var P,$;if(!u)return null;const O=($=(P=e.data)==null?void 0:P.signals)==null?void 0:$.transformer_audit;return!Array.isArray(O)||!O.length?null:t?O.find(A=>A&&A.node_id===t)??O[O.length-1]??null:O[O.length-1]??null},[u,t,(k=(C=e.data)==null?void 0:C.signals)==null?void 0:k.transformer_audit]);return{featureMathSignals:d,polynomialSignal:p,featureSelectionSignal:h,outlierPreviewSignal:f,transformerAuditSignal:g}},GP=({catalogFlags:e,featureSelectionSignal:t,upstreamTargetColumn:n,setConfigState:s})=>{const{isFeatureSelectionNode:i}=e;_.useEffect(()=>{if(!i)return;const l=typeof(t==null?void 0:t.target_column)=="string"?t.target_column.trim():"",c=typeof n=="string"?n.trim():"",u=l||c;u&&s(d=>(typeof(d==null?void 0:d.target_column)=="string"?d.target_column.trim():"")?d:{...d,target_column:u})},[t==null?void 0:t.target_column,i,s,n]),_.useEffect(()=>{if(!i)return;const l=typeof(t==null?void 0:t.k)=="number"&&Number.isFinite(t.k)?Math.max(0,Math.trunc(t.k)):null,c=Array.isArray(t==null?void 0:t.selected_columns)?t.selected_columns.length:null,u=l??c??null;u===null||u<=0||s(d=>{const p=d==null?void 0:d.k;let h=null;if(typeof p=="number"&&Number.isFinite(p))h=Math.trunc(p);else if(typeof p=="string"){const f=Number(p);Number.isFinite(f)&&(h=Math.trunc(f))}return h!==null&&h<=u?d:{...d,k:u}})},[t==null?void 0:t.k,t==null?void 0:t.selected_columns,i,s])},Hu=e=>String(e??"").trim(),QP=({catalogFlags:e,setConfigState:t,binningExcludedColumns:n,scalingExcludedColumns:s,availableColumns:i,recommendations:l})=>{const{isBinningNode:c,isScalingNode:u}=e,d=_.useCallback((y,x,N)=>{const E=Hu(y);E&&t(S=>{const j=S.manual_bounds&&typeof S.manual_bounds=="object"&&!Array.isArray(S.manual_bounds)?{...S.manual_bounds}:{},C=j[E]&&typeof j[E]=="object"?{...j[E]}:{lower:null,upper:null};if(N==="")x==="lower"?C.lower=null:C.upper=null;else{const R=Number(N);if(!Number.isFinite(R))return S;x==="lower"?C.lower=R:C.upper=R}const k=C.lower??null,O=C.upper??null;return k===null&&O===null?delete j[E]:j[E]={lower:k,upper:O},{...S,manual_bounds:j}})},[t]),p=_.useCallback(y=>{const x=Hu(y);x&&t(N=>{const E=N.manual_bounds&&typeof N.manual_bounds=="object"&&!Array.isArray(N.manual_bounds)?N.manual_bounds:null;if(!E||!Object.prototype.hasOwnProperty.call(E,x))return N;const S={...E};return delete S[x],{...N,manual_bounds:S}})},[t]),h=_.useCallback(y=>{const x=Hu(y);x&&t(N=>{const E=Ke(N.columns),S=E.includes(x),j=S?E.filter(R=>R!==x):[...E,x];let C=!1,k=N.manual_bounds;S&&k&&typeof k=="object"&&!Array.isArray(k)&&Object.prototype.hasOwnProperty.call(k,x)&&(k={...k},delete k[x],C=!0);const O={...N,columns:j};if(C&&(O.manual_bounds=k),c){const R=new Set(j);if(N.custom_bins&&typeof N.custom_bins=="object"&&!Array.isArray(N.custom_bins)){const P={};Object.entries(N.custom_bins).forEach(([$,A])=>{R.has($)&&Array.isArray(A)&&A.length&&(P[$]=[...A])}),Object.keys(P).length?O.custom_bins=P:"custom_bins"in O&&delete O.custom_bins}else"custom_bins"in O&&delete O.custom_bins;if(N.custom_labels&&typeof N.custom_labels=="object"&&!Array.isArray(N.custom_labels)){const P={};Object.entries(N.custom_labels).forEach(([$,A])=>{R.has($)&&Array.isArray(A)&&A.length&&(P[$]=A.map(D=>String(D)))}),Object.keys(P).length?O.custom_labels=P:"custom_labels"in O&&delete O.custom_labels}else"custom_labels"in O&&delete O.custom_labels;if(N.column_overrides&&typeof N.column_overrides=="object"&&!Array.isArray(N.column_overrides)){const P={};Object.entries(N.column_overrides).forEach(([$,A])=>{R.has($)&&A&&typeof A=="object"&&!Array.isArray(A)&&(P[$]={...A})}),Object.keys(P).length?(O.column_overrides=P,O.column_strategies=P):("column_overrides"in O&&delete O.column_overrides,"column_strategies"in O&&delete O.column_strategies)}else"column_overrides"in O&&delete O.column_overrides,"column_strategies"in O&&delete O.column_strategies}if(u){let R=null;N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)&&(R={},Object.entries(N.column_methods).forEach(([P,$])=>{const A=typeof $=="string"?$.trim():null;!A||!Us.includes(A)||S&&P===x||(R[P]=A)})),R&&Object.keys(R).length?O.column_methods=R:S&&Object.prototype.hasOwnProperty.call(O,"column_methods")&&delete O.column_methods}return O})},[c,u,t]),f=_.useCallback(()=>{l.length&&t(y=>{const x=new Set(Ke(y.columns));return l.forEach(N=>{N!=null&&N.name&&x.add(String(N.name))}),{...y,columns:Array.from(x)}})},[l,t]),g=_.useCallback(()=>{i.length&&t(y=>{const x=new Set(Ke(y.columns));return i.filter(E=>c?!n.has(E):u?!s.has(E):!0).forEach(E=>x.add(E)),{...y,columns:Array.from(x).sort((E,S)=>E.localeCompare(S))}})},[i,n,c,u,s,t]),b=_.useCallback(()=>{t(y=>{const x={...y,columns:[]};return y!=null&&y.manual_bounds&&typeof y.manual_bounds=="object"&&!Array.isArray(y.manual_bounds)&&Object.keys(y.manual_bounds).length&&(x.manual_bounds={}),c&&("custom_bins"in x&&delete x.custom_bins,"custom_labels"in x&&delete x.custom_labels,"column_overrides"in x&&delete x.column_overrides,"column_strategies"in x&&delete x.column_strategies),u&&"column_methods"in x&&delete x.column_methods,x})},[c,u,t]),w=_.useCallback(y=>{const x=Hu(y);x&&t(N=>{const E=Ke(N.columns);if(!E.includes(x))return N;const S=E.filter(O=>O!==x);let j=!1,C=N.manual_bounds;C&&typeof C=="object"&&!Array.isArray(C)&&Object.prototype.hasOwnProperty.call(C,x)&&(C={...C},delete C[x],j=!0);const k={...N,columns:S};if(j&&(k.manual_bounds=C),c){if(N.custom_bins&&typeof N.custom_bins=="object"&&!Array.isArray(N.custom_bins)){const O={};Object.entries(N.custom_bins).forEach(([R,P])=>{R!==x&&Array.isArray(P)&&P.length&&(O[R]=[...P])}),Object.keys(O).length?k.custom_bins=O:"custom_bins"in k&&delete k.custom_bins}else"custom_bins"in k&&delete k.custom_bins;if(N.custom_labels&&typeof N.custom_labels=="object"&&!Array.isArray(N.custom_labels)){const O={};Object.entries(N.custom_labels).forEach(([R,P])=>{R!==x&&Array.isArray(P)&&P.length&&(O[R]=P.map($=>String($)))}),Object.keys(O).length?k.custom_labels=O:"custom_labels"in k&&delete k.custom_labels}else"custom_labels"in k&&delete k.custom_labels;if(N.column_overrides&&typeof N.column_overrides=="object"&&!Array.isArray(N.column_overrides)){const O={};Object.entries(N.column_overrides).forEach(([R,P])=>{R!==x&&P&&typeof P=="object"&&!Array.isArray(P)&&(O[R]={...P})}),Object.keys(O).length?(k.column_overrides=O,k.column_strategies=O):("column_overrides"in k&&delete k.column_overrides,"column_strategies"in k&&delete k.column_strategies)}else"column_overrides"in k&&delete k.column_overrides,"column_strategies"in k&&delete k.column_strategies}if(u)if(N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)){const O={};Object.entries(N.column_methods).forEach(([R,P])=>{const $=typeof P=="string"?P.trim():null;!$||!Us.includes($)||R!==x&&(O[R]=$)}),Object.keys(O).length?k.column_methods=O:Object.prototype.hasOwnProperty.call(k,"column_methods")&&delete k.column_methods}else Object.prototype.hasOwnProperty.call(k,"column_methods")&&delete k.column_methods;return k})},[c,u,t]);return{handleManualBoundChange:d,handleClearManualBound:p,handleToggleColumn:h,handleApplyAllRecommended:f,handleSelectAllColumns:g,handleClearColumns:b,handleRemoveColumn:w}},XP=({configState:e,catalogFlags:t,nodeId:n,onUpdateConfig:s,onClose:i,sourceId:l,graphSnapshot:c,onUpdateNodeData:u,setConfigState:d,canResetNode:p,defaultConfigTemplate:h,onResetConfig:f})=>{const{isBinningNode:g,isScalingNode:b,isInspectionNode:w}=t,y=_.useCallback(N=>{if(!n)return;let E=Th(e);if(g){const S=Ny(E);E={...E,strategy:S.strategy,columns:S.columns,equal_width_bins:S.equalWidthBins,equal_frequency_bins:S.equalFrequencyBins,include_lowest:S.includeLowest,precision:S.precision,duplicates:S.duplicates,output_suffix:S.outputSuffix,drop_original:S.dropOriginal,label_format:S.labelFormat,missing_strategy:S.missingStrategy},S.missingStrategy==="label"?E.missing_label=S.missingLabel:Object.prototype.hasOwnProperty.call(E,"missing_label")&&delete E.missing_label,Object.keys(S.customBins).length?E.custom_bins=S.customBins:Object.prototype.hasOwnProperty.call(E,"custom_bins")&&delete E.custom_bins,Object.keys(S.customLabels).length?E.custom_labels=S.customLabels:Object.prototype.hasOwnProperty.call(E,"custom_labels")&&delete E.custom_labels}if(b){const S=wx(E);E={...E,columns:S.columns,default_method:S.defaultMethod,auto_detect:S.autoDetect,skipped_columns:S.skippedColumns},Object.keys(S.columnMethods).length>0?E.column_methods=S.columnMethods:Object.prototype.hasOwnProperty.call(E,"column_methods")&&delete E.column_methods}s(n,E),(N==null?void 0:N.closeModal)!==!1&&i(),l&&c&&!w&&(u==null||u(n,{backgroundExecutionStatus:"loading"}),my({dataset_source_id:l,graph:{nodes:c.nodes||[],edges:c.edges||[]},target_node_id:n}).then(()=>{u==null||u(n,{backgroundExecutionStatus:"success"})}).catch(S=>{u==null||u(n,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",S)}))},[e,c,g,w,b,n,i,s,u,l]),x=_.useCallback(()=>{if(!p||!n)return;const N=Th(h??{});d(N),f==null||f(n,N)},[p,h,n,f,d]);return{handleSave:y,handleResetNode:x}},JP=e=>_.useMemo(()=>{const t=new Map;return e.forEach(n=>{n!=null&&n.name&&t.set(n.name,n)}),n=>t.get(n)??null},[e]),ZP=e=>{const t=_.useMemo(()=>{var u;const c=(u=e==null?void 0:e.data)==null?void 0:u.parameters;return Array.isArray(c)?c.filter(d=>!!(d!=null&&d.name)).map(d=>({...d})):[]},[e]),n=JP(t),s=_.useCallback((c,u)=>c?n(u):null,[n]),i=_.useMemo(()=>t.some(c=>{var u;return(c==null?void 0:c.type)==="multi_select"&&((u=c==null?void 0:c.source)==null?void 0:u.type)!=="drop_column_recommendations"}),[t]),l=_.useMemo(()=>t.find(c=>{var u;return((u=c==null?void 0:c.source)==null?void 0:u.type)==="drop_column_recommendations"})??null,[t]);return{parameters:t,getParameter:n,getParameterIf:s,requiresColumnCatalog:i,dropColumnParameter:l}},eR=(e,t)=>{const n=(s,i)=>s?e(i):null;return _.useMemo(()=>{const{isBinningNode:s,isScalingNode:i,isRemoveDuplicatesNode:l,isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isReplaceInvalidValuesNode:p,isRegexCleanupNode:h,isNormalizeTextCaseNode:f,isLabelEncodingNode:g,isHashEncodingNode:b,isPolynomialFeaturesNode:w,isFeatureSelectionNode:y,isFeatureMathNode:x,isClassUndersamplingNode:N,isClassOversamplingNode:E,isFeatureTargetSplitNode:S,isTrainModelDraftNode:j,isHyperparameterTuningNode:C,isTargetEncodingNode:k,isOrdinalEncodingNode:O,isDummyEncodingNode:R,isOneHotEncodingNode:P,isMissingIndicatorNode:$,isDropMissingRowsNode:A,isDropMissingColumnsNode:D}=t,V=N||E,z=j||C;return{binning:{columns:n(s,"columns")},scaling:{columns:n(i,"columns"),defaultMethod:n(i,"default_method"),autoDetect:n(i,"auto_detect")},removeDuplicates:{columns:n(l,"columns"),keep:n(l,"keep")},replaceAliases:{customPairs:n(c,"custom_pairs")},trimWhitespace:{columns:n(u,"columns"),mode:n(u,"mode")},removeSpecial:{columns:n(d,"columns"),mode:n(d,"mode"),replacement:n(d,"replacement")},replaceInvalid:{columns:n(p,"columns"),mode:n(p,"mode"),minValue:n(p,"min_value"),maxValue:n(p,"max_value")},regexCleanup:{columns:n(h,"columns"),mode:n(h,"mode"),pattern:n(h,"pattern"),replacement:n(h,"replacement")},normalizeCase:{columns:n(f,"columns"),mode:n(f,"mode")},labelEncoding:{columns:g?e("columns"):null,autoDetect:g?e("auto_detect"):null,maxUnique:g?e("max_unique_values"):null,outputSuffix:g?e("output_suffix"):null,dropOriginal:g?e("drop_original"):null,missingStrategy:g?e("missing_strategy"):null,missingCode:g?e("missing_code"):null},hashEncoding:{columns:b?e("columns"):null,autoDetect:b?e("auto_detect"):null,maxCategories:b?e("max_categories"):null,buckets:b?e("n_buckets"):null,outputSuffix:b?e("output_suffix"):null,dropOriginal:b?e("drop_original"):null,encodeMissing:b?e("encode_missing"):null},polynomial:{columns:n(w,"columns"),autoDetect:n(w,"auto_detect"),degree:n(w,"degree"),includeBias:n(w,"include_bias"),interactionOnly:n(w,"interaction_only"),includeInputFeatures:n(w,"include_input_features"),outputPrefix:n(w,"output_prefix")},featureSelection:{columns:n(y,"columns"),autoDetect:n(y,"auto_detect"),targetColumn:n(y,"target_column"),method:n(y,"method"),scoreFunc:n(y,"score_func"),problemType:n(y,"problem_type"),k:n(y,"k"),percentile:n(y,"percentile"),alpha:n(y,"alpha"),threshold:n(y,"threshold"),mode:n(y,"mode"),estimator:n(y,"estimator"),step:n(y,"step"),minFeatures:n(y,"min_features"),maxFeatures:n(y,"max_features"),dropUnselected:n(y,"drop_unselected")},featureMath:{errorHandling:n(x,"error_handling"),allowOverwrite:n(x,"allow_overwrite"),defaultTimezone:n(x,"default_timezone"),epsilon:n(x,"epsilon")},resampling:{method:n(V,"method"),targetColumn:n(V,"target_column"),samplingStrategy:n(V,"sampling_strategy"),randomState:n(V,"random_state"),kNeighbors:n(E,"k_neighbors"),replacement:n(N,"replacement")},featureTargetSplit:{targetColumn:n(S,"target_column")},trainModel:{targetColumn:n(z,"target_column"),problemType:n(z,"problem_type"),modelType:n(z,"model_type"),hyperparameters:n(j,"hyperparameters"),cvEnabled:n(z,"cv_enabled"),cvStrategy:n(z,"cv_strategy"),cvFolds:n(z,"cv_folds"),cvShuffle:n(z,"cv_shuffle"),cvRandomState:n(z,"cv_random_state"),cvRefitStrategy:n(j,"cv_refit_strategy")},hyperparameterTuning:{searchStrategy:n(C,"search_strategy"),searchIterations:n(C,"search_iterations"),searchRandomState:n(C,"search_random_state"),scoringMetric:n(C,"scoring_metric")},targetEncoding:{columns:k?e("columns"):null,targetColumn:k?e("target_column"):null,autoDetect:k?e("auto_detect"):null,maxCategories:k?e("max_categories"):null,outputSuffix:k?e("output_suffix"):null,dropOriginal:k?e("drop_original"):null,smoothing:k?e("smoothing"):null,encodeMissing:k?e("encode_missing"):null,handleUnknown:k?e("handle_unknown"):null},ordinalEncoding:{columns:O?e("columns"):null,autoDetect:O?e("auto_detect"):null,maxCategories:O?e("max_categories"):null,outputSuffix:O?e("output_suffix"):null,dropOriginal:O?e("drop_original"):null,encodeMissing:O?e("encode_missing"):null,handleUnknown:O?e("handle_unknown"):null,unknownValue:O?e("unknown_value"):null},dummyEncoding:{columns:R?e("columns"):null,autoDetect:R?e("auto_detect"):null,maxCategories:R?e("max_categories"):null,dropFirst:R?e("drop_first"):null,includeMissing:R?e("include_missing"):null,dropOriginal:R?e("drop_original"):null,prefixSeparator:R?e("prefix_separator"):null},oneHotEncoding:{columns:P?e("columns"):null,autoDetect:P?e("auto_detect"):null,maxCategories:P?e("max_categories"):null,dropFirst:P?e("drop_first"):null,includeMissing:P?e("include_missing"):null,dropOriginal:P?e("drop_original"):null,prefixSeparator:P?e("prefix_separator"):null},missingIndicator:{columns:n($,"columns"),suffix:n($,"flag_suffix")},dropRows:{any:n(A,"drop_if_any_missing")},dropMissing:{threshold:n(D||A,"missing_threshold")}}},[t,e])},tR=({isResetAvailable:e=!1,defaultConfigTemplate:t,catalogFlags:n})=>{const{isDataset:s,isScalingNode:i,isBinningNode:l,isBinnedDistributionNode:c,isSkewnessDistributionNode:u,isFeatureMathNode:d,isFeatureTargetSplitNode:p,isTrainTestSplitNode:h,isModelEvaluationNode:f,isHashEncodingNode:g,isPolynomialFeaturesNode:b,isFeatureSelectionNode:w,isDataConsistencyNode:y,isTrainModelDraftNode:x,isHyperparameterTuningNode:N,isClassUndersamplingNode:E,isClassOversamplingNode:S,isLabelEncodingNode:j,isTargetEncodingNode:C,isDummyEncodingNode:k,isOneHotEncodingNode:O,isOrdinalEncodingNode:R,isImputerNode:P,isMissingIndicatorNode:$,isReplaceAliasesNode:A,isTrimWhitespaceNode:D,isRemoveSpecialCharsNode:V,isReplaceInvalidValuesNode:z,isRegexCleanupNode:F,isNormalizeTextCaseNode:q,isStandardizeDatesNode:G,isCastNode:W,isRemoveDuplicatesNode:X,isDropMissingNode:I,isOutlierNode:L}=n,U=_.useMemo(()=>!!(e&&!s&&t),[t,s,e]),H=[d,p,h,f,g,b,w,y,x,N,E||S,j,C,k,O,R,P,$,A,D,V,z,F,q,G,W,X,I,L].some(Boolean),Y=c||u;return{canResetNode:U,headerCanResetNode:U&&!(Y||i||l||H),footerCanResetNode:U&&!Y}},nR=({cachedPreviewSchema:e,catalogFlags:t,resamplingTargetColumn:n,imputerStrategies:s})=>{const{isClassOversamplingNode:i,isImputerNode:l}=t,c=_.useMemo(()=>(e==null?void 0:e.columns)??[],[e]),u=_.useMemo(()=>{if(!i||!c.length||!n)return null;const h=new Set(["numeric","integer","boolean"]),f=c.filter(g=>g&&g.name!==n).filter(g=>!h.has(String(g.logical_family??"unknown"))).map(g=>({name:g.name,logical_family:String(g.logical_family??"unknown")}));return f.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:f.map(g=>g.name),details:f}:null},[c,i,n]),d=_.useMemo(()=>{if(!l||!c.length||!s.length)return null;const h=new Set(["numeric","integer"]),f=new Map(c.map(b=>[b.name,b])),g=[];return s.forEach((b,w)=>{if(!Cy(b.method)||!Array.isArray(b.columns)||!b.columns.length)return;const y=b.columns.map(x=>f.get(x)).filter(x=>!!x).filter(x=>!h.has(String(x.logical_family??"unknown"))).map(x=>({name:x.name,logical_family:String(x.logical_family??"unknown")}));y.length&&g.push({index:w,columns:y.map(x=>x.name),details:y})}),g.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:g}:null},[c,s,l]),p=!!(u!=null&&u.blocked||d!=null&&d.blocked);return{cachedSchemaColumns:c,oversamplingSchemaGuard:u,imputationSchemaDiagnostics:d,skipPreview:p}},sR=e=>{var i,l,c;const t=_.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.columns;return Array.isArray(u)?u.filter(p=>typeof p=="string"):[]},[(i=e.data)==null?void 0:i.columns]),n=_.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.column_stats;return Array.isArray(u)?u:[]},[(l=e.data)==null?void 0:l.column_stats]),s=_.useMemo(()=>{var u;return Array.isArray((u=e.data)==null?void 0:u.sample_rows)?e.data.sample_rows:[]},[(c=e.data)==null?void 0:c.sample_rows]);return{previewColumns:t,previewColumnStats:n,previewSampleRows:s}},rR=({isProfileLoading:e,isPreviewLoading:t,isFetchingScaling:n,isFetchingBinning:s,isFetchingHashEncoding:i,isFetchingBinnedDistribution:l,isFetchingRecommendations:c,catalogFlags:u})=>{const{isPreviewNode:d}=u,p=_.useMemo(()=>e||t||n||s||i||l||c,[l,s,i,n,c,t,e]),h=_.useMemo(()=>e?"Generating dataset profile":n?"Loading scaling insights":s?"Loading binning insights":i?"Loading hash encoding insights":l?"Computing binned distributions":c?"Fetching column recommendations":t?d?"Loading dataset preview":"Analyzing node outputs":null,[l,s,i,c,n,t,d,e]);return{hasActiveAsyncWork:p,busyLabel:h,footerBusyLabel:h??(p?"Processing":null)}},Vu=e=>{const t=Number(e);return Number.isFinite(t)?Math.max(0,Math.round(t)):null},aR=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:i})=>{const l=_.useMemo(()=>zn(e??null),[e]),c=_.useMemo(()=>zn((t==null?void 0:t.generated_at)??null),[t==null?void 0:t.generated_at]),u=_.useMemo(()=>zn((n==null?void 0:n.generated_at)??null),[n==null?void 0:n.generated_at]),d=_.useMemo(()=>zn((s==null?void 0:s.generated_at)??null),[s==null?void 0:s.generated_at]),p=_.useMemo(()=>zn((i==null?void 0:i.generated_at)??null),[i==null?void 0:i.generated_at]),h=_.useMemo(()=>Vu((t==null?void 0:t.sample_size)??null),[t==null?void 0:t.sample_size]),f=_.useMemo(()=>Vu((n==null?void 0:n.sample_size)??null),[n==null?void 0:n.sample_size]),g=_.useMemo(()=>Vu((s==null?void 0:s.sample_size)??null),[s==null?void 0:s.sample_size]),b=_.useMemo(()=>Vu((i==null?void 0:i.sample_size)??null),[i==null?void 0:i.sample_size]);return{relativeGeneratedAt:l,relativeScalingGeneratedAt:c,relativeBinningGeneratedAt:u,relativeBinnedGeneratedAt:d,relativeOutlierGeneratedAt:p,scalingSampleSize:h,binningSampleSize:f,binnedSampleSize:g,outlierSampleSize:b}},oR=({suggestedThreshold:e,thresholdParameterName:t,configState:n,handleParameterChange:s})=>{const i=_.useMemo(()=>{if(e===null||Number.isNaN(Number(e)))return null;const d=Number(e);return Math.round(d*10)/10},[e]),l=_.useMemo(()=>{if(t===null||i===null)return!1;const d=Number(n==null?void 0:n[t]);return!Number.isNaN(d)&&d===i},[n,i,t]),c=i!==null&&!l,u=_.useCallback(()=>{i===null||!t||s(t,i)},[s,i,t]);return{normalizedSuggestedThreshold:i,thresholdMatchesSuggestion:l,canApplySuggestedThreshold:c,handleApplySuggestedThreshold:u}},iR=(e,t,n)=>{const{isFeatureMathNode:s}=e,[i,l]=_.useState(()=>new Set),c=_.useMemo(()=>s?Eb((t==null?void 0:t.operations)??[]):[],[t==null?void 0:t.operations,s]),u=_.useMemo(()=>s?iT(c,n):[],[c,n,s]);return _.useEffect(()=>{if(!s){l(()=>new Set);return}l(d=>{if(!d.size)return d;const p=new Set(c.map(f=>f.id)),h=new Set;return d.forEach(f=>{p.has(f)&&h.add(f)}),h.size===d.size?d:h})},[c,s]),{featureMathOperations:c,featureMathSummaries:u,collapsedFeatureMath:i,setCollapsedFeatureMath:l}},lR="_was_missing",cR=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const s=typeof t=="string"?t.trim():"";return s||lR},uR=(e,t)=>{const n=typeof e=="string"?e.trim():"",s=typeof t=="string"?t:"";return!n||!s?!1:n.endsWith(s)},dR=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:s})=>{const i=typeof s=="string"?s:"",l=Ke(t),c=new Set(l),u=Array.from(new Set(Ke(e))),d=[];if(u.forEach(f=>{const g=`${f}${i}`,b=n[f],w=typeof b=="number"&&Number.isFinite(b)?Math.max(0,b):null;d.push({column:f,missingPercentage:w,flagColumn:g,conflicts:{alreadyExists:c.has(g),duplicateFlag:!1}})}),d.length>0){const f=new Map;d.forEach(g=>{f.set(g.flagColumn,(f.get(g.flagColumn)??0)+1)}),d.forEach(g=>{g.conflicts.duplicateFlag=(f.get(g.flagColumn)??0)>1})}d.sort((f,g)=>{const b=f.missingPercentage,w=g.missingPercentage,y=typeof b=="number",x=typeof w=="number";return y&&x&&b!==w?w-b:y!==x?y?-1:1:f.column.localeCompare(g.column)});const p=i?Array.from(new Set(l.filter(f=>uR(f,i)))):[],h=d.reduce((f,g)=>g.conflicts.alreadyExists||g.conflicts.duplicateFlag?f+1:f,0);return{rows:d,flaggedColumnsInDataset:p,conflictCount:h}},mR=({catalogFlags:e,configState:t,node:n,availableColumns:s,columnMissingMap:i})=>{var p,h;const{isMissingIndicatorNode:l}=e,c=_.useMemo(()=>{var f,g;return l?cR(t==null?void 0:t.flag_suffix,(g=(f=n==null?void 0:n.data)==null?void 0:f.config)==null?void 0:g.flag_suffix):""},[t==null?void 0:t.flag_suffix,l,(h=(p=n==null?void 0:n.data)==null?void 0:p.config)==null?void 0:h.flag_suffix]),u=_.useMemo(()=>l?Ke(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,l]),d=_.useMemo(()=>l?dR({selectedColumns:u,availableColumns:s,columnMissingMap:i,suffix:c}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[c,s,i,l,u]);return{activeFlagSuffix:c,missingIndicatorColumns:u,missingIndicatorInsights:d}},hR=({node:e,graphContext:t,hasReachableSource:n,sourceId:s,formatRelativeTime:i,catalogFlags:l})=>{const{isDatasetProfileNode:c}=l,u=_.useMemo(()=>t?ql(t):"",[t]),d=$k({node:e,isDatasetProfileNode:c,sourceId:s,hasReachableSource:n,graphContext:t,profilingGraphSignature:u,formatRelativeTime:i}),{profileState:p}=d;return{datasetProfileController:d,profileState:p}},fR=({parameter:e,nodeId:t,configState:n,handleNumberChange:s,handleBooleanChange:i,handleTextChange:l,thresholdParameterName:c,normalizedSuggestedThreshold:u,showRecommendations:d,canApplySuggestedThreshold:p,thresholdMatchesSuggestion:h,handleApplySuggestedThreshold:f,renderMultiSelect:g})=>{var y;if(!(e!=null&&e.name))return null;if(e.type==="multi_select")return a.jsx(a.Fragment,{children:g(e)});if(e.type==="number"){const x=`node-${t}-${e.name}`,N=n==null?void 0:n[e.name],E=typeof N=="number"?N:N??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx("input",{id:x,type:"number",className:"canvas-modal__input",value:E,min:e.min!==void 0?e.min:void 0,max:e.max!==void 0?e.max:void 0,step:e.step!==void 0?e.step:"any",onChange:S=>s(e.name,S.target.value)}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),c===e.name&&u!==null&&d&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:Kn(u)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,disabled:!p,children:h?"Applied":"Apply suggestion"})]})]},e.name)}if(e.type==="boolean"){const x=`node-${t}-${e.name}`,N=!!(n!=null&&n[e.name]);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:x,children:e.label})}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:x,type:"checkbox",checked:N,onChange:E=>i(e.name,E.target.checked)}),a.jsx("span",{children:N?"Enabled":"Disabled"})]})]},e.name)}if(e.type==="select"){const x=`node-${t}-${e.name}`,N=Array.isArray(e.options)?e.options:[],E=n==null?void 0:n[e.name],S=typeof e.default=="string"?e.default:((y=N.find(C=>C&&typeof C.value=="string"))==null?void 0:y.value)??"",j=typeof E=="string"&&E.trim().length?E:S;return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("select",{id:x,className:"canvas-modal__input",value:j,onChange:C=>l(e.name,C.target.value),children:N.map(C=>a.jsx("option",{value:C.value,title:C.description??void 0,children:C.label??C.value},C.value))})]},e.name)}if(e.type==="textarea"){const x=`node-${t}-${e.name}`;if(e.name==="hyperparameters"){let E="",S=n==null?void 0:n[e.name];if(typeof S=="string"&&S.trim())try{const j=JSON.parse(S);j&&typeof j=="object"&&!Array.isArray(j)?E=Object.entries(j).map(([C,k])=>`${C}: ${JSON.stringify(k)}`).join(`
`):E=S}catch{E=S}else S&&typeof S=="object"&&!Array.isArray(S)&&(E=Object.entries(S).map(([j,C])=>`${j}: ${JSON.stringify(C)}`).join(`
`));return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description||"Enter parameters as key: value pairs (one per line)"}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:E,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:j=>{const k=j.target.value.split(`
`).filter(R=>R.trim()),O={};for(const R of k){const P=R.indexOf(":");if(P===-1)continue;const $=R.substring(0,P).trim(),A=R.substring(P+1).trim();if($)try{O[$]=JSON.parse(A)}catch{O[$]=A}}l(e.name,JSON.stringify(O,null,2))},rows:6})]},e.name)}const N=typeof(n==null?void 0:n[e.name])=="string"?n==null?void 0:n[e.name]:"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:N,placeholder:e.placeholder??"",onChange:E=>l(e.name,E.target.value),rows:4})]},e.name)}const b=`node-${t}-${e.name}`,w=(n==null?void 0:n[e.name])??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:b,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("input",{id:b,type:"text",className:"canvas-modal__input canvas-modal__input--wide",value:w,placeholder:e.placeholder??"",onChange:x=>l(e.name,x.target.value)})]},e.name)},pR=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:s,recommendations:i,filteredRecommendations:l,isFetchingRecommendations:c,recommendationsError:u,relativeGeneratedAt:d,formatSignalName:p,formatMissingPercentage:h,getPriorityClass:f,getPriorityLabel:g,handleToggleColumn:b,selectedColumns:w})=>{const y=x=>{if(!(x!=null&&x.name))return null;const N=String(x.name),E=w.includes(N),S=f(x.priority),j=g(x.priority),C=Array.isArray(x==null?void 0:x.signals)?x.signals.map(k=>p(k)).filter(k=>!!k):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:E,onChange:()=>b(N)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:N}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[x.missing_percentage!==void 0&&x.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${h(x.missing_percentage)}`}),S&&j&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${S}`,children:j})]}),C.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:C.map(k=>a.jsx("span",{className:"canvas-modal__signal-badge",children:k},`${N}-${k}`))}),x.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:x.reason})]})]},N)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>s(null),children:["All reasons (",i.length,")"]}),t.map(x=>{const N=n===x.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${N?" canvas-modal__filter-button--active":""}`,onClick:()=>s(E=>E===x.id?null:x.id),title:x.description??void 0,children:[x.label," (",x.count,")"]},x.id)})]}),c&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!c&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!c&&!u&&a.jsxs(a.Fragment,{children:[d&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",d,"."]}),l.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:l.map(x=>y(x))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},gR=({parameter:e,previewStateStatus:t,isBinningNode:n,isScalingNode:s,binningAllNumericColumns:i,binningRecommendedColumnSet:l,selectedColumns:c,availableColumns:u,scalingExcludedColumns:d,normalizedColumnSearch:p,filteredColumnOptions:h,binningExcludedColumns:f,selectionCount:g,isCastNode:b,columnSuggestions:w,sourceId:y,isFetchingRecommendations:x,hasReachableSource:N,refreshRecommendations:E,availableFilters:S,activeFilterId:j,setActiveFilterId:C,recommendations:k,filteredRecommendations:O,recommendationsError:R,relativeGeneratedAt:P,formatSignalName:$,handleToggleColumn:A,handleRemoveColumn:D,handleApplyAllRecommended:V,handleBinningApplyColumns:z,handleSelectAllColumns:F,handleClearColumns:q,columnSearch:G,setColumnSearch:W,columnMissingMap:X,columnTypeMap:I,binningColumnPreviewMap:L,isImputerNode:U,showRecommendations:te})=>{var Ue;const K=((Ue=e==null?void 0:e.source)==null?void 0:Ue.type)==="drop_column_recommendations",H=!K,Y=H&&t==="loading",Q=n&&e.name==="columns",ne=s&&e.name==="columns",J=(()=>{if(!Q)return[];const ce=[...i];return l.size>0&&l.forEach(Oe=>{ce.includes(Oe)||ce.push(Oe)}),c.forEach(Oe=>{Oe&&!ce.includes(Oe)&&ce.push(Oe)}),ce})(),re=Q?J:ne?u.filter(ce=>!d.has(ce)):u,Se=Q?p?J.filter(ce=>ce.toLowerCase().includes(p)):J:ne?h.filter(ce=>!d.has(ce)):h,ze=Q?c.filter(ce=>!f.has(ce)).length:ne?c.filter(ce=>!d.has(ce)).length:g,$e=H&&re.length>0&&ze>=re.length,Be=K||U,it=new Set(re),He=b&&H?Object.entries(w).filter(([ce,Oe])=>it.has(ce)&&Oe.length>0).map(([ce,Oe])=>`${ce}: ${Oe.join(", ")}`).slice(0,4):[],de=Q?Array.from(f).slice(0,4):[],ge=ne?Array.from(d).slice(0,4):[],Ne=Q&&l.size>0,Me=Ne?Array.from(l).some(ce=>!c.includes(ce)):!1;return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),K&&y&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:E,disabled:x||!N,children:x?"Refreshing":"Refresh suggestions"})})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),He.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",He.join("; ")]}),Q&&f.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",f.size," non-numeric column",f.size===1?"":"s",de.length?` (examples: ${de.join(", ")}${f.size>de.length?", ":""})`:""," binning only supports numeric inputs."]}),ne&&d.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",d.size," non-numeric column",d.size===1?"":"s",ge.length?` (examples: ${ge.join(", ")}${d.size>ge.length?", ":""})`:""," scaling only supports numeric inputs."]}),K&&a.jsx(pR,{sourceId:y,availableFilters:S,activeFilterId:j,setActiveFilterId:C,recommendations:k,filteredRecommendations:O,isFetchingRecommendations:x,recommendationsError:R,relativeGeneratedAt:P,formatSignalName:$,formatMissingPercentage:Kn,getPriorityClass:Dk,getPriorityLabel:Fk,handleToggleColumn:A,selectedColumns:c}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:ze})]}),ze>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:c.map(ce=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[ce,a.jsx("button",{type:"button",onClick:()=>D(ce),"aria-label":`Remove ${ce}`,children:""})]},ce))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[K&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:V,disabled:!k.length,children:"Use all recommendations"}),Ne&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>z(l),disabled:!Me,children:"Add recommended columns"}),H&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:F,disabled:!re.length||$e,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:q,disabled:!g,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:G,onChange:ce=>W(ce.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:Se.length?Se.map(ce=>{const Oe=c.includes(ce),Ge=Object.prototype.hasOwnProperty.call(X,ce)?X[ce]:void 0,ut=Kn(typeof Ge=="number"?Ge:null),rt=I[ce]??null,vt=w[ce]??[],at=Q?L[ce]:void 0,ct=!!(at&&(at.min!==null&&at.min!==void 0||at.max!==null&&at.max!==void 0)),$t=Q?(at==null?void 0:at.distinct)??null:null,Dt=Q&&$t!==null&&Number.isFinite($t),Qe=Dt?$t:null,Ut=!Q,Yt=Ut||Be||ct||Dt,Mt=Ut&&vt.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${Oe?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:Oe,onChange:()=>A(ce)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:ce}),Yt&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Ut&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",ZT(rt)]}),Be&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",ut]}),ct&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[Q?"Sample range":"Range",":"," ",at&&at.min!==null&&at.min!==void 0?xs(at.min):""," ",""," ",at&&at.max!==null&&at.max!==void 0?xs(at.max):""]}),Dt&&Qe!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",Is(Qe)]})]}),Mt&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",vt.join(", ")]})]})]},ce)}):a.jsx("p",{className:"canvas-modal__note",children:u.length?Q&&re.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":Y?"Loading column catalog":y?N?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},e.name)},_R=({setConfigState:e,imputationMethodValues:t,imputationMethodOptions:n,imputerStrategyCount:s,setCollapsedStrategies:i,setImputerMissingFilter:l})=>{const c=_.useCallback(y=>{e(x=>{const N=Ey(x==null?void 0:x.strategies,t),E=y(N).map(S=>({...S,options:Pl(S.method,S.options)}));return{...x,strategies:uM(E)}})},[t,e]),u=_.useCallback(()=>{var N;const y=s,x=((N=n[0])==null?void 0:N.value)??"mean";c(E=>[...E,{method:x,columns:[],options:Pl(x,Sy(x))}]),i(E=>{const S=new Set(E);return S.delete(y),S})},[n,s,c,i]),d=_.useCallback(y=>{c(x=>x.filter((N,E)=>E!==y)),i(x=>{const N=new Set;return x.forEach(E=>{E!==y&&N.add(E>y?E-1:E)}),N})},[c,i]),p=_.useCallback(y=>{i(x=>{const N=new Set(x);return N.has(y)?N.delete(y):N.add(y),N})},[i]),h=_.useCallback((y,x)=>{c(N=>N.map((E,S)=>S===y?{...E,method:x,options:Pl(x,E.options)}:E))},[c]),f=_.useCallback((y,x,N)=>{c(E=>E.map((S,j)=>{if(j!==y)return S;const C={...S.options??{}};if(N==="")delete C[x];else{const k=Number(N);if(!Number.isFinite(k))return S;C[x]=k}return{...S,options:Pl(S.method,C)}}))},[c]),g=_.useCallback((y,x)=>{const N=x.split(",").map(E=>E.trim()).filter(Boolean);c(E=>E.map((S,j)=>j===y?{...S,columns:N}:S))},[c]),b=_.useCallback((y,x)=>{const N=x.trim();N&&c(E=>E.map((S,j)=>{if(j!==y)return S;const k=S.columns.includes(N)?S.columns.filter(O=>O!==N):[...S.columns,N];return k.sort((O,R)=>O.localeCompare(R)),{...S,columns:k}}))},[c]),w=_.useCallback(y=>{l(y)},[l]);return{updateImputerStrategies:c,handleAddImputerStrategy:u,handleRemoveImputerStrategy:d,toggleImputerStrategySection:p,handleImputerMethodChange:h,handleImputerOptionNumberChange:f,handleImputerColumnsChange:g,handleImputerColumnToggle:b,handleImputerMissingFilterChange:w}},vR=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,aliasColumnSummary:i,aliasStrategyCount:l})=>{var y;const{isReplaceAliasesNode:c}=e,u=_.useCallback(x=>{c&&n(N=>{var D,V,z,F,q,G,W,X,I;if(!c)return N;const E=Ke((N==null?void 0:N.columns)??((V=(D=t==null?void 0:t.data)==null?void 0:D.config)==null?void 0:V.columns)),S=Su(N==null?void 0:N.mode,(F=(z=t==null?void 0:t.data)==null?void 0:z.config)==null?void 0:F.mode),j=(()=>{var te;const L=Ei(N);if(L!==void 0){const K=xo(L);if(K!==null)return K}const U=Ei((te=t==null?void 0:t.data)==null?void 0:te.config);if(U!==void 0){const K=xo(U);if(K!==null)return K}return E.length===0})(),C=(N==null?void 0:N.alias_strategies)??(N==null?void 0:N.strategies)??((G=(q=t==null?void 0:t.data)==null?void 0:q.config)==null?void 0:G.alias_strategies)??((X=(W=t==null?void 0:t.data)==null?void 0:W.config)==null?void 0:X.strategies),k=Py(C,{mode:S,columns:E,autoDetect:j}),O=x(k).map(L=>({mode:Su(L.mode,S),columns:Array.from(new Set(L.columns.map(U=>U.trim()).filter(Boolean))).sort((U,te)=>U.localeCompare(te)),autoDetect:!!L.autoDetect})),R=OM(O),P=Array.from(new Set(O.flatMap(L=>L.columns))).sort((L,U)=>L.localeCompare(U)),$=((I=O[0])==null?void 0:I.mode)??S,A=O.length?O.some(L=>L.autoDetect):j;return{...N,alias_strategies:R,columns:P,mode:$,auto_detect:A}})},[c,(y=t==null?void 0:t.data)==null?void 0:y.config,n]),d=_.useCallback(()=>{if(!c)return;const x=l;u(N=>{var k;const E=new Set;N.forEach(O=>{O.columns.forEach(R=>{const P=R.trim();P&&E.add(P)})});const S=i.recommendedColumns.find(O=>!E.has(O)),C={mode:N.length?N[N.length-1].mode:((k=Ty[0])==null?void 0:k.value)??yh,columns:S?[S]:[],autoDetect:!S};return[...N,C]}),s(N=>{const E=new Set(N);return E.delete(x),E})},[i.recommendedColumns,l,c,s,u]),p=_.useCallback(x=>{u(N=>N.filter((E,S)=>S!==x)),s(N=>{const E=new Set;return N.forEach(S=>{S!==x&&E.add(S>x?S-1:S)}),E})},[s,u]),h=_.useCallback(x=>{s(N=>{const E=new Set(N);return E.has(x)?E.delete(x):E.add(x),E})},[s]),f=_.useCallback((x,N)=>{u(E=>E.map((S,j)=>j===x?{...S,mode:N}:S))},[u]),g=_.useCallback((x,N)=>{const E=N.trim();E&&u(S=>S.map((j,C)=>{if(C!==x)return j;const O=j.columns.includes(E)?j.columns.filter(R=>R!==E):[...j.columns,E];return O.sort((R,P)=>R.localeCompare(P)),{...j,columns:O}}))},[u]),b=_.useCallback((x,N)=>{const E=N.split(",").map(j=>j.trim()).filter(Boolean),S=Array.from(new Set(E)).sort((j,C)=>j.localeCompare(C));u(j=>j.map((C,k)=>k===x?{...C,columns:S}:C))},[u]),w=_.useCallback((x,N)=>{u(E=>E.map((S,j)=>j===x?{...S,autoDetect:N}:S))},[u]);return{updateAliasStrategies:u,handleAddAliasStrategy:d,handleRemoveAliasStrategy:p,toggleAliasStrategySection:h,handleAliasModeChange:f,handleAliasColumnToggle:g,handleAliasColumnsChange:b,handleAliasAutoDetectToggle:w}},yR=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,dateStrategies:i,standardizeDatesColumnSummary:l,standardizeDatesMode:c})=>{var x,N,E,S,j,C;const{isStandardizeDatesNode:u}=e,d=_.useCallback(k=>{n(O=>{var q,G,W,X,I,L,U;if(!u)return O;const R=Ke((O==null?void 0:O.columns)??((G=(q=t==null?void 0:t.data)==null?void 0:q.config)==null?void 0:G.columns)),P=Vy(O==null?void 0:O.mode,(X=(W=t==null?void 0:t.data)==null?void 0:W.config)==null?void 0:X.mode),$=R.length===0,A=Wy((O==null?void 0:O.format_strategies)??((L=(I=t==null?void 0:t.data)==null?void 0:I.config)==null?void 0:L.format_strategies),{columns:R,mode:P,autoDetect:$}),D=k(A),V=rA(D),z=Array.from(new Set(D.flatMap(te=>te.columns.map(K=>K.trim()).filter(Boolean)))).sort((te,K)=>te.localeCompare(K)),F=((U=D[0])==null?void 0:U.mode)??P;return{...O,format_strategies:V,columns:z,mode:F}})},[u,(N=(x=t==null?void 0:t.data)==null?void 0:x.config)==null?void 0:N.columns,(S=(E=t==null?void 0:t.data)==null?void 0:E.config)==null?void 0:S.format_strategies,(C=(j=t==null?void 0:t.data)==null?void 0:j.config)==null?void 0:C.mode,n]),p=_.useCallback(()=>{const k=i.length;d(O=>{var D;const R=new Set;O.forEach(V=>{V.columns.forEach(z=>{const F=z.trim();F&&R.add(F)})});const P=l.recommendedColumns.find(V=>!R.has(V)),A={mode:O.length?O[O.length-1].mode:((D=Nh[0])==null?void 0:D.value)??c,columns:P?[P]:[],autoDetect:!P};return[...O,A]}),s(O=>{const R=new Set(O);return R.delete(k),R})},[i.length,s,l.recommendedColumns,c,d]),h=_.useCallback(k=>{d(O=>O.filter((R,P)=>P!==k)),s(O=>{const R=new Set;return O.forEach(P=>{P!==k&&R.add(P>k?P-1:P)}),R})},[s,d]),f=_.useCallback(k=>{s(O=>{const R=new Set(O);return R.has(k)?R.delete(k):R.add(k),R})},[s]),g=_.useCallback((k,O)=>{d(R=>R.map((P,$)=>$===k?{...P,mode:O}:P))},[d]),b=_.useCallback((k,O)=>{const R=O.split(",").map(P=>P.trim()).filter(Boolean).sort((P,$)=>P.localeCompare($));d(P=>P.map(($,A)=>A===k?{...$,columns:R}:$))},[d]),w=_.useCallback((k,O)=>{const R=O.trim();R&&d(P=>P.map(($,A)=>{if(A!==k)return $;const V=$.columns.includes(R)?$.columns.filter(z=>z!==R):[...$.columns,R];return V.sort((z,F)=>z.localeCompare(F)),{...$,columns:V}}))},[d]),y=_.useCallback((k,O)=>{d(R=>R.map((P,$)=>$===k?{...P,autoDetect:O}:P))},[d]);return{updateDateStrategies:d,handleAddDateStrategy:p,handleRemoveDateStrategy:h,toggleDateStrategySection:f,handleDateStrategyModeChange:g,handleDateStrategyColumnsChange:b,handleDateStrategyColumnToggle:w,handleDateStrategyAutoDetectToggle:y}},bR=new Set(Tu.map(e=>e.value)),Yl=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),jx=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),Cx=e=>{const n=Yl(e).filter(s=>bR.has(s));return n.length?n:["year","month","day"]},Gl=e=>e==null?null:Number.isFinite(e)?e:null,Sx=e=>{const t=Gl(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},Ex=e=>typeof e!="string"?"UTC":e.trim()||"UTC",xR=({catalogFlags:e,setConfigState:t,setCollapsedFeatureMath:n})=>{const{isFeatureMathNode:s}=e,i=_.useCallback(f=>{t(g=>{if(!s)return g;const b=g&&typeof g=="object"&&!Array.isArray(g)?{...g}:{},w=Eb(Array.isArray(g==null?void 0:g.operations)?g.operations:[]),y=f(w);return b.operations=aT(y),b})},[s,t]),l=_.useCallback(f=>{if(!s)return;let g="";i(b=>{const w=new Set(b.map(x=>x.id)),y=kb(f,w);return g=y.id,[...b,y]}),g&&n(b=>{const w=new Set(b);return w.delete(g),w})},[s,n,i]),c=_.useCallback(f=>{if(!s)return;let g="";i(b=>{const w=b.findIndex(j=>j.id===f);if(w===-1)return b;const y=b[w],x=new Set(b.map(j=>j.id)),N=kb(y.type,x);g=N.id;const E={...y,id:N.id,inputColumns:[...y.inputColumns],secondaryColumns:[...y.secondaryColumns],constants:[...y.constants],datetimeFeatures:[...y.datetimeFeatures],outputColumn:y.outputColumn?`${y.outputColumn}_copy`:""},S=[...b];return S.splice(w+1,0,E),S}),g&&n(b=>{const w=new Set(b);return w.delete(g),w})},[s,n,i]),u=_.useCallback(f=>{s&&(i(g=>g.filter(b=>b.id!==f)),n(g=>{const b=new Set(g);return b.delete(f),b}))},[s,n,i]),d=_.useCallback((f,g)=>{s&&i(b=>{const w=b.findIndex(E=>E.id===f);if(w===-1)return b;const y=g==="up"?w-1:w+1;if(y<0||y>=b.length)return b;const x=[...b],[N]=x.splice(w,1);return x.splice(y,0,N),x})},[s,i]),p=_.useCallback(f=>{n(g=>{const b=new Set(g);return b.has(f)?b.delete(f):b.add(f),b})},[n]),h=_.useCallback((f,g)=>{s&&i(b=>b.map(w=>{if(w.id!==f)return w;let y={...w};if(g.type&&(y.type=g.type),g.method!==void 0&&(y.method=g.method),g.inputColumns!==void 0&&(y.inputColumns=Yl(g.inputColumns)),g.secondaryColumns!==void 0&&(y.secondaryColumns=Yl(g.secondaryColumns)),g.constants!==void 0&&(y.constants=jx(g.constants)),g.outputColumn!==void 0&&(y.outputColumn=g.outputColumn.trim()),g.outputPrefix!==void 0&&(y.outputPrefix=g.outputPrefix.trim()),g.datetimeFeatures!==void 0&&(y.datetimeFeatures=Cx(g.datetimeFeatures)),g.timezone!==void 0&&(y.timezone=Ex(g.timezone)),g.fillna!==void 0&&(y.fillna=Gl(g.fillna)),g.roundDigits!==void 0&&(y.roundDigits=Sx(g.roundDigits)),g.normalize!==void 0&&(y.normalize=g.normalize),g.epsilon!==void 0&&(y.epsilon=Gl(g.epsilon)),g.allowOverwrite!==void 0&&(y.allowOverwrite=g.allowOverwrite),g.description!==void 0){const E=typeof g.description=="string"?g.description.trim():"";y.description=E||void 0}const x=y.type,N=Mb(x);return N.length?new Set(N.map(S=>S.value)).has(y.method)||(y.method=N[0].value):x==="ratio"?y.method="ratio":x==="datetime_extract"&&(y.method="datetime_extract"),y.inputColumns=Yl(y.inputColumns),x==="ratio"||x==="similarity"?y.secondaryColumns=Yl(y.secondaryColumns):y.secondaryColumns=[],y.constants=jx(y.constants),y.fillna=Gl(y.fillna),y.roundDigits=Sx(y.roundDigits),y.epsilon=Gl(y.epsilon),x==="datetime_extract"?(y.datetimeFeatures=Cx(y.datetimeFeatures),y.timezone=Ex(y.timezone)):(y.datetimeFeatures=[],y.timezone="UTC"),x!=="similarity"?y.normalize=!1:y.normalize=!!y.normalize,typeof y.allowOverwrite!="boolean"&&(y.allowOverwrite=null),y.outputColumn=y.outputColumn.trim(),y.outputPrefix=y.outputPrefix.trim(),y}))},[s,i]);return{updateFeatureMathOperations:i,handleAddFeatureMathOperation:l,handleDuplicateFeatureMathOperation:c,handleRemoveFeatureMathOperation:u,handleReorderFeatureMathOperation:d,handleToggleFeatureMathOperation:p,handleFeatureMathOperationChange:h}},wR=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:s,sourceId:i,graphSnapshot:l,onResetConfig:c,defaultConfigTemplate:u,isResetAvailable:d=!1})=>{var Ua,xc,Gi,qa,Go;const{metadata:p,title:h}=L$(e),{connectionInfo:f,connectedHandleKeys:g,connectedOutputHandleKeys:b,evaluationSplitConnectivity:w,connectionReady:y,gatedSectionStyle:x,gatedAriaDisabled:N}=D$(e,l??null),E=i$(e),{catalogType:S,isDataset:j,isImputerNode:C,isMissingIndicatorNode:k,isReplaceAliasesNode:O,isTrimWhitespaceNode:R,isRemoveSpecialCharsNode:P,isReplaceInvalidValuesNode:$,isRegexCleanupNode:A,isNormalizeTextCaseNode:D,isStandardizeDatesNode:V,isLabelEncodingNode:z,isTargetEncodingNode:F,isHashEncodingNode:q,isFeatureTargetSplitNode:G,isTrainTestSplitNode:W,isTrainModelDraftNode:X,isModelEvaluationNode:I,isModelRegistryNode:L,isHyperparameterTuningNode:U,isClassUndersamplingNode:te,isClassOversamplingNode:K,isOrdinalEncodingNode:H,isDummyEncodingNode:Y,isOneHotEncodingNode:Q,isFeatureMathNode:ne,isCastNode:J,isBinningNode:re,isScalingNode:Se,isPolynomialFeaturesNode:ze,isFeatureSelectionNode:$e,isTransformerAuditNode:Be,isOutlierNode:it,isSkewnessNode:He,isSkewnessDistributionNode:de,isBinnedDistributionNode:ge,isDataConsistencyNode:Ne,isInspectionNode:Me,isRemoveDuplicatesNode:Ue,isDropMissingColumnsNode:ce,isDropMissingRowsNode:Oe,isDropMissingNode:Ge,isPreviewNode:ut,isDatasetProfileNode:rt}=E,vt=j,at=te||K,ct=_.useMemo(()=>rM,[]),$t=_.useMemo(()=>ct.map(St=>St.value),[ct]),{parameters:Dt,getParameter:Qe,requiresColumnCatalog:Ut,dropColumnParameter:Yt}=ZP(e),Mt=_.useMemo(()=>N$[S]??null,[S]),yt=typeof(e==null?void 0:e.id)=="string"?e.id:"",{canResetNode:jn,headerCanResetNode:Rt,footerCanResetNode:tn}=tR({isResetAvailable:d,defaultConfigTemplate:u,catalogFlags:E}),fe=eR(Qe,E),qt=F$(Dt,E),dt=_.useMemo(()=>Ne?qt:[],[qt,Ne]),{configState:Ye,setConfigState:bt,stableInitialConfig:dn,stableCurrentConfig:ft,nodeChangeVersion:Cs}=I$({node:e}),{handleParameterChange:Gt,handleNumberChange:pt,handleBooleanChange:Nt,handleTextChange:Yn}=B$({setConfigState:bt}),mn=_.useMemo(()=>L?Ye?{...Ye}:{}:null,[Ye,L]),rn=_.useMemo(()=>Ey(Ye==null?void 0:Ye.strategies,$t),[Ye==null?void 0:Ye.strategies,$t]),hn=rn.length,Cn=_.useMemo(()=>vh(ky(Ye==null?void 0:Ye.transformations)),[Ye==null?void 0:Ye.transformations]),{graphContext:At,graphNodes:Gn,graphNodeCount:Ht,upstreamNodeIds:fn,upstreamTargetColumn:Sn,hasReachableSource:Ve}=IP({graphSnapshot:l??null,nodeId:yt,catalogFlags:E}),{featureTargetSplitConfig:tr,trainTestSplitConfig:Qn,resamplingConfig:as,trainModelDraftConfig:Fn,trainModelRuntimeConfig:os,trainModelCVConfig:Ss,filteredModelTypeOptions:In}=b$({configState:Ye,setConfigState:bt,catalogFlags:E,upstreamTargetColumn:Sn,nodeId:yt,modelTypeOptions:((Ua=fe.trainModel.modelType)==null?void 0:Ua.options)??null}),nr=_.useMemo(()=>{if(!fn.length)return{};const St={};return fn.forEach(As=>{var Qo;const Ha=Gn.find(Va=>Va&&typeof Va.id=="string"&&Va.id===As);if(!Ha)return;const wc=((Qo=Ha==null?void 0:Ha.data)==null?void 0:Qo.config)??null;St[As]=wc}),St},[Gn,fn]),Qt=_.useMemo(()=>ql({sourceId:i??null,nodeId:yt||null,config:Ye,upstreamIds:fn,upstreamConfig:nr}),[Ye,yt,i,nr,fn]),[Xe,Bt]=_.useState(null),{cachedSchemaColumns:Bn,oversamplingSchemaGuard:qs,imputationSchemaDiagnostics:is,skipPreview:gr}=nR({cachedPreviewSchema:Xe,catalogFlags:E,resamplingTargetColumn:(as==null?void 0:as.targetColumn)??null,imputerStrategies:rn}),{availableColumns:ie,setAvailableColumns:ve,columnSearch:Pe,setColumnSearch:jt,columnMissingMap:we,setColumnMissingMap:nt,columnTypeMap:tt,setColumnTypeMap:Ft,columnSuggestions:Ot,setColumnSuggestions:nn,imputerMissingFilter:Vt,setImputerMissingFilter:pn}=VP({requiresColumnCatalog:Ut,catalogFlags:E,nodeId:yt,sourceId:i,hasReachableSource:Ve}),Es=!!Yt,{hasDropColumnSource:Xn,availableFilters:yn,activeFilterId:En,setActiveFilterId:Jn,recommendations:$n,filteredRecommendations:Jr,formatSignalName:$a,isFetchingRecommendations:gt,recommendationsError:zo,recommendationsGeneratedAt:Do,suggestedThreshold:Fo,refreshRecommendations:Io}=_k({hasDropColumnSource:Es,sourceId:i,nodeId:yt,graphContext:At,hasReachableSource:Ve,columnTypeMap:tt,setAvailableColumns:ve,setColumnSearch:jt,setColumnMissingMap:nt,setColumnTypeMap:Ft,setColumnSuggestions:nn});h$({catalogFlags:E,sourceId:i,hasReachableSource:Ve,graphContext:At,targetNodeId:(e==null?void 0:e.id)??null,setAvailableColumns:ve,setColumnMissingMap:nt});const{labelEncoding:Or,targetEncoding:_r,hashEncoding:Hs,ordinalEncoding:Vs,dummyEncoding:Zn,oneHotEncoding:Z}=hP({catalogFlags:E,sourceId:i,hasReachableSource:Ve,graphContext:At,node:e,configState:Ye,setConfigState:bt,nodeChangeVersion:Cs}),[pe,me]=_.useState("500"),[ke,je]=_.useState(()=>new Set);_.useEffect(()=>{je(new Set)},[dn]);const{datasetProfileController:be,profileState:st}=hR({node:e,graphContext:At,hasReachableSource:Ve,sourceId:i,formatRelativeTime:zn,catalogFlags:E}),{previewState:Ae,refreshPreview:mt,clearCachedPreviewSchema:ot,canTriggerPreview:Je}=qP({graphSnapshot:l??null,graphNodeCount:Ht,hasReachableSource:Ve,sourceId:i,node:e,nodeId:yt,previewSignature:Qt,skipPreview:gr,cachedPreviewSchema:Xe,setCachedPreviewSchema:Bt,catalogFlags:E}),{featureMathSignals:Ct,polynomialSignal:Pn,featureSelectionSignal:Wt,outlierPreviewSignal:kn,transformerAuditSignal:ks}=YP({previewState:Ae,nodeId:yt,catalogFlags:E});GP({catalogFlags:E,featureSelectionSignal:Wt,upstreamTargetColumn:Sn,setConfigState:bt});const{featureMathOperations:Ms,featureMathSummaries:Ws,collapsedFeatureMath:Tr,setCollapsedFeatureMath:sr}=iR(E,Ye,Ct),{outlierData:Un,outlierError:ps,isFetchingOutliers:Pa,refreshOutliers:gs}=f$({catalogFlags:E,sourceId:i,hasReachableSource:Ve,graphContext:At,targetNodeId:yt||null}),{scalingData:Zr,scalingError:ea,isFetchingScaling:ta,refreshScaling:na}=l$({catalogFlags:E,sourceId:i,hasReachableSource:Ve,graphContext:At,targetNodeId:(e==null?void 0:e.id)??null}),{binningData:sa,binningError:Ra,isFetchingBinning:Mn,refreshBinning:Jt}=c$({catalogFlags:E,sourceId:i,hasReachableSource:Ve,graphContext:At,targetNodeId:(e==null?void 0:e.id)??null}),Ks=_.useCallback(()=>{ot(),mt(),Se&&na(),re&&Jt(),it&&gs()},[re,it,Se,Jt,gs,ot,mt,na]),{binnedDistributionData:$r,binnedDistributionError:sc,isFetchingBinnedDistribution:La,refreshBinnedDistribution:Zt}=d$({catalogFlags:E,sourceId:i,hasReachableSource:Ve,graphContext:At,targetNodeId:(e==null?void 0:e.id)??null,samplePreset:pe}),{skewnessData:An,skewnessError:es,isFetchingSkewness:Bo,refreshSkewness:af}=u$({catalogFlags:E,sourceId:i,graphContext:At,targetNodeId:(e==null?void 0:e.id)??null,transformations:Cn}),{previewColumns:rc,previewColumnStats:of,previewSampleRows:za}=sR(Ae),{activeFlagSuffix:ac,missingIndicatorInsights:lf}=mR({catalogFlags:E,configState:Ye,node:e,availableColumns:ie,columnMissingMap:we}),cf=!!i&&Ve,uf=_.useMemo(()=>{var St;return Ke((St=e==null?void 0:e.data)==null?void 0:St.columns)},[(xc=e==null?void 0:e.data)==null?void 0:xc.columns]),{alias:ra,trimWhitespace:Ui,removeSpecial:oc,regexCleanup:Uo,normalizeCase:qi,replaceInvalid:Da,standardizeDates:vr}=FP({catalogFlags:E,configState:Ye,nodeConfig:((Gi=e==null?void 0:e.data)==null?void 0:Gi.config)??null,availableColumns:ie,columnTypeMap:tt,previewSampleRows:za}),{numericExcludedColumns:Xu}=v$({catalogFlags:E,availableColumns:ie,columnTypeMap:tt,previewSampleRows:za}),{scaling:gn,outlier:an,binning:ht,selectedColumns:Ys}=kP({catalogFlags:E,configState:Ye,setConfigState:bt,nodeId:yt,numericExcludedColumns:Xu,scalingData:Zr,outlierData:Un,binningData:sa,availableColumns:ie,previewSampleRows:za});WP({previewState:Ae,previewSampleRows:za,activeFlagSuffix:ac??"",setColumnTypeMap:Ft,setColumnSuggestions:nn}),KP({previewState:Ae,activeFlagSuffix:ac??"",hasReachableSource:Ve,requiresColumnCatalog:Ut,nodeColumns:uf,selectedColumns:Ys,setAvailableColumns:ve,setColumnMissingMap:nt});const df=`${yt||"node"}-remove-duplicates-keep`,mf=_.useMemo(()=>{const St=typeof(Ye==null?void 0:Ye.keep)=="string"?Ye.keep.trim().toLowerCase():"";return St==="last"||St==="none"?St:yk},[Ye==null?void 0:Ye.keep]),qo=_.useMemo(()=>Pe.trim().toLowerCase(),[Pe]),Ju=_.useMemo(()=>qo?ie.filter(St=>St.toLowerCase().includes(qo)):ie,[ie,qo]),hf=_.useCallback(St=>{bt(As=>{const Ha=vh(ky(As==null?void 0:As.transformations)),wc=vh(St(Ha));return{...As,transformations:wc.map(Qo=>({...Qo}))}})},[]),_n=w$({catalogFlags:E,skewnessData:An,skewnessTransformations:Cn,availableColumns:ie,previewColumns:rc,columnTypeMap:tt,updateSkewnessTransformations:hf}),{imputerColumnOptions:ic,imputerMissingSliderMax:Ho,imputerFilteredOptionCount:ff,imputerMissingFilterActive:Zu}=y$({catalogFlags:E,imputerStrategies:rn,availableColumns:ie,columnMissingMap:we,previewColumns:rc,previewColumnStats:of,nodeColumns:(qa=e==null?void 0:e.data)==null?void 0:qa.columns,imputerMissingFilter:Vt}),Hi=((Go=fe.dropMissing.threshold)==null?void 0:Go.name)??null,{normalizedSuggestedThreshold:lc,thresholdMatchesSuggestion:cc,canApplySuggestedThreshold:uc,handleApplySuggestedThreshold:aa}=oR({suggestedThreshold:Fo,thresholdParameterName:Hi,configState:Ye,handleParameterChange:Gt}),pf=Oe&&!!(fe.dropMissing.threshold||fe.dropRows.any),{handleToggleColumn:Pr,handleApplyAllRecommended:ed,handleSelectAllColumns:dc,handleClearColumns:mc,handleRemoveColumn:Fa}=QP({catalogFlags:E,setConfigState:bt,binningExcludedColumns:ht.state.excludedColumns,scalingExcludedColumns:gn.state.excludedColumns,availableColumns:ie,recommendations:$n}),{handleSave:oa,handleResetNode:td}=XP({configState:Ye,catalogFlags:E,nodeId:yt,onUpdateConfig:n,onClose:t,sourceId:i,graphSnapshot:l??null,onUpdateNodeData:s,setConfigState:bt,canResetNode:jn,defaultConfigTemplate:u,onResetConfig:c}),Vo=Ys.length,{relativeGeneratedAt:nd,relativeScalingGeneratedAt:sd,relativeBinningGeneratedAt:hc,relativeBinnedGeneratedAt:fc,relativeOutlierGeneratedAt:rd,scalingSampleSize:ad,binningSampleSize:od,binnedSampleSize:gf,outlierSampleSize:_f}=aR({recommendationsGeneratedAt:Do,scalingData:Zr,binningData:sa,binnedDistributionData:$r,outlierData:Un}),Vi=Xn&&!!i&&Ve,id=!vt&&!Me,vf=id&&dn!==ft,Gs=st.status==="loading",Wo=Ae.status==="loading",{hasActiveAsyncWork:ld,footerBusyLabel:cd}=rR({isProfileLoading:Gs,isPreviewLoading:Wo,isFetchingScaling:ta,isFetchingBinning:Mn,isFetchingHashEncoding:Hs.isFetching,isFetchingBinnedDistribution:La,isFetchingRecommendations:gt,catalogFlags:E}),{handleAddImputerStrategy:ud,handleRemoveImputerStrategy:dd,toggleImputerStrategySection:pc,handleImputerMethodChange:yf,handleImputerOptionNumberChange:bf,handleImputerColumnsChange:Ia,handleImputerColumnToggle:gc,handleImputerMissingFilterChange:Ko}=_R({setConfigState:bt,imputationMethodValues:$t,imputationMethodOptions:ct,imputerStrategyCount:hn,setCollapsedStrategies:je,setImputerMissingFilter:pn}),{handleAddAliasStrategy:_c,handleRemoveAliasStrategy:md,toggleAliasStrategySection:Wi,handleAliasModeChange:Ba,handleAliasColumnToggle:vc,handleAliasColumnsChange:hd,handleAliasAutoDetectToggle:Ki}=vR({catalogFlags:E,node:e,setConfigState:bt,setCollapsedStrategies:je,aliasColumnSummary:ra.columnSummary,aliasStrategyCount:ra.strategyCount}),{handleAddDateStrategy:fd,handleRemoveDateStrategy:pd,toggleDateStrategySection:gd,handleDateStrategyModeChange:_d,handleDateStrategyColumnsChange:vd,handleDateStrategyColumnToggle:yd,handleDateStrategyAutoDetectToggle:Rr}=yR({catalogFlags:E,node:e,setConfigState:bt,setCollapsedStrategies:je,dateStrategies:vr.strategies,standardizeDatesColumnSummary:vr.columnSummary,standardizeDatesMode:vr.mode}),{handleAddFeatureMathOperation:yc,handleDuplicateFeatureMathOperation:bc,handleRemoveFeatureMathOperation:xf,handleReorderFeatureMathOperation:wf,handleToggleFeatureMathOperation:Yo,handleFeatureMathOperationChange:Nf}=xR({catalogFlags:E,setConfigState:bt,setCollapsedFeatureMath:sr}),bd=_.useCallback(()=>{i&&Zt()},[Zt,i]),xd=m$({catalogFlags:E,binnedDistributionData:$r}),kt=_.useCallback(St=>a.jsx(gR,{parameter:St,previewStateStatus:Ae.status,isBinningNode:re,isScalingNode:Se,binningAllNumericColumns:ht.state.allNumericColumns,binningRecommendedColumnSet:ht.state.recommendedColumnSet,selectedColumns:Ys,availableColumns:ie,scalingExcludedColumns:gn.state.excludedColumns,normalizedColumnSearch:qo,filteredColumnOptions:Ju,binningExcludedColumns:ht.state.excludedColumns,selectionCount:Vo,isCastNode:J,columnSuggestions:Ot,sourceId:i,isFetchingRecommendations:gt,hasReachableSource:Ve,refreshRecommendations:Io,availableFilters:yn,activeFilterId:En,setActiveFilterId:Jn,recommendations:$n,filteredRecommendations:Jr,recommendationsError:zo,relativeGeneratedAt:nd,formatSignalName:$a,handleToggleColumn:Pr,handleRemoveColumn:Fa,handleApplyAllRecommended:ed,handleBinningApplyColumns:ht.handlers.handleApplyColumns,handleSelectAllColumns:dc,handleClearColumns:mc,columnSearch:Pe,setColumnSearch:jt,columnMissingMap:we,columnTypeMap:tt,binningColumnPreviewMap:ht.state.columnPreviewMap,isImputerNode:C,showRecommendations:Vi}),[En,ie,yn,we,Pe,Ot,tt,ht.state.allNumericColumns,Xu,Ju,Jr,$a,ed,ht.handlers.handleApplyColumns,mc,Fa,dc,Pr,Ve,J,gt,re,ht.state.recommendedColumnSet,ht.state.columnPreviewMap,C,Se,ht.state.excludedColumns,Ae.status,$n,zo,nd,Ys,Vo,Jn,jt,gn.state.excludedColumns,Vi,i,Io,qo]),Lt=_.useCallback(St=>a.jsx(fR,{parameter:St,nodeId:e.id,configState:Ye,handleNumberChange:pt,handleBooleanChange:Nt,handleTextChange:Yn,thresholdParameterName:Hi,normalizedSuggestedThreshold:lc,showRecommendations:Vi,canApplySuggestedThreshold:uc,thresholdMatchesSuggestion:cc,handleApplySuggestedThreshold:aa,renderMultiSelect:kt}),[uc,Ye,aa,Nt,pt,Yn,e.id,lc,kt,Vi,cc,Hi]),Yi=_.useCallback(St=>{bt(As=>({...As,keep:St}))},[bt]);return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(Lk,{title:h,isDataset:vt,onClose:t,canResetNode:Rt,onResetNode:td}),a.jsxs("div",{className:"canvas-modal__body",children:[f&&a.jsx(z$,{connectionInfo:f,connectedInputHandles:g,connectedOutputHandles:b,connectionReady:y}),pf&&a.jsx(vk,{thresholdParameter:fe.dropMissing.threshold??null,dropIfAnyParameter:fe.dropRows.any,renderParameterField:Lt}),Yt&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),fe.dropMissing.threshold&&Lt(fe.dropMissing.threshold),kt(Yt)]}),k&&a.jsxs(a.Fragment,{children:[a.jsx(xM,{suffix:ac,insights:lf,formatMissingPercentage:Kn}),(fe.missingIndicator.columns||fe.missingIndicator.suffix)&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[fe.missingIndicator.columns?Lt(fe.missingIndicator.columns):null,fe.missingIndicator.suffix?Lt(fe.missingIndicator.suffix):null]})]})]}),ut&&a.jsx(Tk,{previewState:Ae,datasetSourceId:i??null,canTriggerPreview:Je,onRefresh:Ks,formatCellValue:Bb,formatMetricValue:Is,formatMissingPercentage:Kn,formatNumericStat:xs,formatModeStat:xy}),a.jsx(Pk,{isDatasetProfileNode:rt,controller:be,formatCellValue:Bb,formatNumericStat:xs,formatMissingPercentage:Kn}),Mt&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",children:[a.jsxs("strong",{children:[Mt.title,"."]})," ",Mt.body]})}),R&&a.jsx(EA,{sourceId:i,hasReachableSource:Ve,columnsParameter:fe.trimWhitespace.columns,modeParameter:fe.trimWhitespace.mode,renderMultiSelectField:kt,renderParameterField:Lt,columnSummary:Ui.columnSummary,modeDetails:Ui.modeDetails,sampleMap:Ui.sampleMap}),P&&a.jsx(WA,{sourceId:i,hasReachableSource:Ve,columnsParameter:fe.removeSpecial.columns,modeParameter:fe.removeSpecial.mode,replacementParameter:fe.removeSpecial.replacement,renderMultiSelectField:kt,renderParameterField:Lt,columnSummary:oc.columnSummary,modeDetails:oc.modeDetails,sampleMap:oc.sampleMap}),$&&a.jsx(XO,{sourceId:i,hasReachableSource:Ve,columnsParameter:fe.replaceInvalid.columns,modeParameter:fe.replaceInvalid.mode,minValueParameter:fe.replaceInvalid.minValue,maxValueParameter:fe.replaceInvalid.maxValue,renderMultiSelectField:kt,renderParameterField:Lt,columnSummary:Da.columnSummary,modeDetails:Da.modeDetails,sampleMap:Da.sampleMap,selectedMode:Da.mode,minValue:Da.minValue,maxValue:Da.maxValue}),A&&a.jsx(EO,{sourceId:i,hasReachableSource:Ve,columnsParameter:fe.regexCleanup.columns,modeParameter:fe.regexCleanup.mode,patternParameter:fe.regexCleanup.pattern,replacementParameter:fe.regexCleanup.replacement,renderMultiSelectField:kt,renderParameterField:Lt,columnSummary:Uo.columnSummary,modeDetails:Uo.modeDetails,sampleMap:Uo.sampleMap,selectedMode:Uo.selectedMode,replacementValue:Uo.replacementValue}),D&&a.jsx(cO,{sourceId:i,hasReachableSource:Ve,columnsParameter:fe.normalizeCase.columns,modeParameter:fe.normalizeCase.mode,renderMultiSelectField:kt,renderParameterField:Lt,columnSummary:qi.columnSummary,modeDetails:qi.modeDetails,sampleMap:qi.sampleMap,selectedMode:qi.selectedMode}),ne&&a.jsx(gT,{operations:Ms,summaries:Ws,collapsed:Tr,onToggleCollapsed:Yo,onAddOperation:yc,onDuplicateOperation:bc,onRemoveOperation:xf,onReorderOperation:wf,onOperationChange:Nf,availableColumns:ie,signals:Ct,previewStatus:Ae.status,errorHandlingParameter:fe.featureMath.errorHandling,allowOverwriteParameter:fe.featureMath.allowOverwrite,defaultTimezoneParameter:fe.featureMath.defaultTimezone,epsilonParameter:fe.featureMath.epsilon,renderParameterField:Lt}),H&&a.jsx(OT,{sourceId:i,hasReachableSource:Ve,isFetching:Vs.isFetching,error:Vs.error,suggestions:Vs.suggestions,metadata:Vs.metadata,columnsParameter:fe.ordinalEncoding.columns,autoDetectParameter:fe.ordinalEncoding.autoDetect,maxCategoriesParameter:fe.ordinalEncoding.maxCategories,outputSuffixParameter:fe.ordinalEncoding.outputSuffix,dropOriginalParameter:fe.ordinalEncoding.dropOriginal,encodeMissingParameter:fe.ordinalEncoding.encodeMissing,handleUnknownParameter:fe.ordinalEncoding.handleUnknown,unknownValueParameter:fe.ordinalEncoding.unknownValue,selectedColumns:Ys,renderParameterField:Lt,onToggleColumn:Pr,onApplyRecommended:Vs.handleApplyRecommended,formatMissingPercentage:Kn}),F&&a.jsx(wT,{sourceId:i,hasReachableSource:Ve,isFetching:_r.isFetching,error:_r.error,suggestions:_r.suggestions,metadata:_r.metadata,columnsParameter:fe.targetEncoding.columns,targetColumnParameter:fe.targetEncoding.targetColumn,autoDetectParameter:fe.targetEncoding.autoDetect,maxCategoriesParameter:fe.targetEncoding.maxCategories,outputSuffixParameter:fe.targetEncoding.outputSuffix,dropOriginalParameter:fe.targetEncoding.dropOriginal,smoothingParameter:fe.targetEncoding.smoothing,encodeMissingParameter:fe.targetEncoding.encodeMissing,handleUnknownParameter:fe.targetEncoding.handleUnknown,selectedColumns:Ys,renderParameterField:Lt,onToggleColumn:Pr,onApplyRecommended:_r.handleApplyRecommended,formatMissingPercentage:Kn}),Y&&a.jsx(PT,{sourceId:i,hasReachableSource:Ve,isFetching:Zn.isFetching,error:Zn.error,suggestions:Zn.suggestions,metadata:Zn.metadata,columnsParameter:fe.dummyEncoding.columns,autoDetectParameter:fe.dummyEncoding.autoDetect,maxCategoriesParameter:fe.dummyEncoding.maxCategories,dropFirstParameter:fe.dummyEncoding.dropFirst,includeMissingParameter:fe.dummyEncoding.includeMissing,dropOriginalParameter:fe.dummyEncoding.dropOriginal,prefixSeparatorParameter:fe.dummyEncoding.prefixSeparator,selectedColumns:Ys,renderParameterField:Lt,onToggleColumn:Pr,onApplyRecommended:Zn.handleApplyRecommended,formatMissingPercentage:Kn}),Q&&a.jsx(zT,{sourceId:i,hasReachableSource:Ve,isFetching:Z.isFetching,error:Z.error,suggestions:Z.suggestions,metadata:Z.metadata,columnsParameter:fe.oneHotEncoding.columns,autoDetectParameter:fe.oneHotEncoding.autoDetect,maxCategoriesParameter:fe.oneHotEncoding.maxCategories,dropFirstParameter:fe.oneHotEncoding.dropFirst,includeMissingParameter:fe.oneHotEncoding.includeMissing,dropOriginalParameter:fe.oneHotEncoding.dropOriginal,prefixSeparatorParameter:fe.oneHotEncoding.prefixSeparator,selectedColumns:Ys,renderParameterField:Lt,onToggleColumn:Pr,onApplyRecommended:Z.handleApplyRecommended,formatMissingPercentage:Kn}),G&&a.jsx(VT,{nodeId:yt,sourceId:i,hasReachableSource:Ve,previewState:Ae,onRefreshPreview:Ks,config:tr,targetColumnParameter:fe.featureTargetSplit.targetColumn,renderParameterField:Lt,formatMetricValue:Is,formatMissingPercentage:Kn}),W&&a.jsx(KT,{nodeId:yt,sourceId:i,hasReachableSource:Ve,previewState:Ae,onRefreshPreview:Ks,config:Qn,parameters:Dt,renderParameterField:Lt,formatMetricValue:Is}),at&&a.jsx(s$,{mode:K?"oversampling":"undersampling",sourceId:i,hasReachableSource:Ve,previewState:Ae,onRefreshPreview:Ks,config:as,methodParameter:fe.resampling.method,targetColumnParameter:fe.resampling.targetColumn,samplingStrategyParameter:fe.resampling.samplingStrategy,randomStateParameter:fe.resampling.randomState,kNeighborsParameter:K?fe.resampling.kNeighbors:null,replacementParameter:te?fe.resampling.replacement:null,renderParameterField:Lt,formatMetricValue:Is,formatMissingPercentage:Kn,schemaGuard:qs}),(X||U)&&a.jsx(JT,{sourceId:i,hasReachableSource:Ve,previewState:Ae,onRefreshPreview:Ks,config:Fn,targetColumnParameter:fe.trainModel.targetColumn,problemTypeParameter:fe.trainModel.problemType,renderParameterField:Lt,formatMetricValue:Is,formatMissingPercentage:Kn,schemaColumns:Bn}),X&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(p2,{nodeId:yt,sourceId:i,graph:At,config:Fn,runtimeConfig:os,cvConfig:Ss,draftConfigState:Ye,renderParameterField:Lt,modelTypeParameter:fe.trainModel.modelType,modelTypeOptions:In,hyperparametersParameter:fe.trainModel.hyperparameters,cvEnabledParameter:fe.trainModel.cvEnabled,cvStrategyParameter:fe.trainModel.cvStrategy,cvFoldsParameter:fe.trainModel.cvFolds,cvShuffleParameter:fe.trainModel.cvShuffle,cvRandomStateParameter:fe.trainModel.cvRandomState,cvRefitStrategyParameter:fe.trainModel.cvRefitStrategy,onSaveDraftConfig:oa})}),I&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(j2,{nodeId:yt,sourceId:i,graph:At,config:Ye,setConfigState:bt,renderParameterField:Lt,formatMetricValue:Is,connectedSplitHandles:w})}),L&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(U2,{nodeId:yt,sourceId:i,graph:At,parameters:Dt,config:mn,renderParameterField:Lt})}),U&&a.jsx("div",{style:x,"aria-disabled":N,children:a.jsx(Z2,{nodeId:yt,sourceId:i,graph:At,config:Fn,runtimeConfig:os,cvConfig:Ss,draftConfigState:Ye,renderParameterField:Lt,modelTypeParameter:fe.trainModel.modelType,modelTypeOptions:In,searchStrategyParameter:fe.hyperparameterTuning.searchStrategy,searchIterationsParameter:fe.hyperparameterTuning.searchIterations,searchRandomStateParameter:fe.hyperparameterTuning.searchRandomState,scoringMetricParameter:fe.hyperparameterTuning.scoringMetric,setDraftConfigState:bt,onSaveDraftConfig:oa})}),z&&a.jsx(yT,{sourceId:i,hasReachableSource:Ve,isFetching:Or.isFetching,error:Or.error,suggestions:Or.suggestions,metadata:Or.metadata,columnsParameter:fe.labelEncoding.columns,autoDetectParameter:fe.labelEncoding.autoDetect,maxUniqueParameter:fe.labelEncoding.maxUnique,outputSuffixParameter:fe.labelEncoding.outputSuffix,dropOriginalParameter:fe.labelEncoding.dropOriginal,missingStrategyParameter:fe.labelEncoding.missingStrategy,missingCodeParameter:fe.labelEncoding.missingCode,selectedColumns:Ys,renderParameterField:Lt,onToggleColumn:Pr,onApplyRecommended:Or.handleApplyRecommended,formatMissingPercentage:Kn}),q&&a.jsx(CT,{sourceId:i,hasReachableSource:Ve,isFetching:Hs.isFetching,error:Hs.error,suggestions:Hs.suggestions,metadata:Hs.metadata,columnsParameter:fe.hashEncoding.columns,autoDetectParameter:fe.hashEncoding.autoDetect,maxCategoriesParameter:fe.hashEncoding.maxCategories,bucketsParameter:fe.hashEncoding.buckets,outputSuffixParameter:fe.hashEncoding.outputSuffix,dropOriginalParameter:fe.hashEncoding.dropOriginal,encodeMissingParameter:fe.hashEncoding.encodeMissing,selectedColumns:Ys,renderParameterField:Lt,onToggleColumn:Pr,onApplyRecommended:Hs.handleApplyRecommended,formatMissingPercentage:Kn}),ze&&a.jsx(ST,{columnsParameter:fe.polynomial.columns,autoDetectParameter:fe.polynomial.autoDetect,degreeParameter:fe.polynomial.degree,includeBiasParameter:fe.polynomial.includeBias,interactionOnlyParameter:fe.polynomial.interactionOnly,includeInputFeaturesParameter:fe.polynomial.includeInputFeatures,outputPrefixParameter:fe.polynomial.outputPrefix,renderParameterField:Lt,signal:Pn}),$e&&a.jsx(kT,{columnsParameter:fe.featureSelection.columns,autoDetectParameter:fe.featureSelection.autoDetect,targetColumnParameter:fe.featureSelection.targetColumn,methodParameter:fe.featureSelection.method,scoreFuncParameter:fe.featureSelection.scoreFunc,problemTypeParameter:fe.featureSelection.problemType,kParameter:fe.featureSelection.k,percentileParameter:fe.featureSelection.percentile,alphaParameter:fe.featureSelection.alpha,thresholdParameter:fe.featureSelection.threshold,modeParameter:fe.featureSelection.mode,estimatorParameter:fe.featureSelection.estimator,stepParameter:fe.featureSelection.step,minFeaturesParameter:fe.featureSelection.minFeatures,maxFeaturesParameter:fe.featureSelection.maxFeatures,dropUnselectedParameter:fe.featureSelection.dropUnselected,renderParameterField:Lt,signal:Wt}),V&&a.jsx(cA,{hasSource:!!i,hasReachableSource:Ve,strategies:vr.strategies,columnSummary:vr.columnSummary,columnOptions:vr.columnOptions,sampleMap:vr.sampleMap,collapsedStrategies:ke,onToggleStrategy:gd,onRemoveStrategy:pd,onAddStrategy:fd,onModeChange:_d,onColumnToggle:yd,onColumnsChange:vd,onAutoDetectToggle:Rr,modeOptions:Nh}),O&&a.jsx(YM,{hasSource:!!i,hasReachableSource:Ve,strategies:ra.strategies,columnSummary:ra.columnSummary,columnOptions:ra.columnOptions,sampleMap:ra.sampleMap,customPairSummary:ra.customPairSummary,customPairsParameter:fe.replaceAliases.customPairs,collapsedStrategies:ke,onToggleStrategy:Wi,onRemoveStrategy:md,onAddStrategy:_c,onModeChange:Ba,onAutoDetectToggle:Ki,onColumnToggle:vc,onColumnsChange:hd,renderParameterField:Lt}),C&&a.jsx(dM,{hasSource:!!i,hasReachableSource:Ve,strategies:rn,columnOptions:ic,methodOptions:ct,missingFilter:Vt,missingFilterMax:Ho,missingFilterActive:Zu,filteredOptionCount:ff,collapsedStrategies:ke,onToggleStrategy:pc,onRemoveStrategy:dd,onAddStrategy:ud,onMethodChange:yf,onOptionNumberChange:bf,onColumnsChange:Ia,onColumnToggle:gc,onMissingFilterChange:Ko,formatMissingPercentage:Kn,formatNumericStat:xs,formatModeStat:xy,schemaDiagnostics:is}),J&&a.jsx(Nk,{configState:Ye,setConfigState:bt,availableColumns:ie,columnTypeMap:tt,columnSuggestions:Ot,selectedColumns:Ys,previewColumns:rc,previewStatus:Ae.status,sourceId:i,hasReachableSource:Ve}),it&&a.jsx(R$,{sourceId:i,hasReachableSource:Ve,isFetchingOutliers:Pa,outlierConfig:an.config,outlierMethodOptions:an.state.methodOptions,outlierMethodDetailMap:an.state.methodDetailMap,outlierDefaultDetail:an.state.defaultDetail,outlierAutoDetectEnabled:an.state.autoDetectEnabled,outlierSelectedCount:an.state.selectedCount,outlierDefaultLabel:an.state.defaultLabel,outlierOverrideCount:an.state.overrideCount,outlierParameterOverrideCount:an.state.parameterOverrideCount,outlierOverrideExampleSummary:an.state.overrideExampleSummary,outlierHasOverrides:an.state.hasOverrides,outlierRecommendationRows:an.state.recommendationRows,outlierHasRecommendations:an.state.hasRecommendations,outlierStatusMessage:an.state.statusMessage,outlierError:ps,outlierSampleSize:_f,relativeOutlierGeneratedAt:rd,outlierPreviewSignal:kn,formatMetricValue:Is,formatNumericStat:xs,onApplyAllRecommendations:an.handlers.handleApplyAllRecommendations,onClearOverrides:an.handlers.handleClearOverrides,onDefaultMethodChange:an.handlers.handleDefaultMethodChange,onAutoDetectToggle:an.handlers.handleAutoDetectToggle,onOverrideSelect:an.handlers.handleOverrideSelect,onMethodParameterChange:an.handlers.handleMethodParameterChange,onColumnParameterChange:an.handlers.handleColumnParameterChange}),Se&&a.jsx(mM,{sourceId:i,hasReachableSource:Ve,isFetchingScaling:ta,scalingConfig:gn.config,scalingMethodOptions:gn.state.methodOptions,scalingMethodDetailMap:gn.state.methodDetailMap,scalingDefaultDetail:gn.state.defaultDetail,scalingAutoDetectEnabled:gn.state.autoDetectEnabled,scalingSelectedCount:gn.state.selectedCount,scalingDefaultLabel:gn.state.defaultLabel,scalingOverrideCount:gn.state.overrideCount,scalingOverrideExampleSummary:gn.state.overrideExampleSummary,scalingRecommendationRows:gn.state.recommendationRows,scalingHasRecommendations:gn.state.hasRecommendations,scalingStatusMessage:gn.state.statusMessage,scalingError:ea,scalingSampleSize:ad,relativeScalingGeneratedAt:sd,formatMetricValue:Is,formatNumericStat:xs,formatMissingPercentage:Kn,onApplyAllRecommendations:gn.handlers.handleApplyAllRecommendations,onClearOverrides:gn.handlers.handleClearOverrides,onDefaultMethodChange:gn.handlers.handleDefaultMethodChange,onAutoDetectToggle:gn.handlers.handleAutoDetectToggle,onOverrideSelect:gn.handlers.handleOverrideSelect}),re&&a.jsxs(a.Fragment,{children:[a.jsx(eM,{hasSource:!!i,hasReachableSource:Ve,isFetching:Mn,error:Ra,relativeGeneratedAt:hc,sampleSize:od,binningConfig:ht.config,binningDefaultLabel:ht.state.defaultLabel,binningOverrideCount:ht.state.overrideCount,binningOverrideSummary:ht.state.overrideSummary,recommendations:ht.state.insightsRecommendations,excludedColumns:ht.state.insightsExcludedColumns,numericColumnCount:ht.state.allNumericColumns.length,canApplyAllNumeric:ht.state.canApplyAllNumeric,onApplyAllNumeric:ht.handlers.handleApplyAllNumeric,onApplyStrategies:ht.handlers.handleApplyStrategies,onClearOverrides:ht.handlers.handleClearOverrides,customEdgeDrafts:ht.state.customEdgeDrafts,customLabelDrafts:ht.state.customLabelDrafts,onOverrideStrategyChange:ht.handlers.handleOverrideStrategyChange,onOverrideNumberChange:ht.handlers.handleOverrideNumberChange,onOverrideKbinsEncodeChange:ht.handlers.handleOverrideKbinsEncodeChange,onOverrideKbinsStrategyChange:ht.handlers.handleOverrideKbinsStrategyChange,onOverrideClear:ht.handlers.handleClearOverride,onCustomBinsChange:ht.handlers.handleCustomBinsChange,onCustomLabelsChange:ht.handlers.handleCustomLabelsChange,onClearCustomColumn:ht.handlers.handleClearCustomColumn,formatMetricValue:Is,formatNumericStat:xs}),a.jsx(Xk,{config:ht.config,fieldIds:ht.state.fieldIds,onIntegerChange:ht.handlers.handleIntegerChange,onBooleanToggle:ht.handlers.handleBooleanToggle,onSuffixChange:ht.handlers.handleSuffixChange,onLabelFormatChange:ht.handlers.handleLabelFormatChange,onMissingStrategyChange:ht.handlers.handleMissingStrategyChange,onMissingLabelChange:ht.handlers.handleMissingLabelChange})]}),He&&a.jsx(vM,{sourceId:i,hasReachableSource:Ve,isFetchingSkewness:Bo,skewnessThreshold:_n.state.threshold,skewnessError:es,skewnessViewMode:_n.state.viewMode,skewnessRecommendedCount:_n.state.recommendedCount,skewnessNumericCount:_n.state.numericCount,skewnessGroupByMethod:_n.state.groupByMethod,skewnessRows:_n.state.rows,skewnessTableGroups:_n.state.tableGroups,hasSkewnessAutoRecommendations:_n.state.hasAutoRecommendations,skewnessTransformationsCount:_n.state.transformationsCount,isFetchingRecommendations:gt,getSkewnessMethodLabel:_n.handlers.getMethodLabel,getSkewnessMethodStatus:_n.handlers.getMethodStatus,onApplyRecommendations:_n.handlers.applyRecommendations,onViewModeChange:_n.handlers.setViewMode,onGroupByToggle:_n.handlers.setGroupByMethod,onOverrideChange:_n.handlers.handleOverrideChange,onClearSelections:_n.handlers.clearTransformations}),de&&a.jsx(bM,{skewnessThreshold:_n.state.threshold,isFetchingSkewness:Bo,skewnessError:es,skewnessDistributionCards:_n.state.distributionCards,skewnessDistributionView:_n.state.distributionView,setSkewnessDistributionView:_n.handlers.setDistributionView,onRefresh:af,canRefresh:cf}),ge&&a.jsx(tM,{cards:xd,selectedPreset:pe,onSelectPreset:St=>me(St),isFetching:La,sampleSize:gf,relativeGeneratedAt:fc,error:sc,onRefresh:bd,canRefresh:!!i}),Ue&&a.jsx(xk,{sourceId:i,hasReachableSource:Ve,removeDuplicatesColumnsParameter:fe.removeDuplicates.columns,removeDuplicatesKeepParameter:fe.removeDuplicates.keep,renderMultiSelectField:kt,removeDuplicatesKeepSelectId:df,removeDuplicatesKeep:mf,onKeepChange:Yi}),Ne&&dt.length>0&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Data consistency settings"})}),a.jsx("div",{className:"canvas-modal__parameter-list",children:dt.map(St=>Lt(St))})]}),Be&&a.jsx(UT,{signal:ks,previewStatus:Ae.status,hasSource:!!i,hasReachableSource:Ve,onRefreshPreview:Ks}),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("h3",{children:"Node details"}),p.length?a.jsx("dl",{className:"canvas-modal__metadata",children:p.map((St,As)=>a.jsxs("div",{className:"canvas-modal__metadata-row",children:[a.jsx("dt",{children:St.label}),a.jsx("dd",{children:St.value})]},`${St.label}-${As}`))}):a.jsx("p",{className:"canvas-modal__empty",children:"No metadata available for this node."})]})]}),a.jsx(zk,{onClose:t,canResetNode:tn,onResetNode:td,showSaveButton:id,canSave:vf,onSave:oa,isBusy:ld,busyLabel:cd})]})]})},kx=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],Vr=kx.map(e=>e.key),NR=kx.reduce((e,t)=>({...e,[t.key]:t.label}),{}),jR=e=>typeof e=="string"&&Vr.includes(e),Wr=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{jR(n)&&t.add(n)}),Vr.filter(n=>t.has(n))},Mx=(e,t)=>{const n=Wr(e),s=Wr(t);return n.length!==s.length?!1:n.every((i,l)=>i===s[l])},Ax=e=>!e||typeof e!="string"?null:Vr.find(t=>e.endsWith(`-${t}`))??null,Ox=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},CR={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},Ql={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"train-in",label:"Train Split",position:20,required:!1,accepts:["train"]},{key:"test-in",label:"Test Split",position:40,required:!1,accepts:["test"]},{key:"validation-in",label:"Validation Split",position:60,required:!1,accepts:["validation"]},{key:"models-in",label:"Model",position:80,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},Tx=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:Ox(t,n),SR=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,ER=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,$x=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},Px=28,Rx=320,kR=170,Lx="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",zx="Drop columns",Dx=new Set(["transformer_audit"]),MR=e=>({width:`${Px}px`,height:`${Px}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),AR=({id:e,data:t,selected:n})=>{var j;const s=(t==null?void 0:t.label)??e,i=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),l=(t==null?void 0:t.isRemovable)??!i,c=(t==null?void 0:t.catalogType)==="train_test_split",u=i?"Primary dataset input":void 0,d=(t==null?void 0:t.description)??u,h=(t==null?void 0:t.catalogType)==="drop_missing_columns"||d===Lx?zx:d,f=(t==null?void 0:t.backgroundExecutionStatus)??"idle",b=!((t==null?void 0:t.hasRequiredConnections)??!0),w=(t==null?void 0:t.catalogType)??"",y=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(w),x=_.useCallback(C=>{var k;C.stopPropagation(),(k=t==null?void 0:t.onRemoveNode)==null||k.call(t,e)},[t,e]),N=_.useMemo(()=>{if(i)return[];const C=(t==null?void 0:t.catalogType)??"",k=C?Ql[C]:void 0;if(k!=null&&k.inputs&&k.inputs.length){const O=k.inputs.length;return k.inputs.map((R,P)=>({position:Te.Left,id:`${e}-${R.key}`,label:SR(R),style:{top:Tx(R,P,O)}}))}return[{position:Te.Left,id:`${e}-target`},{position:Te.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,i]),E=_.useMemo(()=>{if(i)return[{position:Te.Left,id:`${e}-source-left`},{position:Te.Right,id:`${e}-source`},{position:Te.Top,id:`${e}-source-top`},{position:Te.Bottom,id:`${e}-source-bottom`}];const C=(t==null?void 0:t.catalogType)??"",k=C?Ql[C]:void 0;if(k!=null&&k.outputs&&k.outputs.length){const P=k.outputs.length;return k.outputs.map(($,A)=>({position:Te.Right,id:`${e}-${$.key}`,label:$.label,style:{top:Tx($,A,P)}}))}const O=c?Vr:Wr((t==null?void 0:t.activeSplits)??[]),R=Wr((t==null?void 0:t.connectedSplits)??[]);if(O.length){const P=O.length;return O.map(($,A)=>({position:Te.Right,id:`${e}-${$}`,style:{top:Ox(A,P)},label:(()=>{var V;const D=NR[$];if(c){if($==="validation"&&!(Number(((V=t==null?void 0:t.config)==null?void 0:V.validation_size)??0)>0))return`${D} (disabled)`;if(!R.includes($))return`${D} (not set)`}return D})()}))}return[{position:Te.Right,id:`${e}-source`},{position:Te.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(j=t==null?void 0:t.config)==null?void 0:j.validation_size,e,i,c]),S=_.useCallback((C,k)=>{const{position:O,id:R,style:P,label:$}=C,A=R.includes("-train")||R.includes("-test")||R.includes("-validation");return a.jsxs(_e.Fragment,{children:[a.jsx(kl,{type:k,position:O,id:R,className:`feature-node__handle feature-node__handle--${k}`,style:{...MR(k),...P??{},...A?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),$&&k==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(P==null?void 0:P.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:$}),$&&k==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(P==null?void 0:P.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:$})]},R)},[]);return a.jsxs("div",{className:`feature-node${n?" feature-node--selected":""}${i?" feature-node--dataset":""}`,children:[N.map(C=>S(C,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:s})]}),a.jsxs("div",{className:"feature-node__controls",children:[b&&y&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)"},children:""}),f==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:"Loading full dataset in background...",children:a.jsx("svg",{className:"feature-node__spinner",viewBox:"0 0 24 24",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60",strokeDashoffset:"30",strokeLinecap:"round"})})}),f==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",children:""}),f==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",children:"!"}),l&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:x,title:"Remove node",children:""})]})]}),h&&a.jsx("p",{className:"feature-node__description",children:h}),E.map(C=>S(C,"source"))]})},Eo="__pending_confirmation__",OR=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],TR=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],Wu=e=>e&&typeof e=="object"&&!Array.isArray(e),Xl=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},Ku=e=>typeof e=="string"&&Dx.has(e),Yu=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",s=!Dx.has(n),i=c=>(s?c[Eo]=!0:delete c[Eo],c);if(t==null)return i({});const l=Xl(t);if(!Wu(l))return i(l&&typeof l=="object"?l:{});switch(Object.entries(l).forEach(([c,u])=>{Array.isArray(u)?OR.some(p=>p.test(c))&&(l[c]=[]):Wu(u)&&TR.some(p=>p.test(c))&&(l[c]={})}),"auto_detect"in l&&(l.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":l.columns=Array.isArray(l.columns)?l.columns:[],l.column_methods=Wu(l.column_methods)?l.column_methods:{},l.skipped_columns=Array.isArray(l.skipped_columns)?l.skipped_columns:[],l.default_method=typeof l.default_method=="string"&&l.default_method.trim()?l.default_method:"standard";break;case"polynomial_features":l.columns=Array.isArray(l.columns)?l.columns:[],l.auto_detect=!!l.auto_detect,l.include_bias=!!l.include_bias,l.interaction_only=!!l.interaction_only,l.include_input_features=!!l.include_input_features,l.degree=typeof l.degree=="number"&&Number.isFinite(l.degree)?l.degree:2,l.output_prefix=typeof l.output_prefix=="string"&&l.output_prefix.trim()?l.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in l&&(l.missing_threshold=null),l.columns=Array.isArray(l.columns)?l.columns:[];break;case"drop_missing_rows":"missing_threshold"in l&&(l.missing_threshold=null),"drop_if_any_missing"in l&&(l.drop_if_any_missing=!1);break;case"outlier_removal":l.method="manual",l.columns=Array.isArray(l.columns)?l.columns:[],l.manual_bounds=Wu(l.manual_bounds)?l.manual_bounds:{};break;case"missing_value_indicator":l.columns=Array.isArray(l.columns)?l.columns:[];break;case"remove_duplicates":if(l.columns=Array.isArray(l.columns)?l.columns:[],typeof l.keep=="string"){const c=l.keep.trim().toLowerCase();l.keep=c==="last"||c==="none"?c:"first"}else l.keep="first";break}return i(l)},$R=(e,t)=>t==="drop_missing_columns"||e===Lx?zx:e,PR=e=>Array.isArray(e)?e.map(t=>({...t})):[],RR=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],LR=[],zR=e=>({...e,data:{...e.data??{}}}),Gu=()=>RR.map(e=>zR(e)),DR=()=>LR.map(e=>({...e})),FR=12,IR=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},BR=(e,t,n)=>{if(!t||typeof t.project!="function"||!n)return;const s=n.getBoundingClientRect(),i=t.project({x:s.width/2,y:s.height/2});if(!i)return;const l=e.filter(f=>f.id!=="dataset-source").length,c=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],u=l%c.length,d=Math.floor(l/c.length),p=c[u],h=d+1;return{x:i.x+p.x*h,y:i.y+p.y*h}},UR=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),Fx=(e,t)=>{if(!e)return!1;if(UR.has(e))return!0;const n=t==null?void 0:t.get(e);return n?(typeof n.category=="string"?n.category.toLowerCase():"").includes("preprocess"):!1},Ix=(e,t)=>{var j,C,k,O,R,P;const{handleOpenSettings:n,handleRemoveNode:s,catalogEntryMap:i}=t,l=e.data??{},c=l.isDataset??e.id==="dataset-source",u={...e.style??{}},d=l.catalogType??l.type??e.id;let h=Array.isArray(l.parameters)?l.parameters:null;if((!h||h.length===0)&&typeof d=="string"){const $=i.get(d)??null;(j=$==null?void 0:$.parameters)!=null&&j.length&&(h=$.parameters)}const f=PR(h);let g;if(f.length||l.config&&typeof l.config=="object"){const $=Xl(l.config);f.forEach(A=>{A!=null&&A.name&&$[A.name]===void 0&&A.default!==void 0&&(Array.isArray(A.default)?$[A.name]=[...A.default]:A.type==="boolean"?$[A.name]=!!A.default:$[A.name]=A.default)}),g=$}u.width||(u.width=c?Rx+20:Rx),u.minHeight||(u.minHeight=kR),u.padding||(u.padding=12),u.borderRadius||(u.borderRadius=16),u.boxSizing=u.boxSizing??"border-box",u.whiteSpace=u.whiteSpace??"pre-line",u.background||(u.background=c?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),u.border||(u.border=c?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),u.boxShadow||(u.boxShadow=c?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),u.color||(u.color=c?"#e0f2fe":"#e2e8f0"),u.fontWeight||(u.fontWeight=c?600:500);const b=$R(l.description,d),w=Ku(d),y=g??(l.config&&typeof l.config=="object"?Xl(l.config):void 0);y&&typeof y=="object"&&w&&delete y[Eo];const x={...l,label:l.label??e.id,description:b,isDataset:c,isRemovable:l.isRemovable??!c,isConfigured:c||l.isConfigured===!0?!0:l.config&&typeof l.config=="object"?w?!0:!l.config[Eo]:!1,inputs:Array.isArray(l.inputs)?[...l.inputs]:l.inputs,outputs:Array.isArray(l.outputs)?[...l.outputs]:l.outputs,category:l.category,parameters:f,config:y,catalogType:d,onRemoveNode:s,onOpenSettings:n},N=typeof d=="string"?Ql[d]:void 0;if(N){const $=((C=N.inputs)==null?void 0:C.map(D=>ER(D)))??[],A=((k=N.outputs)==null?void 0:k.map(D=>D.label))??[];$.length?x.inputs=$:delete x.inputs,A.length?x.outputs=A:delete x.outputs,x.connectionInfo={inputs:((O=N.inputs)==null?void 0:O.map(D=>({...D})))??[],outputs:((R=N.outputs)==null?void 0:R.map(D=>({...D})))??[]}}else(!x.inputs||x.inputs.length===0)&&delete x.inputs,(!x.outputs||x.outputs.length===0)&&delete x.outputs,delete x.connectionInfo;const E=Wr(x.activeSplits);E.length?x.activeSplits=E:delete x.activeSplits;const S=Wr(x.connectedSplits);return S.length?x.connectedSplits=S:delete x.connectedSplits,d==="train_test_split"&&(x.activeSplits=[...Vr],S.length||delete x.connectedSplits),(P=x.parameters)!=null&&P.length||delete x.parameters,x.config===void 0&&delete x.config,{...e,type:"featureNode",position:e.position??{x:0,y:0},data:x,style:u}},qR=(e,t,n,s,i)=>{const l=(e==null?void 0:e.label)??(e==null?void 0:e.type)??s,c=typeof l=="string"&&l.trim()?l:s,u=Yu(e),d=Ku((e==null?void 0:e.type)??null);return Ix({id:t,type:"featureNode",position:n,data:{label:c,description:e==null?void 0:e.description,inputs:e==null?void 0:e.inputs,outputs:e==null?void 0:e.outputs,category:e==null?void 0:e.category,parameters:e==null?void 0:e.parameters,config:u,catalogType:e==null?void 0:e.type,isConfigured:!!d}},i)},HR=(e,t)=>{const n=e.map(i=>{const{data:l,...c}=i,u=l?{...l}:void 0;return u&&(delete u.onRemoveNode,delete u.onOpenSettings),JSON.parse(JSON.stringify({...c,data:u}))}),s=t.map(i=>JSON.parse(JSON.stringify(i)));return{nodes:n,edges:s}},VR=()=>{var h;const[e,t]=_.useState(!1),n=_.useRef(new Map),s=Ls({queryKey:["feature-canvas","node-catalog"],queryFn:Kv,staleTime:5*60*1e3}),i=s.data??[],l=s.isLoading||s.isFetching,c=s.error?((h=s.error)==null?void 0:h.message)??"Unable to load node catalog":null;_.useEffect(()=>{const f=new Map;i.forEach(g=>{g&&typeof g.type=="string"&&g.type.trim()&&f.set(g.type,g)}),n.current=f},[i]);const u=_.useCallback(()=>t(!0),[]),d=_.useCallback(()=>t(!1),[]),p=_.useCallback(()=>t(f=>!f),[]);return{nodeCatalog:i,catalogEntryMapRef:n,isCatalogOpen:e,openCatalog:u,closeCatalog:d,toggleCatalog:p,isCatalogLoading:l,catalogErrorMessage:c}},Qu=e=>!e||!e.length?"":e.join(", "),WR=({nodes:e,onAddNode:t})=>{const[n,s]=_.useState(""),[i,l]=_.useState([]),c=n.trim().toLowerCase(),u=_.useMemo(()=>c?e.filter(g=>{const b=[g.label,g.type,g.description];return g.category&&b.push(g.category),g.tags&&g.tags.length&&b.push(g.tags.join(" ")),b.some(w=>w==null?void 0:w.toLowerCase().includes(c))}):e,[e,c]),d=_.useMemo(()=>{const g=new Map;return u.forEach(b=>{var x;const w=((x=b.category)==null?void 0:x.trim())||"Other",y=g.get(w)??[];y.push(b),g.set(w,y)}),Array.from(g.entries()).sort(([b],[w])=>b.localeCompare(w)).map(([b,w])=>({category:b,entries:w.sort((y,x)=>(y.label||y.type).localeCompare(x.label||x.type))}))},[u]);_.useEffect(()=>{if(!c){l([]);return}l(g=>{const b=new Set(g);let w=!1;return d.forEach(({category:y})=>{b.has(y)||(b.add(y),w=!0)}),w?Array.from(b):g})},[d,c]);const p=g=>{l(b=>{const w=new Set(b);return w.has(g)?w.delete(g):w.add(g),Array.from(w)})},h=u.length,f=h>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsx("h3",{children:"Available steps"}),a.jsxs("div",{className:"feature-canvas-sidebar__search",children:[a.jsx("input",{type:"search",value:n,onChange:g=>s(g.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps"}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>s(""),"aria-label":"Clear search",children:""})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",h," ",h===1?"step":"steps",c?` matching ${n.trim()}`:""]})]}),f?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:d.map(({category:g,entries:b})=>{const w=i.includes(g);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>p(g),"aria-expanded":w,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:g.charAt(0).toUpperCase()+g.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[b.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":w,children:""})]})]}),w&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:b.map(y=>{var x,N;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(y),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:y.label||y.type}),y.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:y.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(x=y.inputs)!=null&&x.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${Qu(y.inputs)}`,children:["In: ",Qu(y.inputs)]}):null,(N=y.outputs)!=null&&N.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${Qu(y.outputs)}`,children:["Out: ",Qu(y.outputs)]}):null,y.parameters&&y.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",children:[y.parameters.length," param",y.parameters.length>1?"s":""]}):null]})]})},y.type)})})]},g)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})},KR=({nodeCatalog:e,isCatalogLoading:t,catalogErrorMessage:n,handleAddNode:s})=>({sidebarContent:_.useMemo(()=>t?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):n?a.jsx("p",{className:"text-danger",children:n}):e.length?a.jsx(WR,{nodes:e,onAddNode:s}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[n,s,t,e])}),YR=({setNodes:e,setEdges:t,setSelectedNodeId:n,setIsSettingsModalOpen:s,catalogEntryMapRef:i,handleOpenSettings:l,reactFlowInstanceRef:c,canvasViewportRef:u,scheduleFitView:d})=>{const p=_.useRef(0),h=_.useCallback(S=>{S!=="dataset-source"&&(e(j=>j.filter(C=>C.id!==S)),t(j=>j.filter(C=>C.source!==S&&C.target!==S)),n(j=>j===S?(s(!1),null):j))},[t,s,e,n]),f=_.useCallback(S=>Ix(S,{handleOpenSettings:l,handleRemoveNode:h,catalogEntryMap:i.current}),[i,l,h]),g=_.useCallback(S=>{const j=S.reduce((C,k)=>{if(typeof k.id=="string"&&k.id.startsWith("node-")){const O=Number(k.id.replace("node-",""));if(!Number.isNaN(O))return Math.max(C,O)}return C},0);j>p.current&&(p.current=j)},[]),b=_.useCallback((S,j)=>{const C=p.current+1,k=`node-${C}`;p.current=C;const O=j??{x:160+(C-1)%4*220,y:40+Math.floor((C-1)/4)*160};return f(qR(S??null,k,O,`Step ${C}`,{handleOpenSettings:l,handleRemoveNode:h,catalogEntryMap:i.current}))},[i,l,h,f]),w=_.useCallback(S=>{e(j=>{const C=BR(j,c.current,u.current),k=b(S,C);return[...j,k]}),d()},[u,b,c,d,e]),y=_.useCallback((S,j)=>{e(C=>C.map(k=>{if(k.id!==S)return k;const O=Xl(j);O&&typeof O=="object"&&delete O[Eo];const R={...k.data??{},config:O,isConfigured:!0};return f({...k,data:R})}))},[f,e]),x=_.useCallback((S,j)=>{e(C=>C.map(k=>{if(k.id!==S)return k;const O={...k.data??{},...j};return f({...k,data:O})}))},[f,e]),N=_.useCallback((S,j)=>{e(C=>C.map(k=>{var A;if(k.id!==S)return k;const O=(A=k==null?void 0:k.data)==null?void 0:A.catalogType,R=O?i.current.get(O)??null:null,P=j&&typeof j=="object"?Xl(j):Yu(R??null),$={...k.data??{},config:P,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...k,data:$})}))},[i,f,e]),E=_.useCallback(()=>{e(S=>S.map(j=>{var P,$;if(!Fx((P=j==null?void 0:j.data)==null?void 0:P.catalogType,i.current))return j;const C=($=j==null?void 0:j.data)==null?void 0:$.catalogType,k=C?i.current.get(C)??null:null,O=Yu(k??null),R={...j.data??{},config:O,isConfigured:!1,backgroundExecutionStatus:"idle"};return f({...j,data:R})}))},[i,f,e]);return{registerNode:f,createNode:b,handleAddNode:w,handleRemoveNode:h,handleUpdateNodeConfig:y,handleUpdateNodeData:x,handleResetNodeConfig:N,handleResetAllNodes:E,updateNodeCounter:g}},GR=({sourceId:e,datasetDisplayLabel:t,registerNode:n,prepareNodes:s,setNodes:i,setEdges:l,updateNodeCounter:c,scheduleFitView:u,onPipelineHydrated:d,onPipelineError:p})=>{const h=_.useRef(!1),f=Ls({queryKey:["feature-canvas","pipeline",e],queryFn:()=>iy(e),enabled:!!e,staleTime:60*1e3,retry:1});return _.useEffect(()=>{const g=`Dataset input
(${t})`;if(!e){if(h.current)i(b=>{let w=!1;const y=b.map(x=>{var E;return x.id!=="dataset-source"||(((E=x==null?void 0:x.data)==null?void 0:E.label)??"")===g?x:(w=!0,n({...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}))});return w?y:b});else{const b=IR(t),w=s(b.nodes);h.current=!0,i(w),l(b.edges),c(w),u(),d==null||d({nodes:w,edges:b.edges,pipeline:null,context:"sample"})}return}if(h.current=!1,f.isLoading){i(b=>b.map(w=>w.id==="dataset-source"?n({...w,data:{...w.data??{},label:g,isDataset:!0,isRemovable:!1}}):w));return}if(f.isError){const b=f.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",b),p==null||p(b);const w=Gu().map(x=>x.id==="dataset-source"?{...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}:x),y=s(w);i(y),l([]),c(y),u(),d==null||d({nodes:y,edges:[],pipeline:null,context:"reset"});return}if(f.data){const b=f.data.graph??{},w=Array.isArray(b==null?void 0:b.nodes)&&b.nodes.length?b.nodes:Gu(),y=s(w),N=(Array.isArray(b==null?void 0:b.edges)?b.edges:[]).map(E=>{var $;const S=E==null?void 0:E.type,j=!S||S==="smoothstep"||S==="default"?"animatedEdge":S,C=E==null?void 0:E.source,k=E==null?void 0:E.target,O=y.find(A=>A.id===k),R=(E==null?void 0:E.sourceHandle)??(C?`${C}-source`:void 0),P=(E==null?void 0:E.targetHandle)??(($=O==null?void 0:O.data)!=null&&$.isDataset?void 0:k?`${k}-target`:void 0);return{...E,animated:(E==null?void 0:E.animated)??!0,type:j,sourceHandle:R,targetHandle:P}});i(y),l(N),c(y),u(),d==null||d({nodes:y,edges:N,pipeline:f.data??null,context:"stored"});return}if(f.isFetched&&!f.data){const b=Gu().map(y=>y.id==="dataset-source"?{...y,data:{...y.data??{},label:g,isDataset:!0,isRemovable:!1}}:y),w=s(b);i(w),l([]),c(w),u(),d==null||d({nodes:w,edges:[],pipeline:null,context:"sample"})}},[t,d,p,f.data,f.error,f.isError,f.isFetched,f.isLoading,s,n,u,l,i,e,c]),{isPipelineLoading:f.isLoading||f.isFetching}},QR=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),XR=e=>{var n;const t=e?Ql[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(s=>s.required!==!1).map(s=>s.key):[]},JR=(e,t,n)=>{const s=XR(t);if(s.length===0)return!0;const i=n.filter(c=>c.target===e),l=new Set(i.map(c=>$x(e,c.targetHandle)).filter(c=>!!c));return s.every(c=>l.has(c))},ZR=(e,t)=>{const n=new Map,s=new Set;e.forEach(d=>{var h;const p=(h=d==null?void 0:d.data)==null?void 0:h.catalogType;if(p&&QR.has(p)){s.add(d.id);return}p==="train_test_split"&&n.set(d.id,new Set(Vr))});let i=!0,l=0;const c=e.length*3;for(;i&&l<c;)i=!1,l++,t.forEach(d=>{if(s.has(d.source)||s.has(d.target))return;const p=n.get(d.source),h=Ax(d.sourceHandle);if(!p||p.size===0)return;n.has(d.target)||n.set(d.target,new Set);const f=n.get(d.target),g=f.size;h?p.has(h)&&f.add(h):p.forEach(b=>f.add(b)),f.size>g&&(i=!0)});const u=new Map;return n.forEach((d,p)=>{!d.size||s.has(p)||u.set(p,Vr.filter(h=>d.has(h)))}),u},eL=e=>{const t=new Map;e.forEach(s=>{const i=Ax(s.sourceHandle);i&&(t.has(s.source)||t.set(s.source,new Set),t.get(s.source).add(i))});const n=new Map;return t.forEach((s,i)=>{n.set(i,Vr.filter(l=>s.has(l)))}),n},tL=({edges:e,setNodes:t,scheduleNodeInternalsUpdate:n})=>{_.useEffect(()=>{const s=[];t(i=>{const l=ZR(i,e),c=eL(e);let u=!1;const d=i.map(p=>{var k,O,R,P,$;const f=((k=p==null?void 0:p.data)==null?void 0:k.catalogType)==="train_test_split"?[...Vr]:l.get(p.id)??[],g=Wr((O=p.data)==null?void 0:O.activeSplits),b=Wr(c.get(p.id)),w=Wr((R=p.data)==null?void 0:R.connectedSplits),y=((P=p==null?void 0:p.data)==null?void 0:P.catalogType)??"",x=JR(p.id,y,e),N=(($=p.data)==null?void 0:$.hasRequiredConnections)??!0,E=!Mx(g,f),S=!Mx(w,b);if(!E&&!S&&!(x!==N))return p;const C={...p.data,hasRequiredConnections:x};return f.length?C.activeSplits=f:delete C.activeSplits,b.length?C.connectedSplits=b:delete C.connectedSplits,(E||S)&&s.push(p.id),u=!0,{...p,data:C}});return u?d:i}),s.length&&n(s)},[e,n,t])},nL=({nodes:e,setEdges:t,scheduleNodeInternalsUpdate:n})=>{const s=_.useCallback(l=>{var b,w;const{source:c,target:u,sourceHandle:d,targetHandle:p}=l;if(!c||!u||!p||c===u)return!1;const h=e.find(y=>y.id===u);if(!h)return!1;const f=((b=h==null?void 0:h.data)==null?void 0:b.catalogType)??"",g=f?Ql[f]:void 0;if((w=g==null?void 0:g.inputs)!=null&&w.length){const y=$x(u,p);if(!y)return!1;const x=g.inputs.find(N=>N.key===y);return!x||!d?!1:x.accepts&&x.accepts.length>0?x.accepts.some(N=>{const E=CR[N];return E?E(d):!1}):!0}return!0},[e]),i=_.useCallback(l=>{t(u=>N_({...l,type:"animatedEdge",animated:!0},u));const c=[l.source,l.target].filter(u=>!!u);c.length&&n(c)},[n,t]);return{isValidConnection:s,onConnect:i}},sL=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const i=Math.abs(n-e),l=Math.max(64,Math.min(i*.45,240)),c=Number.isFinite(l)?l:100,u=n>=e?1:-1,d=e+u*c,p=t,h=n-u*c;return`M ${e},${t} C ${d},${p} ${h},${s} ${n},${s}`},rL=({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:i,targetPosition:l})=>{const c=sL(e,t,n,s),u="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:u,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:s,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:s,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},aL=({nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:i,onEdgesChange:l,onConnect:c,isValidConnection:u,onNodeClick:d,reactFlowInstanceRef:p,canvasViewportRef:h,handleResetAllNodes:f,openCatalog:g})=>a.jsxs("div",{className:"canvas-stage__viewport",ref:h,children:[a.jsxs(Hv,{style:{width:"100%",height:"100%"},nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:i,onEdgesChange:l,onConnect:c,isValidConnection:u,onNodeClick:d,onInit:b=>{p.current=b,requestAnimationFrame(()=>b.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:go.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:rL,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(TE,{position:"bottom-left"}),a.jsx(zE,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:f,"aria-label":"Reset preprocessing nodes",children:""}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:g,"aria-label":"Open node catalog",children:"+"})]}),oL=_.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:s,onPipelineError:i},l)=>{const c=_.useMemo(()=>({featureNode:AR}),[]),u=_.useMemo(()=>({animatedEdge:ck}),[]),[d,p,h]=ak(Gu().map(He=>({...He,type:"featureNode"}))),[f,g,b]=ok(DR()),[w,y]=_.useState(null),[x,N]=_.useState(!1),E=_.useRef(null),S=_.useRef(null),j=_.useRef(!1),C=t??e??"Demo dataset",k=FE(),{nodeCatalog:O,catalogEntryMapRef:R,isCatalogOpen:P,openCatalog:$,closeCatalog:A,isCatalogLoading:D,catalogErrorMessage:V}=VR(),z=_.useCallback(He=>{const de=(Array.isArray(He)?He:[He]).filter(Boolean);if(!de.length)return;const ge=Array.from(new Set(de));requestAnimationFrame(()=>{requestAnimationFrame(()=>{ge.forEach(Ne=>{k(Ne)})})})},[k]);tL({edges:f,setNodes:p,scheduleNodeInternalsUpdate:z});const F=_.useMemo(()=>d.find(He=>He.id===w)??null,[d,w]),q=_.useMemo(()=>HR(d,f),[f,d]),G=_.useCallback(He=>{y(He),N(!0)},[]),W=_.useCallback(()=>{N(!1),y(null)},[]),X=_.useCallback(()=>{j.current=!0},[]);_.useEffect(()=>{j.current&&(j.current=!1,requestAnimationFrame(()=>{var He;(He=E.current)==null||He.fitView({padding:.25,duration:350})}))},[f,d]);const{registerNode:I,handleAddNode:L,handleUpdateNodeConfig:U,handleUpdateNodeData:te,handleResetNodeConfig:K,handleResetAllNodes:H,updateNodeCounter:Y}=YR({setNodes:p,setEdges:g,setSelectedNodeId:y,setIsSettingsModalOpen:N,catalogEntryMapRef:R,handleOpenSettings:G,reactFlowInstanceRef:E,canvasViewportRef:S,scheduleFitView:X});_.useEffect(()=>{Y(d)},[d,Y]);const Q=_.useCallback(He=>He.map(de=>{const ge={...de.data??{}};de.id==="dataset-source"&&(ge.label=`Dataset input
(${C})`,ge.isDataset=!0,ge.isRemovable=!1,ge.isConfigured=!0);const Ne=ge.catalogType??ge.type??de.id;return ge.config&&typeof ge.config=="object"&&Ku(Ne)&&delete ge.config[Eo],ge.isConfigured===void 0&&(ge.config&&typeof ge.config=="object"?ge.isConfigured=Ku(Ne)?!0:!ge.config[Eo]:ge.isConfigured=!0),I({...de,data:ge})}),[C,I]),{isPipelineLoading:ne}=GR({sourceId:e,datasetDisplayLabel:C,registerNode:I,prepareNodes:Q,setNodes:p,setEdges:g,updateNodeCounter:Y,scheduleFitView:X,onPipelineHydrated:s,onPipelineError:i}),J=_.useCallback(()=>{p(He=>{const de=He.find(Ne=>Ne.id==="dataset-source");return[I(de?{...de,data:{...de.data??{},label:`Dataset input
(${C})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${C})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),g([]),y(null),N(!1),X()},[C,I,X,g,p,y,N]);_.useImperativeHandle(l,()=>({openCatalog:$,closeCatalog:A,clearGraph:J}),[J,A,$]);const{isValidConnection:re,onConnect:Se}=nL({nodes:d,setEdges:g,scheduleNodeInternalsUpdate:z});_.useEffect(()=>{n==null||n(d,f)},[f,d,n]);const ze=_.useMemo(()=>{var ge;if(!F)return null;const He=(ge=F==null?void 0:F.data)==null?void 0:ge.catalogType;if(!He)return null;const de=R.current.get(He);return de?Yu(de):null},[F]),$e=_.useMemo(()=>{var de,ge;if(!F||(de=F.data)!=null&&de.isDataset)return!1;const He=(ge=F==null?void 0:F.data)==null?void 0:ge.catalogType;return Fx(typeof He=="string"?He:null,R.current)},[F]),{sidebarContent:Be}=KR({nodeCatalog:O,isCatalogLoading:D,catalogErrorMessage:V,handleAddNode:L}),it=_.useCallback((He,de)=>{G(de.id)},[G]);return a.jsxs("div",{className:"canvas-stage","data-pipeline-loading":ne?"true":"false","aria-busy":ne,children:[a.jsx(aL,{nodes:d,edges:f,nodeTypes:c,edgeTypes:u,onNodesChange:h,onEdgesChange:b,onConnect:Se,isValidConnection:re,onNodeClick:it,reactFlowInstanceRef:E,canvasViewportRef:S,handleResetAllNodes:H,openCatalog:$}),a.jsxs("div",{className:`canvas-drawer${P?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:A,"aria-label":"Close catalog",children:""})]}),a.jsx("div",{className:"canvas-drawer__body",children:Be})]}),P&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:A}),x&&F&&a.jsx(wR,{node:F,sourceId:e??null,graphSnapshot:q,onClose:W,onUpdateConfig:U,onUpdateNodeData:te,onResetConfig:K,defaultConfigTemplate:ze,isResetAvailable:$e})]})}),Bx=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},tf=e=>{const t=Bx(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},nf=e=>{const t=Bx(e);if(!t)return null;const n=t.getTime(),s=Date.now()-n,i=Math.round(s/6e4);if(i<1)return"just now";if(i===1)return"1 minute ago";if(i<60)return`${i} minutes ago`;const l=Math.round(i/60);if(l===1)return"1 hour ago";if(l<24)return`${l} hours ago`;const c=Math.round(l/24);if(c===1)return"1 day ago";if(c<7)return`${c} days ago`;const u=Math.round(c/7);return u===1?"1 week ago":`${u} weeks ago`},iL=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:i,canSelectDatasets:l,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:b,isHistoryLoading:w,historyErrorMessage:y,historyItems:x,activePipelineId:N,isDirty:E,isSaveDisabled:S,saveButtonLabel:j,saveFeedback:C,feedbackIcon:k,feedbackClass:O,onSelectHistory:R})=>{const P=d?(u==null?void 0:u.name)??d:null;return a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),e&&a.jsx("span",{className:"canvas-sidepanel__meta",children:nf(e)??tf(e)})]}),t?a.jsx("p",{className:"text-danger",children:t}):i?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:d??"",onChange:$=>h($.target.value),disabled:n||!l,"aria-label":"Select dataset",children:c.map($=>a.jsx("option",{value:$.value,disabled:!$.isOwned,children:`${$.label}${$.isOwned?"":" (locked)"}`},$.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),n&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!n&&!s&&!t&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:u.description}),P&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:P})]}),!l&&i>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:f,disabled:!p,"aria-label":"Clean all nodes",title:p?"Remove all nodes and edges from the canvas":"Nothing to clean yet",children:[a.jsx("span",{"aria-hidden":"true",children:""}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:g,disabled:w||!d,"aria-label":"Refresh history",title:"Refresh history",children:""}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:b,disabled:S,"aria-label":j,title:j,children:""})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:w?a.jsx("p",{className:"text-muted",children:"Loading history"}):y?a.jsx("p",{className:"text-danger",children:y}):x.length?x.map($=>{const D=nf($.updated_at)??tf($.updated_at),V=$.id===N,z=V&&!E;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${V?" canvas-sidepanel__history-item--active":""}`,onClick:()=>R($),disabled:z,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:$.name||`Pipeline #${$.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:D}),V&&E&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},$.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),C&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${O}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:k}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:C.message})]})]})},lL=e=>{var b;const[t,n]=_.useState(e??null),[s,i]=_.useState(null),l=Ls({queryKey:["feature-canvas","datasets"],queryFn:()=>Yv(12),staleTime:5*60*1e3}),c=l.data??[],u=_.useMemo(()=>c.filter(w=>(w==null?void 0:w.is_owned)!==!1),[c]);_.useEffect(()=>{if(!c.length){i(null);return}if(t){const y=c.find(x=>x.source_id===t);if(y){i(x=>(x==null?void 0:x.id)===y.id?x:y);return}}const w=u[0]??c[0];w&&(t||n(w.source_id??String(w.id)),i(w))},[t,c,u]);const d=_.useMemo(()=>c.map(w=>({value:w.source_id,label:w.name??w.source_id,isOwned:w.is_owned!==!1})),[c]),p=u.length>1,h=c.length>0,f=u.length,g=l.error?((b=l.error)==null?void 0:b.message)??"Unable to load datasets":null;return{datasets:c,ownedDatasets:u,selectedDataset:s,setSelectedDataset:i,activeSourceId:t,setActiveSourceId:n,datasetOptions:d,canSelectDatasets:p,hasDatasets:h,ownedDatasetsCount:f,isDatasetLoading:l.isLoading,datasetErrorMessage:g}},cL=({sourceId:e,setIsDirty:t,setSaveFeedback:n,isHydratingRef:s})=>{const i=lL(e),{datasets:l,setActiveSourceId:c,setSelectedDataset:u}=i,d=_.useCallback(p=>{const h=l.find(f=>f.source_id===p)??null;if(!h){n({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(h.is_owned===!1){n({message:"Only datasets you own can be selected.",tone:"error"});return}c(p),u(h),s.current=!0,t(!1),n(null)},[l,s,c,t,n,u]);return{...i,handleDatasetSelection:d}},Ux=(e,t)=>({nodes:JSON.parse(JSON.stringify(e??[])),edges:JSON.parse(JSON.stringify(t??[]))}),qx=e=>Array.isArray(e)?e.some(t=>(t==null?void 0:t.id)&&t.id!=="dataset-source"):!1,Hx=e=>Array.isArray(e)?e.length>0:!1,uL=({setIsDirty:e,setSaveFeedback:t,isHydratingRef:n})=>{const s=_.useRef({nodes:[],edges:[]}),[i,l]=_.useState(!1),c=_.useCallback((d,p)=>{const h=Ux(d,p);s.current=h;const f=qx(h.nodes),g=Hx(h.edges);return l(f||g),{hasCustomNodes:f,hasEdges:g}},[]),u=_.useCallback((d,p)=>{const h=Ux(d,p),f=s.current,g=JSON.stringify(f.nodes??[])===JSON.stringify(h.nodes??[])&&JSON.stringify(f.edges??[])===JSON.stringify(h.edges??[]);s.current=h;const b=qx(h.nodes),w=Hx(h.edges);l(b||w),!(n.current||g)&&(e(!0),t(null))},[n,e,t]);return{graphSnapshotRef:s,canClearCanvas:i,handleGraphChange:u,applyHydratedSnapshot:c}},dL=({canvasShellRef:e,canClearCanvas:t,setSaveFeedback:n})=>_.useCallback(()=>{var s;t&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((s=e.current)==null||s.clearGraph(),n(i=>(i==null?void 0:i.tone)==="error"?i:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[e,t,n]),mL=({activeSourceId:e,isDirty:t,setSaveFeedback:n,pipelineQueryKey:s,pendingHistoryIdRef:i,isHydratingRef:l,historyLimit:c=FR})=>{var h;const u=uo(),d=Ls({queryKey:["feature-canvas","pipeline-history",e],queryFn:()=>cy(e,c),enabled:!!e,staleTime:30*1e3,retry:1}),p=_.useCallback(f=>{if(!(f!=null&&f.graph)){n({message:"Selected revision is missing pipeline data.",tone:"error"});return}t&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(i.current=f.id??null,l.current=!0,n({message:`Loading revision ${f.name??`#${f.id}`}`,tone:"info"}),u.setQueryData(s,f))},[t,l,i,s,u,n]);return{historyItems:d.data??[],isHistoryLoading:d.isLoading||d.isFetching,historyErrorMessage:d.error?((h=d.error)==null?void 0:h.message)??"Unable to load history":null,refetchHistory:d.refetch,handleHistorySelection:p}},hL=({applyHydratedSnapshot:e,selectedDataset:t,activeSourceId:n,setActivePipelineId:s,setActivePipelineName:i,setActivePipelineUpdatedAt:l,setIsDirty:c,setSaveFeedback:u,pendingHistoryIdRef:d,isHydratingRef:p})=>{const h=_.useCallback(g=>{const{nodes:b,edges:w,pipeline:y,context:x}=g,{hasCustomNodes:N}=e(b,w),E=(y==null?void 0:y.id)??null;if(s(E),i((y==null?void 0:y.name)??null),l((y==null?void 0:y.updated_at)??null),x==="stored"&&y)if(d.current===y.id){const j=nf(y.updated_at)??tf(y.updated_at);u({message:`Saved revision ${y.name??`#${y.id}`} (${j})`,tone:"info"}),d.current=null}else p.current&&u(S=>(S==null?void 0:S.tone)==="error"?S:N?{message:"Loaded saved pipeline",tone:"info"}:S);else x==="sample"?(d.current=null,u(S=>(S==null?void 0:S.tone)==="error"||N?S:{message:`Showing starter pipeline for ${(t==null?void 0:t.name)??(t==null?void 0:t.source_id)??n??"demo dataset"}`,tone:"info"})):x==="reset"?d.current=null:y||(d.current=null,u(S=>(S==null?void 0:S.tone)==="error"?S:null));p.current&&c(!1),y&&d.current&&d.current!==y.id&&(d.current=null),p.current=!1},[n,e,d,t,s,i,l,c,u,p]),f=_.useCallback(g=>{u({message:(g==null?void 0:g.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[u]);return{handlePipelineHydrated:h,handlePipelineError:f}},fL=({queryClient:e,setSaveFeedback:t,setIsDirty:n,setActivePipelineId:s,setActivePipelineName:i,setActivePipelineUpdatedAt:l,pendingHistoryIdRef:c})=>{const{mutate:u,isPending:d}=qc({mutationFn:async({sourceId:p,payload:h})=>ly(p,h),onSuccess:(p,h)=>{t({message:"Draft saved successfully.",tone:"success"}),n(!1),s(p.id??null),i(p.name??null),l(p.updated_at??null),c.current=p.id??null,e.setQueryData(["feature-canvas","pipeline",h.sourceId],p),e.invalidateQueries({queryKey:["feature-canvas","pipeline-history",h.sourceId],exact:!1})},onError:p=>{t({message:(p==null?void 0:p.message)??"Failed to save pipeline.",tone:"error"})}});return{triggerSave:u,isSaving:d}},pL=e=>e==="success"?"":e==="error"?"":"",gL=e=>e==="error"?"text-danger":e==="success"?"text-success":"text-muted",_L=()=>{const[e,t]=_.useState(null);_.useEffect(()=>{if(!e||e.tone==="error"||typeof window>"u")return;const i=window.setTimeout(()=>t(null),e.tone==="success"?4e3:2500);return()=>window.clearTimeout(i)},[e]);const n=_.useMemo(()=>pL(e==null?void 0:e.tone),[e]),s=_.useMemo(()=>gL(e==null?void 0:e.tone),[e]);return{saveFeedback:e,setSaveFeedback:t,feedbackIcon:n,feedbackClass:s}},vL=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:i,canSelectDatasets:l,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:b,isHistoryLoading:w,historyErrorMessage:y,historyItems:x,activePipelineId:N,isDirty:E,isSaving:S,saveFeedback:j,feedbackIcon:C,feedbackClass:k,onSelectHistory:O})=>({sidepanelProps:{activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:i,canSelectDatasets:l,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:p,onDatasetSelection:h,onClearCanvas:f,onRefreshHistory:g,onSaveClick:b,isHistoryLoading:w,historyErrorMessage:y,historyItems:x,activePipelineId:N,isDirty:E,isSaveDisabled:!d||S,saveButtonLabel:S?"Saving":E?"Save draft*":"Save draft",saveFeedback:j,feedbackIcon:C,feedbackClass:k,onSelectHistory:O}}),yL=(e=!0)=>{const[t,n]=_.useState(e),s=_.useCallback(()=>{n(i=>!i)},[]);return{isSidepanelExpanded:t,handleToggleSidepanel:s}},bL=e=>{const t=e==null?void 0:e.type;return!t||t==="smoothstep"||t==="default"?"animatedEdge":t},xL=({snapshot:e,selectedDataset:t,activeSourceId:n})=>{const s=e.nodes??[],i=e.edges??[];return{name:t!=null&&t.name?`Draft pipeline for ${t.name}`:`Draft pipeline for ${n}`,graph:{nodes:s,edges:i.map(l=>({...l,animated:(l==null?void 0:l.animated)??!0,type:bL(l)}))},metadata:{lastClientSave:new Date().toISOString(),nodeCount:s.length,edgeCount:i.length}}},wL=({sourceId:e})=>{const t=uo(),n=_.useRef(null),s=_.useRef(!0),{isSidepanelExpanded:i,handleToggleSidepanel:l}=yL(!0),[c,u]=_.useState(!1),{saveFeedback:d,setSaveFeedback:p,feedbackIcon:h,feedbackClass:f}=_L(),{selectedDataset:g,activeSourceId:b,datasetOptions:w,canSelectDatasets:y,hasDatasets:x,ownedDatasetsCount:N,isDatasetLoading:E,datasetErrorMessage:S,handleDatasetSelection:j}=cL({sourceId:e,setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),[C,k]=_.useState(null),[O,R]=_.useState(null),[P,$]=_.useState(null),A=_.useMemo(()=>["feature-canvas","pipeline",b],[b]),D=_.useRef(null),{graphSnapshotRef:V,canClearCanvas:z,handleGraphChange:F,applyHydratedSnapshot:q}=uL({setIsDirty:u,setSaveFeedback:p,isHydratingRef:s}),G=dL({canvasShellRef:n,canClearCanvas:z,setSaveFeedback:p}),{historyItems:W,isHistoryLoading:X,historyErrorMessage:I,refetchHistory:L,handleHistorySelection:U}=mL({activeSourceId:b,isDirty:c,setSaveFeedback:p,pipelineQueryKey:A,pendingHistoryIdRef:D,isHydratingRef:s}),{triggerSave:te,isSaving:K}=fL({queryClient:t,setSaveFeedback:p,setIsDirty:u,setActivePipelineId:k,setActivePipelineName:$,setActivePipelineUpdatedAt:R,pendingHistoryIdRef:D}),{handlePipelineHydrated:H,handlePipelineError:Y}=hL({applyHydratedSnapshot:q,selectedDataset:g,activeSourceId:b,setActivePipelineId:k,setActivePipelineName:$,setActivePipelineUpdatedAt:R,setIsDirty:u,setSaveFeedback:p,pendingHistoryIdRef:D,isHydratingRef:s}),Q=_.useCallback(()=>{if(!b){p({message:"Select a dataset before saving.",tone:"error"});return}const J=V.current;if(!J.nodes||!J.nodes.length){p({message:"Add nodes to the canvas before saving.",tone:"error"});return}const re=xL({snapshot:J,selectedDataset:g,activeSourceId:b});p({message:"Saving draft",tone:"info"}),te({sourceId:b,payload:re})},[b,g==null?void 0:g.name,te]),{sidepanelProps:ne}=vL({activePipelineUpdatedAt:O,datasetErrorMessage:S,isDatasetLoading:E,hasDatasets:x,ownedDatasetsCount:N,canSelectDatasets:y,datasetOptions:w,selectedDataset:g,activeSourceId:b,canClearCanvas:z,onDatasetSelection:j,onClearCanvas:G,onRefreshHistory:()=>{L()},onSaveClick:Q,isHistoryLoading:X,historyErrorMessage:I,historyItems:W,activePipelineId:C,isDirty:c,isSaving:K,saveFeedback:d,feedbackIcon:h,feedbackClass:f,onSelectHistory:U});return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":i?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:l,"aria-label":i?"Collapse details panel":"Expand details panel","aria-expanded":i,"aria-controls":"feature-canvas-sidepanel",children:i?"":""}),!i&&d&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${f}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:h}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:d.message})]}),i&&a.jsx(iL,{...ne}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(Vv,{children:a.jsx(oL,{ref:n,sourceId:b,datasetName:(g==null?void 0:g.name)??(g==null?void 0:g.source_id)??null,onGraphChange:F,onPipelineHydrated:H,onPipelineError:Y})})})]})},NL=new mN,sf=document.getElementById("ml-workflow-root");if(!sf)throw new Error("ML workflow root element not found");const jL=um.createRoot(sf),CL=sf.getAttribute("data-source-id")||void 0;jL.render(a.jsx(_e.StrictMode,{children:a.jsx(hN,{client:NL,children:a.jsx(wL,{sourceId:CL})})}))})();
//# sourceMappingURL=feature-canvas.js.map
