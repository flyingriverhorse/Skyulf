var Qw=Tn=>{throw TypeError(Tn)};var $_=(Tn,Vn,Wn)=>Vn.has(Tn)||Qw("Cannot "+Wn);var ue=(Tn,Vn,Wn)=>($_(Tn,Vn,"read from private field"),Wn?Wn.call(Tn):Vn.get(Tn)),ft=(Tn,Vn,Wn)=>Vn.has(Tn)?Qw("Cannot add the same private member more than once"):Vn instanceof WeakSet?Vn.add(Tn):Vn.set(Tn,Wn),Ze=(Tn,Vn,Wn,Dl)=>($_(Tn,Vn,"write to private field"),Dl?Dl.call(Tn,Wn):Vn.set(Tn,Wn),Wn),zt=(Tn,Vn,Wn)=>($_(Tn,Vn,"access private method"),Wn);var op=(Tn,Vn,Wn,Dl)=>({set _($t){Ze(Tn,Vn,$t,Wn)},get _(){return ue(Tn,Vn,Dl)}});(function(){"use strict";var Vo,e_,Tw,ni,Wo,hc,$w,pc,Ko,gc,Dw,si,Lw,ri,_c,Pr,ai,rs,bd,oi,Zr,zo,zw,Vs,Wt,xd,Ms,li,vc,ao,Yo,wd,yc,bc,ii,ci,Qo,xc,tn,Lm,D_,L_,z_,R_,F_,I_,B_,Gw,Rw,jd,Ma,As,ui,Aa,$l,Fw,oo,ea,Nd,Iw,lo,Go,Ws,io,co,lp,U_,Bw,Oa,Uw,$n,Xo,Jo,wc,jc,Zo,Nc,Sc,qw;function Tn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Vn={exports:{}},Wn={},Dl={exports:{}},$t={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q_;function Xw(){if(q_)return $t;q_=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),u=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function _(K){return K===null||typeof K!="object"?null:(K=v&&K[v]||K["@@iterator"],typeof K=="function"?K:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},j=Object.assign,S={};function k(K,J,te){this.props=K,this.context=J,this.refs=S,this.updater=te||x}k.prototype.isReactComponent={},k.prototype.setState=function(K,J){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,J,"setState")},k.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function M(){}M.prototype=k.prototype;function P(K,J,te){this.props=K,this.context=J,this.refs=S,this.updater=te||x}var T=P.prototype=new M;T.constructor=P,j(T,k.prototype),T.isPureReactComponent=!0;var w=Array.isArray,A=Object.prototype.hasOwnProperty,E={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function $(K,J,te){var Y,U={},Z=null,ie=null;if(J!=null)for(Y in J.ref!==void 0&&(ie=J.ref),J.key!==void 0&&(Z=""+J.key),J)A.call(J,Y)&&!D.hasOwnProperty(Y)&&(U[Y]=J[Y]);var re=arguments.length-2;if(re===1)U.children=te;else if(1<re){for(var pe=Array(re),xe=0;xe<re;xe++)pe[xe]=arguments[xe+2];U.children=pe}if(K&&K.defaultProps)for(Y in re=K.defaultProps,re)U[Y]===void 0&&(U[Y]=re[Y]);return{$$typeof:e,type:K,key:Z,ref:ie,props:U,_owner:E.current}}function F(K,J){return{$$typeof:e,type:K.type,key:J,ref:K.ref,props:K.props,_owner:K._owner}}function R(K){return typeof K=="object"&&K!==null&&K.$$typeof===e}function B(K){var J={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(te){return J[te]})}var ee=/\/+/g;function le(K,J){return typeof K=="object"&&K!==null&&K.key!=null?B(""+K.key):J.toString(36)}function z(K,J,te,Y,U){var Z=typeof K;(Z==="undefined"||Z==="boolean")&&(K=null);var ie=!1;if(K===null)ie=!0;else switch(Z){case"string":case"number":ie=!0;break;case"object":switch(K.$$typeof){case e:case t:ie=!0}}if(ie)return ie=K,U=U(ie),K=Y===""?"."+le(ie,0):Y,w(U)?(te="",K!=null&&(te=K.replace(ee,"$&/")+"/"),z(U,J,te,"",function(xe){return xe})):U!=null&&(R(U)&&(U=F(U,te+(!U.key||ie&&ie.key===U.key?"":(""+U.key).replace(ee,"$&/")+"/")+K)),J.push(U)),1;if(ie=0,Y=Y===""?".":Y+":",w(K))for(var re=0;re<K.length;re++){Z=K[re];var pe=Y+le(Z,re);ie+=z(Z,J,te,pe,U)}else if(pe=_(K),typeof pe=="function")for(K=pe.call(K),re=0;!(Z=K.next()).done;)Z=Z.value,pe=Y+le(Z,re++),ie+=z(Z,J,te,pe,U);else if(Z==="object")throw J=String(K),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.");return ie}function G(K,J,te){if(K==null)return K;var Y=[],U=0;return z(K,Y,"","",function(Z){return J.call(te,Z,U++)}),Y}function W(K){if(K._status===-1){var J=K._result;J=J(),J.then(function(te){(K._status===0||K._status===-1)&&(K._status=1,K._result=te)},function(te){(K._status===0||K._status===-1)&&(K._status=2,K._result=te)}),K._status===-1&&(K._status=0,K._result=J)}if(K._status===1)return K._result.default;throw K._result}var H={current:null},V={transition:null},ne={ReactCurrentDispatcher:H,ReactCurrentBatchConfig:V,ReactCurrentOwner:E};function Q(){throw Error("act(...) is not supported in production builds of React.")}return $t.Children={map:G,forEach:function(K,J,te){G(K,function(){J.apply(this,arguments)},te)},count:function(K){var J=0;return G(K,function(){J++}),J},toArray:function(K){return G(K,function(J){return J})||[]},only:function(K){if(!R(K))throw Error("React.Children.only expected to receive a single React element child.");return K}},$t.Component=k,$t.Fragment=n,$t.Profiler=l,$t.PureComponent=P,$t.StrictMode=r,$t.Suspense=m,$t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,$t.act=Q,$t.cloneElement=function(K,J,te){if(K==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+K+".");var Y=j({},K.props),U=K.key,Z=K.ref,ie=K._owner;if(J!=null){if(J.ref!==void 0&&(Z=J.ref,ie=E.current),J.key!==void 0&&(U=""+J.key),K.type&&K.type.defaultProps)var re=K.type.defaultProps;for(pe in J)A.call(J,pe)&&!D.hasOwnProperty(pe)&&(Y[pe]=J[pe]===void 0&&re!==void 0?re[pe]:J[pe])}var pe=arguments.length-2;if(pe===1)Y.children=te;else if(1<pe){re=Array(pe);for(var xe=0;xe<pe;xe++)re[xe]=arguments[xe+2];Y.children=re}return{$$typeof:e,type:K.type,key:U,ref:Z,props:Y,_owner:ie}},$t.createContext=function(K){return K={$$typeof:u,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},K.Provider={$$typeof:i,_context:K},K.Consumer=K},$t.createElement=$,$t.createFactory=function(K){var J=$.bind(null,K);return J.type=K,J},$t.createRef=function(){return{current:null}},$t.forwardRef=function(K){return{$$typeof:d,render:K}},$t.isValidElement=R,$t.lazy=function(K){return{$$typeof:p,_payload:{_status:-1,_result:K},_init:W}},$t.memo=function(K,J){return{$$typeof:y,type:K,compare:J===void 0?null:J}},$t.startTransition=function(K){var J=V.transition;V.transition={};try{K()}finally{V.transition=J}},$t.unstable_act=Q,$t.useCallback=function(K,J){return H.current.useCallback(K,J)},$t.useContext=function(K){return H.current.useContext(K)},$t.useDebugValue=function(){},$t.useDeferredValue=function(K){return H.current.useDeferredValue(K)},$t.useEffect=function(K,J){return H.current.useEffect(K,J)},$t.useId=function(){return H.current.useId()},$t.useImperativeHandle=function(K,J,te){return H.current.useImperativeHandle(K,J,te)},$t.useInsertionEffect=function(K,J){return H.current.useInsertionEffect(K,J)},$t.useLayoutEffect=function(K,J){return H.current.useLayoutEffect(K,J)},$t.useMemo=function(K,J){return H.current.useMemo(K,J)},$t.useReducer=function(K,J,te){return H.current.useReducer(K,J,te)},$t.useRef=function(K){return H.current.useRef(K)},$t.useState=function(K){return H.current.useState(K)},$t.useSyncExternalStore=function(K,J,te){return H.current.useSyncExternalStore(K,J,te)},$t.useTransition=function(){return H.current.useTransition()},$t.version="18.3.1",$t}Dl.exports=Xw();var f=Dl.exports;const Ae=Tn(f);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var H_;function Jw(){if(H_)return Wn;H_=1;var e=f,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,l=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function u(d,m,y){var p,v={},_=null,x=null;y!==void 0&&(_=""+y),m.key!==void 0&&(_=""+m.key),m.ref!==void 0&&(x=m.ref);for(p in m)r.call(m,p)&&!i.hasOwnProperty(p)&&(v[p]=m[p]);if(d&&d.defaultProps)for(p in m=d.defaultProps,m)v[p]===void 0&&(v[p]=m[p]);return{$$typeof:t,type:d,key:_,ref:x,props:v,_owner:l.current}}return Wn.Fragment=n,Wn.jsx=u,Wn.jsxs=u,Wn}Vn.exports=Jw();var a=Vn.exports,ip={},V_={exports:{}},Bs={},cp={exports:{}},up={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var W_;function Zw(){return W_||(W_=1,function(e){function t(V,ne){var Q=V.length;V.push(ne);e:for(;0<Q;){var K=Q-1>>>1,J=V[K];if(0<l(J,ne))V[K]=ne,V[Q]=J,Q=K;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var ne=V[0],Q=V.pop();if(Q!==ne){V[0]=Q;e:for(var K=0,J=V.length,te=J>>>1;K<te;){var Y=2*(K+1)-1,U=V[Y],Z=Y+1,ie=V[Z];if(0>l(U,Q))Z<J&&0>l(ie,U)?(V[K]=ie,V[Z]=Q,K=Z):(V[K]=U,V[Y]=Q,K=Y);else if(Z<J&&0>l(ie,Q))V[K]=ie,V[Z]=Q,K=Z;else break e}}return ne}function l(V,ne){var Q=V.sortIndex-ne.sortIndex;return Q!==0?Q:V.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var u=Date,d=u.now();e.unstable_now=function(){return u.now()-d}}var m=[],y=[],p=1,v=null,_=3,x=!1,j=!1,S=!1,k=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(V){for(var ne=n(y);ne!==null;){if(ne.callback===null)r(y);else if(ne.startTime<=V)r(y),ne.sortIndex=ne.expirationTime,t(m,ne);else break;ne=n(y)}}function w(V){if(S=!1,T(V),!j)if(n(m)!==null)j=!0,W(A);else{var ne=n(y);ne!==null&&H(w,ne.startTime-V)}}function A(V,ne){j=!1,S&&(S=!1,M($),$=-1),x=!0;var Q=_;try{for(T(ne),v=n(m);v!==null&&(!(v.expirationTime>ne)||V&&!B());){var K=v.callback;if(typeof K=="function"){v.callback=null,_=v.priorityLevel;var J=K(v.expirationTime<=ne);ne=e.unstable_now(),typeof J=="function"?v.callback=J:v===n(m)&&r(m),T(ne)}else r(m);v=n(m)}if(v!==null)var te=!0;else{var Y=n(y);Y!==null&&H(w,Y.startTime-ne),te=!1}return te}finally{v=null,_=Q,x=!1}}var E=!1,D=null,$=-1,F=5,R=-1;function B(){return!(e.unstable_now()-R<F)}function ee(){if(D!==null){var V=e.unstable_now();R=V;var ne=!0;try{ne=D(!0,V)}finally{ne?le():(E=!1,D=null)}}else E=!1}var le;if(typeof P=="function")le=function(){P(ee)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,G=z.port2;z.port1.onmessage=ee,le=function(){G.postMessage(null)}}else le=function(){k(ee,0)};function W(V){D=V,E||(E=!0,le())}function H(V,ne){$=k(function(){V(e.unstable_now())},ne)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(V){V.callback=null},e.unstable_continueExecution=function(){j||x||(j=!0,W(A))},e.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<V?Math.floor(1e3/V):5},e.unstable_getCurrentPriorityLevel=function(){return _},e.unstable_getFirstCallbackNode=function(){return n(m)},e.unstable_next=function(V){switch(_){case 1:case 2:case 3:var ne=3;break;default:ne=_}var Q=_;_=ne;try{return V()}finally{_=Q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(V,ne){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var Q=_;_=V;try{return ne()}finally{_=Q}},e.unstable_scheduleCallback=function(V,ne,Q){var K=e.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?K+Q:K):Q=K,V){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=Q+J,V={id:p++,callback:ne,priorityLevel:V,startTime:Q,expirationTime:J,sortIndex:-1},Q>K?(V.sortIndex=Q,t(y,V),n(m)===null&&V===n(y)&&(S?(M($),$=-1):S=!0,H(w,Q-K))):(V.sortIndex=J,t(m,V),j||x||(j=!0,W(A))),V},e.unstable_shouldYield=B,e.unstable_wrapCallback=function(V){var ne=_;return function(){var Q=_;_=ne;try{return V.apply(this,arguments)}finally{_=Q}}}}(up)),up}var K_;function ej(){return K_||(K_=1,cp.exports=Zw()),cp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Y_;function tj(){if(Y_)return Bs;Y_=1;var e=f,t=ej();function n(s){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+s,c=1;c<arguments.length;c++)o+="&args[]="+encodeURIComponent(arguments[c]);return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,l={};function i(s,o){u(s,o),u(s+"Capture",o)}function u(s,o){for(l[s]=o,s=0;s<o.length;s++)r.add(o[s])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},v={};function _(s){return m.call(v,s)?!0:m.call(p,s)?!1:y.test(s)?v[s]=!0:(p[s]=!0,!1)}function x(s,o,c,h){if(c!==null&&c.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:c!==null?!c.acceptsBooleans:(s=s.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-");default:return!1}}function j(s,o,c,h){if(o===null||typeof o>"u"||x(s,o,c,h))return!0;if(h)return!1;if(c!==null)switch(c.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function S(s,o,c,h,b,C,L){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=b,this.mustUseProperty=c,this.propertyName=s,this.type=o,this.sanitizeURL=C,this.removeEmptyString=L}var k={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(s){k[s]=new S(s,0,!1,s,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(s){var o=s[0];k[o]=new S(o,1,!1,s[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(s){k[s]=new S(s,2,!1,s.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(s){k[s]=new S(s,2,!1,s,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(s){k[s]=new S(s,3,!1,s.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(s){k[s]=new S(s,3,!0,s,null,!1,!1)}),["capture","download"].forEach(function(s){k[s]=new S(s,4,!1,s,null,!1,!1)}),["cols","rows","size","span"].forEach(function(s){k[s]=new S(s,6,!1,s,null,!1,!1)}),["rowSpan","start"].forEach(function(s){k[s]=new S(s,5,!1,s.toLowerCase(),null,!1,!1)});var M=/[\-:]([a-z])/g;function P(s){return s[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(s){var o=s.replace(M,P);k[o]=new S(o,1,!1,s,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(s){var o=s.replace(M,P);k[o]=new S(o,1,!1,s,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(s){var o=s.replace(M,P);k[o]=new S(o,1,!1,s,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(s){k[s]=new S(s,1,!1,s.toLowerCase(),null,!1,!1)}),k.xlinkHref=new S("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(s){k[s]=new S(s,1,!1,s.toLowerCase(),null,!0,!0)});function T(s,o,c,h){var b=k.hasOwnProperty(o)?k[o]:null;(b!==null?b.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(j(o,c,b,h)&&(c=null),h||b===null?_(o)&&(c===null?s.removeAttribute(o):s.setAttribute(o,""+c)):b.mustUseProperty?s[b.propertyName]=c===null?b.type===3?!1:"":c:(o=b.attributeName,h=b.attributeNamespace,c===null?s.removeAttribute(o):(b=b.type,c=b===3||b===4&&c===!0?"":""+c,h?s.setAttributeNS(h,o,c):s.setAttribute(o,c))))}var w=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),E=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),$=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),R=Symbol.for("react.provider"),B=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),le=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),H=Symbol.for("react.offscreen"),V=Symbol.iterator;function ne(s){return s===null||typeof s!="object"?null:(s=V&&s[V]||s["@@iterator"],typeof s=="function"?s:null)}var Q=Object.assign,K;function J(s){if(K===void 0)try{throw Error()}catch(c){var o=c.stack.trim().match(/\n( *(at )?)/);K=o&&o[1]||""}return`
`+K+s}var te=!1;function Y(s,o){if(!s||te)return"";te=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(je){var h=je}Reflect.construct(s,[],o)}else{try{o.call()}catch(je){h=je}s.call(o.prototype)}else{try{throw Error()}catch(je){h=je}s()}}catch(je){if(je&&h&&typeof je.stack=="string"){for(var b=je.stack.split(`
`),C=h.stack.split(`
`),L=b.length-1,se=C.length-1;1<=L&&0<=se&&b[L]!==C[se];)se--;for(;1<=L&&0<=se;L--,se--)if(b[L]!==C[se]){if(L!==1||se!==1)do if(L--,se--,0>se||b[L]!==C[se]){var fe=`
`+b[L].replace(" at new "," at ");return s.displayName&&fe.includes("<anonymous>")&&(fe=fe.replace("<anonymous>",s.displayName)),fe}while(1<=L&&0<=se);break}}}finally{te=!1,Error.prepareStackTrace=c}return(s=s?s.displayName||s.name:"")?J(s):""}function U(s){switch(s.tag){case 5:return J(s.type);case 16:return J("Lazy");case 13:return J("Suspense");case 19:return J("SuspenseList");case 0:case 2:case 15:return s=Y(s.type,!1),s;case 11:return s=Y(s.type.render,!1),s;case 1:return s=Y(s.type,!0),s;default:return""}}function Z(s){if(s==null)return null;if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case D:return"Fragment";case E:return"Portal";case F:return"Profiler";case $:return"StrictMode";case le:return"Suspense";case z:return"SuspenseList"}if(typeof s=="object")switch(s.$$typeof){case B:return(s.displayName||"Context")+".Consumer";case R:return(s._context.displayName||"Context")+".Provider";case ee:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case G:return o=s.displayName||null,o!==null?o:Z(s.type)||"Memo";case W:o=s._payload,s=s._init;try{return Z(s(o))}catch{}}return null}function ie(s){var o=s.type;switch(s.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return s=o.render,s=s.displayName||s.name||"",o.displayName||(s!==""?"ForwardRef("+s+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Z(o);case 8:return o===$?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function re(s){switch(typeof s){case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function pe(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function xe(s){var o=pe(s)?"checked":"value",c=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),h=""+s[o];if(!s.hasOwnProperty(o)&&typeof c<"u"&&typeof c.get=="function"&&typeof c.set=="function"){var b=c.get,C=c.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return b.call(this)},set:function(L){h=""+L,C.call(this,L)}}),Object.defineProperty(s,o,{enumerable:c.enumerable}),{getValue:function(){return h},setValue:function(L){h=""+L},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Ve(s){s._valueTracker||(s._valueTracker=xe(s))}function ht(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var c=o.getValue(),h="";return s&&(h=pe(s)?s.checked?"true":"false":s.value),s=h,s!==c?(o.setValue(s),!0):!1}function Qe(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}function Ne(s,o){var c=o.checked;return Q({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:c??s._wrapperState.initialChecked})}function ze(s,o){var c=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;c=re(o.value!=null?o.value:c),s._wrapperState={initialChecked:h,initialValue:c,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Se(s,o){o=o.checked,o!=null&&T(s,"checked",o,!1)}function Be(s,o){Se(s,o);var c=re(o.value),h=o.type;if(c!=null)h==="number"?(c===0&&s.value===""||s.value!=c)&&(s.value=""+c):s.value!==""+c&&(s.value=""+c);else if(h==="submit"||h==="reset"){s.removeAttribute("value");return}o.hasOwnProperty("value")?Ke(s,o.type,c):o.hasOwnProperty("defaultValue")&&Ke(s,o.type,re(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(s.defaultChecked=!!o.defaultChecked)}function He(s,o,c){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+s._wrapperState.initialValue,c||o===s.value||(s.value=o),s.defaultValue=o}c=s.name,c!==""&&(s.name=""),s.defaultChecked=!!s._wrapperState.initialChecked,c!==""&&(s.name=c)}function Ke(s,o,c){(o!=="number"||Qe(s.ownerDocument)!==s)&&(c==null?s.defaultValue=""+s._wrapperState.initialValue:s.defaultValue!==""+c&&(s.defaultValue=""+c))}var st=Array.isArray;function X(s,o,c,h){if(s=s.options,o){o={};for(var b=0;b<c.length;b++)o["$"+c[b]]=!0;for(c=0;c<s.length;c++)b=o.hasOwnProperty("$"+s[c].value),s[c].selected!==b&&(s[c].selected=b),b&&h&&(s[c].defaultSelected=!0)}else{for(c=""+re(c),o=null,b=0;b<s.length;b++){if(s[b].value===c){s[b].selected=!0,h&&(s[b].defaultSelected=!0);return}o!==null||s[b].disabled||(o=s[b])}o!==null&&(o.selected=!0)}}function Oe(s,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return Q({},o,{value:void 0,defaultValue:void 0,children:""+s._wrapperState.initialValue})}function Te(s,o){var c=o.value;if(c==null){if(c=o.children,o=o.defaultValue,c!=null){if(o!=null)throw Error(n(92));if(st(c)){if(1<c.length)throw Error(n(93));c=c[0]}o=c}o==null&&(o=""),c=o}s._wrapperState={initialValue:re(c)}}function ot(s,o){var c=re(o.value),h=re(o.defaultValue);c!=null&&(c=""+c,c!==s.value&&(s.value=c),o.defaultValue==null&&s.defaultValue!==c&&(s.defaultValue=c)),h!=null&&(s.defaultValue=""+h)}function jt(s){var o=s.textContent;o===s._wrapperState.initialValue&&o!==""&&o!==null&&(s.value=o)}function rn(s){switch(s){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ve(s,o){return s==null||s==="http://www.w3.org/1999/xhtml"?rn(o):s==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":s}var be,ke=function(s){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,c,h,b){MSApp.execUnsafeLocalFunction(function(){return s(o,c,h,b)})}:s}(function(s,o){if(s.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in s)s.innerHTML=o;else{for(be=be||document.createElement("div"),be.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=be.firstChild;s.firstChild;)s.removeChild(s.firstChild);for(;o.firstChild;)s.appendChild(o.firstChild)}});function Le(s,o){if(o){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=o;return}}s.textContent=o}var Xe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},et=["Webkit","ms","Moz","O"];Object.keys(Xe).forEach(function(s){et.forEach(function(o){o=o+s.charAt(0).toUpperCase()+s.substring(1),Xe[o]=Xe[s]})});function tt(s,o,c){return o==null||typeof o=="boolean"||o===""?"":c||typeof o!="number"||o===0||Xe.hasOwnProperty(s)&&Xe[s]?(""+o).trim():o+"px"}function xt(s,o){s=s.style;for(var c in o)if(o.hasOwnProperty(c)){var h=c.indexOf("--")===0,b=tt(c,o[c],h);c==="float"&&(c="cssFloat"),h?s.setProperty(c,b):s[c]=b}}var Bt=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ft(s,o){if(o){if(Bt[s]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,s));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function ct(s,o){if(s.indexOf("-")===-1)return typeof o.is=="string";switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Tt=null;function gt(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Ct=null,hn=null,Zt=null;function Cn(s){if(s=Ba(s)){if(typeof Ct!="function")throw Error(n(280));var o=s.stateNode;o&&(o=fl(o),Ct(s.stateNode,s.type,o))}}function Yn(s){hn?Zt?Zt.push(s):Zt=[s]:hn=s}function pn(){if(hn){var s=hn,o=Zt;if(Zt=hn=null,Cn(s),o)for(s=0;s<o.length;s++)Cn(o[s])}}function Ot(s,o){return s(o)}function Ut(){}var bn=!1;function qt(s,o,c){if(bn)return s(o,c);bn=!0;try{return Ot(s,o,c)}finally{bn=!1,(hn!==null||Zt!==null)&&(Ut(),pn())}}function Pt(s,o){var c=s.stateNode;if(c===null)return null;var h=fl(c);if(h===null)return null;c=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(n(231,o,typeof c));return c}var an=!1;if(d)try{var es={};Object.defineProperty(es,"passive",{get:function(){an=!0}}),window.addEventListener("test",es,es),window.removeEventListener("test",es,es)}catch{an=!1}function Ks(s,o,c,h,b,C,L,se,fe){var je=Array.prototype.slice.call(arguments,3);try{o.apply(c,je)}catch(De){this.onError(De)}}var En=!1,as=null,Gt=!1,Qn=null,Tr={onError:function(s){En=!0,as=s}};function uo(s,o,c,h,b,C,L,se,fe){En=!1,as=null,Ks.apply(Tr,arguments)}function Ys(s,o,c,h,b,C,L,se,fe){if(uo.apply(this,arguments),En){if(En){var je=as;En=!1,as=null}else throw Error(n(198));Gt||(Gt=!0,Qn=je)}}function Os(s){var o=s,c=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,o.flags&4098&&(c=o.return),s=o.return;while(s)}return o.tag===3?c:null}function Pa(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function Ta(s){if(Os(s)!==s)throw Error(n(188))}function ta(s){var o=s.alternate;if(!o){if(o=Os(s),o===null)throw Error(n(188));return o!==s?null:s}for(var c=s,h=o;;){var b=c.return;if(b===null)break;var C=b.alternate;if(C===null){if(h=b.return,h!==null){c=h;continue}break}if(b.child===C.child){for(C=b.child;C;){if(C===c)return Ta(b),s;if(C===h)return Ta(b),o;C=C.sibling}throw Error(n(188))}if(c.return!==h.return)c=b,h=C;else{for(var L=!1,se=b.child;se;){if(se===c){L=!0,c=b,h=C;break}if(se===h){L=!0,h=b,c=C;break}se=se.sibling}if(!L){for(se=C.child;se;){if(se===c){L=!0,c=C,h=b;break}if(se===h){L=!0,h=C,c=b;break}se=se.sibling}if(!L)throw Error(n(189))}}if(c.alternate!==h)throw Error(n(190))}if(c.tag!==3)throw Error(n(188));return c.stateNode.current===c?s:o}function $r(s){return s=ta(s),s!==null?na(s):null}function na(s){if(s.tag===5||s.tag===6)return s;for(s=s.child;s!==null;){var o=na(s);if(o!==null)return o;s=s.sibling}return null}var sa=t.unstable_scheduleCallback,ra=t.unstable_cancelCallback,Ee=t.unstable_shouldYield,Ye=t.unstable_requestPaint,Ge=t.unstable_now,sn=t.unstable_getCurrentPriorityLevel,Mt=t.unstable_ImmediatePriority,os=t.unstable_UserBlockingPriority,nn=t.unstable_NormalPriority,jn=t.unstable_LowPriority,dn=t.unstable_IdlePriority,gn=null,_n=null;function on(s){if(_n&&typeof _n.onCommitFiberRoot=="function")try{_n.onCommitFiberRoot(gn,s,void 0,(s.current.flags&128)===128)}catch{}}var kn=Math.clz32?Math.clz32:Dr,aa=Math.log,Qs=Math.LN2;function Dr(s){return s>>>=0,s===0?32:31-(aa(s)/Qs|0)|0}var pr=64,_s=4194304;function Lr(s){switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return s&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return s}}function zr(s,o){var c=s.pendingLanes;if(c===0)return 0;var h=0,b=s.suspendedLanes,C=s.pingedLanes,L=c&268435455;if(L!==0){var se=L&~b;se!==0?h=Lr(se):(C&=L,C!==0&&(h=Lr(C)))}else L=c&~b,L!==0?h=Lr(L):C!==0&&(h=Lr(C));if(h===0)return 0;if(o!==0&&o!==h&&!(o&b)&&(b=h&-h,C=o&-o,b>=C||b===16&&(C&4194240)!==0))return o;if(h&4&&(h|=c&16),o=s.entangledLanes,o!==0)for(s=s.entanglements,o&=h;0<o;)c=31-kn(o),b=1<<c,h|=s[c],o&=~b;return h}function mo(s,o){switch(s){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oa(s,o){for(var c=s.suspendedLanes,h=s.pingedLanes,b=s.expirationTimes,C=s.pendingLanes;0<C;){var L=31-kn(C),se=1<<L,fe=b[L];fe===-1?(!(se&c)||se&h)&&(b[L]=mo(se,o)):fe<=o&&(s.expiredLanes|=se),C&=~se}}function la(s){return s=s.pendingLanes&-1073741825,s!==0?s:s&1073741824?1073741824:0}function ia(){var s=pr;return pr<<=1,!(pr&4194240)&&(pr=64),s}function el(s){for(var o=[],c=0;31>c;c++)o.push(s);return o}function fo(s,o,c){s.pendingLanes|=o,o!==536870912&&(s.suspendedLanes=0,s.pingedLanes=0),s=s.eventTimes,o=31-kn(o),s[o]=c}function Cc(s,o){var c=s.pendingLanes&~o;s.pendingLanes=o,s.suspendedLanes=0,s.pingedLanes=0,s.expiredLanes&=o,s.mutableReadLanes&=o,s.entangledLanes&=o,o=s.entanglements;var h=s.eventTimes;for(s=s.expirationTimes;0<c;){var b=31-kn(c),C=1<<b;o[b]=0,h[b]=-1,s[b]=-1,c&=~C}}function di(s,o){var c=s.entangledLanes|=o;for(s=s.entanglements;c;){var h=31-kn(c),b=1<<h;b&o|s[h]&o&&(s[h]|=o),c&=~b}}var Xt=0;function Ec(s){return s&=-s,1<s?4<s?s&268435455?16:536870912:4:1}var mi,tl,fi,hi,ae,Me=!1,we=[],We=null,Ue=null,Pe=null,_t=new Map,rt=new Map,mt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(s,o){switch(s){case"focusin":case"focusout":We=null;break;case"dragenter":case"dragleave":Ue=null;break;case"mouseover":case"mouseout":Pe=null;break;case"pointerover":case"pointerout":_t.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":rt.delete(o.pointerId)}}function Lt(s,o,c,h,b,C){return s===null||s.nativeEvent!==C?(s={blockedOn:o,domEventName:c,eventSystemFlags:h,nativeEvent:C,targetContainers:[b]},o!==null&&(o=Ba(o),o!==null&&tl(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,b!==null&&o.indexOf(b)===-1&&o.push(b),s)}function Dn(s,o,c,h,b){switch(o){case"focusin":return We=Lt(We,s,o,c,h,b),!0;case"dragenter":return Ue=Lt(Ue,s,o,c,h,b),!0;case"mouseover":return Pe=Lt(Pe,s,o,c,h,b),!0;case"pointerover":var C=b.pointerId;return _t.set(C,Lt(_t.get(C)||null,s,o,c,h,b)),!0;case"gotpointercapture":return C=b.pointerId,rt.set(C,Lt(rt.get(C)||null,s,o,c,h,b)),!0}return!1}function Yt(s){var o=Eo(s.target);if(o!==null){var c=Os(o);if(c!==null){if(o=c.tag,o===13){if(o=Pa(c),o!==null){s.blockedOn=o,ae(s.priority,function(){fi(c)});return}}else if(o===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Ln(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var c=nl(s.domEventName,s.eventSystemFlags,o[0],s.nativeEvent);if(c===null){c=s.nativeEvent;var h=new c.constructor(c.type,c);Tt=h,c.target.dispatchEvent(h),Tt=null}else return o=Ba(c),o!==null&&tl(o),s.blockedOn=c,!1;o.shift()}return!0}function gr(s,o,c){Ln(s)&&c.delete(o)}function $a(){Me=!1,We!==null&&Ln(We)&&(We=null),Ue!==null&&Ln(Ue)&&(Ue=null),Pe!==null&&Ln(Pe)&&(Pe=null),_t.forEach(gr),rt.forEach(gr)}function _r(s,o){s.blockedOn===o&&(s.blockedOn=null,Me||(Me=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,$a)))}function Gs(s){function o(b){return _r(b,s)}if(0<we.length){_r(we[0],s);for(var c=1;c<we.length;c++){var h=we[c];h.blockedOn===s&&(h.blockedOn=null)}}for(We!==null&&_r(We,s),Ue!==null&&_r(Ue,s),Pe!==null&&_r(Pe,s),_t.forEach(o),rt.forEach(o),c=0;c<mt.length;c++)h=mt[c],h.blockedOn===s&&(h.blockedOn=null);for(;0<mt.length&&(c=mt[0],c.blockedOn===null);)Yt(c),c.blockedOn===null&&mt.shift()}var Ps=w.ReactCurrentBatchConfig,vs=!0;function vr(s,o,c,h){var b=Xt,C=Ps.transition;Ps.transition=null;try{Xt=1,ho(s,o,c,h)}finally{Xt=b,Ps.transition=C}}function pi(s,o,c,h){var b=Xt,C=Ps.transition;Ps.transition=null;try{Xt=4,ho(s,o,c,h)}finally{Xt=b,Ps.transition=C}}function ho(s,o,c,h){if(vs){var b=nl(s,o,c,h);if(b===null)Ud(s,o,h,po,c),pt(s,h);else if(Dn(b,s,o,c,h))h.stopPropagation();else if(pt(s,h),o&4&&-1<Dt.indexOf(s)){for(;b!==null;){var C=Ba(b);if(C!==null&&mi(C),C=nl(s,o,c,h),C===null&&Ud(s,o,h,po,c),C===b)break;b=C}b!==null&&h.stopPropagation()}else Ud(s,o,h,null,c)}}var po=null;function nl(s,o,c,h){if(po=null,s=gt(h),s=Eo(s),s!==null)if(o=Os(s),o===null)s=null;else if(c=o.tag,c===13){if(s=Pa(o),s!==null)return s;s=null}else if(c===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null);return po=s,null}function sl(s){switch(s){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sn()){case Mt:return 1;case os:return 4;case nn:case jn:return 16;case dn:return 536870912;default:return 16}default:return 16}}var Rr=null,gi=null,Da=null;function rl(){if(Da)return Da;var s,o=gi,c=o.length,h,b="value"in Rr?Rr.value:Rr.textContent,C=b.length;for(s=0;s<c&&o[s]===b[s];s++);var L=c-s;for(h=1;h<=L&&o[c-h]===b[C-h];h++);return Da=b.slice(s,1<h?1-h:void 0)}function zn(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function go(){return!0}function kc(){return!1}function ys(s){function o(c,h,b,C,L){this._reactName=c,this._targetInst=b,this.type=h,this.nativeEvent=C,this.target=L,this.currentTarget=null;for(var se in s)s.hasOwnProperty(se)&&(c=s[se],this[se]=c?c(C):C[se]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?go:kc,this.isPropagationStopped=kc,this}return Q(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=go)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=go)},persist:function(){},isPersistent:go}),o}var La={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Nn=ys(La),Gn=Q({},La,{view:0,detail:0}),yr=ys(Gn),_i,Sd,vi,Mc=Q({},Gn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kd,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==vi&&(vi&&s.type==="mousemove"?(_i=s.screenX-vi.screenX,Sd=s.screenY-vi.screenY):Sd=_i=0,vi=s),_i)},movementY:function(s){return"movementY"in s?s.movementY:Sd}}),Wf=ys(Mc),Cd=Q({},Mc,{dataTransfer:0}),Ed=ys(Cd),Ac=Q({},Gn,{relatedTarget:0}),yi=ys(Ac),Kf=Q({},La,{animationName:0,elapsedTime:0,pseudoElement:0}),Yf=ys(Kf),Qf=Q({},La,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Gf=ys(Qf),bi=Q({},La,{data:0}),ge=ys(bi),Re={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ca={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xf={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function t_(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=Xf[s])?!!o[s]:!1}function kd(){return t_}var al=Q({},Gn,{key:function(s){if(s.key){var o=Re[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=zn(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?ca[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kd,charCode:function(s){return s.type==="keypress"?zn(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?zn(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),Jf=ys(al),Zf=Q({},Mc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mn=ys(Zf),_o=Q({},Gn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kd}),ol=ys(_o),Oc=Q({},La,{propertyName:0,elapsedTime:0,pseudoElement:0}),za=ys(Oc),n_=Q({},Mc,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),s_=ys(n_),r_=[9,13,27,32],ua=d&&"CompositionEvent"in window,vo=null;d&&"documentMode"in document&&(vo=document.documentMode);var eh=d&&"TextEvent"in window&&!vo,Md=d&&(!ua||vo&&8<vo&&11>=vo),Ad=" ",ll=!1;function Od(s,o){switch(s){case"keyup":return r_.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Pd(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var da=!1;function Pc(s,o){switch(s){case"compositionend":return Pd(o);case"keypress":return o.which!==32?null:(ll=!0,Ad);case"textInput":return s=o.data,s===Ad&&ll?null:s;default:return null}}function yo(s,o){if(da)return s==="compositionend"||!ua&&Od(s,o)?(s=rl(),Da=gi=Rr=null,da=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Md&&o.locale!=="ko"?null:o.data;default:return null}}var Td={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function bt(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!Td[s.type]:o==="textarea"}function xi(s,o,c,h){Yn(h),o=fa(o,"onChange"),0<o.length&&(c=new Nn("onChange","change",null,c,h),s.push({event:c,listeners:o}))}var Ra=null,wi=null;function xn(s){Rc(s,0)}function bo(s){var o=Zs(s);if(ht(o))return s}function Tc(s,o){if(s==="change")return o}var ji=!1;if(d){var Fa;if(d){var il="oninput"in document;if(!il){var br=document.createElement("div");br.setAttribute("oninput","return;"),il=typeof br.oninput=="function"}Fa=il}else Fa=!1;ji=Fa&&(!document.documentMode||9<document.documentMode)}function Ni(){Ra&&(Ra.detachEvent("onpropertychange",Si),wi=Ra=null)}function Si(s){if(s.propertyName==="value"&&bo(wi)){var o=[];xi(o,wi,s,gt(s)),qt(xn,o)}}function $c(s,o,c){s==="focusin"?(Ni(),Ra=o,wi=c,Ra.attachEvent("onpropertychange",Si)):s==="focusout"&&Ni()}function th(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return bo(wi)}function $d(s,o){if(s==="click")return bo(o)}function a_(s,o){if(s==="input"||s==="change")return bo(o)}function o_(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Xs=typeof Object.is=="function"?Object.is:o_;function cl(s,o){if(Xs(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var c=Object.keys(s),h=Object.keys(o);if(c.length!==h.length)return!1;for(h=0;h<c.length;h++){var b=c[h];if(!m.call(o,b)||!Xs(s[b],o[b]))return!1}return!0}function Dd(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function xo(s,o){var c=Dd(s);s=0;for(var h;c;){if(c.nodeType===3){if(h=s+c.textContent.length,s<=o&&h>=o)return{node:c,offset:o-s};s=h}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=Dd(c)}}function Ld(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?Ld(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function zd(){for(var s=window,o=Qe();o instanceof s.HTMLIFrameElement;){try{var c=typeof o.contentWindow.location.href=="string"}catch{c=!1}if(c)s=o.contentWindow;else break;o=Qe(s.document)}return o}function Fr(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}function nh(s){var o=zd(),c=s.focusedElem,h=s.selectionRange;if(o!==c&&c&&c.ownerDocument&&Ld(c.ownerDocument.documentElement,c)){if(h!==null&&Fr(c)){if(o=h.start,s=h.end,s===void 0&&(s=o),"selectionStart"in c)c.selectionStart=o,c.selectionEnd=Math.min(s,c.value.length);else if(s=(o=c.ownerDocument||document)&&o.defaultView||window,s.getSelection){s=s.getSelection();var b=c.textContent.length,C=Math.min(h.start,b);h=h.end===void 0?C:Math.min(h.end,b),!s.extend&&C>h&&(b=h,h=C,C=b),b=xo(c,C);var L=xo(c,h);b&&L&&(s.rangeCount!==1||s.anchorNode!==b.node||s.anchorOffset!==b.offset||s.focusNode!==L.node||s.focusOffset!==L.offset)&&(o=o.createRange(),o.setStart(b.node,b.offset),s.removeAllRanges(),C>h?(s.addRange(o),s.extend(L.node,L.offset)):(o.setEnd(L.node,L.offset),s.addRange(o)))}}for(o=[],s=c;s=s.parentNode;)s.nodeType===1&&o.push({element:s,left:s.scrollLeft,top:s.scrollTop});for(typeof c.focus=="function"&&c.focus(),c=0;c<o.length;c++)s=o[c],s.element.scrollLeft=s.left,s.element.scrollTop=s.top}}var l_=d&&"documentMode"in document&&11>=document.documentMode,ma=null,Dc=null,Ci=null,Rd=!1;function sh(s,o,c){var h=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;Rd||ma==null||ma!==Qe(h)||(h=ma,"selectionStart"in h&&Fr(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ci&&cl(Ci,h)||(Ci=h,h=fa(Dc,"onSelect"),0<h.length&&(o=new Nn("onSelect","select",null,o,c),s.push({event:o,listeners:h}),o.target=ma)))}function ul(s,o){var c={};return c[s.toLowerCase()]=o.toLowerCase(),c["Webkit"+s]="webkit"+o,c["Moz"+s]="moz"+o,c}var dl={animationend:ul("Animation","AnimationEnd"),animationiteration:ul("Animation","AnimationIteration"),animationstart:ul("Animation","AnimationStart"),transitionend:ul("Transition","TransitionEnd")},Fd={},Lc={};d&&(Lc=document.createElement("div").style,"AnimationEvent"in window||(delete dl.animationend.animation,delete dl.animationiteration.animation,delete dl.animationstart.animation),"TransitionEvent"in window||delete dl.transitionend.transition);function Ir(s){if(Fd[s])return Fd[s];if(!dl[s])return s;var o=dl[s],c;for(c in o)if(o.hasOwnProperty(c)&&c in Lc)return Fd[s]=o[c];return s}var Ei=Ir("animationend"),rh=Ir("animationiteration"),zc=Ir("animationstart"),ml=Ir("transitionend"),ah=new Map,oh="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Br(s,o){ah.set(s,o),i(o,[s])}for(var wo=0;wo<oh.length;wo++){var Id=oh[wo],i_=Id.toLowerCase(),Bd=Id[0].toUpperCase()+Id.slice(1);Br(i_,"on"+Bd)}Br(Ei,"onAnimationEnd"),Br(rh,"onAnimationIteration"),Br(zc,"onAnimationStart"),Br("dblclick","onDoubleClick"),Br("focusin","onFocus"),Br("focusout","onBlur"),Br(ml,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),i("onBeforeInput",["compositionend","keypress","textInput","paste"]),i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),c_=new Set("cancel close invalid load scroll toggle".split(" ").concat(jo));function lh(s,o,c){var h=s.type||"unknown-event";s.currentTarget=c,Ys(h,o,void 0,s),s.currentTarget=null}function Rc(s,o){o=(o&4)!==0;for(var c=0;c<s.length;c++){var h=s[c],b=h.event;h=h.listeners;e:{var C=void 0;if(o)for(var L=h.length-1;0<=L;L--){var se=h[L],fe=se.instance,je=se.currentTarget;if(se=se.listener,fe!==C&&b.isPropagationStopped())break e;lh(b,se,je),C=fe}else for(L=0;L<h.length;L++){if(se=h[L],fe=se.instance,je=se.currentTarget,se=se.listener,fe!==C&&b.isPropagationStopped())break e;lh(b,se,je),C=fe}}}if(Gt)throw s=Qn,Gt=!1,Qn=null,s}function mn(s,o){var c=o[Vd];c===void 0&&(c=o[Vd]=new Set);var h=s+"__bubble";c.has(h)||(bs(o,s,2,!1),c.add(h))}function Fc(s,o,c){var h=0;o&&(h|=4),bs(c,s,h,o)}var Ic="_reactListening"+Math.random().toString(36).slice(2);function No(s){if(!s[Ic]){s[Ic]=!0,r.forEach(function(c){c!=="selectionchange"&&(c_.has(c)||Fc(c,!1,s),Fc(c,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Ic]||(o[Ic]=!0,Fc("selectionchange",!1,o))}}function bs(s,o,c,h){switch(sl(o)){case 1:var b=vr;break;case 4:b=pi;break;default:b=ho}c=b.bind(null,o,c,s),b=void 0,!an||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(b=!0),h?b!==void 0?s.addEventListener(o,c,{capture:!0,passive:b}):s.addEventListener(o,c,!0):b!==void 0?s.addEventListener(o,c,{passive:b}):s.addEventListener(o,c,!1)}function Ud(s,o,c,h,b){var C=h;if(!(o&1)&&!(o&2)&&h!==null)e:for(;;){if(h===null)return;var L=h.tag;if(L===3||L===4){var se=h.stateNode.containerInfo;if(se===b||se.nodeType===8&&se.parentNode===b)break;if(L===4)for(L=h.return;L!==null;){var fe=L.tag;if((fe===3||fe===4)&&(fe=L.stateNode.containerInfo,fe===b||fe.nodeType===8&&fe.parentNode===b))return;L=L.return}for(;se!==null;){if(L=Eo(se),L===null)return;if(fe=L.tag,fe===5||fe===6){h=C=L;continue e}se=se.parentNode}}h=h.return}qt(function(){var je=C,De=gt(c),Fe=[];e:{var $e=ah.get(s);if($e!==void 0){var nt=Nn,lt=s;switch(s){case"keypress":if(zn(c)===0)break e;case"keydown":case"keyup":nt=Jf;break;case"focusin":lt="focus",nt=yi;break;case"focusout":lt="blur",nt=yi;break;case"beforeblur":case"afterblur":nt=yi;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":nt=Wf;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":nt=Ed;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":nt=ol;break;case Ei:case rh:case zc:nt=Yf;break;case ml:nt=za;break;case"scroll":nt=yr;break;case"wheel":nt=s_;break;case"copy":case"cut":case"paste":nt=Gf;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":nt=Mn}var it=(o&4)!==0,Hn=!it&&s==="scroll",_e=it?$e!==null?$e+"Capture":null:$e;it=[];for(var he=je,ye;he!==null;){ye=he;var qe=ye.stateNode;if(ye.tag===5&&qe!==null&&(ye=qe,_e!==null&&(qe=Pt(he,_e),qe!=null&&it.push(Ts(he,qe,ye)))),Hn)break;he=he.return}0<it.length&&($e=new nt($e,lt,null,c,De),Fe.push({event:$e,listeners:it}))}}if(!(o&7)){e:{if($e=s==="mouseover"||s==="pointerover",nt=s==="mouseout"||s==="pointerout",$e&&c!==Tt&&(lt=c.relatedTarget||c.fromElement)&&(Eo(lt)||lt[An]))break e;if((nt||$e)&&($e=De.window===De?De:($e=De.ownerDocument)?$e.defaultView||$e.parentWindow:window,nt?(lt=c.relatedTarget||c.toElement,nt=je,lt=lt?Eo(lt):null,lt!==null&&(Hn=Os(lt),lt!==Hn||lt.tag!==5&&lt.tag!==6)&&(lt=null)):(nt=null,lt=je),nt!==lt)){if(it=Wf,qe="onMouseLeave",_e="onMouseEnter",he="mouse",(s==="pointerout"||s==="pointerover")&&(it=Mn,qe="onPointerLeave",_e="onPointerEnter",he="pointer"),Hn=nt==null?$e:Zs(nt),ye=lt==null?$e:Zs(lt),$e=new it(qe,he+"leave",nt,c,De),$e.target=Hn,$e.relatedTarget=ye,qe=null,Eo(De)===je&&(it=new it(_e,he+"enter",lt,c,De),it.target=ye,it.relatedTarget=Hn,qe=it),Hn=qe,nt&&lt)t:{for(it=nt,_e=lt,he=0,ye=it;ye;ye=So(ye))he++;for(ye=0,qe=_e;qe;qe=So(qe))ye++;for(;0<he-ye;)it=So(it),he--;for(;0<ye-he;)_e=So(_e),ye--;for(;he--;){if(it===_e||_e!==null&&it===_e.alternate)break t;it=So(it),_e=So(_e)}it=null}else it=null;nt!==null&&ih(Fe,$e,nt,it,!1),lt!==null&&Hn!==null&&ih(Fe,Hn,lt,it,!0)}}e:{if($e=je?Zs(je):window,nt=$e.nodeName&&$e.nodeName.toLowerCase(),nt==="select"||nt==="input"&&$e.type==="file")var dt=Tc;else if(bt($e))if(ji)dt=a_;else{dt=th;var vt=$c}else(nt=$e.nodeName)&&nt.toLowerCase()==="input"&&($e.type==="checkbox"||$e.type==="radio")&&(dt=$d);if(dt&&(dt=dt(s,je))){xi(Fe,dt,c,De);break e}vt&&vt(s,$e,je),s==="focusout"&&(vt=$e._wrapperState)&&vt.controlled&&$e.type==="number"&&Ke($e,"number",$e.value)}switch(vt=je?Zs(je):window,s){case"focusin":(bt(vt)||vt.contentEditable==="true")&&(ma=vt,Dc=je,Ci=null);break;case"focusout":Ci=Dc=ma=null;break;case"mousedown":Rd=!0;break;case"contextmenu":case"mouseup":case"dragend":Rd=!1,sh(Fe,c,De);break;case"selectionchange":if(l_)break;case"keydown":case"keyup":sh(Fe,c,De)}var yt;if(ua)e:{switch(s){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else da?Od(s,c)&&(Nt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Nt="onCompositionStart");Nt&&(Md&&c.locale!=="ko"&&(da||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&da&&(yt=rl()):(Rr=De,gi="value"in Rr?Rr.value:Rr.textContent,da=!0)),vt=fa(je,Nt),0<vt.length&&(Nt=new ge(Nt,s,null,c,De),Fe.push({event:Nt,listeners:vt}),yt?Nt.data=yt:(yt=Pd(c),yt!==null&&(Nt.data=yt)))),(yt=eh?Pc(s,c):yo(s,c))&&(je=fa(je,"onBeforeInput"),0<je.length&&(De=new ge("onBeforeInput","beforeinput",null,c,De),Fe.push({event:De,listeners:je}),De.data=yt))}Rc(Fe,o)})}function Ts(s,o,c){return{instance:s,listener:o,currentTarget:c}}function fa(s,o){for(var c=o+"Capture",h=[];s!==null;){var b=s,C=b.stateNode;b.tag===5&&C!==null&&(b=C,C=Pt(s,c),C!=null&&h.unshift(Ts(s,C,b)),C=Pt(s,o),C!=null&&h.push(Ts(s,C,b))),s=s.return}return h}function So(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5);return s||null}function ih(s,o,c,h,b){for(var C=o._reactName,L=[];c!==null&&c!==h;){var se=c,fe=se.alternate,je=se.stateNode;if(fe!==null&&fe===h)break;se.tag===5&&je!==null&&(se=je,b?(fe=Pt(c,C),fe!=null&&L.unshift(Ts(c,fe,se))):b||(fe=Pt(c,C),fe!=null&&L.push(Ts(c,fe,se)))),c=c.return}L.length!==0&&s.push({event:o,listeners:L})}var ch=/\r\n?/g,u_=/\u0000|\uFFFD/g;function uh(s){return(typeof s=="string"?s:""+s).replace(ch,`
`).replace(u_,"")}function ki(s,o,c){if(o=uh(o),uh(s)!==o&&c)throw Error(n(425))}function Bc(){}var Et=null,Uc=null;function Mi(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var qd=typeof setTimeout=="function"?setTimeout:void 0,d_=typeof clearTimeout=="function"?clearTimeout:void 0,dh=typeof Promise=="function"?Promise:void 0,Ai=typeof queueMicrotask=="function"?queueMicrotask:typeof dh<"u"?function(s){return dh.resolve(null).then(s).catch(m_)}:qd;function m_(s){setTimeout(function(){throw s})}function Hd(s,o){var c=o,h=0;do{var b=c.nextSibling;if(s.removeChild(c),b&&b.nodeType===8)if(c=b.data,c==="/$"){if(h===0){s.removeChild(b),Gs(o);return}h--}else c!=="$"&&c!=="$?"&&c!=="$!"||h++;c=b}while(c);Gs(o)}function ha(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return s}function Co(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"){if(o===0)return s;o--}else c==="/$"&&o++}s=s.previousSibling}return null}var Js=Math.random().toString(36).slice(2),Ur="__reactFiber$"+Js,Ia="__reactProps$"+Js,An="__reactContainer$"+Js,Vd="__reactEvents$"+Js,qc="__reactListeners$"+Js,mh="__reactHandles$"+Js;function Eo(s){var o=s[Ur];if(o)return o;for(var c=s.parentNode;c;){if(o=c[An]||c[Ur]){if(c=o.alternate,o.child!==null||c!==null&&c.child!==null)for(s=Co(s);s!==null;){if(c=s[Ur])return c;s=Co(s)}return o}s=c,c=s.parentNode}return null}function Ba(s){return s=s[Ur]||s[An],!s||s.tag!==5&&s.tag!==6&&s.tag!==13&&s.tag!==3?null:s}function Zs(s){if(s.tag===5||s.tag===6)return s.stateNode;throw Error(n(33))}function fl(s){return s[Ia]||null}var Wd=[],Rn=-1;function pa(s){return{current:s}}function fn(s){0>Rn||(s.current=Wd[Rn],Wd[Rn]=null,Rn--)}function Kt(s,o){Rn++,Wd[Rn]=s.current,s.current=o}var Ua={},ts=pa(Ua),ls=pa(!1),ko=Ua;function hl(s,o){var c=s.type.contextTypes;if(!c)return Ua;var h=s.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var b={},C;for(C in c)b[C]=o[C];return h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=o,s.__reactInternalMemoizedMaskedChildContext=b),b}function Ss(s){return s=s.childContextTypes,s!=null}function Hc(){fn(ls),fn(ts)}function fh(s,o,c){if(ts.current!==Ua)throw Error(n(168));Kt(ts,o),Kt(ls,c)}function hh(s,o,c){var h=s.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return c;h=h.getChildContext();for(var b in h)if(!(b in o))throw Error(n(108,ie(s)||"Unknown",b));return Q({},c,h)}function Vc(s){return s=(s=s.stateNode)&&s.__reactInternalMemoizedMergedChildContext||Ua,ko=ts.current,Kt(ts,s),Kt(ls,ls.current),!0}function ph(s,o,c){var h=s.stateNode;if(!h)throw Error(n(169));c?(s=hh(s,o,ko),h.__reactInternalMemoizedMergedChildContext=s,fn(ls),fn(ts),Kt(ts,s)):fn(ls),Kt(ls,c)}var ga=null,Wc=!1,Kd=!1;function gh(s){ga===null?ga=[s]:ga.push(s)}function f_(s){Wc=!0,gh(s)}function qa(){if(!Kd&&ga!==null){Kd=!0;var s=0,o=Xt;try{var c=ga;for(Xt=1;s<c.length;s++){var h=c[s];do h=h(!0);while(h!==null)}ga=null,Wc=!1}catch(b){throw ga!==null&&(ga=ga.slice(s+1)),sa(Mt,qa),b}finally{Xt=o,Kd=!1}}return null}var pl=[],gl=0,Kc=null,Yc=0,er=[],tr=0,Mo=null,_a=1,va="";function Ao(s,o){pl[gl++]=Yc,pl[gl++]=Kc,Kc=s,Yc=o}function Yd(s,o,c){er[tr++]=_a,er[tr++]=va,er[tr++]=Mo,Mo=s;var h=_a;s=va;var b=32-kn(h)-1;h&=~(1<<b),c+=1;var C=32-kn(o)+b;if(30<C){var L=b-b%5;C=(h&(1<<L)-1).toString(32),h>>=L,b-=L,_a=1<<32-kn(o)+b|c<<b|h,va=C+s}else _a=1<<C|c<<b|h,va=s}function Oi(s){s.return!==null&&(Ao(s,1),Yd(s,1,0))}function Qd(s){for(;s===Kc;)Kc=pl[--gl],pl[gl]=null,Yc=pl[--gl],pl[gl]=null;for(;s===Mo;)Mo=er[--tr],er[tr]=null,va=er[--tr],er[tr]=null,_a=er[--tr],er[tr]=null}var xs=null,$s=null,vn=!1,Ds=null;function _l(s,o){var c=Qr(5,null,null,0);c.elementType="DELETED",c.stateNode=o,c.return=s,o=s.deletions,o===null?(s.deletions=[c],s.flags|=16):o.push(c)}function Ls(s,o){switch(s.tag){case 5:var c=s.type;return o=o.nodeType!==1||c.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(s.stateNode=o,xs=s,$s=ha(o.firstChild),!0):!1;case 6:return o=s.pendingProps===""||o.nodeType!==3?null:o,o!==null?(s.stateNode=o,xs=s,$s=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(c=Mo!==null?{id:_a,overflow:va}:null,s.memoizedState={dehydrated:o,treeContext:c,retryLane:1073741824},c=Qr(18,null,null,0),c.stateNode=o,c.return=s,s.child=c,xs=s,$s=null,!0):!1;default:return!1}}function Gd(s){return(s.mode&1)!==0&&(s.flags&128)===0}function Xd(s){if(vn){var o=$s;if(o){var c=o;if(!Ls(s,o)){if(Gd(s))throw Error(n(418));o=ha(c.nextSibling);var h=xs;o&&Ls(s,o)?_l(h,c):(s.flags=s.flags&-4097|2,vn=!1,xs=s)}}else{if(Gd(s))throw Error(n(418));s.flags=s.flags&-4097|2,vn=!1,xs=s}}}function Oo(s){for(s=s.return;s!==null&&s.tag!==5&&s.tag!==3&&s.tag!==13;)s=s.return;xs=s}function Qc(s){if(s!==xs)return!1;if(!vn)return Oo(s),vn=!0,!1;var o;if((o=s.tag!==3)&&!(o=s.tag!==5)&&(o=s.type,o=o!=="head"&&o!=="body"&&!Mi(s.type,s.memoizedProps)),o&&(o=$s)){if(Gd(s))throw _h(),Error(n(418));for(;o;)_l(s,o),o=ha(o.nextSibling)}if(Oo(s),s.tag===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"){if(o===0){$s=ha(s.nextSibling);break e}o--}else c!=="$"&&c!=="$!"&&c!=="$?"||o++}s=s.nextSibling}$s=null}}else $s=xs?ha(s.stateNode.nextSibling):null;return!0}function _h(){for(var s=$s;s;)s=ha(s.nextSibling)}function vl(){$s=xs=null,vn=!1}function Jd(s){Ds===null?Ds=[s]:Ds.push(s)}var h_=w.ReactCurrentBatchConfig;function Po(s,o,c){if(s=c.ref,s!==null&&typeof s!="function"&&typeof s!="object"){if(c._owner){if(c=c._owner,c){if(c.tag!==1)throw Error(n(309));var h=c.stateNode}if(!h)throw Error(n(147,s));var b=h,C=""+s;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===C?o.ref:(o=function(L){var se=b.refs;L===null?delete se[C]:se[C]=L},o._stringRef=C,o)}if(typeof s!="string")throw Error(n(284));if(!c._owner)throw Error(n(290,s))}return s}function Gc(s,o){throw s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s))}function vh(s){var o=s._init;return o(s._payload)}function yh(s){function o(_e,he){if(s){var ye=_e.deletions;ye===null?(_e.deletions=[he],_e.flags|=16):ye.push(he)}}function c(_e,he){if(!s)return null;for(;he!==null;)o(_e,he),he=he.sibling;return null}function h(_e,he){for(_e=new Map;he!==null;)he.key!==null?_e.set(he.key,he):_e.set(he.index,he),he=he.sibling;return _e}function b(_e,he){return _e=Pl(_e,he),_e.index=0,_e.sibling=null,_e}function C(_e,he,ye){return _e.index=ye,s?(ye=_e.alternate,ye!==null?(ye=ye.index,ye<he?(_e.flags|=2,he):ye):(_e.flags|=2,he)):(_e.flags|=1048576,he)}function L(_e){return s&&_e.alternate===null&&(_e.flags|=2),_e}function se(_e,he,ye,qe){return he===null||he.tag!==6?(he=k_(ye,_e.mode,qe),he.return=_e,he):(he=b(he,ye),he.return=_e,he)}function fe(_e,he,ye,qe){var dt=ye.type;return dt===D?De(_e,he,ye.props.children,qe,ye.key):he!==null&&(he.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===W&&vh(dt)===he.type)?(qe=b(he,ye.props),qe.ref=Po(_e,he,ye),qe.return=_e,qe):(qe=Jh(ye.type,ye.key,ye.props,null,_e.mode,qe),qe.ref=Po(_e,he,ye),qe.return=_e,qe)}function je(_e,he,ye,qe){return he===null||he.tag!==4||he.stateNode.containerInfo!==ye.containerInfo||he.stateNode.implementation!==ye.implementation?(he=M_(ye,_e.mode,qe),he.return=_e,he):(he=b(he,ye.children||[]),he.return=_e,he)}function De(_e,he,ye,qe,dt){return he===null||he.tag!==7?(he=Ki(ye,_e.mode,qe,dt),he.return=_e,he):(he=b(he,ye),he.return=_e,he)}function Fe(_e,he,ye){if(typeof he=="string"&&he!==""||typeof he=="number")return he=k_(""+he,_e.mode,ye),he.return=_e,he;if(typeof he=="object"&&he!==null){switch(he.$$typeof){case A:return ye=Jh(he.type,he.key,he.props,null,_e.mode,ye),ye.ref=Po(_e,null,he),ye.return=_e,ye;case E:return he=M_(he,_e.mode,ye),he.return=_e,he;case W:var qe=he._init;return Fe(_e,qe(he._payload),ye)}if(st(he)||ne(he))return he=Ki(he,_e.mode,ye,null),he.return=_e,he;Gc(_e,he)}return null}function $e(_e,he,ye,qe){var dt=he!==null?he.key:null;if(typeof ye=="string"&&ye!==""||typeof ye=="number")return dt!==null?null:se(_e,he,""+ye,qe);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case A:return ye.key===dt?fe(_e,he,ye,qe):null;case E:return ye.key===dt?je(_e,he,ye,qe):null;case W:return dt=ye._init,$e(_e,he,dt(ye._payload),qe)}if(st(ye)||ne(ye))return dt!==null?null:De(_e,he,ye,qe,null);Gc(_e,ye)}return null}function nt(_e,he,ye,qe,dt){if(typeof qe=="string"&&qe!==""||typeof qe=="number")return _e=_e.get(ye)||null,se(he,_e,""+qe,dt);if(typeof qe=="object"&&qe!==null){switch(qe.$$typeof){case A:return _e=_e.get(qe.key===null?ye:qe.key)||null,fe(he,_e,qe,dt);case E:return _e=_e.get(qe.key===null?ye:qe.key)||null,je(he,_e,qe,dt);case W:var vt=qe._init;return nt(_e,he,ye,vt(qe._payload),dt)}if(st(qe)||ne(qe))return _e=_e.get(ye)||null,De(he,_e,qe,dt,null);Gc(he,qe)}return null}function lt(_e,he,ye,qe){for(var dt=null,vt=null,yt=he,Nt=he=0,fs=null;yt!==null&&Nt<ye.length;Nt++){yt.index>Nt?(fs=yt,yt=null):fs=yt.sibling;var Jt=$e(_e,yt,ye[Nt],qe);if(Jt===null){yt===null&&(yt=fs);break}s&&yt&&Jt.alternate===null&&o(_e,yt),he=C(Jt,he,Nt),vt===null?dt=Jt:vt.sibling=Jt,vt=Jt,yt=fs}if(Nt===ye.length)return c(_e,yt),vn&&Ao(_e,Nt),dt;if(yt===null){for(;Nt<ye.length;Nt++)yt=Fe(_e,ye[Nt],qe),yt!==null&&(he=C(yt,he,Nt),vt===null?dt=yt:vt.sibling=yt,vt=yt);return vn&&Ao(_e,Nt),dt}for(yt=h(_e,yt);Nt<ye.length;Nt++)fs=nt(yt,_e,Nt,ye[Nt],qe),fs!==null&&(s&&fs.alternate!==null&&yt.delete(fs.key===null?Nt:fs.key),he=C(fs,he,Nt),vt===null?dt=fs:vt.sibling=fs,vt=fs);return s&&yt.forEach(function(Tl){return o(_e,Tl)}),vn&&Ao(_e,Nt),dt}function it(_e,he,ye,qe){var dt=ne(ye);if(typeof dt!="function")throw Error(n(150));if(ye=dt.call(ye),ye==null)throw Error(n(151));for(var vt=dt=null,yt=he,Nt=he=0,fs=null,Jt=ye.next();yt!==null&&!Jt.done;Nt++,Jt=ye.next()){yt.index>Nt?(fs=yt,yt=null):fs=yt.sibling;var Tl=$e(_e,yt,Jt.value,qe);if(Tl===null){yt===null&&(yt=fs);break}s&&yt&&Tl.alternate===null&&o(_e,yt),he=C(Tl,he,Nt),vt===null?dt=Tl:vt.sibling=Tl,vt=Tl,yt=fs}if(Jt.done)return c(_e,yt),vn&&Ao(_e,Nt),dt;if(yt===null){for(;!Jt.done;Nt++,Jt=ye.next())Jt=Fe(_e,Jt.value,qe),Jt!==null&&(he=C(Jt,he,Nt),vt===null?dt=Jt:vt.sibling=Jt,vt=Jt);return vn&&Ao(_e,Nt),dt}for(yt=h(_e,yt);!Jt.done;Nt++,Jt=ye.next())Jt=nt(yt,_e,Nt,Jt.value,qe),Jt!==null&&(s&&Jt.alternate!==null&&yt.delete(Jt.key===null?Nt:Jt.key),he=C(Jt,he,Nt),vt===null?dt=Jt:vt.sibling=Jt,vt=Jt);return s&&yt.forEach(function(_D){return o(_e,_D)}),vn&&Ao(_e,Nt),dt}function Hn(_e,he,ye,qe){if(typeof ye=="object"&&ye!==null&&ye.type===D&&ye.key===null&&(ye=ye.props.children),typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case A:e:{for(var dt=ye.key,vt=he;vt!==null;){if(vt.key===dt){if(dt=ye.type,dt===D){if(vt.tag===7){c(_e,vt.sibling),he=b(vt,ye.props.children),he.return=_e,_e=he;break e}}else if(vt.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===W&&vh(dt)===vt.type){c(_e,vt.sibling),he=b(vt,ye.props),he.ref=Po(_e,vt,ye),he.return=_e,_e=he;break e}c(_e,vt);break}else o(_e,vt);vt=vt.sibling}ye.type===D?(he=Ki(ye.props.children,_e.mode,qe,ye.key),he.return=_e,_e=he):(qe=Jh(ye.type,ye.key,ye.props,null,_e.mode,qe),qe.ref=Po(_e,he,ye),qe.return=_e,_e=qe)}return L(_e);case E:e:{for(vt=ye.key;he!==null;){if(he.key===vt)if(he.tag===4&&he.stateNode.containerInfo===ye.containerInfo&&he.stateNode.implementation===ye.implementation){c(_e,he.sibling),he=b(he,ye.children||[]),he.return=_e,_e=he;break e}else{c(_e,he);break}else o(_e,he);he=he.sibling}he=M_(ye,_e.mode,qe),he.return=_e,_e=he}return L(_e);case W:return vt=ye._init,Hn(_e,he,vt(ye._payload),qe)}if(st(ye))return lt(_e,he,ye,qe);if(ne(ye))return it(_e,he,ye,qe);Gc(_e,ye)}return typeof ye=="string"&&ye!==""||typeof ye=="number"?(ye=""+ye,he!==null&&he.tag===6?(c(_e,he.sibling),he=b(he,ye),he.return=_e,_e=he):(c(_e,he),he=k_(ye,_e.mode,qe),he.return=_e,_e=he),L(_e)):c(_e,he)}return Hn}var qr=yh(!0),Xc=yh(!1),Jc=pa(null),Zc=null,ya=null,Zd=null;function yl(){Zd=ya=Zc=null}function Ha(s){var o=Jc.current;fn(Jc),s._currentValue=o}function em(s,o,c){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===c)break;s=s.return}}function bl(s,o){Zc=s,Zd=ya=null,s=s.dependencies,s!==null&&s.firstContext!==null&&(s.lanes&o&&(ws=!0),s.firstContext=null)}function nr(s){var o=s._currentValue;if(Zd!==s)if(s={context:s,memoizedValue:o,next:null},ya===null){if(Zc===null)throw Error(n(308));ya=s,Zc.dependencies={lanes:0,firstContext:s}}else ya=ya.next=s;return o}var To=null;function tm(s){To===null?To=[s]:To.push(s)}function nm(s,o,c,h){var b=o.interleaved;return b===null?(c.next=c,tm(o)):(c.next=b.next,b.next=c),o.interleaved=c,ba(s,h)}function ba(s,o){s.lanes|=o;var c=s.alternate;for(c!==null&&(c.lanes|=o),c=s,s=s.return;s!==null;)s.childLanes|=o,c=s.alternate,c!==null&&(c.childLanes|=o),c=s,s=s.return;return c.tag===3?c.stateNode:null}var Va=!1;function sm(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function bh(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,effects:s.effects})}function xr(s,o){return{eventTime:s,lane:o,tag:0,payload:null,callback:null,next:null}}function Wa(s,o,c){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,Ht&2){var b=h.pending;return b===null?o.next=o:(o.next=b.next,b.next=o),h.pending=o,ba(s,c)}return b=h.interleaved,b===null?(o.next=o,tm(h)):(o.next=b.next,b.next=o),h.interleaved=o,ba(s,c)}function eu(s,o,c){if(o=o.updateQueue,o!==null&&(o=o.shared,(c&4194240)!==0)){var h=o.lanes;h&=s.pendingLanes,c|=h,o.lanes=c,di(s,c)}}function rm(s,o){var c=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,c===h)){var b=null,C=null;if(c=c.firstBaseUpdate,c!==null){do{var L={eventTime:c.eventTime,lane:c.lane,tag:c.tag,payload:c.payload,callback:c.callback,next:null};C===null?b=C=L:C=C.next=L,c=c.next}while(c!==null);C===null?b=C=o:C=C.next=o}else b=C=o;c={baseState:h.baseState,firstBaseUpdate:b,lastBaseUpdate:C,shared:h.shared,effects:h.effects},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=o:s.next=o,c.lastBaseUpdate=o}function tu(s,o,c,h){var b=s.updateQueue;Va=!1;var C=b.firstBaseUpdate,L=b.lastBaseUpdate,se=b.shared.pending;if(se!==null){b.shared.pending=null;var fe=se,je=fe.next;fe.next=null,L===null?C=je:L.next=je,L=fe;var De=s.alternate;De!==null&&(De=De.updateQueue,se=De.lastBaseUpdate,se!==L&&(se===null?De.firstBaseUpdate=je:se.next=je,De.lastBaseUpdate=fe))}if(C!==null){var Fe=b.baseState;L=0,De=je=fe=null,se=C;do{var $e=se.lane,nt=se.eventTime;if((h&$e)===$e){De!==null&&(De=De.next={eventTime:nt,lane:0,tag:se.tag,payload:se.payload,callback:se.callback,next:null});e:{var lt=s,it=se;switch($e=o,nt=c,it.tag){case 1:if(lt=it.payload,typeof lt=="function"){Fe=lt.call(nt,Fe,$e);break e}Fe=lt;break e;case 3:lt.flags=lt.flags&-65537|128;case 0:if(lt=it.payload,$e=typeof lt=="function"?lt.call(nt,Fe,$e):lt,$e==null)break e;Fe=Q({},Fe,$e);break e;case 2:Va=!0}}se.callback!==null&&se.lane!==0&&(s.flags|=64,$e=b.effects,$e===null?b.effects=[se]:$e.push(se))}else nt={eventTime:nt,lane:$e,tag:se.tag,payload:se.payload,callback:se.callback,next:null},De===null?(je=De=nt,fe=Fe):De=De.next=nt,L|=$e;if(se=se.next,se===null){if(se=b.shared.pending,se===null)break;$e=se,se=$e.next,$e.next=null,b.lastBaseUpdate=$e,b.shared.pending=null}}while(!0);if(De===null&&(fe=Fe),b.baseState=fe,b.firstBaseUpdate=je,b.lastBaseUpdate=De,o=b.shared.interleaved,o!==null){b=o;do L|=b.lane,b=b.next;while(b!==o)}else C===null&&(b.shared.lanes=0);Ga|=L,s.lanes=L,s.memoizedState=Fe}}function am(s,o,c){if(s=o.effects,o.effects=null,s!==null)for(o=0;o<s.length;o++){var h=s[o],b=h.callback;if(b!==null){if(h.callback=null,h=c,typeof b!="function")throw Error(n(191,b));b.call(h)}}}var Pi={},ln=pa(Pi),Ti=pa(Pi),is=pa(Pi);function Ka(s){if(s===Pi)throw Error(n(174));return s}function om(s,o){switch(Kt(is,o),Kt(Ti,s),Kt(ln,Pi),s=o.nodeType,s){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ve(null,"");break;default:s=s===8?o.parentNode:o,o=s.namespaceURI||null,s=s.tagName,o=ve(o,s)}fn(ln),Kt(ln,o)}function xl(){fn(ln),fn(Ti),fn(is)}function nu(s){Ka(is.current);var o=Ka(ln.current),c=ve(o,s.type);o!==c&&(Kt(Ti,s),Kt(ln,c))}function wl(s){Ti.current===s&&(fn(ln),fn(Ti))}var wn=pa(0);function jl(s){for(var o=s;o!==null;){if(o.tag===13){var c=o.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||c.data==="$?"||c.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var lm=[];function im(){for(var s=0;s<lm.length;s++)lm[s]._workInProgressVersionPrimary=null;lm.length=0}var su=w.ReactCurrentDispatcher,cm=w.ReactCurrentBatchConfig,sr=0,yn=null,Bn=null,Xn=null,ru=!1,$i=!1,Di=0,p_=0;function On(){throw Error(n(321))}function um(s,o){if(o===null)return!1;for(var c=0;c<o.length&&c<s.length;c++)if(!Xs(s[c],o[c]))return!1;return!0}function dm(s,o,c,h,b,C){if(sr=C,yn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,su.current=s===null||s.memoizedState===null?v_:Dh,s=c(h,b),$i){C=0;do{if($i=!1,Di=0,25<=C)throw Error(n(301));C+=1,Xn=Bn=null,o.updateQueue=null,su.current=y_,s=c(h,b)}while($i)}if(su.current=iu,o=Bn!==null&&Bn.next!==null,sr=0,Xn=Bn=yn=null,ru=!1,o)throw Error(n(300));return s}function mm(){var s=Di!==0;return Di=0,s}function Hr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xn===null?yn.memoizedState=Xn=s:Xn=Xn.next=s,Xn}function rr(){if(Bn===null){var s=yn.alternate;s=s!==null?s.memoizedState:null}else s=Bn.next;var o=Xn===null?yn.memoizedState:Xn.next;if(o!==null)Xn=o,Bn=s;else{if(s===null)throw Error(n(310));Bn=s,s={memoizedState:Bn.memoizedState,baseState:Bn.baseState,baseQueue:Bn.baseQueue,queue:Bn.queue,next:null},Xn===null?yn.memoizedState=Xn=s:Xn=Xn.next=s}return Xn}function Li(s,o){return typeof o=="function"?o(s):o}function fm(s){var o=rr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=Bn,b=h.baseQueue,C=c.pending;if(C!==null){if(b!==null){var L=b.next;b.next=C.next,C.next=L}h.baseQueue=b=C,c.pending=null}if(b!==null){C=b.next,h=h.baseState;var se=L=null,fe=null,je=C;do{var De=je.lane;if((sr&De)===De)fe!==null&&(fe=fe.next={lane:0,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null}),h=je.hasEagerState?je.eagerState:s(h,je.action);else{var Fe={lane:De,action:je.action,hasEagerState:je.hasEagerState,eagerState:je.eagerState,next:null};fe===null?(se=fe=Fe,L=h):fe=fe.next=Fe,yn.lanes|=De,Ga|=De}je=je.next}while(je!==null&&je!==C);fe===null?L=h:fe.next=se,Xs(h,o.memoizedState)||(ws=!0),o.memoizedState=h,o.baseState=L,o.baseQueue=fe,c.lastRenderedState=h}if(s=c.interleaved,s!==null){b=s;do C=b.lane,yn.lanes|=C,Ga|=C,b=b.next;while(b!==s)}else b===null&&(c.lanes=0);return[o.memoizedState,c.dispatch]}function hm(s){var o=rr(),c=o.queue;if(c===null)throw Error(n(311));c.lastRenderedReducer=s;var h=c.dispatch,b=c.pending,C=o.memoizedState;if(b!==null){c.pending=null;var L=b=b.next;do C=s(C,L.action),L=L.next;while(L!==b);Xs(C,o.memoizedState)||(ws=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),c.lastRenderedState=C}return[C,h]}function xh(){}function Ya(s,o){var c=yn,h=rr(),b=o(),C=!Xs(h.memoizedState,b);if(C&&(h.memoizedState=b,ws=!0),h=h.queue,gm(au.bind(null,c,h,s),[s]),h.getSnapshot!==o||C||Xn!==null&&Xn.memoizedState.tag&1){if(c.flags|=2048,Nl(9,wr.bind(null,c,h,b,o),void 0,null),Un===null)throw Error(n(349));sr&30||xa(c,o,b)}return b}function xa(s,o,c){s.flags|=16384,s={getSnapshot:o,value:c},o=yn.updateQueue,o===null?(o={lastEffect:null,stores:null},yn.updateQueue=o,o.stores=[s]):(c=o.stores,c===null?o.stores=[s]:c.push(s))}function wr(s,o,c,h){o.value=c,o.getSnapshot=h,wh(o)&&zs(s)}function au(s,o,c){return c(function(){wh(o)&&zs(s)})}function wh(s){var o=s.getSnapshot;s=s.value;try{var c=o();return!Xs(s,c)}catch{return!0}}function zs(s){var o=ba(s,1);o!==null&&lr(o,s,1,-1)}function pm(s){var o=Hr();return typeof s=="function"&&(s=s()),o.memoizedState=o.baseState=s,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Li,lastRenderedState:s},o.queue=s,s=s.dispatch=__.bind(null,yn,s),[o.memoizedState,s]}function Nl(s,o,c,h){return s={tag:s,create:o,destroy:c,deps:h,next:null},o=yn.updateQueue,o===null?(o={lastEffect:null,stores:null},yn.updateQueue=o,o.lastEffect=s.next=s):(c=o.lastEffect,c===null?o.lastEffect=s.next=s:(h=c.next,c.next=s,s.next=h,o.lastEffect=s)),s}function Sl(){return rr().memoizedState}function ou(s,o,c,h){var b=Hr();yn.flags|=s,b.memoizedState=Nl(1|o,c,void 0,h===void 0?null:h)}function lu(s,o,c,h){var b=rr();h=h===void 0?null:h;var C=void 0;if(Bn!==null){var L=Bn.memoizedState;if(C=L.destroy,h!==null&&um(h,L.deps)){b.memoizedState=Nl(o,c,C,h);return}}yn.flags|=s,b.memoizedState=Nl(1|o,c,C,h)}function jh(s,o){return ou(8390656,8,s,o)}function gm(s,o){return lu(2048,8,s,o)}function Nh(s,o){return lu(4,2,s,o)}function Sh(s,o){return lu(4,4,s,o)}function Ch(s,o){if(typeof o=="function")return s=s(),o(s),function(){o(null)};if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function Eh(s,o,c){return c=c!=null?c.concat([s]):null,lu(4,4,Ch.bind(null,o,s),c)}function _m(){}function kh(s,o){var c=rr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&um(o,h[1])?h[0]:(c.memoizedState=[s,o],s)}function Mh(s,o){var c=rr();o=o===void 0?null:o;var h=c.memoizedState;return h!==null&&o!==null&&um(o,h[1])?h[0]:(s=s(),c.memoizedState=[s,o],s)}function Ah(s,o,c){return sr&21?(Xs(c,o)||(c=ia(),yn.lanes|=c,Ga|=c,s.baseState=!0),o):(s.baseState&&(s.baseState=!1,ws=!0),s.memoizedState=c)}function g_(s,o){var c=Xt;Xt=c!==0&&4>c?c:4,s(!0);var h=cm.transition;cm.transition={};try{s(!1),o()}finally{Xt=c,cm.transition=h}}function Vr(){return rr().memoizedState}function Oh(s,o,c){var h=Na(s);if(c={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null},Ph(s))Th(o,c);else if(c=nm(s,o,c,h),c!==null){var b=ms();lr(c,s,h,b),$h(c,o,h)}}function __(s,o,c){var h=Na(s),b={lane:h,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ph(s))Th(o,b);else{var C=s.alternate;if(s.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var L=o.lastRenderedState,se=C(L,c);if(b.hasEagerState=!0,b.eagerState=se,Xs(se,L)){var fe=o.interleaved;fe===null?(b.next=b,tm(o)):(b.next=fe.next,fe.next=b),o.interleaved=b;return}}catch{}finally{}c=nm(s,o,b,h),c!==null&&(b=ms(),lr(c,s,h,b),$h(c,o,h))}}function Ph(s){var o=s.alternate;return s===yn||o!==null&&o===yn}function Th(s,o){$i=ru=!0;var c=s.pending;c===null?o.next=o:(o.next=c.next,c.next=o),s.pending=o}function $h(s,o,c){if(c&4194240){var h=o.lanes;h&=s.pendingLanes,c|=h,o.lanes=c,di(s,c)}}var iu={readContext:nr,useCallback:On,useContext:On,useEffect:On,useImperativeHandle:On,useInsertionEffect:On,useLayoutEffect:On,useMemo:On,useReducer:On,useRef:On,useState:On,useDebugValue:On,useDeferredValue:On,useTransition:On,useMutableSource:On,useSyncExternalStore:On,useId:On,unstable_isNewReconciler:!1},v_={readContext:nr,useCallback:function(s,o){return Hr().memoizedState=[s,o===void 0?null:o],s},useContext:nr,useEffect:jh,useImperativeHandle:function(s,o,c){return c=c!=null?c.concat([s]):null,ou(4194308,4,Ch.bind(null,o,s),c)},useLayoutEffect:function(s,o){return ou(4194308,4,s,o)},useInsertionEffect:function(s,o){return ou(4,2,s,o)},useMemo:function(s,o){var c=Hr();return o=o===void 0?null:o,s=s(),c.memoizedState=[s,o],s},useReducer:function(s,o,c){var h=Hr();return o=c!==void 0?c(o):o,h.memoizedState=h.baseState=o,s={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:o},h.queue=s,s=s.dispatch=Oh.bind(null,yn,s),[h.memoizedState,s]},useRef:function(s){var o=Hr();return s={current:s},o.memoizedState=s},useState:pm,useDebugValue:_m,useDeferredValue:function(s){return Hr().memoizedState=s},useTransition:function(){var s=pm(!1),o=s[0];return s=g_.bind(null,s[1]),Hr().memoizedState=s,[o,s]},useMutableSource:function(){},useSyncExternalStore:function(s,o,c){var h=yn,b=Hr();if(vn){if(c===void 0)throw Error(n(407));c=c()}else{if(c=o(),Un===null)throw Error(n(349));sr&30||xa(h,o,c)}b.memoizedState=c;var C={value:c,getSnapshot:o};return b.queue=C,jh(au.bind(null,h,C,s),[s]),h.flags|=2048,Nl(9,wr.bind(null,h,C,c,o),void 0,null),c},useId:function(){var s=Hr(),o=Un.identifierPrefix;if(vn){var c=va,h=_a;c=(h&~(1<<32-kn(h)-1)).toString(32)+c,o=":"+o+"R"+c,c=Di++,0<c&&(o+="H"+c.toString(32)),o+=":"}else c=p_++,o=":"+o+"r"+c.toString(32)+":";return s.memoizedState=o},unstable_isNewReconciler:!1},Dh={readContext:nr,useCallback:kh,useContext:nr,useEffect:gm,useImperativeHandle:Eh,useInsertionEffect:Nh,useLayoutEffect:Sh,useMemo:Mh,useReducer:fm,useRef:Sl,useState:function(){return fm(Li)},useDebugValue:_m,useDeferredValue:function(s){var o=rr();return Ah(o,Bn.memoizedState,s)},useTransition:function(){var s=fm(Li)[0],o=rr().memoizedState;return[s,o]},useMutableSource:xh,useSyncExternalStore:Ya,useId:Vr,unstable_isNewReconciler:!1},y_={readContext:nr,useCallback:kh,useContext:nr,useEffect:gm,useImperativeHandle:Eh,useInsertionEffect:Nh,useLayoutEffect:Sh,useMemo:Mh,useReducer:hm,useRef:Sl,useState:function(){return hm(Li)},useDebugValue:_m,useDeferredValue:function(s){var o=rr();return Bn===null?o.memoizedState=s:Ah(o,Bn.memoizedState,s)},useTransition:function(){var s=hm(Li)[0],o=rr().memoizedState;return[s,o]},useMutableSource:xh,useSyncExternalStore:Ya,useId:Vr,unstable_isNewReconciler:!1};function jr(s,o){if(s&&s.defaultProps){o=Q({},o),s=s.defaultProps;for(var c in s)o[c]===void 0&&(o[c]=s[c]);return o}return o}function zi(s,o,c,h){o=s.memoizedState,c=c(h,o),c=c==null?o:Q({},o,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var cu={isMounted:function(s){return(s=s._reactInternals)?Os(s)===s:!1},enqueueSetState:function(s,o,c){s=s._reactInternals;var h=ms(),b=Na(s),C=xr(h,b);C.payload=o,c!=null&&(C.callback=c),o=Wa(s,C,b),o!==null&&(lr(o,s,b,h),eu(o,s,b))},enqueueReplaceState:function(s,o,c){s=s._reactInternals;var h=ms(),b=Na(s),C=xr(h,b);C.tag=1,C.payload=o,c!=null&&(C.callback=c),o=Wa(s,C,b),o!==null&&(lr(o,s,b,h),eu(o,s,b))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var c=ms(),h=Na(s),b=xr(c,h);b.tag=2,o!=null&&(b.callback=o),o=Wa(s,b,h),o!==null&&(lr(o,s,h,c),eu(o,s,h))}};function Lh(s,o,c,h,b,C,L){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,C,L):o.prototype&&o.prototype.isPureReactComponent?!cl(c,h)||!cl(b,C):!0}function vm(s,o,c){var h=!1,b=Ua,C=o.contextType;return typeof C=="object"&&C!==null?C=nr(C):(b=Ss(o)?ko:ts.current,h=o.contextTypes,C=(h=h!=null)?hl(s,b):Ua),o=new o(c,C),s.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=cu,s.stateNode=o,o._reactInternals=s,h&&(s=s.stateNode,s.__reactInternalMemoizedUnmaskedChildContext=b,s.__reactInternalMemoizedMaskedChildContext=C),o}function uu(s,o,c,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(c,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(c,h),o.state!==s&&cu.enqueueReplaceState(o,o.state,null)}function ym(s,o,c,h){var b=s.stateNode;b.props=c,b.state=s.memoizedState,b.refs={},sm(s);var C=o.contextType;typeof C=="object"&&C!==null?b.context=nr(C):(C=Ss(o)?ko:ts.current,b.context=hl(s,C)),b.state=s.memoizedState,C=o.getDerivedStateFromProps,typeof C=="function"&&(zi(s,o,C,c),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(o=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),o!==b.state&&cu.enqueueReplaceState(b,b.state,null),tu(s,c,b,h),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308)}function Cl(s,o){try{var c="",h=o;do c+=U(h),h=h.return;while(h);var b=c}catch(C){b=`
Error generating stack: `+C.message+`
`+C.stack}return{value:s,source:o,stack:b,digest:null}}function bm(s,o,c){return{value:s,source:null,stack:c??null,digest:o??null}}function xm(s,o){try{console.error(o.value)}catch(c){setTimeout(function(){throw c})}}var b_=typeof WeakMap=="function"?WeakMap:Map;function du(s,o,c){c=xr(-1,c),c.tag=3,c.payload={element:null};var h=o.value;return c.callback=function(){Ui||(Ui=!0,ku=h),xm(s,o)},c}function zh(s,o,c){c=xr(-1,c),c.tag=3;var h=s.type.getDerivedStateFromError;if(typeof h=="function"){var b=o.value;c.payload=function(){return h(b)},c.callback=function(){xm(s,o)}}var C=s.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(c.callback=function(){xm(s,o),typeof h!="function"&&(wa===null?wa=new Set([this]):wa.add(this));var L=o.stack;this.componentDidCatch(o.value,{componentStack:L!==null?L:""})}),c}function Rh(s,o,c){var h=s.pingCache;if(h===null){h=s.pingCache=new b_;var b=new Set;h.set(o,b)}else b=h.get(o),b===void 0&&(b=new Set,h.set(o,b));b.has(c)||(b.add(c),s=Er.bind(null,s,o,c),o.then(s,s))}function wm(s){do{var o;if((o=s.tag===13)&&(o=s.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return s;s=s.return}while(s!==null);return null}function mu(s,o,c,h,b){return s.mode&1?(s.flags|=65536,s.lanes=b,s):(s===o?s.flags|=65536:(s.flags|=128,c.flags|=131072,c.flags&=-52805,c.tag===1&&(c.alternate===null?c.tag=17:(o=xr(-1,1),o.tag=2,Wa(c,o,1))),c.lanes|=1),s)}var x_=w.ReactCurrentOwner,ws=!1;function cs(s,o,c,h){o.child=s===null?Xc(o,null,c,h):qr(o,s.child,c,h)}function jm(s,o,c,h,b){c=c.render;var C=o.ref;return bl(o,b),h=dm(s,o,c,h,C,b),c=mm(),s!==null&&!ws?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,Fn(s,o,b)):(vn&&c&&Oi(o),o.flags|=1,cs(s,o,h,b),o.child)}function Nr(s,o,c,h,b){if(s===null){var C=c.type;return typeof C=="function"&&!E_(C)&&C.defaultProps===void 0&&c.compare===null&&c.defaultProps===void 0?(o.tag=15,o.type=C,fu(s,o,C,h,b)):(s=Jh(c.type,null,h,o,o.mode,b),s.ref=o.ref,s.return=o,o.child=s)}if(C=s.child,!(s.lanes&b)){var L=C.memoizedProps;if(c=c.compare,c=c!==null?c:cl,c(L,h)&&s.ref===o.ref)return Fn(s,o,b)}return o.flags|=1,s=Pl(C,h),s.ref=o.ref,s.return=o,o.child=s}function fu(s,o,c,h,b){if(s!==null){var C=s.memoizedProps;if(cl(C,h)&&s.ref===o.ref)if(ws=!1,o.pendingProps=h=C,(s.lanes&b)!==0)s.flags&131072&&(ws=!0);else return o.lanes=s.lanes,Fn(s,o,b)}return pu(s,o,c,h,b)}function Nm(s,o,c){var h=o.pendingProps,b=h.children,C=s!==null?s.memoizedState:null;if(h.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kt($o,Cs),Cs|=c;else{if(!(c&1073741824))return s=C!==null?C.baseLanes|c:c,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:s,cachePool:null,transitions:null},o.updateQueue=null,Kt($o,Cs),Cs|=s,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=C!==null?C.baseLanes:c,Kt($o,Cs),Cs|=h}else C!==null?(h=C.baseLanes|c,o.memoizedState=null):h=c,Kt($o,Cs),Cs|=h;return cs(s,o,b,c),o.child}function hu(s,o){var c=o.ref;(s===null&&c!==null||s!==null&&s.ref!==c)&&(o.flags|=512,o.flags|=2097152)}function pu(s,o,c,h,b){var C=Ss(c)?ko:ts.current;return C=hl(o,C),bl(o,b),c=dm(s,o,c,h,C,b),h=mm(),s!==null&&!ws?(o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~b,Fn(s,o,b)):(vn&&h&&Oi(o),o.flags|=1,cs(s,o,c,b),o.child)}function Fh(s,o,c,h,b){if(Ss(c)){var C=!0;Vc(o)}else C=!1;if(bl(o,b),o.stateNode===null)wu(s,o),vm(o,c,h),ym(o,c,h,b),h=!0;else if(s===null){var L=o.stateNode,se=o.memoizedProps;L.props=se;var fe=L.context,je=c.contextType;typeof je=="object"&&je!==null?je=nr(je):(je=Ss(c)?ko:ts.current,je=hl(o,je));var De=c.getDerivedStateFromProps,Fe=typeof De=="function"||typeof L.getSnapshotBeforeUpdate=="function";Fe||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(se!==h||fe!==je)&&uu(o,L,h,je),Va=!1;var $e=o.memoizedState;L.state=$e,tu(o,h,L,b),fe=o.memoizedState,se!==h||$e!==fe||ls.current||Va?(typeof De=="function"&&(zi(o,c,De,h),fe=o.memoizedState),(se=Va||Lh(o,c,se,h,$e,fe,je))?(Fe||typeof L.UNSAFE_componentWillMount!="function"&&typeof L.componentWillMount!="function"||(typeof L.componentWillMount=="function"&&L.componentWillMount(),typeof L.UNSAFE_componentWillMount=="function"&&L.UNSAFE_componentWillMount()),typeof L.componentDidMount=="function"&&(o.flags|=4194308)):(typeof L.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=fe),L.props=h,L.state=fe,L.context=je,h=se):(typeof L.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{L=o.stateNode,bh(s,o),se=o.memoizedProps,je=o.type===o.elementType?se:jr(o.type,se),L.props=je,Fe=o.pendingProps,$e=L.context,fe=c.contextType,typeof fe=="object"&&fe!==null?fe=nr(fe):(fe=Ss(c)?ko:ts.current,fe=hl(o,fe));var nt=c.getDerivedStateFromProps;(De=typeof nt=="function"||typeof L.getSnapshotBeforeUpdate=="function")||typeof L.UNSAFE_componentWillReceiveProps!="function"&&typeof L.componentWillReceiveProps!="function"||(se!==Fe||$e!==fe)&&uu(o,L,h,fe),Va=!1,$e=o.memoizedState,L.state=$e,tu(o,h,L,b);var lt=o.memoizedState;se!==Fe||$e!==lt||ls.current||Va?(typeof nt=="function"&&(zi(o,c,nt,h),lt=o.memoizedState),(je=Va||Lh(o,c,je,h,$e,lt,fe)||!1)?(De||typeof L.UNSAFE_componentWillUpdate!="function"&&typeof L.componentWillUpdate!="function"||(typeof L.componentWillUpdate=="function"&&L.componentWillUpdate(h,lt,fe),typeof L.UNSAFE_componentWillUpdate=="function"&&L.UNSAFE_componentWillUpdate(h,lt,fe)),typeof L.componentDidUpdate=="function"&&(o.flags|=4),typeof L.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof L.componentDidUpdate!="function"||se===s.memoizedProps&&$e===s.memoizedState||(o.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||se===s.memoizedProps&&$e===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=lt),L.props=h,L.state=lt,L.context=fe,h=je):(typeof L.componentDidUpdate!="function"||se===s.memoizedProps&&$e===s.memoizedState||(o.flags|=4),typeof L.getSnapshotBeforeUpdate!="function"||se===s.memoizedProps&&$e===s.memoizedState||(o.flags|=1024),h=!1)}return Sm(s,o,c,h,C,b)}function Sm(s,o,c,h,b,C){hu(s,o);var L=(o.flags&128)!==0;if(!h&&!L)return b&&ph(o,c,!1),Fn(s,o,C);h=o.stateNode,x_.current=o;var se=L&&typeof c.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,s!==null&&L?(o.child=qr(o,s.child,null,C),o.child=qr(o,null,se,C)):cs(s,o,se,C),o.memoizedState=h.state,b&&ph(o,c,!0),o.child}function Cm(s){var o=s.stateNode;o.pendingContext?fh(s,o.pendingContext,o.pendingContext!==o.context):o.context&&fh(s,o.context,!1),om(s,o.containerInfo)}function Ih(s,o,c,h,b){return vl(),Jd(b),o.flags|=256,cs(s,o,c,h),o.child}var gu={dehydrated:null,treeContext:null,retryLane:0};function Em(s){return{baseLanes:s,cachePool:null,transitions:null}}function _u(s,o,c){var h=o.pendingProps,b=wn.current,C=!1,L=(o.flags&128)!==0,se;if((se=L)||(se=s!==null&&s.memoizedState===null?!1:(b&2)!==0),se?(C=!0,o.flags&=-129):(s===null||s.memoizedState!==null)&&(b|=1),Kt(wn,b&1),s===null)return Xd(o),s=o.memoizedState,s!==null&&(s=s.dehydrated,s!==null)?(o.mode&1?s.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(L=h.children,s=h.fallback,C?(h=o.mode,C=o.child,L={mode:"hidden",children:L},!(h&1)&&C!==null?(C.childLanes=0,C.pendingProps=L):C=Zh(L,h,0,null),s=Ki(s,h,c,null),C.return=o,s.return=o,C.sibling=s,o.child=C,o.child.memoizedState=Em(c),o.memoizedState=gu,s):vu(o,L));if(b=s.memoizedState,b!==null&&(se=b.dehydrated,se!==null))return km(s,o,L,h,se,b,c);if(C){C=h.fallback,L=o.mode,b=s.child,se=b.sibling;var fe={mode:"hidden",children:h.children};return!(L&1)&&o.child!==b?(h=o.child,h.childLanes=0,h.pendingProps=fe,o.deletions=null):(h=Pl(b,fe),h.subtreeFlags=b.subtreeFlags&14680064),se!==null?C=Pl(se,C):(C=Ki(C,L,c,null),C.flags|=2),C.return=o,h.return=o,h.sibling=C,o.child=h,h=C,C=o.child,L=s.child.memoizedState,L=L===null?Em(c):{baseLanes:L.baseLanes|c,cachePool:null,transitions:L.transitions},C.memoizedState=L,C.childLanes=s.childLanes&~c,o.memoizedState=gu,h}return C=s.child,s=C.sibling,h=Pl(C,{mode:"visible",children:h.children}),!(o.mode&1)&&(h.lanes=c),h.return=o,h.sibling=null,s!==null&&(c=o.deletions,c===null?(o.deletions=[s],o.flags|=16):c.push(s)),o.child=h,o.memoizedState=null,h}function vu(s,o){return o=Zh({mode:"visible",children:o},s.mode,0,null),o.return=s,s.child=o}function yu(s,o,c,h){return h!==null&&Jd(h),qr(o,s.child,null,c),s=vu(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function km(s,o,c,h,b,C,L){if(c)return o.flags&256?(o.flags&=-257,h=bm(Error(n(422))),yu(s,o,L,h)):o.memoizedState!==null?(o.child=s.child,o.flags|=128,null):(C=h.fallback,b=o.mode,h=Zh({mode:"visible",children:h.children},b,0,null),C=Ki(C,b,L,null),C.flags|=2,h.return=o,C.return=o,h.sibling=C,o.child=h,o.mode&1&&qr(o,s.child,null,L),o.child.memoizedState=Em(L),o.memoizedState=gu,C);if(!(o.mode&1))return yu(s,o,L,null);if(b.data==="$!"){if(h=b.nextSibling&&b.nextSibling.dataset,h)var se=h.dgst;return h=se,C=Error(n(419)),h=bm(C,h,void 0),yu(s,o,L,h)}if(se=(L&s.childLanes)!==0,ws||se){if(h=Un,h!==null){switch(L&-L){case 4:b=2;break;case 16:b=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:b=32;break;case 536870912:b=268435456;break;default:b=0}b=b&(h.suspendedLanes|L)?0:b,b!==0&&b!==C.retryLane&&(C.retryLane=b,ba(s,b),lr(h,s,b,-1))}return Rt(),h=bm(Error(n(421))),yu(s,o,L,h)}return b.data==="$?"?(o.flags|=128,o.child=s.child,o=Au.bind(null,s),b._reactRetry=o,null):(s=C.treeContext,$s=ha(b.nextSibling),xs=o,vn=!0,Ds=null,s!==null&&(er[tr++]=_a,er[tr++]=va,er[tr++]=Mo,_a=s.id,va=s.overflow,Mo=o),o=vu(o,h.children),o.flags|=4096,o)}function bu(s,o,c){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),em(s.return,o,c)}function xu(s,o,c,h,b){var C=s.memoizedState;C===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:c,tailMode:b}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=h,C.tail=c,C.tailMode=b)}function w_(s,o,c){var h=o.pendingProps,b=h.revealOrder,C=h.tail;if(cs(s,o,h.children,c),h=wn.current,h&2)h=h&1|2,o.flags|=128;else{if(s!==null&&s.flags&128)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&bu(s,c,o);else if(s.tag===19)bu(s,c,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}if(Kt(wn,h),!(o.mode&1))o.memoizedState=null;else switch(b){case"forwards":for(c=o.child,b=null;c!==null;)s=c.alternate,s!==null&&jl(s)===null&&(b=c),c=c.sibling;c=b,c===null?(b=o.child,o.child=null):(b=c.sibling,c.sibling=null),xu(o,!1,b,c,C);break;case"backwards":for(c=null,b=o.child,o.child=null;b!==null;){if(s=b.alternate,s!==null&&jl(s)===null){o.child=b;break}s=b.sibling,b.sibling=c,c=b,b=s}xu(o,!0,c,null,C);break;case"together":xu(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function wu(s,o){!(o.mode&1)&&s!==null&&(s.alternate=null,o.alternate=null,o.flags|=2)}function Fn(s,o,c){if(s!==null&&(o.dependencies=s.dependencies),Ga|=o.lanes,!(c&o.childLanes))return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,c=Pl(s,s.pendingProps),o.child=c,c.return=o;s.sibling!==null;)s=s.sibling,c=c.sibling=Pl(s,s.pendingProps),c.return=o;c.sibling=null}return o.child}function ar(s,o,c){switch(o.tag){case 3:Cm(o),vl();break;case 5:nu(o);break;case 1:Ss(o.type)&&Vc(o);break;case 4:om(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,b=o.memoizedProps.value;Kt(Jc,h._currentValue),h._currentValue=b;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(Kt(wn,wn.current&1),o.flags|=128,null):c&o.child.childLanes?_u(s,o,c):(Kt(wn,wn.current&1),s=Fn(s,o,c),s!==null?s.sibling:null);Kt(wn,wn.current&1);break;case 19:if(h=(c&o.childLanes)!==0,s.flags&128){if(h)return w_(s,o,c);o.flags|=128}if(b=o.memoizedState,b!==null&&(b.rendering=null,b.tail=null,b.lastEffect=null),Kt(wn,wn.current),h)break;return null;case 22:case 23:return o.lanes=0,Nm(s,o,c)}return Fn(s,o,c)}var Rs,Mm,Bh,Uh;Rs=function(s,o){for(var c=o.child;c!==null;){if(c.tag===5||c.tag===6)s.appendChild(c.stateNode);else if(c.tag!==4&&c.child!==null){c.child.return=c,c=c.child;continue}if(c===o)break;for(;c.sibling===null;){if(c.return===null||c.return===o)return;c=c.return}c.sibling.return=c.return,c=c.sibling}},Mm=function(){},Bh=function(s,o,c,h){var b=s.memoizedProps;if(b!==h){s=o.stateNode,Ka(ln.current);var C=null;switch(c){case"input":b=Ne(s,b),h=Ne(s,h),C=[];break;case"select":b=Q({},b,{value:void 0}),h=Q({},h,{value:void 0}),C=[];break;case"textarea":b=Oe(s,b),h=Oe(s,h),C=[];break;default:typeof b.onClick!="function"&&typeof h.onClick=="function"&&(s.onclick=Bc)}Ft(c,h);var L;c=null;for(je in b)if(!h.hasOwnProperty(je)&&b.hasOwnProperty(je)&&b[je]!=null)if(je==="style"){var se=b[je];for(L in se)se.hasOwnProperty(L)&&(c||(c={}),c[L]="")}else je!=="dangerouslySetInnerHTML"&&je!=="children"&&je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&je!=="autoFocus"&&(l.hasOwnProperty(je)?C||(C=[]):(C=C||[]).push(je,null));for(je in h){var fe=h[je];if(se=b!=null?b[je]:void 0,h.hasOwnProperty(je)&&fe!==se&&(fe!=null||se!=null))if(je==="style")if(se){for(L in se)!se.hasOwnProperty(L)||fe&&fe.hasOwnProperty(L)||(c||(c={}),c[L]="");for(L in fe)fe.hasOwnProperty(L)&&se[L]!==fe[L]&&(c||(c={}),c[L]=fe[L])}else c||(C||(C=[]),C.push(je,c)),c=fe;else je==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,se=se?se.__html:void 0,fe!=null&&se!==fe&&(C=C||[]).push(je,fe)):je==="children"?typeof fe!="string"&&typeof fe!="number"||(C=C||[]).push(je,""+fe):je!=="suppressContentEditableWarning"&&je!=="suppressHydrationWarning"&&(l.hasOwnProperty(je)?(fe!=null&&je==="onScroll"&&mn("scroll",s),C||se===fe||(C=[])):(C=C||[]).push(je,fe))}c&&(C=C||[]).push("style",c);var je=C;(o.updateQueue=je)&&(o.flags|=4)}},Uh=function(s,o,c,h){c!==h&&(o.flags|=4)};function Ri(s,o){if(!vn)switch(s.tailMode){case"hidden":o=s.tail;for(var c=null;o!==null;)o.alternate!==null&&(c=o),o=o.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var h=null;c!==null;)c.alternate!==null&&(h=c),c=c.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function us(s){var o=s.alternate!==null&&s.alternate.child===s.child,c=0,h=0;if(o)for(var b=s.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags&14680064,h|=b.flags&14680064,b.return=s,b=b.sibling;else for(b=s.child;b!==null;)c|=b.lanes|b.childLanes,h|=b.subtreeFlags,h|=b.flags,b.return=s,b=b.sibling;return s.subtreeFlags|=h,s.childLanes=c,o}function j_(s,o,c){var h=o.pendingProps;switch(Qd(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return us(o),null;case 1:return Ss(o.type)&&Hc(),us(o),null;case 3:return h=o.stateNode,xl(),fn(ls),fn(ts),im(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Qc(o)?o.flags|=4:s===null||s.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,Ds!==null&&(I(Ds),Ds=null))),Mm(s,o),us(o),null;case 5:wl(o);var b=Ka(is.current);if(c=o.type,s!==null&&o.stateNode!=null)Bh(s,o,c,h,b),s.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(n(166));return us(o),null}if(s=Ka(ln.current),Qc(o)){h=o.stateNode,c=o.type;var C=o.memoizedProps;switch(h[Ur]=o,h[Ia]=C,s=(o.mode&1)!==0,c){case"dialog":mn("cancel",h),mn("close",h);break;case"iframe":case"object":case"embed":mn("load",h);break;case"video":case"audio":for(b=0;b<jo.length;b++)mn(jo[b],h);break;case"source":mn("error",h);break;case"img":case"image":case"link":mn("error",h),mn("load",h);break;case"details":mn("toggle",h);break;case"input":ze(h,C),mn("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!C.multiple},mn("invalid",h);break;case"textarea":Te(h,C),mn("invalid",h)}Ft(c,C),b=null;for(var L in C)if(C.hasOwnProperty(L)){var se=C[L];L==="children"?typeof se=="string"?h.textContent!==se&&(C.suppressHydrationWarning!==!0&&ki(h.textContent,se,s),b=["children",se]):typeof se=="number"&&h.textContent!==""+se&&(C.suppressHydrationWarning!==!0&&ki(h.textContent,se,s),b=["children",""+se]):l.hasOwnProperty(L)&&se!=null&&L==="onScroll"&&mn("scroll",h)}switch(c){case"input":Ve(h),He(h,C,!0);break;case"textarea":Ve(h),jt(h);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(h.onclick=Bc)}h=b,o.updateQueue=h,h!==null&&(o.flags|=4)}else{L=b.nodeType===9?b:b.ownerDocument,s==="http://www.w3.org/1999/xhtml"&&(s=rn(c)),s==="http://www.w3.org/1999/xhtml"?c==="script"?(s=L.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild)):typeof h.is=="string"?s=L.createElement(c,{is:h.is}):(s=L.createElement(c),c==="select"&&(L=s,h.multiple?L.multiple=!0:h.size&&(L.size=h.size))):s=L.createElementNS(s,c),s[Ur]=o,s[Ia]=h,Rs(s,o,!1,!1),o.stateNode=s;e:{switch(L=ct(c,h),c){case"dialog":mn("cancel",s),mn("close",s),b=h;break;case"iframe":case"object":case"embed":mn("load",s),b=h;break;case"video":case"audio":for(b=0;b<jo.length;b++)mn(jo[b],s);b=h;break;case"source":mn("error",s),b=h;break;case"img":case"image":case"link":mn("error",s),mn("load",s),b=h;break;case"details":mn("toggle",s),b=h;break;case"input":ze(s,h),b=Ne(s,h),mn("invalid",s);break;case"option":b=h;break;case"select":s._wrapperState={wasMultiple:!!h.multiple},b=Q({},h,{value:void 0}),mn("invalid",s);break;case"textarea":Te(s,h),b=Oe(s,h),mn("invalid",s);break;default:b=h}Ft(c,b),se=b;for(C in se)if(se.hasOwnProperty(C)){var fe=se[C];C==="style"?xt(s,fe):C==="dangerouslySetInnerHTML"?(fe=fe?fe.__html:void 0,fe!=null&&ke(s,fe)):C==="children"?typeof fe=="string"?(c!=="textarea"||fe!=="")&&Le(s,fe):typeof fe=="number"&&Le(s,""+fe):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(l.hasOwnProperty(C)?fe!=null&&C==="onScroll"&&mn("scroll",s):fe!=null&&T(s,C,fe,L))}switch(c){case"input":Ve(s),He(s,h,!1);break;case"textarea":Ve(s),jt(s);break;case"option":h.value!=null&&s.setAttribute("value",""+re(h.value));break;case"select":s.multiple=!!h.multiple,C=h.value,C!=null?X(s,!!h.multiple,C,!1):h.defaultValue!=null&&X(s,!!h.multiple,h.defaultValue,!0);break;default:typeof b.onClick=="function"&&(s.onclick=Bc)}switch(c){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return us(o),null;case 6:if(s&&o.stateNode!=null)Uh(s,o,s.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(n(166));if(c=Ka(is.current),Ka(ln.current),Qc(o)){if(h=o.stateNode,c=o.memoizedProps,h[Ur]=o,(C=h.nodeValue!==c)&&(s=xs,s!==null))switch(s.tag){case 3:ki(h.nodeValue,c,(s.mode&1)!==0);break;case 5:s.memoizedProps.suppressHydrationWarning!==!0&&ki(h.nodeValue,c,(s.mode&1)!==0)}C&&(o.flags|=4)}else h=(c.nodeType===9?c:c.ownerDocument).createTextNode(h),h[Ur]=o,o.stateNode=h}return us(o),null;case 13:if(fn(wn),h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(vn&&$s!==null&&o.mode&1&&!(o.flags&128))_h(),vl(),o.flags|=98560,C=!1;else if(C=Qc(o),h!==null&&h.dehydrated!==null){if(s===null){if(!C)throw Error(n(318));if(C=o.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(n(317));C[Ur]=o}else vl(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;us(o),C=!1}else Ds!==null&&(I(Ds),Ds=null),C=!0;if(!C)return o.flags&65536?o:null}return o.flags&128?(o.lanes=c,o):(h=h!==null,h!==(s!==null&&s.memoizedState!==null)&&h&&(o.child.flags|=8192,o.mode&1&&(s===null||wn.current&1?In===0&&(In=3):Rt())),o.updateQueue!==null&&(o.flags|=4),us(o),null);case 4:return xl(),Mm(s,o),s===null&&No(o.stateNode.containerInfo),us(o),null;case 10:return Ha(o.type._context),us(o),null;case 17:return Ss(o.type)&&Hc(),us(o),null;case 19:if(fn(wn),C=o.memoizedState,C===null)return us(o),null;if(h=(o.flags&128)!==0,L=C.rendering,L===null)if(h)Ri(C,!1);else{if(In!==0||s!==null&&s.flags&128)for(s=o.child;s!==null;){if(L=jl(s),L!==null){for(o.flags|=128,Ri(C,!1),h=L.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=c,c=o.child;c!==null;)C=c,s=h,C.flags&=14680066,L=C.alternate,L===null?(C.childLanes=0,C.lanes=s,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=L.childLanes,C.lanes=L.lanes,C.child=L.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=L.memoizedProps,C.memoizedState=L.memoizedState,C.updateQueue=L.updateQueue,C.type=L.type,s=L.dependencies,C.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),c=c.sibling;return Kt(wn,wn.current&1|2),o.child}s=s.sibling}C.tail!==null&&Ge()>Do&&(o.flags|=128,h=!0,Ri(C,!1),o.lanes=4194304)}else{if(!h)if(s=jl(L),s!==null){if(o.flags|=128,h=!0,c=s.updateQueue,c!==null&&(o.updateQueue=c,o.flags|=4),Ri(C,!0),C.tail===null&&C.tailMode==="hidden"&&!L.alternate&&!vn)return us(o),null}else 2*Ge()-C.renderingStartTime>Do&&c!==1073741824&&(o.flags|=128,h=!0,Ri(C,!1),o.lanes=4194304);C.isBackwards?(L.sibling=o.child,o.child=L):(c=C.last,c!==null?c.sibling=L:o.child=L,C.last=L)}return C.tail!==null?(o=C.tail,C.rendering=o,C.tail=o.sibling,C.renderingStartTime=Ge(),o.sibling=null,c=wn.current,Kt(wn,h?c&1|2:c&1),o):(us(o),null);case 22:case 23:return Ce(),h=o.memoizedState!==null,s!==null&&s.memoizedState!==null!==h&&(o.flags|=8192),h&&o.mode&1?Cs&1073741824&&(us(o),o.subtreeFlags&6&&(o.flags|=8192)):us(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function N_(s,o){switch(Qd(o),o.tag){case 1:return Ss(o.type)&&Hc(),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return xl(),fn(ls),fn(ts),im(),s=o.flags,s&65536&&!(s&128)?(o.flags=s&-65537|128,o):null;case 5:return wl(o),null;case 13:if(fn(wn),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));vl()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return fn(wn),null;case 4:return xl(),null;case 10:return Ha(o.type._context),null;case 22:case 23:return Ce(),null;case 24:return null;default:return null}}var ju=!1,ds=!1,S_=typeof WeakSet=="function"?WeakSet:Set,at=null;function El(s,o){var c=s.ref;if(c!==null)if(typeof c=="function")try{c(null)}catch(h){Vt(s,o,h)}else c.current=null}function Am(s,o,c){try{c()}catch(h){Vt(s,o,h)}}var qh=!1;function C_(s,o){if(Et=vs,s=zd(),Fr(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var h=c.getSelection&&c.getSelection();if(h&&h.rangeCount!==0){c=h.anchorNode;var b=h.anchorOffset,C=h.focusNode;h=h.focusOffset;try{c.nodeType,C.nodeType}catch{c=null;break e}var L=0,se=-1,fe=-1,je=0,De=0,Fe=s,$e=null;t:for(;;){for(var nt;Fe!==c||b!==0&&Fe.nodeType!==3||(se=L+b),Fe!==C||h!==0&&Fe.nodeType!==3||(fe=L+h),Fe.nodeType===3&&(L+=Fe.nodeValue.length),(nt=Fe.firstChild)!==null;)$e=Fe,Fe=nt;for(;;){if(Fe===s)break t;if($e===c&&++je===b&&(se=L),$e===C&&++De===h&&(fe=L),(nt=Fe.nextSibling)!==null)break;Fe=$e,$e=Fe.parentNode}Fe=nt}c=se===-1||fe===-1?null:{start:se,end:fe}}else c=null}c=c||{start:0,end:0}}else c=null;for(Uc={focusedElem:s,selectionRange:c},vs=!1,at=o;at!==null;)if(o=at,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,at=s;else for(;at!==null;){o=at;try{var lt=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(lt!==null){var it=lt.memoizedProps,Hn=lt.memoizedState,_e=o.stateNode,he=_e.getSnapshotBeforeUpdate(o.elementType===o.type?it:jr(o.type,it),Hn);_e.__reactInternalSnapshotBeforeUpdate=he}break;case 3:var ye=o.stateNode.containerInfo;ye.nodeType===1?ye.textContent="":ye.nodeType===9&&ye.documentElement&&ye.removeChild(ye.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(qe){Vt(o,o.return,qe)}if(s=o.sibling,s!==null){s.return=o.return,at=s;break}at=o.return}return lt=qh,qh=!1,lt}function Fi(s,o,c){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var b=h=h.next;do{if((b.tag&s)===s){var C=b.destroy;b.destroy=void 0,C!==void 0&&Am(o,c,C)}b=b.next}while(b!==h)}}function Nu(s,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var c=o=o.next;do{if((c.tag&s)===s){var h=c.create;c.destroy=h()}c=c.next}while(c!==o)}}function or(s){var o=s.ref;if(o!==null){var c=s.stateNode;switch(s.tag){case 5:s=c;break;default:s=c}typeof o=="function"?o(s):o.current=s}}function Hh(s){var o=s.alternate;o!==null&&(s.alternate=null,Hh(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&(delete o[Ur],delete o[Ia],delete o[Vd],delete o[qc],delete o[mh])),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}function Vh(s){return s.tag===5||s.tag===3||s.tag===4}function Wh(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||Vh(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function Om(s,o,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?c.nodeType===8?c.parentNode.insertBefore(s,o):c.insertBefore(s,o):(c.nodeType===8?(o=c.parentNode,o.insertBefore(s,c)):(o=c,o.appendChild(s)),c=c._reactRootContainer,c!=null||o.onclick!==null||(o.onclick=Bc));else if(h!==4&&(s=s.child,s!==null))for(Om(s,o,c),s=s.sibling;s!==null;)Om(s,o,c),s=s.sibling}function Pm(s,o,c){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?c.insertBefore(s,o):c.appendChild(s);else if(h!==4&&(s=s.child,s!==null))for(Pm(s,o,c),s=s.sibling;s!==null;)Pm(s,o,c),s=s.sibling}var ns=null,Sr=!1;function Qa(s,o,c){for(c=c.child;c!==null;)Kh(s,o,c),c=c.sibling}function Kh(s,o,c){if(_n&&typeof _n.onCommitFiberUnmount=="function")try{_n.onCommitFiberUnmount(gn,c)}catch{}switch(c.tag){case 5:ds||El(c,o);case 6:var h=ns,b=Sr;ns=null,Qa(s,o,c),ns=h,Sr=b,ns!==null&&(Sr?(s=ns,c=c.stateNode,s.nodeType===8?s.parentNode.removeChild(c):s.removeChild(c)):ns.removeChild(c.stateNode));break;case 18:ns!==null&&(Sr?(s=ns,c=c.stateNode,s.nodeType===8?Hd(s.parentNode,c):s.nodeType===1&&Hd(s,c),Gs(s)):Hd(ns,c.stateNode));break;case 4:h=ns,b=Sr,ns=c.stateNode.containerInfo,Sr=!0,Qa(s,o,c),ns=h,Sr=b;break;case 0:case 11:case 14:case 15:if(!ds&&(h=c.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){b=h=h.next;do{var C=b,L=C.destroy;C=C.tag,L!==void 0&&(C&2||C&4)&&Am(c,o,L),b=b.next}while(b!==h)}Qa(s,o,c);break;case 1:if(!ds&&(El(c,o),h=c.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=c.memoizedProps,h.state=c.memoizedState,h.componentWillUnmount()}catch(se){Vt(c,o,se)}Qa(s,o,c);break;case 21:Qa(s,o,c);break;case 22:c.mode&1?(ds=(h=ds)||c.memoizedState!==null,Qa(s,o,c),ds=h):Qa(s,o,c);break;default:Qa(s,o,c)}}function Yh(s){var o=s.updateQueue;if(o!==null){s.updateQueue=null;var c=s.stateNode;c===null&&(c=s.stateNode=new S_),o.forEach(function(h){var b=Ol.bind(null,s,h);c.has(h)||(c.add(h),h.then(b,b))})}}function Cr(s,o){var c=o.deletions;if(c!==null)for(var h=0;h<c.length;h++){var b=c[h];try{var C=s,L=o,se=L;e:for(;se!==null;){switch(se.tag){case 5:ns=se.stateNode,Sr=!1;break e;case 3:ns=se.stateNode.containerInfo,Sr=!0;break e;case 4:ns=se.stateNode.containerInfo,Sr=!0;break e}se=se.return}if(ns===null)throw Error(n(160));Kh(C,L,b),ns=null,Sr=!1;var fe=b.alternate;fe!==null&&(fe.return=null),b.return=null}catch(je){Vt(b,o,je)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Qh(o,s),o=o.sibling}function Qh(s,o){var c=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:if(Cr(o,s),Wr(s),h&4){try{Fi(3,s,s.return),Nu(3,s)}catch(it){Vt(s,s.return,it)}try{Fi(5,s,s.return)}catch(it){Vt(s,s.return,it)}}break;case 1:Cr(o,s),Wr(s),h&512&&c!==null&&El(c,c.return);break;case 5:if(Cr(o,s),Wr(s),h&512&&c!==null&&El(c,c.return),s.flags&32){var b=s.stateNode;try{Le(b,"")}catch(it){Vt(s,s.return,it)}}if(h&4&&(b=s.stateNode,b!=null)){var C=s.memoizedProps,L=c!==null?c.memoizedProps:C,se=s.type,fe=s.updateQueue;if(s.updateQueue=null,fe!==null)try{se==="input"&&C.type==="radio"&&C.name!=null&&Se(b,C),ct(se,L);var je=ct(se,C);for(L=0;L<fe.length;L+=2){var De=fe[L],Fe=fe[L+1];De==="style"?xt(b,Fe):De==="dangerouslySetInnerHTML"?ke(b,Fe):De==="children"?Le(b,Fe):T(b,De,Fe,je)}switch(se){case"input":Be(b,C);break;case"textarea":ot(b,C);break;case"select":var $e=b._wrapperState.wasMultiple;b._wrapperState.wasMultiple=!!C.multiple;var nt=C.value;nt!=null?X(b,!!C.multiple,nt,!1):$e!==!!C.multiple&&(C.defaultValue!=null?X(b,!!C.multiple,C.defaultValue,!0):X(b,!!C.multiple,C.multiple?[]:"",!1))}b[Ia]=C}catch(it){Vt(s,s.return,it)}}break;case 6:if(Cr(o,s),Wr(s),h&4){if(s.stateNode===null)throw Error(n(162));b=s.stateNode,C=s.memoizedProps;try{b.nodeValue=C}catch(it){Vt(s,s.return,it)}}break;case 3:if(Cr(o,s),Wr(s),h&4&&c!==null&&c.memoizedState.isDehydrated)try{Gs(o.containerInfo)}catch(it){Vt(s,s.return,it)}break;case 4:Cr(o,s),Wr(s);break;case 13:Cr(o,s),Wr(s),b=s.child,b.flags&8192&&(C=b.memoizedState!==null,b.stateNode.isHidden=C,!C||b.alternate!==null&&b.alternate.memoizedState!==null||(Eu=Ge())),h&4&&Yh(s);break;case 22:if(De=c!==null&&c.memoizedState!==null,s.mode&1?(ds=(je=ds)||De,Cr(o,s),ds=je):Cr(o,s),Wr(s),h&8192){if(je=s.memoizedState!==null,(s.stateNode.isHidden=je)&&!De&&s.mode&1)for(at=s,De=s.child;De!==null;){for(Fe=at=De;at!==null;){switch($e=at,nt=$e.child,$e.tag){case 0:case 11:case 14:case 15:Fi(4,$e,$e.return);break;case 1:El($e,$e.return);var lt=$e.stateNode;if(typeof lt.componentWillUnmount=="function"){h=$e,c=$e.return;try{o=h,lt.props=o.memoizedProps,lt.state=o.memoizedState,lt.componentWillUnmount()}catch(it){Vt(h,c,it)}}break;case 5:El($e,$e.return);break;case 22:if($e.memoizedState!==null){Tm(Fe);continue}}nt!==null?(nt.return=$e,at=nt):Tm(Fe)}De=De.sibling}e:for(De=null,Fe=s;;){if(Fe.tag===5){if(De===null){De=Fe;try{b=Fe.stateNode,je?(C=b.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(se=Fe.stateNode,fe=Fe.memoizedProps.style,L=fe!=null&&fe.hasOwnProperty("display")?fe.display:null,se.style.display=tt("display",L))}catch(it){Vt(s,s.return,it)}}}else if(Fe.tag===6){if(De===null)try{Fe.stateNode.nodeValue=je?"":Fe.memoizedProps}catch(it){Vt(s,s.return,it)}}else if((Fe.tag!==22&&Fe.tag!==23||Fe.memoizedState===null||Fe===s)&&Fe.child!==null){Fe.child.return=Fe,Fe=Fe.child;continue}if(Fe===s)break e;for(;Fe.sibling===null;){if(Fe.return===null||Fe.return===s)break e;De===Fe&&(De=null),Fe=Fe.return}De===Fe&&(De=null),Fe.sibling.return=Fe.return,Fe=Fe.sibling}}break;case 19:Cr(o,s),Wr(s),h&4&&Yh(s);break;case 21:break;default:Cr(o,s),Wr(s)}}function Wr(s){var o=s.flags;if(o&2){try{e:{for(var c=s.return;c!==null;){if(Vh(c)){var h=c;break e}c=c.return}throw Error(n(160))}switch(h.tag){case 5:var b=h.stateNode;h.flags&32&&(Le(b,""),h.flags&=-33);var C=Wh(s);Pm(s,C,b);break;case 3:case 4:var L=h.stateNode.containerInfo,se=Wh(s);Om(s,se,L);break;default:throw Error(n(161))}}catch(fe){Vt(s,s.return,fe)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function Kr(s,o,c){at=s,en(s)}function en(s,o,c){for(var h=(s.mode&1)!==0;at!==null;){var b=at,C=b.child;if(b.tag===22&&h){var L=b.memoizedState!==null||ju;if(!L){var se=b.alternate,fe=se!==null&&se.memoizedState!==null||ds;se=ju;var je=ds;if(ju=L,(ds=fe)&&!je)for(at=b;at!==null;)L=at,fe=L.child,L.tag===22&&L.memoizedState!==null?$m(b):fe!==null?(fe.return=L,at=fe):$m(b);for(;C!==null;)at=C,en(C),C=C.sibling;at=b,ju=se,ds=je}Gh(s)}else b.subtreeFlags&8772&&C!==null?(C.return=b,at=C):Gh(s)}}function Gh(s){for(;at!==null;){var o=at;if(o.flags&8772){var c=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:ds||Nu(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!ds)if(c===null)h.componentDidMount();else{var b=o.elementType===o.type?c.memoizedProps:jr(o.type,c.memoizedProps);h.componentDidUpdate(b,c.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var C=o.updateQueue;C!==null&&am(o,C,h);break;case 3:var L=o.updateQueue;if(L!==null){if(c=null,o.child!==null)switch(o.child.tag){case 5:c=o.child.stateNode;break;case 1:c=o.child.stateNode}am(o,L,c)}break;case 5:var se=o.stateNode;if(c===null&&o.flags&4){c=se;var fe=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":fe.autoFocus&&c.focus();break;case"img":fe.src&&(c.src=fe.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var je=o.alternate;if(je!==null){var De=je.memoizedState;if(De!==null){var Fe=De.dehydrated;Fe!==null&&Gs(Fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ds||o.flags&512&&or(o)}catch($e){Vt(o,o.return,$e)}}if(o===s){at=null;break}if(c=o.sibling,c!==null){c.return=o.return,at=c;break}at=o.return}}function Tm(s){for(;at!==null;){var o=at;if(o===s){at=null;break}var c=o.sibling;if(c!==null){c.return=o.return,at=c;break}at=o.return}}function $m(s){for(;at!==null;){var o=at;try{switch(o.tag){case 0:case 11:case 15:var c=o.return;try{Nu(4,o)}catch(fe){Vt(o,c,fe)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var b=o.return;try{h.componentDidMount()}catch(fe){Vt(o,b,fe)}}var C=o.return;try{or(o)}catch(fe){Vt(o,C,fe)}break;case 5:var L=o.return;try{or(o)}catch(fe){Vt(o,L,fe)}}}catch(fe){Vt(o,o.return,fe)}if(o===s){at=null;break}var se=o.sibling;if(se!==null){se.return=o.return,at=se;break}at=o.return}}var Xh=Math.ceil,Ii=w.ReactCurrentDispatcher,Su=w.ReactCurrentOwner,Fs=w.ReactCurrentBatchConfig,Ht=0,Un=null,Pn=null,Jn=0,Cs=0,$o=pa(0),In=0,kl=null,Ga=0,Bi=0,Cu=0,Ml=null,js=null,Eu=0,Do=1/0,Yr=null,Ui=!1,ku=null,wa=null,qi=!1,ja=null,Hi=0,Al=0,Mu=null,Vi=-1,Wi=0;function ms(){return Ht&6?Ge():Vi!==-1?Vi:Vi=Ge()}function Na(s){return s.mode&1?Ht&2&&Jn!==0?Jn&-Jn:h_.transition!==null?(Wi===0&&(Wi=ia()),Wi):(s=Xt,s!==0||(s=window.event,s=s===void 0?16:sl(s.type)),s):1}function lr(s,o,c,h){if(50<Al)throw Al=0,Mu=null,Error(n(185));fo(s,c,h),(!(Ht&2)||s!==Un)&&(s===Un&&(!(Ht&2)&&(Bi|=c),In===4&&oe(s,Jn)),g(s,h),c===1&&Ht===0&&!(o.mode&1)&&(Do=Ge()+500,Wc&&qa()))}function g(s,o){var c=s.callbackNode;oa(s,o);var h=zr(s,s===Un?Jn:0);if(h===0)c!==null&&ra(c),s.callbackNode=null,s.callbackPriority=0;else if(o=h&-h,s.callbackPriority!==o){if(c!=null&&ra(c),o===1)s.tag===0?f_(de.bind(null,s)):gh(de.bind(null,s)),Ai(function(){!(Ht&6)&&qa()}),c=null;else{switch(Ec(h)){case 1:c=Mt;break;case 4:c=os;break;case 16:c=nn;break;case 536870912:c=dn;break;default:c=nn}c=Pu(c,N.bind(null,s))}s.callbackPriority=o,s.callbackNode=c}}function N(s,o){if(Vi=-1,Wi=0,Ht&6)throw Error(n(327));var c=s.callbackNode;if(Sn()&&s.callbackNode!==c)return null;var h=zr(s,s===Un?Jn:0);if(h===0)return null;if(h&30||h&s.expiredLanes||o)o=cn(s,h);else{o=h;var b=Ht;Ht|=2;var C=St();(Un!==s||Jn!==o)&&(Yr=null,Do=Ge()+500,Ie(s,o));do try{At();break}catch(se){wt(s,se)}while(!0);yl(),Ii.current=C,Ht=b,Pn!==null?o=0:(Un=null,Jn=0,o=In)}if(o!==0){if(o===2&&(b=la(s),b!==0&&(h=b,o=O(s,b))),o===1)throw c=kl,Ie(s,0),oe(s,h),g(s,Ge()),c;if(o===6)oe(s,h);else{if(b=s.current.alternate,!(h&30)&&!q(b)&&(o=cn(s,h),o===2&&(C=la(s),C!==0&&(h=C,o=O(s,C))),o===1))throw c=kl,Ie(s,0),oe(s,h),g(s,Ge()),c;switch(s.finishedWork=b,s.finishedLanes=h,o){case 0:case 1:throw Error(n(345));case 2:Is(s,js,Yr);break;case 3:if(oe(s,h),(h&130023424)===h&&(o=Eu+500-Ge(),10<o)){if(zr(s,0)!==0)break;if(b=s.suspendedLanes,(b&h)!==h){ms(),s.pingedLanes|=s.suspendedLanes&b;break}s.timeoutHandle=qd(Is.bind(null,s,js,Yr),o);break}Is(s,js,Yr);break;case 4:if(oe(s,h),(h&4194240)===h)break;for(o=s.eventTimes,b=-1;0<h;){var L=31-kn(h);C=1<<L,L=o[L],L>b&&(b=L),h&=~C}if(h=b,h=Ge()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*Xh(h/1960))-h,10<h){s.timeoutHandle=qd(Is.bind(null,s,js,Yr),h);break}Is(s,js,Yr);break;case 5:Is(s,js,Yr);break;default:throw Error(n(329))}}}return g(s,Ge()),s.callbackNode===c?N.bind(null,s):null}function O(s,o){var c=Ml;return s.current.memoizedState.isDehydrated&&(Ie(s,o).flags|=256),s=cn(s,o),s!==2&&(o=js,js=c,o!==null&&I(o)),s}function I(s){js===null?js=s:js.push.apply(js,s)}function q(s){for(var o=s;;){if(o.flags&16384){var c=o.updateQueue;if(c!==null&&(c=c.stores,c!==null))for(var h=0;h<c.length;h++){var b=c[h],C=b.getSnapshot;b=b.value;try{if(!Xs(C(),b))return!1}catch{return!1}}}if(c=o.child,o.subtreeFlags&16384&&c!==null)c.return=o,o=c;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function oe(s,o){for(o&=~Cu,o&=~Bi,s.suspendedLanes|=o,s.pingedLanes&=~o,s=s.expirationTimes;0<o;){var c=31-kn(o),h=1<<c;s[c]=-1,o&=~h}}function de(s){if(Ht&6)throw Error(n(327));Sn();var o=zr(s,0);if(!(o&1))return g(s,Ge()),null;var c=cn(s,o);if(s.tag!==0&&c===2){var h=la(s);h!==0&&(o=h,c=O(s,h))}if(c===1)throw c=kl,Ie(s,0),oe(s,o),g(s,Ge()),c;if(c===6)throw Error(n(345));return s.finishedWork=s.current.alternate,s.finishedLanes=o,Is(s,js,Yr),g(s,Ge()),null}function me(s,o){var c=Ht;Ht|=1;try{return s(o)}finally{Ht=c,Ht===0&&(Do=Ge()+500,Wc&&qa())}}function ce(s){ja!==null&&ja.tag===0&&!(Ht&6)&&Sn();var o=Ht;Ht|=1;var c=Fs.transition,h=Xt;try{if(Fs.transition=null,Xt=1,s)return s()}finally{Xt=h,Fs.transition=c,Ht=o,!(Ht&6)&&qa()}}function Ce(){Cs=$o.current,fn($o)}function Ie(s,o){s.finishedWork=null,s.finishedLanes=0;var c=s.timeoutHandle;if(c!==-1&&(s.timeoutHandle=-1,d_(c)),Pn!==null)for(c=Pn.return;c!==null;){var h=c;switch(Qd(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Hc();break;case 3:xl(),fn(ls),fn(ts),im();break;case 5:wl(h);break;case 4:xl();break;case 13:fn(wn);break;case 19:fn(wn);break;case 10:Ha(h.type._context);break;case 22:case 23:Ce()}c=c.return}if(Un=s,Pn=s=Pl(s.current,null),Jn=Cs=o,In=0,kl=null,Cu=Bi=Ga=0,js=Ml=null,To!==null){for(o=0;o<To.length;o++)if(c=To[o],h=c.interleaved,h!==null){c.interleaved=null;var b=h.next,C=c.pending;if(C!==null){var L=C.next;C.next=b,h.next=L}c.pending=h}To=null}return s}function wt(s,o){do{var c=Pn;try{if(yl(),su.current=iu,ru){for(var h=yn.memoizedState;h!==null;){var b=h.queue;b!==null&&(b.pending=null),h=h.next}ru=!1}if(sr=0,Xn=Bn=yn=null,$i=!1,Di=0,Su.current=null,c===null||c.return===null){In=1,kl=o,Pn=null;break}e:{var C=s,L=c.return,se=c,fe=o;if(o=Jn,se.flags|=32768,fe!==null&&typeof fe=="object"&&typeof fe.then=="function"){var je=fe,De=se,Fe=De.tag;if(!(De.mode&1)&&(Fe===0||Fe===11||Fe===15)){var $e=De.alternate;$e?(De.updateQueue=$e.updateQueue,De.memoizedState=$e.memoizedState,De.lanes=$e.lanes):(De.updateQueue=null,De.memoizedState=null)}var nt=wm(L);if(nt!==null){nt.flags&=-257,mu(nt,L,se,C,o),nt.mode&1&&Rh(C,je,o),o=nt,fe=je;var lt=o.updateQueue;if(lt===null){var it=new Set;it.add(fe),o.updateQueue=it}else lt.add(fe);break e}else{if(!(o&1)){Rh(C,je,o),Rt();break e}fe=Error(n(426))}}else if(vn&&se.mode&1){var Hn=wm(L);if(Hn!==null){!(Hn.flags&65536)&&(Hn.flags|=256),mu(Hn,L,se,C,o),Jd(Cl(fe,se));break e}}C=fe=Cl(fe,se),In!==4&&(In=2),Ml===null?Ml=[C]:Ml.push(C),C=L;do{switch(C.tag){case 3:C.flags|=65536,o&=-o,C.lanes|=o;var _e=du(C,fe,o);rm(C,_e);break e;case 1:se=fe;var he=C.type,ye=C.stateNode;if(!(C.flags&128)&&(typeof he.getDerivedStateFromError=="function"||ye!==null&&typeof ye.componentDidCatch=="function"&&(wa===null||!wa.has(ye)))){C.flags|=65536,o&=-o,C.lanes|=o;var qe=zh(C,se,o);rm(C,qe);break e}}C=C.return}while(C!==null)}Es(c)}catch(dt){o=dt,Pn===c&&c!==null&&(Pn=c=c.return);continue}break}while(!0)}function St(){var s=Ii.current;return Ii.current=iu,s===null?iu:s}function Rt(){(In===0||In===3||In===2)&&(In=4),Un===null||!(Ga&268435455)&&!(Bi&268435455)||oe(Un,Jn)}function cn(s,o){var c=Ht;Ht|=2;var h=St();(Un!==s||Jn!==o)&&(Yr=null,Ie(s,o));do try{qn();break}catch(b){wt(s,b)}while(!0);if(yl(),Ht=c,Ii.current=h,Pn!==null)throw Error(n(261));return Un=null,Jn=0,In}function qn(){for(;Pn!==null;)ss(Pn)}function At(){for(;Pn!==null&&!Ee();)ss(Pn)}function ss(s){var o=Ou(s.alternate,s,Cs);s.memoizedProps=s.pendingProps,o===null?Es(s):Pn=o,Su.current=null}function Es(s){var o=s;do{var c=o.alternate;if(s=o.return,o.flags&32768){if(c=N_(c,o),c!==null){c.flags&=32767,Pn=c;return}if(s!==null)s.flags|=32768,s.subtreeFlags=0,s.deletions=null;else{In=6,Pn=null;return}}else if(c=j_(c,o,Cs),c!==null){Pn=c;return}if(o=o.sibling,o!==null){Pn=o;return}Pn=o=s}while(o!==null);In===0&&(In=5)}function Is(s,o,c){var h=Xt,b=Fs.transition;try{Fs.transition=null,Xt=1,Xa(s,o,c,h)}finally{Fs.transition=b,Xt=h}return null}function Xa(s,o,c,h){do Sn();while(ja!==null);if(Ht&6)throw Error(n(327));c=s.finishedWork;var b=s.finishedLanes;if(c===null)return null;if(s.finishedWork=null,s.finishedLanes=0,c===s.current)throw Error(n(177));s.callbackNode=null,s.callbackPriority=0;var C=c.lanes|c.childLanes;if(Cc(s,C),s===Un&&(Pn=Un=null,Jn=0),!(c.subtreeFlags&2064)&&!(c.flags&2064)||qi||(qi=!0,Pu(nn,function(){return Sn(),null})),C=(c.flags&15990)!==0,c.subtreeFlags&15990||C){C=Fs.transition,Fs.transition=null;var L=Xt;Xt=1;var se=Ht;Ht|=4,Su.current=null,C_(s,c),Qh(c,s),nh(Uc),vs=!!Et,Uc=Et=null,s.current=c,Kr(c),Ye(),Ht=se,Xt=L,Fs.transition=C}else s.current=c;if(qi&&(qi=!1,ja=s,Hi=b),C=s.pendingLanes,C===0&&(wa=null),on(c.stateNode),g(s,Ge()),o!==null)for(h=s.onRecoverableError,c=0;c<o.length;c++)b=o[c],h(b.value,{componentStack:b.stack,digest:b.digest});if(Ui)throw Ui=!1,s=ku,ku=null,s;return Hi&1&&s.tag!==0&&Sn(),C=s.pendingLanes,C&1?s===Mu?Al++:(Al=0,Mu=s):Al=0,qa(),null}function Sn(){if(ja!==null){var s=Ec(Hi),o=Fs.transition,c=Xt;try{if(Fs.transition=null,Xt=16>s?16:s,ja===null)var h=!1;else{if(s=ja,ja=null,Hi=0,Ht&6)throw Error(n(331));var b=Ht;for(Ht|=4,at=s.current;at!==null;){var C=at,L=C.child;if(at.flags&16){var se=C.deletions;if(se!==null){for(var fe=0;fe<se.length;fe++){var je=se[fe];for(at=je;at!==null;){var De=at;switch(De.tag){case 0:case 11:case 15:Fi(8,De,C)}var Fe=De.child;if(Fe!==null)Fe.return=De,at=Fe;else for(;at!==null;){De=at;var $e=De.sibling,nt=De.return;if(Hh(De),De===je){at=null;break}if($e!==null){$e.return=nt,at=$e;break}at=nt}}}var lt=C.alternate;if(lt!==null){var it=lt.child;if(it!==null){lt.child=null;do{var Hn=it.sibling;it.sibling=null,it=Hn}while(it!==null)}}at=C}}if(C.subtreeFlags&2064&&L!==null)L.return=C,at=L;else e:for(;at!==null;){if(C=at,C.flags&2048)switch(C.tag){case 0:case 11:case 15:Fi(9,C,C.return)}var _e=C.sibling;if(_e!==null){_e.return=C.return,at=_e;break e}at=C.return}}var he=s.current;for(at=he;at!==null;){L=at;var ye=L.child;if(L.subtreeFlags&2064&&ye!==null)ye.return=L,at=ye;else e:for(L=he;at!==null;){if(se=at,se.flags&2048)try{switch(se.tag){case 0:case 11:case 15:Nu(9,se)}}catch(dt){Vt(se,se.return,dt)}if(se===L){at=null;break e}var qe=se.sibling;if(qe!==null){qe.return=se.return,at=qe;break e}at=se.return}}if(Ht=b,qa(),_n&&typeof _n.onPostCommitFiberRoot=="function")try{_n.onPostCommitFiberRoot(gn,s)}catch{}h=!0}return h}finally{Xt=c,Fs.transition=o}}return!1}function kt(s,o,c){o=Cl(c,o),o=du(s,o,1),s=Wa(s,o,1),o=ms(),s!==null&&(fo(s,1,o),g(s,o))}function Vt(s,o,c){if(s.tag===3)kt(s,s,c);else for(;o!==null;){if(o.tag===3){kt(o,s,c);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(wa===null||!wa.has(h))){s=Cl(c,s),s=zh(o,s,1),o=Wa(o,s,1),s=ms(),o!==null&&(fo(o,1,s),g(o,s));break}}o=o.return}}function Er(s,o,c){var h=s.pingCache;h!==null&&h.delete(o),o=ms(),s.pingedLanes|=s.suspendedLanes&c,Un===s&&(Jn&c)===c&&(In===4||In===3&&(Jn&130023424)===Jn&&500>Ge()-Eu?Ie(s,0):Cu|=c),g(s,o)}function Lo(s,o){o===0&&(s.mode&1?(o=_s,_s<<=1,!(_s&130023424)&&(_s=4194304)):o=1);var c=ms();s=ba(s,o),s!==null&&(fo(s,o,c),g(s,c))}function Au(s){var o=s.memoizedState,c=0;o!==null&&(c=o.retryLane),Lo(s,c)}function Ol(s,o){var c=0;switch(s.tag){case 13:var h=s.stateNode,b=s.memoizedState;b!==null&&(c=b.retryLane);break;case 19:h=s.stateNode;break;default:throw Error(n(314))}h!==null&&h.delete(o),Lo(s,c)}var Ou;Ou=function(s,o,c){if(s!==null)if(s.memoizedProps!==o.pendingProps||ls.current)ws=!0;else{if(!(s.lanes&c)&&!(o.flags&128))return ws=!1,ar(s,o,c);ws=!!(s.flags&131072)}else ws=!1,vn&&o.flags&1048576&&Yd(o,Yc,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;wu(s,o),s=o.pendingProps;var b=hl(o,ts.current);bl(o,c),b=dm(null,o,h,s,b,c);var C=mm();return o.flags|=1,typeof b=="object"&&b!==null&&typeof b.render=="function"&&b.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Ss(h)?(C=!0,Vc(o)):C=!1,o.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,sm(o),b.updater=cu,o.stateNode=b,b._reactInternals=o,ym(o,h,s,c),o=Sm(null,o,h,!0,C,c)):(o.tag=0,vn&&C&&Oi(o),cs(null,o,b,c),o=o.child),o;case 16:h=o.elementType;e:{switch(wu(s,o),s=o.pendingProps,b=h._init,h=b(h._payload),o.type=h,b=o.tag=uD(h),s=jr(h,s),b){case 0:o=pu(null,o,h,s,c);break e;case 1:o=Fh(null,o,h,s,c);break e;case 11:o=jm(null,o,h,s,c);break e;case 14:o=Nr(null,o,h,jr(h.type,s),c);break e}throw Error(n(306,h,""))}return o;case 0:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:jr(h,b),pu(s,o,h,b,c);case 1:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:jr(h,b),Fh(s,o,h,b,c);case 3:e:{if(Cm(o),s===null)throw Error(n(387));h=o.pendingProps,C=o.memoizedState,b=C.element,bh(s,o),tu(o,h,null,c);var L=o.memoizedState;if(h=L.element,C.isDehydrated)if(C={element:h,isDehydrated:!1,cache:L.cache,pendingSuspenseBoundaries:L.pendingSuspenseBoundaries,transitions:L.transitions},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){b=Cl(Error(n(423)),o),o=Ih(s,o,h,c,b);break e}else if(h!==b){b=Cl(Error(n(424)),o),o=Ih(s,o,h,c,b);break e}else for($s=ha(o.stateNode.containerInfo.firstChild),xs=o,vn=!0,Ds=null,c=Xc(o,null,h,c),o.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling;else{if(vl(),h===b){o=Fn(s,o,c);break e}cs(s,o,h,c)}o=o.child}return o;case 5:return nu(o),s===null&&Xd(o),h=o.type,b=o.pendingProps,C=s!==null?s.memoizedProps:null,L=b.children,Mi(h,b)?L=null:C!==null&&Mi(h,C)&&(o.flags|=32),hu(s,o),cs(s,o,L,c),o.child;case 6:return s===null&&Xd(o),null;case 13:return _u(s,o,c);case 4:return om(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=qr(o,null,h,c):cs(s,o,h,c),o.child;case 11:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:jr(h,b),jm(s,o,h,b,c);case 7:return cs(s,o,o.pendingProps,c),o.child;case 8:return cs(s,o,o.pendingProps.children,c),o.child;case 12:return cs(s,o,o.pendingProps.children,c),o.child;case 10:e:{if(h=o.type._context,b=o.pendingProps,C=o.memoizedProps,L=b.value,Kt(Jc,h._currentValue),h._currentValue=L,C!==null)if(Xs(C.value,L)){if(C.children===b.children&&!ls.current){o=Fn(s,o,c);break e}}else for(C=o.child,C!==null&&(C.return=o);C!==null;){var se=C.dependencies;if(se!==null){L=C.child;for(var fe=se.firstContext;fe!==null;){if(fe.context===h){if(C.tag===1){fe=xr(-1,c&-c),fe.tag=2;var je=C.updateQueue;if(je!==null){je=je.shared;var De=je.pending;De===null?fe.next=fe:(fe.next=De.next,De.next=fe),je.pending=fe}}C.lanes|=c,fe=C.alternate,fe!==null&&(fe.lanes|=c),em(C.return,c,o),se.lanes|=c;break}fe=fe.next}}else if(C.tag===10)L=C.type===o.type?null:C.child;else if(C.tag===18){if(L=C.return,L===null)throw Error(n(341));L.lanes|=c,se=L.alternate,se!==null&&(se.lanes|=c),em(L,c,o),L=C.sibling}else L=C.child;if(L!==null)L.return=C;else for(L=C;L!==null;){if(L===o){L=null;break}if(C=L.sibling,C!==null){C.return=L.return,L=C;break}L=L.return}C=L}cs(s,o,b.children,c),o=o.child}return o;case 9:return b=o.type,h=o.pendingProps.children,bl(o,c),b=nr(b),h=h(b),o.flags|=1,cs(s,o,h,c),o.child;case 14:return h=o.type,b=jr(h,o.pendingProps),b=jr(h.type,b),Nr(s,o,h,b,c);case 15:return fu(s,o,o.type,o.pendingProps,c);case 17:return h=o.type,b=o.pendingProps,b=o.elementType===h?b:jr(h,b),wu(s,o),o.tag=1,Ss(h)?(s=!0,Vc(o)):s=!1,bl(o,c),vm(o,h,b),ym(o,h,b,c),Sm(null,o,h,!0,s,c);case 19:return w_(s,o,c);case 22:return Nm(s,o,c)}throw Error(n(156,o.tag))};function Pu(s,o){return sa(s,o)}function cD(s,o,c,h){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qr(s,o,c,h){return new cD(s,o,c,h)}function E_(s){return s=s.prototype,!(!s||!s.isReactComponent)}function uD(s){if(typeof s=="function")return E_(s)?1:0;if(s!=null){if(s=s.$$typeof,s===ee)return 11;if(s===G)return 14}return 2}function Pl(s,o){var c=s.alternate;return c===null?(c=Qr(s.tag,o,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=o,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&14680064,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,o=s.dependencies,c.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c}function Jh(s,o,c,h,b,C){var L=2;if(h=s,typeof s=="function")E_(s)&&(L=1);else if(typeof s=="string")L=5;else e:switch(s){case D:return Ki(c.children,b,C,o);case $:L=8,b|=8;break;case F:return s=Qr(12,c,o,b|2),s.elementType=F,s.lanes=C,s;case le:return s=Qr(13,c,o,b),s.elementType=le,s.lanes=C,s;case z:return s=Qr(19,c,o,b),s.elementType=z,s.lanes=C,s;case H:return Zh(c,b,C,o);default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case R:L=10;break e;case B:L=9;break e;case ee:L=11;break e;case G:L=14;break e;case W:L=16,h=null;break e}throw Error(n(130,s==null?s:typeof s,""))}return o=Qr(L,c,o,b),o.elementType=s,o.type=h,o.lanes=C,o}function Ki(s,o,c,h){return s=Qr(7,s,h,o),s.lanes=c,s}function Zh(s,o,c,h){return s=Qr(22,s,h,o),s.elementType=H,s.lanes=c,s.stateNode={isHidden:!1},s}function k_(s,o,c){return s=Qr(6,s,null,o),s.lanes=c,s}function M_(s,o,c){return o=Qr(4,s.children!==null?s.children:[],s.key,o),o.lanes=c,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}function dD(s,o,c,h,b){this.tag=o,this.containerInfo=s,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=el(0),this.expirationTimes=el(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=el(0),this.identifierPrefix=h,this.onRecoverableError=b,this.mutableSourceEagerHydrationData=null}function A_(s,o,c,h,b,C,L,se,fe){return s=new dD(s,o,c,se,fe),o===1?(o=1,C===!0&&(o|=8)):o=0,C=Qr(3,null,null,o),s.current=C,C.stateNode=s,C.memoizedState={element:h,isDehydrated:c,cache:null,transitions:null,pendingSuspenseBoundaries:null},sm(C),s}function mD(s,o,c){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:E,key:h==null?null:""+h,children:s,containerInfo:o,implementation:c}}function Hw(s){if(!s)return Ua;s=s._reactInternals;e:{if(Os(s)!==s||s.tag!==1)throw Error(n(170));var o=s;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Ss(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(s.tag===1){var c=s.type;if(Ss(c))return hh(s,c,o)}return o}function Vw(s,o,c,h,b,C,L,se,fe){return s=A_(c,h,!0,s,b,C,L,se,fe),s.context=Hw(null),c=s.current,h=ms(),b=Na(c),C=xr(h,b),C.callback=o??null,Wa(c,C,b),s.current.lanes=b,fo(s,b,h),g(s,h),s}function ep(s,o,c,h){var b=o.current,C=ms(),L=Na(b);return c=Hw(c),o.context===null?o.context=c:o.pendingContext=c,o=xr(C,L),o.payload={element:s},h=h===void 0?null:h,h!==null&&(o.callback=h),s=Wa(b,o,L),s!==null&&(lr(s,b,L,C),eu(s,b,L)),L}function tp(s){if(s=s.current,!s.child)return null;switch(s.child.tag){case 5:return s.child.stateNode;default:return s.child.stateNode}}function Ww(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<o?c:o}}function O_(s,o){Ww(s,o),(s=s.alternate)&&Ww(s,o)}function fD(){return null}var Kw=typeof reportError=="function"?reportError:function(s){console.error(s)};function P_(s){this._internalRoot=s}np.prototype.render=P_.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));ep(s,o,null,null)},np.prototype.unmount=P_.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;ce(function(){ep(null,s,null,null)}),o[An]=null}};function np(s){this._internalRoot=s}np.prototype.unstable_scheduleHydration=function(s){if(s){var o=hi();s={blockedOn:null,target:s,priority:o};for(var c=0;c<mt.length&&o!==0&&o<mt[c].priority;c++);mt.splice(c,0,s),c===0&&Yt(s)}};function T_(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function sp(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11&&(s.nodeType!==8||s.nodeValue!==" react-mount-point-unstable "))}function Yw(){}function hD(s,o,c,h,b){if(b){if(typeof h=="function"){var C=h;h=function(){var je=tp(L);C.call(je)}}var L=Vw(o,h,s,0,null,!1,!1,"",Yw);return s._reactRootContainer=L,s[An]=L.current,No(s.nodeType===8?s.parentNode:s),ce(),L}for(;b=s.lastChild;)s.removeChild(b);if(typeof h=="function"){var se=h;h=function(){var je=tp(fe);se.call(je)}}var fe=A_(s,0,!1,null,null,!1,!1,"",Yw);return s._reactRootContainer=fe,s[An]=fe.current,No(s.nodeType===8?s.parentNode:s),ce(function(){ep(o,fe,c,h)}),fe}function rp(s,o,c,h,b){var C=c._reactRootContainer;if(C){var L=C;if(typeof b=="function"){var se=b;b=function(){var fe=tp(L);se.call(fe)}}ep(o,L,s,b)}else L=hD(c,o,s,b,h);return tp(L)}mi=function(s){switch(s.tag){case 3:var o=s.stateNode;if(o.current.memoizedState.isDehydrated){var c=Lr(o.pendingLanes);c!==0&&(di(o,c|1),g(o,Ge()),!(Ht&6)&&(Do=Ge()+500,qa()))}break;case 13:ce(function(){var h=ba(s,1);if(h!==null){var b=ms();lr(h,s,1,b)}}),O_(s,1)}},tl=function(s){if(s.tag===13){var o=ba(s,134217728);if(o!==null){var c=ms();lr(o,s,134217728,c)}O_(s,134217728)}},fi=function(s){if(s.tag===13){var o=Na(s),c=ba(s,o);if(c!==null){var h=ms();lr(c,s,o,h)}O_(s,o)}},hi=function(){return Xt},ae=function(s,o){var c=Xt;try{return Xt=s,o()}finally{Xt=c}},Ct=function(s,o,c){switch(o){case"input":if(Be(s,c),o=c.name,c.type==="radio"&&o!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<c.length;o++){var h=c[o];if(h!==s&&h.form===s.form){var b=fl(h);if(!b)throw Error(n(90));ht(h),Be(h,b)}}}break;case"textarea":ot(s,c);break;case"select":o=c.value,o!=null&&X(s,!!c.multiple,o,!1)}},Ot=me,Ut=ce;var pD={usingClientEntryPoint:!1,Events:[Ba,Zs,fl,Yn,pn,me]},Dm={findFiberByHostInstance:Eo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},gD={bundleType:Dm.bundleType,version:Dm.version,rendererPackageName:Dm.rendererPackageName,rendererConfig:Dm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(s){return s=$r(s),s===null?null:s.stateNode},findFiberByHostInstance:Dm.findFiberByHostInstance||fD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ap=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ap.isDisabled&&ap.supportsFiber)try{gn=ap.inject(gD),_n=ap}catch{}}return Bs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=pD,Bs.createPortal=function(s,o){var c=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!T_(o))throw Error(n(200));return mD(s,o,null,c)},Bs.createRoot=function(s,o){if(!T_(s))throw Error(n(299));var c=!1,h="",b=Kw;return o!=null&&(o.unstable_strictMode===!0&&(c=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(b=o.onRecoverableError)),o=A_(s,1,!1,null,null,c,!1,h,b),s[An]=o.current,No(s.nodeType===8?s.parentNode:s),new P_(o)},Bs.findDOMNode=function(s){if(s==null)return null;if(s.nodeType===1)return s;var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=$r(o),s=s===null?null:s.stateNode,s},Bs.flushSync=function(s){return ce(s)},Bs.hydrate=function(s,o,c){if(!sp(o))throw Error(n(200));return rp(null,s,o,!0,c)},Bs.hydrateRoot=function(s,o,c){if(!T_(s))throw Error(n(405));var h=c!=null&&c.hydratedSources||null,b=!1,C="",L=Kw;if(c!=null&&(c.unstable_strictMode===!0&&(b=!0),c.identifierPrefix!==void 0&&(C=c.identifierPrefix),c.onRecoverableError!==void 0&&(L=c.onRecoverableError)),o=Vw(o,null,s,1,c??null,b,!1,C,L),s[An]=o.current,No(s),h)for(s=0;s<h.length;s++)c=h[s],b=c._getVersion,b=b(c._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[c,b]:o.mutableSourceEagerHydrationData.push(c,b);return new np(o)},Bs.render=function(s,o,c){if(!sp(o))throw Error(n(200));return rp(null,s,o,!1,c)},Bs.unmountComponentAtNode=function(s){if(!sp(s))throw Error(n(40));return s._reactRootContainer?(ce(function(){rp(null,null,s,!1,function(){s._reactRootContainer=null,s[An]=null})}),!0):!1},Bs.unstable_batchedUpdates=me,Bs.unstable_renderSubtreeIntoContainer=function(s,o,c,h){if(!sp(c))throw Error(n(200));if(s==null||s._reactInternals===void 0)throw Error(n(38));return rp(s,o,c,!1,h)},Bs.version="18.3.1-next-f1338f8080-20240426",Bs}function Q_(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Q_)}catch(e){console.error(e)}}Q_(),V_.exports=tj();var nj=V_.exports,G_=nj;ip.createRoot=G_.createRoot,ip.hydrateRoot=G_.hydrateRoot;var Yi=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},sj={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},rj=(Tw=class{constructor(){ft(this,Vo,sj);ft(this,e_,!1)}setTimeoutProvider(e){Ze(this,Vo,e)}setTimeout(e,t){return ue(this,Vo).setTimeout(e,t)}clearTimeout(e){ue(this,Vo).clearTimeout(e)}setInterval(e,t){return ue(this,Vo).setInterval(e,t)}clearInterval(e){ue(this,Vo).clearInterval(e)}},Vo=new WeakMap,e_=new WeakMap,Tw),Ll=new rj;function aj(e){setTimeout(e,0)}var zl=typeof window>"u"||"Deno"in globalThis;function ks(){}function oj(e,t){return typeof e=="function"?e(t):e}function dp(e){return typeof e=="number"&&e>=0&&e!==1/0}function X_(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ro(e,t){return typeof e=="function"?e(t):e}function kr(e,t){return typeof e=="function"?e(t):e}function J_(e,t){const{type:n="all",exact:r,fetchStatus:l,predicate:i,queryKey:u,stale:d}=e;if(u){if(r){if(t.queryHash!==mp(u,t.options))return!1}else if(!Tu(t.queryKey,u))return!1}if(n!=="all"){const m=t.isActive();if(n==="active"&&!m||n==="inactive"&&m)return!1}return!(typeof d=="boolean"&&t.isStale()!==d||l&&l!==t.state.fetchStatus||i&&!i(t))}function Z_(e,t){const{exact:n,status:r,predicate:l,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(Rl(t.options.mutationKey)!==Rl(i))return!1}else if(!Tu(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||l&&!l(t))}function mp(e,t){return((t==null?void 0:t.queryKeyHashFn)||Rl)(e)}function Rl(e){return JSON.stringify(e,(t,n)=>fp(n)?Object.keys(n).sort().reduce((r,l)=>(r[l]=n[l],r),{}):n)}function Tu(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Tu(e[n],t[n])):!1}var lj=Object.prototype.hasOwnProperty;function ev(e,t){if(e===t)return e;const n=tv(e)&&tv(t);if(!n&&!(fp(e)&&fp(t)))return t;const l=(n?e:Object.keys(e)).length,i=n?t:Object.keys(t),u=i.length,d=n?new Array(u):{};let m=0;for(let y=0;y<u;y++){const p=n?y:i[y],v=e[p],_=t[p];if(v===_){d[p]=v,(n?y<l:lj.call(e,p))&&m++;continue}if(v===null||_===null||typeof v!="object"||typeof _!="object"){d[p]=_;continue}const x=ev(v,_);d[p]=x,x===v&&m++}return l===u&&m===l?e:d}function zm(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function tv(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function fp(e){if(!nv(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!nv(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function nv(e){return Object.prototype.toString.call(e)==="[object Object]"}function ij(e){return new Promise(t=>{Ll.setTimeout(t,e)})}function hp(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?ev(e,t):t}function cj(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function uj(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var pp=Symbol();function sv(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===pp?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function rv(e,t){return typeof e=="function"?e(...t):!!e}var dj=($w=class extends Yi{constructor(){super();ft(this,ni);ft(this,Wo);ft(this,hc);Ze(this,hc,t=>{if(!zl&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){ue(this,Wo)||this.setEventListener(ue(this,hc))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,Wo))==null||t.call(this),Ze(this,Wo,void 0))}setEventListener(t){var n;Ze(this,hc,t),(n=ue(this,Wo))==null||n.call(this),Ze(this,Wo,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){ue(this,ni)!==t&&(Ze(this,ni,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof ue(this,ni)=="boolean"?ue(this,ni):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},ni=new WeakMap,Wo=new WeakMap,hc=new WeakMap,$w),gp=new dj;function _p(){let e,t;const n=new Promise((l,i)=>{e=l,t=i});n.status="pending",n.catch(()=>{});function r(l){Object.assign(n,l),delete n.resolve,delete n.reject}return n.resolve=l=>{r({status:"fulfilled",value:l}),e(l)},n.reject=l=>{r({status:"rejected",reason:l}),t(l)},n}var mj=aj;function fj(){let e=[],t=0,n=d=>{d()},r=d=>{d()},l=mj;const i=d=>{t?e.push(d):l(()=>{n(d)})},u=()=>{const d=e;e=[],d.length&&l(()=>{r(()=>{d.forEach(m=>{n(m)})})})};return{batch:d=>{let m;t++;try{m=d()}finally{t--,t||u()}return m},batchCalls:d=>(...m)=>{i(()=>{d(...m)})},schedule:i,setNotifyFunction:d=>{n=d},setBatchNotifyFunction:d=>{r=d},setScheduler:d=>{l=d}}}var Zn=fj(),hj=(Dw=class extends Yi{constructor(){super();ft(this,pc,!0);ft(this,Ko);ft(this,gc);Ze(this,gc,t=>{if(!zl&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){ue(this,Ko)||this.setEventListener(ue(this,gc))}onUnsubscribe(){var t;this.hasListeners()||((t=ue(this,Ko))==null||t.call(this),Ze(this,Ko,void 0))}setEventListener(t){var n;Ze(this,gc,t),(n=ue(this,Ko))==null||n.call(this),Ze(this,Ko,t(this.setOnline.bind(this)))}setOnline(t){ue(this,pc)!==t&&(Ze(this,pc,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return ue(this,pc)}},pc=new WeakMap,Ko=new WeakMap,gc=new WeakMap,Dw),Rm=new hj;function pj(e){return Math.min(1e3*2**e,3e4)}function av(e){return(e??"online")==="online"?Rm.isOnline():!0}var vp=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function ov(e){let t=!1,n=0,r;const l=_p(),i=()=>l.status!=="pending",u=S=>{var k;if(!i()){const M=new vp(S);_(M),(k=e.onCancel)==null||k.call(e,M)}},d=()=>{t=!0},m=()=>{t=!1},y=()=>gp.isFocused()&&(e.networkMode==="always"||Rm.isOnline())&&e.canRun(),p=()=>av(e.networkMode)&&e.canRun(),v=S=>{i()||(r==null||r(),l.resolve(S))},_=S=>{i()||(r==null||r(),l.reject(S))},x=()=>new Promise(S=>{var k;r=M=>{(i()||y())&&S(M)},(k=e.onPause)==null||k.call(e)}).then(()=>{var S;r=void 0,i()||(S=e.onContinue)==null||S.call(e)}),j=()=>{if(i())return;let S;const k=n===0?e.initialPromise:void 0;try{S=k??e.fn()}catch(M){S=Promise.reject(M)}Promise.resolve(S).then(v).catch(M=>{var E;if(i())return;const P=e.retry??(zl?0:3),T=e.retryDelay??pj,w=typeof T=="function"?T(n,M):T,A=P===!0||typeof P=="number"&&n<P||typeof P=="function"&&P(n,M);if(t||!A){_(M);return}n++,(E=e.onFail)==null||E.call(e,n,M),ij(w).then(()=>y()?void 0:x()).then(()=>{t?_(M):j()})})};return{promise:l,status:()=>l.status,cancel:u,continue:()=>(r==null||r(),l),cancelRetry:d,continueRetry:m,canStart:p,start:()=>(p()?j():x().then(j),l)}}var lv=(Lw=class{constructor(){ft(this,si)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),dp(this.gcTime)&&Ze(this,si,Ll.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(zl?1/0:5*60*1e3))}clearGcTimeout(){ue(this,si)&&(Ll.clearTimeout(ue(this,si)),Ze(this,si,void 0))}},si=new WeakMap,Lw),gj={NODE_ENV:"production"},_j=(zw=class extends lv{constructor(t){super();ft(this,Zr);ft(this,ri);ft(this,_c);ft(this,Pr);ft(this,ai);ft(this,rs);ft(this,bd);ft(this,oi);Ze(this,oi,!1),Ze(this,bd,t.defaultOptions),this.setOptions(t.options),this.observers=[],Ze(this,ai,t.client),Ze(this,Pr,ue(this,ai).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Ze(this,ri,cv(this.options)),this.state=t.state??ue(this,ri),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=ue(this,rs))==null?void 0:t.promise}setOptions(t){if(this.options={...ue(this,bd),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=cv(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),Ze(this,ri,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&ue(this,Pr).remove(this)}setData(t,n){const r=hp(this.state.data,t,this.options);return zt(this,Zr,zo).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){zt(this,Zr,zo).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,l;const n=(r=ue(this,rs))==null?void 0:r.promise;return(l=ue(this,rs))==null||l.cancel(t),n?n.then(ks).catch(ks):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(ue(this,ri))}isActive(){return this.observers.some(t=>kr(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===pp||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Ro(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!X_(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=ue(this,rs))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=ue(this,rs))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),ue(this,Pr).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(ue(this,rs)&&(ue(this,oi)?ue(this,rs).cancel({revert:!0}):ue(this,rs).cancelRetry()),this.scheduleGc()),ue(this,Pr).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||zt(this,Zr,zo).call(this,{type:"invalidate"})}async fetch(t,n){var m,y,p,v,_,x,j,S,k,M,P,T;if(this.state.fetchStatus!=="idle"&&((m=ue(this,rs))==null?void 0:m.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(ue(this,rs))return ue(this,rs).continueRetry(),ue(this,rs).promise}if(t&&this.setOptions(t),!this.options.queryFn){const w=this.observers.find(A=>A.options.queryFn);w&&this.setOptions(w.options)}const r=new AbortController,l=w=>{Object.defineProperty(w,"signal",{enumerable:!0,get:()=>(Ze(this,oi,!0),r.signal)})},i=()=>{const w=sv(this.options,n),E=(()=>{const D={client:ue(this,ai),queryKey:this.queryKey,meta:this.meta};return l(D),D})();return Ze(this,oi,!1),this.options.persister?this.options.persister(w,E,this):w(E)},d=(()=>{const w={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:ue(this,ai),state:this.state,fetchFn:i};return l(w),w})();(y=this.options.behavior)==null||y.onFetch(d,this),Ze(this,_c,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((p=d.fetchOptions)==null?void 0:p.meta))&&zt(this,Zr,zo).call(this,{type:"fetch",meta:(v=d.fetchOptions)==null?void 0:v.meta}),Ze(this,rs,ov({initialPromise:n==null?void 0:n.initialPromise,fn:d.fetchFn,onCancel:w=>{w instanceof vp&&w.revert&&this.setState({...ue(this,_c),fetchStatus:"idle"}),r.abort()},onFail:(w,A)=>{zt(this,Zr,zo).call(this,{type:"failed",failureCount:w,error:A})},onPause:()=>{zt(this,Zr,zo).call(this,{type:"pause"})},onContinue:()=>{zt(this,Zr,zo).call(this,{type:"continue"})},retry:d.options.retry,retryDelay:d.options.retryDelay,networkMode:d.options.networkMode,canRun:()=>!0}));try{const w=await ue(this,rs).start();if(w===void 0)throw gj.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(w),(x=(_=ue(this,Pr).config).onSuccess)==null||x.call(_,w,this),(S=(j=ue(this,Pr).config).onSettled)==null||S.call(j,w,this.state.error,this),w}catch(w){if(w instanceof vp){if(w.silent)return ue(this,rs).promise;if(w.revert){if(this.state.data===void 0)throw w;return this.state.data}}throw zt(this,Zr,zo).call(this,{type:"error",error:w}),(M=(k=ue(this,Pr).config).onError)==null||M.call(k,w,this),(T=(P=ue(this,Pr).config).onSettled)==null||T.call(P,this.state.data,w,this),w}finally{this.scheduleGc()}}},ri=new WeakMap,_c=new WeakMap,Pr=new WeakMap,ai=new WeakMap,rs=new WeakMap,bd=new WeakMap,oi=new WeakMap,Zr=new WeakSet,zo=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...iv(r.data,this.options),fetchMeta:t.meta??null};case"success":const l={...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Ze(this,_c,t.manual?l:void 0),l;case"error":const i=t.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Zn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),ue(this,Pr).notify({query:this,type:"updated",action:t})})},zw);function iv(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:av(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function cv(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var vj=(Rw=class extends Yi{constructor(t,n){super();ft(this,tn);ft(this,Vs);ft(this,Wt);ft(this,xd);ft(this,Ms);ft(this,li);ft(this,vc);ft(this,ao);ft(this,Yo);ft(this,wd);ft(this,yc);ft(this,bc);ft(this,ii);ft(this,ci);ft(this,Qo);ft(this,xc,new Set);this.options=n,Ze(this,Vs,t),Ze(this,Yo,null),Ze(this,ao,_p()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(ue(this,Wt).addObserver(this),uv(ue(this,Wt),this.options)?zt(this,tn,Lm).call(this):this.updateResult(),zt(this,tn,R_).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return yp(ue(this,Wt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return yp(ue(this,Wt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,zt(this,tn,F_).call(this),zt(this,tn,I_).call(this),ue(this,Wt).removeObserver(this)}setOptions(t){const n=this.options,r=ue(this,Wt);if(this.options=ue(this,Vs).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof kr(this.options.enabled,ue(this,Wt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");zt(this,tn,B_).call(this),ue(this,Wt).setOptions(this.options),n._defaulted&&!zm(this.options,n)&&ue(this,Vs).getQueryCache().notify({type:"observerOptionsUpdated",query:ue(this,Wt),observer:this});const l=this.hasListeners();l&&dv(ue(this,Wt),r,this.options,n)&&zt(this,tn,Lm).call(this),this.updateResult(),l&&(ue(this,Wt)!==r||kr(this.options.enabled,ue(this,Wt))!==kr(n.enabled,ue(this,Wt))||Ro(this.options.staleTime,ue(this,Wt))!==Ro(n.staleTime,ue(this,Wt)))&&zt(this,tn,D_).call(this);const i=zt(this,tn,L_).call(this);l&&(ue(this,Wt)!==r||kr(this.options.enabled,ue(this,Wt))!==kr(n.enabled,ue(this,Wt))||i!==ue(this,Qo))&&zt(this,tn,z_).call(this,i)}getOptimisticResult(t){const n=ue(this,Vs).getQueryCache().build(ue(this,Vs),t),r=this.createResult(n,t);return bj(this,r)&&(Ze(this,Ms,r),Ze(this,vc,this.options),Ze(this,li,ue(this,Wt).state)),r}getCurrentResult(){return ue(this,Ms)}trackResult(t,n){return new Proxy(t,{get:(r,l)=>(this.trackProp(l),n==null||n(l),l==="promise"&&!this.options.experimental_prefetchInRender&&ue(this,ao).status==="pending"&&ue(this,ao).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(r,l))})}trackProp(t){ue(this,xc).add(t)}getCurrentQuery(){return ue(this,Wt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=ue(this,Vs).defaultQueryOptions(t),r=ue(this,Vs).getQueryCache().build(ue(this,Vs),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return zt(this,tn,Lm).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),ue(this,Ms)))}createResult(t,n){var F;const r=ue(this,Wt),l=this.options,i=ue(this,Ms),u=ue(this,li),d=ue(this,vc),y=t!==r?t.state:ue(this,xd),{state:p}=t;let v={...p},_=!1,x;if(n._optimisticResults){const R=this.hasListeners(),B=!R&&uv(t,n),ee=R&&dv(t,r,n,l);(B||ee)&&(v={...v,...iv(p.data,t.options)}),n._optimisticResults==="isRestoring"&&(v.fetchStatus="idle")}let{error:j,errorUpdatedAt:S,status:k}=v;x=v.data;let M=!1;if(n.placeholderData!==void 0&&x===void 0&&k==="pending"){let R;i!=null&&i.isPlaceholderData&&n.placeholderData===(d==null?void 0:d.placeholderData)?(R=i.data,M=!0):R=typeof n.placeholderData=="function"?n.placeholderData((F=ue(this,bc))==null?void 0:F.state.data,ue(this,bc)):n.placeholderData,R!==void 0&&(k="success",x=hp(i==null?void 0:i.data,R,n),_=!0)}if(n.select&&x!==void 0&&!M)if(i&&x===(u==null?void 0:u.data)&&n.select===ue(this,wd))x=ue(this,yc);else try{Ze(this,wd,n.select),x=n.select(x),x=hp(i==null?void 0:i.data,x,n),Ze(this,yc,x),Ze(this,Yo,null)}catch(R){Ze(this,Yo,R)}ue(this,Yo)&&(j=ue(this,Yo),x=ue(this,yc),S=Date.now(),k="error");const P=v.fetchStatus==="fetching",T=k==="pending",w=k==="error",A=T&&P,E=x!==void 0,$={status:k,fetchStatus:v.fetchStatus,isPending:T,isSuccess:k==="success",isError:w,isInitialLoading:A,isLoading:A,data:x,dataUpdatedAt:v.dataUpdatedAt,error:j,errorUpdatedAt:S,failureCount:v.fetchFailureCount,failureReason:v.fetchFailureReason,errorUpdateCount:v.errorUpdateCount,isFetched:v.dataUpdateCount>0||v.errorUpdateCount>0,isFetchedAfterMount:v.dataUpdateCount>y.dataUpdateCount||v.errorUpdateCount>y.errorUpdateCount,isFetching:P,isRefetching:P&&!T,isLoadingError:w&&!E,isPaused:v.fetchStatus==="paused",isPlaceholderData:_,isRefetchError:w&&E,isStale:bp(t,n),refetch:this.refetch,promise:ue(this,ao),isEnabled:kr(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const R=le=>{$.status==="error"?le.reject($.error):$.data!==void 0&&le.resolve($.data)},B=()=>{const le=Ze(this,ao,$.promise=_p());R(le)},ee=ue(this,ao);switch(ee.status){case"pending":t.queryHash===r.queryHash&&R(ee);break;case"fulfilled":($.status==="error"||$.data!==ee.value)&&B();break;case"rejected":($.status!=="error"||$.error!==ee.reason)&&B();break}}return $}updateResult(){const t=ue(this,Ms),n=this.createResult(ue(this,Wt),this.options);if(Ze(this,li,ue(this,Wt).state),Ze(this,vc,this.options),ue(this,li).data!==void 0&&Ze(this,bc,ue(this,Wt)),zm(n,t))return;Ze(this,Ms,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,i=typeof l=="function"?l():l;if(i==="all"||!i&&!ue(this,xc).size)return!0;const u=new Set(i??ue(this,xc));return this.options.throwOnError&&u.add("error"),Object.keys(ue(this,Ms)).some(d=>{const m=d;return ue(this,Ms)[m]!==t[m]&&u.has(m)})};zt(this,tn,Gw).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&zt(this,tn,R_).call(this)}},Vs=new WeakMap,Wt=new WeakMap,xd=new WeakMap,Ms=new WeakMap,li=new WeakMap,vc=new WeakMap,ao=new WeakMap,Yo=new WeakMap,wd=new WeakMap,yc=new WeakMap,bc=new WeakMap,ii=new WeakMap,ci=new WeakMap,Qo=new WeakMap,xc=new WeakMap,tn=new WeakSet,Lm=function(t){zt(this,tn,B_).call(this);let n=ue(this,Wt).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(ks)),n},D_=function(){zt(this,tn,F_).call(this);const t=Ro(this.options.staleTime,ue(this,Wt));if(zl||ue(this,Ms).isStale||!dp(t))return;const r=X_(ue(this,Ms).dataUpdatedAt,t)+1;Ze(this,ii,Ll.setTimeout(()=>{ue(this,Ms).isStale||this.updateResult()},r))},L_=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(ue(this,Wt)):this.options.refetchInterval)??!1},z_=function(t){zt(this,tn,I_).call(this),Ze(this,Qo,t),!(zl||kr(this.options.enabled,ue(this,Wt))===!1||!dp(ue(this,Qo))||ue(this,Qo)===0)&&Ze(this,ci,Ll.setInterval(()=>{(this.options.refetchIntervalInBackground||gp.isFocused())&&zt(this,tn,Lm).call(this)},ue(this,Qo)))},R_=function(){zt(this,tn,D_).call(this),zt(this,tn,z_).call(this,zt(this,tn,L_).call(this))},F_=function(){ue(this,ii)&&(Ll.clearTimeout(ue(this,ii)),Ze(this,ii,void 0))},I_=function(){ue(this,ci)&&(Ll.clearInterval(ue(this,ci)),Ze(this,ci,void 0))},B_=function(){const t=ue(this,Vs).getQueryCache().build(ue(this,Vs),this.options);if(t===ue(this,Wt))return;const n=ue(this,Wt);Ze(this,Wt,t),Ze(this,xd,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},Gw=function(t){Zn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(ue(this,Ms))}),ue(this,Vs).getQueryCache().notify({query:ue(this,Wt),type:"observerResultsUpdated"})})},Rw);function yj(e,t){return kr(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function uv(e,t){return yj(e,t)||e.state.data!==void 0&&yp(e,t,t.refetchOnMount)}function yp(e,t,n){if(kr(t.enabled,e)!==!1&&Ro(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&bp(e,t)}return!1}function dv(e,t,n,r){return(e!==t||kr(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&bp(e,n)}function bp(e,t){return kr(t.enabled,e)!==!1&&e.isStaleByTime(Ro(t.staleTime,e))}function bj(e,t){return!zm(e.getCurrentResult(),t)}function mv(e){return{onFetch:(t,n)=>{var p,v,_,x,j;const r=t.options,l=(_=(v=(p=t.fetchOptions)==null?void 0:p.meta)==null?void 0:v.fetchMore)==null?void 0:_.direction,i=((x=t.state.data)==null?void 0:x.pages)||[],u=((j=t.state.data)==null?void 0:j.pageParams)||[];let d={pages:[],pageParams:[]},m=0;const y=async()=>{let S=!1;const k=T=>{Object.defineProperty(T,"signal",{enumerable:!0,get:()=>(t.signal.aborted?S=!0:t.signal.addEventListener("abort",()=>{S=!0}),t.signal)})},M=sv(t.options,t.fetchOptions),P=async(T,w,A)=>{if(S)return Promise.reject();if(w==null&&T.pages.length)return Promise.resolve(T);const D=(()=>{const B={client:t.client,queryKey:t.queryKey,pageParam:w,direction:A?"backward":"forward",meta:t.options.meta};return k(B),B})(),$=await M(D),{maxPages:F}=t.options,R=A?uj:cj;return{pages:R(T.pages,$,F),pageParams:R(T.pageParams,w,F)}};if(l&&i.length){const T=l==="backward",w=T?xj:fv,A={pages:i,pageParams:u},E=w(r,A);d=await P(A,E,T)}else{const T=e??i.length;do{const w=m===0?u[0]??r.initialPageParam:fv(r,d);if(m>0&&w==null)break;d=await P(d,w),m++}while(m<T)}return d};t.options.persister?t.fetchFn=()=>{var S,k;return(k=(S=t.options).persister)==null?void 0:k.call(S,y,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=y}}}function fv(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function xj(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var wj=(Fw=class extends lv{constructor(t){super();ft(this,Aa);ft(this,jd);ft(this,Ma);ft(this,As);ft(this,ui);Ze(this,jd,t.client),this.mutationId=t.mutationId,Ze(this,As,t.mutationCache),Ze(this,Ma,[]),this.state=t.state||hv(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){ue(this,Ma).includes(t)||(ue(this,Ma).push(t),this.clearGcTimeout(),ue(this,As).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Ze(this,Ma,ue(this,Ma).filter(n=>n!==t)),this.scheduleGc(),ue(this,As).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){ue(this,Ma).length||(this.state.status==="pending"?this.scheduleGc():ue(this,As).remove(this))}continue(){var t;return((t=ue(this,ui))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var u,d,m,y,p,v,_,x,j,S,k,M,P,T,w,A,E,D,$,F;const n=()=>{zt(this,Aa,$l).call(this,{type:"continue"})},r={client:ue(this,jd),meta:this.options.meta,mutationKey:this.options.mutationKey};Ze(this,ui,ov({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(R,B)=>{zt(this,Aa,$l).call(this,{type:"failed",failureCount:R,error:B})},onPause:()=>{zt(this,Aa,$l).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>ue(this,As).canRun(this)}));const l=this.state.status==="pending",i=!ue(this,ui).canStart();try{if(l)n();else{zt(this,Aa,$l).call(this,{type:"pending",variables:t,isPaused:i}),await((d=(u=ue(this,As).config).onMutate)==null?void 0:d.call(u,t,this,r));const B=await((y=(m=this.options).onMutate)==null?void 0:y.call(m,t,r));B!==this.state.context&&zt(this,Aa,$l).call(this,{type:"pending",context:B,variables:t,isPaused:i})}const R=await ue(this,ui).start();return await((v=(p=ue(this,As).config).onSuccess)==null?void 0:v.call(p,R,t,this.state.context,this,r)),await((x=(_=this.options).onSuccess)==null?void 0:x.call(_,R,t,this.state.context,r)),await((S=(j=ue(this,As).config).onSettled)==null?void 0:S.call(j,R,null,this.state.variables,this.state.context,this,r)),await((M=(k=this.options).onSettled)==null?void 0:M.call(k,R,null,t,this.state.context,r)),zt(this,Aa,$l).call(this,{type:"success",data:R}),R}catch(R){try{throw await((T=(P=ue(this,As).config).onError)==null?void 0:T.call(P,R,t,this.state.context,this,r)),await((A=(w=this.options).onError)==null?void 0:A.call(w,R,t,this.state.context,r)),await((D=(E=ue(this,As).config).onSettled)==null?void 0:D.call(E,void 0,R,this.state.variables,this.state.context,this,r)),await((F=($=this.options).onSettled)==null?void 0:F.call($,void 0,R,t,this.state.context,r)),R}finally{zt(this,Aa,$l).call(this,{type:"error",error:R})}}finally{ue(this,As).runNext(this)}}},jd=new WeakMap,Ma=new WeakMap,As=new WeakMap,ui=new WeakMap,Aa=new WeakSet,$l=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Zn.batch(()=>{ue(this,Ma).forEach(r=>{r.onMutationUpdate(t)}),ue(this,As).notify({mutation:this,type:"updated",action:t})})},Fw);function hv(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var jj=(Iw=class extends Yi{constructor(t={}){super();ft(this,oo);ft(this,ea);ft(this,Nd);this.config=t,Ze(this,oo,new Set),Ze(this,ea,new Map),Ze(this,Nd,0)}build(t,n,r){const l=new wj({client:t,mutationCache:this,mutationId:++op(this,Nd)._,options:t.defaultMutationOptions(n),state:r});return this.add(l),l}add(t){ue(this,oo).add(t);const n=Fm(t);if(typeof n=="string"){const r=ue(this,ea).get(n);r?r.push(t):ue(this,ea).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(ue(this,oo).delete(t)){const n=Fm(t);if(typeof n=="string"){const r=ue(this,ea).get(n);if(r)if(r.length>1){const l=r.indexOf(t);l!==-1&&r.splice(l,1)}else r[0]===t&&ue(this,ea).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Fm(t);if(typeof n=="string"){const r=ue(this,ea).get(n),l=r==null?void 0:r.find(i=>i.state.status==="pending");return!l||l===t}else return!0}runNext(t){var r;const n=Fm(t);if(typeof n=="string"){const l=(r=ue(this,ea).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(l==null?void 0:l.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Zn.batch(()=>{ue(this,oo).forEach(t=>{this.notify({type:"removed",mutation:t})}),ue(this,oo).clear(),ue(this,ea).clear()})}getAll(){return Array.from(ue(this,oo))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>Z_(n,r))}findAll(t={}){return this.getAll().filter(n=>Z_(t,n))}notify(t){Zn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Zn.batch(()=>Promise.all(t.map(n=>n.continue().catch(ks))))}},oo=new WeakMap,ea=new WeakMap,Nd=new WeakMap,Iw);function Fm(e){var t;return(t=e.options.scope)==null?void 0:t.id}var Nj=(Bw=class extends Yi{constructor(t,n){super();ft(this,co);ft(this,lo);ft(this,Go);ft(this,Ws);ft(this,io);Ze(this,lo,t),this.setOptions(n),this.bindMethods(),zt(this,co,lp).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var r;const n=this.options;this.options=ue(this,lo).defaultMutationOptions(t),zm(this.options,n)||ue(this,lo).getMutationCache().notify({type:"observerOptionsUpdated",mutation:ue(this,Ws),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&Rl(n.mutationKey)!==Rl(this.options.mutationKey)?this.reset():((r=ue(this,Ws))==null?void 0:r.state.status)==="pending"&&ue(this,Ws).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=ue(this,Ws))==null||t.removeObserver(this)}onMutationUpdate(t){zt(this,co,lp).call(this),zt(this,co,U_).call(this,t)}getCurrentResult(){return ue(this,Go)}reset(){var t;(t=ue(this,Ws))==null||t.removeObserver(this),Ze(this,Ws,void 0),zt(this,co,lp).call(this),zt(this,co,U_).call(this)}mutate(t,n){var r;return Ze(this,io,n),(r=ue(this,Ws))==null||r.removeObserver(this),Ze(this,Ws,ue(this,lo).getMutationCache().build(ue(this,lo),this.options)),ue(this,Ws).addObserver(this),ue(this,Ws).execute(t)}},lo=new WeakMap,Go=new WeakMap,Ws=new WeakMap,io=new WeakMap,co=new WeakSet,lp=function(){var n;const t=((n=ue(this,Ws))==null?void 0:n.state)??hv();Ze(this,Go,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},U_=function(t){Zn.batch(()=>{var n,r,l,i,u,d,m,y;if(ue(this,io)&&this.hasListeners()){const p=ue(this,Go).variables,v=ue(this,Go).context,_={client:ue(this,lo),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((r=(n=ue(this,io)).onSuccess)==null||r.call(n,t.data,p,v,_),(i=(l=ue(this,io)).onSettled)==null||i.call(l,t.data,null,p,v,_)):(t==null?void 0:t.type)==="error"&&((d=(u=ue(this,io)).onError)==null||d.call(u,t.error,p,v,_),(y=(m=ue(this,io)).onSettled)==null||y.call(m,void 0,t.error,p,v,_))}this.listeners.forEach(p=>{p(ue(this,Go))})})},Bw),Sj=(Uw=class extends Yi{constructor(t={}){super();ft(this,Oa);this.config=t,Ze(this,Oa,new Map)}build(t,n,r){const l=n.queryKey,i=n.queryHash??mp(l,n);let u=this.get(i);return u||(u=new _j({client:t,queryKey:l,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(l)}),this.add(u)),u}add(t){ue(this,Oa).has(t.queryHash)||(ue(this,Oa).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=ue(this,Oa).get(t.queryHash);n&&(t.destroy(),n===t&&ue(this,Oa).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Zn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return ue(this,Oa).get(t)}getAll(){return[...ue(this,Oa).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>J_(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>J_(t,r)):n}notify(t){Zn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Zn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Zn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Oa=new WeakMap,Uw),Cj=(qw=class{constructor(e={}){ft(this,$n);ft(this,Xo);ft(this,Jo);ft(this,wc);ft(this,jc);ft(this,Zo);ft(this,Nc);ft(this,Sc);Ze(this,$n,e.queryCache||new Sj),Ze(this,Xo,e.mutationCache||new jj),Ze(this,Jo,e.defaultOptions||{}),Ze(this,wc,new Map),Ze(this,jc,new Map),Ze(this,Zo,0)}mount(){op(this,Zo)._++,ue(this,Zo)===1&&(Ze(this,Nc,gp.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,$n).onFocus())})),Ze(this,Sc,Rm.subscribe(async e=>{e&&(await this.resumePausedMutations(),ue(this,$n).onOnline())})))}unmount(){var e,t;op(this,Zo)._--,ue(this,Zo)===0&&((e=ue(this,Nc))==null||e.call(this),Ze(this,Nc,void 0),(t=ue(this,Sc))==null||t.call(this),Ze(this,Sc,void 0))}isFetching(e){return ue(this,$n).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return ue(this,Xo).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ue(this,$n).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=ue(this,$n).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Ro(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return ue(this,$n).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),l=ue(this,$n).get(r.queryHash),i=l==null?void 0:l.state.data,u=oj(t,i);if(u!==void 0)return ue(this,$n).build(this,r).setData(u,{...n,manual:!0})}setQueriesData(e,t,n){return Zn.batch(()=>ue(this,$n).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=ue(this,$n).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=ue(this,$n);Zn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=ue(this,$n);return Zn.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=Zn.batch(()=>ue(this,$n).findAll(e).map(l=>l.cancel(n)));return Promise.all(r).then(ks).catch(ks)}invalidateQueries(e,t={}){return Zn.batch(()=>(ue(this,$n).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=Zn.batch(()=>ue(this,$n).findAll(e).filter(l=>!l.isDisabled()&&!l.isStatic()).map(l=>{let i=l.fetch(void 0,n);return n.throwOnError||(i=i.catch(ks)),l.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(ks)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=ue(this,$n).build(this,t);return n.isStaleByTime(Ro(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ks).catch(ks)}fetchInfiniteQuery(e){return e.behavior=mv(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ks).catch(ks)}ensureInfiniteQueryData(e){return e.behavior=mv(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Rm.isOnline()?ue(this,Xo).resumePausedMutations():Promise.resolve()}getQueryCache(){return ue(this,$n)}getMutationCache(){return ue(this,Xo)}getDefaultOptions(){return ue(this,Jo)}setDefaultOptions(e){Ze(this,Jo,e)}setQueryDefaults(e,t){ue(this,wc).set(Rl(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...ue(this,wc).values()],n={};return t.forEach(r=>{Tu(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){ue(this,jc).set(Rl(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...ue(this,jc).values()],n={};return t.forEach(r=>{Tu(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...ue(this,Jo).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=mp(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===pp&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...ue(this,Jo).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){ue(this,$n).clear(),ue(this,Xo).clear()}},$n=new WeakMap,Xo=new WeakMap,Jo=new WeakMap,wc=new WeakMap,jc=new WeakMap,Zo=new WeakMap,Nc=new WeakMap,Sc=new WeakMap,qw),pv=f.createContext(void 0),Qi=e=>{const t=f.useContext(pv);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},Ej=({client:e,children:t})=>(f.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(pv.Provider,{value:e,children:t})),gv=f.createContext(!1),kj=()=>f.useContext(gv);gv.Provider;function Mj(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var Aj=f.createContext(Mj()),Oj=()=>f.useContext(Aj),Pj=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},Tj=e=>{f.useEffect(()=>{e.clearReset()},[e])},$j=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:l})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(l&&e.data===void 0||rv(n,[e.error,r])),Dj=e=>{if(e.suspense){const n=l=>l==="static"?l:Math.max(l??1e3,1e3),r=e.staleTime;e.staleTime=typeof r=="function"?(...l)=>n(r(...l)):n(r),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Lj=(e,t)=>e.isLoading&&e.isFetching&&!t,zj=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,_v=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Rj(e,t,n){var v,_,x,j,S;const r=kj(),l=Oj(),i=Qi(),u=i.defaultQueryOptions(e);(_=(v=i.getDefaultOptions().queries)==null?void 0:v._experimental_beforeQuery)==null||_.call(v,u),u._optimisticResults=r?"isRestoring":"optimistic",Dj(u),Pj(u,l),Tj(l);const d=!i.getQueryCache().get(u.queryHash),[m]=f.useState(()=>new t(i,u)),y=m.getOptimisticResult(u),p=!r&&e.subscribed!==!1;if(f.useSyncExternalStore(f.useCallback(k=>{const M=p?m.subscribe(Zn.batchCalls(k)):ks;return m.updateResult(),M},[m,p]),()=>m.getCurrentResult(),()=>m.getCurrentResult()),f.useEffect(()=>{m.setOptions(u)},[u,m]),zj(u,y))throw _v(u,m,l);if($j({result:y,errorResetBoundary:l,throwOnError:u.throwOnError,query:i.getQueryCache().get(u.queryHash),suspense:u.suspense}))throw y.error;if((j=(x=i.getDefaultOptions().queries)==null?void 0:x._experimental_afterQuery)==null||j.call(x,u,y),u.experimental_prefetchInRender&&!zl&&Lj(y,r)){const k=d?_v(u,m,l):(S=i.getQueryCache().get(u.queryHash))==null?void 0:S.promise;k==null||k.catch(ks).finally(()=>{m.updateResult()})}return u.notifyOnChangeProps?y:m.trackResult(y)}function ir(e,t){return Rj(e,vj)}function Im(e,t){const n=Qi(),[r]=f.useState(()=>new Nj(n,e));f.useEffect(()=>{r.setOptions(e)},[r,e]);const l=f.useSyncExternalStore(f.useCallback(u=>r.subscribe(Zn.batchCalls(u)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),i=f.useCallback((u,d)=>{r.mutate(u,d).catch(ks)},[r]);if(l.error&&rv(r.options.throwOnError,[l.error]))throw l.error;return{...l,mutate:i,mutateAsync:l.mutate}}function Fj(e){let t;const n=new Set,r=(y,p)=>{const v=typeof y=="function"?y(t):y;if(v!==t){const _=t;t=p?v:Object.assign({},t,v),n.forEach(x=>x(t,_))}},l=()=>t,i=(y,p=l,v=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let _=p(t);function x(){const j=p(t);if(!v(_,j)){const S=_;y(_=j,S)}}return n.add(x),()=>n.delete(x)},m={setState:r,getState:l,subscribe:(y,p,v)=>p||v?i(y,p,v):(n.add(y),()=>n.delete(y)),destroy:()=>n.clear()};return t=e(r,l,m),m}const vv=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?f.useEffect:f.useLayoutEffect;function Ij(e){const t=typeof e=="function"?Fj(e):e,n=(r=t.getState,l=Object.is)=>{const[,i]=f.useReducer(k=>k+1,0),u=t.getState(),d=f.useRef(u),m=f.useRef(r),y=f.useRef(l),p=f.useRef(!1),v=f.useRef();v.current===void 0&&(v.current=r(u));let _,x=!1;(d.current!==u||m.current!==r||y.current!==l||p.current)&&(_=r(u),x=!l(v.current,_)),vv(()=>{x&&(v.current=_),d.current=u,m.current=r,y.current=l,p.current=!1});const j=f.useRef(u);vv(()=>{const k=()=>{try{const P=t.getState(),T=m.current(P);y.current(v.current,T)||(d.current=P,v.current=T,i())}catch{p.current=!0,i()}},M=t.subscribe(k);return t.getState()!==j.current&&k(),M},[]);const S=x?_:v.current;return f.useDebugValue(S),S};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const r=[n,t];return{next(){const l=r.length<=0;return{value:r.shift(),done:l}}}},n}function Bj(){const e=f.createContext(void 0);return{Provider:({initialStore:l,createStore:i,children:u})=>{const d=f.useRef();return d.current||(l&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),i||(i=()=>l)),d.current=i()),f.createElement(e.Provider,{value:d.current},u)},useStore:(l,i=Object.is)=>{const u=f.useContext(e);if(!u)throw new Error("Seems like you have not used zustand provider as an ancestor.");return u(l,i)},useStoreApi:()=>{const l=f.useContext(e);if(!l)throw new Error("Seems like you have not used zustand provider as an ancestor.");return f.useMemo(()=>({getState:l.getState,setState:l.setState,subscribe:l.subscribe,destroy:l.destroy}),[l])}}}var Uj={value:()=>{}};function Bm(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Um(n)}function Um(e){this._=e}function qj(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",l=n.indexOf(".");if(l>=0&&(r=n.slice(l+1),n=n.slice(0,l)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Um.prototype=Bm.prototype={constructor:Um,on:function(e,t){var n=this._,r=qj(e+"",n),l,i=-1,u=r.length;if(arguments.length<2){for(;++i<u;)if((l=(e=r[i]).type)&&(l=Hj(n[l],e.name)))return l;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<u;)if(l=(e=r[i]).type)n[l]=yv(n[l],e.name,t);else if(t==null)for(l in n)n[l]=yv(n[l],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Um(e)},call:function(e,t){if((l=arguments.length-2)>0)for(var n=new Array(l),r=0,l,i;r<l;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,l=i.length;r<l;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],l=0,i=r.length;l<i;++l)r[l].value.apply(t,n)}};function Hj(e,t){for(var n=0,r=e.length,l;n<r;++n)if((l=e[n]).name===t)return l.value}function yv(e,t,n){for(var r=0,l=e.length;r<l;++r)if(e[r].name===t){e[r]=Uj,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var xp="http://www.w3.org/1999/xhtml";const bv={svg:"http://www.w3.org/2000/svg",xhtml:xp,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function qm(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),bv.hasOwnProperty(t)?{space:bv[t],local:e}:e}function Vj(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===xp&&t.documentElement.namespaceURI===xp?t.createElement(e):t.createElementNS(n,e)}}function Wj(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function xv(e){var t=qm(e);return(t.local?Wj:Vj)(t)}function Kj(){}function wp(e){return e==null?Kj:function(){return this.querySelector(e)}}function Yj(e){typeof e!="function"&&(e=wp(e));for(var t=this._groups,n=t.length,r=new Array(n),l=0;l<n;++l)for(var i=t[l],u=i.length,d=r[l]=new Array(u),m,y,p=0;p<u;++p)(m=i[p])&&(y=e.call(m,m.__data__,p,i))&&("__data__"in m&&(y.__data__=m.__data__),d[p]=y);return new cr(r,this._parents)}function Qj(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function Gj(){return[]}function wv(e){return e==null?Gj:function(){return this.querySelectorAll(e)}}function Xj(e){return function(){return Qj(e.apply(this,arguments))}}function Jj(e){typeof e=="function"?e=Xj(e):e=wv(e);for(var t=this._groups,n=t.length,r=[],l=[],i=0;i<n;++i)for(var u=t[i],d=u.length,m,y=0;y<d;++y)(m=u[y])&&(r.push(e.call(m,m.__data__,y,u)),l.push(m));return new cr(r,l)}function jv(e){return function(){return this.matches(e)}}function Nv(e){return function(t){return t.matches(e)}}var Zj=Array.prototype.find;function eN(e){return function(){return Zj.call(this.children,e)}}function tN(){return this.firstElementChild}function nN(e){return this.select(e==null?tN:eN(typeof e=="function"?e:Nv(e)))}var sN=Array.prototype.filter;function rN(){return Array.from(this.children)}function aN(e){return function(){return sN.call(this.children,e)}}function oN(e){return this.selectAll(e==null?rN:aN(typeof e=="function"?e:Nv(e)))}function lN(e){typeof e!="function"&&(e=jv(e));for(var t=this._groups,n=t.length,r=new Array(n),l=0;l<n;++l)for(var i=t[l],u=i.length,d=r[l]=[],m,y=0;y<u;++y)(m=i[y])&&e.call(m,m.__data__,y,i)&&d.push(m);return new cr(r,this._parents)}function Sv(e){return new Array(e.length)}function iN(){return new cr(this._enter||this._groups.map(Sv),this._parents)}function Hm(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Hm.prototype={constructor:Hm,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function cN(e){return function(){return e}}function uN(e,t,n,r,l,i){for(var u=0,d,m=t.length,y=i.length;u<y;++u)(d=t[u])?(d.__data__=i[u],r[u]=d):n[u]=new Hm(e,i[u]);for(;u<m;++u)(d=t[u])&&(l[u]=d)}function dN(e,t,n,r,l,i,u){var d,m,y=new Map,p=t.length,v=i.length,_=new Array(p),x;for(d=0;d<p;++d)(m=t[d])&&(_[d]=x=u.call(m,m.__data__,d,t)+"",y.has(x)?l[d]=m:y.set(x,m));for(d=0;d<v;++d)x=u.call(e,i[d],d,i)+"",(m=y.get(x))?(r[d]=m,m.__data__=i[d],y.delete(x)):n[d]=new Hm(e,i[d]);for(d=0;d<p;++d)(m=t[d])&&y.get(_[d])===m&&(l[d]=m)}function mN(e){return e.__data__}function fN(e,t){if(!arguments.length)return Array.from(this,mN);var n=t?dN:uN,r=this._parents,l=this._groups;typeof e!="function"&&(e=cN(e));for(var i=l.length,u=new Array(i),d=new Array(i),m=new Array(i),y=0;y<i;++y){var p=r[y],v=l[y],_=v.length,x=hN(e.call(p,p&&p.__data__,y,r)),j=x.length,S=d[y]=new Array(j),k=u[y]=new Array(j),M=m[y]=new Array(_);n(p,v,S,k,M,x,t);for(var P=0,T=0,w,A;P<j;++P)if(w=S[P]){for(P>=T&&(T=P+1);!(A=k[T])&&++T<j;);w._next=A||null}}return u=new cr(u,r),u._enter=d,u._exit=m,u}function hN(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function pN(){return new cr(this._exit||this._groups.map(Sv),this._parents)}function gN(e,t,n){var r=this.enter(),l=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(l=t(l),l&&(l=l.selection())),n==null?i.remove():n(i),r&&l?r.merge(l).order():l}function _N(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,l=n.length,i=r.length,u=Math.min(l,i),d=new Array(l),m=0;m<u;++m)for(var y=n[m],p=r[m],v=y.length,_=d[m]=new Array(v),x,j=0;j<v;++j)(x=y[j]||p[j])&&(_[j]=x);for(;m<l;++m)d[m]=n[m];return new cr(d,this._parents)}function vN(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],l=r.length-1,i=r[l],u;--l>=0;)(u=r[l])&&(i&&u.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(u,i),i=u);return this}function yN(e){e||(e=bN);function t(v,_){return v&&_?e(v.__data__,_.__data__):!v-!_}for(var n=this._groups,r=n.length,l=new Array(r),i=0;i<r;++i){for(var u=n[i],d=u.length,m=l[i]=new Array(d),y,p=0;p<d;++p)(y=u[p])&&(m[p]=y);m.sort(t)}return new cr(l,this._parents).order()}function bN(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function xN(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function wN(){return Array.from(this)}function jN(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],l=0,i=r.length;l<i;++l){var u=r[l];if(u)return u}return null}function NN(){let e=0;for(const t of this)++e;return e}function SN(){return!this.node()}function CN(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var l=t[n],i=0,u=l.length,d;i<u;++i)(d=l[i])&&e.call(d,d.__data__,i,l);return this}function EN(e){return function(){this.removeAttribute(e)}}function kN(e){return function(){this.removeAttributeNS(e.space,e.local)}}function MN(e,t){return function(){this.setAttribute(e,t)}}function AN(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ON(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function PN(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function TN(e,t){var n=qm(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?kN:EN:typeof t=="function"?n.local?PN:ON:n.local?AN:MN)(n,t))}function Cv(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function $N(e){return function(){this.style.removeProperty(e)}}function DN(e,t,n){return function(){this.style.setProperty(e,t,n)}}function LN(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function zN(e,t,n){return arguments.length>1?this.each((t==null?$N:typeof t=="function"?LN:DN)(e,t,n??"")):Gi(this.node(),e)}function Gi(e,t){return e.style.getPropertyValue(t)||Cv(e).getComputedStyle(e,null).getPropertyValue(t)}function RN(e){return function(){delete this[e]}}function FN(e,t){return function(){this[e]=t}}function IN(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function BN(e,t){return arguments.length>1?this.each((t==null?RN:typeof t=="function"?IN:FN)(e,t)):this.node()[e]}function Ev(e){return e.trim().split(/^|\s+/)}function jp(e){return e.classList||new kv(e)}function kv(e){this._node=e,this._names=Ev(e.getAttribute("class")||"")}kv.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Mv(e,t){for(var n=jp(e),r=-1,l=t.length;++r<l;)n.add(t[r])}function Av(e,t){for(var n=jp(e),r=-1,l=t.length;++r<l;)n.remove(t[r])}function UN(e){return function(){Mv(this,e)}}function qN(e){return function(){Av(this,e)}}function HN(e,t){return function(){(t.apply(this,arguments)?Mv:Av)(this,e)}}function VN(e,t){var n=Ev(e+"");if(arguments.length<2){for(var r=jp(this.node()),l=-1,i=n.length;++l<i;)if(!r.contains(n[l]))return!1;return!0}return this.each((typeof t=="function"?HN:t?UN:qN)(n,t))}function WN(){this.textContent=""}function KN(e){return function(){this.textContent=e}}function YN(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function QN(e){return arguments.length?this.each(e==null?WN:(typeof e=="function"?YN:KN)(e)):this.node().textContent}function GN(){this.innerHTML=""}function XN(e){return function(){this.innerHTML=e}}function JN(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ZN(e){return arguments.length?this.each(e==null?GN:(typeof e=="function"?JN:XN)(e)):this.node().innerHTML}function eS(){this.nextSibling&&this.parentNode.appendChild(this)}function tS(){return this.each(eS)}function nS(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function sS(){return this.each(nS)}function rS(e){var t=typeof e=="function"?e:xv(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function aS(){return null}function oS(e,t){var n=typeof e=="function"?e:xv(e),r=t==null?aS:typeof t=="function"?t:wp(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function lS(){var e=this.parentNode;e&&e.removeChild(this)}function iS(){return this.each(lS)}function cS(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function uS(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function dS(e){return this.select(e?uS:cS)}function mS(e){return arguments.length?this.property("__data__",e):this.node().__data__}function fS(e){return function(t){e.call(this,t,this.__data__)}}function hS(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function pS(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,l=t.length,i;n<l;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function gS(e,t,n){return function(){var r=this.__on,l,i=fS(t);if(r){for(var u=0,d=r.length;u<d;++u)if((l=r[u]).type===e.type&&l.name===e.name){this.removeEventListener(l.type,l.listener,l.options),this.addEventListener(l.type,l.listener=i,l.options=n),l.value=t;return}}this.addEventListener(e.type,i,n),l={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(l):this.__on=[l]}}function _S(e,t,n){var r=hS(e+""),l,i=r.length,u;if(arguments.length<2){var d=this.node().__on;if(d){for(var m=0,y=d.length,p;m<y;++m)for(l=0,p=d[m];l<i;++l)if((u=r[l]).type===p.type&&u.name===p.name)return p.value}return}for(d=t?gS:pS,l=0;l<i;++l)this.each(d(r[l],t,n));return this}function Ov(e,t,n){var r=Cv(e),l=r.CustomEvent;typeof l=="function"?l=new l(t,n):(l=r.document.createEvent("Event"),n?(l.initEvent(t,n.bubbles,n.cancelable),l.detail=n.detail):l.initEvent(t,!1,!1)),e.dispatchEvent(l)}function vS(e,t){return function(){return Ov(this,e,t)}}function yS(e,t){return function(){return Ov(this,e,t.apply(this,arguments))}}function bS(e,t){return this.each((typeof t=="function"?yS:vS)(e,t))}function*xS(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],l=0,i=r.length,u;l<i;++l)(u=r[l])&&(yield u)}var Pv=[null];function cr(e,t){this._groups=e,this._parents=t}function $u(){return new cr([[document.documentElement]],Pv)}function wS(){return this}cr.prototype=$u.prototype={constructor:cr,select:Yj,selectAll:Jj,selectChild:nN,selectChildren:oN,filter:lN,data:fN,enter:iN,exit:pN,join:gN,merge:_N,selection:wS,order:vN,sort:yN,call:xN,nodes:wN,node:jN,size:NN,empty:SN,each:CN,attr:TN,style:zN,property:BN,classed:VN,text:QN,html:ZN,raise:tS,lower:sS,append:rS,insert:oS,remove:iS,clone:dS,datum:mS,on:_S,dispatch:bS,[Symbol.iterator]:xS};function Gr(e){return typeof e=="string"?new cr([[document.querySelector(e)]],[document.documentElement]):new cr([[e]],Pv)}function jS(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Sa(e,t){if(e=jS(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var l=t.getBoundingClientRect();return[e.clientX-l.left-t.clientLeft,e.clientY-l.top-t.clientTop]}}return[e.pageX,e.pageY]}const NS={passive:!1},Du={capture:!0,passive:!1};function Np(e){e.stopImmediatePropagation()}function Xi(e){e.preventDefault(),e.stopImmediatePropagation()}function Tv(e){var t=e.document.documentElement,n=Gr(e).on("dragstart.drag",Xi,Du);"onselectstart"in t?n.on("selectstart.drag",Xi,Du):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function $v(e,t){var n=e.document.documentElement,r=Gr(e).on("dragstart.drag",null);t&&(r.on("click.drag",Xi,Du),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Vm=e=>()=>e;function Sp(e,{sourceEvent:t,subject:n,target:r,identifier:l,active:i,x:u,y:d,dx:m,dy:y,dispatch:p}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:l,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:u,enumerable:!0,configurable:!0},y:{value:d,enumerable:!0,configurable:!0},dx:{value:m,enumerable:!0,configurable:!0},dy:{value:y,enumerable:!0,configurable:!0},_:{value:p}})}Sp.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function SS(e){return!e.ctrlKey&&!e.button}function CS(){return this.parentNode}function ES(e,t){return t??{x:e.x,y:e.y}}function kS(){return navigator.maxTouchPoints||"ontouchstart"in this}function MS(){var e=SS,t=CS,n=ES,r=kS,l={},i=Bm("start","drag","end"),u=0,d,m,y,p,v=0;function _(w){w.on("mousedown.drag",x).filter(r).on("touchstart.drag",k).on("touchmove.drag",M,NS).on("touchend.drag touchcancel.drag",P).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function x(w,A){if(!(p||!e.call(this,w,A))){var E=T(this,t.call(this,w,A),w,A,"mouse");E&&(Gr(w.view).on("mousemove.drag",j,Du).on("mouseup.drag",S,Du),Tv(w.view),Np(w),y=!1,d=w.clientX,m=w.clientY,E("start",w))}}function j(w){if(Xi(w),!y){var A=w.clientX-d,E=w.clientY-m;y=A*A+E*E>v}l.mouse("drag",w)}function S(w){Gr(w.view).on("mousemove.drag mouseup.drag",null),$v(w.view,y),Xi(w),l.mouse("end",w)}function k(w,A){if(e.call(this,w,A)){var E=w.changedTouches,D=t.call(this,w,A),$=E.length,F,R;for(F=0;F<$;++F)(R=T(this,D,w,A,E[F].identifier,E[F]))&&(Np(w),R("start",w,E[F]))}}function M(w){var A=w.changedTouches,E=A.length,D,$;for(D=0;D<E;++D)($=l[A[D].identifier])&&(Xi(w),$("drag",w,A[D]))}function P(w){var A=w.changedTouches,E=A.length,D,$;for(p&&clearTimeout(p),p=setTimeout(function(){p=null},500),D=0;D<E;++D)($=l[A[D].identifier])&&(Np(w),$("end",w,A[D]))}function T(w,A,E,D,$,F){var R=i.copy(),B=Sa(F||E,A),ee,le,z;if((z=n.call(w,new Sp("beforestart",{sourceEvent:E,target:_,identifier:$,active:u,x:B[0],y:B[1],dx:0,dy:0,dispatch:R}),D))!=null)return ee=z.x-B[0]||0,le=z.y-B[1]||0,function G(W,H,V){var ne=B,Q;switch(W){case"start":l[$]=G,Q=u++;break;case"end":delete l[$],--u;case"drag":B=Sa(V||H,A),Q=u;break}R.call(W,w,new Sp(W,{sourceEvent:H,subject:z,target:_,identifier:$,active:Q,x:B[0]+ee,y:B[1]+le,dx:B[0]-ne[0],dy:B[1]-ne[1],dispatch:R}),D)}}return _.filter=function(w){return arguments.length?(e=typeof w=="function"?w:Vm(!!w),_):e},_.container=function(w){return arguments.length?(t=typeof w=="function"?w:Vm(w),_):t},_.subject=function(w){return arguments.length?(n=typeof w=="function"?w:Vm(w),_):n},_.touchable=function(w){return arguments.length?(r=typeof w=="function"?w:Vm(!!w),_):r},_.on=function(){var w=i.on.apply(i,arguments);return w===i?_:w},_.clickDistance=function(w){return arguments.length?(v=(w=+w)*w,_):Math.sqrt(v)},_}function Cp(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Dv(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function Lu(){}var zu=.7,Wm=1/zu,Ji="\\s*([+-]?\\d+)\\s*",Ru="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ca="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",AS=/^#([0-9a-f]{3,8})$/,OS=new RegExp(`^rgb\\(${Ji},${Ji},${Ji}\\)$`),PS=new RegExp(`^rgb\\(${Ca},${Ca},${Ca}\\)$`),TS=new RegExp(`^rgba\\(${Ji},${Ji},${Ji},${Ru}\\)$`),$S=new RegExp(`^rgba\\(${Ca},${Ca},${Ca},${Ru}\\)$`),DS=new RegExp(`^hsl\\(${Ru},${Ca},${Ca}\\)$`),LS=new RegExp(`^hsla\\(${Ru},${Ca},${Ca},${Ru}\\)$`),Lv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Cp(Lu,Fu,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:zv,formatHex:zv,formatHex8:zS,formatHsl:RS,formatRgb:Rv,toString:Rv});function zv(){return this.rgb().formatHex()}function zS(){return this.rgb().formatHex8()}function RS(){return qv(this).formatHsl()}function Rv(){return this.rgb().formatRgb()}function Fu(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=AS.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Fv(t):n===3?new Us(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Km(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Km(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=OS.exec(e))?new Us(t[1],t[2],t[3],1):(t=PS.exec(e))?new Us(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=TS.exec(e))?Km(t[1],t[2],t[3],t[4]):(t=$S.exec(e))?Km(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=DS.exec(e))?Uv(t[1],t[2]/100,t[3]/100,1):(t=LS.exec(e))?Uv(t[1],t[2]/100,t[3]/100,t[4]):Lv.hasOwnProperty(e)?Fv(Lv[e]):e==="transparent"?new Us(NaN,NaN,NaN,0):null}function Fv(e){return new Us(e>>16&255,e>>8&255,e&255,1)}function Km(e,t,n,r){return r<=0&&(e=t=n=NaN),new Us(e,t,n,r)}function FS(e){return e instanceof Lu||(e=Fu(e)),e?(e=e.rgb(),new Us(e.r,e.g,e.b,e.opacity)):new Us}function Ep(e,t,n,r){return arguments.length===1?FS(e):new Us(e,t,n,r??1)}function Us(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Cp(Us,Ep,Dv(Lu,{brighter(e){return e=e==null?Wm:Math.pow(Wm,e),new Us(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?zu:Math.pow(zu,e),new Us(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Us(Fl(this.r),Fl(this.g),Fl(this.b),Ym(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Iv,formatHex:Iv,formatHex8:IS,formatRgb:Bv,toString:Bv}));function Iv(){return`#${Il(this.r)}${Il(this.g)}${Il(this.b)}`}function IS(){return`#${Il(this.r)}${Il(this.g)}${Il(this.b)}${Il((isNaN(this.opacity)?1:this.opacity)*255)}`}function Bv(){const e=Ym(this.opacity);return`${e===1?"rgb(":"rgba("}${Fl(this.r)}, ${Fl(this.g)}, ${Fl(this.b)}${e===1?")":`, ${e})`}`}function Ym(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Fl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Il(e){return e=Fl(e),(e<16?"0":"")+e.toString(16)}function Uv(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new Xr(e,t,n,r)}function qv(e){if(e instanceof Xr)return new Xr(e.h,e.s,e.l,e.opacity);if(e instanceof Lu||(e=Fu(e)),!e)return new Xr;if(e instanceof Xr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,l=Math.min(t,n,r),i=Math.max(t,n,r),u=NaN,d=i-l,m=(i+l)/2;return d?(t===i?u=(n-r)/d+(n<r)*6:n===i?u=(r-t)/d+2:u=(t-n)/d+4,d/=m<.5?i+l:2-i-l,u*=60):d=m>0&&m<1?0:u,new Xr(u,d,m,e.opacity)}function BS(e,t,n,r){return arguments.length===1?qv(e):new Xr(e,t,n,r??1)}function Xr(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Cp(Xr,BS,Dv(Lu,{brighter(e){return e=e==null?Wm:Math.pow(Wm,e),new Xr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?zu:Math.pow(zu,e),new Xr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,l=2*n-r;return new Us(kp(e>=240?e-240:e+120,l,r),kp(e,l,r),kp(e<120?e+240:e-120,l,r),this.opacity)},clamp(){return new Xr(Hv(this.h),Qm(this.s),Qm(this.l),Ym(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Ym(this.opacity);return`${e===1?"hsl(":"hsla("}${Hv(this.h)}, ${Qm(this.s)*100}%, ${Qm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Hv(e){return e=(e||0)%360,e<0?e+360:e}function Qm(e){return Math.max(0,Math.min(1,e||0))}function kp(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Vv=e=>()=>e;function US(e,t){return function(n){return e+n*t}}function qS(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function HS(e){return(e=+e)==1?Wv:function(t,n){return n-t?qS(t,n,e):Vv(isNaN(t)?n:t)}}function Wv(e,t){var n=t-e;return n?US(e,n):Vv(isNaN(e)?t:e)}const Kv=function e(t){var n=HS(t);function r(l,i){var u=n((l=Ep(l)).r,(i=Ep(i)).r),d=n(l.g,i.g),m=n(l.b,i.b),y=Wv(l.opacity,i.opacity);return function(p){return l.r=u(p),l.g=d(p),l.b=m(p),l.opacity=y(p),l+""}}return r.gamma=e,r}(1);function Fo(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Mp=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ap=new RegExp(Mp.source,"g");function VS(e){return function(){return e}}function WS(e){return function(t){return e(t)+""}}function KS(e,t){var n=Mp.lastIndex=Ap.lastIndex=0,r,l,i,u=-1,d=[],m=[];for(e=e+"",t=t+"";(r=Mp.exec(e))&&(l=Ap.exec(t));)(i=l.index)>n&&(i=t.slice(n,i),d[u]?d[u]+=i:d[++u]=i),(r=r[0])===(l=l[0])?d[u]?d[u]+=l:d[++u]=l:(d[++u]=null,m.push({i:u,x:Fo(r,l)})),n=Ap.lastIndex;return n<t.length&&(i=t.slice(n),d[u]?d[u]+=i:d[++u]=i),d.length<2?m[0]?WS(m[0].x):VS(t):(t=m.length,function(y){for(var p=0,v;p<t;++p)d[(v=m[p]).i]=v.x(y);return d.join("")})}var Yv=180/Math.PI,Op={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Qv(e,t,n,r,l,i){var u,d,m;return(u=Math.sqrt(e*e+t*t))&&(e/=u,t/=u),(m=e*n+t*r)&&(n-=e*m,r-=t*m),(d=Math.sqrt(n*n+r*r))&&(n/=d,r/=d,m/=d),e*r<t*n&&(e=-e,t=-t,m=-m,u=-u),{translateX:l,translateY:i,rotate:Math.atan2(t,e)*Yv,skewX:Math.atan(m)*Yv,scaleX:u,scaleY:d}}var Gm;function YS(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Op:Qv(t.a,t.b,t.c,t.d,t.e,t.f)}function QS(e){return e==null||(Gm||(Gm=document.createElementNS("http://www.w3.org/2000/svg","g")),Gm.setAttribute("transform",e),!(e=Gm.transform.baseVal.consolidate()))?Op:(e=e.matrix,Qv(e.a,e.b,e.c,e.d,e.e,e.f))}function Gv(e,t,n,r){function l(y){return y.length?y.pop()+" ":""}function i(y,p,v,_,x,j){if(y!==v||p!==_){var S=x.push("translate(",null,t,null,n);j.push({i:S-4,x:Fo(y,v)},{i:S-2,x:Fo(p,_)})}else(v||_)&&x.push("translate("+v+t+_+n)}function u(y,p,v,_){y!==p?(y-p>180?p+=360:p-y>180&&(y+=360),_.push({i:v.push(l(v)+"rotate(",null,r)-2,x:Fo(y,p)})):p&&v.push(l(v)+"rotate("+p+r)}function d(y,p,v,_){y!==p?_.push({i:v.push(l(v)+"skewX(",null,r)-2,x:Fo(y,p)}):p&&v.push(l(v)+"skewX("+p+r)}function m(y,p,v,_,x,j){if(y!==v||p!==_){var S=x.push(l(x)+"scale(",null,",",null,")");j.push({i:S-4,x:Fo(y,v)},{i:S-2,x:Fo(p,_)})}else(v!==1||_!==1)&&x.push(l(x)+"scale("+v+","+_+")")}return function(y,p){var v=[],_=[];return y=e(y),p=e(p),i(y.translateX,y.translateY,p.translateX,p.translateY,v,_),u(y.rotate,p.rotate,v,_),d(y.skewX,p.skewX,v,_),m(y.scaleX,y.scaleY,p.scaleX,p.scaleY,v,_),y=p=null,function(x){for(var j=-1,S=_.length,k;++j<S;)v[(k=_[j]).i]=k.x(x);return v.join("")}}}var GS=Gv(YS,"px, ","px)","deg)"),XS=Gv(QS,", ",")",")"),JS=1e-12;function Xv(e){return((e=Math.exp(e))+1/e)/2}function ZS(e){return((e=Math.exp(e))-1/e)/2}function eC(e){return((e=Math.exp(2*e))-1)/(e+1)}const tC=function e(t,n,r){function l(i,u){var d=i[0],m=i[1],y=i[2],p=u[0],v=u[1],_=u[2],x=p-d,j=v-m,S=x*x+j*j,k,M;if(S<JS)M=Math.log(_/y)/t,k=function(D){return[d+D*x,m+D*j,y*Math.exp(t*D*M)]};else{var P=Math.sqrt(S),T=(_*_-y*y+r*S)/(2*y*n*P),w=(_*_-y*y-r*S)/(2*_*n*P),A=Math.log(Math.sqrt(T*T+1)-T),E=Math.log(Math.sqrt(w*w+1)-w);M=(E-A)/t,k=function(D){var $=D*M,F=Xv(A),R=y/(n*P)*(F*eC(t*$+A)-ZS(A));return[d+R*x,m+R*j,y*F/Xv(t*$+A)]}}return k.duration=M*1e3*t/Math.SQRT2,k}return l.rho=function(i){var u=Math.max(.001,+i),d=u*u,m=d*d;return e(u,d,m)},l}(Math.SQRT2,2,4);var Zi=0,Iu=0,Bu=0,Jv=1e3,Xm,Uu,Jm=0,Bl=0,Zm=0,qu=typeof performance=="object"&&performance.now?performance:Date,Zv=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Pp(){return Bl||(Zv(nC),Bl=qu.now()+Zm)}function nC(){Bl=0}function ef(){this._call=this._time=this._next=null}ef.prototype=ey.prototype={constructor:ef,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Pp():+n)+(t==null?0:+t),!this._next&&Uu!==this&&(Uu?Uu._next=this:Xm=this,Uu=this),this._call=e,this._time=n,Tp()},stop:function(){this._call&&(this._call=null,this._time=1/0,Tp())}};function ey(e,t,n){var r=new ef;return r.restart(e,t,n),r}function sC(){Pp(),++Zi;for(var e=Xm,t;e;)(t=Bl-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Zi}function ty(){Bl=(Jm=qu.now())+Zm,Zi=Iu=0;try{sC()}finally{Zi=0,aC(),Bl=0}}function rC(){var e=qu.now(),t=e-Jm;t>Jv&&(Zm-=t,Jm=e)}function aC(){for(var e,t=Xm,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Xm=n);Uu=e,Tp(r)}function Tp(e){if(!Zi){Iu&&(Iu=clearTimeout(Iu));var t=e-Bl;t>24?(e<1/0&&(Iu=setTimeout(ty,e-qu.now()-Zm)),Bu&&(Bu=clearInterval(Bu))):(Bu||(Jm=qu.now(),Bu=setInterval(rC,Jv)),Zi=1,Zv(ty))}}function ny(e,t,n){var r=new ef;return t=t==null?0:+t,r.restart(l=>{r.stop(),e(l+t)},t,n),r}var oC=Bm("start","end","cancel","interrupt"),lC=[],sy=0,ry=1,$p=2,tf=3,ay=4,Dp=5,nf=6;function sf(e,t,n,r,l,i){var u=e.__transition;if(!u)e.__transition={};else if(n in u)return;iC(e,n,{name:t,index:r,group:l,on:oC,tween:lC,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:sy})}function Lp(e,t){var n=Jr(e,t);if(n.state>sy)throw new Error("too late; already scheduled");return n}function Ea(e,t){var n=Jr(e,t);if(n.state>tf)throw new Error("too late; already running");return n}function Jr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function iC(e,t,n){var r=e.__transition,l;r[t]=n,n.timer=ey(i,0,n.time);function i(y){n.state=ry,n.timer.restart(u,n.delay,n.time),n.delay<=y&&u(y-n.delay)}function u(y){var p,v,_,x;if(n.state!==ry)return m();for(p in r)if(x=r[p],x.name===n.name){if(x.state===tf)return ny(u);x.state===ay?(x.state=nf,x.timer.stop(),x.on.call("interrupt",e,e.__data__,x.index,x.group),delete r[p]):+p<t&&(x.state=nf,x.timer.stop(),x.on.call("cancel",e,e.__data__,x.index,x.group),delete r[p])}if(ny(function(){n.state===tf&&(n.state=ay,n.timer.restart(d,n.delay,n.time),d(y))}),n.state=$p,n.on.call("start",e,e.__data__,n.index,n.group),n.state===$p){for(n.state=tf,l=new Array(_=n.tween.length),p=0,v=-1;p<_;++p)(x=n.tween[p].value.call(e,e.__data__,n.index,n.group))&&(l[++v]=x);l.length=v+1}}function d(y){for(var p=y<n.duration?n.ease.call(null,y/n.duration):(n.timer.restart(m),n.state=Dp,1),v=-1,_=l.length;++v<_;)l[v].call(e,p);n.state===Dp&&(n.on.call("end",e,e.__data__,n.index,n.group),m())}function m(){n.state=nf,n.timer.stop(),delete r[t];for(var y in r)return;delete e.__transition}}function rf(e,t){var n=e.__transition,r,l,i=!0,u;if(n){t=t==null?null:t+"";for(u in n){if((r=n[u]).name!==t){i=!1;continue}l=r.state>$p&&r.state<Dp,r.state=nf,r.timer.stop(),r.on.call(l?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[u]}i&&delete e.__transition}}function cC(e){return this.each(function(){rf(this,e)})}function uC(e,t){var n,r;return function(){var l=Ea(this,e),i=l.tween;if(i!==n){r=n=i;for(var u=0,d=r.length;u<d;++u)if(r[u].name===t){r=r.slice(),r.splice(u,1);break}}l.tween=r}}function dC(e,t,n){var r,l;if(typeof n!="function")throw new Error;return function(){var i=Ea(this,e),u=i.tween;if(u!==r){l=(r=u).slice();for(var d={name:t,value:n},m=0,y=l.length;m<y;++m)if(l[m].name===t){l[m]=d;break}m===y&&l.push(d)}i.tween=l}}function mC(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Jr(this.node(),n).tween,l=0,i=r.length,u;l<i;++l)if((u=r[l]).name===e)return u.value;return null}return this.each((t==null?uC:dC)(n,e,t))}function zp(e,t,n){var r=e._id;return e.each(function(){var l=Ea(this,r);(l.value||(l.value={}))[t]=n.apply(this,arguments)}),function(l){return Jr(l,r).value[t]}}function oy(e,t){var n;return(typeof t=="number"?Fo:t instanceof Fu?Kv:(n=Fu(t))?(t=n,Kv):KS)(e,t)}function fC(e){return function(){this.removeAttribute(e)}}function hC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function pC(e,t,n){var r,l=n+"",i;return function(){var u=this.getAttribute(e);return u===l?null:u===r?i:i=t(r=u,n)}}function gC(e,t,n){var r,l=n+"",i;return function(){var u=this.getAttributeNS(e.space,e.local);return u===l?null:u===r?i:i=t(r=u,n)}}function _C(e,t,n){var r,l,i;return function(){var u,d=n(this),m;return d==null?void this.removeAttribute(e):(u=this.getAttribute(e),m=d+"",u===m?null:u===r&&m===l?i:(l=m,i=t(r=u,d)))}}function vC(e,t,n){var r,l,i;return function(){var u,d=n(this),m;return d==null?void this.removeAttributeNS(e.space,e.local):(u=this.getAttributeNS(e.space,e.local),m=d+"",u===m?null:u===r&&m===l?i:(l=m,i=t(r=u,d)))}}function yC(e,t){var n=qm(e),r=n==="transform"?XS:oy;return this.attrTween(e,typeof t=="function"?(n.local?vC:_C)(n,r,zp(this,"attr."+e,t)):t==null?(n.local?hC:fC)(n):(n.local?gC:pC)(n,r,t))}function bC(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function xC(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function wC(e,t){var n,r;function l(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&xC(e,i)),n}return l._value=t,l}function jC(e,t){var n,r;function l(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&bC(e,i)),n}return l._value=t,l}function NC(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=qm(e);return this.tween(n,(r.local?wC:jC)(r,t))}function SC(e,t){return function(){Lp(this,e).delay=+t.apply(this,arguments)}}function CC(e,t){return t=+t,function(){Lp(this,e).delay=t}}function EC(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?SC:CC)(t,e)):Jr(this.node(),t).delay}function kC(e,t){return function(){Ea(this,e).duration=+t.apply(this,arguments)}}function MC(e,t){return t=+t,function(){Ea(this,e).duration=t}}function AC(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?kC:MC)(t,e)):Jr(this.node(),t).duration}function OC(e,t){if(typeof t!="function")throw new Error;return function(){Ea(this,e).ease=t}}function PC(e){var t=this._id;return arguments.length?this.each(OC(t,e)):Jr(this.node(),t).ease}function TC(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ea(this,e).ease=n}}function $C(e){if(typeof e!="function")throw new Error;return this.each(TC(this._id,e))}function DC(e){typeof e!="function"&&(e=jv(e));for(var t=this._groups,n=t.length,r=new Array(n),l=0;l<n;++l)for(var i=t[l],u=i.length,d=r[l]=[],m,y=0;y<u;++y)(m=i[y])&&e.call(m,m.__data__,y,i)&&d.push(m);return new Ja(r,this._parents,this._name,this._id)}function LC(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,l=n.length,i=Math.min(r,l),u=new Array(r),d=0;d<i;++d)for(var m=t[d],y=n[d],p=m.length,v=u[d]=new Array(p),_,x=0;x<p;++x)(_=m[x]||y[x])&&(v[x]=_);for(;d<r;++d)u[d]=t[d];return new Ja(u,this._parents,this._name,this._id)}function zC(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function RC(e,t,n){var r,l,i=zC(t)?Lp:Ea;return function(){var u=i(this,e),d=u.on;d!==r&&(l=(r=d).copy()).on(t,n),u.on=l}}function FC(e,t){var n=this._id;return arguments.length<2?Jr(this.node(),n).on.on(e):this.each(RC(n,e,t))}function IC(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function BC(){return this.on("end.remove",IC(this._id))}function UC(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wp(e));for(var r=this._groups,l=r.length,i=new Array(l),u=0;u<l;++u)for(var d=r[u],m=d.length,y=i[u]=new Array(m),p,v,_=0;_<m;++_)(p=d[_])&&(v=e.call(p,p.__data__,_,d))&&("__data__"in p&&(v.__data__=p.__data__),y[_]=v,sf(y[_],t,n,_,y,Jr(p,n)));return new Ja(i,this._parents,t,n)}function qC(e){var t=this._name,n=this._id;typeof e!="function"&&(e=wv(e));for(var r=this._groups,l=r.length,i=[],u=[],d=0;d<l;++d)for(var m=r[d],y=m.length,p,v=0;v<y;++v)if(p=m[v]){for(var _=e.call(p,p.__data__,v,m),x,j=Jr(p,n),S=0,k=_.length;S<k;++S)(x=_[S])&&sf(x,t,n,S,_,j);i.push(_),u.push(p)}return new Ja(i,u,t,n)}var HC=$u.prototype.constructor;function VC(){return new HC(this._groups,this._parents)}function WC(e,t){var n,r,l;return function(){var i=Gi(this,e),u=(this.style.removeProperty(e),Gi(this,e));return i===u?null:i===n&&u===r?l:l=t(n=i,r=u)}}function ly(e){return function(){this.style.removeProperty(e)}}function KC(e,t,n){var r,l=n+"",i;return function(){var u=Gi(this,e);return u===l?null:u===r?i:i=t(r=u,n)}}function YC(e,t,n){var r,l,i;return function(){var u=Gi(this,e),d=n(this),m=d+"";return d==null&&(m=d=(this.style.removeProperty(e),Gi(this,e))),u===m?null:u===r&&m===l?i:(l=m,i=t(r=u,d))}}function QC(e,t){var n,r,l,i="style."+t,u="end."+i,d;return function(){var m=Ea(this,e),y=m.on,p=m.value[i]==null?d||(d=ly(t)):void 0;(y!==n||l!==p)&&(r=(n=y).copy()).on(u,l=p),m.on=r}}function GC(e,t,n){var r=(e+="")=="transform"?GS:oy;return t==null?this.styleTween(e,WC(e,r)).on("end.style."+e,ly(e)):typeof t=="function"?this.styleTween(e,YC(e,r,zp(this,"style."+e,t))).each(QC(this._id,e)):this.styleTween(e,KC(e,r,t),n).on("end.style."+e,null)}function XC(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function JC(e,t,n){var r,l;function i(){var u=t.apply(this,arguments);return u!==l&&(r=(l=u)&&XC(e,u,n)),r}return i._value=t,i}function ZC(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,JC(e,t,n??""))}function eE(e){return function(){this.textContent=e}}function tE(e){return function(){var t=e(this);this.textContent=t??""}}function nE(e){return this.tween("text",typeof e=="function"?tE(zp(this,"text",e)):eE(e==null?"":e+""))}function sE(e){return function(t){this.textContent=e.call(this,t)}}function rE(e){var t,n;function r(){var l=e.apply(this,arguments);return l!==n&&(t=(n=l)&&sE(l)),t}return r._value=e,r}function aE(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,rE(e))}function oE(){for(var e=this._name,t=this._id,n=iy(),r=this._groups,l=r.length,i=0;i<l;++i)for(var u=r[i],d=u.length,m,y=0;y<d;++y)if(m=u[y]){var p=Jr(m,t);sf(m,e,n,y,u,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Ja(r,this._parents,e,n)}function lE(){var e,t,n=this,r=n._id,l=n.size();return new Promise(function(i,u){var d={value:u},m={value:function(){--l===0&&i()}};n.each(function(){var y=Ea(this,r),p=y.on;p!==e&&(t=(e=p).copy(),t._.cancel.push(d),t._.interrupt.push(d),t._.end.push(m)),y.on=t}),l===0&&i()})}var iE=0;function Ja(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function iy(){return++iE}var Za=$u.prototype;Ja.prototype={constructor:Ja,select:UC,selectAll:qC,selectChild:Za.selectChild,selectChildren:Za.selectChildren,filter:DC,merge:LC,selection:VC,transition:oE,call:Za.call,nodes:Za.nodes,node:Za.node,size:Za.size,empty:Za.empty,each:Za.each,on:FC,attr:yC,attrTween:NC,style:GC,styleTween:ZC,text:nE,textTween:aE,remove:BC,tween:mC,delay:EC,duration:AC,ease:PC,easeVarying:$C,end:lE,[Symbol.iterator]:Za[Symbol.iterator]};function cE(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var uE={time:null,delay:0,duration:250,ease:cE};function dE(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function mE(e){var t,n;e instanceof Ja?(t=e._id,e=e._name):(t=iy(),(n=uE).time=Pp(),e=e==null?null:e+"");for(var r=this._groups,l=r.length,i=0;i<l;++i)for(var u=r[i],d=u.length,m,y=0;y<d;++y)(m=u[y])&&sf(m,e,t,y,u,n||dE(m,t));return new Ja(r,this._parents,e,t)}$u.prototype.interrupt=cC,$u.prototype.transition=mE;const af=e=>()=>e;function fE(e,{sourceEvent:t,target:n,transform:r,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:l}})}function eo(e,t,n){this.k=e,this.x=t,this.y=n}eo.prototype={constructor:eo,scale:function(e){return e===1?this:new eo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new eo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ul=new eo(1,0,0);eo.prototype;function Rp(e){e.stopImmediatePropagation()}function Hu(e){e.preventDefault(),e.stopImmediatePropagation()}function hE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function pE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function cy(){return this.__zoom||Ul}function gE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function _E(){return navigator.maxTouchPoints||"ontouchstart"in this}function vE(e,t,n){var r=e.invertX(t[0][0])-n[0][0],l=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],u=e.invertY(t[1][1])-n[1][1];return e.translate(l>r?(r+l)/2:Math.min(0,r)||Math.max(0,l),u>i?(i+u)/2:Math.min(0,i)||Math.max(0,u))}function yE(){var e=hE,t=pE,n=vE,r=gE,l=_E,i=[0,1/0],u=[[-1/0,-1/0],[1/0,1/0]],d=250,m=tC,y=Bm("start","zoom","end"),p,v,_,x=500,j=150,S=0,k=10;function M(z){z.property("__zoom",cy).on("wheel.zoom",$,{passive:!1}).on("mousedown.zoom",F).on("dblclick.zoom",R).filter(l).on("touchstart.zoom",B).on("touchmove.zoom",ee).on("touchend.zoom touchcancel.zoom",le).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}M.transform=function(z,G,W,H){var V=z.selection?z.selection():z;V.property("__zoom",cy),z!==V?A(z,G,W,H):V.interrupt().each(function(){E(this,arguments).event(H).start().zoom(null,typeof G=="function"?G.apply(this,arguments):G).end()})},M.scaleBy=function(z,G,W,H){M.scaleTo(z,function(){var V=this.__zoom.k,ne=typeof G=="function"?G.apply(this,arguments):G;return V*ne},W,H)},M.scaleTo=function(z,G,W,H){M.transform(z,function(){var V=t.apply(this,arguments),ne=this.__zoom,Q=W==null?w(V):typeof W=="function"?W.apply(this,arguments):W,K=ne.invert(Q),J=typeof G=="function"?G.apply(this,arguments):G;return n(T(P(ne,J),Q,K),V,u)},W,H)},M.translateBy=function(z,G,W,H){M.transform(z,function(){return n(this.__zoom.translate(typeof G=="function"?G.apply(this,arguments):G,typeof W=="function"?W.apply(this,arguments):W),t.apply(this,arguments),u)},null,H)},M.translateTo=function(z,G,W,H,V){M.transform(z,function(){var ne=t.apply(this,arguments),Q=this.__zoom,K=H==null?w(ne):typeof H=="function"?H.apply(this,arguments):H;return n(Ul.translate(K[0],K[1]).scale(Q.k).translate(typeof G=="function"?-G.apply(this,arguments):-G,typeof W=="function"?-W.apply(this,arguments):-W),ne,u)},H,V)};function P(z,G){return G=Math.max(i[0],Math.min(i[1],G)),G===z.k?z:new eo(G,z.x,z.y)}function T(z,G,W){var H=G[0]-W[0]*z.k,V=G[1]-W[1]*z.k;return H===z.x&&V===z.y?z:new eo(z.k,H,V)}function w(z){return[(+z[0][0]+ +z[1][0])/2,(+z[0][1]+ +z[1][1])/2]}function A(z,G,W,H){z.on("start.zoom",function(){E(this,arguments).event(H).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(H).end()}).tween("zoom",function(){var V=this,ne=arguments,Q=E(V,ne).event(H),K=t.apply(V,ne),J=W==null?w(K):typeof W=="function"?W.apply(V,ne):W,te=Math.max(K[1][0]-K[0][0],K[1][1]-K[0][1]),Y=V.__zoom,U=typeof G=="function"?G.apply(V,ne):G,Z=m(Y.invert(J).concat(te/Y.k),U.invert(J).concat(te/U.k));return function(ie){if(ie===1)ie=U;else{var re=Z(ie),pe=te/re[2];ie=new eo(pe,J[0]-re[0]*pe,J[1]-re[1]*pe)}Q.zoom(null,ie)}})}function E(z,G,W){return!W&&z.__zooming||new D(z,G)}function D(z,G){this.that=z,this.args=G,this.active=0,this.sourceEvent=null,this.extent=t.apply(z,G),this.taps=0}D.prototype={event:function(z){return z&&(this.sourceEvent=z),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(z,G){return this.mouse&&z!=="mouse"&&(this.mouse[1]=G.invert(this.mouse[0])),this.touch0&&z!=="touch"&&(this.touch0[1]=G.invert(this.touch0[0])),this.touch1&&z!=="touch"&&(this.touch1[1]=G.invert(this.touch1[0])),this.that.__zoom=G,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(z){var G=Gr(this.that).datum();y.call(z,this.that,new fE(z,{sourceEvent:this.sourceEvent,target:M,transform:this.that.__zoom,dispatch:y}),G)}};function $(z,...G){if(!e.apply(this,arguments))return;var W=E(this,G).event(z),H=this.__zoom,V=Math.max(i[0],Math.min(i[1],H.k*Math.pow(2,r.apply(this,arguments)))),ne=Sa(z);if(W.wheel)(W.mouse[0][0]!==ne[0]||W.mouse[0][1]!==ne[1])&&(W.mouse[1]=H.invert(W.mouse[0]=ne)),clearTimeout(W.wheel);else{if(H.k===V)return;W.mouse=[ne,H.invert(ne)],rf(this),W.start()}Hu(z),W.wheel=setTimeout(Q,j),W.zoom("mouse",n(T(P(H,V),W.mouse[0],W.mouse[1]),W.extent,u));function Q(){W.wheel=null,W.end()}}function F(z,...G){if(_||!e.apply(this,arguments))return;var W=z.currentTarget,H=E(this,G,!0).event(z),V=Gr(z.view).on("mousemove.zoom",J,!0).on("mouseup.zoom",te,!0),ne=Sa(z,W),Q=z.clientX,K=z.clientY;Tv(z.view),Rp(z),H.mouse=[ne,this.__zoom.invert(ne)],rf(this),H.start();function J(Y){if(Hu(Y),!H.moved){var U=Y.clientX-Q,Z=Y.clientY-K;H.moved=U*U+Z*Z>S}H.event(Y).zoom("mouse",n(T(H.that.__zoom,H.mouse[0]=Sa(Y,W),H.mouse[1]),H.extent,u))}function te(Y){V.on("mousemove.zoom mouseup.zoom",null),$v(Y.view,H.moved),Hu(Y),H.event(Y).end()}}function R(z,...G){if(e.apply(this,arguments)){var W=this.__zoom,H=Sa(z.changedTouches?z.changedTouches[0]:z,this),V=W.invert(H),ne=W.k*(z.shiftKey?.5:2),Q=n(T(P(W,ne),H,V),t.apply(this,G),u);Hu(z),d>0?Gr(this).transition().duration(d).call(A,Q,H,z):Gr(this).call(M.transform,Q,H,z)}}function B(z,...G){if(e.apply(this,arguments)){var W=z.touches,H=W.length,V=E(this,G,z.changedTouches.length===H).event(z),ne,Q,K,J;for(Rp(z),Q=0;Q<H;++Q)K=W[Q],J=Sa(K,this),J=[J,this.__zoom.invert(J),K.identifier],V.touch0?!V.touch1&&V.touch0[2]!==J[2]&&(V.touch1=J,V.taps=0):(V.touch0=J,ne=!0,V.taps=1+!!p);p&&(p=clearTimeout(p)),ne&&(V.taps<2&&(v=J[0],p=setTimeout(function(){p=null},x)),rf(this),V.start())}}function ee(z,...G){if(this.__zooming){var W=E(this,G).event(z),H=z.changedTouches,V=H.length,ne,Q,K,J;for(Hu(z),ne=0;ne<V;++ne)Q=H[ne],K=Sa(Q,this),W.touch0&&W.touch0[2]===Q.identifier?W.touch0[0]=K:W.touch1&&W.touch1[2]===Q.identifier&&(W.touch1[0]=K);if(Q=W.that.__zoom,W.touch1){var te=W.touch0[0],Y=W.touch0[1],U=W.touch1[0],Z=W.touch1[1],ie=(ie=U[0]-te[0])*ie+(ie=U[1]-te[1])*ie,re=(re=Z[0]-Y[0])*re+(re=Z[1]-Y[1])*re;Q=P(Q,Math.sqrt(ie/re)),K=[(te[0]+U[0])/2,(te[1]+U[1])/2],J=[(Y[0]+Z[0])/2,(Y[1]+Z[1])/2]}else if(W.touch0)K=W.touch0[0],J=W.touch0[1];else return;W.zoom("touch",n(T(Q,K,J),W.extent,u))}}function le(z,...G){if(this.__zooming){var W=E(this,G).event(z),H=z.changedTouches,V=H.length,ne,Q;for(Rp(z),_&&clearTimeout(_),_=setTimeout(function(){_=null},x),ne=0;ne<V;++ne)Q=H[ne],W.touch0&&W.touch0[2]===Q.identifier?delete W.touch0:W.touch1&&W.touch1[2]===Q.identifier&&delete W.touch1;if(W.touch1&&!W.touch0&&(W.touch0=W.touch1,delete W.touch1),W.touch0)W.touch0[1]=this.__zoom.invert(W.touch0[0]);else if(W.end(),W.taps===2&&(Q=Sa(Q,this),Math.hypot(v[0]-Q[0],v[1]-Q[1])<k)){var K=Gr(this).on("dblclick.zoom");K&&K.apply(this,arguments)}}}return M.wheelDelta=function(z){return arguments.length?(r=typeof z=="function"?z:af(+z),M):r},M.filter=function(z){return arguments.length?(e=typeof z=="function"?z:af(!!z),M):e},M.touchable=function(z){return arguments.length?(l=typeof z=="function"?z:af(!!z),M):l},M.extent=function(z){return arguments.length?(t=typeof z=="function"?z:af([[+z[0][0],+z[0][1]],[+z[1][0],+z[1][1]]]),M):t},M.scaleExtent=function(z){return arguments.length?(i[0]=+z[0],i[1]=+z[1],M):[i[0],i[1]]},M.translateExtent=function(z){return arguments.length?(u[0][0]=+z[0][0],u[1][0]=+z[1][0],u[0][1]=+z[0][1],u[1][1]=+z[1][1],M):[[u[0][0],u[0][1]],[u[1][0],u[1][1]]]},M.constrain=function(z){return arguments.length?(n=z,M):n},M.duration=function(z){return arguments.length?(d=+z,M):d},M.interpolate=function(z){return arguments.length?(m=z,M):m},M.on=function(){var z=y.on.apply(y,arguments);return z===y?M:z},M.clickDistance=function(z){return arguments.length?(S=(z=+z)*z,M):Math.sqrt(S)},M.tapDistance=function(z){return arguments.length?(k=+z,M):k},M}function Qt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fp(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uy(e,t){if(e){if(typeof e=="string")return Fp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fp(e,t)}}function bE(e){if(Array.isArray(e))return e}function xE(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r=[],l=!0,i=!1,u,d;try{for(n=n.call(e);!(l=(u=n.next()).done)&&(r.push(u.value),!(t&&r.length===t));l=!0);}catch(m){i=!0,d=m}finally{try{!l&&n.return!=null&&n.return()}finally{if(i)throw d}}return r}}function wE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function It(e,t){return bE(e)||xE(e,t)||uy(e,t)||wE()}var ql;(function(e){e.Strict="strict",e.Loose="loose"})(ql||(ql={}));var ec;(function(e){e.Lines="lines",e.Dots="dots"})(ec||(ec={}));var tc;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(tc||(tc={}));var Io;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Io||(Io={}));var of;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(of||(of={}));var Je;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Je||(Je={}));var Ip=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},nc=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),r)},dy=function(t,n){return{x:nc(t.x,n[0][0],n[1][0]),y:nc(t.y,n[0][1],n[1][1])}},my=function(t){var n,r;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((r=window)===null||r===void 0?void 0:r.document)},jE=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},lf=function(t){var n=t.x,r=t.y,l=t.width,i=t.height;return{x:n,y:r,x2:n+l,y2:r+i}},NE=function(t){var n=t.x,r=t.y,l=t.x2,i=t.y2;return{x:n,y:r,width:l-n,height:i-r}},fy=function(t){return!isNaN(t)&&isFinite(t)},hs=Symbol("internals");function hy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Vu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?hy(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):hy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function py(e,t){var n=e.find(function(y){return y.id===t.parentNode});if(n){var r=t.position.x+t.width-n.width,l=t.position.y+t.height-n.height;if(r>0||l>0||t.position.x<0||t.position.y<0){var i,u;if(n.style=Vu({},n.style)||{},n.style.width=(i=n.style.width)!==null&&i!==void 0?i:n.width,n.style.height=(u=n.style.height)!==null&&u!==void 0?u:n.height,r>0&&(n.style.width+=r),l>0&&(n.style.height+=l),t.position.x<0){var d=Math.abs(t.position.x);n.position.x=n.position.x-d,n.style.width+=d,t.position.x=0}if(t.position.y<0){var m=Math.abs(t.position.y);n.position.y=n.position.y-m,n.style.height+=m,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function gy(e,t){if(e.some(function(r){return r.type==="reset"}))return e.filter(function(r){return r.type==="reset"}).map(function(r){return r.item});var n=e.filter(function(r){return r.type==="add"}).map(function(r){return r.item});return t.reduce(function(r,l){var i=e.find(function(m){return m.id===l.id});if(i)switch(i.type){case"select":return r.push(Vu(Vu({},l),{},{selected:i.selected})),r;case"position":{var u=Vu({},l);return typeof i.position<"u"&&(u.position=i.position),typeof i.positionAbsolute<"u"&&(u.positionAbsolute=i.positionAbsolute),typeof i.dragging<"u"&&(u.dragging=i.dragging),u.expandParent&&py(r,u),r.push(u),r}case"dimensions":{var d=Vu({},l);return typeof i.dimensions<"u"&&(d.width=i.dimensions.width,d.height=i.dimensions.height),d.expandParent&&py(r,d),r.push(d),r}case"remove":return r}return r.push(l),r},n)}function _y(e,t){return gy(e,t)}function SE(e,t){return gy(e,t)}var Bo=function(t,n){return{id:t,type:"select",selected:n}};function sc(e,t){return e.reduce(function(n,r){var l=t.includes(r.id);return!r.selected&&l?(r.selected=!0,n.push(Bo(r.id,!0))):r.selected&&!l&&(r.selected=!1,n.push(Bo(r.id,!1))),n},[])}function vy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function yy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vy(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var by=function(t,n,r){var l=n.querySelectorAll(t);if(!l||!l.length)return null;var i=Array.from(l),u=n.getBoundingClientRect();return i.map(function(d){var m=d.getBoundingClientRect();return yy({id:d.getAttribute("data-handleid"),position:d.getAttribute("data-handlepos"),x:(m.left-u.left)/r,y:(m.top-u.top)/r},Ip(d))})};function Wu(e,t,n){return n===void 0?n:function(r){var l=t().nodeInternals.get(e);n(r,yy({},l))}}function xy(e){var t=e.id,n=e.store,r=n.getState(),l=r.addSelectedNodes,i=r.unselectNodesAndEdges,u=r.multiSelectionActive,d=r.nodeInternals,m=d.get(t);n.setState({nodesSelectionActive:!1}),m.selected?m.selected&&u&&i({nodes:[m]}):l([t])}function wy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Ku(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wy(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var CE=function(t){return"id"in t&&"source"in t&&"target"in t},EE=function(t){var n=t.source,r=t.sourceHandle,l=t.target,i=t.targetHandle;return"reactflow__edge-".concat(n).concat(r||"","-").concat(l).concat(i||"")},Bp=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var r=n?"".concat(n,"__"):"";return"".concat(r).concat(Object.keys(t).sort().map(function(l){return"".concat(l,"=").concat(t[l])}).join("&"))},kE=function(t,n){return n.some(function(r){return r.source===t.source&&r.target===t.target&&(r.sourceHandle===t.sourceHandle||!r.sourceHandle&&!t.sourceHandle)&&(r.targetHandle===t.targetHandle||!r.targetHandle&&!t.targetHandle)})},jy=function(t,n){if(!t.source||!t.target)return n;var r;return CE(t)?r=Ku({},t):r=Ku(Ku({},t),{},{id:EE(t)}),kE(r,n)?n:n.concat(r)},Ny=function(t,n,r,l){var i=t.x,u=t.y,d=It(n,3),m=d[0],y=d[1],p=d[2],v=It(l,2),_=v[0],x=v[1],j={x:(i-m)/p,y:(u-y)/p};return r?{x:_*Math.round(j.x/_),y:x*Math.round(j.y/x)}:j},Up=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(r,l){var i=l.positionAbsolute,u=l.position,d=l.width,m=l.height;return jE(r,lf({x:i?i.x:u.x,y:i?i.y:u.y,width:d||0,height:m||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return NE(n)},Sy=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],l=It(r,3),i=l[0],u=l[1],d=l[2],m=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,y=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,p=lf({x:(n.x-i)/d,y:(n.y-u)/d,width:n.width/d,height:n.height/d}),v=[];return t.forEach(function(_){var x=_.positionAbsolute,j=_.width,S=_.height,k=_.selectable,M=k===void 0?!0:k;if(y&&!M)return!1;var P=lf(Ku(Ku({},x),{},{width:j||0,height:S||0})),T=Math.max(0,Math.min(p.x2,P.x2)-Math.max(p.x,P.x)),w=Math.max(0,Math.min(p.y2,P.y2)-Math.max(p.y,P.y)),A=Math.ceil(T*w),E=typeof j>"u"||typeof S>"u"||j===null||S===null,D=m&&A>0,$=(j||0)*(S||0),F=E||D||A>=$;F&&v.push(_)}),v},Cy=function(t,n){var r=t.map(function(l){return l.id});return n.filter(function(l){return r.includes(l.source)||r.includes(l.target)})},Ey=function(t,n,r,l,i){var u=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,d=n/(t.width*(1+u)),m=r/(t.height*(1+u)),y=Math.min(d,m),p=nc(y,l,i),v=t.x+t.width/2,_=t.y+t.height/2,x=n/2-v*p,j=r/2-_*p;return[x,j,p]},Hl=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function ky(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function rc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ky(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ky(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function My(e,t,n,r){var l,i,u,d,m,y,p,v,_,x,j,S;if(!e.parentNode)return r;var k=t.get(e.parentNode);return My(k,t,n,{x:((l=r.x)!==null&&l!==void 0?l:0)+((i=(u=k.position)===null||u===void 0?void 0:u.x)!==null&&i!==void 0?i:0),y:((d=r.y)!==null&&d!==void 0?d:0)+((m=(y=k.position)===null||y===void 0?void 0:y.y)!==null&&m!==void 0?m:0),z:((p=(v=k[hs])===null||v===void 0?void 0:v.z)!==null&&p!==void 0?p:0)>((_=r.z)!==null&&_!==void 0?_:0)?(x=(j=k[hs])===null||j===void 0?void 0:j.z)!==null&&x!==void 0?x:0:(S=r.z)!==null&&S!==void 0?S:0})}function qp(e,t){var n=new Map,r={};return e.forEach(function(l){var i,u=fy(l.zIndex)?l.zIndex:l.selected?1e3:0,d=t.get(l.id),m=rc(rc({width:d==null?void 0:d.width,height:d==null?void 0:d.height},l),{},{positionAbsolute:{x:l.position.x,y:l.position.y}});l.parentNode&&(m.parentNode=l.parentNode,r[l.parentNode]=!0),Object.defineProperty(m,hs,{enumerable:!1,value:{handleBounds:d==null||(i=d[hs])===null||i===void 0?void 0:i.handleBounds,z:u}}),n.set(l.id,m)}),n.forEach(function(l){if(l.parentNode&&!n.has(l.parentNode))throw new Error("Parent node ".concat(l.parentNode," not found"));if(l.parentNode||r[l.id]){var i,u,d=My(l,n,r,rc(rc({},l.position),{},{z:(i=(u=l[hs])===null||u===void 0?void 0:u.z)!==null&&i!==void 0?i:0})),m=d.x,y=d.y,p=d.z;l.positionAbsolute={x:m,y},l[hs].z=p,r[l.id]&&(l[hs].isParent=!0)}}),n}function Ay(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),r=n.nodeInternals,l=n.width,i=n.height,u=n.minZoom,d=n.maxZoom,m=n.d3Zoom,y=n.d3Selection,p=n.fitViewOnInitDone,v=n.fitViewOnInit;if((t.initial&&!p&&v||!t.initial)&&m&&y){var _=Array.from(r.values()).filter(function($){return t.includeHiddenNodes?$.width&&$.height:!$.hidden}),x=_.every(function($){return $.width&&$.height});if(_.length>0&&x){var j,S,k,M=Up(_),P=Ey(M,l,i,(j=t.minZoom)!==null&&j!==void 0?j:u,(S=t.maxZoom)!==null&&S!==void 0?S:d,(k=t.padding)!==null&&k!==void 0?k:.1),T=It(P,3),w=T[0],A=T[1],E=T[2],D=Ul.translate(w,A).scale(E);return typeof t.duration=="number"&&t.duration>0?m.transform(Hl(y,t.duration),D):m.transform(y,D),!0}}return!1}function ME(e,t){return e.forEach(function(n){var r=t.get(n.id);if(r){var l;t.set(r.id,rc(rc({},r),{},(l={},Qt(l,hs,r[hs]),Qt(l,"selected",n.selected),l)))}}),new Map(t)}function AE(e,t){return t.map(function(n){var r=e.find(function(l){return l.id===n.id});return r&&(n.selected=r.selected),n})}function cf(e){var t=e.changedNodes,n=e.changedEdges,r=e.get,l=e.set,i=r(),u=i.nodeInternals,d=i.edges,m=i.onNodesChange,y=i.onEdgesChange,p=i.hasDefaultNodes,v=i.hasDefaultEdges;t!=null&&t.length&&(p&&l({nodeInternals:ME(t,u)}),m==null||m(t)),n!=null&&n.length&&(v&&l({edges:AE(n,d)}),y==null||y(n))}var Hp=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Oy={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Hp,nodeExtent:Hp,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:ql.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function Py(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function ka(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Py(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Py(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Vp=Bj(),Ty=Vp.Provider,Kn=Vp.useStore,Ns=Vp.useStoreApi,$y=function(){return Ij(function(t,n){return ka(ka({},Oy),{},{setNodes:function(l){t({nodeInternals:qp(l,n().nodeInternals)})},setEdges:function(l){var i=n(),u=i.defaultEdgeOptions,d=u===void 0?{}:u;t({edges:l.map(function(m){return ka(ka({},d),m)})})},setDefaultNodesAndEdges:function(l,i){var u=typeof l<"u",d=typeof i<"u",m=u?qp(l,new Map):new Map,y=d?i:[];t({nodeInternals:m,edges:y,hasDefaultNodes:u,hasDefaultEdges:d})},updateNodeDimensions:function(l){var i=n(),u=i.onNodesChange,d=i.nodeInternals,m=i.fitViewOnInit,y=i.fitViewOnInitDone,p=i.fitViewOnInitOptions,v=i.domNode,_=v==null?void 0:v.querySelector(".react-flow__viewport");if(_){var x=window.getComputedStyle(_),j=new window.DOMMatrixReadOnly(x.transform),S=j.m22,k=l.reduce(function(P,T){var w=d.get(T.id);if(w){var A=Ip(T.nodeElement),E=!!(A.width&&A.height&&(w.width!==A.width||w.height!==A.height||T.forceUpdate));E&&(d.set(w.id,ka(ka({},w),{},Qt({},hs,ka(ka({},w[hs]),{},{handleBounds:{source:by(".source",T.nodeElement,S),target:by(".target",T.nodeElement,S)}})),A)),P.push({id:w.id,type:"dimensions",dimensions:A}))}return P},[]),M=y||m&&!y&&Ay(n,ka({initial:!0},p));t({nodeInternals:new Map(d),fitViewOnInitDone:M}),(k==null?void 0:k.length)>0&&(u==null||u(k))}},updateNodePositions:function(l){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=n(),m=d.onNodesChange,y=d.nodeInternals,p=d.hasDefaultNodes;if(p||m){var v=l.map(function(j){var S={id:j.id,type:"position",dragging:u};return i&&(S.positionAbsolute=j.positionAbsolute,S.position=j.position),S});if(v!=null&&v.length){if(p){var _=_y(v,Array.from(y.values())),x=qp(_,y);t({nodeInternals:x})}m==null||m(v)}}},addSelectedNodes:function(l){var i=n(),u=i.multiSelectionActive,d=i.nodeInternals,m=i.edges,y,p=null;u?y=l.map(function(v){return Bo(v,!0)}):(y=sc(Array.from(d.values()),l),p=sc(m,[])),cf({changedNodes:y,changedEdges:p,get:n,set:t})},addSelectedEdges:function(l){var i=n(),u=i.multiSelectionActive,d=i.edges,m=i.nodeInternals,y,p=null;u?y=l.map(function(v){return Bo(v,!0)}):(y=sc(d,l),p=sc(Array.from(m.values()),[])),cf({changedNodes:p,changedEdges:y,get:n,set:t})},unselectNodesAndEdges:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=l.nodes,u=l.edges,d=n(),m=d.nodeInternals,y=d.edges,p=i||Array.from(m.values()),v=u||y,_=p.map(function(j){return j.selected=!1,Bo(j.id,!1)}),x=v.map(function(j){return Bo(j.id,!1)});cf({changedNodes:_,changedEdges:x,get:n,set:t})},setMinZoom:function(l){var i=n(),u=i.d3Zoom,d=i.maxZoom;u==null||u.scaleExtent([l,d]),t({minZoom:l})},setMaxZoom:function(l){var i=n(),u=i.d3Zoom,d=i.minZoom;u==null||u.scaleExtent([d,l]),t({maxZoom:l})},setTranslateExtent:function(l){var i=n(),u=i.d3Zoom;u==null||u.translateExtent(l),t({translateExtent:l})},resetSelectedElements:function(){var l=n(),i=l.nodeInternals,u=l.edges,d=Array.from(i.values()),m=d.filter(function(p){return p.selected}).map(function(p){return Bo(p.id,!1)}),y=u.filter(function(p){return p.selected}).map(function(p){return Bo(p.id,!1)});cf({changedNodes:m,changedEdges:y,get:n,set:t})},setNodeExtent:function(l){var i=n(),u=i.nodeInternals;u.forEach(function(d){d.positionAbsolute=dy(d.position,l)}),t({nodeExtent:l,nodeInternals:new Map(u)})},reset:function(){return t(ka({},Oy))}})})};function ur(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ur(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function dr(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}function OE(e){if(Array.isArray(e))return Fp(e)}function PE(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Vl(e){return OE(e)||PE(e)||uy(e)||TE()}var $E={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},DE=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},LE=function(){var t=Ns(),n=Kn(DE,dr),r=n.d3Zoom,l=n.d3Selection,i=f.useMemo(function(){return l&&r?{zoomIn:function(d){return r.scaleBy(Hl(l,d==null?void 0:d.duration),1.2)},zoomOut:function(d){return r.scaleBy(Hl(l,d==null?void 0:d.duration),1/1.2)},zoomTo:function(d,m){return r.scaleTo(Hl(l,m==null?void 0:m.duration),d)},getZoom:function(){return t.getState().transform[2]},setViewport:function(d,m){var y,p,v,_=It(t.getState().transform,3),x=_[0],j=_[1],S=_[2],k=Ul.translate((y=d.x)!==null&&y!==void 0?y:x,(p=d.y)!==null&&p!==void 0?p:j).scale((v=d.zoom)!==null&&v!==void 0?v:S);r.transform(Hl(l,m==null?void 0:m.duration),k)},getViewport:function(){var d=It(t.getState().transform,3),m=d[0],y=d[1],p=d[2];return{x:m,y,zoom:p}},fitView:function(d){return Ay(t.getState,d)},setCenter:function(d,m,y){var p=t.getState(),v=p.width,_=p.height,x=p.maxZoom,j=typeof(y==null?void 0:y.zoom)<"u"?y.zoom:x,S=v/2-d*j,k=_/2-m*j,M=Ul.translate(S,k).scale(j);r.transform(Hl(l,y==null?void 0:y.duration),M)},fitBounds:function(d,m){var y,p=t.getState(),v=p.width,_=p.height,x=p.minZoom,j=p.maxZoom,S=Ey(d,v,_,x,j,(y=m==null?void 0:m.padding)!==null&&y!==void 0?y:.1),k=It(S,3),M=k[0],P=k[1],T=k[2],w=Ul.translate(M,P).scale(T);r.transform(Hl(l,m==null?void 0:m.duration),w)},project:function(d){var m=t.getState(),y=m.transform,p=m.snapToGrid,v=m.snapGrid;return Ny(d,y,p,v)},viewportInitialized:!0}:$E},[r,l]);return i};function Dy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function ac(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Dy(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Dy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Wp(){var e=LE(),t=Ns(),n=f.useCallback(function(){var v=t.getState(),_=v.nodeInternals,x=Array.from(_.values());return x.map(function(j){return ac({},j)})},[]),r=f.useCallback(function(v){var _=t.getState(),x=_.nodeInternals;return x.get(v)},[]),l=f.useCallback(function(){var v=t.getState(),_=v.edges,x=_===void 0?[]:_;return x.map(function(j){return ac({},j)})},[]),i=f.useCallback(function(v){var _=t.getState(),x=_.edges,j=x===void 0?[]:x;return j.find(function(S){return S.id===v})},[]),u=f.useCallback(function(v){var _=t.getState(),x=_.nodeInternals,j=_.setNodes,S=_.hasDefaultNodes,k=_.onNodesChange,M=Array.from(x.values()),P=typeof v=="function"?v(M):v;if(S)j(P);else if(k){var T=P.length===0?M.map(function(w){return{type:"remove",id:w.id}}):P.map(function(w){return{item:w,type:"reset"}});k(T)}},[]),d=f.useCallback(function(v){var _=t.getState(),x=_.edges,j=x===void 0?[]:x,S=_.setEdges,k=_.hasDefaultEdges,M=_.onEdgesChange,P=typeof v=="function"?v(j):v;if(k)S(P);else if(M){var T=P.length===0?j.map(function(w){return{type:"remove",id:w.id}}):P.map(function(w){return{item:w,type:"reset"}});M(T)}},[]),m=f.useCallback(function(v){var _=Array.isArray(v)?v:[v],x=t.getState(),j=x.nodeInternals,S=x.setNodes,k=x.hasDefaultNodes,M=x.onNodesChange;if(k){var P=Array.from(j.values()),T=[].concat(P,Vl(_));S(T)}else if(M){var w=_.map(function(A){return{item:A,type:"add"}});M(w)}},[]),y=f.useCallback(function(v){var _=Array.isArray(v)?v:[v],x=t.getState(),j=x.edges,S=j===void 0?[]:j,k=x.setEdges,M=x.hasDefaultEdges,P=x.onEdgesChange;if(M)k([].concat(Vl(S),Vl(_)));else if(P){var T=_.map(function(w){return{item:w,type:"add"}});P(T)}},[]),p=f.useCallback(function(){var v=t.getState(),_=v.nodeInternals,x=v.edges,j=x===void 0?[]:x,S=v.transform,k=Array.from(_.values()),M=It(S,3),P=M[0],T=M[1],w=M[2];return{nodes:k.map(function(A){return ac({},A)}),edges:j.map(function(A){return ac({},A)}),viewport:{x:P,y:T,zoom:w}}},[]);return f.useMemo(function(){return ac(ac({},e),{},{getNodes:n,getNode:r,getEdges:l,getEdge:i,setNodes:u,setEdges:d,addNodes:m,addEdges:y,toObject:p})},[e,n,r,l,i,u,d,m,y,p])}function zE(e,t){if(e==null)return{};var n={},r=Object.keys(e),l,i;for(i=0;i<r.length;i++)l=r[i],!(t.indexOf(l)>=0)&&(n[l]=e[l]);return n}function uf(e,t){if(e==null)return{};var n=zE(e,t),r,l;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(l=0;l<i.length;l++)r=i[l],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function RE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},Ae.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function FE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},Ae.createElement("path",{d:"M0 0h32v4.2H0z"}))}function IE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},Ae.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function BE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Ae.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function UE(){return Ae.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},Ae.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var qE=["children","className"];function Ly(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function HE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ly(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ly(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var df=function(t){var n=t.children,r=t.className,l=uf(t,qE);return Ae.createElement("button",HE({type:"button",className:ur(["react-flow__controls-button",r])},l),n)},VE=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},zy=function(t){var n=t.style,r=t.showZoom,l=r===void 0?!0:r,i=t.showFitView,u=i===void 0?!0:i,d=t.showInteractive,m=d===void 0?!0:d,y=t.fitViewOptions,p=t.onZoomIn,v=t.onZoomOut,_=t.onFitView,x=t.onInteractiveChange,j=t.className,S=t.children,k=Ns(),M=f.useState(!1),P=It(M,2),T=P[0],w=P[1],A=Kn(VE),E=Wp(),D=E.zoomIn,$=E.zoomOut,F=E.fitView;if(f.useEffect(function(){w(!0)},[]),!T)return null;var R=function(){D==null||D(),p==null||p()},B=function(){$==null||$(),v==null||v()},ee=function(){F==null||F(y),_==null||_()},le=function(){k.setState({nodesDraggable:!A,nodesConnectable:!A,elementsSelectable:!A}),x==null||x(!A)};return Ae.createElement("div",{className:ur(["react-flow__controls",j]),style:n},l&&Ae.createElement(Ae.Fragment,null,Ae.createElement(df,{onClick:R,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},Ae.createElement(RE,null)),Ae.createElement(df,{onClick:B,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},Ae.createElement(FE,null))),u&&Ae.createElement(df,{className:"react-flow__controls-fitview",onClick:ee,title:"fit view","aria-label":"fit view"},Ae.createElement(IE,null)),m&&Ae.createElement(df,{className:"react-flow__controls-interactive",onClick:le,title:"toggle interactivity","aria-label":"toggle interactivity"},A?Ae.createElement(UE,null):Ae.createElement(BE,null)),S)};zy.displayName="Controls";var WE=f.memo(zy),KE=function(t,n,r){return Ae.createElement("path",{stroke:r,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},YE=function(t,n){return Ae.createElement("circle",{cx:t,cy:t,r:t,fill:n})},mf;function Ry(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Fy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ry(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ry(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var QE=(mf={},Qt(mf,ec.Dots,"#81818a"),Qt(mf,ec.Lines,"#eee"),mf),GE=function(t){return t.transform},Iy=function(t){var n=t.variant,r=n===void 0?ec.Dots:n,l=t.gap,i=l===void 0?15:l,u=t.size,d=u===void 0?.4:u,m=t.color,y=t.style,p=t.className,v=f.useRef(null),_=f.useState(null),x=It(_,2),j=x[0],S=x[1],k=Kn(GE),M=It(k,3),P=M[0],T=M[1],w=M[2];f.useEffect(function(){var B=document.querySelectorAll(".react-flow__background"),ee=Array.from(B).findIndex(function(le){return le===v.current});S("pattern-".concat(ee))},[]);var A=i*w||1,E=P%A,D=T%A,$=r===ec.Lines,F=m||QE[r],R=$?KE(A,d,F):YE(d*w,F);return Ae.createElement("svg",{className:ur(["react-flow__background","react-flow__container",p]),style:Fy(Fy({},y),{},{width:"100%",height:"100%"}),ref:v},j&&Ae.createElement(Ae.Fragment,null,Ae.createElement("pattern",{id:j,x:E,y:D,width:A,height:A,patternUnits:"userSpaceOnUse"},R),Ae.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(j,")")})))};Iy.displayName="Background";var XE=f.memo(Iy),JE=function(t){return t.updateNodeDimensions};function ZE(){var e=Ns(),t=Kn(JE);return f.useCallback(function(n){var r,l=(r=e.getState().domNode)===null||r===void 0?void 0:r.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));l&&requestAnimationFrame(function(){return t([{id:n,nodeElement:l,forceUpdate:!0}])})},[])}var e1=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function t1(e){var t=e.proOptions,n=e.position,r=n===void 0?"bottom-right":n;if(t!=null&&t.account&&e1.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var l="".concat(r).split("-");return Ae.createElement("div",{className:ur(["react-flow__attribution"].concat(Vl(l))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},Ae.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var n1=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function By(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function s1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?By(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):By(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var r1=function(t){var n=t.x,r=t.y,l=t.label,i=t.labelStyle,u=i===void 0?{}:i,d=t.labelShowBg,m=d===void 0?!0:d,y=t.labelBgStyle,p=y===void 0?{}:y,v=t.labelBgPadding,_=v===void 0?[2,4]:v,x=t.labelBgBorderRadius,j=x===void 0?2:x,S=t.children,k=t.className,M=uf(t,n1),P=f.useRef(null),T=f.useState({x:0,y:0,width:0,height:0}),w=It(T,2),A=w[0],E=w[1],D=ur(["react-flow__edge-textwrapper",k]);return f.useEffect(function(){if(P.current){var $=P.current.getBBox();E({x:$.x,y:$.y,width:$.width,height:$.height})}},[l]),typeof l>"u"||!l?null:Ae.createElement("g",s1({transform:"translate(".concat(n-A.width/2," ").concat(r-A.height/2,")"),className:D},M),m&&Ae.createElement("rect",{width:A.width+2*_[0],x:-_[0],y:-_[1],height:A.height+2*_[1],className:"react-flow__edge-textbg",style:p,rx:j,ry:j}),Ae.createElement("text",{className:"react-flow__edge-text",y:A.height/2,dy:"0.3em",ref:P,style:u},l),S)},a1=f.memo(r1),ff=function(e){var t=e.path,n=e.centerX,r=e.centerY,l=e.label,i=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,m=e.labelBgPadding,y=e.labelBgBorderRadius,p=e.style,v=e.markerEnd,_=e.markerStart,x=l?Ae.createElement(a1,{x:n,y:r,label:l,labelStyle:i,labelShowBg:u,labelBgStyle:d,labelBgPadding:m,labelBgBorderRadius:y}):null;return Ae.createElement(Ae.Fragment,null,Ae.createElement("path",{style:p,d:t,className:"react-flow__edge-path",markerEnd:v,markerStart:_}),x)};function hf(e){var t=e.pos,n=e.x1,r=e.y1,l=e.x2,i=e.y2,u,d;switch(t){case Je.Left:case Je.Right:u=.5*(n+l),d=r;break;case Je.Top:case Je.Bottom:u=n,d=.5*(r+i);break}return[u,d]}function Uy(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,l=r===void 0?Je.Bottom:r,i=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Je.Top:d,y=hf({pos:l,x1:t,y1:n,x2:i,y2:u}),p=It(y,2),v=p[0],_=p[1],x=hf({pos:m,x1:i,y1:u,x2:t,y2:n}),j=It(x,2),S=j[0],k=j[1];return"M".concat(t,",").concat(n," C").concat(v,",").concat(_," ").concat(S,",").concat(k," ").concat(i,",").concat(u)}function o1(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,l=r===void 0?Je.Bottom:r,i=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Je.Top:d,y=hf({pos:l,x1:t,y1:n,x2:i,y2:u}),p=It(y,2),v=p[0],_=p[1],x=hf({pos:m,x1:i,y1:u,x2:t,y2:n}),j=It(x,2),S=j[0],k=j[1],M=t*.125+v*.375+S*.375+i*.125,P=n*.125+_*.375+k*.375+u*.125,T=Math.abs(M-t),w=Math.abs(P-n);return[M,P,T,w]}var qy=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,l=e.targetY,i=e.sourcePosition,u=i===void 0?Je.Bottom:i,d=e.targetPosition,m=d===void 0?Je.Top:d,y=e.label,p=e.labelStyle,v=e.labelShowBg,_=e.labelBgStyle,x=e.labelBgPadding,j=e.labelBgBorderRadius,S=e.style,k=e.markerEnd,M=e.markerStart,P={sourceX:t,sourceY:n,sourcePosition:u,targetX:r,targetY:l,targetPosition:m},T=Uy(P),w=o1(P),A=It(w,2),E=A[0],D=A[1];return Ae.createElement(ff,{path:T,centerX:E,centerY:D,label:y,labelStyle:p,labelShowBg:v,labelBgStyle:_,labelBgPadding:x,labelBgBorderRadius:j,style:S,markerEnd:k,markerStart:M})});function Hy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function l1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Hy(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Vy=[Je.Left,Je.Right],Wy=function(t){var n=t.sourceX,r=t.sourceY,l=t.targetX,i=t.targetY,u=t.sourcePosition,d=u===void 0?Je.Bottom:u,m=t.targetPosition,y=m===void 0?Je.Top:m,p=Vy.includes(d),v=Vy.includes(y),_=p&&!v||v&&!p;if(_){var x=p?Math.abs(l-n):0,j=n>l?n-x:n+x,S=p?0:Math.abs(i-r),k=r<i?r+S:r-S;return[j,k,x,S]}var M=Math.abs(l-n)/2,P=l<n?l+M:l-M,T=Math.abs(i-r)/2,w=i<r?i+T:i-T;return[P,w,M,T]};function Yu(e,t,n){return n===void 0?n:function(r){var l=t().edges.find(function(i){return i.id===e});n(r,l1({},l))}}var Kp=function(t,n,r){return"L ".concat(t,",").concat(n-r,"Q ").concat(t,",").concat(n," ").concat(t+r,",").concat(n)},Yp=function(t,n,r){return"L ".concat(t+r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-r)},Qp=function(t,n,r){return"L ".concat(t,",").concat(n-r,"Q ").concat(t,",").concat(n," ").concat(t-r,",").concat(n)},Gp=function(t,n,r){return"L ".concat(t-r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-r)},Xp=function(t,n,r){return"L ".concat(t+r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+r)},Jp=function(t,n,r){return"L ".concat(t,",").concat(n+r,"Q ").concat(t,",").concat(n," ").concat(t+r,",").concat(n)},Zp=function(t,n,r){return"L ".concat(t,",").concat(n+r,"Q ").concat(t,",").concat(n," ").concat(t-r,",").concat(n)},eg=function(t,n,r){return"L ".concat(t-r,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+r)};function tg(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,l=r===void 0?Je.Bottom:r,i=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Je.Top:d,y=e.borderRadius,p=y===void 0?5:y,v=e.centerX,_=e.centerY,x=Wy({sourceX:t,sourceY:n,targetX:i,targetY:u}),j=It(x,4),S=j[0],k=j[1],M=j[2],P=j[3],T=Math.min(p,Math.abs(i-t)),w=Math.min(p,Math.abs(u-n)),A=Math.min(T,w,M,P),E=[Je.Left,Je.Right],D=typeof v<"u"?v:S,$=typeof _<"u"?_:k,F=null,R=null;return t<=i?(F=n<=u?Kp(t,$,A):Jp(t,$,A),R=n<=u?eg(i,$,A):Gp(i,$,A)):(F=n<u?Qp(t,$,A):Zp(t,$,A),R=n<u?Xp(i,$,A):Yp(i,$,A)),E.includes(l)&&E.includes(m)?t<=i?(F=n<=u?eg(D,n,A):Gp(D,n,A),R=n<=u?Kp(D,u,A):Jp(D,u,A)):(l===Je.Right&&m===Je.Left||l===Je.Left&&m===Je.Right||l===Je.Left&&m===Je.Left)&&(F=n<=u?Xp(D,n,A):Yp(D,n,A),R=n<=u?Qp(D,u,A):Zp(D,u,A)):E.includes(l)&&!E.includes(m)?(t<=i?F=n<=u?eg(i,n,A):Gp(i,n,A):F=n<=u?Xp(i,n,A):Yp(i,n,A),R=""):!E.includes(l)&&E.includes(m)&&(t<=i?F=n<=u?Kp(t,u,A):Jp(t,u,A):F=n<=u?Qp(t,u,A):Zp(t,u,A),R=""),"M ".concat(t,",").concat(n).concat(F).concat(R,"L ").concat(i,",").concat(u)}var ng=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,l=e.targetY,i=e.label,u=e.labelStyle,d=e.labelShowBg,m=e.labelBgStyle,y=e.labelBgPadding,p=e.labelBgBorderRadius,v=e.style,_=e.sourcePosition,x=_===void 0?Je.Bottom:_,j=e.targetPosition,S=j===void 0?Je.Top:j,k=e.markerEnd,M=e.markerStart,P=e.borderRadius,T=P===void 0?5:P,w=Wy({sourceX:t,sourceY:n,targetX:r,targetY:l,sourcePosition:x,targetPosition:S}),A=It(w,2),E=A[0],D=A[1],$=tg({sourceX:t,sourceY:n,sourcePosition:x,targetX:r,targetY:l,targetPosition:S,borderRadius:T});return Ae.createElement(ff,{path:$,centerX:E,centerY:D,label:i,labelStyle:u,labelShowBg:d,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:p,style:v,markerEnd:k,markerStart:M})});function Ky(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Yy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ky(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ky(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Qy=f.memo(function(e){return Ae.createElement(ng,Yy(Yy({},e),{},{borderRadius:0}))}),Gy=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,l=e.targetY,i=e.label,u=e.labelStyle,d=e.labelShowBg,m=e.labelBgStyle,y=e.labelBgPadding,p=e.labelBgBorderRadius,v=e.style,_=e.markerEnd,x=e.markerStart,j=Math.abs(l-n)/2,S=l<n?l+j:l-j,k=Math.abs(r-t)/2,M=r<t?r+k:r-k,P="M ".concat(t,",").concat(n,"L ").concat(r,",").concat(l);return Ae.createElement(ff,{path:P,centerX:M,centerY:S,label:i,labelStyle:u,labelShowBg:d,labelBgStyle:m,labelBgPadding:y,labelBgBorderRadius:p,style:v,markerEnd:_,markerStart:x})});function pf(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function gf(e){var t=e.pos,n=e.x1,r=e.y1,l=e.x2,i=e.y2,u=e.c,d,m;switch(t){case Je.Left:d=n-pf(n-l,u),m=r;break;case Je.Right:d=n+pf(l-n,u),m=r;break;case Je.Top:d=n,m=r-pf(r-i,u);break;case Je.Bottom:d=n,m=r+pf(i-r,u);break}return[d,m]}function Xy(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,l=r===void 0?Je.Bottom:r,i=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Je.Top:d,y=e.curvature,p=y===void 0?.25:y,v=gf({pos:l,x1:t,y1:n,x2:i,y2:u,c:p}),_=It(v,2),x=_[0],j=_[1],S=gf({pos:m,x1:i,y1:u,x2:t,y2:n,c:p}),k=It(S,2),M=k[0],P=k[1];return"M".concat(t,",").concat(n," C").concat(x,",").concat(j," ").concat(M,",").concat(P," ").concat(i,",").concat(u)}function i1(e){var t=e.sourceX,n=e.sourceY,r=e.sourcePosition,l=r===void 0?Je.Bottom:r,i=e.targetX,u=e.targetY,d=e.targetPosition,m=d===void 0?Je.Top:d,y=e.curvature,p=y===void 0?.25:y,v=gf({pos:l,x1:t,y1:n,x2:i,y2:u,c:p}),_=It(v,2),x=_[0],j=_[1],S=gf({pos:m,x1:i,y1:u,x2:t,y2:n,c:p}),k=It(S,2),M=k[0],P=k[1],T=t*.125+x*.375+M*.375+i*.125,w=n*.125+j*.375+P*.375+u*.125,A=Math.abs(T-t),E=Math.abs(w-n);return[T,w,A,E]}var sg=f.memo(function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,l=e.targetY,i=e.sourcePosition,u=i===void 0?Je.Bottom:i,d=e.targetPosition,m=d===void 0?Je.Top:d,y=e.label,p=e.labelStyle,v=e.labelShowBg,_=e.labelBgStyle,x=e.labelBgPadding,j=e.labelBgBorderRadius,S=e.style,k=e.markerEnd,M=e.markerStart,P=e.curvature,T={sourceX:t,sourceY:n,sourcePosition:u,targetX:r,targetY:l,targetPosition:m,curvature:P},w=Xy(T),A=i1(T),E=It(A,2),D=E[0],$=E[1];return Ae.createElement(ff,{path:w,centerX:D,centerY:$,label:y,labelStyle:p,labelShowBg:v,labelBgStyle:_,labelBgPadding:x,labelBgBorderRadius:j,style:S,markerEnd:k,markerStart:M})}),rg=f.createContext(null),c1=rg.Provider;rg.Consumer;function ag(e,t,n,r,l,i,u){var d=u.elementFromPoint(e.clientX,e.clientY),m=(d==null?void 0:d.classList.contains("target"))||!1,y=(d==null?void 0:d.classList.contains("source"))||!1,p={elementBelow:d,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(d&&(m||y)){p.isHoveringHandle=!0;var v=d.getAttribute("data-nodeid"),_=d.getAttribute("data-handleid"),x=n?{source:v,sourceHandle:_,target:r,targetHandle:l}:{source:r,sourceHandle:l,target:v,targetHandle:_};p.connection=x;var j=t===ql.Strict?n&&y||!n&&m:!0;j&&(p.isValid=i(x))}return p}function og(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function Jy(e){var t=e.event,n=e.handleId,r=e.nodeId,l=e.onConnect,i=e.isTarget,u=e.getState,d=e.setState,m=e.isValidConnection,y=e.elementEdgeUpdaterType,p=e.onEdgeUpdateEnd,v=t.target.closest(".react-flow"),_=my(t.target);if(!_)return;var x=_.elementFromPoint(t.clientX,t.clientY),j=x==null?void 0:x.classList.contains("target"),S=x==null?void 0:x.classList.contains("source");if(!v||!j&&!S&&!y)return;var k=u(),M=k.onConnectStart,P=k.connectionMode,T=y||(j?"target":"source"),w=v.getBoundingClientRect(),A;d({connectionPosition:{x:t.clientX-w.left,y:t.clientY-w.top},connectionNodeId:r,connectionHandleId:n,connectionHandleType:T}),M==null||M(t,{nodeId:r,handleId:n,handleType:T});function E($){d({connectionPosition:{x:$.clientX-w.left,y:$.clientY-w.top}});var F=ag($,P,i,r,n,m,_),R=F.connection,B=F.elementBelow,ee=F.isValid,le=F.isHoveringHandle;if(!le)return og(A);R.source!==R.target&&B&&(og(A),A=B,B.classList.add("react-flow__handle-connecting"),B.classList.toggle("react-flow__handle-valid",ee))}function D($){var F=u(),R=F.onConnectStop,B=F.onConnectEnd,ee=ag($,P,i,r,n,m,_),le=ee.connection,z=ee.isValid;R==null||R($),z&&(l==null||l(le)),B==null||B($),y&&p&&p($),og(A),d({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),_.removeEventListener("mousemove",E),_.removeEventListener("mouseup",D)}_.addEventListener("mousemove",E),_.addEventListener("mouseup",D)}var u1=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function Zy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function lg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zy(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zy(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var d1=function(){return!0},m1=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},eb=f.forwardRef(function(e,t){var n=e.type,r=n===void 0?"source":n,l=e.position,i=l===void 0?Je.Top:l,u=e.isValidConnection,d=u===void 0?d1:u,m=e.isConnectable,y=m===void 0?!0:m,p=e.id,v=e.onConnect,_=e.children,x=e.className,j=e.onMouseDown,S=uf(e,u1),k=Ns(),M=f.useContext(rg),P=Kn(m1,dr),T=P.connectionStartHandle,w=P.connectOnClick,A=p||null,E=r==="target",D=function(B){var ee=k.getState(),le=ee.defaultEdgeOptions,z=ee.onConnect,G=ee.hasDefaultEdges,W=lg(lg({},le),B);if(G){var H=k.getState(),V=H.edges;k.setState({edges:jy(W,V)})}z==null||z(W),v==null||v(W)},$=function(B){B.button===0&&Jy({event:B,handleId:A,nodeId:M,onConnect:D,isTarget:E,getState:k.getState,setState:k.setState,isValidConnection:d}),j==null||j(B)},F=function(B){var ee=k.getState(),le=ee.onClickConnectStart,z=ee.onClickConnectStop,G=ee.onClickConnectEnd,W=ee.connectionMode;if(!T){le==null||le(B,{nodeId:M,handleId:A,handleType:r}),k.setState({connectionStartHandle:{nodeId:M,type:r,handleId:A}});return}var H=my(B.target),V=ag(B,W,T.type==="target",T.nodeId,T.handleId||null,d,H),ne=V.connection,Q=V.isValid;z==null||z(B),Q&&D(ne),G==null||G(B),k.setState({connectionStartHandle:null})};return Ae.createElement("div",lg({"data-handleid":A,"data-nodeid":M,"data-handlepos":i,className:ur(["react-flow__handle","react-flow__handle-".concat(i),"nodrag",x,{source:!E,target:E,connectable:y,connecting:(T==null?void 0:T.nodeId)===M&&(T==null?void 0:T.handleId)===A&&(T==null?void 0:T.type)===r}]),onMouseDown:$,onClick:w?F:void 0,ref:t},S),_)});eb.displayName="Handle";var Qu=f.memo(eb),tb=function(t){var n=t.data,r=t.isConnectable,l=t.targetPosition,i=l===void 0?Je.Top:l,u=t.sourcePosition,d=u===void 0?Je.Bottom:u;return Ae.createElement(Ae.Fragment,null,Ae.createElement(Qu,{type:"target",position:i,isConnectable:r}),n==null?void 0:n.label,Ae.createElement(Qu,{type:"source",position:d,isConnectable:r}))};tb.displayName="DefaultNode";var ig=f.memo(tb),nb=function(t){var n=t.data,r=t.isConnectable,l=t.sourcePosition,i=l===void 0?Je.Bottom:l;return Ae.createElement(Ae.Fragment,null,n==null?void 0:n.label,Ae.createElement(Qu,{type:"source",position:i,isConnectable:r}))};nb.displayName="InputNode";var sb=f.memo(nb),rb=function(t){var n=t.data,r=t.isConnectable,l=t.targetPosition,i=l===void 0?Je.Top:l;return Ae.createElement(Ae.Fragment,null,Ae.createElement(Qu,{type:"target",position:i,isConnectable:r}),n==null?void 0:n.label)};rb.displayName="OutputNode";var ab=f.memo(rb),f1=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},h1=function(t,n){var r=t.selectedNodes.map(function(d){return d.id}),l=n.selectedNodes.map(function(d){return d.id}),i=t.selectedEdges.map(function(d){return d.id}),u=n.selectedEdges.map(function(d){return d.id});return dr(r,l)&&dr(i,u)};function p1(e){var t=e.onSelectionChange,n=Kn(f1,h1),r=n.selectedNodes,l=n.selectedEdges;return f.useEffect(function(){t({nodes:r,edges:l})},[r,l]),null}var g1=f.memo(p1),_1=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function Uo(e,t){f.useEffect(function(){typeof e<"u"&&t(e)},[e])}function un(e,t,n){f.useEffect(function(){typeof t<"u"&&n(Qt({},e,t))},[t])}var v1=function(t){var n=t.nodes,r=t.edges,l=t.defaultNodes,i=t.defaultEdges,u=t.onConnect,d=t.onConnectStart,m=t.onConnectStop,y=t.onConnectEnd,p=t.onClickConnectStart,v=t.onClickConnectStop,_=t.onClickConnectEnd,x=t.nodesDraggable,j=t.nodesConnectable,S=t.minZoom,k=t.maxZoom,M=t.nodeExtent,P=t.onNodesChange,T=t.onEdgesChange,w=t.elementsSelectable,A=t.connectionMode,E=t.snapGrid,D=t.snapToGrid,$=t.translateExtent,F=t.connectOnClick,R=t.defaultEdgeOptions,B=t.fitView,ee=t.fitViewOptions,le=t.onNodesDelete,z=t.onEdgesDelete,G=t.onNodeDrag,W=t.onNodeDragStart,H=t.onNodeDragStop,V=t.onSelectionDrag,ne=t.onSelectionDragStart,Q=t.onSelectionDragStop,K=Kn(_1,dr),J=K.setNodes,te=K.setEdges,Y=K.setDefaultNodesAndEdges,U=K.setMinZoom,Z=K.setMaxZoom,ie=K.setTranslateExtent,re=K.setNodeExtent,pe=K.reset,xe=Ns();return f.useEffect(function(){return Y(l,i),function(){pe()}},[]),un("defaultEdgeOptions",R,xe.setState),un("connectionMode",A,xe.setState),un("onConnect",u,xe.setState),un("onConnectStart",d,xe.setState),un("onConnectStop",m,xe.setState),un("onConnectEnd",y,xe.setState),un("onClickConnectStart",p,xe.setState),un("onClickConnectStop",v,xe.setState),un("onClickConnectEnd",_,xe.setState),un("nodesDraggable",x,xe.setState),un("nodesConnectable",j,xe.setState),un("elementsSelectable",w,xe.setState),un("snapToGrid",D,xe.setState),un("snapGrid",E,xe.setState),un("onNodesChange",P,xe.setState),un("onEdgesChange",T,xe.setState),un("connectOnClick",F,xe.setState),un("fitViewOnInit",B,xe.setState),un("fitViewOnInitOptions",ee,xe.setState),un("onNodesDelete",le,xe.setState),un("onEdgesDelete",z,xe.setState),un("onNodeDrag",G,xe.setState),un("onNodeDragStart",W,xe.setState),un("onNodeDragStop",H,xe.setState),un("onSelectionDrag",V,xe.setState),un("onSelectionDragStart",ne,xe.setState),un("onSelectionDragStop",Q,xe.setState),Uo(n,J),Uo(r,te),Uo(l,J),Uo(i,te),Uo(S,U),Uo(k,Z),Uo($,ie),Uo(M,re),null},y1=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",b1=y1,x1=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",w1=x1,j1=function(t,n,r){return r===Je.Left?t-n:r===Je.Right?t+n:t},N1=function(t,n,r){return r===Je.Top?t-n:r===Je.Bottom?t+n:t},ob=function(t){var n=t.className,r=t.position,l=t.centerX,i=t.centerY,u=t.radius,d=u===void 0?10:u;return Ae.createElement("circle",{className:ur(["react-flow__edgeupdater",n]),cx:j1(l,d,r),cy:N1(i,d,r),r:d,stroke:"transparent",fill:"transparent"})},oc=function(e){var t=function(r){var l=r.id,i=r.className,u=r.type,d=r.data,m=r.onClick,y=r.onEdgeDoubleClick,p=r.selected,v=r.animated,_=r.label,x=r.labelStyle,j=r.labelShowBg,S=r.labelBgStyle,k=r.labelBgPadding,M=r.labelBgBorderRadius,P=r.style,T=r.source,w=r.target,A=r.sourceX,E=r.sourceY,D=r.targetX,$=r.targetY,F=r.sourcePosition,R=r.targetPosition,B=r.elementsSelectable,ee=r.hidden,le=r.sourceHandleId,z=r.targetHandleId,G=r.onContextMenu,W=r.onMouseEnter,H=r.onMouseMove,V=r.onMouseLeave,ne=r.edgeUpdaterRadius,Q=r.onEdgeUpdate,K=r.onEdgeUpdateStart,J=r.onEdgeUpdateEnd,te=r.markerEnd,Y=r.markerStart,U=r.rfId,Z=f.useState(!1),ie=It(Z,2),re=ie[0],pe=ie[1],xe=Ns(),Ve=function(be){var ke=xe.getState(),Le=ke.edges,Xe=ke.addSelectedEdges,et=Le.find(function(tt){return tt.id===l});B&&(xe.setState({nodesSelectionActive:!1}),Xe([l])),m==null||m(be,et)},ht=Yu(l,xe.getState,y),Qe=Yu(l,xe.getState,G),Ne=Yu(l,xe.getState,W),ze=Yu(l,xe.getState,H),Se=Yu(l,xe.getState,V),Be=function(be,ke){var Le=ke?w:T,Xe=(ke?z:le)||null,et=ke?"target":"source",tt=function(){return!0},xt=ke,Bt=xe.getState().edges.find(function(Tt){return Tt.id===l});K==null||K(be,Bt,et);var Ft=J?function(Tt){return J(Tt,Bt,et)}:void 0,ct=function(gt){return Q==null?void 0:Q(Bt,gt)};Jy({event:be,handleId:Xe,nodeId:Le,onConnect:ct,isTarget:xt,getState:xe.getState,setState:xe.setState,isValidConnection:tt,elementEdgeUpdaterType:et,onEdgeUpdateEnd:Ft})},He=function(be){return Be(be,!0)},Ke=function(be){return Be(be,!1)},st=function(){return pe(!0)},X=function(){return pe(!1)},Oe=f.useMemo(function(){return"url(#".concat(Bp(Y,U),")")},[Y,U]),Te=f.useMemo(function(){return"url(#".concat(Bp(te,U),")")},[te,U]);if(ee)return null;var ot=!B&&!m,jt=typeof Q<"u",rn=ur(["react-flow__edge","react-flow__edge-".concat(u),i,{selected:p,animated:v,inactive:ot,updating:re}]);return Ae.createElement("g",{className:rn,onClick:Ve,onDoubleClick:ht,onContextMenu:Qe,onMouseEnter:Ne,onMouseMove:ze,onMouseLeave:Se},Ae.createElement(e,{id:l,source:T,target:w,selected:p,animated:v,label:_,labelStyle:x,labelShowBg:j,labelBgStyle:S,labelBgPadding:k,labelBgBorderRadius:M,data:d,style:P,sourceX:A,sourceY:E,targetX:D,targetY:$,sourcePosition:F,targetPosition:R,sourceHandleId:le,targetHandleId:z,markerStart:Oe,markerEnd:Te,"data-testid":"rf__edge-".concat(l)}),jt&&Ae.createElement("g",{onMouseDown:He,onMouseEnter:st,onMouseOut:X},Ae.createElement(ob,{position:F,centerX:A,centerY:E,radius:ne})),jt&&Ae.createElement("g",{onMouseDown:Ke,onMouseEnter:st,onMouseOut:X},Ae.createElement(ob,{position:R,centerX:D,centerY:$,radius:ne})))};return t.displayName="EdgeWrapper",f.memo(t)};function lb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function ib(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lb(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S1(e){var t={default:oc(e.default||sg),straight:oc(e.bezier||Gy),step:oc(e.step||Qy),smoothstep:oc(e.step||ng),simplebezier:oc(e.simplebezier||qy)},n={},r=Object.keys(e).filter(function(l){return!["default","bezier"].includes(l)}).reduce(function(l,i){return l[i]=oc(e[i]||sg),l},n);return ib(ib({},t),r)}function cb(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=((n==null?void 0:n.x)||0)+t.x,l=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,u=(n==null?void 0:n.height)||t.height;switch(e){case Je.Top:return{x:r+i/2,y:l};case Je.Right:return{x:r+i,y:l+u/2};case Je.Bottom:return{x:r+i/2,y:l+u};case Je.Left:return{x:r,y:l+u/2}}}function ub(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(r){return r.id===t})),typeof n>"u"?null:n}var C1=function(t,n,r,l,i,u){var d=cb(r,t,n),m=cb(u,l,i);return{sourceX:d.x,sourceY:d.y,targetX:m.x,targetY:m.y}};function E1(e){var t=e.sourcePos,n=e.targetPos,r=e.sourceWidth,l=e.sourceHeight,i=e.targetWidth,u=e.targetHeight,d=e.width,m=e.height,y=e.transform,p={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+r,n.x+i),y2:Math.max(t.y+l,n.y+u)};p.x===p.x2&&(p.x2+=1),p.y===p.y2&&(p.y2+=1);var v=lf({x:(0-y[0])/y[2],y:(0-y[1])/y[2],width:d/y[2],height:m/y[2]}),_=Math.max(0,Math.min(v.x2,p.x2)-Math.max(v.x,p.x)),x=Math.max(0,Math.min(v.y2,p.y2)-Math.max(v.y,p.y)),j=Math.ceil(_*x);return j>0}function db(e,t){var n,r,l,i,u,d=e.get(t),m=(d==null||(n=d[hs])===null||n===void 0?void 0:n.handleBounds)||null,y=!d||!m||!d.width||!d.height||typeof((r=d.positionAbsolute)===null||r===void 0?void 0:r.x)>"u"||typeof((l=d.positionAbsolute)===null||l===void 0?void 0:l.y)>"u";return[{x:(d==null||(i=d.positionAbsolute)===null||i===void 0?void 0:i.x)||0,y:(d==null||(u=d.positionAbsolute)===null||u===void 0?void 0:u.y)||0,width:(d==null?void 0:d.width)||0,height:(d==null?void 0:d.height)||0},m,!y]}var k1=typeof document<"u"?document:null,_f=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:k1},n=f.useState(!1),r=It(n,2),l=r[0],i=r[1],u=f.useRef(new Set([])),d=f.useMemo(function(){if(e!==null){var v=Array.isArray(e)?e:[e],_=v.filter(function(j){return typeof j=="string"}).map(function(j){return j.split("+")}),x=_.reduce(function(j,S){return j.concat.apply(j,Vl(S))},[]);return[_,x]}return[[],[]]},[e]),m=It(d,2),y=m[0],p=m[1];return f.useEffect(function(){if(e!==null){var v,_,x=function(M){if(hb(M))return!1;var P=fb(M.code,p);u.current.add(M[P]),mb(y,u.current,!1)&&(M.preventDefault(),i(!0))},j=function(M){if(hb(M))return!1;var P=fb(M.code,p);mb(y,u.current,!0)?(i(!1),u.current.clear()):u.current.delete(M[P])},S=function(){u.current.clear(),i(!1)};return t==null||(v=t.target)===null||v===void 0||v.addEventListener("keydown",x),t==null||(_=t.target)===null||_===void 0||_.addEventListener("keyup",j),window.addEventListener("blur",S),function(){var k,M;t==null||(k=t.target)===null||k===void 0||k.removeEventListener("keydown",x),t==null||(M=t.target)===null||M===void 0||M.removeEventListener("keyup",j),window.removeEventListener("blur",S)}}},[e,i]),l};function mb(e,t,n){return e.filter(function(r){return n||r.length===t.size}).some(function(r){return r.every(function(l){return t.has(l)})})}function fb(e,t){return t.includes(e)?"code":"key"}function hb(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var M1=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},A1=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,r=Ns(),l=Kn(M1,dr),i=l.onNodesChange,u=l.onEdgesChange,d=_f(t),m=_f(n);f.useEffect(function(){var y=r.getState(),p=y.nodeInternals,v=y.edges,_=y.hasDefaultNodes,x=y.hasDefaultEdges,j=y.onNodesDelete,S=y.onEdgesDelete,k=Array.from(p.values()),M=k.reduce(function($,F){return(!F.selected&&F.parentNode&&$.find(function(R){return R.id===F.parentNode})||F.selected)&&$.push(F),$},[]),P=v.filter(function($){return $.selected});if(d&&(M||P)){var T=Cy(M,v),w=[].concat(Vl(P),Vl(T)),A=w.reduce(function($,F){return $.includes(F.id)||$.push(F.id),$},[]);if((x||_)&&(x&&r.setState({edges:v.filter(function($){return!A.includes($.id)})}),_&&(M.forEach(function($){p.delete($.id)}),r.setState({nodeInternals:new Map(p)}))),A.length>0&&(S==null||S(w),u)){var E=A.map(function($){return{id:$,type:"remove"}});u(E)}if(M.length>0&&(j==null||j(M),i)){var D=M.map(function($){return{id:$.id,type:"remove"}});i(D)}r.setState({nodesSelectionActive:!1})}},[d,i,u]),f.useEffect(function(){r.setState({multiSelectionActive:m})},[m])};function O1(e){var t=Ns();f.useEffect(function(){var n,r=function(){if(e.current){var i=Ip(e.current);t.setState({width:i.width||500,height:i.height||500})}};return r(),window.onresize=r,e.current&&(n=new ResizeObserver(function(){return r()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var P1=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},cg=function(t){return{x:t.x,y:t.y,zoom:t.k}},vf=function(t,n){return t.target.closest(".".concat(n))},T1=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},$1=function(t){var n=t.onMove,r=t.onMoveStart,l=t.onMoveEnd,i=t.zoomOnScroll,u=i===void 0?!0:i,d=t.zoomOnPinch,m=d===void 0?!0:d,y=t.panOnScroll,p=y===void 0?!1:y,v=t.panOnScrollSpeed,_=v===void 0?.5:v,x=t.panOnScrollMode,j=x===void 0?tc.Free:x,S=t.zoomOnDoubleClick,k=S===void 0?!0:S,M=t.selectionKeyPressed,P=t.elementsSelectable,T=t.panOnDrag,w=T===void 0?!0:T,A=t.translateExtent,E=t.minZoom,D=t.maxZoom,$=t.defaultZoom,F=$===void 0?1:$,R=t.defaultPosition,B=R===void 0?[0,0]:R,ee=t.zoomActivationKeyCode,le=t.preventScrolling,z=le===void 0?!0:le,G=t.children,W=t.noWheelClassName,H=t.noPanClassName,V=Ns(),ne=f.useRef(!1),Q=f.useRef(null),K=f.useRef({x:0,y:0,zoom:0}),J=Kn(T1,dr),te=J.d3Zoom,Y=J.d3Selection,U=J.d3ZoomHandler,Z=_f(ee);return O1(Q),f.useEffect(function(){if(Q.current){var ie,re=yE().scaleExtent([E,D]).translateExtent(A),pe=Gr(Q.current).call(re),xe=nc(B[0],A[0][0],A[1][0]),Ve=nc(B[1],A[0][1],A[1][1]),ht=nc(F,E,D),Qe=Ul.translate(xe,Ve).scale(ht);re.transform(pe,Qe),V.setState({d3Zoom:re,d3Selection:pe,d3ZoomHandler:pe.on("wheel.zoom"),transform:[xe,Ve,ht],domNode:(ie=pe.node())===null||ie===void 0?void 0:ie.closest(".react-flow")})}},[]),f.useEffect(function(){Y&&te&&(p&&!Z?Y.on("wheel",function(ie){if(vf(ie,W))return!1;ie.preventDefault(),ie.stopImmediatePropagation();var re=Y.property("__zoom").k||1;if(ie.ctrlKey&&m){var pe=Sa(ie),xe=-ie.deltaY*(ie.deltaMode===1?.05:ie.deltaMode?1:.002)*10,Ve=re*Math.pow(2,xe);te.scaleTo(Y,Ve,pe);return}var ht=ie.deltaMode===1?20:1,Qe=j===tc.Vertical?0:ie.deltaX*ht,Ne=j===tc.Horizontal?0:ie.deltaY*ht;te.translateBy(Y,-(Qe/re)*_,-(Ne/re)*_)}).on("wheel.zoom",null):typeof U<"u"&&Y.on("wheel",function(ie){if(!z||vf(ie,W))return null;ie.preventDefault()}).on("wheel.zoom",U))},[p,j,Y,te,U,Z,m,z,W]),f.useEffect(function(){te&&(M&&!ne.current?te.on("zoom",null):M||te.on("zoom",function(ie){if(V.setState({transform:[ie.transform.x,ie.transform.y,ie.transform.k]}),n){var re=cg(ie.transform);n(ie.sourceEvent,re)}}))},[M,te,n]),f.useEffect(function(){te&&te.on("start",function(ie){if(ne.current=!0,r){var re=cg(ie.transform);K.current=re,r(ie.sourceEvent,re)}})},[te,r]),f.useEffect(function(){te&&te.on("end",function(ie){if(ne.current=!1,l&&P1(K.current,ie.transform)){var re=cg(ie.transform);K.current=re,l(ie.sourceEvent,re)}})},[te,l]),f.useEffect(function(){te&&te.filter(function(ie){var re=Z||u,pe=m&&ie.ctrlKey;return!w&&!re&&!p&&!k&&!m||M||!k&&ie.type==="dblclick"||vf(ie,W)&&ie.type==="wheel"||vf(ie,H)&&ie.type!=="wheel"||!m&&ie.ctrlKey&&ie.type==="wheel"||!re&&!p&&!pe&&ie.type==="wheel"||!w&&(ie.type==="mousedown"||ie.type==="touchstart")?!1:(!ie.ctrlKey||ie.type==="wheel")&&!ie.button})},[te,u,m,p,k,w,M,P,Z]),Ae.createElement("div",{className:"react-flow__renderer react-flow__container",ref:Q},G)};function pb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function gb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?pb(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function _b(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var D1=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},vb={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},L1=f.memo(function(e){var t=e.selectionKeyPressed,n=Ns(),r=f.useRef(0),l=f.useRef(0),i=f.useRef(),u=f.useState(vb),d=It(u,2),m=d[0],y=d[1],p=Kn(D1,dr),v=p.userSelectionActive,_=p.elementsSelectable,x=v||t;if(!_||!x)return null;var j=function(){y(vb),n.setState({userSelectionActive:!1}),r.current=0,l.current=0},S=function(w){var A=w.target.closest(".react-flow");i.current=A.getBoundingClientRect();var E=_b(w,i.current);y({width:0,height:0,startX:E.x,startY:E.y,x:E.x,y:E.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},k=function(w){var A,E;if(!(!t||!m.draw||!i.current)){var D=_b(w,i.current),$=(A=m.startX)!==null&&A!==void 0?A:0,F=(E=m.startY)!==null&&E!==void 0?E:0,R=gb(gb({},m),{},{x:D.x<$?D.x:$,y:D.y<F?D.y:F,width:Math.abs(D.x-$),height:Math.abs(D.y-F)}),B=n.getState(),ee=B.nodeInternals,le=B.edges,z=B.transform,G=B.onNodesChange,W=B.onEdgesChange,H=Array.from(ee.values()),V=Sy(ee,R,z,!1,!0),ne=Cy(V,le).map(function(te){return te.id}),Q=V.map(function(te){return te.id});if(r.current!==Q.length){r.current=Q.length;var K=sc(H,Q);K.length&&(G==null||G(K))}if(l.current!==ne.length){l.current=ne.length;var J=sc(le,ne);J.length&&(W==null||W(J))}y(R)}},M=function(){n.setState({nodesSelectionActive:r.current>0}),j()},P=function(){n.setState({nodesSelectionActive:!1}),j()};return Ae.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:S,onMouseMove:k,onMouseUp:M,onMouseLeave:P},m.draw&&Ae.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:m.width,height:m.height,transform:"translate(".concat(m.x,"px, ").concat(m.y,"px)")}}))});function yb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function bb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yb(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xb(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:xb(n,t):!1}function wb(e,t,n){var r=e;do{var l;if((l=r)!==null&&l!==void 0&&l.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function z1(e,t,n){return Array.from(e.values()).filter(function(r){return(r.selected||r.id===n)&&(!r.parentNode||!xb(r,e))}).map(function(r){var l,i,u,d;return{id:r.id,position:r.position||{x:0,y:0},positionAbsolute:r.positionAbsolute||{x:0,y:0},distance:{x:t.x-((l=(i=r.positionAbsolute)===null||i===void 0?void 0:i.x)!==null&&l!==void 0?l:0),y:t.y-((u=(d=r.positionAbsolute)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0)},delta:{x:0,y:0},extent:r.extent,parentNode:r.parentNode,width:r.width,height:r.height}})}function R1(e,t,n,r,l,i){var u=It(r,2),d=u[0],m=u[1],y=e.extent||i,p={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(p.x=d*Math.round(p.x/d),p.y=m*Math.round(p.y/m)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var v=l.get(e.parentNode);y=v!=null&&v.positionAbsolute&&v!==null&&v!==void 0&&v.width&&v!==null&&v!==void 0&&v.height?[[v.positionAbsolute.x,v.positionAbsolute.y],[v.positionAbsolute.x+v.width-e.width,v.positionAbsolute.y+v.height-e.height]]:y}else y=i;else if(e.extent&&e.parentNode){var _,x,j,S,k=l.get(e.parentNode),M=(_=k==null||(x=k.positionAbsolute)===null||x===void 0?void 0:x.x)!==null&&_!==void 0?_:0,P=(j=k==null||(S=k.positionAbsolute)===null||S===void 0?void 0:S.y)!==null&&j!==void 0?j:0;y=[[e.extent[0][0]+M,e.extent[0][1]+P],[e.extent[1][0]+M,e.extent[1][1]+P]]}var T={x:0,y:0};if(e.parentNode){var w,A,E,D,$=l.get(e.parentNode);T={x:(w=$==null||(A=$.positionAbsolute)===null||A===void 0?void 0:A.x)!==null&&w!==void 0?w:0,y:(E=$==null||(D=$.positionAbsolute)===null||D===void 0?void 0:D.y)!==null&&E!==void 0?E:0}}return e.positionAbsolute=y?dy(p,y):p,e.position={x:e.positionAbsolute.x-T.x,y:e.positionAbsolute.y-T.y},e}function ug(e){var t=e.nodeId,n=e.dragItems,r=e.nodeInternals,l=n.map(function(i){var u=r.get(i.id);return bb(bb({},u),{},{position:i.position,positionAbsolute:i.positionAbsolute})});return[t?l.find(function(i){return i.id===t}):l[0],l]}function dg(e){return function(t,n,r){return e==null?void 0:e(t,r)}}function jb(e){var t=e.nodeRef,n=e.disabled,r=n===void 0?!1:n,l=e.noDragClassName,i=e.handleSelector,u=e.nodeId,d=e.isSelectable,m=e.selectNodesOnDrag,y=f.useState(!1),p=It(y,2),v=p[0],_=p[1],x=Ns(),j=f.useRef(),S=f.useRef({x:null,y:null}),k=f.useCallback(function(M){var P=M.sourceEvent,T=x.getState(),w=T.transform,A=T.snapGrid,E=T.snapToGrid,D=P.touches?P.touches[0].clientX:P.clientX,$=P.touches?P.touches[0].clientY:P.clientY,F=Ny({x:D,y:$},w,E,A);return F},[]);return f.useEffect(function(){if(t!=null&&t.current){var M=Gr(t.current);if(r)M.on(".drag",null);else{var P=MS().on("start",function(T){var w=x.getState(),A=w.nodeInternals,E=w.multiSelectionActive,D=w.unselectNodesAndEdges,$=w.onNodeDragStart,F=w.onSelectionDragStart,R=u?$:dg(F);if(!m&&!E&&u){var B;(B=A.get(u))!==null&&B!==void 0&&B.selected||D()}u&&d&&m&&xy({id:u,store:x});var ee=k(T);if(S.current=ee,j.current=z1(A,ee,u),R&&j.current){var le=ug({nodeId:u,dragItems:j.current,nodeInternals:A}),z=It(le,2),G=z[0],W=z[1];R(T.sourceEvent,G,W)}}).on("drag",function(T){var w=x.getState(),A=w.updateNodePositions,E=w.snapToGrid,D=w.snapGrid,$=w.nodeInternals,F=w.nodeExtent,R=w.onNodeDrag,B=w.onSelectionDrag,ee=k(T);if((S.current.x!==ee.x||S.current.y!==ee.y)&&j.current){S.current=ee,j.current=j.current.map(function(V){return R1(V,ee,E,D,$,F)});var le=u?R:dg(B);if(A(j.current,!0,!0),_(!0),le){var z=ug({nodeId:u,dragItems:j.current,nodeInternals:$}),G=It(z,2),W=G[0],H=G[1];le(T.sourceEvent,W,H)}}T.on("end",function(V){if(_(!1),j.current){var ne=x.getState(),Q=ne.updateNodePositions,K=ne.nodeInternals,J=ne.onNodeDragStop,te=ne.onSelectionDragStop,Y=u?J:dg(te);if(Q(j.current,!1,!1),Y){var U=ug({nodeId:u,dragItems:j.current,nodeInternals:K}),Z=It(U,2),ie=Z[0],re=Z[1];Y(V.sourceEvent,ie,re)}}})}).filter(function(T){var w=T.target,A=!T.button&&(!l||!wb(w,".".concat(l),t))&&(!i||wb(w,i,t));return A});return M.call(P),function(){M.on(".drag",null)}}}},[t,r,l,i,d,x,u,m,k]),v}function Nb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function F1(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nb(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var I1=function(t){return F1({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},Up(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},B1=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(r){return r.selected});return Up(n)};function U1(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,r=Ns(),l=Kn(I1,dr),i=l.transformString,u=l.userSelectionActive,d=Kn(B1,dr),m=d.width,y=d.height,p=d.x,v=d.y,_=f.useRef(null);if(jb({nodeRef:_}),u||!m||!y)return null;var x=t?function(j){var S=Array.from(r.getState().nodeInternals.values()).filter(function(k){return k.selected});t(j,S)}:void 0;return Ae.createElement("div",{className:ur(["react-flow__nodesselection","react-flow__container",n]),style:{transform:i}},Ae.createElement("div",{ref:_,className:"react-flow__nodesselection-rect",onContextMenu:x,style:{width:m,height:y,top:v,left:p}}))}var q1=f.memo(U1),H1=function(t){return t.nodesSelectionActive},Sb=function(t){var n=t.children,r=t.onPaneClick,l=t.onPaneContextMenu,i=t.onPaneScroll,u=t.deleteKeyCode,d=t.onMove,m=t.onMoveStart,y=t.onMoveEnd,p=t.selectionKeyCode,v=t.multiSelectionKeyCode,_=t.zoomActivationKeyCode,x=t.elementsSelectable,j=t.zoomOnScroll,S=t.zoomOnPinch,k=t.panOnScroll,M=t.panOnScrollSpeed,P=t.panOnScrollMode,T=t.zoomOnDoubleClick,w=t.panOnDrag,A=t.translateExtent,E=t.minZoom,D=t.maxZoom,$=t.defaultZoom,F=t.defaultPosition,R=t.preventScrolling,B=t.onSelectionContextMenu,ee=t.noWheelClassName,le=t.noPanClassName,z=Ns(),G=Kn(H1),W=_f(p);A1({deleteKeyCode:u,multiSelectionKeyCode:v});var H=function(K){r==null||r(K),z.getState().resetSelectedElements(),z.setState({nodesSelectionActive:!1})},V=l?function(Q){return l(Q)}:void 0,ne=i?function(Q){return i(Q)}:void 0;return Ae.createElement($1,{onMove:d,onMoveStart:m,onMoveEnd:y,selectionKeyPressed:W,elementsSelectable:x,zoomOnScroll:j,zoomOnPinch:S,panOnScroll:k,panOnScrollSpeed:M,panOnScrollMode:P,zoomOnDoubleClick:T,panOnDrag:w,translateExtent:A,minZoom:E,maxZoom:D,defaultZoom:$,defaultPosition:F,zoomActivationKeyCode:_,preventScrolling:R,noWheelClassName:ee,noPanClassName:le},n,Ae.createElement(L1,{selectionKeyPressed:W}),G&&Ae.createElement(q1,{onSelectionContextMenu:B,noPanClassName:le}),Ae.createElement("div",{className:"react-flow__pane react-flow__container",onClick:H,onContextMenu:V,onWheel:ne}))};Sb.displayName="FlowRenderer";var V1=f.memo(Sb);function W1(e){var t=Kn(f.useCallback(function(n){return e?Sy(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var K1=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},Cb=function(t){var n=Kn(K1,dr),r=n.nodesDraggable,l=n.nodesConnectable,i=n.elementsSelectable,u=n.updateNodeDimensions,d=W1(t.onlyRenderVisibleElements),m=f.useRef(),y=f.useMemo(function(){if(typeof ResizeObserver>"u")return null;var p=new ResizeObserver(function(v){var _=v.map(function(x){return{id:x.target.getAttribute("data-id"),nodeElement:x.target,forceUpdate:!0}});u(_)});return m.current=p,p},[]);return f.useEffect(function(){return function(){var p;m==null||(p=m.current)===null||p===void 0||p.disconnect()}},[]),Ae.createElement("div",{className:"react-flow__nodes react-flow__container"},d.map(function(p){var v,_,x,j,S,k,M,P=p.type||"default";t.nodeTypes[P]||(P="default");var T=t.nodeTypes[P]||t.nodeTypes.default,w=!!(p.draggable||r&&typeof p.draggable>"u"),A=!!(p.selectable||i&&typeof p.selectable>"u"),E=!!(p.connectable||l&&typeof p.connectable>"u");return Ae.createElement(T,{key:p.id,id:p.id,className:p.className,style:p.style,type:P,data:p.data,sourcePosition:p.sourcePosition||Je.Bottom,targetPosition:p.targetPosition||Je.Top,hidden:p.hidden,xPos:(v=(_=p.positionAbsolute)===null||_===void 0?void 0:_.x)!==null&&v!==void 0?v:0,yPos:(x=(j=p.positionAbsolute)===null||j===void 0?void 0:j.y)!==null&&x!==void 0?x:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!p.selected,isDraggable:w,isSelectable:A,isConnectable:E,resizeObserver:y,dragHandle:p.dragHandle,zIndex:(S=(k=p[hs])===null||k===void 0?void 0:k.z)!==null&&S!==void 0?S:0,isParent:!!((M=p[hs])!==null&&M!==void 0&&M.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!p.width&&!!p.height})}))};Cb.displayName="NodeRenderer";var Y1=f.memo(Cb),lc;function Eb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function kb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Eb(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Eb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Q1=(lc={},Qt(lc,Je.Left,Je.Right),Qt(lc,Je.Right,Je.Left),Qt(lc,Je.Top,Je.Bottom),Qt(lc,Je.Bottom,Je.Top),lc),G1=function(e){var t,n,r,l,i,u=e.connectionNodeId,d=e.connectionHandleType,m=e.connectionLineStyle,y=e.connectionLineType,p=y===void 0?Io.Bezier:y,v=e.isConnectable,_=e.CustomConnectionLineComponent,x=Kn(f.useCallback(function(ne){return{fromNode:ne.nodeInternals.get(u),handleId:ne.connectionHandleId,toX:(ne.connectionPosition.x-ne.transform[0])/ne.transform[2],toY:(ne.connectionPosition.y-ne.transform[1])/ne.transform[2]}},[u]),dr),j=x.fromNode,S=x.handleId,k=x.toX,M=x.toY,P=j==null||(t=j[hs])===null||t===void 0?void 0:t.handleBounds;if(!j||!v||!(P!=null&&P[d]))return null;var T=P[d],w=S?T.find(function(ne){return ne.id===S}):T[0],A=w?w.x+w.width/2:((n=j==null?void 0:j.width)!==null&&n!==void 0?n:0)/2,E=w?w.y+w.height/2:(r=j==null?void 0:j.height)!==null&&r!==void 0?r:0,D=((j==null||(l=j.positionAbsolute)===null||l===void 0?void 0:l.x)||0)+A,$=((j==null||(i=j.positionAbsolute)===null||i===void 0?void 0:i.y)||0)+E,F=w==null?void 0:w.position;if(!F)return null;var R=Q1[F],B,ee,le,z,G,W;switch(d){case"source":B=D,ee=$,le=F,z=k,G=M,W=R;break;case"target":B=k,ee=M,le=R,z=D,G=$,W=F;break}if(_)return Ae.createElement("g",{className:"react-flow__connection"},Ae.createElement(_,{connectionLineType:p,connectionLineStyle:m,fromNode:j,fromHandle:w,fromX:D,fromY:$,toX:k,toY:M,fromPosition:F,toPosition:R,sourcePosition:le,targetPosition:W,sourceNode:j,sourceHandle:w,targetX:z,targetY:G,sourceX:B,sourceY:ee}));var H="",V={sourceX:B,sourceY:ee,sourcePosition:le,targetX:z,targetY:G,targetPosition:W};return p===Io.Bezier?H=Xy(V):p===Io.Step?H=tg(kb(kb({},V),{},{borderRadius:0})):p===Io.SmoothStep?H=tg(V):p===Io.SimpleBezier?H=Uy(V):H="M".concat(B,",").concat(ee," ").concat(z,",").concat(G),Ae.createElement("g",{className:"react-flow__connection"},Ae.createElement("path",{d:H,className:"react-flow__connection-path",style:m}))};function mg(e){"@babel/helpers - typeof";return mg=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mg(e)}var yf,X1=function(t){var n=t.color,r=n===void 0?"none":n,l=t.strokeWidth,i=l===void 0?1:l;return Ae.createElement("polyline",{stroke:r,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:"none",points:"-5,-4 0,0 -5,4"})},J1=function(t){var n=t.color,r=n===void 0?"none":n,l=t.strokeWidth,i=l===void 0?1:l;return Ae.createElement("polyline",{stroke:r,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:i,fill:r,points:"-5,-4 0,0 -5,4 -5,-4"})},Mb=(yf={},Qt(yf,of.Arrow,X1),Qt(yf,of.ArrowClosed,J1),yf);function Z1(e){var t=f.useMemo(function(){var n=Mb.hasOwnProperty(e);return n?Mb[e]:function(){return null}},[e]);return t}function Ab(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function ek(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ab(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ab(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var tk=function(t){var n=t.id,r=t.type,l=t.color,i=t.width,u=i===void 0?12.5:i,d=t.height,m=d===void 0?12.5:d,y=t.markerUnits,p=y===void 0?"strokeWidth":y,v=t.strokeWidth,_=t.orient,x=_===void 0?"auto":_,j=Z1(r);return Ae.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(u),markerHeight:"".concat(m),viewBox:"-10 -10 20 20",markerUnits:p,orient:x,refX:"0",refY:"0"},Ae.createElement(j,{color:l,strokeWidth:v}))},nk=function(t){var n=t.defaultColor,r=t.rfId;return function(l){var i=[];return l.edges.reduce(function(u,d){return[d.markerStart,d.markerEnd].forEach(function(m){if(m&&mg(m)==="object"){var y=Bp(m,r);i.includes(y)||(u.push(ek({id:y,color:m.color||n},m)),i.push(y))}}),u},[]).sort(function(u,d){return u.id.localeCompare(d.id)})}},Ob=function(t){var n=t.defaultColor,r=t.rfId,l=Kn(f.useCallback(nk({defaultColor:n,rfId:r}),[n,r]),function(i,u){return!(i.length!==u.length||i.some(function(d,m){return d.id!==u[m].id}))});return Ae.createElement("defs",null,l.map(function(i){return Ae.createElement(tk,{id:i.id,key:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient})}))};Ob.displayName="MarkerDefinitions";var sk=f.memo(Ob),rk=[{level:0,isMaxLevel:!0,edges:[]}];function ak(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=-1,l=e.reduce(function(u,d){var m=fy(d.zIndex),y=m?d.zIndex:0;if(n){var p,v,_,x;y=m?d.zIndex:Math.max(((p=t.get(d.source))===null||p===void 0||(v=p[hs])===null||v===void 0?void 0:v.z)||0,((_=t.get(d.target))===null||_===void 0||(x=_[hs])===null||x===void 0?void 0:x.z)||0)}return u[y]?u[y].push(d):u[y]=[d],r=y>r?y:r,u},{}),i=Object.entries(l).map(function(u){var d=It(u,2),m=d[0],y=d[1],p=+m;return{edges:y,level:p,isMaxLevel:p===r}});return i.length===0?rk:i}function ok(e,t,n){var r=Kn(f.useCallback(function(l){return e?l.edges.filter(function(i){var u=t.get(i.source),d=t.get(i.target);return(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&(d==null?void 0:d.width)&&(d==null?void 0:d.height)&&E1({sourcePos:u.positionAbsolute||{x:0,y:0},targetPos:d.positionAbsolute||{x:0,y:0},sourceWidth:u.width,sourceHeight:u.height,targetWidth:d.width,targetHeight:d.height,width:l.width,height:l.height,transform:l.transform})}):l.edges},[e,t]));return ak(r,t,n)}var lk=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},Pb=function(t){var n=Kn(lk,dr),r=n.connectionNodeId,l=n.connectionHandleType,i=n.nodesConnectable,u=n.elementsSelectable,d=n.width,m=n.height,y=n.connectionMode,p=n.nodeInternals,v=ok(t.onlyRenderVisibleElements,p,t.elevateEdgesOnSelect);if(!d)return null;var _=t.connectionLineType,x=t.defaultMarkerColor,j=t.connectionLineStyle,S=t.connectionLineComponent,k=t.connectionLineContainerStyle,M=r&&l;return Ae.createElement(Ae.Fragment,null,v.map(function(P){var T=P.level,w=P.edges,A=P.isMaxLevel;return Ae.createElement("svg",{key:T,style:{zIndex:T},width:d,height:m,className:"react-flow__edges react-flow__container"},A&&Ae.createElement(sk,{defaultColor:x,rfId:t.rfId}),Ae.createElement("g",null,w.map(function(E){var D=db(p,E.source),$=It(D,3),F=$[0],R=$[1],B=$[2],ee=db(p,E.target),le=It(ee,3),z=le[0],G=le[1],W=le[2];if(!B||!W)return null;var H=E.type||"default";t.edgeTypes[H]||(console.warn('[React Flow]: Edge type "'.concat(H,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),H="default");var V=t.edgeTypes[H]||t.edgeTypes.default,ne=y===ql.Strict?G.target:G.target||G.source,Q=ub(R.source,E.sourceHandle||null),K=ub(ne,E.targetHandle||null),J=(Q==null?void 0:Q.position)||Je.Bottom,te=(K==null?void 0:K.position)||Je.Top;if(!Q||!K)return null;var Y=C1(F,Q,J,z,K,te),U=Y.sourceX,Z=Y.sourceY,ie=Y.targetX,re=Y.targetY;return Ae.createElement(V,{key:E.id,id:E.id,className:ur([E.className,t.noPanClassName]),type:H,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:U,sourceY:Z,targetX:ie,targetY:re,sourcePosition:J,targetPosition:te,elementsSelectable:u,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),M&&Ae.createElement("svg",{style:k,width:d,height:m,className:"react-flow__edges react-flow__connectionline react-flow__container"},Ae.createElement(G1,{connectionNodeId:r,connectionHandleType:l,connectionLineStyle:j,connectionLineType:_,isConnectable:i,CustomConnectionLineComponent:S})))};Pb.displayName="EdgeRenderer";var ik=f.memo(Pb),ck=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function uk(e){var t=e.children,n=Kn(ck);return Ae.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function dk(e){var t=Wp(),n=f.useRef(!1);f.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var Tb=function(t){var n=t.nodeTypes,r=t.edgeTypes,l=t.onMove,i=t.onMoveStart,u=t.onMoveEnd,d=t.onInit,m=t.onNodeClick,y=t.onEdgeClick,p=t.onNodeDoubleClick,v=t.onEdgeDoubleClick,_=t.onNodeMouseEnter,x=t.onNodeMouseMove,j=t.onNodeMouseLeave,S=t.onNodeContextMenu,k=t.onSelectionContextMenu,M=t.connectionLineType,P=t.connectionLineStyle,T=t.connectionLineComponent,w=t.connectionLineContainerStyle,A=t.selectionKeyCode,E=t.multiSelectionKeyCode,D=t.zoomActivationKeyCode,$=t.deleteKeyCode,F=t.onlyRenderVisibleElements,R=t.elementsSelectable,B=t.selectNodesOnDrag,ee=t.translateExtent,le=t.minZoom,z=t.maxZoom,G=t.defaultZoom,W=t.defaultPosition,H=t.preventScrolling,V=t.defaultMarkerColor,ne=t.zoomOnScroll,Q=t.zoomOnPinch,K=t.panOnScroll,J=t.panOnScrollSpeed,te=t.panOnScrollMode,Y=t.zoomOnDoubleClick,U=t.panOnDrag,Z=t.onPaneClick,ie=t.onPaneScroll,re=t.onPaneContextMenu,pe=t.onEdgeUpdate,xe=t.onEdgeContextMenu,Ve=t.onEdgeMouseEnter,ht=t.onEdgeMouseMove,Qe=t.onEdgeMouseLeave,Ne=t.edgeUpdaterRadius,ze=t.onEdgeUpdateStart,Se=t.onEdgeUpdateEnd,Be=t.noDragClassName,He=t.noWheelClassName,Ke=t.noPanClassName,st=t.elevateEdgesOnSelect,X=t.id;return dk(d),Ae.createElement(V1,{onPaneClick:Z,onPaneContextMenu:re,onPaneScroll:ie,deleteKeyCode:$,selectionKeyCode:A,multiSelectionKeyCode:E,zoomActivationKeyCode:D,elementsSelectable:R,onMove:l,onMoveStart:i,onMoveEnd:u,zoomOnScroll:ne,zoomOnPinch:Q,zoomOnDoubleClick:Y,panOnScroll:K,panOnScrollSpeed:J,panOnScrollMode:te,panOnDrag:U,translateExtent:ee,minZoom:le,maxZoom:z,defaultZoom:G,defaultPosition:W,onSelectionContextMenu:k,preventScrolling:H,noDragClassName:Be,noWheelClassName:He,noPanClassName:Ke},Ae.createElement(uk,null,Ae.createElement(ik,{edgeTypes:r,onEdgeClick:y,onEdgeDoubleClick:v,connectionLineType:M,connectionLineStyle:P,connectionLineComponent:T,connectionLineContainerStyle:w,onEdgeUpdate:pe,onlyRenderVisibleElements:F,onEdgeContextMenu:xe,onEdgeMouseEnter:Ve,onEdgeMouseMove:ht,onEdgeMouseLeave:Qe,onEdgeUpdateStart:ze,onEdgeUpdateEnd:Se,edgeUpdaterRadius:Ne,defaultMarkerColor:V,noPanClassName:Ke,elevateEdgesOnSelect:!!st,rfId:X}),Ae.createElement(Y1,{nodeTypes:n,onNodeClick:m,onNodeDoubleClick:p,onNodeMouseEnter:_,onNodeMouseMove:x,onNodeMouseLeave:j,onNodeContextMenu:S,selectNodesOnDrag:B,onlyRenderVisibleElements:F,noPanClassName:Ke,noDragClassName:Be})))};Tb.displayName="GraphView";var mk=f.memo(Tb),$b=function(){return null};$b.displayName="GroupNode";function Db(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Lb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Db(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Db(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}var Gu=function(e){var t=function(r){var l=r.id,i=r.type,u=r.data,d=r.xPos,m=r.yPos,y=r.selected,p=r.onClick,v=r.onMouseEnter,_=r.onMouseMove,x=r.onMouseLeave,j=r.onContextMenu,S=r.onDoubleClick,k=r.style,M=r.className,P=r.isDraggable,T=r.isSelectable,w=r.isConnectable,A=r.selectNodesOnDrag,E=r.sourcePosition,D=r.targetPosition,$=r.hidden,F=r.resizeObserver,R=r.dragHandle,B=r.zIndex,ee=r.isParent,le=r.noPanClassName,z=r.noDragClassName,G=r.initialized,W=Ns(),H=f.useRef(null),V=f.useRef(E),ne=f.useRef(D),Q=f.useRef(i),K=T||P||p||v||_||x,J=Wu(l,W.getState,v),te=Wu(l,W.getState,_),Y=Wu(l,W.getState,x),U=Wu(l,W.getState,j),Z=Wu(l,W.getState,S),ie=function(xe){if(T&&(!A||!P)&&xy({id:l,store:W}),p){var Ve=W.getState().nodeInternals.get(l);p(xe,Lb({},Ve))}};f.useEffect(function(){if(H.current&&!$){var pe=H.current;return F==null||F.observe(pe),function(){return F==null?void 0:F.unobserve(pe)}}},[$]),f.useEffect(function(){var pe=Q.current!==i,xe=V.current!==E,Ve=ne.current!==D;H.current&&(pe||xe||Ve)&&(pe&&(Q.current=i),xe&&(V.current=E),Ve&&(ne.current=D),W.getState().updateNodeDimensions([{id:l,nodeElement:H.current,forceUpdate:!0}]))},[l,i,E,D]);var re=jb({nodeRef:H,disabled:$||!P,noDragClassName:z,handleSelector:R,nodeId:l,isSelectable:T,selectNodesOnDrag:A});return $?null:Ae.createElement("div",{className:ur(["react-flow__node","react-flow__node-".concat(i),le,M,{selected:y,selectable:T,parent:ee}]),ref:H,style:Lb({zIndex:B,transform:"translate(".concat(d,"px,").concat(m,"px)"),pointerEvents:K?"all":"none",visibility:G?"visible":"hidden"},k),onMouseEnter:J,onMouseMove:te,onMouseLeave:Y,onContextMenu:U,onClick:ie,onDoubleClick:Z,"data-testid":"rf__node-".concat(l),"data-id":l},Ae.createElement(c1,{value:l},Ae.createElement(e,{id:l,data:u,type:i,xPos:d,yPos:m,selected:y,isConnectable:w,sourcePosition:E,targetPosition:D,dragging:re,dragHandle:R,zIndex:B})))};return t.displayName="NodeWrapper",f.memo(t)};function zb(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function Rb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zb(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zb(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function fk(e){var t={input:Gu(e.input||sb),default:Gu(e.default||ig),output:Gu(e.output||ab),group:Gu(e.group||$b)},n={},r=Object.keys(e).filter(function(l){return!["input","default","output","group"].includes(l)}).reduce(function(l,i){return l[i]=Gu(e[i]||ig),l},n);return Rb(Rb({},t),r)}function Fb(e,t){f.useRef(null);var n=f.useMemo(function(){return t(e)},[e]);return n}function Ib(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var Bb=function(t){var n=t.children,r=!0;try{Ns()}catch{r=!1}return r?Ae.createElement(Ae.Fragment,null,n):Ae.createElement(Ty,{createStore:$y},n)};Bb.displayName="ReactFlowWrapper";var hk=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function Ub(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable})),n.push.apply(n,r)}return n}function qb(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ub(Object(n),!0).forEach(function(r){Qt(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ub(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}Ib(b1),Ib(w1);var pk={input:sb,default:ig,output:ab},gk={default:sg,straight:Gy,step:Qy,smoothstep:ng,simplebezier:qy},_k=[15,15],vk=[0,0],Hb=f.forwardRef(function(e,t){var n=e.nodes,r=e.edges,l=e.defaultNodes,i=e.defaultEdges,u=e.className,d=e.nodeTypes,m=d===void 0?pk:d,y=e.edgeTypes,p=y===void 0?gk:y,v=e.onNodeClick,_=e.onEdgeClick,x=e.onInit,j=e.onMove,S=e.onMoveStart,k=e.onMoveEnd,M=e.onConnect,P=e.onConnectStart,T=e.onConnectStop,w=e.onConnectEnd,A=e.onClickConnectStart,E=e.onClickConnectStop,D=e.onClickConnectEnd,$=e.onNodeMouseEnter,F=e.onNodeMouseMove,R=e.onNodeMouseLeave,B=e.onNodeContextMenu,ee=e.onNodeDoubleClick,le=e.onNodeDragStart,z=e.onNodeDrag,G=e.onNodeDragStop,W=e.onNodesDelete,H=e.onEdgesDelete,V=e.onSelectionChange,ne=e.onSelectionDragStart,Q=e.onSelectionDrag,K=e.onSelectionDragStop,J=e.onSelectionContextMenu,te=e.connectionMode,Y=te===void 0?ql.Strict:te,U=e.connectionLineType,Z=U===void 0?Io.Bezier:U,ie=e.connectionLineStyle,re=e.connectionLineComponent,pe=e.connectionLineContainerStyle,xe=e.deleteKeyCode,Ve=xe===void 0?"Backspace":xe,ht=e.selectionKeyCode,Qe=ht===void 0?"Shift":ht,Ne=e.multiSelectionKeyCode,ze=Ne===void 0?"Meta":Ne,Se=e.zoomActivationKeyCode,Be=Se===void 0?"Meta":Se,He=e.snapToGrid,Ke=He===void 0?!1:He,st=e.snapGrid,X=st===void 0?_k:st,Oe=e.onlyRenderVisibleElements,Te=Oe===void 0?!1:Oe,ot=e.selectNodesOnDrag,jt=ot===void 0?!0:ot,rn=e.nodesDraggable,ve=e.nodesConnectable,be=e.elementsSelectable,ke=e.minZoom,Le=ke===void 0?.5:ke,Xe=e.maxZoom,et=Xe===void 0?2:Xe,tt=e.defaultZoom,xt=tt===void 0?1:tt,Bt=e.defaultPosition,Ft=Bt===void 0?vk:Bt,ct=e.translateExtent,Tt=ct===void 0?Hp:ct,gt=e.preventScrolling,Ct=gt===void 0?!0:gt,hn=e.nodeExtent,Zt=e.defaultMarkerColor,Cn=Zt===void 0?"#b1b1b7":Zt,Yn=e.zoomOnScroll,pn=Yn===void 0?!0:Yn,Ot=e.zoomOnPinch,Ut=Ot===void 0?!0:Ot,bn=e.panOnScroll,qt=bn===void 0?!1:bn,Pt=e.panOnScrollSpeed,an=Pt===void 0?.5:Pt,es=e.panOnScrollMode,Ks=es===void 0?tc.Free:es,En=e.zoomOnDoubleClick,as=En===void 0?!0:En,Gt=e.panOnDrag,Qn=Gt===void 0?!0:Gt,Tr=e.onPaneClick,uo=e.onPaneScroll,Ys=e.onPaneContextMenu,Os=e.children,Pa=e.onEdgeUpdate,Ta=e.onEdgeContextMenu,ta=e.onEdgeDoubleClick,$r=e.onEdgeMouseEnter,na=e.onEdgeMouseMove,sa=e.onEdgeMouseLeave,ra=e.onEdgeUpdateStart,Ee=e.onEdgeUpdateEnd,Ye=e.edgeUpdaterRadius,Ge=Ye===void 0?10:Ye,sn=e.onNodesChange,Mt=e.onEdgesChange,os=e.noDragClassName,nn=os===void 0?"nodrag":os,jn=e.noWheelClassName,dn=jn===void 0?"nowheel":jn,gn=e.noPanClassName,_n=gn===void 0?"nopan":gn,on=e.fitView,kn=on===void 0?!1:on,aa=e.fitViewOptions,Qs=e.connectOnClick,Dr=Qs===void 0?!0:Qs,pr=e.attributionPosition,_s=e.proOptions,Lr=e.defaultEdgeOptions,zr=e.elevateEdgesOnSelect,mo=zr===void 0?!1:zr,oa=uf(e,hk),la=Fb(m,fk),ia=Fb(p,S1);return Ae.createElement("div",qb(qb({},oa),{},{ref:t,className:ur(["react-flow",u])}),Ae.createElement(Bb,null,Ae.createElement(mk,{onInit:x,onMove:j,onMoveStart:S,onMoveEnd:k,onNodeClick:v,onEdgeClick:_,onNodeMouseEnter:$,onNodeMouseMove:F,onNodeMouseLeave:R,onNodeContextMenu:B,onNodeDoubleClick:ee,nodeTypes:la,edgeTypes:ia,connectionLineType:Z,connectionLineStyle:ie,connectionLineComponent:re,connectionLineContainerStyle:pe,selectionKeyCode:Qe,deleteKeyCode:Ve,multiSelectionKeyCode:ze,zoomActivationKeyCode:Be,onlyRenderVisibleElements:Te,selectNodesOnDrag:jt,translateExtent:Tt,minZoom:Le,maxZoom:et,defaultZoom:xt,defaultPosition:Ft,preventScrolling:Ct,zoomOnScroll:pn,zoomOnPinch:Ut,zoomOnDoubleClick:as,panOnScroll:qt,panOnScrollSpeed:an,panOnScrollMode:Ks,panOnDrag:Qn,onPaneClick:Tr,onPaneScroll:uo,onPaneContextMenu:Ys,onSelectionContextMenu:J,onEdgeUpdate:Pa,onEdgeContextMenu:Ta,onEdgeDoubleClick:ta,onEdgeMouseEnter:$r,onEdgeMouseMove:na,onEdgeMouseLeave:sa,onEdgeUpdateStart:ra,onEdgeUpdateEnd:Ee,edgeUpdaterRadius:Ge,defaultMarkerColor:Cn,noDragClassName:nn,noWheelClassName:dn,noPanClassName:_n,elevateEdgesOnSelect:mo,id:oa==null?void 0:oa.id}),Ae.createElement(v1,{nodes:n,edges:r,defaultNodes:l,defaultEdges:i,onConnect:M,onConnectStart:P,onConnectStop:T,onConnectEnd:w,onClickConnectStart:A,onClickConnectStop:E,onClickConnectEnd:D,nodesDraggable:rn,nodesConnectable:ve,elementsSelectable:be,minZoom:Le,maxZoom:et,nodeExtent:hn,onNodesChange:sn,onEdgesChange:Mt,snapToGrid:Ke,snapGrid:X,connectionMode:Y,translateExtent:Tt,connectOnClick:Dr,defaultEdgeOptions:Lr,fitView:kn,fitViewOptions:aa,onNodesDelete:W,onEdgesDelete:H,onNodeDragStart:le,onNodeDrag:z,onNodeDragStop:G,onSelectionDrag:Q,onSelectionDragStart:ne,onSelectionDragStop:K}),V&&Ae.createElement(g1,{onSelectionChange:V}),Os,Ae.createElement(t1,{proOptions:_s,position:pr})))});Hb.displayName="ReactFlow";var Vb=function(t){var n=t.children;return Ae.createElement(Ty,{createStore:$y},n)};Vb.displayName="ReactFlowProvider";function Wb(e){return function(t){var n=f.useState(t),r=It(n,2),l=r[0],i=r[1],u=f.useCallback(function(d){return i(function(m){return e(d,m)})},[]);return[l,i,u]}}var yk=Wb(_y),bk=Wb(SE);const xk=e=>Number.isFinite(e),bf=e=>Math.round(e*100)/100,wk=(e,t,n,r)=>{if(e===n&&t===r)return`M ${e},${t}`;const l=Math.abs(n-e),i=Math.abs(r-t),u=Math.sqrt(l*l+i*i),d=Math.max(80,Math.min(u*.4,280)),m=Number.isFinite(d)?d:120,y=n>=e?1:-1,p=Math.min(Math.abs(r-t)*.2,50),v=e+y*m,_=t+(r>t?p:-p),x=n-y*m,j=r-(r>t?p:-p);return`M ${e},${t} C ${v},${_} ${x},${j} ${n},${r}`},jk=({id:e,sourceX:t,sourceY:n,targetX:r,targetY:l,markerEnd:i,style:u})=>{const{setEdges:d}=Wp(),[m,y]=f.useState(!1),p=f.useCallback(()=>{y(!0)},[]),v=f.useCallback(()=>{y(!1)},[]),_=f.useMemo(()=>[t,n,r,l].every(R=>xk(R))?{sourceX:bf(t),sourceY:bf(n),targetX:bf(r),targetY:bf(l)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:r,targetY:l}),null),[t,n,r,l,e]),x=f.useMemo(()=>{if(!_)return null;const{sourceX:R,sourceY:B,targetX:ee,targetY:le}=_;return wk(R,B,ee,le)},[_]),j=f.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!_||!x)return null;const{sourceX:S,sourceY:k,targetX:M,targetY:P}=_,T=(S+M)/2,w=(k+P)/2,A=32,E=T-A/2,D=w-A/2,$=`animated-edge${m?" animated-edge--hovered":""}`,F=`canvas-edge-remove${m?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:$,onMouseEnter:p,onMouseLeave:v,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:j,gradientUnits:"userSpaceOnUse",x1:S,y1:k,x2:M,y2:P,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:x,fill:"none",stroke:"transparent",strokeWidth:20,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:x,fill:"none",stroke:`url(#${j})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:x,fill:"none",stroke:`url(#${j})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:i,className:"animated-edge__base",style:{...u,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:x,fill:"none",stroke:`url(#${j})`,strokeWidth:m?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:x,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:F,x:E,y:D,width:A,height:A,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:R=>{R.stopPropagation(),d(B=>B.filter(ee=>ee.id!==e))},"aria-label":"Remove connection",children:""})})})]})},Nk=(e,t,n,r)=>{if(e===n&&t===r)return`M ${e},${t}`;const l=Math.abs(n-e),i=Math.max(64,Math.min(l*.45,240)),u=Number.isFinite(i)?i:100,d=n>=e?1:-1,m=e+d*u,y=t,p=n-d*u;return`M ${e},${t} C ${m},${y} ${p},${r} ${n},${r}`},Sk=({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:l,targetPosition:i})=>{const u=Nk(e,t,n,r),d="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:d,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:r,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:u,fill:"none",stroke:`url(#${d})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:u,fill:"none",stroke:`url(#${d})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:r,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},xf=e=>!e||!e.length?"":e.join(", "),Ck=({nodes:e,onAddNode:t})=>{const[n,r]=f.useState(""),[l,i]=f.useState([]),u=n.trim().toLowerCase(),d=f.useMemo(()=>u?e.filter(_=>{const x=[_.label,_.type,_.description];return _.category&&x.push(_.category),_.tags&&_.tags.length&&x.push(_.tags.join(" ")),x.some(j=>j==null?void 0:j.toLowerCase().includes(u))}):e,[e,u]),m=f.useMemo(()=>{const _=new Map;return d.forEach(x=>{var k;const j=((k=x.category)==null?void 0:k.trim())||"Other",S=_.get(j)??[];S.push(x),_.set(j,S)}),Array.from(_.entries()).sort(([x],[j])=>x.localeCompare(j)).map(([x,j])=>({category:x,entries:j.sort((S,k)=>(S.label||S.type).localeCompare(k.label||k.type))}))},[d]);f.useEffect(()=>{if(!u){i([]);return}i(_=>{const x=new Set(_);let j=!1;return m.forEach(({category:S})=>{x.has(S)||(x.add(S),j=!0)}),j?Array.from(x):_})},[m,u]);const y=_=>{i(x=>{const j=new Set(x);return j.has(_)?j.delete(_):j.add(_),Array.from(j)})},p=d.length,v=p>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsx("h3",{children:"Available steps"}),a.jsxs("div",{className:"feature-canvas-sidebar__search",children:[a.jsx("input",{type:"search",value:n,onChange:_=>r(_.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps"}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>r(""),"aria-label":"Clear search",children:""})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",p," ",p===1?"step":"steps",u?` matching ${n.trim()}`:""]})]}),v?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:m.map(({category:_,entries:x})=>{const j=l.includes(_);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>y(_),"aria-expanded":j,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:_.charAt(0).toUpperCase()+_.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[x.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":j,children:""})]})]}),j&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:x.map(S=>{var k,M;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(S),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:S.label||S.type}),S.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:S.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(k=S.inputs)!=null&&k.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${xf(S.inputs)}`,children:["In: ",xf(S.inputs)]}):null,(M=S.outputs)!=null&&M.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${xf(S.outputs)}`,children:["Out: ",xf(S.outputs)]}):null,S.parameters&&S.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",children:[S.parameters.length," param",S.parameters.length>1?"s":""]}):null]})]})},S.type)})})]},_)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})};async function Kb(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function fg(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load column drop recommendations");return u.json()}async function Yb(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load label encoding recommendations");return u.json()}async function Qb(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load ordinal encoding suggestions");return u.json()}async function Gb(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load target encoding recommendations");return u.json()}async function Xb(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load hash encoding recommendations");return u.json()}async function Jb(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load one-hot encoding recommendations");return u.json()}async function Zb(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load dummy encoding recommendations");return u.json()}async function ex(e,t={}){const{sampleSize:n=500,transformations:r,graph:l,targetNodeId:i}=t,u={dataset_source_id:e,sample_size:n};Array.isArray(r)?r.length>0&&(u.transformations=JSON.stringify(r)):r&&typeof r=="object"&&Object.keys(r).length>0&&(u.transformations=JSON.stringify(r)),l&&Array.isArray(l.nodes)&&Array.isArray(l.edges)&&(u.graph={nodes:l.nodes,edges:l.edges}),i&&(u.target_node_id=i);const d=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok)throw new Error("Failed to load skewness recommendations");return d.json()}async function tx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i={dataset_source_id:e,sample_size:n};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(i.graph={nodes:r.nodes,edges:r.edges}),l&&(i.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)});if(!u.ok)throw new Error("Failed to load scaling recommendations");return u.json()}async function nx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,u={dataset_source_id:e,sample_size:i};r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&(u.graph={nodes:r.nodes,edges:r.edges}),l&&(u.target_node_id=l);const d=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok)throw new Error("Failed to load outlier recommendations");return d.json()}async function sx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,u=new URLSearchParams({dataset_source_id:e,sample_size:String(i)});r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&u.set("graph",JSON.stringify({nodes:r.nodes,edges:r.edges})),l&&u.set("target_node_id",l);const d=await fetch(`/ml-workflow/api/analytics/binned-distribution?${u.toString()}`);if(!d.ok)throw new Error("Failed to load binned column distributions");return d.json()}async function rx(e,t={}){const{sampleSize:n=500,graph:r,targetNodeId:l}=t,i=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,u=new URLSearchParams({dataset_source_id:e,sample_size:String(i)});r&&Array.isArray(r.nodes)&&Array.isArray(r.edges)&&u.set("graph",JSON.stringify({nodes:r.nodes,edges:r.edges})),l&&u.set("target_node_id",l);const d=await fetch(`/ml-workflow/api/analytics/quick-profile?${u.toString()}`);if(!d.ok){let m="Failed to generate dataset profile";try{const y=await d.clone().json(),p=typeof(y==null?void 0:y.detail)=="string"&&y.detail.trim()?y.detail.trim():typeof(y==null?void 0:y.error)=="string"&&y.error.trim()?y.error.trim():typeof(y==null?void 0:y.message)=="string"&&y.message.trim()?y.message.trim():null;p&&(m=p)}catch{try{const p=(await d.text()).trim();p&&(m=p)}catch{}}throw new Error(m)}return d.json()}async function Ek(e,t={}){const{config:n,sampleSize:r,graph:l,targetNodeId:i}=t,u={dataset_source_id:e,sample_size:r==="all"?0:typeof r=="number"&&Number.isFinite(r)?r:300};if(n&&typeof n=="object"){const m=(_,x)=>{const j=Number(_);return Number.isFinite(j)?j<0?0:j>100?100:j:x},y=_=>{if(!_||typeof _!="object")return{};const x={};return Object.entries(_).forEach(([j,S])=>{const k=String(j??"").trim();if(!k)return;let M=null,P=null;if(S&&typeof S=="object"){const T=S.lower??S.min??S.minimum??null,w=S.upper??S.max??S.maximum??null,A=Number(T);Number.isFinite(A)&&(M=A);const E=Number(w);Number.isFinite(E)&&(P=E)}if(!(M===null&&P===null)){if(M!==null&&P!==null&&M>P){const T=M;M=P,P=T}x[k]={lower:M,upper:P}}}),x},p=m(n.lower_percentile,5),v=m(n.upper_percentile,95);u.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:p,upper_percentile:v<=p?Math.min(p+1,100):v,manual_bounds:y(n.manual_bounds)}}l&&Array.isArray(l.nodes)&&Array.isArray(l.edges)&&(u.graph={nodes:l.nodes,edges:l.edges}),i&&(u.target_node_id=i);const d=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});if(!d.ok){const m=await d.text();throw new Error(m||"Failed to load outlier diagnostics")}return d.json()}async function ax(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function ox(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function lx(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function ix(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}async function cx(e,t={}){const{offset:n,limit:r,mode:l}=t,i=new URLSearchParams;typeof n=="number"&&Number.isFinite(n)&&i.set("offset",String(n)),typeof r=="number"&&Number.isFinite(r)&&i.set("limit",String(r)),l&&i.set("mode",l);const u=i.toString(),d=`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/preview/rows${u?`?${u}`:""}`,m=await fetch(d);if(!m.ok){const y=await m.text();throw new Error(y||"Failed to load preview rows")}return m.json()}async function ux(e){const t=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(n||"Failed to load pipeline preview")}return t.json()}const hg=e=>{if(Array.isArray(e))return e.map(t=>hg(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(r=>{n[r]=hg(e[r])}),n}return e},kk=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),Mk=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return kk(n)},Ak=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],r=t.map(i=>{let u=null;if(i&&i.data&&typeof i.data=="object"){const d=i.data.config;if(d!==void 0)try{u=JSON.parse(JSON.stringify(d))}catch{u=d}}return{id:i&&Object.prototype.hasOwnProperty.call(i,"id")?i.id??null:null,type:i&&Object.prototype.hasOwnProperty.call(i,"type")?i.type??null:null,catalogType:i&&i.data&&Object.prototype.hasOwnProperty.call(i.data,"catalogType")?i.data.catalogType??null:null,config:u}}).sort((i,u)=>{const d=typeof i.id=="string"?i.id:String(i.id??""),m=typeof u.id=="string"?u.id:String(u.id??"");return d.localeCompare(m)}),l=n.map(i=>({source:i&&Object.prototype.hasOwnProperty.call(i,"source")?i.source??null:null,target:i&&Object.prototype.hasOwnProperty.call(i,"target")?i.target??null:null,sourceHandle:i&&Object.prototype.hasOwnProperty.call(i,"sourceHandle")?i.sourceHandle??null:null,targetHandle:i&&Object.prototype.hasOwnProperty.call(i,"targetHandle")?i.targetHandle??null:null})).sort((i,u)=>{const d=String(i.source??"").localeCompare(String(u.source??""));return d!==0?d:String(i.target??"").localeCompare(String(u.target??""))});return{nodes:r,edges:l}};async function Wl(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=Ak(t),r=JSON.stringify(hg(n)),l=await Mk(r);return`${e}_${l.slice(0,8)}`}async function dx(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const r=await t.text();throw new Error(r||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const r=n.jobs,l=typeof n.total=="number"?n.total:r.length;return{jobs:r,total:l}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function mx(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function Xu(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),r=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!r.ok){if(r.status===401||r.status===403)throw new Error("Sign in to view training jobs.");const l=await r.text();throw new Error(l||"Failed to load training jobs")}return r.json()}async function fx(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const r=await n.text();throw new Error(r||"Failed to evaluate model")}return n.json()}async function hx(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const r=await t.text();throw new Error(r||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const r=n.jobs,l=typeof n.total=="number"?n.total:r.length;return{jobs:r,total:l}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function Ok(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function Ju(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),r=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!r.ok){if(r.status===401||r.status===403)throw new Error("Sign in to view tuning jobs.");const l=await r.text();throw new Error(l||"Failed to load tuning jobs")}return r.json()}async function px(e){const t={...e,sample_size:0},n=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const r=await n.text();throw new Error(r||"Failed to trigger full dataset execution")}return n.json()}async function wf(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function gx(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const r=n.toString(),l=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${r?`?${r}`:""}`,{credentials:"include"});if(!l.ok){if(l.status===404)throw new Error(`Model type '${e}' not found`);const i=await l.text();throw new Error(i||"Failed to fetch best hyperparameters")}return l.json()}async function Pk(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/full-execution/${encodeURIComponent(t)}`);if(!n.ok){const r=await n.text();throw new Error(r||"Failed to fetch full execution status")}return n.json()}const Tk=Object.freeze(Object.defineProperty({__proto__:null,createHyperparameterTuningJob:hx,createTrainingJob:dx,evaluateTrainingJob:fx,fetchBestHyperparameters:gx,fetchBinnedDistribution:sx,fetchDatasets:ax,fetchDropColumnRecommendations:fg,fetchDummyEncodingRecommendations:Zb,fetchFullExecutionStatus:Pk,fetchHashEncodingRecommendations:Xb,fetchHyperparameterTuningJob:Ok,fetchHyperparameterTuningJobs:Ju,fetchLabelEncodingRecommendations:Yb,fetchModelHyperparameters:wf,fetchNodeCatalog:Kb,fetchOneHotEncodingRecommendations:Jb,fetchOrdinalEncodingRecommendations:Qb,fetchOutlierDiagnostics:Ek,fetchOutlierRecommendations:nx,fetchPipeline:ox,fetchPipelineHistory:ix,fetchPipelinePreview:ux,fetchPipelinePreviewRows:cx,fetchQuickProfile:rx,fetchScalingRecommendations:tx,fetchSkewnessRecommendations:ex,fetchTargetEncodingRecommendations:Gb,fetchTrainingJob:mx,fetchTrainingJobs:Xu,generatePipelineId:Wl,savePipeline:lx,triggerFullDatasetExecution:px},Symbol.toStringTag,{value:"Module"})),$k=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:r,hasReachableSource:l,columnTypeMap:i,setAvailableColumns:u,setColumnSearch:d,setColumnMissingMap:m,setColumnTypeMap:y,setColumnSuggestions:p})=>{const[v,_]=f.useState([]),[x,j]=f.useState(null),[S,k]=f.useState([]),[M,P]=f.useState(null),[T,w]=f.useState(!1),[A,E]=f.useState(null),[D,$]=f.useState(null),[F,R]=f.useState(0),B=f.useRef(i);f.useEffect(()=>{B.current=i},[i]),f.useEffect(()=>{let W=!0;const H=V=>{k([]),P(V??null),E(null),$(null),w(!1),_([]),j(null),u([]),d(""),m({}),y({}),p({})};return e?t?l?(w(!0),P(null),fg(t,{graph:r,targetNodeId:n??null}).then(V=>{if(!W)return;const ne=Array.isArray(V==null?void 0:V.candidates)?V.candidates:[];k(ne),E((V==null?void 0:V.generated_at)??null),$(typeof(V==null?void 0:V.suggested_threshold)=="number"?Number(V.suggested_threshold):null);const Q=Array.isArray(V==null?void 0:V.available_filters)?V.available_filters:[];_(Q),j(Y=>Y&&Q.some(U=>U.id===Y)?Y:null);const K={};V&&typeof V=="object"&&(V!=null&&V.column_missing_map)&&typeof V.column_missing_map=="object"&&Object.entries(V.column_missing_map).forEach(([Y,U])=>{const Z=String(Y??"").trim();if(!Z)return;const ie=Number(U);Number.isFinite(ie)&&(K[Z]=Number(ie))});const J=new Set;Array.isArray(V==null?void 0:V.all_columns)&&V.all_columns.forEach(Y=>{const U=String(Y??"").trim();U&&J.add(U)}),Object.keys(B.current??{}).forEach(Y=>J.add(Y));const te=Array.from(J).sort((Y,U)=>Y.localeCompare(U));te.forEach(Y=>{Object.prototype.hasOwnProperty.call(K,Y)||(K[Y]=0)}),u(te),d(""),m(K),y(Y=>{const U=V==null?void 0:V.column_type_map;if(!U||typeof U!="object")return Y;const Z={...Y};return Object.entries(U).forEach(([ie,re])=>{const pe=String(ie??"").trim();if(!pe)return;const xe=String(re??"").trim();Z[pe]=xe||Y[pe]||""}),Z}),p(Y=>{const U=V==null?void 0:V.column_recommendations;if(!U||typeof U!="object")return Y;const Z={};return Object.entries(U).forEach(([ie,re])=>{const pe=String(ie??"").trim();if(!pe)return;const xe=Array.isArray(re)?re.map(Ve=>String(Ve??"").trim()).filter(Boolean):[];Z[pe]=xe}),Z})}).catch(V=>{W&&H((V==null?void 0:V.message)??"Unable to load recommendations")}).finally(()=>{W&&w(!1)}),()=>{W=!1}):(H("Connect this step to an upstream output to load recommendations."),()=>{W=!1}):(H(),()=>{W=!1}):(H(),()=>{W=!1})},[B,r,e,l,n,F,u,m,d,p,y,t]);const ee=f.useCallback(()=>{!e||!t||!l||R(W=>W+1)},[e,l,t]),le=f.useMemo(()=>{const W=new Map;return v.forEach(H=>{H!=null&&H.id&&W.set(H.id,H.label)}),W},[v]),z=f.useCallback(W=>W?le.has(W)?le.get(W)??null:W.split("_").filter(Boolean).map(V=>V.charAt(0).toUpperCase()+V.slice(1)).join(" ")||W:null,[le]),G=f.useMemo(()=>x?S.filter(W=>Array.isArray(W==null?void 0:W.signals)&&W.signals.includes(x)):S,[x,S]);return{hasDropColumnSource:e,availableFilters:v,activeFilterId:x,setActiveFilterId:j,recommendations:S,filteredRecommendations:G,formatSignalName:z,isFetchingRecommendations:T,recommendationsError:M,recommendationsGeneratedAt:A,suggestedThreshold:D,refreshRecommendations:ee}},Dk=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:r,recommendations:l,filteredRecommendations:i,isFetchingRecommendations:u,recommendationsError:d,relativeGeneratedAt:m,formatSignalName:y,formatMissingPercentage:p,getPriorityClass:v,getPriorityLabel:_,handleToggleColumn:x,selectedColumns:j})=>{const S=k=>{if(!(k!=null&&k.name))return null;const M=String(k.name),P=j.includes(M),T=v(k.priority),w=_(k.priority),A=Array.isArray(k==null?void 0:k.signals)?k.signals.map(E=>y(E)).filter(E=>!!E):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:()=>x(M)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:M}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[k.missing_percentage!==void 0&&k.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${p(k.missing_percentage)}`}),T&&w&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${T}`,children:w})]}),A.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:A.map(E=>a.jsx("span",{className:"canvas-modal__signal-badge",children:E},`${M}-${E}`))}),k.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:k.reason})]})]},M)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>r(null),children:["All reasons (",l.length,")"]}),t.map(k=>{const M=n===k.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${M?" canvas-modal__filter-button--active":""}`,onClick:()=>r(P=>P===k.id?null:k.id),title:k.description??void 0,children:[k.label," (",k.count,")"]},k.id)})]}),u&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!u&&d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:d}),!u&&!d&&a.jsxs(a.Fragment,{children:[m&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",m,"."]}),i.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:i.map(k=>S(k))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},Lk=({thresholdParameter:e,dropIfAnyParameter:t,renderParameterField:n})=>!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&n(e),t&&n(t)]}),zk="first",Rk=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],Fk=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:r,renderMultiSelectField:l,removeDuplicatesKeepSelectId:i,removeDuplicatesKeep:u,onKeepChange:d})=>{if(!n&&!r)return null;const m=y=>{const p=y.target.value;d(p==="last"||p==="none"?p:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),l(n)]}),r&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:i,className:"canvas-modal__parameter-label",children:r.label??"Keep strategy"}),r.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:r.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:i,value:u,onChange:m,children:Rk.map(y=>a.jsx("option",{value:y.value,children:y.label},y.value))})})]})]})},ut=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],Ik=["float64","Int64","boolean","string","category","datetime64[ns]","object"],Bk=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:r,columnSuggestions:l,selectedColumns:i,previewColumns:u,previewStatus:d,sourceId:m,hasReachableSource:y})=>{const p=f.useMemo(()=>{const w=e==null?void 0:e.column_overrides;if(!w||typeof w!="object"||Array.isArray(w))return{};const A={};return Object.entries(w).forEach(([E,D])=>{const $=String(E??"").trim();if(!$||typeof D!="string")return;const F=D.trim();F&&(A[$]=F)}),A},[e==null?void 0:e.column_overrides]),v=f.useMemo(()=>{const w=e==null?void 0:e.target_dtype;return typeof w=="string"?w.trim():""},[e==null?void 0:e.target_dtype]),_=f.useMemo(()=>{const w=new Set;return n.forEach(E=>w.add(E)),Object.keys(r).forEach(E=>w.add(E)),Object.keys(l).forEach(E=>w.add(E)),Object.keys(p).forEach(E=>w.add(E)),i.forEach(E=>w.add(E)),u.forEach(E=>{typeof E=="string"&&w.add(E)}),Array.from(w).sort((E,D)=>E.localeCompare(D)).map(E=>{const D=r[E]??"Unknown",$=l[E]??[],F=$.length?$[0]:null,R=Object.prototype.hasOwnProperty.call(p,E),B=R?p[E]:null,ee=typeof B=="string"?B.trim():"",le=R?ee:v,z=new Set;le&&z.add(le),$.forEach(Q=>z.add(Q)),D&&D!=="Unknown"&&z.add(D),v&&z.add(v),Ik.forEach(Q=>z.add(Q));const G=le??"",W=!!(F&&F!==G),H=!!(F&&F===G),V=i.includes(E),ne=Array.from(z).sort((Q,K)=>Q.localeCompare(K));return{column:E,originalType:D,recommended:F,currentTarget:le,suggestions:$,options:ne,hasRecommendationGap:W,hasOverride:R,usesDefaultTarget:!R,isRecommendationApplied:H,isSelected:V}})},[n,v,p,l,r,u,i]),x=f.useMemo(()=>{const w=_.filter(D=>D.hasRecommendationGap),A=_.filter(D=>!D.hasRecommendationGap),E=[];return w.length&&E.push({key:"needs-attention",label:"Needs attention",rows:w}),A.length&&E.push({key:"all-columns",label:w.length?"Other columns":"All columns",rows:A}),E},[_]),j=f.useMemo(()=>_.filter(w=>w.hasRecommendationGap).length,[_]),S=f.useMemo(()=>j>0,[j]),k=f.useMemo(()=>_.filter(w=>w.isSelected).length,[_]),M=f.useCallback((w,A)=>{const E=w.trim();E&&t(D=>{const $=D.column_overrides&&typeof D.column_overrides=="object"&&!Array.isArray(D.column_overrides)?{...D.column_overrides}:{},F=typeof A=="string"?A.trim():"",R=new Set(ut(D.columns)),B=new Set(ut(D.skipped_columns)),ee=B.delete(E);F?($[E]=F,R.add(E)):delete $[E];const le={...D,columns:Array.from(R).sort((z,G)=>z.localeCompare(G)),column_overrides:$};return ee&&(le.skipped_columns=Array.from(B).sort((z,G)=>z.localeCompare(G))),le})},[t]),P=f.useCallback(()=>{const w=Object.entries(l).filter(([,A])=>A.length>0);w.length&&t(A=>{const E=new Set(ut(A.columns)),D=A.column_overrides&&typeof A.column_overrides=="object"&&!Array.isArray(A.column_overrides)?{...A.column_overrides}:{};return w.forEach(([$,F])=>{const R=$.trim();R&&(E.add(R),F.length&&(D[R]=F[0]))}),{...A,columns:Array.from(E).sort(($,F)=>$.localeCompare(F)),column_overrides:D}})},[l,t]),T=f.useCallback((w,A)=>{A==="__default__"?M(w,null):M(w,A)},[M]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:P,disabled:!S,children:"Apply recommendations"})})]}),!m&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),m&&!y&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),v?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:v}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),_.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",_.length," column",_.length===1?"":"s","  ",k," mapped in node selection."]}),S?a.jsxs("p",{className:"canvas-modal__note",children:[j," column",j===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):_.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),d==="loading"&&!_.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),_.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:x.map(w=>a.jsxs("div",{className:"canvas-cast__group",children:[w.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:w.label}),a.jsxs("span",{children:[w.rows.length," column",w.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:w.rows.map(A=>{const E=["canvas-cast__row"];A.hasRecommendationGap&&E.push("canvas-cast__row--attention"),A.hasOverride&&E.push("canvas-cast__row--override");const D=A.hasOverride?A.currentTarget||"":"__default__",$=A.isRecommendationApplied,F=A.suggestions.slice(1,4),R=A.hasOverride?A.currentTarget?`Override  ${A.currentTarget}`:"Override cleared (uses original dtype)":v?`Inheriting ${v}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:E.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:A.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[A.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),A.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!A.isSelected&&!A.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:A.originalType})}),a.jsx("td",{children:A.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${A.hasRecommendationGap?" canvas-cast__chip--attention":""}${$?" canvas-cast__chip--applied":""}`,children:A.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:$?"Aligned with target":"Not applied yet"}),F.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",F.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:D,onChange:B=>T(A.column,B.target.value),children:[a.jsx("option",{value:"__default__",children:v?`Inherit global (${v})`:"No override (use original)"}),A.options.map(B=>a.jsx("option",{value:B,children:B},`${A.column}-${B}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:R})]})})]},`cast-row-${A.column}`)})})]})})]},`cast-group-${w.key}`))})]})},Zu=100,Uk=12,qk={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},_x={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},Hk={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details."},Vk={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},Wk=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},Kk=e=>{if(!e)return"";const t=Hk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},vx=(e,t)=>{if(!e)return null;const n=e.job_status??null,r=Wk(n??e.status??null),l=_x[n??e.status??r]??_x[r],i=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,u=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let d=`Full dataset run: ${l}`;r==="running"&&i&&u?d=`Full dataset run: In progress (${i}/${u})`:r==="running"&&i?d=`Full dataset run: In progress (${i} rows)`:r==="succeeded"&&i?d=`Full dataset run: Completed (${i} rows)`:r==="succeeded"&&u&&(d=`Full dataset run: Completed (${u} rows)`);const m=[],y=[],p=n?Vk[n]??n:null;if(n==="running"?i&&u?m.push(`Processed ${i} of ${u} rows.`):i?m.push(`Processed ${i} rows.`):u&&m.push(`Processing ${u} rows.`):i?m.push(`Processed ${i} rows.`):u&&m.push(`Total rows ${u}.`),e.reason&&m.push(e.reason),p&&y.push({label:"Background job",value:p}),e.job_id&&y.push({label:"Background job ID",value:e.job_id}),u&&y.push({label:"Dataset rows",value:u}),i&&r!=="queued"&&r!=="skipped"&&y.push({label:"Processed rows",value:i}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&y.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const x=new Date(e.last_updated).toLocaleString();y.push({label:"Last updated",value:x})}catch{y.push({label:"Last updated",value:String(e.last_updated)})}const v=Array.isArray(e.warnings)?e.warnings.map(Kk).map(x=>x.trim()).filter(Boolean):[];let _=null;switch(r){case"queued":_=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":_=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(i){const x=e.processed_rows===1?"":"s";_=`Full dataset run processed ${i} row${x}.`}else u?_=`Full dataset run completed (${u} rows).`:_="Full dataset run completed.";break;case"failed":_=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":_="Full dataset run cancelled.";break;case"skipped":_=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":_=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:_=null;break}return{label:d,tone:r,details:m,metadata:y,warnings:v,stepLabel:_,isActive:n==="queued"||n==="running"}},yx=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),Yk=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const r=e.split(":",2)[1]??"";return r?`Preview mode "${r}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=qk[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},Qk=({preview:e,columns:t,rows:n,tableNote:r,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:u,formatNumericStat:d,formatModeStat:m,fullExecutionStepLabel:y,fullExecutionWarnings:p})=>{const v=e==null?void 0:e.metrics,_=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],x=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],j=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let S=j;const k=y||null;if(k){const w=j.findIndex(A=>typeof A=="string"&&A.toLowerCase().startsWith("full dataset run"));w>=0?S=[...j.slice(0,w),k,...j.slice(w+1)]:j.includes(k)||(S=[...j,k])}const M=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],P=x.reduce((w,A)=>(A&&typeof A.index=="number"&&(w[A.index]=typeof A.missing_percentage=="number"?A.missing_percentage:0),w),{}),T=M.slice(0,Uk);return a.jsxs("div",{className:"canvas-preview",children:[v&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(v.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(v.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(v.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(v.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(v.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:i(v.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:v.requested_sample_size===0?"Full dataset":i(v.requested_sample_size)})]})]}),S.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:S.map((w,A)=>a.jsx("li",{children:w},`${w}-${A}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(w=>a.jsx("th",{children:w},w))})}),a.jsx("tbody",{children:n.map((w,A)=>a.jsx("tr",{children:t.map(E=>a.jsx("td",{children:l(w==null?void 0:w[E])},`${A}-${E}`))},`row-${A}`))})]}),r?a.jsx("p",{className:"canvas-modal__note",children:r}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),x.length>0&&T.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:T.map((w,A)=>{const E=P[A]??0,D=E%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",A+1]}),a.jsxs("strong",{children:[i(E,D),"%"]})]},`row-missing-${A}`)})})]}),_.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:_.map(w=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:w.name}),w.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",w.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",u(w.missing_percentage)," (",i(w.missing_count),")"]}),typeof w.mean=="number"&&!Number.isNaN(w.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",d(w.mean)]}),typeof w.median=="number"&&!Number.isNaN(w.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",d(w.median)]}),w.mode!==void 0&&w.mode!==null&&w.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",m(w.mode)]}),typeof w.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",i(w.distinct_count)]})]},w.name))})]}),p&&p.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:p.map((w,A)=>a.jsx("li",{children:w},`${w}-${A}`))})]})]})},Gk=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:r,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:u,formatNumericStat:d,formatModeStat:m})=>{var H,V,ne,Q,K;const[y,p]=f.useState(()=>yx()),[v,_]=f.useState(null),[x,j]=f.useState(!1),S=e.status==="loading",k=S||!n,M=f.useMemo(()=>{var te;const J=(te=e.data)==null?void 0:te.columns;return Array.isArray(J)?J.filter(Y=>typeof Y=="string"):[]},[(H=e.data)==null?void 0:H.columns]),P=f.useMemo(()=>{var J;return Array.isArray((J=e.data)==null?void 0:J.sample_rows)?e.data.sample_rows.slice(0,Zu):[]},[(V=e.data)==null?void 0:V.sample_rows]),T=P.length,w=Array.isArray((ne=e.data)==null?void 0:ne.sample_rows)?e.data.sample_rows.length:0,A=(Q=e.data)==null?void 0:Q.metrics,E=f.useMemo(()=>A?w>T||typeof A.total_rows=="number"&&A.total_rows>w:!1,[A,T,w]);f.useEffect(()=>{var te;if(e.status!=="success"||!e.data){p(Y=>Y.status==="idle"?Y:yx()),_(null);return}const J=vx((te=e.data.signals)==null?void 0:te.full_execution,i);_(J),p({status:"ready",columns:[...M],rows:[...P],nextOffset:T,hasMore:E,totalRows:typeof(A==null?void 0:A.total_rows)=="number"?A.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[M,P,T,E,i,A==null?void 0:A.total_rows,e.data,e.status]),f.useEffect(()=>{var U,Z;if(!v||!v.isActive)return;const J=(Z=(U=e.data)==null?void 0:U.signals)==null?void 0:Z.full_execution;if(!J||!J.job_id||!t)return;const te=typeof J.poll_after_seconds=="number"&&J.poll_after_seconds>0?J.poll_after_seconds*1e3:5e3,Y=setTimeout(()=>{Promise.resolve().then(()=>Tk).then(ie=>ie.fetchFullExecutionStatus(t,J.job_id)).then(ie=>{const re=vx(ie,i);_(re),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(ie=>{console.error("Failed to poll background job status:",ie)})},te);return()=>clearTimeout(Y)},[v,t,i,e.data]);const D=y.columns.length>0?y.columns:M,$=y.rows.length>0?y.rows:P,F=y.totalRows??(typeof(A==null?void 0:A.total_rows)=="number"?A.total_rows:null),R=y.status==="idle"?E:y.hasMore,B=y.status==="loading",ee=$.length,le=f.useMemo(()=>{if(!ee)return null;const J=i(ee);if(F!==null&&F>=0){const te=i(F),Y=`Loaded ${J} of ${te} rows.`;return R&&ee<F?`${Y} Load more rows to continue.`:!R&&ee<F?`${Y} Preview limited by backend settings.`:Y}return R?`Loaded ${J} rows. Additional rows available.`:`Loaded ${J} rows.`},[R,i,ee,F]),z=f.useMemo(()=>(y.status==="idle"?[]:y.samplingAdjustments).map(Yk).map(te=>te.trim()).filter(Boolean),[y.samplingAdjustments,y.status]),G=y.status==="idle"?!1:y.largeDataset,W=f.useCallback(()=>{var U;if(!t||!R||y.status==="loading")return;const J=y.rows.length>0?y.rows:P,te=y.status==="idle"?J.length:y.nextOffset??J.length,Y=Array.isArray((U=e.data)==null?void 0:U.sample_rows)?e.data.sample_rows:[];if(te<Y.length){const Z=Y.slice(te,te+Zu),ie=J.concat(Z),re=te+Z.length,pe=re<Y.length||typeof(A==null?void 0:A.total_rows)=="number"&&A.total_rows>Y.length;p({status:"ready",columns:y.columns.length>0?y.columns:M,rows:ie,nextOffset:pe?re:null,hasMore:pe,totalRows:typeof(A==null?void 0:A.total_rows)=="number"?A.total_rows:null,samplingAdjustments:y.samplingAdjustments,largeDataset:y.largeDataset,error:null});return}p(Z=>({...Z,status:"loading",error:null})),cx(t,{offset:te,limit:Zu}).then(Z=>{p(ie=>{const re=ie.rows.length>0?ie.rows:J,pe=Array.isArray(Z.columns)&&Z.columns.length>0?Z.columns.map(st=>String(st)):ie.columns.length>0?ie.columns:M,xe=typeof Z.offset=="number"&&Z.offset>=0?Z.offset:0,Ve=Array.isArray(Z.rows)?Z.rows:[],ht=xe<=re.length?re.slice(0,xe):re.slice(),Qe=xe<=re.length?ht.concat(Ve):re.concat(Ve),Ne=Ve.length,ze=!!Z.has_more,Se=typeof Z.next_offset=="number"?Z.next_offset:ze?xe+Ne:null,Be=typeof Z.total_rows=="number"?Z.total_rows:null,He=ze?null:Qe.length,Ke=Be!==null?Be:ie.totalRows!==null?ie.totalRows:He;return{status:"ready",columns:[...pe],rows:Qe,nextOffset:Se,hasMore:ze,totalRows:Ke,samplingAdjustments:Array.isArray(Z.sampling_adjustments)?Z.sampling_adjustments:[],largeDataset:!!Z.large_dataset,error:null}})}).catch(Z=>{p(ie=>({...ie,status:"error",error:(Z==null?void 0:Z.message)??"Unable to load additional rows."}))})},[M,P,t,R,y,(K=e.data)==null?void 0:K.sample_rows,A]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),v&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${v.tone}`,role:"status","aria-live":v.isActive?"polite":"off",title:v.details.length>0?v.details.join(" "):void 0,children:v.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:r,disabled:k,children:S?"Refreshing":"Refresh"})})]}),v&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[v.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:v.details.map((J,te)=>a.jsx("li",{children:J},`${J}-${te}`))}),v.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>j(!x),"aria-expanded":x,children:[x?"":""," ",x?"Hide":"Show"," job details"]}),x&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:v.metadata.map((J,te)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:J.label}),a.jsx("dd",{children:J.value})]},`${J.label}-${J.value}-${te}`))})]})]}),S&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(Qk,{preview:e.data,columns:D,rows:$,tableNote:le,formatCellValue:l,formatMetricValue:i,formatMissingPercentage:u,formatNumericStat:d,formatModeStat:m,fullExecutionStepLabel:(v==null?void 0:v.stepLabel)??null,fullExecutionWarnings:(v==null?void 0:v.warnings)??[]}),y.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:y.error}),G&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",i(Zu)," rows to stay responsive."]}),z.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:z.map((J,te)=>a.jsx("li",{children:J},`${J}-${te}`))})]}),R&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:W,disabled:B,children:B?"Loading rows":`Load next ${i(Zu)} rows`})}),!R&&!S&&F!==null&&ee>=F&&ee>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},ic=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],Xk=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:r,graphContext:l,profilingGraphSignature:i,formatRelativeTime:u})=>{var W;const[d,m]=f.useState({status:"idle",data:null,error:null}),[y,p]=f.useState(0),[v,_]=f.useState({}),[x,j]=f.useState("500"),[S,k]=f.useState("summary"),[M,P]=f.useState(!1),T=f.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${x}::${i}`,[t,e==null?void 0:e.id,i,x,n]),w=f.useMemo(()=>T?v[T]??null:null,[v,T]);f.useEffect(()=>{j("500"),m({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),f.useEffect(()=>{if(!t){m({status:"idle",data:null,error:null});return}if(!n){m({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!r){m({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(w){m({status:"success",data:w,error:null});return}let H=!0;m({status:"loading",data:null,error:null});const V=ic.find(Q=>Q.value===x)??ic[1]??ic[0],ne=V.value==="all"?"all":Number(V.value);return rx(n,{sampleSize:ne,graph:l,targetNodeId:(e==null?void 0:e.id)??null}).then(Q=>{H&&(T&&Q&&_(K=>({...K,[T]:Q})),m({status:"success",data:Q??null,error:null}))}).catch(Q=>{H&&m({status:"error",data:null,error:(Q==null?void 0:Q.message)??"Unable to generate dataset profile"})}),()=>{H=!1}},[w,l,r,t,e==null?void 0:e.id,y,T,x,n]);const A=d.data,E=(A==null?void 0:A.generated_at)??null,D=((W=A==null?void 0:A.correlations)==null?void 0:W.length)??0;f.useEffect(()=>{P(!1),k("summary")},[t,E]),f.useEffect(()=>{S==="correlations"&&D===0&&k("summary")},[S,D]);const $=f.useCallback(()=>{T&&_(H=>{if(!Object.prototype.hasOwnProperty.call(H,T))return H;const V={...H};return delete V[T],V}),p(H=>H+1)},[T]),F=f.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),R=f.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),B=f.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),ee=f.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),le=f.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),z=f.useMemo(()=>ic.find(H=>H.value===x)??ic[0],[x]),G=f.useMemo(()=>u((A==null?void 0:A.generated_at)??null),[u,A==null?void 0:A.generated_at]);return{profileState:d,profileData:A,profilingSamplePreset:x,setProfilingSamplePreset:j,profilingActiveTab:S,setProfilingActiveTab:k,isProfilingWarningsOpen:M,setIsProfilingWarningsOpen:P,handleRefreshDatasetProfile:$,activeProfilingSamplePreset:z,profilingWarningsListId:F,profilingSummaryPanelId:R,profilingCorrelationsPanelId:B,profilingSummaryTabId:ee,profilingCorrelationsTabId:le,profilingCorrelationCount:D,relativeProfilingGeneratedAt:G}},Jk=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:r,formatMissingPercentage:l})=>{if(!e)return null;const{profileState:i,profileData:u,profilingSamplePreset:d,setProfilingSamplePreset:m,profilingActiveTab:y,setProfilingActiveTab:p,isProfilingWarningsOpen:v,setIsProfilingWarningsOpen:_,handleRefreshDatasetProfile:x,activeProfilingSamplePreset:j,profilingWarningsListId:S,profilingSummaryPanelId:k,profilingCorrelationsPanelId:M,profilingSummaryTabId:P,profilingCorrelationsTabId:T,profilingCorrelationCount:w,relativeProfilingGeneratedAt:A}=t,E=i.status==="success"&&!!u;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:ic.map(D=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":D.value===d,onClick:()=>m(D.value),disabled:i.status==="loading",children:D.label},D.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:x,disabled:i.status==="loading",children:i.status==="loading"?"Refreshing":"Refresh"})]})]}),A&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",A]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:j.label}),"."]}),i.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),i.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i.error}),E&&u&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",u.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",u.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",u.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",u.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",u.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:P,role:"tab","data-active":y==="summary","aria-selected":y==="summary","aria-controls":k,onClick:()=>p("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:T,role:"tab","data-active":y==="correlations","aria-selected":y==="correlations","aria-controls":M,onClick:()=>p("correlations"),disabled:!w,children:"Correlations"})]}),y==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:k,role:"tabpanel","aria-labelledby":P,children:[u.warnings&&u.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>_(D=>!D),"aria-expanded":v,"aria-controls":S,children:v?"Hide warnings":`Show warnings (${u.warnings.length})`}),v&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:S,children:u.warnings.map((D,$)=>a.jsx("li",{children:D},`profiling-warning-${$}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:u.columns.map(D=>{const $=D.numeric_summary,F=!!$,R=Array.isArray(D.top_values)?D.top_values:[],B=Array.isArray(D.sample_values)?D.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${D.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:D.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:D.semantic_type??D.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${l(D.missing_percentage)} (${D.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:D.distinct_count!==null?D.distinct_count.toLocaleString():""})]})]}),F?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",r($==null?void 0:$.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",r($==null?void 0:$.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",r($==null?void 0:$.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",r($==null?void 0:$.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",r($==null?void 0:$.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",r($==null?void 0:$.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",r($==null?void 0:$.percentile_75)]})]})]}):null,R.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:R.map((ee,le)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(ee.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[ee.count.toLocaleString()," (",ee.percentage.toFixed(1),"%)"]})]},`${D.name}-top-${le}`))})]}):null,B.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:B.slice(0,5).map((ee,le)=>a.jsx("li",{children:n(ee)},`${D.name}-sample-${le}`))})]}):null]},D.name)})})]}),y==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:M,role:"tabpanel","aria-labelledby":T,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),u.correlations&&u.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:u.correlations.map((D,$)=>{const F=Math.abs(D.coefficient);let R="low";F>=.85?R="extreme":F>=.7?R="strong":F>=.55&&(R="moderate");const B=D.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:D.column_a}),a.jsx("td",{children:D.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":R,"data-sign":B,children:D.coefficient.toFixed(2)})]},`profile-correlation-${$}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},Zk=({type:e})=>a.jsx("span",{"aria-hidden":"true",className:`canvas-modal__title-glyph${e==="dataset"?" canvas-modal__title-glyph--dataset":""}`,children:e==="dataset"?"":""}),eM=({title:e,isDataset:t,onClose:n,canResetNode:r=!1,onResetNode:l})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx(Zk,{type:t?"dataset":"default"}),a.jsxs("div",{children:[a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e}),a.jsx("p",{className:"canvas-modal__subtitle",children:t?"Configure how this dataset feeds the pipeline.":"Adjust parameters to control this transformation."})]})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[r&&l&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,children:"Reset node"}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",children:""})]})]}),tM=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:r,canSave:l,onSave:i,isBusy:u,busyLabel:d})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsx("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":u,children:u&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:d??"Processing"})]})}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,children:"Reset node"}),r&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:i,disabled:!l,children:"Save changes"})]})]}),Mr=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),ps=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},mr=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return Mr(t,n)},bx=e=>e==null||e===""?"":typeof e=="number"?mr(e):String(e),nM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},sM=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},rM=5,aM=4,oM=3,lM="_binned",xx="Missing",iM=5,cM="ordinal",uM="quantile",pg=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],dM=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],mM=[{value:"raise",label:"Raise error on duplicate edges"},{value:"drop",label:"Drop duplicate edges"}],fM=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],ed=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],wx=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",r=ut(e==null?void 0:e.columns),l=(R,B,ee,le)=>{const z=Number(R);if(!Number.isFinite(z))return B;const G=Math.round(z);return Math.max(ee,Math.min(le,G))},i=l(e==null?void 0:e.equal_width_bins,rM,2,200),u=l(e==null?void 0:e.equal_frequency_bins,aM,2,200),d=l(e==null?void 0:e.precision,oM,0,8),m=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",y=!!((e==null?void 0:e.include_lowest)??!0),p=!!((e==null?void 0:e.drop_original)??!1),_=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||lM,x=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",j=["range","bin_index","ordinal","column_suffix"].includes(x)?x:"range",k=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",M=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",P=k==="label"&&M||xx,T=l(e==null?void 0:e.kbins_n_bins,iM,2,200),w=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",A=["ordinal","onehot","onehot-dense"].includes(w)?w:cM,E=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",D=["uniform","quantile","kmeans"].includes(E)?E:uM,$={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([R,B])=>{const ee=String(R??"").trim();if(!ee||!Array.isArray(B))return;const z=B.map(G=>{if(typeof G=="number")return G;if(G==null)return Number.NaN;const W=String(G).trim();return W?Number(W):Number.NaN}).filter(G=>Number.isFinite(G)).sort((G,W)=>G-W).filter((G,W,H)=>W===0||G!==H[W-1]);z.length>=2&&($[ee]=z)});const F={};return e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([R,B])=>{const ee=String(R??"").trim();if(!ee)return;const le=Array.isArray(B)?B.map(z=>String(z).trim()).filter(Boolean):typeof B=="string"?B.split(/[\,\n]/).map(z=>z.trim()).filter(Boolean):[];le.length&&(F[ee]=le)}),{strategy:n,columns:r,equalWidthBins:i,equalFrequencyBins:u,includeLowest:y,precision:d,duplicates:m,outputSuffix:_,dropOriginal:p,labelFormat:j,missingStrategy:k,missingLabel:P,customBins:$,customLabels:F,kbinsNBins:T,kbinsEncode:A,kbinsStrategy:D}},hM=({config:e,columnsParameter:t,renderMultiSelectField:n,fieldIds:r,customEdgeDrafts:l,customLabelDrafts:i,onStrategyChange:u,onIntegerChange:d,onBooleanToggle:m,onSuffixChange:y,onLabelFormatChange:p,onDuplicatesChange:v,onMissingStrategyChange:_,onMissingLabelChange:x,onCustomBinsChange:j,onCustomLabelsChange:S,onClearCustomColumn:k,onKbinsEncodeChange:M,onKbinsStrategyChange:P})=>{const T=pg.find(w=>w.value===e.strategy)??pg[0];return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Binning configuration"})}),a.jsx("p",{className:"canvas-modal__note",children:"Group numeric features into discrete buckets for downstream models or reporting."}),a.jsx("div",{className:"canvas-skewness__segmented",role:"tablist","aria-label":"Binning strategy",children:pg.map(w=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.strategy===w.value,"aria-selected":e.strategy===w.value,onClick:()=>u(w.value),children:w.label},w.value))}),a.jsx("p",{className:"canvas-modal__note",children:T.description}),t&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns"}),n(t)]}),e.strategy==="equal_width"&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Equal-width bins"}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.equalWidth,className:"canvas-modal__parameter-label",children:"Number of bins"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:r.equalWidth,type:"number",className:"canvas-modal__input",min:2,max:200,step:1,value:e.equalWidthBins,onChange:w=>d("equal_width_bins",w.target.value,2,200)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Splits each columns min/max range into evenly sized intervals."})]})]}),e.strategy==="equal_frequency"&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Equal-frequency bins"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.equalFrequency,className:"canvas-modal__parameter-label",children:"Number of quantile bins"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:r.equalFrequency,type:"number",className:"canvas-modal__input",min:2,max:200,step:1,value:e.equalFrequencyBins,onChange:w=>d("equal_frequency_bins",w.target.value,2,200)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Creates buckets with a similar number of rows using quantiles."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.duplicates,className:"canvas-modal__parameter-label",children:"Duplicate edges"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:r.duplicates,value:e.duplicates,onChange:w=>v(w.target.value==="drop"?"drop":"raise"),children:mM.map(w=>a.jsx("option",{value:w.value,children:w.label},w.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Control how tied quantile edges are handled during discretization."})]})]})]}),e.strategy==="kbins"&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"KBinsDiscretizer (sklearn)"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.kbinsNBins,className:"canvas-modal__parameter-label",children:"Number of bins"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:r.kbinsNBins,type:"number",className:"canvas-modal__input",min:2,max:200,step:1,value:e.kbinsNBins,onChange:w=>d("kbins_n_bins",w.target.value,2,200)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Number of bins to produce for each feature."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.kbinsStrategy,className:"canvas-modal__parameter-label",children:"Binning strategy"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsxs("select",{id:r.kbinsStrategy,value:e.kbinsStrategy,onChange:w=>P(w.target.value),children:[a.jsx("option",{value:"uniform",children:"Uniform (equal width)"}),a.jsx("option",{value:"quantile",children:"Quantile (equal frequency)"}),a.jsx("option",{value:"kmeans",children:"K-means clustering"})]})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Strategy for defining bin widths: uniform, quantile, or k-means."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.kbinsEncode,className:"canvas-modal__parameter-label",children:"Encoding"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsxs("select",{id:r.kbinsEncode,value:e.kbinsEncode,onChange:w=>M(w.target.value),children:[a.jsx("option",{value:"ordinal",children:"Ordinal (0, 1, 2, ...)"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"How to encode the discretized values."})]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Output & labels"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.suffix,className:"canvas-modal__parameter-label",children:"Output suffix"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:r.suffix,type:"text",className:"canvas-modal__input",value:e.outputSuffix,onChange:w=>y(w.target.value),placeholder:"e.g. _binned"})})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.labelFormat,className:"canvas-modal__parameter-label",children:"Label format"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:r.labelFormat,value:e.labelFormat,onChange:w=>p(w.target.value??"range"),children:dM.map(w=>a.jsx("option",{value:w.value,children:w.label},w.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Controls how new bin values are named when custom labels arent provided."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.precision,className:"canvas-modal__parameter-label",children:"Decimal precision"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:r.precision,type:"number",className:"canvas-modal__input",min:0,max:8,step:1,value:e.precision,onChange:w=>d("precision",w.target.value,0,8)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Sets rounding precision for interval labels."})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:r.includeLowest,children:"Include lowest edge"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:r.includeLowest,type:"checkbox",checked:e.includeLowest,onChange:w=>m("include_lowest",w.target.checked)}),"Include the minimum value in the first bin"]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:r.dropOriginal,children:"Drop original columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:r.dropOriginal,type:"checkbox",checked:e.dropOriginal,onChange:w=>m("drop_original",w.target.checked)}),"Remove source columns after binning"]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:fM.map(w=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===w.value,onClick:()=>_(w.value),children:w.label},w.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:r.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:r.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:w=>x(w.target.value),placeholder:"e.g. Missing"})})]})]}),e.strategy==="custom"&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Custom bin edges"}),a.jsx("p",{className:"canvas-modal__note",children:"Provide ordered numeric thresholds (minimum two) per column. Optional labels override the global label format."}),e.columns.length?a.jsx("div",{className:"canvas-modal__parameter-list",children:e.columns.map(w=>{const A=e.customBins[w]??[],E=e.customLabels[w]??[],D=Object.prototype.hasOwnProperty.call(l,w)?l[w]:A.length?A.join(", "):"",$=Object.prototype.hasOwnProperty.call(i,w)?i[w]:E.length?E.join(", "):"",F=!!(A.length||E.length);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:w}),F&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>k(w),children:"Clear"})})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Bin edges (comma separated, sorted automatically)"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{type:"text",className:"canvas-modal__input",value:D,placeholder:"e.g. 0, 50, 100",onChange:R=>j(w,R.target.value)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Optional labels (comma separated)"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{type:"text",className:"canvas-modal__input",value:$,placeholder:"e.g. Low, Medium, High",onChange:R=>S(w,R.target.value)})})]},`binning-custom-${w}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Select at least one column above to define custom thresholds."})]})]})},pM=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:r,sampleSize:l,relativeGeneratedAt:i,error:u,onRefresh:d,canRefresh:m})=>{const y=f.useMemo(()=>ed.find(p=>p.value===t)??ed[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:ed.map(p=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":p.value===t,onClick:()=>n(p.value),disabled:r,children:p.label},p.value))})]}),i&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",i]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:d,disabled:r||!m,children:r?"Refreshing":"Refresh"})]})]}),l!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:y.label}),"."," ",y.value==="all"?`Summaries computed from the full dataset (${l.toLocaleString()} rows).`:`Summaries computed from ${l.toLocaleString()} sampled rows.`]}),r&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!r&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!r&&!u&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(p=>{const v=p.topPercentage!==null?`${p.topPercentage.toFixed(1)}%`:null,_=p.topCount!==null?`${p.topCount.toLocaleString()}${v?`  ${v}`:""}`:v??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:p.column}),p.sourceColumn&&p.sourceColumn!==p.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:p.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:p.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:_})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:p.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:p.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:p.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:p.bins.map(x=>{const j=x.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",S=Math.min(100,Math.max(0,x.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:j,children:x.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${S}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:x.count.toLocaleString()}),a.jsxs("span",{children:[x.percentage.toFixed(1),"%"]})]})]},`${p.column}-${x.label}`)})}),p.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",p.bins.length," of ",p.totalBinCount," bins."]})]},`binned-card-${p.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},gM=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],_M=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],vM=[...gM,..._M],yM=[0,5,10,20,40,60],bM=["float","double","int","uint","long","short","byte","number","decimal"],xM=["bool","boolean"],wM=["object","string","category","datetime","date","time"],jM=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:wM.some(n=>t.includes(n))?!1:!!(bM.some(n=>t.includes(n))||xM.some(n=>t.includes(n)))},jx=e=>e!=="mode",Nx=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},td=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,r=Number(n);return{neighbors:Number.isFinite(r)?Math.max(1,Math.round(r)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,r=Number(n);return{max_iter:Number.isFinite(r)?Math.max(1,Math.round(r)):10}}},Sx=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",r=new Set(t);return e.map(l=>{if(!l||typeof l!="object")return null;const i=typeof l.method=="string"?l.method.trim().toLowerCase():n,u=r.has(i)?i:n;let d=[];Array.isArray(l.columns)?d=l.columns.map(v=>String(v).trim()).filter(Boolean):typeof l.columns=="string"&&(d=l.columns.split(",").map(v=>v.trim()).filter(Boolean));const m=l.options&&typeof l.options=="object"?l.options:{};let y;if(u==="knn"){const v=m.neighbors??l.neighbors,_=Number(v);y={neighbors:Number.isFinite(_)?Math.max(1,Math.round(_)):5}}else if(u==="regression"||u==="mice"){const v=m.max_iter??m.maxIter??l.max_iter??l.maxIter,_=Number(v);y={max_iter:Number.isFinite(_)?Math.max(1,Math.round(_)):10}}const p=td(u,y??Nx(u));return{method:u,columns:d,options:p}}).filter(l=>!!l)},NM=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),SM=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:r,methodOptions:l,missingFilter:i,missingFilterMax:u,missingFilterActive:d,filteredOptionCount:m,collapsedStrategies:y,onToggleStrategy:p,onRemoveStrategy:v,onAddStrategy:_,onMethodChange:x,onOptionNumberChange:j,onColumnsChange:S,onColumnToggle:k,onMissingFilterChange:M,formatMissingPercentage:P,formatNumericStat:T,formatModeStat:w,schemaDiagnostics:A})=>{const E=Ae.useMemo(()=>{var R;return(R=A==null?void 0:A.entries)!=null&&R.length?new Map(A.entries.map(B=>[B.index,B])):new Map},[A]),D=Math.max(u,i||0),$=r.length>0,F=R=>{var ee,le,z;const B=((ee=l.find(G=>G.value===R.method))==null?void 0:ee.label)??R.method;return R.method==="knn"&&((le=R.options)!=null&&le.neighbors)?`${B}  k=${R.options.neighbors}`:(R.method==="regression"||R.method==="mice")&&((z=R.options)!=null&&z.max_iter)?`${B}  ${R.options.max_iter} iter`:B};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:_,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(A==null?void 0:A.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:A.message}),r.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",m," of ",r.length," column",r.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx("input",{id:"imputer-missing-filter",type:"range",min:0,max:D,step:1,value:i,onChange:R=>M(Number(R.target.value)),className:"canvas-imputer__filter-range"}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[i,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>M(0),disabled:!i,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:yM.map(R=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${i===R?" canvas-imputer__filter-button--active":""}`,onClick:()=>M(R),children:["",R,"%"]},`imputer-missing-preset-${R}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map((R,B)=>{var J,te,Y;const ee=R.columns.join(", "),le=jx(R.method),z=r.filter(U=>{if(R.columns.includes(U.name))return!0;if(le&&!jM(U))return!1;const Z=typeof U.missingPercentage=="number"?U.missingPercentage:null;return Z!==null?Z<=0?!1:Z>=i:i===0}),G=F(R),W=R.columns.length?`${R.columns.length} column${R.columns.length===1?"":"s"}`:"No columns yet",H=y.has(B),V=z.filter(U=>!R.columns.includes(U.name)),ne=E.get(B),Q=(J=ne==null?void 0:ne.details)!=null&&J.length?ne.details.map(U=>U.logical_family?`${U.name} (${U.logical_family})`:U.name).join(", "):"",K=()=>{if(!z.length)return;const U=[...R.columns];z.forEach(Z=>{U.includes(Z.name)||U.push(Z.name)}),S(B,U.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>p(B),"aria-expanded":!H,"aria-controls":`imputer-strategy-body-${B}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${H?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",B+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[G,"  ",W]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>v(B),"aria-label":`Remove strategy ${B+1}`,children:"Remove"})]}),!H&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${B}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Method"}),a.jsx("select",{value:R.method,onChange:U=>x(B,U.target.value??"mean"),children:l.map(U=>a.jsx("option",{value:U.value,children:U.label},U.value))})]}),R.method==="knn"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Neighbors (k)"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:50,step:1,value:((te=R.options)==null?void 0:te.neighbors)??5,onChange:U=>j(B,"neighbors",U.target.value)})]}),(R.method==="regression"||R.method==="mice")&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Max iterations"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:100,step:1,value:((Y=R.options)==null?void 0:Y.max_iter)??10,onChange:U=>j(B,"max_iter",U.target.value)})]}),R.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),Q&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",Q,"."]}),z.length>0&&V.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:K,children:"Select all columns"}),z.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:z.map(U=>{const Z=R.columns.includes(U.name),ie=P(U.missingPercentage),re=typeof U.mean=="number",pe=typeof U.median=="number",xe=U.mode!==null&&U.mode!==void 0&&U.mode!=="",Ve=re||pe||xe;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Z?" canvas-imputer__column-pill--selected":""}`,onClick:()=>k(B,U.name),"aria-pressed":Z,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:U.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",ie]}),U.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:U.dtype})]}),Ve&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[re&&a.jsxs("span",{children:["Mean: ",T(U.mean)]}),pe&&a.jsxs("span",{children:["Median: ",T(U.median)]}),xe&&a.jsxs("span",{children:["Mode: ",w(U.mode)]})]})]},U.name)})}):a.jsx("p",{className:"canvas-modal__note",children:$?d?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${R.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:R.columns.length?R.columns.map(U=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:U},U)):a.jsx("span",{children:"No columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Manual columns (optional)"}),a.jsx("input",{type:"text",className:"canvas-imputer__columns-input",value:ee,onChange:U=>S(B,U.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${B}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},qs=["standard","robust","minmax","maxabs"],Kl={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},Cx={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},Ex=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],CM=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=Ex(t.columns),r=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",l=qs.includes(r)?r:"standard",i={},u=t.column_methods;u&&typeof u=="object"&&!Array.isArray(u)&&Object.entries(u).forEach(([y,p])=>{const v=String(y??"").trim(),_=typeof p=="string"?p.trim().toLowerCase():"";v&&qs.includes(_)&&(i[v]=_)});const d=typeof t.auto_detect=="boolean"?t.auto_detect:!0,m=Ex(t.skipped_columns);return{columns:n,defaultMethod:l,columnMethods:i,autoDetect:d,skippedColumns:m}},EM=e=>{const t={...Kl};return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";r&&qs.includes(r)&&l&&(t[r]=l)}),t},kM=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;r&&qs.includes(r)&&t.set(r,n)}),t},MM=e=>qs.map(t=>({value:t,label:e[t]??Kl[t]??t})),AM=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:r,scalingSkippedColumns:l,scalingExcludedColumns:i})=>{if(!e.length)return[];const u=[];return e.forEach(d=>{const m=String((d==null?void 0:d.column)??"").trim();if(!m)return;const y=d.recommended_method,p=n[y]??Kl[y]??y,v=Array.isArray(d.fallback_methods)?d.fallback_methods.filter(E=>qs.includes(E)).map(E=>{const D=E;return n[D]??Kl[D]??D}):[],_=d.confidence??"medium",x=Cx[_]??Cx.medium,S=t.columnMethods[m]??null,k=S??t.defaultMethod,M=n[k]??Kl[k]??k,P=i.has(m),T=l.has(m),w=r.has(m),A=d.stats;u.push({column:m,dtype:d.dtype??null,recommendedMethod:y,recommendedLabel:p,confidence:_,confidenceLabel:x,reasons:Array.isArray(d.reasons)?d.reasons:[],fallbackLabels:v,stats:A,hasMissing:!!d.has_missing,currentOverride:S,currentMethod:k,currentMethodLabel:M,isOverrideApplied:S!==null,isSelected:w,isExcluded:P,isSkipped:T})}),u.sort((d,m)=>d.column.localeCompare(m.column)),u},OM=(e,t,n,r)=>{if(!e.length)return null;const l=e.map(i=>{const u=t[i],d=u?n[u]??Kl[u]??u:null;return d?`${i} -> ${d}`:i});return r>e.length&&l.push(""),l.join(", ")},PM=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:r,scalingMethodOptions:l,scalingMethodDetailMap:i,scalingDefaultDetail:u,scalingAutoDetectEnabled:d,scalingSelectedCount:m,scalingDefaultLabel:y,scalingOverrideCount:p,scalingOverrideExampleSummary:v,scalingRecommendationRows:_,scalingHasRecommendations:x,scalingStatusMessage:j,scalingError:S,scalingSampleSize:k,relativeScalingGeneratedAt:M,formatMetricValue:P,formatNumericStat:T,formatMissingPercentage:w,onApplyAllRecommendations:A,onClearOverrides:E,onDefaultMethodChange:D,onAutoDetectToggle:$,onOverrideSelect:F})=>{const R=u??i.get(r.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:A,disabled:!x,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:E,disabled:!p,children:"Clear overrides"})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),M&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",M,k!==null?` on ${P(k)} row${k===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:l.map(B=>{const ee=i.get(B.value)??null,le=B.value===r.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${le?" canvas-scaling__method-button--active":""}`,"aria-pressed":le,onClick:()=>D(B.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:B.label}),(ee==null?void 0:ee.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:ee.description})]},B.value)})}),(R==null?void 0:R.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:R.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:B=>$(B.target.checked)}),a.jsx("span",{children:d?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"When enabled, recommended numeric features join this node automatically after each refresh."})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:m})," column",m===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:y})," ",d?" Auto-detect on":" Auto-detect off",p>0?`  Overrides: ${p}${v?` (${v})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&S&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:S}),!n&&!S&&a.jsxs(a.Fragment,{children:[j&&a.jsx("p",{className:"canvas-modal__note",children:j}),_.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:_.map(B=>{const ee=!B.isSkipped&&B.recommendedMethod!==B.currentMethod,le=["canvas-cast__row"];ee&&le.push("canvas-cast__row--attention"),B.isOverrideApplied&&le.push("canvas-cast__row--override"),B.isSkipped&&le.push("canvas-cast__row--muted");const z=B.isSkipped?"__skip__":B.isOverrideApplied?B.currentMethod:"__default__",G=B.isOverrideApplied?`Override -> ${B.currentMethodLabel}`:B.isSkipped?"Skipped (column will not be scaled)":B.isSelected?`Inheriting ${y}`:"Pending inclusion",W=B.stats,H=[];typeof W.valid_count=="number"&&Number.isFinite(W.valid_count)&&H.push(`${P(W.valid_count)} valid rows`),typeof W.mean=="number"&&Number.isFinite(W.mean)&&H.push(`Mean ${T(W.mean)}`),typeof W.median=="number"&&Number.isFinite(W.median)&&H.push(`Median ${T(W.median)}`),typeof W.stddev=="number"&&Number.isFinite(W.stddev)&&H.push(` ${T(W.stddev)}`),typeof W.iqr=="number"&&Number.isFinite(W.iqr)&&H.push(`IQR ${T(W.iqr)}`);const V=typeof W.minimum=="number"&&Number.isFinite(W.minimum),ne=typeof W.maximum=="number"&&Number.isFinite(W.maximum);if(V||ne){const K=V?T(W.minimum):"",J=ne?T(W.maximum):"";H.push(`Range ${K}  ${J}`)}typeof W.skewness=="number"&&Number.isFinite(W.skewness)&&H.push(`Skew ${T(W.skewness)}`),typeof W.outlier_ratio=="number"&&Number.isFinite(W.outlier_ratio)&&W.outlier_ratio>0&&H.push(`${w(W.outlier_ratio*100)} outliers`);const Q=H.length?H.join("  "):null;return a.jsxs("tr",{className:le.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:B.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[B.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",B.dtype]}),B.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),B.isSelected&&!B.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),B.isSkipped&&!B.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),B.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${ee?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:B.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:B.confidenceLabel}),B.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:B.reasons.join("; ")})]})}),a.jsx("td",{children:Q?a.jsx("span",{children:Q}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:z,onChange:K=>F(B.column,K.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",y,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),l.map(K=>a.jsx("option",{value:K.value,children:K.label},`${B.column}-${K.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:G})]})})]},`scaling-row-${B.column}`)})})]})})})]})]})},jf=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],TM="log",to=e=>typeof e=="string"&&jf.includes(e),kx=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",r=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const l=to(r)?r:TM;return{column:n,method:l}}).filter(t=>!!t):[],gg=e=>{const t=new Set,n=[];return e.forEach(r=>{const l=`${r.column}__${r.method}`;t.has(l)||(t.add(l),n.push(r))}),n},Mx={left:"Left skew",right:"Right skew"},$M={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},DM=e=>{const t={...$M};return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!r||!l||to(r)&&(t[r]=l)}),t},LM=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:r,transformationMap:l})=>{const i=e==="recommended"?t.map(m=>m!=null&&m.column?m.column:null).filter(m=>!!m):n,u=new Set,d=[];return i.forEach(m=>{const y=typeof m=="string"?m.trim():"";if(!y||u.has(y))return;u.add(y);const p=r.get(y)??null,v=p?p.recommended_methods.filter(to):[],_=v.length?v[0]:null,x=p!=null&&p.direction?Mx[p.direction]??p.direction:null,j=p!=null&&p.magnitude?`${p.magnitude.charAt(0).toUpperCase()}${p.magnitude.slice(1)}`:null,S=p&&typeof p.skewness=="number"&&Number.isFinite(p.skewness)?p.skewness:null,k=(p==null?void 0:p.summary)??null,M=l.get(y)??null;d.push({column:y,recommendedMethods:v,primaryMethod:_,directionLabel:x,magnitudeLabel:j,skewnessValue:S,summary:k,selectedMethod:M})}),d.sort((m,y)=>{const p=typeof m.skewnessValue=="number"?Math.abs(m.skewnessValue):-1/0,v=typeof y.skewnessValue=="number"?Math.abs(y.skewnessValue):-1/0;if(p!==v)return v-p;const _=!!m.primaryMethod,x=!!y.primaryMethod;return _!==x?_?-1:1:m.column.localeCompare(y.column)}),d},zM=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const r="no-recommendation",l=new Map;e.forEach(u=>{const d=u.primaryMethod??null,m=d??r,y=d?n(d):"No recommended action",p=l.get(m)??{key:m,label:y,method:d,rows:[]};p.rows.push(u),l.set(m,p)});const i=Array.from(l.values());return i.sort((u,d)=>{const m=_=>_?jf.indexOf(_):jf.length,y=m(u.method)-m(d.method);if(y!==0)return y;if(u.rows.length!==d.rows.length)return d.rows.length-u.rows.length;const p=u.label??"",v=d.label??"";return p.localeCompare(v)}),i},RM=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:r,skewnessError:l,skewnessViewMode:i,skewnessRecommendedCount:u,skewnessNumericCount:d,skewnessGroupByMethod:m,skewnessRows:y,skewnessTableGroups:p,hasSkewnessAutoRecommendations:v,skewnessTransformationsCount:_,isFetchingRecommendations:x,getSkewnessMethodLabel:j,getSkewnessMethodStatus:S,onApplyRecommendations:k,onViewModeChange:M,onGroupByToggle:P,onOverrideChange:T,onClearSelections:w})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:k,disabled:n||!v,children:"Apply recommendations"})})]}),r!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",r.toFixed(2)," are surfaced below."]}),n&&y.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&l&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l}),(!n||y.length>0)&&!l&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="recommended",onClick:()=>M("recommended"),disabled:!u,children:["Recommended (",u,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="all",onClick:()=>M("all"),disabled:!d,children:["All numeric (",d,")"]})]}),a.jsxs("label",{className:"canvas-skewness__toggle",children:[a.jsx("input",{type:"checkbox",checked:m,onChange:A=>P(A.target.checked)}),"Group columns by recommended action"]})]}),y.length===0?a.jsx("p",{className:"canvas-modal__note",children:i==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:p.map(A=>a.jsxs("div",{className:"canvas-skewness__group",children:[A.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:A.label}),a.jsxs("span",{children:[A.rows.length," column",A.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:A.rows.map(E=>{const D=[];E.directionLabel&&D.push(E.directionLabel),E.skewnessValue!==null&&D.push(`(${E.skewnessValue.toFixed(2)})`),E.magnitudeLabel&&D.push(` ${E.magnitudeLabel}`);const $=D.length?D.join(" "):"",F=E.selectedMethod??"",R=new Set(E.recommendedMethods),B=[{value:"",label:"No transform",status:null,reason:null}];E.recommendedMethods.forEach(z=>{const G=S(E.column,z);B.push({value:z,label:`${j(z)}${z===E.primaryMethod?" (recommended)":""}`,status:G,reason:(G==null?void 0:G.reason)??null})}),jf.forEach(z=>{if(R.has(z))return;const G=S(E.column,z);B.push({value:z,label:j(z),status:G,reason:(G==null?void 0:G.reason)??null})});const ee=E.selectedMethod?S(E.column,E.selectedMethod):null,le=!E.selectedMethod&&E.primaryMethod?S(E.column,E.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${E.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:E.column}),E.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:E.summary})]})}),a.jsx("td",{children:E.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${E.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:E.primaryMethod?j(E.primaryMethod):j(E.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:$})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx("select",{value:F,onChange:z=>T(E.column,z.target.value),disabled:n||x||!t,children:B.map(z=>{var H;const G=z.reason?`${z.label} (caution: ${z.reason})`:z.label,W=((H=z.status)==null?void 0:H.status)??"ready";return a.jsx("option",{value:z.value,"data-status":W,children:G},`skewness-option-${E.column}-${z.value||"none"}`)})}),ee&&ee.status!=="ready"&&ee.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",ee.reason]}),!E.selectedMethod&&le&&le.status!=="ready"&&le.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",le.reason]})]})})]},`skewness-row-${E.column}`)})})]})})]},`skewness-group-${A.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:_?`${_} transformation${_===1?"":"s"} configured`:"No transformations configured yet."}),_>0&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:w,children:"Clear selections"})]})]})]}),FM="_was_missing",IM=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const r=typeof t=="string"?t.trim():"";return r||FM},BM=(e,t)=>{const n=typeof e=="string"?e.trim():"",r=typeof t=="string"?t:"";return!n||!r?!1:n.endsWith(r)},UM=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:r})=>{const l=typeof r=="string"?r:"",i=ut(t),u=new Set(i),d=Array.from(new Set(ut(e))),m=[];if(d.forEach(v=>{const _=`${v}${l}`,x=n[v],j=typeof x=="number"&&Number.isFinite(x)?Math.max(0,x):null;m.push({column:v,missingPercentage:j,flagColumn:_,conflicts:{alreadyExists:u.has(_),duplicateFlag:!1}})}),m.length>0){const v=new Map;m.forEach(_=>{v.set(_.flagColumn,(v.get(_.flagColumn)??0)+1)}),m.forEach(_=>{_.conflicts.duplicateFlag=(v.get(_.flagColumn)??0)>1})}m.sort((v,_)=>{const x=v.missingPercentage,j=_.missingPercentage,S=typeof x=="number",k=typeof j=="number";return S&&k&&x!==j?j-x:S!==k?S?-1:1:v.column.localeCompare(_.column)});const y=l?Array.from(new Set(i.filter(v=>BM(v,l)))):[],p=m.reduce((v,_)=>_.conflicts.alreadyExists||_.conflicts.duplicateFlag?v+1:v,0);return{rows:m,flaggedColumnsInDataset:y,conflictCount:p}},qM=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:r,flaggedColumnsInDataset:l,conflictCount:i}=t,u=r.length>0,d=e||"(no suffix)",m=l.slice(0,4),y=Math.max(l.length-m.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:r.length})," flag column",r.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:d}),"."]}),l.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",l.length," existing flag column",l.length===1?"":"s"," ","with this suffix",m.length>0?` (examples: ${m.join(", ")}${y>0?", ":""})`:"","."]}),i>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i," generated flag column",i===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),u?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:r.map(p=>{const v=[];p.conflicts.alreadyExists&&v.push("Already exists"),p.conflicts.duplicateFlag&&v.push("Duplicate name");const _=v.length>0,x=_?v.join("  "):"Ready",j=_?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",S=_?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:S,children:[a.jsx("th",{scope:"row",children:p.column}),a.jsx("td",{children:n(p.missingPercentage)}),a.jsx("td",{children:p.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:j,children:x})})]},`missing-indicator-${p.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},Ax=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],_g="canonicalize_country_codes",HM=new Set(Ax),VM=["string","object","text","category","mixed","varchar","char"],WM=4,KM=6,Yl=4,YM=3,Ox=36,QM=5,vg={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},Px=Ax.map(e=>{var t;return{value:e,label:((t=vg[e])==null?void 0:t.label)??e}}),GM=new Set(["true","1","yes","y","on"]),XM=new Set(["false","0","no","n","off"]),JM=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(GM.has(n))return!0;if(XM.has(n))return!1}return t},yg=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?yg(e.split(",")):[],Tx=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,r=yg(n.columns),l=JM(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),i=Sf(typeof n.mode=="string"?n.mode:void 0,t.mode);return!r.length&&!l?null:{mode:i,columns:r,autoDetect:l}},$x=(e,t)=>{const n={mode:t.mode,columns:yg(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const l=Tx(e,n);return l?[l]:[n]}const r=[];return e.forEach(l=>{const i=Tx(l,n);i&&r.push(i)}),r.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):r},ZM=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),eA=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),Nf=e=>e.length<=Ox?e:`${e.slice(0,Ox-1)}...`,Dx=e=>HM.has(e),Lx=e=>{if(!e)return!1;const t=e.toLowerCase();return VM.some(n=>t.includes(n))},Sf=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Dx(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&Dx(r)?r:_g},tA=e=>{const t=vg[e]??vg[_g];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},nA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:r})=>{const l=Array.from(new Set(ut(e))),i=new Set(l),u=t.filter(p=>Lx(n[p]??null)),d=u.filter(p=>!i.has(p)),m=l.filter(p=>!Lx(n[p]??null)),y=typeof r=="boolean"?r:l.length===0;return{selectedColumns:l,nonTextSelected:m,autoDetectionActive:y,recommendedColumns:d,textColumnCount:u.length,textColumns:u}},sA=/[\n;,]+/,cc=(e,t)=>e.slice(0,t),Cf=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[r,...l]=n,i=l.join(t);return[r,i]},rA=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],r=[],l=new Map;let i=0;const u=(p,v)=>{const _=String(p??"").trim(),x=String(v??"").trim();if(!_||!x){(_||x)&&n.push(`${_} => ${x}`.trim());return}const j=eA(_);if(!j){n.push(`${_} => ${x}`);return}l.has(j)?t.add(_):(l.set(j,x),r.length<WM&&r.push(`${_} => ${x}`)),i+=1};if(typeof e=="string"){e.split(sA).forEach(j=>{const S=j.trim();if(S){if(S.includes("=>")){const k=Cf(S,"=>");k?u(k[0],k[1]):n.push(S);return}if(S.includes(":")){const k=Cf(S,":");k?u(k[0],k[1]):n.push(S);return}n.push(S)}});const v=Array.from(t),_=cc(v,Yl),x=cc(n,Yl);return{totalPairs:i,previewPairs:r,previewOverflow:Math.max(i-r.length,0),duplicates:_,duplicateOverflow:Math.max(v.length-_.length,0),invalidEntries:x,invalidOverflow:Math.max(n.length-x.length,0)}}if(Array.isArray(e)){e.forEach(x=>{if(x){if(typeof x=="string"){const j=x.trim();if(!j)return;if(j.includes("=>")){const S=Cf(j,"=>");S?u(S[0],S[1]):n.push(j)}else if(j.includes(":")){const S=Cf(j,":");S?u(S[0],S[1]):n.push(j)}else n.push(j);return}if(typeof x=="object"){const{alias:j,replacement:S}=x;u(j,S);return}n.push(String(x))}});const p=Array.from(t),v=cc(p,Yl),_=cc(n,Yl);return{totalPairs:i,previewPairs:r,previewOverflow:Math.max(i-r.length,0),duplicates:v,duplicateOverflow:Math.max(p.length-v.length,0),invalidEntries:_,invalidOverflow:Math.max(n.length-_.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([p,v])=>{u(p,v)});const d=Array.from(t),m=cc(d,Yl),y=cc(n,Yl);return{totalPairs:i,previewPairs:r,previewOverflow:Math.max(i-r.length,0),duplicates:m,duplicateOverflow:Math.max(d.length-m.length,0),invalidEntries:y,invalidOverflow:Math.max(n.length-y.length,0)}},aA=e=>{const t=e.slice(0,KM);return{preview:t,remaining:Math.max(e.length-t.length,0)}},oA=e=>{const t=e.slice(0,Yl);return{preview:t,remaining:Math.max(e.length-t.length,0)}},lA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Nf(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?Nf(t):null}try{const t=JSON.stringify(e);return t?Nf(t):null}catch{return Nf(String(e))}},iA=(e,t=YM)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([l,i])=>{const u=typeof l=="string"?l.trim():"";if(!u)return;const d=lA(i);if(!d)return;const m=n[u]??[];m.includes(d)||m.length>=t||(n[u]=[...m,d])})}),n},cA=(e,t,n=QM)=>{if(!t.length)return[];const r=[];for(const l of t){if(r.length>=n)break;const i=e[l];!i||!i.length||r.push({column:l,values:i,overflow:0})}return r},bg=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),zx=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],Rx=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);zx.forEach(e=>{e.forEach(t=>Rx.add(bg(t)))});const Fx=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],Ix=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);Fx.forEach(e=>{e.forEach(t=>Ix.add(bg(t)))});const uA=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],dA=/^[A-Za-z]{2,3}$/,mA=/[^0-9A-Za-z\s]/,fA=/[^0-9A-Za-z]+/,Ef={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:zx},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:Fx},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:uA},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},hA=e=>{const t=[];return e.forEach(n=>{n.split(fA).filter(Boolean).forEach(l=>{t.push(l)})}),t},pA=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(r=>mA.test(r));const n=hA(t).map(r=>bg(r));return n.length?e==="canonicalize_country_codes"?n.some(r=>Rx.has(r))||t.some(r=>dA.test(r.trim())):e==="normalize_boolean"?n.some(r=>Ix.has(r)):!1:!1},Bx=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},gA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:r,columnOptions:l,sampleMap:i,modeOptions:u=Px,customPairSummary:d,customPairsParameter:m,collapsedStrategies:y,onToggleStrategy:p,onRemoveStrategy:v,onAddStrategy:_,onModeChange:x,onAutoDetectToggle:j,onColumnToggle:S,onColumnsChange:k,renderParameterField:M})=>{const P=n.length>0,T=r.selectedColumns.length,w=f.useMemo(()=>aA(r.recommendedColumns),[r.recommendedColumns]),A=f.useMemo(()=>oA(r.nonTextSelected),[r.nonTextSelected]),E=f.useMemo(()=>cA(i,r.selectedColumns),[r.selectedColumns,i]),D=!e||!t,$=d.duplicates.length+d.duplicateOverflow,F=d.invalidEntries.length+d.invalidOverflow,R=d.duplicates.join(", "),B=d.invalidEntries.join(", "),ee=f.useMemo(()=>n.some(Y=>Y.mode==="custom"),[n]),le=f.useMemo(()=>{const Y=new Map;return n.forEach(U=>{U.columns.forEach(Z=>{const ie=Z.trim();ie&&Y.set(ie,(Y.get(ie)??0)+1)})}),Y},[n]),[z,G]=f.useState(()=>new Set),W=f.useCallback(Y=>{G(U=>{const Z=new Set(U);return Z.has(Y)?Z.delete(Y):Z.add(Y),Z})},[]);f.useEffect(()=>{G(Y=>{const U=new Set;return Y.forEach(Z=>{Z<n.length&&U.add(Z)}),U.size===Y.size?Y:U})},[n.length]);const[H,V]=f.useState(()=>({index:null,mode:null})),ne=f.useMemo(()=>{const Y=new Map;return l.forEach(U=>{const Z=Array.isArray(U.samples)?U.samples:[],ie=Array.isArray(i[U.name])?i[U.name]:[],re=[...Z,...ie].map(pe=>String(pe??"").trim()).filter(pe=>pe.length>0);Y.set(U.name,re.slice(0,12))}),Y},[l,i]),Q=f.useMemo(()=>{const Y=new Map;return l.forEach(U=>{const Z=ne.get(U.name)??[],ie=Z.length?Z:[U.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(re=>{pA(re,ie)&&(Y.has(re)||Y.set(re,new Set),Y.get(re).add(U.name))})}),Y},[l,ne]);f.useEffect(()=>{if(H.index===null)return;const Y=n[H.index];(!Y||Y.mode!==H.mode)&&V({index:null,mode:null})},[H.index,H.mode,n]);const K=f.useCallback((Y,U)=>{V({index:Y,mode:U})},[]),J=f.useCallback(()=>{V({index:null,mode:null})},[]);let te=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:_,children:"Add strategy"})})]}),r.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:T})," column",T===1?"":"s"," across all strategies."]}),E.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",E.map(Y=>`${Y.column} (${Y.values.join(", ")})`).join("; "),"."]}),r.textColumnCount>0&&w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"","."]}),A.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[A.preview.join(", ")," ",A.preview.length===1?"is":"are"," not text-like.",A.remaining>0?` ${A.remaining} more column${A.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),D?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!P&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),P&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((Y,U)=>{var X;const Z=tA(Y.mode),ie=((X=u.find(Oe=>Oe.value===Y.mode))==null?void 0:X.label)??Z.label,re=Y.columns.length,pe=re?`${re} column${re===1?"":"s"}`:Y.autoDetect?"Auto-detecting columns":"No columns yet",xe=y.has(U),Ve=z.has(U),ht=Y.columns.join(", "),Qe=Q.get(Y.mode)??new Set,Ne=Y.mode==="custom"&&!!m&&!te,ze=Y.mode==="custom"&&!!m&&te;Ne&&(te=!0);const Se=l.map(Oe=>{const Te=Y.columns.includes(Oe.name),ot=Qe.has(Oe.name),jt=Te?0:ot?1:Oe.isRecommended?2:Oe.isTextLike?3:4;return{option:Oe,priority:jt}}).sort((Oe,Te)=>Oe.priority!==Te.priority?Oe.priority-Te.priority:Oe.option.name.localeCompare(Te.option.name)).map(Oe=>Oe.option),Be=Qe.size>0,He=Se.filter(Oe=>Y.columns.includes(Oe.name)?!0:Be?Qe.has(Oe.name):Oe.isRecommended||Oe.isTextLike),Ke=new Set(He.map(Oe=>Oe.name)),st=Se.filter(Oe=>!Ke.has(Oe.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>p(U),"aria-expanded":!xe,"aria-controls":`alias-strategy-body-${U}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${xe?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",U+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[ie,Y.autoDetect?"  auto-detect":"",pe?`  ${pe}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>v(U),"aria-label":`Remove alias strategy ${U+1}`,children:"Remove"})]}),!xe&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${U}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[u.map(Oe=>{const Te=Oe.value===Y.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${Te?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":Te,onClick:()=>x(U,Oe.value),children:Oe.label},Oe.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>K(U,Y.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:Z.guidance})]}),H.index===U&&H.mode===Y.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:Ef[Y.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:J,children:"Close"})]}),a.jsx("p",{children:Ef[Y.mode].description}),Ef[Y.mode].preview&&a.jsx("ul",{children:Ef[Y.mode].preview.map(([Oe,Te])=>a.jsxs("li",{children:[Oe," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",Te]},`${Oe}-${Te}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${U}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${U}-auto-detect`,type:"checkbox",checked:Y.autoDetect,onChange:Oe=>j(U,Oe.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${U}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),l.length?a.jsxs(a.Fragment,{children:[Qe.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",ie.toLowerCase()," entries."]}),He.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${U+1}`,children:He.map(Oe=>{const Te=Y.columns.includes(Oe.name),ot=Bx(Oe.samples.length?Oe.samples:i[Oe.name]??[]),rn=(le.get(Oe.name)??0)-(Te?1:0)>0,ve=Qe.has(Oe.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Te?" canvas-imputer__column-pill--selected":""}`,onClick:()=>S(U,Oe.name),"aria-pressed":Te,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Oe.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Oe.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Oe.dtype}),Oe.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!Oe.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),ve&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),rn&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),ot&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",ot]})]},Oe.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),st.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>W(U),"aria-expanded":Ve,"aria-controls":`alias-strategy-${U}-other-columns`,children:Ve?"Hide other columns":`Show other columns (${st.length})`}),Ve&&a.jsx("div",{id:`alias-strategy-${U}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${U+1}`,children:st.map(Oe=>{const Te=Y.columns.includes(Oe.name),ot=Bx(Oe.samples.length?Oe.samples:i[Oe.name]??[]),rn=(le.get(Oe.name)??0)-(Te?1:0)>0,ve=Qe.has(Oe.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Te?" canvas-imputer__column-pill--selected":""}`,onClick:()=>S(U,Oe.name),"aria-pressed":Te,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Oe.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Oe.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Oe.dtype}),!Oe.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),ve&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),rn&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),ot&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",ot]})]},Oe.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${Y.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:Y.columns.length?Y.columns.map(Oe=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:Oe},Oe)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${U}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${U}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:ht,onChange:Oe=>k(U,Oe.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),Y.mode==="custom"&&m&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Ne?M(m):ze?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${U}`)})}),d.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[d.totalPairs," custom pair",d.totalPairs===1?"":"s"," captured.",ee?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",d.previewPairs.length>0?` Examples: ${d.previewPairs.join("; ")}${d.previewOverflow>0?"...":""}`:""]}),d.totalPairs===0&&ee&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),$>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",R?`: ${R}`:"",d.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),F>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",F," incomplete pair",F===1?"":"s",".",B?` Examples: ${B}${d.invalidOverflow>0?"...":""}`:""]})]})},kf=["iso_date","iso_datetime","month_day_year","day_month_year"],_A="iso_date",vA=["date","time","timestamp","datetime"],yA=3,Ux=36,nd={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},xg=kf.map(e=>({value:e,label:nd[e].label,guidance:nd[e].guidance,example:nd[e].example})),bA=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],qx=e=>e.length<=Ux?e:`${e.slice(0,Ux-1)}...`,Hx=e=>{if(!e)return!1;const t=e.toLowerCase();return vA.some(n=>t.includes(n))},xA=e=>bA.some(t=>t.test(e)),Vx=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&kf.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&kf.includes(r)?r:_A},wA=e=>{const t=[];return Object.entries(e).forEach(([n,r])=>{if(!r||!r.length)return;const l=r.length;let i=0;if(r.forEach(d=>{xA(d)&&(i+=1)}),!l)return;i/l>=.6&&i>=2&&t.push(n)}),t.sort((n,r)=>n.localeCompare(r)),t},jA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const l=Array.from(new Set(ut(e)));l.sort((_,x)=>_.localeCompare(x));const i=new Set(l),u=t.filter(_=>Hx(n[_]??null)),d=wA(r),m=new Set;u.forEach(_=>{i.has(_)||m.add(_)}),d.forEach(_=>{i.has(_)||m.add(_)});const y=Array.from(m);y.sort((_,x)=>_.localeCompare(x));const p=l.filter(_=>!(Hx(n[_]??null)||d.includes(_))),v=d.slice().sort((_,x)=>_.localeCompare(x));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:y,nonDateSelected:p,dateColumnCount:u.length,sampleCandidateCount:d.length,sampleCandidates:v}},NA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&kf.includes(n)?n:t},SA=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},Wx=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,r=e.map(l=>{if(!l||typeof l!="object")return null;const i=ut(l.columns),u=Array.from(new Set(i.map(p=>p.trim()).filter(Boolean))).sort((p,v)=>p.localeCompare(v)),d=NA(l.mode,t.mode),m=SA(l.auto_detect??l.autoDetect??l.auto),y=`${d}|${u.join(",")}|${m?"auto":"manual"}`;return n.has(y)?null:(n.add(y),{mode:d,columns:u,autoDetect:m})}).filter(l=>!!l);return r.length?r:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},CA=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),EA=e=>{var t;return((t=nd[e])==null?void 0:t.label)??nd.iso_date.label},kA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?qx(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?qx(t):null},MA=(e,t=yA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([l,i])=>{const u=typeof l=="string"?l.trim():"";if(!u)return;const d=kA(i);if(!d)return;const m=n[u]??[];m.includes(d)||m.length>=t||(n[u]=[...m,d])})}),n},AA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},Kx=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},OA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:r,columnOptions:l,sampleMap:i,collapsedStrategies:u,onToggleStrategy:d,onRemoveStrategy:m,onAddStrategy:y,onModeChange:p,onColumnToggle:v,onColumnsChange:_,onAutoDetectToggle:x,modeOptions:j=xg})=>{const S=n.length>0,k=f.useMemo(()=>n.some($=>$.autoDetect),[n]),[M,P]=f.useState(()=>new Set),T=f.useCallback($=>{P(F=>{const R=new Set(F);return R.has($)?R.delete($):R.add($),R})},[]);f.useEffect(()=>{P($=>{const F=new Set;return $.forEach(R=>{R<n.length&&F.add(R)}),F.size===$.size?$:F})},[n.length]);const w=f.useMemo(()=>{const $=new Map;return n.forEach(F=>{F.columns.forEach(R=>{const B=R.trim();B&&$.set(B,($.get(B)??0)+1)})}),$},[n]),A=f.useMemo(()=>{const $=r.recommendedColumns.slice(0,6),F=Math.max(r.recommendedColumns.length-$.length,0);return{preview:$,remaining:F}},[r.recommendedColumns]),E=f.useMemo(()=>{const $=r.nonDateSelected.slice(0,4),F=Math.max(r.nonDateSelected.length-$.length,0);return{preview:$,remaining:F}},[r.nonDateSelected]),D=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:y,children:"Add strategy"})})]}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),A.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",A.preview.join(", "),A.remaining>0?`,  (${A.remaining} more)`:"",".",k?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),r.sampleCandidates.length===0&&!A.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"looks":"look"," non-date-like.",E.remaining>0?` ${E.remaining} more selected column${E.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),k&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",r.sampleCandidateCount||r.dateColumnCount," date-like columns that are not already assigned."]}),S?a.jsx("div",{className:"canvas-imputer__list",children:n.map(($,F)=>{var J,te;const R=((J=j.find(Y=>Y.value===$.mode))==null?void 0:J.label)??EA($.mode),B=$.columns.length,ee=B?`${B} column${B===1?"":"s"}`:$.autoDetect?"Auto-detecting columns":"No columns yet",le=u.has(F),z=$.columns.join(", "),G=`date-strategy-${F}-toggle`,W=`date-strategy-${F}-auto-detect`,H=l.map(Y=>({option:Y,priority:Y.isRecommended?0:Y.isSampleCandidate?1:2})).sort((Y,U)=>Y.priority!==U.priority?Y.priority-U.priority:Y.option.name.localeCompare(U.option.name)).map(Y=>Y.option),V=H.filter(Y=>$.columns.includes(Y.name)?!0:Y.isRecommended||Y.isSampleCandidate),ne=new Set(V.map(Y=>Y.name)),Q=H.filter(Y=>!ne.has(Y.name)),K=M.has(F);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:G,className:"canvas-imputer__card-toggle",onClick:()=>d(F),"aria-expanded":!le,"aria-controls":`date-strategy-body-${F}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${le?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",F+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[R,$.autoDetect?"  auto-detect":"",ee?`  ${ee}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>m(F),"aria-label":`Remove date formatting strategy ${F+1}`,children:"Remove"})]}),!le&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${F}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${F}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${F}-mode`,value:$.mode,onChange:Y=>p(F,Y.target.value),children:j.map(Y=>a.jsx("option",{value:Y.value,children:Y.label},Y.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((te=j.find(Y=>Y.value===$.mode))==null?void 0:te.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:W,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:W,type:"checkbox",checked:$.autoDetect,onChange:Y=>x(F,Y.target.checked)}),a.jsx("label",{htmlFor:W,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),H.length?a.jsxs(a.Fragment,{children:[V.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:V.map(Y=>{const U=$.columns.includes(Y.name),Z=Kx(Y.samples.length?Y.samples:i[Y.name]??[]),re=(w.get(Y.name)??0)-(U?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${U?" canvas-imputer__column-pill--selected":""}`,onClick:()=>v(F,Y.name),"aria-pressed":U,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Y.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Y.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Y.dtype}),Y.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!Y.isRecommended&&Y.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),re&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Z&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Z]})]},Y.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),Q.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>T(F),"aria-expanded":K,"aria-controls":`date-strategy-${F}-other-columns`,children:K?"Hide other columns":`Show other columns (${Q.length})`}),K&&a.jsx("div",{id:`date-strategy-${F}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:Q.map(Y=>{const U=$.columns.includes(Y.name),Z=Kx(Y.samples.length?Y.samples:i[Y.name]??[]),re=(w.get(Y.name)??0)-(U?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${U?" canvas-imputer__column-pill--selected":""}`,onClick:()=>v(F,Y.name),"aria-pressed":U,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:Y.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[Y.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:Y.dtype}),re&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),Z&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Z]})]},Y.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${$.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:$.columns.length?$.columns.map(Y=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:Y},Y)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${F}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${F}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:z,onChange:Y=>_(F,Y.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${F}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},Yx=["both","leading","trailing"],Qx="both",PA=["string","object","text","category","mixed","varchar","char"],TA=3,Gx=36,Xx=6,$A=4,DA=5,Jx={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},LA=e=>e.length<=Gx?e:`${e.slice(0,Gx-1)}...`,Zx=e=>{if(!e)return!1;const t=e.toLowerCase();return PA.some(n=>t.includes(n))},zA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${LA(t)}'`},RA=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,FA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Yx.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&Yx.includes(r)?r:Qx},IA=e=>{const t=Jx[e]??Jx[Qx];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},BA=e=>{const t=[];return Object.entries(e).forEach(([n,r])=>{if(!r.length)return;const l=r.reduce((u,d)=>d.hasIssue?u+1:u,0);if(!l)return;const i=l/r.length;(l>=2||i>=.5)&&t.push(n)}),t.sort((n,r)=>n.localeCompare(r)),t},UA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const l=Array.from(new Set(ut(e)));l.sort((v,_)=>v.localeCompare(_));const i=new Set(l),u=t.filter(v=>Zx(n[v]??null)),d=BA(r),m=new Set;u.forEach(v=>{i.has(v)||m.add(v)}),d.forEach(v=>{i.has(v)||m.add(v)});const y=Array.from(m).sort((v,_)=>v.localeCompare(_)),p=l.filter(v=>!Zx(n[v]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:y,nonTextSelected:p,textColumnCount:u.length,whitespaceCandidateCount:d.length,whitespaceCandidates:d}},wg=(e,t)=>e.slice(0,t),qA=e=>{const t=wg(e,Xx);return{preview:t,remaining:Math.max(e.length-t.length,0)}},HA=e=>{const t=wg(e,$A);return{preview:t,remaining:Math.max(e.length-t.length,0)}},VA=e=>{const t=wg(e,Xx);return{preview:t,remaining:Math.max(e.length-t.length,0)}},WA=(e,t=TA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([l,i])=>{const u=typeof l=="string"?l.trim():"";if(!u)return;let d="";if(i==null)d="";else if(typeof i=="string")d=i;else if(typeof i=="number"||typeof i=="boolean")d=String(i);else try{d=JSON.stringify(i)}catch{d=String(i)}if(!d.length)return;const m=RA(d),y=zA(d),p=n[u]??[];p.find(v=>v.value===y)||p.length>=t||(n[u]=[...p,{value:y,hasIssue:m}])})}),n},KA=(e,t,n=DA)=>{if(!t.length)return[];const r=[];for(const l of t){if(r.length>=n)break;const i=e[l];!i||!i.length||r.push({column:l,values:i.map(u=>u.value),overflow:0})}return r},YA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},QA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,renderMultiSelectField:l,renderParameterField:i,columnSummary:u,modeDetails:d,sampleMap:m})=>{if(!n&&!r)return null;const y=u.selectedColumns.length,p=qA(u.recommendedColumns),v=HA(u.nonTextSelected),_=VA(u.whitespaceCandidates),x=KA(m,u.selectedColumns),j=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:y})," column",y===1?"":"s"," for trimming."]}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",x.map(S=>`${S.column} (${S.values.join(", ")})`).join("; "),"."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),p.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",p.preview.join(", "),p.remaining>0?`, ... (${p.remaining} more)`:"","."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[v.preview.join(", ")," ",v.preview.length===1?"is":"are"," not text-like.",v.remaining>0?` ${v.remaining} more column${v.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),j?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),l(n)]}),r&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(r)})]})},e0=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],t0="keep_alphanumeric",GA=["string","object","text","category","mixed","varchar","char"],XA=3,n0=36,JA=6,ZA=4,eO=5,s0={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},tO=e=>e.length<=n0?e:`${e.slice(0,n0-1)}...`,nO=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${tO(t)}'`},r0=e=>{if(!e)return!1;const t=e.toLowerCase();return GA.some(n=>t.includes(n))},sO=e=>/[^0-9A-Za-z\s]/.test(e),rO=e=>/[A-Za-z]/.test(e),aO=e=>/[0-9]/.test(e),oO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&e0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&e0.includes(r)?r:t0},lO=e=>{const t=s0[e]??s0[t0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},iO=e=>{const t=new Set,n=new Set,r=new Set;Object.entries(e).forEach(([d,m])=>{if(!m.length)return;let y=0,p=0,v=0;m.forEach(_=>{_.hasSpecial&&(y+=1),_.hasDigits&&(p+=1),_.hasLetters&&(v+=1)}),y>0&&t.add(d),p>0&&v===0&&n.add(d),v>0&&p===0&&r.add(d)});const l=Array.from(t).sort((d,m)=>d.localeCompare(m)),i=Array.from(n).sort((d,m)=>d.localeCompare(m)),u=Array.from(r).sort((d,m)=>d.localeCompare(m));return{specialCandidates:l,digitsOnlyCandidates:i,lettersOnlyCandidates:u}},cO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const l=Array.from(new Set(ut(e)));l.sort((x,j)=>x.localeCompare(j));const i=new Set(l),u=t.filter(x=>r0(n[x]??null)),{specialCandidates:d,digitsOnlyCandidates:m,lettersOnlyCandidates:y}=iO(r),p=new Set;u.forEach(x=>{i.has(x)||p.add(x)}),d.forEach(x=>{i.has(x)||p.add(x)});const v=Array.from(p).sort((x,j)=>x.localeCompare(j)),_=l.filter(x=>!r0(n[x]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:v,nonTextSelected:_,textColumnCount:u.length,specialCandidateCount:d.length,specialCandidates:d,digitsOnlyCandidates:m,lettersOnlyCandidates:y}},a0=(e,t)=>e.slice(0,t),uO=e=>{const t=a0(e,JA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Mf=e=>{const t=a0(e,ZA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},dO=(e,t=XA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([l,i])=>{const u=typeof l=="string"?l.trim():"";if(!u)return;let d="";if(i==null)d="";else if(typeof i=="string")d=i;else if(typeof i=="number"||typeof i=="boolean")d=String(i);else try{d=JSON.stringify(i)}catch{d=String(i)}if(!d.length)return;const m=nO(d),y=sO(d),p={value:m,hasSpecial:y,hasDigits:aO(d),hasLetters:rO(d)},v=n[u]??[];v.find(_=>_.value===m)||v.length>=t||(n[u]=[...v,p])})}),n},mO=(e,t,n=eO)=>{if(!t.length)return[];const r=[];for(const l of t){if(r.length>=n)break;const i=e[l];!i||!i.length||r.push({column:l,values:i.map(u=>u.value),overflow:0})}return r},fO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},hO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,replacementParameter:l,renderMultiSelectField:i,renderParameterField:u,columnSummary:d,modeDetails:m,sampleMap:y})=>{if(!n&&!r&&!l)return null;const p=d.selectedColumns.length,v=uO(d.recommendedColumns),_=Mf(d.specialCandidates),x=Mf(d.digitsOnlyCandidates),j=Mf(d.lettersOnlyCandidates),S=Mf(d.nonTextSelected),k=mO(y,d.selectedColumns),M=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:m.label})," mode. ",m.guidance," Example: ",m.example,"."]}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for cleanup."]}),k.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",k.map(P=>`${P.column} (${P.values.join(", ")})`).join("; "),"."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"",". Consider `digits only` mode."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"",". Consider `letters only` mode."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.preview.join(", ")," ",S.preview.length===1?"is":"are"," not text-like.",S.remaining>0?` ${S.remaining} more column${S.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),M?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),i(n)]}),(r||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[r?u(r):null,l?u(l):null]})]})},o0=["lower","upper","title","sentence"],l0="lower",pO=["string","object","text","category","mixed","varchar","char"],gO=3,i0=60,_O=6,vO=4,yO=5,c0={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},bO=e=>e.length<=i0?e:`${e.slice(0,i0-1)}...`,u0=e=>{if(!e)return!1;const t=e.toLowerCase();return pO.some(n=>t.includes(n))},sd=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${bO(t)}'`},xO=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),wO=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),jO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&o0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&o0.includes(r)?r:l0},NO=e=>{const t=c0[e]??c0[l0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},SO=(e,t)=>{const n=[];return Object.entries(e).forEach(([r,l])=>{if(!l.length)return;l.some(u=>{const d=u[t];return u.original!==d})&&n.push(r)}),n.sort((r,l)=>r.localeCompare(l)),n},CO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r,mode:l})=>{const i=Array.from(new Set(ut(e)));i.sort((_,x)=>_.localeCompare(x));const u=new Set(i),d=t.filter(_=>u0(n[_]??null)),m=SO(r,l),y=new Set;d.forEach(_=>{u.has(_)||y.add(_)}),m.forEach(_=>{u.has(_)||y.add(_)});const p=Array.from(y).sort((_,x)=>_.localeCompare(x)),v=i.filter(_=>!u0(n[_]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:p,nonTextSelected:v,textColumnCount:d.length,inconsistentColumns:m}},d0=(e,t)=>e.slice(0,t),EO=e=>{const t=d0(e,_O);return{preview:t,remaining:Math.max(e.length-t.length,0)}},m0=e=>{const t=d0(e,vO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},kO=(e,t=gO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([l,i])=>{const u=typeof l=="string"?l.trim():"";if(!u)return;let d="";if(i==null)d="";else if(typeof i=="string")d=i;else if(typeof i=="number"||typeof i=="boolean")d=String(i);else try{d=JSON.stringify(i)}catch{d=String(i)}if(!d.length)return;const m=sd(d),y={original:m,lower:sd(d.toLowerCase()),upper:sd(d.toUpperCase()),title:sd(xO(d)),sentence:sd(wO(d))},p=n[u]??[];p.find(v=>v.original===m)||p.length>=t||(n[u]=[...p,y])})}),n},MO=(e,t,n,r=yO)=>{if(!t.length)return[];const l=[];for(const i of t){if(l.length>=r)break;const u=e[i];if(!u||!u.length)continue;const d=u.map(m=>`${m.original}  ${m[n]}`);l.push({column:i,values:d,overflow:0})}return l},AO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},OO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,renderMultiSelectField:l,renderParameterField:i,columnSummary:u,modeDetails:d,sampleMap:m,selectedMode:y})=>{if(!n&&!r)return null;const p=u.selectedColumns.length,v=EO(u.recommendedColumns),_=m0(u.inconsistentColumns),x=m0(u.nonTextSelected),j=MO(m,u.selectedColumns,y),S=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:p})," column",p===1?"":"s"," for case normalization."]}),j.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",j.map(k=>`${k.column} (${k.values.join("; ")})`).join(" | "),"."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"","."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[x.preview.join(", ")," ",x.preview.length===1?"is":"are"," not text-like.",x.remaining>0?` ${x.remaining} more column${x.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),S?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),l(n)]}),r&&a.jsx("div",{className:"canvas-modal__parameter-list",children:i(r)})]})},f0=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],h0="preset_digits_only",PO=["string","object","text","category","mixed","varchar","char"],TO=3,p0=60,$O=6,DO=4,LO=5,g0={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},zO=e=>e.length<=p0?e:`${e.slice(0,p0-1)}...`,rd=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${zO(t)}'`},_0=e=>{if(!e)return!1;const t=e.toLowerCase();return PO.some(n=>t.includes(n))},RO=e=>e.replace(/\s+/g," ").trim(),FO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&f0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&f0.includes(r)?r:h0},IO=e=>{const t=g0[e]??g0[h0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},BO=e=>{const t=new Set,n=new Set,r=new Set;Object.entries(e).forEach(([i,u])=>{u.length&&u.forEach(d=>{d.hasDigits&&t.add(i),d.hasLetters&&n.add(i),d.hasWhitespaceRuns&&r.add(i)})});const l=i=>Array.from(i).sort((u,d)=>u.localeCompare(d));return{digits:l(t),letters:l(n),whitespace:l(r)}},UO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const l=Array.from(new Set(ut(e)));l.sort((x,j)=>x.localeCompare(j));const i=new Set(l),u=t.filter(x=>_0(n[x]??null)),{digits:d,letters:m,whitespace:y}=BO(r),p=new Set;u.forEach(x=>{i.has(x)||p.add(x)}),[...d,...m,...y].forEach(x=>{i.has(x)||p.add(x)});const v=Array.from(p).sort((x,j)=>x.localeCompare(j)),_=l.filter(x=>!_0(n[x]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:v,nonTextSelected:_,textColumnCount:u.length,digitsCandidates:d,lettersCandidates:m,whitespaceCandidates:y}},v0=(e,t)=>e.slice(0,t),qO=e=>{const t=v0(e,$O);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Af=e=>{const t=v0(e,DO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},HO=(e,t=TO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([l,i])=>{const u=typeof l=="string"?l.trim():"";if(!u)return;let d="";if(i==null)d="";else if(typeof i=="string")d=i;else if(typeof i=="number"||typeof i=="boolean")d=String(i);else try{d=JSON.stringify(i)}catch{d=String(i)}if(!d.length)return;const m=rd(d),y={original:m,presetDigits:rd(d.replace(/\D+/g,"")),presetLetters:rd(d.replace(/[^A-Za-z]+/g,"")),presetWhitespace:rd(RO(d)),hasDigits:/\d/.test(d),hasLetters:/[A-Za-z]/.test(d),hasWhitespaceRuns:/\s{2,}/.test(d)||/\t|\n|\r/.test(d)},p=n[u]??[];p.find(v=>v.original===m)||p.length>=t||(n[u]=[...p,y])})}),n},VO=(e,t,n)=>{const r=n??"",l=i=>i.length?i:"''";switch(t){case"preset_letters_only":return`${l(e.original)}  ${l(e.presetLetters)}`;case"preset_whitespace_collapse":return`${l(e.original)}  ${l(e.presetWhitespace)}`;case"custom":try{const i=new RegExp(r.split("|||")[0]??"",r.split("|||")[1]??""),u=rd(e.original.replace(i,r.split("|||")[2]??""));return`${l(e.original)}  ${l(u)}`}catch{return`${l(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${l(e.original)}  ${l(e.presetDigits)}`}},WO=(e,t,n,r,l=LO)=>{if(!t.length)return[];const i=[];for(const u of t){if(i.length>=l)break;const d=e[u];if(!d||!d.length)continue;const m=d.map(y=>VO(y,n,r));i.push({column:u,values:m,overflow:0})}return i},KO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},YO=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",r=t[1]??"",l=t[2]??"";return!n.trim()&&!l.trim()?null:`Pattern: /${n||"(empty)"}/${r||"(none)"} Replacement: ${l||"''"}`},QO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,patternParameter:l,replacementParameter:i,renderMultiSelectField:u,renderParameterField:d,columnSummary:m,modeDetails:y,sampleMap:p,selectedMode:v,replacementValue:_})=>{if(!n&&!r&&!l&&!i)return null;const x=m.selectedColumns.length,j=qO(m.recommendedColumns),S=Af(m.digitsCandidates),k=Af(m.lettersCandidates),M=Af(m.whitespaceCandidates),P=Af(m.nonTextSelected),T=YO(_),w=WO(p,m.selectedColumns,v,_),A=!e||!t,E=v==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:y.label})," mode. ",y.guidance," Example: ",y.example,"."]}),T&&a.jsx("p",{className:"canvas-modal__note",children:T}),m.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:x})," column",x===1?"":"s"," for regex cleanup."]}),w.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",w.map(D=>`${D.column} (${D.values.join("; ")})`).join(" | "),"."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",S.preview.join(", "),S.remaining>0?`, ... (${S.remaining} more)`:"","."]}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",k.preview.join(", "),k.remaining>0?`, ... (${k.remaining} more)`:"","."]}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",M.preview.join(", "),M.remaining>0?`, ... (${M.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),P.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[P.preview.join(", ")," ",P.preview.length===1?"is":"are"," not text-like.",P.remaining>0?` ${P.remaining} more column${P.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),E&&!T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),A?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),u(n)]}),(r||l||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[r?d(r):null,l?d(l):null,i?d(i):null]})]})},y0=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],b0="negative_to_nan",GO=["int","float","double","numeric","number","decimal","real","long"],XO=3,JO=6,ZO=4,eP=5,x0={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},tP=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},nP=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},sP=e=>{if(!e)return!1;const t=e.toLowerCase();return GO.some(n=>t.includes(n))},rP=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&y0.includes(n))return n;const r=typeof t=="string"?t.trim().toLowerCase():"";return r&&y0.includes(r)?r:b0},aP=e=>{const t=x0[e]??x0[b0];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},oP=e=>{const t=new Set,n=new Set,r=new Set,l=new Set;Object.entries(e).forEach(([u,d])=>{d.forEach(m=>{m.isNegative&&t.add(u),m.isZero&&n.add(u),(m.numericValue<0||m.numericValue>100)&&r.add(u),(m.numericValue<0||m.numericValue>120)&&l.add(u)})});const i=u=>Array.from(u).sort((d,m)=>d.localeCompare(m));return{negative:i(t),zeros:i(n),percentage:i(r),age:i(l)}},lP=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:r})=>{const l=Array.from(new Set(ut(e))).sort((j,S)=>j.localeCompare(S)),i=new Set(l),u=t.filter(j=>sP(n[j]??null)),d=new Set(u),{negative:m,zeros:y,percentage:p,age:v}=oP(r),_=new Set;u.forEach(j=>{i.has(j)||_.add(j)}),[...m,...y,...p,...v].forEach(j=>{i.has(j)||_.add(j)});const x=l.filter(j=>!d.has(j));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:Array.from(_).sort((j,S)=>j.localeCompare(S)),nonNumericSelected:x,numericColumnCount:u.length,negativeCandidates:m,zeroCandidates:y,percentageOutliers:p,ageOutliers:v}},iP=e=>{const t=e.slice(0,JO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},ad=e=>{const t=e.slice(0,ZO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},cP=(e,t=XO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(r=>{!r||typeof r!="object"||Object.entries(r).forEach(([l,i])=>{const u=typeof l=="string"?l.trim():"";if(!u)return;const d=nP(i);if(d===null)return;const m=tP(String(i)),y={originalDisplay:m,numericValue:d,isNegative:d<0,isZero:Math.abs(d)<=1e-9},p=n[u]??[];p.find(v=>v.originalDisplay===m)||p.length>=t||(n[u]=[...p,y])})}),n},uP=0,dP=100,mP=0,fP=120,hP=(e,t,n,r)=>{switch(t){case"negative_to_nan":{const l=n??0;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:r!==null&&e.numericValue>r?{flagged:!0,reason:`value > ${r}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const l=n??uP,i=r??dP;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"age_bounds":{const l=n??mP,i=r??fP;return e.numericValue<l?{flagged:!0,reason:`value < ${l}`}:e.numericValue>i?{flagged:!0,reason:`value > ${i}`}:{flagged:!1,reason:null}}case"custom_range":default:{const l=n!=null,i=r!=null;return!l&&!i?{flagged:!1,reason:null}:l&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:i&&e.numericValue>r?{flagged:!0,reason:`value > ${r}`}:{flagged:!1,reason:null}}}},pP=(e,t,n,r)=>{const{flagged:l,reason:i}=hP(e,t,n,r);return l?`${e.originalDisplay}  flagged (${i??"rule match"})`:`${e.originalDisplay}  ok`},gP=(e,t,n,r,l,i=eP)=>{if(!t.length)return[];const u=[];for(const d of t){if(u.length>=i)break;const m=e[d];!m||!m.length||u.push({column:d,values:m.map(y=>pP(y,n,r,l)),overflow:0})}return u},_P={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},vP=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const r=t===null?"-":String(t),l=n===null?"":String(n);return`Custom bounds active: [${r}, ${l}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const r=t??0;return n===null?`Negative-to-missing rule overrides values below ${r}.`:`Negative-to-missing rule overrides values < ${r} or > ${n}.`}return null},yP=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:r,minValueParameter:l,maxValueParameter:i,renderMultiSelectField:u,renderParameterField:d,columnSummary:m,modeDetails:y,sampleMap:p,selectedMode:v,minValue:_,maxValue:x})=>{if(!n&&!r&&!l&&!i)return null;const{selectedColumns:j,autoDetectionActive:S}=m,k=j.length,M=iP(m.recommendedColumns),P=ad(m.negativeCandidates),T=ad(m.zeroCandidates),w=ad(m.percentageOutliers),A=ad(m.ageOutliers),E=ad(m.nonNumericSelected),D=gP(p,j,v,_,x),$=vP(v,_,x),F=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:y.label})," rule. ",y.guidance," Example: ",y.example,"."]}),$&&a.jsx("p",{className:"canvas-modal__note",children:$}),S?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:k})," column",k===1?"":"s"," for invalid value cleanup."]}),D.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",D.map(R=>`${R.column} (${R.values.join("; ")})`).join(" | "),"."]}),P.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",P.preview.join(", "),P.remaining>0?`, ... (${P.remaining} more)`:"","."]}),T.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",T.preview.join(", "),T.remaining>0?`, ... (${T.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"","."]}),A.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",A.preview.join(", "),A.remaining>0?`, ... (${A.remaining} more)`:"","."]}),M.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",M.preview.join(", "),M.remaining>0?`, ... (${M.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"is":"are"," not numeric-type columns.",E.remaining>0?` ${E.remaining} more column${E.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),F?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),u(n)]}),(r||l||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[r?d(r):null,l?d(l):null,i?d(i):null]})]})};let bP="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",w0=(e=21)=>{let t="",n=e|0;for(;n--;)t+=bP[Math.random()*64|0];return t};const j0=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],N0=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],S0=[{value:"token_sort_ratio",label:"Token sort ratio"},{value:"token_set_ratio",label:"Token set ratio"},{value:"ratio",label:"Basic ratio"}],Of=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],xP=new Set(Of.map(e=>e.value)),uc=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],od="UTC",Pf=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Pf(e.split(",")):[]:[],C0=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(r=>{const l=Number(r);Number.isFinite(l)&&n.push(l)}),n}if(typeof e=="string")return C0(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},jg=e=>{const t=Number(e);return Number.isFinite(t)?t:null},E0=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},wP=(e,t)=>{var r,l,i,u,d;if(typeof t!="string")return((r=uc.find(m=>m.value===e))==null?void 0:r.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((i=j0.find(m=>m.value===n))==null?void 0:i.value)??"add":e==="stat"?((u=N0.find(m=>m.value===n))==null?void 0:u.value)??"mean":e==="similarity"?((d=S0.find(m=>m.value===n))==null?void 0:d.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((l=uc.find(m=>m.value===e))==null?void 0:l.defaultMethod)??""},jP=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},NP=e=>{const t=Pf(e);return t.length?t.filter(n=>xP.has(n)):["year","month","day"]},SP=e=>typeof e!="string"?od:e.trim()||od,k0=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,r)=>{if(!n||typeof n!="object")return;const l=n,i=jP(l.operation_type??l.type),u=l.operation_id??l.id??`feature_math_${r+1}`,d=typeof u=="string"&&u.trim()?u.trim():`feature_math_${r+1}`,m=wP(i,l.method),y=Pf(l.input_columns??l.inputs??l.inputColumns),p=Pf(l.secondary_columns??l.denominator??l.secondaryColumns),v=C0(l.constants),_=typeof l.output_column=="string"?l.output_column.trim():"",x=typeof l.output_prefix=="string"?l.output_prefix.trim():"",j=i==="datetime_extract"?NP(l.datetime_features):[],S=i==="datetime_extract"?SP(l.timezone):od,k=jg(l.fillna),M=(()=>{const E=jg(l.round??l.round_digits);return Number.isInteger(E??NaN),E})(),P=jg(l.epsilon),T=i==="similarity"?E0(l.normalize,!1):!1,w=l.allow_overwrite===void 0?null:E0(l.allow_overwrite,!1),A=typeof l.description=="string"?l.description:void 0;t.push({id:d,type:i,method:m,inputColumns:y,secondaryColumns:p,constants:v,outputColumn:_,outputPrefix:x,datetimeFeatures:j,timezone:S,fillna:k,roundDigits:M,normalize:T,epsilon:P,allowOverwrite:w,description:A})}),t},CP=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||od):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},EP=e=>e.map(t=>CP(t)),kP={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},M0=(e,t)=>{var l;const n=kP[e]??{};let r=`math_${e}_${w0(6)}`;for(;t.has(r);)r=`math_${e}_${w0(6)}`;return{id:r,type:e,method:n.method??((l=uc.find(i=>i.value===e))==null?void 0:l.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:od,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},MP=(e,t)=>{const n=new Map;return t==null||t.forEach(r=>{r.operations.forEach(l=>{n.has(l.operation_id)||n.set(l.operation_id,l)})}),e.map((r,l)=>{const i=n.get(r.id),u=`${l+1}. ${r.type.replace("_"," ")}${r.method?`  ${r.method}`:""}`;return{id:r.id,label:u,status:i==null?void 0:i.status,message:(i==null?void 0:i.message)??void 0,outputColumns:(i==null?void 0:i.output_columns)??[]}})},A0=e=>e==="arithmetic"?j0:e==="stat"?N0:e==="similarity"?S0:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],AP={applied:"Applied",skipped:"Skipped",failed:"Failed"},OP={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},PP=new Set(Of.map(e=>e.value)),TP=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),r=e.length-n.length;return r>0?`${n.join(", ")}  (${r} more)`:n.join(", ")},O0=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],$P=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],DP=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",LP=({index:e,total:t,operation:n,summary:r,availableColumns:l,isCollapsed:i,onToggleCollapsed:u,onDuplicate:d,onRemove:m,onReorder:y,onChange:p})=>{var ie;const v=f.useMemo(()=>A0(n.type),[n.type]),_=f.useMemo(()=>{var re;return((re=uc.find(pe=>pe.value===n.type))==null?void 0:re.label)??n.type},[n.type]),x=f.useMemo(()=>{var re;return((re=v.find(pe=>pe.value===n.method))==null?void 0:re.label)??n.method},[v,n.method]),[j,S]=f.useState(n.inputColumns.join(", ")),[k,M]=f.useState(n.secondaryColumns.join(", ")),[P,T]=f.useState(n.constants.join(", "));f.useEffect(()=>{S(n.inputColumns.join(", "))},[n.inputColumns]),f.useEffect(()=>{M(n.secondaryColumns.join(", "))},[n.secondaryColumns]),f.useEffect(()=>{T(n.constants.join(", "))},[n.constants]);const w=()=>{p(n.id,{inputColumns:O0(j)})},A=()=>{p(n.id,{secondaryColumns:O0(k)})},E=()=>{p(n.id,{constants:$P(P)})},D=`feature-math-toggle-${n.id}`,$=`feature-math-body-${n.id}`,F=`feature-math-input-columns-${n.id}`,R=`feature-math-secondary-columns-${n.id}`,B=r==null?void 0:r.status,ee=B?a.jsx("span",{className:`canvas-cast__chip ${OP[B]??""}`,style:{marginLeft:"0.5rem"},children:AP[B]}):null,le=r!=null&&r.message?r.message.trim():"",z=DP(B),G=(ie=r==null?void 0:r.outputColumns)!=null&&ie.length?r.outputColumns.join(", "):"",W=TP(n.inputColumns),H=n.type==="ratio"||n.type==="similarity",V=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",ne=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",Q=n.type==="similarity",K=n.type==="datetime_extract",J=n.type==="stat"||n.type==="datetime_extract",te=f.useMemo(()=>{if(!l.length)return"";const re=l.slice(0,6),pe=l.length-re.length;return pe>0?`${re.join(", ")}  (${pe} more)`:re.join(", ")},[l]),Y=re=>{if(!re||!PP.has(re))return;const pe=new Set(n.datetimeFeatures);pe.has(re)?pe.delete(re):pe.add(re),p(n.id,{datetimeFeatures:Array.from(pe)})},U=re=>pe=>{const xe=pe.target.value;if(xe===""){p(n.id,{[re]:null});return}const Ve=Number(xe);Number.isFinite(Ve)&&(re==="roundDigits"?p(n.id,{roundDigits:Math.round(Ve)}):re==="fillna"?p(n.id,{fillna:Ve}):p(n.id,{epsilon:Ve}))},Z=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:D,className:"canvas-imputer__card-toggle",onClick:()=>u(n.id),"aria-expanded":!i,"aria-controls":$,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${i?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[_,x?`  ${x}`:"",n.outputColumn?`   ${n.outputColumn}`:"",ee]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",W]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>m(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!i&&a.jsxs("div",{className:"canvas-imputer__card-body",id:$,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>d(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>y(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>y(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),le&&a.jsx("p",{className:z,children:le}),G&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",G]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:re=>p(n.id,{type:re.target.value}),children:uc.map(re=>a.jsx("option",{value:re.value,children:re.label},re.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:re=>p(n.id,{method:re.target.value}),children:v.map(re=>a.jsx("option",{value:re.value,children:re.label},re.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:j,onChange:re=>S(re.target.value),onBlur:w,onKeyDown:re=>{re.key==="Enter"&&(re.preventDefault(),w())},placeholder:"col_a, col_b",list:F}),a.jsx("datalist",{id:F,children:l.map(re=>a.jsx("option",{value:re},`${n.id}-input-option-${re}`))}),te&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",te]})]}),H&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:k,onChange:re=>M(re.target.value),onBlur:A,onKeyDown:re=>{re.key==="Enter"&&(re.preventDefault(),A())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:R}),a.jsx("datalist",{id:R,children:l.map(re=>a.jsx("option",{value:re},`${n.id}-secondary-option-${re}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),V&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:P,onChange:re=>T(re.target.value),onBlur:E,onKeyDown:re=>{re.key==="Enter"&&(re.preventDefault(),E())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:re=>p(n.id,{outputColumn:re.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),J&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:re=>p(n.id,{outputPrefix:re.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),ne&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:U("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:U("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:U("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),Q&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:re=>p(n.id,{normalize:re.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),K&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:Of.map(re=>{const pe=`feature-math-${n.id}-datetime-${re.value}`,xe=n.datetimeFeatures.includes(re.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:pe,children:[a.jsx("input",{id:pe,type:"checkbox",checked:xe,onChange:()=>Y(re.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:re.label})]},re.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:re=>p(n.id,{timezone:re.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:Z,onChange:re=>{const pe=re.target.value;pe==="inherit"?p(n.id,{allowOverwrite:null}):p(n.id,{allowOverwrite:pe==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},zP=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:r,onAddOperation:l,onDuplicateOperation:i,onRemoveOperation:u,onReorderOperation:d,onOperationChange:m,availableColumns:y,signals:p,previewStatus:v,errorHandlingParameter:_,allowOverwriteParameter:x,defaultTimezoneParameter:j,epsilonParameter:S,renderParameterField:k,canResetNode:M=!1,onResetNode:P})=>{const[T,w]=f.useState("arithmetic"),A=f.useMemo(()=>{const R=new Map;return t.forEach(B=>{R.set(B.id,B)}),R},[t]),E=f.useMemo(()=>p.length?p[p.length-1]:null,[p]),D=(E==null?void 0:E.warnings)??[],$=E&&E.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",F=()=>{l(T)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("select",{value:T,onChange:R=>w(R.target.value),children:uc.map(R=>a.jsx("option",{value:R.value,children:R.label},R.value))}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:F,children:"Add operation"}),M&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:P,disabled:!P,children:"Reset node"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),v==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),E&&a.jsxs("p",{className:$,children:["Preview applied ",E.applied_operations," of ",E.total_operations," operation",E.total_operations===1?"":"s"," (",E.skipped_operations," skipped, ",E.failed_operations," failed)."]}),D.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:D.map((R,B)=>a.jsx("li",{children:R},`feature-math-warning-${B}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((R,B)=>a.jsx(LP,{index:B,total:e.length,operation:R,summary:A.get(R.id),availableColumns:y,isCollapsed:n.has(R.id),onToggleCollapsed:r,onDuplicate:i,onRemove:u,onReorder:d,onChange:m},R.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[_&&k(_),x&&k(x),j&&k(j),S&&k(S)]})]})},RP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},FP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},P0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),IP=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:l,metadata:i,columnsParameter:u,autoDetectParameter:d,maxUniqueParameter:m,outputSuffixParameter:y,dropOriginalParameter:p,missingStrategyParameter:v,missingCodeParameter:_,selectedColumns:x,renderParameterField:j,onToggleColumn:S,onApplyRecommended:k,formatMissingPercentage:M})=>{const P=f.useMemo(()=>{if(!l.length)return[];const E=new Set;return l.forEach(D=>{D.status==="recommended"&&D.selectable&&E.add(D.column)}),Array.from(E)},[l]),T=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),w=l.length>0,A=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>k(P),disabled:!P.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:T}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((E,D)=>a.jsx("li",{children:E},`label-encoding-note-${D}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!w&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&w&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(E=>{const D=x.includes(E.column),$=RP[E.status],F=FP[E.status]??"canvas-cast__chip--muted",R=E.sample_values.length?E.sample_values.join(", "):"",B=E.unique_count!==void 0&&E.unique_count!==null?`${P0(E.unique_count)} (${P0(E.unique_percentage)}%)`:"",ee=M(E.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:E.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[E.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",E.dtype]}),E.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:E.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",R]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:E.reason})]})}),a.jsx("td",{children:B}),a.jsx("td",{children:ee}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${F}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:D,onChange:()=>S(E.column),disabled:!E.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:E.selectable?D?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${E.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&j(d),m&&j(m),y&&j(y),p&&j(p),v&&j(v),_&&j(_)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),j(u)]})]})},BP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},UP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},T0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),qP=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:l,metadata:i,columnsParameter:u,targetColumnParameter:d,autoDetectParameter:m,maxCategoriesParameter:y,outputSuffixParameter:p,dropOriginalParameter:v,smoothingParameter:_,encodeMissingParameter:x,handleUnknownParameter:j,selectedColumns:S,renderParameterField:k,onToggleColumn:M,onApplyRecommended:P,formatMissingPercentage:T})=>{const w=f.useMemo(()=>{if(!l.length)return[];const $=new Set;return l.forEach(F=>{F.status==="recommended"&&F.selectable&&$.add(F.column)}),Array.from($)},[l]),A=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),E=l.length>0,D=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>P(w),disabled:!w.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:A}),!d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map(($,F)=>a.jsx("li",{children:$},`target-encoding-note-${F}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!E&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&E&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map($=>{const F=S.includes($.column),R=BP[$.status],B=UP[$.status]??"canvas-cast__chip--muted",ee=$.sample_values.length?$.sample_values.join(", "):"",le=$.unique_count!==void 0&&$.unique_count!==null?`${T0($.unique_count)} (${T0($.unique_percentage)}%)`:"",z=T($.missing_percentage),G=$.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:$.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[$.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",$.dtype]}),$.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:$.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",ee]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:$.reason})]})}),a.jsx("td",{children:le}),a.jsx("td",{children:z}),a.jsx("td",{children:G}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${B}`,children:R})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:F,onChange:()=>M($.column),disabled:!$.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:$.selectable?F?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${$.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&k(d),m&&k(m),y&&k(y),p&&k(p),v&&k(v),_&&k(_),x&&k(x),j&&k(j)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),k(u)]})]})},HP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},VP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},$0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),WP=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:l,metadata:i,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,bucketsParameter:y,outputSuffixParameter:p,dropOriginalParameter:v,encodeMissingParameter:_,selectedColumns:x,renderParameterField:j,onToggleColumn:S,onApplyRecommended:k,canResetNode:M=!1,onResetNode:P,formatMissingPercentage:T})=>{const w=f.useMemo(()=>{if(!l.length)return[];const F=new Set;return l.forEach(R=>{R.status==="recommended"&&R.selectable&&F.add(R.column)}),Array.from(F)},[l]),A=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),E=l.length>0,D=i.suggestedBucketDefault>0?`Default bucket suggestion: ${i.suggestedBucketDefault.toLocaleString()}.`:null,$=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>k(w),disabled:!w.length,children:"Add recommended"}),M&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:P,disabled:!P,children:"Reset node"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:A}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:D}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((F,R)=>a.jsx("li",{children:F},`hash-encoding-note-${R}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),$&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!E&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&E&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(F=>{const R=x.includes(F.column),B=HP[F.status],ee=VP[F.status]??"canvas-cast__chip--muted",le=F.sample_values.length?F.sample_values.join(", "):"",z=F.unique_count!==void 0&&F.unique_count!==null?`${$0(F.unique_count)} (${$0(F.unique_percentage)}%)`:"",G=T(F.missing_percentage),W=F.recommended_bucket_count?F.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:F.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[F.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",F.dtype]}),F.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:F.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",le]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:F.reason})]})}),a.jsx("td",{children:z}),a.jsx("td",{children:G}),a.jsx("td",{children:W}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${ee}`,children:B})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>S(F.column),disabled:!F.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:F.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${F.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&j(d),m&&j(m),y&&j(y),p&&j(p),v&&j(v),_&&j(_)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),j(u)]})]})},KP=({columnsParameter:e,autoDetectParameter:t,degreeParameter:n,includeBiasParameter:r,interactionOnlyParameter:l,includeInputFeaturesParameter:i,outputPrefixParameter:u,renderParameterField:d,signal:m,canResetNode:y=!1,onResetNode:p})=>{const v=f.useMemo(()=>[e,t,n,r,l,i,u].filter(P=>!!P),[e,t,n,r,l,i,u]),_=(m==null?void 0:m.generated_features)??[],x=(m==null?void 0:m.skipped_columns)??[],j=(m==null?void 0:m.filled_columns)??{},S=(m==null?void 0:m.notes)??[],k=(m==null?void 0:m.feature_count)??0,M=f.useMemo(()=>{const P=Object.entries(j);return P.length?P.map(([T,w])=>`${T} (${w.toLocaleString()} missing)`).join(", "):null},[j]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Polynomial feature settings"}),y&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:p,disabled:!p,children:"Reset node"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),v.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:v.map(P=>d(P))}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",x.join(", "),"."]}),M&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",M," before generating features."]}),k>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:_.map(P=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:P.column}),a.jsx("td",{children:P.expression||(P.terms.length?P.terms.join("  "):"1")}),a.jsx("td",{children:P.degree})]},`poly-feature-${P.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),S.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:S.map((P,T)=>a.jsx("li",{children:P},`polynomial-note-${T}`))})]})},D0=e=>!!e,ld=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},YP=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},L0=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),r=e.length-n.length;return r>0?`${n.join(", ")}  (${r} more)`:n.join(", ")},QP=({columnsParameter:e,autoDetectParameter:t,targetColumnParameter:n,methodParameter:r,scoreFuncParameter:l,problemTypeParameter:i,kParameter:u,percentileParameter:d,alphaParameter:m,thresholdParameter:y,modeParameter:p,estimatorParameter:v,stepParameter:_,minFeaturesParameter:x,maxFeaturesParameter:j,dropUnselectedParameter:S,renderParameterField:k,signal:M,canResetNode:P=!1,onResetNode:T})=>{const w=f.useMemo(()=>[e,t,n,r,l,i].filter(D0),[e,t,n,r,l,i]),A=f.useMemo(()=>[u,d,m,y,p,v,_,x,j,S].filter(D0),[u,d,m,y,p,v,_,x,j,S]),E=(M==null?void 0:M.configured_columns)??[],D=(M==null?void 0:M.evaluated_columns)??[],$=(M==null?void 0:M.selected_columns)??[],F=(M==null?void 0:M.dropped_columns)??[],R=(M==null?void 0:M.feature_summaries)??[],B=(M==null?void 0:M.notes)??[],ee=(M==null?void 0:M.drop_unselected)??!1,le=f.useMemo(()=>{if(!D.length&&!E.length)return null;if(D.length===E.length)return`Evaluated ${D.length.toLocaleString()} column(s).`;if(!E.length)return`Evaluated ${D.length.toLocaleString()} column(s) via auto-detect.`;const H=Math.max(D.length-E.length,0);return H>0?`Evaluated ${D.length.toLocaleString()} column(s) (${H.toLocaleString()} auto-detected).`:`Evaluated ${D.length.toLocaleString()} of ${E.length.toLocaleString()} configured column(s).`},[E,D]),z=f.useMemo(()=>{if(!M)return null;const H=[];return M.method&&H.push(`Method: ${M.method}`),M.score_func&&H.push(`Score: ${M.score_func}`),M.estimator&&H.push(`Estimator: ${M.estimator}`),M.problem_type&&M.problem_type!=="auto"&&H.push(`Problem: ${M.problem_type}`),M.target_column&&H.push(`Target: ${M.target_column}`),typeof M.k=="number"&&Number.isFinite(M.k)&&H.push(`k = ${M.k.toLocaleString()}`),typeof M.percentile=="number"&&Number.isFinite(M.percentile)&&H.push(`percentile = ${ld(M.percentile,2)}`),typeof M.alpha=="number"&&Number.isFinite(M.alpha)&&H.push(`alpha = ${ld(M.alpha,4)}`),M.threshold!==null&&M.threshold!==void 0&&Number.isFinite(M.threshold)&&H.push(`threshold = ${ld(M.threshold,4)}`),M.auto_detect&&H.push("Auto-detect enabled"),H.length?H.join("  "):null},[M]),G=f.useMemo(()=>L0($),[$]),W=f.useMemo(()=>L0(F),[F]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature selection settings"}),P&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:T,disabled:!T,children:"Reset node"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:z}),le&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:le}),w.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:w.map(H=>k(H))}),A.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:A.map(H=>k(H))}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:ee?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),$.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",$.length.toLocaleString()," column(s): ",G]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),F.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",F.length.toLocaleString()," column(s): ",W]}),R.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:R.map(H=>{const V=["canvas-cast__row"];return H.selected||V.push("canvas-cast__row--muted"),a.jsxs("tr",{className:V.join(" "),children:[a.jsx("th",{scope:"row",children:H.column}),a.jsx("td",{children:ld(H.score)}),a.jsx("td",{children:YP(H.p_value)}),a.jsx("td",{children:H.rank??""}),a.jsx("td",{children:ld(H.importance,4)}),a.jsx("td",{children:H.selected?"Selected":"Dropped"}),a.jsx("td",{children:H.note??""})]},`feature-selection-summary-${H.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),B.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:B.map((H,V)=>a.jsx("li",{children:H},`feature-selection-note-${V}`))})]})},GP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},XP={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},z0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),JP=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:l,metadata:i,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,outputSuffixParameter:y,dropOriginalParameter:p,encodeMissingParameter:v,handleUnknownParameter:_,unknownValueParameter:x,selectedColumns:j,renderParameterField:S,onToggleColumn:k,onApplyRecommended:M,formatMissingPercentage:P})=>{const T=f.useMemo(()=>{if(!l.length)return[];const D=new Set;return l.forEach($=>{$.status==="recommended"&&$.selectable&&D.add($.column)}),Array.from(D)},[l]),w=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),A=l.length>0,E=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>M(T),disabled:!T.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:w}),i.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),i.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((D,$)=>a.jsx("li",{children:D},`ordinal-encoding-note-${$}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!A&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&A&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(D=>{const $=j.includes(D.column),F=GP[D.status],R=XP[D.status]??"canvas-cast__chip--muted",B=D.sample_values.length?D.sample_values.join(", "):"",ee=D.unique_count!==void 0&&D.unique_count!==null?`${z0(D.unique_count)} (${z0(D.unique_percentage)}%)`:"",le=P(D.missing_percentage),z=D.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:D.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[D.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",D.dtype]}),D.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:D.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",B]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:D.reason})]})}),a.jsx("td",{children:ee}),a.jsx("td",{children:le}),a.jsx("td",{children:z}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${R}`,children:F})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:$,onChange:()=>k(D.column),disabled:!D.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:D.selectable?$?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${D.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&S(d),m&&S(m),y&&S(y),p&&S(p),v&&S(v),_&&S(_),x&&S(x)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),S(u)]})]})},ZP={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},eT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},R0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),tT=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:l,metadata:i,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,dropFirstParameter:y,includeMissingParameter:p,dropOriginalParameter:v,prefixSeparatorParameter:_,selectedColumns:x,renderParameterField:j,onToggleColumn:S,onApplyRecommended:k,formatMissingPercentage:M})=>{const P=f.useMemo(()=>{if(!l.length)return[];const E=new Set;return l.forEach(D=>{D.status==="recommended"&&D.selectable&&E.add(D.column)}),Array.from(E)},[l]),T=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),w=l.length>0,A=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>k(P),disabled:!P.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:T}),i.autoDetectDefault&&d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((E,D)=>a.jsx("li",{children:E},`dummy-note-${D}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!w&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&w&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(E=>{const D=x.includes(E.column),$=ZP[E.status],F=eT[E.status]??"canvas-cast__chip--muted",R=E.sample_values.length?E.sample_values.join(", "):"",B=E.unique_count!==void 0&&E.unique_count!==null?`${R0(E.unique_count)} (${R0(E.unique_percentage)}%)`:"",ee=M(E.missing_percentage),le=E.estimated_dummy_columns?E.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:E.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[E.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",E.dtype]}),E.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:E.text_category}),E.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",R]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:E.reason})]})}),a.jsx("td",{children:B}),a.jsx("td",{children:ee}),a.jsx("td",{children:le}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${F}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:D,onChange:()=>S(E.column),disabled:!E.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:E.selectable?D?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${E.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&j(d),m&&j(m),y&&j(y),p&&j(p),v&&j(v),_&&j(_)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),j(u)]})]})},nT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},sT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},F0=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),rT=({sourceId:e,hasReachableSource:t,isFetching:n,error:r,suggestions:l,metadata:i,columnsParameter:u,autoDetectParameter:d,maxCategoriesParameter:m,dropFirstParameter:y,includeMissingParameter:p,dropOriginalParameter:v,prefixSeparatorParameter:_,selectedColumns:x,renderParameterField:j,onToggleColumn:S,onApplyRecommended:k,formatMissingPercentage:M})=>{const P=f.useMemo(()=>{if(!l.length)return[];const E=new Set;return l.forEach(D=>{D.status==="recommended"&&D.selectable&&E.add(D.column)}),Array.from(E)},[l]),T=f.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),w=l.length>0,A=!n&&!!r&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>k(P),disabled:!P.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:T}),i.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(i.generatedAt).toLocaleString()," on"," ",i.sampleSize===null?"sampled rows":`${i.sampleSize.toLocaleString()} row${i.sampleSize===1?"":"s"}`,"."]}),!i.generatedAt&&i.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",i.sampleSize.toLocaleString()," row",i.sampleSize===1?"":"s"," for categorical trends."]}),i.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",i.totalTextColumns," text column",i.totalTextColumns===1?"":"s","; recommendations cover"," ",i.recommendedCount," candidate",i.recommendedCount===1?"":"s","."]}),i.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[i.cautionedCount," column",i.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),i.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:i.notes.map((E,D)=>a.jsx("li",{children:E},`one-hot-note-${D}`))}),i.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",i.highCardinalityColumns.length," high-cardinality column",i.highCardinalityColumns.length===1?"":"s",":"," ",i.highCardinalityColumns.slice(0,4).join(", "),i.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r??""}),!n&&!r&&!w&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!r&&w&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:l.map(E=>{const D=x.includes(E.column),$=nT[E.status],F=sT[E.status]??"canvas-cast__chip--muted",R=E.sample_values.length?E.sample_values.join(", "):"",B=E.unique_count!==void 0&&E.unique_count!==null?`${F0(E.unique_count)} (${F0(E.unique_percentage)}%)`:"",ee=M(E.missing_percentage),le=E.estimated_dummy_columns?E.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:E.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[E.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",E.dtype]}),E.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:E.text_category}),E.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",R]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:E.reason})]})}),a.jsx("td",{children:B}),a.jsx("td",{children:ee}),a.jsx("td",{children:le}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${F}`,children:$})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:D,onChange:()=>S(E.column),disabled:!E.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:E.selectable?D?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${E.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[d&&j(d),m&&j(m),y&&j(y),p&&j(p),v&&j(v),_&&j(_)]}),u&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),j(u)]})]})},I0={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},aT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},B0=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},oT=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(r=>r&&r.split===t)??null:null,Ng=(e,t)=>{const n=oT(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const r=I0[n.action]??n.action,l=B0(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:r}),l&&a.jsx("span",{className:"canvas-cast__muted",children:l})]})},lT=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(r=>r&&!["train","test","validation"].includes(r.split));return t.length&&t.map(r=>{const l=r.label||r.split,i=I0[r.action]??r.action,u=B0(r.rows??null);return u?`${l}: ${i} (${u})`:`${l}: ${i}`}).join("; ")||null},iT=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,cT=({signal:e,previewStatus:t,hasSource:n,hasReachableSource:r,onRefreshPreview:l})=>{const i=f.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),u=(e==null?void 0:e.total_transformers)??i.length,d=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],m=t==="loading",y=u?`Tracking ${u.toLocaleString()} transformer${u===1?"":"s"}.`:null,p=m||!n||!r;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:p,children:m?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),y&&a.jsx("p",{className:"canvas-modal__note",children:y}),!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),n&&!r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),d.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:d.map((v,_)=>a.jsx("li",{children:v},`transformer-audit-note-${_}`))}),m&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!m&&t==="error"&&n&&r&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!m&&n&&r&&!i.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!m&&i.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:i.map((v,_)=>{const x=v.storage_key??`${v.transformer_name}-${v.column_name??"all"}-${_}`,j=lT(v),S=v.source_node_label||v.source_node_id||"",k=aT(v.updated_at??v.created_at??null),M=v.column_name??"",P=iT(v);return a.jsxs(Ae.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:S})})}),a.jsx("td",{children:v.transformer_name}),a.jsx("td",{children:M}),a.jsx("td",{children:P||""}),a.jsx("td",{children:Ng(v,"train")}),a.jsx("td",{children:Ng(v,"test")}),a.jsx("td",{children:Ng(v,"validation")}),a.jsx("td",{children:k})]}),j&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",j]})})})]},x)})})]})})]})},Sg=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",uT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},dT=(e,t)=>{if(!e.length)return null;const n=e.filter(r=>!(r!=null&&r.node_id)||r.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},mT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:r,onRefreshPreview:l,config:i,targetColumnParameter:u,renderParameterField:d,formatMetricValue:m,formatMissingPercentage:y,canResetNode:p,onResetNode:v})=>{var U,Z,ie,re;const _=r.data,x=r.status,j=Array.isArray(_==null?void 0:_.applied_steps)?_.applied_steps:[],S=Array.isArray(_==null?void 0:_.columns)?_==null?void 0:_.columns:[],k=Array.isArray((U=_==null?void 0:_.signals)==null?void 0:U.feature_target_split)?(Z=_==null?void 0:_.signals)==null?void 0:Z.feature_target_split:[],M=dT(k,e),P=(i==null?void 0:i.targetColumn)??"",T=(M==null?void 0:M.target_column)??P,w=(i==null?void 0:i.featureColumns)??[],A=f.useMemo(()=>Array.isArray(_==null?void 0:_.column_stats)?_==null?void 0:_.column_stats:[],[_==null?void 0:_.column_stats]),E=f.useMemo(()=>{const pe=new Map;return A.forEach(xe=>{xe!=null&&xe.name&&pe.set(xe.name,xe)}),pe},[A]),D=f.useMemo(()=>{var pe;return(pe=M==null?void 0:M.feature_columns)!=null&&pe.length?M.feature_columns:w.length?w:T?S.filter(xe=>xe!==T):S.slice()},[M==null?void 0:M.feature_columns,w,S,T]),$=(M==null?void 0:M.auto_included_columns)??[],F=(M==null?void 0:M.missing_feature_columns)??[],R=(M==null?void 0:M.excluded_columns)??[],B=(M==null?void 0:M.target_missing_count)??0,ee=typeof(M==null?void 0:M.target_missing_percentage)=="number"?M.target_missing_percentage:null,le=(M==null?void 0:M.target_dtype)??(T?((ie=E.get(T))==null?void 0:ie.dtype)??null:null),z=typeof((re=_==null?void 0:_.metrics)==null?void 0:re.row_count)=="number"?_.metrics.row_count:null,G=D.length,W=$.length,H=R.length,V=F.length,ne=f.useMemo(()=>uT(j),[j]),Q=f.useMemo(()=>{const pe=[];if(pe.push({label:"Target column",value:T||"Not set"}),pe.push({label:"Feature columns",value:m(G)}),z!==null&&pe.push({label:"Preview rows",value:m(z)}),W&&pe.push({label:"Auto-selected features",value:m(W)}),V&&pe.push({label:"Configured features missing",value:m(V)}),H&&pe.push({label:"Excluded columns",value:m(H)}),B){const xe=m(B),Ve=ee!==null?y(ee):null;pe.push({label:"Target missing values",value:Ve?`${xe} (${Ve})`:xe})}return pe},[W,H,G,m,y,V,z,T,B,ee]),K=f.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),J=f.useMemo(()=>!t||!n?null:x==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,x,t]),te=f.useMemo(()=>T?x==="success"&&T&&!S.includes(T)?`Target column "${T}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[S,x,T]),Y=!!t&&n&&x!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[p&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:v,disabled:!v,children:"Reset node"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:!Y,children:x==="loading"?"Refreshing...":"Refresh preview"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:K}),r.error&&x==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r.error}),J&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:J}),te&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:te}),V>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",Sg(F),"."]}),H>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",Sg(R),"."]}),W>0&&w.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",Sg($),"."]}),ne&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:ne}),Q.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Q.map(pe=>a.jsxs("li",{children:[pe.label,": ",a.jsx("strong",{children:pe.value})]},`feature-target-summary-${pe.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:u&&d(u)}),x==="success"&&G===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),T&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",le?a.jsx("strong",{children:le}):a.jsx("span",{children:"Unknown"}),B?` - Missing rows flagged for review: ${m(B)}.`:""]})]})},fT=(e,t)=>{if(!e.length)return null;const n=e.filter(r=>!(r!=null&&r.node_id)||r.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},no=e=>`${(e*100).toFixed(1)}%`,hT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:r,onRefreshPreview:l,config:i,parameters:u,renderParameterField:d,formatMetricValue:m,canResetNode:y,onResetNode:p})=>{var ee,le;const v=r.data,_=r.status,x=Array.isArray((ee=v==null?void 0:v.signals)==null?void 0:ee.train_test_split)?(le=v==null?void 0:v.signals)==null?void 0:le.train_test_split:[],j=fT(x,e),S=(i==null?void 0:i.test_size)??.2,k=(i==null?void 0:i.validation_size)??0,M=i==null?void 0:i.random_state;i==null||i.shuffle;const P=(i==null?void 0:i.stratify)??!1,T=(i==null?void 0:i.target_column)??"",w=k>0,A=f.useMemo(()=>j?{trainSize:j.train_size??0,validationSize:j.validation_size??0,testSize:j.test_size??0,totalSize:j.total_size??0,trainRatio:j.train_size&&j.total_size?j.train_size/j.total_size:0,validationRatio:j.validation_ratio??0,testRatio:j.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-S-k,validationRatio:k,testRatio:S},[j,S,k]),E=u.find(z=>z.name==="test_size"),D=u.find(z=>z.name==="validation_size"),$=u.find(z=>z.name==="random_state"),F=u.find(z=>z.name==="shuffle"),R=u.find(z=>z.name==="stratify"),B=u.find(z=>z.name==="target_column");return a.jsxs("div",{className:"node-settings__section",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Train/Test Split Configuration"}),y&&p&&a.jsx("button",{type:"button",onClick:p,className:"node-settings__reset-button",title:"Reset node configuration",children:"Reset"})]}),a.jsxs("div",{className:"node-settings__field-group",children:[E&&d(E),D&&d(D),$&&d($),F&&d(F),R&&d(R),P&&B&&d(B)]}),_==="success"&&j&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:no(A.trainRatio)},title:`Training: ${A.trainSize} rows (${no(A.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),w&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:no(A.validationRatio)},title:`Validation: ${A.validationSize} rows (${no(A.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:no(A.testRatio)},title:`Test: ${A.testSize} rows (${no(A.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:m(A.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[m(A.trainSize,0)," (",no(A.trainRatio),")"]})]}),w&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[m(A.validationSize,0)," (",no(A.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[m(A.testSize,0)," (",no(A.testRatio),")"]})]}),P&&T&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:T})]}),M!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:M})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",children:[a.jsx("span",{className:"node-settings__warning-icon",children:""}),"Connect this node to a data source to configure the split."]}),_==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),_==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},pT={classification:"Classification",regression:"Regression"},gT=e=>e==="numeric"||e==="integer",_T=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},Cg=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,vT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},yT=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:r,config:l,targetColumnParameter:i,problemTypeParameter:u,renderParameterField:d,formatMetricValue:m,formatMissingPercentage:y,schemaColumns:p})=>{var J;const v=n.data,_=n.status,x=Array.isArray(v==null?void 0:v.applied_steps)?v.applied_steps:[],j=Array.isArray(v==null?void 0:v.column_stats)?v.column_stats:[],S=(v==null?void 0:v.metrics)??null,k=f.useMemo(()=>{var te;return p.length?p:Array.isArray((te=v==null?void 0:v.schema)==null?void 0:te.columns)?v.schema.columns:[]},[(J=v==null?void 0:v.schema)==null?void 0:J.columns,p]),M=f.useMemo(()=>{const te=new Map;return k.forEach(Y=>{Y!=null&&Y.name&&te.set(Y.name,Y)}),te},[k]),P=(l==null?void 0:l.targetColumn)??"",T=(l==null?void 0:l.problemType)??"classification",w=P?j.find(te=>(te==null?void 0:te.name)===P)??null:null;P&&M.get(P);const A=f.useMemo(()=>{const te=new Set;return j.forEach(Y=>{Y!=null&&Y.name&&Y.name!==P&&te.add(Y.name)}),k.forEach(Y=>{Y!=null&&Y.name&&Y.name!==P&&te.add(Y.name)}),Array.from(te).sort()},[j,k,P]),E=f.useMemo(()=>A.filter(te=>{const Y=M.get(te);if(Y&&gT(Y.logical_family))return!0;const U=j.find(Z=>Z.name===te);return _T((U==null?void 0:U.dtype)??null)}),[j,A,M]),D=f.useMemo(()=>new Set(E),[E]),$=f.useMemo(()=>A.filter(te=>!D.has(te)),[A,D]),F=f.useMemo(()=>j.filter(te=>(te==null?void 0:te.name)&&te.name!==P&&(te.missing_count??0)>0).map(te=>te.name),[j,P]),R=typeof(S==null?void 0:S.row_count)=="number"?S.row_count:null,B=typeof(w==null?void 0:w.distinct_count)=="number"&&Number.isFinite(w.distinct_count)?w.distinct_count:null,ee=typeof(w==null?void 0:w.missing_count)=="number"?w.missing_count:0,le=typeof(w==null?void 0:w.missing_percentage)=="number"?w.missing_percentage:null,z=f.useMemo(()=>{const te=[];return P?_!=="success"?te:!w&&!A.length?(te.push(`Target column "${P}" is not present in the preview output, and no feature columns were found.`),te):(A.length||te.push("Add at least one feature column in addition to the target before training."),w&&ee>0&&te.push(`Target column includes ${ee} missing value${ee===1?"":"s"}.`),T==="classification"&&w&&(B??0)<2&&te.push("Classification tasks require at least two distinct target classes."),T==="regression"&&E.length===0&&te.push("Regression tasks need at least one numeric feature column."),F.length>0&&te.push(`Feature columns with missing values: ${Cg(F)}.`),R!==null&&R===0&&te.push("Preview returned zero rows after upstream transformations."),te):(te.push("Set a target column to evaluate downstream modeling constraints."),te)},[F,A.length,ee,E.length,R,_,T,P,B,w]),G=f.useMemo(()=>pT[T],[T]),W=f.useMemo(()=>{const te=[{label:"Problem type",value:G},{label:"Target column",value:P||"Not set"}];if(_==="success"){if(R!==null&&te.push({label:"Preview rows",value:m(R)}),te.push({label:"Feature columns",value:m(A.length)}),te.push({label:"Numeric features",value:m(E.length)}),te.push({label:"Non-numeric features",value:m($.length)}),B!==null&&te.push({label:"Target distinct values",value:m(B)}),w){const Y=m(ee),U=le!==null?y(le):null;te.push({label:"Target missing values",value:U?`${Y} (${U})`:Y})}F.length>0&&te.push({label:"Features with missing values",value:m(F.length)})}return te},[G,F.length,A.length,m,y,ee,$.length,E.length,R,_,P,B,le,w]),H=f.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),V=f.useMemo(()=>!e||!t?null:_==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,_,e]),ne=f.useMemo(()=>vT(x),[x]),Q=!!e&&t&&_!=="loading",K=f.useMemo(()=>!P||_!=="success"||z.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[_,z.length,P]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:r,disabled:!Q,children:_==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:H}),n.error&&_==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),V&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:V}),z.map((te,Y)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:te},`train-model-issue-${Y}`)),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:K}),ne&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:ne}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[i&&d(i),u&&d(u)]}),W.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:W.map(te=>a.jsxs("li",{children:[te.label,": ",a.jsx("strong",{children:te.value})]},`train-model-summary-${te.label}`))}),_==="success"&&F.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",Cg(F),"."]}),_==="success"&&T==="regression"&&$.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",Cg($),". Consider encoding or casting them before training regression models."]})]})},U0=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?Mr(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},bT=e=>e||"Unknown",xT=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},fr=e=>{const t=xT(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const r=Math.round(n/60);if(r===1)return"1 hour ago";if(r<24)return`${r} hours ago`;const l=Math.round(r/24);return l===1?"1 day ago":`${l} days ago`},wT={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},dc={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},Tf=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([r,l])=>{t.has(r)&&(n[r]=l)}),n},jT=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([r,l])=>{t.has(r)&&(l===""||l===null||l===void 0||(n[r]=l))}),n},q0=e=>!!e&&typeof e=="object"&&!Array.isArray(e),id=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},NT=e=>{if(!e)return dc.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return dc.regression;if(t.includes("classifier")||t.includes("classification"))return dc.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?dc.regression:n==="classification"?dc.classification:dc.fallback},ST=e=>{var i,u,d;if(!e)return null;const t=[],n=(u=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:u.mean;q0(n)&&((d=e==null?void 0:e.cross_validation)==null?void 0:d.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const r=[e.test,e.validation,e.train];for(const m of r)q0(m)&&t.push({dataset:m,labelPrefix:""});const l=NT(e);for(const m of t)for(const y of l){const p=m.dataset[y];if(typeof p=="number"&&Number.isFinite(p))return{label:m.labelPrefix?`${m.labelPrefix}${y}`:y,value:p}}for(const m of t)for(const[y,p]of Object.entries(m.dataset))if(typeof p=="number"&&Number.isFinite(p))return{label:m.labelPrefix?`${m.labelPrefix}${y}`:y,value:p};return null},CT=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",ET=({nodeId:e,sourceId:t,graph:n,config:r,runtimeConfig:l,cvConfig:i,draftConfigState:u,renderParameterField:d,modelTypeParameter:m,modelTypeOptions:y,hyperparametersParameter:p,cvEnabledParameter:v,cvStrategyParameter:_,cvFoldsParameter:x,cvShuffleParameter:j,cvRandomStateParameter:S,cvRefitStrategyParameter:k,onSaveDraftConfig:M})=>{var $r,na,sa,ra;const P=Qi(),[T,w]=f.useState(null),[A,E]=f.useState(null),[D,$]=f.useState(null),[F,R]=f.useState(0),[B,ee]=f.useState({}),[le,z]=f.useState(!1),G=f.useRef(!1),[W,H]=f.useState(null),[V,ne]=f.useState(!1),[Q,K]=f.useState(null),[J,te]=f.useState(null),Y=((r==null?void 0:r.targetColumn)??"").trim(),U=(r==null?void 0:r.problemType)==="regression"?"regression":"classification",Z=((l==null?void 0:l.modelType)??"").trim(),ie=(l==null?void 0:l.hyperparameters)??null,re=(l==null?void 0:l.hyperparametersError)??null,pe=!!(i!=null&&i.enabled),xe=(i==null?void 0:i.strategy)??"auto",Ve=typeof(i==null?void 0:i.folds)=="number"?i.folds:0,ht=!!(i!=null&&i.shuffle),Qe=(i==null?void 0:i.randomState)??null,Ne=(i==null?void 0:i.refitStrategy)??"train_plus_validation",ze=f.useMemo(()=>m?y.length?{...m,options:y}:m:null,[y,m]),Se=ir({queryKey:["model-hyperparameters",Z],queryFn:()=>wf(Z),enabled:!!Z,staleTime:5*60*1e3}),Be=ir({queryKey:["best-hyperparameters",Z,W,t],queryFn:()=>gx(Z,{pipelineId:W||void 0,datasetSourceId:t||void 0}),enabled:!!(Z&&t),staleTime:30*1e3,retry:1}),He=(($r=Se.data)==null?void 0:$r.fields)??[],Ke=((na=Se.data)==null?void 0:na.defaults)??{},st=f.useMemo(()=>He.length?new Set(He.map(Ee=>Ee.name)):new Set,[He]),X=f.useMemo(()=>{if(!Z||!ie||st.size===0)return null;const Ee=Tf(ie,st);return Object.keys(Ee).length>0?Ee:null},[st,ie,Z]);f.useEffect(()=>{ee({}),z(!1),G.current=!1},[Z]),f.useEffect(()=>{X&&(ee(Ee=>{const Ye=Object.keys(Ee),Ge=Object.keys(X);return Ye.length===Ge.length&&Ge.every(Mt=>Object.is(Ee[Mt],X[Mt]))?Ee:X}),G.current||(z(!0),G.current=!0))},[X]),f.useEffect(()=>{if(!Z||X||st.size===0||!Ke||Object.keys(Ke).length===0)return;const Ee=Tf(Ke,st);Object.keys(Ee).length!==0&&ee(Ye=>Object.keys(Ye).length>0?Ye:Ee)},[st,X,Ke,Z]);const Oe=f.useMemo(()=>{if(st.size===0)return null;const Ee=jT(B,st);return Object.keys(Ee).length>0?Ee:null},[st,B]),Te=f.useCallback(()=>{z(Ee=>{const Ye=!Ee;return Ye&&(G.current=!0),Ye})},[]),ot=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),jt=f.useMemo(()=>{if(!ot)return null;if(!u||Object.keys(u).length===0)return ot;const Ee=id(ot);return!Ee||!Array.isArray(Ee.nodes)||(Ee.nodes=Ee.nodes.map(Ye=>{if(!Ye||Ye.id!==e)return Ye;const Ge=(Ye==null?void 0:Ye.data)??{},Mt={...(Ge==null?void 0:Ge.config)??{},...u};return{...Ye,data:{...Ge,config:Mt,isConfigured:!0}}})),Ee},[u,ot,e]);f.useEffect(()=>{let Ee=!1;return!t||!ot?(H(null),()=>{Ee=!0}):(Wl(t,ot).then(Ye=>{Ee||H(Ye)}).catch(()=>{Ee||H(null)}),()=>{Ee=!0})},[ot,t]),f.useEffect(()=>{let Ee=!1;E(null);const Ye=jt??ot;return!t||!Ye?(w(null),()=>{Ee=!0}):(Wl(t,Ye).then(Ge=>{Ee||w(Ge)}).catch(Ge=>{Ee||(E((Ge==null?void 0:Ge.message)??"Unable to compute pipeline ID"),w(null))}),()=>{Ee=!0})},[ot,jt,t]),f.useEffect(()=>{if(!T||!W){ne(!1);return}ne(T!==W)},[T,W]);const rn=f.useMemo(()=>["feature-canvas","training-jobs",t??"none",T??"pending",e],[e,T,t]),ve=f.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",T??"pending",e],[e,T,t]),be=!!(t&&e),ke=ir({queryKey:ve,queryFn:async()=>{var Ye;const Ee={datasetSourceId:t||void 0,nodeId:e,limit:5};if(T){const Ge=await Ju({...Ee,pipelineId:T});if((((Ye=Ge==null?void 0:Ge.jobs)==null?void 0:Ye.length)??0)>0)return Ge}return Ju(Ee)},enabled:be,retry:(Ee,Ye)=>Ye.message.includes("Sign in")?!1:Ee<2,refetchInterval:Ee=>{const Ye=Ee.state.data;return((Ye==null?void 0:Ye.jobs)??[]).some(Mt=>Mt.status==="queued"||Mt.status==="running")?5e3:!1}}),Le=ir({queryKey:rn,queryFn:async()=>{var Ye;const Ee={datasetSourceId:t||void 0,nodeId:e,limit:5};if(T){const Ge=await Xu({...Ee,pipelineId:T});if((((Ye=Ge==null?void 0:Ge.jobs)==null?void 0:Ye.length)??0)>0)return Ge}return Xu(Ee)},enabled:be,retry:(Ee,Ye)=>Ye.message.includes("Sign in")?!1:Ee<2,refetchInterval:Ee=>{const Ye=Ee.state.data;return((Ye==null?void 0:Ye.jobs)??[]).some(Mt=>Mt.status==="queued"||Mt.status==="running")?5e3:!1}}),{mutateAsync:Xe,isPending:et,error:tt}=Im({mutationFn:dx,onSuccess:Ee=>{const Ye=Array.isArray(Ee.jobs)?Ee.jobs.length:0,Ge=Ye>0?Ee.jobs[0]:null;$(Ge),R(Ye),P.invalidateQueries({queryKey:rn})}}),xt=ke.error,Bt=ke.isLoading||ke.isFetching,Ft=((sa=ke.data)==null?void 0:sa.jobs)??[],ct=Be.data,Tt=!!(ct!=null&&ct.available&&(ct!=null&&ct.best_params)),gt=f.useMemo(()=>{if(!Tt||!(ct!=null&&ct.best_params)||st.size===0)return null;const Ee=Tf(ct.best_params,st);return Object.keys(Ee).length?Ee:null},[st,ct,Tt]),Ct=f.useMemo(()=>{if(!Ft.length)return null;const Ee=Ft.filter(Ye=>Ye.status==="succeeded");return Ee.length?Ee.slice().sort((Ye,Ge)=>{const sn=Date.parse(Ye.updated_at||Ye.created_at||"0");return Date.parse(Ge.updated_at||Ge.created_at||"0")-sn})[0]:null},[Ft]),hn=f.useMemo(()=>{if(!Ct||!Ct.best_params||st.size===0)return null;const Ee=Tf(Ct.best_params,st);return Object.keys(Ee).length?Ee:null},[st,Ct]),Zt=gt||hn,Cn=!!(Z&&(ct!=null&&ct.available&&(ct==null?void 0:ct.model_type)===Z||Ct&&Ct.model_type===Z)),pn=!!!(Zt&&Cn),Ot=ct!=null&&ct.available?ct:Ct,Ut=Ot?"finished_at"in Ot?Ot.finished_at:"updated_at"in Ot?Ot.updated_at||Ot.created_at:null:null,bn=Ut?fr(Ut):null,qt=Ot&&"run_number"in Ot?Ot.run_number:null,Pt=Ot?"job_id"in Ot?Ot.job_id:"id"in Ot?Ot.id:null:null;f.useEffect(()=>{if(!Pt){K(null),te(null);return}Q&&Pt!==Q&&te(null)},[Q,Pt]);const an=f.useCallback(()=>{if(!Ct){te({message:"No tuning job results available to apply.",tone:"warning"});return}if(!hn){te({message:"Latest tuning run did not produce compatible hyperparameters for this model template.",tone:"warning"});return}if(!Cn){te({message:`Latest tuning run targeted ${Ct.model_type}. Switch the model template to apply its parameters.`,tone:"warning"});return}ee(()=>id(Zt)),z(!0),G.current=!0,K(Pt||""),te({message:`Applied best parameters from tuning run${qt?` ${qt}`:""}.`,tone:"success"})},[Zt,ct,Ct,Pt,qt,Cn]),es=f.useMemo(()=>{if(!J)return"rgba(148, 163, 184, 0.75)";switch(J.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[J]),Ks=f.useMemo(()=>{const Ee=[];return t||Ee.push("Select a dataset before launching training jobs."),(!ot||!ot.nodes.length)&&Ee.push("Connect this node to an upstream pipeline before training."),Y||Ee.push("Set a target column in the Train model readiness section."),Z||Ee.push("Choose a model type before enqueuing training jobs."),pe&&Ve<2&&Ee.push("Cross-validation requires at least 2 folds."),A&&Ee.push(A),re&&Ee.push(re),Ee},[pe,Ve,ot,re,Z,A,t,Y]),En=((ra=Le.data)==null?void 0:ra.jobs)??[],as=f.useMemo(()=>{if(!En.length)return En;const Ee=U==null?void 0:U.toLowerCase();return En.filter(Ye=>{if(!Ee)return!0;const Ge=(()=>{var jn,dn,gn,_n;const Mt=typeof Ye.problem_type=="string"?Ye.problem_type:null,os=typeof((jn=Ye.metadata)==null?void 0:jn.problem_type)=="string"?(dn=Ye.metadata)==null?void 0:dn.problem_type:null,nn=typeof((gn=Ye.metadata)==null?void 0:gn.resolved_problem_type)=="string"?(_n=Ye.metadata)==null?void 0:_n.resolved_problem_type:null;return(Mt||nn||os||"").toLowerCase()})();if(Ge)return Ge===Ee;const sn=String(Ye.model_type||"").toLowerCase();return Ee==="regression"?sn.includes("regress"):Ee==="classification"?sn.includes("classif"):!0})},[En,U]),Gt=Math.max(En.length-as.length,0),Qn=Le.isLoading||Le.isFetching,Tr=Le.error,uo=Ks.length>0||!T||!t||!ot||et,Ys=f.useCallback((Ee,Ye)=>{ee(Ge=>({...Ge,[Ee]:Ye}))},[]),Os=f.useCallback(Ee=>{var sn;const Ye=B[Ee.name]??Ee.default,Ge=`hyperparam-${e}-${Ee.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Ge,className:"canvas-modal__parameter-label",children:[Ee.label,Ee.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:Ee.description})]}),Ee.type==="number"&&a.jsx("input",{id:Ge,type:"number",className:"canvas-modal__parameter-input",value:Ye??"",onChange:Mt=>{const os=Mt.target.value;if(os===""&&Ee.nullable)Ys(Ee.name,null);else{const nn=parseFloat(os);isNaN(nn)||Ys(Ee.name,nn)}},min:Ee.min,max:Ee.max,step:Ee.step,placeholder:Ee.nullable?"Empty = default":""}),Ee.type==="select"&&a.jsx("select",{id:Ge,className:"canvas-modal__parameter-select",value:Ye??"",onChange:Mt=>Ys(Ee.name,Mt.target.value),children:(sn=Ee.options)==null?void 0:sn.map(Mt=>a.jsx("option",{value:Mt.value,children:Mt.label},Mt.value))}),Ee.type==="boolean"&&a.jsx("input",{id:Ge,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!Ye,onChange:Mt=>Ys(Ee.name,Mt.target.checked)}),Ee.type==="text"&&a.jsx("input",{id:Ge,type:"text",className:"canvas-modal__parameter-input",value:Ye??"",onChange:Mt=>Ys(Ee.name,Mt.target.value),placeholder:Ee.nullable?"Empty = default":""})]},Ee.name)},[B,Ys,e]),Pa=f.useCallback(async()=>{if(!T||!t||!Z)return;V&&M&&(M(),await new Promise(nn=>setTimeout(nn,100)));const Ee=jt??ot;if(!Ee)return;const Ye={};Y&&(Ye.target_column=Y),Ye.problem_type=U,Ye.cross_validation={enabled:pe,strategy:xe,folds:Ve,shuffle:ht,random_state:Qe,refit_strategy:Ne};const Ge=Object.keys(Ye).length?Ye:void 0,sn=id(Ee);sn&&Array.isArray(sn.nodes)&&(sn.nodes=sn.nodes.map(nn=>{if(!nn||nn.id!==e)return nn;const jn=(nn==null?void 0:nn.data)??{},dn=(jn==null?void 0:jn.config)??{},gn=u?{...dn,...u}:dn;return{...nn,data:{...jn,config:gn,isConfigured:!0}}}));const Mt=Z?[Z]:[],os={dataset_source_id:t,pipeline_id:T,node_id:e,model_type:Z||void 0,model_types:Mt.length?Mt:void 0,hyperparameters:le&&Oe?id(Oe):void 0,metadata:Ge,job_metadata:Ge,run_training:!0,graph:sn??id(Ee),target_node_id:e};try{await Xe(os)}catch{}},[pe,Ve,Qe,Ne,ht,xe,u,Xe,ot,jt,V,Z,e,M,T,U,Oe,le,t,Y]),Ta=f.useCallback(()=>{be&&Le.refetch()},[be,Le]),ta=Ee=>{var _n,on,kn,aa;const Ye=ST(Ee.metrics??null),Ge=Ee.updated_at?fr(Ee.updated_at):null,sn=Ee.updated_at||Ee.created_at,Mt=sn?Ge??new Date(sn).toLocaleString():null,os=wT[Ee.status]??Ee.status,nn=(Ee.problem_type||((_n=Ee.metadata)==null?void 0:_n.resolved_problem_type)||((on=Ee.metadata)==null?void 0:on.problem_type)||"").toString(),jn=((kn=Ee.metadata)==null?void 0:kn.cross_validation)??null,dn=((aa=Ee.metrics)==null?void 0:aa.cross_validation)??null,gn=[];if(gn.push(`Model ${Ee.model_type}`),nn&&gn.push(nn.charAt(0).toUpperCase()+nn.slice(1)),jn!=null&&jn.enabled){const Qs=String(jn.strategy??"auto"),Dr=Qs==="stratified_kfold"?"Stratified KFold":Qs==="kfold"?"KFold":"Auto CV",pr=typeof jn.folds=="number"?`${jn.folds} folds`:"CV enabled";if(gn.push(`${Dr} (${pr})`),(dn==null?void 0:dn.status)==="skipped"){const _s=String((dn==null?void 0:dn.reason)??"unknown reason").replace(/_/g," ");gn.push(`CV skipped (${_s})`)}}else if((dn==null?void 0:dn.status)==="skipped"){const Qs=String((dn==null?void 0:dn.reason)??"unknown reason").replace(/_/g," ");gn.push(`CV skipped (${Qs})`)}return Ye&&gn.push(`${Ye.label}: ${CT(Ye.value)}`),Mt&&gn.push(`Updated ${Mt}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["v",Ee.version]}),"  ",os,gn.length>0?`  ${gn.join("  ")}`:""]},Ee.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Ta,disabled:!be||Qn,children:Qn?"Refreshing":"Refresh jobs"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),T&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:T})]}),V&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]}),Ks.map((Ee,Ye)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Ee},`training-prereq-${Ye}`)),tt instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:tt.message}),Tr&&!(tt instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Tr.message||"Unable to load training jobs."}),xt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:xt.message||"Unable to load tuning jobs."}),D&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:F>1?a.jsxs("span",{children:["Queued ",F," training jobs. Latest job ",D.id," (version ",D.version,")."]}):a.jsxs("span",{children:["Training job ",D.id," queued (version ",D.version,")."]})}),Bt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[ze&&d(ze),v&&d(v),pe&&a.jsxs(a.Fragment,{children:[_&&d(_),x&&d(x),j&&d(j),S&&d(S),k&&d(k)]}),Z&&He.length>0&&a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:le?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),Ot&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:Tt?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:Z}),qt&&` (run ${qt})`,bn&&`  ${bn}`]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",qt||"N/A",bn?`  ${bn}`:"",Cn?" matches the current model template.":Ot&&"model_type"in Ot?` targeted ${Ot.model_type}.`:Ct?` targeted ${Ct.model_type}.`:""]})}),J&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:es},children:J.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[Ot&&a.jsx("button",{type:"button",onClick:an,disabled:pn,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:pn?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:pn?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:pn?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:pn?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:pn?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply best params"}),a.jsx("button",{type:"button",onClick:Te,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:le?"#fff":"rgba(148, 163, 184, 0.85)",background:le?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(15, 23, 42, 0.6)",border:le?"none":"1px solid rgba(148, 163, 184, 0.45)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:le?"0 4px 12px rgba(118, 75, 162, 0.25)":"none"},onMouseEnter:Ee=>{le?Ee.currentTarget.style.boxShadow="0 6px 16px rgba(118, 75, 162, 0.35)":(Ee.currentTarget.style.borderColor="rgba(148, 163, 184, 0.65)",Ee.currentTarget.style.background="rgba(15, 23, 42, 0.8)")},onMouseLeave:Ee=>{le?Ee.currentTarget.style.boxShadow="0 4px 12px rgba(118, 75, 162, 0.25)":(Ee.currentTarget.style.borderColor="rgba(148, 163, 184, 0.45)",Ee.currentTarget.style.background="rgba(15, 23, 42, 0.6)")},children:le?" Advanced":"Default"})]})]})}),Z&&Se.isLoading&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),Z&&Se.error&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",Se.error.message]}),Z&&le&&He.length>0&&a.jsxs("div",{style:{gridColumn:"1 / -1",padding:"1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginTop:"0.5rem"},children:[a.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid rgba(102, 126, 234, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600",color:"#e2e8f0"},children:"Advanced Hyperparameters"}),a.jsxs("p",{style:{margin:"0",fontSize:"0.875rem",color:"rgba(148, 163, 184, 0.85)",lineHeight:"1.5"},children:["Configure ",Z.replace(/_/g," ")," hyperparameters. Leave empty to use recommended defaults."]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:He.map(Os)})]}),!Z&&p&&d(p)]}),pe&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",Ve," folds before refitting on"," ",Ne==="train_plus_validation"?"training plus validation data.":"training data only."]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Pa,disabled:uo,children:et?"Queuing":"Launch training job"})}),Qn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),Gt>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:Gt===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${Gt} training jobs use a different problem type. Switch the problem type to view them.`}),!Qn&&as.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),as.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:as.map(ta)})]})},kT=new Set(["true","1","yes","on"]),MT=new Set(["false","0","no","off"]),AT=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],H0=new Set(["true","1","yes","y","on","t"]),V0=new Set(["false","0","no","n","off","f"]),Ql=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(kT.has(t))return!0;if(MT.has(t))return!1}return null},mc=e=>{if(!(!e||typeof e!="object")){for(const t of AT)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},Eg=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},kg=e=>Array.isArray(e)?e.map(t=>kg(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=kg(e[n]),t),{}):e,cd=e=>e===void 0?"":JSON.stringify(kg(e)),W0=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},OT=(e,t)=>{const n=[],r=v=>{n.includes(v)||n.push(v)},l=(e??"").toLowerCase();if(!t.length)return n;const i=t.filter(v=>v!=null);if(!i.length)return n;const u=i.reduce((v,_)=>{if(typeof _=="number"&&Number.isFinite(_))return v+1;if(typeof _=="string"){const x=_.trim();if(!x)return v;const j=Number(x);if(!Number.isNaN(j)&&Number.isFinite(j))return v+1}return v},0),d=i.reduce((v,_)=>{const x=String(_).trim().toLowerCase();return x&&(H0.has(x)||V0.has(x))?v+1:v},0),m=(()=>{const v=new Set;return i.forEach(_=>{v.add(String(_).trim().toLowerCase())}),v.size})(),y=u/i.length,p=d/i.length;if(l.includes("object")||l.includes("string"))return p>=.7&&r("boolean"),y>=.7&&r("float64"),m>0&&m<=20&&r("category"),n;if(l.includes("float")){const v=i.reduce((_,x)=>{if(typeof x=="number")return Number.isInteger(x)?_+1:_;if(typeof x=="string"){const j=x.trim();if(!j)return _;const S=Number(j);if(!Number.isNaN(S)&&Number.isFinite(S)&&Number.isInteger(S))return _+1}return _},0);return p>=.8&&r("boolean"),i.length>0&&v/i.length>=.9&&r("Int64"),n}return l.includes("int")&&p>=.7&&r("boolean"),n},$f=[{value:"validation",label:"Validation",accent:"validation"},{value:"test",label:"Test",accent:"test"}],Df={validation:0,test:1},PT=["validation","test"],Mg=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],ud=e=>{const t=new Set($f.map(l=>l.value)),n=[];e.forEach(l=>{if(l&&!(l==="training"||l==="train")){if(l==="valid"||l==="val"){n.push("validation");return}t.has(l)&&n.push(l)}});const r=new Set;return n.filter(l=>r.has(l)?!1:(r.add(l),!0)).sort((l,i)=>Df[l]-Df[i])},TT=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},Ag=(e,t)=>{const n=Ql(e);return n===null?t:n},K0=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},Y0=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},$T=e=>{const t=$f.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},DT=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},LT=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${DT(e.status)}`);const n=fr(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},Lf=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,zT=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,r])=>{typeof r=="number"&&Number.isFinite(r)&&t.push({key:n,value:r})}),t.sort((n,r)=>n.key.localeCompare(r.key)),t},Q0=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},RT=({nodeId:e,sourceId:t,graph:n,config:r,setConfigState:l,renderParameterField:i,formatMetricValue:u,connectedSplitHandles:d,canResetNode:m=!1,onResetNode:y})=>{var Qe;const p=Qi(),v=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),_=f.useMemo(()=>{if(!v)return[];const Ne=new Map;v.nodes.forEach(Se=>{Se!=null&&Se.id&&Ne.set(Se.id,Se)});const ze=new Set;return v.edges.forEach(Se=>{var He;if(!Se||Se.target!==e)return;const Be=Ne.get(Se.source);((He=Be==null?void 0:Be.data)==null?void 0:He.catalogType)==="train_model_draft"&&ze.add(Be.id)}),ze.size>0?Array.from(ze):v.nodes.filter(Se=>{var Be;return((Be=Se==null?void 0:Se.data)==null?void 0:Be.catalogType)==="train_model_draft"}).map(Se=>Se.id)},[v,e]),x=f.useMemo(()=>_.length?_.slice().sort().join("|"):"all",[_]),[j,S]=f.useState(null),[k,M]=f.useState(null);f.useEffect(()=>{let Ne=!1;return M(null),!t||!v?(S(null),()=>{Ne=!0}):(Wl(t,v).then(ze=>{Ne||S(ze)}).catch(ze=>{Ne||(M((ze==null?void 0:ze.message)??"Unable to compute pipeline signature."),S(null))}),()=>{Ne=!0})},[v,t]);const P=f.useMemo(()=>{const Ne=r==null?void 0:r.training_job_id;return typeof Ne=="string"?Ne.trim():typeof Ne=="number"?String(Ne):""},[r==null?void 0:r.training_job_id]),T=f.useMemo(()=>ud(Mg(r==null?void 0:r.splits)),[r==null?void 0:r.splits]),w=f.useMemo(()=>T.length?T:PT,[T]);f.useEffect(()=>{d&&l(Ne=>{const ze=Ne??{},Se=ud(Mg(ze.splits)),Be=Se.filter(Ke=>d[Ke]!==!1);if(Be.length===Se.length&&Be.every((Ke,st)=>Ke===Se[st]))return Ne;const He={...ze};return Be.length?He.splits=Be:delete He.splits,He})},[d,l]);const A=f.useMemo(()=>d?w.filter(Ne=>d[Ne]!==!1):w,[d,w]),E=f.useMemo(()=>d?$f.filter(Ne=>d[Ne.value]===!1).map(Ne=>Ne.label):[],[d]),D=f.useMemo(()=>E.length?E.length===1?E[0]:`${E[0]} and ${E[1]}`:"",[E]),$=A.length>0,F=Ag(r==null?void 0:r.include_confusion,!0),R=Ag(r==null?void 0:r.include_curves,!0),B=Ag(r==null?void 0:r.include_residuals,!0),ee=K0(r==null?void 0:r.max_curve_points,500),le=K0(r==null?void 0:r.max_scatter_points,750),z=typeof(r==null?void 0:r.last_evaluated_at)=="string"?r.last_evaluated_at:null,[G,W]=f.useState(null),H=f.useRef(!1);f.useEffect(()=>{W(null),H.current=!1},[P]);const V=f.useMemo(()=>["feature-canvas","model-evaluation",t??"none",j??"pending",x],[j,t,x]),ne=ir({queryKey:V,queryFn:async()=>{const Ne={datasetSourceId:t||void 0,limit:50},ze=new Map,Se=[];let Be=null;const He=Oe=>{Array.isArray(Oe)&&Oe.forEach(Te=>{Te&&!ze.has(Te.id)&&ze.set(Te.id,Te)})},Ke=async Oe=>{try{const Te=await Xu(Oe);return He(Te==null?void 0:Te.jobs),Te}catch(Te){return Te instanceof Error&&Se.push(Te),null}};if(j&&await Ke({...Ne,pipelineId:j}),_.length&&await Promise.all(_.map(Oe=>Ke({...Ne,nodeId:Oe}))),Be=await Ke(Ne),!ze.size){if(Be)return Be;if(Se.length)throw Se[0];return{jobs:[],total:0}}const st=Array.from(ze.values());st.sort((Oe,Te)=>Y0(Te.updated_at??Te.created_at)-Y0(Oe.updated_at??Oe.created_at));const X=(Be==null?void 0:Be.total)??st.length;return{jobs:st,total:X}},enabled:!!t,staleTime:30*1e3,retry:(Ne,ze)=>ze.message.includes("Sign in")?!1:Ne<2,refetchInterval:Ne=>{const ze=Ne.state.data;return((ze==null?void 0:ze.jobs)??[]).some(He=>He.status==="queued"||He.status==="running")?5e3:!1}}),Q=((Qe=ne.data)==null?void 0:Qe.jobs)??[],K=f.useMemo(()=>{const Ne=new Map;return Q.forEach(ze=>{Ne.set(ze.id,ze)}),Ne},[Q]),J=f.useMemo(()=>Q.filter(Ne=>Ne.status==="succeeded"),[Q]),te=f.useMemo(()=>J.map(Ne=>({value:Ne.id,label:LT(Ne)})),[J]),Y=P?K.get(P)??null:null,U=ir({queryKey:["feature-canvas","training-job",P||"none"],queryFn:()=>mx(P),enabled:!!P,staleTime:30*1e3});f.useEffect(()=>{var Oe,Te;const Ne=U.data;if(!Ne)return;const ze=(Oe=Ne.metrics)==null?void 0:Oe.evaluation;if(!ze||typeof ze!="object")return;const Se=ze.splits;if(!Se||typeof Se!="object")return;const Be={};Object.entries(Se).forEach(([ot,jt])=>{jt&&typeof jt=="object"&&(Be[ot]=jt)});const He=typeof ze.generated_at=="string"?ze.generated_at:z??Ne.updated_at??Ne.created_at??new Date().toISOString(),Ke=ze.problem_type==="regression"?"regression":"classification",st={job_id:Ne.id,pipeline_id:Ne.pipeline_id,node_id:Ne.node_id,generated_at:He,problem_type:Ke,target_column:ze.target_column??((Te=Ne.metadata)==null?void 0:Te.target_column)??null,splits:Be};W(st),He&&He!==z&&l(ot=>({...ot??{},last_evaluated_at:He}));const X=ud(Object.keys(Be));X.length&&!H.current&&!TT(T,X)&&l(ot=>({...ot??{},splits:X}))},[U.data,z,l,T]);const Z=Im({mutationFn:async Ne=>{if(!P)throw new Error("Select a training job before running evaluation.");return fx(P,Ne)},onSuccess:Ne=>{W(Ne),l(ze=>({...ze??{},training_job_id:P,splits:Ne.splits?Object.keys(Ne.splits):A,include_confusion:F,include_curves:R,include_residuals:B,max_curve_points:ee,max_scatter_points:le,last_evaluated_at:Ne.generated_at})),p.invalidateQueries({queryKey:["feature-canvas","training-job",P]})}}),ie=f.useCallback(Ne=>{const ze=Ne.target.value;Z.reset(),l(Se=>{const Be={...Se??{}};return ze?Be.training_job_id=ze:delete Be.training_job_id,Be})},[Z,l]),re=f.useCallback(Ne=>{d&&d[Ne]===!1||(Z.reset(),H.current=!0,l(ze=>{const Se=ud(Mg(ze==null?void 0:ze.splits)),Be=Se.includes(Ne);let He;if(Be){if(Se.length<=1)return ze??{};He=Se.filter(Ke=>Ke!==Ne)}else He=ud([...Se,Ne]);return{...ze??{},splits:He}}))},[d,Z,l]),pe=f.useCallback((Ne,ze)=>{Z.reset(),l(Se=>({...Se??{},[Ne]:ze}))},[Z,l]),xe=f.useCallback(()=>{if(!P)return;const Ne={splits:A,include_confusion:F,include_curves:R,include_residuals:B,max_curve_points:R?ee:void 0,max_scatter_points:B?le:void 0};Z.mutate(Ne)},[Z,F,R,B,ee,le,P,A]),Ve=G?fr(G.generated_at):z?fr(z):null,ht=f.useMemo(()=>G?Object.entries(G.splits).sort((Ne,ze)=>{const[Se]=Ne,[Be]=ze,He=Df[Se]??99,Ke=Df[Be]??99;return He-Ke}):[],[G]);return a.jsxs("div",{className:"node-settings__section node-settings__evaluation",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[Ve&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",Ve]}),m&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:y,disabled:!y,title:"Reset evaluation node to defaults",children:"Reset node"})]})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:P,onChange:ie,disabled:ne.isLoading||ne.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),te.map(Ne=>a.jsx("option",{value:Ne.value,children:Ne.label},Ne.value))]}),ne.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),ne.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:ne.error.message}),!ne.isLoading&&!te.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),k&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:k})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:$f.map(Ne=>{const ze=d?d[Ne.value]!==!1:!0,Se=ze&&A.includes(Ne.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${Ne.accent} ${Se?"evaluation-chip--active":""}`,"aria-disabled":!ze,title:ze?void 0:`${Ne.label} split is not connected`,style:ze?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:Se,disabled:!ze,onChange:()=>re(Ne.value)}),a.jsx("span",{children:Ne.label})]},Ne.value)})}),E.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",D," split",E.length>1?"s":""," to enable diagnostics."]}),!$&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a validation or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:F,onChange:Ne=>pe("include_confusion",Ne.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:Ne=>pe("include_curves",Ne.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:B,onChange:Ne=>pe("include_residuals",Ne.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:xe,disabled:!P||Z.isPending||!$,children:Z.isPending?"Running":"Run evaluation"}),Y&&Y.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!$&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),Z.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:Z.error.message}),Z.isSuccess&&G&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",fr(G.generated_at),"."]}),U.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:U.error.message})]}),G?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:G.problem_type==="regression"?"Regression":"Classification"})]}),G.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:G.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:fr(G.generated_at)??G.generated_at})]})]}),ht.map(([Ne,ze])=>a.jsx(FT,{splitKey:Ne,payload:ze,problemType:G.problem_type,formatMetricValue:u},Ne))]}):a.jsx("div",{className:"evaluation-placeholder",children:P?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},FT=({splitKey:e,payload:t,problemType:n,formatMetricValue:r})=>{const l=zT(t.metrics),i=l.length>0,u=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[$T(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),i?a.jsx("div",{className:"evaluation-metrics__grid",children:l.map(d=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:d.key}),a.jsx("span",{className:"evaluation-metrics__value",children:r(d.value)})]},d.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(IT,{matrix:t.confusion_matrix,formatMetricValue:r}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(d=>a.jsx(BT,{curve:d,formatMetricValue:r},`roc-${d.label}`)),t.pr_curves.map(d=>a.jsx(UT,{curve:d,formatMetricValue:r},`pr-${d.label}`))]}),n==="regression"&&t.residuals&&a.jsx(HT,{residuals:t.residuals,formatMetricValue:r})]}),u.length>0&&a.jsx("ul",{className:"evaluation-notes",children:u.map((d,m)=>a.jsx("li",{children:d},`${e}-note-${m}`))})]})},IT=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],r=Array.isArray(e.totals)?e.totals:[],l=Array.isArray(e.normalized)?e.normalized:[],i=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),i!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",Q0(i,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((u,d)=>a.jsx("th",{children:u},`pred-${d}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((u,d)=>{const m=l[d]??[],y=r[d]??u.reduce((p,v)=>p+v,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[d]??`Class ${d}`}),u.map((p,v)=>{const _=typeof m[v]=="number"?m[v]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:p}),_!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:Q0(_,t)})]},`cell-${d}-${v}`)}),a.jsx("td",{children:y})]},`row-${d}`)})})]})]})},BT=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,r=240,l=28,i=n-l*2,u=r-l*2,d=e.fpr.map((m,y)=>{const p=l+Lf(m)*i,v=r-l-Lf(e.tpr[y])*u;return`${y===0?"M":"L"}${p} ${v}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${r}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:l,y:l,width:i,height:u,className:"evaluation-chart__frame"}),a.jsx("line",{x1:l,y1:r-l,x2:n-l,y2:l,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:l,y1:l,x2:l,y2:r-l,className:"evaluation-chart__axis"}),a.jsx("line",{x1:l,y1:r-l,x2:n-l,y2:r-l,className:"evaluation-chart__axis"}),a.jsx("path",{d,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:r-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},UT=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,r=240,l=28,i=n-l*2,u=r-l*2,d=e.recall.map((m,y)=>{const p=l+Lf(m)*i,v=r-l-Lf(e.precision[y])*u;return`${y===0?"M":"L"}${p} ${v}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${r}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:l,y:l,width:i,height:u,className:"evaluation-chart__frame"}),a.jsx("line",{x1:l,y1:l,x2:l,y2:r-l,className:"evaluation-chart__axis"}),a.jsx("line",{x1:l,y1:r-l,x2:n-l,y2:r-l,className:"evaluation-chart__axis"}),a.jsx("path",{d,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:r-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},qT={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},HT=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(r=>typeof r[1]=="number"&&Number.isFinite(r[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([r,l])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:qT[r]??r}),a.jsx("span",{className:"evaluation-summary__value",children:t(l)})]},r))}),a.jsx(VT,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx(WT,{points:e.scatter})]})},VT=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const r=t.reduce((l,i)=>Math.max(l,i),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((l,i)=>{const u=l/r*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${l} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${u}%`}})},`bin-${i}`)})})},WT=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,r=36,l=e.map(_=>_.actual),i=e.map(_=>_.predicted),u=Math.min(...l,...i),d=Math.max(...l,...i),m=d-u||1,y=_=>(_-u)/m,p=_=>r+y(_)*(t-r*2),v=_=>n-r-y(_)*(n-r*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:r,y:r,width:t-r*2,height:n-r*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:r,y1:n-r,x2:t-r,y2:n-r,className:"evaluation-chart__axis"}),a.jsx("line",{x1:r,y1:r,x2:r,y2:n-r,className:"evaluation-chart__axis"}),a.jsx("line",{x1:p(u),y1:v(u),x2:p(d),y2:v(d),className:"evaluation-curve__baseline"}),e.map((_,x)=>a.jsx("circle",{cx:p(_.actual),cy:v(_.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${x}`))]})})},KT={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},YT={queued:"info",running:"info",succeeded:"success",failed:"danger",cancelled:"neutral"},fc={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score"],regression:["rmse","mae","r2","mape"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},G0=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted"],X0=["rmse","mae","r2","mape"],J0=new Set(["rmse","mae","mape","mse"]),Z0={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},hr=e=>!!e&&typeof e=="object"&&!Array.isArray(e),QT=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},Og=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",GT=e=>{if(!e)return fc.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return fc.regression;if(t.includes("class")||t.includes("classification"))return fc.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?fc.regression:n==="classification"?fc.classification:fc.fallback},XT=e=>{var l,i,u;if(!hr(e))return null;const t=[],n=(i=(l=e==null?void 0:e.cross_validation)==null?void 0:l.metrics)==null?void 0:i.mean;hr(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),hr(e.test)&&t.push({values:e.test,labelPrefix:""}),hr(e.validation)&&t.push({values:e.validation,labelPrefix:""}),hr(e.train)&&t.push({values:e.train,labelPrefix:""});const r=GT(e);for(const d of t)for(const m of r){const y=d.values[m];if(typeof y=="number"&&Number.isFinite(y))return{label:d.labelPrefix?`${d.labelPrefix}${m}`:m,value:y}}for(const d of t)for(const[m,y]of Object.entries(d.values))if(typeof y=="number"&&Number.isFinite(y))return{label:d.labelPrefix?`${d.labelPrefix}${m}`:m,value:y};return null},JT=e=>{var n,r;if(!hr(e))return{label:null,values:{}};if(hr(e.test))return{label:"Test",values:e.test};if(hr(e.validation))return{label:"Validation",values:e.validation};const t=(r=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:r.mean;return hr(t)?{label:"CV mean",values:t}:hr(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},ew=e=>{if(!e)return"Unknown model";const t=e.trim();return Z0[t]?Z0[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},ZT=e=>{var i,u;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const d of n)if(typeof d=="string"){const m=d.trim().toLowerCase();if(m==="classification"||m==="regression")return m}const r=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(r.includes("classifier")||r.includes("classification"))return"classification";if(r.includes("regress")||r.includes("regression"))return"regression";const l=e.metrics;if(hr(l)){const d=new Set,m=_=>{hr(_)&&Object.keys(_).forEach(x=>d.add(x.toLowerCase()))};m(l.test),m(l.validation),m(l.train);const y=(u=(i=l==null?void 0:l.cross_validation)==null?void 0:i.metrics)==null?void 0:u.mean;hr(y)&&m(y);const p=G0.some(_=>d.has(_)),v=X0.some(_=>d.has(_));if(p&&!v)return"classification";if(v&&!p)return"regression"}return"unknown"},e2=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:ZT(t),modelLabel:ew(t.model_type),primaryMetric:XT(n),metricBucket:JT(n)}}),tw=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return J0.has(t)||J0.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},t2=({nodeId:e,sourceId:t,graph:n,parameters:r,config:l,renderParameterField:i})=>{var Y;const u=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),d=f.useMemo(()=>{if(!u)return[];const U=new Map;u.nodes.forEach(re=>{re&&re.id&&U.set(re.id,re)});const Z=new Set;return u.edges.forEach(re=>{var xe;if(!re||re.target!==e)return;const pe=U.get(re.source);((xe=pe==null?void 0:pe.data)==null?void 0:xe.catalogType)==="train_model_draft"&&Z.add(pe.id)}),Z.size>0?Array.from(Z):u.nodes.filter(re=>{var pe;return((pe=re==null?void 0:re.data)==null?void 0:pe.catalogType)==="train_model_draft"}).map(re=>re.id)},[u,e]),m=f.useMemo(()=>d.length?d.slice().sort().join("|"):"all",[d]),[y,p]=f.useState(null),[v,_]=f.useState(null);f.useEffect(()=>{let U=!1;return _(null),!t||!u?(p(null),()=>{U=!0}):(Wl(t,u).then(Z=>{U||p(Z)}).catch(Z=>{U||(_((Z==null?void 0:Z.message)??"Unable to compute pipeline ID"),p(null))}),()=>{U=!0})},[u,t]);const x=QT(l==null?void 0:l.show_non_success,!0),j=f.useMemo(()=>["feature-canvas","model-registry",t??"none",y??"pending",m,x?"all-statuses":"succeeded"],[y,x,t,m]),S=ir({queryKey:j,queryFn:async()=>{const U={datasetSourceId:t||void 0,limit:50},Z=new Map,ie=[];let re=null;const pe=Qe=>{!Array.isArray(Qe)||!Qe.length||Qe.forEach(Ne=>{Ne&&!Z.has(Ne.id)&&Z.set(Ne.id,Ne)})},xe=async Qe=>{try{const Ne=await Xu(Qe);return pe(Ne==null?void 0:Ne.jobs),Ne}catch(Ne){return Ne instanceof Error&&ie.push(Ne),null}};if(y&&await xe({...U,pipelineId:y}),d.length===1){const[Qe]=d;await xe({...U,nodeId:Qe})}if(re=await xe(U),!Z.size){if(re)return re;if(ie.length)throw ie[0];return{jobs:[],total:0}}const Ve=Array.from(Z.values()),ht=(re==null?void 0:re.total)??Ve.length;return{jobs:Ve,total:ht}},enabled:!!t,staleTime:30*1e3,retry:(U,Z)=>Z.message.includes("Sign in")?!1:U<2,refetchInterval:U=>{const Z=U.state.data;return((Z==null?void 0:Z.jobs)??[]).some(pe=>pe.status==="queued"||pe.status==="running")?5e3:!1}}),k=((Y=S.data)==null?void 0:Y.jobs)??[],M=f.useMemo(()=>{if(!k.length)return[];if(!d.length)return k;const U=k.filter(Z=>d.includes(Z.node_id));return U.length?U:k},[k,d]),P=f.useMemo(()=>e2(M),[M]),T=f.useMemo(()=>x?P:P.filter(U=>U.job.status==="succeeded"),[P,x]),w=f.useMemo(()=>T.filter(U=>U.problemType==="classification"),[T]),A=f.useMemo(()=>T.filter(U=>U.problemType==="regression"),[T]),E=f.useMemo(()=>!w.length&&!A.length?"classification":w.length?A.length?w.length>=A.length?"classification":"regression":"classification":"regression",[w.length,A.length]),D=typeof(l==null?void 0:l.default_problem_type)=="string"?l.default_problem_type.trim().toLowerCase():"auto",$=D==="classification"||D==="regression"?D:E,[F,R]=f.useState($);f.useEffect(()=>{R($)},[$]);const B=F==="classification"?w:A,ee=f.useMemo(()=>{const U=new Map;return B.forEach(Z=>{const ie=Z.job.model_type,re=U.get(ie)??{label:Z.modelLabel,count:0};re.count+=1,U.set(ie,re)}),Array.from(U.entries()).map(([Z,ie])=>({value:Z,label:ie.label,count:ie.count})).sort((Z,ie)=>Z.label.localeCompare(ie.label))},[B]),le=typeof(l==null?void 0:l.default_method)=="string"?l.default_method.trim().toLowerCase():"",[z,G]=f.useState("all");f.useEffect(()=>{if(!ee.length){G("all");return}const U=ee.find(Z=>Z.value.toLowerCase()===le);G(U?U.value:"all")},[le,ee,F]);const W=f.useMemo(()=>z==="all"?B:B.filter(U=>U.job.model_type===z),[z,B]),H=f.useMemo(()=>W.slice().sort((U,Z)=>{if(Z.job.version!==U.job.version)return Z.job.version-U.job.version;const ie=Date.parse(U.job.updated_at??U.job.created_at??"");return Date.parse(Z.job.updated_at??Z.job.created_at??"")-ie}),[W]),V=f.useMemo(()=>{if(!B.length)return[];const U=new Map;B.forEach(ie=>{const re=ie.job.model_type,pe=U.get(re)??[];pe.push(ie),U.set(re,pe)});const Z=[];return U.forEach((ie,re)=>{const pe=ie.reduce((xe,Ve)=>{const ht=tw(Ve.primaryMetric);if(ht===null)return xe;if(!xe)return Ve;const Qe=tw(xe.primaryMetric);return Qe===null||ht>Qe?Ve:xe},null);Z.push({modelType:re,label:ew(re),bestJob:pe})}),Z.sort((ie,re)=>ie.label.localeCompare(re.label))},[B]),ne=f.useMemo(()=>r.filter(U=>["default_problem_type","show_non_success"].includes(U.name)),[r]),Q=F==="classification"?G0:X0,K=S.isLoading||S.isFetching,J=S.error??null,te=H.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),y&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",y]})]}),v&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:v}),!d.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),ne.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:ne.map(U=>a.jsx(Ae.Fragment,{children:i(U)},U.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(U=>a.jsxs("button",{type:"button",role:"tab","data-active":F===U,className:"model-registry__tab",onClick:()=>R(U),disabled:U==="classification"&&!w.length||U==="regression"&&!A.length,children:[U==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:U==="classification"?w.length:A.length})]},U))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z==="all",onClick:()=>G("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:B.length})]}),ee.map(U=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":z===U.value,onClick:()=>G(U.value),children:[U.label,a.jsx("span",{className:"model-registry__method-count",children:U.count})]},U.value))]})]}),V.length>0&&a.jsx("div",{className:"model-registry__summary",children:V.map(U=>{const Z=U.bestJob,ie=Z!=null&&Z.primaryMetric?Z.primaryMetric.label:null,re=Z!=null&&Z.primaryMetric?Og(Z.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:U.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[ie||"No metrics",ie&&a.jsx("strong",{children:re})]}),(Z==null?void 0:Z.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",Z.job.version]})]},U.modelType)})}),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),J&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:J.message}),!K&&!J&&!te&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),te&&a.jsx("div",{className:"model-registry__table-wrapper",children:a.jsxs("table",{className:"model-registry__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Version"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Model"}),a.jsx("th",{scope:"col",children:"Primary metric"}),Q.map(U=>a.jsx("th",{scope:"col",children:U.replace(/_/g," ")},U)),a.jsx("th",{scope:"col",children:"Evaluated"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:H.map(U=>{const{job:Z,primaryMetric:ie,metricBucket:re}=U,pe=re.values||{},xe=re.label??"",Ve=Z.updated_at??Z.created_at??null;return a.jsxs("tr",{children:[a.jsxs("td",{children:["v",Z.version]}),a.jsx("td",{children:a.jsx("span",{className:`model-registry__status model-registry__status--${YT[Z.status]}`,children:KT[Z.status]})}),a.jsx("td",{children:U.modelLabel}),a.jsx("td",{children:ie?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",children:ie.label}),a.jsx("span",{className:"model-registry__metric-value",children:Og(ie.value)})]}):""}),Q.map(ht=>{const Qe=pe[ht];return a.jsx("td",{children:typeof Qe=="number"&&Number.isFinite(Qe)?Og(Qe):""},`${Z.id}-${ht}`)}),a.jsx("td",{children:xe}),a.jsx("td",{children:Ve?fr(Ve)??Ve:""})]},Z.id)})})]})})]})},n2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},Gl="__tuning_strategies",Xl="__active_tuning_strategy_id",Jl="__expanded_tuning_strategy_ids",Pg=["random","grid","halving","optuna"],dd=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const r=n.toLowerCase();if(t&&t.length>0){const i=t.find(u=>u.toLowerCase()===r);if(i)return i}const l=Pg.find(i=>i.toLowerCase()===r);return l||n},Ar=e=>!!e&&typeof e=="object"&&!Array.isArray(e),gs=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},qo=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return Ar(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return Ar(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},Tg=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,r])=>{if(n){if(Array.isArray(r)){const l=r.filter(i=>i!=null);l.length>0&&(t[n]=l.map(i=>gs(i)));return}r==null||r===""||(t[n]=[gs(r)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},s2=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",r2=new Set(["train","test","validation"]),nw=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const r=n.trim().toLowerCase();r2.has(r)&&t.add(r)}}),Array.from(t)},$g=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([r,l])=>{t.has(r)&&(n[r]=l)}),n},Dg=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([r,l])=>{if(t.has(r)){if(Array.isArray(l)){const i=l.map(u=>gs(u)).filter(u=>u!=null&&u!=="");i.length>0&&(n[r]=i);return}l!=null&&l!==""&&(n[r]=[gs(l)])}}),n},a2=(e,t)=>{const n=t.split(/[\n,]+/).map(m=>m.trim()).filter(m=>m.length>0);if(n.length===0)return{values:[],error:null};const r=[],l=[],i=Array.isArray(e.options)?new Set(e.options.map(m=>m.value)):null;n.forEach(m=>{if(e.type==="number"){const y=Number(m);Number.isFinite(y)?r.push(y):l.push(m);return}if(e.type==="boolean"){const y=m.toLowerCase();if(["true","1","yes","y"].includes(y)){r.push(!0);return}if(["false","0","no","n"].includes(y)){r.push(!1);return}l.push(m);return}if(e.type==="select"){if(i&&!i.has(m)){l.push(m);return}r.push(m);return}r.push(m)});const u=[],d=new Set;if(r.forEach(m=>{const y=typeof m=="object"?JSON.stringify(m):String(m);d.has(y)||(d.add(y),u.push(m))}),l.length>0){const m=l.slice(0,3).join(", "),y=l.length>3?"":"";return{values:u,error:`Invalid value${l.length>1?"s":""}: ${m}${y}`}}return{values:u,error:null}},sw=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),zf=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},Rf=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},md=(e,t,n)=>{let r=e;return typeof t=="number"&&Number.isFinite(t)&&(r=Math.max(r,t)),typeof n=="number"&&Number.isFinite(n)&&(r=Math.min(r,n)),r},o2=(e,t)=>{const n={},r=e.find(m=>(m==null?void 0:m.name)==="solver"),l=e.find(m=>(m==null?void 0:m.name)==="penalty"),i=!!(r&&l&&Array.isArray(r.options)&&r.options.some(m=>(m==null?void 0:m.value)==="liblinear")&&Array.isArray(l.options)&&l.options.some(m=>(m==null?void 0:m.value)==="elasticnet")),u=new Set(["lbfgs","saga"]),d=new Set(["l2","none"]);return e.forEach(m=>{if(!(m!=null&&m.name))return;const y=new Map,p=x=>{if(x==null||typeof x=="number"&&!Number.isFinite(x))return;const j=typeof x=="object"?JSON.stringify(x):`${typeof x}:${String(x)}`;y.has(j)||y.set(j,gs(x))},v=t==null?void 0:t[m.name];if(i&&m.name==="solver")(Array.isArray(m.options)?m.options:[]).forEach(j=>{j!=null&&j.value&&u.has(String(j.value))&&p(j.value)}),!y.size&&typeof v=="string"&&u.has(v)&&p(v),y.size||u.forEach(j=>p(j));else if(i&&m.name==="penalty")(Array.isArray(m.options)?m.options:[]).forEach(j=>{j!=null&&j.value&&d.has(String(j.value))&&p(j.value)}),!y.size&&typeof v=="string"&&d.has(v)&&p(v),y.size||d.forEach(j=>p(j));else if(m.type==="number"){const x=Rf(v),j=Rf(m.min),S=Rf(m.max);if(j!==null&&p(j),x!==null&&p(md(x,j,S)),S!==null&&p(S),y.size<=1&&x!==null){const k=Rf(m.step);k!==null&&k>0?(p(md(x+k,j,S)),p(md(x-k,j,S))):(p(md(x*1.5,j,S)),p(md(x*.5,j,S)))}}else m.type==="boolean"?(p(!0),p(!1),typeof v=="boolean"&&p(v)):(m.type==="select"&&(m.options??[]).slice(0,6).forEach(x=>{(x==null?void 0:x.value)!==void 0&&p(x.value)}),typeof v=="string"&&v.trim().length&&p(v.trim()));const _=Array.from(y.values());_.length>0&&(n[m.name]=_)}),n},l2={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},Lg=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,fd=e=>{if(!Ar(e))return{};const t=gs(e);return Ar(t)?(delete t[Gl],delete t[Xl],delete t[Jl],t):{}},Zl=e=>fd(e),hd=(e,t,n)=>({id:Lg(),label:e,config:Zl(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),Or=e=>`Strategy ${e}`,rw=e=>Ar(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},aw=e=>Ar(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const r=e[n];return t[n]=r===null?null:String(r),t},{}):{},i2=e=>{if(!Ar(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,Gl)&&(t[Gl]=gs(e[Gl])),Object.prototype.hasOwnProperty.call(e,Xl)&&(t[Xl]=e[Xl]),Object.prototype.hasOwnProperty.call(e,Jl)&&(t[Jl]=gs(e[Jl])),t},c2=()=>({strategies:[],activeId:null,expandedIds:[]}),zg=e=>{var m;const t=c2();if(!Ar(e))return t;const n=e[Gl];if(Array.isArray(n)){const y=new Set;n.forEach(p=>{if(!Ar(p))return;let v=typeof p.id=="string"?p.id.trim():"";(!v||y.has(v))&&(v=Lg()),y.add(v);const _=typeof p.label=="string"?p.label.trim():"",x=_.length?_:Or(t.strategies.length+1),j=Ar(p.config)?p.config:{},S={id:v,label:x,config:fd(j),searchSpaceTexts:rw(p.searchSpaceTexts),searchSpaceFieldErrors:aw(p.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!p.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!p.searchSpaceManuallyCleared};t.strategies.push(S)})}const r=new Set(t.strategies.map(y=>y.id)),l=e[Xl],i=typeof l=="string"?l.trim():"";t.activeId=i&&r.has(i)?i:((m=t.strategies[0])==null?void 0:m.id)??null;const u=e[Jl],d=Array.isArray(u)?u.map(y=>typeof y=="string"?y.trim():"").filter(y=>!!y&&r.has(y)):[];return t.activeId&&!d.includes(t.activeId)&&d.push(t.activeId),t.expandedIds=Array.from(new Set(d)).sort(),t},ow=e=>({id:e.id,label:e.label,config:Zl(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),u2=(e,t,n)=>{var d;const r=e.map((m,y)=>({id:typeof m.id=="string"&&m.id.trim().length?m.id:Lg(),label:typeof m.label=="string"&&m.label.trim().length?m.label:Or(y+1),config:fd(m.config),searchSpaceTexts:rw(m.searchSpaceTexts),searchSpaceFieldErrors:aw(m.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!m.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!m.searchSpaceManuallyCleared})),l=new Set(r.map(m=>m.id)),i=typeof t=="string"&&l.has(t)?t:((d=r[0])==null?void 0:d.id)??null,u=Array.from(n??new Set).filter(m=>l.has(m));return i&&!u.includes(i)&&u.push(i),{strategies:r,activeId:i,expandedIds:Array.from(new Set(u)).sort()}},lw=(e,t)=>{var n;return t&&e.some(r=>r.id===t)?t:((n=e[0])==null?void 0:n.id)??""},iw=(e,t)=>{const n=new Set(e.map(l=>l.id)),r=t.filter(l=>n.has(l));return!r.length&&e[0]&&r.push(e[0].id),new Set(r)},Ff=e=>cd(e),cw=(e,t)=>{const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const l of n)if(e[l]!==t[l])return!1;return!0},d2=({nodeId:e,sourceId:t,graph:n,config:r,runtimeConfig:l,cvConfig:i,draftConfigState:u,renderParameterField:d,modelTypeParameter:m,modelTypeOptions:y,searchStrategyParameter:p,searchIterationsParameter:v,searchRandomStateParameter:_,scoringMetricParameter:x,setDraftConfigState:j,onSaveDraftConfig:S})=>{var mi,tl,fi,hi;const k=Qi(),[M,P]=f.useState(null),[T,w]=f.useState(null),[A,E]=f.useState(null),[D,$]=f.useState(0),[F,R]=f.useState(null),[B,ee]=f.useState(!1),[le,z]=f.useState(null),G=((r==null?void 0:r.targetColumn)??"").trim(),W=(r==null?void 0:r.problemType)==="regression"?"regression":"classification",H=(m==null?void 0:m.name)??"model_type",V=(p==null?void 0:p.name)??"search_strategy",ne=(v==null?void 0:v.name)??"search_iterations",Q=(_==null?void 0:_.name)??"search_random_state",K=(x==null?void 0:x.name)??"scoring_metric",J=u==null?void 0:u[H],te=typeof J=="string"&&J.trim().length?J.trim():((l==null?void 0:l.modelType)??"").trim(),Y=ir({queryKey:["model-hyperparameters",te],queryFn:()=>wf(te),enabled:!!te,staleTime:5*60*1e3}),U=((mi=Y.data)==null?void 0:mi.fields)??[],Z=((tl=Y.data)==null?void 0:tl.defaults)??{},ie=f.useMemo(()=>{if(!U.length)return new Set;const ae=new Set;return U.forEach(Me=>{Me!=null&&Me.name&&ae.add(Me.name)}),ae},[U]),re=!!(i!=null&&i.enabled),pe=(i==null?void 0:i.strategy)??"auto",xe=typeof(i==null?void 0:i.folds)=="number"?i.folds:5,Ve=!!(i!=null&&i.shuffle),ht=(i==null?void 0:i.randomState)??null,Qe=f.useMemo(()=>{const ae=[];return((p==null?void 0:p.options)??[]).forEach(Me=>{if(!Me||typeof Me.value!="string")return;const we=Me.value.trim();if(!we.length)return;const We=we.toLowerCase();ae.some(Ue=>Ue.toLowerCase()===We)||ae.push(we)}),ae},[p]),Ne=f.useMemo(()=>Qe.length>0?[...Qe]:[...Pg],[Qe]),ze=dd(p==null?void 0:p.default,Qe),Be=dd(u==null?void 0:u[V],Qe)??ze??Ne[0]??Pg[0],He=u==null?void 0:u[ne];let Ke=null;if(typeof He=="number"&&Number.isFinite(He))Ke=Math.max(1,Math.floor(He));else if(typeof He=="string"){const ae=Number(He.trim());Number.isFinite(ae)&&ae>0&&(Ke=Math.max(1,Math.floor(ae)))}const st=u==null?void 0:u[Q];let X=null;if(typeof st=="number"&&Number.isFinite(st))X=Math.trunc(st);else if(typeof st=="string"){const ae=Number(st.trim());Number.isFinite(ae)&&(X=Math.trunc(ae))}const Oe=typeof(v==null?void 0:v.default)=="number"&&Number.isFinite(v.default)?Math.max(1,Math.floor(v.default)):null,Te=typeof(_==null?void 0:_.default)=="number"&&Number.isFinite(_.default)?Math.trunc(_.default):null,ot=typeof(u==null?void 0:u[K])=="string"?String(u[K]).trim():"",jt=ot.length?ot:null,rn=f.useMemo(()=>qo(u==null?void 0:u.baseline_hyperparameters),[u==null?void 0:u.baseline_hyperparameters]),ve=f.useMemo(()=>qo(u==null?void 0:u.search_space),[u==null?void 0:u.search_space]),be=f.useMemo(()=>Tg(ve.value),[ve.value]),ke=rn.value,Le=rn.error,Xe=be.value,et=ve.error??be.error,tt=f.useMemo(()=>$g(ke,ie),[ie,ke]),xt=f.useMemo(()=>Dg(Xe,ie),[ie,Xe]),Bt=f.useMemo(()=>Object.keys(tt).length,[tt]),Ft=f.useMemo(()=>Object.keys(xt).length,[xt]),ct=Ft>0,[Tt,gt]=f.useState({}),[Ct,hn]=f.useState({}),[Zt,Cn]=f.useState(!1),[Yn,pn]=f.useState(!1),Ot=f.useRef(null);if(!Ot.current){const ae=zg(u);let We=ae.strategies.length>0?ae.strategies.map(ow):(()=>{const rt=Zl(u),mt=dd(rt==null?void 0:rt[V],Ne)??Be;return Array.from(new Set([mt,...Ne])).map((pt,Lt)=>{const Dn=gs(rt),Yt=Ar(Dn)?Dn:{};if(Yt[V]=pt,pt==="random"||pt==="optuna"){const Ln=Ke!==null?Ke:Oe;Ln!==null?Yt[ne]=Ln:delete Yt[ne];const gr=X!==null?X:Te;gr!==null?Yt[Q]=gr:delete Yt[Q]}else delete Yt[ne],delete Yt[Q];return hd(Or(Lt+1),Yt,{searchSpaceTexts:{},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:!1,searchSpaceManuallyCleared:!1})})})();We.length||(We=[hd(Or(1),u)]);const Ue=lw(We,ae.activeId),Pe=iw(We,ae.expandedIds);Ue&&!Pe.has(Ue)&&We.length&&Pe.add(Ue);const _t=Ff(ae);Ot.current={strategies:We,activeId:Ue,expanded:Pe,signature:_t}}const[Ut,bn]=f.useState(()=>Ot.current?Ot.current.strategies:[hd(Or(1),u)]),[qt,Pt]=f.useState(()=>new Set(Ot.current?Array.from(Ot.current.expanded):[])),[an,es]=f.useState(()=>{var ae,Me,we;return((ae=Ot.current)==null?void 0:ae.activeId)??((we=(Me=Ot.current)==null?void 0:Me.strategies[0])==null?void 0:we.id)??""}),Ks=f.useRef(((fi=Ot.current)==null?void 0:fi.signature)??""),En=f.useRef(null),as=f.useRef(null),Gt=f.useMemo(()=>Ut.length?Ut.find(Me=>Me.id===an)??Ut[0]:null,[an,Ut]),Qn=f.useMemo(()=>zg(u),[u]),Tr=f.useMemo(()=>Ff(Qn),[Qn]);f.useEffect(()=>{if(Tr===Ks.current)return;const ae=Qn.strategies.length?Qn.strategies.map(ow):[hd(Or(1),u)],Me=lw(ae,Qn.activeId),we=iw(ae,Qn.expandedIds);Me&&!we.has(Me)&&ae.length&&we.add(Me),En.current=null,bn(ae),es(Me),Pt(we),Ks.current=Tr},[Tr,Qn,u]),f.useEffect(()=>{if(!Ut.length)return;Ut.some(Me=>Me.id===an)||es(Ut[0].id)},[an,Ut]),f.useEffect(()=>{const ae=u2(Ut,an,qt),Me=Ff(ae);Ks.current!==Me&&j(we=>{const We=zg(we),Ue=Ff(We);if(Ue===Me)return Ks.current=Ue,we??{};const Pe=we?{...we}:{};return ae.strategies.length?Pe[Gl]=ae.strategies.map(_t=>({..._t,config:gs(_t.config),searchSpaceTexts:{..._t.searchSpaceTexts},searchSpaceFieldErrors:{..._t.searchSpaceFieldErrors}})):delete Pe[Gl],ae.activeId?Pe[Xl]=ae.activeId:delete Pe[Xl],ae.expandedIds.length?Pe[Jl]=[...ae.expandedIds]:delete Pe[Jl],Ks.current=Me,Pe})},[an,qt,j,Ut]),f.useEffect(()=>{if(!Gt||En.current===Gt.id)return;En.current=Gt.id;const ae=Zl(Gt.config);j(we=>({...i2(we),...ae})),gt(Gt.searchSpaceTexts??{}),hn(Gt.searchSpaceFieldErrors??{}),Cn(Gt.hasAutoFilledSearchSpace??!1),pn(Gt.searchSpaceManuallyCleared??!1);const Me=typeof(ae==null?void 0:ae[H])=="string"?String(ae[H]):(l==null?void 0:l.modelType)??"";as.current=Me},[Gt,H,l==null?void 0:l.modelType,j]),f.useEffect(()=>{if(!Gt)return;const ae=Zl(u),Me=JSON.stringify(ae)!==JSON.stringify(Gt.config??{}),we=!cw(Tt,Gt.searchSpaceTexts),We=!cw(Ct,Gt.searchSpaceFieldErrors),Ue=Gt.hasAutoFilledSearchSpace!==Zt,Pe=Gt.searchSpaceManuallyCleared!==Yn;!Me&&!we&&!We&&!Ue&&!Pe||bn(_t=>_t.map(rt=>rt.id!==Gt.id?rt:{...rt,config:ae,searchSpaceTexts:{...Tt},searchSpaceFieldErrors:{...Ct},hasAutoFilledSearchSpace:Zt,searchSpaceManuallyCleared:Yn}))},[Gt,u,Zt,Ct,Yn,Tt]);const uo=f.useCallback(()=>{const ae=Ut.length+1,Me=Zl(u),we=new Set;Ut.forEach(rt=>{var Dt;const mt=dd((Dt=rt.config)==null?void 0:Dt[V],Ne);mt&&we.add(mt)});const We=Ne.find(rt=>!we.has(rt))??Be,Ue=gs(Me),Pe=Ar(Ue)?Ue:{};if(Pe[V]=We,We==="random"||We==="optuna"){const rt=Ke!==null?Ke:Oe;rt!==null?Pe[ne]=rt:delete Pe[ne];const mt=X!==null?X:Te;mt!==null?Pe[Q]=mt:delete Pe[Q]}else delete Pe[ne],delete Pe[Q];const _t=hd(Or(ae),Pe,{searchSpaceTexts:{...Tt},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:Zt,searchSpaceManuallyCleared:Yn});bn(rt=>[...rt,_t]),Pt(rt=>new Set([...rt,_t.id])),En.current=null,es(_t.id)},[Ne,u,Zt,Ke,Oe,X,Te,Yn,Tt,Be,V,ne,Q,bn,es,Pt,Ut]),Ys=f.useCallback(ae=>{Pt(Me=>{const we=new Set(Me);return we.has(ae)?we.delete(ae):we.add(ae),we})},[]),Os=f.useCallback(ae=>{!ae||ae===an||(En.current=null,es(ae),Pt(Me=>{const we=new Set(Me);return we.add(ae),we}))},[an]),Pa=f.useCallback(ae=>{let Me=null;bn(we=>{if(we.length<=1)return we;const We=we.filter(Pe=>Pe.id!==ae);if(!We.length)return we;const Ue=We.map((Pe,_t)=>({...Pe,label:Or(_t+1)}));if(ae===an){En.current=null;const Pe=Ue[0].id;Me=Pe,es(Pe)}return Ue}),Pt(we=>{const We=new Set(we);return We.delete(ae),Me&&We.add(Me),We})},[an]),Ta=f.useMemo(()=>Ut.map((ae,Me)=>{var Gs,Ps;const we=ae.config??{},We=we==null?void 0:we[H],Ue=typeof We=="string"?We.trim():"",Pe=((Gs=y.find(vs=>vs.value===Ue))==null?void 0:Gs.label)??Ue,_t=we==null?void 0:we[V],rt=typeof _t=="string"?_t.trim():"",mt=(Ps=((p==null?void 0:p.options)??[]).find(vs=>vs.value===rt))==null?void 0:Ps.label,Dt=we==null?void 0:we[K],pt=typeof Dt=="string"?Dt.trim():"",Dn=qo(we==null?void 0:we.baseline_hyperparameters).error,Yt=qo(we==null?void 0:we.search_space),Ln=Tg(Yt.value),gr=Ln.value?Object.keys(Ln.value).length:0,$a=Ln.value?Object.values(Ln.value).reduce((vs,vr)=>vs+(Array.isArray(vr)?vr.length:0),0):0,_r=Dn!==null||Object.values(ae.searchSpaceFieldErrors).some(vs=>!!vs);return{id:ae.id,label:ae.label||Or(Me+1),modelLabel:Pe||"Select model",searchStrategyLabel:mt??(rt||"Random search"),scoringLabel:pt||"Estimator default",parameterCount:gr,candidateCount:$a,hasErrors:_r}}),[y,H,K,p,V,Ut]);f.useEffect(()=>{const ae=as.current;if(ae===null){as.current=te;return}ae!==te&&(as.current=te,gt({}),hn({}),Cn(!1),pn(!1))},[te]),f.useEffect(()=>{!te||!U.length||gt(ae=>{const Me={...ae};let we=!1;return U.forEach(We=>{if(Ct[We.name])return;const Ue=xt[We.name],Pe=Array.isArray(Ue)&&Ue.length>0?Ue.map(_t=>sw(We,_t)).join(", "):"";Me[We.name]!==Pe&&(Me[We.name]=Pe,we=!0)}),we?Me:ae})},[xt,U,te,Ct]),f.useEffect(()=>{if(!te||!U.length||Yn)return;if(ct){Zt||Cn(!0);return}if(Zt)return;const ae=o2(U,Z);Object.keys(ae).length&&(Cn(!0),hn({}),gt(()=>{const Me={};return U.forEach(we=>{if(!ae[we.name])return;const We=ae[we.name].map(Ue=>sw(we,Ue)).filter(Ue=>Ue.length>0).join(", ");Me[we.name]=We}),Me}),j(Me=>{const we=Me?{...Me}:{};return we.search_space=ae,we}))},[Zt,Z,U,te,ct,Yn,j]);const[ta,$r]=f.useState(jt??"");f.useEffect(()=>{$r(jt??"")},[jt]);const na=f.useMemo(()=>l2[W==="regression"?"regression":"classification"],[W]),sa=(x==null?void 0:x.label)??"Scoring metric",ra=(x==null?void 0:x.description)??"Pick the evaluation metric used to rank candidates.",Ee=f.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),Ye=f.useMemo(()=>Object.values(Ct).some(ae=>!!ae),[Ct]),Ge=f.useCallback((ae,Me)=>{ie.has(ae)&&j(we=>{const We={...we},Ue=qo(we==null?void 0:we.baseline_hyperparameters).value??{},_t={...$g(Ue,ie)};return Me===void 0?delete _t[ae]:_t[ae]=Me,Object.keys(_t).length>0?We.baseline_hyperparameters=_t:delete We.baseline_hyperparameters,We})},[ie,j]),sn=f.useCallback((ae,Me)=>{gt(Ue=>({...Ue,[ae.name]:Me}));const{values:we,error:We}=a2(ae,Me);hn(Ue=>({...Ue,[ae.name]:We})),!We&&j(Ue=>{const Pe={...Ue},_t=qo(Ue==null?void 0:Ue.search_space).value??{},mt={...Dg(_t,ie)};return we.length>0?mt[ae.name]=we.map(Dt=>gs(Dt)):delete mt[ae.name],Object.keys(mt).length>0?Pe.search_space=mt:delete Pe.search_space,Pe})},[ie,j]),Mt=f.useCallback(ae=>{Ge(ae,void 0)},[Ge]),os=f.useCallback(()=>{j(ae=>{if(!ae||!ae.baseline_hyperparameters)return ae??{};const Me={...ae};return delete Me.baseline_hyperparameters,Me})},[j]),nn=f.useCallback(()=>{pn(!0),Cn(!0),gt({}),hn({}),j(ae=>{if(!ae||!ae.search_space)return ae??{};const Me={...ae};return delete Me.search_space,Me})},[j]),jn=f.useCallback(ae=>{$r(ae);const Me=ae.trim();j(we=>{const We={...we};return Me.length>0?We.scoring_metric=Me:delete We.scoring_metric,We})},[j]),dn=f.useCallback(ae=>{if(!(ae!=null&&ae.name)||!ie.has(ae.name))return null;const Me=`baseline-${e}-${ae.name}`,we=tt[ae.name],We=we!==void 0,Ue=Z==null?void 0:Z[ae.name],Pe=ae.label??ae.name,_t=ae.description,rt=Ue!==void 0?`Default: ${zf(Ue)}`:"Default: estimator setting";let mt;if(ae.type==="number"){const Dt=typeof we=="number"?String(we):"";mt=a.jsx("input",{id:Me,type:"number",className:"canvas-modal__parameter-input",value:Dt,onChange:pt=>{const Lt=pt.target.value;if(!Lt.length){Mt(ae.name);return}const Dn=Number(Lt);Number.isFinite(Dn)&&Ge(ae.name,Dn)},min:ae.min,max:ae.max,step:ae.step,placeholder:"Leave blank to use default"})}else if(ae.type==="select"){const Dt=We?String(we):"";mt=a.jsxs("select",{id:Me,className:"canvas-modal__parameter-select",value:Dt,onChange:pt=>{const Lt=pt.target.value;if(!Lt.length){Mt(ae.name);return}Ge(ae.name,Lt)},children:[a.jsx("option",{value:"",children:"Use default"}),(ae.options??[]).map(pt=>a.jsx("option",{value:pt.value,children:pt.label},pt.value))]})}else if(ae.type==="boolean"){const Dt=We?we?"true":"false":"";mt=a.jsxs("select",{id:Me,className:"canvas-modal__parameter-select",value:Dt,onChange:pt=>{const Lt=pt.target.value;if(!Lt.length){Mt(ae.name);return}Ge(ae.name,Lt==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const Dt=typeof we=="string"?we:"";mt=a.jsx("input",{id:Me,type:"text",className:"canvas-modal__parameter-input",value:Dt,onChange:pt=>{const Lt=pt.target.value;if(!Lt.length){Mt(ae.name);return}Ge(ae.name,Lt)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Me,className:"canvas-modal__parameter-label",children:[Pe,_t&&a.jsx("span",{className:"canvas-modal__parameter-description",children:_t})]}),mt,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:We?`Override: ${zf(we)}`:rt})})]},ae.name)},[ie,tt,Z,e,Ge]),gn=f.useCallback(ae=>{if(!(ae!=null&&ae.name)||!ie.has(ae.name))return null;const Me=`search-${e}-${ae.name}`,we=Tt[ae.name]??"",We=xt[ae.name],Ue=Array.isArray(We)?We.length:0,Pe=Ct[ae.name],_t=Z==null?void 0:Z[ae.name],rt=ae.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":ae.type==="boolean"?"Enter true/false values, separated by commas or new lines":ae.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",mt=Array.isArray(We)?We.slice(0,3).map(Dt=>zf(Dt)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:Me,className:"canvas-modal__parameter-label",children:[ae.label??ae.name,ae.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:ae.description})]}),a.jsx("textarea",{id:Me,className:"canvas-modal__parameter-input",rows:3,value:we,onChange:Dt=>sn(ae,Dt.target.value),placeholder:rt,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Ue>0?`Configured ${Ue} value${Ue===1?"":"s"}${mt?` (${mt}${Ue>3?"":""})`:""}`:`Default: ${zf(_t)}`})}),Pe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:Pe})]},ae.name)},[ie,xt,sn,Z,e,Ct,Tt]),_n=f.useMemo(()=>{if(!ct)return{parameterCount:0,candidateProduct:null};const ae=Object.values(xt),Me=ae.length;let we=null;if(ae.length>0){let We=1,Ue=!1;ae.forEach(Pe=>{We*=Math.max(Pe.length,1),(!Number.isFinite(We)||We>1e6)&&(Ue=!0)}),we=Ue?null:We}return{parameterCount:Me,candidateProduct:we}},[xt,ct]),on=f.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),kn=f.useCallback(ae=>{if(!on)return null;const Me=gs(on);if(!Me||!Array.isArray(Me.nodes))return on;const we=fd(ae),We=Object.keys(we).length>0;return Me.nodes=Me.nodes.map(Ue=>{if(!Ue||Ue.id!==e)return Ue;const Pe=(Ue==null?void 0:Ue.data)??{},_t=(Pe==null?void 0:Pe.config)??{},rt=fd(_t),mt=We?{...rt,...we}:rt;return{...Ue,data:{...Pe,config:mt,isConfigured:!0}}}),Me},[on,e]),aa=f.useMemo(()=>{const ae=kn(u);return ae||on},[u,on,kn]),Qs=f.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const ae=n.nodes,Me=n.edges;return(()=>{var _t;const Pe=ae.find(rt=>(rt==null?void 0:rt.id)===e);return Pe?nw((_t=Pe==null?void 0:Pe.data)==null?void 0:_t.connectedSplits):[]})().includes("validation")||Me.some(Pe=>!Pe||(typeof Pe.target=="string"?Pe.target:null)!==e?!1:(typeof Pe.sourceHandle=="string"?Pe.sourceHandle.toLowerCase():"").includes("validation"))?!0:Me.some(Pe=>{var pt;if(!Pe||(typeof Pe.target=="string"?Pe.target:null)!==e)return!1;const rt=typeof Pe.source=="string"?Pe.source:null;if(!rt)return!1;const mt=ae.find(Lt=>(Lt==null?void 0:Lt.id)===rt);return mt?nw((pt=mt==null?void 0:mt.data)==null?void 0:pt.activeSplits).includes("validation"):!1})?!1:null},[n,e]);f.useEffect(()=>{let ae=!1;return!t||!on?(R(null),()=>{ae=!0}):(Wl(t,on).then(Me=>{ae||R(Me)}).catch(()=>{ae||R(null)}),()=>{ae=!0})},[on,t]),f.useEffect(()=>{let ae=!1;w(null);const Me=aa??on;return!t||!Me?(P(null),()=>{ae=!0}):(Wl(t,Me).then(we=>{ae||P(we)}).catch(we=>{ae||(w((we==null?void 0:we.message)??"Unable to compute pipeline ID"),P(null))}),()=>{ae=!0})},[on,aa,t]),f.useEffect(()=>{if(!M||!F){ee(!1);return}ee(M!==F)},[M,F]);const Dr=!!(t&&e),pr=f.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",M??"pending",e],[e,M,t]),_s=ir({queryKey:pr,queryFn:async()=>{var Me;const ae={datasetSourceId:t||void 0,nodeId:e,limit:5};if(M){const we=await Ju({...ae,pipelineId:M});if((((Me=we==null?void 0:we.jobs)==null?void 0:Me.length)??0)>0)return we}return Ju(ae)},enabled:Dr,retry:(ae,Me)=>Me.message.includes("Sign in")?!1:ae<2,refetchInterval:ae=>{const Me=ae.state.data;return((Me==null?void 0:Me.jobs)??[]).some(Ue=>Ue.status==="queued"||Ue.status==="running")?5e3:!1}}),{mutateAsync:Lr,isPending:zr,error:mo}=Im({mutationFn:hx,onSuccess:ae=>{const Me=Array.isArray(ae.jobs)?ae.jobs.length:0,we=Me>0?ae.jobs[0]:null;E(we),$(Me),k.invalidateQueries({queryKey:pr})}}),oa=f.useMemo(()=>{const ae=[];return t||ae.push("Select a dataset before launching tuning jobs."),(!on||!on.nodes.length)&&ae.push("Connect this node to an upstream pipeline before tuning."),G||ae.push("Set a target column before tuning."),Qs===!1&&ae.push("Connect the validation split to this node to enable tuning."),te||ae.push("Choose a model type before enqueuing tuning jobs."),ct||ae.push("Define at least one hyperparameter in the search space."),Le&&ae.push(Le),et&&ae.push(et),Ye&&ae.push("Resolve invalid candidate values in the search space."),(Be==="random"||Be==="optuna")&&!Ke&&ae.push("Provide the maximum iterations for random or Optuna search."),re&&xe<2&&ae.push("Cross-validation requires at least 2 folds."),T&&ae.push(T),ae},[Le,re,xe,on,ct,Ye,te,T,Ke,et,Be,t,G,Qs]),la=((hi=_s.data)==null?void 0:hi.jobs)??[],ia=_s.isLoading||_s.isFetching,el=_s.error,fo=oa.length>0||Ye||!M||!t||!on||!ct||zr,Cc=f.useMemo(()=>m?y.length?{...m,options:y}:m:null,[y,m]),di=f.useCallback(async()=>{if(!M||!t||!on||Ut.length===0)return;if(S){try{const Ue=S();ee(!1),Ue&&typeof Ue.then=="function"&&await Ue}catch{}await new Promise(Ue=>setTimeout(Ue,100))}const ae=async()=>{const Ue=[],Pe=[],_t=async rt=>{if(!rt)return new Set;if(rt===te)return ie;const mt=["model-hyperparameters",rt],Dt=k.getQueryData(mt),pt=Lt=>{const Dn=new Set;return(Lt??[]).forEach(Yt=>{Yt!=null&&Yt.name&&Dn.add(Yt.name)}),Dn};if(Dt)return pt(Dt.fields);try{const Lt=await k.fetchQuery({queryKey:mt,queryFn:()=>wf(rt)});return pt(Lt==null?void 0:Lt.fields)}catch{return new Set}};for(let rt=0;rt<Ut.length;rt+=1){const mt=Ut[rt],Dt=mt.label||Or(rt+1),pt=Zl(mt.config),Lt=pt==null?void 0:pt[H],Dn=typeof Lt=="string"&&Lt.trim().length?Lt.trim():te;if(!Dn){Pe.push(`${Dt} is missing a model selection.`);continue}const Yt=dd(pt==null?void 0:pt[V],Ne)??ze??"random",Ln=await _t(Dn),$a=qo(pt==null?void 0:pt.baseline_hyperparameters).value??{},_r=Ln.size>0?$g($a,Ln):gs($a),Gs=qo(pt==null?void 0:pt.search_space);if(Gs.error){Pe.push(`${Dt} has invalid search space: ${Gs.error}`);continue}const Ps=Tg(Gs.value);if(Ps.error){Pe.push(`${Dt} has invalid search space: ${Ps.error}`);continue}const vs=Ps.value??{},vr=Ln.size>0?Dg(vs,Ln):gs(vs);if(!vr||Object.keys(vr).length===0){Pe.push(`${Dt} requires at least one hyperparameter in the search space.`);continue}if(Object.values(mt.searchSpaceFieldErrors??{}).some(Nn=>!!Nn)){Pe.push(`${Dt} has search space entries that need attention.`);continue}const pi=Object.keys(vr).length;let ho=null;if(pi>0){let Nn=1,Gn=!1;Object.values(vr).forEach(yr=>{const _i=Array.isArray(yr)?yr.length:0;Nn*=Math.max(_i,1),(!Number.isFinite(Nn)||Nn>1e6)&&(Gn=!0)}),ho=Gn?null:Nn}const po=pt==null?void 0:pt[K],nl=typeof po=="string"?po.trim():"",sl=nl.length?nl:null,Rr=()=>{const Nn=pt==null?void 0:pt[ne];let Gn=null;if(typeof Nn=="number"&&Number.isFinite(Nn))Gn=Math.max(1,Math.floor(Nn));else if(typeof Nn=="string"){const yr=Number(Nn.trim());Number.isFinite(yr)&&yr>0&&(Gn=Math.max(1,Math.floor(yr)))}return Gn===null&&(Yt==="random"||Yt==="optuna")?Oe!==null?Oe:null:Gn},gi=()=>{const Nn=pt==null?void 0:pt[Q];let Gn=null;if(typeof Nn=="number"&&Number.isFinite(Nn))Gn=Math.trunc(Nn);else if(typeof Nn=="string"){const yr=Number(Nn.trim());Number.isFinite(yr)&&(Gn=Math.trunc(yr))}return Gn===null&&(Yt==="random"||Yt==="optuna")?Te!==null?Te:null:Gn},Da=Rr(),rl=gi(),zn={};G&&(zn.target_column=G),zn.problem_type=W,zn.strategy_id=mt.id,zn.strategy_label=Dt,zn.strategy_index=rt+1,zn.search_strategy=Yt,Da!==null&&(Yt==="random"||Yt==="optuna")&&(zn.max_iterations=Da),sl&&(zn.scoring_metric=sl),rl!==null&&(zn.random_state=rl),zn.search_space_keys=Object.keys(vr),pi>0&&(zn.search_space_parameters=pi),ho!==null&&(zn.search_space_candidates=ho),zn.cross_validation={enabled:re,strategy:pe,folds:xe,shuffle:Ve,random_state:ht};const go=kn(pt)??on;if(!go){Pe.push(`Unable to build pipeline graph for ${Dt}.`);continue}const kc=_r&&Object.keys(_r).length>0?gs(_r):void 0,ys=gs(vr),La={dataset_source_id:t,pipeline_id:M,node_id:e,model_type:Dn,model_types:[Dn],search_strategy:Yt,search_space:ys,baseline_hyperparameters:kc,n_iterations:Yt==="random"||Yt==="optuna"?Da??void 0:void 0,scoring:sl??void 0,random_state:rl??void 0,cross_validation:{enabled:re,strategy:pe,folds:xe,shuffle:Ve,random_state:ht},metadata:zn,job_metadata:zn,run_tuning:!0,graph:go,target_node_id:e};Ue.push({payload:La,label:Dt})}return{plans:Ue,issues:Pe}};z(null);const{plans:Me,issues:we}=await ae();if(!Me.length){we.length&&z(we.join(" "));return}const We=[];for(const{payload:Ue}of Me)try{const Pe=await Lr(Ue);Array.isArray(Pe==null?void 0:Pe.jobs)&&Pe.jobs.length&&We.push(...Pe.jobs)}catch(Pe){Pe instanceof Error&&Pe.message?z(Pe.message):z("Failed to enqueue one or more tuning jobs.");return}if(We.length){const Ue=We[We.length-1];E(Ue),$(We.length)}},[ie,re,xe,ht,Ve,pe,Lr,on,kn,te,H,e,S,ze,k,M,W,K,Oe,ne,Te,Q,V,z,ee,t,Ut,G]),Xt=f.useCallback(()=>{Dr&&_s.refetch()},[Dr,_s]),Ec=ae=>{var Lt,Dn,Yt,Ln,gr;const Me=n2[ae.status]??ae.status,We=(((Lt=y.find($a=>$a.value===ae.model_type))==null?void 0:Lt.label)??ae.model_type??"").trim(),Ue=(()=>{switch(ae.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"optuna":return"Optuna search";default:return"Random search"}})(),Pe=ae.updated_at?fr(ae.updated_at):null,_t=ae.updated_at||ae.created_at,rt=_t?Pe??new Date(_t).toLocaleString():null,mt=[];We&&mt.push(`Model ${We}`),mt.push(Ue),Array.isArray(ae.results)&&ae.results.length>0&&mt.push(`${ae.results.length} candidates`);const Dt=typeof ae.best_score=="number"&&Number.isFinite(ae.best_score)?ae.best_score:typeof((Dn=ae.metrics)==null?void 0:Dn.best_score)=="number"?ae.metrics.best_score:null;Dt!==null&&mt.push(`Best score ${s2(Dt)}`);const pt=String(((Yt=ae.metrics)==null?void 0:Yt.scoring)??((Ln=ae.metrics)==null?void 0:Ln.scorer)??((gr=ae.metadata)==null?void 0:gr.scoring_metric)??"").trim();return pt&&mt.push(`Scoring ${pt}`),rt&&mt.push(`Updated ${rt}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["Run ",ae.run_number]}),"  ",Me,mt.length?`  ${mt.join("  ")}`:""]},ae.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:uo,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Xt,disabled:!Dr||ia,children:ia?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),M&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:M})]}),B&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]}),oa.map((ae,Me)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:ae},`tuning-prereq-${Me}`)),mo instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:mo.message}),le&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:le}),el&&!(mo instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:el.message||"Unable to load tuning jobs."}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:D>1?a.jsxs("span",{children:["Queued ",D," tuning jobs. Latest job ",A.id," (run ",A.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",A.id," queued (run ",A.run_number,")."]})}),ct&&_n.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",_n.parameterCount," hyperparameter",_n.parameterCount===1?"":"s",_n.candidateProduct!==null?`  up to ${_n.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsx("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:Ut.map((ae,Me)=>{const we=Ta[Me],We=!!(Gt&&Gt.id===ae.id),Ue=qt.has(ae.id),Pe=[];if(we!=null&&we.modelLabel&&Pe.push(we.modelLabel),we!=null&&we.searchStrategyLabel&&Pe.push(we.searchStrategyLabel),we!=null&&we.scoringLabel&&Pe.push(`Scoring ${we.scoringLabel}`),we!=null&&we.parameterCount){const rt=we.candidateCount?`${we.parameterCount} param${we.parameterCount===1?"":"s"}  ${we.candidateCount} candidate${we.candidateCount===1?"":"s"}`:`${we.parameterCount} param${we.parameterCount===1?"":"s"}`;Pe.push(rt)}else Pe.includes("Needs attention")||Pe.push("No search values");we!=null&&we.hasErrors&&Pe.push("Needs attention");const _t=Pe.length>0?Pe.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{Ys(ae.id),We||Os(ae.id)},"aria-expanded":Ue,"aria-controls":`tuning-strategy-body-${ae.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${Ue?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(we==null?void 0:we.label)??Or(Me+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:_t})]})]}),Ut.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>Pa(ae.id),"aria-label":`Remove ${(we==null?void 0:we.label)??Or(Me+1)}`,children:"Remove"})]}),Ue&&We&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${ae.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Cc&&d(Cc),p&&d(p),(Be==="random"||Be==="optuna")&&v&&d(v),(Be==="random"||Be==="optuna")&&_&&d(_)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:sa}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:ra}),a.jsxs("div",{id:Ee,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:ta||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[na.map(rt=>a.jsx("button",{type:"button",onClick:()=>jn(rt.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:ta===rt.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:ta===rt.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:rt.label},rt.value)),a.jsx("button",{type:"button",onClick:()=>jn(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),te&&U.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Bt>0?`${Bt} override${Bt===1?"":"s"} configured`:"Using template defaults"}),Bt>0&&a.jsx("button",{type:"button",onClick:os,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),Le&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Le}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:U.map(dn)})]}),te&&U.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Ft>0?`${Ft} parameter${Ft===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:nn,disabled:Ft===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:Ft===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:Ft===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:Ft===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),et&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:et}),Ye&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:U.map(gn)})]})]})]},ae.id)})}),re&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",xe," folds before reporting aggregate metrics."]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:di,disabled:fo,children:zr?"Queuing":"Launch tuning job"})}),ia&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!ia&&la.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),la.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:la.map(Ec)})]})},Rg={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},m2=(e,t)=>{if(e==null||e==="")return Rg[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return Rg[t].auto;const r=Math.max(Math.min(e,1),0),l=r*100,i=r.toFixed(r>=.1||r===0?2:3),u=t==="undersampling"?"majority":"majority baseline";return`${i} ratio (${l.toFixed(1)}% of ${u})`}const n=e.trim().toLowerCase();return Rg[t][n]??n},f2=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let r=e.length-1;r>=0;r-=1){const l=e[r];if(typeof l!="string")continue;const i=l.toLowerCase();if(n.some(u=>i.includes(u)))return l}return null},h2=(e,t)=>t?"Missing":e.length?e:"Empty string",p2=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:r,onRefreshPreview:l,config:i,methodParameter:u,targetColumnParameter:d,samplingStrategyParameter:m,randomStateParameter:y,replacementParameter:p,kNeighborsParameter:v,renderParameterField:_,formatMetricValue:x,formatMissingPercentage:j,schemaGuard:S})=>{var K;const k=r.data,M=r.status,P=Array.isArray(k==null?void 0:k.applied_steps)?k==null?void 0:k.applied_steps:[],T=f.useMemo(()=>f2(P,e),[P,e]),w=(i==null?void 0:i.targetColumn)??"",A=(i==null?void 0:i.method)||(typeof(u==null?void 0:u.default)=="string"?u.default:""),E=f.useMemo(()=>{const J=Array.isArray(u==null?void 0:u.options)?u==null?void 0:u.options:[];if(A){const te=J.find(Y=>Y.value===A);return te!=null&&te.label?te.label:A.replace(/_/g," ")}return J.length>0?J[0].label??J[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[A,u==null?void 0:u.options,e]),D=f.useMemo(()=>m2(i==null?void 0:i.samplingStrategy,e),[i==null?void 0:i.samplingStrategy,e]),$=f.useMemo(()=>(i==null?void 0:i.randomState)===null||(i==null?void 0:i.randomState)===void 0?"Not set":Number.isFinite(i.randomState)?String(i.randomState):"Not set",[i==null?void 0:i.randomState]),F=f.useMemo(()=>{if(e!=="oversampling")return null;const J=i==null?void 0:i.kNeighbors;if(typeof J=="number"&&Number.isFinite(J))return String(Math.max(1,Math.round(J)));if(v&&typeof v.default=="number"){const te=v.default;if(Number.isFinite(te))return String(Math.max(1,Math.round(te)))}return"Default"},[i==null?void 0:i.kNeighbors,v,e]),R=(i==null?void 0:i.replacement)===null||(i==null?void 0:i.replacement)===void 0?null:i.replacement?"With replacement":"Without replacement",B=f.useMemo(()=>{if(M!=="success"||!k||!w)return{rows:[],total:0,truncated:!1};const J=Array.isArray(k.sample_rows)?k.sample_rows:[];if(!J.length)return{rows:[],total:0,truncated:!1};const te=new Map;J.forEach(xe=>{if(!xe||typeof xe!="object")return;const Ve=xe[w],ht=Ve==null,Qe=ht?"__missing__":String(Ve),Ne=h2(ht?"":Qe,ht),ze=te.get(Qe);ze?ze.count+=1:te.set(Qe,{label:Ne,count:1,percentage:0,isMissing:ht})});const Y=Array.from(te.values()).sort((xe,Ve)=>Ve.count-xe.count),U=Y.reduce((xe,Ve)=>xe+Ve.count,0),Z=8,ie=Y.length>Z;return{rows:(ie?Y.slice(0,Z):Y).map(xe=>({...xe,percentage:U>0?xe.count/U*100:0})),total:U,truncated:ie}},[k,M,w]),ee=((K=k==null?void 0:k.metrics)==null?void 0:K.row_count)??null,le=!!t&&n&&M!=="loading"&&!(S!=null&&S.blocked),z=f.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),G=f.useMemo(()=>!(S!=null&&S.blocked)||!S.details.length?"":S.details.map(J=>J.logical_family?`${J.name} (${J.logical_family})`:J.name).join(", "),[S]),W=!w,H=!!w&&Array.isArray(k==null?void 0:k.columns)&&!(k!=null&&k.columns.includes(w)),V=e==="undersampling"?"Class undersampling":"Class oversampling",ne=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",Q=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:V}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:l,disabled:!le,children:M==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:ne}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),W&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",Q,"."]}),(S==null?void 0:S.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[S.message,G&&a.jsxs(a.Fragment,{children:[" ","Columns: ",G,"."]})]}),M==="error"&&r.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:r.error}),H&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",w," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),T&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:T}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:E})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:D})]}),e==="oversampling"&&F&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:F})]}),R&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:R})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:$})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&_(u),m&&_(m),e==="oversampling"&&v&&_(v),y&&_(y),p&&_(p)]}),d&&a.jsx("div",{className:"canvas-modal__parameter-list",children:_(d)}),w&&M==="success"&&!H&&(B.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:B.rows.map(J=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:J.label}),a.jsx("td",{children:x(J.count)}),a.jsx("td",{children:j(J.percentage)})]},`resampling-class-${J.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",x(B.total)," row",B.total===1?"":"s"," from the preview.",B.truncated?" Showing top classes by frequency.":""]}),ee!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",x(ee),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},g2=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},_2=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),v2=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),y2=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return f.useMemo(()=>{const r=g2(e),l=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",i=t==="missing_value_indicator",u=t==="replace_aliases_typos",d=t==="trim_whitespace",m=t==="remove_special_characters",y=t==="replace_invalid_values",p=t==="regex_replace_fix",v=t==="normalize_text_case",_=t==="standardize_date_formats",x=t==="label_encoding",j=t==="target_encoding",S=t==="hash_encoding",k=t==="train_model_draft",M=t==="model_evaluation",P=t==="model_registry_overview",T=t==="hyperparameter_tuning",w=t==="feature_target_split",A=t==="train_test_split",E=t==="class_undersampling",D=t==="class_oversampling",$=t==="ordinal_encoding",F=t==="dummy_encoding",R=t==="one_hot_encoding",B=t==="feature_math",ee=t==="cast_column_types",le=t==="binning_discretization",z=t==="scale_numeric_features",G=t==="polynomial_features",W=t==="feature_selection",H=t==="transformer_audit",V=t==="outlier_removal",ne=t==="skewness_transform",Q=t==="skewness_distribution",K=t==="binned_distribution",J=v2.has(t),te=_2.has(t),Y=t==="remove_duplicates",U=t==="drop_missing_columns",Z=t==="drop_missing_rows";return{catalogType:t,isDataset:r,isImputerNode:l,isMissingIndicatorNode:i,isReplaceAliasesNode:u,isTrimWhitespaceNode:d,isRemoveSpecialCharsNode:m,isReplaceInvalidValuesNode:y,isRegexCleanupNode:p,isNormalizeTextCaseNode:v,isStandardizeDatesNode:_,isLabelEncodingNode:x,isTargetEncodingNode:j,isHashEncodingNode:S,isTrainModelDraftNode:k,isModelEvaluationNode:M,isModelRegistryNode:P,isHyperparameterTuningNode:T,isFeatureTargetSplitNode:w,isTrainTestSplitNode:A,isClassUndersamplingNode:E,isClassOversamplingNode:D,isOrdinalEncodingNode:$,isDummyEncodingNode:F,isOneHotEncodingNode:R,isFeatureMathNode:B,isCastNode:ee,isBinningNode:le,isScalingNode:z,isPolynomialFeaturesNode:G,isFeatureSelectionNode:W,isTransformerAuditNode:H,isOutlierNode:V,isSkewnessNode:ne,isSkewnessDistributionNode:Q,isBinnedDistributionNode:K,isDataConsistencyNode:J,isInspectionNode:te,isRemoveDuplicatesNode:Y,isDropMissingColumnsNode:U,isDropMissingRowsNode:Z,isDropMissingNode:U||Z}},[t,e])},b2=({isScalingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(null),[d,m]=f.useState(null),[y,p]=f.useState(!1),[v,_]=f.useState(0),x=f.useCallback(()=>{_(j=>j+1)},[]);return f.useEffect(()=>{let j=!0;return e?t?n?(p(!0),m(null),tx(t,{graph:r,targetNodeId:l}).then(S=>{j&&u(S??null)}).catch(S=>{j&&(u(null),m((S==null?void 0:S.message)??"Unable to load scaling insights"))}).finally(()=>{j&&p(!1)}),()=>{j=!1}):(u(null),m("Connect this step to an upstream output to load scaling insights."),p(!1),()=>{j=!1}):(u(null),m("Select a dataset to load scaling insights."),p(!1),()=>{j=!1}):(u(null),m(null),p(!1),()=>{j=!1})},[r,n,e,v,t,l]),{scalingData:i,scalingError:d,isFetchingScaling:y,refreshScaling:x}},x2=({shouldLoad:e,sourceId:t,graphContext:n,targetNodeId:r,transformations:l})=>{const[i,u]=f.useState(null),[d,m]=f.useState(null),[y,p]=f.useState(!1),[v,_]=f.useState(0),x=f.useRef(null),j=f.useCallback(()=>{_(S=>S+1)},[]);return f.useEffect(()=>{let S=!0;return e?t?(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{if(!S)return;p(!0),m(null);let k;l.length>0&&(k=l.map(M=>({column:M.column,method:M.method}))),ex(t,{transformations:k,graph:n,targetNodeId:r}).then(M=>{S&&u(M??null)}).catch(M=>{S&&(u(null),m((M==null?void 0:M.message)??"Unable to load skewness insights"))}).finally(()=>{S&&p(!1)})},300),()=>{S=!1,x.current&&clearTimeout(x.current)}):(u(null),m("Select a dataset to load skewness insights."),p(!1),x.current&&(clearTimeout(x.current),x.current=null),()=>{S=!1}):(u(null),m(null),p(!1),x.current&&(clearTimeout(x.current),x.current=null),()=>{S=!1})},[n,v,e,t,r,l]),{skewnessData:i,skewnessError:d,isFetchingSkewness:y,refreshSkewness:j}},w2=({isBinnedDistributionNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l,samplePreset:i})=>{const[u,d]=f.useState(null),[m,y]=f.useState(null),[p,v]=f.useState(!1),[_,x]=f.useState(0),j=f.useCallback(()=>{x(S=>S+1)},[]);return f.useEffect(()=>{let S=!0;if(!e)return d(null),y(null),v(!1),()=>{S=!1};if(!t)return d(null),y("Select a dataset to load binned column distributions."),v(!1),()=>{S=!1};if(!n)return d(null),y("Connect this step to an upstream output to load binned column distributions."),v(!1),()=>{S=!1};v(!0),y(null);const k=ed.find(P=>P.value===i)??ed[0],M=k.value==="all"?"all":Number(k.value);return sx(t,{sampleSize:M,graph:r,targetNodeId:l}).then(P=>{S&&d(P??null)}).catch(P=>{S&&(d(null),y((P==null?void 0:P.message)??"Unable to load binned column distributions"))}).finally(()=>{S&&v(!1)}),()=>{S=!1}},[r,n,e,_,i,t,l]),{binnedDistributionData:u,binnedDistributionError:m,isFetchingBinnedDistribution:p,refreshBinnedDistribution:j}},pd={status:"idle",data:null,error:null},j2=1e3,N2=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:r,isPreviewNode:l,targetNodeId:i,previewSignature:u,skipPreview:d=!1,requestPreviewRows:m,includeSignals:y})=>{const[p,v]=f.useState(pd),[_,x]=f.useState(0),j=f.useRef(null),S=f.useRef(-1),k=f.useCallback(()=>{x(M=>M+1)},[]);return f.useEffect(()=>{if(!e){v(pd),j.current=null,S.current=-1;return}if(d)return;if(!t){v(l?{status:"error",data:null,error:"Select a dataset to generate previews."}:pd);return}if(!n){v(l?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:pd);return}if(!r)return;const M=(()=>{const F=Array.isArray(r.nodes)?r.nodes.map(B=>B&&typeof B.id=="string"?B.id:null).filter(B=>!!B).sort():[],R=Array.isArray(r.edges)?r.edges.map(B=>{const ee=B&&typeof B.source=="string"?B.source.trim():"",le=B&&typeof B.target=="string"?B.target.trim():"";return ee&&le?`${ee}->${le}`:null}).filter(B=>!!B).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:i??null,nodeIds:F,edgePairs:R})})(),P=u??M,T=P!==j.current;if(!(S.current!==_)&&!T)return;j.current=P,S.current=_;let A=!0;v(F=>({status:"loading",data:F.data??null,error:null}));const E=m??l,D=y??E,$={dataset_source_id:t,graph:{nodes:r.nodes,edges:r.edges},target_node_id:i??void 0,include_preview_rows:E,include_signals:D};return E&&($.sample_size=j2),ux($).then(F=>{A&&v({status:"success",data:F,error:null})}).catch(F=>{A&&v(l?{status:"error",data:null,error:(F==null?void 0:F.message)??"Unable to generate preview."}:pd)}),()=>{A=!1}},[n,r,l,d,u,_,e,t,i]),{previewState:p,refreshPreview:k}},S2=({shouldLoad:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l,setAvailableColumns:i,setColumnMissingMap:u})=>{const[d,m]=f.useState(!1),[y,p]=f.useState(null),[v,_]=f.useState(0),x=f.useCallback(()=>{!e||!t||!n||_(j=>j+1)},[n,e,t]);return f.useEffect(()=>{let j=!0;return e?t?n?(m(!0),p(null),fg(t,{graph:r,targetNodeId:l}).then(S=>{if(!j)return;const k={};S&&typeof S=="object"&&(S!=null&&S.column_missing_map)&&typeof S.column_missing_map=="object"&&Object.entries(S.column_missing_map).forEach(([T,w])=>{const A=String(T??"").trim();if(!A)return;const E=Number(w);Number.isNaN(E)||E<0||(k[A]=Number(E))});const M=new Set;Array.isArray(S==null?void 0:S.all_columns)&&S.all_columns.forEach(T=>{const w=String(T??"").trim();w&&M.add(w)}),Object.keys(k).forEach(T=>M.add(T));const P=Array.from(M).sort((T,w)=>T.localeCompare(w));P.forEach(T=>{Object.prototype.hasOwnProperty.call(k,T)||(k[T]=0)}),P.length&&i(P),Object.keys(k).length&&u(T=>({...T,...k}))}).catch(S=>{j&&p((S==null?void 0:S.message)??"Unable to load column metrics.")}).finally(()=>{j&&m(!1)}),()=>{j=!1}):(p("Connect this step to an upstream output to load column metrics."),m(!1),()=>{j=!1}):(p("Select a dataset to load column metrics."),m(!1),()=>{j=!1}):()=>{j=!1}},[r,n,v,i,u,e,t,l]),{isFetching:d,error:y,refreshDropColumnRecommendations:x}},uw={enabled:!1,explicit:!1},C2={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},E2={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},k2={},M2=[],A2=({isReplaceAliasesNode:e,configState:t,nodeConfig:n,availableColumns:r,columnTypeMap:l,previewSampleRows:i})=>{const u=f.useMemo(()=>{if(!e)return uw;const S=mc(t);if(S!==void 0)return{enabled:!!Ql(S),explicit:!0};if(n&&typeof n=="object"){const k=mc(n);if(k!==void 0)return{enabled:!!Ql(k),explicit:!0}}return uw},[t,e,n]),d=f.useMemo(()=>{if(!e)return[];const S=ut((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),k=Sf(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),M=(()=>{const T=mc(t);if(T!==void 0){const w=Ql(T);if(w!==null)return w}if(n&&typeof n=="object"){const w=mc(n);if(w!==void 0){const A=Ql(w);if(A!==null)return A}}return S.length===0})(),P=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return $x(P,{mode:k,columns:S,autoDetect:M})},[t,e,n]),m=f.useMemo(()=>e?d.length?Array.from(new Set(d.flatMap(S=>S.columns.map(k=>k.trim()).filter(Boolean)))).sort((S,k)=>S.localeCompare(k)):ut(t==null?void 0:t.columns):[],[d,t==null?void 0:t.columns,e]),y=f.useMemo(()=>e?d.length?d.some(S=>S.autoDetect):u.explicit?u.enabled:m.length===0:!1,[u.enabled,u.explicit,m.length,d,e]),p=f.useMemo(()=>{if(e)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,e]),v=f.useMemo(()=>e?iA(i):k2,[e,i]),_=f.useMemo(()=>e?nA({selectedColumns:m,availableColumns:r,columnTypeMap:l,autoDetectEnabled:y}):C2,[y,m,r,l,e]),x=f.useMemo(()=>e?rA(p):E2,[e,p]),j=f.useMemo(()=>{if(!e)return M2;const S=new Set(_.recommendedColumns),k=new Set(_.textColumns);return r.map(M=>{const P=l[M]??null,T=v[M]??[];return{name:M,dtype:P,samples:T.slice(0,3),isRecommended:S.has(M),isTextLike:k.has(M)}})},[_.recommendedColumns,_.textColumns,v,r,l,e]);return{aliasAutoDetectMeta:u,aliasStrategies:d,aliasStrategyCount:d.length,aliasSelectedColumns:m,aliasAutoDetectEnabled:y,replaceAliasesCustomPairsValue:p,aliasColumnSummary:_,aliasCustomPairSummary:x,aliasSampleMap:v,aliasColumnOptions:j}},O2=({isOutlierNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(null),[d,m]=f.useState(null),[y,p]=f.useState(!1),[v,_]=f.useState(0),x=f.useCallback(()=>{_(j=>j+1)},[]);return f.useEffect(()=>{let j=!0;return e?t?n?(p(!0),m(null),nx(t,{graph:r,targetNodeId:l}).then(S=>{j&&u(S??null)}).catch(S=>{j&&(u(null),m((S==null?void 0:S.message)??"Unable to load outlier insights"))}).finally(()=>{j&&p(!1)}),()=>{j=!1}):(u(null),m("Connect this step to an upstream output to load outlier insights."),p(!1),()=>{j=!1}):(u(null),m("Select a dataset to load outlier insights."),p(!1),()=>{j=!1}):(u(null),m(null),p(!1),()=>{j=!1})},[r,n,e,v,t,l]),{outlierData:i,outlierError:d,isFetchingOutliers:y,refreshOutliers:x}},P2=["int","float","double","decimal","number","numeric","long","short"],T2=["datetime","date","time","timestamp"],$2=["object","string","text","category","categorical","char"],D2=({shouldAnalyze:e,availableColumns:t,columnTypeMap:n,previewSampleRows:r})=>{const l=f.useMemo(()=>{if(!e)return{excluded:new Set,reasons:new Map};const i=new Set,u=new Map;return t.forEach(d=>{const m=(n[d]??"").toLowerCase(),y=P2.some(M=>m.includes(M)),p=T2.some(M=>m.includes(M)),v=$2.some(M=>m.includes(M));if(m.includes("bool")){i.add(d),u.set(d,"Boolean dtype");return}if((p||v)&&!y){i.add(d),u.set(d,"Non-numeric dtype");return}const _=r.map(M=>M&&Object.prototype.hasOwnProperty.call(M,d)?M[d]:void 0).filter(M=>M!=null);if(!_.length){y||(i.add(d),u.set(d,"No numeric samples"));return}let x=!0,j=!1,S=!1;const k=new Set;for(const M of _){if(typeof M=="boolean"){k.add(M?"1":"0");continue}if(typeof M=="number"){if(!Number.isFinite(M)){x=!1;break}j=!0,Math.abs(M)<1e-9?k.add("0"):Math.abs(M-1)<1e-9?k.add("1"):S=!0;continue}if(typeof M=="string"){const P=M.trim();if(!P)continue;const T=P.toLowerCase();if(H0.has(T)){k.add("1");continue}if(V0.has(T)){k.add("0");continue}const w=Number(P);if(!Number.isNaN(w)&&Number.isFinite(w)){j=!0,Math.abs(w)<1e-9?k.add("0"):Math.abs(w-1)<1e-9?k.add("1"):S=!0;continue}x=!1;break}x=!1;break}if(!x||!j&&!y){i.add(d),u.set(d,"Non-numeric values");return}!S&&k.size>0&&Array.from(k).every(P=>P==="0"||P==="1")&&(i.add(d),u.set(d,"Binary/bool-like values"))}),{excluded:i,reasons:u}},[t,n,r,e]);return{numericExcludedColumns:l.excluded,numericExclusionReasons:l.reasons}},L2=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},z2=({isBinningNode:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:r,availableColumns:l})=>{const i=f.useMemo(()=>e?t:new Set,[e,t]),u=f.useMemo(()=>{if(!e||!r.length)return{};const d={};return l.forEach(m=>{if(i.has(m))return;let y=null,p=null;const v=new Set;if(r.forEach(_=>{if(!_||!Object.prototype.hasOwnProperty.call(_,m))return;const x=L2(_[m]);x!==null&&((y===null||x<y)&&(y=x),(p===null||x>p)&&(p=x),v.size<=1e3&&v.add(x))}),y!==null||p!==null){const _=v.size>0?v.size:null;d[m]={min:y,max:p,distinct:_}}}),d},[l,i,e,r]);return{binningExcludedColumns:i,binningColumnPreviewMap:u,manualBoundColumns:[],manualRangeFallbackMap:{}}},Hs=["iqr","zscore","elliptic_envelope","winsorize","manual"],ei={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},If={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},Ho={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Bf=(e,{min:t,max:n}={})=>{const r=typeof e=="number"?e:Number(e);if(!Number.isFinite(r))return null;let l=r;return typeof t=="number"&&Number.isFinite(t)&&l<t&&(l=t),typeof n=="number"&&Number.isFinite(n)&&l>n&&(l=n),l},dw=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const r=String(n??"").trim();r&&t.push(r)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,r)=>n.localeCompare(r))},R2=e=>{const t={iqr:{...Ho.iqr},zscore:{...Ho.zscore},elliptic_envelope:{...Ho.elliptic_envelope},winsorize:{...Ho.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,r])=>{const l=n.trim().toLowerCase();if(!Hs.includes(l))return;const i=t[l]??{};if(!(!r||typeof r!="object"||Array.isArray(r))){if(Object.entries(r).forEach(([u,d])=>{const m=u.trim().toLowerCase();if(!If[l].includes(m))return;let y={};m==="threshold"?y={min:.1}:m==="multiplier"?y={min:.1}:(m==="lower_percentile"||m==="upper_percentile")&&(y={min:0,max:100});const p=Bf(d,y);p!==null&&(i[m]=p)}),l==="winsorize"){const u=Bf(i.lower_percentile,{min:0,max:100}),d=Bf(i.upper_percentile,{min:0,max:100});typeof u=="number"&&typeof d=="number"&&u>=d?(i.lower_percentile=Ho.winsorize.lower_percentile,i.upper_percentile=Ho.winsorize.upper_percentile):(typeof u=="number"&&(i.lower_percentile=u),typeof d=="number"&&(i.upper_percentile=d))}t[l]=i}}),t},F2=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,r])=>{const l=String(n??"").trim();if(!l||!r||typeof r!="object"||Array.isArray(r))return;const i={};Object.entries(r).forEach(([u,d])=>{const m=u.trim().toLowerCase();if(!Object.values(If).some(_=>_.includes(m)))return;let p={};m==="threshold"?p={min:.1}:m==="multiplier"?p={min:.1}:m==="contamination"?p={min:1e-4,max:.49}:(m==="lower_percentile"||m==="upper_percentile")&&(p={min:0,max:100});const v=Bf(d,p);v!==null&&(i[m]=v)}),Object.keys(i).length&&(t[l]=i)}),t},I2=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=dw(t.columns),r=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",l=Hs.includes(r)?r:"iqr",i={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([p,v])=>{const _=String(p??"").trim(),x=typeof v=="string"?v.trim().toLowerCase():"";_&&Hs.includes(x)&&(i[_]=x)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=dw(t.skipped_columns),m=R2(t.method_parameters),y=F2(t.column_parameters);return{columns:n,defaultMethod:l,columnMethods:i,autoDetect:u,skippedColumns:d,methodParameters:m,columnParameters:y}},B2=e=>{const t={...ei};return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,l=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";r&&l&&Hs.includes(r)&&(t[r]=l)}),t},U2=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const r=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;r&&Hs.includes(r)&&t.set(r,n)}),t},q2=e=>Hs.map(t=>({value:t,label:e[t]??ei[t]??t})),H2=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:r,skippedColumns:l,excludedColumns:i})=>{if(!e.length)return[];const u=[];return e.forEach(d=>{const m=String((d==null?void 0:d.column)??"").trim();if(!m)return;const y={};Array.isArray(d==null?void 0:d.method_summaries)&&d.method_summaries.forEach(T=>{const w=T==null?void 0:T.method;w&&Hs.includes(w)&&(y[w]=T)});const p=d!=null&&d.recommended_method&&Hs.includes(d.recommended_method)?d.recommended_method:null,v=p?n[p]??ei[p]??p:null,_=t.columnMethods[m]??null,x=_??t.defaultMethod,j=n[x]??ei[x]??x,S=l.has(m),k=i.has(m),M=r.has(m),P=!!(d!=null&&d.has_missing);u.push({column:m,dtype:typeof(d==null?void 0:d.dtype)=="string"?d.dtype:null,stats:(d==null?void 0:d.stats)??{},recommendedMethod:p,recommendedLabel:v,recommendedReason:typeof(d==null?void 0:d.recommended_reason)=="string"?d.recommended_reason:null,methodSummaries:y,currentOverride:_,currentMethod:x,currentMethodLabel:j,isOverrideApplied:_!==null,isSelected:M,isSkipped:S,isExcluded:k,hasMissing:P})}),u.sort((d,m)=>d.column.localeCompare(m.column)),u},V2=(e,t,n,r)=>{if(!e.length)return null;const l=e.map(i=>{const u=t[i],d=u?n[u]??ei[u]??u:null;return d?`${i} -> ${d}`:i});return r>e.length&&l.push(""),l.join(", ")},W2=({isScalingNode:e,isBinningNode:t,isOutlierNode:n,scalingExcludedColumns:r,binningExcludedColumns:l,outlierExcludedColumns:i,setConfigState:u})=>{f.useEffect(()=>{!e||r.size===0||u(d=>{if(!d||typeof d!="object")return d;const m=ut(d.columns);if(!m.length)return d;const y=m.filter(v=>!r.has(v));if(y.length===m.length)return d;const p={...d,columns:y};if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const v={};Object.entries(d.column_methods).forEach(([_,x])=>{const j=String(_??"").trim();if(!j||r.has(j))return;const S=typeof x=="string"?x.trim():null;S&&qs.includes(S)&&(v[j]=S)}),Object.keys(v).length?p.column_methods=v:Object.prototype.hasOwnProperty.call(p,"column_methods")&&delete p.column_methods}return p})},[e,r,u]),f.useEffect(()=>{!t||l.size===0||u(d=>{if(!d||typeof d!="object")return d;const m=ut(d.columns);if(!m.length)return d;const y=m.filter(_=>!l.has(_));if(y.length===m.length)return d;const p=new Set(m.filter(_=>l.has(_))),v={...d,columns:y};if(d.custom_bins&&typeof d.custom_bins=="object"&&!Array.isArray(d.custom_bins)){const _={};Object.entries(d.custom_bins).forEach(([x,j])=>{!p.has(x)&&Array.isArray(j)&&j.length&&(_[x]=[...j])}),Object.keys(_).length?v.custom_bins=_:Object.prototype.hasOwnProperty.call(v,"custom_bins")&&delete v.custom_bins}if(d.custom_labels&&typeof d.custom_labels=="object"&&!Array.isArray(d.custom_labels)){const _={};Object.entries(d.custom_labels).forEach(([x,j])=>{!p.has(x)&&Array.isArray(j)&&j.length&&(_[x]=j.map(S=>String(S)))}),Object.keys(_).length?v.custom_labels=_:Object.prototype.hasOwnProperty.call(v,"custom_labels")&&delete v.custom_labels}return v})},[l,t,u]),f.useEffect(()=>{!n||i.size===0||u(d=>{if(!d||typeof d!="object")return d;const m=ut(d.columns),y=m.filter(P=>!i.has(P)),p=y.length!==m.length,v=ut(d.skipped_columns),_=v.filter(P=>!i.has(P)),x=_.length!==v.length,j=P=>P??{...d};let S=null;p&&(S=j(S),S.columns=y.sort((P,T)=>P.localeCompare(T))),x&&(S=j(S),_.length?S.skipped_columns=_.sort((P,T)=>P.localeCompare(T)):Object.prototype.hasOwnProperty.call(S,"skipped_columns")&&delete S.skipped_columns);let k=!1;if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const P={};Object.entries(d.column_methods).forEach(([T,w])=>{const A=String(T??"").trim();if(!A||i.has(A)){k=!0;return}const E=typeof w=="string"?w.trim():null;E&&Hs.includes(E)?P[A]=E:k=!0}),k&&(S=j(S),Object.keys(P).length?S.column_methods=P:Object.prototype.hasOwnProperty.call(S,"column_methods")&&delete S.column_methods)}let M=!1;if(d.column_parameters&&typeof d.column_parameters=="object"&&!Array.isArray(d.column_parameters)){const P={};Object.entries(d.column_parameters).forEach(([T,w])=>{const A=String(T??"").trim();if(!A||i.has(A)){M=!0;return}if(!w||typeof w!="object"||Array.isArray(w)){M=!0;return}P[A]={...w}}),M&&(S=j(S),Object.keys(P).length?S.column_parameters=P:Object.prototype.hasOwnProperty.call(S,"column_parameters")&&delete S.column_parameters)}return S||d})},[n,i,u])},K2=({isTrimWhitespaceNode:e,isRemoveSpecialCharsNode:t,isRegexCleanupNode:n,isNormalizeTextCaseNode:r,configState:l,nodeConfig:i,availableColumns:u,columnTypeMap:d,previewSampleRows:m})=>{const y=f.useMemo(()=>FA(e?l==null?void 0:l.mode:void 0,e?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,e,i==null?void 0:i.mode]),p=f.useMemo(()=>e?ut(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,e]),v=f.useMemo(()=>e?WA(m):{},[e,m]),_=f.useMemo(()=>e?UA({selectedColumns:p,availableColumns:u,columnTypeMap:d,sampleMap:v}):YA,[u,d,e,p,v]),x=f.useMemo(()=>IA(y),[y]),j=f.useMemo(()=>oO(t?l==null?void 0:l.mode:void 0,t?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,t,i==null?void 0:i.mode]),S=f.useMemo(()=>t?ut(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,t]),k=f.useMemo(()=>t?dO(m):{},[t,m]),M=f.useMemo(()=>t?cO({selectedColumns:S,availableColumns:u,columnTypeMap:d,sampleMap:k}):fO,[u,d,t,S,k]),P=f.useMemo(()=>lO(j),[j]),T=f.useMemo(()=>FO(n?l==null?void 0:l.mode:void 0,n?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,n,i==null?void 0:i.mode]),w=f.useMemo(()=>n?ut(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,n]),A=f.useMemo(()=>n?HO(m):{},[n,m]),E=f.useMemo(()=>n?UO({selectedColumns:w,availableColumns:u,columnTypeMap:d,sampleMap:A}):KO,[u,d,n,w,A]),D=f.useMemo(()=>IO(T),[T]),$=f.useMemo(()=>{if(!n)return null;const z=(l==null?void 0:l.replacement)??(i==null?void 0:i.replacement)??null;return typeof z=="string"?z:null},[l==null?void 0:l.replacement,n,i==null?void 0:i.replacement]),F=f.useMemo(()=>jO(r?l==null?void 0:l.mode:void 0,r?i==null?void 0:i.mode:void 0),[l==null?void 0:l.mode,r,i==null?void 0:i.mode]),R=f.useMemo(()=>r?ut(l==null?void 0:l.columns):[],[l==null?void 0:l.columns,r]),B=f.useMemo(()=>r?kO(m):{},[r,m]),ee=f.useMemo(()=>r?CO({selectedColumns:R,availableColumns:u,columnTypeMap:d,sampleMap:B,mode:F}):AO,[u,d,r,R,F,B]),le=f.useMemo(()=>NO(F),[F]);return{trimWhitespace:{columnSummary:_,sampleMap:v,modeDetails:x},removeSpecial:{columnSummary:M,sampleMap:k,modeDetails:P,selectedMode:j},regexCleanup:{columnSummary:E,sampleMap:A,modeDetails:D,selectedMode:T,replacementValue:$},normalizeCase:{columnSummary:ee,sampleMap:B,modeDetails:le,selectedMode:F}}},Y2={},Q2=({isReplaceInvalidValuesNode:e,configState:t,nodeConfig:n,availableColumns:r,columnTypeMap:l,previewSampleRows:i})=>{const u=f.useMemo(()=>rP(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),d=f.useMemo(()=>e?ut(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,e]),m=f.useMemo(()=>{if(!e)return null;const x=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),j=Number(x);return Number.isFinite(j)?j:null},[t==null?void 0:t.min_value,e,n==null?void 0:n.min_value]),y=f.useMemo(()=>{if(!e)return null;const x=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),j=Number(x);return Number.isFinite(j)?j:null},[t==null?void 0:t.max_value,e,n==null?void 0:n.max_value]),p=f.useMemo(()=>e?cP(i):Y2,[e,i]),v=f.useMemo(()=>e?lP({selectedColumns:d,availableColumns:r,columnTypeMap:l,sampleMap:p}):_P,[r,l,e,p,d]),_=f.useMemo(()=>aP(u),[u]);return{selectedColumns:d,selectedMode:u,modeDetails:_,sampleMap:p,columnSummary:v,minValue:m,maxValue:y}},G2={},X2=({isStandardizeDatesNode:e,configState:t,nodeConfig:n,availableColumns:r,columnTypeMap:l,previewSampleRows:i})=>{const u=f.useMemo(()=>Vx(e?t==null?void 0:t.mode:void 0,e?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,e,n==null?void 0:n.mode]),d=f.useMemo(()=>e?ut((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,e,n==null?void 0:n.columns]),m=f.useMemo(()=>{if(!e)return[];const j={columns:d,mode:u,autoDetect:d.length===0};return Wx((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),j)},[t==null?void 0:t.format_strategies,e,d,n==null?void 0:n.format_strategies,u]),y=f.useMemo(()=>{if(!e)return[];const j=new Set;return m.forEach(S=>{S.columns.forEach(k=>{const M=k.trim();M&&j.add(M)})}),Array.from(j).sort((S,k)=>S.localeCompare(k))},[e,m]),p=f.useMemo(()=>m.some(j=>j.autoDetect),[m]),v=f.useMemo(()=>e?MA(i):G2,[e,i]),_=f.useMemo(()=>{if(!e)return AA;const j=jA({selectedColumns:y,availableColumns:r,columnTypeMap:l,sampleMap:v});return p?{...j,autoDetectionActive:!0}:j},[r,l,p,e,v,y]),x=f.useMemo(()=>{if(!e)return[];const j=new Set(_.recommendedColumns),S=new Set(_.sampleCandidates);return r.map(k=>{const M=l[k]??null,P=v[k]??[];return{name:k,dtype:M,samples:P.slice(0,3),isRecommended:j.has(k),isSampleCandidate:S.has(k)}})},[r,_,l,e,v]);return{selectedMode:u,strategies:m,sampleMap:v,columnSummary:_,columnOptions:x}},J2=({isScalingNode:e,configState:t,numericExcludedColumns:n,scalingData:r})=>{const l=f.useMemo(()=>CM(t),[t]),i=f.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),u=f.useMemo(()=>e?n:new Set,[e,n]),d=f.useMemo(()=>e?new Set(l.columns):new Set,[e,l.columns]),m=f.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),y=f.useMemo(()=>Array.isArray(r==null?void 0:r.columns)?r.columns.filter(ee=>!!(ee&&ee.column)):[],[r==null?void 0:r.columns]),p=f.useMemo(()=>EM(r==null?void 0:r.methods),[r==null?void 0:r.methods]),v=f.useMemo(()=>kM(r==null?void 0:r.methods),[r==null?void 0:r.methods]),_=f.useMemo(()=>AM({recommendations:y,scalingConfig:l,scalingMethodLabelMap:p,scalingSelectedSet:d,scalingSkippedColumns:i,scalingExcludedColumns:u}),[y,l,p,d,i,u]),x=f.useMemo(()=>Array.from(m).sort((ee,le)=>ee.localeCompare(le)),[m]),j=f.useMemo(()=>x.slice(0,4),[x]),S=_.length,k=m.size,M=d.size,P=l.autoDetect,T=f.useMemo(()=>v.get(l.defaultMethod)??null,[l.defaultMethod,v]),w=f.useMemo(()=>{const ee=l.defaultMethod;return p[ee]??Kl[ee]??ee},[l.defaultMethod,p]),A=S>0,E=f.useMemo(()=>_.filter(ee=>!ee.isSkipped&&!ee.isExcluded&&ee.isSelected&&ee.recommendedMethod!==ee.currentMethod).length,[_]),D=f.useMemo(()=>_.filter(ee=>ee.isSelected&&!ee.isSkipped&&!ee.isExcluded).length,[_]),$=f.useMemo(()=>_.filter(ee=>ee.isSkipped&&!ee.isExcluded).length,[_]),F=f.useMemo(()=>_.length?E>0?`${E} column${E===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:D>0?"All configured columns align with the recommended scalers.":$>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[E,D,_,$]),R=f.useMemo(()=>MM(p),[p]),B=f.useMemo(()=>OM(j,l.columnMethods,p,k),[j,l.columnMethods,p,k]);return{scalingConfig:l,scalingExcludedColumns:u,scalingMethodDetailMap:v,scalingMethodOptions:R,scalingRecommendations:y,scalingRecommendationRows:_,scalingSelectedCount:M,scalingOverrideCount:k,scalingDefaultDetail:T,scalingDefaultLabel:w,scalingAutoDetectEnabled:P,scalingHasRecommendations:A,scalingStatusMessage:F,scalingOverrideExampleSummary:B}},Z2=({isOutlierNode:e,configState:t,numericExcludedColumns:n,outlierData:r})=>{const l=f.useMemo(()=>I2(t),[t]),i=f.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),u=f.useMemo(()=>e?n:new Set,[e,n]),d=f.useMemo(()=>e?new Set(l.columns):new Set,[e,l.columns]),m=f.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),y=f.useMemo(()=>Array.isArray(r==null?void 0:r.columns)?r.columns.filter(ee=>!!(ee&&ee.column)):[],[r==null?void 0:r.columns]),p=f.useMemo(()=>B2(r==null?void 0:r.methods),[r==null?void 0:r.methods]),v=f.useMemo(()=>U2(r==null?void 0:r.methods),[r==null?void 0:r.methods]),_=f.useMemo(()=>H2({insights:y,outlierConfig:l,labelMap:p,selectedColumns:d,skippedColumns:i,excludedColumns:u}),[y,l,p,d,i,u]),x=f.useMemo(()=>q2(p),[p]),j=f.useMemo(()=>Array.from(m).sort((ee,le)=>ee.localeCompare(le)),[m]),S=f.useMemo(()=>j.slice(0,4),[j]),k=d.size,M=m.size,P=f.useMemo(()=>Object.keys(l.columnParameters).length,[l.columnParameters]),T=l.autoDetect,w=f.useMemo(()=>v.get(l.defaultMethod)??null,[l.defaultMethod,v]),A=f.useMemo(()=>{const ee=l.defaultMethod;return p[ee]??ei[ee]??ee},[l.defaultMethod,p]),E=_.length>0,D=f.useMemo(()=>_.filter(ee=>ee.isSkipped||ee.isExcluded||!ee.isSelected||!ee.recommendedMethod?!1:ee.recommendedMethod!==ee.currentMethod).length,[_]),$=f.useMemo(()=>_.filter(ee=>ee.isSelected&&!ee.isSkipped&&!ee.isExcluded).length,[_]),F=f.useMemo(()=>_.filter(ee=>ee.isSkipped&&!ee.isExcluded).length,[_]),R=f.useMemo(()=>_.length?D>0?`${D} column${D===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:$>0?"All configured columns align with the recommended outlier handling strategies.":F>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[D,$,_,F]),B=f.useMemo(()=>V2(S,l.columnMethods,p,M),[S,l.columnMethods,p,M]);return{outlierConfig:l,outlierExcludedColumns:u,outlierMethodLabelMap:p,outlierMethodDetailMap:v,outlierMethodOptions:x,outlierRecommendations:y,outlierRecommendationRows:_,outlierSelectedCount:k,outlierOverrideCount:M,outlierParameterOverrideCount:P,outlierDefaultDetail:w,outlierDefaultLabel:A,outlierAutoDetectEnabled:T,outlierHasRecommendations:E,outlierStatusMessage:R,outlierOverrideExampleSummary:B}},e$=({configState:e,nodeId:t})=>{const n=f.useMemo(()=>wx(e),[e]),r=f.useMemo(()=>`binning-${t||"node"}`,[t]),l=f.useMemo(()=>({equalWidth:`${r}-equal-width-bins`,equalFrequency:`${r}-equal-frequency-bins`,precision:`${r}-precision`,suffix:`${r}-suffix`,missingLabel:`${r}-missing-label`,includeLowest:`${r}-include-lowest`,dropOriginal:`${r}-drop-original`,labelFormat:`${r}-label-format`,duplicates:`${r}-duplicates`,kbinsNBins:`${r}-kbins-n-bins`,kbinsEncode:`${r}-kbins-encode`,kbinsStrategy:`${r}-kbins-strategy`}),[r]),[i,u]=f.useState({}),[d,m]=f.useState({});return f.useEffect(()=>{u(y=>{const p=new Set,v={...y};return n.columns.forEach(_=>{const x=String(_??"").trim();if(!x||(p.add(x),Object.prototype.hasOwnProperty.call(v,x)))return;const j=n.customBins[x]??[];v[x]=j.length>=2?j.join(", "):""}),Object.keys(v).forEach(_=>{p.has(_)||delete v[_]}),v})},[n.columns,n.customBins]),f.useEffect(()=>{m(y=>{const p=new Set,v={...y};return n.columns.forEach(_=>{const x=String(_??"").trim();if(!x||(p.add(x),Object.prototype.hasOwnProperty.call(v,x)))return;const j=n.customLabels[x]??[];v[x]=j.length>0?j.join(", "):""}),Object.keys(v).forEach(_=>{p.has(_)||delete v[_]}),v})},[n.columns,n.customLabels]),{binningConfig:n,fieldIds:l,customEdgeDrafts:i,setCustomEdgeDrafts:u,customLabelDrafts:d,setCustomLabelDrafts:m}},t$=({isImputerNode:e,imputerStrategies:t,availableColumns:n,columnMissingMap:r,previewColumns:l,previewColumnStats:i,nodeColumns:u,imputerMissingFilter:d})=>{const m=f.useMemo(()=>{if(!e)return[];const _=l.length?new Set(l.map(T=>typeof T=="string"?T.trim():"").filter(T=>T.length>0)):null,x=new Set;t.forEach(T=>{T.columns.forEach(w=>{const A=typeof w=="string"?w.trim():"";A&&x.add(A)})}),ut(u).forEach(T=>{T&&x.add(T)});const j=T=>!_||_.size===0?!1:!_.has(T)&&!x.has(T),S=new Map,k=(T,w)=>{const A=typeof T=="string"?T.trim():"";if(!A||j(A))return;const E=S.get(A)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};w&&(typeof w.missingPercentage=="number"&&!Number.isNaN(w.missingPercentage)&&(E.missingPercentage=Math.max(0,w.missingPercentage)),w.dtype!==void 0&&(E.dtype=w.dtype),typeof w.mean=="number"&&!Number.isNaN(w.mean)&&(E.mean=w.mean),typeof w.median=="number"&&!Number.isNaN(w.median)&&(E.median=w.median),w.mode!==void 0&&w.mode!==null&&w.mode!==""&&(E.mode=w.mode)),S.set(A,E)};n.forEach(T=>{const w=Object.prototype.hasOwnProperty.call(r,T)?r[T]:null;k(T,{missingPercentage:typeof w=="number"?w:null})}),(Array.isArray(i)?i:[]).forEach(T=>{!T||!T.name||k(T.name,{missingPercentage:typeof T.missing_percentage=="number"?T.missing_percentage:null,dtype:T.dtype??null,mean:typeof T.mean=="number"?T.mean:null,median:typeof T.median=="number"?T.median:null,mode:T.mode??null})}),ut(u).forEach(T=>k(T)),t.forEach(T=>{T.columns.forEach(w=>k(w))});const P=Array.from(S.entries()).map(([T,w])=>({name:T,missingPercentage:typeof w.missingPercentage=="number"&&!Number.isNaN(w.missingPercentage)?Math.max(0,w.missingPercentage):null,dtype:w.dtype??null,mean:typeof w.mean=="number"&&!Number.isNaN(w.mean)?w.mean:null,median:typeof w.median=="number"&&!Number.isNaN(w.median)?w.median:null,mode:w.mode!==void 0&&w.mode!==null&&w.mode!==""?w.mode:null}));return P.sort((T,w)=>{const A=typeof T.missingPercentage=="number",E=typeof w.missingPercentage=="number";return A&&E&&T.missingPercentage!==w.missingPercentage?w.missingPercentage-T.missingPercentage:A!==E?A?-1:1:T.name.localeCompare(w.name)}),P},[n,r,t,u,i,l,e]),y=f.useMemo(()=>{if(!m.length)return 100;const _=m.reduce((j,S)=>{const k=typeof S.missingPercentage=="number"?S.missingPercentage:0;return k>j?k:j},0),x=Math.ceil(_/5)*5;return Math.max(100,x||0)},[m]),p=f.useMemo(()=>m.length?m.reduce((_,x)=>{const j=typeof x.missingPercentage=="number"?x.missingPercentage:null;return j!==null?j<=0?_:j>=d?_+1:_:d===0?_+1:_},0):0,[m,d]),v=d>0;return{imputerColumnOptions:m,imputerMissingSliderMax:y,imputerFilteredOptionCount:p,imputerMissingFilterActive:v}},n$=({configState:e,setConfigState:t,isFeatureTargetSplitNode:n,isTrainTestSplitNode:r,isTrainModelDraftNode:l,isHyperparameterTuningNode:i,isClassResamplingNode:u,isClassOversamplingNode:d,isClassUndersamplingNode:m,upstreamTargetColumn:y,nodeId:p,modelTypeOptions:v})=>{const _=l||i,x=f.useMemo(()=>{if(!n)return null;const $=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",F=ut(e==null?void 0:e.feature_columns).map(R=>typeof R=="string"?R.trim():"").filter(R=>!!R);return{targetColumn:$,featureColumns:F}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,n]),j=f.useMemo(()=>{if(!r)return null;const $=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,F=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,R=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,B=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,ee=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,le=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:$,validation_size:F,random_state:R,shuffle:B,stratify:ee,target_column:le}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,r]),S=f.useMemo(()=>{if(!u)return null;const $=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",F=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",R=e==null?void 0:e.sampling_strategy;let B=null;if(typeof R=="number"&&Number.isFinite(R))B=R;else if(typeof R=="string"){const W=R.trim();B=W||null}else R===null&&(B=null);const ee=e==null?void 0:e.random_state;let le=null;if(typeof ee=="number"&&Number.isFinite(ee))le=ee;else if(typeof ee=="string"){const W=Number(ee);le=Number.isFinite(W)?W:null}let z=null;if(m){const W=e==null?void 0:e.replacement;z=typeof W=="boolean"?W:typeof W=="string"?W.trim().toLowerCase()==="true":!!W}let G=null;if(d){const W=e==null?void 0:e.k_neighbors;if(typeof W=="number"&&Number.isFinite(W))G=Math.max(1,Math.round(W));else if(typeof W=="string"){const H=Number(W);Number.isFinite(H)&&(G=Math.max(1,Math.round(H)))}}return{method:$,targetColumn:F,samplingStrategy:B,randomState:le,replacement:z,kNeighbors:G}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,d,u,m]),k=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",M=k==="regression"?"regression":"classification",P=f.useMemo(()=>Array.isArray(v)?v.filter($=>$&&typeof $.value=="string"):[],[v]),T=f.useMemo(()=>{const $={classification:[],regression:[]};return P.forEach(F=>{var B;const R=String(((B=F==null?void 0:F.metadata)==null?void 0:B.problem_type)??"").trim().toLowerCase();R==="regression"?$.regression.push(F):R==="classification"?$.classification.push(F):($.classification.push(F),$.regression.push(F))}),$},[P]),w=f.useMemo(()=>{if(!P.length)return[];const $=M==="regression"?T.regression:T.classification;return $.length>0?$:P},[P,T,M]),A=f.useMemo(()=>_?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:M}:null,[e==null?void 0:e.target_column,_,M]),E=f.useMemo(()=>{if(!_)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const $=(e==null?void 0:e.cv_enabled)===void 0?!!i:!!e.cv_enabled,F=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",R=["auto","kfold","stratified_kfold"].includes(F)?F:"auto",B=Number(e==null?void 0:e.cv_folds),ee=Number.isFinite(B)&&B>=2?Math.floor(B):5,le=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let z=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))z=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const H=Number(e.cv_random_state.trim());z=Number.isFinite(H)?Math.trunc(H):null}const W=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:$,strategy:R,folds:ee,shuffle:le,randomState:z,refitStrategy:W}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,i,_]);f.useEffect(()=>{_&&k!==M&&t($=>({...$,problem_type:M}))},[_,M,k,t]),f.useEffect(()=>{var B;if(!_||!w.length)return;const $=new Set(w.map(ee=>ee.value)),F=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if(F&&$.has(F))return;const R=((B=w[0])==null?void 0:B.value)??"";R&&t(ee=>{const le=typeof(ee==null?void 0:ee.model_type)=="string"?ee.model_type.trim():"";return le&&$.has(le)||le===R?ee:{...ee,model_type:R}})},[e==null?void 0:e.model_type,w,_,t]);const D=f.useMemo(()=>{if(!_)return null;const $=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",F=e==null?void 0:e.hyperparameters;let R=null,B=null;if(F&&typeof F=="string"){const ee=F.trim();if(ee.length)try{const le=JSON.parse(ee);le&&typeof le=="object"&&!Array.isArray(le)?R=le:B="Hyperparameters JSON must be an object."}catch{B="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else F&&typeof F=="object"&&!Array.isArray(F)&&(R=F);return{modelType:$||null,hyperparameters:R,hyperparametersError:B}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,_]);return f.useEffect(()=>{(r||l)&&y&&(r&&(e==null?void 0:e.stratify)!==!0||t($=>(typeof($==null?void 0:$.target_column)=="string"?$.target_column.trim():"")?$:{...$,target_column:y}))},[e==null?void 0:e.stratify,l,r,p,t,y]),{featureTargetSplitConfig:x,trainTestSplitConfig:j,resamplingConfig:S,trainModelDraftConfig:A,trainModelRuntimeConfig:D,trainModelCVConfig:E,filteredModelTypeOptions:w}},s$=["int","float","double","numeric","number"],mw=e=>{if(!e)return!1;const t=e.toLowerCase();return s$.some(n=>t.includes(n))},r$=({skewnessData:e,shouldLoadInsights:t,skewnessTransformations:n,availableColumns:r,previewColumns:l,columnTypeMap:i,updateSkewnessTransformations:u})=>{const[d,m]=f.useState("recommended"),[y,p]=f.useState(!1),[v,_]=f.useState("before"),x=n.length,j=f.useMemo(()=>e!=null&&e.methods?[...e.methods]:[],[e==null?void 0:e.methods]),S=f.useMemo(()=>DM(j),[j]),k=f.useMemo(()=>e!=null&&e.columns?[...e.columns]:[],[e==null?void 0:e.columns]),M=f.useMemo(()=>{const H=new Map;return k.forEach(V=>{V&&V.column&&H.set(V.column,V)}),H},[k]),P=f.useMemo(()=>{const H=new Set;return k.forEach(V=>{V!=null&&V.column&&H.add(V.column)}),r.forEach(V=>{V&&mw(i[V]??null)&&H.add(V)}),l.forEach(V=>{const ne=typeof V=="string"?V.trim():"";ne&&mw(i[ne]??null)&&H.add(ne)}),Array.from(H).sort((V,ne)=>V.localeCompare(ne))},[r,l,k,i]);f.useEffect(()=>{d==="recommended"&&k.length===0&&P.length>0&&m("all")},[P.length,k.length,d]);const T=(e==null?void 0:e.skewness_threshold)??null,w=f.useCallback(H=>S[H]??H,[S]),A=f.useCallback((H,V)=>{const ne=M.get(H);return!ne||!ne.method_status?{status:"ready",reason:void 0}:ne.method_status[V]??{status:"ready",reason:void 0}},[M]),E=f.useCallback(()=>{const H=k.map(V=>{if(!V||!V.column)return null;const ne=Array.isArray(V.recommended_methods)?V.recommended_methods.find(to):void 0;return ne?{column:V.column,method:ne}:null}).filter(V=>!!V);H.length&&u(V=>{const ne=new Map;return V.forEach(Q=>{const K=typeof Q.column=="string"?Q.column.trim():"";K&&to(Q.method)&&ne.set(K,Q.method)}),H.forEach(Q=>{const K=typeof Q.column=="string"?Q.column.trim():"";K&&ne.set(K,Q.method)}),Array.from(ne.entries()).map(([Q,K])=>({column:Q,method:K}))})},[k,u]),D=f.useMemo(()=>{const H=new Map;return n.forEach(V=>{const ne=typeof V.column=="string"?V.column.trim():"";!ne||H.has(ne)||H.set(ne,V.method)}),H},[n]),$=f.useCallback((H,V)=>{const ne=typeof H=="string"?H.trim():"";ne&&u(Q=>{const K=Q.filter(J=>J.column!==ne);return V?[...K,{column:ne,method:V}]:K})},[u]),F=f.useCallback((H,V)=>{if(H){if(!V){$(H,null);return}to(V)&&$(H,V)}},[$]),R=f.useCallback(()=>{u(()=>[])},[u]),B=k.length,ee=f.useMemo(()=>k.some(H=>H&&typeof H.column=="string"&&Array.isArray(H.recommended_methods)&&H.recommended_methods.some(to)),[k]),le=P.length,z=f.useMemo(()=>LM({viewMode:d,recommendations:k,columnOptions:P,recommendationMap:M,transformationMap:D}),[d,k,P,M,D]),G=f.useMemo(()=>t?k.map(H=>{var ie;if(!H||!H.column)return null;const V=H.distribution_before??H.distribution??null;if(!V||!Array.isArray(V.bin_edges)||!Array.isArray(V.counts)||V.counts.length===0||V.bin_edges.length!==V.counts.length+1)return null;let ne=H.distribution_after??null;ne&&(!Array.isArray(ne.bin_edges)||!Array.isArray(ne.counts)||ne.counts.length===0||ne.bin_edges.length!==ne.counts.length+1)&&(ne=null);const Q=((ie=H.recommended_methods)==null?void 0:ie.find(to))??null,K=H.magnitude?`${H.magnitude.charAt(0).toUpperCase()}${H.magnitude.slice(1)}`:null,J=H.direction?Mx[H.direction]??H.direction:null,te=H.applied_method&&to(H.applied_method)?H.applied_method:null,Y=D.get(H.column)??null,U=te??Y??null,Z=U?w(U):null;return{column:H.column,skewness:typeof H.skewness=="number"?H.skewness:null,magnitudeLabel:K,directionLabel:J,summary:H.summary??null,recommendedLabel:Z?null:Q?w(Q):null,appliedLabel:Z,distributionBefore:V,distributionAfter:ne}}).filter(H=>!!H).sort((H,V)=>{const ne=H.skewness!==null?Math.abs(H.skewness):-1/0,Q=V.skewness!==null?Math.abs(V.skewness):-1/0;return ne!==Q?Q-ne:H.column.localeCompare(V.column)}):[],[w,t,k,D]),W=f.useMemo(()=>zM(z,y,w),[z,y,w]);return{skewnessThreshold:T,skewnessViewMode:d,setSkewnessViewMode:m,skewnessGroupByMethod:y,setSkewnessGroupByMethod:p,skewnessDistributionView:v,setSkewnessDistributionView:_,skewnessRecommendedCount:B,skewnessNumericCount:le,skewnessTransformationsCount:x,hasSkewnessAutoRecommendations:ee,skewnessRows:z,skewnessTableGroups:W,skewnessDistributionCards:G,getSkewnessMethodLabel:w,getSkewnessMethodStatus:A,applySkewnessRecommendations:E,handleSkewnessOverrideChange:F,clearSkewnessTransformations:R}},Fg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},a$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Ig=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],o$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=a$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=Ig(t.sample_values),v=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:r,reason:l,dtype:i,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:v,selectable:_}}).filter(t=>!!t),l$=e=>{if(!e||typeof e!="object")return{...Fg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,u=Ig(e.high_cardinality_columns),d=Ig(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:l,autoDetectDefault:i,highCardinalityColumns:u,notes:d}},i$=({isLabelEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[v,_]=f.useState({...Fg}),[x,j]=f.useState(0);f.useEffect(()=>{let P=!0;const T=w=>{p([]),_({...Fg}),u(!1),m(w??null)};return e?t?n?(u(!0),m(null),Yb(t,{graph:r??null,targetNodeId:l??null}).then(w=>{P&&(p(o$(w)),_(l$(w)))}).catch(w=>{if(!P)return;const A=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load label encoding suggestions";T(A)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,x,t,l]);const S=f.useCallback(()=>{!e||!t||!n||j(P=>P+1)},[n,e,t]),k=f.useMemo(()=>v,[v]),M=f.useMemo(()=>y,[y]);return{isFetching:i,error:d,suggestions:M,metadata:k,refresh:S}},Bg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},c$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Ug=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],u$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=c$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=Ug(t.sample_values),v=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0,x=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:r,reason:l,dtype:i,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:v,selectable:_,recommended_use_global_fallback:x}}).filter(t=>!!t),d$=e=>{if(!e||typeof e!="object")return{...Bg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.enable_global_fallback_default,u=Ug(e.high_cardinality_columns),d=Ug(e.notes),m=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:l,autoDetectDefault:m,enableGlobalFallbackDefault:i,highCardinalityColumns:u,notes:d}},m$=({isTargetEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[v,_]=f.useState({...Bg}),[x,j]=f.useState(0);f.useEffect(()=>{let P=!0;const T=w=>{p([]),_({...Bg}),u(!1),m(w??null)};return e?t?n?(u(!0),m(null),Gb(t,{graph:r??null,targetNodeId:l??null}).then(w=>{P&&(p(u$(w)),_(d$(w)))}).catch(w=>{if(!P)return;const A=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load target encoding suggestions";T(A)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,x,t,l]);const S=f.useCallback(()=>{!e||!t||!n||j(P=>P+1)},[n,e,t]),k=f.useMemo(()=>v,[v]),M=f.useMemo(()=>y,[y]);return{isFetching:i,error:d,suggestions:M,metadata:k,refresh:S}},Uf={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},f$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},qg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],h$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=f$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=qg(t.sample_values),v=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0,x=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:r,reason:l,dtype:i,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:v,selectable:_,recommended_bucket_count:x}}).filter(t=>!!t),p$=e=>{if(!e||typeof e!="object")return{...Uf};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.auto_detect_default,u=Number(e.suggested_bucket_default??0)||0,d=qg(e.high_cardinality_columns),m=qg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:l,autoDetectDefault:i,suggestedBucketDefault:u,highCardinalityColumns:d,notes:m}},g$=({isHashEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[v,_]=f.useState({...Uf}),[x,j]=f.useState(0),S=f.useCallback(P=>{p([]),_({...Uf}),u(!1),m(P??null)},[]);f.useEffect(()=>{let P=!0;return e?t?n?(u(!0),m(null),Xb(t,{graph:r??null,targetNodeId:l??null}).then(T=>{P&&(p(h$(T)),_(p$(T)))}).catch(T=>{P&&(p([]),_({...Uf}),m(T!=null&&T.message?String(T.message):"Unable to load hash encoding suggestions"))}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(S("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(S(),()=>{P=!1}):(S(),()=>{P=!1})},[r,n,e,S,t,l,x]);const k=f.useCallback(()=>{j(P=>P+1)},[]);return f.useMemo(()=>({isFetching:i,error:d,suggestions:y,metadata:v,refresh:k}),[d,i,v,k,y])},Hg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},_$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Vg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],v$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=_$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=Vg(t.sample_values),v=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0,x=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:r,reason:l,dtype:i,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,score:v,selectable:_,recommended_handle_unknown:x}}).filter(t=>!!t),y$=e=>{if(!e||typeof e!="object")return{...Hg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=!!e.enable_unknown_default,u=Vg(e.high_cardinality_columns),d=Vg(e.notes),m=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:l,autoDetectDefault:m,enableUnknownDefault:i,highCardinalityColumns:u,notes:d}},b$=({isOrdinalEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[v,_]=f.useState({...Hg}),[x,j]=f.useState(0);f.useEffect(()=>{let P=!0;const T=w=>{p([]),_({...Hg}),u(!1),m(w??null)};return e?t?n?(u(!0),m(null),Qb(t,{graph:r??null,targetNodeId:l??null}).then(w=>{P&&(p(v$(w)),_(y$(w)))}).catch(w=>{if(!P)return;const A=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load ordinal encoding suggestions";T(A)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,x,t,l]);const S=f.useCallback(()=>{!e||!t||!n||j(P=>P+1)},[n,e,t]),k=f.useMemo(()=>v,[v]),M=f.useMemo(()=>y,[y]);return{isFetching:i,error:d,suggestions:M,metadata:k,refresh:S}},Wg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},x$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Kg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],w$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=x$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=Kg(t.sample_values),v=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,_=typeof t.score=="number"?t.score:0,x=typeof t.selectable=="boolean"?t.selectable:!0,j=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:r,reason:l,dtype:i,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,estimated_dummy_columns:v,score:_,selectable:x,recommended_drop_first:j}}).filter(t=>!!t),j$=e=>{if(!e||typeof e!="object")return{...Wg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,u=Kg(e.high_cardinality_columns),d=Kg(e.notes),m=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:l,cautionedCount:i,highCardinalityColumns:u,notes:d,autoDetectDefault:m}},N$=({isDummyEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[v,_]=f.useState({...Wg}),[x,j]=f.useState(0);f.useEffect(()=>{let P=!0;const T=w=>{p([]),_({...Wg}),u(!1),m(w??null)};return e?t?n?(u(!0),m(null),Zb(t,{graph:r??null,targetNodeId:l??null}).then(w=>{P&&(p(w$(w)),_(j$(w)))}).catch(w=>{if(!P)return;const A=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load dummy encoding suggestions";T(A)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,x,t,l]);const S=f.useCallback(()=>{!e||!t||!n||j(P=>P+1)},[n,e,t]),k=f.useMemo(()=>v,[v]),M=f.useMemo(()=>y,[y]);return{isFetching:i,error:d,suggestions:M,metadata:k,refresh:S}},Yg={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},S$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Qg=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],C$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const r=S$(t.status),l=typeof t.reason=="string"?t.reason:"",i=typeof t.dtype=="string"?t.dtype:null,u=typeof t.unique_count=="number"?t.unique_count:null,d=typeof t.unique_percentage=="number"?t.unique_percentage:null,m=typeof t.missing_percentage=="number"?t.missing_percentage:null,y=typeof t.text_category=="string"?t.text_category:null,p=Qg(t.sample_values),v=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,_=typeof t.score=="number"?t.score:0,x=typeof t.selectable=="boolean"?t.selectable:!0,j=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:r,reason:l,dtype:i,unique_count:u,unique_percentage:d,missing_percentage:m,text_category:y,sample_values:p,estimated_dummy_columns:v,score:_,selectable:x,recommended_drop_first:j}}).filter(t=>!!t),E$=e=>{if(!e||typeof e!="object")return{...Yg};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,r=Number(e.total_text_columns??0)||0,l=Number(e.recommended_count??0)||0,i=Number(e.cautioned_count??0)||0,u=Qg(e.high_cardinality_columns),d=Qg(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:r,recommendedCount:l,cautionedCount:i,highCardinalityColumns:u,notes:d}},k$=({isOneHotEncodingNode:e,sourceId:t,hasReachableSource:n,graphContext:r,targetNodeId:l})=>{const[i,u]=f.useState(!1),[d,m]=f.useState(null),[y,p]=f.useState([]),[v,_]=f.useState({...Yg}),[x,j]=f.useState(0);f.useEffect(()=>{let P=!0;const T=w=>{p([]),_({...Yg}),u(!1),m(w??null)};return e?t?n?(u(!0),m(null),Jb(t,{graph:r??null,targetNodeId:l??null}).then(w=>{P&&(p(C$(w)),_(E$(w)))}).catch(w=>{if(!P)return;const A=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load one-hot encoding suggestions";T(A)}).finally(()=>{P&&u(!1)}),()=>{P=!1}):(T("Connect this node to the dataset input to load suggestions."),()=>{P=!1}):(T(),()=>{P=!1}):(T(),()=>{P=!1})},[r,n,e,x,t,l]);const S=f.useCallback(()=>{!e||!t||!n||j(P=>P+1)},[n,e,t]),k=f.useMemo(()=>v,[v]),M=f.useMemo(()=>y,[y]);return{isFetching:i,error:d,suggestions:M,metadata:k,refresh:S}},M$={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},A$=(e,t)=>{var l;const n=(l=e==null?void 0:e.parameter_help)==null?void 0:l[t];if(n)return n;const r=t.replace(/_/g," ").trim();return r.charAt(0).toUpperCase()+r.slice(1)},O$=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},P$=(e,t,n,r,l)=>{var y;const i=n[r]??{};if(Object.prototype.hasOwnProperty.call(i,t)){const p=i[t];if(typeof p=="number"&&Number.isFinite(p))return{value:p,fallback:null}}const d=(l[e]??{})[t];return typeof d=="number"&&Number.isFinite(d)?{value:"",fallback:d}:{value:"",fallback:((y=Ho[e])==null?void 0:y[t])??null??null}},fw=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",hw={lower_percentile:"%",upper_percentile:"%"},T$=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:r,outlierMethodOptions:l,outlierMethodDetailMap:i,outlierDefaultDetail:u,outlierAutoDetectEnabled:d,outlierSelectedCount:m,outlierDefaultLabel:y,outlierOverrideCount:p,outlierParameterOverrideCount:v,outlierOverrideExampleSummary:_,outlierHasOverrides:x,outlierRecommendationRows:j,outlierHasRecommendations:S,outlierStatusMessage:k,outlierError:M,outlierSampleSize:P,relativeOutlierGeneratedAt:T,outlierPreviewSignal:w,formatMetricValue:A,formatNumericStat:E,onApplyAllRecommendations:D,onClearOverrides:$,onDefaultMethodChange:F,onAutoDetectToggle:R,onOverrideSelect:B,onMethodParameterChange:ee,onColumnParameterChange:le})=>{const z=O$(w);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:D,disabled:!S,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:$,disabled:!x,children:"Clear overrides"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),T&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",T,P!==null?` on ${A(P)} row${P===1?"":"s"}.`:"."]}),!T&&P!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",A(P)," row",P===1?"":"s","."]}),z&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",z]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:l.map(G=>{const W=i.get(G.value)??null,H=G.value===r.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${H?" canvas-scaling__method-button--active":""}`,"aria-pressed":H,onClick:()=>F(G.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:G.label}),(W==null?void 0:W.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:W.description})]},G.value)})}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:u.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:G=>R(G.target.checked)}),a.jsx("span",{children:d?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]})]}),a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for each strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:Hs.map(G=>{const W=i.get(G)??null,H=If[G];if(!H.length)return null;const V=(W==null?void 0:W.label)??ei[G]??G;return a.jsxs("article",{className:"canvas-outlier__method-card",children:[a.jsxs("header",{className:"canvas-outlier__method-header",children:[a.jsx("span",{className:"canvas-outlier__method-title",children:V}),(W==null?void 0:W.description)&&a.jsx("p",{className:"canvas-outlier__method-summary",children:W.description})]}),a.jsx("div",{className:"canvas-outlier__parameter-list",children:H.map(ne=>{var J,te;const Q=((J=r.methodParameters[G])==null?void 0:J[ne])??null,K=hw[ne]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:A$(W,ne)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx("input",{type:"number",className:"canvas-outlier__method-input-field",value:typeof Q=="number"&&Number.isFinite(Q)?Q:"",placeholder:fw(((te=Ho[G])==null?void 0:te[ne])??null),onChange:Y=>{const U=Y.target.value;if(U==="")ee(G,ne,null);else{const Z=Number(U);ee(G,ne,Number.isFinite(Z)?Z:null)}}}),K&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:K})]})]},`${G}-${ne}`)})})]},`outlier-method-${G}`)})})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:m})," column",m===1?"":"s","  Default method"," ",a.jsx("strong",{children:y})," ",d?" Auto-detect on":" Auto-detect off",(()=>{if(!(p+v))return"  No overrides yet";const W=[];return p>0&&W.push(_?`${p} method override${p===1?"":"s"} (${_})`:`${p} method override${p===1?"":"s"}`),v>0&&W.push(`${v} parameter override${v===1?"":"s"}`),`  Overrides: ${W.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&M&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:M}),!n&&!M&&a.jsxs(a.Fragment,{children:[k&&a.jsx("p",{className:"canvas-modal__note",children:k}),j.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:j.map(G=>{const W=!G.isSkipped&&!G.isExcluded&&G.recommendedMethod&&G.recommendedMethod!==G.currentMethod,H=["canvas-cast__row"];W&&H.push("canvas-cast__row--attention"),G.isOverrideApplied&&H.push("canvas-cast__row--override"),G.isSkipped&&H.push("canvas-cast__row--muted");const V=G.isSkipped?"__skip__":G.isOverrideApplied?G.currentMethod:"__default__",ne=G.isOverrideApplied?`Override -> ${G.currentMethodLabel}`:G.isSkipped?"Skipped (column will not be altered)":G.isSelected?`Inheriting ${y}`:"Pending inclusion",Q=G.stats,K=[];typeof Q.valid_count=="number"&&Number.isFinite(Q.valid_count)&&K.push(`${A(Q.valid_count)} valid rows`);const J=typeof Q.minimum=="number"&&Number.isFinite(Q.minimum),te=typeof Q.maximum=="number"&&Number.isFinite(Q.maximum);if(J||te){const pe=J?E(Q.minimum):"",xe=te?E(Q.maximum):"";K.push(`Range ${pe}  ${xe}`)}typeof Q.mean=="number"&&Number.isFinite(Q.mean)&&K.push(`Mean ${E(Q.mean)}`),typeof Q.median=="number"&&Number.isFinite(Q.median)&&K.push(`Median ${E(Q.median)}`),typeof Q.stddev=="number"&&Number.isFinite(Q.stddev)&&K.push(` ${E(Q.stddev)}`);const Y=K.length?K.join("  "):null,U=!G.recommendedMethod||!G.recommendedLabel?G.recommendedReason||"No outlier risk detected":G.recommendedReason?`${G.recommendedLabel}  ${G.recommendedReason}`:G.recommendedLabel,Z=r.columnParameters,ie=r.methodParameters,re=If[G.currentMethod]??[];return a.jsxs("tr",{className:H.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:G.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[G.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",G.dtype]}),G.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),G.isSelected&&!G.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),G.isSkipped&&!G.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),G.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),G.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[G.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${W?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:G.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),U&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:U})]})}),a.jsx("td",{children:Y?a.jsx("span",{children:Y}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:V,onChange:pe=>B(G.column,pe.target.value),disabled:G.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",y,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),l.map(pe=>a.jsx("option",{value:pe.value,children:pe.label},`${G.column}-${pe.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:ne}),re.length>0&&!G.isExcluded&&a.jsx("div",{className:"canvas-outlier__parameters",children:re.map(pe=>{const{value:xe,fallback:Ve}=P$(G.currentMethod,pe,Z,G.column,ie),ht=hw[pe]??"";return a.jsxs("label",{children:[a.jsx("span",{children:pe.replace(/_/g," ")}),a.jsx("input",{type:"number",value:xe,placeholder:fw(Ve),onChange:Qe=>{const Ne=Qe.target.value;if(Ne==="")le(G.column,pe,null);else{const ze=Number(Ne);le(G.column,pe,Number.isFinite(ze)?ze:null)}}}),ht&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:ht})]},`${G.column}-${G.currentMethod}-${pe}`)})})]})})]},`outlier-row-${G.column}`)})})]})})})]})]})},pw=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const r=t.split("-");return r.length>=2?r.slice(-2).join("-"):t},$$=({counts:e,binEdges:t,className:n})=>{const r=f.useId(),l=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:l,"aria-hidden":"true"});const i=e.reduce((m,y)=>Math.max(m,y),0),u=i>0?i:1,d=100/e.length;return a.jsx("div",{className:l,role:"img","aria-label":"Histogram sparkline",children:a.jsxs("svg",{viewBox:"0 0 100 60",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((m,y)=>{const p=m/u*52,v=y*d,_=58-p,x=Math.max(d-2,1);return a.jsx("rect",{x:v+1,y:_,width:x,height:p,rx:1.2,ry:1.2,fill:`url(#${r})`},`hist-bin-${y}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:r,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},D$=new Set(Of.map(e=>e.value)),gd=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),gw=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),_w=e=>{const n=gd(e).filter(r=>D$.has(r));return n.length?n:["year","month","day"]},_d=e=>e==null?null:Number.isFinite(e)?e:null,vw=e=>{const t=_d(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},yw=e=>typeof e!="string"?"UTC":e.trim()||"UTC",L$=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:r,sourceId:l,graphSnapshot:i,onResetConfig:u,defaultConfigTemplate:d,isResetAvailable:m=!1})=>{var Tm,$m,Xh,Ii,Su,Fs,Ht,Un,Pn,Jn,Cs,$o,In,kl,Ga,Bi,Cu,Ml,js,Eu,Do,Yr,Ui,ku,wa,qi,ja,Hi,Al,Mu,Vi,Wi,ms,Na,lr;const y=f.useMemo(()=>{var N,O,I,q,oe,de;const g=[];return(N=e==null?void 0:e.data)!=null&&N.label&&g.push({label:"Label",value:String(e.data.label)}),(O=e==null?void 0:e.data)!=null&&O.description&&g.push({label:"Description",value:String(e.data.description)}),(I=e==null?void 0:e.data)!=null&&I.category&&g.push({label:"Category",value:String(e.data.category)}),(q=e==null?void 0:e.data)!=null&&q.catalogType&&g.push({label:"Node type",value:String(e.data.catalogType)}),(oe=e==null?void 0:e.data)!=null&&oe.inputs&&Array.isArray(e.data.inputs)&&e.data.inputs.length&&g.push({label:"Inputs",value:e.data.inputs.join(", ")}),(de=e==null?void 0:e.data)!=null&&de.outputs&&Array.isArray(e.data.outputs)&&e.data.outputs.length&&g.push({label:"Outputs",value:e.data.outputs.join(", ")}),g},[e]),p=f.useMemo(()=>{var N;const g=((N=e==null?void 0:e.data)==null?void 0:N.label)??(e==null?void 0:e.id);return typeof g=="string"&&g.trim()?g:`Node ${(e==null?void 0:e.id)??""}`},[e]),{catalogType:v,isDataset:_,isImputerNode:x,isMissingIndicatorNode:j,isReplaceAliasesNode:S,isTrimWhitespaceNode:k,isRemoveSpecialCharsNode:M,isReplaceInvalidValuesNode:P,isRegexCleanupNode:T,isNormalizeTextCaseNode:w,isStandardizeDatesNode:A,isLabelEncodingNode:E,isTargetEncodingNode:D,isHashEncodingNode:$,isFeatureTargetSplitNode:F,isTrainTestSplitNode:R,isTrainModelDraftNode:B,isModelEvaluationNode:ee,isModelRegistryNode:le,isHyperparameterTuningNode:z,isClassUndersamplingNode:G,isClassOversamplingNode:W,isOrdinalEncodingNode:H,isDummyEncodingNode:V,isOneHotEncodingNode:ne,isFeatureMathNode:Q,isCastNode:K,isBinningNode:J,isScalingNode:te,isPolynomialFeaturesNode:Y,isFeatureSelectionNode:U,isTransformerAuditNode:Z,isOutlierNode:ie,isSkewnessNode:re,isSkewnessDistributionNode:pe,isBinnedDistributionNode:xe,isDataConsistencyNode:Ve,isInspectionNode:ht,isRemoveDuplicatesNode:Qe,isDropMissingColumnsNode:Ne,isDropMissingRowsNode:ze,isDropMissingNode:Se}=y2(e),Be=_,He=G||W,Ke=f.useMemo(()=>vM,[]),st=f.useMemo(()=>Ke.map(g=>g.value),[Ke]),X=f.useMemo(()=>{var N;const g=(N=e==null?void 0:e.data)==null?void 0:N.parameters;return Array.isArray(g)?g.filter(O=>!!(O!=null&&O.name)).map(O=>({...O})):[]},[e]),Oe=f.useMemo(()=>M$[v]??null,[v]),Te=typeof(e==null?void 0:e.id)=="string"?e.id:"",ot=f.useMemo(()=>{var O;const g=(O=e==null?void 0:e.data)==null?void 0:O.connectionInfo;if(!g)return null;const N=I=>Array.isArray(I)?I.map(q=>({...q})):[];return{inputs:N(g.inputs),outputs:N(g.outputs)}},[e]),jt=((Tm=e==null?void 0:e.data)==null?void 0:Tm.hasRequiredConnections)!==!1,rn=f.useMemo(()=>{if(!Te||!i||!Array.isArray(i.edges))return new Set;const g=i.edges.filter(N=>(N==null?void 0:N.target)===Te).map(N=>pw(Te,N==null?void 0:N.targetHandle)).filter(N=>!!N);return new Set(g)},[i,Te]),ve=f.useMemo(()=>{if(!Te||!i||!Array.isArray(i.edges))return new Set;const g=i.edges.filter(N=>(N==null?void 0:N.source)===Te).map(N=>pw(Te,N==null?void 0:N.sourceHandle)).filter(N=>!!N);return new Set(g)},[i,Te]),be=f.useMemo(()=>{if(!(ot!=null&&ot.inputs)||ot.inputs.length===0)return;let g=!1;const N={};return ot.inputs.forEach(O=>{if(!Array.isArray(O.accepts)||O.accepts.length===0)return;const I=rn.has(O.key);O.accepts.forEach(q=>{(q==="validation"||q==="test")&&(N[q]=I,g=!0)})}),g?N:void 0},[ot==null?void 0:ot.inputs,rn]),ke=f.useMemo(()=>{var g;return(g=ot==null?void 0:ot.inputs)!=null&&g.length?ot.inputs.filter(N=>N.required!==!1):[]},[ot==null?void 0:ot.inputs]),Le=f.useMemo(()=>ke.length?ke.filter(g=>!rn.has(g.key)):[],[rn,ke]),Xe=jt&&Le.length===0,et=f.useMemo(()=>{if(!Xe)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[Xe]),tt=Xe?void 0:!0,xt=f.useMemo(()=>!!(m&&!_&&d),[d,_,m]),Bt=f.useMemo(()=>J?X.find(g=>g.name==="columns")??null:null,[J,X]);f.useMemo(()=>te?X.find(g=>g.name==="columns")??null:null,[te,X]);const Ft=f.useMemo(()=>Qe?X.find(g=>g.name==="columns")??null:null,[Qe,X]),ct=f.useMemo(()=>Qe?X.find(g=>g.name==="keep")??null:null,[Qe,X]),Tt=f.useMemo(()=>S?X.find(g=>g.name==="custom_pairs")??null:null,[S,X]),gt=f.useMemo(()=>k?X.find(g=>g.name==="columns")??null:null,[k,X]),Ct=f.useMemo(()=>k?X.find(g=>g.name==="mode")??null:null,[k,X]),hn=f.useMemo(()=>M?X.find(g=>g.name==="columns")??null:null,[M,X]),Zt=f.useMemo(()=>M?X.find(g=>g.name==="mode")??null:null,[M,X]),Cn=f.useMemo(()=>M?X.find(g=>g.name==="replacement")??null:null,[M,X]),Yn=f.useMemo(()=>P?X.find(g=>g.name==="columns")??null:null,[P,X]),pn=f.useMemo(()=>P?X.find(g=>g.name==="mode")??null:null,[P,X]),Ot=f.useMemo(()=>P?X.find(g=>g.name==="min_value")??null:null,[P,X]),Ut=f.useMemo(()=>P?X.find(g=>g.name==="max_value")??null:null,[P,X]),bn=f.useMemo(()=>T?X.find(g=>g.name==="columns")??null:null,[T,X]),qt=f.useMemo(()=>T?X.find(g=>g.name==="mode")??null:null,[T,X]),Pt=f.useMemo(()=>T?X.find(g=>g.name==="pattern")??null:null,[T,X]),an=f.useMemo(()=>T?X.find(g=>g.name==="replacement")??null:null,[T,X]),es=f.useMemo(()=>w?X.find(g=>g.name==="columns")??null:null,[w,X]),Ks=f.useMemo(()=>w?X.find(g=>g.name==="mode")??null:null,[w,X]),En=f.useMemo(()=>E?X.find(g=>g.name==="columns")??null:null,[E,X]),as=f.useMemo(()=>E?X.find(g=>g.name==="auto_detect")??null:null,[E,X]),Gt=f.useMemo(()=>E?X.find(g=>g.name==="max_unique_values")??null:null,[E,X]),Qn=f.useMemo(()=>E?X.find(g=>g.name==="output_suffix")??null:null,[E,X]),Tr=f.useMemo(()=>E?X.find(g=>g.name==="drop_original")??null:null,[E,X]),uo=f.useMemo(()=>E?X.find(g=>g.name==="missing_strategy")??null:null,[E,X]),Ys=f.useMemo(()=>E?X.find(g=>g.name==="missing_code")??null:null,[E,X]),Os=f.useMemo(()=>$?X.find(g=>g.name==="columns")??null:null,[$,X]),Pa=f.useMemo(()=>$?X.find(g=>g.name==="auto_detect")??null:null,[$,X]),Ta=f.useMemo(()=>$?X.find(g=>g.name==="max_categories")??null:null,[$,X]),ta=f.useMemo(()=>$?X.find(g=>g.name==="n_buckets")??null:null,[$,X]),$r=f.useMemo(()=>$?X.find(g=>g.name==="output_suffix")??null:null,[$,X]),na=f.useMemo(()=>$?X.find(g=>g.name==="drop_original")??null:null,[$,X]),sa=f.useMemo(()=>$?X.find(g=>g.name==="encode_missing")??null:null,[$,X]),ra=f.useMemo(()=>Y?X.find(g=>g.name==="columns")??null:null,[Y,X]),Ee=f.useMemo(()=>Y?X.find(g=>g.name==="auto_detect")??null:null,[Y,X]),Ye=f.useMemo(()=>Y?X.find(g=>g.name==="degree")??null:null,[Y,X]),Ge=f.useMemo(()=>Y?X.find(g=>g.name==="include_bias")??null:null,[Y,X]),sn=f.useMemo(()=>Y?X.find(g=>g.name==="interaction_only")??null:null,[Y,X]),Mt=f.useMemo(()=>Y?X.find(g=>g.name==="include_input_features")??null:null,[Y,X]),os=f.useMemo(()=>Y?X.find(g=>g.name==="output_prefix")??null:null,[Y,X]),nn=f.useMemo(()=>U?X.find(g=>g.name==="columns")??null:null,[U,X]),jn=f.useMemo(()=>U?X.find(g=>g.name==="auto_detect")??null:null,[U,X]),dn=f.useMemo(()=>U?X.find(g=>g.name==="target_column")??null:null,[U,X]),gn=f.useMemo(()=>U?X.find(g=>g.name==="method")??null:null,[U,X]),_n=f.useMemo(()=>U?X.find(g=>g.name==="score_func")??null:null,[U,X]),on=f.useMemo(()=>U?X.find(g=>g.name==="problem_type")??null:null,[U,X]),kn=f.useMemo(()=>U?X.find(g=>g.name==="k")??null:null,[U,X]),aa=f.useMemo(()=>U?X.find(g=>g.name==="percentile")??null:null,[U,X]),Qs=f.useMemo(()=>U?X.find(g=>g.name==="alpha")??null:null,[U,X]),Dr=f.useMemo(()=>U?X.find(g=>g.name==="threshold")??null:null,[U,X]),pr=f.useMemo(()=>U?X.find(g=>g.name==="mode")??null:null,[U,X]),_s=f.useMemo(()=>U?X.find(g=>g.name==="estimator")??null:null,[U,X]),Lr=f.useMemo(()=>U?X.find(g=>g.name==="step")??null:null,[U,X]),zr=f.useMemo(()=>U?X.find(g=>g.name==="min_features")??null:null,[U,X]),mo=f.useMemo(()=>U?X.find(g=>g.name==="max_features")??null:null,[U,X]),oa=f.useMemo(()=>U?X.find(g=>g.name==="drop_unselected")??null:null,[U,X]),la=f.useMemo(()=>Q?X.find(g=>g.name==="error_handling")??null:null,[Q,X]),ia=f.useMemo(()=>Q?X.find(g=>g.name==="allow_overwrite")??null:null,[Q,X]),el=f.useMemo(()=>Q?X.find(g=>g.name==="default_timezone")??null:null,[Q,X]),fo=f.useMemo(()=>Q?X.find(g=>g.name==="epsilon")??null:null,[Q,X]),Cc=f.useMemo(()=>He?X.find(g=>g.name==="method")??null:null,[He,X]),di=f.useMemo(()=>He?X.find(g=>g.name==="target_column")??null:null,[He,X]),Xt=f.useMemo(()=>He?X.find(g=>g.name==="sampling_strategy")??null:null,[He,X]),Ec=f.useMemo(()=>He?X.find(g=>g.name==="random_state")??null:null,[He,X]),mi=f.useMemo(()=>W?X.find(g=>g.name==="k_neighbors")??null:null,[W,X]),tl=f.useMemo(()=>G?X.find(g=>g.name==="replacement")??null:null,[G,X]),fi=f.useMemo(()=>F?X.find(g=>g.name==="target_column")??null:null,[F,X]),hi=f.useMemo(()=>B||z?X.find(g=>g.name==="target_column")??null:null,[z,B,X]),ae=f.useMemo(()=>B||z?X.find(g=>g.name==="problem_type")??null:null,[z,B,X]),Me=f.useMemo(()=>B||z?X.find(g=>g.name==="model_type")??null:null,[z,B,X]),we=f.useMemo(()=>B?X.find(g=>g.name==="hyperparameters")??null:null,[B,X]),We=f.useMemo(()=>z?X.find(g=>g.name==="search_strategy")??null:null,[z,X]),Ue=f.useMemo(()=>z?X.find(g=>g.name==="search_iterations")??null:null,[z,X]),Pe=f.useMemo(()=>z?X.find(g=>g.name==="search_random_state")??null:null,[z,X]),_t=f.useMemo(()=>z?X.find(g=>g.name==="scoring_metric")??null:null,[z,X]),rt=f.useMemo(()=>B||z?X.find(g=>g.name==="cv_enabled")??null:null,[z,B,X]),mt=f.useMemo(()=>B||z?X.find(g=>g.name==="cv_strategy")??null:null,[z,B,X]),Dt=f.useMemo(()=>B||z?X.find(g=>g.name==="cv_folds")??null:null,[z,B,X]),pt=f.useMemo(()=>B||z?X.find(g=>g.name==="cv_shuffle")??null:null,[z,B,X]),Lt=f.useMemo(()=>B||z?X.find(g=>g.name==="cv_random_state")??null:null,[z,B,X]),Dn=f.useMemo(()=>B?X.find(g=>g.name==="cv_refit_strategy")??null:null,[B,X]),Yt=f.useMemo(()=>D?X.find(g=>g.name==="columns")??null:null,[D,X]),Ln=f.useMemo(()=>D?X.find(g=>g.name==="target_column")??null:null,[D,X]),gr=f.useMemo(()=>D?X.find(g=>g.name==="auto_detect")??null:null,[D,X]),$a=f.useMemo(()=>D?X.find(g=>g.name==="max_categories")??null:null,[D,X]),_r=f.useMemo(()=>D?X.find(g=>g.name==="output_suffix")??null:null,[D,X]),Gs=f.useMemo(()=>D?X.find(g=>g.name==="drop_original")??null:null,[D,X]),Ps=f.useMemo(()=>D?X.find(g=>g.name==="smoothing")??null:null,[D,X]),vs=f.useMemo(()=>D?X.find(g=>g.name==="encode_missing")??null:null,[D,X]),vr=f.useMemo(()=>D?X.find(g=>g.name==="handle_unknown")??null:null,[D,X]),pi=f.useMemo(()=>H?X.find(g=>g.name==="columns")??null:null,[H,X]),ho=f.useMemo(()=>H?X.find(g=>g.name==="auto_detect")??null:null,[H,X]),po=f.useMemo(()=>H?X.find(g=>g.name==="max_categories")??null:null,[H,X]),nl=f.useMemo(()=>H?X.find(g=>g.name==="output_suffix")??null:null,[H,X]),sl=f.useMemo(()=>H?X.find(g=>g.name==="drop_original")??null:null,[H,X]),Rr=f.useMemo(()=>H?X.find(g=>g.name==="encode_missing")??null:null,[H,X]),gi=f.useMemo(()=>H?X.find(g=>g.name==="handle_unknown")??null:null,[H,X]),Da=f.useMemo(()=>H?X.find(g=>g.name==="unknown_value")??null:null,[H,X]),rl=f.useMemo(()=>V?X.find(g=>g.name==="columns")??null:null,[V,X]),zn=f.useMemo(()=>V?X.find(g=>g.name==="auto_detect")??null:null,[V,X]),go=f.useMemo(()=>V?X.find(g=>g.name==="max_categories")??null:null,[V,X]),kc=f.useMemo(()=>V?X.find(g=>g.name==="drop_first")??null:null,[V,X]),ys=f.useMemo(()=>V?X.find(g=>g.name==="include_missing")??null:null,[V,X]),La=f.useMemo(()=>V?X.find(g=>g.name==="drop_original")??null:null,[V,X]),Nn=f.useMemo(()=>V?X.find(g=>g.name==="prefix_separator")??null:null,[V,X]),Gn=f.useMemo(()=>ne?X.find(g=>g.name==="columns")??null:null,[ne,X]),yr=f.useMemo(()=>ne?X.find(g=>g.name==="auto_detect")??null:null,[ne,X]),_i=f.useMemo(()=>ne?X.find(g=>g.name==="max_categories")??null:null,[ne,X]),Sd=f.useMemo(()=>ne?X.find(g=>g.name==="drop_first")??null:null,[ne,X]),vi=f.useMemo(()=>ne?X.find(g=>g.name==="include_missing")??null:null,[ne,X]),Mc=f.useMemo(()=>ne?X.find(g=>g.name==="drop_original")??null:null,[ne,X]),Wf=f.useMemo(()=>ne?X.find(g=>g.name==="prefix_separator")??null:null,[ne,X]),Cd=f.useMemo(()=>j?X.find(g=>g.name==="columns")??null:null,[j,X]),Ed=f.useMemo(()=>j?X.find(g=>g.name==="flag_suffix")??null:null,[j,X]);f.useMemo(()=>te?X.find(g=>g.name==="default_method")??null:null,[te,X]),f.useMemo(()=>te?X.find(g=>g.name==="auto_detect")??null:null,[te,X]);const Ac=f.useMemo(()=>X.some(g=>{var N;return(g==null?void 0:g.type)==="multi_select"&&((N=g==null?void 0:g.source)==null?void 0:N.type)!=="drop_column_recommendations"}),[X]),yi=f.useMemo(()=>X.find(g=>{var N;return((N=g==null?void 0:g.source)==null?void 0:N.type)==="drop_column_recommendations"})??null,[X]),Kf=f.useMemo(()=>X.find(g=>g.name==="drop_if_any_missing")??null,[X]),Yf=f.useMemo(()=>{let g=X;return g=g.filter(N=>{var O;return((O=N==null?void 0:N.source)==null?void 0:O.type)!=="drop_column_recommendations"}),(Ne||ze)&&(g=g.filter(N=>N.name!=="missing_threshold")),ze&&(g=g.filter(N=>N.name!=="drop_if_any_missing")),x&&(g=g.filter(N=>N.name!=="strategies")),re&&(g=g.filter(N=>N.name!=="transformations")),K&&(g=g.filter(N=>N.name!=="column_overrides")),J&&(g=g.filter(N=>N.name!=="columns")),te&&(g=g.filter(N=>!["columns","default_method","auto_detect"].includes(N.name))),Qe&&(g=g.filter(N=>N.name!=="columns"&&N.name!=="keep")),j&&(g=g.filter(N=>N.name!=="columns"&&N.name!=="flag_suffix")),S&&(g=g.filter(N=>!["columns","mode","custom_pairs"].includes(N.name))),k&&(g=g.filter(N=>!["columns","mode"].includes(N.name))),M&&(g=g.filter(N=>!["columns","mode","replacement"].includes(N.name))),P&&(g=g.filter(N=>!["columns","mode","min_value","max_value"].includes(N.name))),T&&(g=g.filter(N=>!["columns","mode","pattern","replacement"].includes(N.name))),w&&(g=g.filter(N=>!["columns","mode"].includes(N.name))),A&&(g=g.filter(N=>!["columns","mode"].includes(N.name))),G&&(g=g.filter(N=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(N.name))),B&&(g=g.filter(N=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(N.name))),W&&(g=g.filter(N=>!["method","target_column","sampling_strategy","random_state"].includes(N.name))),F&&(g=g.filter(N=>N.name!=="target_column")),E&&(g=g.filter(N=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(N.name))),H&&(g=g.filter(N=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(N.name))),V&&(g=g.filter(N=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(N.name))),ne&&(g=g.filter(N=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(N.name))),g},[J,K,Ne,ze,x,j,S,k,M,P,T,w,A,G,W,B,E,H,V,ne,Qe,re,F,X]),Qf=f.useMemo(()=>Ve?Yf:[],[Yf,Ve]),Gf=re||pe,bi=f.useMemo(()=>{var N;const g=Eg(((N=e==null?void 0:e.data)==null?void 0:N.config)??{});return!g||typeof g!="object"||Array.isArray(g)?{}:((!g.column_overrides||typeof g.column_overrides!="object"||Array.isArray(g.column_overrides))&&(g.column_overrides={}),g)},[e]),[ge,Re]=f.useState(bi),ca=f.useRef(!1),Xf=f.useMemo(()=>cd(bi),[bi]),t_=f.useMemo(()=>cd(ge),[ge]),kd=f.useMemo(()=>le?ge?{...ge}:{}:null,[ge,le]),al=f.useMemo(()=>Sx(ge==null?void 0:ge.strategies,st),[ge==null?void 0:ge.strategies,st]),Jf=al.length,Zf=f.useMemo(()=>gg(kx(ge==null?void 0:ge.transformations)),[ge==null?void 0:ge.transformations]),Mn=f.useMemo(()=>{if(!i)return null;const g=Array.isArray(i.nodes)?i.nodes:[],N=Array.isArray(i.edges)?i.edges:[];return{nodes:g,edges:N}},[i]),_o=f.useMemo(()=>i&&Array.isArray(i.nodes)?i.nodes:[],[i]),ol=f.useMemo(()=>i&&Array.isArray(i.edges)?i.edges:[],[i]),Oc=_o.length,za=f.useMemo(()=>{if(!Te||!ol.length)return[];const g=new Set,N=[Te];for(;N.length;){const I=N.pop();I&&ol.forEach(q=>{const oe=q&&typeof q.source=="string"?q.source.trim():"",de=q&&typeof q.target=="string"?q.target.trim():"";!oe||!de||de===I&&!g.has(oe)&&(g.add(oe),N.push(oe))})}const O=Array.from(g);return O.sort(),O},[ol,Te]),n_=f.useMemo(()=>{var O,I,q,oe,de;if(!za.length)return"";let g="",N="";for(const me of za){const ce=_o.find(Ie=>(Ie==null?void 0:Ie.id)===me);if(!ce)continue;const Ce=String(((O=ce==null?void 0:ce.data)==null?void 0:O.catalogType)??"").toLowerCase().trim();if(Ce==="feature_target_split"){const Ie=(q=(I=ce==null?void 0:ce.data)==null?void 0:I.config)==null?void 0:q.target_column;typeof Ie=="string"&&Ie.trim()&&(g=Ie.trim())}else if(Ce==="train_test_split"){const Ie=(de=(oe=ce==null?void 0:ce.data)==null?void 0:oe.config)==null?void 0:de.target_column;typeof Ie=="string"&&Ie.trim()&&(N=Ie.trim())}}return g||N||""},[_o,za]),{featureTargetSplitConfig:s_,trainTestSplitConfig:r_,resamplingConfig:ua,trainModelDraftConfig:vo,trainModelRuntimeConfig:eh,trainModelCVConfig:Md,filteredModelTypeOptions:Ad}=n$({configState:ge,setConfigState:Re,isFeatureTargetSplitNode:F,isTrainTestSplitNode:R,isTrainModelDraftNode:B,isHyperparameterTuningNode:z,isClassResamplingNode:He,isClassOversamplingNode:W,isClassUndersamplingNode:G,upstreamTargetColumn:n_,nodeId:Te,modelTypeOptions:(Me==null?void 0:Me.options)??null}),ll=f.useMemo(()=>Q?k0((ge==null?void 0:ge.operations)??[]):[],[ge==null?void 0:ge.operations,Q]),Od=f.useMemo(()=>{if(!za.length)return{};const g={};return za.forEach(N=>{var q;const O=_o.find(oe=>oe&&typeof oe.id=="string"&&oe.id===N);if(!O)return;const I=((q=O==null?void 0:O.data)==null?void 0:q.config)??null;g[N]=I}),g},[_o,za]),Pd=f.useMemo(()=>cd({sourceId:l??null,nodeId:Te||null,config:ge,upstreamIds:za,upstreamConfig:Od}),[ge,Te,l,Od,za]),[da,Pc]=f.useState(null),yo=f.useMemo(()=>(da==null?void 0:da.columns)??[],[da]),Td=f.useMemo(()=>{const g=new Set;return _o.forEach(N=>{if(!N)return;const O=typeof N.id=="string"?N.id.trim():String((N==null?void 0:N.id)??"").trim();if(!O)return;const I=(N==null?void 0:N.data)??{};(O==="dataset-source"||(I==null?void 0:I.isDataset)===!0||(I==null?void 0:I.catalogType)==="dataset")&&g.add(O)}),g.size||g.add("dataset-source"),Array.from(g)},[_o]),bt=f.useMemo(()=>{if(!Te)return!1;if(_)return!0;if(!ol.length)return Td.includes(Te);const g=new Map;ol.forEach(I=>{const q=I==null?void 0:I.source,oe=I==null?void 0:I.target,de=typeof q=="string"?q.trim():String(q??"").trim(),me=typeof oe=="string"?oe.trim():String(oe??"").trim();if(!de||!me)return;const ce=g.get(de);ce?ce.push(me):g.set(de,[me])});const N=new Set,O=[...Td];for(;O.length;){const I=O.pop();if(!I||N.has(I))continue;N.add(I);const q=g.get(I);q&&q.forEach(oe=>{oe&&!N.has(oe)&&O.push(oe)})}return N.has(Te)},[Td,ol,_,Te]),xi=f.useMemo(()=>{if(!W||!yo.length)return null;const g=ua==null?void 0:ua.targetColumn;if(!g)return null;const N=new Set(["numeric","integer","boolean"]),O=yo.filter(I=>I&&I.name!==g).filter(I=>!N.has(String(I.logical_family??"unknown"))).map(I=>({name:I.name,logical_family:String(I.logical_family??"unknown")}));return O.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:O.map(I=>I.name),details:O}:null},[yo,W,ua==null?void 0:ua.targetColumn]),Ra=f.useMemo(()=>{if(!x||!yo.length||!al.length)return null;const g=new Set(["numeric","integer"]),N=new Map(yo.map(I=>[I.name,I])),O=[];return al.forEach((I,q)=>{if(!jx(I.method)||!Array.isArray(I.columns)||!I.columns.length)return;const oe=I.columns.map(de=>N.get(de)).filter(de=>!!de).filter(de=>!g.has(String(de.logical_family??"unknown"))).map(de=>({name:de.name,logical_family:String(de.logical_family??"unknown")}));oe.length&&O.push({index:q,columns:oe.map(de=>de.name),details:oe})}),O.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:O}:null},[yo,al,x]),wi=!!(xi!=null&&xi.blocked||Ra!=null&&Ra.blocked),[xn,bo]=f.useState([]),[Tc,ji]=f.useState(""),[Fa,il]=f.useState({}),[br,Ni]=f.useState({}),[Si,$c]=f.useState({}),[th,$d]=f.useState(0),a_=!!yi,{hasDropColumnSource:o_,availableFilters:Xs,activeFilterId:cl,setActiveFilterId:Dd,recommendations:xo,filteredRecommendations:Ld,formatSignalName:zd,isFetchingRecommendations:Fr,recommendationsError:nh,recommendationsGeneratedAt:l_,suggestedThreshold:ma,refreshRecommendations:Dc}=$k({hasDropColumnSource:a_,sourceId:l,nodeId:Te,graphContext:Mn,hasReachableSource:bt,columnTypeMap:br,setAvailableColumns:bo,setColumnSearch:ji,setColumnMissingMap:il,setColumnTypeMap:Ni,setColumnSuggestions:$c});S2({shouldLoad:x,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null,setAvailableColumns:bo,setColumnMissingMap:il});const{isFetching:Ci,error:Rd,suggestions:sh,metadata:ul}=i$({isLabelEncodingNode:E,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:dl,error:Fd,suggestions:Lc,metadata:Ir}=m$({isTargetEncodingNode:D,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:Ei,error:rh,suggestions:zc,metadata:ml}=g$({isHashEncodingNode:$,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:ah,error:oh,suggestions:Br,metadata:wo}=b$({isOrdinalEncodingNode:H,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:Id,error:i_,suggestions:Bd,metadata:jo}=N$({isDummyEncodingNode:V,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null}),{isFetching:c_,error:lh,suggestions:Rc,metadata:mn}=k$({isOneHotEncodingNode:ne,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null});f.useEffect(()=>{E&&ul.autoDetectDefault&&(ge==null?void 0:ge.auto_detect)!==!0&&(ge==null?void 0:ge.auto_detect)!==!1&&Re(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[ge==null?void 0:ge.auto_detect,E,ul.autoDetectDefault,Re]),f.useEffect(()=>{D&&Ir.autoDetectDefault&&(ge==null?void 0:ge.auto_detect)!==!0&&(ge==null?void 0:ge.auto_detect)!==!1&&Re(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[ge==null?void 0:ge.auto_detect,D,Re,Ir.autoDetectDefault]),f.useEffect(()=>{$&&ml.autoDetectDefault&&(ge==null?void 0:ge.auto_detect)!==!0&&(ge==null?void 0:ge.auto_detect)!==!1&&Re(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[ge==null?void 0:ge.auto_detect,ml.autoDetectDefault,$,Re]),f.useEffect(()=>{if(!$)return;const g=ml.suggestedBucketDefault;if(!g||!Number.isFinite(g))return;const N=Math.max(2,Math.round(g));Re(O=>{if(!O||typeof O!="object"||Array.isArray(O))return O;const I=O.n_buckets;if(I!=null){const q=Number(I);if(Number.isFinite(q)&&Math.round(q)>0)return O}return{...O,n_buckets:N}})},[ml.suggestedBucketDefault,$,Re]),f.useEffect(()=>{if(!D||!Ir.enableGlobalFallbackDefault)return;const g=typeof(ge==null?void 0:ge.encode_missing)=="boolean"?ge.encode_missing:null,N=typeof(ge==null?void 0:ge.handle_unknown)=="string"?ge.handle_unknown.trim().toLowerCase():"";g===!0&&N==="global_mean"||Re(O=>{const I=typeof(O==null?void 0:O.encode_missing)=="boolean"?O.encode_missing:null,q=typeof(O==null?void 0:O.handle_unknown)=="string"?O.handle_unknown.trim().toLowerCase():"";if(I===!0&&q==="global_mean")return O;const oe={...O};return I!==!0&&(oe.encode_missing=!0),q!=="global_mean"&&(oe.handle_unknown="global_mean"),oe})},[ge==null?void 0:ge.encode_missing,ge==null?void 0:ge.handle_unknown,D,Re,Ir.enableGlobalFallbackDefault]),f.useEffect(()=>{H&&wo.autoDetectDefault&&(ge==null?void 0:ge.auto_detect)!==!0&&(ge==null?void 0:ge.auto_detect)!==!1&&Re(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[ge==null?void 0:ge.auto_detect,H,wo.autoDetectDefault,Re]),f.useEffect(()=>{!H||!wo.enableUnknownDefault||typeof(ge==null?void 0:ge.handle_unknown)=="string"&&ge.handle_unknown.trim().toLowerCase()||Re(N=>(typeof(N==null?void 0:N.handle_unknown)=="string"?N.handle_unknown.trim().toLowerCase():"")?N:{...N,handle_unknown:"use_encoded_value"})},[ge==null?void 0:ge.handle_unknown,H,wo.enableUnknownDefault,Re]),f.useEffect(()=>{V&&jo.autoDetectDefault&&(ge==null?void 0:ge.auto_detect)!==!0&&(ge==null?void 0:ge.auto_detect)!==!1&&Re(g=>(g==null?void 0:g.auto_detect)!==void 0&&g.auto_detect!==null?g:{...g,auto_detect:!0})},[ge==null?void 0:ge.auto_detect,jo.autoDetectDefault,V,Re]),f.useEffect(()=>{!Ac&&!x||l&&bt||(bo([]),il({}),Ni({}),$c({}),ji(""))},[bt,x,Ac,l]),f.useEffect(()=>{Re(bi),ca.current=!1},[bi]),f.useEffect(()=>{$d(0)},[x,e==null?void 0:e.id]);const[Fc,Ic]=f.useState("500"),[No,bs]=f.useState(()=>new Set),[Ud,Ts]=f.useState(()=>new Set);f.useEffect(()=>{bs(new Set)},[Xf]),f.useEffect(()=>{if(!D){ca.current=!1;return}if(!Ir.enableGlobalFallbackDefault||ca.current)return;const g=typeof(ge==null?void 0:ge.encode_missing)=="boolean"?ge.encode_missing:null,N=typeof(ge==null?void 0:ge.handle_unknown)=="string"?ge.handle_unknown.trim().toLowerCase():"";if(g===!0&&N==="global_mean"){ca.current=!0;return}Re(O=>{const I=typeof(O==null?void 0:O.encode_missing)=="boolean"?O.encode_missing:null,q=typeof(O==null?void 0:O.handle_unknown)=="string"?O.handle_unknown.trim().toLowerCase():"";if(I===!0&&q==="global_mean")return ca.current=!0,O;const oe={...O};return I!==!0&&(oe.encode_missing=!0),q!=="global_mean"&&(oe.handle_unknown="global_mean"),ca.current=!0,oe})},[ge==null?void 0:ge.encode_missing,ge==null?void 0:ge.handle_unknown,D,Re,Ir.enableGlobalFallbackDefault]);const fa=f.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="data_preview"},[($m=e==null?void 0:e.data)==null?void 0:$m.catalogType]),So=f.useMemo(()=>{var g;return((g=e==null?void 0:e.data)==null?void 0:g.catalogType)==="dataset_profile"},[(Xh=e==null?void 0:e.data)==null?void 0:Xh.catalogType]),ih=f.useMemo(()=>Mn?cd(Mn):"",[Mn]),ch=Xk({node:e,isDatasetProfileNode:So,sourceId:l,hasReachableSource:bt,graphContext:Mn,profilingGraphSignature:ih,formatRelativeTime:fr}),{profileState:u_}=ch,uh=f.useMemo(()=>!(!i||!Oc||!bt),[Oc,i,bt,l]),ki=f.useMemo(()=>!i||!l||!bt?!1:Oc>0,[Oc,i,bt,l]),Bc=fa||Q||Y||U||ie||Z,{previewState:Et,refreshPreview:Uc}=N2({shouldFetchPreview:uh,sourceId:l,canTriggerPreview:ki,graphSnapshot:i??null,isPreviewNode:fa,targetNodeId:(e==null?void 0:e.id)??null,previewSignature:Pd,skipPreview:wi,requestPreviewRows:fa,includeSignals:Bc}),Mi=f.useMemo(()=>{var N,O;if(!Q)return[];const g=(O=(N=Et.data)==null?void 0:N.signals)==null?void 0:O.feature_math;return Array.isArray(g)?g:[]},[Q,(Su=(Ii=Et.data)==null?void 0:Ii.signals)==null?void 0:Su.feature_math]),qd=f.useMemo(()=>{var O,I;if(!Y)return null;const g=(I=(O=Et.data)==null?void 0:O.signals)==null?void 0:I.polynomial_features;return!Array.isArray(g)||g.length===0?null:(Te?g.find(q=>q&&typeof q.node_id=="string"&&q.node_id===Te):null)??g[0]??null},[Y,Te,(Ht=(Fs=Et.data)==null?void 0:Fs.signals)==null?void 0:Ht.polynomial_features]),d_=f.useMemo(()=>{var O,I;if(!U)return null;const g=(I=(O=Et.data)==null?void 0:O.signals)==null?void 0:I.feature_selection;return!Array.isArray(g)||g.length===0?null:(Te?g.find(q=>q&&typeof q.node_id=="string"&&q.node_id===Te):null)??g[0]??null},[U,Te,(Pn=(Un=Et.data)==null?void 0:Un.signals)==null?void 0:Pn.feature_selection]),dh=f.useMemo(()=>Q?MP(ll,Mi):[],[ll,Mi,Q]);f.useEffect(()=>{if(!Q){Ts(()=>new Set);return}Ts(g=>{if(!g.size)return g;const N=new Set(ll.map(I=>I.id)),O=new Set;return g.forEach(I=>{N.has(I)&&O.add(I)}),O.size===g.size?g:O})},[ll,Q]);const{outlierData:Ai,outlierError:m_,isFetchingOutliers:Hd,refreshOutliers:ha}=O2({isOutlierNode:ie,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:Te||null}),Co=f.useCallback(()=>{Pc(null),Uc(),ie&&ha()},[ie,ha,Uc]);f.useEffect(()=>{var N;const g=((N=Et.data)==null?void 0:N.schema)??null;g&&Pc(O=>O!=null&&O.signature&&g.signature&&O.signature===g.signature?O:g)},[(Jn=Et.data)==null?void 0:Jn.schema]),f.useEffect(()=>{Pc(null)},[l]),f.useEffect(()=>{Pc(null)},[Pd]);const{scalingData:Js,scalingError:Ur,isFetchingScaling:Ia}=b2({isScalingNode:te,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null}),{binnedDistributionData:An,binnedDistributionError:Vd,isFetchingBinnedDistribution:qc,refreshBinnedDistribution:mh}=w2({isBinnedDistributionNode:xe,sourceId:l,hasReachableSource:bt,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null,samplePreset:Fc}),{skewnessData:Eo,skewnessError:Ba,isFetchingSkewness:Zs}=x2({shouldLoad:Gf,sourceId:l,graphContext:Mn,targetNodeId:(e==null?void 0:e.id)??null,transformations:Zf}),fl=f.useMemo(()=>{var N;const g=(N=Et.data)==null?void 0:N.columns;return Array.isArray(g)?g.filter(O=>typeof O=="string"):[]},[(Cs=Et.data)==null?void 0:Cs.columns]),Wd=f.useMemo(()=>{var N;const g=(N=Et.data)==null?void 0:N.column_stats;return Array.isArray(g)?g:[]},[($o=Et.data)==null?void 0:$o.column_stats]),Rn=f.useMemo(()=>{var g,N;return j?IM(ge==null?void 0:ge.flag_suffix,(N=(g=e==null?void 0:e.data)==null?void 0:g.config)==null?void 0:N.flag_suffix):""},[ge==null?void 0:ge.flag_suffix,j,(kl=(In=e==null?void 0:e.data)==null?void 0:In.config)==null?void 0:kl.flag_suffix]),pa=f.useMemo(()=>j?ut(ge==null?void 0:ge.columns):[],[ge==null?void 0:ge.columns,j]),fn=f.useMemo(()=>j?UM({selectedColumns:pa,availableColumns:xn,columnMissingMap:Fa,suffix:Rn}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[Rn,xn,Fa,j,pa]),Kt=f.useMemo(()=>{var g;return Array.isArray((g=Et.data)==null?void 0:g.sample_rows)?Et.data.sample_rows:[]},[(Ga=Et.data)==null?void 0:Ga.sample_rows]),{aliasStrategies:Ua,aliasStrategyCount:ts,aliasColumnSummary:ls,aliasCustomPairSummary:ko,aliasSampleMap:hl,aliasColumnOptions:Ss}=A2({isReplaceAliasesNode:S,configState:ge,nodeConfig:((Bi=e==null?void 0:e.data)==null?void 0:Bi.config)??null,availableColumns:xn,columnTypeMap:br,previewSampleRows:Kt}),{trimWhitespace:{columnSummary:Hc,sampleMap:fh,modeDetails:hh},removeSpecial:{columnSummary:Vc,sampleMap:ph,modeDetails:ga},regexCleanup:{columnSummary:Wc,sampleMap:Kd,modeDetails:gh,selectedMode:f_,replacementValue:qa},normalizeCase:{columnSummary:pl,sampleMap:gl,modeDetails:Kc,selectedMode:Yc}}=K2({isTrimWhitespaceNode:k,isRemoveSpecialCharsNode:M,isRegexCleanupNode:T,isNormalizeTextCaseNode:w,configState:ge,nodeConfig:((Cu=e==null?void 0:e.data)==null?void 0:Cu.config)??null,availableColumns:xn,columnTypeMap:br,previewSampleRows:Kt}),{selectedMode:er,modeDetails:tr,sampleMap:Mo,columnSummary:_a,minValue:va,maxValue:Ao}=Q2({isReplaceInvalidValuesNode:P,configState:ge,nodeConfig:((Ml=e==null?void 0:e.data)==null?void 0:Ml.config)??null,availableColumns:xn,columnTypeMap:br,previewSampleRows:Kt}),{selectedMode:Yd,strategies:Oi,sampleMap:Qd,columnSummary:xs,columnOptions:$s}=X2({isStandardizeDatesNode:A,configState:ge,nodeConfig:((js=e==null?void 0:e.data)==null?void 0:js.config)??null,availableColumns:xn,columnTypeMap:br,previewSampleRows:Kt}),vn=J||te||ie,{numericExcludedColumns:Ds}=D2({shouldAnalyze:vn,availableColumns:xn,columnTypeMap:br,previewSampleRows:Kt}),{scalingConfig:_l,scalingExcludedColumns:Ls,scalingMethodDetailMap:Gd,scalingMethodOptions:Xd,scalingRecommendations:Oo,scalingRecommendationRows:Qc,scalingSelectedCount:_h,scalingOverrideCount:vl,scalingDefaultDetail:Jd,scalingDefaultLabel:h_,scalingAutoDetectEnabled:Po,scalingHasRecommendations:Gc,scalingStatusMessage:vh,scalingOverrideExampleSummary:yh}=J2({isScalingNode:te,configState:ge,numericExcludedColumns:Ds,scalingData:Js}),{outlierConfig:qr,outlierExcludedColumns:Xc,outlierMethodDetailMap:Jc,outlierMethodOptions:Zc,outlierRecommendationRows:ya,outlierSelectedCount:Zd,outlierOverrideCount:yl,outlierParameterOverrideCount:Ha,outlierDefaultDetail:em,outlierDefaultLabel:bl,outlierAutoDetectEnabled:nr,outlierHasRecommendations:To,outlierStatusMessage:tm,outlierOverrideExampleSummary:nm}=Z2({isOutlierNode:ie,configState:ge,numericExcludedColumns:Ds,outlierData:Ai}),ba=typeof(Ai==null?void 0:Ai.sample_size)=="number"?Ai.sample_size:null,Va=null,sm=yl>0||Ha>0,bh=f.useMemo(()=>yl>0?nm:Ha>0?`${Ha} column${Ha===1?"":"s"} with parameter overrides`:null,[yl,Ha,nm]),{binningConfig:xr,fieldIds:Wa,customEdgeDrafts:eu,setCustomEdgeDrafts:rm,customLabelDrafts:tu,setCustomLabelDrafts:am}=e$({configState:ge,nodeId:Te}),Pi=`${Te||"node"}-remove-duplicates-keep`,ln=f.useMemo(()=>te?_l.columns:J?xr.columns:ie?qr.columns:ut(ge==null?void 0:ge.columns),[xr.columns,ge,J,ie,te,qr.columns,_l.columns]),Ti=f.useMemo(()=>{const g=typeof(ge==null?void 0:ge.keep)=="string"?ge.keep.trim().toLowerCase():"";return g==="last"||g==="none"?g:zk},[ge==null?void 0:ge.keep]),{binningExcludedColumns:is,binningColumnPreviewMap:Ka}=z2({isBinningNode:J,numericExcludedColumns:Ds,selectedColumns:ln,previewSampleRows:Kt,availableColumns:xn});W2({isScalingNode:te,isBinningNode:J,isOutlierNode:ie,scalingExcludedColumns:Ls,binningExcludedColumns:is,outlierExcludedColumns:Xc,setConfigState:Re});const om=f.useMemo(()=>{var O,I;if(!ie)return null;const g=(I=(O=Et.data)==null?void 0:O.signals)==null?void 0:I.outlier_removal;return!Array.isArray(g)||!g.length?null:Te?g.find(q=>q&&q.node_id===Te)??g[g.length-1]??null:g[g.length-1]??null},[ie,Te,(Do=(Eu=Et.data)==null?void 0:Eu.signals)==null?void 0:Do.outlier_removal]),xl=f.useMemo(()=>{var O,I;if(!Z)return null;const g=(I=(O=Et.data)==null?void 0:O.signals)==null?void 0:I.transformer_audit;return!Array.isArray(g)||!g.length?null:Te?g.find(q=>q&&q.node_id===Te)??g[g.length-1]??null:g[g.length-1]??null},[Z,Te,(Ui=(Yr=Et.data)==null?void 0:Yr.signals)==null?void 0:Ui.transformer_audit]);f.useEffect(()=>{var I;const g=Array.isArray((I=Et.data)==null?void 0:I.column_stats)?Et.data.column_stats:[];if(!g.length){if(Et.status==="loading")return;Ni(q=>Object.keys(q).length?{}:q),$c(q=>Object.keys(q).length?{}:q);return}const N={},O={};g.forEach(q=>{if(!q||!q.name)return;const oe=String(q.name).trim();if(!oe||Rn&&oe.endsWith(Rn))return;const de=typeof q.dtype=="string"?q.dtype:null;de&&(N[oe]=de);const me=Kt.map(Ce=>Ce&&Object.prototype.hasOwnProperty.call(Ce,oe)?Ce[oe]:void 0),ce=OT(de,me);ce.length&&(O[oe]=ce)}),Ni(q=>{const oe=Object.entries(q),de=Object.entries(N);return oe.length===de.length&&oe.every(([me,ce])=>Object.prototype.hasOwnProperty.call(N,me)&&N[me]===ce)?q:N}),$c(q=>{const oe=Object.keys(q),de=Object.keys(O);return oe.length===de.length&&oe.every(me=>{if(!Object.prototype.hasOwnProperty.call(O,me))return!1;const ce=q[me]??[],Ce=O[me]??[];return W0(ce,Ce)})?q:O})},[Rn,Kt,(ku=Et.data)==null?void 0:ku.column_stats,Et.status]),f.useEffect(()=>{var oe,de,me;if(!Ac||!bt)return;const g=new Set;(Array.isArray((oe=Et.data)==null?void 0:oe.columns)?Et.data.columns:[]).forEach(ce=>{const Ce=typeof ce=="string"?ce.trim():"";Ce&&(Rn&&Ce.endsWith(Rn)||g.add(Ce))});const O=Array.isArray((de=Et.data)==null?void 0:de.column_stats)?Et.data.column_stats:[],I={};if(O.forEach(ce=>{if(!ce||!ce.name)return;const Ce=String(ce.name).trim();if(!Ce||Rn&&Ce.endsWith(Rn))return;g.add(Ce);const Ie=Number(ce.missing_percentage);!Number.isNaN(Ie)&&Ie>=0&&(I[Ce]=Ie)}),ut((me=e==null?void 0:e.data)==null?void 0:me.columns).forEach(ce=>{ce&&!(Rn&&ce.endsWith(Rn))&&g.add(ce)}),ln.forEach(ce=>{ce&&!(Rn&&ce.endsWith(Rn))&&g.add(ce)}),g.size===0)return;const q=Array.from(g).sort((ce,Ce)=>ce.localeCompare(Ce));bo(ce=>W0(ce,q)?ce:q),Object.keys(I).length>0&&il(ce=>({...ce,...I}))},[Rn,bt,(wa=e==null?void 0:e.data)==null?void 0:wa.columns,(qi=Et.data)==null?void 0:qi.column_stats,(ja=Et.data)==null?void 0:ja.columns,Ac,ln]);const nu=f.useMemo(()=>Tc.trim().toLowerCase(),[Tc]),wl=f.useMemo(()=>nu?xn.filter(g=>g.toLowerCase().includes(nu)):xn,[xn,nu]),wn=f.useCallback(g=>{Re(N=>{const O=gg(kx(N==null?void 0:N.transformations)),I=gg(g(O));return{...N,transformations:I.map(q=>({...q}))}})},[]),{skewnessThreshold:jl,skewnessViewMode:lm,setSkewnessViewMode:im,skewnessGroupByMethod:su,setSkewnessGroupByMethod:cm,skewnessDistributionView:sr,setSkewnessDistributionView:yn,skewnessRecommendedCount:Bn,skewnessNumericCount:Xn,skewnessTransformationsCount:ru,hasSkewnessAutoRecommendations:$i,skewnessRows:Di,skewnessTableGroups:p_,skewnessDistributionCards:On,getSkewnessMethodLabel:um,getSkewnessMethodStatus:dm,applySkewnessRecommendations:mm,handleSkewnessOverrideChange:Hr,clearSkewnessTransformations:rr}=r$({skewnessData:Eo,shouldLoadInsights:Gf,skewnessTransformations:Zf,availableColumns:xn,previewColumns:fl,columnTypeMap:br,updateSkewnessTransformations:wn}),{imputerColumnOptions:Li,imputerMissingSliderMax:fm,imputerFilteredOptionCount:hm,imputerMissingFilterActive:xh}=t$({isImputerNode:x,imputerStrategies:al,availableColumns:xn,columnMissingMap:Fa,previewColumns:fl,previewColumnStats:Wd,nodeColumns:(Hi=e==null?void 0:e.data)==null?void 0:Hi.columns,imputerMissingFilter:th}),Ya=f.useMemo(()=>X.find(g=>g.name==="missing_threshold"),[X]),xa=(Ya==null?void 0:Ya.name)??null,wr=f.useMemo(()=>{if(ma===null||Number.isNaN(Number(ma)))return null;const g=Number(ma);return Math.round(g*10)/10},[ma]),au=f.useMemo(()=>{if(xa===null||wr===null)return!1;const g=Number(ge==null?void 0:ge[xa]);return!Number.isNaN(g)&&g===wr},[ge,wr,xa]),wh=ze&&!!(Ya||Kf),zs=f.useCallback((g,N)=>{g&&Re(O=>{const I={...O};return N===void 0?delete I[g]:I[g]=N,I})},[]),pm=f.useCallback((g,N)=>{if(!g)return;if(N===""){zs(g,void 0);return}const O=Number(N);Number.isNaN(O)||zs(g,O)},[zs]);f.useCallback((g,N)=>{if(!g)return;if(N===""){zs(g,void 0);return}const O=Number(N);if(!Number.isFinite(O))return;const I=Math.min(Math.max(O,0),100);zs(g,I)},[zs]),f.useCallback((g,N,O)=>{const I=String(g??"").trim();I&&Re(q=>{const oe=q.manual_bounds&&typeof q.manual_bounds=="object"&&!Array.isArray(q.manual_bounds)?{...q.manual_bounds}:{},de=oe[I]&&typeof oe[I]=="object"?{...oe[I]}:{lower:null,upper:null};if(O==="")N==="lower"?de.lower=null:de.upper=null;else{const Ce=Number(O);if(!Number.isFinite(Ce))return q;N==="lower"?de.lower=Ce:de.upper=Ce}const me=de.lower??null,ce=de.upper??null;return me===null&&ce===null?delete oe[I]:oe[I]={lower:me,upper:ce},{...q,manual_bounds:oe}})},[]),f.useCallback(g=>{const N=String(g??"").trim();N&&Re(O=>{const I=O.manual_bounds&&typeof O.manual_bounds=="object"&&!Array.isArray(O.manual_bounds)?O.manual_bounds:null;if(!I||!Object.prototype.hasOwnProperty.call(I,N))return O;const q={...I};return delete q[N],{...O,manual_bounds:q}})},[]);const Nl=f.useCallback((g,N)=>{zs(g,N)},[zs]),Sl=f.useCallback((g,N)=>{zs(g,N)},[zs]),ou=f.useCallback(g=>{Re(N=>{if((typeof(N==null?void 0:N.strategy)=="string"?N.strategy:void 0)===g)return N;const I={...N,strategy:g};return g!=="custom"&&(Object.prototype.hasOwnProperty.call(I,"custom_bins")&&delete I.custom_bins,Object.prototype.hasOwnProperty.call(I,"custom_labels")&&delete I.custom_labels),I})},[]),lu=f.useCallback((g,N,O,I)=>{Re(q=>{const oe=typeof(q==null?void 0:q[g])=="number"&&Number.isFinite(q[g])?q[g]:void 0;if(N===""){if(oe===void 0)return q;const ce={...q};return delete ce[g],ce}const de=Number(N);if(!Number.isFinite(de))return q;const me=Math.min(Math.max(Math.round(de),O),I);return oe===me?q:{...q,[g]:me}})},[]),jh=f.useCallback((g,N)=>{Re(O=>!!(O!=null&&O[g])===N?O:{...O,[g]:N})},[]),gm=f.useCallback(g=>{const N=g.trim();Re(O=>{const I=typeof(O==null?void 0:O.output_suffix)=="string"?O.output_suffix:"";if(!N){if(!I)return O;const q={...O};return delete q.output_suffix,q}return I===N?O:{...O,output_suffix:N}})},[]),Nh=f.useCallback(g=>{Re(N=>((N==null?void 0:N.duplicates)==="drop"?"drop":"raise")===g?N:{...N,duplicates:g})},[]),Sh=f.useCallback(g=>{Re(N=>{const O=typeof(N==null?void 0:N.label_format)=="string"?N.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(O)?O:"range")===g?N:{...N,label_format:g}})},[]),Ch=f.useCallback(g=>{Re(N=>{if(((N==null?void 0:N.missing_strategy)==="label"?"label":"keep")===g)return N;const I={...N,missing_strategy:g};return g!=="label"&&Object.prototype.hasOwnProperty.call(I,"missing_label")&&delete I.missing_label,I})},[]),Eh=f.useCallback(g=>{const N=g.trim();Re(O=>{const I=typeof(O==null?void 0:O.missing_label)=="string"?O.missing_label:"";if(!N){if(!I)return O;const q={...O};return delete q.missing_label,q}return I===N?O:{...O,missing_label:N}})},[]),_m=f.useCallback((g,N)=>{const O=String(g??"").trim();O&&(rm(I=>({...I,[O]:N})),Re(I=>{const q=I==null?void 0:I.custom_bins,oe=q&&typeof q=="object"&&!Array.isArray(q)?q:{},de=Array.isArray(oe[O])?oe[O]:void 0,ce=N.split(/[,\n]/).map(St=>St.trim()).filter(Boolean).map(St=>Number(St)).filter(St=>Number.isFinite(St)).sort((St,Rt)=>St-Rt).filter((St,Rt,cn)=>Rt===0||St!==cn[Rt-1]),Ce=ce.length>=2;if(Ce&&de&&de.length===ce.length&&de.every((St,Rt)=>St===ce[Rt])||!Ce&&!de)return I;const Ie={...I},wt={...oe};return Ce?wt[O]=ce:delete wt[O],Object.keys(wt).length>0?Ie.custom_bins=wt:delete Ie.custom_bins,Ie}))},[]),kh=f.useCallback((g,N)=>{const O=String(g??"").trim();O&&(am(I=>({...I,[O]:N})),Re(I=>{const q=I==null?void 0:I.custom_labels,oe=q&&typeof q=="object"&&!Array.isArray(q)?q:{},de=Array.isArray(oe[O])?oe[O]:void 0,me=N.split(/[,\n]/).map(Ie=>Ie.trim()).filter(Boolean);if(me.length>0&&de&&de.length===me.length&&de.every((Ie,wt)=>Ie===me[wt])||me.length===0&&!de)return I;const ce={...I},Ce={...oe};return me.length>0?Ce[O]=me:delete Ce[O],Object.keys(Ce).length>0?ce.custom_labels=Ce:delete ce.custom_labels,ce}))},[]),Mh=f.useCallback(g=>{const N=String(g??"").trim();N&&(rm(O=>{if(!Object.prototype.hasOwnProperty.call(O,N))return O;const I={...O};return delete I[N],I}),am(O=>{if(!Object.prototype.hasOwnProperty.call(O,N))return O;const I={...O};return delete I[N],I}),Re(O=>{let I=!1;const q={...O};if(O!=null&&O.custom_bins&&typeof O.custom_bins=="object"&&!Array.isArray(O.custom_bins)&&Object.prototype.hasOwnProperty.call(O.custom_bins,N)){const oe={...O.custom_bins};delete oe[N],Object.keys(oe).length>0?q.custom_bins=oe:delete q.custom_bins,I=!0}if(O!=null&&O.custom_labels&&typeof O.custom_labels=="object"&&!Array.isArray(O.custom_labels)&&Object.prototype.hasOwnProperty.call(O.custom_labels,N)){const oe={...O.custom_labels};delete oe[N],Object.keys(oe).length>0?q.custom_labels=oe:delete q.custom_labels,I=!0}return I?q:O}))},[]),Ah=f.useCallback(g=>{Re(N=>{const O=typeof(N==null?void 0:N.kbins_encode)=="string"?N.kbins_encode:"";return(["ordinal","onehot","onehot-dense"].includes(O)?O:"ordinal")===g?N:{...N,kbins_encode:g}})},[]),g_=f.useCallback(g=>{Re(N=>{const O=typeof(N==null?void 0:N.kbins_strategy)=="string"?N.kbins_strategy:"";return(["uniform","quantile","kmeans"].includes(O)?O:"quantile")===g?N:{...N,kbins_strategy:g}})},[]),Vr=f.useCallback(g=>{const N=String(g??"").trim();N&&Re(O=>{const I=ut(O.columns),q=I.includes(N),oe=q?I.filter(Ce=>Ce!==N):[...I,N];let de=!1,me=O.manual_bounds;q&&me&&typeof me=="object"&&!Array.isArray(me)&&Object.prototype.hasOwnProperty.call(me,N)&&(me={...me},delete me[N],de=!0);const ce={...O,columns:oe};if(de&&(ce.manual_bounds=me),J){const Ce=new Set(oe);if(O.custom_bins&&typeof O.custom_bins=="object"&&!Array.isArray(O.custom_bins)){const Ie={};Object.entries(O.custom_bins).forEach(([wt,St])=>{Ce.has(wt)&&Array.isArray(St)&&St.length&&(Ie[wt]=[...St])}),Object.keys(Ie).length?ce.custom_bins=Ie:"custom_bins"in ce&&delete ce.custom_bins}else"custom_bins"in ce&&delete ce.custom_bins;if(O.custom_labels&&typeof O.custom_labels=="object"&&!Array.isArray(O.custom_labels)){const Ie={};Object.entries(O.custom_labels).forEach(([wt,St])=>{Ce.has(wt)&&Array.isArray(St)&&St.length&&(Ie[wt]=St.map(Rt=>String(Rt)))}),Object.keys(Ie).length?ce.custom_labels=Ie:"custom_labels"in ce&&delete ce.custom_labels}else"custom_labels"in ce&&delete ce.custom_labels}if(te){let Ce=null;O.column_methods&&typeof O.column_methods=="object"&&!Array.isArray(O.column_methods)&&(Ce={},Object.entries(O.column_methods).forEach(([Ie,wt])=>{const St=typeof wt=="string"?wt.trim():null;!St||!qs.includes(St)||q&&Ie===N||(Ce[Ie]=St)})),Ce&&Object.keys(Ce).length?ce.column_methods=Ce:q&&Object.prototype.hasOwnProperty.call(ce,"column_methods")&&delete ce.column_methods}return ce})},[J,te]),Oh=f.useCallback(()=>{xo.length&&Re(g=>{const N=new Set(ut(g.columns));return xo.forEach(O=>{O!=null&&O.name&&N.add(String(O.name))}),{...g,columns:Array.from(N)}})},[xo]),__=f.useCallback(g=>{g.length&&Re(N=>{const O=new Set(ut(N.columns));g.forEach(q=>{const oe=String(q??"").trim();oe&&O.add(oe)});const I=Array.from(O).sort((q,oe)=>q.localeCompare(oe));return{...N,columns:I}})},[]),Ph=f.useCallback(g=>{g.length&&Re(N=>{const O=new Set(ut(N.columns));let I=!1;g.forEach(de=>{const me=String(de??"").trim();if(me&&(O.add(me),!I)){const ce=Lc.find(Ce=>Ce.column===me);ce!=null&&ce.recommended_use_global_fallback&&(I=!0)}});const q=Array.from(O).sort((de,me)=>de.localeCompare(me)),oe={...N,columns:q};return I&&(ca.current=!0,oe.encode_missing=!0,oe.handle_unknown="global_mean"),oe})},[Lc]),Th=f.useCallback(g=>{g.length&&Re(N=>{const O=new Set(ut(N.columns));let I=0;g.forEach(de=>{const me=String(de??"").trim();if(!me)return;O.add(me);const ce=zc.find(Ce=>Ce.column===me);ce&&ce.recommended_bucket_count>I&&(I=ce.recommended_bucket_count)});const q=Array.from(O).sort((de,me)=>de.localeCompare(me)),oe={...N,columns:q};if(I>0){const de=Number(N==null?void 0:N.n_buckets);(!Number.isFinite(de)||de<=0)&&(oe.n_buckets=I)}return oe})},[zc]),$h=f.useCallback(g=>{g.length&&Re(N=>{const O=new Set(ut(N.columns));let I=!1,q=!1;g.forEach(me=>{const ce=String(me??"").trim();if(ce&&(O.add(ce),!I||!q)){const Ce=Br.find(Ie=>Ie.column===ce);Ce!=null&&Ce.recommended_handle_unknown&&(I=!0),((Ce==null?void 0:Ce.missing_percentage)??0)>0&&(q=!0)}});const oe=Array.from(O).sort((me,ce)=>me.localeCompare(ce)),de={...N,columns:oe};return I&&(de.handle_unknown="use_encoded_value"),q&&(de.encode_missing=!0),de})},[Br]),iu=f.useCallback(g=>{g.length&&Re(N=>{const O=new Set(ut(N.columns));let I=(N==null?void 0:N.drop_first)===!0;g.forEach(de=>{const me=String(de??"").trim();if(me&&(O.add(me),!I)){const ce=Bd.find(Ce=>Ce.column===me);ce!=null&&ce.recommended_drop_first&&(I=!0)}});const q=Array.from(O).sort((de,me)=>de.localeCompare(me)),oe={...N,columns:q};return I&&(oe.drop_first=!0),oe})},[Bd]),v_=f.useCallback(g=>{g.length&&Re(N=>{const O=new Set(ut(N.columns));let I=!1;g.forEach(de=>{const me=String(de??"").trim();if(me&&(O.add(me),!I)){const ce=Rc.find(Ce=>Ce.column===me);ce!=null&&ce.recommended_drop_first&&(I=!0)}});const q=Array.from(O).sort((de,me)=>de.localeCompare(me)),oe={...N,columns:q};return I&&(oe.drop_first=!0),oe})},[Rc]),Dh=f.useCallback(()=>{xn.length&&Re(g=>{const N=new Set(ut(g.columns));return xn.filter(I=>J?!is.has(I):te?!Ls.has(I):!0).forEach(I=>N.add(I)),{...g,columns:Array.from(N).sort((I,q)=>I.localeCompare(q))}})},[xn,is,J,te,Ls]),y_=f.useCallback(g=>{Hs.includes(g)&&Re(N=>(N==null?void 0:N.default_method)===g?N:{...N,default_method:g})},[Re]),jr=f.useCallback(g=>{Re(N=>(typeof(N==null?void 0:N.auto_detect)=="boolean"?N.auto_detect:!0)===g?N:{...N,auto_detect:g})},[Re]),zi=f.useCallback((g,N)=>{const O=String(g??"").trim();O&&Re(I=>{if(!I||typeof I!="object")return I;const q=ut(I.columns),oe=new Set(q),de=I.column_methods&&typeof I.column_methods=="object"&&!Array.isArray(I.column_methods)?{...I.column_methods}:{};let me=!1;if(N){if(!Hs.includes(N))return I;de[O]!==N&&(de[O]=N,me=!0),oe.has(O)||(oe.add(O),me=!0)}else Object.prototype.hasOwnProperty.call(de,O)&&(delete de[O],me=!0);if(!me)return I;const ce={...I};return ce.columns=Array.from(oe).sort((Ce,Ie)=>Ce.localeCompare(Ie)),Object.keys(de).length?ce.column_methods=de:Object.prototype.hasOwnProperty.call(ce,"column_methods")&&delete ce.column_methods,ce})},[Re]),cu=f.useCallback(()=>{Re(g=>{if(!g||typeof g!="object")return g;const N=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)&&Object.keys(g.column_methods).length>0,O=g.column_parameters&&typeof g.column_parameters=="object"&&!Array.isArray(g.column_parameters)&&Object.keys(g.column_parameters).length>0;if(!N&&!O)return g;const I={...g};return N&&delete I.column_methods,O&&delete I.column_parameters,I})},[Re]),Lh=f.useCallback(()=>{ya.length&&Re(g=>{if(!g||typeof g!="object")return g;const N=new Set(ut(g.columns)),O=new Set(ut(g.skipped_columns)),I=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{},q=g.column_parameters&&typeof g.column_parameters=="object"&&!Array.isArray(g.column_parameters)?{...g.column_parameters}:{};let oe=!1;if(ya.forEach(me=>{if(!me||me.isExcluded||!me.recommendedMethod)return;const ce=String(me.column??"").trim();if(!ce||Xc.has(ce))return;const Ce=me.recommendedMethod;Hs.includes(Ce)&&(O.has(ce)&&(O.delete(ce),oe=!0),N.has(ce)||(N.add(ce),oe=!0),Ce===qr.defaultMethod?Object.prototype.hasOwnProperty.call(I,ce)&&(delete I[ce],oe=!0):I[ce]!==Ce&&(I[ce]=Ce,oe=!0),Object.prototype.hasOwnProperty.call(q,ce)&&(delete q[ce],oe=!0))}),!oe)return g;const de={...g,columns:Array.from(N).sort((me,ce)=>me.localeCompare(ce))};return O.size?de.skipped_columns=Array.from(O).sort((me,ce)=>me.localeCompare(ce)):Object.prototype.hasOwnProperty.call(de,"skipped_columns")&&delete de.skipped_columns,Object.keys(I).length?de.column_methods=I:Object.prototype.hasOwnProperty.call(de,"column_methods")&&delete de.column_methods,Object.keys(q).length?de.column_parameters=q:Object.prototype.hasOwnProperty.call(de,"column_parameters")&&delete de.column_parameters,de})},[qr.defaultMethod,Xc,ya,Re]),vm=f.useCallback(g=>{const N=String(g??"").trim();N&&Re(O=>{if(!O||typeof O!="object")return O;const I=ut(O.columns),q=I.filter(cn=>cn!==N),oe=new Set(ut(O.skipped_columns)),de=oe.size;oe.add(N);const me=de!==oe.size,ce=O.column_methods&&typeof O.column_methods=="object"&&!Array.isArray(O.column_methods)?{...O.column_methods}:{},Ce=Object.prototype.hasOwnProperty.call(ce,N);Ce&&delete ce[N];const Ie=O.column_parameters&&typeof O.column_parameters=="object"&&!Array.isArray(O.column_parameters)?{...O.column_parameters}:{},wt=Object.prototype.hasOwnProperty.call(Ie,N);if(wt&&delete Ie[N],!(q.length!==I.length)&&!me&&!Ce&&!wt)return O;const Rt={...O,columns:q.sort((cn,qn)=>cn.localeCompare(qn)),skipped_columns:Array.from(oe).sort((cn,qn)=>cn.localeCompare(qn))};return Object.keys(ce).length?Rt.column_methods=ce:Object.prototype.hasOwnProperty.call(Rt,"column_methods")&&delete Rt.column_methods,Object.keys(Ie).length?Rt.column_parameters=Ie:Object.prototype.hasOwnProperty.call(Rt,"column_parameters")&&delete Rt.column_parameters,Rt})},[Re]),uu=f.useCallback(g=>{const N=String(g??"").trim();N&&Re(O=>{if(!O||typeof O!="object")return O;const I=ut(O.skipped_columns);if(!I.includes(N))return O;const q=I.filter(me=>me!==N),oe=new Set(ut(O.columns));oe.has(N)||oe.add(N);const de={...O,columns:Array.from(oe).sort((me,ce)=>me.localeCompare(ce))};return q.length?de.skipped_columns=q.sort((me,ce)=>me.localeCompare(ce)):Object.prototype.hasOwnProperty.call(de,"skipped_columns")&&delete de.skipped_columns,de})},[Re]),ym=f.useCallback((g,N)=>{if(N==="__skip__"){vm(g);return}if(N==="__default__"){uu(g),zi(g,null);return}Hs.includes(N)&&(uu(g),zi(g,N))},[vm,uu,zi]),Cl=f.useCallback((g,N,O)=>{const I=String(N??"").trim().toLowerCase();Re(q=>{if(!q||typeof q!="object")return q;const oe=q.method_parameters&&typeof q.method_parameters=="object"&&!Array.isArray(q.method_parameters)?{...q.method_parameters}:{},de={...oe[g]??{}},me=typeof O=="number"&&Number.isFinite(O)?O:null;let ce=!1;if(me===null?Object.prototype.hasOwnProperty.call(de,I)&&(delete de[I],ce=!0):de[I]!==me&&(de[I]=me,ce=!0),!ce)return q;if(Object.keys(de).length?oe[g]=de:delete oe[g],!Object.keys(oe).length){const Ce={...q};return Object.prototype.hasOwnProperty.call(Ce,"method_parameters")&&delete Ce.method_parameters,Ce}return{...q,method_parameters:oe}})},[Re]),bm=f.useCallback((g,N,O)=>{const I=String(g??"").trim();if(!I)return;const q=String(N??"").trim().toLowerCase();Re(oe=>{if(!oe||typeof oe!="object")return oe;const de=oe.column_parameters&&typeof oe.column_parameters=="object"&&!Array.isArray(oe.column_parameters)?{...oe.column_parameters}:{},me={...de[I]??{}},ce=typeof O=="number"&&Number.isFinite(O)?O:null;let Ce=!1;if(ce===null?Object.prototype.hasOwnProperty.call(me,q)&&(delete me[q],Ce=!0):me[q]!==ce&&(me[q]=ce,Ce=!0),!Ce)return oe;if(Object.keys(me).length?de[I]=me:delete de[I],!Object.keys(de).length){const Ie={...oe};return Object.prototype.hasOwnProperty.call(Ie,"column_parameters")&&delete Ie.column_parameters,Ie}return{...oe,column_parameters:de}})},[Re]),xm=f.useCallback(g=>{qs.includes(g)&&Re(N=>(N==null?void 0:N.default_method)===g?N:{...N,default_method:g})},[Re]),b_=f.useCallback(g=>{Re(N=>(typeof(N==null?void 0:N.auto_detect)=="boolean"?N.auto_detect:!0)===g?N:{...N,auto_detect:g})},[Re]),du=f.useCallback((g,N)=>{const O=String(g??"").trim();O&&Re(I=>{const q=ut(I.columns),oe=q.includes(O),de=I.column_methods&&typeof I.column_methods=="object"&&!Array.isArray(I.column_methods)?{...I.column_methods}:{};if(N){if(!qs.includes(N))return I;const Ce=(de[O]??null)!==N,Ie=!oe;if(!Ce&&!Ie)return I;de[O]=N;const wt=Ie?[...q,O].sort((St,Rt)=>St.localeCompare(Rt)):q;return{...I,columns:wt,column_methods:de}}if(!Object.prototype.hasOwnProperty.call(de,O))return I;if(delete de[O],Object.keys(de).length)return{...I,column_methods:de};const me={...I};return Object.prototype.hasOwnProperty.call(me,"column_methods")&&delete me.column_methods,me})},[Re]),zh=f.useCallback(()=>{Re(g=>{if(!g.column_methods||typeof g.column_methods!="object"||Array.isArray(g.column_methods)||!Object.keys(g.column_methods).length)return g;const N={...g};return delete N.column_methods,N})},[Re]),Rh=f.useCallback(()=>{Oo.length&&Re(g=>{const N=ut(g.columns),O=new Set(N),I=new Set(ut(g.skipped_columns)),q=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{};let oe=!1;if(Oo.forEach(me=>{const ce=String(me.column??"").trim(),Ce=me.recommended_method;!ce||!qs.includes(Ce)||I.has(ce)||(q[ce]!==Ce&&(q[ce]=Ce,oe=!0),O.has(ce)||(O.add(ce),oe=!0))}),!oe)return g;const de=Array.from(O).sort((me,ce)=>me.localeCompare(ce));return{...g,columns:de,column_methods:q}})},[Oo,Re]),wm=f.useCallback(g=>{const N=String(g??"").trim();N&&Re(O=>{const I=ut(O.columns),q=I.filter(Ie=>Ie!==N),oe=new Set(ut(O.skipped_columns)),de=oe.size;oe.add(N);const me=oe.size!==de,ce=O.column_methods&&typeof O.column_methods=="object"&&!Array.isArray(O.column_methods)?{...O.column_methods}:{},Ce=Object.prototype.hasOwnProperty.call(ce,N);return Ce&&delete ce[N],!me&&q.length===I.length&&!Ce?O:{...O,columns:q.sort((Ie,wt)=>Ie.localeCompare(wt)),column_methods:ce,skipped_columns:Array.from(oe).sort((Ie,wt)=>Ie.localeCompare(wt))}})},[Re]),mu=f.useCallback(g=>{const N=String(g??"").trim();N&&Re(O=>{const I=ut(O.skipped_columns);if(!I.includes(N))return O;const q=new Set(I);q.delete(N);const oe=new Set(ut(O.columns));return oe.has(N)||oe.add(N),{...O,columns:Array.from(oe).sort((me,ce)=>me.localeCompare(ce)),skipped_columns:Array.from(q).sort((me,ce)=>me.localeCompare(ce))}})},[Re]),x_=f.useCallback((g,N)=>{if(N==="__skip__"){wm(g);return}if(N==="__default__"){mu(g),du(g,null);return}qs.includes(N)&&(mu(g),du(g,N))},[wm,mu,du]);f.useEffect(()=>{Oo.length&&(Po||Re(g=>{const N=new Set(ut(g.skipped_columns)),O=new Set(ut(g.columns)),I=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{};let q=!1;return Oo.forEach(oe=>{const de=String(oe.column??"").trim();if(!de||N.has(de))return;O.has(de)||(O.add(de),q=!0);const me=oe.recommended_method;qs.includes(me)&&!Object.prototype.hasOwnProperty.call(I,de)&&me!==_l.defaultMethod&&(I[de]=me,q=!0)}),q?{...g,columns:Array.from(O).sort((oe,de)=>oe.localeCompare(de)),column_methods:I}:g}))},[Po,_l.defaultMethod,Oo,Re]);const ws=f.useCallback(()=>{Re(g=>{const N={...g,columns:[]};return g!=null&&g.manual_bounds&&typeof g.manual_bounds=="object"&&!Array.isArray(g.manual_bounds)&&Object.keys(g.manual_bounds).length&&(N.manual_bounds={}),J&&("custom_bins"in N&&delete N.custom_bins,"custom_labels"in N&&delete N.custom_labels),te&&"column_methods"in N&&delete N.column_methods,N})},[J,te]),cs=f.useCallback(g=>{const N=String(g??"").trim();N&&Re(O=>{const I=ut(O.columns);if(!I.includes(N))return O;const q=I.filter(ce=>ce!==N);let oe=!1,de=O.manual_bounds;de&&typeof de=="object"&&!Array.isArray(de)&&Object.prototype.hasOwnProperty.call(de,N)&&(de={...de},delete de[N],oe=!0);const me={...O,columns:q};if(oe&&(me.manual_bounds=de),J){if(O.custom_bins&&typeof O.custom_bins=="object"&&!Array.isArray(O.custom_bins)){const ce={};Object.entries(O.custom_bins).forEach(([Ce,Ie])=>{Ce!==N&&Array.isArray(Ie)&&Ie.length&&(ce[Ce]=[...Ie])}),Object.keys(ce).length?me.custom_bins=ce:"custom_bins"in me&&delete me.custom_bins}else"custom_bins"in me&&delete me.custom_bins;if(O.custom_labels&&typeof O.custom_labels=="object"&&!Array.isArray(O.custom_labels)){const ce={};Object.entries(O.custom_labels).forEach(([Ce,Ie])=>{Ce!==N&&Array.isArray(Ie)&&Ie.length&&(ce[Ce]=Ie.map(wt=>String(wt)))}),Object.keys(ce).length?me.custom_labels=ce:"custom_labels"in me&&delete me.custom_labels}else"custom_labels"in me&&delete me.custom_labels}if(te)if(O.column_methods&&typeof O.column_methods=="object"&&!Array.isArray(O.column_methods)){const ce={};Object.entries(O.column_methods).forEach(([Ce,Ie])=>{const wt=typeof Ie=="string"?Ie.trim():null;!wt||!qs.includes(wt)||Ce!==N&&(ce[Ce]=wt)}),Object.keys(ce).length?me.column_methods=ce:Object.prototype.hasOwnProperty.call(me,"column_methods")&&delete me.column_methods}else Object.prototype.hasOwnProperty.call(me,"column_methods")&&delete me.column_methods;return me})},[J,te]),jm=f.useCallback(()=>{wr===null||!xa||zs(xa,wr)},[zs,wr,xa]),Nr=f.useCallback(()=>{if(!xt||!Te)return;const g=Eg(d??{});D&&(ca.current=!1),Re(g),u==null||u(Te,g)},[xt,d,D,Te,u,ca]),fu=f.useCallback(()=>{let g=Eg(ge);if(J){const N=wx(g);g={...g,strategy:N.strategy,columns:N.columns,equal_width_bins:N.equalWidthBins,equal_frequency_bins:N.equalFrequencyBins,include_lowest:N.includeLowest,precision:N.precision,duplicates:N.duplicates,output_suffix:N.outputSuffix,drop_original:N.dropOriginal,label_format:N.labelFormat,missing_strategy:N.missingStrategy},N.missingStrategy==="label"?g.missing_label=N.missingLabel:Object.prototype.hasOwnProperty.call(g,"missing_label")&&delete g.missing_label,Object.keys(N.customBins).length?g.custom_bins=N.customBins:Object.prototype.hasOwnProperty.call(g,"custom_bins")&&delete g.custom_bins,Object.keys(N.customLabels).length?g.custom_labels=N.customLabels:Object.prototype.hasOwnProperty.call(g,"custom_labels")&&delete g.custom_labels}n(e.id,g),t(),l&&i&&!ht&&(r&&r(e.id,{backgroundExecutionStatus:"loading"}),px({dataset_source_id:l,graph:{nodes:i.nodes||[],edges:i.edges||[]},target_node_id:e.id}).then(()=>{r&&r(e.id,{backgroundExecutionStatus:"success"})}).catch(N=>{r&&r(e.id,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",N)}))},[ge,J,e.id,t,n,r,l,i,ht]),Nm=wr!==null&&!au,hu=ln.length,pu=fr(l_),Fh=fr((Js==null?void 0:Js.generated_at)??null),Sm=fr((An==null?void 0:An.generated_at)??null),Cm=Number(Js==null?void 0:Js.sample_size),Ih=Number.isFinite(Cm)?Math.max(0,Math.round(Cm)):null,gu=Number(An==null?void 0:An.sample_size),Em=Number.isFinite(gu)?Math.max(0,Math.round(gu)):null,_u=o_&&!!l&&bt,vu=!Be&&!ht,yu=vu&&Xf!==t_,km=u_.status==="loading",bu=Et.status==="loading",xu=km||bu||Ia||Ei||Zs||qc||Fr,wu=f.useMemo(()=>km?"Generating dataset profile":Ia?"Loading scaling insights":Ei?"Loading hash encoding insights":Zs?"Loading skewness insights":qc?"Computing binned distributions":Fr?"Fetching column recommendations":bu?fa?"Loading dataset preview":"Analyzing node outputs":null,[qc,Fr,Ia,Ei,Zs,bu,km,fa])??(xu?"Processing":null),Fn=f.useCallback(g=>{Re(N=>{const O=Sx(N==null?void 0:N.strategies,st),I=g(O).map(q=>({...q,options:td(q.method,q.options)}));return{...N,strategies:NM(I)}})},[st]),ar=f.useCallback(g=>{S&&Re(N=>{var St,Rt,cn,qn,At,ss,Es,Is,Xa;if(!S)return N;const O=ut((N==null?void 0:N.columns)??((Rt=(St=e==null?void 0:e.data)==null?void 0:St.config)==null?void 0:Rt.columns)),I=Sf(N==null?void 0:N.mode,(qn=(cn=e==null?void 0:e.data)==null?void 0:cn.config)==null?void 0:qn.mode),q=(()=>{var Vt;const Sn=mc(N);if(Sn!==void 0){const Er=Ql(Sn);if(Er!==null)return Er}const kt=mc((Vt=e==null?void 0:e.data)==null?void 0:Vt.config);if(kt!==void 0){const Er=Ql(kt);if(Er!==null)return Er}return O.length===0})(),oe=(N==null?void 0:N.alias_strategies)??(N==null?void 0:N.strategies)??((ss=(At=e==null?void 0:e.data)==null?void 0:At.config)==null?void 0:ss.alias_strategies)??((Is=(Es=e==null?void 0:e.data)==null?void 0:Es.config)==null?void 0:Is.strategies),de=$x(oe,{mode:I,columns:O,autoDetect:q}),me=g(de).map(Sn=>({mode:Sf(Sn.mode,I),columns:Array.from(new Set(Sn.columns.map(kt=>kt.trim()).filter(Boolean))).sort((kt,Vt)=>kt.localeCompare(Vt)),autoDetect:!!Sn.autoDetect})),ce=ZM(me),Ce=Array.from(new Set(me.flatMap(Sn=>Sn.columns))).sort((Sn,kt)=>Sn.localeCompare(kt)),Ie=((Xa=me[0])==null?void 0:Xa.mode)??I,wt=me.length?me.some(Sn=>Sn.autoDetect):q;return{...N,alias_strategies:ce,columns:Ce,mode:Ie,auto_detect:wt}})},[S,(Al=e==null?void 0:e.data)==null?void 0:Al.config]),Rs=f.useCallback(g=>{Re(N=>{var Ie,wt,St,Rt,cn,qn,At;if(!A)return N;const O=ut((N==null?void 0:N.columns)??((wt=(Ie=e==null?void 0:e.data)==null?void 0:Ie.config)==null?void 0:wt.columns)),I=Vx(N==null?void 0:N.mode,(Rt=(St=e==null?void 0:e.data)==null?void 0:St.config)==null?void 0:Rt.mode),q=O.length===0,oe=Wx((N==null?void 0:N.format_strategies)??((qn=(cn=e==null?void 0:e.data)==null?void 0:cn.config)==null?void 0:qn.format_strategies),{columns:O,mode:I,autoDetect:q}),de=g(oe),me=CA(de),ce=Array.from(new Set(de.flatMap(ss=>ss.columns.map(Es=>Es.trim()).filter(Boolean)))).sort((ss,Es)=>ss.localeCompare(Es)),Ce=((At=de[0])==null?void 0:At.mode)??I;return{...N,format_strategies:me,columns:ce,mode:Ce}})},[A,(Vi=(Mu=e==null?void 0:e.data)==null?void 0:Mu.config)==null?void 0:Vi.columns,(ms=(Wi=e==null?void 0:e.data)==null?void 0:Wi.config)==null?void 0:ms.format_strategies,(lr=(Na=e==null?void 0:e.data)==null?void 0:Na.config)==null?void 0:lr.mode]),Mm=f.useCallback(()=>{l&&mh()},[mh,l]),Bh=f.useMemo(()=>{if(!xe)return[];const N=(Array.isArray(An==null?void 0:An.columns)?An==null?void 0:An.columns:[]).map(O=>{if(!O||!O.column)return null;const I=Number(O.total_rows),q=Number.isFinite(I)?Math.max(0,Math.round(I)):0;if(q<=0)return null;const de=(Array.isArray(O.bins)?O.bins:[]).map(kt=>{if(!kt)return null;const Er=(typeof kt.label=="string"?kt.label.trim():String(kt.label??""))||(kt.is_missing?"Missing":"Unlabeled bin"),Lo=Number(kt.count);if(!Number.isFinite(Lo))return null;const Au=Math.max(0,Math.round(Lo)),Ol=Number(kt.percentage),Ou=Number.isFinite(Ol)?Math.min(100,Math.max(0,Ol)):0,Pu=Number(Ou.toFixed(2));return{label:Er,count:Au,percentage:Pu,isMissing:!!kt.is_missing}}).filter(kt=>!!kt);if(!de.length)return null;de.sort((kt,Vt)=>kt.isMissing!==Vt.isMissing?kt.isMissing?1:-1:kt.count!==Vt.count?Vt.count-kt.count:kt.label.localeCompare(Vt.label));const me=de.length,ce=12,Ce=me>ce,Ie=Ce?de.slice(0,ce):de,wt=Number(O.missing_rows),St=Number.isFinite(wt)?Math.max(0,Math.round(wt)):0,Rt=Number(O.distinct_bins),cn=Number.isFinite(Rt)?Math.max(0,Math.round(Rt)):de.length,qn=O.top_label;let At=typeof qn=="string"?qn.trim()||null:qn??null;const ss=Number(O.top_count);let Es=Number.isFinite(ss)?Math.max(0,Math.round(ss)):null;const Is=Number(O.top_percentage);let Xa=Number.isFinite(Is)?Number(Math.min(100,Math.max(0,Is)).toFixed(2)):null;(At===null||Es===null||Xa===null)&&Ie.length&&(At=Ie[0].label,Es=Ie[0].count,Xa=Ie[0].percentage);const Sn=typeof O.source_column=="string"?O.source_column.trim()||null:O.source_column??null;return{column:O.column,sourceColumn:Sn,totalRows:q,missingRows:St,distinctBins:cn,topLabel:At,topCount:Es,topPercentage:Xa,bins:Ie,hasMoreBins:Ce,totalBinCount:me}}).filter(O=>!!O);return N.sort((O,I)=>{const q=(I.topCount??0)-(O.topCount??0);return q!==0?q:O.column.localeCompare(I.column)}),N},[An,xe]),Uh=f.useCallback(()=>{var O;const g=Jf,N=((O=Ke[0])==null?void 0:O.value)??"mean";Fn(I=>[...I,{method:N,columns:[],options:td(N,Nx(N))}]),bs(I=>{const q=new Set(I);return q.delete(g),q})},[Ke,Jf,Fn]),Ri=f.useCallback(g=>{Fn(N=>N.filter((O,I)=>I!==g)),bs(N=>{const O=new Set;return N.forEach(I=>{I!==g&&O.add(I>g?I-1:I)}),O})},[Fn]),us=f.useCallback(g=>{bs(N=>{const O=new Set(N);return O.has(g)?O.delete(g):O.add(g),O})},[]),j_=f.useCallback((g,N)=>{Fn(O=>O.map((I,q)=>q===g?{...I,method:N,options:td(N,I.options)}:I))},[Fn]),N_=f.useCallback((g,N,O)=>{Fn(I=>I.map((q,oe)=>{if(oe!==g)return q;const de={...q.options??{}};if(O==="")delete de[N];else{const me=Number(O);if(!Number.isFinite(me))return q;de[N]=me}return{...q,options:td(q.method,de)}}))},[Fn]),ju=f.useCallback((g,N)=>{const O=N.split(",").map(I=>I.trim()).filter(Boolean);Fn(I=>I.map((q,oe)=>oe===g?{...q,columns:O}:q))},[Fn]),ds=f.useCallback((g,N)=>{const O=N.trim();O&&Fn(I=>I.map((q,oe)=>{if(oe!==g)return q;const me=q.columns.includes(O)?q.columns.filter(ce=>ce!==O):[...q.columns,O];return me.sort((ce,Ce)=>ce.localeCompare(Ce)),{...q,columns:me}}))},[Fn]),S_=f.useCallback(g=>{$d(g)},[$d]),at=f.useCallback(()=>{const g=Oi.length;Rs(N=>{var de;const O=new Set;N.forEach(me=>{me.columns.forEach(ce=>{const Ce=ce.trim();Ce&&O.add(Ce)})});const I=xs.recommendedColumns.find(me=>!O.has(me)),oe={mode:N.length?N[N.length-1].mode:((de=xg[0])==null?void 0:de.value)??Yd,columns:I?[I]:[],autoDetect:!I};return[...N,oe]}),bs(N=>{const O=new Set(N);return O.delete(g),O})},[Oi.length,bs,xs.recommendedColumns,Yd,Rs]),El=f.useCallback(g=>{Rs(N=>N.filter((O,I)=>I!==g)),bs(N=>{const O=new Set;return N.forEach(I=>{I!==g&&O.add(I>g?I-1:I)}),O})},[bs,Rs]),Am=f.useCallback(g=>{bs(N=>{const O=new Set(N);return O.has(g)?O.delete(g):O.add(g),O})},[]),qh=f.useCallback((g,N)=>{Rs(O=>O.map((I,q)=>q===g?{...I,mode:N}:I))},[Rs]),C_=f.useCallback((g,N)=>{const O=N.split(",").map(I=>I.trim()).filter(Boolean).sort((I,q)=>I.localeCompare(q));Rs(I=>I.map((q,oe)=>oe===g?{...q,columns:O}:q))},[Rs]),Fi=f.useCallback((g,N)=>{const O=N.trim();O&&Rs(I=>I.map((q,oe)=>{if(oe!==g)return q;const me=q.columns.includes(O)?q.columns.filter(ce=>ce!==O):[...q.columns,O];return me.sort((ce,Ce)=>ce.localeCompare(Ce)),{...q,columns:me}}))},[Rs]),Nu=f.useCallback((g,N)=>{Rs(O=>O.map((I,q)=>q===g?{...I,autoDetect:N}:I))},[Rs]),or=f.useCallback(g=>{Re(N=>{if(!Q)return N;const O=N&&typeof N=="object"&&!Array.isArray(N)?{...N}:{},I=k0(Array.isArray(N==null?void 0:N.operations)?N.operations:[]),q=g(I);return O.operations=EP(q),O})},[Q,Re]),Hh=f.useCallback(g=>{if(!Q)return;let N="";or(O=>{const I=new Set(O.map(oe=>oe.id)),q=M0(g,I);return N=q.id,[...O,q]}),N&&Ts(O=>{const I=new Set(O);return I.delete(N),I})},[Q,Ts,or]),Vh=f.useCallback(g=>{if(!Q)return;let N="";or(O=>{const I=O.findIndex(Ce=>Ce.id===g);if(I===-1)return O;const q=O[I],oe=new Set(O.map(Ce=>Ce.id)),de=M0(q.type,oe);N=de.id;const me={...q,id:de.id,inputColumns:[...q.inputColumns],secondaryColumns:[...q.secondaryColumns],constants:[...q.constants],datetimeFeatures:[...q.datetimeFeatures],outputColumn:q.outputColumn?`${q.outputColumn}_copy`:""},ce=[...O];return ce.splice(I+1,0,me),ce}),N&&Ts(O=>{const I=new Set(O);return I.delete(N),I})},[Q,Ts,or]),Wh=f.useCallback(g=>{Q&&(or(N=>N.filter(O=>O.id!==g)),Ts(N=>{const O=new Set(N);return O.delete(g),O}))},[Q,Ts,or]),Om=f.useCallback((g,N)=>{Q&&or(O=>{const I=O.findIndex(me=>me.id===g);if(I===-1)return O;const q=N==="up"?I-1:I+1;if(q<0||q>=O.length)return O;const oe=[...O],[de]=oe.splice(I,1);return oe.splice(q,0,de),oe})},[Q,or]),Pm=f.useCallback(g=>{Ts(N=>{const O=new Set(N);return O.has(g)?O.delete(g):O.add(g),O})},[]),ns=f.useCallback((g,N)=>{Q&&or(O=>O.map(I=>{if(I.id!==g)return I;let q={...I};if(N.type&&(q.type=N.type),N.method!==void 0&&(q.method=N.method),N.inputColumns!==void 0&&(q.inputColumns=gd(N.inputColumns)),N.secondaryColumns!==void 0&&(q.secondaryColumns=gd(N.secondaryColumns)),N.constants!==void 0&&(q.constants=gw(N.constants)),N.outputColumn!==void 0&&(q.outputColumn=N.outputColumn.trim()),N.outputPrefix!==void 0&&(q.outputPrefix=N.outputPrefix.trim()),N.datetimeFeatures!==void 0&&(q.datetimeFeatures=_w(N.datetimeFeatures)),N.timezone!==void 0&&(q.timezone=yw(N.timezone)),N.fillna!==void 0&&(q.fillna=_d(N.fillna)),N.roundDigits!==void 0&&(q.roundDigits=vw(N.roundDigits)),N.normalize!==void 0&&(q.normalize=N.normalize),N.epsilon!==void 0&&(q.epsilon=_d(N.epsilon)),N.allowOverwrite!==void 0&&(q.allowOverwrite=N.allowOverwrite),N.description!==void 0){const me=typeof N.description=="string"?N.description.trim():"";q.description=me||void 0}const oe=q.type,de=A0(oe);return de.length?new Set(de.map(ce=>ce.value)).has(q.method)||(q.method=de[0].value):oe==="ratio"?q.method="ratio":oe==="datetime_extract"&&(q.method="datetime_extract"),q.inputColumns=gd(q.inputColumns),oe==="ratio"||oe==="similarity"?q.secondaryColumns=gd(q.secondaryColumns):q.secondaryColumns=[],q.constants=gw(q.constants),q.fillna=_d(q.fillna),q.roundDigits=vw(q.roundDigits),q.epsilon=_d(q.epsilon),oe==="datetime_extract"?(q.datetimeFeatures=_w(q.datetimeFeatures),q.timezone=yw(q.timezone)):(q.datetimeFeatures=[],q.timezone="UTC"),oe!=="similarity"?q.normalize=!1:q.normalize=!!q.normalize,typeof q.allowOverwrite!="boolean"&&(q.allowOverwrite=null),q.outputColumn=q.outputColumn.trim(),q.outputPrefix=q.outputPrefix.trim(),q}))},[Q,or]),Sr=f.useCallback(()=>{if(!S)return;const g=ts;ar(N=>{var de;const O=new Set;N.forEach(me=>{me.columns.forEach(ce=>{const Ce=ce.trim();Ce&&O.add(Ce)})});const I=ls.recommendedColumns.find(me=>!O.has(me)),oe={mode:N.length?N[N.length-1].mode:((de=Px[0])==null?void 0:de.value)??_g,columns:I?[I]:[],autoDetect:!I};return[...N,oe]}),bs(N=>{const O=new Set(N);return O.delete(g),O})},[ls.recommendedColumns,ts,S,bs,ar]),Qa=f.useCallback(g=>{ar(N=>N.filter((O,I)=>I!==g)),bs(N=>{const O=new Set;return N.forEach(I=>{I!==g&&O.add(I>g?I-1:I)}),O})},[bs,ar]),Kh=f.useCallback(g=>{bs(N=>{const O=new Set(N);return O.has(g)?O.delete(g):O.add(g),O})},[]),Yh=f.useCallback((g,N)=>{ar(O=>O.map((I,q)=>q===g?{...I,mode:N}:I))},[ar]),Cr=f.useCallback((g,N)=>{const O=N.trim();O&&ar(I=>I.map((q,oe)=>{if(oe!==g)return q;const me=q.columns.includes(O)?q.columns.filter(ce=>ce!==O):[...q.columns,O];return me.sort((ce,Ce)=>ce.localeCompare(Ce)),{...q,columns:me}}))},[ar]),Qh=f.useCallback((g,N)=>{const O=N.split(",").map(q=>q.trim()).filter(Boolean),I=Array.from(new Set(O)).sort((q,oe)=>q.localeCompare(oe));ar(q=>q.map((oe,de)=>de===g?{...oe,columns:I}:oe))},[ar]),Wr=f.useCallback((g,N)=>{ar(O=>O.map((I,q)=>q===g?{...I,autoDetect:N}:I))},[ar]),Kr=f.useCallback(g=>{var qn;const N=((qn=g==null?void 0:g.source)==null?void 0:qn.type)==="drop_column_recommendations",O=!N,I=O&&Et.status==="loading",q=J&&g.name==="columns",oe=te&&g.name==="columns",de=q?xn.filter(At=>!is.has(At)):oe?xn.filter(At=>!Ls.has(At)):xn,me=q?wl.filter(At=>!is.has(At)):oe?wl.filter(At=>!Ls.has(At)):wl,ce=q?ln.filter(At=>!is.has(At)).length:oe?ln.filter(At=>!Ls.has(At)).length:hu,Ce=O&&de.length>0&&ce>=de.length,Ie=N||x,wt=new Set(de),St=K&&O?Object.entries(Si).filter(([At,ss])=>wt.has(At)&&ss.length>0).map(([At,ss])=>`${At}: ${ss.join(", ")}`).slice(0,4):[],Rt=q?Array.from(is).slice(0,4):[],cn=oe?Array.from(Ls).slice(0,4):[];return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:g.label}),N&&l&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Dc,disabled:Fr||!bt,children:Fr?"Refreshing":"Refresh suggestions"})})]}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),St.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",St.join("; ")]}),q&&is.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",is.size," non-numeric column",is.size===1?"":"s",Rt.length?` (examples: ${Rt.join(", ")}${is.size>Rt.length?", ":""})`:""," binning only supports numeric inputs."]}),oe&&Ls.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",Ls.size," non-numeric column",Ls.size===1?"":"s",cn.length?` (examples: ${cn.join(", ")}${Ls.size>cn.length?", ":""})`:""," scaling only supports numeric inputs."]}),N&&a.jsx(Dk,{sourceId:l,availableFilters:Xs,activeFilterId:cl,setActiveFilterId:Dd,recommendations:xo,filteredRecommendations:Ld,isFetchingRecommendations:Fr,recommendationsError:nh,relativeGeneratedAt:pu,formatSignalName:zd,formatMissingPercentage:ps,getPriorityClass:nM,getPriorityLabel:sM,handleToggleColumn:Vr,selectedColumns:ln}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:ce})]}),ce>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:ln.map(At=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[At,a.jsx("button",{type:"button",onClick:()=>cs(At),"aria-label":`Remove ${At}`,children:""})]},At))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[N&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Oh,disabled:!xo.length,children:"Use all recommendations"}),O&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Dh,disabled:!de.length||Ce,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:ws,disabled:!hu,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:Tc,onChange:At=>ji(At.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:me.length?me.map(At=>{const ss=ln.includes(At),Es=Object.prototype.hasOwnProperty.call(Fa,At)?Fa[At]:void 0,Is=ps(typeof Es=="number"?Es:null),Xa=br[At]??null,Sn=Si[At]??[],kt=q?Ka[At]:void 0,Vt=!!(kt&&(kt.min!==null&&kt.min!==void 0||kt.max!==null&&kt.max!==void 0)),Er=q?(kt==null?void 0:kt.distinct)??null:null,Lo=q&&Er!==null&&Number.isFinite(Er),Au=Lo?Er:null,Ol=!q,Ou=Ol||Ie||Vt||Lo,Pu=Ol&&Sn.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${ss?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:ss,onChange:()=>Vr(At)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:At}),Ou&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Ol&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",bT(Xa)]}),Ie&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",Is]}),Vt&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[q?"Sample range":"Range",":"," ",kt&&kt.min!==null&&kt.min!==void 0?mr(kt.min):""," ",""," ",kt&&kt.max!==null&&kt.max!==void 0?mr(kt.max):""]}),Lo&&Au!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",Mr(Au)]})]}),Pu&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",Sn.join(", ")]})]})]},At)}):a.jsx("p",{className:"canvas-modal__note",children:xn.length?q&&de.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":I?"Loading column catalog":l?bt?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},g.name)},[cl,xn,Xs,Fa,Tc,Si,br,wl,Ld,zd,Oh,ws,cs,Dh,Vr,bt,K,Fr,J,Ka,x,te,is,Et.status,xo,nh,pu,ln,hu,Dd,ji,Ls,_u,l,Dc]),en=f.useCallback(g=>{var I;if(!(g!=null&&g.name))return null;if(g.type==="multi_select")return Kr(g);if(g.type==="number"){const q=`node-${e.id}-${g.name}`,oe=ge==null?void 0:ge[g.name],de=typeof oe=="number"?oe:oe??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:q,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:g.label}),g.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:g.unit})]}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx("input",{id:q,type:"number",className:"canvas-modal__input",value:de,min:g.min!==void 0?g.min:void 0,max:g.max!==void 0?g.max:void 0,step:g.step!==void 0?g.step:"any",onChange:me=>pm(g.name,me.target.value)}),g.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:g.unit})]}),xa===g.name&&wr!==null&&_u&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:ps(wr)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:jm,disabled:!Nm,children:au?"Applied":"Apply suggestion"})]})]},g.name)}if(g.type==="boolean"){const q=`node-${e.id}-${g.name}`,oe=!!(ge!=null&&ge[g.name]);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:q,children:g.label})}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:q,type:"checkbox",checked:oe,onChange:de=>Nl(g.name,de.target.checked)}),a.jsx("span",{children:oe?"Enabled":"Disabled"})]})]},g.name)}if(g.type==="select"){const q=`node-${e.id}-${g.name}`,oe=Array.isArray(g.options)?g.options:[],de=ge==null?void 0:ge[g.name],me=typeof g.default=="string"?g.default:((I=oe.find(Ce=>Ce&&typeof Ce.value=="string"))==null?void 0:I.value)??"",ce=typeof de=="string"&&de.trim().length?de:me;return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:q,className:"canvas-modal__parameter-label",children:g.label}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsx("select",{id:q,className:"canvas-modal__input",value:ce,onChange:Ce=>Sl(g.name,Ce.target.value),children:oe.map(Ce=>a.jsx("option",{value:Ce.value,title:Ce.description??void 0,children:Ce.label??Ce.value},Ce.value))})]},g.name)}if(g.type==="textarea"){const q=`node-${e.id}-${g.name}`;if(g.name==="hyperparameters"){let de="",me=ge==null?void 0:ge[g.name];if(typeof me=="string"&&me.trim())try{const ce=JSON.parse(me);ce&&typeof ce=="object"&&!Array.isArray(ce)?de=Object.entries(ce).map(([Ce,Ie])=>`${Ce}: ${JSON.stringify(Ie)}`).join(`
`):de=me}catch{de=me}else me&&typeof me=="object"&&!Array.isArray(me)&&(de=Object.entries(me).map(([ce,Ce])=>`${ce}: ${JSON.stringify(Ce)}`).join(`
`));return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:q,className:"canvas-modal__parameter-label",children:g.label}),a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description||"Enter parameters as key: value pairs (one per line)"}),a.jsx("textarea",{id:q,className:"canvas-modal__input canvas-modal__input--wide",value:de,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:ce=>{const Ie=ce.target.value.split(`
`).filter(St=>St.trim()),wt={};for(const St of Ie){const Rt=St.indexOf(":");if(Rt===-1)continue;const cn=St.substring(0,Rt).trim(),qn=St.substring(Rt+1).trim();if(cn)try{wt[cn]=JSON.parse(qn)}catch{wt[cn]=qn}}Sl(g.name,JSON.stringify(wt,null,2))},rows:6})]},g.name)}const oe=typeof(ge==null?void 0:ge[g.name])=="string"?ge==null?void 0:ge[g.name]:"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:q,className:"canvas-modal__parameter-label",children:g.label}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsx("textarea",{id:q,className:"canvas-modal__input canvas-modal__input--wide",value:oe,placeholder:g.placeholder??"",onChange:de=>Sl(g.name,de.target.value),rows:4})]},g.name)}const N=`node-${e.id}-${g.name}`,O=(ge==null?void 0:ge[g.name])??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:N,className:"canvas-modal__parameter-label",children:g.label}),g.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:g.description}),a.jsx("input",{id:N,type:"text",className:"canvas-modal__input canvas-modal__input--wide",value:O,placeholder:g.placeholder??"",onChange:q=>Sl(g.name,q.target.value)})]},g.name)},[Nm,ge,jm,Nl,pm,Sl,e.id,wr,Kr,_u,au,xa]),Gh=f.useCallback(g=>{Re(N=>({...N,keep:g}))},[Re]);return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(eM,{title:p,isDataset:Be,onClose:t,canResetNode:xt,onResetNode:Nr}),a.jsxs("div",{className:"canvas-modal__body",children:[ot&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:Xe?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",children:[a.jsx("strong",{children:Xe?"Ready to execute.":"Missing required connections."})," ",Xe?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]}),ot.inputs&&ot.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:ot.inputs.map(g=>{const N=rn.has(g.key),O=g.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:g.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:N?"Connected":O?"Missing":"Optional"})]},`inputs-${g.key}`)})})]}),ot.outputs&&ot.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:ot.outputs.map(g=>{const N=ve.has(g.key),O=g.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:g.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:N?"Connected":O?"Unlinked":"Optional"})]},`outputs-${g.key}`)})})]})]}),wh&&a.jsx(Lk,{thresholdParameter:Ya??null,dropIfAnyParameter:Kf,renderParameterField:en}),yi&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),Ya&&en(Ya),Kr(yi)]}),j&&a.jsxs(a.Fragment,{children:[a.jsx(qM,{suffix:Rn,insights:fn,formatMissingPercentage:ps}),(Cd||Ed)&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[Cd?en(Cd):null,Ed?en(Ed):null]})]})]}),fa&&a.jsx(Gk,{previewState:Et,datasetSourceId:l??null,canTriggerPreview:ki,onRefresh:Co,formatCellValue:U0,formatMetricValue:Mr,formatMissingPercentage:ps,formatNumericStat:mr,formatModeStat:bx}),a.jsx(Jk,{isDatasetProfileNode:So,controller:ch,formatCellValue:U0,formatNumericStat:mr,formatMissingPercentage:ps}),Oe&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",children:[a.jsxs("strong",{children:[Oe.title,"."]})," ",Oe.body]})}),k&&a.jsx(QA,{sourceId:l,hasReachableSource:bt,columnsParameter:gt,modeParameter:Ct,renderMultiSelectField:Kr,renderParameterField:en,columnSummary:Hc,modeDetails:hh,sampleMap:fh}),M&&a.jsx(hO,{sourceId:l,hasReachableSource:bt,columnsParameter:hn,modeParameter:Zt,replacementParameter:Cn,renderMultiSelectField:Kr,renderParameterField:en,columnSummary:Vc,modeDetails:ga,sampleMap:ph}),P&&a.jsx(yP,{sourceId:l,hasReachableSource:bt,columnsParameter:Yn,modeParameter:pn,minValueParameter:Ot,maxValueParameter:Ut,renderMultiSelectField:Kr,renderParameterField:en,columnSummary:_a,modeDetails:tr,sampleMap:Mo,selectedMode:er,minValue:va,maxValue:Ao}),T&&a.jsx(QO,{sourceId:l,hasReachableSource:bt,columnsParameter:bn,modeParameter:qt,patternParameter:Pt,replacementParameter:an,renderMultiSelectField:Kr,renderParameterField:en,columnSummary:Wc,modeDetails:gh,sampleMap:Kd,selectedMode:f_,replacementValue:qa}),w&&a.jsx(OO,{sourceId:l,hasReachableSource:bt,columnsParameter:es,modeParameter:Ks,renderMultiSelectField:Kr,renderParameterField:en,columnSummary:pl,modeDetails:Kc,sampleMap:gl,selectedMode:Yc}),Q&&a.jsx(zP,{operations:ll,summaries:dh,collapsed:Ud,onToggleCollapsed:Pm,onAddOperation:Hh,onDuplicateOperation:Vh,onRemoveOperation:Wh,onReorderOperation:Om,onOperationChange:ns,availableColumns:xn,signals:Mi,previewStatus:Et.status,errorHandlingParameter:la,allowOverwriteParameter:ia,defaultTimezoneParameter:el,epsilonParameter:fo,renderParameterField:en,canResetNode:xt,onResetNode:Nr}),H&&a.jsx(JP,{sourceId:l,hasReachableSource:bt,isFetching:ah,error:oh,suggestions:Br,metadata:wo,columnsParameter:pi,autoDetectParameter:ho,maxCategoriesParameter:po,outputSuffixParameter:nl,dropOriginalParameter:sl,encodeMissingParameter:Rr,handleUnknownParameter:gi,unknownValueParameter:Da,selectedColumns:ln,renderParameterField:en,onToggleColumn:Vr,onApplyRecommended:$h,formatMissingPercentage:ps}),D&&a.jsx(qP,{sourceId:l,hasReachableSource:bt,isFetching:dl,error:Fd,suggestions:Lc,metadata:Ir,columnsParameter:Yt,targetColumnParameter:Ln,autoDetectParameter:gr,maxCategoriesParameter:$a,outputSuffixParameter:_r,dropOriginalParameter:Gs,smoothingParameter:Ps,encodeMissingParameter:vs,handleUnknownParameter:vr,selectedColumns:ln,renderParameterField:en,onToggleColumn:Vr,onApplyRecommended:Ph,formatMissingPercentage:ps}),V&&a.jsx(tT,{sourceId:l,hasReachableSource:bt,isFetching:Id,error:i_,suggestions:Bd,metadata:jo,columnsParameter:rl,autoDetectParameter:zn,maxCategoriesParameter:go,dropFirstParameter:kc,includeMissingParameter:ys,dropOriginalParameter:La,prefixSeparatorParameter:Nn,selectedColumns:ln,renderParameterField:en,onToggleColumn:Vr,onApplyRecommended:iu,formatMissingPercentage:ps}),ne&&a.jsx(rT,{sourceId:l,hasReachableSource:bt,isFetching:c_,error:lh,suggestions:Rc,metadata:mn,columnsParameter:Gn,autoDetectParameter:yr,maxCategoriesParameter:_i,dropFirstParameter:Sd,includeMissingParameter:vi,dropOriginalParameter:Mc,prefixSeparatorParameter:Wf,selectedColumns:ln,renderParameterField:en,onToggleColumn:Vr,onApplyRecommended:v_,formatMissingPercentage:ps}),F&&a.jsx(mT,{nodeId:Te,sourceId:l,hasReachableSource:bt,previewState:Et,onRefreshPreview:Co,config:s_,targetColumnParameter:fi,renderParameterField:en,formatMetricValue:Mr,formatMissingPercentage:ps,canResetNode:xt,onResetNode:Nr}),R&&a.jsx(hT,{nodeId:Te,sourceId:l,hasReachableSource:bt,previewState:Et,onRefreshPreview:Co,config:r_,parameters:X,renderParameterField:en,formatMetricValue:Mr,canResetNode:xt,onResetNode:Nr}),He&&a.jsx(p2,{mode:W?"oversampling":"undersampling",sourceId:l,hasReachableSource:bt,previewState:Et,onRefreshPreview:Co,config:ua,methodParameter:Cc,targetColumnParameter:di,samplingStrategyParameter:Xt,randomStateParameter:Ec,kNeighborsParameter:W?mi:null,replacementParameter:G?tl:null,renderParameterField:en,formatMetricValue:Mr,formatMissingPercentage:ps,schemaGuard:xi}),(B||z)&&a.jsx(yT,{sourceId:l,hasReachableSource:bt,previewState:Et,onRefreshPreview:Co,config:vo,targetColumnParameter:hi,problemTypeParameter:ae,renderParameterField:en,formatMetricValue:Mr,formatMissingPercentage:ps,schemaColumns:yo}),B&&a.jsx("div",{style:et,"aria-disabled":tt,children:a.jsx(ET,{nodeId:Te,sourceId:l,graph:Mn,config:vo,runtimeConfig:eh,cvConfig:Md,draftConfigState:ge,renderParameterField:en,modelTypeParameter:Me,modelTypeOptions:Ad,hyperparametersParameter:we,cvEnabledParameter:rt,cvStrategyParameter:mt,cvFoldsParameter:Dt,cvShuffleParameter:pt,cvRandomStateParameter:Lt,cvRefitStrategyParameter:Dn,onSaveDraftConfig:fu})}),ee&&a.jsx("div",{style:et,"aria-disabled":tt,children:a.jsx(RT,{nodeId:Te,sourceId:l,graph:Mn,config:ge,setConfigState:Re,renderParameterField:en,formatMetricValue:Mr,connectedSplitHandles:be,canResetNode:xt,onResetNode:Nr})}),le&&a.jsx("div",{style:et,"aria-disabled":tt,children:a.jsx(t2,{nodeId:Te,sourceId:l,graph:Mn,parameters:X,config:kd,renderParameterField:en})}),z&&a.jsx("div",{style:et,"aria-disabled":tt,children:a.jsx(d2,{nodeId:Te,sourceId:l,graph:Mn,config:vo,runtimeConfig:eh,cvConfig:Md,draftConfigState:ge,renderParameterField:en,modelTypeParameter:Me,modelTypeOptions:Ad,searchStrategyParameter:We,searchIterationsParameter:Ue,searchRandomStateParameter:Pe,scoringMetricParameter:_t,setDraftConfigState:Re,onSaveDraftConfig:fu})}),E&&a.jsx(IP,{sourceId:l,hasReachableSource:bt,isFetching:Ci,error:Rd,suggestions:sh,metadata:ul,columnsParameter:En,autoDetectParameter:as,maxUniqueParameter:Gt,outputSuffixParameter:Qn,dropOriginalParameter:Tr,missingStrategyParameter:uo,missingCodeParameter:Ys,selectedColumns:ln,renderParameterField:en,onToggleColumn:Vr,onApplyRecommended:__,formatMissingPercentage:ps}),$&&a.jsx(WP,{sourceId:l,hasReachableSource:bt,isFetching:Ei,error:rh,suggestions:zc,metadata:ml,columnsParameter:Os,autoDetectParameter:Pa,maxCategoriesParameter:Ta,bucketsParameter:ta,outputSuffixParameter:$r,dropOriginalParameter:na,encodeMissingParameter:sa,selectedColumns:ln,renderParameterField:en,onToggleColumn:Vr,onApplyRecommended:Th,canResetNode:xt,onResetNode:Nr,formatMissingPercentage:ps}),Y&&a.jsx(KP,{columnsParameter:ra,autoDetectParameter:Ee,degreeParameter:Ye,includeBiasParameter:Ge,interactionOnlyParameter:sn,includeInputFeaturesParameter:Mt,outputPrefixParameter:os,renderParameterField:en,signal:qd,canResetNode:xt,onResetNode:Nr}),U&&a.jsx(QP,{columnsParameter:nn,autoDetectParameter:jn,targetColumnParameter:dn,methodParameter:gn,scoreFuncParameter:_n,problemTypeParameter:on,kParameter:kn,percentileParameter:aa,alphaParameter:Qs,thresholdParameter:Dr,modeParameter:pr,estimatorParameter:_s,stepParameter:Lr,minFeaturesParameter:zr,maxFeaturesParameter:mo,dropUnselectedParameter:oa,renderParameterField:en,signal:d_,canResetNode:xt,onResetNode:Nr}),A&&a.jsx(OA,{hasSource:!!l,hasReachableSource:bt,strategies:Oi,columnSummary:xs,columnOptions:$s,sampleMap:Qd,collapsedStrategies:No,onToggleStrategy:Am,onRemoveStrategy:El,onAddStrategy:at,onModeChange:qh,onColumnToggle:Fi,onColumnsChange:C_,onAutoDetectToggle:Nu,modeOptions:xg}),S&&a.jsx(gA,{hasSource:!!l,hasReachableSource:bt,strategies:Ua,columnSummary:ls,columnOptions:Ss,sampleMap:hl,customPairSummary:ko,customPairsParameter:Tt,collapsedStrategies:No,onToggleStrategy:Kh,onRemoveStrategy:Qa,onAddStrategy:Sr,onModeChange:Yh,onAutoDetectToggle:Wr,onColumnToggle:Cr,onColumnsChange:Qh,renderParameterField:en}),x&&a.jsx(SM,{hasSource:!!l,hasReachableSource:bt,strategies:al,columnOptions:Li,methodOptions:Ke,missingFilter:th,missingFilterMax:fm,missingFilterActive:xh,filteredOptionCount:hm,collapsedStrategies:No,onToggleStrategy:us,onRemoveStrategy:Ri,onAddStrategy:Uh,onMethodChange:j_,onOptionNumberChange:N_,onColumnsChange:ju,onColumnToggle:ds,onMissingFilterChange:S_,formatMissingPercentage:ps,formatNumericStat:mr,formatModeStat:bx,schemaDiagnostics:Ra}),K&&a.jsx(Bk,{configState:ge,setConfigState:Re,availableColumns:xn,columnTypeMap:br,columnSuggestions:Si,selectedColumns:ln,previewColumns:fl,previewStatus:Et.status,sourceId:l,hasReachableSource:bt}),ie&&a.jsx(T$,{sourceId:l,hasReachableSource:bt,isFetchingOutliers:Hd,outlierConfig:qr,outlierMethodOptions:Zc,outlierMethodDetailMap:Jc,outlierDefaultDetail:em,outlierAutoDetectEnabled:nr,outlierSelectedCount:Zd,outlierDefaultLabel:bl,outlierOverrideCount:yl,outlierParameterOverrideCount:Ha,outlierOverrideExampleSummary:bh,outlierHasOverrides:sm,outlierRecommendationRows:ya,outlierHasRecommendations:To,outlierStatusMessage:tm,outlierError:m_,outlierSampleSize:ba,relativeOutlierGeneratedAt:Va,outlierPreviewSignal:om,formatMetricValue:Mr,formatNumericStat:mr,onApplyAllRecommendations:Lh,onClearOverrides:cu,onDefaultMethodChange:y_,onAutoDetectToggle:jr,onOverrideSelect:ym,onMethodParameterChange:Cl,onColumnParameterChange:bm}),te&&a.jsx(PM,{sourceId:l,hasReachableSource:bt,isFetchingScaling:Ia,scalingConfig:_l,scalingMethodOptions:Xd,scalingMethodDetailMap:Gd,scalingDefaultDetail:Jd,scalingAutoDetectEnabled:Po,scalingSelectedCount:_h,scalingDefaultLabel:h_,scalingOverrideCount:vl,scalingOverrideExampleSummary:yh,scalingRecommendationRows:Qc,scalingHasRecommendations:Gc,scalingStatusMessage:vh,scalingError:Ur,scalingSampleSize:Ih,relativeScalingGeneratedAt:Fh,formatMetricValue:Mr,formatNumericStat:mr,formatMissingPercentage:ps,onApplyAllRecommendations:Rh,onClearOverrides:zh,onDefaultMethodChange:xm,onAutoDetectToggle:b_,onOverrideSelect:x_}),J&&a.jsx(hM,{config:xr,columnsParameter:Bt,renderMultiSelectField:Kr,fieldIds:Wa,customEdgeDrafts:eu,customLabelDrafts:tu,onStrategyChange:ou,onIntegerChange:lu,onBooleanToggle:jh,onSuffixChange:gm,onLabelFormatChange:Sh,onDuplicatesChange:Nh,onMissingStrategyChange:Ch,onMissingLabelChange:Eh,onCustomBinsChange:_m,onCustomLabelsChange:kh,onClearCustomColumn:Mh,onKbinsEncodeChange:Ah,onKbinsStrategyChange:g_}),re&&a.jsx(RM,{sourceId:l,hasReachableSource:bt,isFetchingSkewness:Zs,skewnessThreshold:jl,skewnessError:Ba,skewnessViewMode:lm,skewnessRecommendedCount:Bn,skewnessNumericCount:Xn,skewnessGroupByMethod:su,skewnessRows:Di,skewnessTableGroups:p_,hasSkewnessAutoRecommendations:$i,skewnessTransformationsCount:ru,isFetchingRecommendations:Fr,getSkewnessMethodLabel:um,getSkewnessMethodStatus:dm,onApplyRecommendations:mm,onViewModeChange:im,onGroupByToggle:cm,onOverrideChange:Hr,onClearSelections:rr}),pe&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":sr==="before",onClick:()=>yn("before"),disabled:!On.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":sr==="after",onClick:()=>yn("after"),disabled:!On.length,children:"After"})]})})]}),jl!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",jl.toFixed(2)," are visualized below."]}),Zs&&On.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!Zs&&Ba&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Ba}),(!Zs||On.length>0)&&!Ba&&(On.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:On.map(g=>{const N=(me,ce,Ce)=>{const Ie=Math.max(0,me.sample_size||0),wt=Math.max(0,me.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:ce}),Ce?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:Ce}):null]}),a.jsx($$,{counts:me.counts,binEdges:me.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:mr(me.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:mr(me.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:mr(me.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:mr(me.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:mr(me.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:Ie.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:wt.toLocaleString()})]})]})]},ce)},O=g.distributionAfter,I=sr==="before",q=sr==="after"&&!!O,oe=sr==="after"&&!O,de=sr==="before"?"Showing the original distribution returned by the skewness analysis.":O?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${g.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:g.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[g.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:g.directionLabel}),g.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:g.magnitudeLabel}),g.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",g.recommendedLabel]}),g.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",g.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:g.skewness!==null?Mr(g.skewness,2):""})]})]}),g.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:g.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[I?N(g.distributionBefore,"Before transform"):null,q&&O?N(O,"After transform",g.appliedLabel):null,oe?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",de]})]},`skewness-dist-${g.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]}),xe&&a.jsx(pM,{cards:Bh,selectedPreset:Fc,onSelectPreset:g=>Ic(g),isFetching:qc,sampleSize:Em,relativeGeneratedAt:Sm,error:Vd,onRefresh:Mm,canRefresh:!!l}),Qe&&a.jsx(Fk,{sourceId:l,hasReachableSource:bt,removeDuplicatesColumnsParameter:Ft,removeDuplicatesKeepParameter:ct,renderMultiSelectField:Kr,removeDuplicatesKeepSelectId:Pi,removeDuplicatesKeep:Ti,onKeepChange:Gh}),Ve&&Qf.length>0&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Data consistency settings"}),xt&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Nr,children:"Reset node"})})]}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Qf.map(g=>en(g))})]}),Z&&a.jsx(cT,{signal:xl,previewStatus:Et.status,hasSource:!!l,hasReachableSource:bt,onRefreshPreview:Co}),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("h3",{children:"Node details"}),y.length?a.jsx("dl",{className:"canvas-modal__metadata",children:y.map((g,N)=>a.jsxs("div",{className:"canvas-modal__metadata-row",children:[a.jsx("dt",{children:g.label}),a.jsx("dd",{children:g.value})]},`${g.label}-${N}`))}):a.jsx("p",{className:"canvas-modal__empty",children:"No metadata available for this node."})]})]}),a.jsx(tM,{onClose:t,canResetNode:xt,onResetNode:Nr,showSaveButton:vu,canSave:yu,onSave:fu,isBusy:xu,busyLabel:wu})]})]})},bw=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],so=bw.map(e=>e.key),z$=bw.reduce((e,t)=>({...e,[t.key]:t.label}),{}),R$=e=>typeof e=="string"&&so.includes(e),xw=28,ww=320,F$=170,jw="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",Nw="Drop columns",vd=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},ti="__pending_confirmation__",qf=e=>e&&typeof e=="object"&&!Array.isArray(e),I$=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],B$=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],U$={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},yd={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"validation-in",label:"Validation Split",position:30,required:!1,accepts:["validation"]},{key:"test-in",label:"Test Split",position:50,required:!1,accepts:["test"]},{key:"models-in",label:"Model",position:70,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},ro=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{R$(n)&&t.add(n)}),so.filter(n=>t.has(n))},Sw=(e,t)=>{const n=ro(e),r=ro(t);return n.length!==r.length?!1:n.every((l,i)=>l===r[i])},Cw=e=>!e||typeof e!="string"?null:so.find(t=>e.endsWith(`-${t}`))??null,Ew=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},kw=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:Ew(t,n),q$=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,H$=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,Mw=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const r=t.split("-");return r.length>=2?r.slice(-2).join("-"):t},V$=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),W$=(e,t)=>{const n=new Map,r=new Set;e.forEach(m=>{var p;const y=(p=m==null?void 0:m.data)==null?void 0:p.catalogType;if(y&&V$.has(y)){r.add(m.id);return}y==="train_test_split"&&n.set(m.id,new Set(so))});let l=!0,i=0;const u=e.length*3;for(;l&&i<u;)l=!1,i++,t.forEach(m=>{if(r.has(m.source)||r.has(m.target))return;const y=n.get(m.source),p=Cw(m.sourceHandle);if(!y||y.size===0)return;n.has(m.target)||n.set(m.target,new Set);const v=n.get(m.target),_=v.size;p?y.has(p)&&v.add(p):y.forEach(x=>v.add(x)),v.size>_&&(l=!0)});const d=new Map;return n.forEach((m,y)=>{!m.size||r.has(y)||d.set(y,so.filter(p=>m.has(p)))}),d},K$=e=>{const t=new Map;e.forEach(r=>{const l=Cw(r.sourceHandle);l&&(t.has(r.source)||t.set(r.source,new Set),t.get(r.source).add(l))});const n=new Map;return t.forEach((r,l)=>{n.set(l,so.filter(i=>r.has(i)))}),n},Y$=e=>{var n;const t=e?yd[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(r=>r.required!==!1).map(r=>r.key):[]},Q$=(e,t,n)=>{const r=Y$(t);if(r.length===0)return!0;const l=n.filter(u=>u.target===e),i=new Set(l.map(u=>Mw(e,u.targetHandle)).filter(u=>!!u));return r.every(u=>i.has(u))},G$=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),Aw=new Set(["transformer_audit"]),Hf=e=>typeof e=="string"&&Aw.has(e),Vf=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",r=!Aw.has(n),l=u=>(r?u[ti]=!0:delete u[ti],u);if(t==null)return l({});const i=vd(t);if(!qf(i))return l(i&&typeof i=="object"?i:{});switch(Object.entries(i).forEach(([u,d])=>{Array.isArray(d)?I$.some(y=>y.test(u))&&(i[u]=[]):qf(d)&&B$.some(y=>y.test(u))&&(i[u]={})}),"auto_detect"in i&&(i.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.column_methods=qf(i.column_methods)?i.column_methods:{},i.skipped_columns=Array.isArray(i.skipped_columns)?i.skipped_columns:[],i.default_method=typeof i.default_method=="string"&&i.default_method.trim()?i.default_method:"standard";break;case"polynomial_features":i.columns=Array.isArray(i.columns)?i.columns:[],i.auto_detect=!!i.auto_detect,i.include_bias=!!i.include_bias,i.interaction_only=!!i.interaction_only,i.include_input_features=!!i.include_input_features,i.degree=typeof i.degree=="number"&&Number.isFinite(i.degree)?i.degree:2,i.output_prefix=typeof i.output_prefix=="string"&&i.output_prefix.trim()?i.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in i&&(i.missing_threshold=null),i.columns=Array.isArray(i.columns)?i.columns:[];break;case"drop_missing_rows":"missing_threshold"in i&&(i.missing_threshold=null),"drop_if_any_missing"in i&&(i.drop_if_any_missing=!1);break;case"outlier_removal":i.method="manual",i.columns=Array.isArray(i.columns)?i.columns:[],i.manual_bounds=qf(i.manual_bounds)?i.manual_bounds:{};break;case"missing_value_indicator":i.columns=Array.isArray(i.columns)?i.columns:[];break;case"remove_duplicates":if(i.columns=Array.isArray(i.columns)?i.columns:[],typeof i.keep=="string"){const u=i.keep.trim().toLowerCase();i.keep=u==="last"||u==="none"?u:"first"}else i.keep="first";break}return l(i)},X$=e=>({width:`${xw}px`,height:`${xw}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),J$=({id:e,data:t,selected:n})=>{var w;const r=(t==null?void 0:t.label)??e,l=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),i=(t==null?void 0:t.isRemovable)??!l,u=(t==null?void 0:t.catalogType)==="train_test_split",d=l?"Primary dataset input":void 0,m=(t==null?void 0:t.description)??d,p=(t==null?void 0:t.catalogType)==="drop_missing_columns"||m===jw?Nw:m,v=(t==null?void 0:t.backgroundExecutionStatus)??"idle",x=!((t==null?void 0:t.hasRequiredConnections)??!0),j=(t==null?void 0:t.catalogType)??"",S=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(j),k=f.useCallback(A=>{var E;A.stopPropagation(),(E=t==null?void 0:t.onRemoveNode)==null||E.call(t,e)},[t,e]),M=f.useMemo(()=>{if(l)return[];const A=(t==null?void 0:t.catalogType)??"",E=A?yd[A]:void 0;if(E!=null&&E.inputs&&E.inputs.length){const D=E.inputs.length;return E.inputs.map(($,F)=>({position:Je.Left,id:`${e}-${$.key}`,label:q$($),style:{top:kw($,F,D)}}))}return[{position:Je.Left,id:`${e}-target`},{position:Je.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,l]),P=f.useMemo(()=>{if(l)return[{position:Je.Left,id:`${e}-source-left`},{position:Je.Right,id:`${e}-source`},{position:Je.Top,id:`${e}-source-top`},{position:Je.Bottom,id:`${e}-source-bottom`}];const A=(t==null?void 0:t.catalogType)??"",E=A?yd[A]:void 0;if(E!=null&&E.outputs&&E.outputs.length){const F=E.outputs.length;return E.outputs.map((R,B)=>({position:Je.Right,id:`${e}-${R.key}`,label:R.label,style:{top:kw(R,B,F)}}))}const D=u?so:ro((t==null?void 0:t.activeSplits)??[]),$=ro((t==null?void 0:t.connectedSplits)??[]);if(D.length){const F=D.length;return D.map((R,B)=>({position:Je.Right,id:`${e}-${R}`,style:{top:Ew(B,F)},label:(()=>{var le;const ee=z$[R];if(u){if(R==="validation"&&!(Number(((le=t==null?void 0:t.config)==null?void 0:le.validation_size)??0)>0))return`${ee} (disabled)`;if(!$.includes(R))return`${ee} (not set)`}return ee})()}))}return[{position:Je.Right,id:`${e}-source`},{position:Je.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(w=t==null?void 0:t.config)==null?void 0:w.validation_size,e,l,u]),T=f.useCallback((A,E)=>{const{position:D,id:$,style:F,label:R}=A,B=$.includes("-train")||$.includes("-test")||$.includes("-validation");return a.jsxs(Ae.Fragment,{children:[a.jsx(Qu,{type:E,position:D,id:$,className:`feature-node__handle feature-node__handle--${E}`,style:{...X$(E),...F??{},...B?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),R&&E==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(F==null?void 0:F.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:R}),R&&E==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(F==null?void 0:F.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:R})]},$)},[]);return a.jsxs("div",{className:`feature-node${n?" feature-node--selected":""}${l?" feature-node--dataset":""}`,children:[M.map(A=>T(A,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:r})]}),a.jsxs("div",{className:"feature-node__controls",children:[x&&S&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)"},children:""}),v==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:"Loading full dataset in background...",children:a.jsx("svg",{className:"feature-node__spinner",viewBox:"0 0 24 24",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60",strokeDashoffset:"30",strokeLinecap:"round"})})}),v==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",children:""}),v==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",children:"!"}),i&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:k,title:"Remove node",children:""})]})]}),p&&a.jsx("p",{className:"feature-node__description",children:p}),P.map(A=>T(A,"source"))]})},Z$=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],eD=[],tD=e=>({...e,data:{...e.data??{}}}),Ow=()=>Z$.map(e=>tD(e)),nD=()=>eD.map(e=>({...e})),sD=12,Gg=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},Pw=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},Xg=e=>{const t=Pw(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},Jg=e=>{const t=Pw(e);if(!t)return null;const n=t.getTime(),r=Date.now()-n,l=Math.round(r/6e4);if(l<1)return"just now";if(l===1)return"1 minute ago";if(l<60)return`${l} minutes ago`;const i=Math.round(l/60);if(i===1)return"1 hour ago";if(i<24)return`${i} hours ago`;const u=Math.round(i/24);if(u===1)return"1 day ago";if(u<7)return`${u} days ago`;const d=Math.round(u/7);return d===1?"1 week ago":`${d} weeks ago`},rD=f.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:r,onPipelineError:l},i)=>{var rn;const u=f.useMemo(()=>({featureNode:J$}),[]),d=f.useMemo(()=>({animatedEdge:jk}),[]),[m,y,p]=yk(Ow().map(ve=>({...ve,type:"featureNode"}))),[v,_,x]=bk(nD()),j=f.useRef(!1),[S,k]=f.useState(!1),[M,P]=f.useState(null),[T,w]=f.useState(!1),A=f.useRef(0),E=f.useRef(null),D=f.useRef(null),$=f.useRef(!1),F=f.useRef(new Map),R=t??e??"Demo dataset",B=ZE(),ee=f.useCallback(ve=>{const be=(Array.isArray(ve)?ve:[ve]).filter(Boolean);if(!be.length)return;const ke=Array.from(new Set(be));console.debug(" Scheduling node internals update for:",ke),requestAnimationFrame(()=>{requestAnimationFrame(()=>{ke.forEach(Le=>{B(Le)})})})},[B]),le=f.useCallback(ve=>{const be=ve.reduce((ke,Le)=>{if(typeof Le.id=="string"&&Le.id.startsWith("node-")){const Xe=Number(Le.id.replace("node-",""));if(!Number.isNaN(Xe))return Math.max(ke,Xe)}return ke},0);be>A.current&&(A.current=be)},[]);f.useEffect(()=>{le(m)},[m,le]),f.useEffect(()=>{const ve=[];y(be=>{const ke=W$(be,v),Le=K$(v);let Xe=!1;const et=be.map(tt=>{var Ot,Ut,bn,qt,Pt;const Bt=((Ot=tt==null?void 0:tt.data)==null?void 0:Ot.catalogType)==="train_test_split"?[...so]:ke.get(tt.id)??[],Ft=ro((Ut=tt.data)==null?void 0:Ut.activeSplits),ct=ro(Le.get(tt.id)),Tt=ro((bn=tt.data)==null?void 0:bn.connectedSplits),gt=((qt=tt==null?void 0:tt.data)==null?void 0:qt.catalogType)??"",Ct=Q$(tt.id,gt,v),hn=((Pt=tt.data)==null?void 0:Pt.hasRequiredConnections)??!0,Zt=!Sw(Ft,Bt),Cn=!Sw(Tt,ct);if(!Zt&&!Cn&&!(Ct!==hn))return tt;const pn={...tt.data,hasRequiredConnections:Ct};return Bt.length?pn.activeSplits=Bt:delete pn.activeSplits,ct.length?pn.connectedSplits=ct:delete pn.connectedSplits,Xe=!0,(Zt||Cn)&&ve.push(tt.id),{...tt,data:pn}});return Xe?et:be}),ve.length&&ee(ve)},[v,ee,y]);const z=f.useMemo(()=>m.find(ve=>ve.id===M)??null,[m,M]),G=f.useMemo(()=>{const ve=m.map(ke=>{const{data:Le,...Xe}=ke,et=Le?{...Le}:void 0;return et&&(delete et.onRemoveNode,delete et.onOpenSettings),JSON.parse(JSON.stringify({...Xe,data:et}))}),be=v.map(ke=>JSON.parse(JSON.stringify(ke)));return{nodes:ve,edges:be}},[v,m]),W=f.useCallback(ve=>{P(ve),w(!0)},[]),H=f.useCallback(()=>{w(!1),P(null)},[]),V=f.useCallback(()=>{$.current=!0},[]);f.useEffect(()=>{$.current&&($.current=!1,requestAnimationFrame(()=>{var ve;(ve=E.current)==null||ve.fitView({padding:.25,duration:350})}))},[v,m]);const ne=f.useCallback(ve=>{ve!=="dataset-source"&&(y(be=>be.filter(ke=>ke.id!==ve)),_(be=>be.filter(ke=>ke.source!==ve&&ke.target!==ve)),P(be=>be===ve?(w(!1),null):be))},[_,w,y]),Q=f.useCallback(ve=>{var Cn,Yn,pn,Ot,Ut,bn;const be=ve.data??{},ke=be.isDataset??ve.id==="dataset-source",Le={...ve.style??{}},Xe=be.catalogType??be.type??ve.id;let tt=Array.isArray(be.parameters)?be.parameters:null;if((!tt||tt.length===0)&&typeof Xe=="string"){const qt=F.current.get(Xe)??null;(Cn=qt==null?void 0:qt.parameters)!=null&&Cn.length&&(tt=qt.parameters)}const xt=Array.isArray(tt)?tt.map(qt=>({...qt})):[];let Bt;if(xt.length||be.config&&typeof be.config=="object"){const qt=vd(be.config);xt.forEach(Pt=>{Pt!=null&&Pt.name&&qt[Pt.name]===void 0&&Pt.default!==void 0&&(Array.isArray(Pt.default)?qt[Pt.name]=[...Pt.default]:Pt.type==="boolean"?qt[Pt.name]=!!Pt.default:qt[Pt.name]=Pt.default)}),Bt=qt}Le.width||(Le.width=ke?ww+20:ww),Le.minHeight||(Le.minHeight=F$),Le.padding||(Le.padding=12),Le.borderRadius||(Le.borderRadius=16),Le.boxSizing=Le.boxSizing??"border-box",Le.whiteSpace=Le.whiteSpace??"pre-line",Le.background||(Le.background=ke?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),Le.border||(Le.border=ke?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),Le.boxShadow||(Le.boxShadow=ke?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),Le.color||(Le.color=ke?"#e0f2fe":"#e2e8f0"),Le.fontWeight||(Le.fontWeight=ke?600:500);const Ft=Xe==="drop_missing_columns"||be.description===jw?Nw:be.description,ct=Hf(Xe),Tt=Bt??(be.config&&typeof be.config=="object"?vd(be.config):void 0);Tt&&typeof Tt=="object"&&ct&&delete Tt[ti];const gt={...be,label:be.label??ve.id,description:Ft,isDataset:ke,isRemovable:be.isRemovable??!ke,isConfigured:ke||be.isConfigured===!0?!0:be.config&&typeof be.config=="object"?ct?!0:!be.config[ti]:!1,inputs:Array.isArray(be.inputs)?[...be.inputs]:be.inputs,outputs:Array.isArray(be.outputs)?[...be.outputs]:be.outputs,category:be.category,parameters:xt,config:Tt,catalogType:Xe,onRemoveNode:ne,onOpenSettings:W},Ct=typeof Xe=="string"?yd[Xe]:void 0;if(Ct){const qt=((Yn=Ct.inputs)==null?void 0:Yn.map(an=>H$(an)))??[],Pt=((pn=Ct.outputs)==null?void 0:pn.map(an=>an.label))??[];qt.length?gt.inputs=qt:delete gt.inputs,Pt.length?gt.outputs=Pt:delete gt.outputs,gt.connectionInfo={inputs:((Ot=Ct.inputs)==null?void 0:Ot.map(an=>({...an})))??[],outputs:((Ut=Ct.outputs)==null?void 0:Ut.map(an=>({...an})))??[]}}else(!gt.inputs||gt.inputs.length===0)&&delete gt.inputs,(!gt.outputs||gt.outputs.length===0)&&delete gt.outputs,delete gt.connectionInfo;const hn=ro(gt.activeSplits);hn.length?gt.activeSplits=hn:delete gt.activeSplits;const Zt=ro(gt.connectedSplits);return Zt.length?gt.connectedSplits=Zt:delete gt.connectedSplits,Xe==="train_test_split"&&(gt.activeSplits=[...so],Zt.length||delete gt.connectedSplits),(bn=gt.parameters)!=null&&bn.length||delete gt.parameters,gt.config===void 0&&delete gt.config,{...ve,type:"featureNode",position:ve.position??{x:0,y:0},data:gt,style:Le}},[W,ne]),K=f.useCallback(()=>{y(ve=>{const be=ve.find(Le=>Le.id==="dataset-source");return[Q(be?{...be,data:{...be.data??{},label:`Dataset input
(${R})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${R})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),_([]),P(null),w(!1),V()},[R,Q,V,_,y,P,w]);f.useImperativeHandle(i,()=>({openCatalog:()=>k(!0),closeCatalog:()=>k(!1),clearGraph:K}),[K]);const J=f.useCallback(ve=>ve.map(be=>{const ke={...be.data??{}};be.id==="dataset-source"&&(ke.label=`Dataset input
(${R})`,ke.isDataset=!0,ke.isRemovable=!1,ke.isConfigured=!0);const Le=ke.catalogType??ke.type??be.id;return ke.config&&typeof ke.config=="object"&&Hf(Le)&&delete ke.config[ti],ke.isConfigured===void 0&&(ke.config&&typeof ke.config=="object"?ke.isConfigured=Hf(Le)?!0:!ke.config[ti]:ke.isConfigured=!0),Q({...be,data:ke})}),[R,Q]),te=f.useCallback((ve,be)=>{const ke=A.current+1,Le=`node-${ke}`;A.current=ke;const Xe=be??{x:160+(ke-1)%4*220,y:40+Math.floor((ke-1)/4)*160},et=`Step ${ke}`,tt=(ve==null?void 0:ve.label)??(ve==null?void 0:ve.type)??et,xt=typeof tt=="string"&&tt.trim()?tt:et,Bt=Vf(ve),Ft=Hf((ve==null?void 0:ve.type)??null);return Q({id:Le,type:"featureNode",position:Xe,data:{label:xt,description:ve==null?void 0:ve.description,inputs:ve==null?void 0:ve.inputs,outputs:ve==null?void 0:ve.outputs,category:ve==null?void 0:ve.category,parameters:ve==null?void 0:ve.parameters,config:Bt,catalogType:ve==null?void 0:ve.type,isConfigured:!!Ft}})},[Q]),Y=f.useCallback(ve=>{const be=E.current,ke=D.current;if(!be||typeof be.project!="function"||!ke)return;const Le=ke.getBoundingClientRect(),Xe=be.project({x:Le.width/2,y:Le.height/2});if(!Xe)return;const et=ve.filter(Tt=>Tt.id!=="dataset-source").length,tt=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],xt=et%tt.length,Bt=Math.floor(et/tt.length),Ft=tt[xt],ct=Bt+1;return{x:Xe.x+Ft.x*ct,y:Xe.y+Ft.y*ct}},[]),U=ir({queryKey:["feature-canvas","node-catalog"],queryFn:Kb,staleTime:5*60*1e3}),Z=U.data??[],ie=U.isLoading||U.isFetching,re=U.error?((rn=U.error)==null?void 0:rn.message)??"Unable to load node catalog":null,pe=f.useMemo(()=>{const ve=new Map;return Z.forEach(be=>{be&&typeof be.type=="string"&&be.type.trim()&&ve.set(be.type,be)}),ve},[Z]);f.useEffect(()=>{F.current=pe},[pe]);const xe=f.useCallback(ve=>{if(!ve)return!1;if(G$.has(ve))return!0;const be=pe.get(ve);return be?(typeof be.category=="string"?be.category.toLowerCase():"").includes("preprocess"):!1},[pe]),Ve=f.useCallback(ve=>{var ke;if(!ve||ve.id==="dataset-source")return!1;const be=(ke=ve==null?void 0:ve.data)==null?void 0:ke.catalogType;return xe(typeof be=="string"?be:null)},[xe]),ht=f.useMemo(()=>m.some(ve=>Ve(ve)),[m,Ve]),Qe=ir({queryKey:["feature-canvas","pipeline",e],queryFn:()=>ox(e),enabled:!!e,staleTime:60*1e3,retry:1}),Ne=Qe.isLoading||Qe.isFetching,ze=f.useCallback(ve=>{y(be=>{const ke=Y(be),Le=te(ve,ke);return[...be,Le]}),V()},[te,Y,V,y]),Se=f.useCallback((ve,be)=>{y(ke=>ke.map(Le=>{if(Le.id!==ve)return Le;const Xe=vd(be);Xe&&typeof Xe=="object"&&delete Xe[ti];const et={...Le.data??{},config:Xe,isConfigured:!0};return Q({...Le,data:et})}))},[Q,y]),Be=f.useCallback((ve,be)=>{y(ke=>ke.map(Le=>{if(Le.id!==ve)return Le;const Xe={...Le.data??{},...be};return Q({...Le,data:Xe})}))},[Q,y]),He=f.useCallback((ve,be)=>{y(ke=>ke.map(Le=>{var Bt;if(Le.id!==ve)return Le;const Xe=(Bt=Le==null?void 0:Le.data)==null?void 0:Bt.catalogType,et=Xe?pe.get(Xe)??null:null,tt=be&&typeof be=="object"?vd(be):Vf(et??null),xt={...Le.data??{},config:tt,isConfigured:!1,backgroundExecutionStatus:"idle"};return Q({...Le,data:xt})}))},[pe,Q,y]),Ke=f.useCallback(()=>{ht&&(typeof window<"u"&&!window.confirm("Reset all preprocessing nodes to their default settings?")||y(ve=>ve.map(be=>{var tt;if(!Ve(be))return be;const ke=(tt=be==null?void 0:be.data)==null?void 0:tt.catalogType,Le=ke?pe.get(ke)??null:null,Xe=Vf(Le??null),et={...be.data??{},config:Xe,isConfigured:!1,backgroundExecutionStatus:"idle"};return Q({...be,data:et})})))},[pe,ht,Q,y,Ve]),st=f.useCallback(ve=>{var Bt,Ft;const{source:be,target:ke,sourceHandle:Le,targetHandle:Xe}=ve;if(!be||!ke||!Xe||be===ke)return!1;const et=m.find(ct=>ct.id===ke);if(!et)return!1;const tt=((Bt=et==null?void 0:et.data)==null?void 0:Bt.catalogType)??"",xt=tt?yd[tt]:void 0;if((Ft=xt==null?void 0:xt.inputs)!=null&&Ft.length){const ct=Mw(ke,Xe);if(!ct)return!1;const Tt=xt.inputs.find(gt=>gt.key===ct);return!Tt||!Le?!1:Tt.accepts&&Tt.accepts.length>0?Tt.accepts.some(gt=>{const Ct=U$[gt];return Ct?Ct(Le):!1}):!0}return!0},[m]),X=f.useCallback(ve=>{_(ke=>jy({...ve,type:"animatedEdge",animated:!0},ke));const be=[ve.source,ve.target].filter(ke=>!!ke);be.length&&ee(be)},[ee,_]);f.useEffect(()=>{if(!e){const ve=`Dataset input
(${R})`;if(j.current)y(be=>{let ke=!1;const Le=be.map(Xe=>{var tt;return Xe.id!=="dataset-source"||(((tt=Xe==null?void 0:Xe.data)==null?void 0:tt.label)??"")===ve?Xe:(ke=!0,Q({...Xe,data:{...Xe.data??{},label:ve,isDataset:!0,isRemovable:!1}}))});return ke?Le:be});else{const be=Gg(R),ke=J(be.nodes);j.current=!0,y(ke),_(be.edges),le(ke),V(),r==null||r({nodes:ke,edges:be.edges,pipeline:null,context:"sample"})}return}if(j.current=!1,Qe.isLoading){const ve=`Dataset input
(${R})`;y(be=>be.map(ke=>ke.id==="dataset-source"?Q({...ke,data:{...ke.data??{},label:ve,isDataset:!0,isRemovable:!1}}):ke));return}if(Qe.isError){const ve=Qe.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",ve),l==null||l(ve);const be=Gg(R),ke=J(be.nodes);y(ke),_(be.edges),le(ke),V(),r==null||r({nodes:ke,edges:be.edges,pipeline:null,context:"reset"});return}if(Qe.data){const ve=Qe.data.graph??{},be=Array.isArray(ve==null?void 0:ve.nodes)&&ve.nodes.length?ve.nodes:Ow(),ke=J(be),Xe=(Array.isArray(ve==null?void 0:ve.edges)?ve.edges:[]).map(et=>{var Ct;const tt=et==null?void 0:et.type,xt=!tt||tt==="smoothstep"||tt==="default"?"animatedEdge":tt,Bt=et==null?void 0:et.source,Ft=et==null?void 0:et.target,ct=ke.find(hn=>hn.id===Ft),Tt=(et==null?void 0:et.sourceHandle)??(Bt?`${Bt}-source`:void 0),gt=(et==null?void 0:et.targetHandle)??((Ct=ct==null?void 0:ct.data)!=null&&Ct.isDataset?void 0:Ft?`${Ft}-target`:void 0);return{...et,animated:(et==null?void 0:et.animated)??!0,type:xt,sourceHandle:Tt,targetHandle:gt}});y(ke),_(Xe),le(ke),V(),r==null||r({nodes:ke,edges:Xe,pipeline:Qe.data??null,context:"stored"});return}if(Qe.isFetched&&!Qe.data){const ve=Gg(R),be=J(ve.nodes);y(be),_(ve.edges),le(be),V(),r==null||r({nodes:be,edges:ve.edges,pipeline:null,context:"sample"})}},[R,r,l,Qe.data,Qe.error,Qe.isError,Qe.isFetched,Qe.isLoading,J,Q,V,_,y,e,le]),f.useEffect(()=>{n==null||n(m,v)},[v,m,n]);const Oe=f.useMemo(()=>{var ke;if(!z)return null;const ve=(ke=z==null?void 0:z.data)==null?void 0:ke.catalogType;if(!ve)return null;const be=pe.get(ve);return be?Vf(be):null},[pe,z]),Te=f.useMemo(()=>{var be,ke;if(!z||(be=z.data)!=null&&be.isDataset)return!1;const ve=(ke=z==null?void 0:z.data)==null?void 0:ke.catalogType;return xe(typeof ve=="string"?ve:null)},[xe,z]),ot=f.useMemo(()=>ie?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):re?a.jsx("p",{className:"text-danger",children:re}):Z.length?a.jsx(Ck,{nodes:Z,onAddNode:ze}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[re,ze,ie,Z]),jt=f.useCallback((ve,be)=>{W(be.id)},[W]);return a.jsxs("div",{className:"canvas-stage",children:[a.jsxs("div",{className:"canvas-stage__viewport","data-pipeline-loading":Ne?"true":"false","aria-busy":Ne,ref:D,children:[a.jsxs(Hb,{style:{width:"100%",height:"100%"},nodes:m,edges:v,nodeTypes:u,edgeTypes:d,onNodesChange:p,onEdgesChange:x,onConnect:X,isValidConnection:st,onNodeClick:jt,onInit:ve=>{E.current=ve,requestAnimationFrame(()=>ve.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:ql.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",proOptions:{hideAttribution:!0},defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:Sk,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(WE,{position:"bottom-left"}),a.jsx(XE,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:Ke,disabled:!ht,"aria-label":"Reset preprocessing nodes",title:ht?"Reset all preprocessing nodes to defaults":"No preprocessing nodes to reset",children:""}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:()=>k(!0),"aria-label":"Open node catalog",children:"+"})]}),a.jsxs("div",{className:`canvas-drawer${S?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:()=>k(!1),"aria-label":"Close catalog",children:""})]}),a.jsx("div",{className:"canvas-drawer__body",children:ot})]}),S&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:()=>k(!1)}),T&&z&&a.jsx(L$,{node:z,sourceId:e??null,graphSnapshot:G,onClose:H,onUpdateConfig:Se,onUpdateNodeData:Be,onResetConfig:He,defaultConfigTemplate:Oe,isResetAvailable:Te})]})}),aD=({sourceId:e})=>{var Ne,ze;const t=Qi(),n=f.useRef(null),[r,l]=f.useState(e??null),[i,u]=f.useState(null),[d,m]=f.useState(!0),[y,p]=f.useState(!1),[v,_]=f.useState(null),[x,j]=f.useState(null),[S,k]=f.useState(null),[M,P]=f.useState(null),[T,w]=f.useState(!1),A=f.useMemo(()=>["feature-canvas","pipeline",r],[r]),E=f.useRef(null),D=f.useRef({nodes:[],edges:[]}),$=f.useRef(!0),F=ir({queryKey:["feature-canvas","datasets"],queryFn:()=>ax(12),staleTime:5*60*1e3}),R=F.data??[],B=F.isLoading,ee=F.error?((Ne=F.error)==null?void 0:Ne.message)??"Unable to load datasets":null,le=f.useMemo(()=>R.filter(Se=>(Se==null?void 0:Se.is_owned)!==!1),[R]);f.useEffect(()=>{if(!R.length){u(null);return}if(r){const Be=R.find(He=>He.source_id===r);if(Be){u(He=>(He==null?void 0:He.id)===Be.id?He:Be);return}}const Se=le[0]??R[0];Se&&(r||l(Se.source_id??String(Se.id)),u(Se))},[r,R,le]);const z=ir({queryKey:["feature-canvas","pipeline-history",r],queryFn:()=>ix(r,sD),enabled:!!r,staleTime:30*1e3,retry:1}),G=z.data??[],W=z.isLoading||z.isFetching,H=z.error?((ze=z.error)==null?void 0:ze.message)??"Unable to load history":null,{mutate:V,isPending:ne}=Im({mutationFn:async({sourceId:Se,payload:Be})=>lx(Se,Be),onSuccess:(Se,Be)=>{_({message:"Draft saved successfully.",tone:"success"}),p(!1),j(Se.id??null),P(Se.name??null),k(Se.updated_at??null),E.current=Se.id??null,t.setQueryData(["feature-canvas","pipeline",Be.sourceId],Se),t.invalidateQueries({queryKey:["feature-canvas","pipeline-history",Be.sourceId],exact:!1})},onError:Se=>{_({message:(Se==null?void 0:Se.message)??"Failed to save pipeline.",tone:"error"})}});f.useEffect(()=>{if(!v||v.tone==="error"||typeof window>"u")return;const Se=window.setTimeout(()=>_(null),v.tone==="success"?4e3:2500);return()=>window.clearTimeout(Se)},[v]);const Q=f.useCallback((Se,Be)=>{const He={nodes:JSON.parse(JSON.stringify(Se??[])),edges:JSON.parse(JSON.stringify(Be??[]))},Ke=D.current,st=JSON.stringify(Ke.nodes??[])===JSON.stringify(He.nodes??[])&&JSON.stringify(Ke.edges??[])===JSON.stringify(He.edges??[]);D.current=He;const X=Array.isArray(He.nodes)?He.nodes.some(Te=>(Te==null?void 0:Te.id)&&Te.id!=="dataset-source"):!1,Oe=Array.isArray(He.edges)?He.edges.length>0:!1;w(X||Oe),!($.current||st)&&(p(!0),_(null))},[]),K=f.useCallback(Se=>{const{nodes:Be,edges:He,pipeline:Ke,context:st}=Se,X={nodes:JSON.parse(JSON.stringify(Be??[])),edges:JSON.parse(JSON.stringify(He??[]))};D.current=X;const Oe=(X.nodes??[]).some(jt=>jt.id!=="dataset-source"),Te=Array.isArray(X.edges)?X.edges.length>0:!1;w(Oe||Te);const ot=(Ke==null?void 0:Ke.id)??null;if(j(ot),P((Ke==null?void 0:Ke.name)??null),k((Ke==null?void 0:Ke.updated_at)??null),st==="stored"&&Ke)if(E.current===Ke.id){const rn=Jg(Ke.updated_at)??Xg(Ke.updated_at);_({message:`Loaded revision ${Ke.name??`#${Ke.id}`} (${rn})`,tone:"info"}),E.current=null}else $.current&&_(jt=>(jt==null?void 0:jt.tone)==="error"?jt:Oe?{message:"Loaded saved pipeline",tone:"info"}:jt);else st==="sample"?(E.current=null,_(jt=>(jt==null?void 0:jt.tone)==="error"||Oe?jt:{message:`Showing starter pipeline for ${(i==null?void 0:i.name)??(i==null?void 0:i.source_id)??r??"demo dataset"}`,tone:"info"})):st==="reset"?E.current=null:Ke||(E.current=null,_(jt=>(jt==null?void 0:jt.tone)==="error"?jt:null));$.current&&p(!1),Ke&&E.current&&E.current!==Ke.id&&(E.current=null),$.current=!1},[r,i,w]),J=f.useCallback(Se=>{_({message:(Se==null?void 0:Se.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[]),te=f.useCallback(Se=>{if(!(Se!=null&&Se.graph)){_({message:"Selected revision is missing pipeline data.",tone:"error"});return}y&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(E.current=Se.id??null,$.current=!0,_({message:`Loading revision ${Se.name??`#${Se.id}`}`,tone:"info"}),t.setQueryData(A,Se))},[y,A,t]),Y=f.useCallback(()=>{var He;if(!r){_({message:"Select a dataset before saving.",tone:"error"});return}const Se=D.current;if(!Se.nodes||!Se.nodes.length){_({message:"Add nodes to the canvas before saving.",tone:"error"});return}const Be={name:i!=null&&i.name?`Draft pipeline for ${i.name}`:`Draft pipeline for ${r}`,graph:{nodes:Se.nodes,edges:(Se.edges??[]).map(Ke=>{const st=Ke==null?void 0:Ke.type,X=!st||st==="smoothstep"||st==="default"?"animatedEdge":st;return{...Ke,animated:(Ke==null?void 0:Ke.animated)??!0,type:X}})},metadata:{lastClientSave:new Date().toISOString(),nodeCount:Se.nodes.length,edgeCount:((He=Se.edges)==null?void 0:He.length)??0}};_({message:"Saving draft",tone:"info"}),V({sourceId:r,payload:Be})},[r,i==null?void 0:i.name,V]),U=f.useCallback(()=>{var Se;T&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((Se=n.current)==null||Se.clearGraph(),_(Be=>(Be==null?void 0:Be.tone)==="error"?Be:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[T,n,_]),Z=(v==null?void 0:v.tone)==="success"?"":(v==null?void 0:v.tone)==="error"?"":"",ie=f.useCallback(()=>{m(Se=>!Se)},[]),re=f.useCallback(Se=>{const Be=R.find(He=>He.source_id===Se)??null;if(!Be){_({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(Be.is_owned===!1){_({message:"Only datasets you own can be selected.",tone:"error"});return}l(Se),u(Be),$.current=!0,p(!1),_(null)},[R]),pe=ne?"Saving":y?"Save draft*":"Save draft",xe=!r||ne,Ve=v?v.tone==="error"?"text-danger":v.tone==="success"?"text-success":"text-muted":"text-muted",ht=R.map(Se=>({value:Se.source_id,label:Se.name??Se.source_id,isOwned:Se.is_owned!==!1})),Qe=le.length>1;return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":d?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:ie,"aria-label":d?"Collapse details panel":"Expand details panel","aria-expanded":d,"aria-controls":"feature-canvas-sidepanel",children:d?"":""}),!d&&v&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${Ve}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:Z}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:v.message})]}),d&&a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),S&&a.jsx("span",{className:"canvas-sidepanel__meta",children:Jg(S)??Xg(S)})]}),ee?a.jsx("p",{className:"text-danger",children:ee}):le.length?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:r??"",onChange:Se=>re(Se.target.value),disabled:B||!Qe,"aria-label":"Select dataset",children:ht.map(Se=>a.jsx("option",{value:Se.value,disabled:!Se.isOwned,children:`${Se.label}${Se.isOwned?"":" (locked)"}`},Se.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),B&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!B&&!R.length&&!ee&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(i==null?void 0:i.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:i.description}),r&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:(i==null?void 0:i.name)??r})]}),!Qe&&le.length>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:U,disabled:!T,"aria-label":"Clean all nodes",title:T?"Remove all nodes and edges from the canvas":"Nothing to clean yet",children:[a.jsx("span",{"aria-hidden":"true",children:""}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:()=>z.refetch(),disabled:W||!r,"aria-label":"Refresh history",title:"Refresh history",children:""}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:Y,disabled:xe,"aria-label":pe,title:pe,children:""})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:W?a.jsx("p",{className:"text-muted",children:"Loading history"}):H?a.jsx("p",{className:"text-danger",children:H}):G.length?G.map(Se=>{const He=Jg(Se.updated_at)??Xg(Se.updated_at),Ke=Se.id===x,st=Ke&&!y;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${Ke?" canvas-sidepanel__history-item--active":""}`,onClick:()=>te(Se),disabled:st,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:Se.name||`Pipeline #${Se.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:He}),Ke&&y&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},Se.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),v&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${Ve}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:Z}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:v.message})]})]}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(Vb,{children:a.jsx(rD,{ref:n,sourceId:r,datasetName:(i==null?void 0:i.name)??(i==null?void 0:i.source_id)??null,onGraphChange:Q,onPipelineHydrated:K,onPipelineError:J})})})]})},oD=new Cj,Zg=document.getElementById("ml-workflow-root");if(!Zg)throw new Error("ML workflow root element not found");const lD=ip.createRoot(Zg),iD=Zg.getAttribute("data-source-id")||void 0;lD.render(a.jsx(Ae.StrictMode,{children:a.jsx(Ej,{client:oD,children:a.jsx(aD,{sourceId:iD})})}))})();
//# sourceMappingURL=feature-canvas.js.map
