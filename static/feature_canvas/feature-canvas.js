var Bw=ln=>{throw TypeError(ln)};var Dp=(ln,_n,vn)=>_n.has(ln)||Bw("Cannot "+vn);var se=(ln,_n,vn)=>(Dp(ln,_n,"read from private field"),vn?vn.call(ln):_n.get(ln)),Ve=(ln,_n,vn)=>_n.has(ln)?Bw("Cannot add the same private member more than once"):_n instanceof WeakSet?_n.add(ln):_n.set(ln,vn),Te=(ln,_n,vn,lo)=>(Dp(ln,_n,"write to private field"),lo?lo.call(ln,vn):_n.set(ln,vn),vn),gt=(ln,_n,vn)=>(Dp(ln,_n,"access private method"),vn);var mm=(ln,_n,vn,lo)=>({set _(ht){Te(ln,_n,ht,vn)},get _(){return se(ln,_n,lo)}});(function(){"use strict";var Na,cf,Qx,Ao,ja,Ai,Xx,Oi,Ca,Ti,Jx,Oo,Zx,To,$i,Xs,$o,Ln,Jl,Po,dr,fa,e0,Ss,xt,Zl,ms,Ro,Pi,Wr,Sa,ec,Ri,Li,Lo,zo,Ea,zi,Rt,zc,Fp,Ip,Bp,Up,qp,Hp,Vp,Uw,t0,tc,Nr,hs,Do,jr,io,n0,Kr,mr,nc,s0,Yr,ka,Es,Gr,Qr,hm,Wp,r0,Cr,a0,cn,Ma,Aa,Di,Fi,Oa,Ii,Bi,o0;function ln(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _n={exports:{}},vn={},lo={exports:{}},ht={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kp;function qw(){if(Kp)return ht;Kp=1;var e=Symbol.for("react.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),l=Symbol.for("react.provider"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function g(z){return z===null||typeof z!="object"?null:(z=p&&z[p]||z["@@iterator"],typeof z=="function"?z:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,v={};function x(z,H,te){this.props=z,this.context=H,this.refs=v,this.updater=te||_}x.prototype.isReactComponent={},x.prototype.setState=function(z,H){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,H,"setState")},x.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function j(){}j.prototype=x.prototype;function k(z,H,te){this.props=z,this.context=H,this.refs=v,this.updater=te||_}var S=k.prototype=new j;S.constructor=k,N(S,x.prototype),S.isPureReactComponent=!0;var C=Array.isArray,w=Object.prototype.hasOwnProperty,E={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function R(z,H,te){var K,V={},G=null,Q=null;if(H!=null)for(K in H.ref!==void 0&&(Q=H.ref),H.key!==void 0&&(G=""+H.key),H)w.call(H,K)&&!A.hasOwnProperty(K)&&(V[K]=H[K]);var ne=arguments.length-2;if(ne===1)V.children=te;else if(1<ne){for(var J=Array(ne),re=0;re<ne;re++)J[re]=arguments[re+2];V.children=J}if(z&&z.defaultProps)for(K in ne=z.defaultProps,ne)V[K]===void 0&&(V[K]=ne[K]);return{$$typeof:e,type:z,key:G,ref:Q,props:V,_owner:E.current}}function P(z,H){return{$$typeof:e,type:z.type,key:H,ref:z.ref,props:z.props,_owner:z._owner}}function T(z){return typeof z=="object"&&z!==null&&z.$$typeof===e}function O(z){var H={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(te){return H[te]})}var F=/\/+/g;function B(z,H){return typeof z=="object"&&z!==null&&z.key!=null?O(""+z.key):H.toString(36)}function L(z,H,te,K,V){var G=typeof z;(G==="undefined"||G==="boolean")&&(z=null);var Q=!1;if(z===null)Q=!0;else switch(G){case"string":case"number":Q=!0;break;case"object":switch(z.$$typeof){case e:case t:Q=!0}}if(Q)return Q=z,V=V(Q),z=K===""?"."+B(Q,0):K,C(V)?(te="",z!=null&&(te=z.replace(F,"$&/")+"/"),L(V,H,te,"",function(re){return re})):V!=null&&(T(V)&&(V=P(V,te+(!V.key||Q&&Q.key===V.key?"":(""+V.key).replace(F,"$&/")+"/")+z)),H.push(V)),1;if(Q=0,K=K===""?".":K+":",C(z))for(var ne=0;ne<z.length;ne++){G=z[ne];var J=K+B(G,ne);Q+=L(G,H,te,J,V)}else if(J=g(z),typeof J=="function")for(z=J.call(z),ne=0;!(G=z.next()).done;)G=G.value,J=K+B(G,ne++),Q+=L(G,H,te,J,V);else if(G==="object")throw H=String(z),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return Q}function D(z,H,te){if(z==null)return z;var K=[],V=0;return L(z,K,"","",function(G){return H.call(te,G,V++)}),K}function q(z){if(z._status===-1){var H=z._result;H=H(),H.then(function(te){(z._status===0||z._status===-1)&&(z._status=1,z._result=te)},function(te){(z._status===0||z._status===-1)&&(z._status=2,z._result=te)}),z._status===-1&&(z._status=0,z._result=H)}if(z._status===1)return z._result.default;throw z._result}var Y={current:null},W={transition:null},X={ReactCurrentDispatcher:Y,ReactCurrentBatchConfig:W,ReactCurrentOwner:E};function I(){throw Error("act(...) is not supported in production builds of React.")}return ht.Children={map:D,forEach:function(z,H,te){D(z,function(){H.apply(this,arguments)},te)},count:function(z){var H=0;return D(z,function(){H++}),H},toArray:function(z){return D(z,function(H){return H})||[]},only:function(z){if(!T(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},ht.Component=x,ht.Fragment=n,ht.Profiler=i,ht.PureComponent=k,ht.StrictMode=s,ht.Suspense=d,ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,ht.act=I,ht.cloneElement=function(z,H,te){if(z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+z+".");var K=N({},z.props),V=z.key,G=z.ref,Q=z._owner;if(H!=null){if(H.ref!==void 0&&(G=H.ref,Q=E.current),H.key!==void 0&&(V=""+H.key),z.type&&z.type.defaultProps)var ne=z.type.defaultProps;for(J in H)w.call(H,J)&&!A.hasOwnProperty(J)&&(K[J]=H[J]===void 0&&ne!==void 0?ne[J]:H[J])}var J=arguments.length-2;if(J===1)K.children=te;else if(1<J){ne=Array(J);for(var re=0;re<J;re++)ne[re]=arguments[re+2];K.children=ne}return{$$typeof:e,type:z.type,key:V,ref:G,props:K,_owner:Q}},ht.createContext=function(z){return z={$$typeof:c,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},z.Provider={$$typeof:l,_context:z},z.Consumer=z},ht.createElement=R,ht.createFactory=function(z){var H=R.bind(null,z);return H.type=z,H},ht.createRef=function(){return{current:null}},ht.forwardRef=function(z){return{$$typeof:u,render:z}},ht.isValidElement=T,ht.lazy=function(z){return{$$typeof:h,_payload:{_status:-1,_result:z},_init:q}},ht.memo=function(z,H){return{$$typeof:f,type:z,compare:H===void 0?null:H}},ht.startTransition=function(z){var H=W.transition;W.transition={};try{z()}finally{W.transition=H}},ht.unstable_act=I,ht.useCallback=function(z,H){return Y.current.useCallback(z,H)},ht.useContext=function(z){return Y.current.useContext(z)},ht.useDebugValue=function(){},ht.useDeferredValue=function(z){return Y.current.useDeferredValue(z)},ht.useEffect=function(z,H){return Y.current.useEffect(z,H)},ht.useId=function(){return Y.current.useId()},ht.useImperativeHandle=function(z,H,te){return Y.current.useImperativeHandle(z,H,te)},ht.useInsertionEffect=function(z,H){return Y.current.useInsertionEffect(z,H)},ht.useLayoutEffect=function(z,H){return Y.current.useLayoutEffect(z,H)},ht.useMemo=function(z,H){return Y.current.useMemo(z,H)},ht.useReducer=function(z,H,te){return Y.current.useReducer(z,H,te)},ht.useRef=function(z){return Y.current.useRef(z)},ht.useState=function(z){return Y.current.useState(z)},ht.useSyncExternalStore=function(z,H,te){return Y.current.useSyncExternalStore(z,H,te)},ht.useTransition=function(){return Y.current.useTransition()},ht.version="18.3.1",ht}lo.exports=qw();var y=lo.exports;const ge=ln(y);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yp;function Hw(){if(Yp)return vn;Yp=1;var e=y,t=Symbol.for("react.element"),n=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,i=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(u,d,f){var h,p={},g=null,_=null;f!==void 0&&(g=""+f),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(_=d.ref);for(h in d)s.call(d,h)&&!l.hasOwnProperty(h)&&(p[h]=d[h]);if(u&&u.defaultProps)for(h in d=u.defaultProps,d)p[h]===void 0&&(p[h]=d[h]);return{$$typeof:t,type:u,key:g,ref:_,props:p,_owner:i.current}}return vn.Fragment=n,vn.jsx=c,vn.jsxs=c,vn}_n.exports=Hw();var a=_n.exports,fm={},Gp={exports:{}},ws={},pm={exports:{}},gm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qp;function Vw(){return Qp||(Qp=1,function(e){function t(W,X){var I=W.length;W.push(X);e:for(;0<I;){var z=I-1>>>1,H=W[z];if(0<i(H,X))W[z]=X,W[I]=H,I=z;else break e}}function n(W){return W.length===0?null:W[0]}function s(W){if(W.length===0)return null;var X=W[0],I=W.pop();if(I!==X){W[0]=I;e:for(var z=0,H=W.length,te=H>>>1;z<te;){var K=2*(z+1)-1,V=W[K],G=K+1,Q=W[G];if(0>i(V,I))G<H&&0>i(Q,V)?(W[z]=Q,W[G]=I,z=G):(W[z]=V,W[K]=I,z=K);else if(G<H&&0>i(Q,I))W[z]=Q,W[G]=I,z=G;else break e}}return X}function i(W,X){var I=W.sortIndex-X.sortIndex;return I!==0?I:W.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;e.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();e.unstable_now=function(){return c.now()-u}}var d=[],f=[],h=1,p=null,g=3,_=!1,N=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,j=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(W){for(var X=n(f);X!==null;){if(X.callback===null)s(f);else if(X.startTime<=W)s(f),X.sortIndex=X.expirationTime,t(d,X);else break;X=n(f)}}function C(W){if(v=!1,S(W),!N)if(n(d)!==null)N=!0,q(w);else{var X=n(f);X!==null&&Y(C,X.startTime-W)}}function w(W,X){N=!1,v&&(v=!1,j(R),R=-1),_=!0;var I=g;try{for(S(X),p=n(d);p!==null&&(!(p.expirationTime>X)||W&&!O());){var z=p.callback;if(typeof z=="function"){p.callback=null,g=p.priorityLevel;var H=z(p.expirationTime<=X);X=e.unstable_now(),typeof H=="function"?p.callback=H:p===n(d)&&s(d),S(X)}else s(d);p=n(d)}if(p!==null)var te=!0;else{var K=n(f);K!==null&&Y(C,K.startTime-X),te=!1}return te}finally{p=null,g=I,_=!1}}var E=!1,A=null,R=-1,P=5,T=-1;function O(){return!(e.unstable_now()-T<P)}function F(){if(A!==null){var W=e.unstable_now();T=W;var X=!0;try{X=A(!0,W)}finally{X?B():(E=!1,A=null)}}else E=!1}var B;if(typeof k=="function")B=function(){k(F)};else if(typeof MessageChannel<"u"){var L=new MessageChannel,D=L.port2;L.port1.onmessage=F,B=function(){D.postMessage(null)}}else B=function(){x(F,0)};function q(W){A=W,E||(E=!0,B())}function Y(W,X){R=x(function(){W(e.unstable_now())},X)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(W){W.callback=null},e.unstable_continueExecution=function(){N||_||(N=!0,q(w))},e.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<W?Math.floor(1e3/W):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(W){switch(g){case 1:case 2:case 3:var X=3;break;default:X=g}var I=g;g=X;try{return W()}finally{g=I}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(W,X){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var I=g;g=W;try{return X()}finally{g=I}},e.unstable_scheduleCallback=function(W,X,I){var z=e.unstable_now();switch(typeof I=="object"&&I!==null?(I=I.delay,I=typeof I=="number"&&0<I?z+I:z):I=z,W){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=I+H,W={id:h++,callback:X,priorityLevel:W,startTime:I,expirationTime:H,sortIndex:-1},I>z?(W.sortIndex=I,t(f,W),n(d)===null&&W===n(f)&&(v?(j(R),R=-1):v=!0,Y(C,I-z))):(W.sortIndex=H,t(d,W),N||_||(N=!0,q(w))),W},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(W){var X=g;return function(){var I=g;g=X;try{return W.apply(this,arguments)}finally{g=I}}}}(gm)),gm}var Xp;function Ww(){return Xp||(Xp=1,pm.exports=Vw()),pm.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jp;function Kw(){if(Jp)return ws;Jp=1;var e=y,t=Ww();function n(r){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+r,m=1;m<arguments.length;m++)o+="&args[]="+encodeURIComponent(arguments[m]);return"Minified React error #"+r+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var s=new Set,i={};function l(r,o){c(r,o),c(r+"Capture",o)}function c(r,o){for(i[r]=o,r=0;r<o.length;r++)s.add(o[r])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function g(r){return d.call(p,r)?!0:d.call(h,r)?!1:f.test(r)?p[r]=!0:(h[r]=!0,!1)}function _(r,o,m,b){if(m!==null&&m.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return b?!1:m!==null?!m.acceptsBooleans:(r=r.toLowerCase().slice(0,5),r!=="data-"&&r!=="aria-");default:return!1}}function N(r,o,m,b){if(o===null||typeof o>"u"||_(r,o,m,b))return!0;if(b)return!1;if(m!==null)switch(m.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v(r,o,m,b,M,$,U){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=b,this.attributeNamespace=M,this.mustUseProperty=m,this.propertyName=r,this.type=o,this.sanitizeURL=$,this.removeEmptyString=U}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(r){x[r]=new v(r,0,!1,r,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(r){var o=r[0];x[o]=new v(o,1,!1,r[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(r){x[r]=new v(r,2,!1,r.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(r){x[r]=new v(r,2,!1,r,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(r){x[r]=new v(r,3,!1,r.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(r){x[r]=new v(r,3,!0,r,null,!1,!1)}),["capture","download"].forEach(function(r){x[r]=new v(r,4,!1,r,null,!1,!1)}),["cols","rows","size","span"].forEach(function(r){x[r]=new v(r,6,!1,r,null,!1,!1)}),["rowSpan","start"].forEach(function(r){x[r]=new v(r,5,!1,r.toLowerCase(),null,!1,!1)});var j=/[\-:]([a-z])/g;function k(r){return r[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(r){var o=r.replace(j,k);x[o]=new v(o,1,!1,r,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(r){var o=r.replace(j,k);x[o]=new v(o,1,!1,r,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(r){var o=r.replace(j,k);x[o]=new v(o,1,!1,r,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(r){x[r]=new v(r,1,!1,r.toLowerCase(),null,!1,!1)}),x.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(r){x[r]=new v(r,1,!1,r.toLowerCase(),null,!0,!0)});function S(r,o,m,b){var M=x.hasOwnProperty(o)?x[o]:null;(M!==null?M.type!==0:b||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(N(o,m,M,b)&&(m=null),b||M===null?g(o)&&(m===null?r.removeAttribute(o):r.setAttribute(o,""+m)):M.mustUseProperty?r[M.propertyName]=m===null?M.type===3?!1:"":m:(o=M.attributeName,b=M.attributeNamespace,m===null?r.removeAttribute(o):(M=M.type,m=M===3||M===4&&m===!0?"":""+m,b?r.setAttributeNS(b,o,m):r.setAttribute(o,m))))}var C=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=Symbol.for("react.element"),E=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),O=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),Y=Symbol.for("react.offscreen"),W=Symbol.iterator;function X(r){return r===null||typeof r!="object"?null:(r=W&&r[W]||r["@@iterator"],typeof r=="function"?r:null)}var I=Object.assign,z;function H(r){if(z===void 0)try{throw Error()}catch(m){var o=m.stack.trim().match(/\n( *(at )?)/);z=o&&o[1]||""}return`
`+z+r}var te=!1;function K(r,o){if(!r||te)return"";te=!0;var m=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(he){var b=he}Reflect.construct(r,[],o)}else{try{o.call()}catch(he){b=he}r.call(o.prototype)}else{try{throw Error()}catch(he){b=he}r()}}catch(he){if(he&&b&&typeof he.stack=="string"){for(var M=he.stack.split(`
`),$=b.stack.split(`
`),U=M.length-1,ee=$.length-1;1<=U&&0<=ee&&M[U]!==$[ee];)ee--;for(;1<=U&&0<=ee;U--,ee--)if(M[U]!==$[ee]){if(U!==1||ee!==1)do if(U--,ee--,0>ee||M[U]!==$[ee]){var ae=`
`+M[U].replace(" at new "," at ");return r.displayName&&ae.includes("<anonymous>")&&(ae=ae.replace("<anonymous>",r.displayName)),ae}while(1<=U&&0<=ee);break}}}finally{te=!1,Error.prepareStackTrace=m}return(r=r?r.displayName||r.name:"")?H(r):""}function V(r){switch(r.tag){case 5:return H(r.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return r=K(r.type,!1),r;case 11:return r=K(r.type.render,!1),r;case 1:return r=K(r.type,!0),r;default:return""}}function G(r){if(r==null)return null;if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case A:return"Fragment";case E:return"Portal";case P:return"Profiler";case R:return"StrictMode";case B:return"Suspense";case L:return"SuspenseList"}if(typeof r=="object")switch(r.$$typeof){case O:return(r.displayName||"Context")+".Consumer";case T:return(r._context.displayName||"Context")+".Provider";case F:var o=r.render;return r=r.displayName,r||(r=o.displayName||o.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case D:return o=r.displayName||null,o!==null?o:G(r.type)||"Memo";case q:o=r._payload,r=r._init;try{return G(r(o))}catch{}}return null}function Q(r){var o=r.type;switch(r.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return r=o.render,r=r.displayName||r.name||"",o.displayName||(r!==""?"ForwardRef("+r+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return G(o);case 8:return o===R?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ne(r){switch(typeof r){case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function J(r){var o=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function re(r){var o=J(r)?"checked":"value",m=Object.getOwnPropertyDescriptor(r.constructor.prototype,o),b=""+r[o];if(!r.hasOwnProperty(o)&&typeof m<"u"&&typeof m.get=="function"&&typeof m.set=="function"){var M=m.get,$=m.set;return Object.defineProperty(r,o,{configurable:!0,get:function(){return M.call(this)},set:function(U){b=""+U,$.call(this,U)}}),Object.defineProperty(r,o,{enumerable:m.enumerable}),{getValue:function(){return b},setValue:function(U){b=""+U},stopTracking:function(){r._valueTracker=null,delete r[o]}}}}function Se(r){r._valueTracker||(r._valueTracker=re(r))}function Re(r){if(!r)return!1;var o=r._valueTracker;if(!o)return!0;var m=o.getValue(),b="";return r&&(b=J(r)?r.checked?"true":"false":r.value),r=b,r!==m?(o.setValue(r),!0):!1}function Oe(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}function Fe(r,o){var m=o.checked;return I({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:m??r._wrapperState.initialChecked})}function lt(r,o){var m=o.defaultValue==null?"":o.defaultValue,b=o.checked!=null?o.checked:o.defaultChecked;m=ne(o.value!=null?o.value:m),r._wrapperState={initialChecked:b,initialValue:m,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Be(r,o){o=o.checked,o!=null&&S(r,"checked",o,!1)}function de(r,o){Be(r,o);var m=ne(o.value),b=o.type;if(m!=null)b==="number"?(m===0&&r.value===""||r.value!=m)&&(r.value=""+m):r.value!==""+m&&(r.value=""+m);else if(b==="submit"||b==="reset"){r.removeAttribute("value");return}o.hasOwnProperty("value")?xe(r,o.type,m):o.hasOwnProperty("defaultValue")&&xe(r,o.type,ne(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(r.defaultChecked=!!o.defaultChecked)}function pe(r,o,m){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var b=o.type;if(!(b!=="submit"&&b!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+r._wrapperState.initialValue,m||o===r.value||(r.value=o),r.defaultValue=o}m=r.name,m!==""&&(r.name=""),r.defaultChecked=!!r._wrapperState.initialChecked,m!==""&&(r.name=m)}function xe(r,o,m){(o!=="number"||Oe(r.ownerDocument)!==r)&&(m==null?r.defaultValue=""+r._wrapperState.initialValue:r.defaultValue!==""+m&&(r.defaultValue=""+m))}var ke=Array.isArray;function Ue(r,o,m,b){if(r=r.options,o){o={};for(var M=0;M<m.length;M++)o["$"+m[M]]=!0;for(m=0;m<r.length;m++)M=o.hasOwnProperty("$"+r[m].value),r[m].selected!==M&&(r[m].selected=M),M&&b&&(r[m].defaultSelected=!0)}else{for(m=""+ne(m),o=null,M=0;M<r.length;M++){if(r[M].value===m){r[M].selected=!0,b&&(r[M].defaultSelected=!0);return}o!==null||r[M].disabled||(o=r[M])}o!==null&&(o.selected=!0)}}function ce(r,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return I({},o,{value:void 0,defaultValue:void 0,children:""+r._wrapperState.initialValue})}function Me(r,o){var m=o.value;if(m==null){if(m=o.children,o=o.defaultValue,m!=null){if(o!=null)throw Error(n(92));if(ke(m)){if(1<m.length)throw Error(n(93));m=m[0]}o=m}o==null&&(o=""),m=o}r._wrapperState={initialValue:ne(m)}}function Ye(r,o){var m=ne(o.value),b=ne(o.defaultValue);m!=null&&(m=""+m,m!==r.value&&(r.value=m),o.defaultValue==null&&r.defaultValue!==m&&(r.defaultValue=m)),b!=null&&(r.defaultValue=""+b)}function at(r){var o=r.textContent;o===r._wrapperState.initialValue&&o!==""&&o!==null&&(r.value=o)}function Ze(r){switch(r){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _t(r,o){return r==null||r==="http://www.w3.org/1999/xhtml"?Ze(o):r==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":r}var st,dt=function(r){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,m,b,M){MSApp.execUnsafeLocalFunction(function(){return r(o,m,b,M)})}:r}(function(r,o){if(r.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in r)r.innerHTML=o;else{for(st=st||document.createElement("div"),st.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=st.firstChild;r.firstChild;)r.removeChild(r.firstChild);for(;o.firstChild;)r.appendChild(o.firstChild)}});function jt(r,o){if(o){var m=r.firstChild;if(m&&m===r.lastChild&&m.nodeType===3){m.nodeValue=o;return}}r.textContent=o}var zt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ge=["Webkit","ms","Moz","O"];Object.keys(zt).forEach(function(r){Ge.forEach(function(o){o=o+r.charAt(0).toUpperCase()+r.substring(1),zt[o]=zt[r]})});function Ft(r,o,m){return o==null||typeof o=="boolean"||o===""?"":m||typeof o!="number"||o===0||zt.hasOwnProperty(r)&&zt[r]?(""+o).trim():o+"px"}function Kt(r,o){r=r.style;for(var m in o)if(o.hasOwnProperty(m)){var b=m.indexOf("--")===0,M=Ft(m,o[m],b);m==="float"&&(m="cssFloat"),b?r.setProperty(m,M):r[m]=M}}var Mt=I({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tn(r,o){if(o){if(Mt[r]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,r));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function Sn(r,o){if(r.indexOf("-")===-1)return typeof o.is=="string";switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var At=null;function nn(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var En=null,It=null,ut=null;function zn(r){if(r=Jo(r)){if(typeof En!="function")throw Error(n(280));var o=r.stateNode;o&&(o=Zi(o),En(r.stateNode,r.type,o))}}function Qt(r){It?ut?ut.push(r):ut=[r]:It=r}function ft(){if(It){var r=It,o=ut;if(ut=It=null,zn(r),o)for(r=0;r<o.length;r++)zn(o[r])}}function tt(r,o){return r(o)}function fs(){}var Vt=!1;function pt(r,o,m){if(Vt)return r(o,m);Vt=!0;try{return tt(r,o,m)}finally{Vt=!1,(It!==null||ut!==null)&&(fs(),ft())}}function bt(r,o){var m=r.stateNode;if(m===null)return null;var b=Zi(m);if(b===null)return null;m=b[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(b=!b.disabled)||(r=r.type,b=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!b;break e;default:r=!1}if(r)return null;if(m&&typeof m!="function")throw Error(n(231,o,typeof m));return m}var ns=!1;if(u)try{var hn={};Object.defineProperty(hn,"passive",{get:function(){ns=!0}}),window.addEventListener("test",hn,hn),window.removeEventListener("test",hn,hn)}catch{ns=!1}function bn(r,o,m,b,M,$,U,ee,ae){var he=Array.prototype.slice.call(arguments,3);try{o.apply(m,he)}catch(be){this.onError(be)}}var un=!1,kn=null,sn=!1,ss=null,$t={onError:function(r){un=!0,kn=r}};function Dn(r,o,m,b,M,$,U,ee,ae){un=!1,kn=null,bn.apply($t,arguments)}function xn(r,o,m,b,M,$,U,ee,ae){if(Dn.apply(this,arguments),un){if(un){var he=kn;un=!1,kn=null}else throw Error(n(198));sn||(sn=!0,ss=he)}}function wn(r){var o=r,m=r;if(r.alternate)for(;o.return;)o=o.return;else{r=o;do o=r,o.flags&4098&&(m=o.return),r=o.return;while(r)}return o.tag===3?m:null}function Js(r){if(r.tag===13){var o=r.memoizedState;if(o===null&&(r=r.alternate,r!==null&&(o=r.memoizedState)),o!==null)return o.dehydrated}return null}function Kn(r){if(wn(r)!==r)throw Error(n(188))}function Is(r){var o=r.alternate;if(!o){if(o=wn(r),o===null)throw Error(n(188));return o!==r?null:r}for(var m=r,b=o;;){var M=m.return;if(M===null)break;var $=M.alternate;if($===null){if(b=M.return,b!==null){m=b;continue}break}if(M.child===$.child){for($=M.child;$;){if($===m)return Kn(M),r;if($===b)return Kn(M),o;$=$.sibling}throw Error(n(188))}if(m.return!==b.return)m=M,b=$;else{for(var U=!1,ee=M.child;ee;){if(ee===m){U=!0,m=M,b=$;break}if(ee===b){U=!0,b=M,m=$;break}ee=ee.sibling}if(!U){for(ee=$.child;ee;){if(ee===m){U=!0,m=$,b=M;break}if(ee===b){U=!0,b=$,m=M;break}ee=ee.sibling}if(!U)throw Error(n(189))}}if(m.alternate!==b)throw Error(n(190))}if(m.tag!==3)throw Error(n(188));return m.stateNode.current===m?r:o}function rs(r){return r=Is(r),r!==null?ps(r):null}function ps(r){if(r.tag===5||r.tag===6)return r;for(r=r.child;r!==null;){var o=ps(r);if(o!==null)return o;r=r.sibling}return null}var Bs=t.unstable_scheduleCallback,Yn=t.unstable_cancelCallback,as=t.unstable_shouldYield,Wt=t.unstable_requestPaint,et=t.unstable_now,qe=t.unstable_getCurrentPriorityLevel,Fn=t.unstable_ImmediatePriority,Us=t.unstable_UserBlockingPriority,os=t.unstable_NormalPriority,qs=t.unstable_LowPriority,ie=t.unstable_IdlePriority,_e=null,$e=null;function Ct(r){if($e&&typeof $e.onCommitFiberRoot=="function")try{$e.onCommitFiberRoot(_e,r,void 0,(r.current.flags&128)===128)}catch{}}var we=Math.clz32?Math.clz32:Lt,rt=Math.log,ct=Math.LN2;function Lt(r){return r>>>=0,r===0?32:31-(rt(r)/ct|0)|0}var Ot=64,Pt=4194304;function Dt(r){switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return r&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return r}}function Xt(r,o){var m=r.pendingLanes;if(m===0)return 0;var b=0,M=r.suspendedLanes,$=r.pingedLanes,U=m&268435455;if(U!==0){var ee=U&~M;ee!==0?b=Dt(ee):($&=U,$!==0&&(b=Dt($)))}else U=m&~M,U!==0?b=Dt(U):$!==0&&(b=Dt($));if(b===0)return 0;if(o!==0&&o!==b&&!(o&M)&&(M=b&-b,$=o&-o,M>=$||M===16&&($&4194240)!==0))return o;if(b&4&&(b|=m&16),o=r.entangledLanes,o!==0)for(r=r.entanglements,o&=b;0<o;)m=31-we(o),M=1<<m,b|=r[m],o&=~M;return b}function gs(r,o){switch(r){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mn(r,o){for(var m=r.suspendedLanes,b=r.pingedLanes,M=r.expirationTimes,$=r.pendingLanes;0<$;){var U=31-we($),ee=1<<U,ae=M[U];ae===-1?(!(ee&m)||ee&b)&&(M[U]=gs(ee,o)):ae<=o&&(r.expiredLanes|=ee),$&=~ee}}function fn(r){return r=r.pendingLanes&-1073741825,r!==0?r:r&1073741824?1073741824:0}function dn(){var r=Ot;return Ot<<=1,!(Ot&4194240)&&(Ot=64),r}function Gn(r){for(var o=[],m=0;31>m;m++)o.push(r);return o}function In(r,o,m){r.pendingLanes|=o,o!==536870912&&(r.suspendedLanes=0,r.pingedLanes=0),r=r.eventTimes,o=31-we(o),r[o]=m}function Xr(r,o){var m=r.pendingLanes&~o;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.expiredLanes&=o,r.mutableReadLanes&=o,r.entangledLanes&=o,o=r.entanglements;var b=r.eventTimes;for(r=r.expirationTimes;0<m;){var M=31-we(m),$=1<<M;o[M]=0,b[M]=-1,r[M]=-1,m&=~$}}function Ta(r,o){var m=r.entangledLanes|=o;for(r=r.entanglements;m;){var b=31-we(m),M=1<<b;M&o|r[b]&o&&(r[b]|=o),m&=~M}}var vt=0;function Fo(r){return r&=-r,1<r?4<r?r&268435455?16:536870912:4:1}var Io,Jr,Bo,Ui,Uo,$a=!1,Zr=[],Hs=null,Z=null,fe=null,me=new Map,Ee=new Map,je=[],ye="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function nt(r,o){switch(r){case"focusin":case"focusout":Hs=null;break;case"dragenter":case"dragleave":Z=null;break;case"mouseover":case"mouseout":fe=null;break;case"pointerover":case"pointerout":me.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ee.delete(o.pointerId)}}function De(r,o,m,b,M,$){return r===null||r.nativeEvent!==$?(r={blockedOn:o,domEventName:m,eventSystemFlags:b,nativeEvent:$,targetContainers:[M]},o!==null&&(o=Jo(o),o!==null&&Jr(o)),r):(r.eventSystemFlags|=b,o=r.targetContainers,M!==null&&o.indexOf(M)===-1&&o.push(M),r)}function mt(r,o,m,b,M){switch(o){case"focusin":return Hs=De(Hs,r,o,m,b,M),!0;case"dragenter":return Z=De(Z,r,o,m,b,M),!0;case"mouseover":return fe=De(fe,r,o,m,b,M),!0;case"pointerover":var $=M.pointerId;return me.set($,De(me.get($)||null,r,o,m,b,M)),!0;case"gotpointercapture":return $=M.pointerId,Ee.set($,De(Ee.get($)||null,r,o,m,b,M)),!0}return!1}function ot(r){var o=oa(r.target);if(o!==null){var m=wn(o);if(m!==null){if(o=m.tag,o===13){if(o=Js(m),o!==null){r.blockedOn=o,Uo(r.priority,function(){Bo(m)});return}}else if(o===3&&m.stateNode.current.memoizedState.isDehydrated){r.blockedOn=m.tag===3?m.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Qe(r){if(r.blockedOn!==null)return!1;for(var o=r.targetContainers;0<o.length;){var m=vs(r.domEventName,r.eventSystemFlags,o[0],r.nativeEvent);if(m===null){m=r.nativeEvent;var b=new m.constructor(m.type,m);At=b,m.target.dispatchEvent(b),At=null}else return o=Jo(m),o!==null&&Jr(o),r.blockedOn=m,!1;o.shift()}return!0}function wt(r,o,m){Qe(r)&&m.delete(o)}function An(){$a=!1,Hs!==null&&Qe(Hs)&&(Hs=null),Z!==null&&Qe(Z)&&(Z=null),fe!==null&&Qe(fe)&&(fe=null),me.forEach(wt),Ee.forEach(wt)}function Bt(r,o){r.blockedOn===o&&(r.blockedOn=null,$a||($a=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,An)))}function pn(r){function o(M){return Bt(M,r)}if(0<Zr.length){Bt(Zr[0],r);for(var m=1;m<Zr.length;m++){var b=Zr[m];b.blockedOn===r&&(b.blockedOn=null)}}for(Hs!==null&&Bt(Hs,r),Z!==null&&Bt(Z,r),fe!==null&&Bt(fe,r),me.forEach(o),Ee.forEach(o),m=0;m<je.length;m++)b=je[m],b.blockedOn===r&&(b.blockedOn=null);for(;0<je.length&&(m=je[0],m.blockedOn===null);)ot(m),m.blockedOn===null&&je.shift()}var ks=C.ReactCurrentBatchConfig,_s=!0;function Vs(r,o,m,b){var M=vt,$=ks.transition;ks.transition=null;try{vt=1,Zs(r,o,m,b)}finally{vt=M,ks.transition=$}}function Sr(r,o,m,b){var M=vt,$=ks.transition;ks.transition=null;try{vt=4,Zs(r,o,m,b)}finally{vt=M,ks.transition=$}}function Zs(r,o,m,b){if(_s){var M=vs(r,o,m,b);if(M===null)_c(r,o,b,Qn,m),nt(r,b);else if(mt(M,r,o,m,b))b.stopPropagation();else if(nt(r,b),o&4&&-1<ye.indexOf(r)){for(;M!==null;){var $=Jo(M);if($!==null&&Io($),$=vs(r,o,m,b),$===null&&_c(r,o,b,Qn,m),$===M)break;M=$}M!==null&&b.stopPropagation()}else _c(r,o,b,null,m)}}var Qn=null;function vs(r,o,m,b){if(Qn=null,r=nn(b),r=oa(r),r!==null)if(o=wn(r),o===null)r=null;else if(m=o.tag,m===13){if(r=Js(o),r!==null)return r;r=null}else if(m===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;r=null}else o!==r&&(r=null);return Qn=r,null}function Pa(r){switch(r){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(qe()){case Fn:return 1;case Us:return 4;case os:case qs:return 16;case ie:return 536870912;default:return 16}default:return 16}}var Ms=null,Ra=null,ea=null;function La(){if(ea)return ea;var r,o=Ra,m=o.length,b,M="value"in Ms?Ms.value:Ms.textContent,$=M.length;for(r=0;r<m&&o[r]===M[r];r++);var U=m-r;for(b=1;b<=U&&o[m-b]===M[$-b];b++);return ea=M.slice(r,1<b?1-b:void 0)}function za(r){var o=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&o===13&&(r=13)):r=o,r===10&&(r=13),32<=r||r===13?r:0}function Da(){return!0}function Fa(){return!1}function On(r){function o(m,b,M,$,U){this._reactName=m,this._targetInst=M,this.type=b,this.nativeEvent=$,this.target=U,this.currentTarget=null;for(var ee in r)r.hasOwnProperty(ee)&&(m=r[ee],this[ee]=m?m($):$[ee]);return this.isDefaultPrevented=($.defaultPrevented!=null?$.defaultPrevented:$.returnValue===!1)?Da:Fa,this.isPropagationStopped=Fa,this}return I(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var m=this.nativeEvent;m&&(m.preventDefault?m.preventDefault():typeof m.returnValue!="unknown"&&(m.returnValue=!1),this.isDefaultPrevented=Da)},stopPropagation:function(){var m=this.nativeEvent;m&&(m.stopPropagation?m.stopPropagation():typeof m.cancelBubble!="unknown"&&(m.cancelBubble=!0),this.isPropagationStopped=Da)},persist:function(){},isPersistent:Da}),o}var Jt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ta=On(Jt),na=I({},Jt,{view:0,detail:0}),sc=On(na),sa,Zt,Nn,is=I({},na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ac,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Nn&&(Nn&&r.type==="mousemove"?(sa=r.screenX-Nn.screenX,Zt=r.screenY-Nn.screenY):Zt=sa=0,Nn=r),sa)},movementY:function(r){return"movementY"in r?r.movementY:Zt}}),qi=On(is),qo=I({},is,{dataTransfer:0}),Ho=On(qo),Ia=I({},na,{relatedTarget:0}),ra=On(Ia),Vo=I({},Jt,{animationName:0,elapsedTime:0,pseudoElement:0}),Wo=On(Vo),uf=I({},Jt,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),df=On(uf),mf=I({},Jt,{data:0}),rc=On(mf),hf={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ff={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gu={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Qu(r){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(r):(r=Gu[r])?!!o[r]:!1}function ac(){return Qu}var pf=I({},na,{key:function(r){if(r.key){var o=hf[r.key]||r.key;if(o!=="Unidentified")return o}return r.type==="keypress"?(r=za(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?ff[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ac,charCode:function(r){return r.type==="keypress"?za(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?za(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),Xu=On(pf),Ju=I({},is,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),aa=On(Ju),Zu=I({},na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ac}),gf=On(Zu),ed=I({},Jt,{propertyName:0,elapsedTime:0,pseudoElement:0}),td=On(ed),_f=I({},is,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),nd=On(_f),sd=[9,13,27,32],oc=u&&"CompositionEvent"in window,Ba=null;u&&"documentMode"in document&&(Ba=document.documentMode);var i0=u&&"TextEvent"in window&&!Ba,rd=u&&(!oc||Ba&&8<Ba&&11>=Ba),ad=" ",od=!1;function Er(r,o){switch(r){case"keyup":return sd.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hi(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var kr=!1;function Ko(r,o){switch(r){case"compositionend":return Hi(o);case"keypress":return o.which!==32?null:(od=!0,ad);case"textInput":return r=o.data,r===ad&&od?null:r;default:return null}}function Vi(r,o){if(kr)return r==="compositionend"||!oc&&Er(r,o)?(r=La(),ea=Ra=Ms=null,kr=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return rd&&o.locale!=="ko"?null:o.data;default:return null}}var Ua={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Mr(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o==="input"?!!Ua[r.type]:o==="textarea"}function id(r,o,m,b){Qt(b),o=Qi(o,"onChange"),0<o.length&&(m=new ta("onChange","change",null,m,b),r.push({event:m,listeners:o}))}var Yt=null,qt=null;function St(r){xd(r,0)}function ys(r){var o=Ga(r);if(Re(o))return r}function vf(r,o){if(r==="change")return o}var ld=!1;if(u){var qa;if(u){var ic="oninput"in document;if(!ic){var lc=document.createElement("div");lc.setAttribute("oninput","return;"),ic=typeof lc.oninput=="function"}qa=ic}else qa=!1;ld=qa&&(!document.documentMode||9<document.documentMode)}function rn(){Yt&&(Yt.detachEvent("onpropertychange",cd),qt=Yt=null)}function cd(r){if(r.propertyName==="value"&&ys(qt)){var o=[];id(o,qt,r,nn(r)),pt(St,o)}}function yf(r,o,m){r==="focusin"?(rn(),Yt=o,qt=m,Yt.attachEvent("onpropertychange",cd)):r==="focusout"&&rn()}function bf(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return ys(qt)}function xf(r,o){if(r==="click")return ys(o)}function wf(r,o){if(r==="input"||r==="change")return ys(o)}function Nf(r,o){return r===o&&(r!==0||1/r===1/o)||r!==r&&o!==o}var Ws=typeof Object.is=="function"?Object.is:Nf;function Yo(r,o){if(Ws(r,o))return!0;if(typeof r!="object"||r===null||typeof o!="object"||o===null)return!1;var m=Object.keys(r),b=Object.keys(o);if(m.length!==b.length)return!1;for(b=0;b<m.length;b++){var M=m[b];if(!d.call(o,M)||!Ws(r[M],o[M]))return!1}return!0}function ud(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function dd(r,o){var m=ud(r);r=0;for(var b;m;){if(m.nodeType===3){if(b=r+m.textContent.length,r<=o&&b>=o)return{node:m,offset:o-r};r=b}e:{for(;m;){if(m.nextSibling){m=m.nextSibling;break e}m=m.parentNode}m=void 0}m=ud(m)}}function md(r,o){return r&&o?r===o?!0:r&&r.nodeType===3?!1:o&&o.nodeType===3?md(r,o.parentNode):"contains"in r?r.contains(o):r.compareDocumentPosition?!!(r.compareDocumentPosition(o)&16):!1:!1}function hd(){for(var r=window,o=Oe();o instanceof r.HTMLIFrameElement;){try{var m=typeof o.contentWindow.location.href=="string"}catch{m=!1}if(m)r=o.contentWindow;else break;o=Oe(r.document)}return o}function cc(r){var o=r&&r.nodeName&&r.nodeName.toLowerCase();return o&&(o==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||o==="textarea"||r.contentEditable==="true")}function jf(r){var o=hd(),m=r.focusedElem,b=r.selectionRange;if(o!==m&&m&&m.ownerDocument&&md(m.ownerDocument.documentElement,m)){if(b!==null&&cc(m)){if(o=b.start,r=b.end,r===void 0&&(r=o),"selectionStart"in m)m.selectionStart=o,m.selectionEnd=Math.min(r,m.value.length);else if(r=(o=m.ownerDocument||document)&&o.defaultView||window,r.getSelection){r=r.getSelection();var M=m.textContent.length,$=Math.min(b.start,M);b=b.end===void 0?$:Math.min(b.end,M),!r.extend&&$>b&&(M=b,b=$,$=M),M=dd(m,$);var U=dd(m,b);M&&U&&(r.rangeCount!==1||r.anchorNode!==M.node||r.anchorOffset!==M.offset||r.focusNode!==U.node||r.focusOffset!==U.offset)&&(o=o.createRange(),o.setStart(M.node,M.offset),r.removeAllRanges(),$>b?(r.addRange(o),r.extend(U.node,U.offset)):(o.setEnd(U.node,U.offset),r.addRange(o)))}}for(o=[],r=m;r=r.parentNode;)r.nodeType===1&&o.push({element:r,left:r.scrollLeft,top:r.scrollTop});for(typeof m.focus=="function"&&m.focus(),m=0;m<o.length;m++)r=o[m],r.element.scrollLeft=r.left,r.element.scrollTop=r.top}}var Cf=u&&"documentMode"in document&&11>=document.documentMode,Ha=null,uc=null,Wi=null,fd=!1;function Ar(r,o,m){var b=m.window===m?m.document:m.nodeType===9?m:m.ownerDocument;fd||Ha==null||Ha!==Oe(b)||(b=Ha,"selectionStart"in b&&cc(b)?b={start:b.selectionStart,end:b.selectionEnd}:(b=(b.ownerDocument&&b.ownerDocument.defaultView||window).getSelection(),b={anchorNode:b.anchorNode,anchorOffset:b.anchorOffset,focusNode:b.focusNode,focusOffset:b.focusOffset}),Wi&&Yo(Wi,b)||(Wi=b,b=Qi(uc,"onSelect"),0<b.length&&(o=new ta("onSelect","select",null,o,m),r.push({event:o,listeners:b}),o.target=Ha)))}function Ki(r,o){var m={};return m[r.toLowerCase()]=o.toLowerCase(),m["Webkit"+r]="webkit"+o,m["Moz"+r]="moz"+o,m}var Va={animationend:Ki("Animation","AnimationEnd"),animationiteration:Ki("Animation","AnimationIteration"),animationstart:Ki("Animation","AnimationStart"),transitionend:Ki("Transition","TransitionEnd")},dc={},pd={};u&&(pd=document.createElement("div").style,"AnimationEvent"in window||(delete Va.animationend.animation,delete Va.animationiteration.animation,delete Va.animationstart.animation),"TransitionEvent"in window||delete Va.transitionend.transition);function Wa(r){if(dc[r])return dc[r];if(!Va[r])return r;var o=Va[r],m;for(m in o)if(o.hasOwnProperty(m)&&m in pd)return dc[r]=o[m];return r}var mc=Wa("animationend"),gd=Wa("animationiteration"),_d=Wa("animationstart"),hc=Wa("transitionend"),vd=new Map,yd="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Or(r,o){vd.set(r,o),l(o,[r])}for(var fc=0;fc<yd.length;fc++){var pc=yd[fc],Sf=pc.toLowerCase(),Ef=pc[0].toUpperCase()+pc.slice(1);Or(Sf,"on"+Ef)}Or(mc,"onAnimationEnd"),Or(gd,"onAnimationIteration"),Or(_d,"onAnimationStart"),Or("dblclick","onDoubleClick"),Or("focusin","onFocus"),Or("focusout","onBlur"),Or(hc,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Go));function bd(r,o,m){var b=r.type||"unknown-event";r.currentTarget=m,xn(b,o,void 0,r),r.currentTarget=null}function xd(r,o){o=(o&4)!==0;for(var m=0;m<r.length;m++){var b=r[m],M=b.event;b=b.listeners;e:{var $=void 0;if(o)for(var U=b.length-1;0<=U;U--){var ee=b[U],ae=ee.instance,he=ee.currentTarget;if(ee=ee.listener,ae!==$&&M.isPropagationStopped())break e;bd(M,ee,he),$=ae}else for(U=0;U<b.length;U++){if(ee=b[U],ae=ee.instance,he=ee.currentTarget,ee=ee.listener,ae!==$&&M.isPropagationStopped())break e;bd(M,ee,he),$=ae}}}if(sn)throw r=ss,sn=!1,ss=null,r}function Ht(r,o){var m=o[xc];m===void 0&&(m=o[xc]=new Set);var b=r+"__bubble";m.has(b)||(Mf(o,r,2,!1),m.add(b))}function gc(r,o,m){var b=0;o&&(b|=4),Mf(m,r,b,o)}var Yi="_reactListening"+Math.random().toString(36).slice(2);function Qo(r){if(!r[Yi]){r[Yi]=!0,s.forEach(function(m){m!=="selectionchange"&&(kf.has(m)||gc(m,!1,r),gc(m,!0,r))});var o=r.nodeType===9?r:r.ownerDocument;o===null||o[Yi]||(o[Yi]=!0,gc("selectionchange",!1,o))}}function Mf(r,o,m,b){switch(Pa(o)){case 1:var M=Vs;break;case 4:M=Sr;break;default:M=Zs}m=M.bind(null,o,m,r),M=void 0,!ns||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(M=!0),b?M!==void 0?r.addEventListener(o,m,{capture:!0,passive:M}):r.addEventListener(o,m,!0):M!==void 0?r.addEventListener(o,m,{passive:M}):r.addEventListener(o,m,!1)}function _c(r,o,m,b,M){var $=b;if(!(o&1)&&!(o&2)&&b!==null)e:for(;;){if(b===null)return;var U=b.tag;if(U===3||U===4){var ee=b.stateNode.containerInfo;if(ee===M||ee.nodeType===8&&ee.parentNode===M)break;if(U===4)for(U=b.return;U!==null;){var ae=U.tag;if((ae===3||ae===4)&&(ae=U.stateNode.containerInfo,ae===M||ae.nodeType===8&&ae.parentNode===M))return;U=U.return}for(;ee!==null;){if(U=oa(ee),U===null)return;if(ae=U.tag,ae===5||ae===6){b=$=U;continue e}ee=ee.parentNode}}b=b.return}pt(function(){var he=$,be=nn(m),Ne=[];e:{var ve=vd.get(r);if(ve!==void 0){var Pe=ta,ze=r;switch(r){case"keypress":if(za(m)===0)break e;case"keydown":case"keyup":Pe=Xu;break;case"focusin":ze="focus",Pe=ra;break;case"focusout":ze="blur",Pe=ra;break;case"beforeblur":case"afterblur":Pe=ra;break;case"click":if(m.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Pe=qi;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Pe=Ho;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Pe=gf;break;case mc:case gd:case _d:Pe=Wo;break;case hc:Pe=td;break;case"scroll":Pe=sc;break;case"wheel":Pe=nd;break;case"copy":case"cut":case"paste":Pe=df;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Pe=aa}var Ie=(o&4)!==0,gn=!Ie&&r==="scroll",le=Ie?ve!==null?ve+"Capture":null:ve;Ie=[];for(var oe=he,ue;oe!==null;){ue=oe;var Ce=ue.stateNode;if(ue.tag===5&&Ce!==null&&(ue=Ce,le!==null&&(Ce=bt(oe,le),Ce!=null&&Ie.push(Gi(oe,Ce,ue)))),gn)break;oe=oe.return}0<Ie.length&&(ve=new Pe(ve,ze,null,m,be),Ne.push({event:ve,listeners:Ie}))}}if(!(o&7)){e:{if(ve=r==="mouseover"||r==="pointerover",Pe=r==="mouseout"||r==="pointerout",ve&&m!==At&&(ze=m.relatedTarget||m.fromElement)&&(oa(ze)||ze[hr]))break e;if((Pe||ve)&&(ve=be.window===be?be:(ve=be.ownerDocument)?ve.defaultView||ve.parentWindow:window,Pe?(ze=m.relatedTarget||m.toElement,Pe=he,ze=ze?oa(ze):null,ze!==null&&(gn=wn(ze),ze!==gn||ze.tag!==5&&ze.tag!==6)&&(ze=null)):(Pe=null,ze=he),Pe!==ze)){if(Ie=qi,Ce="onMouseLeave",le="onMouseEnter",oe="mouse",(r==="pointerout"||r==="pointerover")&&(Ie=aa,Ce="onPointerLeave",le="onPointerEnter",oe="pointer"),gn=Pe==null?ve:Ga(Pe),ue=ze==null?ve:Ga(ze),ve=new Ie(Ce,oe+"leave",Pe,m,be),ve.target=gn,ve.relatedTarget=ue,Ce=null,oa(be)===he&&(Ie=new Ie(le,oe+"enter",ze,m,be),Ie.target=ue,Ie.relatedTarget=gn,Ce=Ie),gn=Ce,Pe&&ze)t:{for(Ie=Pe,le=ze,oe=0,ue=Ie;ue;ue=Ka(ue))oe++;for(ue=0,Ce=le;Ce;Ce=Ka(Ce))ue++;for(;0<oe-ue;)Ie=Ka(Ie),oe--;for(;0<ue-oe;)le=Ka(le),ue--;for(;oe--;){if(Ie===le||le!==null&&Ie===le.alternate)break t;Ie=Ka(Ie),le=Ka(le)}Ie=null}else Ie=null;Pe!==null&&wd(Ne,ve,Pe,Ie,!1),ze!==null&&gn!==null&&wd(Ne,gn,ze,Ie,!0)}}e:{if(ve=he?Ga(he):window,Pe=ve.nodeName&&ve.nodeName.toLowerCase(),Pe==="select"||Pe==="input"&&ve.type==="file")var He=vf;else if(Mr(ve))if(ld)He=wf;else{He=bf;var Xe=yf}else(Pe=ve.nodeName)&&Pe.toLowerCase()==="input"&&(ve.type==="checkbox"||ve.type==="radio")&&(He=xf);if(He&&(He=He(r,he))){id(Ne,He,m,be);break e}Xe&&Xe(r,ve,he),r==="focusout"&&(Xe=ve._wrapperState)&&Xe.controlled&&ve.type==="number"&&xe(ve,"number",ve.value)}switch(Xe=he?Ga(he):window,r){case"focusin":(Mr(Xe)||Xe.contentEditable==="true")&&(Ha=Xe,uc=he,Wi=null);break;case"focusout":Wi=uc=Ha=null;break;case"mousedown":fd=!0;break;case"contextmenu":case"mouseup":case"dragend":fd=!1,Ar(Ne,m,be);break;case"selectionchange":if(Cf)break;case"keydown":case"keyup":Ar(Ne,m,be)}var Je;if(oc)e:{switch(r){case"compositionstart":var it="onCompositionStart";break e;case"compositionend":it="onCompositionEnd";break e;case"compositionupdate":it="onCompositionUpdate";break e}it=void 0}else kr?Er(r,m)&&(it="onCompositionEnd"):r==="keydown"&&m.keyCode===229&&(it="onCompositionStart");it&&(rd&&m.locale!=="ko"&&(kr||it!=="onCompositionStart"?it==="onCompositionEnd"&&kr&&(Je=La()):(Ms=be,Ra="value"in Ms?Ms.value:Ms.textContent,kr=!0)),Xe=Qi(he,it),0<Xe.length&&(it=new rc(it,r,null,m,be),Ne.push({event:it,listeners:Xe}),Je?it.data=Je:(Je=Hi(m),Je!==null&&(it.data=Je)))),(Je=i0?Ko(r,m):Vi(r,m))&&(he=Qi(he,"onBeforeInput"),0<he.length&&(be=new rc("onBeforeInput","beforeinput",null,m,be),Ne.push({event:be,listeners:he}),be.data=Je))}xd(Ne,o)})}function Gi(r,o,m){return{instance:r,listener:o,currentTarget:m}}function Qi(r,o){for(var m=o+"Capture",b=[];r!==null;){var M=r,$=M.stateNode;M.tag===5&&$!==null&&(M=$,$=bt(r,m),$!=null&&b.unshift(Gi(r,$,M)),$=bt(r,o),$!=null&&b.push(Gi(r,$,M))),r=r.return}return b}function Ka(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5);return r||null}function wd(r,o,m,b,M){for(var $=o._reactName,U=[];m!==null&&m!==b;){var ee=m,ae=ee.alternate,he=ee.stateNode;if(ae!==null&&ae===b)break;ee.tag===5&&he!==null&&(ee=he,M?(ae=bt(m,$),ae!=null&&U.unshift(Gi(m,ae,ee))):M||(ae=bt(m,$),ae!=null&&U.push(Gi(m,ae,ee)))),m=m.return}U.length!==0&&r.push({event:o,listeners:U})}var Af=/\r\n?/g,Of=/\u0000|\uFFFD/g;function Nd(r){return(typeof r=="string"?r:""+r).replace(Af,`
`).replace(Of,"")}function Xi(r,o,m){if(o=Nd(o),Nd(r)!==o&&m)throw Error(n(425))}function Ji(){}var jd=null,vc=null;function yc(r,o){return r==="textarea"||r==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var bc=typeof setTimeout=="function"?setTimeout:void 0,Tf=typeof clearTimeout=="function"?clearTimeout:void 0,Cd=typeof Promise=="function"?Promise:void 0,$f=typeof queueMicrotask=="function"?queueMicrotask:typeof Cd<"u"?function(r){return Cd.resolve(null).then(r).catch(Pf)}:bc;function Pf(r){setTimeout(function(){throw r})}function Sd(r,o){var m=o,b=0;do{var M=m.nextSibling;if(r.removeChild(m),M&&M.nodeType===8)if(m=M.data,m==="/$"){if(b===0){r.removeChild(M),pn(o);return}b--}else m!=="$"&&m!=="$?"&&m!=="$!"||b++;m=M}while(m);pn(o)}function Tr(r){for(;r!=null;r=r.nextSibling){var o=r.nodeType;if(o===1||o===3)break;if(o===8){if(o=r.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return r}function Ed(r){r=r.previousSibling;for(var o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="$"||m==="$!"||m==="$?"){if(o===0)return r;o--}else m==="/$"&&o++}r=r.previousSibling}return null}var Ya=Math.random().toString(36).slice(2),er="__reactFiber$"+Ya,Xo="__reactProps$"+Ya,hr="__reactContainer$"+Ya,xc="__reactEvents$"+Ya,l0="__reactListeners$"+Ya,Rf="__reactHandles$"+Ya;function oa(r){var o=r[er];if(o)return o;for(var m=r.parentNode;m;){if(o=m[hr]||m[er]){if(m=o.alternate,o.child!==null||m!==null&&m.child!==null)for(r=Ed(r);r!==null;){if(m=r[er])return m;r=Ed(r)}return o}r=m,m=r.parentNode}return null}function Jo(r){return r=r[er]||r[hr],!r||r.tag!==5&&r.tag!==6&&r.tag!==13&&r.tag!==3?null:r}function Ga(r){if(r.tag===5||r.tag===6)return r.stateNode;throw Error(n(33))}function Zi(r){return r[Xo]||null}var wc=[],Qa=-1;function $r(r){return{current:r}}function Et(r){0>Qa||(r.current=wc[Qa],wc[Qa]=null,Qa--)}function Ke(r,o){Qa++,wc[Qa]=r.current,r.current=o}var Pr={},Tn=$r(Pr),Xn=$r(!1),Rr=Pr;function Gt(r,o){var m=r.type.contextTypes;if(!m)return Pr;var b=r.stateNode;if(b&&b.__reactInternalMemoizedUnmaskedChildContext===o)return b.__reactInternalMemoizedMaskedChildContext;var M={},$;for($ in m)M[$]=o[$];return b&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=o,r.__reactInternalMemoizedMaskedChildContext=M),M}function Bn(r){return r=r.childContextTypes,r!=null}function kd(){Et(Xn),Et(Tn)}function c0(r,o,m){if(Tn.current!==Pr)throw Error(n(168));Ke(Tn,o),Ke(Xn,m)}function u0(r,o,m){var b=r.stateNode;if(o=o.childContextTypes,typeof b.getChildContext!="function")return m;b=b.getChildContext();for(var M in b)if(!(M in o))throw Error(n(108,Q(r)||"Unknown",M));return I({},m,b)}function Md(r){return r=(r=r.stateNode)&&r.__reactInternalMemoizedMergedChildContext||Pr,Rr=Tn.current,Ke(Tn,r),Ke(Xn,Xn.current),!0}function d0(r,o,m){var b=r.stateNode;if(!b)throw Error(n(169));m?(r=u0(r,o,Rr),b.__reactInternalMemoizedMergedChildContext=r,Et(Xn),Et(Tn),Ke(Tn,r)):Et(Xn),Ke(Xn,m)}var ia=null,Ad=!1,Lf=!1;function m0(r){ia===null?ia=[r]:ia.push(r)}function qL(r){Ad=!0,m0(r)}function Xa(){if(!Lf&&ia!==null){Lf=!0;var r=0,o=vt;try{var m=ia;for(vt=1;r<m.length;r++){var b=m[r];do b=b(!0);while(b!==null)}ia=null,Ad=!1}catch(M){throw ia!==null&&(ia=ia.slice(r+1)),Bs(Fn,Xa),M}finally{vt=o,Lf=!1}}return null}var el=[],tl=0,Od=null,Td=0,tr=[],nr=0,Zo=null,la=1,ca="";function ei(r,o){el[tl++]=Td,el[tl++]=Od,Od=r,Td=o}function h0(r,o,m){tr[nr++]=la,tr[nr++]=ca,tr[nr++]=Zo,Zo=r;var b=la;r=ca;var M=32-we(b)-1;b&=~(1<<M),m+=1;var $=32-we(o)+M;if(30<$){var U=M-M%5;$=(b&(1<<U)-1).toString(32),b>>=U,M-=U,la=1<<32-we(o)+M|m<<M|b,ca=$+r}else la=1<<$|m<<M|b,ca=r}function zf(r){r.return!==null&&(ei(r,1),h0(r,1,0))}function Df(r){for(;r===Od;)Od=el[--tl],el[tl]=null,Td=el[--tl],el[tl]=null;for(;r===Zo;)Zo=tr[--nr],tr[nr]=null,ca=tr[--nr],tr[nr]=null,la=tr[--nr],tr[nr]=null}var Ks=null,Ys=null,en=!1,fr=null;function f0(r,o){var m=or(5,null,null,0);m.elementType="DELETED",m.stateNode=o,m.return=r,o=r.deletions,o===null?(r.deletions=[m],r.flags|=16):o.push(m)}function p0(r,o){switch(r.tag){case 5:var m=r.type;return o=o.nodeType!==1||m.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(r.stateNode=o,Ks=r,Ys=Tr(o.firstChild),!0):!1;case 6:return o=r.pendingProps===""||o.nodeType!==3?null:o,o!==null?(r.stateNode=o,Ks=r,Ys=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(m=Zo!==null?{id:la,overflow:ca}:null,r.memoizedState={dehydrated:o,treeContext:m,retryLane:1073741824},m=or(18,null,null,0),m.stateNode=o,m.return=r,r.child=m,Ks=r,Ys=null,!0):!1;default:return!1}}function Ff(r){return(r.mode&1)!==0&&(r.flags&128)===0}function If(r){if(en){var o=Ys;if(o){var m=o;if(!p0(r,o)){if(Ff(r))throw Error(n(418));o=Tr(m.nextSibling);var b=Ks;o&&p0(r,o)?f0(b,m):(r.flags=r.flags&-4097|2,en=!1,Ks=r)}}else{if(Ff(r))throw Error(n(418));r.flags=r.flags&-4097|2,en=!1,Ks=r}}}function g0(r){for(r=r.return;r!==null&&r.tag!==5&&r.tag!==3&&r.tag!==13;)r=r.return;Ks=r}function $d(r){if(r!==Ks)return!1;if(!en)return g0(r),en=!0,!1;var o;if((o=r.tag!==3)&&!(o=r.tag!==5)&&(o=r.type,o=o!=="head"&&o!=="body"&&!yc(r.type,r.memoizedProps)),o&&(o=Ys)){if(Ff(r))throw _0(),Error(n(418));for(;o;)f0(r,o),o=Tr(o.nextSibling)}if(g0(r),r.tag===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(n(317));e:{for(r=r.nextSibling,o=0;r;){if(r.nodeType===8){var m=r.data;if(m==="/$"){if(o===0){Ys=Tr(r.nextSibling);break e}o--}else m!=="$"&&m!=="$!"&&m!=="$?"||o++}r=r.nextSibling}Ys=null}}else Ys=Ks?Tr(r.stateNode.nextSibling):null;return!0}function _0(){for(var r=Ys;r;)r=Tr(r.nextSibling)}function nl(){Ys=Ks=null,en=!1}function Bf(r){fr===null?fr=[r]:fr.push(r)}var HL=C.ReactCurrentBatchConfig;function Nc(r,o,m){if(r=m.ref,r!==null&&typeof r!="function"&&typeof r!="object"){if(m._owner){if(m=m._owner,m){if(m.tag!==1)throw Error(n(309));var b=m.stateNode}if(!b)throw Error(n(147,r));var M=b,$=""+r;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===$?o.ref:(o=function(U){var ee=M.refs;U===null?delete ee[$]:ee[$]=U},o._stringRef=$,o)}if(typeof r!="string")throw Error(n(284));if(!m._owner)throw Error(n(290,r))}return r}function Pd(r,o){throw r=Object.prototype.toString.call(o),Error(n(31,r==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":r))}function v0(r){var o=r._init;return o(r._payload)}function y0(r){function o(le,oe){if(r){var ue=le.deletions;ue===null?(le.deletions=[oe],le.flags|=16):ue.push(oe)}}function m(le,oe){if(!r)return null;for(;oe!==null;)o(le,oe),oe=oe.sibling;return null}function b(le,oe){for(le=new Map;oe!==null;)oe.key!==null?le.set(oe.key,oe):le.set(oe.index,oe),oe=oe.sibling;return le}function M(le,oe){return le=ao(le,oe),le.index=0,le.sibling=null,le}function $(le,oe,ue){return le.index=ue,r?(ue=le.alternate,ue!==null?(ue=ue.index,ue<oe?(le.flags|=2,oe):ue):(le.flags|=2,oe)):(le.flags|=1048576,oe)}function U(le){return r&&le.alternate===null&&(le.flags|=2),le}function ee(le,oe,ue,Ce){return oe===null||oe.tag!==6?(oe=Tp(ue,le.mode,Ce),oe.return=le,oe):(oe=M(oe,ue),oe.return=le,oe)}function ae(le,oe,ue,Ce){var He=ue.type;return He===A?be(le,oe,ue.props.children,Ce,ue.key):oe!==null&&(oe.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===q&&v0(He)===oe.type)?(Ce=M(oe,ue.props),Ce.ref=Nc(le,oe,ue),Ce.return=le,Ce):(Ce=rm(ue.type,ue.key,ue.props,null,le.mode,Ce),Ce.ref=Nc(le,oe,ue),Ce.return=le,Ce)}function he(le,oe,ue,Ce){return oe===null||oe.tag!==4||oe.stateNode.containerInfo!==ue.containerInfo||oe.stateNode.implementation!==ue.implementation?(oe=$p(ue,le.mode,Ce),oe.return=le,oe):(oe=M(oe,ue.children||[]),oe.return=le,oe)}function be(le,oe,ue,Ce,He){return oe===null||oe.tag!==7?(oe=li(ue,le.mode,Ce,He),oe.return=le,oe):(oe=M(oe,ue),oe.return=le,oe)}function Ne(le,oe,ue){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return oe=Tp(""+oe,le.mode,ue),oe.return=le,oe;if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case w:return ue=rm(oe.type,oe.key,oe.props,null,le.mode,ue),ue.ref=Nc(le,null,oe),ue.return=le,ue;case E:return oe=$p(oe,le.mode,ue),oe.return=le,oe;case q:var Ce=oe._init;return Ne(le,Ce(oe._payload),ue)}if(ke(oe)||X(oe))return oe=li(oe,le.mode,ue,null),oe.return=le,oe;Pd(le,oe)}return null}function ve(le,oe,ue,Ce){var He=oe!==null?oe.key:null;if(typeof ue=="string"&&ue!==""||typeof ue=="number")return He!==null?null:ee(le,oe,""+ue,Ce);if(typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case w:return ue.key===He?ae(le,oe,ue,Ce):null;case E:return ue.key===He?he(le,oe,ue,Ce):null;case q:return He=ue._init,ve(le,oe,He(ue._payload),Ce)}if(ke(ue)||X(ue))return He!==null?null:be(le,oe,ue,Ce,null);Pd(le,ue)}return null}function Pe(le,oe,ue,Ce,He){if(typeof Ce=="string"&&Ce!==""||typeof Ce=="number")return le=le.get(ue)||null,ee(oe,le,""+Ce,He);if(typeof Ce=="object"&&Ce!==null){switch(Ce.$$typeof){case w:return le=le.get(Ce.key===null?ue:Ce.key)||null,ae(oe,le,Ce,He);case E:return le=le.get(Ce.key===null?ue:Ce.key)||null,he(oe,le,Ce,He);case q:var Xe=Ce._init;return Pe(le,oe,ue,Xe(Ce._payload),He)}if(ke(Ce)||X(Ce))return le=le.get(ue)||null,be(oe,le,Ce,He,null);Pd(oe,Ce)}return null}function ze(le,oe,ue,Ce){for(var He=null,Xe=null,Je=oe,it=oe=0,Hn=null;Je!==null&&it<ue.length;it++){Je.index>it?(Hn=Je,Je=null):Hn=Je.sibling;var Tt=ve(le,Je,ue[it],Ce);if(Tt===null){Je===null&&(Je=Hn);break}r&&Je&&Tt.alternate===null&&o(le,Je),oe=$(Tt,oe,it),Xe===null?He=Tt:Xe.sibling=Tt,Xe=Tt,Je=Hn}if(it===ue.length)return m(le,Je),en&&ei(le,it),He;if(Je===null){for(;it<ue.length;it++)Je=Ne(le,ue[it],Ce),Je!==null&&(oe=$(Je,oe,it),Xe===null?He=Je:Xe.sibling=Je,Xe=Je);return en&&ei(le,it),He}for(Je=b(le,Je);it<ue.length;it++)Hn=Pe(Je,le,it,ue[it],Ce),Hn!==null&&(r&&Hn.alternate!==null&&Je.delete(Hn.key===null?it:Hn.key),oe=$(Hn,oe,it),Xe===null?He=Hn:Xe.sibling=Hn,Xe=Hn);return r&&Je.forEach(function(oo){return o(le,oo)}),en&&ei(le,it),He}function Ie(le,oe,ue,Ce){var He=X(ue);if(typeof He!="function")throw Error(n(150));if(ue=He.call(ue),ue==null)throw Error(n(151));for(var Xe=He=null,Je=oe,it=oe=0,Hn=null,Tt=ue.next();Je!==null&&!Tt.done;it++,Tt=ue.next()){Je.index>it?(Hn=Je,Je=null):Hn=Je.sibling;var oo=ve(le,Je,Tt.value,Ce);if(oo===null){Je===null&&(Je=Hn);break}r&&Je&&oo.alternate===null&&o(le,Je),oe=$(oo,oe,it),Xe===null?He=oo:Xe.sibling=oo,Xe=oo,Je=Hn}if(Tt.done)return m(le,Je),en&&ei(le,it),He;if(Je===null){for(;!Tt.done;it++,Tt=ue.next())Tt=Ne(le,Tt.value,Ce),Tt!==null&&(oe=$(Tt,oe,it),Xe===null?He=Tt:Xe.sibling=Tt,Xe=Tt);return en&&ei(le,it),He}for(Je=b(le,Je);!Tt.done;it++,Tt=ue.next())Tt=Pe(Je,le,it,Tt.value,Ce),Tt!==null&&(r&&Tt.alternate!==null&&Je.delete(Tt.key===null?it:Tt.key),oe=$(Tt,oe,it),Xe===null?He=Tt:Xe.sibling=Tt,Xe=Tt);return r&&Je.forEach(function(Nz){return o(le,Nz)}),en&&ei(le,it),He}function gn(le,oe,ue,Ce){if(typeof ue=="object"&&ue!==null&&ue.type===A&&ue.key===null&&(ue=ue.props.children),typeof ue=="object"&&ue!==null){switch(ue.$$typeof){case w:e:{for(var He=ue.key,Xe=oe;Xe!==null;){if(Xe.key===He){if(He=ue.type,He===A){if(Xe.tag===7){m(le,Xe.sibling),oe=M(Xe,ue.props.children),oe.return=le,le=oe;break e}}else if(Xe.elementType===He||typeof He=="object"&&He!==null&&He.$$typeof===q&&v0(He)===Xe.type){m(le,Xe.sibling),oe=M(Xe,ue.props),oe.ref=Nc(le,Xe,ue),oe.return=le,le=oe;break e}m(le,Xe);break}else o(le,Xe);Xe=Xe.sibling}ue.type===A?(oe=li(ue.props.children,le.mode,Ce,ue.key),oe.return=le,le=oe):(Ce=rm(ue.type,ue.key,ue.props,null,le.mode,Ce),Ce.ref=Nc(le,oe,ue),Ce.return=le,le=Ce)}return U(le);case E:e:{for(Xe=ue.key;oe!==null;){if(oe.key===Xe)if(oe.tag===4&&oe.stateNode.containerInfo===ue.containerInfo&&oe.stateNode.implementation===ue.implementation){m(le,oe.sibling),oe=M(oe,ue.children||[]),oe.return=le,le=oe;break e}else{m(le,oe);break}else o(le,oe);oe=oe.sibling}oe=$p(ue,le.mode,Ce),oe.return=le,le=oe}return U(le);case q:return Xe=ue._init,gn(le,oe,Xe(ue._payload),Ce)}if(ke(ue))return ze(le,oe,ue,Ce);if(X(ue))return Ie(le,oe,ue,Ce);Pd(le,ue)}return typeof ue=="string"&&ue!==""||typeof ue=="number"?(ue=""+ue,oe!==null&&oe.tag===6?(m(le,oe.sibling),oe=M(oe,ue),oe.return=le,le=oe):(m(le,oe),oe=Tp(ue,le.mode,Ce),oe.return=le,le=oe),U(le)):m(le,oe)}return gn}var sl=y0(!0),b0=y0(!1),Rd=$r(null),Ld=null,rl=null,Uf=null;function qf(){Uf=rl=Ld=null}function Hf(r){var o=Rd.current;Et(Rd),r._currentValue=o}function Vf(r,o,m){for(;r!==null;){var b=r.alternate;if((r.childLanes&o)!==o?(r.childLanes|=o,b!==null&&(b.childLanes|=o)):b!==null&&(b.childLanes&o)!==o&&(b.childLanes|=o),r===m)break;r=r.return}}function al(r,o){Ld=r,Uf=rl=null,r=r.dependencies,r!==null&&r.firstContext!==null&&(r.lanes&o&&(As=!0),r.firstContext=null)}function sr(r){var o=r._currentValue;if(Uf!==r)if(r={context:r,memoizedValue:o,next:null},rl===null){if(Ld===null)throw Error(n(308));rl=r,Ld.dependencies={lanes:0,firstContext:r}}else rl=rl.next=r;return o}var ti=null;function Wf(r){ti===null?ti=[r]:ti.push(r)}function x0(r,o,m,b){var M=o.interleaved;return M===null?(m.next=m,Wf(o)):(m.next=M.next,M.next=m),o.interleaved=m,ua(r,b)}function ua(r,o){r.lanes|=o;var m=r.alternate;for(m!==null&&(m.lanes|=o),m=r,r=r.return;r!==null;)r.childLanes|=o,m=r.alternate,m!==null&&(m.childLanes|=o),m=r,r=r.return;return m.tag===3?m.stateNode:null}var Ja=!1;function Kf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function w0(r,o){r=r.updateQueue,o.updateQueue===r&&(o.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,effects:r.effects})}function da(r,o){return{eventTime:r,lane:o,tag:0,payload:null,callback:null,next:null}}function Za(r,o,m){var b=r.updateQueue;if(b===null)return null;if(b=b.shared,kt&2){var M=b.pending;return M===null?o.next=o:(o.next=M.next,M.next=o),b.pending=o,ua(r,m)}return M=b.interleaved,M===null?(o.next=o,Wf(b)):(o.next=M.next,M.next=o),b.interleaved=o,ua(r,m)}function zd(r,o,m){if(o=o.updateQueue,o!==null&&(o=o.shared,(m&4194240)!==0)){var b=o.lanes;b&=r.pendingLanes,m|=b,o.lanes=m,Ta(r,m)}}function N0(r,o){var m=r.updateQueue,b=r.alternate;if(b!==null&&(b=b.updateQueue,m===b)){var M=null,$=null;if(m=m.firstBaseUpdate,m!==null){do{var U={eventTime:m.eventTime,lane:m.lane,tag:m.tag,payload:m.payload,callback:m.callback,next:null};$===null?M=$=U:$=$.next=U,m=m.next}while(m!==null);$===null?M=$=o:$=$.next=o}else M=$=o;m={baseState:b.baseState,firstBaseUpdate:M,lastBaseUpdate:$,shared:b.shared,effects:b.effects},r.updateQueue=m;return}r=m.lastBaseUpdate,r===null?m.firstBaseUpdate=o:r.next=o,m.lastBaseUpdate=o}function Dd(r,o,m,b){var M=r.updateQueue;Ja=!1;var $=M.firstBaseUpdate,U=M.lastBaseUpdate,ee=M.shared.pending;if(ee!==null){M.shared.pending=null;var ae=ee,he=ae.next;ae.next=null,U===null?$=he:U.next=he,U=ae;var be=r.alternate;be!==null&&(be=be.updateQueue,ee=be.lastBaseUpdate,ee!==U&&(ee===null?be.firstBaseUpdate=he:ee.next=he,be.lastBaseUpdate=ae))}if($!==null){var Ne=M.baseState;U=0,be=he=ae=null,ee=$;do{var ve=ee.lane,Pe=ee.eventTime;if((b&ve)===ve){be!==null&&(be=be.next={eventTime:Pe,lane:0,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null});e:{var ze=r,Ie=ee;switch(ve=o,Pe=m,Ie.tag){case 1:if(ze=Ie.payload,typeof ze=="function"){Ne=ze.call(Pe,Ne,ve);break e}Ne=ze;break e;case 3:ze.flags=ze.flags&-65537|128;case 0:if(ze=Ie.payload,ve=typeof ze=="function"?ze.call(Pe,Ne,ve):ze,ve==null)break e;Ne=I({},Ne,ve);break e;case 2:Ja=!0}}ee.callback!==null&&ee.lane!==0&&(r.flags|=64,ve=M.effects,ve===null?M.effects=[ee]:ve.push(ee))}else Pe={eventTime:Pe,lane:ve,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},be===null?(he=be=Pe,ae=Ne):be=be.next=Pe,U|=ve;if(ee=ee.next,ee===null){if(ee=M.shared.pending,ee===null)break;ve=ee,ee=ve.next,ve.next=null,M.lastBaseUpdate=ve,M.shared.pending=null}}while(!0);if(be===null&&(ae=Ne),M.baseState=ae,M.firstBaseUpdate=he,M.lastBaseUpdate=be,o=M.shared.interleaved,o!==null){M=o;do U|=M.lane,M=M.next;while(M!==o)}else $===null&&(M.shared.lanes=0);ri|=U,r.lanes=U,r.memoizedState=Ne}}function j0(r,o,m){if(r=o.effects,o.effects=null,r!==null)for(o=0;o<r.length;o++){var b=r[o],M=b.callback;if(M!==null){if(b.callback=null,b=m,typeof M!="function")throw Error(n(191,M));M.call(b)}}}var jc={},Lr=$r(jc),Cc=$r(jc),Sc=$r(jc);function ni(r){if(r===jc)throw Error(n(174));return r}function Yf(r,o){switch(Ke(Sc,o),Ke(Cc,r),Ke(Lr,jc),r=o.nodeType,r){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:_t(null,"");break;default:r=r===8?o.parentNode:o,o=r.namespaceURI||null,r=r.tagName,o=_t(o,r)}Et(Lr),Ke(Lr,o)}function ol(){Et(Lr),Et(Cc),Et(Sc)}function C0(r){ni(Sc.current);var o=ni(Lr.current),m=_t(o,r.type);o!==m&&(Ke(Cc,r),Ke(Lr,m))}function Gf(r){Cc.current===r&&(Et(Lr),Et(Cc))}var an=$r(0);function Fd(r){for(var o=r;o!==null;){if(o.tag===13){var m=o.memoizedState;if(m!==null&&(m=m.dehydrated,m===null||m.data==="$?"||m.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Qf=[];function Xf(){for(var r=0;r<Qf.length;r++)Qf[r]._workInProgressVersionPrimary=null;Qf.length=0}var Id=C.ReactCurrentDispatcher,Jf=C.ReactCurrentBatchConfig,si=0,on=null,$n=null,Un=null,Bd=!1,Ec=!1,kc=0,VL=0;function ls(){throw Error(n(321))}function Zf(r,o){if(o===null)return!1;for(var m=0;m<o.length&&m<r.length;m++)if(!Ws(r[m],o[m]))return!1;return!0}function ep(r,o,m,b,M,$){if(si=$,on=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Id.current=r===null||r.memoizedState===null?GL:QL,r=m(b,M),Ec){$=0;do{if(Ec=!1,kc=0,25<=$)throw Error(n(301));$+=1,Un=$n=null,o.updateQueue=null,Id.current=XL,r=m(b,M)}while(Ec)}if(Id.current=Hd,o=$n!==null&&$n.next!==null,si=0,Un=$n=on=null,Bd=!1,o)throw Error(n(300));return r}function tp(){var r=kc!==0;return kc=0,r}function zr(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?on.memoizedState=Un=r:Un=Un.next=r,Un}function rr(){if($n===null){var r=on.alternate;r=r!==null?r.memoizedState:null}else r=$n.next;var o=Un===null?on.memoizedState:Un.next;if(o!==null)Un=o,$n=r;else{if(r===null)throw Error(n(310));$n=r,r={memoizedState:$n.memoizedState,baseState:$n.baseState,baseQueue:$n.baseQueue,queue:$n.queue,next:null},Un===null?on.memoizedState=Un=r:Un=Un.next=r}return Un}function Mc(r,o){return typeof o=="function"?o(r):o}function np(r){var o=rr(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var b=$n,M=b.baseQueue,$=m.pending;if($!==null){if(M!==null){var U=M.next;M.next=$.next,$.next=U}b.baseQueue=M=$,m.pending=null}if(M!==null){$=M.next,b=b.baseState;var ee=U=null,ae=null,he=$;do{var be=he.lane;if((si&be)===be)ae!==null&&(ae=ae.next={lane:0,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null}),b=he.hasEagerState?he.eagerState:r(b,he.action);else{var Ne={lane:be,action:he.action,hasEagerState:he.hasEagerState,eagerState:he.eagerState,next:null};ae===null?(ee=ae=Ne,U=b):ae=ae.next=Ne,on.lanes|=be,ri|=be}he=he.next}while(he!==null&&he!==$);ae===null?U=b:ae.next=ee,Ws(b,o.memoizedState)||(As=!0),o.memoizedState=b,o.baseState=U,o.baseQueue=ae,m.lastRenderedState=b}if(r=m.interleaved,r!==null){M=r;do $=M.lane,on.lanes|=$,ri|=$,M=M.next;while(M!==r)}else M===null&&(m.lanes=0);return[o.memoizedState,m.dispatch]}function sp(r){var o=rr(),m=o.queue;if(m===null)throw Error(n(311));m.lastRenderedReducer=r;var b=m.dispatch,M=m.pending,$=o.memoizedState;if(M!==null){m.pending=null;var U=M=M.next;do $=r($,U.action),U=U.next;while(U!==M);Ws($,o.memoizedState)||(As=!0),o.memoizedState=$,o.baseQueue===null&&(o.baseState=$),m.lastRenderedState=$}return[$,b]}function S0(){}function E0(r,o){var m=on,b=rr(),M=o(),$=!Ws(b.memoizedState,M);if($&&(b.memoizedState=M,As=!0),b=b.queue,rp(A0.bind(null,m,b,r),[r]),b.getSnapshot!==o||$||Un!==null&&Un.memoizedState.tag&1){if(m.flags|=2048,Ac(9,M0.bind(null,m,b,M,o),void 0,null),qn===null)throw Error(n(349));si&30||k0(m,o,M)}return M}function k0(r,o,m){r.flags|=16384,r={getSnapshot:o,value:m},o=on.updateQueue,o===null?(o={lastEffect:null,stores:null},on.updateQueue=o,o.stores=[r]):(m=o.stores,m===null?o.stores=[r]:m.push(r))}function M0(r,o,m,b){o.value=m,o.getSnapshot=b,O0(o)&&T0(r)}function A0(r,o,m){return m(function(){O0(o)&&T0(r)})}function O0(r){var o=r.getSnapshot;r=r.value;try{var m=o();return!Ws(r,m)}catch{return!0}}function T0(r){var o=ua(r,1);o!==null&&vr(o,r,1,-1)}function $0(r){var o=zr();return typeof r=="function"&&(r=r()),o.memoizedState=o.baseState=r,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Mc,lastRenderedState:r},o.queue=r,r=r.dispatch=YL.bind(null,on,r),[o.memoizedState,r]}function Ac(r,o,m,b){return r={tag:r,create:o,destroy:m,deps:b,next:null},o=on.updateQueue,o===null?(o={lastEffect:null,stores:null},on.updateQueue=o,o.lastEffect=r.next=r):(m=o.lastEffect,m===null?o.lastEffect=r.next=r:(b=m.next,m.next=r,r.next=b,o.lastEffect=r)),r}function P0(){return rr().memoizedState}function Ud(r,o,m,b){var M=zr();on.flags|=r,M.memoizedState=Ac(1|o,m,void 0,b===void 0?null:b)}function qd(r,o,m,b){var M=rr();b=b===void 0?null:b;var $=void 0;if($n!==null){var U=$n.memoizedState;if($=U.destroy,b!==null&&Zf(b,U.deps)){M.memoizedState=Ac(o,m,$,b);return}}on.flags|=r,M.memoizedState=Ac(1|o,m,$,b)}function R0(r,o){return Ud(8390656,8,r,o)}function rp(r,o){return qd(2048,8,r,o)}function L0(r,o){return qd(4,2,r,o)}function z0(r,o){return qd(4,4,r,o)}function D0(r,o){if(typeof o=="function")return r=r(),o(r),function(){o(null)};if(o!=null)return r=r(),o.current=r,function(){o.current=null}}function F0(r,o,m){return m=m!=null?m.concat([r]):null,qd(4,4,D0.bind(null,o,r),m)}function ap(){}function I0(r,o){var m=rr();o=o===void 0?null:o;var b=m.memoizedState;return b!==null&&o!==null&&Zf(o,b[1])?b[0]:(m.memoizedState=[r,o],r)}function B0(r,o){var m=rr();o=o===void 0?null:o;var b=m.memoizedState;return b!==null&&o!==null&&Zf(o,b[1])?b[0]:(r=r(),m.memoizedState=[r,o],r)}function U0(r,o,m){return si&21?(Ws(m,o)||(m=dn(),on.lanes|=m,ri|=m,r.baseState=!0),o):(r.baseState&&(r.baseState=!1,As=!0),r.memoizedState=m)}function WL(r,o){var m=vt;vt=m!==0&&4>m?m:4,r(!0);var b=Jf.transition;Jf.transition={};try{r(!1),o()}finally{vt=m,Jf.transition=b}}function q0(){return rr().memoizedState}function KL(r,o,m){var b=so(r);if(m={lane:b,action:m,hasEagerState:!1,eagerState:null,next:null},H0(r))V0(o,m);else if(m=x0(r,o,m,b),m!==null){var M=xs();vr(m,r,b,M),W0(m,o,b)}}function YL(r,o,m){var b=so(r),M={lane:b,action:m,hasEagerState:!1,eagerState:null,next:null};if(H0(r))V0(o,M);else{var $=r.alternate;if(r.lanes===0&&($===null||$.lanes===0)&&($=o.lastRenderedReducer,$!==null))try{var U=o.lastRenderedState,ee=$(U,m);if(M.hasEagerState=!0,M.eagerState=ee,Ws(ee,U)){var ae=o.interleaved;ae===null?(M.next=M,Wf(o)):(M.next=ae.next,ae.next=M),o.interleaved=M;return}}catch{}finally{}m=x0(r,o,M,b),m!==null&&(M=xs(),vr(m,r,b,M),W0(m,o,b))}}function H0(r){var o=r.alternate;return r===on||o!==null&&o===on}function V0(r,o){Ec=Bd=!0;var m=r.pending;m===null?o.next=o:(o.next=m.next,m.next=o),r.pending=o}function W0(r,o,m){if(m&4194240){var b=o.lanes;b&=r.pendingLanes,m|=b,o.lanes=m,Ta(r,m)}}var Hd={readContext:sr,useCallback:ls,useContext:ls,useEffect:ls,useImperativeHandle:ls,useInsertionEffect:ls,useLayoutEffect:ls,useMemo:ls,useReducer:ls,useRef:ls,useState:ls,useDebugValue:ls,useDeferredValue:ls,useTransition:ls,useMutableSource:ls,useSyncExternalStore:ls,useId:ls,unstable_isNewReconciler:!1},GL={readContext:sr,useCallback:function(r,o){return zr().memoizedState=[r,o===void 0?null:o],r},useContext:sr,useEffect:R0,useImperativeHandle:function(r,o,m){return m=m!=null?m.concat([r]):null,Ud(4194308,4,D0.bind(null,o,r),m)},useLayoutEffect:function(r,o){return Ud(4194308,4,r,o)},useInsertionEffect:function(r,o){return Ud(4,2,r,o)},useMemo:function(r,o){var m=zr();return o=o===void 0?null:o,r=r(),m.memoizedState=[r,o],r},useReducer:function(r,o,m){var b=zr();return o=m!==void 0?m(o):o,b.memoizedState=b.baseState=o,r={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:o},b.queue=r,r=r.dispatch=KL.bind(null,on,r),[b.memoizedState,r]},useRef:function(r){var o=zr();return r={current:r},o.memoizedState=r},useState:$0,useDebugValue:ap,useDeferredValue:function(r){return zr().memoizedState=r},useTransition:function(){var r=$0(!1),o=r[0];return r=WL.bind(null,r[1]),zr().memoizedState=r,[o,r]},useMutableSource:function(){},useSyncExternalStore:function(r,o,m){var b=on,M=zr();if(en){if(m===void 0)throw Error(n(407));m=m()}else{if(m=o(),qn===null)throw Error(n(349));si&30||k0(b,o,m)}M.memoizedState=m;var $={value:m,getSnapshot:o};return M.queue=$,R0(A0.bind(null,b,$,r),[r]),b.flags|=2048,Ac(9,M0.bind(null,b,$,m,o),void 0,null),m},useId:function(){var r=zr(),o=qn.identifierPrefix;if(en){var m=ca,b=la;m=(b&~(1<<32-we(b)-1)).toString(32)+m,o=":"+o+"R"+m,m=kc++,0<m&&(o+="H"+m.toString(32)),o+=":"}else m=VL++,o=":"+o+"r"+m.toString(32)+":";return r.memoizedState=o},unstable_isNewReconciler:!1},QL={readContext:sr,useCallback:I0,useContext:sr,useEffect:rp,useImperativeHandle:F0,useInsertionEffect:L0,useLayoutEffect:z0,useMemo:B0,useReducer:np,useRef:P0,useState:function(){return np(Mc)},useDebugValue:ap,useDeferredValue:function(r){var o=rr();return U0(o,$n.memoizedState,r)},useTransition:function(){var r=np(Mc)[0],o=rr().memoizedState;return[r,o]},useMutableSource:S0,useSyncExternalStore:E0,useId:q0,unstable_isNewReconciler:!1},XL={readContext:sr,useCallback:I0,useContext:sr,useEffect:rp,useImperativeHandle:F0,useInsertionEffect:L0,useLayoutEffect:z0,useMemo:B0,useReducer:sp,useRef:P0,useState:function(){return sp(Mc)},useDebugValue:ap,useDeferredValue:function(r){var o=rr();return $n===null?o.memoizedState=r:U0(o,$n.memoizedState,r)},useTransition:function(){var r=sp(Mc)[0],o=rr().memoizedState;return[r,o]},useMutableSource:S0,useSyncExternalStore:E0,useId:q0,unstable_isNewReconciler:!1};function pr(r,o){if(r&&r.defaultProps){o=I({},o),r=r.defaultProps;for(var m in r)o[m]===void 0&&(o[m]=r[m]);return o}return o}function op(r,o,m,b){o=r.memoizedState,m=m(b,o),m=m==null?o:I({},o,m),r.memoizedState=m,r.lanes===0&&(r.updateQueue.baseState=m)}var Vd={isMounted:function(r){return(r=r._reactInternals)?wn(r)===r:!1},enqueueSetState:function(r,o,m){r=r._reactInternals;var b=xs(),M=so(r),$=da(b,M);$.payload=o,m!=null&&($.callback=m),o=Za(r,$,M),o!==null&&(vr(o,r,M,b),zd(o,r,M))},enqueueReplaceState:function(r,o,m){r=r._reactInternals;var b=xs(),M=so(r),$=da(b,M);$.tag=1,$.payload=o,m!=null&&($.callback=m),o=Za(r,$,M),o!==null&&(vr(o,r,M,b),zd(o,r,M))},enqueueForceUpdate:function(r,o){r=r._reactInternals;var m=xs(),b=so(r),M=da(m,b);M.tag=2,o!=null&&(M.callback=o),o=Za(r,M,b),o!==null&&(vr(o,r,b,m),zd(o,r,b))}};function K0(r,o,m,b,M,$,U){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(b,$,U):o.prototype&&o.prototype.isPureReactComponent?!Yo(m,b)||!Yo(M,$):!0}function Y0(r,o,m){var b=!1,M=Pr,$=o.contextType;return typeof $=="object"&&$!==null?$=sr($):(M=Bn(o)?Rr:Tn.current,b=o.contextTypes,$=(b=b!=null)?Gt(r,M):Pr),o=new o(m,$),r.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Vd,r.stateNode=o,o._reactInternals=r,b&&(r=r.stateNode,r.__reactInternalMemoizedUnmaskedChildContext=M,r.__reactInternalMemoizedMaskedChildContext=$),o}function G0(r,o,m,b){r=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(m,b),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(m,b),o.state!==r&&Vd.enqueueReplaceState(o,o.state,null)}function ip(r,o,m,b){var M=r.stateNode;M.props=m,M.state=r.memoizedState,M.refs={},Kf(r);var $=o.contextType;typeof $=="object"&&$!==null?M.context=sr($):($=Bn(o)?Rr:Tn.current,M.context=Gt(r,$)),M.state=r.memoizedState,$=o.getDerivedStateFromProps,typeof $=="function"&&(op(r,o,$,m),M.state=r.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof M.getSnapshotBeforeUpdate=="function"||typeof M.UNSAFE_componentWillMount!="function"&&typeof M.componentWillMount!="function"||(o=M.state,typeof M.componentWillMount=="function"&&M.componentWillMount(),typeof M.UNSAFE_componentWillMount=="function"&&M.UNSAFE_componentWillMount(),o!==M.state&&Vd.enqueueReplaceState(M,M.state,null),Dd(r,m,M,b),M.state=r.memoizedState),typeof M.componentDidMount=="function"&&(r.flags|=4194308)}function il(r,o){try{var m="",b=o;do m+=V(b),b=b.return;while(b);var M=m}catch($){M=`
Error generating stack: `+$.message+`
`+$.stack}return{value:r,source:o,stack:M,digest:null}}function lp(r,o,m){return{value:r,source:null,stack:m??null,digest:o??null}}function cp(r,o){try{console.error(o.value)}catch(m){setTimeout(function(){throw m})}}var JL=typeof WeakMap=="function"?WeakMap:Map;function Q0(r,o,m){m=da(-1,m),m.tag=3,m.payload={element:null};var b=o.value;return m.callback=function(){Jd||(Jd=!0,jp=b),cp(r,o)},m}function X0(r,o,m){m=da(-1,m),m.tag=3;var b=r.type.getDerivedStateFromError;if(typeof b=="function"){var M=o.value;m.payload=function(){return b(M)},m.callback=function(){cp(r,o)}}var $=r.stateNode;return $!==null&&typeof $.componentDidCatch=="function"&&(m.callback=function(){cp(r,o),typeof b!="function"&&(to===null?to=new Set([this]):to.add(this));var U=o.stack;this.componentDidCatch(o.value,{componentStack:U!==null?U:""})}),m}function J0(r,o,m){var b=r.pingCache;if(b===null){b=r.pingCache=new JL;var M=new Set;b.set(o,M)}else M=b.get(o),M===void 0&&(M=new Set,b.set(o,M));M.has(m)||(M.add(m),r=mz.bind(null,r,o,m),o.then(r,r))}function Z0(r){do{var o;if((o=r.tag===13)&&(o=r.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return r;r=r.return}while(r!==null);return null}function ew(r,o,m,b,M){return r.mode&1?(r.flags|=65536,r.lanes=M,r):(r===o?r.flags|=65536:(r.flags|=128,m.flags|=131072,m.flags&=-52805,m.tag===1&&(m.alternate===null?m.tag=17:(o=da(-1,1),o.tag=2,Za(m,o,1))),m.lanes|=1),r)}var ZL=C.ReactCurrentOwner,As=!1;function bs(r,o,m,b){o.child=r===null?b0(o,null,m,b):sl(o,r.child,m,b)}function tw(r,o,m,b,M){m=m.render;var $=o.ref;return al(o,M),b=ep(r,o,m,b,$,M),m=tp(),r!==null&&!As?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~M,ma(r,o,M)):(en&&m&&zf(o),o.flags|=1,bs(r,o,b,M),o.child)}function nw(r,o,m,b,M){if(r===null){var $=m.type;return typeof $=="function"&&!Op($)&&$.defaultProps===void 0&&m.compare===null&&m.defaultProps===void 0?(o.tag=15,o.type=$,sw(r,o,$,b,M)):(r=rm(m.type,null,b,o,o.mode,M),r.ref=o.ref,r.return=o,o.child=r)}if($=r.child,!(r.lanes&M)){var U=$.memoizedProps;if(m=m.compare,m=m!==null?m:Yo,m(U,b)&&r.ref===o.ref)return ma(r,o,M)}return o.flags|=1,r=ao($,b),r.ref=o.ref,r.return=o,o.child=r}function sw(r,o,m,b,M){if(r!==null){var $=r.memoizedProps;if(Yo($,b)&&r.ref===o.ref)if(As=!1,o.pendingProps=b=$,(r.lanes&M)!==0)r.flags&131072&&(As=!0);else return o.lanes=r.lanes,ma(r,o,M)}return up(r,o,m,b,M)}function rw(r,o,m){var b=o.pendingProps,M=b.children,$=r!==null?r.memoizedState:null;if(b.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(cl,Gs),Gs|=m;else{if(!(m&1073741824))return r=$!==null?$.baseLanes|m:m,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:r,cachePool:null,transitions:null},o.updateQueue=null,Ke(cl,Gs),Gs|=r,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},b=$!==null?$.baseLanes:m,Ke(cl,Gs),Gs|=b}else $!==null?(b=$.baseLanes|m,o.memoizedState=null):b=m,Ke(cl,Gs),Gs|=b;return bs(r,o,M,m),o.child}function aw(r,o){var m=o.ref;(r===null&&m!==null||r!==null&&r.ref!==m)&&(o.flags|=512,o.flags|=2097152)}function up(r,o,m,b,M){var $=Bn(m)?Rr:Tn.current;return $=Gt(o,$),al(o,M),m=ep(r,o,m,b,$,M),b=tp(),r!==null&&!As?(o.updateQueue=r.updateQueue,o.flags&=-2053,r.lanes&=~M,ma(r,o,M)):(en&&b&&zf(o),o.flags|=1,bs(r,o,m,M),o.child)}function ow(r,o,m,b,M){if(Bn(m)){var $=!0;Md(o)}else $=!1;if(al(o,M),o.stateNode===null)Kd(r,o),Y0(o,m,b),ip(o,m,b,M),b=!0;else if(r===null){var U=o.stateNode,ee=o.memoizedProps;U.props=ee;var ae=U.context,he=m.contextType;typeof he=="object"&&he!==null?he=sr(he):(he=Bn(m)?Rr:Tn.current,he=Gt(o,he));var be=m.getDerivedStateFromProps,Ne=typeof be=="function"||typeof U.getSnapshotBeforeUpdate=="function";Ne||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ee!==b||ae!==he)&&G0(o,U,b,he),Ja=!1;var ve=o.memoizedState;U.state=ve,Dd(o,b,U,M),ae=o.memoizedState,ee!==b||ve!==ae||Xn.current||Ja?(typeof be=="function"&&(op(o,m,be,b),ae=o.memoizedState),(ee=Ja||K0(o,m,ee,b,ve,ae,he))?(Ne||typeof U.UNSAFE_componentWillMount!="function"&&typeof U.componentWillMount!="function"||(typeof U.componentWillMount=="function"&&U.componentWillMount(),typeof U.UNSAFE_componentWillMount=="function"&&U.UNSAFE_componentWillMount()),typeof U.componentDidMount=="function"&&(o.flags|=4194308)):(typeof U.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=b,o.memoizedState=ae),U.props=b,U.state=ae,U.context=he,b=ee):(typeof U.componentDidMount=="function"&&(o.flags|=4194308),b=!1)}else{U=o.stateNode,w0(r,o),ee=o.memoizedProps,he=o.type===o.elementType?ee:pr(o.type,ee),U.props=he,Ne=o.pendingProps,ve=U.context,ae=m.contextType,typeof ae=="object"&&ae!==null?ae=sr(ae):(ae=Bn(m)?Rr:Tn.current,ae=Gt(o,ae));var Pe=m.getDerivedStateFromProps;(be=typeof Pe=="function"||typeof U.getSnapshotBeforeUpdate=="function")||typeof U.UNSAFE_componentWillReceiveProps!="function"&&typeof U.componentWillReceiveProps!="function"||(ee!==Ne||ve!==ae)&&G0(o,U,b,ae),Ja=!1,ve=o.memoizedState,U.state=ve,Dd(o,b,U,M);var ze=o.memoizedState;ee!==Ne||ve!==ze||Xn.current||Ja?(typeof Pe=="function"&&(op(o,m,Pe,b),ze=o.memoizedState),(he=Ja||K0(o,m,he,b,ve,ze,ae)||!1)?(be||typeof U.UNSAFE_componentWillUpdate!="function"&&typeof U.componentWillUpdate!="function"||(typeof U.componentWillUpdate=="function"&&U.componentWillUpdate(b,ze,ae),typeof U.UNSAFE_componentWillUpdate=="function"&&U.UNSAFE_componentWillUpdate(b,ze,ae)),typeof U.componentDidUpdate=="function"&&(o.flags|=4),typeof U.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof U.componentDidUpdate!="function"||ee===r.memoizedProps&&ve===r.memoizedState||(o.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&ve===r.memoizedState||(o.flags|=1024),o.memoizedProps=b,o.memoizedState=ze),U.props=b,U.state=ze,U.context=ae,b=he):(typeof U.componentDidUpdate!="function"||ee===r.memoizedProps&&ve===r.memoizedState||(o.flags|=4),typeof U.getSnapshotBeforeUpdate!="function"||ee===r.memoizedProps&&ve===r.memoizedState||(o.flags|=1024),b=!1)}return dp(r,o,m,b,$,M)}function dp(r,o,m,b,M,$){aw(r,o);var U=(o.flags&128)!==0;if(!b&&!U)return M&&d0(o,m,!1),ma(r,o,$);b=o.stateNode,ZL.current=o;var ee=U&&typeof m.getDerivedStateFromError!="function"?null:b.render();return o.flags|=1,r!==null&&U?(o.child=sl(o,r.child,null,$),o.child=sl(o,null,ee,$)):bs(r,o,ee,$),o.memoizedState=b.state,M&&d0(o,m,!0),o.child}function iw(r){var o=r.stateNode;o.pendingContext?c0(r,o.pendingContext,o.pendingContext!==o.context):o.context&&c0(r,o.context,!1),Yf(r,o.containerInfo)}function lw(r,o,m,b,M){return nl(),Bf(M),o.flags|=256,bs(r,o,m,b),o.child}var mp={dehydrated:null,treeContext:null,retryLane:0};function hp(r){return{baseLanes:r,cachePool:null,transitions:null}}function cw(r,o,m){var b=o.pendingProps,M=an.current,$=!1,U=(o.flags&128)!==0,ee;if((ee=U)||(ee=r!==null&&r.memoizedState===null?!1:(M&2)!==0),ee?($=!0,o.flags&=-129):(r===null||r.memoizedState!==null)&&(M|=1),Ke(an,M&1),r===null)return If(o),r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null)?(o.mode&1?r.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(U=b.children,r=b.fallback,$?(b=o.mode,$=o.child,U={mode:"hidden",children:U},!(b&1)&&$!==null?($.childLanes=0,$.pendingProps=U):$=am(U,b,0,null),r=li(r,b,m,null),$.return=o,r.return=o,$.sibling=r,o.child=$,o.child.memoizedState=hp(m),o.memoizedState=mp,r):fp(o,U));if(M=r.memoizedState,M!==null&&(ee=M.dehydrated,ee!==null))return ez(r,o,U,b,ee,M,m);if($){$=b.fallback,U=o.mode,M=r.child,ee=M.sibling;var ae={mode:"hidden",children:b.children};return!(U&1)&&o.child!==M?(b=o.child,b.childLanes=0,b.pendingProps=ae,o.deletions=null):(b=ao(M,ae),b.subtreeFlags=M.subtreeFlags&14680064),ee!==null?$=ao(ee,$):($=li($,U,m,null),$.flags|=2),$.return=o,b.return=o,b.sibling=$,o.child=b,b=$,$=o.child,U=r.child.memoizedState,U=U===null?hp(m):{baseLanes:U.baseLanes|m,cachePool:null,transitions:U.transitions},$.memoizedState=U,$.childLanes=r.childLanes&~m,o.memoizedState=mp,b}return $=r.child,r=$.sibling,b=ao($,{mode:"visible",children:b.children}),!(o.mode&1)&&(b.lanes=m),b.return=o,b.sibling=null,r!==null&&(m=o.deletions,m===null?(o.deletions=[r],o.flags|=16):m.push(r)),o.child=b,o.memoizedState=null,b}function fp(r,o){return o=am({mode:"visible",children:o},r.mode,0,null),o.return=r,r.child=o}function Wd(r,o,m,b){return b!==null&&Bf(b),sl(o,r.child,null,m),r=fp(o,o.pendingProps.children),r.flags|=2,o.memoizedState=null,r}function ez(r,o,m,b,M,$,U){if(m)return o.flags&256?(o.flags&=-257,b=lp(Error(n(422))),Wd(r,o,U,b)):o.memoizedState!==null?(o.child=r.child,o.flags|=128,null):($=b.fallback,M=o.mode,b=am({mode:"visible",children:b.children},M,0,null),$=li($,M,U,null),$.flags|=2,b.return=o,$.return=o,b.sibling=$,o.child=b,o.mode&1&&sl(o,r.child,null,U),o.child.memoizedState=hp(U),o.memoizedState=mp,$);if(!(o.mode&1))return Wd(r,o,U,null);if(M.data==="$!"){if(b=M.nextSibling&&M.nextSibling.dataset,b)var ee=b.dgst;return b=ee,$=Error(n(419)),b=lp($,b,void 0),Wd(r,o,U,b)}if(ee=(U&r.childLanes)!==0,As||ee){if(b=qn,b!==null){switch(U&-U){case 4:M=2;break;case 16:M=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:M=32;break;case 536870912:M=268435456;break;default:M=0}M=M&(b.suspendedLanes|U)?0:M,M!==0&&M!==$.retryLane&&($.retryLane=M,ua(r,M),vr(b,r,M,-1))}return Ap(),b=lp(Error(n(421))),Wd(r,o,U,b)}return M.data==="$?"?(o.flags|=128,o.child=r.child,o=hz.bind(null,r),M._reactRetry=o,null):(r=$.treeContext,Ys=Tr(M.nextSibling),Ks=o,en=!0,fr=null,r!==null&&(tr[nr++]=la,tr[nr++]=ca,tr[nr++]=Zo,la=r.id,ca=r.overflow,Zo=o),o=fp(o,b.children),o.flags|=4096,o)}function uw(r,o,m){r.lanes|=o;var b=r.alternate;b!==null&&(b.lanes|=o),Vf(r.return,o,m)}function pp(r,o,m,b,M){var $=r.memoizedState;$===null?r.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:b,tail:m,tailMode:M}:($.isBackwards=o,$.rendering=null,$.renderingStartTime=0,$.last=b,$.tail=m,$.tailMode=M)}function dw(r,o,m){var b=o.pendingProps,M=b.revealOrder,$=b.tail;if(bs(r,o,b.children,m),b=an.current,b&2)b=b&1|2,o.flags|=128;else{if(r!==null&&r.flags&128)e:for(r=o.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&uw(r,m,o);else if(r.tag===19)uw(r,m,o);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===o)break e;for(;r.sibling===null;){if(r.return===null||r.return===o)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}b&=1}if(Ke(an,b),!(o.mode&1))o.memoizedState=null;else switch(M){case"forwards":for(m=o.child,M=null;m!==null;)r=m.alternate,r!==null&&Fd(r)===null&&(M=m),m=m.sibling;m=M,m===null?(M=o.child,o.child=null):(M=m.sibling,m.sibling=null),pp(o,!1,M,m,$);break;case"backwards":for(m=null,M=o.child,o.child=null;M!==null;){if(r=M.alternate,r!==null&&Fd(r)===null){o.child=M;break}r=M.sibling,M.sibling=m,m=M,M=r}pp(o,!0,m,null,$);break;case"together":pp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Kd(r,o){!(o.mode&1)&&r!==null&&(r.alternate=null,o.alternate=null,o.flags|=2)}function ma(r,o,m){if(r!==null&&(o.dependencies=r.dependencies),ri|=o.lanes,!(m&o.childLanes))return null;if(r!==null&&o.child!==r.child)throw Error(n(153));if(o.child!==null){for(r=o.child,m=ao(r,r.pendingProps),o.child=m,m.return=o;r.sibling!==null;)r=r.sibling,m=m.sibling=ao(r,r.pendingProps),m.return=o;m.sibling=null}return o.child}function tz(r,o,m){switch(o.tag){case 3:iw(o),nl();break;case 5:C0(o);break;case 1:Bn(o.type)&&Md(o);break;case 4:Yf(o,o.stateNode.containerInfo);break;case 10:var b=o.type._context,M=o.memoizedProps.value;Ke(Rd,b._currentValue),b._currentValue=M;break;case 13:if(b=o.memoizedState,b!==null)return b.dehydrated!==null?(Ke(an,an.current&1),o.flags|=128,null):m&o.child.childLanes?cw(r,o,m):(Ke(an,an.current&1),r=ma(r,o,m),r!==null?r.sibling:null);Ke(an,an.current&1);break;case 19:if(b=(m&o.childLanes)!==0,r.flags&128){if(b)return dw(r,o,m);o.flags|=128}if(M=o.memoizedState,M!==null&&(M.rendering=null,M.tail=null,M.lastEffect=null),Ke(an,an.current),b)break;return null;case 22:case 23:return o.lanes=0,rw(r,o,m)}return ma(r,o,m)}var mw,gp,hw,fw;mw=function(r,o){for(var m=o.child;m!==null;){if(m.tag===5||m.tag===6)r.appendChild(m.stateNode);else if(m.tag!==4&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===o)break;for(;m.sibling===null;){if(m.return===null||m.return===o)return;m=m.return}m.sibling.return=m.return,m=m.sibling}},gp=function(){},hw=function(r,o,m,b){var M=r.memoizedProps;if(M!==b){r=o.stateNode,ni(Lr.current);var $=null;switch(m){case"input":M=Fe(r,M),b=Fe(r,b),$=[];break;case"select":M=I({},M,{value:void 0}),b=I({},b,{value:void 0}),$=[];break;case"textarea":M=ce(r,M),b=ce(r,b),$=[];break;default:typeof M.onClick!="function"&&typeof b.onClick=="function"&&(r.onclick=Ji)}tn(m,b);var U;m=null;for(he in M)if(!b.hasOwnProperty(he)&&M.hasOwnProperty(he)&&M[he]!=null)if(he==="style"){var ee=M[he];for(U in ee)ee.hasOwnProperty(U)&&(m||(m={}),m[U]="")}else he!=="dangerouslySetInnerHTML"&&he!=="children"&&he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&he!=="autoFocus"&&(i.hasOwnProperty(he)?$||($=[]):($=$||[]).push(he,null));for(he in b){var ae=b[he];if(ee=M!=null?M[he]:void 0,b.hasOwnProperty(he)&&ae!==ee&&(ae!=null||ee!=null))if(he==="style")if(ee){for(U in ee)!ee.hasOwnProperty(U)||ae&&ae.hasOwnProperty(U)||(m||(m={}),m[U]="");for(U in ae)ae.hasOwnProperty(U)&&ee[U]!==ae[U]&&(m||(m={}),m[U]=ae[U])}else m||($||($=[]),$.push(he,m)),m=ae;else he==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ee=ee?ee.__html:void 0,ae!=null&&ee!==ae&&($=$||[]).push(he,ae)):he==="children"?typeof ae!="string"&&typeof ae!="number"||($=$||[]).push(he,""+ae):he!=="suppressContentEditableWarning"&&he!=="suppressHydrationWarning"&&(i.hasOwnProperty(he)?(ae!=null&&he==="onScroll"&&Ht("scroll",r),$||ee===ae||($=[])):($=$||[]).push(he,ae))}m&&($=$||[]).push("style",m);var he=$;(o.updateQueue=he)&&(o.flags|=4)}},fw=function(r,o,m,b){m!==b&&(o.flags|=4)};function Oc(r,o){if(!en)switch(r.tailMode){case"hidden":o=r.tail;for(var m=null;o!==null;)o.alternate!==null&&(m=o),o=o.sibling;m===null?r.tail=null:m.sibling=null;break;case"collapsed":m=r.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?o||r.tail===null?r.tail=null:r.tail.sibling=null:b.sibling=null}}function cs(r){var o=r.alternate!==null&&r.alternate.child===r.child,m=0,b=0;if(o)for(var M=r.child;M!==null;)m|=M.lanes|M.childLanes,b|=M.subtreeFlags&14680064,b|=M.flags&14680064,M.return=r,M=M.sibling;else for(M=r.child;M!==null;)m|=M.lanes|M.childLanes,b|=M.subtreeFlags,b|=M.flags,M.return=r,M=M.sibling;return r.subtreeFlags|=b,r.childLanes=m,o}function nz(r,o,m){var b=o.pendingProps;switch(Df(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return cs(o),null;case 1:return Bn(o.type)&&kd(),cs(o),null;case 3:return b=o.stateNode,ol(),Et(Xn),Et(Tn),Xf(),b.pendingContext&&(b.context=b.pendingContext,b.pendingContext=null),(r===null||r.child===null)&&($d(o)?o.flags|=4:r===null||r.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,fr!==null&&(Ep(fr),fr=null))),gp(r,o),cs(o),null;case 5:Gf(o);var M=ni(Sc.current);if(m=o.type,r!==null&&o.stateNode!=null)hw(r,o,m,b,M),r.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!b){if(o.stateNode===null)throw Error(n(166));return cs(o),null}if(r=ni(Lr.current),$d(o)){b=o.stateNode,m=o.type;var $=o.memoizedProps;switch(b[er]=o,b[Xo]=$,r=(o.mode&1)!==0,m){case"dialog":Ht("cancel",b),Ht("close",b);break;case"iframe":case"object":case"embed":Ht("load",b);break;case"video":case"audio":for(M=0;M<Go.length;M++)Ht(Go[M],b);break;case"source":Ht("error",b);break;case"img":case"image":case"link":Ht("error",b),Ht("load",b);break;case"details":Ht("toggle",b);break;case"input":lt(b,$),Ht("invalid",b);break;case"select":b._wrapperState={wasMultiple:!!$.multiple},Ht("invalid",b);break;case"textarea":Me(b,$),Ht("invalid",b)}tn(m,$),M=null;for(var U in $)if($.hasOwnProperty(U)){var ee=$[U];U==="children"?typeof ee=="string"?b.textContent!==ee&&($.suppressHydrationWarning!==!0&&Xi(b.textContent,ee,r),M=["children",ee]):typeof ee=="number"&&b.textContent!==""+ee&&($.suppressHydrationWarning!==!0&&Xi(b.textContent,ee,r),M=["children",""+ee]):i.hasOwnProperty(U)&&ee!=null&&U==="onScroll"&&Ht("scroll",b)}switch(m){case"input":Se(b),pe(b,$,!0);break;case"textarea":Se(b),at(b);break;case"select":case"option":break;default:typeof $.onClick=="function"&&(b.onclick=Ji)}b=M,o.updateQueue=b,b!==null&&(o.flags|=4)}else{U=M.nodeType===9?M:M.ownerDocument,r==="http://www.w3.org/1999/xhtml"&&(r=Ze(m)),r==="http://www.w3.org/1999/xhtml"?m==="script"?(r=U.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild)):typeof b.is=="string"?r=U.createElement(m,{is:b.is}):(r=U.createElement(m),m==="select"&&(U=r,b.multiple?U.multiple=!0:b.size&&(U.size=b.size))):r=U.createElementNS(r,m),r[er]=o,r[Xo]=b,mw(r,o,!1,!1),o.stateNode=r;e:{switch(U=Sn(m,b),m){case"dialog":Ht("cancel",r),Ht("close",r),M=b;break;case"iframe":case"object":case"embed":Ht("load",r),M=b;break;case"video":case"audio":for(M=0;M<Go.length;M++)Ht(Go[M],r);M=b;break;case"source":Ht("error",r),M=b;break;case"img":case"image":case"link":Ht("error",r),Ht("load",r),M=b;break;case"details":Ht("toggle",r),M=b;break;case"input":lt(r,b),M=Fe(r,b),Ht("invalid",r);break;case"option":M=b;break;case"select":r._wrapperState={wasMultiple:!!b.multiple},M=I({},b,{value:void 0}),Ht("invalid",r);break;case"textarea":Me(r,b),M=ce(r,b),Ht("invalid",r);break;default:M=b}tn(m,M),ee=M;for($ in ee)if(ee.hasOwnProperty($)){var ae=ee[$];$==="style"?Kt(r,ae):$==="dangerouslySetInnerHTML"?(ae=ae?ae.__html:void 0,ae!=null&&dt(r,ae)):$==="children"?typeof ae=="string"?(m!=="textarea"||ae!=="")&&jt(r,ae):typeof ae=="number"&&jt(r,""+ae):$!=="suppressContentEditableWarning"&&$!=="suppressHydrationWarning"&&$!=="autoFocus"&&(i.hasOwnProperty($)?ae!=null&&$==="onScroll"&&Ht("scroll",r):ae!=null&&S(r,$,ae,U))}switch(m){case"input":Se(r),pe(r,b,!1);break;case"textarea":Se(r),at(r);break;case"option":b.value!=null&&r.setAttribute("value",""+ne(b.value));break;case"select":r.multiple=!!b.multiple,$=b.value,$!=null?Ue(r,!!b.multiple,$,!1):b.defaultValue!=null&&Ue(r,!!b.multiple,b.defaultValue,!0);break;default:typeof M.onClick=="function"&&(r.onclick=Ji)}switch(m){case"button":case"input":case"select":case"textarea":b=!!b.autoFocus;break e;case"img":b=!0;break e;default:b=!1}}b&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return cs(o),null;case 6:if(r&&o.stateNode!=null)fw(r,o,r.memoizedProps,b);else{if(typeof b!="string"&&o.stateNode===null)throw Error(n(166));if(m=ni(Sc.current),ni(Lr.current),$d(o)){if(b=o.stateNode,m=o.memoizedProps,b[er]=o,($=b.nodeValue!==m)&&(r=Ks,r!==null))switch(r.tag){case 3:Xi(b.nodeValue,m,(r.mode&1)!==0);break;case 5:r.memoizedProps.suppressHydrationWarning!==!0&&Xi(b.nodeValue,m,(r.mode&1)!==0)}$&&(o.flags|=4)}else b=(m.nodeType===9?m:m.ownerDocument).createTextNode(b),b[er]=o,o.stateNode=b}return cs(o),null;case 13:if(Et(an),b=o.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(en&&Ys!==null&&o.mode&1&&!(o.flags&128))_0(),nl(),o.flags|=98560,$=!1;else if($=$d(o),b!==null&&b.dehydrated!==null){if(r===null){if(!$)throw Error(n(318));if($=o.memoizedState,$=$!==null?$.dehydrated:null,!$)throw Error(n(317));$[er]=o}else nl(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;cs(o),$=!1}else fr!==null&&(Ep(fr),fr=null),$=!0;if(!$)return o.flags&65536?o:null}return o.flags&128?(o.lanes=m,o):(b=b!==null,b!==(r!==null&&r.memoizedState!==null)&&b&&(o.child.flags|=8192,o.mode&1&&(r===null||an.current&1?Pn===0&&(Pn=3):Ap())),o.updateQueue!==null&&(o.flags|=4),cs(o),null);case 4:return ol(),gp(r,o),r===null&&Qo(o.stateNode.containerInfo),cs(o),null;case 10:return Hf(o.type._context),cs(o),null;case 17:return Bn(o.type)&&kd(),cs(o),null;case 19:if(Et(an),$=o.memoizedState,$===null)return cs(o),null;if(b=(o.flags&128)!==0,U=$.rendering,U===null)if(b)Oc($,!1);else{if(Pn!==0||r!==null&&r.flags&128)for(r=o.child;r!==null;){if(U=Fd(r),U!==null){for(o.flags|=128,Oc($,!1),b=U.updateQueue,b!==null&&(o.updateQueue=b,o.flags|=4),o.subtreeFlags=0,b=m,m=o.child;m!==null;)$=m,r=b,$.flags&=14680066,U=$.alternate,U===null?($.childLanes=0,$.lanes=r,$.child=null,$.subtreeFlags=0,$.memoizedProps=null,$.memoizedState=null,$.updateQueue=null,$.dependencies=null,$.stateNode=null):($.childLanes=U.childLanes,$.lanes=U.lanes,$.child=U.child,$.subtreeFlags=0,$.deletions=null,$.memoizedProps=U.memoizedProps,$.memoizedState=U.memoizedState,$.updateQueue=U.updateQueue,$.type=U.type,r=U.dependencies,$.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext}),m=m.sibling;return Ke(an,an.current&1|2),o.child}r=r.sibling}$.tail!==null&&et()>ul&&(o.flags|=128,b=!0,Oc($,!1),o.lanes=4194304)}else{if(!b)if(r=Fd(U),r!==null){if(o.flags|=128,b=!0,m=r.updateQueue,m!==null&&(o.updateQueue=m,o.flags|=4),Oc($,!0),$.tail===null&&$.tailMode==="hidden"&&!U.alternate&&!en)return cs(o),null}else 2*et()-$.renderingStartTime>ul&&m!==1073741824&&(o.flags|=128,b=!0,Oc($,!1),o.lanes=4194304);$.isBackwards?(U.sibling=o.child,o.child=U):(m=$.last,m!==null?m.sibling=U:o.child=U,$.last=U)}return $.tail!==null?(o=$.tail,$.rendering=o,$.tail=o.sibling,$.renderingStartTime=et(),o.sibling=null,m=an.current,Ke(an,b?m&1|2:m&1),o):(cs(o),null);case 22:case 23:return Mp(),b=o.memoizedState!==null,r!==null&&r.memoizedState!==null!==b&&(o.flags|=8192),b&&o.mode&1?Gs&1073741824&&(cs(o),o.subtreeFlags&6&&(o.flags|=8192)):cs(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function sz(r,o){switch(Df(o),o.tag){case 1:return Bn(o.type)&&kd(),r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 3:return ol(),Et(Xn),Et(Tn),Xf(),r=o.flags,r&65536&&!(r&128)?(o.flags=r&-65537|128,o):null;case 5:return Gf(o),null;case 13:if(Et(an),r=o.memoizedState,r!==null&&r.dehydrated!==null){if(o.alternate===null)throw Error(n(340));nl()}return r=o.flags,r&65536?(o.flags=r&-65537|128,o):null;case 19:return Et(an),null;case 4:return ol(),null;case 10:return Hf(o.type._context),null;case 22:case 23:return Mp(),null;case 24:return null;default:return null}}var Yd=!1,us=!1,rz=typeof WeakSet=="function"?WeakSet:Set,Le=null;function ll(r,o){var m=r.ref;if(m!==null)if(typeof m=="function")try{m(null)}catch(b){mn(r,o,b)}else m.current=null}function _p(r,o,m){try{m()}catch(b){mn(r,o,b)}}var pw=!1;function az(r,o){if(jd=_s,r=hd(),cc(r)){if("selectionStart"in r)var m={start:r.selectionStart,end:r.selectionEnd};else e:{m=(m=r.ownerDocument)&&m.defaultView||window;var b=m.getSelection&&m.getSelection();if(b&&b.rangeCount!==0){m=b.anchorNode;var M=b.anchorOffset,$=b.focusNode;b=b.focusOffset;try{m.nodeType,$.nodeType}catch{m=null;break e}var U=0,ee=-1,ae=-1,he=0,be=0,Ne=r,ve=null;t:for(;;){for(var Pe;Ne!==m||M!==0&&Ne.nodeType!==3||(ee=U+M),Ne!==$||b!==0&&Ne.nodeType!==3||(ae=U+b),Ne.nodeType===3&&(U+=Ne.nodeValue.length),(Pe=Ne.firstChild)!==null;)ve=Ne,Ne=Pe;for(;;){if(Ne===r)break t;if(ve===m&&++he===M&&(ee=U),ve===$&&++be===b&&(ae=U),(Pe=Ne.nextSibling)!==null)break;Ne=ve,ve=Ne.parentNode}Ne=Pe}m=ee===-1||ae===-1?null:{start:ee,end:ae}}else m=null}m=m||{start:0,end:0}}else m=null;for(vc={focusedElem:r,selectionRange:m},_s=!1,Le=o;Le!==null;)if(o=Le,r=o.child,(o.subtreeFlags&1028)!==0&&r!==null)r.return=o,Le=r;else for(;Le!==null;){o=Le;try{var ze=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(ze!==null){var Ie=ze.memoizedProps,gn=ze.memoizedState,le=o.stateNode,oe=le.getSnapshotBeforeUpdate(o.elementType===o.type?Ie:pr(o.type,Ie),gn);le.__reactInternalSnapshotBeforeUpdate=oe}break;case 3:var ue=o.stateNode.containerInfo;ue.nodeType===1?ue.textContent="":ue.nodeType===9&&ue.documentElement&&ue.removeChild(ue.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Ce){mn(o,o.return,Ce)}if(r=o.sibling,r!==null){r.return=o.return,Le=r;break}Le=o.return}return ze=pw,pw=!1,ze}function Tc(r,o,m){var b=o.updateQueue;if(b=b!==null?b.lastEffect:null,b!==null){var M=b=b.next;do{if((M.tag&r)===r){var $=M.destroy;M.destroy=void 0,$!==void 0&&_p(o,m,$)}M=M.next}while(M!==b)}}function Gd(r,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var m=o=o.next;do{if((m.tag&r)===r){var b=m.create;m.destroy=b()}m=m.next}while(m!==o)}}function vp(r){var o=r.ref;if(o!==null){var m=r.stateNode;switch(r.tag){case 5:r=m;break;default:r=m}typeof o=="function"?o(r):o.current=r}}function gw(r){var o=r.alternate;o!==null&&(r.alternate=null,gw(o)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(o=r.stateNode,o!==null&&(delete o[er],delete o[Xo],delete o[xc],delete o[l0],delete o[Rf])),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}function _w(r){return r.tag===5||r.tag===3||r.tag===4}function vw(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||_w(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function yp(r,o,m){var b=r.tag;if(b===5||b===6)r=r.stateNode,o?m.nodeType===8?m.parentNode.insertBefore(r,o):m.insertBefore(r,o):(m.nodeType===8?(o=m.parentNode,o.insertBefore(r,m)):(o=m,o.appendChild(r)),m=m._reactRootContainer,m!=null||o.onclick!==null||(o.onclick=Ji));else if(b!==4&&(r=r.child,r!==null))for(yp(r,o,m),r=r.sibling;r!==null;)yp(r,o,m),r=r.sibling}function bp(r,o,m){var b=r.tag;if(b===5||b===6)r=r.stateNode,o?m.insertBefore(r,o):m.appendChild(r);else if(b!==4&&(r=r.child,r!==null))for(bp(r,o,m),r=r.sibling;r!==null;)bp(r,o,m),r=r.sibling}var Jn=null,gr=!1;function eo(r,o,m){for(m=m.child;m!==null;)yw(r,o,m),m=m.sibling}function yw(r,o,m){if($e&&typeof $e.onCommitFiberUnmount=="function")try{$e.onCommitFiberUnmount(_e,m)}catch{}switch(m.tag){case 5:us||ll(m,o);case 6:var b=Jn,M=gr;Jn=null,eo(r,o,m),Jn=b,gr=M,Jn!==null&&(gr?(r=Jn,m=m.stateNode,r.nodeType===8?r.parentNode.removeChild(m):r.removeChild(m)):Jn.removeChild(m.stateNode));break;case 18:Jn!==null&&(gr?(r=Jn,m=m.stateNode,r.nodeType===8?Sd(r.parentNode,m):r.nodeType===1&&Sd(r,m),pn(r)):Sd(Jn,m.stateNode));break;case 4:b=Jn,M=gr,Jn=m.stateNode.containerInfo,gr=!0,eo(r,o,m),Jn=b,gr=M;break;case 0:case 11:case 14:case 15:if(!us&&(b=m.updateQueue,b!==null&&(b=b.lastEffect,b!==null))){M=b=b.next;do{var $=M,U=$.destroy;$=$.tag,U!==void 0&&($&2||$&4)&&_p(m,o,U),M=M.next}while(M!==b)}eo(r,o,m);break;case 1:if(!us&&(ll(m,o),b=m.stateNode,typeof b.componentWillUnmount=="function"))try{b.props=m.memoizedProps,b.state=m.memoizedState,b.componentWillUnmount()}catch(ee){mn(m,o,ee)}eo(r,o,m);break;case 21:eo(r,o,m);break;case 22:m.mode&1?(us=(b=us)||m.memoizedState!==null,eo(r,o,m),us=b):eo(r,o,m);break;default:eo(r,o,m)}}function bw(r){var o=r.updateQueue;if(o!==null){r.updateQueue=null;var m=r.stateNode;m===null&&(m=r.stateNode=new rz),o.forEach(function(b){var M=fz.bind(null,r,b);m.has(b)||(m.add(b),b.then(M,M))})}}function _r(r,o){var m=o.deletions;if(m!==null)for(var b=0;b<m.length;b++){var M=m[b];try{var $=r,U=o,ee=U;e:for(;ee!==null;){switch(ee.tag){case 5:Jn=ee.stateNode,gr=!1;break e;case 3:Jn=ee.stateNode.containerInfo,gr=!0;break e;case 4:Jn=ee.stateNode.containerInfo,gr=!0;break e}ee=ee.return}if(Jn===null)throw Error(n(160));yw($,U,M),Jn=null,gr=!1;var ae=M.alternate;ae!==null&&(ae.return=null),M.return=null}catch(he){mn(M,o,he)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)xw(o,r),o=o.sibling}function xw(r,o){var m=r.alternate,b=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:if(_r(o,r),Dr(r),b&4){try{Tc(3,r,r.return),Gd(3,r)}catch(Ie){mn(r,r.return,Ie)}try{Tc(5,r,r.return)}catch(Ie){mn(r,r.return,Ie)}}break;case 1:_r(o,r),Dr(r),b&512&&m!==null&&ll(m,m.return);break;case 5:if(_r(o,r),Dr(r),b&512&&m!==null&&ll(m,m.return),r.flags&32){var M=r.stateNode;try{jt(M,"")}catch(Ie){mn(r,r.return,Ie)}}if(b&4&&(M=r.stateNode,M!=null)){var $=r.memoizedProps,U=m!==null?m.memoizedProps:$,ee=r.type,ae=r.updateQueue;if(r.updateQueue=null,ae!==null)try{ee==="input"&&$.type==="radio"&&$.name!=null&&Be(M,$),Sn(ee,U);var he=Sn(ee,$);for(U=0;U<ae.length;U+=2){var be=ae[U],Ne=ae[U+1];be==="style"?Kt(M,Ne):be==="dangerouslySetInnerHTML"?dt(M,Ne):be==="children"?jt(M,Ne):S(M,be,Ne,he)}switch(ee){case"input":de(M,$);break;case"textarea":Ye(M,$);break;case"select":var ve=M._wrapperState.wasMultiple;M._wrapperState.wasMultiple=!!$.multiple;var Pe=$.value;Pe!=null?Ue(M,!!$.multiple,Pe,!1):ve!==!!$.multiple&&($.defaultValue!=null?Ue(M,!!$.multiple,$.defaultValue,!0):Ue(M,!!$.multiple,$.multiple?[]:"",!1))}M[Xo]=$}catch(Ie){mn(r,r.return,Ie)}}break;case 6:if(_r(o,r),Dr(r),b&4){if(r.stateNode===null)throw Error(n(162));M=r.stateNode,$=r.memoizedProps;try{M.nodeValue=$}catch(Ie){mn(r,r.return,Ie)}}break;case 3:if(_r(o,r),Dr(r),b&4&&m!==null&&m.memoizedState.isDehydrated)try{pn(o.containerInfo)}catch(Ie){mn(r,r.return,Ie)}break;case 4:_r(o,r),Dr(r);break;case 13:_r(o,r),Dr(r),M=r.child,M.flags&8192&&($=M.memoizedState!==null,M.stateNode.isHidden=$,!$||M.alternate!==null&&M.alternate.memoizedState!==null||(Np=et())),b&4&&bw(r);break;case 22:if(be=m!==null&&m.memoizedState!==null,r.mode&1?(us=(he=us)||be,_r(o,r),us=he):_r(o,r),Dr(r),b&8192){if(he=r.memoizedState!==null,(r.stateNode.isHidden=he)&&!be&&r.mode&1)for(Le=r,be=r.child;be!==null;){for(Ne=Le=be;Le!==null;){switch(ve=Le,Pe=ve.child,ve.tag){case 0:case 11:case 14:case 15:Tc(4,ve,ve.return);break;case 1:ll(ve,ve.return);var ze=ve.stateNode;if(typeof ze.componentWillUnmount=="function"){b=ve,m=ve.return;try{o=b,ze.props=o.memoizedProps,ze.state=o.memoizedState,ze.componentWillUnmount()}catch(Ie){mn(b,m,Ie)}}break;case 5:ll(ve,ve.return);break;case 22:if(ve.memoizedState!==null){jw(Ne);continue}}Pe!==null?(Pe.return=ve,Le=Pe):jw(Ne)}be=be.sibling}e:for(be=null,Ne=r;;){if(Ne.tag===5){if(be===null){be=Ne;try{M=Ne.stateNode,he?($=M.style,typeof $.setProperty=="function"?$.setProperty("display","none","important"):$.display="none"):(ee=Ne.stateNode,ae=Ne.memoizedProps.style,U=ae!=null&&ae.hasOwnProperty("display")?ae.display:null,ee.style.display=Ft("display",U))}catch(Ie){mn(r,r.return,Ie)}}}else if(Ne.tag===6){if(be===null)try{Ne.stateNode.nodeValue=he?"":Ne.memoizedProps}catch(Ie){mn(r,r.return,Ie)}}else if((Ne.tag!==22&&Ne.tag!==23||Ne.memoizedState===null||Ne===r)&&Ne.child!==null){Ne.child.return=Ne,Ne=Ne.child;continue}if(Ne===r)break e;for(;Ne.sibling===null;){if(Ne.return===null||Ne.return===r)break e;be===Ne&&(be=null),Ne=Ne.return}be===Ne&&(be=null),Ne.sibling.return=Ne.return,Ne=Ne.sibling}}break;case 19:_r(o,r),Dr(r),b&4&&bw(r);break;case 21:break;default:_r(o,r),Dr(r)}}function Dr(r){var o=r.flags;if(o&2){try{e:{for(var m=r.return;m!==null;){if(_w(m)){var b=m;break e}m=m.return}throw Error(n(160))}switch(b.tag){case 5:var M=b.stateNode;b.flags&32&&(jt(M,""),b.flags&=-33);var $=vw(r);bp(r,$,M);break;case 3:case 4:var U=b.stateNode.containerInfo,ee=vw(r);yp(r,ee,U);break;default:throw Error(n(161))}}catch(ae){mn(r,r.return,ae)}r.flags&=-3}o&4096&&(r.flags&=-4097)}function oz(r,o,m){Le=r,ww(r)}function ww(r,o,m){for(var b=(r.mode&1)!==0;Le!==null;){var M=Le,$=M.child;if(M.tag===22&&b){var U=M.memoizedState!==null||Yd;if(!U){var ee=M.alternate,ae=ee!==null&&ee.memoizedState!==null||us;ee=Yd;var he=us;if(Yd=U,(us=ae)&&!he)for(Le=M;Le!==null;)U=Le,ae=U.child,U.tag===22&&U.memoizedState!==null?Cw(M):ae!==null?(ae.return=U,Le=ae):Cw(M);for(;$!==null;)Le=$,ww($),$=$.sibling;Le=M,Yd=ee,us=he}Nw(r)}else M.subtreeFlags&8772&&$!==null?($.return=M,Le=$):Nw(r)}}function Nw(r){for(;Le!==null;){var o=Le;if(o.flags&8772){var m=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:us||Gd(5,o);break;case 1:var b=o.stateNode;if(o.flags&4&&!us)if(m===null)b.componentDidMount();else{var M=o.elementType===o.type?m.memoizedProps:pr(o.type,m.memoizedProps);b.componentDidUpdate(M,m.memoizedState,b.__reactInternalSnapshotBeforeUpdate)}var $=o.updateQueue;$!==null&&j0(o,$,b);break;case 3:var U=o.updateQueue;if(U!==null){if(m=null,o.child!==null)switch(o.child.tag){case 5:m=o.child.stateNode;break;case 1:m=o.child.stateNode}j0(o,U,m)}break;case 5:var ee=o.stateNode;if(m===null&&o.flags&4){m=ee;var ae=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":ae.autoFocus&&m.focus();break;case"img":ae.src&&(m.src=ae.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var he=o.alternate;if(he!==null){var be=he.memoizedState;if(be!==null){var Ne=be.dehydrated;Ne!==null&&pn(Ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}us||o.flags&512&&vp(o)}catch(ve){mn(o,o.return,ve)}}if(o===r){Le=null;break}if(m=o.sibling,m!==null){m.return=o.return,Le=m;break}Le=o.return}}function jw(r){for(;Le!==null;){var o=Le;if(o===r){Le=null;break}var m=o.sibling;if(m!==null){m.return=o.return,Le=m;break}Le=o.return}}function Cw(r){for(;Le!==null;){var o=Le;try{switch(o.tag){case 0:case 11:case 15:var m=o.return;try{Gd(4,o)}catch(ae){mn(o,m,ae)}break;case 1:var b=o.stateNode;if(typeof b.componentDidMount=="function"){var M=o.return;try{b.componentDidMount()}catch(ae){mn(o,M,ae)}}var $=o.return;try{vp(o)}catch(ae){mn(o,$,ae)}break;case 5:var U=o.return;try{vp(o)}catch(ae){mn(o,U,ae)}}}catch(ae){mn(o,o.return,ae)}if(o===r){Le=null;break}var ee=o.sibling;if(ee!==null){ee.return=o.return,Le=ee;break}Le=o.return}}var iz=Math.ceil,Qd=C.ReactCurrentDispatcher,xp=C.ReactCurrentOwner,ar=C.ReactCurrentBatchConfig,kt=0,qn=null,jn=null,Zn=0,Gs=0,cl=$r(0),Pn=0,$c=null,ri=0,Xd=0,wp=0,Pc=null,Os=null,Np=0,ul=1/0,ha=null,Jd=!1,jp=null,to=null,Zd=!1,no=null,em=0,Rc=0,Cp=null,tm=-1,nm=0;function xs(){return kt&6?et():tm!==-1?tm:tm=et()}function so(r){return r.mode&1?kt&2&&Zn!==0?Zn&-Zn:HL.transition!==null?(nm===0&&(nm=dn()),nm):(r=vt,r!==0||(r=window.event,r=r===void 0?16:Pa(r.type)),r):1}function vr(r,o,m,b){if(50<Rc)throw Rc=0,Cp=null,Error(n(185));In(r,m,b),(!(kt&2)||r!==qn)&&(r===qn&&(!(kt&2)&&(Xd|=m),Pn===4&&ro(r,Zn)),Ts(r,b),m===1&&kt===0&&!(o.mode&1)&&(ul=et()+500,Ad&&Xa()))}function Ts(r,o){var m=r.callbackNode;Mn(r,o);var b=Xt(r,r===qn?Zn:0);if(b===0)m!==null&&Yn(m),r.callbackNode=null,r.callbackPriority=0;else if(o=b&-b,r.callbackPriority!==o){if(m!=null&&Yn(m),o===1)r.tag===0?qL(Ew.bind(null,r)):m0(Ew.bind(null,r)),$f(function(){!(kt&6)&&Xa()}),m=null;else{switch(Fo(b)){case 1:m=Fn;break;case 4:m=Us;break;case 16:m=os;break;case 536870912:m=ie;break;default:m=os}m=Rw(m,Sw.bind(null,r))}r.callbackPriority=o,r.callbackNode=m}}function Sw(r,o){if(tm=-1,nm=0,kt&6)throw Error(n(327));var m=r.callbackNode;if(dl()&&r.callbackNode!==m)return null;var b=Xt(r,r===qn?Zn:0);if(b===0)return null;if(b&30||b&r.expiredLanes||o)o=sm(r,b);else{o=b;var M=kt;kt|=2;var $=Mw();(qn!==r||Zn!==o)&&(ha=null,ul=et()+500,oi(r,o));do try{uz();break}catch(ee){kw(r,ee)}while(!0);qf(),Qd.current=$,kt=M,jn!==null?o=0:(qn=null,Zn=0,o=Pn)}if(o!==0){if(o===2&&(M=fn(r),M!==0&&(b=M,o=Sp(r,M))),o===1)throw m=$c,oi(r,0),ro(r,b),Ts(r,et()),m;if(o===6)ro(r,b);else{if(M=r.current.alternate,!(b&30)&&!lz(M)&&(o=sm(r,b),o===2&&($=fn(r),$!==0&&(b=$,o=Sp(r,$))),o===1))throw m=$c,oi(r,0),ro(r,b),Ts(r,et()),m;switch(r.finishedWork=M,r.finishedLanes=b,o){case 0:case 1:throw Error(n(345));case 2:ii(r,Os,ha);break;case 3:if(ro(r,b),(b&130023424)===b&&(o=Np+500-et(),10<o)){if(Xt(r,0)!==0)break;if(M=r.suspendedLanes,(M&b)!==b){xs(),r.pingedLanes|=r.suspendedLanes&M;break}r.timeoutHandle=bc(ii.bind(null,r,Os,ha),o);break}ii(r,Os,ha);break;case 4:if(ro(r,b),(b&4194240)===b)break;for(o=r.eventTimes,M=-1;0<b;){var U=31-we(b);$=1<<U,U=o[U],U>M&&(M=U),b&=~$}if(b=M,b=et()-b,b=(120>b?120:480>b?480:1080>b?1080:1920>b?1920:3e3>b?3e3:4320>b?4320:1960*iz(b/1960))-b,10<b){r.timeoutHandle=bc(ii.bind(null,r,Os,ha),b);break}ii(r,Os,ha);break;case 5:ii(r,Os,ha);break;default:throw Error(n(329))}}}return Ts(r,et()),r.callbackNode===m?Sw.bind(null,r):null}function Sp(r,o){var m=Pc;return r.current.memoizedState.isDehydrated&&(oi(r,o).flags|=256),r=sm(r,o),r!==2&&(o=Os,Os=m,o!==null&&Ep(o)),r}function Ep(r){Os===null?Os=r:Os.push.apply(Os,r)}function lz(r){for(var o=r;;){if(o.flags&16384){var m=o.updateQueue;if(m!==null&&(m=m.stores,m!==null))for(var b=0;b<m.length;b++){var M=m[b],$=M.getSnapshot;M=M.value;try{if(!Ws($(),M))return!1}catch{return!1}}}if(m=o.child,o.subtreeFlags&16384&&m!==null)m.return=o,o=m;else{if(o===r)break;for(;o.sibling===null;){if(o.return===null||o.return===r)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ro(r,o){for(o&=~wp,o&=~Xd,r.suspendedLanes|=o,r.pingedLanes&=~o,r=r.expirationTimes;0<o;){var m=31-we(o),b=1<<m;r[m]=-1,o&=~b}}function Ew(r){if(kt&6)throw Error(n(327));dl();var o=Xt(r,0);if(!(o&1))return Ts(r,et()),null;var m=sm(r,o);if(r.tag!==0&&m===2){var b=fn(r);b!==0&&(o=b,m=Sp(r,b))}if(m===1)throw m=$c,oi(r,0),ro(r,o),Ts(r,et()),m;if(m===6)throw Error(n(345));return r.finishedWork=r.current.alternate,r.finishedLanes=o,ii(r,Os,ha),Ts(r,et()),null}function kp(r,o){var m=kt;kt|=1;try{return r(o)}finally{kt=m,kt===0&&(ul=et()+500,Ad&&Xa())}}function ai(r){no!==null&&no.tag===0&&!(kt&6)&&dl();var o=kt;kt|=1;var m=ar.transition,b=vt;try{if(ar.transition=null,vt=1,r)return r()}finally{vt=b,ar.transition=m,kt=o,!(kt&6)&&Xa()}}function Mp(){Gs=cl.current,Et(cl)}function oi(r,o){r.finishedWork=null,r.finishedLanes=0;var m=r.timeoutHandle;if(m!==-1&&(r.timeoutHandle=-1,Tf(m)),jn!==null)for(m=jn.return;m!==null;){var b=m;switch(Df(b),b.tag){case 1:b=b.type.childContextTypes,b!=null&&kd();break;case 3:ol(),Et(Xn),Et(Tn),Xf();break;case 5:Gf(b);break;case 4:ol();break;case 13:Et(an);break;case 19:Et(an);break;case 10:Hf(b.type._context);break;case 22:case 23:Mp()}m=m.return}if(qn=r,jn=r=ao(r.current,null),Zn=Gs=o,Pn=0,$c=null,wp=Xd=ri=0,Os=Pc=null,ti!==null){for(o=0;o<ti.length;o++)if(m=ti[o],b=m.interleaved,b!==null){m.interleaved=null;var M=b.next,$=m.pending;if($!==null){var U=$.next;$.next=M,b.next=U}m.pending=b}ti=null}return r}function kw(r,o){do{var m=jn;try{if(qf(),Id.current=Hd,Bd){for(var b=on.memoizedState;b!==null;){var M=b.queue;M!==null&&(M.pending=null),b=b.next}Bd=!1}if(si=0,Un=$n=on=null,Ec=!1,kc=0,xp.current=null,m===null||m.return===null){Pn=1,$c=o,jn=null;break}e:{var $=r,U=m.return,ee=m,ae=o;if(o=Zn,ee.flags|=32768,ae!==null&&typeof ae=="object"&&typeof ae.then=="function"){var he=ae,be=ee,Ne=be.tag;if(!(be.mode&1)&&(Ne===0||Ne===11||Ne===15)){var ve=be.alternate;ve?(be.updateQueue=ve.updateQueue,be.memoizedState=ve.memoizedState,be.lanes=ve.lanes):(be.updateQueue=null,be.memoizedState=null)}var Pe=Z0(U);if(Pe!==null){Pe.flags&=-257,ew(Pe,U,ee,$,o),Pe.mode&1&&J0($,he,o),o=Pe,ae=he;var ze=o.updateQueue;if(ze===null){var Ie=new Set;Ie.add(ae),o.updateQueue=Ie}else ze.add(ae);break e}else{if(!(o&1)){J0($,he,o),Ap();break e}ae=Error(n(426))}}else if(en&&ee.mode&1){var gn=Z0(U);if(gn!==null){!(gn.flags&65536)&&(gn.flags|=256),ew(gn,U,ee,$,o),Bf(il(ae,ee));break e}}$=ae=il(ae,ee),Pn!==4&&(Pn=2),Pc===null?Pc=[$]:Pc.push($),$=U;do{switch($.tag){case 3:$.flags|=65536,o&=-o,$.lanes|=o;var le=Q0($,ae,o);N0($,le);break e;case 1:ee=ae;var oe=$.type,ue=$.stateNode;if(!($.flags&128)&&(typeof oe.getDerivedStateFromError=="function"||ue!==null&&typeof ue.componentDidCatch=="function"&&(to===null||!to.has(ue)))){$.flags|=65536,o&=-o,$.lanes|=o;var Ce=X0($,ee,o);N0($,Ce);break e}}$=$.return}while($!==null)}Ow(m)}catch(He){o=He,jn===m&&m!==null&&(jn=m=m.return);continue}break}while(!0)}function Mw(){var r=Qd.current;return Qd.current=Hd,r===null?Hd:r}function Ap(){(Pn===0||Pn===3||Pn===2)&&(Pn=4),qn===null||!(ri&268435455)&&!(Xd&268435455)||ro(qn,Zn)}function sm(r,o){var m=kt;kt|=2;var b=Mw();(qn!==r||Zn!==o)&&(ha=null,oi(r,o));do try{cz();break}catch(M){kw(r,M)}while(!0);if(qf(),kt=m,Qd.current=b,jn!==null)throw Error(n(261));return qn=null,Zn=0,Pn}function cz(){for(;jn!==null;)Aw(jn)}function uz(){for(;jn!==null&&!as();)Aw(jn)}function Aw(r){var o=Pw(r.alternate,r,Gs);r.memoizedProps=r.pendingProps,o===null?Ow(r):jn=o,xp.current=null}function Ow(r){var o=r;do{var m=o.alternate;if(r=o.return,o.flags&32768){if(m=sz(m,o),m!==null){m.flags&=32767,jn=m;return}if(r!==null)r.flags|=32768,r.subtreeFlags=0,r.deletions=null;else{Pn=6,jn=null;return}}else if(m=nz(m,o,Gs),m!==null){jn=m;return}if(o=o.sibling,o!==null){jn=o;return}jn=o=r}while(o!==null);Pn===0&&(Pn=5)}function ii(r,o,m){var b=vt,M=ar.transition;try{ar.transition=null,vt=1,dz(r,o,m,b)}finally{ar.transition=M,vt=b}return null}function dz(r,o,m,b){do dl();while(no!==null);if(kt&6)throw Error(n(327));m=r.finishedWork;var M=r.finishedLanes;if(m===null)return null;if(r.finishedWork=null,r.finishedLanes=0,m===r.current)throw Error(n(177));r.callbackNode=null,r.callbackPriority=0;var $=m.lanes|m.childLanes;if(Xr(r,$),r===qn&&(jn=qn=null,Zn=0),!(m.subtreeFlags&2064)&&!(m.flags&2064)||Zd||(Zd=!0,Rw(os,function(){return dl(),null})),$=(m.flags&15990)!==0,m.subtreeFlags&15990||$){$=ar.transition,ar.transition=null;var U=vt;vt=1;var ee=kt;kt|=4,xp.current=null,az(r,m),xw(m,r),jf(vc),_s=!!jd,vc=jd=null,r.current=m,oz(m),Wt(),kt=ee,vt=U,ar.transition=$}else r.current=m;if(Zd&&(Zd=!1,no=r,em=M),$=r.pendingLanes,$===0&&(to=null),Ct(m.stateNode),Ts(r,et()),o!==null)for(b=r.onRecoverableError,m=0;m<o.length;m++)M=o[m],b(M.value,{componentStack:M.stack,digest:M.digest});if(Jd)throw Jd=!1,r=jp,jp=null,r;return em&1&&r.tag!==0&&dl(),$=r.pendingLanes,$&1?r===Cp?Rc++:(Rc=0,Cp=r):Rc=0,Xa(),null}function dl(){if(no!==null){var r=Fo(em),o=ar.transition,m=vt;try{if(ar.transition=null,vt=16>r?16:r,no===null)var b=!1;else{if(r=no,no=null,em=0,kt&6)throw Error(n(331));var M=kt;for(kt|=4,Le=r.current;Le!==null;){var $=Le,U=$.child;if(Le.flags&16){var ee=$.deletions;if(ee!==null){for(var ae=0;ae<ee.length;ae++){var he=ee[ae];for(Le=he;Le!==null;){var be=Le;switch(be.tag){case 0:case 11:case 15:Tc(8,be,$)}var Ne=be.child;if(Ne!==null)Ne.return=be,Le=Ne;else for(;Le!==null;){be=Le;var ve=be.sibling,Pe=be.return;if(gw(be),be===he){Le=null;break}if(ve!==null){ve.return=Pe,Le=ve;break}Le=Pe}}}var ze=$.alternate;if(ze!==null){var Ie=ze.child;if(Ie!==null){ze.child=null;do{var gn=Ie.sibling;Ie.sibling=null,Ie=gn}while(Ie!==null)}}Le=$}}if($.subtreeFlags&2064&&U!==null)U.return=$,Le=U;else e:for(;Le!==null;){if($=Le,$.flags&2048)switch($.tag){case 0:case 11:case 15:Tc(9,$,$.return)}var le=$.sibling;if(le!==null){le.return=$.return,Le=le;break e}Le=$.return}}var oe=r.current;for(Le=oe;Le!==null;){U=Le;var ue=U.child;if(U.subtreeFlags&2064&&ue!==null)ue.return=U,Le=ue;else e:for(U=oe;Le!==null;){if(ee=Le,ee.flags&2048)try{switch(ee.tag){case 0:case 11:case 15:Gd(9,ee)}}catch(He){mn(ee,ee.return,He)}if(ee===U){Le=null;break e}var Ce=ee.sibling;if(Ce!==null){Ce.return=ee.return,Le=Ce;break e}Le=ee.return}}if(kt=M,Xa(),$e&&typeof $e.onPostCommitFiberRoot=="function")try{$e.onPostCommitFiberRoot(_e,r)}catch{}b=!0}return b}finally{vt=m,ar.transition=o}}return!1}function Tw(r,o,m){o=il(m,o),o=Q0(r,o,1),r=Za(r,o,1),o=xs(),r!==null&&(In(r,1,o),Ts(r,o))}function mn(r,o,m){if(r.tag===3)Tw(r,r,m);else for(;o!==null;){if(o.tag===3){Tw(o,r,m);break}else if(o.tag===1){var b=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof b.componentDidCatch=="function"&&(to===null||!to.has(b))){r=il(m,r),r=X0(o,r,1),o=Za(o,r,1),r=xs(),o!==null&&(In(o,1,r),Ts(o,r));break}}o=o.return}}function mz(r,o,m){var b=r.pingCache;b!==null&&b.delete(o),o=xs(),r.pingedLanes|=r.suspendedLanes&m,qn===r&&(Zn&m)===m&&(Pn===4||Pn===3&&(Zn&130023424)===Zn&&500>et()-Np?oi(r,0):wp|=m),Ts(r,o)}function $w(r,o){o===0&&(r.mode&1?(o=Pt,Pt<<=1,!(Pt&130023424)&&(Pt=4194304)):o=1);var m=xs();r=ua(r,o),r!==null&&(In(r,o,m),Ts(r,m))}function hz(r){var o=r.memoizedState,m=0;o!==null&&(m=o.retryLane),$w(r,m)}function fz(r,o){var m=0;switch(r.tag){case 13:var b=r.stateNode,M=r.memoizedState;M!==null&&(m=M.retryLane);break;case 19:b=r.stateNode;break;default:throw Error(n(314))}b!==null&&b.delete(o),$w(r,m)}var Pw;Pw=function(r,o,m){if(r!==null)if(r.memoizedProps!==o.pendingProps||Xn.current)As=!0;else{if(!(r.lanes&m)&&!(o.flags&128))return As=!1,tz(r,o,m);As=!!(r.flags&131072)}else As=!1,en&&o.flags&1048576&&h0(o,Td,o.index);switch(o.lanes=0,o.tag){case 2:var b=o.type;Kd(r,o),r=o.pendingProps;var M=Gt(o,Tn.current);al(o,m),M=ep(null,o,b,r,M,m);var $=tp();return o.flags|=1,typeof M=="object"&&M!==null&&typeof M.render=="function"&&M.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Bn(b)?($=!0,Md(o)):$=!1,o.memoizedState=M.state!==null&&M.state!==void 0?M.state:null,Kf(o),M.updater=Vd,o.stateNode=M,M._reactInternals=o,ip(o,b,r,m),o=dp(null,o,b,!0,$,m)):(o.tag=0,en&&$&&zf(o),bs(null,o,M,m),o=o.child),o;case 16:b=o.elementType;e:{switch(Kd(r,o),r=o.pendingProps,M=b._init,b=M(b._payload),o.type=b,M=o.tag=gz(b),r=pr(b,r),M){case 0:o=up(null,o,b,r,m);break e;case 1:o=ow(null,o,b,r,m);break e;case 11:o=tw(null,o,b,r,m);break e;case 14:o=nw(null,o,b,pr(b.type,r),m);break e}throw Error(n(306,b,""))}return o;case 0:return b=o.type,M=o.pendingProps,M=o.elementType===b?M:pr(b,M),up(r,o,b,M,m);case 1:return b=o.type,M=o.pendingProps,M=o.elementType===b?M:pr(b,M),ow(r,o,b,M,m);case 3:e:{if(iw(o),r===null)throw Error(n(387));b=o.pendingProps,$=o.memoizedState,M=$.element,w0(r,o),Dd(o,b,null,m);var U=o.memoizedState;if(b=U.element,$.isDehydrated)if($={element:b,isDehydrated:!1,cache:U.cache,pendingSuspenseBoundaries:U.pendingSuspenseBoundaries,transitions:U.transitions},o.updateQueue.baseState=$,o.memoizedState=$,o.flags&256){M=il(Error(n(423)),o),o=lw(r,o,b,m,M);break e}else if(b!==M){M=il(Error(n(424)),o),o=lw(r,o,b,m,M);break e}else for(Ys=Tr(o.stateNode.containerInfo.firstChild),Ks=o,en=!0,fr=null,m=b0(o,null,b,m),o.child=m;m;)m.flags=m.flags&-3|4096,m=m.sibling;else{if(nl(),b===M){o=ma(r,o,m);break e}bs(r,o,b,m)}o=o.child}return o;case 5:return C0(o),r===null&&If(o),b=o.type,M=o.pendingProps,$=r!==null?r.memoizedProps:null,U=M.children,yc(b,M)?U=null:$!==null&&yc(b,$)&&(o.flags|=32),aw(r,o),bs(r,o,U,m),o.child;case 6:return r===null&&If(o),null;case 13:return cw(r,o,m);case 4:return Yf(o,o.stateNode.containerInfo),b=o.pendingProps,r===null?o.child=sl(o,null,b,m):bs(r,o,b,m),o.child;case 11:return b=o.type,M=o.pendingProps,M=o.elementType===b?M:pr(b,M),tw(r,o,b,M,m);case 7:return bs(r,o,o.pendingProps,m),o.child;case 8:return bs(r,o,o.pendingProps.children,m),o.child;case 12:return bs(r,o,o.pendingProps.children,m),o.child;case 10:e:{if(b=o.type._context,M=o.pendingProps,$=o.memoizedProps,U=M.value,Ke(Rd,b._currentValue),b._currentValue=U,$!==null)if(Ws($.value,U)){if($.children===M.children&&!Xn.current){o=ma(r,o,m);break e}}else for($=o.child,$!==null&&($.return=o);$!==null;){var ee=$.dependencies;if(ee!==null){U=$.child;for(var ae=ee.firstContext;ae!==null;){if(ae.context===b){if($.tag===1){ae=da(-1,m&-m),ae.tag=2;var he=$.updateQueue;if(he!==null){he=he.shared;var be=he.pending;be===null?ae.next=ae:(ae.next=be.next,be.next=ae),he.pending=ae}}$.lanes|=m,ae=$.alternate,ae!==null&&(ae.lanes|=m),Vf($.return,m,o),ee.lanes|=m;break}ae=ae.next}}else if($.tag===10)U=$.type===o.type?null:$.child;else if($.tag===18){if(U=$.return,U===null)throw Error(n(341));U.lanes|=m,ee=U.alternate,ee!==null&&(ee.lanes|=m),Vf(U,m,o),U=$.sibling}else U=$.child;if(U!==null)U.return=$;else for(U=$;U!==null;){if(U===o){U=null;break}if($=U.sibling,$!==null){$.return=U.return,U=$;break}U=U.return}$=U}bs(r,o,M.children,m),o=o.child}return o;case 9:return M=o.type,b=o.pendingProps.children,al(o,m),M=sr(M),b=b(M),o.flags|=1,bs(r,o,b,m),o.child;case 14:return b=o.type,M=pr(b,o.pendingProps),M=pr(b.type,M),nw(r,o,b,M,m);case 15:return sw(r,o,o.type,o.pendingProps,m);case 17:return b=o.type,M=o.pendingProps,M=o.elementType===b?M:pr(b,M),Kd(r,o),o.tag=1,Bn(b)?(r=!0,Md(o)):r=!1,al(o,m),Y0(o,b,M),ip(o,b,M,m),dp(null,o,b,!0,r,m);case 19:return dw(r,o,m);case 22:return rw(r,o,m)}throw Error(n(156,o.tag))};function Rw(r,o){return Bs(r,o)}function pz(r,o,m,b){this.tag=r,this.key=m,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=b,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function or(r,o,m,b){return new pz(r,o,m,b)}function Op(r){return r=r.prototype,!(!r||!r.isReactComponent)}function gz(r){if(typeof r=="function")return Op(r)?1:0;if(r!=null){if(r=r.$$typeof,r===F)return 11;if(r===D)return 14}return 2}function ao(r,o){var m=r.alternate;return m===null?(m=or(r.tag,o,r.key,r.mode),m.elementType=r.elementType,m.type=r.type,m.stateNode=r.stateNode,m.alternate=r,r.alternate=m):(m.pendingProps=o,m.type=r.type,m.flags=0,m.subtreeFlags=0,m.deletions=null),m.flags=r.flags&14680064,m.childLanes=r.childLanes,m.lanes=r.lanes,m.child=r.child,m.memoizedProps=r.memoizedProps,m.memoizedState=r.memoizedState,m.updateQueue=r.updateQueue,o=r.dependencies,m.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},m.sibling=r.sibling,m.index=r.index,m.ref=r.ref,m}function rm(r,o,m,b,M,$){var U=2;if(b=r,typeof r=="function")Op(r)&&(U=1);else if(typeof r=="string")U=5;else e:switch(r){case A:return li(m.children,M,$,o);case R:U=8,M|=8;break;case P:return r=or(12,m,o,M|2),r.elementType=P,r.lanes=$,r;case B:return r=or(13,m,o,M),r.elementType=B,r.lanes=$,r;case L:return r=or(19,m,o,M),r.elementType=L,r.lanes=$,r;case Y:return am(m,M,$,o);default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case T:U=10;break e;case O:U=9;break e;case F:U=11;break e;case D:U=14;break e;case q:U=16,b=null;break e}throw Error(n(130,r==null?r:typeof r,""))}return o=or(U,m,o,M),o.elementType=r,o.type=b,o.lanes=$,o}function li(r,o,m,b){return r=or(7,r,b,o),r.lanes=m,r}function am(r,o,m,b){return r=or(22,r,b,o),r.elementType=Y,r.lanes=m,r.stateNode={isHidden:!1},r}function Tp(r,o,m){return r=or(6,r,null,o),r.lanes=m,r}function $p(r,o,m){return o=or(4,r.children!==null?r.children:[],r.key,o),o.lanes=m,o.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},o}function _z(r,o,m,b,M){this.tag=o,this.containerInfo=r,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gn(0),this.expirationTimes=Gn(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gn(0),this.identifierPrefix=b,this.onRecoverableError=M,this.mutableSourceEagerHydrationData=null}function Pp(r,o,m,b,M,$,U,ee,ae){return r=new _z(r,o,m,ee,ae),o===1?(o=1,$===!0&&(o|=8)):o=0,$=or(3,null,null,o),r.current=$,$.stateNode=r,$.memoizedState={element:b,isDehydrated:m,cache:null,transitions:null,pendingSuspenseBoundaries:null},Kf($),r}function vz(r,o,m){var b=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:E,key:b==null?null:""+b,children:r,containerInfo:o,implementation:m}}function Lw(r){if(!r)return Pr;r=r._reactInternals;e:{if(wn(r)!==r||r.tag!==1)throw Error(n(170));var o=r;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Bn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(r.tag===1){var m=r.type;if(Bn(m))return u0(r,m,o)}return o}function zw(r,o,m,b,M,$,U,ee,ae){return r=Pp(m,b,!0,r,M,$,U,ee,ae),r.context=Lw(null),m=r.current,b=xs(),M=so(m),$=da(b,M),$.callback=o??null,Za(m,$,M),r.current.lanes=M,In(r,M,b),Ts(r,b),r}function om(r,o,m,b){var M=o.current,$=xs(),U=so(M);return m=Lw(m),o.context===null?o.context=m:o.pendingContext=m,o=da($,U),o.payload={element:r},b=b===void 0?null:b,b!==null&&(o.callback=b),r=Za(M,o,U),r!==null&&(vr(r,M,U,$),zd(r,M,U)),U}function im(r){if(r=r.current,!r.child)return null;switch(r.child.tag){case 5:return r.child.stateNode;default:return r.child.stateNode}}function Dw(r,o){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var m=r.retryLane;r.retryLane=m!==0&&m<o?m:o}}function Rp(r,o){Dw(r,o),(r=r.alternate)&&Dw(r,o)}function yz(){return null}var Fw=typeof reportError=="function"?reportError:function(r){console.error(r)};function Lp(r){this._internalRoot=r}lm.prototype.render=Lp.prototype.render=function(r){var o=this._internalRoot;if(o===null)throw Error(n(409));om(r,o,null,null)},lm.prototype.unmount=Lp.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var o=r.containerInfo;ai(function(){om(null,r,null,null)}),o[hr]=null}};function lm(r){this._internalRoot=r}lm.prototype.unstable_scheduleHydration=function(r){if(r){var o=Ui();r={blockedOn:null,target:r,priority:o};for(var m=0;m<je.length&&o!==0&&o<je[m].priority;m++);je.splice(m,0,r),m===0&&ot(r)}};function zp(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function cm(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11&&(r.nodeType!==8||r.nodeValue!==" react-mount-point-unstable "))}function Iw(){}function bz(r,o,m,b,M){if(M){if(typeof b=="function"){var $=b;b=function(){var he=im(U);$.call(he)}}var U=zw(o,b,r,0,null,!1,!1,"",Iw);return r._reactRootContainer=U,r[hr]=U.current,Qo(r.nodeType===8?r.parentNode:r),ai(),U}for(;M=r.lastChild;)r.removeChild(M);if(typeof b=="function"){var ee=b;b=function(){var he=im(ae);ee.call(he)}}var ae=Pp(r,0,!1,null,null,!1,!1,"",Iw);return r._reactRootContainer=ae,r[hr]=ae.current,Qo(r.nodeType===8?r.parentNode:r),ai(function(){om(o,ae,m,b)}),ae}function um(r,o,m,b,M){var $=m._reactRootContainer;if($){var U=$;if(typeof M=="function"){var ee=M;M=function(){var ae=im(U);ee.call(ae)}}om(o,U,r,M)}else U=bz(m,o,r,M,b);return im(U)}Io=function(r){switch(r.tag){case 3:var o=r.stateNode;if(o.current.memoizedState.isDehydrated){var m=Dt(o.pendingLanes);m!==0&&(Ta(o,m|1),Ts(o,et()),!(kt&6)&&(ul=et()+500,Xa()))}break;case 13:ai(function(){var b=ua(r,1);if(b!==null){var M=xs();vr(b,r,1,M)}}),Rp(r,1)}},Jr=function(r){if(r.tag===13){var o=ua(r,134217728);if(o!==null){var m=xs();vr(o,r,134217728,m)}Rp(r,134217728)}},Bo=function(r){if(r.tag===13){var o=so(r),m=ua(r,o);if(m!==null){var b=xs();vr(m,r,o,b)}Rp(r,o)}},Ui=function(){return vt},Uo=function(r,o){var m=vt;try{return vt=r,o()}finally{vt=m}},En=function(r,o,m){switch(o){case"input":if(de(r,m),o=m.name,m.type==="radio"&&o!=null){for(m=r;m.parentNode;)m=m.parentNode;for(m=m.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<m.length;o++){var b=m[o];if(b!==r&&b.form===r.form){var M=Zi(b);if(!M)throw Error(n(90));Re(b),de(b,M)}}}break;case"textarea":Ye(r,m);break;case"select":o=m.value,o!=null&&Ue(r,!!m.multiple,o,!1)}},tt=kp,fs=ai;var xz={usingClientEntryPoint:!1,Events:[Jo,Ga,Zi,Qt,ft,kp]},Lc={findFiberByHostInstance:oa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wz={bundleType:Lc.bundleType,version:Lc.version,rendererPackageName:Lc.rendererPackageName,rendererConfig:Lc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:C.ReactCurrentDispatcher,findHostInstanceByFiber:function(r){return r=rs(r),r===null?null:r.stateNode},findFiberByHostInstance:Lc.findFiberByHostInstance||yz,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var dm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!dm.isDisabled&&dm.supportsFiber)try{_e=dm.inject(wz),$e=dm}catch{}}return ws.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xz,ws.createPortal=function(r,o){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zp(o))throw Error(n(200));return vz(r,o,null,m)},ws.createRoot=function(r,o){if(!zp(r))throw Error(n(299));var m=!1,b="",M=Fw;return o!=null&&(o.unstable_strictMode===!0&&(m=!0),o.identifierPrefix!==void 0&&(b=o.identifierPrefix),o.onRecoverableError!==void 0&&(M=o.onRecoverableError)),o=Pp(r,1,!1,null,null,m,!1,b,M),r[hr]=o.current,Qo(r.nodeType===8?r.parentNode:r),new Lp(o)},ws.findDOMNode=function(r){if(r==null)return null;if(r.nodeType===1)return r;var o=r._reactInternals;if(o===void 0)throw typeof r.render=="function"?Error(n(188)):(r=Object.keys(r).join(","),Error(n(268,r)));return r=rs(o),r=r===null?null:r.stateNode,r},ws.flushSync=function(r){return ai(r)},ws.hydrate=function(r,o,m){if(!cm(o))throw Error(n(200));return um(null,r,o,!0,m)},ws.hydrateRoot=function(r,o,m){if(!zp(r))throw Error(n(405));var b=m!=null&&m.hydratedSources||null,M=!1,$="",U=Fw;if(m!=null&&(m.unstable_strictMode===!0&&(M=!0),m.identifierPrefix!==void 0&&($=m.identifierPrefix),m.onRecoverableError!==void 0&&(U=m.onRecoverableError)),o=zw(o,null,r,1,m??null,M,!1,$,U),r[hr]=o.current,Qo(r),b)for(r=0;r<b.length;r++)m=b[r],M=m._getVersion,M=M(m._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[m,M]:o.mutableSourceEagerHydrationData.push(m,M);return new lm(o)},ws.render=function(r,o,m){if(!cm(o))throw Error(n(200));return um(null,r,o,!1,m)},ws.unmountComponentAtNode=function(r){if(!cm(r))throw Error(n(40));return r._reactRootContainer?(ai(function(){um(null,null,r,!1,function(){r._reactRootContainer=null,r[hr]=null})}),!0):!1},ws.unstable_batchedUpdates=kp,ws.unstable_renderSubtreeIntoContainer=function(r,o,m,b){if(!cm(m))throw Error(n(200));if(r==null||r._reactInternals===void 0)throw Error(n(38));return um(r,o,m,!1,b)},ws.version="18.3.1-next-f1338f8080-20240426",ws}function Zp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Zp)}catch(e){console.error(e)}}Zp(),Gp.exports=Kw();var eg=Gp.exports,tg=eg;fm.createRoot=tg.createRoot,fm.hydrateRoot=tg.hydrateRoot;var ci=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Yw={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},Gw=(Qx=class{constructor(){Ve(this,Na,Yw);Ve(this,cf,!1)}setTimeoutProvider(e){Te(this,Na,e)}setTimeout(e,t){return se(this,Na).setTimeout(e,t)}clearTimeout(e){se(this,Na).clearTimeout(e)}setInterval(e,t){return se(this,Na).setInterval(e,t)}clearInterval(e){se(this,Na).clearInterval(e)}},Na=new WeakMap,cf=new WeakMap,Qx),co=new Gw;function Qw(e){setTimeout(e,0)}var uo=typeof window>"u"||"Deno"in globalThis;function ds(){}function Xw(e,t){return typeof e=="function"?e(t):e}function _m(e){return typeof e=="number"&&e>=0&&e!==1/0}function ng(e,t){return Math.max(e+(t||0)-Date.now(),0)}function pa(e,t){return typeof e=="function"?e(t):e}function Qs(e,t){return typeof e=="function"?e(t):e}function sg(e,t){const{type:n="all",exact:s,fetchStatus:i,predicate:l,queryKey:c,stale:u}=e;if(c){if(s){if(t.queryHash!==vm(c,t.options))return!1}else if(!ml(t.queryKey,c))return!1}if(n!=="all"){const d=t.isActive();if(n==="active"&&!d||n==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||i&&i!==t.state.fetchStatus||l&&!l(t))}function rg(e,t){const{exact:n,status:s,predicate:i,mutationKey:l}=e;if(l){if(!t.options.mutationKey)return!1;if(n){if(mo(t.options.mutationKey)!==mo(l))return!1}else if(!ml(t.options.mutationKey,l))return!1}return!(s&&t.state.status!==s||i&&!i(t))}function vm(e,t){return((t==null?void 0:t.queryKeyHashFn)||mo)(e)}function mo(e){return JSON.stringify(e,(t,n)=>ym(n)?Object.keys(n).sort().reduce((s,i)=>(s[i]=n[i],s),{}):n)}function ml(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>ml(e[n],t[n])):!1}var Jw=Object.prototype.hasOwnProperty;function ag(e,t){if(e===t)return e;const n=og(e)&&og(t);if(!n&&!(ym(e)&&ym(t)))return t;const i=(n?e:Object.keys(e)).length,l=n?t:Object.keys(t),c=l.length,u=n?new Array(c):{};let d=0;for(let f=0;f<c;f++){const h=n?f:l[f],p=e[h],g=t[h];if(p===g){u[h]=p,(n?f<i:Jw.call(e,h))&&d++;continue}if(p===null||g===null||typeof p!="object"||typeof g!="object"){u[h]=g;continue}const _=ag(p,g);u[h]=_,_===p&&d++}return i===c&&d===i?e:u}function Dc(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function og(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function ym(e){if(!ig(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!ig(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function ig(e){return Object.prototype.toString.call(e)==="[object Object]"}function Zw(e){return new Promise(t=>{co.setTimeout(t,e)})}function bm(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?ag(e,t):t}function eN(e,t,n=0){const s=[...e,t];return n&&s.length>n?s.slice(1):s}function tN(e,t,n=0){const s=[t,...e];return n&&s.length>n?s.slice(0,-1):s}var xm=Symbol();function lg(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===xm?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function cg(e,t){return typeof e=="function"?e(...t):!!e}var nN=(Xx=class extends ci{constructor(){super();Ve(this,Ao);Ve(this,ja);Ve(this,Ai);Te(this,Ai,t=>{if(!uo&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){se(this,ja)||this.setEventListener(se(this,Ai))}onUnsubscribe(){var t;this.hasListeners()||((t=se(this,ja))==null||t.call(this),Te(this,ja,void 0))}setEventListener(t){var n;Te(this,Ai,t),(n=se(this,ja))==null||n.call(this),Te(this,ja,t(s=>{typeof s=="boolean"?this.setFocused(s):this.onFocus()}))}setFocused(t){se(this,Ao)!==t&&(Te(this,Ao,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof se(this,Ao)=="boolean"?se(this,Ao):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ao=new WeakMap,ja=new WeakMap,Ai=new WeakMap,Xx),wm=new nN;function Nm(){let e,t;const n=new Promise((i,l)=>{e=i,t=l});n.status="pending",n.catch(()=>{});function s(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{s({status:"fulfilled",value:i}),e(i)},n.reject=i=>{s({status:"rejected",reason:i}),t(i)},n}var sN=Qw;function rN(){let e=[],t=0,n=u=>{u()},s=u=>{u()},i=sN;const l=u=>{t?e.push(u):i(()=>{n(u)})},c=()=>{const u=e;e=[],u.length&&i(()=>{s(()=>{u.forEach(d=>{n(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{l(()=>{u(...d)})},schedule:l,setNotifyFunction:u=>{n=u},setBatchNotifyFunction:u=>{s=u},setScheduler:u=>{i=u}}}var Cn=rN(),aN=(Jx=class extends ci{constructor(){super();Ve(this,Oi,!0);Ve(this,Ca);Ve(this,Ti);Te(this,Ti,t=>{if(!uo&&window.addEventListener){const n=()=>t(!0),s=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",s,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",s)}}})}onSubscribe(){se(this,Ca)||this.setEventListener(se(this,Ti))}onUnsubscribe(){var t;this.hasListeners()||((t=se(this,Ca))==null||t.call(this),Te(this,Ca,void 0))}setEventListener(t){var n;Te(this,Ti,t),(n=se(this,Ca))==null||n.call(this),Te(this,Ca,t(this.setOnline.bind(this)))}setOnline(t){se(this,Oi)!==t&&(Te(this,Oi,t),this.listeners.forEach(s=>{s(t)}))}isOnline(){return se(this,Oi)}},Oi=new WeakMap,Ca=new WeakMap,Ti=new WeakMap,Jx),Fc=new aN;function oN(e){return Math.min(1e3*2**e,3e4)}function ug(e){return(e??"online")==="online"?Fc.isOnline():!0}var jm=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function dg(e){let t=!1,n=0,s;const i=Nm(),l=()=>i.status!=="pending",c=v=>{var x;if(!l()){const j=new jm(v);g(j),(x=e.onCancel)==null||x.call(e,j)}},u=()=>{t=!0},d=()=>{t=!1},f=()=>wm.isFocused()&&(e.networkMode==="always"||Fc.isOnline())&&e.canRun(),h=()=>ug(e.networkMode)&&e.canRun(),p=v=>{l()||(s==null||s(),i.resolve(v))},g=v=>{l()||(s==null||s(),i.reject(v))},_=()=>new Promise(v=>{var x;s=j=>{(l()||f())&&v(j)},(x=e.onPause)==null||x.call(e)}).then(()=>{var v;s=void 0,l()||(v=e.onContinue)==null||v.call(e)}),N=()=>{if(l())return;let v;const x=n===0?e.initialPromise:void 0;try{v=x??e.fn()}catch(j){v=Promise.reject(j)}Promise.resolve(v).then(p).catch(j=>{var E;if(l())return;const k=e.retry??(uo?0:3),S=e.retryDelay??oN,C=typeof S=="function"?S(n,j):S,w=k===!0||typeof k=="number"&&n<k||typeof k=="function"&&k(n,j);if(t||!w){g(j);return}n++,(E=e.onFail)==null||E.call(e,n,j),Zw(C).then(()=>f()?void 0:_()).then(()=>{t?g(j):N()})})};return{promise:i,status:()=>i.status,cancel:c,continue:()=>(s==null||s(),i),cancelRetry:u,continueRetry:d,canStart:h,start:()=>(h()?N():_().then(N),i)}}var mg=(Zx=class{constructor(){Ve(this,Oo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),_m(this.gcTime)&&Te(this,Oo,co.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(uo?1/0:5*60*1e3))}clearGcTimeout(){se(this,Oo)&&(co.clearTimeout(se(this,Oo)),Te(this,Oo,void 0))}},Oo=new WeakMap,Zx),iN={NODE_ENV:"production"},lN=(e0=class extends mg{constructor(t){super();Ve(this,dr);Ve(this,To);Ve(this,$i);Ve(this,Xs);Ve(this,$o);Ve(this,Ln);Ve(this,Jl);Ve(this,Po);Te(this,Po,!1),Te(this,Jl,t.defaultOptions),this.setOptions(t.options),this.observers=[],Te(this,$o,t.client),Te(this,Xs,se(this,$o).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Te(this,To,fg(this.options)),this.state=t.state??se(this,To),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=se(this,Ln))==null?void 0:t.promise}setOptions(t){if(this.options={...se(this,Jl),...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const n=fg(this.options);n.data!==void 0&&(this.setData(n.data,{updatedAt:n.dataUpdatedAt,manual:!0}),Te(this,To,n))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&se(this,Xs).remove(this)}setData(t,n){const s=bm(this.state.data,t,this.options);return gt(this,dr,fa).call(this,{data:s,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),s}setState(t,n){gt(this,dr,fa).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var s,i;const n=(s=se(this,Ln))==null?void 0:s.promise;return(i=se(this,Ln))==null||i.cancel(t),n?n.then(ds).catch(ds):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(se(this,To))}isActive(){return this.observers.some(t=>Qs(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===xm||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>pa(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!ng(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(s=>s.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=se(this,Ln))==null||n.continue()}onOnline(){var n;const t=this.observers.find(s=>s.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=se(this,Ln))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),se(this,Xs).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(se(this,Ln)&&(se(this,Po)?se(this,Ln).cancel({revert:!0}):se(this,Ln).cancelRetry()),this.scheduleGc()),se(this,Xs).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||gt(this,dr,fa).call(this,{type:"invalidate"})}async fetch(t,n){var d,f,h,p,g,_,N,v,x,j,k,S;if(this.state.fetchStatus!=="idle"&&((d=se(this,Ln))==null?void 0:d.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(se(this,Ln))return se(this,Ln).continueRetry(),se(this,Ln).promise}if(t&&this.setOptions(t),!this.options.queryFn){const C=this.observers.find(w=>w.options.queryFn);C&&this.setOptions(C.options)}const s=new AbortController,i=C=>{Object.defineProperty(C,"signal",{enumerable:!0,get:()=>(Te(this,Po,!0),s.signal)})},l=()=>{const C=lg(this.options,n),E=(()=>{const A={client:se(this,$o),queryKey:this.queryKey,meta:this.meta};return i(A),A})();return Te(this,Po,!1),this.options.persister?this.options.persister(C,E,this):C(E)},u=(()=>{const C={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:se(this,$o),state:this.state,fetchFn:l};return i(C),C})();(f=this.options.behavior)==null||f.onFetch(u,this),Te(this,$i,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((h=u.fetchOptions)==null?void 0:h.meta))&&gt(this,dr,fa).call(this,{type:"fetch",meta:(p=u.fetchOptions)==null?void 0:p.meta}),Te(this,Ln,dg({initialPromise:n==null?void 0:n.initialPromise,fn:u.fetchFn,onCancel:C=>{C instanceof jm&&C.revert&&this.setState({...se(this,$i),fetchStatus:"idle"}),s.abort()},onFail:(C,w)=>{gt(this,dr,fa).call(this,{type:"failed",failureCount:C,error:w})},onPause:()=>{gt(this,dr,fa).call(this,{type:"pause"})},onContinue:()=>{gt(this,dr,fa).call(this,{type:"continue"})},retry:u.options.retry,retryDelay:u.options.retryDelay,networkMode:u.options.networkMode,canRun:()=>!0}));try{const C=await se(this,Ln).start();if(C===void 0)throw iN.NODE_ENV,new Error(`${this.queryHash} data is undefined`);return this.setData(C),(_=(g=se(this,Xs).config).onSuccess)==null||_.call(g,C,this),(v=(N=se(this,Xs).config).onSettled)==null||v.call(N,C,this.state.error,this),C}catch(C){if(C instanceof jm){if(C.silent)return se(this,Ln).promise;if(C.revert){if(this.state.data===void 0)throw C;return this.state.data}}throw gt(this,dr,fa).call(this,{type:"error",error:C}),(j=(x=se(this,Xs).config).onError)==null||j.call(x,C,this),(S=(k=se(this,Xs).config).onSettled)==null||S.call(k,this.state.data,C,this),C}finally{this.scheduleGc()}}},To=new WeakMap,$i=new WeakMap,Xs=new WeakMap,$o=new WeakMap,Ln=new WeakMap,Jl=new WeakMap,Po=new WeakMap,dr=new WeakSet,fa=function(t){const n=s=>{switch(t.type){case"failed":return{...s,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...hg(s.data,this.options),fetchMeta:t.meta??null};case"success":const i={...s,data:t.data,dataUpdateCount:s.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Te(this,$i,t.manual?i:void 0),i;case"error":const l=t.error;return{...s,error:l,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...t.state}}};this.state=n(this.state),Cn.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),se(this,Xs).notify({query:this,type:"updated",action:t})})},e0);function hg(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:ug(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function fg(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,s=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?s??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var cN=(t0=class extends ci{constructor(t,n){super();Ve(this,Rt);Ve(this,Ss);Ve(this,xt);Ve(this,Zl);Ve(this,ms);Ve(this,Ro);Ve(this,Pi);Ve(this,Wr);Ve(this,Sa);Ve(this,ec);Ve(this,Ri);Ve(this,Li);Ve(this,Lo);Ve(this,zo);Ve(this,Ea);Ve(this,zi,new Set);this.options=n,Te(this,Ss,t),Te(this,Sa,null),Te(this,Wr,Nm()),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(se(this,xt).addObserver(this),pg(se(this,xt),this.options)?gt(this,Rt,zc).call(this):this.updateResult(),gt(this,Rt,Up).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Cm(se(this,xt),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Cm(se(this,xt),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,gt(this,Rt,qp).call(this),gt(this,Rt,Hp).call(this),se(this,xt).removeObserver(this)}setOptions(t){const n=this.options,s=se(this,xt);if(this.options=se(this,Ss).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Qs(this.options.enabled,se(this,xt))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");gt(this,Rt,Vp).call(this),se(this,xt).setOptions(this.options),n._defaulted&&!Dc(this.options,n)&&se(this,Ss).getQueryCache().notify({type:"observerOptionsUpdated",query:se(this,xt),observer:this});const i=this.hasListeners();i&&gg(se(this,xt),s,this.options,n)&&gt(this,Rt,zc).call(this),this.updateResult(),i&&(se(this,xt)!==s||Qs(this.options.enabled,se(this,xt))!==Qs(n.enabled,se(this,xt))||pa(this.options.staleTime,se(this,xt))!==pa(n.staleTime,se(this,xt)))&&gt(this,Rt,Fp).call(this);const l=gt(this,Rt,Ip).call(this);i&&(se(this,xt)!==s||Qs(this.options.enabled,se(this,xt))!==Qs(n.enabled,se(this,xt))||l!==se(this,Ea))&&gt(this,Rt,Bp).call(this,l)}getOptimisticResult(t){const n=se(this,Ss).getQueryCache().build(se(this,Ss),t),s=this.createResult(n,t);return dN(this,s)&&(Te(this,ms,s),Te(this,Pi,this.options),Te(this,Ro,se(this,xt).state)),s}getCurrentResult(){return se(this,ms)}trackResult(t,n){return new Proxy(t,{get:(s,i)=>(this.trackProp(i),n==null||n(i),i==="promise"&&!this.options.experimental_prefetchInRender&&se(this,Wr).status==="pending"&&se(this,Wr).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),Reflect.get(s,i))})}trackProp(t){se(this,zi).add(t)}getCurrentQuery(){return se(this,xt)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=se(this,Ss).defaultQueryOptions(t),s=se(this,Ss).getQueryCache().build(se(this,Ss),n);return s.fetch().then(()=>this.createResult(s,n))}fetch(t){return gt(this,Rt,zc).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),se(this,ms)))}createResult(t,n){var P;const s=se(this,xt),i=this.options,l=se(this,ms),c=se(this,Ro),u=se(this,Pi),f=t!==s?t.state:se(this,Zl),{state:h}=t;let p={...h},g=!1,_;if(n._optimisticResults){const T=this.hasListeners(),O=!T&&pg(t,n),F=T&&gg(t,s,n,i);(O||F)&&(p={...p,...hg(h.data,t.options)}),n._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:N,errorUpdatedAt:v,status:x}=p;_=p.data;let j=!1;if(n.placeholderData!==void 0&&_===void 0&&x==="pending"){let T;l!=null&&l.isPlaceholderData&&n.placeholderData===(u==null?void 0:u.placeholderData)?(T=l.data,j=!0):T=typeof n.placeholderData=="function"?n.placeholderData((P=se(this,Li))==null?void 0:P.state.data,se(this,Li)):n.placeholderData,T!==void 0&&(x="success",_=bm(l==null?void 0:l.data,T,n),g=!0)}if(n.select&&_!==void 0&&!j)if(l&&_===(c==null?void 0:c.data)&&n.select===se(this,ec))_=se(this,Ri);else try{Te(this,ec,n.select),_=n.select(_),_=bm(l==null?void 0:l.data,_,n),Te(this,Ri,_),Te(this,Sa,null)}catch(T){Te(this,Sa,T)}se(this,Sa)&&(N=se(this,Sa),_=se(this,Ri),v=Date.now(),x="error");const k=p.fetchStatus==="fetching",S=x==="pending",C=x==="error",w=S&&k,E=_!==void 0,R={status:x,fetchStatus:p.fetchStatus,isPending:S,isSuccess:x==="success",isError:C,isInitialLoading:w,isLoading:w,data:_,dataUpdatedAt:p.dataUpdatedAt,error:N,errorUpdatedAt:v,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>f.dataUpdateCount||p.errorUpdateCount>f.errorUpdateCount,isFetching:k,isRefetching:k&&!S,isLoadingError:C&&!E,isPaused:p.fetchStatus==="paused",isPlaceholderData:g,isRefetchError:C&&E,isStale:Sm(t,n),refetch:this.refetch,promise:se(this,Wr),isEnabled:Qs(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const T=B=>{R.status==="error"?B.reject(R.error):R.data!==void 0&&B.resolve(R.data)},O=()=>{const B=Te(this,Wr,R.promise=Nm());T(B)},F=se(this,Wr);switch(F.status){case"pending":t.queryHash===s.queryHash&&T(F);break;case"fulfilled":(R.status==="error"||R.data!==F.value)&&O();break;case"rejected":(R.status!=="error"||R.error!==F.reason)&&O();break}}return R}updateResult(){const t=se(this,ms),n=this.createResult(se(this,xt),this.options);if(Te(this,Ro,se(this,xt).state),Te(this,Pi,this.options),se(this,Ro).data!==void 0&&Te(this,Li,se(this,xt)),Dc(n,t))return;Te(this,ms,n);const s=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,l=typeof i=="function"?i():i;if(l==="all"||!l&&!se(this,zi).size)return!0;const c=new Set(l??se(this,zi));return this.options.throwOnError&&c.add("error"),Object.keys(se(this,ms)).some(u=>{const d=u;return se(this,ms)[d]!==t[d]&&c.has(d)})};gt(this,Rt,Uw).call(this,{listeners:s()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&gt(this,Rt,Up).call(this)}},Ss=new WeakMap,xt=new WeakMap,Zl=new WeakMap,ms=new WeakMap,Ro=new WeakMap,Pi=new WeakMap,Wr=new WeakMap,Sa=new WeakMap,ec=new WeakMap,Ri=new WeakMap,Li=new WeakMap,Lo=new WeakMap,zo=new WeakMap,Ea=new WeakMap,zi=new WeakMap,Rt=new WeakSet,zc=function(t){gt(this,Rt,Vp).call(this);let n=se(this,xt).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(ds)),n},Fp=function(){gt(this,Rt,qp).call(this);const t=pa(this.options.staleTime,se(this,xt));if(uo||se(this,ms).isStale||!_m(t))return;const s=ng(se(this,ms).dataUpdatedAt,t)+1;Te(this,Lo,co.setTimeout(()=>{se(this,ms).isStale||this.updateResult()},s))},Ip=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(se(this,xt)):this.options.refetchInterval)??!1},Bp=function(t){gt(this,Rt,Hp).call(this),Te(this,Ea,t),!(uo||Qs(this.options.enabled,se(this,xt))===!1||!_m(se(this,Ea))||se(this,Ea)===0)&&Te(this,zo,co.setInterval(()=>{(this.options.refetchIntervalInBackground||wm.isFocused())&&gt(this,Rt,zc).call(this)},se(this,Ea)))},Up=function(){gt(this,Rt,Fp).call(this),gt(this,Rt,Bp).call(this,gt(this,Rt,Ip).call(this))},qp=function(){se(this,Lo)&&(co.clearTimeout(se(this,Lo)),Te(this,Lo,void 0))},Hp=function(){se(this,zo)&&(co.clearInterval(se(this,zo)),Te(this,zo,void 0))},Vp=function(){const t=se(this,Ss).getQueryCache().build(se(this,Ss),this.options);if(t===se(this,xt))return;const n=se(this,xt);Te(this,xt,t),Te(this,Zl,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},Uw=function(t){Cn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(se(this,ms))}),se(this,Ss).getQueryCache().notify({query:se(this,xt),type:"observerResultsUpdated"})})},t0);function uN(e,t){return Qs(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function pg(e,t){return uN(e,t)||e.state.data!==void 0&&Cm(e,t,t.refetchOnMount)}function Cm(e,t,n){if(Qs(t.enabled,e)!==!1&&pa(t.staleTime,e)!=="static"){const s=typeof n=="function"?n(e):n;return s==="always"||s!==!1&&Sm(e,t)}return!1}function gg(e,t,n,s){return(e!==t||Qs(s.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Sm(e,n)}function Sm(e,t){return Qs(t.enabled,e)!==!1&&e.isStaleByTime(pa(t.staleTime,e))}function dN(e,t){return!Dc(e.getCurrentResult(),t)}function _g(e){return{onFetch:(t,n)=>{var h,p,g,_,N;const s=t.options,i=(g=(p=(h=t.fetchOptions)==null?void 0:h.meta)==null?void 0:p.fetchMore)==null?void 0:g.direction,l=((_=t.state.data)==null?void 0:_.pages)||[],c=((N=t.state.data)==null?void 0:N.pageParams)||[];let u={pages:[],pageParams:[]},d=0;const f=async()=>{let v=!1;const x=S=>{Object.defineProperty(S,"signal",{enumerable:!0,get:()=>(t.signal.aborted?v=!0:t.signal.addEventListener("abort",()=>{v=!0}),t.signal)})},j=lg(t.options,t.fetchOptions),k=async(S,C,w)=>{if(v)return Promise.reject();if(C==null&&S.pages.length)return Promise.resolve(S);const A=(()=>{const O={client:t.client,queryKey:t.queryKey,pageParam:C,direction:w?"backward":"forward",meta:t.options.meta};return x(O),O})(),R=await j(A),{maxPages:P}=t.options,T=w?tN:eN;return{pages:T(S.pages,R,P),pageParams:T(S.pageParams,C,P)}};if(i&&l.length){const S=i==="backward",C=S?mN:vg,w={pages:l,pageParams:c},E=C(s,w);u=await k(w,E,S)}else{const S=e??l.length;do{const C=d===0?c[0]??s.initialPageParam:vg(s,u);if(d>0&&C==null)break;u=await k(u,C),d++}while(d<S)}return u};t.options.persister?t.fetchFn=()=>{var v,x;return(x=(v=t.options).persister)==null?void 0:x.call(v,f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=f}}}function vg(e,{pages:t,pageParams:n}){const s=t.length-1;return t.length>0?e.getNextPageParam(t[s],t,n[s],n):void 0}function mN(e,{pages:t,pageParams:n}){var s;return t.length>0?(s=e.getPreviousPageParam)==null?void 0:s.call(e,t[0],t,n[0],n):void 0}var hN=(n0=class extends mg{constructor(t){super();Ve(this,jr);Ve(this,tc);Ve(this,Nr);Ve(this,hs);Ve(this,Do);Te(this,tc,t.client),this.mutationId=t.mutationId,Te(this,hs,t.mutationCache),Te(this,Nr,[]),this.state=t.state||yg(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){se(this,Nr).includes(t)||(se(this,Nr).push(t),this.clearGcTimeout(),se(this,hs).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Te(this,Nr,se(this,Nr).filter(n=>n!==t)),this.scheduleGc(),se(this,hs).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){se(this,Nr).length||(this.state.status==="pending"?this.scheduleGc():se(this,hs).remove(this))}continue(){var t;return((t=se(this,Do))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var c,u,d,f,h,p,g,_,N,v,x,j,k,S,C,w,E,A,R,P;const n=()=>{gt(this,jr,io).call(this,{type:"continue"})},s={client:se(this,tc),meta:this.options.meta,mutationKey:this.options.mutationKey};Te(this,Do,dg({fn:()=>this.options.mutationFn?this.options.mutationFn(t,s):Promise.reject(new Error("No mutationFn found")),onFail:(T,O)=>{gt(this,jr,io).call(this,{type:"failed",failureCount:T,error:O})},onPause:()=>{gt(this,jr,io).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>se(this,hs).canRun(this)}));const i=this.state.status==="pending",l=!se(this,Do).canStart();try{if(i)n();else{gt(this,jr,io).call(this,{type:"pending",variables:t,isPaused:l}),await((u=(c=se(this,hs).config).onMutate)==null?void 0:u.call(c,t,this,s));const O=await((f=(d=this.options).onMutate)==null?void 0:f.call(d,t,s));O!==this.state.context&&gt(this,jr,io).call(this,{type:"pending",context:O,variables:t,isPaused:l})}const T=await se(this,Do).start();return await((p=(h=se(this,hs).config).onSuccess)==null?void 0:p.call(h,T,t,this.state.context,this,s)),await((_=(g=this.options).onSuccess)==null?void 0:_.call(g,T,t,this.state.context,s)),await((v=(N=se(this,hs).config).onSettled)==null?void 0:v.call(N,T,null,this.state.variables,this.state.context,this,s)),await((j=(x=this.options).onSettled)==null?void 0:j.call(x,T,null,t,this.state.context,s)),gt(this,jr,io).call(this,{type:"success",data:T}),T}catch(T){try{throw await((S=(k=se(this,hs).config).onError)==null?void 0:S.call(k,T,t,this.state.context,this,s)),await((w=(C=this.options).onError)==null?void 0:w.call(C,T,t,this.state.context,s)),await((A=(E=se(this,hs).config).onSettled)==null?void 0:A.call(E,void 0,T,this.state.variables,this.state.context,this,s)),await((P=(R=this.options).onSettled)==null?void 0:P.call(R,void 0,T,t,this.state.context,s)),T}finally{gt(this,jr,io).call(this,{type:"error",error:T})}}finally{se(this,hs).runNext(this)}}},tc=new WeakMap,Nr=new WeakMap,hs=new WeakMap,Do=new WeakMap,jr=new WeakSet,io=function(t){const n=s=>{switch(t.type){case"failed":return{...s,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...s,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:t.error,failureCount:s.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Cn.batch(()=>{se(this,Nr).forEach(s=>{s.onMutationUpdate(t)}),se(this,hs).notify({mutation:this,type:"updated",action:t})})},n0);function yg(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var fN=(s0=class extends ci{constructor(t={}){super();Ve(this,Kr);Ve(this,mr);Ve(this,nc);this.config=t,Te(this,Kr,new Set),Te(this,mr,new Map),Te(this,nc,0)}build(t,n,s){const i=new hN({client:t,mutationCache:this,mutationId:++mm(this,nc)._,options:t.defaultMutationOptions(n),state:s});return this.add(i),i}add(t){se(this,Kr).add(t);const n=Ic(t);if(typeof n=="string"){const s=se(this,mr).get(n);s?s.push(t):se(this,mr).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(se(this,Kr).delete(t)){const n=Ic(t);if(typeof n=="string"){const s=se(this,mr).get(n);if(s)if(s.length>1){const i=s.indexOf(t);i!==-1&&s.splice(i,1)}else s[0]===t&&se(this,mr).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Ic(t);if(typeof n=="string"){const s=se(this,mr).get(n),i=s==null?void 0:s.find(l=>l.state.status==="pending");return!i||i===t}else return!0}runNext(t){var s;const n=Ic(t);if(typeof n=="string"){const i=(s=se(this,mr).get(n))==null?void 0:s.find(l=>l!==t&&l.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Cn.batch(()=>{se(this,Kr).forEach(t=>{this.notify({type:"removed",mutation:t})}),se(this,Kr).clear(),se(this,mr).clear()})}getAll(){return Array.from(se(this,Kr))}find(t){const n={exact:!0,...t};return this.getAll().find(s=>rg(n,s))}findAll(t={}){return this.getAll().filter(n=>rg(t,n))}notify(t){Cn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Cn.batch(()=>Promise.all(t.map(n=>n.continue().catch(ds))))}},Kr=new WeakMap,mr=new WeakMap,nc=new WeakMap,s0);function Ic(e){var t;return(t=e.options.scope)==null?void 0:t.id}var pN=(r0=class extends ci{constructor(t,n){super();Ve(this,Qr);Ve(this,Yr);Ve(this,ka);Ve(this,Es);Ve(this,Gr);Te(this,Yr,t),this.setOptions(n),this.bindMethods(),gt(this,Qr,hm).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){var s;const n=this.options;this.options=se(this,Yr).defaultMutationOptions(t),Dc(this.options,n)||se(this,Yr).getMutationCache().notify({type:"observerOptionsUpdated",mutation:se(this,Es),observer:this}),n!=null&&n.mutationKey&&this.options.mutationKey&&mo(n.mutationKey)!==mo(this.options.mutationKey)?this.reset():((s=se(this,Es))==null?void 0:s.state.status)==="pending"&&se(this,Es).setOptions(this.options)}onUnsubscribe(){var t;this.hasListeners()||(t=se(this,Es))==null||t.removeObserver(this)}onMutationUpdate(t){gt(this,Qr,hm).call(this),gt(this,Qr,Wp).call(this,t)}getCurrentResult(){return se(this,ka)}reset(){var t;(t=se(this,Es))==null||t.removeObserver(this),Te(this,Es,void 0),gt(this,Qr,hm).call(this),gt(this,Qr,Wp).call(this)}mutate(t,n){var s;return Te(this,Gr,n),(s=se(this,Es))==null||s.removeObserver(this),Te(this,Es,se(this,Yr).getMutationCache().build(se(this,Yr),this.options)),se(this,Es).addObserver(this),se(this,Es).execute(t)}},Yr=new WeakMap,ka=new WeakMap,Es=new WeakMap,Gr=new WeakMap,Qr=new WeakSet,hm=function(){var n;const t=((n=se(this,Es))==null?void 0:n.state)??yg();Te(this,ka,{...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset})},Wp=function(t){Cn.batch(()=>{var n,s,i,l,c,u,d,f;if(se(this,Gr)&&this.hasListeners()){const h=se(this,ka).variables,p=se(this,ka).context,g={client:se(this,Yr),meta:this.options.meta,mutationKey:this.options.mutationKey};(t==null?void 0:t.type)==="success"?((s=(n=se(this,Gr)).onSuccess)==null||s.call(n,t.data,h,p,g),(l=(i=se(this,Gr)).onSettled)==null||l.call(i,t.data,null,h,p,g)):(t==null?void 0:t.type)==="error"&&((u=(c=se(this,Gr)).onError)==null||u.call(c,t.error,h,p,g),(f=(d=se(this,Gr)).onSettled)==null||f.call(d,void 0,t.error,h,p,g))}this.listeners.forEach(h=>{h(se(this,ka))})})},r0),gN=(a0=class extends ci{constructor(t={}){super();Ve(this,Cr);this.config=t,Te(this,Cr,new Map)}build(t,n,s){const i=n.queryKey,l=n.queryHash??vm(i,n);let c=this.get(l);return c||(c=new lN({client:t,queryKey:i,queryHash:l,options:t.defaultQueryOptions(n),state:s,defaultOptions:t.getQueryDefaults(i)}),this.add(c)),c}add(t){se(this,Cr).has(t.queryHash)||(se(this,Cr).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=se(this,Cr).get(t.queryHash);n&&(t.destroy(),n===t&&se(this,Cr).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Cn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return se(this,Cr).get(t)}getAll(){return[...se(this,Cr).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(s=>sg(n,s))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(s=>sg(t,s)):n}notify(t){Cn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Cn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},Cr=new WeakMap,a0),_N=(o0=class{constructor(e={}){Ve(this,cn);Ve(this,Ma);Ve(this,Aa);Ve(this,Di);Ve(this,Fi);Ve(this,Oa);Ve(this,Ii);Ve(this,Bi);Te(this,cn,e.queryCache||new gN),Te(this,Ma,e.mutationCache||new fN),Te(this,Aa,e.defaultOptions||{}),Te(this,Di,new Map),Te(this,Fi,new Map),Te(this,Oa,0)}mount(){mm(this,Oa)._++,se(this,Oa)===1&&(Te(this,Ii,wm.subscribe(async e=>{e&&(await this.resumePausedMutations(),se(this,cn).onFocus())})),Te(this,Bi,Fc.subscribe(async e=>{e&&(await this.resumePausedMutations(),se(this,cn).onOnline())})))}unmount(){var e,t;mm(this,Oa)._--,se(this,Oa)===0&&((e=se(this,Ii))==null||e.call(this),Te(this,Ii,void 0),(t=se(this,Bi))==null||t.call(this),Te(this,Bi,void 0))}isFetching(e){return se(this,cn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return se(this,Ma).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=se(this,cn).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=se(this,cn).build(this,t),s=n.state.data;return s===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(pa(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(s))}getQueriesData(e){return se(this,cn).findAll(e).map(({queryKey:t,state:n})=>{const s=n.data;return[t,s]})}setQueryData(e,t,n){const s=this.defaultQueryOptions({queryKey:e}),i=se(this,cn).get(s.queryHash),l=i==null?void 0:i.state.data,c=Xw(t,l);if(c!==void 0)return se(this,cn).build(this,s).setData(c,{...n,manual:!0})}setQueriesData(e,t,n){return Cn.batch(()=>se(this,cn).findAll(e).map(({queryKey:s})=>[s,this.setQueryData(s,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=se(this,cn).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=se(this,cn);Cn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=se(this,cn);return Cn.batch(()=>(n.findAll(e).forEach(s=>{s.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},s=Cn.batch(()=>se(this,cn).findAll(e).map(i=>i.cancel(n)));return Promise.all(s).then(ds).catch(ds)}invalidateQueries(e,t={}){return Cn.batch(()=>(se(this,cn).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},s=Cn.batch(()=>se(this,cn).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let l=i.fetch(void 0,n);return n.throwOnError||(l=l.catch(ds)),i.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(s).then(ds)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=se(this,cn).build(this,t);return n.isStaleByTime(pa(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(ds).catch(ds)}fetchInfiniteQuery(e){return e.behavior=_g(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(ds).catch(ds)}ensureInfiniteQueryData(e){return e.behavior=_g(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return Fc.isOnline()?se(this,Ma).resumePausedMutations():Promise.resolve()}getQueryCache(){return se(this,cn)}getMutationCache(){return se(this,Ma)}getDefaultOptions(){return se(this,Aa)}setDefaultOptions(e){Te(this,Aa,e)}setQueryDefaults(e,t){se(this,Di).set(mo(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...se(this,Di).values()],n={};return t.forEach(s=>{ml(e,s.queryKey)&&Object.assign(n,s.defaultOptions)}),n}setMutationDefaults(e,t){se(this,Fi).set(mo(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...se(this,Fi).values()],n={};return t.forEach(s=>{ml(e,s.mutationKey)&&Object.assign(n,s.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...se(this,Aa).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=vm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===xm&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...se(this,Aa).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){se(this,cn).clear(),se(this,Ma).clear()}},cn=new WeakMap,Ma=new WeakMap,Aa=new WeakMap,Di=new WeakMap,Fi=new WeakMap,Oa=new WeakMap,Ii=new WeakMap,Bi=new WeakMap,o0),bg=y.createContext(void 0),ho=e=>{const t=y.useContext(bg);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},vN=({client:e,children:t})=>(y.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(bg.Provider,{value:e,children:t})),xg=y.createContext(!1),yN=()=>y.useContext(xg);xg.Provider;function bN(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var xN=y.createContext(bN()),wN=()=>y.useContext(xN),NN=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},jN=e=>{y.useEffect(()=>{e.clearReset()},[e])},CN=({result:e,errorResetBoundary:t,throwOnError:n,query:s,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&s&&(i&&e.data===void 0||cg(n,[e.error,s])),SN=e=>{if(e.suspense){const n=i=>i==="static"?i:Math.max(i??1e3,1e3),s=e.staleTime;e.staleTime=typeof s=="function"?(...i)=>n(s(...i)):n(s),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},EN=(e,t)=>e.isLoading&&e.isFetching&&!t,kN=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,wg=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function MN(e,t,n){var p,g,_,N,v;const s=yN(),i=wN(),l=ho(),c=l.defaultQueryOptions(e);(g=(p=l.getDefaultOptions().queries)==null?void 0:p._experimental_beforeQuery)==null||g.call(p,c),c._optimisticResults=s?"isRestoring":"optimistic",SN(c),NN(c,i),jN(i);const u=!l.getQueryCache().get(c.queryHash),[d]=y.useState(()=>new t(l,c)),f=d.getOptimisticResult(c),h=!s&&e.subscribed!==!1;if(y.useSyncExternalStore(y.useCallback(x=>{const j=h?d.subscribe(Cn.batchCalls(x)):ds;return d.updateResult(),j},[d,h]),()=>d.getCurrentResult(),()=>d.getCurrentResult()),y.useEffect(()=>{d.setOptions(c)},[c,d]),kN(c,f))throw wg(c,d,i);if(CN({result:f,errorResetBoundary:i,throwOnError:c.throwOnError,query:l.getQueryCache().get(c.queryHash),suspense:c.suspense}))throw f.error;if((N=(_=l.getDefaultOptions().queries)==null?void 0:_._experimental_afterQuery)==null||N.call(_,c,f),c.experimental_prefetchInRender&&!uo&&EN(f,s)){const x=u?wg(c,d,i):(v=l.getQueryCache().get(c.queryHash))==null?void 0:v.promise;x==null||x.catch(ds).finally(()=>{d.updateResult()})}return c.notifyOnChangeProps?f:d.trackResult(f)}function $s(e,t){return MN(e,cN)}function Bc(e,t){const n=ho(),[s]=y.useState(()=>new pN(n,e));y.useEffect(()=>{s.setOptions(e)},[s,e]);const i=y.useSyncExternalStore(y.useCallback(c=>s.subscribe(Cn.batchCalls(c)),[s]),()=>s.getCurrentResult(),()=>s.getCurrentResult()),l=y.useCallback((c,u)=>{s.mutate(c,u).catch(ds)},[s]);if(i.error&&cg(s.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:l,mutateAsync:i.mutate}}function AN(e){let t;const n=new Set,s=(f,h)=>{const p=typeof f=="function"?f(t):f;if(p!==t){const g=t;t=h?p:Object.assign({},t,p),n.forEach(_=>_(t,g))}},i=()=>t,l=(f,h=i,p=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let g=h(t);function _(){const N=h(t);if(!p(g,N)){const v=g;f(g=N,v)}}return n.add(_),()=>n.delete(_)},d={setState:s,getState:i,subscribe:(f,h,p)=>h||p?l(f,h,p):(n.add(f),()=>n.delete(f)),destroy:()=>n.clear()};return t=e(s,i,d),d}const Ng=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?y.useEffect:y.useLayoutEffect;function ON(e){const t=typeof e=="function"?AN(e):e,n=(s=t.getState,i=Object.is)=>{const[,l]=y.useReducer(x=>x+1,0),c=t.getState(),u=y.useRef(c),d=y.useRef(s),f=y.useRef(i),h=y.useRef(!1),p=y.useRef();p.current===void 0&&(p.current=s(c));let g,_=!1;(u.current!==c||d.current!==s||f.current!==i||h.current)&&(g=s(c),_=!i(p.current,g)),Ng(()=>{_&&(p.current=g),u.current=c,d.current=s,f.current=i,h.current=!1});const N=y.useRef(c);Ng(()=>{const x=()=>{try{const k=t.getState(),S=d.current(k);f.current(p.current,S)||(u.current=k,p.current=S,l())}catch{h.current=!0,l()}},j=t.subscribe(x);return t.getState()!==N.current&&x(),j},[]);const v=_?g:p.current;return y.useDebugValue(v),v};return Object.assign(n,t),n[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const s=[n,t];return{next(){const i=s.length<=0;return{value:s.shift(),done:i}}}},n}function TN(){const e=y.createContext(void 0);return{Provider:({initialStore:i,createStore:l,children:c})=>{const u=y.useRef();return u.current||(i&&(console.warn("Provider initialStore is deprecated and will be removed in the next version."),l||(l=()=>i)),u.current=l()),y.createElement(e.Provider,{value:u.current},c)},useStore:(i,l=Object.is)=>{const c=y.useContext(e);if(!c)throw new Error("Seems like you have not used zustand provider as an ancestor.");return c(i,l)},useStoreApi:()=>{const i=y.useContext(e);if(!i)throw new Error("Seems like you have not used zustand provider as an ancestor.");return y.useMemo(()=>({getState:i.getState,setState:i.setState,subscribe:i.subscribe,destroy:i.destroy}),[i])}}}var $N={value:()=>{}};function Uc(){for(var e=0,t=arguments.length,n={},s;e<t;++e){if(!(s=arguments[e]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new qc(n)}function qc(e){this._=e}function PN(e,t){return e.trim().split(/^|\s+/).map(function(n){var s="",i=n.indexOf(".");if(i>=0&&(s=n.slice(i+1),n=n.slice(0,i)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}qc.prototype=Uc.prototype={constructor:qc,on:function(e,t){var n=this._,s=PN(e+"",n),i,l=-1,c=s.length;if(arguments.length<2){for(;++l<c;)if((i=(e=s[l]).type)&&(i=RN(n[i],e.name)))return i;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++l<c;)if(i=(e=s[l]).type)n[i]=jg(n[i],e.name,t);else if(t==null)for(i in n)n[i]=jg(n[i],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new qc(e)},call:function(e,t){if((i=arguments.length-2)>0)for(var n=new Array(i),s=0,i,l;s<i;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(l=this._[e],s=0,i=l.length;s<i;++s)l[s].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],i=0,l=s.length;i<l;++i)s[i].value.apply(t,n)}};function RN(e,t){for(var n=0,s=e.length,i;n<s;++n)if((i=e[n]).name===t)return i.value}function jg(e,t,n){for(var s=0,i=e.length;s<i;++s)if(e[s].name===t){e[s]=$N,e=e.slice(0,s).concat(e.slice(s+1));break}return n!=null&&e.push({name:t,value:n}),e}var Em="http://www.w3.org/1999/xhtml";const Cg={svg:"http://www.w3.org/2000/svg",xhtml:Em,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Hc(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Cg.hasOwnProperty(t)?{space:Cg[t],local:e}:e}function LN(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Em&&t.documentElement.namespaceURI===Em?t.createElement(e):t.createElementNS(n,e)}}function zN(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Sg(e){var t=Hc(e);return(t.local?zN:LN)(t)}function DN(){}function km(e){return e==null?DN:function(){return this.querySelector(e)}}function FN(e){typeof e!="function"&&(e=km(e));for(var t=this._groups,n=t.length,s=new Array(n),i=0;i<n;++i)for(var l=t[i],c=l.length,u=s[i]=new Array(c),d,f,h=0;h<c;++h)(d=l[h])&&(f=e.call(d,d.__data__,h,l))&&("__data__"in d&&(f.__data__=d.__data__),u[h]=f);return new Ps(s,this._parents)}function IN(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function BN(){return[]}function Eg(e){return e==null?BN:function(){return this.querySelectorAll(e)}}function UN(e){return function(){return IN(e.apply(this,arguments))}}function qN(e){typeof e=="function"?e=UN(e):e=Eg(e);for(var t=this._groups,n=t.length,s=[],i=[],l=0;l<n;++l)for(var c=t[l],u=c.length,d,f=0;f<u;++f)(d=c[f])&&(s.push(e.call(d,d.__data__,f,c)),i.push(d));return new Ps(s,i)}function kg(e){return function(){return this.matches(e)}}function Mg(e){return function(t){return t.matches(e)}}var HN=Array.prototype.find;function VN(e){return function(){return HN.call(this.children,e)}}function WN(){return this.firstElementChild}function KN(e){return this.select(e==null?WN:VN(typeof e=="function"?e:Mg(e)))}var YN=Array.prototype.filter;function GN(){return Array.from(this.children)}function QN(e){return function(){return YN.call(this.children,e)}}function XN(e){return this.selectAll(e==null?GN:QN(typeof e=="function"?e:Mg(e)))}function JN(e){typeof e!="function"&&(e=kg(e));for(var t=this._groups,n=t.length,s=new Array(n),i=0;i<n;++i)for(var l=t[i],c=l.length,u=s[i]=[],d,f=0;f<c;++f)(d=l[f])&&e.call(d,d.__data__,f,l)&&u.push(d);return new Ps(s,this._parents)}function Ag(e){return new Array(e.length)}function ZN(){return new Ps(this._enter||this._groups.map(Ag),this._parents)}function Vc(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Vc.prototype={constructor:Vc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function ej(e){return function(){return e}}function tj(e,t,n,s,i,l){for(var c=0,u,d=t.length,f=l.length;c<f;++c)(u=t[c])?(u.__data__=l[c],s[c]=u):n[c]=new Vc(e,l[c]);for(;c<d;++c)(u=t[c])&&(i[c]=u)}function nj(e,t,n,s,i,l,c){var u,d,f=new Map,h=t.length,p=l.length,g=new Array(h),_;for(u=0;u<h;++u)(d=t[u])&&(g[u]=_=c.call(d,d.__data__,u,t)+"",f.has(_)?i[u]=d:f.set(_,d));for(u=0;u<p;++u)_=c.call(e,l[u],u,l)+"",(d=f.get(_))?(s[u]=d,d.__data__=l[u],f.delete(_)):n[u]=new Vc(e,l[u]);for(u=0;u<h;++u)(d=t[u])&&f.get(g[u])===d&&(i[u]=d)}function sj(e){return e.__data__}function rj(e,t){if(!arguments.length)return Array.from(this,sj);var n=t?nj:tj,s=this._parents,i=this._groups;typeof e!="function"&&(e=ej(e));for(var l=i.length,c=new Array(l),u=new Array(l),d=new Array(l),f=0;f<l;++f){var h=s[f],p=i[f],g=p.length,_=aj(e.call(h,h&&h.__data__,f,s)),N=_.length,v=u[f]=new Array(N),x=c[f]=new Array(N),j=d[f]=new Array(g);n(h,p,v,x,j,_,t);for(var k=0,S=0,C,w;k<N;++k)if(C=v[k]){for(k>=S&&(S=k+1);!(w=x[S])&&++S<N;);C._next=w||null}}return c=new Ps(c,s),c._enter=u,c._exit=d,c}function aj(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function oj(){return new Ps(this._exit||this._groups.map(Ag),this._parents)}function ij(e,t,n){var s=this.enter(),i=this,l=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),t!=null&&(i=t(i),i&&(i=i.selection())),n==null?l.remove():n(l),s&&i?s.merge(i).order():i}function lj(e){for(var t=e.selection?e.selection():e,n=this._groups,s=t._groups,i=n.length,l=s.length,c=Math.min(i,l),u=new Array(i),d=0;d<c;++d)for(var f=n[d],h=s[d],p=f.length,g=u[d]=new Array(p),_,N=0;N<p;++N)(_=f[N]||h[N])&&(g[N]=_);for(;d<i;++d)u[d]=n[d];return new Ps(u,this._parents)}function cj(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var s=e[t],i=s.length-1,l=s[i],c;--i>=0;)(c=s[i])&&(l&&c.compareDocumentPosition(l)^4&&l.parentNode.insertBefore(c,l),l=c);return this}function uj(e){e||(e=dj);function t(p,g){return p&&g?e(p.__data__,g.__data__):!p-!g}for(var n=this._groups,s=n.length,i=new Array(s),l=0;l<s;++l){for(var c=n[l],u=c.length,d=i[l]=new Array(u),f,h=0;h<u;++h)(f=c[h])&&(d[h]=f);d.sort(t)}return new Ps(i,this._parents).order()}function dj(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function mj(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function hj(){return Array.from(this)}function fj(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],i=0,l=s.length;i<l;++i){var c=s[i];if(c)return c}return null}function pj(){let e=0;for(const t of this)++e;return e}function gj(){return!this.node()}function _j(e){for(var t=this._groups,n=0,s=t.length;n<s;++n)for(var i=t[n],l=0,c=i.length,u;l<c;++l)(u=i[l])&&e.call(u,u.__data__,l,i);return this}function vj(e){return function(){this.removeAttribute(e)}}function yj(e){return function(){this.removeAttributeNS(e.space,e.local)}}function bj(e,t){return function(){this.setAttribute(e,t)}}function xj(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function wj(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Nj(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function jj(e,t){var n=Hc(e);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((t==null?n.local?yj:vj:typeof t=="function"?n.local?Nj:wj:n.local?xj:bj)(n,t))}function Og(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function Cj(e){return function(){this.style.removeProperty(e)}}function Sj(e,t,n){return function(){this.style.setProperty(e,t,n)}}function Ej(e,t,n){return function(){var s=t.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,n)}}function kj(e,t,n){return arguments.length>1?this.each((t==null?Cj:typeof t=="function"?Ej:Sj)(e,t,n??"")):ui(this.node(),e)}function ui(e,t){return e.style.getPropertyValue(t)||Og(e).getComputedStyle(e,null).getPropertyValue(t)}function Mj(e){return function(){delete this[e]}}function Aj(e,t){return function(){this[e]=t}}function Oj(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function Tj(e,t){return arguments.length>1?this.each((t==null?Mj:typeof t=="function"?Oj:Aj)(e,t)):this.node()[e]}function Tg(e){return e.trim().split(/^|\s+/)}function Mm(e){return e.classList||new $g(e)}function $g(e){this._node=e,this._names=Tg(e.getAttribute("class")||"")}$g.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Pg(e,t){for(var n=Mm(e),s=-1,i=t.length;++s<i;)n.add(t[s])}function Rg(e,t){for(var n=Mm(e),s=-1,i=t.length;++s<i;)n.remove(t[s])}function $j(e){return function(){Pg(this,e)}}function Pj(e){return function(){Rg(this,e)}}function Rj(e,t){return function(){(t.apply(this,arguments)?Pg:Rg)(this,e)}}function Lj(e,t){var n=Tg(e+"");if(arguments.length<2){for(var s=Mm(this.node()),i=-1,l=n.length;++i<l;)if(!s.contains(n[i]))return!1;return!0}return this.each((typeof t=="function"?Rj:t?$j:Pj)(n,t))}function zj(){this.textContent=""}function Dj(e){return function(){this.textContent=e}}function Fj(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Ij(e){return arguments.length?this.each(e==null?zj:(typeof e=="function"?Fj:Dj)(e)):this.node().textContent}function Bj(){this.innerHTML=""}function Uj(e){return function(){this.innerHTML=e}}function qj(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Hj(e){return arguments.length?this.each(e==null?Bj:(typeof e=="function"?qj:Uj)(e)):this.node().innerHTML}function Vj(){this.nextSibling&&this.parentNode.appendChild(this)}function Wj(){return this.each(Vj)}function Kj(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Yj(){return this.each(Kj)}function Gj(e){var t=typeof e=="function"?e:Sg(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Qj(){return null}function Xj(e,t){var n=typeof e=="function"?e:Sg(e),s=t==null?Qj:typeof t=="function"?t:km(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function Jj(){var e=this.parentNode;e&&e.removeChild(this)}function Zj(){return this.each(Jj)}function eC(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function tC(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function nC(e){return this.select(e?tC:eC)}function sC(e){return arguments.length?this.property("__data__",e):this.node().__data__}function rC(e){return function(t){e.call(this,t,this.__data__)}}function aC(e){return e.trim().split(/^|\s+/).map(function(t){var n="",s=t.indexOf(".");return s>=0&&(n=t.slice(s+1),t=t.slice(0,s)),{type:t,name:n}})}function oC(e){return function(){var t=this.__on;if(t){for(var n=0,s=-1,i=t.length,l;n<i;++n)l=t[n],(!e.type||l.type===e.type)&&l.name===e.name?this.removeEventListener(l.type,l.listener,l.options):t[++s]=l;++s?t.length=s:delete this.__on}}}function iC(e,t,n){return function(){var s=this.__on,i,l=rC(t);if(s){for(var c=0,u=s.length;c<u;++c)if((i=s[c]).type===e.type&&i.name===e.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=l,i.options=n),i.value=t;return}}this.addEventListener(e.type,l,n),i={type:e.type,name:e.name,value:t,listener:l,options:n},s?s.push(i):this.__on=[i]}}function lC(e,t,n){var s=aC(e+""),i,l=s.length,c;if(arguments.length<2){var u=this.node().__on;if(u){for(var d=0,f=u.length,h;d<f;++d)for(i=0,h=u[d];i<l;++i)if((c=s[i]).type===h.type&&c.name===h.name)return h.value}return}for(u=t?iC:oC,i=0;i<l;++i)this.each(u(s[i],t,n));return this}function Lg(e,t,n){var s=Og(e),i=s.CustomEvent;typeof i=="function"?i=new i(t,n):(i=s.document.createEvent("Event"),n?(i.initEvent(t,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(t,!1,!1)),e.dispatchEvent(i)}function cC(e,t){return function(){return Lg(this,e,t)}}function uC(e,t){return function(){return Lg(this,e,t.apply(this,arguments))}}function dC(e,t){return this.each((typeof t=="function"?uC:cC)(e,t))}function*mC(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var s=e[t],i=0,l=s.length,c;i<l;++i)(c=s[i])&&(yield c)}var zg=[null];function Ps(e,t){this._groups=e,this._parents=t}function hl(){return new Ps([[document.documentElement]],zg)}function hC(){return this}Ps.prototype=hl.prototype={constructor:Ps,select:FN,selectAll:qN,selectChild:KN,selectChildren:XN,filter:JN,data:rj,enter:ZN,exit:oj,join:ij,merge:lj,selection:hC,order:cj,sort:uj,call:mj,nodes:hj,node:fj,size:pj,empty:gj,each:_j,attr:jj,style:kj,property:Tj,classed:Lj,text:Ij,html:Hj,raise:Wj,lower:Yj,append:Gj,insert:Xj,remove:Zj,clone:nC,datum:sC,on:lC,dispatch:dC,[Symbol.iterator]:mC};function ir(e){return typeof e=="string"?new Ps([[document.querySelector(e)]],[document.documentElement]):new Ps([[e]],zg)}function fC(e){let t;for(;t=e.sourceEvent;)e=t;return e}function yr(e,t){if(e=fC(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var s=n.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(t.getScreenCTM().inverse()),[s.x,s.y]}if(t.getBoundingClientRect){var i=t.getBoundingClientRect();return[e.clientX-i.left-t.clientLeft,e.clientY-i.top-t.clientTop]}}return[e.pageX,e.pageY]}const pC={passive:!1},fl={capture:!0,passive:!1};function Am(e){e.stopImmediatePropagation()}function di(e){e.preventDefault(),e.stopImmediatePropagation()}function Dg(e){var t=e.document.documentElement,n=ir(e).on("dragstart.drag",di,fl);"onselectstart"in t?n.on("selectstart.drag",di,fl):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Fg(e,t){var n=e.document.documentElement,s=ir(e).on("dragstart.drag",null);t&&(s.on("click.drag",di,fl),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in n?s.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Wc=e=>()=>e;function Om(e,{sourceEvent:t,subject:n,target:s,identifier:i,active:l,x:c,y:u,dx:d,dy:f,dispatch:h}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:l,enumerable:!0,configurable:!0},x:{value:c,enumerable:!0,configurable:!0},y:{value:u,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:f,enumerable:!0,configurable:!0},_:{value:h}})}Om.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function gC(e){return!e.ctrlKey&&!e.button}function _C(){return this.parentNode}function vC(e,t){return t??{x:e.x,y:e.y}}function yC(){return navigator.maxTouchPoints||"ontouchstart"in this}function bC(){var e=gC,t=_C,n=vC,s=yC,i={},l=Uc("start","drag","end"),c=0,u,d,f,h,p=0;function g(C){C.on("mousedown.drag",_).filter(s).on("touchstart.drag",x).on("touchmove.drag",j,pC).on("touchend.drag touchcancel.drag",k).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function _(C,w){if(!(h||!e.call(this,C,w))){var E=S(this,t.call(this,C,w),C,w,"mouse");E&&(ir(C.view).on("mousemove.drag",N,fl).on("mouseup.drag",v,fl),Dg(C.view),Am(C),f=!1,u=C.clientX,d=C.clientY,E("start",C))}}function N(C){if(di(C),!f){var w=C.clientX-u,E=C.clientY-d;f=w*w+E*E>p}i.mouse("drag",C)}function v(C){ir(C.view).on("mousemove.drag mouseup.drag",null),Fg(C.view,f),di(C),i.mouse("end",C)}function x(C,w){if(e.call(this,C,w)){var E=C.changedTouches,A=t.call(this,C,w),R=E.length,P,T;for(P=0;P<R;++P)(T=S(this,A,C,w,E[P].identifier,E[P]))&&(Am(C),T("start",C,E[P]))}}function j(C){var w=C.changedTouches,E=w.length,A,R;for(A=0;A<E;++A)(R=i[w[A].identifier])&&(di(C),R("drag",C,w[A]))}function k(C){var w=C.changedTouches,E=w.length,A,R;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),A=0;A<E;++A)(R=i[w[A].identifier])&&(Am(C),R("end",C,w[A]))}function S(C,w,E,A,R,P){var T=l.copy(),O=yr(P||E,w),F,B,L;if((L=n.call(C,new Om("beforestart",{sourceEvent:E,target:g,identifier:R,active:c,x:O[0],y:O[1],dx:0,dy:0,dispatch:T}),A))!=null)return F=L.x-O[0]||0,B=L.y-O[1]||0,function D(q,Y,W){var X=O,I;switch(q){case"start":i[R]=D,I=c++;break;case"end":delete i[R],--c;case"drag":O=yr(W||Y,w),I=c;break}T.call(q,C,new Om(q,{sourceEvent:Y,subject:L,target:g,identifier:R,active:I,x:O[0]+F,y:O[1]+B,dx:O[0]-X[0],dy:O[1]-X[1],dispatch:T}),A)}}return g.filter=function(C){return arguments.length?(e=typeof C=="function"?C:Wc(!!C),g):e},g.container=function(C){return arguments.length?(t=typeof C=="function"?C:Wc(C),g):t},g.subject=function(C){return arguments.length?(n=typeof C=="function"?C:Wc(C),g):n},g.touchable=function(C){return arguments.length?(s=typeof C=="function"?C:Wc(!!C),g):s},g.on=function(){var C=l.on.apply(l,arguments);return C===l?g:C},g.clickDistance=function(C){return arguments.length?(p=(C=+C)*C,g):Math.sqrt(p)},g}function Tm(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ig(e,t){var n=Object.create(e.prototype);for(var s in t)n[s]=t[s];return n}function pl(){}var gl=.7,Kc=1/gl,mi="\\s*([+-]?\\d+)\\s*",_l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",br="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",xC=/^#([0-9a-f]{3,8})$/,wC=new RegExp(`^rgb\\(${mi},${mi},${mi}\\)$`),NC=new RegExp(`^rgb\\(${br},${br},${br}\\)$`),jC=new RegExp(`^rgba\\(${mi},${mi},${mi},${_l}\\)$`),CC=new RegExp(`^rgba\\(${br},${br},${br},${_l}\\)$`),SC=new RegExp(`^hsl\\(${_l},${br},${br}\\)$`),EC=new RegExp(`^hsla\\(${_l},${br},${br},${_l}\\)$`),Bg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Tm(pl,vl,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Ug,formatHex:Ug,formatHex8:kC,formatHsl:MC,formatRgb:qg,toString:qg});function Ug(){return this.rgb().formatHex()}function kC(){return this.rgb().formatHex8()}function MC(){return Yg(this).formatHsl()}function qg(){return this.rgb().formatRgb()}function vl(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=xC.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Hg(t):n===3?new Ns(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Yc(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Yc(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=wC.exec(e))?new Ns(t[1],t[2],t[3],1):(t=NC.exec(e))?new Ns(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=jC.exec(e))?Yc(t[1],t[2],t[3],t[4]):(t=CC.exec(e))?Yc(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=SC.exec(e))?Kg(t[1],t[2]/100,t[3]/100,1):(t=EC.exec(e))?Kg(t[1],t[2]/100,t[3]/100,t[4]):Bg.hasOwnProperty(e)?Hg(Bg[e]):e==="transparent"?new Ns(NaN,NaN,NaN,0):null}function Hg(e){return new Ns(e>>16&255,e>>8&255,e&255,1)}function Yc(e,t,n,s){return s<=0&&(e=t=n=NaN),new Ns(e,t,n,s)}function AC(e){return e instanceof pl||(e=vl(e)),e?(e=e.rgb(),new Ns(e.r,e.g,e.b,e.opacity)):new Ns}function $m(e,t,n,s){return arguments.length===1?AC(e):new Ns(e,t,n,s??1)}function Ns(e,t,n,s){this.r=+e,this.g=+t,this.b=+n,this.opacity=+s}Tm(Ns,$m,Ig(pl,{brighter(e){return e=e==null?Kc:Math.pow(Kc,e),new Ns(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?gl:Math.pow(gl,e),new Ns(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ns(fo(this.r),fo(this.g),fo(this.b),Gc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Vg,formatHex:Vg,formatHex8:OC,formatRgb:Wg,toString:Wg}));function Vg(){return`#${po(this.r)}${po(this.g)}${po(this.b)}`}function OC(){return`#${po(this.r)}${po(this.g)}${po(this.b)}${po((isNaN(this.opacity)?1:this.opacity)*255)}`}function Wg(){const e=Gc(this.opacity);return`${e===1?"rgb(":"rgba("}${fo(this.r)}, ${fo(this.g)}, ${fo(this.b)}${e===1?")":`, ${e})`}`}function Gc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function fo(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function po(e){return e=fo(e),(e<16?"0":"")+e.toString(16)}function Kg(e,t,n,s){return s<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new lr(e,t,n,s)}function Yg(e){if(e instanceof lr)return new lr(e.h,e.s,e.l,e.opacity);if(e instanceof pl||(e=vl(e)),!e)return new lr;if(e instanceof lr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,s=e.b/255,i=Math.min(t,n,s),l=Math.max(t,n,s),c=NaN,u=l-i,d=(l+i)/2;return u?(t===l?c=(n-s)/u+(n<s)*6:n===l?c=(s-t)/u+2:c=(t-n)/u+4,u/=d<.5?l+i:2-l-i,c*=60):u=d>0&&d<1?0:c,new lr(c,u,d,e.opacity)}function TC(e,t,n,s){return arguments.length===1?Yg(e):new lr(e,t,n,s??1)}function lr(e,t,n,s){this.h=+e,this.s=+t,this.l=+n,this.opacity=+s}Tm(lr,TC,Ig(pl,{brighter(e){return e=e==null?Kc:Math.pow(Kc,e),new lr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?gl:Math.pow(gl,e),new lr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*t,i=2*n-s;return new Ns(Pm(e>=240?e-240:e+120,i,s),Pm(e,i,s),Pm(e<120?e+240:e-120,i,s),this.opacity)},clamp(){return new lr(Gg(this.h),Qc(this.s),Qc(this.l),Gc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Gc(this.opacity);return`${e===1?"hsl(":"hsla("}${Gg(this.h)}, ${Qc(this.s)*100}%, ${Qc(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Gg(e){return e=(e||0)%360,e<0?e+360:e}function Qc(e){return Math.max(0,Math.min(1,e||0))}function Pm(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Qg=e=>()=>e;function $C(e,t){return function(n){return e+n*t}}function PC(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(s){return Math.pow(e+s*t,n)}}function RC(e){return(e=+e)==1?Xg:function(t,n){return n-t?PC(t,n,e):Qg(isNaN(t)?n:t)}}function Xg(e,t){var n=t-e;return n?$C(e,n):Qg(isNaN(e)?t:e)}const Jg=function e(t){var n=RC(t);function s(i,l){var c=n((i=$m(i)).r,(l=$m(l)).r),u=n(i.g,l.g),d=n(i.b,l.b),f=Xg(i.opacity,l.opacity);return function(h){return i.r=c(h),i.g=u(h),i.b=d(h),i.opacity=f(h),i+""}}return s.gamma=e,s}(1);function ga(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Rm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Lm=new RegExp(Rm.source,"g");function LC(e){return function(){return e}}function zC(e){return function(t){return e(t)+""}}function DC(e,t){var n=Rm.lastIndex=Lm.lastIndex=0,s,i,l,c=-1,u=[],d=[];for(e=e+"",t=t+"";(s=Rm.exec(e))&&(i=Lm.exec(t));)(l=i.index)>n&&(l=t.slice(n,l),u[c]?u[c]+=l:u[++c]=l),(s=s[0])===(i=i[0])?u[c]?u[c]+=i:u[++c]=i:(u[++c]=null,d.push({i:c,x:ga(s,i)})),n=Lm.lastIndex;return n<t.length&&(l=t.slice(n),u[c]?u[c]+=l:u[++c]=l),u.length<2?d[0]?zC(d[0].x):LC(t):(t=d.length,function(f){for(var h=0,p;h<t;++h)u[(p=d[h]).i]=p.x(f);return u.join("")})}var Zg=180/Math.PI,zm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function e_(e,t,n,s,i,l){var c,u,d;return(c=Math.sqrt(e*e+t*t))&&(e/=c,t/=c),(d=e*n+t*s)&&(n-=e*d,s-=t*d),(u=Math.sqrt(n*n+s*s))&&(n/=u,s/=u,d/=u),e*s<t*n&&(e=-e,t=-t,d=-d,c=-c),{translateX:i,translateY:l,rotate:Math.atan2(t,e)*Zg,skewX:Math.atan(d)*Zg,scaleX:c,scaleY:u}}var Xc;function FC(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?zm:e_(t.a,t.b,t.c,t.d,t.e,t.f)}function IC(e){return e==null||(Xc||(Xc=document.createElementNS("http://www.w3.org/2000/svg","g")),Xc.setAttribute("transform",e),!(e=Xc.transform.baseVal.consolidate()))?zm:(e=e.matrix,e_(e.a,e.b,e.c,e.d,e.e,e.f))}function t_(e,t,n,s){function i(f){return f.length?f.pop()+" ":""}function l(f,h,p,g,_,N){if(f!==p||h!==g){var v=_.push("translate(",null,t,null,n);N.push({i:v-4,x:ga(f,p)},{i:v-2,x:ga(h,g)})}else(p||g)&&_.push("translate("+p+t+g+n)}function c(f,h,p,g){f!==h?(f-h>180?h+=360:h-f>180&&(f+=360),g.push({i:p.push(i(p)+"rotate(",null,s)-2,x:ga(f,h)})):h&&p.push(i(p)+"rotate("+h+s)}function u(f,h,p,g){f!==h?g.push({i:p.push(i(p)+"skewX(",null,s)-2,x:ga(f,h)}):h&&p.push(i(p)+"skewX("+h+s)}function d(f,h,p,g,_,N){if(f!==p||h!==g){var v=_.push(i(_)+"scale(",null,",",null,")");N.push({i:v-4,x:ga(f,p)},{i:v-2,x:ga(h,g)})}else(p!==1||g!==1)&&_.push(i(_)+"scale("+p+","+g+")")}return function(f,h){var p=[],g=[];return f=e(f),h=e(h),l(f.translateX,f.translateY,h.translateX,h.translateY,p,g),c(f.rotate,h.rotate,p,g),u(f.skewX,h.skewX,p,g),d(f.scaleX,f.scaleY,h.scaleX,h.scaleY,p,g),f=h=null,function(_){for(var N=-1,v=g.length,x;++N<v;)p[(x=g[N]).i]=x.x(_);return p.join("")}}}var BC=t_(FC,"px, ","px)","deg)"),UC=t_(IC,", ",")",")"),qC=1e-12;function n_(e){return((e=Math.exp(e))+1/e)/2}function HC(e){return((e=Math.exp(e))-1/e)/2}function VC(e){return((e=Math.exp(2*e))-1)/(e+1)}const WC=function e(t,n,s){function i(l,c){var u=l[0],d=l[1],f=l[2],h=c[0],p=c[1],g=c[2],_=h-u,N=p-d,v=_*_+N*N,x,j;if(v<qC)j=Math.log(g/f)/t,x=function(A){return[u+A*_,d+A*N,f*Math.exp(t*A*j)]};else{var k=Math.sqrt(v),S=(g*g-f*f+s*v)/(2*f*n*k),C=(g*g-f*f-s*v)/(2*g*n*k),w=Math.log(Math.sqrt(S*S+1)-S),E=Math.log(Math.sqrt(C*C+1)-C);j=(E-w)/t,x=function(A){var R=A*j,P=n_(w),T=f/(n*k)*(P*VC(t*R+w)-HC(w));return[u+T*_,d+T*N,f*P/n_(t*R+w)]}}return x.duration=j*1e3*t/Math.SQRT2,x}return i.rho=function(l){var c=Math.max(.001,+l),u=c*c,d=u*u;return e(c,u,d)},i}(Math.SQRT2,2,4);var hi=0,yl=0,bl=0,s_=1e3,Jc,xl,Zc=0,go=0,eu=0,wl=typeof performance=="object"&&performance.now?performance:Date,r_=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Dm(){return go||(r_(KC),go=wl.now()+eu)}function KC(){go=0}function tu(){this._call=this._time=this._next=null}tu.prototype=a_.prototype={constructor:tu,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Dm():+n)+(t==null?0:+t),!this._next&&xl!==this&&(xl?xl._next=this:Jc=this,xl=this),this._call=e,this._time=n,Fm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Fm())}};function a_(e,t,n){var s=new tu;return s.restart(e,t,n),s}function YC(){Dm(),++hi;for(var e=Jc,t;e;)(t=go-e._time)>=0&&e._call.call(void 0,t),e=e._next;--hi}function o_(){go=(Zc=wl.now())+eu,hi=yl=0;try{YC()}finally{hi=0,QC(),go=0}}function GC(){var e=wl.now(),t=e-Zc;t>s_&&(eu-=t,Zc=e)}function QC(){for(var e,t=Jc,n,s=1/0;t;)t._call?(s>t._time&&(s=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Jc=n);xl=e,Fm(s)}function Fm(e){if(!hi){yl&&(yl=clearTimeout(yl));var t=e-go;t>24?(e<1/0&&(yl=setTimeout(o_,e-wl.now()-eu)),bl&&(bl=clearInterval(bl))):(bl||(Zc=wl.now(),bl=setInterval(GC,s_)),hi=1,r_(o_))}}function i_(e,t,n){var s=new tu;return t=t==null?0:+t,s.restart(i=>{s.stop(),e(i+t)},t,n),s}var XC=Uc("start","end","cancel","interrupt"),JC=[],l_=0,c_=1,Im=2,nu=3,u_=4,Bm=5,su=6;function ru(e,t,n,s,i,l){var c=e.__transition;if(!c)e.__transition={};else if(n in c)return;ZC(e,n,{name:t,index:s,group:i,on:XC,tween:JC,time:l.time,delay:l.delay,duration:l.duration,ease:l.ease,timer:null,state:l_})}function Um(e,t){var n=cr(e,t);if(n.state>l_)throw new Error("too late; already scheduled");return n}function xr(e,t){var n=cr(e,t);if(n.state>nu)throw new Error("too late; already running");return n}function cr(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function ZC(e,t,n){var s=e.__transition,i;s[t]=n,n.timer=a_(l,0,n.time);function l(f){n.state=c_,n.timer.restart(c,n.delay,n.time),n.delay<=f&&c(f-n.delay)}function c(f){var h,p,g,_;if(n.state!==c_)return d();for(h in s)if(_=s[h],_.name===n.name){if(_.state===nu)return i_(c);_.state===u_?(_.state=su,_.timer.stop(),_.on.call("interrupt",e,e.__data__,_.index,_.group),delete s[h]):+h<t&&(_.state=su,_.timer.stop(),_.on.call("cancel",e,e.__data__,_.index,_.group),delete s[h])}if(i_(function(){n.state===nu&&(n.state=u_,n.timer.restart(u,n.delay,n.time),u(f))}),n.state=Im,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Im){for(n.state=nu,i=new Array(g=n.tween.length),h=0,p=-1;h<g;++h)(_=n.tween[h].value.call(e,e.__data__,n.index,n.group))&&(i[++p]=_);i.length=p+1}}function u(f){for(var h=f<n.duration?n.ease.call(null,f/n.duration):(n.timer.restart(d),n.state=Bm,1),p=-1,g=i.length;++p<g;)i[p].call(e,h);n.state===Bm&&(n.on.call("end",e,e.__data__,n.index,n.group),d())}function d(){n.state=su,n.timer.stop(),delete s[t];for(var f in s)return;delete e.__transition}}function au(e,t){var n=e.__transition,s,i,l=!0,c;if(n){t=t==null?null:t+"";for(c in n){if((s=n[c]).name!==t){l=!1;continue}i=s.state>Im&&s.state<Bm,s.state=su,s.timer.stop(),s.on.call(i?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete n[c]}l&&delete e.__transition}}function eS(e){return this.each(function(){au(this,e)})}function tS(e,t){var n,s;return function(){var i=xr(this,e),l=i.tween;if(l!==n){s=n=l;for(var c=0,u=s.length;c<u;++c)if(s[c].name===t){s=s.slice(),s.splice(c,1);break}}i.tween=s}}function nS(e,t,n){var s,i;if(typeof n!="function")throw new Error;return function(){var l=xr(this,e),c=l.tween;if(c!==s){i=(s=c).slice();for(var u={name:t,value:n},d=0,f=i.length;d<f;++d)if(i[d].name===t){i[d]=u;break}d===f&&i.push(u)}l.tween=i}}function sS(e,t){var n=this._id;if(e+="",arguments.length<2){for(var s=cr(this.node(),n).tween,i=0,l=s.length,c;i<l;++i)if((c=s[i]).name===e)return c.value;return null}return this.each((t==null?tS:nS)(n,e,t))}function qm(e,t,n){var s=e._id;return e.each(function(){var i=xr(this,s);(i.value||(i.value={}))[t]=n.apply(this,arguments)}),function(i){return cr(i,s).value[t]}}function d_(e,t){var n;return(typeof t=="number"?ga:t instanceof vl?Jg:(n=vl(t))?(t=n,Jg):DC)(e,t)}function rS(e){return function(){this.removeAttribute(e)}}function aS(e){return function(){this.removeAttributeNS(e.space,e.local)}}function oS(e,t,n){var s,i=n+"",l;return function(){var c=this.getAttribute(e);return c===i?null:c===s?l:l=t(s=c,n)}}function iS(e,t,n){var s,i=n+"",l;return function(){var c=this.getAttributeNS(e.space,e.local);return c===i?null:c===s?l:l=t(s=c,n)}}function lS(e,t,n){var s,i,l;return function(){var c,u=n(this),d;return u==null?void this.removeAttribute(e):(c=this.getAttribute(e),d=u+"",c===d?null:c===s&&d===i?l:(i=d,l=t(s=c,u)))}}function cS(e,t,n){var s,i,l;return function(){var c,u=n(this),d;return u==null?void this.removeAttributeNS(e.space,e.local):(c=this.getAttributeNS(e.space,e.local),d=u+"",c===d?null:c===s&&d===i?l:(i=d,l=t(s=c,u)))}}function uS(e,t){var n=Hc(e),s=n==="transform"?UC:d_;return this.attrTween(e,typeof t=="function"?(n.local?cS:lS)(n,s,qm(this,"attr."+e,t)):t==null?(n.local?aS:rS)(n):(n.local?iS:oS)(n,s,t))}function dS(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function mS(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function hS(e,t){var n,s;function i(){var l=t.apply(this,arguments);return l!==s&&(n=(s=l)&&mS(e,l)),n}return i._value=t,i}function fS(e,t){var n,s;function i(){var l=t.apply(this,arguments);return l!==s&&(n=(s=l)&&dS(e,l)),n}return i._value=t,i}function pS(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var s=Hc(e);return this.tween(n,(s.local?hS:fS)(s,t))}function gS(e,t){return function(){Um(this,e).delay=+t.apply(this,arguments)}}function _S(e,t){return t=+t,function(){Um(this,e).delay=t}}function vS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?gS:_S)(t,e)):cr(this.node(),t).delay}function yS(e,t){return function(){xr(this,e).duration=+t.apply(this,arguments)}}function bS(e,t){return t=+t,function(){xr(this,e).duration=t}}function xS(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?yS:bS)(t,e)):cr(this.node(),t).duration}function wS(e,t){if(typeof t!="function")throw new Error;return function(){xr(this,e).ease=t}}function NS(e){var t=this._id;return arguments.length?this.each(wS(t,e)):cr(this.node(),t).ease}function jS(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;xr(this,e).ease=n}}function CS(e){if(typeof e!="function")throw new Error;return this.each(jS(this._id,e))}function SS(e){typeof e!="function"&&(e=kg(e));for(var t=this._groups,n=t.length,s=new Array(n),i=0;i<n;++i)for(var l=t[i],c=l.length,u=s[i]=[],d,f=0;f<c;++f)(d=l[f])&&e.call(d,d.__data__,f,l)&&u.push(d);return new Fr(s,this._parents,this._name,this._id)}function ES(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,s=t.length,i=n.length,l=Math.min(s,i),c=new Array(s),u=0;u<l;++u)for(var d=t[u],f=n[u],h=d.length,p=c[u]=new Array(h),g,_=0;_<h;++_)(g=d[_]||f[_])&&(p[_]=g);for(;u<s;++u)c[u]=t[u];return new Fr(c,this._parents,this._name,this._id)}function kS(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function MS(e,t,n){var s,i,l=kS(t)?Um:xr;return function(){var c=l(this,e),u=c.on;u!==s&&(i=(s=u).copy()).on(t,n),c.on=i}}function AS(e,t){var n=this._id;return arguments.length<2?cr(this.node(),n).on.on(e):this.each(MS(n,e,t))}function OS(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function TS(){return this.on("end.remove",OS(this._id))}function $S(e){var t=this._name,n=this._id;typeof e!="function"&&(e=km(e));for(var s=this._groups,i=s.length,l=new Array(i),c=0;c<i;++c)for(var u=s[c],d=u.length,f=l[c]=new Array(d),h,p,g=0;g<d;++g)(h=u[g])&&(p=e.call(h,h.__data__,g,u))&&("__data__"in h&&(p.__data__=h.__data__),f[g]=p,ru(f[g],t,n,g,f,cr(h,n)));return new Fr(l,this._parents,t,n)}function PS(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Eg(e));for(var s=this._groups,i=s.length,l=[],c=[],u=0;u<i;++u)for(var d=s[u],f=d.length,h,p=0;p<f;++p)if(h=d[p]){for(var g=e.call(h,h.__data__,p,d),_,N=cr(h,n),v=0,x=g.length;v<x;++v)(_=g[v])&&ru(_,t,n,v,g,N);l.push(g),c.push(h)}return new Fr(l,c,t,n)}var RS=hl.prototype.constructor;function LS(){return new RS(this._groups,this._parents)}function zS(e,t){var n,s,i;return function(){var l=ui(this,e),c=(this.style.removeProperty(e),ui(this,e));return l===c?null:l===n&&c===s?i:i=t(n=l,s=c)}}function m_(e){return function(){this.style.removeProperty(e)}}function DS(e,t,n){var s,i=n+"",l;return function(){var c=ui(this,e);return c===i?null:c===s?l:l=t(s=c,n)}}function FS(e,t,n){var s,i,l;return function(){var c=ui(this,e),u=n(this),d=u+"";return u==null&&(d=u=(this.style.removeProperty(e),ui(this,e))),c===d?null:c===s&&d===i?l:(i=d,l=t(s=c,u))}}function IS(e,t){var n,s,i,l="style."+t,c="end."+l,u;return function(){var d=xr(this,e),f=d.on,h=d.value[l]==null?u||(u=m_(t)):void 0;(f!==n||i!==h)&&(s=(n=f).copy()).on(c,i=h),d.on=s}}function BS(e,t,n){var s=(e+="")=="transform"?BC:d_;return t==null?this.styleTween(e,zS(e,s)).on("end.style."+e,m_(e)):typeof t=="function"?this.styleTween(e,FS(e,s,qm(this,"style."+e,t))).each(IS(this._id,e)):this.styleTween(e,DS(e,s,t),n).on("end.style."+e,null)}function US(e,t,n){return function(s){this.style.setProperty(e,t.call(this,s),n)}}function qS(e,t,n){var s,i;function l(){var c=t.apply(this,arguments);return c!==i&&(s=(i=c)&&US(e,c,n)),s}return l._value=t,l}function HS(e,t,n){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(t==null)return this.tween(s,null);if(typeof t!="function")throw new Error;return this.tween(s,qS(e,t,n??""))}function VS(e){return function(){this.textContent=e}}function WS(e){return function(){var t=e(this);this.textContent=t??""}}function KS(e){return this.tween("text",typeof e=="function"?WS(qm(this,"text",e)):VS(e==null?"":e+""))}function YS(e){return function(t){this.textContent=e.call(this,t)}}function GS(e){var t,n;function s(){var i=e.apply(this,arguments);return i!==n&&(t=(n=i)&&YS(i)),t}return s._value=e,s}function QS(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,GS(e))}function XS(){for(var e=this._name,t=this._id,n=h_(),s=this._groups,i=s.length,l=0;l<i;++l)for(var c=s[l],u=c.length,d,f=0;f<u;++f)if(d=c[f]){var h=cr(d,t);ru(d,e,n,f,c,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new Fr(s,this._parents,e,n)}function JS(){var e,t,n=this,s=n._id,i=n.size();return new Promise(function(l,c){var u={value:c},d={value:function(){--i===0&&l()}};n.each(function(){var f=xr(this,s),h=f.on;h!==e&&(t=(e=h).copy(),t._.cancel.push(u),t._.interrupt.push(u),t._.end.push(d)),f.on=t}),i===0&&l()})}var ZS=0;function Fr(e,t,n,s){this._groups=e,this._parents=t,this._name=n,this._id=s}function h_(){return++ZS}var Ir=hl.prototype;Fr.prototype={constructor:Fr,select:$S,selectAll:PS,selectChild:Ir.selectChild,selectChildren:Ir.selectChildren,filter:SS,merge:ES,selection:LS,transition:XS,call:Ir.call,nodes:Ir.nodes,node:Ir.node,size:Ir.size,empty:Ir.empty,each:Ir.each,on:AS,attr:uS,attrTween:pS,style:BS,styleTween:HS,text:KS,textTween:QS,remove:TS,tween:sS,delay:vS,duration:xS,ease:NS,easeVarying:CS,end:JS,[Symbol.iterator]:Ir[Symbol.iterator]};function eE(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var tE={time:null,delay:0,duration:250,ease:eE};function nE(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function sE(e){var t,n;e instanceof Fr?(t=e._id,e=e._name):(t=h_(),(n=tE).time=Dm(),e=e==null?null:e+"");for(var s=this._groups,i=s.length,l=0;l<i;++l)for(var c=s[l],u=c.length,d,f=0;f<u;++f)(d=c[f])&&ru(d,e,t,f,c,n||nE(d,t));return new Fr(s,this._parents,e,t)}hl.prototype.interrupt=eS,hl.prototype.transition=sE;const ou=e=>()=>e;function rE(e,{sourceEvent:t,target:n,transform:s,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function Br(e,t,n){this.k=e,this.x=t,this.y=n}Br.prototype={constructor:Br,scale:function(e){return e===1?this:new Br(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Br(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var _o=new Br(1,0,0);Br.prototype;function Hm(e){e.stopImmediatePropagation()}function Nl(e){e.preventDefault(),e.stopImmediatePropagation()}function aE(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function oE(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function f_(){return this.__zoom||_o}function iE(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function lE(){return navigator.maxTouchPoints||"ontouchstart"in this}function cE(e,t,n){var s=e.invertX(t[0][0])-n[0][0],i=e.invertX(t[1][0])-n[1][0],l=e.invertY(t[0][1])-n[0][1],c=e.invertY(t[1][1])-n[1][1];return e.translate(i>s?(s+i)/2:Math.min(0,s)||Math.max(0,i),c>l?(l+c)/2:Math.min(0,l)||Math.max(0,c))}function uE(){var e=aE,t=oE,n=cE,s=iE,i=lE,l=[0,1/0],c=[[-1/0,-1/0],[1/0,1/0]],u=250,d=WC,f=Uc("start","zoom","end"),h,p,g,_=500,N=150,v=0,x=10;function j(L){L.property("__zoom",f_).on("wheel.zoom",R,{passive:!1}).on("mousedown.zoom",P).on("dblclick.zoom",T).filter(i).on("touchstart.zoom",O).on("touchmove.zoom",F).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}j.transform=function(L,D,q,Y){var W=L.selection?L.selection():L;W.property("__zoom",f_),L!==W?w(L,D,q,Y):W.interrupt().each(function(){E(this,arguments).event(Y).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},j.scaleBy=function(L,D,q,Y){j.scaleTo(L,function(){var W=this.__zoom.k,X=typeof D=="function"?D.apply(this,arguments):D;return W*X},q,Y)},j.scaleTo=function(L,D,q,Y){j.transform(L,function(){var W=t.apply(this,arguments),X=this.__zoom,I=q==null?C(W):typeof q=="function"?q.apply(this,arguments):q,z=X.invert(I),H=typeof D=="function"?D.apply(this,arguments):D;return n(S(k(X,H),I,z),W,c)},q,Y)},j.translateBy=function(L,D,q,Y){j.transform(L,function(){return n(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof q=="function"?q.apply(this,arguments):q),t.apply(this,arguments),c)},null,Y)},j.translateTo=function(L,D,q,Y,W){j.transform(L,function(){var X=t.apply(this,arguments),I=this.__zoom,z=Y==null?C(X):typeof Y=="function"?Y.apply(this,arguments):Y;return n(_o.translate(z[0],z[1]).scale(I.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof q=="function"?-q.apply(this,arguments):-q),X,c)},Y,W)};function k(L,D){return D=Math.max(l[0],Math.min(l[1],D)),D===L.k?L:new Br(D,L.x,L.y)}function S(L,D,q){var Y=D[0]-q[0]*L.k,W=D[1]-q[1]*L.k;return Y===L.x&&W===L.y?L:new Br(L.k,Y,W)}function C(L){return[(+L[0][0]+ +L[1][0])/2,(+L[0][1]+ +L[1][1])/2]}function w(L,D,q,Y){L.on("start.zoom",function(){E(this,arguments).event(Y).start()}).on("interrupt.zoom end.zoom",function(){E(this,arguments).event(Y).end()}).tween("zoom",function(){var W=this,X=arguments,I=E(W,X).event(Y),z=t.apply(W,X),H=q==null?C(z):typeof q=="function"?q.apply(W,X):q,te=Math.max(z[1][0]-z[0][0],z[1][1]-z[0][1]),K=W.__zoom,V=typeof D=="function"?D.apply(W,X):D,G=d(K.invert(H).concat(te/K.k),V.invert(H).concat(te/V.k));return function(Q){if(Q===1)Q=V;else{var ne=G(Q),J=te/ne[2];Q=new Br(J,H[0]-ne[0]*J,H[1]-ne[1]*J)}I.zoom(null,Q)}})}function E(L,D,q){return!q&&L.__zooming||new A(L,D)}function A(L,D){this.that=L,this.args=D,this.active=0,this.sourceEvent=null,this.extent=t.apply(L,D),this.taps=0}A.prototype={event:function(L){return L&&(this.sourceEvent=L),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(L,D){return this.mouse&&L!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&L!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&L!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(L){var D=ir(this.that).datum();f.call(L,this.that,new rE(L,{sourceEvent:this.sourceEvent,target:j,transform:this.that.__zoom,dispatch:f}),D)}};function R(L,...D){if(!e.apply(this,arguments))return;var q=E(this,D).event(L),Y=this.__zoom,W=Math.max(l[0],Math.min(l[1],Y.k*Math.pow(2,s.apply(this,arguments)))),X=yr(L);if(q.wheel)(q.mouse[0][0]!==X[0]||q.mouse[0][1]!==X[1])&&(q.mouse[1]=Y.invert(q.mouse[0]=X)),clearTimeout(q.wheel);else{if(Y.k===W)return;q.mouse=[X,Y.invert(X)],au(this),q.start()}Nl(L),q.wheel=setTimeout(I,N),q.zoom("mouse",n(S(k(Y,W),q.mouse[0],q.mouse[1]),q.extent,c));function I(){q.wheel=null,q.end()}}function P(L,...D){if(g||!e.apply(this,arguments))return;var q=L.currentTarget,Y=E(this,D,!0).event(L),W=ir(L.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",te,!0),X=yr(L,q),I=L.clientX,z=L.clientY;Dg(L.view),Hm(L),Y.mouse=[X,this.__zoom.invert(X)],au(this),Y.start();function H(K){if(Nl(K),!Y.moved){var V=K.clientX-I,G=K.clientY-z;Y.moved=V*V+G*G>v}Y.event(K).zoom("mouse",n(S(Y.that.__zoom,Y.mouse[0]=yr(K,q),Y.mouse[1]),Y.extent,c))}function te(K){W.on("mousemove.zoom mouseup.zoom",null),Fg(K.view,Y.moved),Nl(K),Y.event(K).end()}}function T(L,...D){if(e.apply(this,arguments)){var q=this.__zoom,Y=yr(L.changedTouches?L.changedTouches[0]:L,this),W=q.invert(Y),X=q.k*(L.shiftKey?.5:2),I=n(S(k(q,X),Y,W),t.apply(this,D),c);Nl(L),u>0?ir(this).transition().duration(u).call(w,I,Y,L):ir(this).call(j.transform,I,Y,L)}}function O(L,...D){if(e.apply(this,arguments)){var q=L.touches,Y=q.length,W=E(this,D,L.changedTouches.length===Y).event(L),X,I,z,H;for(Hm(L),I=0;I<Y;++I)z=q[I],H=yr(z,this),H=[H,this.__zoom.invert(H),z.identifier],W.touch0?!W.touch1&&W.touch0[2]!==H[2]&&(W.touch1=H,W.taps=0):(W.touch0=H,X=!0,W.taps=1+!!h);h&&(h=clearTimeout(h)),X&&(W.taps<2&&(p=H[0],h=setTimeout(function(){h=null},_)),au(this),W.start())}}function F(L,...D){if(this.__zooming){var q=E(this,D).event(L),Y=L.changedTouches,W=Y.length,X,I,z,H;for(Nl(L),X=0;X<W;++X)I=Y[X],z=yr(I,this),q.touch0&&q.touch0[2]===I.identifier?q.touch0[0]=z:q.touch1&&q.touch1[2]===I.identifier&&(q.touch1[0]=z);if(I=q.that.__zoom,q.touch1){var te=q.touch0[0],K=q.touch0[1],V=q.touch1[0],G=q.touch1[1],Q=(Q=V[0]-te[0])*Q+(Q=V[1]-te[1])*Q,ne=(ne=G[0]-K[0])*ne+(ne=G[1]-K[1])*ne;I=k(I,Math.sqrt(Q/ne)),z=[(te[0]+V[0])/2,(te[1]+V[1])/2],H=[(K[0]+G[0])/2,(K[1]+G[1])/2]}else if(q.touch0)z=q.touch0[0],H=q.touch0[1];else return;q.zoom("touch",n(S(I,z,H),q.extent,c))}}function B(L,...D){if(this.__zooming){var q=E(this,D).event(L),Y=L.changedTouches,W=Y.length,X,I;for(Hm(L),g&&clearTimeout(g),g=setTimeout(function(){g=null},_),X=0;X<W;++X)I=Y[X],q.touch0&&q.touch0[2]===I.identifier?delete q.touch0:q.touch1&&q.touch1[2]===I.identifier&&delete q.touch1;if(q.touch1&&!q.touch0&&(q.touch0=q.touch1,delete q.touch1),q.touch0)q.touch0[1]=this.__zoom.invert(q.touch0[0]);else if(q.end(),q.taps===2&&(I=yr(I,this),Math.hypot(p[0]-I[0],p[1]-I[1])<x)){var z=ir(this).on("dblclick.zoom");z&&z.apply(this,arguments)}}}return j.wheelDelta=function(L){return arguments.length?(s=typeof L=="function"?L:ou(+L),j):s},j.filter=function(L){return arguments.length?(e=typeof L=="function"?L:ou(!!L),j):e},j.touchable=function(L){return arguments.length?(i=typeof L=="function"?L:ou(!!L),j):i},j.extent=function(L){return arguments.length?(t=typeof L=="function"?L:ou([[+L[0][0],+L[0][1]],[+L[1][0],+L[1][1]]]),j):t},j.scaleExtent=function(L){return arguments.length?(l[0]=+L[0],l[1]=+L[1],j):[l[0],l[1]]},j.translateExtent=function(L){return arguments.length?(c[0][0]=+L[0][0],c[1][0]=+L[1][0],c[0][1]=+L[0][1],c[1][1]=+L[1][1],j):[[c[0][0],c[0][1]],[c[1][0],c[1][1]]]},j.constrain=function(L){return arguments.length?(n=L,j):n},j.duration=function(L){return arguments.length?(u=+L,j):u},j.interpolate=function(L){return arguments.length?(d=L,j):d},j.on=function(){var L=f.on.apply(f,arguments);return L===f?j:L},j.clickDistance=function(L){return arguments.length?(v=(L=+L)*L,j):Math.sqrt(v)},j.tapDistance=function(L){return arguments.length?(x=+L,j):x},j}function Nt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Vm(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function p_(e,t){if(e){if(typeof e=="string")return Vm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vm(e,t)}}function dE(e){if(Array.isArray(e))return e}function mE(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s=[],i=!0,l=!1,c,u;try{for(n=n.call(e);!(i=(c=n.next()).done)&&(s.push(c.value),!(t&&s.length===t));i=!0);}catch(d){l=!0,u=d}finally{try{!i&&n.return!=null&&n.return()}finally{if(l)throw u}}return s}}function hE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function yt(e,t){return dE(e)||mE(e,t)||p_(e,t)||hE()}var vo;(function(e){e.Strict="strict",e.Loose="loose"})(vo||(vo={}));var fi;(function(e){e.Lines="lines",e.Dots="dots"})(fi||(fi={}));var pi;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(pi||(pi={}));var _a;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(_a||(_a={}));var iu;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(iu||(iu={}));var Ae;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Ae||(Ae={}));var Wm=function(t){return{width:t.offsetWidth,height:t.offsetHeight}},gi=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;return Math.min(Math.max(t,n),s)},g_=function(t,n){return{x:gi(t.x,n[0][0],n[1][0]),y:gi(t.y,n[0][1],n[1][1])}},__=function(t){var n,s;return((n=t.getRootNode)===null||n===void 0?void 0:n.call(t))||((s=window)===null||s===void 0?void 0:s.document)},fE=function(t,n){return{x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x2,n.x2),y2:Math.max(t.y2,n.y2)}},lu=function(t){var n=t.x,s=t.y,i=t.width,l=t.height;return{x:n,y:s,x2:n+i,y2:s+l}},pE=function(t){var n=t.x,s=t.y,i=t.x2,l=t.y2;return{x:n,y:s,width:i-n,height:l-s}},v_=function(t){return!isNaN(t)&&isFinite(t)},Vn=Symbol("internals");function y_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function jl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?y_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function b_(e,t){var n=e.find(function(f){return f.id===t.parentNode});if(n){var s=t.position.x+t.width-n.width,i=t.position.y+t.height-n.height;if(s>0||i>0||t.position.x<0||t.position.y<0){var l,c;if(n.style=jl({},n.style)||{},n.style.width=(l=n.style.width)!==null&&l!==void 0?l:n.width,n.style.height=(c=n.style.height)!==null&&c!==void 0?c:n.height,s>0&&(n.style.width+=s),i>0&&(n.style.height+=i),t.position.x<0){var u=Math.abs(t.position.x);n.position.x=n.position.x-u,n.style.width+=u,t.position.x=0}if(t.position.y<0){var d=Math.abs(t.position.y);n.position.y=n.position.y-d,n.style.height+=d,t.position.y=0}n.width=n.style.width,n.height=n.style.height}}}function x_(e,t){if(e.some(function(s){return s.type==="reset"}))return e.filter(function(s){return s.type==="reset"}).map(function(s){return s.item});var n=e.filter(function(s){return s.type==="add"}).map(function(s){return s.item});return t.reduce(function(s,i){var l=e.find(function(d){return d.id===i.id});if(l)switch(l.type){case"select":return s.push(jl(jl({},i),{},{selected:l.selected})),s;case"position":{var c=jl({},i);return typeof l.position<"u"&&(c.position=l.position),typeof l.positionAbsolute<"u"&&(c.positionAbsolute=l.positionAbsolute),typeof l.dragging<"u"&&(c.dragging=l.dragging),c.expandParent&&b_(s,c),s.push(c),s}case"dimensions":{var u=jl({},i);return typeof l.dimensions<"u"&&(u.width=l.dimensions.width,u.height=l.dimensions.height),u.expandParent&&b_(s,u),s.push(u),s}case"remove":return s}return s.push(i),s},n)}function w_(e,t){return x_(e,t)}function gE(e,t){return x_(e,t)}var va=function(t,n){return{id:t,type:"select",selected:n}};function _i(e,t){return e.reduce(function(n,s){var i=t.includes(s.id);return!s.selected&&i?(s.selected=!0,n.push(va(s.id,!0))):s.selected&&!i&&(s.selected=!1,n.push(va(s.id,!1))),n},[])}function N_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function j_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?N_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):N_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var C_=function(t,n,s){var i=n.querySelectorAll(t);if(!i||!i.length)return null;var l=Array.from(i),c=n.getBoundingClientRect();return l.map(function(u){var d=u.getBoundingClientRect();return j_({id:u.getAttribute("data-handleid"),position:u.getAttribute("data-handlepos"),x:(d.left-c.left)/s,y:(d.top-c.top)/s},Wm(u))})};function Cl(e,t,n){return n===void 0?n:function(s){var i=t().nodeInternals.get(e);n(s,j_({},i))}}function S_(e){var t=e.id,n=e.store,s=n.getState(),i=s.addSelectedNodes,l=s.unselectNodesAndEdges,c=s.multiSelectionActive,u=s.nodeInternals,d=u.get(t);n.setState({nodesSelectionActive:!1}),d.selected?d.selected&&c&&l({nodes:[d]}):i([t])}function E_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Sl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?E_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var _E=function(t){return"id"in t&&"source"in t&&"target"in t},vE=function(t){var n=t.source,s=t.sourceHandle,i=t.target,l=t.targetHandle;return"reactflow__edge-".concat(n).concat(s||"","-").concat(i).concat(l||"")},Km=function(t,n){if(typeof t>"u")return"";if(typeof t=="string")return t;var s=n?"".concat(n,"__"):"";return"".concat(s).concat(Object.keys(t).sort().map(function(i){return"".concat(i,"=").concat(t[i])}).join("&"))},yE=function(t,n){return n.some(function(s){return s.source===t.source&&s.target===t.target&&(s.sourceHandle===t.sourceHandle||!s.sourceHandle&&!t.sourceHandle)&&(s.targetHandle===t.targetHandle||!s.targetHandle&&!t.targetHandle)})},k_=function(t,n){if(!t.source||!t.target)return n;var s;return _E(t)?s=Sl({},t):s=Sl(Sl({},t),{},{id:vE(t)}),yE(s,n)?n:n.concat(s)},M_=function(t,n,s,i){var l=t.x,c=t.y,u=yt(n,3),d=u[0],f=u[1],h=u[2],p=yt(i,2),g=p[0],_=p[1],N={x:(l-d)/h,y:(c-f)/h};return s?{x:g*Math.round(N.x/g),y:_*Math.round(N.y/_)}:N},Ym=function(t){if(t.length===0)return{x:0,y:0,width:0,height:0};var n=t.reduce(function(s,i){var l=i.positionAbsolute,c=i.position,u=i.width,d=i.height;return fE(s,lu({x:l?l.x:c.x,y:l?l.y:c.y,width:u||0,height:d||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return pE(n)},A_=function(t,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[0,0,1],i=yt(s,3),l=i[0],c=i[1],u=i[2],d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1,h=lu({x:(n.x-l)/u,y:(n.y-c)/u,width:n.width/u,height:n.height/u}),p=[];return t.forEach(function(g){var _=g.positionAbsolute,N=g.width,v=g.height,x=g.selectable,j=x===void 0?!0:x;if(f&&!j)return!1;var k=lu(Sl(Sl({},_),{},{width:N||0,height:v||0})),S=Math.max(0,Math.min(h.x2,k.x2)-Math.max(h.x,k.x)),C=Math.max(0,Math.min(h.y2,k.y2)-Math.max(h.y,k.y)),w=Math.ceil(S*C),E=typeof N>"u"||typeof v>"u"||N===null||v===null,A=d&&w>0,R=(N||0)*(v||0),P=E||A||w>=R;P&&p.push(g)}),p},O_=function(t,n){var s=t.map(function(i){return i.id});return n.filter(function(i){return s.includes(i.source)||s.includes(i.target)})},T_=function(t,n,s,i,l){var c=arguments.length>5&&arguments[5]!==void 0?arguments[5]:.1,u=n/(t.width*(1+c)),d=s/(t.height*(1+c)),f=Math.min(u,d),h=gi(f,i,l),p=t.x+t.width/2,g=t.y+t.height/2,_=n/2-p*h,N=s/2-g*h;return[_,N,h]},yo=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.transition().duration(n)};function $_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function vi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function P_(e,t,n,s){var i,l,c,u,d,f,h,p,g,_,N,v;if(!e.parentNode)return s;var x=t.get(e.parentNode);return P_(x,t,n,{x:((i=s.x)!==null&&i!==void 0?i:0)+((l=(c=x.position)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0),y:((u=s.y)!==null&&u!==void 0?u:0)+((d=(f=x.position)===null||f===void 0?void 0:f.y)!==null&&d!==void 0?d:0),z:((h=(p=x[Vn])===null||p===void 0?void 0:p.z)!==null&&h!==void 0?h:0)>((g=s.z)!==null&&g!==void 0?g:0)?(_=(N=x[Vn])===null||N===void 0?void 0:N.z)!==null&&_!==void 0?_:0:(v=s.z)!==null&&v!==void 0?v:0})}function Gm(e,t){var n=new Map,s={};return e.forEach(function(i){var l,c=v_(i.zIndex)?i.zIndex:i.selected?1e3:0,u=t.get(i.id),d=vi(vi({width:u==null?void 0:u.width,height:u==null?void 0:u.height},i),{},{positionAbsolute:{x:i.position.x,y:i.position.y}});i.parentNode&&(d.parentNode=i.parentNode,s[i.parentNode]=!0),Object.defineProperty(d,Vn,{enumerable:!1,value:{handleBounds:u==null||(l=u[Vn])===null||l===void 0?void 0:l.handleBounds,z:c}}),n.set(i.id,d)}),n.forEach(function(i){if(i.parentNode&&!n.has(i.parentNode))throw new Error("Parent node ".concat(i.parentNode," not found"));if(i.parentNode||s[i.id]){var l,c,u=P_(i,n,s,vi(vi({},i.position),{},{z:(l=(c=i[Vn])===null||c===void 0?void 0:c.z)!==null&&l!==void 0?l:0})),d=u.x,f=u.y,h=u.z;i.positionAbsolute={x:d,y:f},i[Vn].z=h,s[i.id]&&(i[Vn].isParent=!0)}}),n}function R_(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=e(),s=n.nodeInternals,i=n.width,l=n.height,c=n.minZoom,u=n.maxZoom,d=n.d3Zoom,f=n.d3Selection,h=n.fitViewOnInitDone,p=n.fitViewOnInit;if((t.initial&&!h&&p||!t.initial)&&d&&f){var g=Array.from(s.values()).filter(function(R){return t.includeHiddenNodes?R.width&&R.height:!R.hidden}),_=g.every(function(R){return R.width&&R.height});if(g.length>0&&_){var N,v,x,j=Ym(g),k=T_(j,i,l,(N=t.minZoom)!==null&&N!==void 0?N:c,(v=t.maxZoom)!==null&&v!==void 0?v:u,(x=t.padding)!==null&&x!==void 0?x:.1),S=yt(k,3),C=S[0],w=S[1],E=S[2],A=_o.translate(C,w).scale(E);return typeof t.duration=="number"&&t.duration>0?d.transform(yo(f,t.duration),A):d.transform(f,A),!0}}return!1}function bE(e,t){return e.forEach(function(n){var s=t.get(n.id);if(s){var i;t.set(s.id,vi(vi({},s),{},(i={},Nt(i,Vn,s[Vn]),Nt(i,"selected",n.selected),i)))}}),new Map(t)}function xE(e,t){return t.map(function(n){var s=e.find(function(i){return i.id===n.id});return s&&(n.selected=s.selected),n})}function cu(e){var t=e.changedNodes,n=e.changedEdges,s=e.get,i=e.set,l=s(),c=l.nodeInternals,u=l.edges,d=l.onNodesChange,f=l.onEdgesChange,h=l.hasDefaultNodes,p=l.hasDefaultEdges;t!=null&&t.length&&(h&&i({nodeInternals:bE(t,c)}),d==null||d(t)),n!=null&&n.length&&(p&&i({edges:xE(n,u)}),f==null||f(n))}var Qm=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],L_={width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Qm,nodeExtent:Qm,nodesSelectionActive:!1,userSelectionActive:!1,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionMode:vo.Strict,domNode:null,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,elementsSelectable:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,reactFlowVersion:"10.3.17",connectionStartHandle:null,connectOnClick:!0};function z_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function wr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?z_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Xm=TN(),D_=Xm.Provider,yn=Xm.useStore,es=Xm.useStoreApi,F_=function(){return ON(function(t,n){return wr(wr({},L_),{},{setNodes:function(i){t({nodeInternals:Gm(i,n().nodeInternals)})},setEdges:function(i){var l=n(),c=l.defaultEdgeOptions,u=c===void 0?{}:c;t({edges:i.map(function(d){return wr(wr({},u),d)})})},setDefaultNodesAndEdges:function(i,l){var c=typeof i<"u",u=typeof l<"u",d=c?Gm(i,new Map):new Map,f=u?l:[];t({nodeInternals:d,edges:f,hasDefaultNodes:c,hasDefaultEdges:u})},updateNodeDimensions:function(i){var l=n(),c=l.onNodesChange,u=l.nodeInternals,d=l.fitViewOnInit,f=l.fitViewOnInitDone,h=l.fitViewOnInitOptions,p=l.domNode,g=p==null?void 0:p.querySelector(".react-flow__viewport");if(g){var _=window.getComputedStyle(g),N=new window.DOMMatrixReadOnly(_.transform),v=N.m22,x=i.reduce(function(k,S){var C=u.get(S.id);if(C){var w=Wm(S.nodeElement),E=!!(w.width&&w.height&&(C.width!==w.width||C.height!==w.height||S.forceUpdate));E&&(u.set(C.id,wr(wr({},C),{},Nt({},Vn,wr(wr({},C[Vn]),{},{handleBounds:{source:C_(".source",S.nodeElement,v),target:C_(".target",S.nodeElement,v)}})),w)),k.push({id:C.id,type:"dimensions",dimensions:w}))}return k},[]),j=f||d&&!f&&R_(n,wr({initial:!0},h));t({nodeInternals:new Map(u),fitViewOnInitDone:j}),(x==null?void 0:x.length)>0&&(c==null||c(x))}},updateNodePositions:function(i){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=n(),d=u.onNodesChange,f=u.nodeInternals,h=u.hasDefaultNodes;if(h||d){var p=i.map(function(N){var v={id:N.id,type:"position",dragging:c};return l&&(v.positionAbsolute=N.positionAbsolute,v.position=N.position),v});if(p!=null&&p.length){if(h){var g=w_(p,Array.from(f.values())),_=Gm(g,f);t({nodeInternals:_})}d==null||d(p)}}},addSelectedNodes:function(i){var l=n(),c=l.multiSelectionActive,u=l.nodeInternals,d=l.edges,f,h=null;c?f=i.map(function(p){return va(p,!0)}):(f=_i(Array.from(u.values()),i),h=_i(d,[])),cu({changedNodes:f,changedEdges:h,get:n,set:t})},addSelectedEdges:function(i){var l=n(),c=l.multiSelectionActive,u=l.edges,d=l.nodeInternals,f,h=null;c?f=i.map(function(p){return va(p,!0)}):(f=_i(u,i),h=_i(Array.from(d.values()),[])),cu({changedNodes:h,changedEdges:f,get:n,set:t})},unselectNodesAndEdges:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},l=i.nodes,c=i.edges,u=n(),d=u.nodeInternals,f=u.edges,h=l||Array.from(d.values()),p=c||f,g=h.map(function(N){return N.selected=!1,va(N.id,!1)}),_=p.map(function(N){return va(N.id,!1)});cu({changedNodes:g,changedEdges:_,get:n,set:t})},setMinZoom:function(i){var l=n(),c=l.d3Zoom,u=l.maxZoom;c==null||c.scaleExtent([i,u]),t({minZoom:i})},setMaxZoom:function(i){var l=n(),c=l.d3Zoom,u=l.minZoom;c==null||c.scaleExtent([u,i]),t({maxZoom:i})},setTranslateExtent:function(i){var l=n(),c=l.d3Zoom;c==null||c.translateExtent(i),t({translateExtent:i})},resetSelectedElements:function(){var i=n(),l=i.nodeInternals,c=i.edges,u=Array.from(l.values()),d=u.filter(function(h){return h.selected}).map(function(h){return va(h.id,!1)}),f=c.filter(function(h){return h.selected}).map(function(h){return va(h.id,!1)});cu({changedNodes:d,changedEdges:f,get:n,set:t})},setNodeExtent:function(i){var l=n(),c=l.nodeInternals;c.forEach(function(u){u.positionAbsolute=g_(u.position,i)}),t({nodeExtent:i,nodeInternals:new Map(c)})},reset:function(){return t(wr({},L_))}})})};function Rs(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,s;n<e.length;n++)(s=Rs(e[n]))!==""&&(t+=(t&&" ")+s);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function Ls(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let s=0;s<n.length;s++)if(!Object.prototype.hasOwnProperty.call(t,n[s])||!Object.is(e[n[s]],t[n[s]]))return!1;return!0}function wE(e){if(Array.isArray(e))return Vm(e)}function NE(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function jE(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bo(e){return wE(e)||NE(e)||p_(e)||jE()}var CE={zoomIn:function(){},zoomOut:function(){},zoomTo:function(t){},getZoom:function(){return 1},setViewport:function(t){},getViewport:function(){return{x:0,y:0,zoom:1}},fitView:function(){},setCenter:function(t,n){},fitBounds:function(t){},project:function(t){return t},viewportInitialized:!1},SE=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}},EE=function(){var t=es(),n=yn(SE,Ls),s=n.d3Zoom,i=n.d3Selection,l=y.useMemo(function(){return i&&s?{zoomIn:function(u){return s.scaleBy(yo(i,u==null?void 0:u.duration),1.2)},zoomOut:function(u){return s.scaleBy(yo(i,u==null?void 0:u.duration),1/1.2)},zoomTo:function(u,d){return s.scaleTo(yo(i,d==null?void 0:d.duration),u)},getZoom:function(){return t.getState().transform[2]},setViewport:function(u,d){var f,h,p,g=yt(t.getState().transform,3),_=g[0],N=g[1],v=g[2],x=_o.translate((f=u.x)!==null&&f!==void 0?f:_,(h=u.y)!==null&&h!==void 0?h:N).scale((p=u.zoom)!==null&&p!==void 0?p:v);s.transform(yo(i,d==null?void 0:d.duration),x)},getViewport:function(){var u=yt(t.getState().transform,3),d=u[0],f=u[1],h=u[2];return{x:d,y:f,zoom:h}},fitView:function(u){return R_(t.getState,u)},setCenter:function(u,d,f){var h=t.getState(),p=h.width,g=h.height,_=h.maxZoom,N=typeof(f==null?void 0:f.zoom)<"u"?f.zoom:_,v=p/2-u*N,x=g/2-d*N,j=_o.translate(v,x).scale(N);s.transform(yo(i,f==null?void 0:f.duration),j)},fitBounds:function(u,d){var f,h=t.getState(),p=h.width,g=h.height,_=h.minZoom,N=h.maxZoom,v=T_(u,p,g,_,N,(f=d==null?void 0:d.padding)!==null&&f!==void 0?f:.1),x=yt(v,3),j=x[0],k=x[1],S=x[2],C=_o.translate(j,k).scale(S);s.transform(yo(i,d==null?void 0:d.duration),C)},project:function(u){var d=t.getState(),f=d.transform,h=d.snapToGrid,p=d.snapGrid;return M_(u,f,h,p)},viewportInitialized:!0}:CE},[s,i]);return l};function I_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function yi(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?I_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Jm(){var e=EE(),t=es(),n=y.useCallback(function(){var p=t.getState(),g=p.nodeInternals,_=Array.from(g.values());return _.map(function(N){return yi({},N)})},[]),s=y.useCallback(function(p){var g=t.getState(),_=g.nodeInternals;return _.get(p)},[]),i=y.useCallback(function(){var p=t.getState(),g=p.edges,_=g===void 0?[]:g;return _.map(function(N){return yi({},N)})},[]),l=y.useCallback(function(p){var g=t.getState(),_=g.edges,N=_===void 0?[]:_;return N.find(function(v){return v.id===p})},[]),c=y.useCallback(function(p){var g=t.getState(),_=g.nodeInternals,N=g.setNodes,v=g.hasDefaultNodes,x=g.onNodesChange,j=Array.from(_.values()),k=typeof p=="function"?p(j):p;if(v)N(k);else if(x){var S=k.length===0?j.map(function(C){return{type:"remove",id:C.id}}):k.map(function(C){return{item:C,type:"reset"}});x(S)}},[]),u=y.useCallback(function(p){var g=t.getState(),_=g.edges,N=_===void 0?[]:_,v=g.setEdges,x=g.hasDefaultEdges,j=g.onEdgesChange,k=typeof p=="function"?p(N):p;if(x)v(k);else if(j){var S=k.length===0?N.map(function(C){return{type:"remove",id:C.id}}):k.map(function(C){return{item:C,type:"reset"}});j(S)}},[]),d=y.useCallback(function(p){var g=Array.isArray(p)?p:[p],_=t.getState(),N=_.nodeInternals,v=_.setNodes,x=_.hasDefaultNodes,j=_.onNodesChange;if(x){var k=Array.from(N.values()),S=[].concat(k,bo(g));v(S)}else if(j){var C=g.map(function(w){return{item:w,type:"add"}});j(C)}},[]),f=y.useCallback(function(p){var g=Array.isArray(p)?p:[p],_=t.getState(),N=_.edges,v=N===void 0?[]:N,x=_.setEdges,j=_.hasDefaultEdges,k=_.onEdgesChange;if(j)x([].concat(bo(v),bo(g)));else if(k){var S=g.map(function(C){return{item:C,type:"add"}});k(S)}},[]),h=y.useCallback(function(){var p=t.getState(),g=p.nodeInternals,_=p.edges,N=_===void 0?[]:_,v=p.transform,x=Array.from(g.values()),j=yt(v,3),k=j[0],S=j[1],C=j[2];return{nodes:x.map(function(w){return yi({},w)}),edges:N.map(function(w){return yi({},w)}),viewport:{x:k,y:S,zoom:C}}},[]);return y.useMemo(function(){return yi(yi({},e),{},{getNodes:n,getNode:s,getEdges:i,getEdge:l,setNodes:c,setEdges:u,addNodes:d,addEdges:f,toObject:h})},[e,n,s,i,l,c,u,d,f,h])}function kE(e,t){if(e==null)return{};var n={},s=Object.keys(e),i,l;for(l=0;l<s.length;l++)i=s[l],!(t.indexOf(i)>=0)&&(n[i]=e[i]);return n}function uu(e,t){if(e==null)return{};var n=kE(e,t),s,i;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(i=0;i<l.length;i++)s=l[i],!(t.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(e,s)&&(n[s]=e[s])}return n}function ME(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},ge.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function AE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},ge.createElement("path",{d:"M0 0h32v4.2H0z"}))}function OE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},ge.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function TE(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ge.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function $E(){return ge.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},ge.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}var PE=["children","className"];function B_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function RE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var du=function(t){var n=t.children,s=t.className,i=uu(t,PE);return ge.createElement("button",RE({type:"button",className:Rs(["react-flow__controls-button",s])},i),n)},LE=function(t){return t.nodesDraggable&&t.nodesConnectable&&t.elementsSelectable},U_=function(t){var n=t.style,s=t.showZoom,i=s===void 0?!0:s,l=t.showFitView,c=l===void 0?!0:l,u=t.showInteractive,d=u===void 0?!0:u,f=t.fitViewOptions,h=t.onZoomIn,p=t.onZoomOut,g=t.onFitView,_=t.onInteractiveChange,N=t.className,v=t.children,x=es(),j=y.useState(!1),k=yt(j,2),S=k[0],C=k[1],w=yn(LE),E=Jm(),A=E.zoomIn,R=E.zoomOut,P=E.fitView;if(y.useEffect(function(){C(!0)},[]),!S)return null;var T=function(){A==null||A(),h==null||h()},O=function(){R==null||R(),p==null||p()},F=function(){P==null||P(f),g==null||g()},B=function(){x.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),_==null||_(!w)};return ge.createElement("div",{className:Rs(["react-flow__controls",N]),style:n},i&&ge.createElement(ge.Fragment,null,ge.createElement(du,{onClick:T,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in"},ge.createElement(ME,null)),ge.createElement(du,{onClick:O,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out"},ge.createElement(AE,null))),c&&ge.createElement(du,{className:"react-flow__controls-fitview",onClick:F,title:"fit view","aria-label":"fit view"},ge.createElement(OE,null)),d&&ge.createElement(du,{className:"react-flow__controls-interactive",onClick:B,title:"toggle interactivity","aria-label":"toggle interactivity"},w?ge.createElement($E,null):ge.createElement(TE,null)),v)};U_.displayName="Controls";var zE=y.memo(U_),DE=function(t,n,s){return ge.createElement("path",{stroke:s,strokeWidth:n,d:"M".concat(t/2," 0 V").concat(t," M0 ").concat(t/2," H").concat(t)})},FE=function(t,n){return ge.createElement("circle",{cx:t,cy:t,r:t,fill:n})},mu;function q_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function H_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?q_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var IE=(mu={},Nt(mu,fi.Dots,"#81818a"),Nt(mu,fi.Lines,"#eee"),mu),BE=function(t){return t.transform},V_=function(t){var n=t.variant,s=n===void 0?fi.Dots:n,i=t.gap,l=i===void 0?15:i,c=t.size,u=c===void 0?.4:c,d=t.color,f=t.style,h=t.className,p=y.useRef(null),g=y.useState(null),_=yt(g,2),N=_[0],v=_[1],x=yn(BE),j=yt(x,3),k=j[0],S=j[1],C=j[2];y.useEffect(function(){var O=document.querySelectorAll(".react-flow__background"),F=Array.from(O).findIndex(function(B){return B===p.current});v("pattern-".concat(F))},[]);var w=l*C||1,E=k%w,A=S%w,R=s===fi.Lines,P=d||IE[s],T=R?DE(w,u,P):FE(u*C,P);return ge.createElement("svg",{className:Rs(["react-flow__background","react-flow__container",h]),style:H_(H_({},f),{},{width:"100%",height:"100%"}),ref:p},N&&ge.createElement(ge.Fragment,null,ge.createElement("pattern",{id:N,x:E,y:A,width:w,height:w,patternUnits:"userSpaceOnUse"},T),ge.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:"url(#".concat(N,")")})))};V_.displayName="Background";var UE=y.memo(V_),qE=function(t){return t.updateNodeDimensions};function HE(){var e=es(),t=yn(qE);return y.useCallback(function(n){var s,i=(s=e.getState().domNode)===null||s===void 0?void 0:s.querySelector('.react-flow__node[data-id="'.concat(n,'"]'));i&&requestAnimationFrame(function(){return t([{id:n,nodeElement:i,forceUpdate:!0}])})},[])}var VE=["paid-pro","paid-sponsor","paid-enterprise","paid-custom"];function WE(e){var t=e.proOptions,n=e.position,s=n===void 0?"bottom-right":n;if(t!=null&&t.account&&VE.includes(t==null?void 0:t.account)&&t!==null&&t!==void 0&&t.hideAttribution)return null;var i="".concat(s).split("-");return ge.createElement("div",{className:Rs(["react-flow__attribution"].concat(bo(i))),"data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev/pricing"},ge.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer"},"React Flow"))}var KE=["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"];function W_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function YE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?W_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):W_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var GE=function(t){var n=t.x,s=t.y,i=t.label,l=t.labelStyle,c=l===void 0?{}:l,u=t.labelShowBg,d=u===void 0?!0:u,f=t.labelBgStyle,h=f===void 0?{}:f,p=t.labelBgPadding,g=p===void 0?[2,4]:p,_=t.labelBgBorderRadius,N=_===void 0?2:_,v=t.children,x=t.className,j=uu(t,KE),k=y.useRef(null),S=y.useState({x:0,y:0,width:0,height:0}),C=yt(S,2),w=C[0],E=C[1],A=Rs(["react-flow__edge-textwrapper",x]);return y.useEffect(function(){if(k.current){var R=k.current.getBBox();E({x:R.x,y:R.y,width:R.width,height:R.height})}},[i]),typeof i>"u"||!i?null:ge.createElement("g",YE({transform:"translate(".concat(n-w.width/2," ").concat(s-w.height/2,")"),className:A},j),d&&ge.createElement("rect",{width:w.width+2*g[0],x:-g[0],y:-g[1],height:w.height+2*g[1],className:"react-flow__edge-textbg",style:h,rx:N,ry:N}),ge.createElement("text",{className:"react-flow__edge-text",y:w.height/2,dy:"0.3em",ref:k,style:c},i),v)},QE=y.memo(GE),hu=function(e){var t=e.path,n=e.centerX,s=e.centerY,i=e.label,l=e.labelStyle,c=e.labelShowBg,u=e.labelBgStyle,d=e.labelBgPadding,f=e.labelBgBorderRadius,h=e.style,p=e.markerEnd,g=e.markerStart,_=i?ge.createElement(QE,{x:n,y:s,label:i,labelStyle:l,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f}):null;return ge.createElement(ge.Fragment,null,ge.createElement("path",{style:h,d:t,className:"react-flow__edge-path",markerEnd:p,markerStart:g}),_)};function fu(e){var t=e.pos,n=e.x1,s=e.y1,i=e.x2,l=e.y2,c,u;switch(t){case Ae.Left:case Ae.Right:c=.5*(n+i),u=s;break;case Ae.Top:case Ae.Bottom:c=n,u=.5*(s+l);break}return[c,u]}function K_(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Ae.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,f=fu({pos:i,x1:t,y1:n,x2:l,y2:c}),h=yt(f,2),p=h[0],g=h[1],_=fu({pos:d,x1:l,y1:c,x2:t,y2:n}),N=yt(_,2),v=N[0],x=N[1];return"M".concat(t,",").concat(n," C").concat(p,",").concat(g," ").concat(v,",").concat(x," ").concat(l,",").concat(c)}function XE(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Ae.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,f=fu({pos:i,x1:t,y1:n,x2:l,y2:c}),h=yt(f,2),p=h[0],g=h[1],_=fu({pos:d,x1:l,y1:c,x2:t,y2:n}),N=yt(_,2),v=N[0],x=N[1],j=t*.125+p*.375+v*.375+l*.125,k=n*.125+g*.375+x*.375+c*.125,S=Math.abs(j-t),C=Math.abs(k-n);return[j,k,S,C]}var Y_=y.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.sourcePosition,c=l===void 0?Ae.Bottom:l,u=e.targetPosition,d=u===void 0?Ae.Top:u,f=e.label,h=e.labelStyle,p=e.labelShowBg,g=e.labelBgStyle,_=e.labelBgPadding,N=e.labelBgBorderRadius,v=e.style,x=e.markerEnd,j=e.markerStart,k={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:i,targetPosition:d},S=K_(k),C=XE(k),w=yt(C,2),E=w[0],A=w[1];return ge.createElement(hu,{path:S,centerX:E,centerY:A,label:f,labelStyle:h,labelShowBg:p,labelBgStyle:g,labelBgPadding:_,labelBgBorderRadius:N,style:v,markerEnd:x,markerStart:j})});function G_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function JE(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?G_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Q_=[Ae.Left,Ae.Right],X_=function(t){var n=t.sourceX,s=t.sourceY,i=t.targetX,l=t.targetY,c=t.sourcePosition,u=c===void 0?Ae.Bottom:c,d=t.targetPosition,f=d===void 0?Ae.Top:d,h=Q_.includes(u),p=Q_.includes(f),g=h&&!p||p&&!h;if(g){var _=h?Math.abs(i-n):0,N=n>i?n-_:n+_,v=h?0:Math.abs(l-s),x=s<l?s+v:s-v;return[N,x,_,v]}var j=Math.abs(i-n)/2,k=i<n?i+j:i-j,S=Math.abs(l-s)/2,C=l<s?l+S:l-S;return[k,C,j,S]};function El(e,t,n){return n===void 0?n:function(s){var i=t().edges.find(function(l){return l.id===e});n(s,JE({},i))}}var Zm=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},eh=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},th=function(t,n,s){return"L ".concat(t,",").concat(n-s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},nh=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n-s)},sh=function(t,n,s){return"L ".concat(t+s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)},rh=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t+s,",").concat(n)},ah=function(t,n,s){return"L ".concat(t,",").concat(n+s,"Q ").concat(t,",").concat(n," ").concat(t-s,",").concat(n)},oh=function(t,n,s){return"L ".concat(t-s,",").concat(n,"Q ").concat(t,",").concat(n," ").concat(t,",").concat(n+s)};function ih(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Ae.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,f=e.borderRadius,h=f===void 0?5:f,p=e.centerX,g=e.centerY,_=X_({sourceX:t,sourceY:n,targetX:l,targetY:c}),N=yt(_,4),v=N[0],x=N[1],j=N[2],k=N[3],S=Math.min(h,Math.abs(l-t)),C=Math.min(h,Math.abs(c-n)),w=Math.min(S,C,j,k),E=[Ae.Left,Ae.Right],A=typeof p<"u"?p:v,R=typeof g<"u"?g:x,P=null,T=null;return t<=l?(P=n<=c?Zm(t,R,w):rh(t,R,w),T=n<=c?oh(l,R,w):nh(l,R,w)):(P=n<c?th(t,R,w):ah(t,R,w),T=n<c?sh(l,R,w):eh(l,R,w)),E.includes(i)&&E.includes(d)?t<=l?(P=n<=c?oh(A,n,w):nh(A,n,w),T=n<=c?Zm(A,c,w):rh(A,c,w)):(i===Ae.Right&&d===Ae.Left||i===Ae.Left&&d===Ae.Right||i===Ae.Left&&d===Ae.Left)&&(P=n<=c?sh(A,n,w):eh(A,n,w),T=n<=c?th(A,c,w):ah(A,c,w)):E.includes(i)&&!E.includes(d)?(t<=l?P=n<=c?oh(l,n,w):nh(l,n,w):P=n<=c?sh(l,n,w):eh(l,n,w),T=""):!E.includes(i)&&E.includes(d)&&(t<=l?P=n<=c?Zm(t,c,w):rh(t,c,w):P=n<=c?th(t,c,w):ah(t,c,w),T=""),"M ".concat(t,",").concat(n).concat(P).concat(T,"L ").concat(l,",").concat(c)}var lh=y.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,f=e.labelBgPadding,h=e.labelBgBorderRadius,p=e.style,g=e.sourcePosition,_=g===void 0?Ae.Bottom:g,N=e.targetPosition,v=N===void 0?Ae.Top:N,x=e.markerEnd,j=e.markerStart,k=e.borderRadius,S=k===void 0?5:k,C=X_({sourceX:t,sourceY:n,targetX:s,targetY:i,sourcePosition:_,targetPosition:v}),w=yt(C,2),E=w[0],A=w[1],R=ih({sourceX:t,sourceY:n,sourcePosition:_,targetX:s,targetY:i,targetPosition:v,borderRadius:S});return ge.createElement(hu,{path:R,centerX:E,centerY:A,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:x,markerStart:j})});function J_(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Z_(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?J_(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J_(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var ev=y.memo(function(e){return ge.createElement(lh,Z_(Z_({},e),{},{borderRadius:0}))}),tv=y.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.label,c=e.labelStyle,u=e.labelShowBg,d=e.labelBgStyle,f=e.labelBgPadding,h=e.labelBgBorderRadius,p=e.style,g=e.markerEnd,_=e.markerStart,N=Math.abs(i-n)/2,v=i<n?i+N:i-N,x=Math.abs(s-t)/2,j=s<t?s+x:s-x,k="M ".concat(t,",").concat(n,"L ").concat(s,",").concat(i);return ge.createElement(hu,{path:k,centerX:j,centerY:v,label:l,labelStyle:c,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:g,markerStart:_})});function pu(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function gu(e){var t=e.pos,n=e.x1,s=e.y1,i=e.x2,l=e.y2,c=e.c,u,d;switch(t){case Ae.Left:u=n-pu(n-i,c),d=s;break;case Ae.Right:u=n+pu(i-n,c),d=s;break;case Ae.Top:u=n,d=s-pu(s-l,c);break;case Ae.Bottom:u=n,d=s+pu(l-s,c);break}return[u,d]}function nv(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Ae.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,f=e.curvature,h=f===void 0?.25:f,p=gu({pos:i,x1:t,y1:n,x2:l,y2:c,c:h}),g=yt(p,2),_=g[0],N=g[1],v=gu({pos:d,x1:l,y1:c,x2:t,y2:n,c:h}),x=yt(v,2),j=x[0],k=x[1];return"M".concat(t,",").concat(n," C").concat(_,",").concat(N," ").concat(j,",").concat(k," ").concat(l,",").concat(c)}function ZE(e){var t=e.sourceX,n=e.sourceY,s=e.sourcePosition,i=s===void 0?Ae.Bottom:s,l=e.targetX,c=e.targetY,u=e.targetPosition,d=u===void 0?Ae.Top:u,f=e.curvature,h=f===void 0?.25:f,p=gu({pos:i,x1:t,y1:n,x2:l,y2:c,c:h}),g=yt(p,2),_=g[0],N=g[1],v=gu({pos:d,x1:l,y1:c,x2:t,y2:n,c:h}),x=yt(v,2),j=x[0],k=x[1],S=t*.125+_*.375+j*.375+l*.125,C=n*.125+N*.375+k*.375+c*.125,w=Math.abs(S-t),E=Math.abs(C-n);return[S,C,w,E]}var ch=y.memo(function(e){var t=e.sourceX,n=e.sourceY,s=e.targetX,i=e.targetY,l=e.sourcePosition,c=l===void 0?Ae.Bottom:l,u=e.targetPosition,d=u===void 0?Ae.Top:u,f=e.label,h=e.labelStyle,p=e.labelShowBg,g=e.labelBgStyle,_=e.labelBgPadding,N=e.labelBgBorderRadius,v=e.style,x=e.markerEnd,j=e.markerStart,k=e.curvature,S={sourceX:t,sourceY:n,sourcePosition:c,targetX:s,targetY:i,targetPosition:d,curvature:k},C=nv(S),w=ZE(S),E=yt(w,2),A=E[0],R=E[1];return ge.createElement(hu,{path:C,centerX:A,centerY:R,label:f,labelStyle:h,labelShowBg:p,labelBgStyle:g,labelBgPadding:_,labelBgBorderRadius:N,style:v,markerEnd:x,markerStart:j})}),uh=y.createContext(null),ek=uh.Provider;uh.Consumer;function dh(e,t,n,s,i,l,c){var u=c.elementFromPoint(e.clientX,e.clientY),d=(u==null?void 0:u.classList.contains("target"))||!1,f=(u==null?void 0:u.classList.contains("source"))||!1,h={elementBelow:u,isValid:!1,connection:{source:null,target:null,sourceHandle:null,targetHandle:null},isHoveringHandle:!1};if(u&&(d||f)){h.isHoveringHandle=!0;var p=u.getAttribute("data-nodeid"),g=u.getAttribute("data-handleid"),_=n?{source:p,sourceHandle:g,target:s,targetHandle:i}:{source:s,sourceHandle:i,target:p,targetHandle:g};h.connection=_;var N=t===vo.Strict?n&&f||!n&&d:!0;N&&(h.isValid=l(_))}return h}function mh(e){e==null||e.classList.remove("react-flow__handle-valid"),e==null||e.classList.remove("react-flow__handle-connecting")}function sv(e){var t=e.event,n=e.handleId,s=e.nodeId,i=e.onConnect,l=e.isTarget,c=e.getState,u=e.setState,d=e.isValidConnection,f=e.elementEdgeUpdaterType,h=e.onEdgeUpdateEnd,p=t.target.closest(".react-flow"),g=__(t.target);if(!g)return;var _=g.elementFromPoint(t.clientX,t.clientY),N=_==null?void 0:_.classList.contains("target"),v=_==null?void 0:_.classList.contains("source");if(!p||!N&&!v&&!f)return;var x=c(),j=x.onConnectStart,k=x.connectionMode,S=f||(N?"target":"source"),C=p.getBoundingClientRect(),w;u({connectionPosition:{x:t.clientX-C.left,y:t.clientY-C.top},connectionNodeId:s,connectionHandleId:n,connectionHandleType:S}),j==null||j(t,{nodeId:s,handleId:n,handleType:S});function E(R){u({connectionPosition:{x:R.clientX-C.left,y:R.clientY-C.top}});var P=dh(R,k,l,s,n,d,g),T=P.connection,O=P.elementBelow,F=P.isValid,B=P.isHoveringHandle;if(!B)return mh(w);T.source!==T.target&&O&&(mh(w),w=O,O.classList.add("react-flow__handle-connecting"),O.classList.toggle("react-flow__handle-valid",F))}function A(R){var P=c(),T=P.onConnectStop,O=P.onConnectEnd,F=dh(R,k,l,s,n,d,g),B=F.connection,L=F.isValid;T==null||T(R),L&&(i==null||i(B)),O==null||O(R),f&&h&&h(R),mh(w),u({connectionNodeId:null,connectionHandleId:null,connectionHandleType:null}),g.removeEventListener("mousemove",E),g.removeEventListener("mouseup",A)}g.addEventListener("mousemove",E),g.addEventListener("mouseup",A)}var tk=["type","position","isValidConnection","isConnectable","id","onConnect","children","className","onMouseDown"];function rv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function hh(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var nk=function(){return!0},sk=function(t){return{connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick}},av=y.forwardRef(function(e,t){var n=e.type,s=n===void 0?"source":n,i=e.position,l=i===void 0?Ae.Top:i,c=e.isValidConnection,u=c===void 0?nk:c,d=e.isConnectable,f=d===void 0?!0:d,h=e.id,p=e.onConnect,g=e.children,_=e.className,N=e.onMouseDown,v=uu(e,tk),x=es(),j=y.useContext(uh),k=yn(sk,Ls),S=k.connectionStartHandle,C=k.connectOnClick,w=h||null,E=s==="target",A=function(O){var F=x.getState(),B=F.defaultEdgeOptions,L=F.onConnect,D=F.hasDefaultEdges,q=hh(hh({},B),O);if(D){var Y=x.getState(),W=Y.edges;x.setState({edges:k_(q,W)})}L==null||L(q),p==null||p(q)},R=function(O){O.button===0&&sv({event:O,handleId:w,nodeId:j,onConnect:A,isTarget:E,getState:x.getState,setState:x.setState,isValidConnection:u}),N==null||N(O)},P=function(O){var F=x.getState(),B=F.onClickConnectStart,L=F.onClickConnectStop,D=F.onClickConnectEnd,q=F.connectionMode;if(!S){B==null||B(O,{nodeId:j,handleId:w,handleType:s}),x.setState({connectionStartHandle:{nodeId:j,type:s,handleId:w}});return}var Y=__(O.target),W=dh(O,q,S.type==="target",S.nodeId,S.handleId||null,u,Y),X=W.connection,I=W.isValid;L==null||L(O),I&&A(X),D==null||D(O),x.setState({connectionStartHandle:null})};return ge.createElement("div",hh({"data-handleid":w,"data-nodeid":j,"data-handlepos":l,className:Rs(["react-flow__handle","react-flow__handle-".concat(l),"nodrag",_,{source:!E,target:E,connectable:f,connecting:(S==null?void 0:S.nodeId)===j&&(S==null?void 0:S.handleId)===w&&(S==null?void 0:S.type)===s}]),onMouseDown:R,onClick:C?P:void 0,ref:t},v),g)});av.displayName="Handle";var kl=y.memo(av),ov=function(t){var n=t.data,s=t.isConnectable,i=t.targetPosition,l=i===void 0?Ae.Top:i,c=t.sourcePosition,u=c===void 0?Ae.Bottom:c;return ge.createElement(ge.Fragment,null,ge.createElement(kl,{type:"target",position:l,isConnectable:s}),n==null?void 0:n.label,ge.createElement(kl,{type:"source",position:u,isConnectable:s}))};ov.displayName="DefaultNode";var fh=y.memo(ov),iv=function(t){var n=t.data,s=t.isConnectable,i=t.sourcePosition,l=i===void 0?Ae.Bottom:i;return ge.createElement(ge.Fragment,null,n==null?void 0:n.label,ge.createElement(kl,{type:"source",position:l,isConnectable:s}))};iv.displayName="InputNode";var lv=y.memo(iv),cv=function(t){var n=t.data,s=t.isConnectable,i=t.targetPosition,l=i===void 0?Ae.Top:i;return ge.createElement(ge.Fragment,null,ge.createElement(kl,{type:"target",position:l,isConnectable:s}),n==null?void 0:n.label)};cv.displayName="OutputNode";var uv=y.memo(cv),rk=function(t){return{selectedNodes:Array.from(t.nodeInternals.values()).filter(function(n){return n.selected}),selectedEdges:t.edges.filter(function(n){return n.selected})}},ak=function(t,n){var s=t.selectedNodes.map(function(u){return u.id}),i=n.selectedNodes.map(function(u){return u.id}),l=t.selectedEdges.map(function(u){return u.id}),c=n.selectedEdges.map(function(u){return u.id});return Ls(s,i)&&Ls(l,c)};function ok(e){var t=e.onSelectionChange,n=yn(rk,ak),s=n.selectedNodes,i=n.selectedEdges;return y.useEffect(function(){t({nodes:s,edges:i})},[s,i]),null}var ik=y.memo(ok),lk=function(t){return{setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset}};function ya(e,t){y.useEffect(function(){typeof e<"u"&&t(e)},[e])}function Ut(e,t,n){y.useEffect(function(){typeof t<"u"&&n(Nt({},e,t))},[t])}var ck=function(t){var n=t.nodes,s=t.edges,i=t.defaultNodes,l=t.defaultEdges,c=t.onConnect,u=t.onConnectStart,d=t.onConnectStop,f=t.onConnectEnd,h=t.onClickConnectStart,p=t.onClickConnectStop,g=t.onClickConnectEnd,_=t.nodesDraggable,N=t.nodesConnectable,v=t.minZoom,x=t.maxZoom,j=t.nodeExtent,k=t.onNodesChange,S=t.onEdgesChange,C=t.elementsSelectable,w=t.connectionMode,E=t.snapGrid,A=t.snapToGrid,R=t.translateExtent,P=t.connectOnClick,T=t.defaultEdgeOptions,O=t.fitView,F=t.fitViewOptions,B=t.onNodesDelete,L=t.onEdgesDelete,D=t.onNodeDrag,q=t.onNodeDragStart,Y=t.onNodeDragStop,W=t.onSelectionDrag,X=t.onSelectionDragStart,I=t.onSelectionDragStop,z=yn(lk,Ls),H=z.setNodes,te=z.setEdges,K=z.setDefaultNodesAndEdges,V=z.setMinZoom,G=z.setMaxZoom,Q=z.setTranslateExtent,ne=z.setNodeExtent,J=z.reset,re=es();return y.useEffect(function(){return K(i,l),function(){J()}},[]),Ut("defaultEdgeOptions",T,re.setState),Ut("connectionMode",w,re.setState),Ut("onConnect",c,re.setState),Ut("onConnectStart",u,re.setState),Ut("onConnectStop",d,re.setState),Ut("onConnectEnd",f,re.setState),Ut("onClickConnectStart",h,re.setState),Ut("onClickConnectStop",p,re.setState),Ut("onClickConnectEnd",g,re.setState),Ut("nodesDraggable",_,re.setState),Ut("nodesConnectable",N,re.setState),Ut("elementsSelectable",C,re.setState),Ut("snapToGrid",A,re.setState),Ut("snapGrid",E,re.setState),Ut("onNodesChange",k,re.setState),Ut("onEdgesChange",S,re.setState),Ut("connectOnClick",P,re.setState),Ut("fitViewOnInit",O,re.setState),Ut("fitViewOnInitOptions",F,re.setState),Ut("onNodesDelete",B,re.setState),Ut("onEdgesDelete",L,re.setState),Ut("onNodeDrag",D,re.setState),Ut("onNodeDragStart",q,re.setState),Ut("onNodeDragStop",Y,re.setState),Ut("onSelectionDrag",W,re.setState),Ut("onSelectionDragStart",X,re.setState),Ut("onSelectionDragStop",I,re.setState),ya(n,H),ya(s,te),ya(i,H),ya(l,te),ya(v,V),ya(x,G),ya(R,Q),ya(j,ne),null},uk=".react-flow{height:100%;overflow:hidden;position:relative;width:100%}.react-flow__container{height:100%;left:0;position:absolute;top:0;width:100%}.react-flow__pane{z-index:1}.react-flow__viewport{pointer-events:none;transform-origin:0 0;z-index:2}.react-flow__renderer{z-index:4}.react-flow__selectionpane{z-index:5}.react-flow .react-flow__edges{overflow:visible;pointer-events:none}.react-flow .react-flow__connectionline{z-index:1001}.react-flow__edge{pointer-events:visibleStroke}.react-flow__edge.inactive{pointer-events:none}@-webkit-keyframes dashdraw{0%{stroke-dashoffset:10}}@keyframes dashdraw{0%{stroke-dashoffset:10}}.react-flow__edge-path{fill:none}.react-flow__edge-textwrapper{pointer-events:all}.react-flow__edge-text{pointer-events:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__connection{pointer-events:none}.react-flow__connection .animated{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__connection-path{fill:none}.react-flow__nodes{pointer-events:none;transform-origin:0 0}.react-flow__node{box-sizing:border-box;pointer-events:all;position:absolute;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.react-flow__nodesselection{pointer-events:none;transform-origin:left top;z-index:3}.react-flow__nodesselection-rect{cursor:-webkit-grab;cursor:grab;pointer-events:all;position:absolute}.react-flow__handle{pointer-events:none;position:absolute}.react-flow__handle.connectable{pointer-events:all}.react-flow__handle-bottom{bottom:-4px;left:50%;top:auto;transform:translate(-50%)}.react-flow__handle-top{left:50%;top:-4px;transform:translate(-50%)}.react-flow__handle-left{left:-4px;top:50%;transform:translateY(-50%)}.react-flow__handle-right{right:-4px;top:50%;transform:translateY(-50%)}.react-flow__edgeupdater{cursor:move;pointer-events:all}.react-flow__controls{bottom:20px;left:15px;position:absolute;z-index:5}.react-flow__controls-button{border:none;height:24px;width:24px}.react-flow__controls-button svg{width:100%}.react-flow__minimap{bottom:20px;position:absolute;right:15px;z-index:5}.react-flow__attribution{background:hsla(0,0%,100%,.5);color:#999;font-size:10px;padding:2px 3px;position:absolute;z-index:1000}.react-flow__attribution a{color:#555;text-decoration:none}.react-flow__attribution.top{top:0}.react-flow__attribution.bottom{bottom:0}.react-flow__attribution.left{left:0}.react-flow__attribution.right{right:0}.react-flow__attribution.center{left:50%;transform:translateX(-50%)}",dk=uk,mk=".react-flow__edge.selected .react-flow__edge-path{stroke:#555}.react-flow__edge.animated path{stroke-dasharray:5;-webkit-animation:dashdraw .5s linear infinite;animation:dashdraw .5s linear infinite}.react-flow__edge.updating .react-flow__edge-path{stroke:#777}.react-flow__edge-path{stroke:#b1b1b7;stroke-width:1}.react-flow__edge-text{font-size:10px}.react-flow__edge-textbg{fill:#fff}.react-flow__connection-path{stroke:#b1b1b7;stroke-width:1}.react-flow__node{cursor:-webkit-grab;cursor:grab}.react-flow__node-default,.react-flow__node-group,.react-flow__node-input,.react-flow__node-output{background:#fff;border:1px solid #1a192b;border-radius:3px;color:#222;font-size:12px;padding:10px;text-align:center;width:150px}.react-flow__node-default.selected,.react-flow__node-group.selected,.react-flow__node-input.selected,.react-flow__node-output.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-default .react-flow__handle,.react-flow__node-group .react-flow__handle,.react-flow__node-input .react-flow__handle,.react-flow__node-output .react-flow__handle{background:#1a192b}.react-flow__node-default.selectable:hover,.react-flow__node-group.selectable:hover,.react-flow__node-input.selectable:hover,.react-flow__node-output.selectable:hover{box-shadow:0 1px 4px 1px rgba(0,0,0,.08)}.react-flow__node-default.selectable.selected,.react-flow__node-group.selectable.selected,.react-flow__node-input.selectable.selected,.react-flow__node-output.selectable.selected{box-shadow:0 0 0 .5px #1a192b}.react-flow__node-group{background:hsla(0,0%,94%,.25);border-color:#1a192b}.react-flow__nodesselection-rect,.react-flow__selection{background:rgba(0,89,220,.08);border:1px dotted rgba(0,89,220,.8)}.react-flow__handle{background:#555;border:1px solid #fff;border-radius:100%;height:6px;width:6px}.react-flow__handle.connectable{cursor:crosshair}.react-flow__minimap{background-color:#fff}.react-flow__controls{box-shadow:0 0 2px 1px rgba(0,0,0,.08)}.react-flow__controls-button{align-items:center;background:#fefefe;border-bottom:1px solid #eee;box-sizing:content-box;cursor:pointer;display:flex;height:16px;justify-content:center;padding:5px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;width:16px}.react-flow__controls-button svg{max-height:12px;max-width:12px}.react-flow__controls-button:hover{background:#f4f4f4}",hk=mk,fk=function(t,n,s){return s===Ae.Left?t-n:s===Ae.Right?t+n:t},pk=function(t,n,s){return s===Ae.Top?t-n:s===Ae.Bottom?t+n:t},dv=function(t){var n=t.className,s=t.position,i=t.centerX,l=t.centerY,c=t.radius,u=c===void 0?10:c;return ge.createElement("circle",{className:Rs(["react-flow__edgeupdater",n]),cx:fk(i,u,s),cy:pk(l,u,s),r:u,stroke:"transparent",fill:"transparent"})},bi=function(e){var t=function(s){var i=s.id,l=s.className,c=s.type,u=s.data,d=s.onClick,f=s.onEdgeDoubleClick,h=s.selected,p=s.animated,g=s.label,_=s.labelStyle,N=s.labelShowBg,v=s.labelBgStyle,x=s.labelBgPadding,j=s.labelBgBorderRadius,k=s.style,S=s.source,C=s.target,w=s.sourceX,E=s.sourceY,A=s.targetX,R=s.targetY,P=s.sourcePosition,T=s.targetPosition,O=s.elementsSelectable,F=s.hidden,B=s.sourceHandleId,L=s.targetHandleId,D=s.onContextMenu,q=s.onMouseEnter,Y=s.onMouseMove,W=s.onMouseLeave,X=s.edgeUpdaterRadius,I=s.onEdgeUpdate,z=s.onEdgeUpdateStart,H=s.onEdgeUpdateEnd,te=s.markerEnd,K=s.markerStart,V=s.rfId,G=y.useState(!1),Q=yt(G,2),ne=Q[0],J=Q[1],re=es(),Se=function(st){var dt=re.getState(),jt=dt.edges,zt=dt.addSelectedEdges,Ge=jt.find(function(Ft){return Ft.id===i});O&&(re.setState({nodesSelectionActive:!1}),zt([i])),d==null||d(st,Ge)},Re=El(i,re.getState,f),Oe=El(i,re.getState,D),Fe=El(i,re.getState,q),lt=El(i,re.getState,Y),Be=El(i,re.getState,W),de=function(st,dt){var jt=dt?C:S,zt=(dt?L:B)||null,Ge=dt?"target":"source",Ft=function(){return!0},Kt=dt,Mt=re.getState().edges.find(function(At){return At.id===i});z==null||z(st,Mt,Ge);var tn=H?function(At){return H(At,Mt,Ge)}:void 0,Sn=function(nn){return I==null?void 0:I(Mt,nn)};sv({event:st,handleId:zt,nodeId:jt,onConnect:Sn,isTarget:Kt,getState:re.getState,setState:re.setState,isValidConnection:Ft,elementEdgeUpdaterType:Ge,onEdgeUpdateEnd:tn})},pe=function(st){return de(st,!0)},xe=function(st){return de(st,!1)},ke=function(){return J(!0)},Ue=function(){return J(!1)},ce=y.useMemo(function(){return"url(#".concat(Km(K,V),")")},[K,V]),Me=y.useMemo(function(){return"url(#".concat(Km(te,V),")")},[te,V]);if(F)return null;var Ye=!O&&!d,at=typeof I<"u",Ze=Rs(["react-flow__edge","react-flow__edge-".concat(c),l,{selected:h,animated:p,inactive:Ye,updating:ne}]);return ge.createElement("g",{className:Ze,onClick:Se,onDoubleClick:Re,onContextMenu:Oe,onMouseEnter:Fe,onMouseMove:lt,onMouseLeave:Be},ge.createElement(e,{id:i,source:S,target:C,selected:h,animated:p,label:g,labelStyle:_,labelShowBg:N,labelBgStyle:v,labelBgPadding:x,labelBgBorderRadius:j,data:u,style:k,sourceX:w,sourceY:E,targetX:A,targetY:R,sourcePosition:P,targetPosition:T,sourceHandleId:B,targetHandleId:L,markerStart:ce,markerEnd:Me,"data-testid":"rf__edge-".concat(i)}),at&&ge.createElement("g",{onMouseDown:pe,onMouseEnter:ke,onMouseOut:Ue},ge.createElement(dv,{position:P,centerX:w,centerY:E,radius:X})),at&&ge.createElement("g",{onMouseDown:xe,onMouseEnter:ke,onMouseOut:Ue},ge.createElement(dv,{position:T,centerX:A,centerY:R,radius:X})))};return t.displayName="EdgeWrapper",y.memo(t)};function mv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function hv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function gk(e){var t={default:bi(e.default||ch),straight:bi(e.bezier||tv),step:bi(e.step||ev),smoothstep:bi(e.step||lh),simplebezier:bi(e.simplebezier||Y_)},n={},s=Object.keys(e).filter(function(i){return!["default","bezier"].includes(i)}).reduce(function(i,l){return i[l]=bi(e[l]||ch),i},n);return hv(hv({},t),s)}function fv(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,s=((n==null?void 0:n.x)||0)+t.x,i=((n==null?void 0:n.y)||0)+t.y,l=(n==null?void 0:n.width)||t.width,c=(n==null?void 0:n.height)||t.height;switch(e){case Ae.Top:return{x:s+l/2,y:i};case Ae.Right:return{x:s+l,y:i+c/2};case Ae.Bottom:return{x:s+l/2,y:i+c};case Ae.Left:return{x:s,y:i+c/2}}}function pv(e,t){if(!e)return null;var n=null;return e.length===1||!t?n=e[0]:t&&(n=e.find(function(s){return s.id===t})),typeof n>"u"?null:n}var _k=function(t,n,s,i,l,c){var u=fv(s,t,n),d=fv(c,i,l);return{sourceX:u.x,sourceY:u.y,targetX:d.x,targetY:d.y}};function vk(e){var t=e.sourcePos,n=e.targetPos,s=e.sourceWidth,i=e.sourceHeight,l=e.targetWidth,c=e.targetHeight,u=e.width,d=e.height,f=e.transform,h={x:Math.min(t.x,n.x),y:Math.min(t.y,n.y),x2:Math.max(t.x+s,n.x+l),y2:Math.max(t.y+i,n.y+c)};h.x===h.x2&&(h.x2+=1),h.y===h.y2&&(h.y2+=1);var p=lu({x:(0-f[0])/f[2],y:(0-f[1])/f[2],width:u/f[2],height:d/f[2]}),g=Math.max(0,Math.min(p.x2,h.x2)-Math.max(p.x,h.x)),_=Math.max(0,Math.min(p.y2,h.y2)-Math.max(p.y,h.y)),N=Math.ceil(g*_);return N>0}function gv(e,t){var n,s,i,l,c,u=e.get(t),d=(u==null||(n=u[Vn])===null||n===void 0?void 0:n.handleBounds)||null,f=!u||!d||!u.width||!u.height||typeof((s=u.positionAbsolute)===null||s===void 0?void 0:s.x)>"u"||typeof((i=u.positionAbsolute)===null||i===void 0?void 0:i.y)>"u";return[{x:(u==null||(l=u.positionAbsolute)===null||l===void 0?void 0:l.x)||0,y:(u==null||(c=u.positionAbsolute)===null||c===void 0?void 0:c.y)||0,width:(u==null?void 0:u.width)||0,height:(u==null?void 0:u.height)||0},d,!f]}var yk=typeof document<"u"?document:null,_u=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{target:yk},n=y.useState(!1),s=yt(n,2),i=s[0],l=s[1],c=y.useRef(new Set([])),u=y.useMemo(function(){if(e!==null){var p=Array.isArray(e)?e:[e],g=p.filter(function(N){return typeof N=="string"}).map(function(N){return N.split("+")}),_=g.reduce(function(N,v){return N.concat.apply(N,bo(v))},[]);return[g,_]}return[[],[]]},[e]),d=yt(u,2),f=d[0],h=d[1];return y.useEffect(function(){if(e!==null){var p,g,_=function(j){if(yv(j))return!1;var k=vv(j.code,h);c.current.add(j[k]),_v(f,c.current,!1)&&(j.preventDefault(),l(!0))},N=function(j){if(yv(j))return!1;var k=vv(j.code,h);_v(f,c.current,!0)?(l(!1),c.current.clear()):c.current.delete(j[k])},v=function(){c.current.clear(),l(!1)};return t==null||(p=t.target)===null||p===void 0||p.addEventListener("keydown",_),t==null||(g=t.target)===null||g===void 0||g.addEventListener("keyup",N),window.addEventListener("blur",v),function(){var x,j;t==null||(x=t.target)===null||x===void 0||x.removeEventListener("keydown",_),t==null||(j=t.target)===null||j===void 0||j.removeEventListener("keyup",N),window.removeEventListener("blur",v)}}},[e,l]),i};function _v(e,t,n){return e.filter(function(s){return n||s.length===t.size}).some(function(s){return s.every(function(i){return t.has(i)})})}function vv(e,t){return t.includes(e)?"code":"key"}function yv(e){var t,n=((t=e.composedPath)===null||t===void 0?void 0:t.call(e)[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))}var bk=function(t){return{onNodesChange:t.onNodesChange,onEdgesChange:t.onEdgesChange}},xk=function(e){var t=e.deleteKeyCode,n=e.multiSelectionKeyCode,s=es(),i=yn(bk,Ls),l=i.onNodesChange,c=i.onEdgesChange,u=_u(t),d=_u(n);y.useEffect(function(){var f=s.getState(),h=f.nodeInternals,p=f.edges,g=f.hasDefaultNodes,_=f.hasDefaultEdges,N=f.onNodesDelete,v=f.onEdgesDelete,x=Array.from(h.values()),j=x.reduce(function(R,P){return(!P.selected&&P.parentNode&&R.find(function(T){return T.id===P.parentNode})||P.selected)&&R.push(P),R},[]),k=p.filter(function(R){return R.selected});if(u&&(j||k)){var S=O_(j,p),C=[].concat(bo(k),bo(S)),w=C.reduce(function(R,P){return R.includes(P.id)||R.push(P.id),R},[]);if((_||g)&&(_&&s.setState({edges:p.filter(function(R){return!w.includes(R.id)})}),g&&(j.forEach(function(R){h.delete(R.id)}),s.setState({nodeInternals:new Map(h)}))),w.length>0&&(v==null||v(C),c)){var E=w.map(function(R){return{id:R,type:"remove"}});c(E)}if(j.length>0&&(N==null||N(j),l)){var A=j.map(function(R){return{id:R.id,type:"remove"}});l(A)}s.setState({nodesSelectionActive:!1})}},[u,l,c]),y.useEffect(function(){s.setState({multiSelectionActive:d})},[d])};function wk(e){var t=es();y.useEffect(function(){var n,s=function(){if(e.current){var l=Wm(e.current);t.setState({width:l.width||500,height:l.height||500})}};return s(),window.onresize=s,e.current&&(n=new ResizeObserver(function(){return s()}),n.observe(e.current)),function(){window.onresize=null,n&&e.current&&n.unobserve(e.current)}},[])}var Nk=function(t,n){return t.x!==n.x||t.y!==n.y||t.zoom!==n.k},ph=function(t){return{x:t.x,y:t.y,zoom:t.k}},vu=function(t,n){return t.target.closest(".".concat(n))},jk=function(t){return{d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler}},Ck=function(t){var n=t.onMove,s=t.onMoveStart,i=t.onMoveEnd,l=t.zoomOnScroll,c=l===void 0?!0:l,u=t.zoomOnPinch,d=u===void 0?!0:u,f=t.panOnScroll,h=f===void 0?!1:f,p=t.panOnScrollSpeed,g=p===void 0?.5:p,_=t.panOnScrollMode,N=_===void 0?pi.Free:_,v=t.zoomOnDoubleClick,x=v===void 0?!0:v,j=t.selectionKeyPressed,k=t.elementsSelectable,S=t.panOnDrag,C=S===void 0?!0:S,w=t.translateExtent,E=t.minZoom,A=t.maxZoom,R=t.defaultZoom,P=R===void 0?1:R,T=t.defaultPosition,O=T===void 0?[0,0]:T,F=t.zoomActivationKeyCode,B=t.preventScrolling,L=B===void 0?!0:B,D=t.children,q=t.noWheelClassName,Y=t.noPanClassName,W=es(),X=y.useRef(!1),I=y.useRef(null),z=y.useRef({x:0,y:0,zoom:0}),H=yn(jk,Ls),te=H.d3Zoom,K=H.d3Selection,V=H.d3ZoomHandler,G=_u(F);return wk(I),y.useEffect(function(){if(I.current){var Q,ne=uE().scaleExtent([E,A]).translateExtent(w),J=ir(I.current).call(ne),re=gi(O[0],w[0][0],w[1][0]),Se=gi(O[1],w[0][1],w[1][1]),Re=gi(P,E,A),Oe=_o.translate(re,Se).scale(Re);ne.transform(J,Oe),W.setState({d3Zoom:ne,d3Selection:J,d3ZoomHandler:J.on("wheel.zoom"),transform:[re,Se,Re],domNode:(Q=J.node())===null||Q===void 0?void 0:Q.closest(".react-flow")})}},[]),y.useEffect(function(){K&&te&&(h&&!G?K.on("wheel",function(Q){if(vu(Q,q))return!1;Q.preventDefault(),Q.stopImmediatePropagation();var ne=K.property("__zoom").k||1;if(Q.ctrlKey&&d){var J=yr(Q),re=-Q.deltaY*(Q.deltaMode===1?.05:Q.deltaMode?1:.002)*10,Se=ne*Math.pow(2,re);te.scaleTo(K,Se,J);return}var Re=Q.deltaMode===1?20:1,Oe=N===pi.Vertical?0:Q.deltaX*Re,Fe=N===pi.Horizontal?0:Q.deltaY*Re;te.translateBy(K,-(Oe/ne)*g,-(Fe/ne)*g)}).on("wheel.zoom",null):typeof V<"u"&&K.on("wheel",function(Q){if(!L||vu(Q,q))return null;Q.preventDefault()}).on("wheel.zoom",V))},[h,N,K,te,V,G,d,L,q]),y.useEffect(function(){te&&(j&&!X.current?te.on("zoom",null):j||te.on("zoom",function(Q){if(W.setState({transform:[Q.transform.x,Q.transform.y,Q.transform.k]}),n){var ne=ph(Q.transform);n(Q.sourceEvent,ne)}}))},[j,te,n]),y.useEffect(function(){te&&te.on("start",function(Q){if(X.current=!0,s){var ne=ph(Q.transform);z.current=ne,s(Q.sourceEvent,ne)}})},[te,s]),y.useEffect(function(){te&&te.on("end",function(Q){if(X.current=!1,i&&Nk(z.current,Q.transform)){var ne=ph(Q.transform);z.current=ne,i(Q.sourceEvent,ne)}})},[te,i]),y.useEffect(function(){te&&te.filter(function(Q){var ne=G||c,J=d&&Q.ctrlKey;return!C&&!ne&&!h&&!x&&!d||j||!x&&Q.type==="dblclick"||vu(Q,q)&&Q.type==="wheel"||vu(Q,Y)&&Q.type!=="wheel"||!d&&Q.ctrlKey&&Q.type==="wheel"||!ne&&!h&&!J&&Q.type==="wheel"||!C&&(Q.type==="mousedown"||Q.type==="touchstart")?!1:(!Q.ctrlKey||Q.type==="wheel")&&!Q.button})},[te,c,d,h,x,C,j,k,G]),ge.createElement("div",{className:"react-flow__renderer react-flow__container",ref:I},D)};function bv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function xv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?bv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function wv(e,t){return{x:e.clientX-t.left,y:e.clientY-t.top}}var Sk=function(t){return{userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable}},Nv={startX:0,startY:0,x:0,y:0,width:0,height:0,draw:!1},Ek=y.memo(function(e){var t=e.selectionKeyPressed,n=es(),s=y.useRef(0),i=y.useRef(0),l=y.useRef(),c=y.useState(Nv),u=yt(c,2),d=u[0],f=u[1],h=yn(Sk,Ls),p=h.userSelectionActive,g=h.elementsSelectable,_=p||t;if(!g||!_)return null;var N=function(){f(Nv),n.setState({userSelectionActive:!1}),s.current=0,i.current=0},v=function(C){var w=C.target.closest(".react-flow");l.current=w.getBoundingClientRect();var E=wv(C,l.current);f({width:0,height:0,startX:E.x,startY:E.y,x:E.x,y:E.y,draw:!0}),n.setState({userSelectionActive:!0,nodesSelectionActive:!1})},x=function(C){var w,E;if(!(!t||!d.draw||!l.current)){var A=wv(C,l.current),R=(w=d.startX)!==null&&w!==void 0?w:0,P=(E=d.startY)!==null&&E!==void 0?E:0,T=xv(xv({},d),{},{x:A.x<R?A.x:R,y:A.y<P?A.y:P,width:Math.abs(A.x-R),height:Math.abs(A.y-P)}),O=n.getState(),F=O.nodeInternals,B=O.edges,L=O.transform,D=O.onNodesChange,q=O.onEdgesChange,Y=Array.from(F.values()),W=A_(F,T,L,!1,!0),X=O_(W,B).map(function(te){return te.id}),I=W.map(function(te){return te.id});if(s.current!==I.length){s.current=I.length;var z=_i(Y,I);z.length&&(D==null||D(z))}if(i.current!==X.length){i.current=X.length;var H=_i(B,X);H.length&&(q==null||q(H))}f(T)}},j=function(){n.setState({nodesSelectionActive:s.current>0}),N()},k=function(){n.setState({nodesSelectionActive:!1}),N()};return ge.createElement("div",{className:"react-flow__selectionpane react-flow__container",onMouseDown:v,onMouseMove:x,onMouseUp:j,onMouseLeave:k},d.draw&&ge.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:d.width,height:d.height,transform:"translate(".concat(d.x,"px, ").concat(d.y,"px)")}}))});function jv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Cv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function Sv(e,t){if(!e.parentNode)return!1;var n=t.get(e.parentNode);return n?n.selected?!0:Sv(n,t):!1}function Ev(e,t,n){var s=e;do{var i;if((i=s)!==null&&i!==void 0&&i.matches(t))return!0;if(s===n.current)return!1;s=s.parentElement}while(s);return!1}function kk(e,t,n){return Array.from(e.values()).filter(function(s){return(s.selected||s.id===n)&&(!s.parentNode||!Sv(s,e))}).map(function(s){var i,l,c,u;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:t.x-((i=(l=s.positionAbsolute)===null||l===void 0?void 0:l.x)!==null&&i!==void 0?i:0),y:t.y-((c=(u=s.positionAbsolute)===null||u===void 0?void 0:u.y)!==null&&c!==void 0?c:0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode,width:s.width,height:s.height}})}function Mk(e,t,n,s,i,l){var c=yt(s,2),u=c[0],d=c[1],f=e.extent||l,h={x:t.x-e.distance.x,y:t.y-e.distance.y};if(n&&(h.x=u*Math.round(h.x/u),h.y=d*Math.round(h.y/d)),e.extent==="parent")if(e.parentNode&&e.width&&e.height){var p=i.get(e.parentNode);f=p!=null&&p.positionAbsolute&&p!==null&&p!==void 0&&p.width&&p!==null&&p!==void 0&&p.height?[[p.positionAbsolute.x,p.positionAbsolute.y],[p.positionAbsolute.x+p.width-e.width,p.positionAbsolute.y+p.height-e.height]]:f}else f=l;else if(e.extent&&e.parentNode){var g,_,N,v,x=i.get(e.parentNode),j=(g=x==null||(_=x.positionAbsolute)===null||_===void 0?void 0:_.x)!==null&&g!==void 0?g:0,k=(N=x==null||(v=x.positionAbsolute)===null||v===void 0?void 0:v.y)!==null&&N!==void 0?N:0;f=[[e.extent[0][0]+j,e.extent[0][1]+k],[e.extent[1][0]+j,e.extent[1][1]+k]]}var S={x:0,y:0};if(e.parentNode){var C,w,E,A,R=i.get(e.parentNode);S={x:(C=R==null||(w=R.positionAbsolute)===null||w===void 0?void 0:w.x)!==null&&C!==void 0?C:0,y:(E=R==null||(A=R.positionAbsolute)===null||A===void 0?void 0:A.y)!==null&&E!==void 0?E:0}}return e.positionAbsolute=f?g_(h,f):h,e.position={x:e.positionAbsolute.x-S.x,y:e.positionAbsolute.y-S.y},e}function gh(e){var t=e.nodeId,n=e.dragItems,s=e.nodeInternals,i=n.map(function(l){var c=s.get(l.id);return Cv(Cv({},c),{},{position:l.position,positionAbsolute:l.positionAbsolute})});return[t?i.find(function(l){return l.id===t}):i[0],i]}function _h(e){return function(t,n,s){return e==null?void 0:e(t,s)}}function kv(e){var t=e.nodeRef,n=e.disabled,s=n===void 0?!1:n,i=e.noDragClassName,l=e.handleSelector,c=e.nodeId,u=e.isSelectable,d=e.selectNodesOnDrag,f=y.useState(!1),h=yt(f,2),p=h[0],g=h[1],_=es(),N=y.useRef(),v=y.useRef({x:null,y:null}),x=y.useCallback(function(j){var k=j.sourceEvent,S=_.getState(),C=S.transform,w=S.snapGrid,E=S.snapToGrid,A=k.touches?k.touches[0].clientX:k.clientX,R=k.touches?k.touches[0].clientY:k.clientY,P=M_({x:A,y:R},C,E,w);return P},[]);return y.useEffect(function(){if(t!=null&&t.current){var j=ir(t.current);if(s)j.on(".drag",null);else{var k=bC().on("start",function(S){var C=_.getState(),w=C.nodeInternals,E=C.multiSelectionActive,A=C.unselectNodesAndEdges,R=C.onNodeDragStart,P=C.onSelectionDragStart,T=c?R:_h(P);if(!d&&!E&&c){var O;(O=w.get(c))!==null&&O!==void 0&&O.selected||A()}c&&u&&d&&S_({id:c,store:_});var F=x(S);if(v.current=F,N.current=kk(w,F,c),T&&N.current){var B=gh({nodeId:c,dragItems:N.current,nodeInternals:w}),L=yt(B,2),D=L[0],q=L[1];T(S.sourceEvent,D,q)}}).on("drag",function(S){var C=_.getState(),w=C.updateNodePositions,E=C.snapToGrid,A=C.snapGrid,R=C.nodeInternals,P=C.nodeExtent,T=C.onNodeDrag,O=C.onSelectionDrag,F=x(S);if((v.current.x!==F.x||v.current.y!==F.y)&&N.current){v.current=F,N.current=N.current.map(function(W){return Mk(W,F,E,A,R,P)});var B=c?T:_h(O);if(w(N.current,!0,!0),g(!0),B){var L=gh({nodeId:c,dragItems:N.current,nodeInternals:R}),D=yt(L,2),q=D[0],Y=D[1];B(S.sourceEvent,q,Y)}}S.on("end",function(W){if(g(!1),N.current){var X=_.getState(),I=X.updateNodePositions,z=X.nodeInternals,H=X.onNodeDragStop,te=X.onSelectionDragStop,K=c?H:_h(te);if(I(N.current,!1,!1),K){var V=gh({nodeId:c,dragItems:N.current,nodeInternals:z}),G=yt(V,2),Q=G[0],ne=G[1];K(W.sourceEvent,Q,ne)}}})}).filter(function(S){var C=S.target,w=!S.button&&(!i||!Ev(C,".".concat(i),t))&&(!l||Ev(C,l,t));return w});return j.call(k),function(){j.on(".drag",null)}}}},[t,s,i,l,u,_,c,d,x]),p}function Mv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Ak(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Mv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Ok=function(t){return Ak({transformString:"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")"),userSelectionActive:t.userSelectionActive},Ym(Array.from(t.nodeInternals.values()).filter(function(n){return n.selected})))},Tk=function(t){var n=Array.from(t.nodeInternals.values()).filter(function(s){return s.selected});return Ym(n)};function $k(e){var t=e.onSelectionContextMenu,n=e.noPanClassName,s=es(),i=yn(Ok,Ls),l=i.transformString,c=i.userSelectionActive,u=yn(Tk,Ls),d=u.width,f=u.height,h=u.x,p=u.y,g=y.useRef(null);if(kv({nodeRef:g}),c||!d||!f)return null;var _=t?function(N){var v=Array.from(s.getState().nodeInternals.values()).filter(function(x){return x.selected});t(N,v)}:void 0;return ge.createElement("div",{className:Rs(["react-flow__nodesselection","react-flow__container",n]),style:{transform:l}},ge.createElement("div",{ref:g,className:"react-flow__nodesselection-rect",onContextMenu:_,style:{width:d,height:f,top:p,left:h}}))}var Pk=y.memo($k),Rk=function(t){return t.nodesSelectionActive},Av=function(t){var n=t.children,s=t.onPaneClick,i=t.onPaneContextMenu,l=t.onPaneScroll,c=t.deleteKeyCode,u=t.onMove,d=t.onMoveStart,f=t.onMoveEnd,h=t.selectionKeyCode,p=t.multiSelectionKeyCode,g=t.zoomActivationKeyCode,_=t.elementsSelectable,N=t.zoomOnScroll,v=t.zoomOnPinch,x=t.panOnScroll,j=t.panOnScrollSpeed,k=t.panOnScrollMode,S=t.zoomOnDoubleClick,C=t.panOnDrag,w=t.translateExtent,E=t.minZoom,A=t.maxZoom,R=t.defaultZoom,P=t.defaultPosition,T=t.preventScrolling,O=t.onSelectionContextMenu,F=t.noWheelClassName,B=t.noPanClassName,L=es(),D=yn(Rk),q=_u(h);xk({deleteKeyCode:c,multiSelectionKeyCode:p});var Y=function(z){s==null||s(z),L.getState().resetSelectedElements(),L.setState({nodesSelectionActive:!1})},W=i?function(I){return i(I)}:void 0,X=l?function(I){return l(I)}:void 0;return ge.createElement(Ck,{onMove:u,onMoveStart:d,onMoveEnd:f,selectionKeyPressed:q,elementsSelectable:_,zoomOnScroll:N,zoomOnPinch:v,panOnScroll:x,panOnScrollSpeed:j,panOnScrollMode:k,zoomOnDoubleClick:S,panOnDrag:C,translateExtent:w,minZoom:E,maxZoom:A,defaultZoom:R,defaultPosition:P,zoomActivationKeyCode:g,preventScrolling:T,noWheelClassName:F,noPanClassName:B},n,ge.createElement(Ek,{selectionKeyPressed:q}),D&&ge.createElement(Pk,{onSelectionContextMenu:O,noPanClassName:B}),ge.createElement("div",{className:"react-flow__pane react-flow__container",onClick:Y,onContextMenu:W,onWheel:X}))};Av.displayName="FlowRenderer";var Lk=y.memo(Av);function zk(e){var t=yn(y.useCallback(function(n){return e?A_(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):Array.from(n.nodeInternals.values())},[e]));return t}var Dk=function(t){return{nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions}},Ov=function(t){var n=yn(Dk,Ls),s=n.nodesDraggable,i=n.nodesConnectable,l=n.elementsSelectable,c=n.updateNodeDimensions,u=zk(t.onlyRenderVisibleElements),d=y.useRef(),f=y.useMemo(function(){if(typeof ResizeObserver>"u")return null;var h=new ResizeObserver(function(p){var g=p.map(function(_){return{id:_.target.getAttribute("data-id"),nodeElement:_.target,forceUpdate:!0}});c(g)});return d.current=h,h},[]);return y.useEffect(function(){return function(){var h;d==null||(h=d.current)===null||h===void 0||h.disconnect()}},[]),ge.createElement("div",{className:"react-flow__nodes react-flow__container"},u.map(function(h){var p,g,_,N,v,x,j,k=h.type||"default";t.nodeTypes[k]||(k="default");var S=t.nodeTypes[k]||t.nodeTypes.default,C=!!(h.draggable||s&&typeof h.draggable>"u"),w=!!(h.selectable||l&&typeof h.selectable>"u"),E=!!(h.connectable||i&&typeof h.connectable>"u");return ge.createElement(S,{key:h.id,id:h.id,className:h.className,style:h.style,type:k,data:h.data,sourcePosition:h.sourcePosition||Ae.Bottom,targetPosition:h.targetPosition||Ae.Top,hidden:h.hidden,xPos:(p=(g=h.positionAbsolute)===null||g===void 0?void 0:g.x)!==null&&p!==void 0?p:0,yPos:(_=(N=h.positionAbsolute)===null||N===void 0?void 0:N.y)!==null&&_!==void 0?_:0,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!h.selected,isDraggable:C,isSelectable:w,isConnectable:E,resizeObserver:f,dragHandle:h.dragHandle,zIndex:(v=(x=h[Vn])===null||x===void 0?void 0:x.z)!==null&&v!==void 0?v:0,isParent:!!((j=h[Vn])!==null&&j!==void 0&&j.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!h.width&&!!h.height})}))};Ov.displayName="NodeRenderer";var Fk=y.memo(Ov),xi;function Tv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function $v(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Tv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Ik=(xi={},Nt(xi,Ae.Left,Ae.Right),Nt(xi,Ae.Right,Ae.Left),Nt(xi,Ae.Top,Ae.Bottom),Nt(xi,Ae.Bottom,Ae.Top),xi),Bk=function(e){var t,n,s,i,l,c=e.connectionNodeId,u=e.connectionHandleType,d=e.connectionLineStyle,f=e.connectionLineType,h=f===void 0?_a.Bezier:f,p=e.isConnectable,g=e.CustomConnectionLineComponent,_=yn(y.useCallback(function(X){return{fromNode:X.nodeInternals.get(c),handleId:X.connectionHandleId,toX:(X.connectionPosition.x-X.transform[0])/X.transform[2],toY:(X.connectionPosition.y-X.transform[1])/X.transform[2]}},[c]),Ls),N=_.fromNode,v=_.handleId,x=_.toX,j=_.toY,k=N==null||(t=N[Vn])===null||t===void 0?void 0:t.handleBounds;if(!N||!p||!(k!=null&&k[u]))return null;var S=k[u],C=v?S.find(function(X){return X.id===v}):S[0],w=C?C.x+C.width/2:((n=N==null?void 0:N.width)!==null&&n!==void 0?n:0)/2,E=C?C.y+C.height/2:(s=N==null?void 0:N.height)!==null&&s!==void 0?s:0,A=((N==null||(i=N.positionAbsolute)===null||i===void 0?void 0:i.x)||0)+w,R=((N==null||(l=N.positionAbsolute)===null||l===void 0?void 0:l.y)||0)+E,P=C==null?void 0:C.position;if(!P)return null;var T=Ik[P],O,F,B,L,D,q;switch(u){case"source":O=A,F=R,B=P,L=x,D=j,q=T;break;case"target":O=x,F=j,B=T,L=A,D=R,q=P;break}if(g)return ge.createElement("g",{className:"react-flow__connection"},ge.createElement(g,{connectionLineType:h,connectionLineStyle:d,fromNode:N,fromHandle:C,fromX:A,fromY:R,toX:x,toY:j,fromPosition:P,toPosition:T,sourcePosition:B,targetPosition:q,sourceNode:N,sourceHandle:C,targetX:L,targetY:D,sourceX:O,sourceY:F}));var Y="",W={sourceX:O,sourceY:F,sourcePosition:B,targetX:L,targetY:D,targetPosition:q};return h===_a.Bezier?Y=nv(W):h===_a.Step?Y=ih($v($v({},W),{},{borderRadius:0})):h===_a.SmoothStep?Y=ih(W):h===_a.SimpleBezier?Y=K_(W):Y="M".concat(O,",").concat(F," ").concat(L,",").concat(D),ge.createElement("g",{className:"react-flow__connection"},ge.createElement("path",{d:Y,className:"react-flow__connection-path",style:d}))};function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}var yu,Uk=function(t){var n=t.color,s=n===void 0?"none":n,i=t.strokeWidth,l=i===void 0?1:i;return ge.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:l,fill:"none",points:"-5,-4 0,0 -5,4"})},qk=function(t){var n=t.color,s=n===void 0?"none":n,i=t.strokeWidth,l=i===void 0?1:i;return ge.createElement("polyline",{stroke:s,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:l,fill:s,points:"-5,-4 0,0 -5,4 -5,-4"})},Pv=(yu={},Nt(yu,iu.Arrow,Uk),Nt(yu,iu.ArrowClosed,qk),yu);function Hk(e){var t=y.useMemo(function(){var n=Pv.hasOwnProperty(e);return n?Pv[e]:function(){return null}},[e]);return t}function Rv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Vk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Wk=function(t){var n=t.id,s=t.type,i=t.color,l=t.width,c=l===void 0?12.5:l,u=t.height,d=u===void 0?12.5:u,f=t.markerUnits,h=f===void 0?"strokeWidth":f,p=t.strokeWidth,g=t.orient,_=g===void 0?"auto":g,N=Hk(s);return ge.createElement("marker",{className:"react-flow__arrowhead",id:n,markerWidth:"".concat(c),markerHeight:"".concat(d),viewBox:"-10 -10 20 20",markerUnits:h,orient:_,refX:"0",refY:"0"},ge.createElement(N,{color:i,strokeWidth:p}))},Kk=function(t){var n=t.defaultColor,s=t.rfId;return function(i){var l=[];return i.edges.reduce(function(c,u){return[u.markerStart,u.markerEnd].forEach(function(d){if(d&&vh(d)==="object"){var f=Km(d,s);l.includes(f)||(c.push(Vk({id:f,color:d.color||n},d)),l.push(f))}}),c},[]).sort(function(c,u){return c.id.localeCompare(u.id)})}},Lv=function(t){var n=t.defaultColor,s=t.rfId,i=yn(y.useCallback(Kk({defaultColor:n,rfId:s}),[n,s]),function(l,c){return!(l.length!==c.length||l.some(function(u,d){return u.id!==c[d].id}))});return ge.createElement("defs",null,i.map(function(l){return ge.createElement(Wk,{id:l.id,key:l.id,type:l.type,color:l.color,width:l.width,height:l.height,markerUnits:l.markerUnits,strokeWidth:l.strokeWidth,orient:l.orient})}))};Lv.displayName="MarkerDefinitions";var Yk=y.memo(Lv),Gk=[{level:0,isMaxLevel:!0,edges:[]}];function Qk(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,s=-1,i=e.reduce(function(c,u){var d=v_(u.zIndex),f=d?u.zIndex:0;if(n){var h,p,g,_;f=d?u.zIndex:Math.max(((h=t.get(u.source))===null||h===void 0||(p=h[Vn])===null||p===void 0?void 0:p.z)||0,((g=t.get(u.target))===null||g===void 0||(_=g[Vn])===null||_===void 0?void 0:_.z)||0)}return c[f]?c[f].push(u):c[f]=[u],s=f>s?f:s,c},{}),l=Object.entries(i).map(function(c){var u=yt(c,2),d=u[0],f=u[1],h=+d;return{edges:f,level:h,isMaxLevel:h===s}});return l.length===0?Gk:l}function Xk(e,t,n){var s=yn(y.useCallback(function(i){return e?i.edges.filter(function(l){var c=t.get(l.source),u=t.get(l.target);return(c==null?void 0:c.width)&&(c==null?void 0:c.height)&&(u==null?void 0:u.width)&&(u==null?void 0:u.height)&&vk({sourcePos:c.positionAbsolute||{x:0,y:0},targetPos:u.positionAbsolute||{x:0,y:0},sourceWidth:c.width,sourceHeight:c.height,targetWidth:u.width,targetHeight:u.height,width:i.width,height:i.height,transform:i.transform})}):i.edges},[e,t]));return Qk(s,t,n)}var Jk=function(t){return{connectionNodeId:t.connectionNodeId,connectionHandleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals}},zv=function(t){var n=yn(Jk,Ls),s=n.connectionNodeId,i=n.connectionHandleType,l=n.nodesConnectable,c=n.elementsSelectable,u=n.width,d=n.height,f=n.connectionMode,h=n.nodeInternals,p=Xk(t.onlyRenderVisibleElements,h,t.elevateEdgesOnSelect);if(!u)return null;var g=t.connectionLineType,_=t.defaultMarkerColor,N=t.connectionLineStyle,v=t.connectionLineComponent,x=t.connectionLineContainerStyle,j=s&&i;return ge.createElement(ge.Fragment,null,p.map(function(k){var S=k.level,C=k.edges,w=k.isMaxLevel;return ge.createElement("svg",{key:S,style:{zIndex:S},width:u,height:d,className:"react-flow__edges react-flow__container"},w&&ge.createElement(Yk,{defaultColor:_,rfId:t.rfId}),ge.createElement("g",null,C.map(function(E){var A=gv(h,E.source),R=yt(A,3),P=R[0],T=R[1],O=R[2],F=gv(h,E.target),B=yt(F,3),L=B[0],D=B[1],q=B[2];if(!O||!q)return null;var Y=E.type||"default";t.edgeTypes[Y]||(console.warn('[React Flow]: Edge type "'.concat(Y,'" not found. Using fallback type "default". Help: https://reactflow.dev/error#300')),Y="default");var W=t.edgeTypes[Y]||t.edgeTypes.default,X=f===vo.Strict?D.target:D.target||D.source,I=pv(T.source,E.sourceHandle||null),z=pv(X,E.targetHandle||null),H=(I==null?void 0:I.position)||Ae.Bottom,te=(z==null?void 0:z.position)||Ae.Top;if(!I||!z)return null;var K=_k(P,I,H,L,z,te),V=K.sourceX,G=K.sourceY,Q=K.targetX,ne=K.targetY;return ge.createElement(W,{key:E.id,id:E.id,className:Rs([E.className,t.noPanClassName]),type:Y,data:E.data,selected:!!E.selected,animated:!!E.animated,hidden:!!E.hidden,label:E.label,labelStyle:E.labelStyle,labelShowBg:E.labelShowBg,labelBgStyle:E.labelBgStyle,labelBgPadding:E.labelBgPadding,labelBgBorderRadius:E.labelBgBorderRadius,style:E.style,source:E.source,target:E.target,sourceHandleId:E.sourceHandle,targetHandleId:E.targetHandle,markerEnd:E.markerEnd,markerStart:E.markerStart,sourceX:V,sourceY:G,targetX:Q,targetY:ne,sourcePosition:H,targetPosition:te,elementsSelectable:c,onEdgeUpdate:t.onEdgeUpdate,onContextMenu:t.onEdgeContextMenu,onMouseEnter:t.onEdgeMouseEnter,onMouseMove:t.onEdgeMouseMove,onMouseLeave:t.onEdgeMouseLeave,onClick:t.onEdgeClick,edgeUpdaterRadius:t.edgeUpdaterRadius,onEdgeDoubleClick:t.onEdgeDoubleClick,onEdgeUpdateStart:t.onEdgeUpdateStart,onEdgeUpdateEnd:t.onEdgeUpdateEnd,rfId:t.rfId})})))}),j&&ge.createElement("svg",{style:x,width:u,height:d,className:"react-flow__edges react-flow__connectionline react-flow__container"},ge.createElement(Bk,{connectionNodeId:s,connectionHandleType:i,connectionLineStyle:N,connectionLineType:g,isConnectable:l,CustomConnectionLineComponent:v})))};zv.displayName="EdgeRenderer";var Zk=y.memo(zv),e1=function(t){return"translate(".concat(t.transform[0],"px,").concat(t.transform[1],"px) scale(").concat(t.transform[2],")")};function t1(e){var t=e.children,n=yn(e1);return ge.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:n}},t)}function n1(e){var t=Jm(),n=y.useRef(!1);y.useEffect(function(){!n.current&&t.viewportInitialized&&e&&(setTimeout(function(){return e(t)},1),n.current=!0)},[e,t.viewportInitialized])}var Dv=function(t){var n=t.nodeTypes,s=t.edgeTypes,i=t.onMove,l=t.onMoveStart,c=t.onMoveEnd,u=t.onInit,d=t.onNodeClick,f=t.onEdgeClick,h=t.onNodeDoubleClick,p=t.onEdgeDoubleClick,g=t.onNodeMouseEnter,_=t.onNodeMouseMove,N=t.onNodeMouseLeave,v=t.onNodeContextMenu,x=t.onSelectionContextMenu,j=t.connectionLineType,k=t.connectionLineStyle,S=t.connectionLineComponent,C=t.connectionLineContainerStyle,w=t.selectionKeyCode,E=t.multiSelectionKeyCode,A=t.zoomActivationKeyCode,R=t.deleteKeyCode,P=t.onlyRenderVisibleElements,T=t.elementsSelectable,O=t.selectNodesOnDrag,F=t.translateExtent,B=t.minZoom,L=t.maxZoom,D=t.defaultZoom,q=t.defaultPosition,Y=t.preventScrolling,W=t.defaultMarkerColor,X=t.zoomOnScroll,I=t.zoomOnPinch,z=t.panOnScroll,H=t.panOnScrollSpeed,te=t.panOnScrollMode,K=t.zoomOnDoubleClick,V=t.panOnDrag,G=t.onPaneClick,Q=t.onPaneScroll,ne=t.onPaneContextMenu,J=t.onEdgeUpdate,re=t.onEdgeContextMenu,Se=t.onEdgeMouseEnter,Re=t.onEdgeMouseMove,Oe=t.onEdgeMouseLeave,Fe=t.edgeUpdaterRadius,lt=t.onEdgeUpdateStart,Be=t.onEdgeUpdateEnd,de=t.noDragClassName,pe=t.noWheelClassName,xe=t.noPanClassName,ke=t.elevateEdgesOnSelect,Ue=t.id;return n1(u),ge.createElement(Lk,{onPaneClick:G,onPaneContextMenu:ne,onPaneScroll:Q,deleteKeyCode:R,selectionKeyCode:w,multiSelectionKeyCode:E,zoomActivationKeyCode:A,elementsSelectable:T,onMove:i,onMoveStart:l,onMoveEnd:c,zoomOnScroll:X,zoomOnPinch:I,zoomOnDoubleClick:K,panOnScroll:z,panOnScrollSpeed:H,panOnScrollMode:te,panOnDrag:V,translateExtent:F,minZoom:B,maxZoom:L,defaultZoom:D,defaultPosition:q,onSelectionContextMenu:x,preventScrolling:Y,noDragClassName:de,noWheelClassName:pe,noPanClassName:xe},ge.createElement(t1,null,ge.createElement(Zk,{edgeTypes:s,onEdgeClick:f,onEdgeDoubleClick:p,connectionLineType:j,connectionLineStyle:k,connectionLineComponent:S,connectionLineContainerStyle:C,onEdgeUpdate:J,onlyRenderVisibleElements:P,onEdgeContextMenu:re,onEdgeMouseEnter:Se,onEdgeMouseMove:Re,onEdgeMouseLeave:Oe,onEdgeUpdateStart:lt,onEdgeUpdateEnd:Be,edgeUpdaterRadius:Fe,defaultMarkerColor:W,noPanClassName:xe,elevateEdgesOnSelect:!!ke,rfId:Ue}),ge.createElement(Fk,{nodeTypes:n,onNodeClick:d,onNodeDoubleClick:h,onNodeMouseEnter:g,onNodeMouseMove:_,onNodeMouseLeave:N,onNodeContextMenu:v,selectNodesOnDrag:O,onlyRenderVisibleElements:P,noPanClassName:xe,noDragClassName:de})))};Dv.displayName="GraphView";var s1=y.memo(Dv),Fv=function(){return null};Fv.displayName="GroupNode";function Iv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Bv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Iv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Iv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}var Ml=function(e){var t=function(s){var i=s.id,l=s.type,c=s.data,u=s.xPos,d=s.yPos,f=s.selected,h=s.onClick,p=s.onMouseEnter,g=s.onMouseMove,_=s.onMouseLeave,N=s.onContextMenu,v=s.onDoubleClick,x=s.style,j=s.className,k=s.isDraggable,S=s.isSelectable,C=s.isConnectable,w=s.selectNodesOnDrag,E=s.sourcePosition,A=s.targetPosition,R=s.hidden,P=s.resizeObserver,T=s.dragHandle,O=s.zIndex,F=s.isParent,B=s.noPanClassName,L=s.noDragClassName,D=s.initialized,q=es(),Y=y.useRef(null),W=y.useRef(E),X=y.useRef(A),I=y.useRef(l),z=S||k||h||p||g||_,H=Cl(i,q.getState,p),te=Cl(i,q.getState,g),K=Cl(i,q.getState,_),V=Cl(i,q.getState,N),G=Cl(i,q.getState,v),Q=function(re){if(S&&(!w||!k)&&S_({id:i,store:q}),h){var Se=q.getState().nodeInternals.get(i);h(re,Bv({},Se))}};y.useEffect(function(){if(Y.current&&!R){var J=Y.current;return P==null||P.observe(J),function(){return P==null?void 0:P.unobserve(J)}}},[R]),y.useEffect(function(){var J=I.current!==l,re=W.current!==E,Se=X.current!==A;Y.current&&(J||re||Se)&&(J&&(I.current=l),re&&(W.current=E),Se&&(X.current=A),q.getState().updateNodeDimensions([{id:i,nodeElement:Y.current,forceUpdate:!0}]))},[i,l,E,A]);var ne=kv({nodeRef:Y,disabled:R||!k,noDragClassName:L,handleSelector:T,nodeId:i,isSelectable:S,selectNodesOnDrag:w});return R?null:ge.createElement("div",{className:Rs(["react-flow__node","react-flow__node-".concat(l),B,j,{selected:f,selectable:S,parent:F}]),ref:Y,style:Bv({zIndex:O,transform:"translate(".concat(u,"px,").concat(d,"px)"),pointerEvents:z?"all":"none",visibility:D?"visible":"hidden"},x),onMouseEnter:H,onMouseMove:te,onMouseLeave:K,onContextMenu:V,onClick:Q,onDoubleClick:G,"data-testid":"rf__node-".concat(i),"data-id":i},ge.createElement(ek,{value:i},ge.createElement(e,{id:i,data:c,type:l,xPos:u,yPos:d,selected:f,isConnectable:C,sourcePosition:E,targetPosition:A,dragging:ne,dragHandle:T,zIndex:O})))};return t.displayName="NodeWrapper",y.memo(t)};function Uv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function qv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Uv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function r1(e){var t={input:Ml(e.input||lv),default:Ml(e.default||fh),output:Ml(e.output||uv),group:Ml(e.group||Fv)},n={},s=Object.keys(e).filter(function(i){return!["input","default","output","group"].includes(i)}).reduce(function(i,l){return i[l]=Ml(e[l]||fh),i},n);return qv(qv({},t),s)}function Hv(e,t){y.useRef(null);var n=y.useMemo(function(){return t(e)},[e]);return n}function Vv(e){if(!(!e||typeof document>"u")){var t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");t.appendChild(n),n.appendChild(document.createTextNode(e))}}var Wv=function(t){var n=t.children,s=!0;try{es()}catch{s=!1}return s?ge.createElement(ge.Fragment,null,n):ge.createElement(D_,{createStore:F_},n)};Wv.displayName="ReactFlowWrapper";var a1=["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectStop","onConnectEnd","onClickConnectStart","onClickConnectStop","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","elementsSelectable","minZoom","maxZoom","defaultZoom","defaultPosition","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneScroll","onPaneContextMenu","children","onEdgeUpdate","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdateStart","onEdgeUpdateEnd","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateEdgesOnSelect"];function Kv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function Yv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Kv(Object(n),!0).forEach(function(s){Nt(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Kv(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}Vv(dk),Vv(hk);var o1={input:lv,default:fh,output:uv},i1={default:ch,straight:tv,step:ev,smoothstep:lh,simplebezier:Y_},l1=[15,15],c1=[0,0],Gv=y.forwardRef(function(e,t){var n=e.nodes,s=e.edges,i=e.defaultNodes,l=e.defaultEdges,c=e.className,u=e.nodeTypes,d=u===void 0?o1:u,f=e.edgeTypes,h=f===void 0?i1:f,p=e.onNodeClick,g=e.onEdgeClick,_=e.onInit,N=e.onMove,v=e.onMoveStart,x=e.onMoveEnd,j=e.onConnect,k=e.onConnectStart,S=e.onConnectStop,C=e.onConnectEnd,w=e.onClickConnectStart,E=e.onClickConnectStop,A=e.onClickConnectEnd,R=e.onNodeMouseEnter,P=e.onNodeMouseMove,T=e.onNodeMouseLeave,O=e.onNodeContextMenu,F=e.onNodeDoubleClick,B=e.onNodeDragStart,L=e.onNodeDrag,D=e.onNodeDragStop,q=e.onNodesDelete,Y=e.onEdgesDelete,W=e.onSelectionChange,X=e.onSelectionDragStart,I=e.onSelectionDrag,z=e.onSelectionDragStop,H=e.onSelectionContextMenu,te=e.connectionMode,K=te===void 0?vo.Strict:te,V=e.connectionLineType,G=V===void 0?_a.Bezier:V,Q=e.connectionLineStyle,ne=e.connectionLineComponent,J=e.connectionLineContainerStyle,re=e.deleteKeyCode,Se=re===void 0?"Backspace":re,Re=e.selectionKeyCode,Oe=Re===void 0?"Shift":Re,Fe=e.multiSelectionKeyCode,lt=Fe===void 0?"Meta":Fe,Be=e.zoomActivationKeyCode,de=Be===void 0?"Meta":Be,pe=e.snapToGrid,xe=pe===void 0?!1:pe,ke=e.snapGrid,Ue=ke===void 0?l1:ke,ce=e.onlyRenderVisibleElements,Me=ce===void 0?!1:ce,Ye=e.selectNodesOnDrag,at=Ye===void 0?!0:Ye,Ze=e.nodesDraggable,_t=e.nodesConnectable,st=e.elementsSelectable,dt=e.minZoom,jt=dt===void 0?.5:dt,zt=e.maxZoom,Ge=zt===void 0?2:zt,Ft=e.defaultZoom,Kt=Ft===void 0?1:Ft,Mt=e.defaultPosition,tn=Mt===void 0?c1:Mt,Sn=e.translateExtent,At=Sn===void 0?Qm:Sn,nn=e.preventScrolling,En=nn===void 0?!0:nn,It=e.nodeExtent,ut=e.defaultMarkerColor,zn=ut===void 0?"#b1b1b7":ut,Qt=e.zoomOnScroll,ft=Qt===void 0?!0:Qt,tt=e.zoomOnPinch,fs=tt===void 0?!0:tt,Vt=e.panOnScroll,pt=Vt===void 0?!1:Vt,bt=e.panOnScrollSpeed,ns=bt===void 0?.5:bt,hn=e.panOnScrollMode,bn=hn===void 0?pi.Free:hn,un=e.zoomOnDoubleClick,kn=un===void 0?!0:un,sn=e.panOnDrag,ss=sn===void 0?!0:sn,$t=e.onPaneClick,Dn=e.onPaneScroll,xn=e.onPaneContextMenu,wn=e.children,Js=e.onEdgeUpdate,Kn=e.onEdgeContextMenu,Is=e.onEdgeDoubleClick,rs=e.onEdgeMouseEnter,ps=e.onEdgeMouseMove,Bs=e.onEdgeMouseLeave,Yn=e.onEdgeUpdateStart,as=e.onEdgeUpdateEnd,Wt=e.edgeUpdaterRadius,et=Wt===void 0?10:Wt,qe=e.onNodesChange,Fn=e.onEdgesChange,Us=e.noDragClassName,os=Us===void 0?"nodrag":Us,qs=e.noWheelClassName,ie=qs===void 0?"nowheel":qs,_e=e.noPanClassName,$e=_e===void 0?"nopan":_e,Ct=e.fitView,we=Ct===void 0?!1:Ct,rt=e.fitViewOptions,ct=e.connectOnClick,Lt=ct===void 0?!0:ct,Ot=e.attributionPosition,Pt=e.proOptions,Dt=e.defaultEdgeOptions,Xt=e.elevateEdgesOnSelect,gs=Xt===void 0?!1:Xt,Mn=uu(e,a1),fn=Hv(d,r1),dn=Hv(h,gk);return ge.createElement("div",Yv(Yv({},Mn),{},{ref:t,className:Rs(["react-flow",c])}),ge.createElement(Wv,null,ge.createElement(s1,{onInit:_,onMove:N,onMoveStart:v,onMoveEnd:x,onNodeClick:p,onEdgeClick:g,onNodeMouseEnter:R,onNodeMouseMove:P,onNodeMouseLeave:T,onNodeContextMenu:O,onNodeDoubleClick:F,nodeTypes:fn,edgeTypes:dn,connectionLineType:G,connectionLineStyle:Q,connectionLineComponent:ne,connectionLineContainerStyle:J,selectionKeyCode:Oe,deleteKeyCode:Se,multiSelectionKeyCode:lt,zoomActivationKeyCode:de,onlyRenderVisibleElements:Me,selectNodesOnDrag:at,translateExtent:At,minZoom:jt,maxZoom:Ge,defaultZoom:Kt,defaultPosition:tn,preventScrolling:En,zoomOnScroll:ft,zoomOnPinch:fs,zoomOnDoubleClick:kn,panOnScroll:pt,panOnScrollSpeed:ns,panOnScrollMode:bn,panOnDrag:ss,onPaneClick:$t,onPaneScroll:Dn,onPaneContextMenu:xn,onSelectionContextMenu:H,onEdgeUpdate:Js,onEdgeContextMenu:Kn,onEdgeDoubleClick:Is,onEdgeMouseEnter:rs,onEdgeMouseMove:ps,onEdgeMouseLeave:Bs,onEdgeUpdateStart:Yn,onEdgeUpdateEnd:as,edgeUpdaterRadius:et,defaultMarkerColor:zn,noDragClassName:os,noWheelClassName:ie,noPanClassName:$e,elevateEdgesOnSelect:gs,id:Mn==null?void 0:Mn.id}),ge.createElement(ck,{nodes:n,edges:s,defaultNodes:i,defaultEdges:l,onConnect:j,onConnectStart:k,onConnectStop:S,onConnectEnd:C,onClickConnectStart:w,onClickConnectStop:E,onClickConnectEnd:A,nodesDraggable:Ze,nodesConnectable:_t,elementsSelectable:st,minZoom:jt,maxZoom:Ge,nodeExtent:It,onNodesChange:qe,onEdgesChange:Fn,snapToGrid:xe,snapGrid:Ue,connectionMode:K,translateExtent:At,connectOnClick:Lt,defaultEdgeOptions:Dt,fitView:we,fitViewOptions:rt,onNodesDelete:q,onEdgesDelete:Y,onNodeDragStart:B,onNodeDrag:L,onNodeDragStop:D,onSelectionDrag:I,onSelectionDragStart:X,onSelectionDragStop:z}),W&&ge.createElement(ik,{onSelectionChange:W}),wn,ge.createElement(WE,{proOptions:Pt,position:Ot})))});Gv.displayName="ReactFlow";var Qv=function(t){var n=t.children;return ge.createElement(D_,{createStore:F_},n)};Qv.displayName="ReactFlowProvider";function Xv(e){return function(t){var n=y.useState(t),s=yt(n,2),i=s[0],l=s[1],c=y.useCallback(function(u){return l(function(d){return e(u,d)})},[]);return[i,l,c]}}var u1=Xv(w_),d1=Xv(gE);const m1=e=>Number.isFinite(e),bu=e=>Math.round(e*100)/100,h1=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const i=Math.abs(n-e),l=Math.abs(s-t),c=Math.sqrt(i*i+l*l),u=Math.max(80,Math.min(c*.4,280)),d=Number.isFinite(u)?u:120,f=n>=e?1:-1,h=Math.min(Math.abs(s-t)*.2,50),p=e+f*d,g=t+(s>t?h:-h),_=n-f*d,N=s-(s>t?h:-h);return`M ${e},${t} C ${p},${g} ${_},${N} ${n},${s}`},f1=({id:e,sourceX:t,sourceY:n,targetX:s,targetY:i,markerEnd:l,style:c})=>{const{setEdges:u}=Jm(),[d,f]=y.useState(!1),h=y.useCallback(()=>{f(!0)},[]),p=y.useCallback(()=>{f(!1)},[]),g=y.useMemo(()=>[t,n,s,i].every(T=>m1(T))?{sourceX:bu(t),sourceY:bu(n),targetX:bu(s),targetY:bu(i)}:(console.error(` Edge ${e}: Invalid coordinates`,{sourceX:t,sourceY:n,targetX:s,targetY:i}),null),[t,n,s,i,e]),_=y.useMemo(()=>{if(!g)return null;const{sourceX:T,sourceY:O,targetX:F,targetY:B}=g;return h1(T,O,F,B)},[g]),N=y.useMemo(()=>`animated-edge-gradient-${e}`,[e]);if(!g||!_)return null;const{sourceX:v,sourceY:x,targetX:j,targetY:k}=g,S=(v+j)/2,C=(x+k)/2,w=32,E=S-w/2,A=C-w/2,R=`animated-edge${d?" animated-edge--hovered":""}`,P=`canvas-edge-remove${d?" canvas-edge-remove--visible":""}`;return a.jsxs("g",{className:R,onMouseEnter:h,onMouseLeave:p,children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:N,gradientUnits:"userSpaceOnUse",x1:v,y1:x,x2:j,y2:k,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.85}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.95}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.9})]}),a.jsxs("filter",{id:`edge-glow-${e}`,x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"2",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:_,fill:"none",stroke:"transparent",strokeWidth:20,style:{cursor:"pointer"},className:"animated-edge__interaction"}),a.jsx("path",{d:_,fill:"none",stroke:`url(#${N})`,strokeWidth:6,strokeOpacity:.2,strokeLinecap:"round",strokeLinejoin:"round",style:{filter:`url(#edge-glow-${e})`}}),a.jsx("path",{d:_,fill:"none",stroke:`url(#${N})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",markerEnd:l,className:"animated-edge__base",style:{...c,transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:_,fill:"none",stroke:`url(#${N})`,strokeWidth:d?3.5:3,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"16 12",className:"animated-edge__trail",style:{transition:"stroke-width 0.2s ease"}}),a.jsx("path",{d:_,fill:"none",stroke:"rgba(248, 250, 252, 0.4)",strokeWidth:1.5,strokeDasharray:"3 8",strokeLinecap:"round",strokeLinejoin:"round",className:"animated-edge__spark"}),a.jsx("foreignObject",{className:P,x:E,y:A,width:w,height:w,requiredExtensions:"http://www.w3.org/1999/xhtml",children:a.jsx("div",{className:"canvas-edge-remove__wrapper",children:a.jsx("button",{type:"button",className:"canvas-edge-remove__button",onClick:T=>{T.stopPropagation(),u(O=>O.filter(F=>F.id!==e))},"aria-label":"Remove connection",children:""})})})]})},p1=({thresholdParameter:e,dropIfAnyParameter:t,renderParameterField:n})=>!e&&!t?null:a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Row missingness"})}),e&&n(e),t&&n(t)]}),g1="first",_1=[{value:"first",label:"Keep first occurrence"},{value:"last",label:"Keep last occurrence"},{value:"none",label:"Drop all duplicates"}],v1=({sourceId:e,hasReachableSource:t,removeDuplicatesColumnsParameter:n,removeDuplicatesKeepParameter:s,renderMultiSelectField:i,removeDuplicatesKeepSelectId:l,removeDuplicatesKeep:c,onKeepChange:u})=>{if(!n&&!s)return null;const d=f=>{const h=f.target.value;u(h==="last"||h==="none"?h:"first")};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Duplicate handling"})}),a.jsx("p",{className:"canvas-modal__note",children:"Choose comparison columns and decide whether to keep the first row, last row, or drop all duplicates."}),e?t?null:a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect its columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load the available columns for duplicate checks."}),n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to compare"}),i(n)]}),s&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:l,className:"canvas-modal__parameter-label",children:s.label??"Keep strategy"}),s.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:s.description}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:l,value:c,onChange:d,children:_1.map(f=>a.jsx("option",{value:f.value,children:f.label},f.value))})})]})]})},We=e=>Array.isArray(e)?e.map(t=>String(t??"").trim()).filter(t=>t.length>0):[],y1=["float64","Int64","boolean","string","category","datetime64[ns]","object"],b1=({configState:e,setConfigState:t,availableColumns:n,columnTypeMap:s,columnSuggestions:i,selectedColumns:l,previewColumns:c,previewStatus:u,sourceId:d,hasReachableSource:f})=>{const h=y.useMemo(()=>{const C=e==null?void 0:e.column_overrides;if(!C||typeof C!="object"||Array.isArray(C))return{};const w={};return Object.entries(C).forEach(([E,A])=>{const R=String(E??"").trim();if(!R||typeof A!="string")return;const P=A.trim();P&&(w[R]=P)}),w},[e==null?void 0:e.column_overrides]),p=y.useMemo(()=>{const C=e==null?void 0:e.target_dtype;return typeof C=="string"?C.trim():""},[e==null?void 0:e.target_dtype]),g=y.useMemo(()=>{const C=new Set;return n.forEach(E=>C.add(E)),Object.keys(s).forEach(E=>C.add(E)),Object.keys(i).forEach(E=>C.add(E)),Object.keys(h).forEach(E=>C.add(E)),l.forEach(E=>C.add(E)),c.forEach(E=>{typeof E=="string"&&C.add(E)}),Array.from(C).sort((E,A)=>E.localeCompare(A)).map(E=>{const A=s[E]??"Unknown",R=i[E]??[],P=R.length?R[0]:null,T=Object.prototype.hasOwnProperty.call(h,E),O=T?h[E]:null,F=typeof O=="string"?O.trim():"",B=T?F:p,L=new Set;B&&L.add(B),R.forEach(I=>L.add(I)),A&&A!=="Unknown"&&L.add(A),p&&L.add(p),y1.forEach(I=>L.add(I));const D=B??"",q=!!(P&&P!==D),Y=!!(P&&P===D),W=l.includes(E),X=Array.from(L).sort((I,z)=>I.localeCompare(z));return{column:E,originalType:A,recommended:P,currentTarget:B,suggestions:R,options:X,hasRecommendationGap:q,hasOverride:T,usesDefaultTarget:!T,isRecommendationApplied:Y,isSelected:W}})},[n,p,h,i,s,c,l]),_=y.useMemo(()=>{const C=g.filter(A=>A.hasRecommendationGap),w=g.filter(A=>!A.hasRecommendationGap),E=[];return C.length&&E.push({key:"needs-attention",label:"Needs attention",rows:C}),w.length&&E.push({key:"all-columns",label:C.length?"Other columns":"All columns",rows:w}),E},[g]),N=y.useMemo(()=>g.filter(C=>C.hasRecommendationGap).length,[g]),v=y.useMemo(()=>N>0,[N]),x=y.useMemo(()=>g.filter(C=>C.isSelected).length,[g]),j=y.useCallback((C,w)=>{const E=C.trim();E&&t(A=>{const R=A.column_overrides&&typeof A.column_overrides=="object"&&!Array.isArray(A.column_overrides)?{...A.column_overrides}:{},P=typeof w=="string"?w.trim():"",T=new Set(We(A.columns)),O=new Set(We(A.skipped_columns)),F=O.delete(E);P?(R[E]=P,T.add(E)):delete R[E];const B={...A,columns:Array.from(T).sort((L,D)=>L.localeCompare(D)),column_overrides:R};return F&&(B.skipped_columns=Array.from(O).sort((L,D)=>L.localeCompare(D))),B})},[t]),k=y.useCallback(()=>{const C=Object.entries(i).filter(([,w])=>w.length>0);C.length&&t(w=>{const E=new Set(We(w.columns)),A=w.column_overrides&&typeof w.column_overrides=="object"&&!Array.isArray(w.column_overrides)?{...w.column_overrides}:{};return C.forEach(([R,P])=>{const T=R.trim();T&&(E.add(T),P.length&&(A[T]=P[0]))}),{...w,columns:Array.from(E).sort((R,P)=>R.localeCompare(P)),column_overrides:A}})},[i,t]),S=y.useCallback((C,w)=>{w==="__default__"?j(C,null):j(C,w)},[j]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Column dtype alignment"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:k,disabled:!v,children:"Apply recommendations"})})]}),!d&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to analyse current column dtypes and suggestions."}),d&&!f&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load dtype insights."}),p?a.jsxs("p",{className:"canvas-modal__note",children:["Global target dtype: ",a.jsx("strong",{children:p}),". Columns inherit this unless an override is set."]}):a.jsx("p",{className:"canvas-modal__note",children:"Set a global target dtype or override individual columns below."}),g.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",g.length," column",g.length===1?"":"s","  ",x," mapped in node selection."]}),v?a.jsxs("p",{className:"canvas-modal__note",children:[N," column",N===1?"":"s"," need attention. Apply them in bulk or adjust individually."]}):g.length>0&&a.jsx("p",{className:"canvas-modal__note",children:"All recommendations are in sync. Fine-tune overrides per column as needed."}),u==="loading"&&!g.length&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column type insights"}),g.length===0?a.jsx("p",{className:"canvas-modal__note",children:"Add columns or refresh the dataset preview to surface dtype intelligence."}):a.jsx("div",{className:"canvas-cast__body",children:_.map(C=>a.jsxs("div",{className:"canvas-cast__group",children:[C.label&&a.jsxs("div",{className:"canvas-cast__group-header",children:[a.jsx("h4",{children:C.label}),a.jsxs("span",{children:[C.rows.length," column",C.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Original dtype"}),a.jsx("th",{scope:"col",children:"Recommended"}),a.jsx("th",{scope:"col",children:"Target dtype"})]})}),a.jsx("tbody",{children:C.rows.map(w=>{const E=["canvas-cast__row"];w.hasRecommendationGap&&E.push("canvas-cast__row--attention"),w.hasOverride&&E.push("canvas-cast__row--override");const A=w.hasOverride?w.currentTarget||"":"__default__",R=w.isRecommendationApplied,P=w.suggestions.slice(1,4),T=w.hasOverride?w.currentTarget?`Override  ${w.currentTarget}`:"Override cleared (uses original dtype)":p?`Inheriting ${p}`:"Retains original dtype until a target is set";return a.jsxs("tr",{className:E.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:w.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[w.isSelected&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),w.hasOverride&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),!w.isSelected&&!w.hasOverride&&a.jsx("span",{className:"canvas-cast__muted",children:"Not yet in node"})]})]})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-cast__muted",children:w.originalType})}),a.jsx("td",{children:w.recommended?a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${w.hasRecommendationGap?" canvas-cast__chip--attention":""}${R?" canvas-cast__chip--applied":""}`,children:w.recommended}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:R?"Aligned with target":"Not applied yet"}),P.length>0&&a.jsxs("span",{className:"canvas-cast__suggestions",children:["Other options: ",P.join(", ")]})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:A,onChange:O=>S(w.column,O.target.value),children:[a.jsx("option",{value:"__default__",children:p?`Inherit global (${p})`:"No override (use original)"}),w.options.map(O=>a.jsx("option",{value:O,children:O},`${w.column}-${O}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:T})]})})]},`cast-row-${w.column}`)})})]})})]},`cast-group-${C.key}`))})]})};async function Jv(){const e=await fetch("/ml-workflow/api/node-catalog");if(!e.ok)throw new Error("Failed to load node catalog");return e.json()}async function Zv(e=8){const t=await fetch(`/ml-workflow/api/datasets?limit=${encodeURIComponent(String(e))}`);if(!t.ok)throw new Error("Failed to load datasets");return t.json()}async function ey(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/label-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load label encoding recommendations");return c.json()}async function ty(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/ordinal-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load ordinal encoding suggestions");return c.json()}async function ny(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/target-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load target encoding recommendations");return c.json()}async function sy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/hash-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load hash encoding recommendations");return c.json()}async function ry(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/one-hot-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load one-hot encoding recommendations");return c.json()}async function ay(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/dummy-encoding",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load dummy encoding recommendations");return c.json()}async function yh(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/drop-columns",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load column drop recommendations");return c.json()}async function oy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l=typeof n=="number"&&Number.isFinite(n)?Math.min(5e3,Math.max(50,Math.round(n))):500,c={dataset_source_id:e,sample_size:l};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/recommendations/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load outlier recommendations");return u.json()}async function iy(e,t={}){const{sampleSize:n=500,transformations:s,graph:i,targetNodeId:l}=t,c={dataset_source_id:e,sample_size:n};Array.isArray(s)?s.length>0&&(c.transformations=JSON.stringify(s)):s&&typeof s=="object"&&Object.keys(s).length>0&&(c.transformations=JSON.stringify(s)),i&&Array.isArray(i.nodes)&&Array.isArray(i.edges)&&(c.graph={nodes:i.nodes,edges:i.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/recommendations/skewness",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok)throw new Error("Failed to load skewness recommendations");return u.json()}async function ly(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/scaling",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load scaling recommendations");return c.json()}async function cy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l={dataset_source_id:e,sample_size:n};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(l.graph={nodes:s.nodes,edges:s.edges}),i&&(l.target_node_id=i);const c=await fetch("/ml-workflow/api/recommendations/binning",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!c.ok)throw new Error("Failed to load binning recommendations");return c.json()}async function uy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c={dataset_source_id:e,sample_size:l};s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&(c.graph={nodes:s.nodes,edges:s.edges}),i&&(c.target_node_id=i);const u=await fetch("/ml-workflow/api/analytics/binned-distribution",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){let d="Failed to load binned column distributions";try{const f=await u.clone().json(),h=typeof(f==null?void 0:f.detail)=="string"&&f.detail.trim()?f.detail.trim():typeof(f==null?void 0:f.error)=="string"&&f.error.trim()?f.error.trim():typeof(f==null?void 0:f.message)=="string"&&f.message.trim()?f.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function dy(e,t={}){const{sampleSize:n=500,graph:s,targetNodeId:i}=t,l=n==="all"?0:typeof n=="number"&&Number.isFinite(n)?Math.max(0,Math.round(n)):500,c=new URLSearchParams({dataset_source_id:e,sample_size:String(l)});s&&Array.isArray(s.nodes)&&Array.isArray(s.edges)&&c.set("graph",JSON.stringify({nodes:s.nodes,edges:s.edges})),i&&c.set("target_node_id",i);const u=await fetch(`/ml-workflow/api/analytics/quick-profile?${c.toString()}`);if(!u.ok){let d="Failed to generate dataset profile";try{const f=await u.clone().json(),h=typeof(f==null?void 0:f.detail)=="string"&&f.detail.trim()?f.detail.trim():typeof(f==null?void 0:f.error)=="string"&&f.error.trim()?f.error.trim():typeof(f==null?void 0:f.message)=="string"&&f.message.trim()?f.message.trim():null;h&&(d=h)}catch{try{const h=(await u.text()).trim();h&&(d=h)}catch{}}throw new Error(d)}return u.json()}async function x1(e,t={}){const{config:n,sampleSize:s,graph:i,targetNodeId:l}=t,c={dataset_source_id:e,sample_size:s==="all"?0:typeof s=="number"&&Number.isFinite(s)?s:300};if(n&&typeof n=="object"){const d=(g,_)=>{const N=Number(g);return Number.isFinite(N)?N<0?0:N>100?100:N:_},f=g=>{if(!g||typeof g!="object")return{};const _={};return Object.entries(g).forEach(([N,v])=>{const x=String(N??"").trim();if(!x)return;let j=null,k=null;if(v&&typeof v=="object"){const S=v.lower??v.min??v.minimum??null,C=v.upper??v.max??v.maximum??null,w=Number(S);Number.isFinite(w)&&(j=w);const E=Number(C);Number.isFinite(E)&&(k=E)}if(!(j===null&&k===null)){if(j!==null&&k!==null&&j>k){const S=j;j=k,k=S}_[x]={lower:j,upper:k}}}),_},h=d(n.lower_percentile,5),p=d(n.upper_percentile,95);c.config={...n,method:n.method??"z_score",columns:Array.isArray(n.columns)?n.columns:[],z_threshold:typeof n.z_threshold=="number"&&Number.isFinite(n.z_threshold)?n.z_threshold:3,iqr_multiplier:typeof n.iqr_multiplier=="number"&&Number.isFinite(n.iqr_multiplier)?n.iqr_multiplier:1.5,lower_percentile:h,upper_percentile:p<=h?Math.min(h+1,100):p,manual_bounds:f(n.manual_bounds)}}i&&Array.isArray(i.nodes)&&Array.isArray(i.edges)&&(c.graph={nodes:i.nodes,edges:i.edges}),l&&(c.target_node_id=l);const u=await fetch("/ml-workflow/api/analytics/outliers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(c)});if(!u.ok){const d=await u.text();throw new Error(d||"Failed to load outlier diagnostics")}return u.json()}async function my(e){const t=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`);if(t.status===404)return null;if(!t.ok)throw new Error("Failed to load saved pipeline");return t.json()}async function hy(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error("Failed to save pipeline");return n.json()}async function fy(e,t=10){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/history?limit=${encodeURIComponent(String(t))}`);if(n.status===404)return[];if(!n.ok)throw new Error("Failed to load pipeline history");return n.json()}async function py(e,t={}){const{offset:n,limit:s,mode:i}=t,l=new URLSearchParams;typeof n=="number"&&Number.isFinite(n)&&l.set("offset",String(n)),typeof s=="number"&&Number.isFinite(s)&&l.set("limit",String(s)),i&&l.set("mode",i);const c=l.toString(),u=`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/preview/rows${c?`?${c}`:""}`,d=await fetch(u);if(!d.ok){const f=await d.text();throw new Error(f||"Failed to load preview rows")}return d.json()}async function gy(e){const t=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){const n=await t.text();throw new Error(n||"Failed to load pipeline preview")}return t.json()}async function _y(e){const t={...e,sample_size:0},n=await fetch("/ml-workflow/api/pipelines/preview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok){const s=await n.text();throw new Error(s||"Failed to trigger full dataset execution")}return n.json()}async function w1(e,t){const n=await fetch(`/ml-workflow/api/pipelines/${encodeURIComponent(e)}/full-execution/${encodeURIComponent(t)}`);if(!n.ok){const s=await n.text();throw new Error(s||"Failed to fetch full execution status")}return n.json()}async function vy(e){const t=await fetch("/ml-workflow/api/training-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch training jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue training job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,i=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:i}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function yy(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Training job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this training job.");const n=await t.text();throw new Error(n||"Failed to load training job")}return t.json()}async function Al(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/training-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view training jobs.");const i=await s.text();throw new Error(i||"Failed to load training jobs")}return s.json()}async function by(e,t){if(!e)throw new Error("jobId is required for evaluation");const n=await fetch(`/ml-workflow/api/training-jobs/${encodeURIComponent(e)}/evaluate`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(t??{})});if(!n.ok){if(n.status===401||n.status===403)throw new Error("Sign in to evaluate this model.");const s=await n.text();throw new Error(s||"Failed to evaluate model")}return n.json()}async function xy(e){const t=await fetch("/ml-workflow/api/hyperparameter-tuning-jobs",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(e)});if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to launch tuning jobs.");const s=await t.text();throw new Error(s||"Failed to enqueue tuning job")}const n=await t.json();if(n&&Array.isArray(n==null?void 0:n.jobs)){const s=n.jobs,i=typeof n.total=="number"?n.total:s.length;return{jobs:s,total:i}}return n&&n.id?{jobs:[n],total:1}:{jobs:[],total:0}}async function N1(e){if(!e)throw new Error("jobId is required");const t=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs/${encodeURIComponent(e)}`,{credentials:"include"});if(t.status===404)throw new Error("Tuning job not found");if(!t.ok){if(t.status===401||t.status===403)throw new Error("Sign in to view this tuning job.");const n=await t.text();throw new Error(n||"Failed to load tuning job")}return t.json()}async function Ol(e={}){const t=new URLSearchParams;e.datasetSourceId&&t.set("dataset_source_id",e.datasetSourceId),e.pipelineId&&t.set("pipeline_id",e.pipelineId),e.nodeId&&t.set("node_id",e.nodeId),typeof e.limit=="number"&&Number.isFinite(e.limit)&&t.set("limit",String(e.limit));const n=t.toString(),s=await fetch(`/ml-workflow/api/hyperparameter-tuning-jobs${n?`?${n}`:""}`,{credentials:"include"});if(!s.ok){if(s.status===401||s.status===403)throw new Error("Sign in to view tuning jobs.");const i=await s.text();throw new Error(i||"Failed to load tuning jobs")}return s.json()}async function xu(e){const t=await fetch(`/ml-workflow/api/model-hyperparameters/${encodeURIComponent(e)}`);if(!t.ok){if(t.status===404)throw new Error(`Model type '${e}' not found`);const n=await t.text();throw new Error(n||"Failed to load model hyperparameters")}return t.json()}async function wy(e,t={}){const n=new URLSearchParams;t.pipelineId&&n.set("pipeline_id",t.pipelineId),t.datasetSourceId&&n.set("dataset_source_id",t.datasetSourceId);const s=n.toString(),i=await fetch(`/ml-workflow/api/hyperparameter-tuning/best-params/${encodeURIComponent(e)}${s?`?${s}`:""}`,{credentials:"include"});if(!i.ok){if(i.status===404)throw new Error(`Model type '${e}' not found`);const l=await i.text();throw new Error(l||"Failed to fetch best hyperparameters")}return i.json()}const bh=e=>{if(Array.isArray(e))return e.map(t=>bh(t));if(e&&typeof e=="object"){const t=Object.keys(e).sort(),n={};return t.forEach(s=>{n[s]=bh(e[s])}),n}return e},j1=e=>Array.from(new Uint8Array(e)).map(t=>t.toString(16).padStart(2,"0")).join(""),C1=async e=>{if(!globalThis.crypto||!globalThis.crypto.subtle)throw new Error("Secure hashing is not available in this environment");const t=new TextEncoder,n=await globalThis.crypto.subtle.digest("SHA-256",t.encode(e));return j1(n)},S1=e=>{const t=e&&Array.isArray(e.nodes)?e.nodes:[],n=e&&Array.isArray(e.edges)?e.edges:[],s=t.map(l=>{let c=null;if(l&&l.data&&typeof l.data=="object"){const u=l.data.config;if(u!==void 0)try{c=JSON.parse(JSON.stringify(u))}catch{c=u}}return{id:l&&Object.prototype.hasOwnProperty.call(l,"id")?l.id??null:null,type:l&&Object.prototype.hasOwnProperty.call(l,"type")?l.type??null:null,catalogType:l&&l.data&&Object.prototype.hasOwnProperty.call(l.data,"catalogType")?l.data.catalogType??null:null,config:c}}).sort((l,c)=>{const u=typeof l.id=="string"?l.id:String(l.id??""),d=typeof c.id=="string"?c.id:String(c.id??"");return u.localeCompare(d)}),i=n.map(l=>({source:l&&Object.prototype.hasOwnProperty.call(l,"source")?l.source??null:null,target:l&&Object.prototype.hasOwnProperty.call(l,"target")?l.target??null:null,sourceHandle:l&&Object.prototype.hasOwnProperty.call(l,"sourceHandle")?l.sourceHandle??null:null,targetHandle:l&&Object.prototype.hasOwnProperty.call(l,"targetHandle")?l.targetHandle??null:null})).sort((l,c)=>{const u=String(l.source??"").localeCompare(String(c.source??""));return u!==0?u:String(l.target??"").localeCompare(String(c.target??""))});return{nodes:s,edges:i}};async function xo(e,t){if(!e)throw new Error("datasetSourceId is required to compute pipeline ID");const n=S1(t),s=JSON.stringify(bh(n)),i=await C1(s);return`${e}_${i.slice(0,8)}`}const E1=Object.freeze(Object.defineProperty({__proto__:null,createHyperparameterTuningJob:xy,createTrainingJob:vy,evaluateTrainingJob:by,fetchBestHyperparameters:wy,fetchBinnedDistribution:uy,fetchBinningRecommendations:cy,fetchDatasets:Zv,fetchDropColumnRecommendations:yh,fetchDummyEncodingRecommendations:ay,fetchFullExecutionStatus:w1,fetchHashEncodingRecommendations:sy,fetchHyperparameterTuningJob:N1,fetchHyperparameterTuningJobs:Ol,fetchLabelEncodingRecommendations:ey,fetchModelHyperparameters:xu,fetchNodeCatalog:Jv,fetchOneHotEncodingRecommendations:ry,fetchOrdinalEncodingRecommendations:ty,fetchOutlierDiagnostics:x1,fetchOutlierRecommendations:oy,fetchPipeline:my,fetchPipelineHistory:fy,fetchPipelinePreview:gy,fetchPipelinePreviewRows:py,fetchQuickProfile:dy,fetchScalingRecommendations:ly,fetchSkewnessRecommendations:iy,fetchTargetEncodingRecommendations:ny,fetchTrainingJob:yy,fetchTrainingJobs:Al,generatePipelineId:xo,savePipeline:hy,triggerFullDatasetExecution:_y},Symbol.toStringTag,{value:"Module"})),Tl=100,k1=12,M1={limited_full_sample_for_large_dataset:"Preview limited because the dataset is large.",capped_sample_for_large_dataset:"Requested sample size capped for a large dataset.",switched_to_first_last_for_large_dataset:"Using first and last rows to summarize the large dataset.",default_offset:"Offset fallback applied; starting from the beginning.",normalized_negative_offset:"Negative offset normalized to zero.",default_limit:"Using the default preview window size.",normalized_non_positive_limit:"Requested preview size too small; using the minimum window.",capped_limit_for_sample:"Preview window capped to stay within safe limits."},Ny={succeeded:"Completed",deferred:"Deferred",queued:"Queued",running:"In progress",failed:"Failed",skipped:"Skipped",cancelled:"Cancelled"},A1={dataset_too_large:"Full dataset run is executing in the background for large datasets.",memory_error:"Full dataset execution failed because the server ran out of memory.",background_failure:"Background job ended unexpectedly. Check server logs for details."},O1={queued:"Queued",running:"Running",succeeded:"Completed",failed:"Failed",cancelled:"Cancelled"},T1=e=>{switch(e){case"succeeded":case"deferred":case"queued":case"running":case"failed":case"skipped":case"cancelled":return e;default:return"deferred"}},$1=e=>{if(!e)return"";const t=A1[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},jy=(e,t)=>{if(!e)return null;const n=e.job_status??null,s=T1(n??e.status??null),i=Ny[n??e.status??s]??Ny[s],l=typeof e.processed_rows=="number"&&e.processed_rows>=0?t(e.processed_rows):null,c=typeof e.total_rows=="number"&&e.total_rows>=0?t(e.total_rows):null;let u=`Full dataset run: ${i}`;s==="running"&&l&&c?u=`Full dataset run: In progress (${l}/${c})`:s==="running"&&l?u=`Full dataset run: In progress (${l} rows)`:s==="succeeded"&&l?u=`Full dataset run: Completed (${l} rows)`:s==="succeeded"&&c&&(u=`Full dataset run: Completed (${c} rows)`);const d=[],f=[],h=n?O1[n]??n:null;if(n==="running"?l&&c?d.push(`Processed ${l} of ${c} rows.`):l?d.push(`Processed ${l} rows.`):c&&d.push(`Processing ${c} rows.`):l?d.push(`Processed ${l} rows.`):c&&d.push(`Total rows ${c}.`),e.reason&&d.push(e.reason),h&&f.push({label:"Background job",value:h}),e.job_id&&f.push({label:"Background job ID",value:e.job_id}),c&&f.push({label:"Dataset rows",value:c}),l&&s!=="queued"&&s!=="skipped"&&f.push({label:"Processed rows",value:l}),typeof e.poll_after_seconds=="number"&&e.poll_after_seconds>0&&f.push({label:"Next status check",value:`${e.poll_after_seconds}s`}),e.last_updated)try{const _=new Date(e.last_updated).toLocaleString();f.push({label:"Last updated",value:_})}catch{f.push({label:"Last updated",value:String(e.last_updated)})}const p=Array.isArray(e.warnings)?e.warnings.map($1).map(_=>_.trim()).filter(Boolean):[];let g=null;switch(s){case"queued":g=e.reason?e.reason:"Full dataset run queued in background.";break;case"running":g=e.reason?e.reason:"Full dataset run in progress.";break;case"succeeded":if(l){const _=e.processed_rows===1?"":"s";g=`Full dataset run processed ${l} row${_}.`}else c?g=`Full dataset run completed (${c} rows).`:g="Full dataset run completed.";break;case"failed":g=e.reason?`Full dataset run failed: ${e.reason}`:"Full dataset run failed.";break;case"cancelled":g="Full dataset run cancelled.";break;case"skipped":g=e.reason?`Full dataset run skipped: ${e.reason}`:"Full dataset run skipped.";break;case"deferred":g=e.reason?e.reason:"Full dataset run deferred to background processing.";break;default:g=null;break}return{label:u,tone:s,details:d,metadata:f,warnings:p,stepLabel:g,isActive:n==="queued"||n==="running"}},Cy=()=>({status:"idle",columns:[],rows:[],nextOffset:null,hasMore:!1,totalRows:null,samplingAdjustments:[],largeDataset:!1,error:null}),P1=e=>{if(!e)return"";if(e.startsWith("window_mode_fallback:")){const s=e.split(":",2)[1]??"";return s?`Preview mode "${s}" is not supported; falling back to head sampling.`:"Preview mode fallback applied."}const t=M1[e];if(t)return t;const n=e.replace(/_/g," ").trim();return n?n.charAt(0).toUpperCase()+n.slice(1):e},R1=({preview:e,columns:t,rows:n,tableNote:s,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:f,fullExecutionWarnings:h})=>{const p=e==null?void 0:e.metrics,g=Array.isArray(e==null?void 0:e.column_stats)?e.column_stats:[],_=Array.isArray(e==null?void 0:e.row_missing_stats)?e.row_missing_stats:[],N=Array.isArray(e==null?void 0:e.applied_steps)?e.applied_steps:[];let v=N;const x=f||null;if(x){const C=N.findIndex(w=>typeof w=="string"&&w.toLowerCase().startsWith("full dataset run"));C>=0?v=[...N.slice(0,C),x,...N.slice(C+1)]:N.includes(x)||(v=[...N,x])}const j=Array.isArray(e==null?void 0:e.sample_rows)?e.sample_rows:[],k=_.reduce((C,w)=>(w&&typeof w.index=="number"&&(C[w.index]=typeof w.missing_percentage=="number"?w.missing_percentage:0),C),{}),S=j.slice(0,k1);return a.jsxs("div",{className:"canvas-preview",children:[p&&a.jsxs("div",{className:"canvas-preview__metrics",role:"list",children:[a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(p.row_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Columns"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(p.column_count)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Duplicate rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(p.duplicate_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Missing cells"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(p.missing_cells)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Rows sampled"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(p.preview_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Dataset rows"}),a.jsx("span",{className:"canvas-preview__metric-value",children:l(p.total_rows)})]}),a.jsxs("div",{className:"canvas-preview__metric",role:"listitem",children:[a.jsx("span",{className:"canvas-preview__metric-label",children:"Sample request"}),a.jsx("span",{className:"canvas-preview__metric-value",children:p.requested_sample_size===0?"Full dataset":l(p.requested_sample_size)})]})]}),v.length>0&&a.jsxs("div",{className:"canvas-preview__steps",children:[a.jsx("h4",{children:"Applied steps"}),a.jsx("ol",{children:v.map((C,w)=>a.jsx("li",{children:C},`${C}-${w}`))})]}),t.length>0&&n.length>0?a.jsxs("div",{className:"canvas-preview__table-wrapper",role:"region","aria-label":"Sample rows",children:[a.jsxs("table",{className:"canvas-preview__table",children:[a.jsx("thead",{children:a.jsx("tr",{children:t.map(C=>a.jsx("th",{children:C},C))})}),a.jsx("tbody",{children:n.map((C,w)=>a.jsx("tr",{children:t.map(E=>a.jsx("td",{children:i(C==null?void 0:C[E])},`${w}-${E}`))},`row-${w}`))})]}),s?a.jsx("p",{className:"canvas-modal__note",children:s}):null]}):a.jsx("p",{className:"canvas-modal__note",children:"No sample rows available after applying the upstream steps."}),_.length>0&&S.length>0&&a.jsxs("div",{className:"canvas-preview__row-stats",children:[a.jsx("h4",{children:"Row missingness"}),a.jsx("div",{className:"canvas-preview__row-grid",children:S.map((C,w)=>{const E=k[w]??0,A=E%1===0?0:1;return a.jsxs("div",{className:"canvas-preview__row-chip",children:[a.jsxs("span",{children:["Row ",w+1]}),a.jsxs("strong",{children:[l(E,A),"%"]})]},`row-missing-${w}`)})})]}),g.length>0&&a.jsxs("div",{className:"canvas-preview__column-stats",children:[a.jsx("h4",{children:"Column summary"}),a.jsx("div",{className:"canvas-preview__column-grid",children:g.map(C=>a.jsxs("div",{className:"canvas-preview__column-card",children:[a.jsx("div",{className:"canvas-preview__column-name",children:C.name}),C.dtype&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Type: ",C.dtype]}),a.jsxs("div",{className:"canvas-preview__column-detail",children:["Missing: ",c(C.missing_percentage)," (",l(C.missing_count),")"]}),typeof C.mean=="number"&&!Number.isNaN(C.mean)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mean: ",u(C.mean)]}),typeof C.median=="number"&&!Number.isNaN(C.median)&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Median: ",u(C.median)]}),C.mode!==void 0&&C.mode!==null&&C.mode!==""&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Mode: ",d(C.mode)]}),typeof C.distinct_count=="number"&&a.jsxs("div",{className:"canvas-preview__column-detail",children:["Distinct values: ",l(C.distinct_count)]})]},C.name))})]}),h&&h.length>0&&a.jsxs("div",{className:"canvas-preview__full-execution-warnings",children:[a.jsx("strong",{children:"Full execution notes:"}),a.jsx("ul",{children:h.map((C,w)=>a.jsx("li",{children:C},`${C}-${w}`))})]})]})},L1=({previewState:e,datasetSourceId:t,canTriggerPreview:n,onRefresh:s,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d})=>{var Y,W,X,I,z;const[f,h]=y.useState(()=>Cy()),[p,g]=y.useState(null),[_,N]=y.useState(!1),v=e.status==="loading",x=v||!n,j=y.useMemo(()=>{var te;const H=(te=e.data)==null?void 0:te.columns;return Array.isArray(H)?H.filter(K=>typeof K=="string"):[]},[(Y=e.data)==null?void 0:Y.columns]),k=y.useMemo(()=>{var H;return Array.isArray((H=e.data)==null?void 0:H.sample_rows)?e.data.sample_rows.slice(0,Tl):[]},[(W=e.data)==null?void 0:W.sample_rows]),S=k.length,C=Array.isArray((X=e.data)==null?void 0:X.sample_rows)?e.data.sample_rows.length:0,w=(I=e.data)==null?void 0:I.metrics,E=y.useMemo(()=>w?C>S||typeof w.total_rows=="number"&&w.total_rows>C:!1,[w,S,C]);y.useEffect(()=>{var te;if(e.status!=="success"||!e.data){h(K=>K.status==="idle"?K:Cy()),g(null);return}const H=jy((te=e.data.signals)==null?void 0:te.full_execution,l);g(H),h({status:"ready",columns:[...j],rows:[...k],nextOffset:S,hasMore:E,totalRows:typeof(w==null?void 0:w.total_rows)=="number"?w.total_rows:null,samplingAdjustments:[],largeDataset:!1,error:null})},[j,k,S,E,l,w==null?void 0:w.total_rows,e.data,e.status]),y.useEffect(()=>{var V,G;if(!p||!p.isActive)return;const H=(G=(V=e.data)==null?void 0:V.signals)==null?void 0:G.full_execution;if(!H||!H.job_id||!t)return;const te=typeof H.poll_after_seconds=="number"&&H.poll_after_seconds>0?H.poll_after_seconds*1e3:5e3,K=setTimeout(()=>{Promise.resolve().then(()=>E1).then(Q=>Q.fetchFullExecutionStatus(t,H.job_id)).then(Q=>{const ne=jy(Q,l);g(ne),e.data&&{...e.data,signals:{...e.data.signals}}}).catch(Q=>{console.error("Failed to poll background job status:",Q)})},te);return()=>clearTimeout(K)},[p,t,l,e.data]);const A=f.columns.length>0?f.columns:j,R=f.rows.length>0?f.rows:k,P=f.totalRows??(typeof(w==null?void 0:w.total_rows)=="number"?w.total_rows:null),T=f.status==="idle"?E:f.hasMore,O=f.status==="loading",F=R.length,B=y.useMemo(()=>{if(!F)return null;const H=l(F);if(P!==null&&P>=0){const te=l(P),K=`Loaded ${H} of ${te} rows.`;return T&&F<P?`${K} Load more rows to continue.`:!T&&F<P?`${K} Preview limited by backend settings.`:K}return T?`Loaded ${H} rows. Additional rows available.`:`Loaded ${H} rows.`},[T,l,F,P]),L=y.useMemo(()=>(f.status==="idle"?[]:f.samplingAdjustments).map(P1).map(te=>te.trim()).filter(Boolean),[f.samplingAdjustments,f.status]),D=f.status==="idle"?!1:f.largeDataset,q=y.useCallback(()=>{var V;if(!t||!T||f.status==="loading")return;const H=f.rows.length>0?f.rows:k,te=f.status==="idle"?H.length:f.nextOffset??H.length,K=Array.isArray((V=e.data)==null?void 0:V.sample_rows)?e.data.sample_rows:[];if(te<K.length){const G=K.slice(te,te+Tl),Q=H.concat(G),ne=te+G.length,J=ne<K.length||typeof(w==null?void 0:w.total_rows)=="number"&&w.total_rows>K.length;h({status:"ready",columns:f.columns.length>0?f.columns:j,rows:Q,nextOffset:J?ne:null,hasMore:J,totalRows:typeof(w==null?void 0:w.total_rows)=="number"?w.total_rows:null,samplingAdjustments:f.samplingAdjustments,largeDataset:f.largeDataset,error:null});return}h(G=>({...G,status:"loading",error:null})),py(t,{offset:te,limit:Tl}).then(G=>{h(Q=>{const ne=Q.rows.length>0?Q.rows:H,J=Array.isArray(G.columns)&&G.columns.length>0?G.columns.map(ke=>String(ke)):Q.columns.length>0?Q.columns:j,re=typeof G.offset=="number"&&G.offset>=0?G.offset:0,Se=Array.isArray(G.rows)?G.rows:[],Re=re<=ne.length?ne.slice(0,re):ne.slice(),Oe=re<=ne.length?Re.concat(Se):ne.concat(Se),Fe=Se.length,lt=!!G.has_more,Be=typeof G.next_offset=="number"?G.next_offset:lt?re+Fe:null,de=typeof G.total_rows=="number"?G.total_rows:null,pe=lt?null:Oe.length,xe=de!==null?de:Q.totalRows!==null?Q.totalRows:pe;return{status:"ready",columns:[...J],rows:Oe,nextOffset:Be,hasMore:lt,totalRows:xe,samplingAdjustments:Array.isArray(G.sampling_adjustments)?G.sampling_adjustments:[],largeDataset:!!G.large_dataset,error:null}})}).catch(G=>{h(Q=>({...Q,status:"error",error:(G==null?void 0:G.message)??"Unable to load additional rows."}))})},[j,k,t,T,f,(z=e.data)==null?void 0:z.sample_rows,w]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsxs("div",{className:"canvas-modal__section-title",children:[a.jsx("h3",{children:"Dataset snapshot"}),p&&a.jsx("div",{className:`canvas-preview__full-execution-badge canvas-preview__full-execution--${p.tone}`,role:"status","aria-live":p.isActive?"polite":"off",title:p.details.length>0?p.details.join(" "):void 0,children:p.label})]}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:x,children:v?"Refreshing":"Refresh"})})]}),p&&a.jsxs("div",{className:"canvas-preview__full-execution-context",children:[p.details.length>0&&a.jsx("ul",{className:"canvas-preview__full-execution-details",children:p.details.map((H,te)=>a.jsx("li",{children:H},`${H}-${te}`))}),p.metadata.length>0&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{type:"button",className:"canvas-preview__full-execution-toggle",onClick:()=>N(!_),"aria-expanded":_,children:[_?"":""," ",_?"Hide":"Show"," job details"]}),_&&a.jsx("dl",{className:"canvas-preview__full-execution-meta",children:p.metadata.map((H,te)=>a.jsxs("div",{className:"canvas-preview__full-execution-meta-item",children:[a.jsx("dt",{children:H.label}),a.jsx("dd",{children:H.value})]},`${H.label}-${H.value}-${te}`))})]})]}),v&&a.jsx("p",{className:"canvas-modal__note",children:"Generating preview"}),e.status==="error"&&e.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:e.error}),e.status==="success"&&e.data&&a.jsx(R1,{preview:e.data,columns:A,rows:R,tableNote:B,formatCellValue:i,formatMetricValue:l,formatMissingPercentage:c,formatNumericStat:u,formatModeStat:d,fullExecutionStepLabel:(p==null?void 0:p.stepLabel)??null,fullExecutionWarnings:(p==null?void 0:p.warnings)??[]}),f.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:f.error}),D&&a.jsxs("p",{className:"canvas-modal__note",children:["Large dataset detected. Preview windows are capped at ",l(Tl)," rows to stay responsive."]}),L.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Sampling adjustments:"}),a.jsx("ul",{children:L.map((H,te)=>a.jsx("li",{children:H},`${H}-${te}`))})]}),T&&t&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:q,disabled:O,children:O?"Loading rows":`Load next ${l(Tl)} rows`})}),!T&&!v&&P!==null&&F>=P&&F>0&&a.jsx("p",{className:"canvas-modal__note",children:"All available rows have been loaded."})]})},wi=[{value:"200",label:"200 rows"},{value:"500",label:"500 rows"},{value:"1000",label:"1,000 rows"},{value:"all",label:"Full dataset"}],z1=({node:e,isDatasetProfileNode:t,sourceId:n,hasReachableSource:s,graphContext:i,profilingGraphSignature:l,formatRelativeTime:c})=>{var q;const[u,d]=y.useState({status:"idle",data:null,error:null}),[f,h]=y.useState(0),[p,g]=y.useState({}),[_,N]=y.useState("500"),[v,x]=y.useState("summary"),[j,k]=y.useState(!1),S=y.useMemo(()=>!t||!n?null:`${n}::${(e==null?void 0:e.id)??""}::${_}::${l}`,[t,e==null?void 0:e.id,l,_,n]),C=y.useMemo(()=>S?p[S]??null:null,[p,S]);y.useEffect(()=>{N("500"),d({status:"idle",data:null,error:null})},[t,e==null?void 0:e.id]),y.useEffect(()=>{if(!t){d({status:"idle",data:null,error:null});return}if(!n){d({status:"error",data:null,error:"Select a dataset to generate a lightweight profile."});return}if(!s){d({status:"error",data:null,error:"Connect this step to an upstream output to generate a profile."});return}if(C){d({status:"success",data:C,error:null});return}let Y=!0;d({status:"loading",data:null,error:null});const W=wi.find(I=>I.value===_)??wi[1]??wi[0],X=W.value==="all"?"all":Number(W.value);return dy(n,{sampleSize:X,graph:i,targetNodeId:(e==null?void 0:e.id)??null}).then(I=>{Y&&(S&&I&&g(z=>({...z,[S]:I})),d({status:"success",data:I??null,error:null}))}).catch(I=>{Y&&d({status:"error",data:null,error:(I==null?void 0:I.message)??"Unable to generate dataset profile"})}),()=>{Y=!1}},[C,i,s,t,e==null?void 0:e.id,f,S,_,n]);const w=u.data,E=(w==null?void 0:w.generated_at)??null,A=((q=w==null?void 0:w.correlations)==null?void 0:q.length)??0;y.useEffect(()=>{k(!1),x("summary")},[t,E]),y.useEffect(()=>{v==="correlations"&&A===0&&x("summary")},[v,A]);const R=y.useCallback(()=>{S&&g(Y=>{if(!Object.prototype.hasOwnProperty.call(Y,S))return Y;const W={...Y};return delete W[S],W}),h(Y=>Y+1)},[S]),P=y.useMemo(()=>e!=null&&e.id?`profiling-warnings-${e.id}`:"profiling-warnings",[e==null?void 0:e.id]),T=y.useMemo(()=>e!=null&&e.id?`profiling-summary-${e.id}`:"profiling-summary",[e==null?void 0:e.id]),O=y.useMemo(()=>e!=null&&e.id?`profiling-correlations-${e.id}`:"profiling-correlations",[e==null?void 0:e.id]),F=y.useMemo(()=>e!=null&&e.id?`profiling-summary-tab-${e.id}`:"profiling-summary-tab",[e==null?void 0:e.id]),B=y.useMemo(()=>e!=null&&e.id?`profiling-correlations-tab-${e.id}`:"profiling-correlations-tab",[e==null?void 0:e.id]),L=y.useMemo(()=>wi.find(Y=>Y.value===_)??wi[0],[_]),D=y.useMemo(()=>c((w==null?void 0:w.generated_at)??null),[c,w==null?void 0:w.generated_at]);return{profileState:u,profileData:w,profilingSamplePreset:_,setProfilingSamplePreset:N,profilingActiveTab:v,setProfilingActiveTab:x,isProfilingWarningsOpen:j,setIsProfilingWarningsOpen:k,handleRefreshDatasetProfile:R,activeProfilingSamplePreset:L,profilingWarningsListId:P,profilingSummaryPanelId:T,profilingCorrelationsPanelId:O,profilingSummaryTabId:F,profilingCorrelationsTabId:B,profilingCorrelationCount:A,relativeProfilingGeneratedAt:D}},D1=({isDatasetProfileNode:e,controller:t,formatCellValue:n,formatNumericStat:s,formatMissingPercentage:i})=>{if(!e)return null;const{profileState:l,profileData:c,profilingSamplePreset:u,setProfilingSamplePreset:d,profilingActiveTab:f,setProfilingActiveTab:h,isProfilingWarningsOpen:p,setIsProfilingWarningsOpen:g,handleRefreshDatasetProfile:_,activeProfilingSamplePreset:N,profilingWarningsListId:v,profilingSummaryPanelId:x,profilingCorrelationsPanelId:j,profilingSummaryTabId:k,profilingCorrelationsTabId:S,profilingCorrelationCount:C,relativeProfilingGeneratedAt:w}=t,E=l.status==="success"&&!!c;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dataset profile"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Profile sampling presets",children:wi.map(A=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":A.value===u,onClick:()=>d(A.value),disabled:l.status==="loading",children:A.label},A.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:_,disabled:l.status==="loading",children:l.status==="loading"?"Refreshing":"Refresh"})]})]}),w&&a.jsxs("span",{className:"canvas-modal__meta",children:["Updated ",w]}),a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:N.label}),"."]}),l.status==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Generating dataset profile"}),l.status==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:l.error}),E&&c&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-profiling__meta",children:[a.jsxs("span",{children:["Rows analysed: ",c.rows_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Columns: ",c.columns_analyzed.toLocaleString()]}),a.jsxs("span",{children:["Sample size: ",c.sample_size.toLocaleString()," rows"]}),a.jsxs("span",{children:["Missing cells: ",c.metrics.missing_cells.toLocaleString()]}),a.jsxs("span",{children:["Duplicate rows: ",c.metrics.duplicate_rows.toLocaleString()]})]}),a.jsxs("div",{className:"canvas-profiling__tabs",role:"tablist","aria-label":"Dataset profile views",children:[a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:k,role:"tab","data-active":f==="summary","aria-selected":f==="summary","aria-controls":x,onClick:()=>h("summary"),children:"Summary"}),a.jsx("button",{type:"button",className:"canvas-profiling__tab",id:S,role:"tab","data-active":f==="correlations","aria-selected":f==="correlations","aria-controls":j,onClick:()=>h("correlations"),disabled:!C,children:"Correlations"})]}),f==="summary"&&a.jsxs("div",{className:"canvas-profiling__panel",id:x,role:"tabpanel","aria-labelledby":k,children:[c.warnings&&c.warnings.length>0?a.jsxs("div",{className:"canvas-profiling__warnings",children:[a.jsx("button",{type:"button",className:"canvas-profiling__warnings-toggle",onClick:()=>g(A=>!A),"aria-expanded":p,"aria-controls":v,children:p?"Hide warnings":`Show warnings (${c.warnings.length})`}),p&&a.jsx("ul",{className:"canvas-profiling__warnings-list",id:v,children:c.warnings.map((A,R)=>a.jsx("li",{children:A},`profiling-warning-${R}`))})]}):null,a.jsx("div",{className:"canvas-quick-profile__columns",children:c.columns.map(A=>{const R=A.numeric_summary,P=!!R,T=Array.isArray(A.top_values)?A.top_values:[],O=Array.isArray(A.sample_values)?A.sample_values:[];return a.jsxs("article",{className:"canvas-quick-profile__column","aria-label":`${A.name} summary`,children:[a.jsxs("header",{className:"canvas-quick-profile__column-header",children:[a.jsx("h4",{children:A.name}),a.jsx("span",{className:"canvas-quick-profile__dtype",children:A.semantic_type??A.dtype??"Unknown"})]}),a.jsxs("dl",{className:"canvas-quick-profile__stats",children:[a.jsxs("div",{children:[a.jsx("dt",{children:"Missing"}),a.jsx("dd",{children:`${i(A.missing_percentage)} (${A.missing_count.toLocaleString()})`})]}),a.jsxs("div",{children:[a.jsx("dt",{children:"Distinct"}),a.jsx("dd",{children:A.distinct_count!==null?A.distinct_count.toLocaleString():""})]})]}),P?a.jsxs("div",{className:"canvas-quick-profile__numeric",children:[a.jsx("h5",{children:"Distribution"}),a.jsxs("div",{className:"canvas-quick-profile__numeric-grid",children:[a.jsxs("span",{children:[a.jsx("strong",{children:"Mean"})," ",s(R==null?void 0:R.mean)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Std dev"})," ",s(R==null?void 0:R.std)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Min"})," ",s(R==null?void 0:R.minimum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Max"})," ",s(R==null?void 0:R.maximum)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P25"})," ",s(R==null?void 0:R.percentile_25)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"Median"})," ",s(R==null?void 0:R.percentile_50)]}),a.jsxs("span",{children:[a.jsx("strong",{children:"P75"})," ",s(R==null?void 0:R.percentile_75)]})]})]}):null,T.length>0?a.jsxs("div",{className:"canvas-quick-profile__top-values",children:[a.jsx("h5",{children:"Top values"}),a.jsx("ul",{children:T.map((F,B)=>a.jsxs("li",{children:[a.jsx("span",{className:"canvas-quick-profile__value",children:n(F.value)}),a.jsxs("span",{className:"canvas-quick-profile__count",children:[F.count.toLocaleString()," (",F.percentage.toFixed(1),"%)"]})]},`${A.name}-top-${B}`))})]}):null,O.length>0?a.jsxs("div",{className:"canvas-quick-profile__samples",children:[a.jsx("h5",{children:"Sample values"}),a.jsx("ul",{children:O.slice(0,5).map((F,B)=>a.jsx("li",{children:n(F)},`${A.name}-sample-${B}`))})]}):null]},A.name)})})]}),f==="correlations"&&a.jsx("div",{className:"canvas-profiling__panel",id:j,role:"tabpanel","aria-labelledby":S,children:a.jsxs("div",{className:"canvas-quick-profile__correlations",children:[a.jsx("h4",{children:"Top correlations"}),c.correlations&&c.correlations.length>0?a.jsxs("table",{className:"canvas-quick-profile__correlation-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column A"}),a.jsx("th",{scope:"col",children:"Column B"}),a.jsx("th",{scope:"col",children:"Coefficient"})]})}),a.jsx("tbody",{children:c.correlations.map((A,R)=>{const P=Math.abs(A.coefficient);let T="low";P>=.85?T="extreme":P>=.7?T="strong":P>=.55&&(T="moderate");const O=A.coefficient>=0?"positive":"negative";return a.jsxs("tr",{children:[a.jsx("td",{children:A.column_a}),a.jsx("td",{children:A.column_b}),a.jsx("td",{className:"canvas-quick-profile__correlation-coefficient","data-strength":T,"data-sign":O,children:A.coefficient.toFixed(2)})]},`profile-correlation-${R}`)})})]}):a.jsx("p",{className:"canvas-quick-profile__correlations-empty",children:"Not enough numeric columns to compute correlations yet."})]})})]})]})},F1=({type:e})=>a.jsx("span",{"aria-hidden":"true",className:`canvas-modal__title-glyph${e==="dataset"?" canvas-modal__title-glyph--dataset":""}`,children:e==="dataset"?"":""}),I1=({title:e,isDataset:t,onClose:n,canResetNode:s=!1,onResetNode:i})=>a.jsxs("div",{className:"canvas-modal__header",children:[a.jsxs("div",{className:"canvas-modal__title-group",children:[a.jsx(F1,{type:t?"dataset":"default"}),a.jsxs("div",{children:[a.jsx("h2",{className:"canvas-modal__title",id:"node-settings-title",children:e}),a.jsx("p",{className:"canvas-modal__subtitle",children:t?"Configure how this dataset feeds the pipeline.":"Adjust parameters to control this transformation."})]})]}),a.jsxs("div",{className:"canvas-modal__header-actions",children:[s&&i&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,children:"Reset node"}),a.jsx("button",{type:"button",className:"canvas-modal__close",onClick:n,"aria-label":"Close settings",children:""})]})]}),B1=({onClose:e,canResetNode:t,onResetNode:n,showSaveButton:s,canSave:i,onSave:l,isBusy:c,busyLabel:u})=>a.jsxs("div",{className:"canvas-modal__footer",children:[a.jsx("div",{className:"canvas-modal__footer-status",role:"status","aria-live":"polite","aria-busy":c,children:c&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-modal__footer-spinner","aria-hidden":"true"}),a.jsx("span",{children:u??"Processing"})]})}),a.jsxs("div",{className:"canvas-modal__footer-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:e,children:"Close"}),t&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary canvas-modal__reset",onClick:n,children:"Reset node"}),s&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:l,disabled:!i,children:"Save changes"})]})]}),zs=(e,t=0)=>e==null?"":new Intl.NumberFormat(void 0,{maximumFractionDigits:t}).format(e),Wn=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=t%1===0?0:1;return`${t.toFixed(n)}%`},js=e=>{if(e==null)return"";const t=Number(e);if(Number.isNaN(t))return"";const n=Math.abs(t)>=1?2:4;return zs(t,n)},Sy=e=>e==null||e===""?"":typeof e=="number"?js(e):String(e),U1=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"critical":t==="high"?"high":t==="medium"?"medium":null},q1=e=>{if(!e)return null;const t=e.toLowerCase();return t==="critical"?"Critical":t==="high"?"High":t==="medium"?"Medium":e.charAt(0).toUpperCase()+e.slice(1)},H1=5,V1=4,W1=3,K1="_binned",Ey="Missing",Y1=5,G1="ordinal",Q1="quantile",X1=[{value:"equal_width",label:"Equal-width",description:"Uniform bin widths based on min/max range."},{value:"equal_frequency",label:"Equal-frequency",description:"Quantile-based bins with similar row counts in each bucket."},{value:"custom",label:"Custom edges",description:"Provide explicit thresholds and optional labels per column."},{value:"kbins",label:"KBins (sklearn)",description:"Use sklearn KBinsDiscretizer with uniform, quantile, or k-means strategies."}],J1=[{value:"range",label:"Numeric interval (default)"},{value:"bin_index",label:"Index (bin_0, bin_1, )"},{value:"ordinal",label:"Ordinal (Bin 1, Bin 2, )"},{value:"column_suffix",label:"Column suffix (col_binned_1, )"}],xh={equal_width:"Equal-width",equal_frequency:"Equal-frequency",custom:"Custom edges",kbins:"KBins (sklearn)"},Z1=[{value:"keep",label:"Leave as missing"},{value:"label",label:"Replace with label"}],$l=[{value:"500",label:"500 rows (default)"},{value:"10000",label:"10000 rows (detailed)"},{value:"all",label:"Full dataset"}],ky=e=>{const t=typeof(e==null?void 0:e.strategy)=="string"?e.strategy.trim().toLowerCase():"",n=["equal_width","equal_frequency","custom","kbins"].includes(t)?t:"equal_width",s=We(e==null?void 0:e.columns),i=(D,q,Y,W)=>{const X=Number(D);if(!Number.isFinite(X))return q;const I=Math.round(X);return Math.max(Y,Math.min(W,I))},l=i(e==null?void 0:e.equal_width_bins,H1,2,200),c=i(e==null?void 0:e.equal_frequency_bins,V1,2,200),u=i(e==null?void 0:e.precision,W1,0,8),d=(e==null?void 0:e.duplicates)==="drop"?"drop":"raise",f=!!((e==null?void 0:e.include_lowest)??!0),h=!!((e==null?void 0:e.drop_original)??!1),g=(typeof(e==null?void 0:e.output_suffix)=="string"?e.output_suffix.trim():"")||K1,_=typeof(e==null?void 0:e.label_format)=="string"?e.label_format.trim().toLowerCase():"",N=["range","bin_index","ordinal","column_suffix"].includes(_)?_:"range",x=(typeof(e==null?void 0:e.missing_strategy)=="string"?e.missing_strategy.trim().toLowerCase():"")==="label"?"label":"keep",j=typeof(e==null?void 0:e.missing_label)=="string"?e.missing_label.trim():"",k=x==="label"&&j||Ey,S=i(e==null?void 0:e.kbins_n_bins,Y1,2,200),C=typeof(e==null?void 0:e.kbins_encode)=="string"?e.kbins_encode.trim().toLowerCase():"",w=["ordinal","onehot","onehot-dense"].includes(C)?C:G1,E=typeof(e==null?void 0:e.kbins_strategy)=="string"?e.kbins_strategy.trim().toLowerCase():"",A=["uniform","quantile","kmeans"].includes(E)?E:Q1,R=D=>{if(!Array.isArray(D))return[];const Y=D.map(W=>{if(typeof W=="number")return W;if(W==null)return Number.NaN;const X=String(W).trim();return X?Number(X):Number.NaN}).filter(W=>Number.isFinite(W)).sort((W,X)=>W-X).filter((W,X,I)=>X===0||W!==I[X-1]);return Y.length>=2?Y:[]},P=D=>Array.isArray(D)?D.map(q=>String(q).trim()).filter(Boolean):typeof D=="string"?D.split(/[\,\n]/).map(q=>q.trim()).filter(Boolean):[],T=(D,q,Y)=>{if(D==null)return null;const W=Number(D);if(!Number.isFinite(W))return null;const X=Math.round(W);return Math.max(q,Math.min(Y,X))},O={};e!=null&&e.custom_bins&&typeof e.custom_bins=="object"&&!Array.isArray(e.custom_bins)&&Object.entries(e.custom_bins).forEach(([D,q])=>{const Y=String(D??"").trim();if(!Y)return;const W=R(q);W.length>=2&&(O[Y]=W)});const F={};e!=null&&e.custom_labels&&typeof e.custom_labels=="object"&&!Array.isArray(e.custom_labels)&&Object.entries(e.custom_labels).forEach(([D,q])=>{const Y=String(D??"").trim();if(!Y)return;const W=P(q);W.length&&(F[Y]=W)});const B={},L=e!=null&&e.column_strategies&&typeof e.column_strategies=="object"&&!Array.isArray(e.column_strategies)?e.column_strategies:e!=null&&e.column_overrides&&typeof e.column_overrides=="object"&&!Array.isArray(e.column_overrides)?e.column_overrides:null;return L&&Object.entries(L).forEach(([D,q])=>{const Y=String(D??"").trim();if(!Y||!q||typeof q!="object"||Array.isArray(q))return;const W=q,X={},I=typeof W.strategy=="string"?W.strategy.trim().toLowerCase():"";["equal_width","equal_frequency","custom","kbins"].includes(I)&&(X.strategy=I);const z=T(W.equal_width_bins,2,200);z!==null&&(X.equalWidthBins=z);const H=T(W.equal_frequency_bins,2,200);H!==null&&(X.equalFrequencyBins=H);const te=T(W.kbins_n_bins,2,200);te!==null&&(X.kbinsNBins=te);const K=typeof W.kbins_encode=="string"?W.kbins_encode.trim().toLowerCase():"";["ordinal","onehot","onehot-dense"].includes(K)&&(X.kbinsEncode=K);const V=typeof W.kbins_strategy=="string"?W.kbins_strategy.trim().toLowerCase():"";["uniform","quantile","kmeans"].includes(V)&&(X.kbinsStrategy=V);const G=R(W.custom_bins);G.length>=2&&(X.customBins=G);const Q=P(W.custom_labels);Q.length>0&&(X.customLabels=Q),Object.keys(X).length>0&&(B[Y]=X)}),{strategy:n,columns:s,equalWidthBins:l,equalFrequencyBins:c,includeLowest:f,precision:u,duplicates:d,outputSuffix:g,dropOriginal:h,labelFormat:N,missingStrategy:x,missingLabel:k,customBins:O,customLabels:F,columnStrategies:B,kbinsNBins:S,kbinsEncode:w,kbinsStrategy:A}},eM=(e,t,n,s=xh)=>{if(!e.length)return null;const i=e.map(l=>{const c=t[l],u=(c==null?void 0:c.strategy)??null;if(!u)return l;const d=s[u]??u,f=[];u==="equal_width"&&(c!=null&&c.equalWidthBins)?f.push(`${c.equalWidthBins} bins`):u==="equal_frequency"&&(c!=null&&c.equalFrequencyBins)?f.push(`${c.equalFrequencyBins} bins`):u==="kbins"&&(c!=null&&c.kbinsNBins&&f.push(`${c.kbinsNBins} bins`),c!=null&&c.kbinsStrategy&&f.push(c.kbinsStrategy),c!=null&&c.kbinsEncode&&f.push(c.kbinsEncode));const h=f.length?` (${f.join(", ")})`:"";return`${l} -> ${d}${h}`});return n>e.length&&i.push(""),i.join(", ")},tM=({config:e,fieldIds:t,onIntegerChange:n,onBooleanToggle:s,onSuffixChange:i,onLabelFormatChange:l,onMissingStrategyChange:c,onMissingLabelChange:u})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Global output & labeling"}),a.jsx("p",{className:"canvas-modal__note",children:"Applies to every selected column unless custom bins or labels override the defaults."}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.suffix,className:"canvas-modal__parameter-label",children:"Output suffix"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.suffix,type:"text",className:"canvas-modal__input",value:e.outputSuffix,onChange:d=>i(d.target.value),placeholder:"e.g. _binned"})})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.labelFormat,className:"canvas-modal__parameter-label",children:"Label format"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("select",{id:t.labelFormat,value:e.labelFormat,onChange:d=>l(d.target.value??"range"),children:J1.map(d=>a.jsx("option",{value:d.value,children:d.label},d.value))})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Controls how new bin values are named when custom labels arent provided."})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.precision,className:"canvas-modal__parameter-label",children:"Decimal precision"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.precision,type:"number",className:"canvas-modal__input",min:0,max:8,step:1,value:e.precision,onChange:d=>n("precision",d.target.value,0,8)})}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Sets rounding precision for interval labels."})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.includeLowest,children:"Include lowest edge"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.includeLowest,type:"checkbox",checked:e.includeLowest,onChange:d=>s("include_lowest",d.target.checked)}),"Include the minimum value in the first bin"]})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:t.dropOriginal,children:"Drop original columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:t.dropOriginal,type:"checkbox",checked:e.dropOriginal,onChange:d=>s("drop_original",d.target.checked)}),"Remove source columns after binning"]})]})]})]}),a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Missing values"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"radiogroup","aria-label":"Missing value handling",children:Z1.map(d=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":e.missingStrategy===d.value,onClick:()=>c(d.value),children:d.label},d.value))}),e.missingStrategy==="label"&&a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:t.missingLabel,className:"canvas-modal__parameter-label",children:"Missing label"}),a.jsx("div",{className:"canvas-modal__parameter-control",children:a.jsx("input",{id:t.missingLabel,type:"text",className:"canvas-modal__input",value:e.missingLabel,onChange:d=>u(d.target.value),placeholder:"e.g. Missing"})})]})]})]}),My=e=>xh[e]??e.replace(/_/g," "),nM=e=>{switch(e){case"high":return"High confidence";case"medium":return"Medium confidence";case"low":return"Low confidence";default:return"Confidence unknown"}},sM=(e,t,n)=>{if(!e||typeof e!="object")return"No distribution summary";const s=[];typeof e.valid_count=="number"&&Number.isFinite(e.valid_count)&&s.push(`${t(e.valid_count)} valid rows`),typeof e.distinct_count=="number"&&Number.isFinite(e.distinct_count)&&s.push(`${t(e.distinct_count)} distinct values`);const i=typeof e.minimum=="number"&&Number.isFinite(e.minimum),l=typeof e.maximum=="number"&&Number.isFinite(e.maximum);if(i||l){const c=i?n(e.minimum):"",u=l?n(e.maximum):"";s.push(`Range ${c}  ${u}`)}return typeof e.skewness=="number"&&Number.isFinite(e.skewness)&&s.push(`Skew ${n(e.skewness)}`),s.length?s.join("  "):"No distribution summary"},rM=({hasSource:e,hasReachableSource:t,isFetching:n,error:s,relativeGeneratedAt:i,sampleSize:l,binningConfig:c,binningDefaultLabel:u,binningOverrideCount:d,binningOverrideSummary:f,recommendations:h,excludedColumns:p,numericColumnCount:g,canApplyAllNumeric:_,onApplyAllNumeric:N,onApplyStrategies:v,onClearOverrides:x,customEdgeDrafts:j,customLabelDrafts:k,onOverrideStrategyChange:S,onOverrideNumberChange:C,onOverrideKbinsEncodeChange:w,onOverrideKbinsStrategyChange:E,onOverrideClear:A,onCustomBinsChange:R,onCustomLabelsChange:P,onClearCustomColumn:T,formatMetricValue:O,formatNumericStat:F})=>{const B=y.useMemo(()=>e?t?n?"Diagnostics are loading":s?"Diagnostics are unavailable at the moment.":g>0?`Detected ${g} numeric column${g===1?"":"s"} in the current sample.`:p.length>0?`Diagnostics skipped ${p.length} column${p.length===1?"":"s"} (see details).`:"No additional diagnostics were produced for the current sample.":"Connect this step to an upstream output to surface diagnostics.":"Select a dataset to surface diagnostics.",[s,p.length,t,e,n,g]),L=y.useMemo(()=>{const I=p.slice(0,6),z=Math.max(0,p.length-I.length);return{preview:I,remaining:z}},[p]),D=y.useMemo(()=>{const I=new Map;return h.forEach(z=>{const H=typeof(z==null?void 0:z.column)=="string"?z.column.trim():"";H&&I.set(H,z)}),I},[h]),q=y.useMemo(()=>{const I=new Set;return c.columns.forEach(z=>{const H=String(z??"").trim();H&&I.add(H)}),Object.keys(c.columnStrategies).forEach(z=>{const H=String(z??"").trim();H&&I.add(H)}),h.forEach(z=>{const H=typeof(z==null?void 0:z.column)=="string"?z.column.trim():"";H&&I.add(H)}),Array.from(I).sort((z,H)=>z.localeCompare(H))},[c.columnStrategies,c.columns,h]),Y=(I,z)=>{var H;return!I||Object.keys(I).length===0?"__default__":I.strategy?I.strategy:(H=I.customBins)!=null&&H.length?"custom":I.kbinsNBins||I.kbinsEncode||I.kbinsStrategy?"kbins":I.equalFrequencyBins?"equal_frequency":I.equalWidthBins?"equal_width":z},W=e&&t,X=I=>{var H,te;if(!I)return[];const z=[];return typeof I.equalWidthBins=="number"&&z.push(`${I.equalWidthBins} bins`),typeof I.equalFrequencyBins=="number"&&z.push(`${I.equalFrequencyBins} bins`),typeof I.kbinsNBins=="number"&&z.push(`${I.kbinsNBins} bins`),I.kbinsStrategy&&z.push(I.kbinsStrategy),I.kbinsEncode&&z.push(I.kbinsEncode),(H=I.customBins)!=null&&H.length&&z.push("Custom bins"),(te=I.customLabels)!=null&&te.length&&z.push("Custom labels"),z};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binning diagnostics"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:x,disabled:!d,children:"Clear"}),v&&a.jsx("button",{type:"button",className:"btn btn-primary",onClick:v,disabled:!h.length,children:"Quick apply"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:B}),a.jsxs("p",{className:"canvas-modal__note",children:["Default strategy ",a.jsx("strong",{children:u}),d>0?`  Overrides: ${d}${f?` (${f})`:""}`:"  No column overrides yet"]}),a.jsxs("div",{className:"canvas-modal__collapsible",children:[!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface binning insights and column diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),W&&a.jsxs(a.Fragment,{children:[i&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",i,l!==null?` on ${O(l)} row${l===1?"":"s"}.`:"."]}),N&&g>0&&a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:N,disabled:!_,children:`Add all numeric columns (${g})`})}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binning diagnostics"}),s&&!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s}),!s&&a.jsxs(a.Fragment,{children:[q.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested strategy"}),a.jsx("th",{scope:"col",children:"Configured strategy"}),a.jsx("th",{scope:"col",children:"Distribution highlights"})]})}),a.jsx("tbody",{children:q.map(I=>{var _t,st,dt,jt,zt;const z=D.get(I)??null,H=c.columnStrategies[I],te=Y(H,c.strategy),K=te==="__default__"?c.strategy:te,V=(z==null?void 0:z.recommended_strategy)??null,G=!!(V&&V!==K),Q=!!(H&&Object.keys(H).length),ne=c.columns.includes(I),J=z==null?void 0:z.recommended_bins,re=typeof J=="number"?J:J!=null?Number(J):null,Se=typeof re=="number"&&Number.isFinite(re)&&re>0?re:null,Re=(H==null?void 0:H.equalWidthBins)??c.equalWidthBins,Oe=(H==null?void 0:H.equalFrequencyBins)??c.equalFrequencyBins,Fe=(H==null?void 0:H.kbinsNBins)??c.kbinsNBins,lt=(H==null?void 0:H.kbinsEncode)??"__default__",Be=(H==null?void 0:H.kbinsStrategy)??"__default__",de=["canvas-cast__row"];G&&de.push("canvas-cast__row--attention"),Q&&de.push("canvas-cast__row--override"),ne||de.push("canvas-cast__row--muted");const pe=sM(z==null?void 0:z.stats,O,F),xe=((_t=z==null?void 0:z.reasons)==null?void 0:_t.filter(Ge=>Ge&&Ge.trim()))??[],ke=(()=>{const Ge=X(H),Ft=Array.isArray(c.customBins[I])?c.customBins[I].length>=2:!1,Kt=Array.isArray(c.customLabels[I])?c.customLabels[I].length>0:!1,Mt=[...Ge];return Ft&&!Mt.includes("Custom bins")&&Mt.push("Custom bins"),Kt&&!Mt.includes("Custom labels")&&Mt.push("Custom labels"),Mt})(),Ue=te==="__default__"?`Inheriting ${u}`:`Override  ${My(K)}${ke.length?` (${ke.join(", ")})`:""}`,ce=(z==null?void 0:z.dtype)??null,Me=z?nM(z.confidence):null,Ye=Object.prototype.hasOwnProperty.call(j,I)?j[I]:((st=c.customBins[I])==null?void 0:st.join(", "))??"",at=Object.prototype.hasOwnProperty.call(k,I)?k[I]:((dt=c.customLabels[I])==null?void 0:dt.join(", "))??"",Ze=(((jt=c.customBins[I])==null?void 0:jt.length)??0)>=2||(((zt=c.customLabels[I])==null?void 0:zt.length)??0)>0;return a.jsxs("tr",{className:de.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:I}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[ce&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",ce]}),!ne&&a.jsx("span",{className:"canvas-cast__muted",children:"Not currently in node"}),Q&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),G&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--attention",children:"Needs review"})]})]})}),a.jsx("td",{children:a.jsx("div",{className:"canvas-cast__recommendation",children:z?a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"canvas-cast__chip canvas-cast__chip--applied",children:My(z.recommended_strategy)}),a.jsxs("span",{className:"canvas-cast__recommendation-note",children:[Se!==null?`${Se} bin${Se===1?"":"s"}`:"Bins not provided",Me?`  ${Me}`:""]}),xe.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:xe.join("; ")})]}):a.jsx("span",{className:"canvas-cast__muted",children:"No recommendation"})})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:te,onChange:Ge=>S(I,Ge.target.value,{recommendedBins:Se}),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",u,")"]}),X1.map(Ge=>a.jsx("option",{value:Ge.value,children:Ge.label},`${I}-${Ge.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:Ue}),te==="equal_width"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Re??"",onChange:Ge=>C(I,"equal_width_bins",Ge.target.value)})]})}),te==="equal_frequency"&&a.jsx("div",{className:"canvas-cast__target-note",children:a.jsxs("label",{children:["Integer bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Oe??"",onChange:Ge=>C(I,"equal_frequency_bins",Ge.target.value)})]})}),te==="kbins"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Max bins",a.jsx("input",{type:"number",min:2,max:200,className:"canvas-modal__input",value:Fe??"",onChange:Ge=>C(I,"kbins_n_bins",Ge.target.value)})]}),a.jsxs("label",{children:["Encode",a.jsxs("select",{value:lt,onChange:Ge=>w(I,Ge.target.value==="__default__"?null:Ge.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsEncode,")"]}),a.jsx("option",{value:"ordinal",children:"Ordinal"}),a.jsx("option",{value:"onehot",children:"One-hot (sparse)"}),a.jsx("option",{value:"onehot-dense",children:"One-hot (dense)"})]})]}),a.jsxs("label",{children:["Strategy",a.jsxs("select",{value:Be,onChange:Ge=>E(I,Ge.target.value==="__default__"?null:Ge.target.value),children:[a.jsxs("option",{value:"__default__",children:["Default (",c.kbinsStrategy,")"]}),a.jsx("option",{value:"uniform",children:"Uniform"}),a.jsx("option",{value:"quantile",children:"Quantile"}),a.jsx("option",{value:"kmeans",children:"K-means"})]})]})]}),te==="custom"&&a.jsxs("div",{className:"canvas-cast__target-note",children:[a.jsxs("label",{children:["Custom edges",a.jsx("input",{type:"text",className:"canvas-modal__input",value:Ye,placeholder:"e.g. 0, 50, 100",onChange:Ge=>R(I,Ge.target.value)})]}),a.jsxs("label",{children:["Optional labels",a.jsx("input",{type:"text",className:"canvas-modal__input",value:at,placeholder:"e.g. Low, Medium, High",onChange:Ge=>P(I,Ge.target.value)})]}),Ze&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>T(I),children:"Clear custom edges"})]}),Q&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:()=>A(I),children:"Clear"})]})}),a.jsx("td",{children:a.jsx("span",{children:pe})})]},`binning-insight-${I}`)})})]})})}),!n&&q.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"No columns met the sampling requirements for binning recommendations."}),p.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",p.length," column",p.length===1?"":"s"," due to non-numeric values or limited variance",L.preview.length>0&&a.jsxs(a.Fragment,{children:[":"," ",L.preview.map(I=>`${I.column}${I.reason?` (${I.reason})`:""}`).join(", "),L.remaining>0?`,  (+${L.remaining} more)`:""]}),"."]})]})]})]})]})},aM=({cards:e,selectedPreset:t,onSelectPreset:n,isFetching:s,sampleSize:i,relativeGeneratedAt:l,error:c,onRefresh:u,canRefresh:d})=>{const f=y.useMemo(()=>$l.find(h=>h.value===t)??$l[0],[t]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Binned column distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-sample__group",children:[a.jsx("span",{className:"canvas-sample__label",children:"Sample"}),a.jsx("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Binned sampling presets",children:$l.map(h=>a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":h.value===t,onClick:()=>n(h.value),disabled:s,children:h.label},h.value))})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:u,disabled:s||!d,children:s?"Refreshing":"Refresh"})]})]}),i!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Sampling preset: ",a.jsx("strong",{children:f.label}),"."," ",f.value==="all"?`Summaries computed from the full dataset (${i.toLocaleString()} rows).`:`Summaries computed from ${i.toLocaleString()} sampled rows.`]}),l&&a.jsxs("p",{className:"canvas-modal__note",children:["Updated ",l]}),s&&a.jsx("p",{className:"canvas-modal__note",children:"Loading binned distributions"}),!s&&c&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:c}),!s&&!c&&(e.length?a.jsx("div",{className:"canvas-binning__grid",children:e.map(h=>{const p=h.topPercentage!==null?`${h.topPercentage.toFixed(1)}%`:null,g=h.topCount!==null?`${h.topCount.toLocaleString()}${p?`  ${p}`:""}`:p??"";return a.jsxs("article",{className:"canvas-binning__card",children:[a.jsxs("header",{className:"canvas-binning__header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:h.column}),h.sourceColumn&&h.sourceColumn!==h.column&&a.jsxs("p",{className:"canvas-binning__subtitle",children:["Derived from ",a.jsx("strong",{children:h.sourceColumn})]})]}),a.jsxs("div",{className:"canvas-binning__summary","aria-label":"Top bin summary",children:[a.jsx("span",{className:"canvas-binning__summary-label",children:"Top bin"}),a.jsx("span",{className:"canvas-binning__summary-value",children:h.topLabel??""}),a.jsx("span",{className:"canvas-binning__summary-meta",children:g})]})]}),a.jsxs("div",{className:"canvas-binning__meta",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Sample size"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.totalRows.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Distinct bins"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.distinctBins.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-binning__meta-label",children:"Missing rows"}),a.jsx("span",{className:"canvas-binning__meta-value",children:h.missingRows.toLocaleString()})]})]}),a.jsx("div",{className:"canvas-binning__bins",children:h.bins.map(_=>{const N=_.isMissing?"canvas-binning__bin-label canvas-binning__bin-label--missing":"canvas-binning__bin-label",v=Math.min(100,Math.max(0,_.percentage));return a.jsxs("div",{className:"canvas-binning__bin-row",children:[a.jsx("div",{className:N,children:_.label}),a.jsx("div",{className:"canvas-binning__bin-bar","aria-hidden":"true",children:a.jsx("div",{className:"canvas-binning__bin-bar-fill",style:{width:`${v}%`}})}),a.jsxs("div",{className:"canvas-binning__bin-stats",children:[a.jsx("span",{children:_.count.toLocaleString()}),a.jsxs("span",{children:[_.percentage.toFixed(1),"%"]})]})]},`${h.column}-${_.label}`)})}),h.hasMoreBins&&a.jsxs("p",{className:"canvas-binning__note",children:["Showing top ",h.bins.length," of ",h.totalBinCount," bins."]})]},`binned-card-${h.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No binned columns detected upstream. Connect this node after a binning step to view category distributions."}))]})},oM=[{value:"mean",label:"Mean (numeric)"},{value:"median",label:"Median (numeric)"},{value:"mode",label:"Mode (most frequent)"}],iM=[{value:"knn",label:"K-Nearest Neighbors (KNN)"},{value:"regression",label:"Iterative regression"},{value:"mice",label:"MICE (multivariate)"}],lM=[...oM,...iM],cM=[0,5,10,20,40,60],uM=["float","double","int","uint","long","short","byte","number","decimal"],dM=["bool","boolean"],mM=["object","string","category","datetime","date","time"],hM=e=>{const t=typeof e.dtype=="string"?e.dtype.trim().toLowerCase():"";return typeof e.mean=="number"||typeof e.median=="number"||!t?!0:mM.some(n=>t.includes(n))?!1:!!(uM.some(n=>t.includes(n))||dM.some(n=>t.includes(n)))},Ay=e=>e!=="mode",Oy=e=>{if(e==="knn")return{neighbors:5};if(e==="regression"||e==="mice")return{max_iter:10}},Pl=(e,t)=>{if(e==="knn"){const n=t==null?void 0:t.neighbors,s=Number(n);return{neighbors:Number.isFinite(s)?Math.max(1,Math.round(s)):5}}if(e==="regression"||e==="mice"){const n=t==null?void 0:t.max_iter,s=Number(n);return{max_iter:Number.isFinite(s)?Math.max(1,Math.round(s)):10}}},Ty=(e,t)=>{if(!Array.isArray(e))return[];const n=t[0]??"mean",s=new Set(t);return e.map(i=>{if(!i||typeof i!="object")return null;const l=typeof i.method=="string"?i.method.trim().toLowerCase():n,c=s.has(l)?l:n;let u=[];Array.isArray(i.columns)?u=i.columns.map(p=>String(p).trim()).filter(Boolean):typeof i.columns=="string"&&(u=i.columns.split(",").map(p=>p.trim()).filter(Boolean));const d=i.options&&typeof i.options=="object"?i.options:{};let f;if(c==="knn"){const p=d.neighbors??i.neighbors,g=Number(p);f={neighbors:Number.isFinite(g)?Math.max(1,Math.round(g)):5}}else if(c==="regression"||c==="mice"){const p=d.max_iter??d.maxIter??i.max_iter??i.maxIter,g=Number(p);f={max_iter:Number.isFinite(g)?Math.max(1,Math.round(g)):10}}const h=Pl(c,f??Oy(c));return{method:c,columns:u,options:h}}).filter(i=>!!i)},fM=e=>e.map(t=>{const n={method:t.method,columns:t.columns};return t.options&&Object.keys(t.options).length&&(n.options={...t.options}),n}),pM=({hasSource:e,hasReachableSource:t,strategies:n,columnOptions:s,methodOptions:i,missingFilter:l,missingFilterMax:c,missingFilterActive:u,filteredOptionCount:d,collapsedStrategies:f,onToggleStrategy:h,onRemoveStrategy:p,onAddStrategy:g,onMethodChange:_,onOptionNumberChange:N,onColumnsChange:v,onColumnToggle:x,onMissingFilterChange:j,formatMissingPercentage:k,formatNumericStat:S,formatModeStat:C,schemaDiagnostics:w})=>{const E=ge.useMemo(()=>{var T;return(T=w==null?void 0:w.entries)!=null&&T.length?new Map(w.entries.map(O=>[O.index,O])):new Map},[w]),A=Math.max(c,l||0),R=s.length>0,P=T=>{var F,B,L;const O=((F=i.find(D=>D.value===T.method))==null?void 0:F.label)??T.method;return T.method==="knn"&&((B=T.options)!=null&&B.neighbors)?`${O}  k=${T.options.neighbors}`:(T.method==="regression"||T.method==="mice")&&((L=T.options)!=null&&L.max_iter)?`${O}  ${T.options.max_iter} iter`:O};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Imputation strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface missingness insights and recommended columns."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to load missingness insights."}),(w==null?void 0:w.blocked)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:w.message}),s.length>0&&a.jsxs("div",{className:"canvas-imputer__filter",role:"group","aria-label":"Filter columns by missing percentage",children:[a.jsxs("div",{className:"canvas-imputer__filter-top",children:[a.jsx("label",{htmlFor:"imputer-missing-filter",children:"Minimum missing percentage"}),a.jsxs("span",{className:"canvas-imputer__filter-summary",children:["Showing ",d," of ",s.length," column",s.length===1?"":"s"]})]}),a.jsxs("div",{className:"canvas-imputer__filter-controls",children:[a.jsx("input",{id:"imputer-missing-filter",type:"range",min:0,max:A,step:1,value:l,onChange:T=>j(Number(T.target.value)),className:"canvas-imputer__filter-range"}),a.jsxs("span",{className:"canvas-imputer__filter-value",children:["",a.jsxs("strong",{children:[l,"%"]})," missing"]}),a.jsx("button",{type:"button",className:"canvas-imputer__filter-reset",onClick:()=>j(0),disabled:!l,children:"Clear"})]}),a.jsx("div",{className:"canvas-imputer__filter-presets",children:cM.map(T=>a.jsxs("button",{type:"button",className:`canvas-imputer__filter-button${l===T?" canvas-imputer__filter-button--active":""}`,onClick:()=>j(T),children:["",T,"%"]},`imputer-missing-preset-${T}`))})]}),n.length?a.jsx("div",{className:"canvas-imputer__list",children:n.map((T,O)=>{var H,te,K;const F=T.columns.join(", "),B=Ay(T.method),L=s.filter(V=>{if(T.columns.includes(V.name))return!0;if(B&&!hM(V))return!1;const G=typeof V.missingPercentage=="number"?V.missingPercentage:null;return G!==null?G<=0?!1:G>=l:l===0}),D=P(T),q=T.columns.length?`${T.columns.length} column${T.columns.length===1?"":"s"}`:"No columns yet",Y=f.has(O),W=L.filter(V=>!T.columns.includes(V.name)),X=E.get(O),I=(H=X==null?void 0:X.details)!=null&&H.length?X.details.map(V=>V.logical_family?`${V.name} (${V.logical_family})`:V.name).join(", "):"",z=()=>{if(!L.length)return;const V=[...T.columns];L.forEach(G=>{V.includes(G.name)||V.push(G.name)}),v(O,V.join(", "))};return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(O),"aria-expanded":!Y,"aria-controls":`imputer-strategy-body-${O}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${Y?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",O+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[D,"  ",q]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>p(O),"aria-label":`Remove strategy ${O+1}`,children:"Remove"})]}),!Y&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`imputer-strategy-body-${O}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Method"}),a.jsx("select",{value:T.method,onChange:V=>_(O,V.target.value??"mean"),children:i.map(V=>a.jsx("option",{value:V.value,children:V.label},V.value))})]}),T.method==="knn"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Neighbors (k)"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:50,step:1,value:((te=T.options)==null?void 0:te.neighbors)??5,onChange:V=>N(O,"neighbors",V.target.value)})]}),(T.method==="regression"||T.method==="mice")&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Max iterations"}),a.jsx("input",{type:"number",className:"canvas-imputer__columns-input",min:1,max:100,step:1,value:((K=T.options)==null?void 0:K.max_iter)??10,onChange:V=>N(O,"max_iter",V.target.value)})]}),T.method==="mice"&&a.jsx("p",{className:"canvas-modal__note",children:"MICE performs chained regressions with posterior sampling for robust imputations."}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),I&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Remove or recast columns before applying this strategy: ",I,"."]}),L.length>0&&W.length>0&&a.jsx("button",{type:"button",className:"btn btn-link",onClick:z,children:"Select all columns"}),L.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Columns eligible for imputation",children:L.map(V=>{const G=T.columns.includes(V.name),Q=k(V.missingPercentage),ne=typeof V.mean=="number",J=typeof V.median=="number",re=V.mode!==null&&V.mode!==void 0&&V.mode!=="",Se=ne||J||re;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${G?" canvas-imputer__column-pill--selected":""}`,onClick:()=>x(O,V.name),"aria-pressed":G,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:V.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[a.jsxs("span",{className:"canvas-imputer__column-pill-metric",children:["Missing: ",Q]}),V.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:V.dtype})]}),Se&&a.jsxs("div",{className:"canvas-imputer__column-pill-stats",children:[ne&&a.jsxs("span",{children:["Mean: ",S(V.mean)]}),J&&a.jsxs("span",{children:["Median: ",S(V.median)]}),re&&a.jsxs("span",{children:["Mode: ",C(V.mode)]})]})]},V.name)})}):a.jsx("p",{className:"canvas-modal__note",children:R?u?"No columns meet the current missingness filter. Lower the threshold or add manual columns below.":"No columns with missing values detected. Add columns manually or adjust upstream steps.":"Column catalog unavailable; enter names manually below."})]}),a.jsx("div",{className:`canvas-imputer__selected${T.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:T.columns.length?T.columns.map(V=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:V},V)):a.jsx("span",{children:"No columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Manual columns (optional)"}),a.jsx("input",{type:"text",className:"canvas-imputer__columns-input",value:F,onChange:V=>v(O,V.target.value),placeholder:"Add custom columns, separated by commas","aria-label":"Manual column entry"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap columns above to toggle them. Missing % reflects the latest row-level preview, and manual entry lets you include custom fields."})]})]},`imputer-strategy-${O}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Define one or more strategies to fill missing values. Each strategy targets a set of columns and a method."})]})},gM=({sourceId:e,hasReachableSource:t,isFetchingScaling:n,scalingConfig:s,scalingMethodOptions:i,scalingMethodDetailMap:l,scalingDefaultDetail:c,scalingAutoDetectEnabled:u,scalingSelectedCount:d,scalingDefaultLabel:f,scalingOverrideCount:h,scalingOverrideExampleSummary:p,scalingRecommendationRows:g,scalingHasRecommendations:_,scalingStatusMessage:N,scalingError:v,scalingSampleSize:x,relativeScalingGeneratedAt:j,formatMetricValue:k,formatNumericStat:S,formatMissingPercentage:C,onApplyAllRecommendations:w,onClearOverrides:E,onDefaultMethodChange:A,onAutoDetectToggle:R,onOverrideSelect:P})=>{const T=c??l.get(s.defaultMethod)??null;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Scaling insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:w,disabled:!_,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:E,disabled:!h,children:"Clear overrides"})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Automatically select scaling strategies for numeric features to keep model inputs in comparable ranges. Edits here refresh the preview immediately so you can inspect the effect, but nothing is committed to your pipeline until you click ",a.jsx("strong",{children:"Save changes"})," at the bottom of this modal."]}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface scaling insights and column recommendations."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric feature distributions."}),j&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",j,x!==null?` on ${k(x)} row${x===1?"":"s"}.`:"."]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default scaling method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default scaling method",children:i.map(O=>{const F=l.get(O.value)??null,B=O.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${B?" canvas-scaling__method-button--active":""}`,"aria-pressed":B,onClick:()=>A(O.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:O.label}),(F==null?void 0:F.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:F.description})]},O.value)})}),(T==null?void 0:T.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:T.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:O=>R(O.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"When enabled, recommended numeric features join this node automatically after each refresh."})]})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s"," in this node  Default method"," ",a.jsx("strong",{children:f})," ",u?" Auto-detect on":" Auto-detect off",h>0?`  Overrides: ${h}${p?` (${p})`:""}`:"  No column overrides yet"]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading scaling diagnostics"}),!n&&v&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:v}),!n&&!v&&a.jsxs(a.Fragment,{children:[N&&a.jsx("p",{className:"canvas-modal__note",children:N}),g.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:g.map(O=>{const F=!O.isSkipped&&O.recommendedMethod!==O.currentMethod,B=["canvas-cast__row"];F&&B.push("canvas-cast__row--attention"),O.isOverrideApplied&&B.push("canvas-cast__row--override"),O.isSkipped&&B.push("canvas-cast__row--muted");const L=O.isSkipped?"__skip__":O.isOverrideApplied?O.currentMethod:"__default__",D=O.isOverrideApplied?`Override -> ${O.currentMethodLabel}`:O.isSkipped?"Skipped (column will not be scaled)":O.isSelected?`Inheriting ${f}`:"Pending inclusion",q=O.stats,Y=[];typeof q.valid_count=="number"&&Number.isFinite(q.valid_count)&&Y.push(`${k(q.valid_count)} valid rows`),typeof q.mean=="number"&&Number.isFinite(q.mean)&&Y.push(`Mean ${S(q.mean)}`),typeof q.median=="number"&&Number.isFinite(q.median)&&Y.push(`Median ${S(q.median)}`),typeof q.stddev=="number"&&Number.isFinite(q.stddev)&&Y.push(` ${S(q.stddev)}`),typeof q.iqr=="number"&&Number.isFinite(q.iqr)&&Y.push(`IQR ${S(q.iqr)}`);const W=typeof q.minimum=="number"&&Number.isFinite(q.minimum),X=typeof q.maximum=="number"&&Number.isFinite(q.maximum);if(W||X){const z=W?S(q.minimum):"",H=X?S(q.maximum):"";Y.push(`Range ${z}  ${H}`)}typeof q.skewness=="number"&&Number.isFinite(q.skewness)&&Y.push(`Skew ${S(q.skewness)}`),typeof q.outlier_ratio=="number"&&Number.isFinite(q.outlier_ratio)&&q.outlier_ratio>0&&Y.push(`${C(q.outlier_ratio*100)} outliers`);const I=Y.length?Y.join("  "):null;return a.jsxs("tr",{className:B.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:O.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[O.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",O.dtype]}),O.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from scaling (non-numeric)"}),O.isSelected&&!O.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),O.isSkipped&&!O.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),O.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[a.jsx("span",{className:`canvas-cast__chip${F?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:O.recommendedLabel}),a.jsx("span",{className:"canvas-cast__recommendation-note",children:O.confidenceLabel}),O.reasons.length>0&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:O.reasons.join("; ")})]})}),a.jsx("td",{children:I?a.jsx("span",{children:I}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:L,onChange:z=>P(O.column,z.target.value),children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",f,")"]}),a.jsx("option",{value:"__skip__",children:"Skip scaling for this column"}),i.map(z=>a.jsx("option",{value:z.value,children:z.label},`${O.column}-${z.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:D})]})})]},`scaling-row-${O.column}`)})})]})})})]})]})},wu=["log","square_root","cube_root","reciprocal","square","exponential","box_cox","yeo_johnson"],_M="log",Ur=e=>typeof e=="string"&&wu.includes(e),$y=e=>Array.isArray(e)?e.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"",s=typeof t.method=="string"?t.method.trim():"";if(!n)return null;const i=Ur(s)?s:_M;return{column:n,method:i}}).filter(t=>!!t):[],wh=e=>{const t=new Set,n=[];return e.forEach(s=>{const i=`${s.column}__${s.method}`;t.has(i)||(t.add(i),n.push(s))}),n},Py={left:"Left skew",right:"Right skew"},vM={log:"Logarithmic",square_root:"Square Root",cube_root:"Cube Root",reciprocal:"Reciprocal (Inverse)",square:"Square",exponential:"Exponential",box_cox:"BoxCox",yeo_johnson:"YeoJohnson"},yM=e=>{const t={...vM};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():"",i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";!s||!i||Ur(s)&&(t[s]=i)}),t},bM=({viewMode:e,recommendations:t,columnOptions:n,recommendationMap:s,transformationMap:i})=>{const l=e==="recommended"?t.map(d=>d!=null&&d.column?d.column:null).filter(d=>!!d):n,c=new Set,u=[];return l.forEach(d=>{const f=typeof d=="string"?d.trim():"";if(!f||c.has(f))return;c.add(f);const h=s.get(f)??null,p=h?h.recommended_methods.filter(Ur):[],g=p.length?p[0]:null,_=h!=null&&h.direction?Py[h.direction]??h.direction:null,N=h!=null&&h.magnitude?`${h.magnitude.charAt(0).toUpperCase()}${h.magnitude.slice(1)}`:null,v=h&&typeof h.skewness=="number"&&Number.isFinite(h.skewness)?h.skewness:null,x=(h==null?void 0:h.summary)??null,j=i.get(f)??null;u.push({column:f,recommendedMethods:p,primaryMethod:g,directionLabel:_,magnitudeLabel:N,skewnessValue:v,summary:x,selectedMethod:j})}),u.sort((d,f)=>{const h=typeof d.skewnessValue=="number"?Math.abs(d.skewnessValue):-1/0,p=typeof f.skewnessValue=="number"?Math.abs(f.skewnessValue):-1/0;if(h!==p)return p-h;const g=!!d.primaryMethod,_=!!f.primaryMethod;return g!==_?g?-1:1:d.column.localeCompare(f.column)}),u},xM=(e,t,n)=>{if(!t)return[{key:"all",label:null,method:null,rows:e}];const s="no-recommendation",i=new Map;e.forEach(c=>{const u=c.primaryMethod??null,d=u??s,f=u?n(u):"No recommended action",h=i.get(d)??{key:d,label:f,method:u,rows:[]};h.rows.push(c),i.set(d,h)});const l=Array.from(i.values());return l.sort((c,u)=>{const d=g=>g?wu.indexOf(g):wu.length,f=d(c.method)-d(u.method);if(f!==0)return f;if(c.rows.length!==u.rows.length)return u.rows.length-c.rows.length;const h=c.label??"",p=u.label??"";return h.localeCompare(p)}),l},wM=({sourceId:e,hasReachableSource:t,isFetchingSkewness:n,skewnessThreshold:s,skewnessError:i,skewnessViewMode:l,skewnessRecommendedCount:c,skewnessNumericCount:u,skewnessGroupByMethod:d,skewnessRows:f,skewnessTableGroups:h,hasSkewnessAutoRecommendations:p,skewnessTransformationsCount:g,isFetchingRecommendations:_,getSkewnessMethodLabel:N,getSkewnessMethodStatus:v,onApplyRecommendations:x,onViewModeChange:j,onGroupByToggle:k,onOverrideChange:S,onClearSelections:C})=>a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness insights"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:x,disabled:_||!p,children:"Apply recommendations"})})]}),s!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",s.toFixed(2)," are surfaced below."]}),n&&f.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness diagnostics"}),!n&&i&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:i}),(!n||f.length>0)&&!i&&a.jsxs("div",{className:"canvas-skewness__body",children:[a.jsxs("div",{className:"canvas-skewness__toolbar",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Skewness view",children:[a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="recommended",onClick:()=>j("recommended"),disabled:!c,children:["Recommended (",c,")"]}),a.jsxs("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":l==="all",onClick:()=>j("all"),disabled:!u,children:["All numeric (",u,")"]})]}),a.jsxs("label",{className:"canvas-skewness__toggle",children:[a.jsx("input",{type:"checkbox",checked:d,onChange:w=>k(w.target.checked)}),"Group columns by recommended action"]})]}),f.length===0?a.jsx("p",{className:"canvas-modal__note",children:l==="recommended"?"No columns met the skewness threshold for recommendations. Switch to All numeric to configure overrides manually.":"No numeric columns available for skewness review."}):a.jsx("div",{className:"canvas-skewness__table-wrapper",children:h.map(w=>a.jsxs("div",{className:"canvas-skewness__group",children:[w.label&&a.jsxs("div",{className:"canvas-skewness__group-header",children:[a.jsx("h4",{children:w.label}),a.jsxs("span",{children:[w.rows.length," column",w.rows.length===1?"":"s"]})]}),a.jsx("div",{className:"canvas-skewness__table-scroll",children:a.jsxs("table",{className:"canvas-skewness__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Suggested transform"}),a.jsx("th",{scope:"col",children:"Skewness level"}),a.jsx("th",{scope:"col",children:"Override"})]})}),a.jsx("tbody",{children:w.rows.map(E=>{const A=[];E.directionLabel&&A.push(E.directionLabel),E.skewnessValue!==null&&A.push(`(${E.skewnessValue.toFixed(2)})`),E.magnitudeLabel&&A.push(` ${E.magnitudeLabel}`);const R=A.length?A.join(" "):"",P=E.selectedMethod??"",T=new Set(E.recommendedMethods),O=[{value:"",label:"No transform",status:null,reason:null}];E.recommendedMethods.forEach(L=>{const D=v(E.column,L);O.push({value:L,label:`${N(L)}${L===E.primaryMethod?" (recommended)":""}`,status:D,reason:(D==null?void 0:D.reason)??null})}),wu.forEach(L=>{if(T.has(L))return;const D=v(E.column,L);O.push({value:L,label:N(L),status:D,reason:(D==null?void 0:D.reason)??null})});const F=E.selectedMethod?v(E.column,E.selectedMethod):null,B=!E.selectedMethod&&E.primaryMethod?v(E.column,E.primaryMethod):null;return a.jsxs("tr",{className:`canvas-skewness__row${E.selectedMethod?" canvas-skewness__row--active":""}`,children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-skewness__column-cell",children:[a.jsx("span",{className:"canvas-skewness__column-name",children:E.column}),E.summary&&a.jsx("span",{className:"canvas-skewness__column-summary",children:E.summary})]})}),a.jsx("td",{children:E.recommendedMethods.length?a.jsx("span",{className:`canvas-skewness__chip${E.primaryMethod?" canvas-skewness__chip--recommended":""}`,children:E.primaryMethod?N(E.primaryMethod):N(E.recommendedMethods[0])}):a.jsx("span",{className:"canvas-skewness__muted",children:"No recommendation"})}),a.jsx("td",{children:a.jsx("span",{className:"canvas-skewness__metric",children:R})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-skewness__override",children:[a.jsx("select",{value:P,onChange:L=>S(E.column,L.target.value),disabled:_||!t,children:O.map(L=>{var Y;const D=L.reason?`${L.label} (caution: ${L.reason})`:L.label,q=((Y=L.status)==null?void 0:Y.status)??"ready";return a.jsx("option",{value:L.value,"data-status":q,children:D},`skewness-option-${E.column}-${L.value||"none"}`)})}),F&&F.status!=="ready"&&F.reason&&a.jsxs("span",{className:"canvas-skewness__status canvas-skewness__status--error",children:["Selected transform may be incompatible: ",F.reason]}),!E.selectedMethod&&B&&B.status!=="ready"&&B.reason&&a.jsxs("span",{className:"canvas-skewness__status",children:["Recommended transform flagged: ",B.reason]})]})})]},`skewness-row-${E.column}`)})})]})})]},`skewness-group-${w.key}`))}),a.jsxs("div",{className:"canvas-skewness__footer",children:[a.jsx("span",{children:g?`${g} transformation${g===1?"":"s"} configured`:"No transformations configured yet."}),g>0&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:C,children:"Clear selections"})]})]})]}),NM=({counts:e,binEdges:t,className:n})=>{const s=y.useId(),i=n??"canvas-skewness__histogram";if(!e||e.length===0||!t||t.length!==e.length+1)return a.jsx("div",{className:i,"aria-hidden":"true"});const l=e.reduce((d,f)=>Math.max(d,f),0),c=l>0?l:1,u=100/e.length;return a.jsx("div",{className:i,role:"img","aria-label":"Histogram sparkline",children:a.jsxs("svg",{viewBox:"0 0 100 60",children:[a.jsx("line",{x1:"0",y1:"58",x2:"100",y2:"58",stroke:"rgba(148, 163, 184, 0.35)",strokeWidth:"0.75"}),e.map((d,f)=>{const h=d/c*52,p=f*u,g=58-h,_=Math.max(u-2,1);return a.jsx("rect",{x:p+1,y:g,width:_,height:h,rx:1.2,ry:1.2,fill:`url(#${s})`},`hist-bin-${f}`)}),a.jsx("defs",{children:a.jsxs("linearGradient",{id:s,x1:"0",x2:"0",y1:"0",y2:"1",children:[a.jsx("stop",{offset:"0%",stopColor:"rgba(165, 180, 252, 0.95)"}),a.jsx("stop",{offset:"100%",stopColor:"rgba(129, 140, 248, 0.35)"})]})})]})})},jM=({skewnessThreshold:e,isFetchingSkewness:t,skewnessError:n,skewnessDistributionCards:s,skewnessDistributionView:i,setSkewnessDistributionView:l,onRefresh:c,canRefresh:u})=>{const d=(f,h,p)=>{const g=Math.max(0,f.sample_size||0),_=Math.max(0,f.missing_count||0);return a.jsxs("div",{className:"canvas-skewness__distribution-block",children:[a.jsxs("div",{className:"canvas-skewness__distribution-block-title",children:[a.jsx("span",{children:h}),p?a.jsx("span",{className:"canvas-skewness__distribution-block-method",children:p}):null]}),a.jsx(NM,{counts:f.counts,binEdges:f.bin_edges,className:"canvas-skewness__histogram"}),a.jsxs("div",{className:"canvas-skewness__distribution-stats",children:[a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Min"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:js(f.minimum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Median"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:js(f.median)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Max"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:js(f.maximum)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Mean"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:js(f.mean)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Std dev"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:js(f.stddev)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Valid"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:g.toLocaleString()})]}),a.jsxs("div",{children:[a.jsx("span",{className:"canvas-skewness__stat-label",children:"Missing"}),a.jsx("span",{className:"canvas-skewness__stat-value",children:_.toLocaleString()})]})]})]},h)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Skewness distributions"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsxs("div",{className:"canvas-skewness__segmented",role:"group","aria-label":"Distribution view",children:[a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="before",onClick:()=>l("before"),disabled:!s.length,children:"Before"}),a.jsx("button",{type:"button",className:"canvas-skewness__segmented-button","data-active":i==="after",onClick:()=>l("after"),disabled:!s.length,children:"After"})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:c,disabled:t||!u,children:t?"Refreshing":"Refresh"})]})]}),e!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with |skewness|  ",e.toFixed(2)," are visualized below."]}),t&&s.length===0&&a.jsx("p",{className:"canvas-modal__note",children:"Loading skewness distributions"}),!t&&n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n}),(!t||s.length>0)&&!n&&(s.length?a.jsx("div",{className:"canvas-skewness__distribution-grid",children:s.map(f=>{const h=f.distributionAfter,p=i==="before",g=i==="after"&&!!h,_=i==="after"&&!h,N=i==="before"?"Showing the original distribution returned by the skewness analysis.":h?"Showing the recomputed distribution after the applied transform.":"A transformed distribution is not available yet for this column.";return a.jsxs("article",{className:"canvas-skewness__distribution-card","aria-label":`Distribution for ${f.column}`,children:[a.jsxs("header",{className:"canvas-skewness__distribution-header",children:[a.jsxs("div",{children:[a.jsx("h4",{children:f.column}),a.jsxs("div",{className:"canvas-skewness__distribution-tags",children:[f.directionLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:f.directionLabel}),f.magnitudeLabel&&a.jsx("span",{className:"canvas-skewness__chip canvas-skewness__chip--muted",children:f.magnitudeLabel}),f.recommendedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--recommended",children:["Suggested: ",f.recommendedLabel]}),f.appliedLabel&&a.jsxs("span",{className:"canvas-skewness__chip canvas-skewness__chip--applied",children:["Applied: ",f.appliedLabel]})]})]}),a.jsxs("div",{className:"canvas-skewness__distribution-skew",children:[a.jsx("span",{children:"Skewness"}),a.jsx("strong",{children:f.skewness!==null?zs(f.skewness,2):""})]})]}),f.summary&&a.jsx("p",{className:"canvas-skewness__distribution-summary",children:f.summary}),a.jsxs("div",{className:"canvas-skewness__distribution-comparison",children:[p?d(f.distributionBefore,"Before transform"):null,g&&h?d(h,"After transform",f.appliedLabel):null,_?a.jsx("div",{className:"canvas-skewness__distribution-empty",children:"After transform data isnt available yet. Apply a skewness method and rerun the node to generate this view."}):null]}),a.jsxs("footer",{className:"canvas-skewness__distribution-footnote",children:["Histogram bins are based on the sampled rows returned by the skewness analysis. ",N]})]},`skewness-dist-${f.column}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"No columns met the skewness threshold for visualization. Refresh with a larger sample if needed."}))]})},CM=({suffix:e,insights:t,formatMissingPercentage:n})=>{const{rows:s,flaggedColumnsInDataset:i,conflictCount:l}=t,c=s.length>0,u=e||"(no suffix)",d=i.slice(0,4),f=Math.max(i.length-d.length,0);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator summary"})}),a.jsxs("p",{className:"canvas-modal__note",children:["Generates ",a.jsx("strong",{children:s.length})," flag column",s.length===1?"":"s"," using suffix"," ",a.jsx("strong",{children:u}),"."]}),i.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Detected ",i.length," existing flag column",i.length===1?"":"s"," ","with this suffix",d.length>0?` (examples: ${d.join(", ")}${f>0?", ":""})`:"","."]}),l>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l," generated flag column",l===1?" has":"s have"," naming conflicts. Adjust the suffix or remove conflicting columns."]}),c?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Missing %"}),a.jsx("th",{scope:"col",children:"Flag column"}),a.jsx("th",{scope:"col",children:"Status"})]})}),a.jsx("tbody",{children:s.map(h=>{const p=[];h.conflicts.alreadyExists&&p.push("Already exists"),h.conflicts.duplicateFlag&&p.push("Duplicate name");const g=p.length>0,_=g?p.join("  "):"Ready",N=g?"canvas-cast__chip canvas-cast__chip--attention":"canvas-cast__chip canvas-cast__chip--applied",v=g?"canvas-cast__row canvas-cast__row--attention":"canvas-cast__row";return a.jsxs("tr",{className:v,children:[a.jsx("th",{scope:"row",children:h.column}),a.jsx("td",{children:n(h.missingPercentage)}),a.jsx("td",{children:h.flagColumn}),a.jsx("td",{children:a.jsx("span",{className:N,children:_})})]},`missing-indicator-${h.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Select columns below to create missing-value flags."})]})},Ry=["canonicalize_country_codes","normalize_boolean","punctuation","custom"],Nh="canonicalize_country_codes",SM=new Set(Ry),EM=["string","object","text","category","mixed","varchar","char"],kM=4,MM=6,wo=4,AM=3,Ly=36,OM=5,jh={canonicalize_country_codes:{label:"Country aliases",guidance:'Maps abbreviations such as "UK" or "UAE" to canonical country names.',examples:["UK => United Kingdom","UAE => United Arab Emirates"]},normalize_boolean:{label:"Boolean tokens",guidance:"Standardizes yes/no style values so downstream logic sees consistent tokens.",examples:["y => Yes","0 => No"]},punctuation:{label:"Punctuation cleanup",guidance:"Strips punctuation and squeezes whitespace to simplify fuzzy matching.",examples:["C.R.M. => CRM","Part - Time => Part Time"]},custom:{label:"Custom mappings",guidance:"Applies the alias pairs you provide. Each entry should follow alias => replacement.",examples:["st => Street","rd => Road"]}},zy=Ry.map(e=>{var t;return{value:e,label:((t=jh[e])==null?void 0:t.label)??e}}),TM=new Set(["true","1","yes","y","on"]),$M=new Set(["false","0","no","n","off"]),PM=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:t:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(TM.has(n))return!0;if($M.has(n))return!1}return t},Ch=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Ch(e.split(",")):[],Dy=(e,t)=>{if(!e||typeof e!="object")return null;const n=e,s=Ch(n.columns),i=PM(n.auto_detect??n.autoDetect??n.auto,t.autoDetect),l=ju(typeof n.mode=="string"?n.mode:void 0,t.mode);return!s.length&&!i?null:{mode:l,columns:s,autoDetect:i}},Fy=(e,t)=>{const n={mode:t.mode,columns:Ch(t.columns),autoDetect:!!t.autoDetect};if(!e)return!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n];if(!Array.isArray(e)){const i=Dy(e,n);return i?[i]:[n]}const s=[];return e.forEach(i=>{const l=Dy(i,n);l&&s.push(l)}),s.length===0?(!n.columns.length&&!n.autoDetect&&(n.autoDetect=!0),[n]):s},RM=e=>e.map(t=>({mode:t.mode,columns:[...t.columns],auto_detect:!!t.autoDetect})),LM=e=>e.replace(/[\s\W_]+/g,"").toLowerCase(),Nu=e=>e.length<=Ly?e:`${e.slice(0,Ly-1)}...`,Iy=e=>SM.has(e),By=e=>{if(!e)return!1;const t=e.toLowerCase();return EM.some(n=>t.includes(n))},ju=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Iy(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Iy(s)?s:Nh},zM=e=>{const t=jh[e]??jh[Nh];return{mode:e,label:t.label,guidance:t.guidance,examples:t.examples}},DM=({selectedColumns:e,availableColumns:t,columnTypeMap:n,autoDetectEnabled:s})=>{const i=Array.from(new Set(We(e))),l=new Set(i),c=t.filter(h=>By(n[h]??null)),u=c.filter(h=>!l.has(h)),d=i.filter(h=>!By(n[h]??null)),f=typeof s=="boolean"?s:i.length===0;return{selectedColumns:i,nonTextSelected:d,autoDetectionActive:f,recommendedColumns:u,textColumnCount:c.length,textColumns:c}},FM=/[\n;,]+/,Ni=(e,t)=>e.slice(0,t),Cu=(e,t)=>{const n=e.split(t);if(n.length<2)return null;const[s,...i]=n,l=i.join(t);return[s,l]},IM=e=>{if(!e)return{totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0};const t=new Set,n=[],s=[],i=new Map;let l=0;const c=(h,p)=>{const g=String(h??"").trim(),_=String(p??"").trim();if(!g||!_){(g||_)&&n.push(`${g} => ${_}`.trim());return}const N=LM(g);if(!N){n.push(`${g} => ${_}`);return}i.has(N)?t.add(g):(i.set(N,_),s.length<kM&&s.push(`${g} => ${_}`)),l+=1};if(typeof e=="string"){e.split(FM).forEach(N=>{const v=N.trim();if(v){if(v.includes("=>")){const x=Cu(v,"=>");x?c(x[0],x[1]):n.push(v);return}if(v.includes(":")){const x=Cu(v,":");x?c(x[0],x[1]):n.push(v);return}n.push(v)}});const p=Array.from(t),g=Ni(p,wo),_=Ni(n,wo);return{totalPairs:l,previewPairs:s,previewOverflow:Math.max(l-s.length,0),duplicates:g,duplicateOverflow:Math.max(p.length-g.length,0),invalidEntries:_,invalidOverflow:Math.max(n.length-_.length,0)}}if(Array.isArray(e)){e.forEach(_=>{if(_){if(typeof _=="string"){const N=_.trim();if(!N)return;if(N.includes("=>")){const v=Cu(N,"=>");v?c(v[0],v[1]):n.push(N)}else if(N.includes(":")){const v=Cu(N,":");v?c(v[0],v[1]):n.push(N)}else n.push(N);return}if(typeof _=="object"){const{alias:N,replacement:v}=_;c(N,v);return}n.push(String(_))}});const h=Array.from(t),p=Ni(h,wo),g=Ni(n,wo);return{totalPairs:l,previewPairs:s,previewOverflow:Math.max(l-s.length,0),duplicates:p,duplicateOverflow:Math.max(h.length-p.length,0),invalidEntries:g,invalidOverflow:Math.max(n.length-g.length,0)}}typeof e=="object"&&Object.entries(e).forEach(([h,p])=>{c(h,p)});const u=Array.from(t),d=Ni(u,wo),f=Ni(n,wo);return{totalPairs:l,previewPairs:s,previewOverflow:Math.max(l-s.length,0),duplicates:d,duplicateOverflow:Math.max(u.length-d.length,0),invalidEntries:f,invalidOverflow:Math.max(n.length-f.length,0)}},BM=e=>{const t=e.slice(0,MM);return{preview:t,remaining:Math.max(e.length-t.length,0)}},UM=e=>{const t=e.slice(0,wo);return{preview:t,remaining:Math.max(e.length-t.length,0)}},qM=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Nu(String(e)):null;if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string"){const t=e.trim();return t?Nu(t):null}try{const t=JSON.stringify(e);return t?Nu(t):null}catch{return Nu(String(e))}},HM=(e,t=AM)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;const u=qM(l);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},VM=(e,t,n=OM)=>{if(!t.length)return[];const s=[];for(const i of t){if(s.length>=n)break;const l=e[i];!l||!l.length||s.push({column:i,values:l,overflow:0})}return s},Sh=e=>e.replace(/[^0-9a-zA-Z]+/g,"").toLowerCase(),Uy=[["UK","United Kingdom"],["UAE","United Arab Emirates"],["USA","United States"],["PRC","China"],["KSA","Saudi Arabia"],["Brasil","Brazil"]],qy=new Set(["us","usa","unitedstates","unitedstatesofamerica","uk","unitedkingdom","greatbritain","england","uae","unitedarabemirates","prc","china","southkorea","republicofkorea","ksa","saudiarabia","brasil","brazil","de","germany","fr","france","es","spain","ca","canada","mx","mexico","country","state","province"]);Uy.forEach(e=>{e.forEach(t=>qy.add(Sh(t)))});const Hy=[["Y","Yes"],["1","Yes"],["ON","Yes"],["N","No"],["0","No"],["OFF","No"]],Vy=new Set(["yes","y","true","t","1","on","enable","enabled","no","n","false","f","0","off","disable","disabled","active","inactive","flag"]);Hy.forEach(e=>{e.forEach(t=>Vy.add(Sh(t)))});const WM=[["C.R.M.","CRM"],["Part - Time","Part Time"],["end-to-end","end to end"]],KM=/^[A-Za-z]{2,3}$/,YM=/[^0-9A-Za-z\s]/,GM=/[^0-9A-Za-z]+/,Su={canonicalize_country_codes:{title:"Country alias map",description:"Common country abbreviations resolve to canonical names or ISO codes.",preview:Uy},normalize_boolean:{title:"Boolean token map",description:"Typical yes / no style values are standardized.",preview:Hy},punctuation:{title:"Punctuation cleanup",description:"Removes punctuation and condenses whitespace for easier matching.",preview:WM},custom:{title:"Custom mappings",description:"Define your own alias => replacement pairs below."}},QM=e=>{const t=[];return e.forEach(n=>{n.split(GM).filter(Boolean).forEach(i=>{t.push(i)})}),t},XM=(e,t)=>{if(!t.length)return!1;if(e==="punctuation")return t.some(s=>YM.test(s));const n=QM(t).map(s=>Sh(s));return n.length?e==="canonicalize_country_codes"?n.some(s=>qy.has(s))||t.some(s=>KM.test(s.trim())):e==="normalize_boolean"?n.some(s=>Vy.has(s)):!1:!1},Wy=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} ...`:t.join(", ")},JM=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:i,sampleMap:l,modeOptions:c=zy,customPairSummary:u,customPairsParameter:d,collapsedStrategies:f,onToggleStrategy:h,onRemoveStrategy:p,onAddStrategy:g,onModeChange:_,onAutoDetectToggle:N,onColumnToggle:v,onColumnsChange:x,renderParameterField:j})=>{const k=n.length>0,S=s.selectedColumns.length,C=y.useMemo(()=>BM(s.recommendedColumns),[s.recommendedColumns]),w=y.useMemo(()=>UM(s.nonTextSelected),[s.nonTextSelected]),E=y.useMemo(()=>VM(l,s.selectedColumns),[s.selectedColumns,l]),A=!e||!t,R=u.duplicates.length+u.duplicateOverflow,P=u.invalidEntries.length+u.invalidOverflow,T=u.duplicates.join(", "),O=u.invalidEntries.join(", "),F=y.useMemo(()=>n.some(K=>K.mode==="custom"),[n]),B=y.useMemo(()=>{const K=new Map;return n.forEach(V=>{V.columns.forEach(G=>{const Q=G.trim();Q&&K.set(Q,(K.get(Q)??0)+1)})}),K},[n]),[L,D]=y.useState(()=>new Set),q=y.useCallback(K=>{D(V=>{const G=new Set(V);return G.has(K)?G.delete(K):G.add(K),G})},[]);y.useEffect(()=>{D(K=>{const V=new Set;return K.forEach(G=>{G<n.length&&V.add(G)}),V.size===K.size?K:V})},[n.length]);const[Y,W]=y.useState(()=>({index:null,mode:null})),X=y.useMemo(()=>{const K=new Map;return i.forEach(V=>{const G=Array.isArray(V.samples)?V.samples:[],Q=Array.isArray(l[V.name])?l[V.name]:[],ne=[...G,...Q].map(J=>String(J??"").trim()).filter(J=>J.length>0);K.set(V.name,ne.slice(0,12))}),K},[i,l]),I=y.useMemo(()=>{const K=new Map;return i.forEach(V=>{const G=X.get(V.name)??[],Q=G.length?G:[V.name];["canonicalize_country_codes","normalize_boolean","punctuation"].forEach(ne=>{XM(ne,Q)&&(K.has(ne)||K.set(ne,new Set),K.get(ne).add(V.name))})}),K},[i,X]);y.useEffect(()=>{if(Y.index===null)return;const K=n[Y.index];(!K||K.mode!==Y.mode)&&W({index:null,mode:null})},[Y.index,Y.mode,n]);const z=y.useCallback((K,V)=>{W({index:K,mode:V})},[]),H=y.useCallback(()=>{W({index:null,mode:null})},[]);let te=!1;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Alias cleanup strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:g,children:"Add strategy"})})]}),s.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is enabled; any remaining text-like columns will be swept into the strategies when this node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:S})," column",S===1?"":"s"," across all strategies."]}),E.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",E.map(K=>`${K.column} (${K.values.join(", ")})`).join("; "),"."]}),s.textColumnCount>0&&C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",C.preview.join(", "),C.remaining>0?`, ... (${C.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[w.preview.join(", ")," ",w.preview.length===1?"is":"are"," not text-like.",w.remaining>0?` ${w.remaining} more column${w.remaining===1?" is":"s are"} also non-text.`:" Remove them or double-check the data."]}),A?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to inspect available columns."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to load available columns for alias cleanup."}):null,!k&&a.jsx("p",{className:"canvas-modal__note",children:"No strategies configured yet. Combine presets (countries, booleans, punctuation) or add custom maps to standardize aliases."}),k&&a.jsx("div",{className:"canvas-imputer__list",children:n.map((K,V)=>{var Ue;const G=zM(K.mode),Q=((Ue=c.find(ce=>ce.value===K.mode))==null?void 0:Ue.label)??G.label,ne=K.columns.length,J=ne?`${ne} column${ne===1?"":"s"}`:K.autoDetect?"Auto-detecting columns":"No columns yet",re=f.has(V),Se=L.has(V),Re=K.columns.join(", "),Oe=I.get(K.mode)??new Set,Fe=K.mode==="custom"&&!!d&&!te,lt=K.mode==="custom"&&!!d&&te;Fe&&(te=!0);const Be=i.map(ce=>{const Me=K.columns.includes(ce.name),Ye=Oe.has(ce.name),at=Me?0:Ye?1:ce.isRecommended?2:ce.isTextLike?3:4;return{option:ce,priority:at}}).sort((ce,Me)=>ce.priority!==Me.priority?ce.priority-Me.priority:ce.option.name.localeCompare(Me.option.name)).map(ce=>ce.option),de=Oe.size>0,pe=Be.filter(ce=>K.columns.includes(ce.name)?!0:de?Oe.has(ce.name):ce.isRecommended||ce.isTextLike),xe=new Set(pe.map(ce=>ce.name)),ke=Be.filter(ce=>!xe.has(ce.name));return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>h(V),"aria-expanded":!re,"aria-controls":`alias-strategy-body-${V}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${re?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",V+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[Q,K.autoDetect?"  auto-detect":"",J?`  ${J}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>p(V),"aria-label":`Remove alias strategy ${V+1}`,children:"Remove"})]}),!re&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`alias-strategy-body-${V}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Replacement strategy"}),a.jsxs("div",{className:"canvas-imputer__mode-toggle",role:"radiogroup","aria-label":"Alias replacement strategy",children:[c.map(ce=>{const Me=ce.value===K.mode;return a.jsx("button",{type:"button",className:`btn btn-outline-secondary canvas-imputer__mode-button${Me?" canvas-imputer__mode-button--active active":""}`,role:"radio","aria-checked":Me,onClick:()=>_(V,ce.value),children:ce.label},ce.value)}),a.jsx("button",{type:"button",className:"btn btn-link canvas-imputer__mode-info",onClick:()=>z(V,K.mode),children:"View examples"})]}),a.jsx("p",{className:"canvas-modal__meta",children:G.guidance})]}),Y.index===V&&Y.mode===K.mode&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--info",children:[a.jsxs("div",{children:[a.jsx("strong",{children:Su[K.mode].title}),a.jsx("button",{type:"button",className:"btn btn-link",onClick:H,children:"Close"})]}),a.jsx("p",{children:Su[K.mode].description}),Su[K.mode].preview&&a.jsx("ul",{children:Su[K.mode].preview.map(([ce,Me])=>a.jsxs("li",{children:[ce," ",a.jsx("span",{"aria-hidden":"true",children:"->"})," ",Me]},`${ce}-${Me}`))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${V}-auto-detect`,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`alias-strategy-${V}-auto-detect`,type:"checkbox",checked:K.autoDetect,onChange:ce=>N(V,ce.target.checked)}),a.jsx("label",{htmlFor:`alias-strategy-${V}-auto-detect`,children:"Auto-detect additional text columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Detected text-like columns not assigned elsewhere will be appended to this strategy."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),i.length?a.jsxs(a.Fragment,{children:[Oe.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Highlighting columns that resemble ",Q.toLowerCase()," entries."]}),pe.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Columns assigned to alias strategy ${V+1}`,children:pe.map(ce=>{const Me=K.columns.includes(ce.name),Ye=Wy(ce.samples.length?ce.samples:l[ce.name]??[]),Ze=(B.get(ce.name)??0)-(Me?1:0)>0,_t=Oe.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Me?" canvas-imputer__column-pill--selected":""}`,onClick:()=>v(V,ce.name),"aria-pressed":Me,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),ce.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),_t&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),Ze&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Ye&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Ye]})]},ce.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),ke.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>q(V),"aria-expanded":Se,"aria-controls":`alias-strategy-${V}-other-columns`,children:Se?"Hide other columns":`Show other columns (${ke.length})`}),Se&&a.jsx("div",{id:`alias-strategy-${V}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":`Other available columns for alias strategy ${V+1}`,children:ke.map(ce=>{const Me=K.columns.includes(ce.name),Ye=Wy(ce.samples.length?ce.samples:l[ce.name]??[]),Ze=(B.get(ce.name)??0)-(Me?1:0)>0,_t=Oe.has(ce.name);return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${Me?" canvas-imputer__column-pill--selected":""}`,onClick:()=>v(V,ce.name),"aria-pressed":Me,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:ce.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[ce.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:ce.dtype}),!ce.isTextLike&&a.jsx("span",{className:"canvas-modal__meta",children:"Non-text"}),_t&&a.jsx("span",{className:"canvas-modal__meta",children:"Likely match"}),Ze&&a.jsx("span",{className:"canvas-modal__meta",children:"Used elsewhere"})]}),Ye&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",Ye]})]},ce.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${K.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:K.columns.length?K.columns.map(ce=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:ce},ce)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`alias-strategy-${V}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`alias-strategy-${V}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:Re,onChange:ce=>x(V,ce.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."}),K.mode==="custom"&&d&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Custom pairs"}),a.jsx("p",{className:"canvas-modal__meta",children:"Enter one alias => replacement per line. These mappings apply to every custom strategy in this node."}),a.jsx("div",{className:"canvas-modal__parameter-list",children:Fe?j(d):lt?a.jsx("p",{className:"canvas-modal__note",children:"Edit the custom pairs above to update this strategy."}):null})]})]})]},`alias-strategy-${V}`)})}),u.totalPairs>0&&a.jsxs("p",{className:"canvas-modal__note",children:[u.totalPairs," custom pair",u.totalPairs===1?"":"s"," captured.",F?" They will be applied during execution.":" Switch a strategy to Custom mappings to apply them.",u.previewPairs.length>0?` Examples: ${u.previewPairs.join("; ")}${u.previewOverflow>0?"...":""}`:""]}),u.totalPairs===0&&F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"At least one strategy is set to Custom mappings, but no valid alias pairs were detected."}),R>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Duplicate alias entries",T?`: ${T}`:"",u.duplicateOverflow>0?"...":"",". Only the first entry for each alias will be used."]}),P>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Ignored ",P," incomplete pair",P===1?"":"s",".",O?` Examples: ${O}${u.invalidOverflow>0?"...":""}`:""]})]})},Eu=["iso_date","iso_datetime","month_day_year","day_month_year"],ZM="iso_date",eA=["date","time","timestamp","datetime"],tA=3,Ky=36,Rl={iso_date:{label:"ISO date",guidance:"Formats values as YYYY-MM-DD. Ideal for analytics layers expecting canonical dates.",example:"2024-03-19"},iso_datetime:{label:"ISO datetime",guidance:"Preserves date and time with second precision (YYYY-MM-DD HH:MM:SS).",example:"2024-03-19 14:05:42"},month_day_year:{label:"MM/DD/YYYY",guidance:"Aligns with US-style date formats. Use when downstream tooling expects month/day ordering.",example:"03/19/2024"},day_month_year:{label:"DD/MM/YYYY",guidance:"Suitable for EU-style day-first formats.",example:"19/03/2024"}},Eh=Eu.map(e=>({value:e,label:Rl[e].label,guidance:Rl[e].guidance,example:Rl[e].example})),nA=[/^\d{4}[-\/]\d{1,2}[-\/]\d{1,2}/,/^\d{1,2}[-\/]\d{1,2}[-\/]\d{2,4}/,/^[A-Za-z]{3,9}\s+\d{1,2},\s*\d{2,4}/,/^\d{1,2}\s+[A-Za-z]{3,9}\s+\d{2,4}/,/^\d{4}\d{2}\d{2}$/],Yy=e=>e.length<=Ky?e:`${e.slice(0,Ky-1)}...`,Gy=e=>{if(!e)return!1;const t=e.toLowerCase();return eA.some(n=>t.includes(n))},sA=e=>nA.some(t=>t.test(e)),Qy=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Eu.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Eu.includes(s)?s:ZM},rA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s||!s.length)return;const i=s.length;let l=0;if(s.forEach(u=>{sA(u)&&(l+=1)}),!i)return;l/i>=.6&&l>=2&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},aA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(We(e)));i.sort((g,_)=>g.localeCompare(_));const l=new Set(i),c=t.filter(g=>Gy(n[g]??null)),u=rA(s),d=new Set;c.forEach(g=>{l.has(g)||d.add(g)}),u.forEach(g=>{l.has(g)||d.add(g)});const f=Array.from(d);f.sort((g,_)=>g.localeCompare(_));const h=i.filter(g=>!(Gy(n[g]??null)||u.includes(g))),p=u.slice().sort((g,_)=>g.localeCompare(_));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:f,nonDateSelected:h,dateColumnCount:c.length,sampleCandidateCount:u.length,sampleCandidates:p}},oA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";return n&&Eu.includes(n)?n:t},iA=e=>{if(typeof e=="boolean")return e;if(typeof e=="string"){const t=e.trim().toLowerCase();if(t==="true"||t==="1"||t==="yes")return!0;if(t==="false"||t==="0"||t==="no")return!1}return typeof e=="number"?e!==0:!1},Xy=(e,t)=>{if(!Array.isArray(e))return t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[];const n=new Set,s=e.map(i=>{if(!i||typeof i!="object")return null;const l=We(i.columns),c=Array.from(new Set(l.map(h=>h.trim()).filter(Boolean))).sort((h,p)=>h.localeCompare(p)),u=oA(i.mode,t.mode),d=iA(i.auto_detect??i.autoDetect??i.auto),f=`${u}|${c.join(",")}|${d?"auto":"manual"}`;return n.has(f)?null:(n.add(f),{mode:u,columns:c,autoDetect:d})}).filter(i=>!!i);return s.length?s:t.columns.length||t.autoDetect?[{mode:t.mode,columns:[...t.columns],autoDetect:t.autoDetect}]:[]},lA=e=>e.map(t=>{const n={mode:t.mode,columns:[...t.columns]};return t.autoDetect&&(n.auto_detect=!0),n}),cA=e=>{var t;return((t=Rl[e])==null?void 0:t.label)??Rl.iso_date.label},uA=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?Yy(String(e)):null;if(typeof e=="boolean")return e?"True":"False";const t=String(e).trim();return t?Yy(t):null},dA=(e,t=tA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;const u=uA(l);if(!u)return;const d=n[c]??[];d.includes(u)||d.length>=t||(n[c]=[...d,u])})}),n},mA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonDateSelected:[],dateColumnCount:0,sampleCandidateCount:0,sampleCandidates:[]},Jy=e=>{if(!e.length)return null;const t=e.slice(0,3);return e.length-t.length>0?`${t.join(", ")} `:t.join(", ")},hA=({hasSource:e,hasReachableSource:t,strategies:n,columnSummary:s,columnOptions:i,sampleMap:l,collapsedStrategies:c,onToggleStrategy:u,onRemoveStrategy:d,onAddStrategy:f,onModeChange:h,onColumnToggle:p,onColumnsChange:g,onAutoDetectToggle:_,modeOptions:N=Eh})=>{const v=n.length>0,x=y.useMemo(()=>n.some(R=>R.autoDetect),[n]),[j,k]=y.useState(()=>new Set),S=y.useCallback(R=>{k(P=>{const T=new Set(P);return T.has(R)?T.delete(R):T.add(R),T})},[]);y.useEffect(()=>{k(R=>{const P=new Set;return R.forEach(T=>{T<n.length&&P.add(T)}),P.size===R.size?R:P})},[n.length]);const C=y.useMemo(()=>{const R=new Map;return n.forEach(P=>{P.columns.forEach(T=>{const O=T.trim();O&&R.set(O,(R.get(O)??0)+1)})}),R},[n]),w=y.useMemo(()=>{const R=s.recommendedColumns.slice(0,6),P=Math.max(s.recommendedColumns.length-R.length,0);return{preview:R,remaining:P}},[s.recommendedColumns]),E=y.useMemo(()=>{const R=s.nonDateSelected.slice(0,4),P=Math.max(s.nonDateSelected.length-R.length,0);return{preview:R,remaining:P}},[s.nonDateSelected]),A=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Date formatting strategies"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:f,children:"Add strategy"})})]}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:e?"Connect this step to an upstream output to explore detected date columns.":"Select a dataset to load column samples and suggestions."}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Suggested columns: ",w.preview.join(", "),w.remaining>0?`,  (${w.remaining} more)`:"",".",x?" Auto-detect strategies will automatically include remaining date-like columns.":""]}),s.sampleCandidates.length===0&&!w.preview.length&&a.jsx("p",{className:"canvas-modal__note",children:"No clear date candidates yet. Add columns manually or enable auto-detect to sweep for timestamps."}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"looks":"look"," non-date-like.",E.remaining>0?` ${E.remaining} more selected column${E.remaining===1?"":"s"} may require double-checking.`:" Double-check that these values represent consistent dates."]}),x&&a.jsxs("p",{className:"canvas-modal__note",children:["Auto-detect gathers from ",s.sampleCandidateCount||s.dateColumnCount," date-like columns that are not already assigned."]}),v?a.jsx("div",{className:"canvas-imputer__list",children:n.map((R,P)=>{var H,te;const T=((H=N.find(K=>K.value===R.mode))==null?void 0:H.label)??cA(R.mode),O=R.columns.length,F=O?`${O} column${O===1?"":"s"}`:R.autoDetect?"Auto-detecting columns":"No columns yet",B=c.has(P),L=R.columns.join(", "),D=`date-strategy-${P}-toggle`,q=`date-strategy-${P}-auto-detect`,Y=i.map(K=>({option:K,priority:K.isRecommended?0:K.isSampleCandidate?1:2})).sort((K,V)=>K.priority!==V.priority?K.priority-V.priority:K.option.name.localeCompare(V.option.name)).map(K=>K.option),W=Y.filter(K=>R.columns.includes(K.name)?!0:K.isRecommended||K.isSampleCandidate),X=new Set(W.map(K=>K.name)),I=Y.filter(K=>!X.has(K.name)),z=j.has(P);return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:D,className:"canvas-imputer__card-toggle",onClick:()=>u(P),"aria-expanded":!B,"aria-controls":`date-strategy-body-${P}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${B?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Strategy ",P+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[T,R.autoDetect?"  auto-detect":"",F?`  ${F}`:""]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(P),"aria-label":`Remove date formatting strategy ${P+1}`,children:"Remove"})]}),!B&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`date-strategy-body-${P}`,children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${P}-mode`,children:"Format"}),a.jsx("select",{id:`date-strategy-${P}-mode`,value:R.mode,onChange:K=>h(P,K.target.value),children:N.map(K=>a.jsx("option",{value:K.value,children:K.label},K.value))}),a.jsxs("p",{className:"canvas-modal__meta",children:["Example: ",((te=N.find(K=>K.value===R.mode))==null?void 0:te.example)??"2024-01-23"]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:q,children:"Detection"}),a.jsxs("div",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:q,type:"checkbox",checked:R.autoDetect,onChange:K=>_(P,K.target.checked)}),a.jsx("label",{htmlFor:q,children:"Auto-detect additional date columns"})]}),a.jsx("p",{className:"canvas-modal__note",children:"We will append detected date-like fields that are not assigned to other strategies."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{children:"Columns"}),Y.length?a.jsxs(a.Fragment,{children:[W.length?a.jsx("div",{className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Detected or selected columns for date formatting",children:W.map(K=>{const V=R.columns.includes(K.name),G=Jy(K.samples.length?K.samples:l[K.name]??[]),ne=(C.get(K.name)??0)-(V?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${V?" canvas-imputer__column-pill--selected":""}`,onClick:()=>p(P,K.name),"aria-pressed":V,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:K.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[K.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:K.dtype}),K.isRecommended&&a.jsx("span",{className:"canvas-modal__meta",children:"Suggested"}),!K.isRecommended&&K.isSampleCandidate&&a.jsx("span",{className:"canvas-modal__meta",children:"Detected"}),ne&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),G&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",G]})]},K.name)})}):a.jsx("p",{className:"canvas-modal__note",children:"No detected or selected columns yet. Expand other columns below to assign manually."}),I.length>0&&a.jsxs("div",{className:"canvas-imputer__more-columns",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>S(P),"aria-expanded":z,"aria-controls":`date-strategy-${P}-other-columns`,children:z?"Hide other columns":`Show other columns (${I.length})`}),z&&a.jsx("div",{id:`date-strategy-${P}-other-columns`,className:"canvas-imputer__columns-list",role:"listbox","aria-label":"Other available columns for date formatting",children:I.map(K=>{const V=R.columns.includes(K.name),G=Jy(K.samples.length?K.samples:l[K.name]??[]),ne=(C.get(K.name)??0)-(V?1:0)>0;return a.jsxs("button",{type:"button",className:`canvas-imputer__column-pill${V?" canvas-imputer__column-pill--selected":""}`,onClick:()=>p(P,K.name),"aria-pressed":V,children:[a.jsx("span",{className:"canvas-imputer__column-pill-name",children:K.name}),a.jsxs("div",{className:"canvas-imputer__column-pill-meta",children:[K.dtype&&a.jsx("span",{className:"canvas-imputer__column-pill-dtype",children:K.dtype}),ne&&a.jsx("span",{className:"canvas-modal__meta",children:"Used in another strategy"})]}),G&&a.jsxs("span",{className:"canvas-modal__meta",children:["e.g. ",G]})]},K.name)})})]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No catalogued columns yet. Add column names manually below or enable auto-detect to populate this list."})]}),a.jsx("div",{className:`canvas-imputer__selected${R.columns.length?"":" canvas-imputer__selected--empty"}`,"aria-live":"polite",children:R.columns.length?R.columns.map(K=>a.jsx("span",{className:"canvas-imputer__selected-chip",children:K},K)):a.jsx("span",{children:"No manual columns selected yet."})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`date-strategy-${P}-manual-columns`,children:"Manual columns (optional)"}),a.jsx("input",{id:`date-strategy-${P}-manual-columns`,type:"text",className:"canvas-imputer__columns-input",value:L,onChange:K=>g(P,K.target.value),placeholder:"Add custom columns, separated by commas"})]}),a.jsx("p",{className:"canvas-modal__note",children:"Tap suggestions to toggle columns. Manual entries let you set custom fields that are not listed above."})]})]},`date-strategy-${P}`)})}):a.jsx("p",{className:"canvas-modal__note",children:"Add a strategy to standardize one or more columns. You can combine manual selection with auto-detect for any remaining date-like fields."})]})},Zy=["both","leading","trailing"],eb="both",fA=["string","object","text","category","mixed","varchar","char"],pA=3,tb=36,nb=6,gA=4,_A=5,sb={both:{label:"Trim both sides",guidance:"Removes whitespace on the left and right side of values. Safe default for messy strings.",example:"' ACME '  'ACME'"},leading:{label:"Trim leading whitespace",guidance:"Strips whitespace at the beginning of values while preserving trailing spacing.",example:"' 123 Main'  '123 Main'"},trailing:{label:"Trim trailing whitespace",guidance:"Removes whitespace at the end of values while keeping leading spacing intact.",example:"'Suite B  '  'Suite B'"}},vA=e=>e.length<=tb?e:`${e.slice(0,tb-1)}...`,rb=e=>{if(!e)return!1;const t=e.toLowerCase();return fA.some(n=>t.includes(n))},yA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${vA(t)}'`},bA=e=>e.length?!!(e.trim()!==e||e.includes("  ")||e.includes(`
`)||e.includes("	")||e.includes("\r")):!1,xA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&Zy.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&Zy.includes(s)?s:eb},wA=e=>{const t=sb[e]??sb[eb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},NA=e=>{const t=[];return Object.entries(e).forEach(([n,s])=>{if(!s.length)return;const i=s.reduce((c,u)=>u.hasIssue?c+1:c,0);if(!i)return;const l=i/s.length;(i>=2||l>=.5)&&t.push(n)}),t.sort((n,s)=>n.localeCompare(s)),t},jA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(We(e)));i.sort((p,g)=>p.localeCompare(g));const l=new Set(i),c=t.filter(p=>rb(n[p]??null)),u=NA(s),d=new Set;c.forEach(p=>{l.has(p)||d.add(p)}),u.forEach(p=>{l.has(p)||d.add(p)});const f=Array.from(d).sort((p,g)=>p.localeCompare(g)),h=i.filter(p=>!rb(n[p]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:f,nonTextSelected:h,textColumnCount:c.length,whitespaceCandidateCount:u.length,whitespaceCandidates:u}},kh=(e,t)=>e.slice(0,t),CA=e=>{const t=kh(e,nb);return{preview:t,remaining:Math.max(e.length-t.length,0)}},SA=e=>{const t=kh(e,gA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},EA=e=>{const t=kh(e,nb);return{preview:t,remaining:Math.max(e.length-t.length,0)}},kA=(e,t=pA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=bA(u),f=yA(u),h=n[c]??[];h.find(p=>p.value===f)||h.length>=t||(n[c]=[...h,{value:f,hasIssue:d}])})}),n},MA=(e,t,n=_A)=>{if(!t.length)return[];const s=[];for(const i of t){if(s.length>=n)break;const l=e[i];!l||!l.length||s.push({column:i,values:l.map(c=>c.value),overflow:0})}return s},AA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,whitespaceCandidateCount:0,whitespaceCandidates:[]},OA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:i,renderParameterField:l,columnSummary:c,modeDetails:u,sampleMap:d})=>{if(!n&&!s)return null;const f=c.selectedColumns.length,h=CA(c.recommendedColumns),p=SA(c.nonTextSelected),g=EA(c.whitespaceCandidates),_=MA(d,c.selectedColumns),N=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Whitespace trimming"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:f})," column",f===1?"":"s"," for trimming."]}),_.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",_.map(v=>`${v.column} (${v.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with leading/trailing whitespace detected: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),h.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",h.preview.join(", "),h.remaining>0?`, ... (${h.remaining} more)`:"","."]}),p.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[p.preview.join(", ")," ",p.preview.length===1?"is":"are"," not text-like.",p.remaining>0?` ${p.remaining} more column${p.remaining===1?" is":"s are"} also non-text.`:" Consider removing them or confirming whitespace cleanup is intentional."]}),N?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples for trimming opportunities."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to trim"}),i(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:l(s)})]})},ab=["keep_alphanumeric","keep_alphanumeric_space","letters_only","digits_only"],ob="keep_alphanumeric",TA=["string","object","text","category","mixed","varchar","char"],$A=3,ib=36,PA=6,RA=4,LA=5,lb={keep_alphanumeric:{label:"Letters & digits",guidance:"Removes punctuation and symbols, leaving only letters and numbers.",example:"ACME-Co.  ACMEC o"},keep_alphanumeric_space:{label:"Letters, digits & spaces",guidance:"Strips punctuation while preserving spaces for readability.",example:"ACME-Co.  ACME Co"},letters_only:{label:"Letters only",guidance:"Keeps alphabetic characters and removes digits, punctuation, and symbols.",example:"R2-D2  RD"},digits_only:{label:"Digits only",guidance:"Preserves numbers while removing letters, punctuation, and symbols.",example:"Order #123A  123"}},zA=e=>e.length<=ib?e:`${e.slice(0,ib-1)}...`,DA=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${zA(t)}'`},cb=e=>{if(!e)return!1;const t=e.toLowerCase();return TA.some(n=>t.includes(n))},FA=e=>/[^0-9A-Za-z\s]/.test(e),IA=e=>/[A-Za-z]/.test(e),BA=e=>/[0-9]/.test(e),UA=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&ab.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&ab.includes(s)?s:ob},qA=e=>{const t=lb[e]??lb[ob];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},HA=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([u,d])=>{if(!d.length)return;let f=0,h=0,p=0;d.forEach(g=>{g.hasSpecial&&(f+=1),g.hasDigits&&(h+=1),g.hasLetters&&(p+=1)}),f>0&&t.add(u),h>0&&p===0&&n.add(u),p>0&&h===0&&s.add(u)});const i=Array.from(t).sort((u,d)=>u.localeCompare(d)),l=Array.from(n).sort((u,d)=>u.localeCompare(d)),c=Array.from(s).sort((u,d)=>u.localeCompare(d));return{specialCandidates:i,digitsOnlyCandidates:l,lettersOnlyCandidates:c}},VA=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(We(e)));i.sort((_,N)=>_.localeCompare(N));const l=new Set(i),c=t.filter(_=>cb(n[_]??null)),{specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:f}=HA(s),h=new Set;c.forEach(_=>{l.has(_)||h.add(_)}),u.forEach(_=>{l.has(_)||h.add(_)});const p=Array.from(h).sort((_,N)=>_.localeCompare(N)),g=i.filter(_=>!cb(n[_]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:p,nonTextSelected:g,textColumnCount:c.length,specialCandidateCount:u.length,specialCandidates:u,digitsOnlyCandidates:d,lettersOnlyCandidates:f}},ub=(e,t)=>e.slice(0,t),WA=e=>{const t=ub(e,PA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},ku=e=>{const t=ub(e,RA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},KA=(e,t=$A)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=DA(u),f=FA(u),h={value:d,hasSpecial:f,hasDigits:BA(u),hasLetters:IA(u)},p=n[c]??[];p.find(g=>g.value===d)||p.length>=t||(n[c]=[...p,h])})}),n},YA=(e,t,n=LA)=>{if(!t.length)return[];const s=[];for(const i of t){if(s.length>=n)break;const l=e[i];!l||!l.length||s.push({column:i,values:l.map(c=>c.value),overflow:0})}return s},GA={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,specialCandidateCount:0,specialCandidates:[],digitsOnlyCandidates:[],lettersOnlyCandidates:[]},QA=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,replacementParameter:i,renderMultiSelectField:l,renderParameterField:c,columnSummary:u,modeDetails:d,sampleMap:f})=>{if(!n&&!s&&!i)return null;const h=u.selectedColumns.length,p=WA(u.recommendedColumns),g=ku(u.specialCandidates),_=ku(u.digitsOnlyCandidates),N=ku(u.lettersOnlyCandidates),v=ku(u.nonTextSelected),x=YA(f,u.selectedColumns),j=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Special character cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:d.label})," mode. ",d.guidance," Example: ",d.example,"."]}),u.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for cleanup."]}),x.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",x.map(k=>`${k.column} (${k.values.join(", ")})`).join("; "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing punctuation or symbols: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Numeric-only samples detected in: ",_.preview.join(", "),_.remaining>0?`, ... (${_.remaining} more)`:"",". Consider `digits only` mode."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Letter-only samples detected in: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"",". Consider `letters only` mode."]}),p.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",p.preview.join(", "),p.remaining>0?`, ... (${p.remaining} more)`:"","."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[v.preview.join(", ")," ",v.preview.length===1?"is":"are"," not text-like.",v.remaining>0?` ${v.remaining} more column${v.remaining===1?" is":"s are"} also non-text.`:" Double-check that symbol stripping is necessary for these fields."]}),j?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before removing characters."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to sanitize"}),l(n)]}),(s||i)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?c(s):null,i?c(i):null]})]})},db=["lower","upper","title","sentence"],mb="lower",XA=["string","object","text","category","mixed","varchar","char"],JA=3,hb=60,ZA=6,eO=4,tO=5,fb={lower:{label:"Lowercase",guidance:"Converts values to lowercase for consistent comparisons.",example:"Acme Corp  acme corp"},upper:{label:"Uppercase",guidance:"Transforms text to uppercase, useful for codes or standard identifiers.",example:"Acme Corp  ACME CORP"},title:{label:"Title case",guidance:"Capitalizes the first letter of each word, ideal for names or titles.",example:"ACME CORP  Acme Corp"},sentence:{label:"Sentence case",guidance:"Capitalizes the first letter of each sentence while lowercasing the rest.",example:"ACME CORP. DELIVERS.  Acme corp. delivers."}},nO=e=>e.length<=hb?e:`${e.slice(0,hb-1)}...`,pb=e=>{if(!e)return!1;const t=e.toLowerCase();return XA.some(n=>t.includes(n))},Ll=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${nO(t)}'`},sO=e=>e.toLowerCase().split(/([\s\-_/]+)/).map(t=>!t.length||/[\s\-_/]+/.test(t)?t:t.charAt(0).toUpperCase()+t.slice(1)).join(""),rO=e=>e.toLowerCase().replace(/(^\s*[a-z])|([\.\!\?]\s*[a-z])/g,n=>n.toUpperCase()),aO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&db.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&db.includes(s)?s:mb},oO=e=>{const t=fb[e]??fb[mb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},iO=(e,t)=>{const n=[];return Object.entries(e).forEach(([s,i])=>{if(!i.length)return;i.some(c=>{const u=c[t];return c.original!==u})&&n.push(s)}),n.sort((s,i)=>s.localeCompare(i)),n},lO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s,mode:i})=>{const l=Array.from(new Set(We(e)));l.sort((g,_)=>g.localeCompare(_));const c=new Set(l),u=t.filter(g=>pb(n[g]??null)),d=iO(s,i),f=new Set;u.forEach(g=>{c.has(g)||f.add(g)}),d.forEach(g=>{c.has(g)||f.add(g)});const h=Array.from(f).sort((g,_)=>g.localeCompare(_)),p=l.filter(g=>!pb(n[g]??null));return{selectedColumns:l,autoDetectionActive:l.length===0,recommendedColumns:h,nonTextSelected:p,textColumnCount:u.length,inconsistentColumns:d}},gb=(e,t)=>e.slice(0,t),cO=e=>{const t=gb(e,ZA);return{preview:t,remaining:Math.max(e.length-t.length,0)}},_b=e=>{const t=gb(e,eO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},uO=(e,t=JA)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=Ll(u),f={original:d,lower:Ll(u.toLowerCase()),upper:Ll(u.toUpperCase()),title:Ll(sO(u)),sentence:Ll(rO(u))},h=n[c]??[];h.find(p=>p.original===d)||h.length>=t||(n[c]=[...h,f])})}),n},dO=(e,t,n,s=tO)=>{if(!t.length)return[];const i=[];for(const l of t){if(i.length>=s)break;const c=e[l];if(!c||!c.length)continue;const u=c.map(d=>`${d.original}  ${d[n]}`);i.push({column:l,values:u,overflow:0})}return i},mO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,inconsistentColumns:[]},hO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,renderMultiSelectField:i,renderParameterField:l,columnSummary:c,modeDetails:u,sampleMap:d,selectedMode:f})=>{if(!n&&!s)return null;const h=c.selectedColumns.length,p=cO(c.recommendedColumns),g=_b(c.inconsistentColumns),_=_b(c.nonTextSelected),N=dO(d,c.selectedColumns,f),v=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Text case normalization"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:u.label})," mode. ",u.guidance," Example: ",u.example,"."]}),c.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:h})," column",h===1?"":"s"," for case normalization."]}),N.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",N.map(x=>`${x.column} (${x.values.join("; ")})`).join(" | "),"."]}),g.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with mixed casing: ",g.preview.join(", "),g.remaining>0?`, ... (${g.remaining} more)`:"","."]}),p.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",p.preview.join(", "),p.remaining>0?`, ... (${p.remaining} more)`:"","."]}),_.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[_.preview.join(", ")," ",_.preview.length===1?"is":"are"," not text-like.",_.remaining>0?` ${_.remaining} more column${_.remaining===1?" is":"s are"} also non-text.`:" Confirm case normalization is necessary for these values."]}),v?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before adjusting case."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to normalize"}),i(n)]}),s&&a.jsx("div",{className:"canvas-modal__parameter-list",children:l(s)})]})},vb=["preset_digits_only","preset_letters_only","preset_whitespace_collapse","custom"],yb="preset_digits_only",fO=["string","object","text","category","mixed","varchar","char"],pO=3,bb=60,gO=6,_O=4,vO=5,xb={preset_digits_only:{label:"Digits only preset",guidance:"Keeps digits while stripping other characters. Useful for IDs or numeric codes.",example:"Order #123A  123"},preset_letters_only:{label:"Letters only preset",guidance:"Removes digits and symbols, retaining alphabetical characters.",example:"SKU-45X  SKUX"},preset_whitespace_collapse:{label:"Collapse whitespace preset",guidance:"Replaces runs of whitespace with a single space, trimming leading/trailing spacing.",example:`ACME	Corp
 ACME Corp`},custom:{label:"Custom regex",guidance:"Applies your regex and replacement text. Supports JavaScript-style regular expressions.",example:'Pattern: /d+/g Replacement: "#"'}},yO=e=>e.length<=bb?e:`${e.slice(0,bb-1)}...`,zl=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return`'${yO(t)}'`},wb=e=>{if(!e)return!1;const t=e.toLowerCase();return fO.some(n=>t.includes(n))},bO=e=>e.replace(/\s+/g," ").trim(),xO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&vb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&vb.includes(s)?s:yb},wO=e=>{const t=xb[e]??xb[yb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},NO=e=>{const t=new Set,n=new Set,s=new Set;Object.entries(e).forEach(([l,c])=>{c.length&&c.forEach(u=>{u.hasDigits&&t.add(l),u.hasLetters&&n.add(l),u.hasWhitespaceRuns&&s.add(l)})});const i=l=>Array.from(l).sort((c,u)=>c.localeCompare(u));return{digits:i(t),letters:i(n),whitespace:i(s)}},jO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(We(e)));i.sort((_,N)=>_.localeCompare(N));const l=new Set(i),c=t.filter(_=>wb(n[_]??null)),{digits:u,letters:d,whitespace:f}=NO(s),h=new Set;c.forEach(_=>{l.has(_)||h.add(_)}),[...u,...d,...f].forEach(_=>{l.has(_)||h.add(_)});const p=Array.from(h).sort((_,N)=>_.localeCompare(N)),g=i.filter(_=>!wb(n[_]??null));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:p,nonTextSelected:g,textColumnCount:c.length,digitsCandidates:u,lettersCandidates:d,whitespaceCandidates:f}},Nb=(e,t)=>e.slice(0,t),CO=e=>{const t=Nb(e,gO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Mu=e=>{const t=Nb(e,_O);return{preview:t,remaining:Math.max(e.length-t.length,0)}},SO=(e,t=pO)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;let u="";if(l==null)u="";else if(typeof l=="string")u=l;else if(typeof l=="number"||typeof l=="boolean")u=String(l);else try{u=JSON.stringify(l)}catch{u=String(l)}if(!u.length)return;const d=zl(u),f={original:d,presetDigits:zl(u.replace(/\D+/g,"")),presetLetters:zl(u.replace(/[^A-Za-z]+/g,"")),presetWhitespace:zl(bO(u)),hasDigits:/\d/.test(u),hasLetters:/[A-Za-z]/.test(u),hasWhitespaceRuns:/\s{2,}/.test(u)||/\t|\n|\r/.test(u)},h=n[c]??[];h.find(p=>p.original===d)||h.length>=t||(n[c]=[...h,f])})}),n},EO=(e,t,n)=>{const s=n??"",i=l=>l.length?l:"''";switch(t){case"preset_letters_only":return`${i(e.original)}  ${i(e.presetLetters)}`;case"preset_whitespace_collapse":return`${i(e.original)}  ${i(e.presetWhitespace)}`;case"custom":try{const l=new RegExp(s.split("|||")[0]??"",s.split("|||")[1]??""),c=zl(e.original.replace(l,s.split("|||")[2]??""));return`${i(e.original)}  ${i(c)}`}catch{return`${i(e.original)}  (invalid regex)`}case"preset_digits_only":default:return`${i(e.original)}  ${i(e.presetDigits)}`}},kO=(e,t,n,s,i=vO)=>{if(!t.length)return[];const l=[];for(const c of t){if(l.length>=i)break;const u=e[c];if(!u||!u.length)continue;const d=u.map(f=>EO(f,n,s));l.push({column:c,values:d,overflow:0})}return l},MO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonTextSelected:[],textColumnCount:0,digitsCandidates:[],lettersCandidates:[],whitespaceCandidates:[]},AO=e=>{if(!e)return null;const t=e.split("|||"),n=t[0]??"",s=t[1]??"",i=t[2]??"";return!n.trim()&&!i.trim()?null:`Pattern: /${n||"(empty)"}/${s||"(none)"} Replacement: ${i||"''"}`},OO=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,patternParameter:i,replacementParameter:l,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:f,sampleMap:h,selectedMode:p,replacementValue:g})=>{if(!n&&!s&&!i&&!l)return null;const _=d.selectedColumns.length,N=CO(d.recommendedColumns),v=Mu(d.digitsCandidates),x=Mu(d.lettersCandidates),j=Mu(d.whitespaceCandidates),k=Mu(d.nonTextSelected),S=AO(g),C=kO(h,d.selectedColumns,p,g),w=!e||!t,E=p==="custom";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Regex cleanup"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:f.label})," mode. ",f.guidance," Example: ",f.example,"."]}),S&&a.jsx("p",{className:"canvas-modal__note",children:S}),d.autoDetectionActive?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectedtext columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:_})," column",_===1?"":"s"," for regex cleanup."]}),C.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",C.map(A=>`${A.column} (${A.values.join("; ")})`).join(" | "),"."]}),v.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing digits: ",v.preview.join(", "),v.remaining>0?`, ... (${v.remaining} more)`:"","."]}),x.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns containing letters: ",x.preview.join(", "),x.remaining>0?`, ... (${x.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with repeated whitespace: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),N.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other text columns: ",N.preview.join(", "),N.remaining>0?`, ... (${N.remaining} more)`:"","."]}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[k.preview.join(", ")," ",k.preview.length===1?"is":"are"," not text-like.",k.remaining>0?` ${k.remaining} more column${k.remaining===1?" is":"s are"} also non-text.`:" Confirm regex cleanup is appropriate for these values."]}),E&&!S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Custom regex mode is enabled, but no pattern or replacement details were detected. Provide both to avoid no-ops."}),w?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review column insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect column samples before applying regex transformations."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||i||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,i?u(i):null,l?u(l):null]})]})},jb=["negative_to_nan","zero_to_nan","percentage_bounds","age_bounds","custom_range"],Cb="negative_to_nan",TO=["int","float","double","numeric","number","decimal","real","long"],$O=3,PO=6,RO=4,LO=5,Sb={negative_to_nan:{label:"Negative to missing",guidance:"Sets negative readings to missing. Useful for metrics that cannot drop below zero.",example:"Inventory change 3  missing"},zero_to_nan:{label:"Zero to missing",guidance:"Treats placeholder zeros as missing values.",example:"Temperature 0  missing"},percentage_bounds:{label:"Percentage bounds",guidance:"Keeps readings within 0-100% unless you provide custom bounds.",example:"Completion 135%  missing"},age_bounds:{label:"Age bounds",guidance:"Flags implausible ages outside a typical 0-120 range unless overridden.",example:"Customer age 212  missing"},custom_range:{label:"Custom bounds",guidance:"Applies your minimum/maximum limits to selected columns.",example:"Metric < 10 or > 75  missing"}},zO=e=>{const t=e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/\t/g,"\\t");return t.length<=60?t:`${t.slice(0,59)}`},DO=e=>{if(e==null)return null;if(typeof e=="number")return Number.isFinite(e)?e:null;if(typeof e=="boolean")return e?1:0;if(typeof e=="string"){const t=e.trim();if(!t)return null;const n=Number(t);return Number.isFinite(n)?n:null}return null},FO=e=>{if(!e)return!1;const t=e.toLowerCase();return TO.some(n=>t.includes(n))},IO=(e,t)=>{const n=typeof e=="string"?e.trim().toLowerCase():"";if(n&&jb.includes(n))return n;const s=typeof t=="string"?t.trim().toLowerCase():"";return s&&jb.includes(s)?s:Cb},BO=e=>{const t=Sb[e]??Sb[Cb];return{mode:e,label:t.label,guidance:t.guidance,example:t.example}},UO=e=>{const t=new Set,n=new Set,s=new Set,i=new Set;Object.entries(e).forEach(([c,u])=>{u.forEach(d=>{d.isNegative&&t.add(c),d.isZero&&n.add(c),(d.numericValue<0||d.numericValue>100)&&s.add(c),(d.numericValue<0||d.numericValue>120)&&i.add(c)})});const l=c=>Array.from(c).sort((u,d)=>u.localeCompare(d));return{negative:l(t),zeros:l(n),percentage:l(s),age:l(i)}},qO=({selectedColumns:e,availableColumns:t,columnTypeMap:n,sampleMap:s})=>{const i=Array.from(new Set(We(e))).sort((N,v)=>N.localeCompare(v)),l=new Set(i),c=t.filter(N=>FO(n[N]??null)),u=new Set(c),{negative:d,zeros:f,percentage:h,age:p}=UO(s),g=new Set;c.forEach(N=>{l.has(N)||g.add(N)}),[...d,...f,...h,...p].forEach(N=>{l.has(N)||g.add(N)});const _=i.filter(N=>!u.has(N));return{selectedColumns:i,autoDetectionActive:i.length===0,recommendedColumns:Array.from(g).sort((N,v)=>N.localeCompare(v)),nonNumericSelected:_,numericColumnCount:c.length,negativeCandidates:d,zeroCandidates:f,percentageOutliers:h,ageOutliers:p}},HO=e=>{const t=e.slice(0,PO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},Dl=e=>{const t=e.slice(0,RO);return{preview:t,remaining:Math.max(e.length-t.length,0)}},VO=(e,t=$O)=>{if(!Array.isArray(e)||!e.length)return{};const n={};return e.forEach(s=>{!s||typeof s!="object"||Object.entries(s).forEach(([i,l])=>{const c=typeof i=="string"?i.trim():"";if(!c)return;const u=DO(l);if(u===null)return;const d=zO(String(l)),f={originalDisplay:d,numericValue:u,isNegative:u<0,isZero:Math.abs(u)<=1e-9},h=n[c]??[];h.find(p=>p.originalDisplay===d)||h.length>=t||(n[c]=[...h,f])})}),n},WO=0,KO=100,YO=0,GO=120,QO=(e,t,n,s)=>{switch(t){case"negative_to_nan":{const i=n??0;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:s!==null&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}case"zero_to_nan":return{flagged:e.isZero,reason:e.isZero?"zero placeholder":null};case"percentage_bounds":{const i=n??WO,l=s??KO;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:e.numericValue>l?{flagged:!0,reason:`value > ${l}`}:{flagged:!1,reason:null}}case"age_bounds":{const i=n??YO,l=s??GO;return e.numericValue<i?{flagged:!0,reason:`value < ${i}`}:e.numericValue>l?{flagged:!0,reason:`value > ${l}`}:{flagged:!1,reason:null}}case"custom_range":default:{const i=n!=null,l=s!=null;return!i&&!l?{flagged:!1,reason:null}:i&&e.numericValue<n?{flagged:!0,reason:`value < ${n}`}:l&&e.numericValue>s?{flagged:!0,reason:`value > ${s}`}:{flagged:!1,reason:null}}}},XO=(e,t,n,s)=>{const{flagged:i,reason:l}=QO(e,t,n,s);return i?`${e.originalDisplay}  flagged (${l??"rule match"})`:`${e.originalDisplay}  ok`},JO=(e,t,n,s,i,l=LO)=>{if(!t.length)return[];const c=[];for(const u of t){if(c.length>=l)break;const d=e[u];!d||!d.length||c.push({column:u,values:d.map(f=>XO(f,n,s,i)),overflow:0})}return c},ZO={selectedColumns:[],autoDetectionActive:!0,recommendedColumns:[],nonNumericSelected:[],numericColumnCount:0,negativeCandidates:[],zeroCandidates:[],percentageOutliers:[],ageOutliers:[]},eT=(e,t,n)=>{if(e==="custom_range"){if(t===null&&n===null)return"Specify a minimum and/or maximum to enable the custom range rule.";const s=t===null?"-":String(t),i=n===null?"":String(n);return`Custom bounds active: [${s}, ${i}].`}if(e==="percentage_bounds")return`Using percentage bounds ${t??0}${n??100}.`;if(e==="age_bounds")return`Using age bounds ${t??0}${n??120}.`;if(e==="negative_to_nan"&&(t!==null||n!==null)){const s=t??0;return n===null?`Negative-to-missing rule overrides values below ${s}.`:`Negative-to-missing rule overrides values < ${s} or > ${n}.`}return null},tT=({sourceId:e,hasReachableSource:t,columnsParameter:n,modeParameter:s,minValueParameter:i,maxValueParameter:l,renderMultiSelectField:c,renderParameterField:u,columnSummary:d,modeDetails:f,sampleMap:h,selectedMode:p,minValue:g,maxValue:_})=>{if(!n&&!s&&!i&&!l)return null;const{selectedColumns:N,autoDetectionActive:v}=d,x=N.length,j=HO(d.recommendedColumns),k=Dl(d.negativeCandidates),S=Dl(d.zeroCandidates),C=Dl(d.percentageOutliers),w=Dl(d.ageOutliers),E=Dl(d.nonNumericSelected),A=JO(h,N,p,g,_),R=eT(p,g,_),P=!e||!t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Replace invalid numeric values"})}),a.jsxs("p",{className:"canvas-modal__note",children:[a.jsx("strong",{children:f.label})," rule. ",f.guidance," Example: ",f.example,"."]}),R&&a.jsx("p",{className:"canvas-modal__note",children:R}),v?a.jsx("p",{className:"canvas-modal__note",children:"No columns selectednumeric columns will be auto-detected when the node runs."}):a.jsxs("p",{className:"canvas-modal__note",children:["Targeting ",a.jsx("strong",{children:x})," column",x===1?"":"s"," for invalid value cleanup."]}),A.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Samples: ",A.map(T=>`${T.column} (${T.values.join("; ")})`).join(" | "),"."]}),k.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with negative values: ",k.preview.join(", "),k.remaining>0?`, ... (${k.remaining} more)`:"","."]}),S.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Columns with placeholder zeros: ",S.preview.join(", "),S.remaining>0?`, ... (${S.remaining} more)`:"","."]}),C.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Percentage candidates with values outside 0-100: ",C.preview.join(", "),C.remaining>0?`, ... (${C.remaining} more)`:"","."]}),w.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Age-like values outside 0-120: ",w.preview.join(", "),w.remaining>0?`, ... (${w.remaining} more)`:"","."]}),j.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Other numeric columns: ",j.preview.join(", "),j.remaining>0?`, ... (${j.remaining} more)`:"","."]}),E.preview.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[E.preview.join(", ")," ",E.preview.length===1?"is":"are"," not numeric-type columns.",E.remaining>0?` ${E.remaining} more column${E.remaining===1?" is":"s are"} also non-numeric.`:" Verify the selection or adjust the rule."]}),P?e?a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream output to review numeric insights."}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to inspect numeric samples before applying replacements."}):null,n&&a.jsxs("div",{className:"canvas-modal__subsection",children:[a.jsx("h4",{children:"Columns to clean"}),c(n)]}),(s||i||l)&&a.jsxs("div",{className:"canvas-modal__parameter-list",children:[s?u(s):null,i?u(i):null,l?u(l):null]})]})};let nT="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",Eb=(e=21)=>{let t="",n=e|0;for(;n--;)t+=nT[Math.random()*64|0];return t};const kb=[{value:"add",label:"Addition (+)"},{value:"subtract",label:"Subtraction ()"},{value:"multiply",label:"Multiplication ()"},{value:"divide",label:"Division ()"}],Mb=[{value:"sum",label:"Sum"},{value:"mean",label:"Mean"},{value:"min",label:"Minimum"},{value:"max",label:"Maximum"},{value:"std",label:"Standard deviation"},{value:"median",label:"Median"},{value:"count",label:"Count (non-missing)"},{value:"range",label:"Range (max - min)"}],Mh=[{value:"token_sort_ratio",label:"Token Sort  Same words, ignore order",description:"Split into words, sort alphabetically, then compare. Great when the same words appear in different order."},{value:"token_set_ratio",label:"Token Set  Unique words, ignore extras",description:"Focus on overlapping unique words and down-weight extras. Best when one string has additional words."},{value:"ratio",label:"Character Ratio  Raw string similarity",description:"Compare characters in order using edit distance. Sensitive to spelling differences."}],Au=[{value:"year",label:"Year"},{value:"quarter",label:"Quarter"},{value:"month",label:"Month"},{value:"month_name",label:"Month name"},{value:"week",label:"ISO week number"},{value:"day",label:"Day of month"},{value:"day_name",label:"Day name"},{value:"weekday",label:"Weekday index (Mon=0)"},{value:"is_weekend",label:"Is weekend"},{value:"hour",label:"Hour"},{value:"minute",label:"Minute"},{value:"second",label:"Second"},{value:"season",label:"Season"},{value:"time_of_day",label:"Time of day bucket"}],sT=new Set(Au.map(e=>e.value)),ji=[{value:"arithmetic",label:"Arithmetic",description:"Combine columns and constants using addition, subtraction, multiplication, or division.",defaultMethod:"add"},{value:"ratio",label:"Ratio",description:"Divide one column or group of columns by another with safe zero handling.",defaultMethod:"ratio"},{value:"stat",label:"Statistics",description:"Compute sums, averages, min/max, or dispersion metrics across columns.",defaultMethod:"mean"},{value:"similarity",label:"Text similarity",description:"Score two text columns using rapidfuzz token-based similarity.",defaultMethod:"token_sort_ratio"},{value:"datetime_extract",label:"Datetime extraction",description:"Expand datetime columns into year, month, weekday, season and similar features.",defaultMethod:"datetime_extract"}],Fl="UTC",Ou=e=>e?Array.isArray(e)?Array.from(new Set(e.map(t=>typeof t=="string"?t.trim():String(t??"").trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Ou(e.split(",")):[]:[],Ab=e=>{if(!e)return[];if(Array.isArray(e)){const n=[];return e.forEach(s=>{const i=Number(s);Number.isFinite(i)&&n.push(i)}),n}if(typeof e=="string")return Ab(e.split(/[;,]+/));const t=Number(e);return Number.isFinite(t)?[t]:[]},Ah=e=>{const t=Number(e);return Number.isFinite(t)?t:null},Ob=(e,t)=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e!==0:t;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","y","on"].includes(n))return!0;if(["false","0","no","n","off"].includes(n))return!1}return t},rT=(e,t)=>{var s,i,l,c,u;if(typeof t!="string")return((s=ji.find(d=>d.value===e))==null?void 0:s.defaultMethod)??"";const n=t.trim().toLowerCase();return n?e==="arithmetic"?((l=kb.find(d=>d.value===n))==null?void 0:l.value)??"add":e==="stat"?((c=Mb.find(d=>d.value===n))==null?void 0:c.value)??"mean":e==="similarity"?((u=Mh.find(d=>d.value===n))==null?void 0:u.value)??"token_sort_ratio":e==="ratio"?"ratio":e==="datetime_extract"?"datetime_extract":n:((i=ji.find(d=>d.value===e))==null?void 0:i.defaultMethod)??""},aT=e=>{if(typeof e!="string")return"arithmetic";const t=e.trim().toLowerCase();return t==="arithmetic"||t==="ratio"||t==="stat"||t==="similarity"||t==="datetime_extract"?t:"arithmetic"},oT=e=>{const t=Ou(e);return t.length?t.filter(n=>sT.has(n)):["year","month","day"]},iT=e=>typeof e!="string"?Fl:e.trim()||Fl,Tb=e=>{if(!Array.isArray(e))return[];const t=[];return e.forEach((n,s)=>{if(!n||typeof n!="object")return;const i=n,l=aT(i.operation_type??i.type),c=i.operation_id??i.id??`feature_math_${s+1}`,u=typeof c=="string"&&c.trim()?c.trim():`feature_math_${s+1}`,d=rT(l,i.method),f=Ou(i.input_columns??i.inputs??i.inputColumns),h=Ou(i.secondary_columns??i.denominator??i.secondaryColumns),p=Ab(i.constants),g=typeof i.output_column=="string"?i.output_column.trim():"",_=typeof i.output_prefix=="string"?i.output_prefix.trim():"",N=l==="datetime_extract"?oT(i.datetime_features):[],v=l==="datetime_extract"?iT(i.timezone):Fl,x=Ah(i.fillna),j=(()=>{const E=Ah(i.round??i.round_digits);return Number.isInteger(E??NaN),E})(),k=Ah(i.epsilon),S=l==="similarity"?Ob(i.normalize,!1):!1,C=i.allow_overwrite===void 0?null:Ob(i.allow_overwrite,!1),w=typeof i.description=="string"?i.description:void 0;t.push({id:u,type:l,method:d,inputColumns:f,secondaryColumns:h,constants:p,outputColumn:g,outputPrefix:_,datetimeFeatures:N,timezone:v,fillna:x,roundDigits:j,normalize:S,epsilon:k,allowOverwrite:C,description:w})}),t},lT=e=>{const t={id:e.id,operation_id:e.id,type:e.type,operation_type:e.type,method:e.method,input_columns:e.inputColumns,secondary_columns:e.secondaryColumns,constants:e.constants,output_column:e.outputColumn,output_prefix:e.outputPrefix};return e.type==="datetime_extract"?(t.datetime_features=e.datetimeFeatures.length?e.datetimeFeatures:["year","month","day"],t.timezone=e.timezone||Fl):e.datetimeFeatures.length&&(t.datetime_features=e.datetimeFeatures),e.type==="similarity"&&(t.normalize=e.normalize),e.fillna!==null&&Number.isFinite(e.fillna)&&(t.fillna=e.fillna),e.roundDigits!==null&&Number.isFinite(e.roundDigits)&&(t.round=e.roundDigits,t.round_digits=e.roundDigits),e.epsilon!==null&&Number.isFinite(e.epsilon)&&(t.epsilon=e.epsilon),e.allowOverwrite!==null&&(t.allow_overwrite=e.allowOverwrite),e.description&&e.description.trim()&&(t.description=e.description.trim()),t},cT=e=>e.map(t=>lT(t)),uT={arithmetic:{method:"add",constants:[]},ratio:{method:"ratio",constants:[]},stat:{method:"mean",constants:[]},similarity:{method:"token_sort_ratio",constants:[],normalize:!1},datetime_extract:{method:"datetime_extract",datetimeFeatures:["year","month","day"]}},$b=(e,t)=>{var i;const n=uT[e]??{};let s=`math_${e}_${Eb(6)}`;for(;t.has(s);)s=`math_${e}_${Eb(6)}`;return{id:s,type:e,method:n.method??((i=ji.find(l=>l.value===e))==null?void 0:i.defaultMethod)??"add",inputColumns:[],secondaryColumns:[],constants:n.constants??[],outputColumn:"",outputPrefix:"",datetimeFeatures:e==="datetime_extract"?n.datetimeFeatures??["year","month","day"]:[],timezone:Fl,fillna:null,roundDigits:null,normalize:n.normalize??!1,epsilon:null,allowOverwrite:null,description:void 0}},dT=(e,t)=>{const n=new Map;return t==null||t.forEach(s=>{s.operations.forEach(i=>{n.has(i.operation_id)||n.set(i.operation_id,i)})}),e.map((s,i)=>{const l=n.get(s.id),c=`${i+1}. ${s.type.replace("_"," ")}${s.method?`  ${s.method}`:""}`;return{id:s.id,label:c,status:l==null?void 0:l.status,message:(l==null?void 0:l.message)??void 0,outputColumns:(l==null?void 0:l.output_columns)??[]}})},Pb=e=>e==="arithmetic"?kb:e==="stat"?Mb:e==="similarity"?Mh:e==="ratio"?[{value:"ratio",label:"Ratio (numerator / denominator)"}]:[{value:"datetime_extract",label:"Extract datetime parts"}],mT=e=>{const t=Mh.find(n=>n.value===e);return t!=null&&t.description?t.description:"Compare the input text columns using the selected similarity technique."},hT={applied:"Applied",skipped:"Skipped",failed:"Failed"},fT={applied:"canvas-cast__chip--applied",skipped:"canvas-cast__chip--muted",failed:"canvas-cast__chip--attention"},pT=new Set(Au.map(e=>e.value)),gT=(e,t=4)=>{if(!e.length)return"No columns yet";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},Rb=e=>e.trim()?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)):[],_T=e=>e.trim()?e.split(",").map(t=>Number(t.trim())).filter(t=>Number.isFinite(t)):[],vT=e=>e==="failed"?"canvas-modal__note canvas-modal__note--error":e==="skipped"?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",yT=({index:e,total:t,operation:n,summary:s,availableColumns:i,isCollapsed:l,onToggleCollapsed:c,onDuplicate:u,onRemove:d,onReorder:f,onChange:h})=>{var ne;const p=y.useMemo(()=>Pb(n.type),[n.type]),g=y.useMemo(()=>{var J;return((J=ji.find(re=>re.value===n.type))==null?void 0:J.label)??n.type},[n.type]),_=y.useMemo(()=>{var J;return((J=p.find(re=>re.value===n.method))==null?void 0:J.label)??n.method},[p,n.method]),N=y.useMemo(()=>n.type==="similarity"?mT(n.method):"",[n.method,n.type]),[v,x]=y.useState(n.inputColumns.join(", ")),[j,k]=y.useState(n.secondaryColumns.join(", ")),[S,C]=y.useState(n.constants.join(", "));y.useEffect(()=>{x(n.inputColumns.join(", "))},[n.inputColumns]),y.useEffect(()=>{k(n.secondaryColumns.join(", "))},[n.secondaryColumns]),y.useEffect(()=>{C(n.constants.join(", "))},[n.constants]);const w=()=>{h(n.id,{inputColumns:Rb(v)})},E=()=>{h(n.id,{secondaryColumns:Rb(j)})},A=()=>{h(n.id,{constants:_T(S)})},R=`feature-math-toggle-${n.id}`,P=`feature-math-body-${n.id}`,T=`feature-math-input-columns-${n.id}`,O=`feature-math-secondary-columns-${n.id}`,F=s==null?void 0:s.status,B=F?a.jsx("span",{className:`canvas-cast__chip ${fT[F]??""}`,style:{marginLeft:"0.5rem"},children:hT[F]}):null,L=s!=null&&s.message?s.message.trim():"",D=vT(F),q=(ne=s==null?void 0:s.outputColumns)!=null&&ne.length?s.outputColumns.join(", "):"",Y=gT(n.inputColumns),W=n.type==="ratio"||n.type==="similarity",X=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",I=n.type==="arithmetic"||n.type==="stat"||n.type==="ratio",z=n.type==="similarity",H=n.type==="datetime_extract",te=n.type==="stat"||n.type==="datetime_extract",K=y.useMemo(()=>{if(!i.length)return"";const J=i.slice(0,6),re=i.length-J.length;return re>0?`${J.join(", ")}  (${re} more)`:J.join(", ")},[i]),V=J=>{if(!J||!pT.has(J))return;const re=new Set(n.datetimeFeatures);re.has(J)?re.delete(J):re.add(J),h(n.id,{datetimeFeatures:Array.from(re)})},G=J=>re=>{const Se=re.target.value;if(Se===""){h(n.id,{[J]:null});return}const Re=Number(Se);Number.isFinite(Re)&&(J==="roundDigits"?h(n.id,{roundDigits:Math.round(Re)}):J==="fillna"?h(n.id,{fillna:Re}):h(n.id,{epsilon:Re}))},Q=n.allowOverwrite===null?"inherit":n.allowOverwrite?"allow":"prevent";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",id:R,className:"canvas-imputer__card-toggle",onClick:()=>c(n.id),"aria-expanded":!l,"aria-controls":P,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${l?"":" canvas-imputer__toggle-icon--open"}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsxs("span",{className:"canvas-imputer__card-title",children:["Operation ",e+1]}),a.jsxs("span",{className:"canvas-imputer__card-summary",children:[g,_?`  ${_}`:"",n.outputColumn?`   ${n.outputColumn}`:"",B]}),a.jsxs("span",{className:"canvas-modal__meta",children:["Inputs: ",Y]})]})]}),a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>d(n.id),"aria-label":`Remove operation ${e+1}`,children:"Remove"})]}),!l&&a.jsxs("div",{className:"canvas-imputer__card-body",id:P,children:[a.jsx("div",{className:"canvas-imputer__row",children:a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>u(n.id),children:"Duplicate"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>f(n.id,"up"),disabled:e===0,children:"Move up"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary btn-sm",onClick:()=>f(n.id,"down"),disabled:e>=t-1,children:"Move down"})]})}),L&&a.jsx("p",{className:D,children:L}),q&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Outputs: ",q]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-type`,children:"Operation type"}),a.jsx("select",{id:`feature-math-${n.id}-type`,value:n.type,onChange:J=>h(n.id,{type:J.target.value}),children:ji.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-method`,children:"Method"}),a.jsx("select",{id:`feature-math-${n.id}-method`,value:n.method,onChange:J=>h(n.id,{method:J.target.value}),children:p.map(J=>a.jsx("option",{value:J.value,children:J.label},J.value))})]}),n.type==="similarity"&&N&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:N}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-input-columns`,children:"Input columns"}),a.jsx("input",{id:`feature-math-${n.id}-input-columns`,type:"text",value:v,onChange:J=>x(J.target.value),onBlur:w,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),w())},placeholder:"col_a, col_b",list:T}),a.jsx("datalist",{id:T,children:i.map(J=>a.jsx("option",{value:J},`${n.id}-input-option-${J}`))}),K&&a.jsxs("p",{className:"canvas-modal__meta",children:["Available: ",K]})]}),W&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-secondary-columns`,children:n.type==="ratio"?"Denominator columns":"Compare against"}),a.jsx("input",{id:`feature-math-${n.id}-secondary-columns`,type:"text",value:j,onChange:J=>k(J.target.value),onBlur:E,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),E())},placeholder:n.type==="ratio"?"denominator_col":"comparison column",list:O}),a.jsx("datalist",{id:O,children:i.map(J=>a.jsx("option",{value:J},`${n.id}-secondary-option-${J}`))}),a.jsx("p",{className:"canvas-modal__meta",children:"Comma separated list"})]}),X&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-constants`,children:"Constants (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-constants`,type:"text",value:S,onChange:J=>C(J.target.value),onBlur:A,onKeyDown:J=>{J.key==="Enter"&&(J.preventDefault(),A())},placeholder:"0.0, 1.5"}),a.jsx("p",{className:"canvas-modal__meta",children:"Numbers separated by commas are added alongside the selected columns."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-column`,children:"Output column (optional)"}),a.jsx("input",{id:`feature-math-${n.id}-output-column`,type:"text",value:n.outputColumn,onChange:J=>h(n.id,{outputColumn:J.target.value}),placeholder:"custom_feature_name"}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank to derive a name automatically."})]}),te&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-output-prefix`,children:"Output prefix"}),a.jsx("input",{id:`feature-math-${n.id}-output-prefix`,type:"text",value:n.outputPrefix,onChange:J=>h(n.id,{outputPrefix:J.target.value}),placeholder:"prefix_"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applied to generated column names (statistics or datetime features)."})]}),I&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-fillna`,children:"Fill missing result with"}),a.jsx("input",{id:`feature-math-${n.id}-fillna`,type:"number",value:n.fillna??"",onChange:G("fillna"),placeholder:"none"}),a.jsx("p",{className:"canvas-modal__meta",children:"Applies after computing the operation."})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-round`,children:"Round digits"}),a.jsx("input",{id:`feature-math-${n.id}-round`,type:"number",value:n.roundDigits??"",onChange:G("roundDigits"),placeholder:"none",step:1}),a.jsx("p",{className:"canvas-modal__meta",children:"Leave blank for no rounding."})]})]}),n.type==="ratio"&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-epsilon`,children:"Division epsilon"}),a.jsx("input",{id:`feature-math-${n.id}-epsilon`,type:"number",value:n.epsilon??"",onChange:G("epsilon"),placeholder:"inherit",step:"any"}),a.jsx("p",{className:"canvas-modal__meta",children:"Overrides the node-level epsilon for this ratio."})]}),z&&a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsxs("label",{htmlFor:`feature-math-${n.id}-normalize`,className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:`feature-math-${n.id}-normalize`,type:"checkbox",checked:n.normalize,onChange:J=>h(n.id,{normalize:J.target.checked})}),a.jsx("span",{children:"Normalize scores to the [0, 1] range"})]}),a.jsx("p",{className:"canvas-modal__meta",children:"Useful when chaining similarity outputs into downstream calculations."})]}),H&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"canvas-imputer__row canvas-imputer__row--wrap",children:a.jsxs("fieldset",{children:[a.jsx("legend",{children:"Datetime features"}),a.jsx("div",{className:"canvas-modal__checkbox-grid",children:Au.map(J=>{const re=`feature-math-${n.id}-datetime-${J.value}`,Se=n.datetimeFeatures.includes(J.value);return a.jsxs("label",{className:"canvas-modal__checkbox-item",htmlFor:re,children:[a.jsx("input",{id:re,type:"checkbox",checked:Se,onChange:()=>V(J.value)}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:J.label})]},J.value)})})]})}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-timezone`,children:"Timezone override"}),a.jsx("input",{id:`feature-math-${n.id}-timezone`,type:"text",value:n.timezone,onChange:J=>h(n.id,{timezone:J.target.value}),placeholder:"UTC"}),a.jsx("p",{className:"canvas-modal__meta",children:"Use an IANA timezone identifier, e.g. America/New_York."})]})]}),a.jsxs("div",{className:"canvas-imputer__row",children:[a.jsx("label",{htmlFor:`feature-math-${n.id}-allow-overwrite`,children:"Overwrite behavior"}),a.jsxs("select",{id:`feature-math-${n.id}-allow-overwrite`,value:Q,onChange:J=>{const re=J.target.value;re==="inherit"?h(n.id,{allowOverwrite:null}):h(n.id,{allowOverwrite:re==="allow"})},children:[a.jsx("option",{value:"inherit",children:"Inherit node default"}),a.jsx("option",{value:"allow",children:"Always overwrite existing columns"}),a.jsx("option",{value:"prevent",children:"Never overwrite existing columns"})]})]})]})]})},bT=({operations:e,summaries:t,collapsed:n,onToggleCollapsed:s,onAddOperation:i,onDuplicateOperation:l,onRemoveOperation:c,onReorderOperation:u,onOperationChange:d,availableColumns:f,signals:h,previewStatus:p,errorHandlingParameter:g,allowOverwriteParameter:_,defaultTimezoneParameter:N,epsilonParameter:v,renderParameterField:x})=>{const[j,k]=y.useState("arithmetic"),S=y.useMemo(()=>{const R=new Map;return t.forEach(P=>{R.set(P.id,P)}),R},[t]),C=y.useMemo(()=>h.length?h[h.length-1]:null,[h]),w=(C==null?void 0:C.warnings)??[],E=C&&C.failed_operations>0?"canvas-modal__note canvas-modal__note--warning":"canvas-modal__note canvas-modal__note--info",A=()=>{i(j)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature math operations"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("select",{value:j,onChange:R=>k(R.target.value),children:ji.map(R=>a.jsx("option",{value:R.value,children:R.label},R.value))}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:A,children:"Add operation"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Blend columns using arithmetic formulas, ratios, statistics, similarity scores, or datetime extractions. Configure each operation below  they execute in order."}),p==="loading"&&a.jsx("p",{className:"canvas-modal__note",children:"Preview updating"}),C&&a.jsxs("p",{className:E,children:["Preview applied ",C.applied_operations," of ",C.total_operations," operation",C.total_operations===1?"":"s"," (",C.skipped_operations," skipped, ",C.failed_operations," failed)."]}),w.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:w.map((R,P)=>a.jsx("li",{children:R},`feature-math-warning-${P}`))}),e.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature math steps configured yet. Add an operation to create engineered columns."}),e.map((R,P)=>a.jsx(yT,{index:P,total:e.length,operation:R,summary:S.get(R.id),availableColumns:f,isCollapsed:n.has(R.id),onToggleCollapsed:s,onDuplicate:l,onRemove:c,onReorder:u,onChange:d},R.id)),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[g&&x(g),_&&x(_),N&&x(N),v&&x(v)]})]})},xT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},wT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Lb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),NT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxUniqueParameter:d,outputSuffixParameter:f,dropOriginalParameter:h,missingStrategyParameter:p,missingCodeParameter:g,selectedColumns:_,renderParameterField:N,onToggleColumn:v,onApplyRecommended:x,formatMissingPercentage:j})=>{const k=y.useMemo(()=>{if(!i.length)return[];const E=new Set;return i.forEach(A=>{A.status==="recommended"&&A.selectable&&E.add(A.column)}),Array.from(E)},[i]),S=y.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface label encoding suggestions.",[t,e]),C=i.length>0,w=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Label encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(k),disabled:!k.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert short-form categorical text into integer labels. Suggestions come from EDA heuristics and the current pipeline preview."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((E,A)=>a.jsx("li",{children:E},`label-encoding-note-${A}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading label encoding insights"}),w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!C&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&C&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(E=>{const A=_.includes(E.column),R=xT[E.status],P=wT[E.status]??"canvas-cast__chip--muted",T=E.sample_values.length?E.sample_values.join(", "):"",O=E.unique_count!==void 0&&E.unique_count!==null?`${Lb(E.unique_count)} (${Lb(E.unique_percentage)}%)`:"",F=j(E.missing_percentage);return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:E.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[E.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",E.dtype]}),E.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:E.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",T]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:E.reason})]})}),a.jsx("td",{children:O}),a.jsx("td",{children:F}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:R})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:()=>v(E.column),disabled:!E.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:E.selectable?A?"In node":"Add column":"Not eligible"})]})})]},`label-encoding-row-${E.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&N(u),d&&N(d),f&&N(f),h&&N(h),p&&N(p),g&&N(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),N(c)]})]})},jT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},CT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},zb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),ST=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,targetColumnParameter:u,autoDetectParameter:d,maxCategoriesParameter:f,outputSuffixParameter:h,dropOriginalParameter:p,smoothingParameter:g,encodeMissingParameter:_,handleUnknownParameter:N,selectedColumns:v,renderParameterField:x,onToggleColumn:j,onApplyRecommended:k,formatMissingPercentage:S})=>{const C=y.useMemo(()=>{if(!i.length)return[];const R=new Set;return i.forEach(P=>{P.status==="recommended"&&P.selectable&&R.add(P.column)}),Array.from(R)},[i]),w=y.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface target encoding suggestions.",[t,e]),E=i.length>0,A=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Target encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>k(C),disabled:!C.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Encode categorical columns by replacing each category with the smoothed mean of a numeric target column. This is useful for high-cardinality features when a label or ordinal encoding is too coarse."}),w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:w}),!u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Add a target column parameter to unlock target encoding. The backend requires a numeric target to compute averages."}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.enableGlobalFallbackDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the global mean fallback so unseen categories and nulls do not break downstream transforms."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((R,P)=>a.jsx("li",{children:R},`target-encoding-note-${P}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading target encoding insights"}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!E&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&E&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Fallback"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(R=>{const P=v.includes(R.column),T=jT[R.status],O=CT[R.status]??"canvas-cast__chip--muted",F=R.sample_values.length?R.sample_values.join(", "):"",B=R.unique_count!==void 0&&R.unique_count!==null?`${zb(R.unique_count)} (${zb(R.unique_percentage)}%)`:"",L=S(R.missing_percentage),D=R.recommended_use_global_fallback?"Use global mean":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:R.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[R.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",R.dtype]}),R.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:R.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",F]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:R.reason})]})}),a.jsx("td",{children:B}),a.jsx("td",{children:L}),a.jsx("td",{children:D}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${O}`,children:T})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:()=>j(R.column),disabled:!R.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:R.selectable?P?"In node":"Add column":"Not eligible"})]})})]},`target-encoding-row-${R.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&x(u),d&&x(d),f&&x(f),h&&x(h),p&&x(p),g&&x(g),_&&x(_),N&&x(N)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),x(c)]})]})},ET={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},kT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Db=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),MT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,bucketsParameter:f,outputSuffixParameter:h,dropOriginalParameter:p,encodeMissingParameter:g,selectedColumns:_,renderParameterField:N,onToggleColumn:v,onApplyRecommended:x,formatMissingPercentage:j})=>{const k=y.useMemo(()=>{if(!i.length)return[];const A=new Set;return i.forEach(R=>{R.status==="recommended"&&R.selectable&&A.add(R.column)}),Array.from(A)},[i]),S=y.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface hash encoding suggestions.",[t,e]),C=i.length>0,w=l.suggestedBucketDefault>0?`Default bucket suggestion: ${l.suggestedBucketDefault.toLocaleString()}.`:null,E=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hash encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(k),disabled:!k.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Hash encoding maps categorical labels into a fixed number of numeric buckets, keeping feature width bounded even when categories grow over time. Collisions are acceptable for tree models and regularised linear models that can tolerate sparse overlaps."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so newly ingested categorical columns pick up hashing without manual edits."}),w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:w}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((A,R)=>a.jsx("li",{children:A},`hash-encoding-note-${R}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["High-cardinality columns highlighted:"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading hash encoding insights"}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!C&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&C&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Suggested buckets"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(A=>{const R=_.includes(A.column),P=ET[A.status],T=kT[A.status]??"canvas-cast__chip--muted",O=A.sample_values.length?A.sample_values.join(", "):"",F=A.unique_count!==void 0&&A.unique_count!==null?`${Db(A.unique_count)} (${Db(A.unique_percentage)}%)`:"",B=j(A.missing_percentage),L=A.recommended_bucket_count?A.recommended_bucket_count.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:A.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[A.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",A.dtype]}),A.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:A.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",O]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:A.reason})]})}),a.jsx("td",{children:F}),a.jsx("td",{children:B}),a.jsx("td",{children:L}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${T}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>v(A.column),disabled:!A.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:A.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`hash-encoding-row-${A.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&N(u),d&&N(d),f&&N(f),h&&N(h),p&&N(p),g&&N(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),N(c)]})]})},AT=({columnsParameter:e,autoDetectParameter:t,degreeParameter:n,includeBiasParameter:s,interactionOnlyParameter:i,includeInputFeaturesParameter:l,outputPrefixParameter:c,renderParameterField:u,signal:d})=>{const f=y.useMemo(()=>[e,t,n,s,i,l,c].filter(x=>!!x),[e,t,n,s,i,l,c]),h=(d==null?void 0:d.generated_features)??[],p=(d==null?void 0:d.skipped_columns)??[],g=(d==null?void 0:d.filled_columns)??{},_=(d==null?void 0:d.notes)??[],N=(d==null?void 0:d.feature_count)??0,v=y.useMemo(()=>{const x=Object.entries(g);return x.length?x.map(([j,k])=>`${j} (${k.toLocaleString()} missing)`).join(", "):null},[g]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Polynomial feature settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Expand numeric features with polynomial powers and interaction terms to capture non-linear relations. Preview the node to inspect generated columns and adjust degree or interaction options as needed."}),f.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:f.map(x=>u(x))}),p.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Skipped columns: ",p.join(", "),"."]}),v&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Filled missing values with 0 for ",v," before generating features."]}),N>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Expression"}),a.jsx("th",{scope:"col",children:"Degree"})]})}),a.jsx("tbody",{children:h.map(x=>a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:x.column}),a.jsx("td",{children:x.expression||(x.terms.length?x.terms.join("  "):"1")}),a.jsx("td",{children:x.degree})]},`poly-feature-${x.column}`))})]})}):a.jsx("p",{className:"canvas-modal__note",children:"No derived features yet. Run a preview to generate polynomial terms for the current configuration."}),_.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:_.map((x,j)=>a.jsx("li",{children:x},`polynomial-note-${j}`))})]})},Fb=e=>!!e,Il=(e,t=4)=>{if(e==null)return"";const n=Number(e);return Number.isFinite(n)?n.toLocaleString(void 0,{maximumFractionDigits:t}):""},OT=e=>{if(e==null)return"";const t=Number(e);return Number.isFinite(t)?t===0?"< 1e-12":t<1e-4?t.toExponential(2):t.toLocaleString(void 0,{maximumFractionDigits:6}):""},Ib=(e,t=8)=>{if(!e.length)return"None";const n=e.slice(0,t),s=e.length-n.length;return s>0?`${n.join(", ")}  (${s} more)`:n.join(", ")},TT=({columnsParameter:e,autoDetectParameter:t,targetColumnParameter:n,methodParameter:s,scoreFuncParameter:i,problemTypeParameter:l,kParameter:c,percentileParameter:u,alphaParameter:d,thresholdParameter:f,modeParameter:h,estimatorParameter:p,stepParameter:g,minFeaturesParameter:_,maxFeaturesParameter:N,dropUnselectedParameter:v,renderParameterField:x,signal:j})=>{const k=y.useMemo(()=>[e,t,n,s,i,l].filter(Fb),[e,t,n,s,i,l]),S=y.useMemo(()=>[c,u,d,f,h,p,g,_,N,v].filter(Fb),[c,u,d,f,h,p,g,_,N,v]),C=(j==null?void 0:j.configured_columns)??[],w=(j==null?void 0:j.evaluated_columns)??[],E=(j==null?void 0:j.selected_columns)??[],A=(j==null?void 0:j.dropped_columns)??[],R=(j==null?void 0:j.feature_summaries)??[],P=(j==null?void 0:j.notes)??[],T=(j==null?void 0:j.drop_unselected)??!1,O=y.useMemo(()=>{if(!w.length&&!C.length)return null;if(w.length===C.length)return`Evaluated ${w.length.toLocaleString()} column(s).`;if(!C.length)return`Evaluated ${w.length.toLocaleString()} column(s) via auto-detect.`;const D=Math.max(w.length-C.length,0);return D>0?`Evaluated ${w.length.toLocaleString()} column(s) (${D.toLocaleString()} auto-detected).`:`Evaluated ${w.length.toLocaleString()} of ${C.length.toLocaleString()} configured column(s).`},[C,w]),F=y.useMemo(()=>{if(!j)return null;const D=[];return j.method&&D.push(`Method: ${j.method}`),j.score_func&&D.push(`Score: ${j.score_func}`),j.estimator&&D.push(`Estimator: ${j.estimator}`),j.problem_type&&j.problem_type!=="auto"&&D.push(`Problem: ${j.problem_type}`),j.target_column&&D.push(`Target: ${j.target_column}`),typeof j.k=="number"&&Number.isFinite(j.k)&&D.push(`k = ${j.k.toLocaleString()}`),typeof j.percentile=="number"&&Number.isFinite(j.percentile)&&D.push(`percentile = ${Il(j.percentile,2)}`),typeof j.alpha=="number"&&Number.isFinite(j.alpha)&&D.push(`alpha = ${Il(j.alpha,4)}`),j.threshold!==null&&j.threshold!==void 0&&Number.isFinite(j.threshold)&&D.push(`threshold = ${Il(j.threshold,4)}`),j.auto_detect&&D.push("Auto-detect enabled"),D.length?D.join("  "):null},[j]),B=y.useMemo(()=>Ib(E),[E]),L=y.useMemo(()=>Ib(A),[A]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Feature selection settings"})}),a.jsx("p",{className:"canvas-modal__note",children:"Score candidate predictors and retain the most informative columns using statistical tests or model-based selectors. Run a preview after adjusting parameters to refresh rankings."}),F&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:F}),O&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:O}),k.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",children:k.map(D=>x(D))}),S.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid",style:{marginTop:"1rem"},children:S.map(D=>x(D))}),a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:T?"Unselected columns will be dropped from the dataset when this node runs.":"Unselected columns will remain in the dataset for downstream steps."}),E.length>0?a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Selected ",E.length.toLocaleString()," column(s): ",B]}):a.jsx("p",{className:"canvas-modal__note",children:"No columns selected yet. Run a preview to compute selection scores."}),A.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Dropped ",A.length.toLocaleString()," column(s): ",L]}),R.length>0?a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Feature column"}),a.jsx("th",{scope:"col",children:"Score"}),a.jsx("th",{scope:"col",children:"p-value"}),a.jsx("th",{scope:"col",children:"Rank"}),a.jsx("th",{scope:"col",children:"Importance"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Note"})]})}),a.jsx("tbody",{children:R.map(D=>{const q=["canvas-cast__row"];return D.selected||q.push("canvas-cast__row--muted"),a.jsxs("tr",{className:q.join(" "),children:[a.jsx("th",{scope:"row",children:D.column}),a.jsx("td",{children:Il(D.score)}),a.jsx("td",{children:OT(D.p_value)}),a.jsx("td",{children:D.rank??""}),a.jsx("td",{children:Il(D.importance,4)}),a.jsx("td",{children:D.selected?"Selected":"Dropped"}),a.jsx("td",{children:D.note??""})]},`feature-selection-summary-${D.column}`)})})]})}):a.jsx("p",{className:"canvas-modal__note",children:"Preview results will display per-column scores, ranks, and selection outcomes here."}),P.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:P.map((D,q)=>a.jsx("li",{children:D},`feature-selection-note-${q}`))})]})},$T={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},PT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Bb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),RT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,outputSuffixParameter:f,dropOriginalParameter:h,encodeMissingParameter:p,handleUnknownParameter:g,unknownValueParameter:_,selectedColumns:N,renderParameterField:v,onToggleColumn:x,onApplyRecommended:j,formatMissingPercentage:k})=>{const S=y.useMemo(()=>{if(!i.length)return[];const A=new Set;return i.forEach(R=>{R.status==="recommended"&&R.selectable&&A.add(R.column)}),Array.from(A)},[i]),C=y.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface ordinal encoding suggestions.",[t,e]),w=i.length>0,E=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Ordinal encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>j(S),disabled:!S.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Convert categorical columns into ordered integer codes. Use the fallback controls to keep pipelines stable when unexpected categories or missing values appear."}),C&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:C}),l.autoDetectDefault&&a.jsx("p",{className:"canvas-modal__note",children:"Auto-detect is suggested so future categorical columns join without manual updates."}),l.enableUnknownDefault&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Enable the fallback code so unseen categories and nulls do not break downstream transforms."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((A,R)=>a.jsx("li",{children:A},`ordinal-encoding-note-${R}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading ordinal encoding insights"}),E&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!w&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&w&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Unknowns"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(A=>{const R=N.includes(A.column),P=$T[A.status],T=PT[A.status]??"canvas-cast__chip--muted",O=A.sample_values.length?A.sample_values.join(", "):"",F=A.unique_count!==void 0&&A.unique_count!==null?`${Bb(A.unique_count)} (${Bb(A.unique_percentage)}%)`:"",B=k(A.missing_percentage),L=A.recommended_handle_unknown?"Enable fallback":"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:A.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[A.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",A.dtype]}),A.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:A.text_category})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",O]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:A.reason})]})}),a.jsx("td",{children:F}),a.jsx("td",{children:B}),a.jsx("td",{children:L}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${T}`,children:P})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:()=>x(A.column),disabled:!A.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:A.selectable?R?"In node":"Add column":"Not eligible"})]})})]},`ordinal-encoding-row-${A.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&v(u),d&&v(d),f&&v(f),h&&v(h),p&&v(p),g&&v(g),_&&v(_)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),v(c)]})]})},LT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},zT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},Ub=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),DT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:f,includeMissingParameter:h,dropOriginalParameter:p,prefixSeparatorParameter:g,selectedColumns:_,renderParameterField:N,onToggleColumn:v,onApplyRecommended:x,formatMissingPercentage:j})=>{const k=y.useMemo(()=>{if(!i.length)return[];const E=new Set;return i.forEach(A=>{A.status==="recommended"&&A.selectable&&E.add(A.column)}),Array.from(E)},[i]),S=y.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface dummy encoding suggestions.",[t,e]),C=i.length>0,w=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Dummy encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(k),disabled:!k.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Create dummy variables while automatically dropping a reference category. This mirrors one-hot encoding but keeps feature matrices full rank."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.autoDetectDefault&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:"Auto-detection is recommended here so new categorical columns are captured by default."}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l.cautionedCount," column",l.cautionedCount===1?"":"s"," could expand heavily  consider alternate encodings."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((E,A)=>a.jsx("li",{children:E},`dummy-note-${A}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading dummy encoding insights"}),w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!C&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&C&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(E=>{const A=_.includes(E.column),R=LT[E.status],P=zT[E.status]??"canvas-cast__chip--muted",T=E.sample_values.length?E.sample_values.join(", "):"",O=E.unique_count!==void 0&&E.unique_count!==null?`${Ub(E.unique_count)} (${Ub(E.unique_percentage)}%)`:"",F=j(E.missing_percentage),B=E.estimated_dummy_columns?E.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:E.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[E.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",E.dtype]}),E.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:E.text_category}),E.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",T]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:E.reason})]})}),a.jsx("td",{children:O}),a.jsx("td",{children:F}),a.jsx("td",{children:B}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:R})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:()=>v(E.column),disabled:!E.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:E.selectable?A?"In node":"Add column":"Not eligible"})]})})]},`dummy-encoding-row-${E.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&N(u),d&&N(d),f&&N(f),h&&N(h),p&&N(p),g&&N(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),N(c)]})]})},FT={recommended:"Recommended",high_cardinality:"High cardinality",identifier:"Identifier-like",free_text:"Free text",single_category:"Single category",too_many_categories:"Too many categories"},IT={recommended:"canvas-cast__chip--applied",high_cardinality:"canvas-cast__chip--attention",identifier:"canvas-cast__chip--muted",free_text:"canvas-cast__chip--muted",single_category:"canvas-cast__chip--muted",too_many_categories:"canvas-cast__chip--muted"},qb=e=>e==null||Number.isNaN(e)?"":e.toLocaleString(void 0,{maximumFractionDigits:2}),BT=({sourceId:e,hasReachableSource:t,isFetching:n,error:s,suggestions:i,metadata:l,columnsParameter:c,autoDetectParameter:u,maxCategoriesParameter:d,dropFirstParameter:f,includeMissingParameter:h,dropOriginalParameter:p,prefixSeparatorParameter:g,selectedColumns:_,renderParameterField:N,onToggleColumn:v,onApplyRecommended:x,formatMissingPercentage:j})=>{const k=y.useMemo(()=>{if(!i.length)return[];const E=new Set;return i.forEach(A=>{A.status==="recommended"&&A.selectable&&E.add(A.column)}),Array.from(E)},[i]),S=y.useMemo(()=>e?t?null:"Connect this node to the dataset input to analyse categorical features.":"Choose a dataset to surface one-hot encoding suggestions.",[t,e]),C=i.length>0,w=!n&&!!s&&!!e&&t;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"One-hot encoding suggestions"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>x(k),disabled:!k.length,children:"Add recommended"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Expand categorical text into binary indicator columns. Suggestions factor in estimated dummy counts so encodings stay tractable."}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:S}),l.generatedAt&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",new Date(l.generatedAt).toLocaleString()," on"," ",l.sampleSize===null?"sampled rows":`${l.sampleSize.toLocaleString()} row${l.sampleSize===1?"":"s"}`,"."]}),!l.generatedAt&&l.sampleSize!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Evaluated ",l.sampleSize.toLocaleString()," row",l.sampleSize===1?"":"s"," for categorical trends."]}),l.totalTextColumns>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Found ",l.totalTextColumns," text column",l.totalTextColumns===1?"":"s","; recommendations cover"," ",l.recommendedCount," candidate",l.recommendedCount===1?"":"s","."]}),l.cautionedCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[l.cautionedCount," column",l.cautionedCount===1?"":"s"," could explode in width  consider alternate encodings."]}),l.notes.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:l.notes.map((E,A)=>a.jsx("li",{children:E},`one-hot-note-${A}`))}),l.highCardinalityColumns.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipped ",l.highCardinalityColumns.length," high-cardinality column",l.highCardinalityColumns.length===1?"":"s",":"," ",l.highCardinalityColumns.slice(0,4).join(", "),l.highCardinalityColumns.length>4?", ":"","."]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading one-hot encoding insights"}),w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s??""}),!n&&!s&&!C&&e&&t&&a.jsx("p",{className:"canvas-modal__note",children:"No categorical text candidates detected in the current preview."}),!n&&!s&&C&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Distinct"}),a.jsx("th",{scope:"col",children:"Missing"}),a.jsx("th",{scope:"col",children:"Dummy cols"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Select"})]})}),a.jsx("tbody",{children:i.map(E=>{const A=_.includes(E.column),R=FT[E.status],P=IT[E.status]??"canvas-cast__chip--muted",T=E.sample_values.length?E.sample_values.join(", "):"",O=E.unique_count!==void 0&&E.unique_count!==null?`${qb(E.unique_count)} (${qb(E.unique_percentage)}%)`:"",F=j(E.missing_percentage),B=E.estimated_dummy_columns?E.estimated_dummy_columns.toLocaleString():"";return a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:E.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[E.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",E.dtype]}),E.text_category&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--category",children:E.text_category}),E.recommended_drop_first&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--info",children:"Drop first suggested"})]}),a.jsx("div",{className:"canvas-cast__column-meta",children:a.jsxs("span",{className:"canvas-cast__muted",children:["Examples: ",T]})}),a.jsx("p",{className:"canvas-cast__recommendation-note",children:E.reason})]})}),a.jsx("td",{children:O}),a.jsx("td",{children:F}),a.jsx("td",{children:B}),a.jsx("td",{children:a.jsx("span",{className:`canvas-cast__chip ${P}`,children:R})}),a.jsx("td",{children:a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:()=>v(E.column),disabled:!E.selectable}),a.jsx("span",{className:"canvas-modal__checkbox-label",children:E.selectable?A?"In node":"Add column":"Not eligible"})]})})]},`one-hot-row-${E.column}`)})})]})}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[u&&N(u),d&&N(d),f&&N(f),h&&N(h),p&&N(p),g&&N(g)]}),c&&a.jsxs("div",{children:[a.jsx("h4",{className:"canvas-modal__subheading",children:"Manual column selection"}),N(c)]})]})},Hb={fit_transform:"Fit + transform",transform:"Transform",not_applied:"Not applied",not_available:""},UT=e=>{if(!e)return"";const t=new Date(e);return Number.isNaN(t.getTime())?e:t.toLocaleString()},Vb=e=>{if(e==null||Number.isNaN(e)||e<=0)return null;const t=Math.round(e);return`${t.toLocaleString()} row${t===1?"":"s"}`},qT=(e,t)=>Array.isArray(e.split_activity)?e.split_activity.find(s=>s&&s.split===t)??null:null,Oh=(e,t)=>{const n=qT(e,t);if(!n||n.action==="not_available")return a.jsx("span",{children:""});const s=Hb[n.action]??n.action,i=Vb(n.rows??null);return a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{children:s}),i&&a.jsx("span",{className:"canvas-cast__muted",children:i})]})},HT=e=>{if(!Array.isArray(e.split_activity))return null;const t=e.split_activity.filter(s=>s&&!["train","test","validation"].includes(s.split));return t.length&&t.map(s=>{const i=s.label||s.split,l=Hb[s.action]??s.action,c=Vb(s.rows??null);return c?`${i}: ${l} (${c})`:`${i}: ${l}`}).join("; ")||null},VT=e=>!e.metadata||typeof e.metadata!="object"?null:e.metadata.method_label?String(e.metadata.method_label):e.metadata.method?String(e.metadata.method):null,WT=({signal:e,previewStatus:t,hasSource:n,hasReachableSource:s,onRefreshPreview:i})=>{const l=y.useMemo(()=>(e==null?void 0:e.transformers)??[],[e==null?void 0:e.transformers]),c=(e==null?void 0:e.total_transformers)??l.length,u=Array.isArray(e==null?void 0:e.notes)?e==null?void 0:e.notes:[],d=t==="loading",f=c?`Tracking ${c.toLocaleString()} transformer${c===1?"":"s"}.`:null,h=d||!n||!s;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Transformer activity"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:h,children:d?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Review whether split-aware transformers (e.g. one-hot encoders) fit on training data and propagated to test/validation splits."}),f&&a.jsx("p",{className:"canvas-modal__note",children:f}),!n&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface transformer activity."}),n&&!s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to an upstream branch to inspect transformer history."}),u.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:u.map((p,g)=>a.jsx("li",{children:p},`transformer-audit-note-${g}`))}),d&&a.jsx("p",{className:"canvas-modal__note",children:"Loading transformer activity"}),!d&&t==="error"&&n&&s&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:"Unable to load transformer activity. Try refreshing the preview."}),!d&&n&&s&&!l.length&&a.jsx("p",{className:"canvas-modal__note",children:"No transformer activity recorded yet. Run a preview after executing split-aware transformation nodes."}),!d&&l.length>0&&a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Node"}),a.jsx("th",{scope:"col",children:"Transformer"}),a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Method"}),a.jsx("th",{scope:"col",children:"Train"}),a.jsx("th",{scope:"col",children:"Test"}),a.jsx("th",{scope:"col",children:"Validation"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:l.map((p,g)=>{const _=p.storage_key??`${p.transformer_name}-${p.column_name??"all"}-${g}`,N=HT(p),v=p.source_node_label||p.source_node_id||"",x=UT(p.updated_at??p.created_at??null),j=p.column_name??"",k=VT(p);return a.jsxs(ge.Fragment,{children:[a.jsxs("tr",{className:"canvas-cast__row",children:[a.jsx("th",{scope:"row",children:a.jsx("div",{className:"canvas-cast__column-cell",children:a.jsx("span",{className:"canvas-cast__column-name",children:v})})}),a.jsx("td",{children:p.transformer_name}),a.jsx("td",{children:j}),a.jsx("td",{children:k||""}),a.jsx("td",{children:Oh(p,"train")}),a.jsx("td",{children:Oh(p,"test")}),a.jsx("td",{children:Oh(p,"validation")}),a.jsx("td",{children:x})]}),N&&a.jsx("tr",{className:"canvas-cast__row canvas-cast__row--subtle",children:a.jsx("td",{colSpan:8,children:a.jsxs("span",{className:"canvas-cast__muted",children:["Additional splits: ",N]})})})]},_)})})]})})]})},Th=(e,t=5)=>e.length?e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`:"",KT=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n!="string")continue;if(n.toLowerCase().includes("feature/target split"))return n}return null},YT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},GT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:i,config:l,targetColumnParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:f})=>{var te,K,V,G;const h=s.data,p=s.status,g=Array.isArray(h==null?void 0:h.applied_steps)?h.applied_steps:[],_=Array.isArray(h==null?void 0:h.columns)?h==null?void 0:h.columns:[],N=Array.isArray((te=h==null?void 0:h.signals)==null?void 0:te.feature_target_split)?(K=h==null?void 0:h.signals)==null?void 0:K.feature_target_split:[],v=YT(N,e),x=(l==null?void 0:l.targetColumn)??"",j=(v==null?void 0:v.target_column)??x,k=(l==null?void 0:l.featureColumns)??[],S=y.useMemo(()=>Array.isArray(h==null?void 0:h.column_stats)?h==null?void 0:h.column_stats:[],[h==null?void 0:h.column_stats]),C=y.useMemo(()=>{const Q=new Map;return S.forEach(ne=>{ne!=null&&ne.name&&Q.set(ne.name,ne)}),Q},[S]),w=y.useMemo(()=>{var Q;return(Q=v==null?void 0:v.feature_columns)!=null&&Q.length?v.feature_columns:k.length?k:j?_.filter(ne=>ne!==j):_.slice()},[v==null?void 0:v.feature_columns,k,_,j]),E=(v==null?void 0:v.auto_included_columns)??[],A=(v==null?void 0:v.missing_feature_columns)??[],R=(v==null?void 0:v.excluded_columns)??[],P=(v==null?void 0:v.target_missing_count)??0,T=typeof(v==null?void 0:v.target_missing_percentage)=="number"?v.target_missing_percentage:null,O=(v==null?void 0:v.target_dtype)??(j?((V=C.get(j))==null?void 0:V.dtype)??null:null),F=typeof((G=h==null?void 0:h.metrics)==null?void 0:G.row_count)=="number"?h.metrics.row_count:null,B=w.length,L=E.length,D=R.length,q=A.length,Y=y.useMemo(()=>KT(g),[g]),W=y.useMemo(()=>{const Q=[];if(Q.push({label:"Target column",value:j||"Not set"}),Q.push({label:"Feature columns",value:d(B)}),F!==null&&Q.push({label:"Preview rows",value:d(F)}),L&&Q.push({label:"Auto-selected features",value:d(L)}),q&&Q.push({label:"Configured features missing",value:d(q)}),D&&Q.push({label:"Excluded columns",value:d(D)}),P){const ne=d(P),J=T!==null?f(T):null;Q.push({label:"Target missing values",value:J?`${ne} (${J})`:ne})}return Q},[L,D,B,d,f,q,F,j,P,T]),X=y.useMemo(()=>t?n?null:"Link this node to the upstream dataset to resolve feature columns.":"Connect this node to a dataset to confirm feature and target mappings.",[n,t]),I=y.useMemo(()=>!t||!n?null:p==="idle"?"Refresh the preview to surface feature/target diagnostics.":null,[n,p,t]),z=y.useMemo(()=>j?p==="success"&&j&&!_.includes(j)?`Target column "${j}" is not present in the current preview output.`:null:"Set a target column so downstream nodes understand the supervised objective.",[_,p,j]),H=!!t&&n&&p!=="loading";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Feature/target separation"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:!H,children:p==="loading"?"Refreshing...":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Confirm which columns feed the feature matrix (X) and which column serves as the supervised target (y). This metadata helps downstream modeling nodes stay aligned with the configured training objective."}),X&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:X}),s.error&&p==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),I&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:I}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:z}),q>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Missing configured feature columns: ",Th(A),"."]}),D>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Columns excluded from the feature matrix: ",Th(R),"."]}),L>0&&k.length===0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--info",children:["Auto-selected feature columns: ",Th(E),"."]}),Y&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:Y}),W.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:W.map(Q=>a.jsxs("li",{children:[Q.label,": ",a.jsx("strong",{children:Q.value})]},`feature-target-summary-${Q.label}`))}),a.jsx("div",{className:"canvas-modal__parameter-grid",children:c&&u(c)}),p==="success"&&B===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"No feature columns detected. Confirm that the dataset includes columns other than the target."}),j&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Target dtype: ",O?a.jsx("strong",{children:O}):a.jsx("span",{children:"Unknown"}),P?` - Missing rows flagged for review: ${d(P)}.`:""]})]})},QT=(e,t)=>{if(!e.length)return null;const n=e.filter(s=>!(s!=null&&s.node_id)||s.node_id===t);return n.length?n[n.length-1]:e[e.length-1]},qr=e=>`${(e*100).toFixed(1)}%`,XT=({nodeId:e,sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:i,config:l,parameters:c,renderParameterField:u,formatMetricValue:d})=>{var T,O;const f=s.data,h=s.status,p=Array.isArray((T=f==null?void 0:f.signals)==null?void 0:T.train_test_split)?(O=f==null?void 0:f.signals)==null?void 0:O.train_test_split:[],g=QT(p,e),_=(l==null?void 0:l.test_size)??.2,N=(l==null?void 0:l.validation_size)??0,v=l==null?void 0:l.random_state;l==null||l.shuffle;const x=(l==null?void 0:l.stratify)??!1,j=(l==null?void 0:l.target_column)??"",k=N>0,S=y.useMemo(()=>g?{trainSize:g.train_size??0,validationSize:g.validation_size??0,testSize:g.test_size??0,totalSize:g.total_size??0,trainRatio:g.train_size&&g.total_size?g.train_size/g.total_size:0,validationRatio:g.validation_ratio??0,testRatio:g.test_ratio??0}:{trainSize:0,validationSize:0,testSize:0,totalSize:0,trainRatio:1-_-N,validationRatio:N,testRatio:_},[g,_,N]),C=c.find(F=>F.name==="test_size"),w=c.find(F=>F.name==="validation_size"),E=c.find(F=>F.name==="random_state"),A=c.find(F=>F.name==="shuffle"),R=c.find(F=>F.name==="stratify"),P=c.find(F=>F.name==="target_column");return a.jsxs("div",{className:"node-settings__section",children:[a.jsx("div",{className:"node-settings__section-header",children:a.jsx("h3",{children:"Train/Test Split Configuration"})}),a.jsxs("div",{className:"node-settings__field-group",children:[C&&u(C),w&&u(w),E&&u(E),A&&u(A),R&&u(R),x&&P&&u(P)]}),h==="success"&&g&&a.jsxs("div",{className:"node-settings__info-panel",children:[a.jsx("h4",{className:"node-settings__info-title",children:"Split Summary"}),a.jsx("div",{className:"node-settings__split-visualization",children:a.jsxs("div",{className:"split-bar",children:[a.jsx("div",{className:"split-bar__segment split-bar__segment--train",style:{width:qr(S.trainRatio)},title:`Training: ${S.trainSize} rows (${qr(S.trainRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Train"})}),k&&a.jsx("div",{className:"split-bar__segment split-bar__segment--validation",style:{width:qr(S.validationRatio)},title:`Validation: ${S.validationSize} rows (${qr(S.validationRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Val"})}),a.jsx("div",{className:"split-bar__segment split-bar__segment--test",style:{width:qr(S.testRatio)},title:`Test: ${S.testSize} rows (${qr(S.testRatio)})`,children:a.jsx("span",{className:"split-bar__label",children:"Test"})})]})}),a.jsxs("div",{className:"node-settings__stats-grid",children:[a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Total rows:"}),a.jsx("span",{className:"node-settings__stat-value",children:d(S.totalSize,0)})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Training:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(S.trainSize,0)," (",qr(S.trainRatio),")"]})]}),k&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Validation:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(S.validationSize,0)," (",qr(S.validationRatio),")"]})]}),a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Test:"}),a.jsxs("span",{className:"node-settings__stat-value",children:[d(S.testSize,0)," (",qr(S.testRatio),")"]})]}),x&&j&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Stratified by:"}),a.jsx("span",{className:"node-settings__stat-value",children:j})]}),v!==void 0&&a.jsxs("div",{className:"node-settings__stat-item",children:[a.jsx("span",{className:"node-settings__stat-label",children:"Random state:"}),a.jsx("span",{className:"node-settings__stat-value",children:v})]})]})]}),!n&&a.jsxs("div",{className:"node-settings__warning",children:[a.jsx("span",{className:"node-settings__warning-icon",children:""}),"Connect this node to a data source to configure the split."]}),h==="loading"&&a.jsx("div",{className:"node-settings__loading",children:"Loading preview..."}),h==="error"&&a.jsxs("div",{className:"node-settings__error",children:[a.jsx("span",{className:"node-settings__error-icon",children:""}),"Failed to load preview. Try refreshing."]})]})},JT={classification:"Classification",regression:"Regression"},ZT=e=>e==="numeric"||e==="integer",e2=e=>{if(!e)return!1;const t=e.toLowerCase();return t.includes("int")||t.includes("float")||t.includes("double")||t.includes("decimal")||t.includes("number")},$h=(e,t=3)=>e.length===0?"":e.length<=t?e.join(", "):`${e.slice(0,t).join(", ")}, ...`,t2=e=>{for(let t=e.length-1;t>=0;t-=1){const n=e[t];if(typeof n=="string"&&n.toLowerCase().startsWith("train model draft"))return n}return null},n2=({sourceId:e,hasReachableSource:t,previewState:n,onRefreshPreview:s,config:i,targetColumnParameter:l,problemTypeParameter:c,renderParameterField:u,formatMetricValue:d,formatMissingPercentage:f,schemaColumns:h})=>{var V;const p=n.data,g=n.status,_=Array.isArray(p==null?void 0:p.applied_steps)?p.applied_steps:[],N=Array.isArray(p==null?void 0:p.column_stats)?p.column_stats:[],v=(p==null?void 0:p.metrics)??null,x=y.useMemo(()=>Array.isArray(p==null?void 0:p.columns)?p.columns.filter(G=>typeof G=="string"&&G.trim().length>0):[],[p==null?void 0:p.columns]),j=y.useMemo(()=>{var G;return h.length?h:Array.isArray((G=p==null?void 0:p.schema)==null?void 0:G.columns)?p.schema.columns:x.length>0?x.map(Q=>({name:Q,pandas_dtype:null,logical_family:"unknown",nullable:!0})):[]},[(V=p==null?void 0:p.schema)==null?void 0:V.columns,x,h]),k=y.useMemo(()=>{const G=new Map;return j.forEach(Q=>{Q!=null&&Q.name&&G.set(Q.name,Q)}),G},[j]),S=(i==null?void 0:i.targetColumn)??"",C=(i==null?void 0:i.problemType)??"classification",w=S?N.find(G=>(G==null?void 0:G.name)===S)??null:null,A=!!(S?k.get(S)??null:null),R=y.useMemo(()=>{const G=new Set;return N.forEach(Q=>{Q!=null&&Q.name&&Q.name!==S&&G.add(Q.name)}),j.forEach(Q=>{Q!=null&&Q.name&&Q.name!==S&&G.add(Q.name)}),Array.from(G).sort()},[N,j,S]),P=y.useMemo(()=>R.filter(G=>{const Q=k.get(G);if(Q&&ZT(Q.logical_family))return!0;const ne=N.find(J=>J.name===G);return e2((ne==null?void 0:ne.dtype)??null)}),[N,R,k]),T=y.useMemo(()=>new Set(P),[P]),O=y.useMemo(()=>R.filter(G=>!T.has(G)),[R,T]),F=y.useMemo(()=>N.filter(G=>(G==null?void 0:G.name)&&G.name!==S&&(G.missing_count??0)>0).map(G=>G.name),[N,S]),B=typeof(v==null?void 0:v.row_count)=="number"?v.row_count:null,L=typeof(w==null?void 0:w.distinct_count)=="number"&&Number.isFinite(w.distinct_count)?w.distinct_count:null,D=typeof(w==null?void 0:w.missing_count)=="number"?w.missing_count:0,q=typeof(w==null?void 0:w.missing_percentage)=="number"?w.missing_percentage:null,Y=y.useMemo(()=>{const G=[];return S?g!=="success"?G:!w&&!A&&!R.length?(G.push(`Target column "${S}" is not present in the preview output, and no feature columns were found.`),G):(R.length||G.push("Add at least one feature column in addition to the target before training."),w&&D>0&&G.push(`Target column includes ${D} missing value${D===1?"":"s"}.`),C==="classification"&&w&&(L??0)<2&&G.push("Classification tasks require at least two distinct target classes."),C==="regression"&&P.length===0&&G.push("Regression tasks need at least one numeric feature column."),F.length>0&&G.push(`Feature columns with missing values: ${$h(F)}.`),B!==null&&B===0&&G.push("Preview returned zero rows after upstream transformations."),G):(G.push("Set a target column to evaluate downstream modeling constraints."),G)},[F,R.length,D,P.length,B,g,C,S,L,w,A]),W=y.useMemo(()=>JT[C],[C]),X=y.useMemo(()=>{const G=[{label:"Problem type",value:W},{label:"Target column",value:S||"Not set"}];if(g==="success"){if(L!==null&&G.push({label:"Target distinct values",value:d(L)}),w){const Q=d(D),ne=q!==null?f(q):null;G.push({label:"Target missing values",value:ne?`${Q} (${ne})`:Q})}F.length>0&&G.push({label:"Features with missing values",value:d(F.length)})}return G},[W,F.length,d,f,D,g,S,L,q,w]),I=y.useMemo(()=>e?t?null:"Link this node to upstream transforms to analyse the feature set that reaches it.":"Connect this node to a dataset to validate training readiness.",[t,e]),z=y.useMemo(()=>!e||!t?null:g==="idle"?"Refresh the preview to surface downstream modeling checks.":null,[t,g,e]),H=y.useMemo(()=>t2(_),[_]),te=!!e&&t&&g!=="loading",K=y.useMemo(()=>!S||g!=="success"||Y.length>0?null:"No critical blockers detected in the preview. Proceed with downstream training when ready.",[g,Y.length,S]);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Train model readiness"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:s,disabled:!te,children:g==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Validate that the pipeline output is ready for lightweight training by checking the target column, feature balance, and missing values against the cached preview."}),I&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:I}),n.error&&g==="error"&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:n.error}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:z}),Y.map((G,Q)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:G},`train-model-issue-${Q}`)),K&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:K}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:H}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[l&&u(l),c&&u(c)]}),X.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:X.map(G=>a.jsxs("li",{children:[G.label,": ",a.jsx("strong",{children:G.value})]},`train-model-summary-${G.label}`))}),g==="success"&&F.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Features with missing values: ",$h(F),"."]}),g==="success"&&C==="regression"&&O.length>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Non-numeric features detected: ",$h(O),". Consider encoding or casting them before training regression models."]})]})},Wb=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?zs(e,Math.abs(e)>=1?2:4):String(e);if(typeof e=="string")return e;if(typeof e=="boolean")return e?"True":"False";if(e instanceof Date)return e.toISOString();if(Array.isArray(e))return e.length?JSON.stringify(e):"[]";if(typeof e=="object")try{return JSON.stringify(e)}catch{return String(e)}return String(e)},s2=e=>e||"Unknown",r2=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},Rn=e=>{const t=r2(e);if(!t)return null;const n=Math.round((Date.now()-t.getTime())/6e4);if(n<1)return"just now";if(n===1)return"1 minute ago";if(n<60)return`${n} minutes ago`;const s=Math.round(n/60);if(s===1)return"1 hour ago";if(s<24)return`${s} hours ago`;const i=Math.round(s/24);return i===1?"1 day ago":`${i} days ago`},Kb=e=>typeof e!="number"||!Number.isFinite(e)?"":Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3),a2=({presets:e,isOpen:t,onClose:n,onApply:s,activePresetId:i,fieldMetadata:l})=>{const[c,u]=y.useState(null);y.useEffect(()=>{var p;if(!t){u(null);return}c&&e.some(g=>g.id===c)||u(((p=e[0])==null?void 0:p.id)??null)},[t,e,c]),y.useEffect(()=>{if(!t)return;const p=g=>{g.key==="Escape"&&n()};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[t,n]);const d=y.useMemo(()=>c?e.find(p=>p.id===c)??e[0]??null:e[0]??null,[e,c]),f=y.useMemo(()=>!i||!d?!1:i===d.id,[i,d]),h=y.useMemo(()=>{var x,j;if(!t||!e.length)return null;const p=((x=d==null?void 0:d.modelType)==null?void 0:x.toLowerCase())==="logistic_regression"?(j=d==null?void 0:d.params)==null?void 0:j.solver:null,g=typeof p=="string"?p.trim().toLowerCase():null,_=g&&(g==="sag"||g==="saga")?"SAG and SAGA solvers expect standardized features. Scale inputs before training to improve convergence and avoid repeated warnings.":null,N=d?Object.entries(d.params??{}).sort(([k],[S])=>k.localeCompare(S)).map(([k,S])=>{const C=l==null?void 0:l[k],w=O=>{var F;return(F=C==null?void 0:C.options)!=null&&F.length?C.options.find(B=>{const L=B.value;return O==null?L===null||typeof L=="string"&&L.trim().toLowerCase()==="none":typeof O=="string"&&typeof L=="string"?L===O?!0:L.trim().toLowerCase()===O.trim().toLowerCase():String(L)===String(O)})??null:null},E=O=>{if(O===null)return C!=null&&C.nullable?"None":"";if(O===void 0)return"";if(typeof O=="boolean")return O?"true":"false";if(typeof O=="number")return Number.isFinite(O)?O.toString():String(O);if(O&&typeof O=="object")try{return JSON.stringify(O)}catch{return"[object]"}return String(O??"")},A=O=>{var D;if(!O)return null;const F=O.value,B=(D=O.label)==null?void 0:D.trim(),L=E(F);return B&&L&&B!==L?`${B} (${L})`:B||L},R=()=>{if(C&&C.default!==void 0){const O=P(C.default,!1);if(O.text)return{text:O.text,note:"Using estimator default"}}return{text:"",note:"Using estimator default"}},P=(O,F=!0)=>{const B=w(O);return B?{text:A(B)??"",note:null}:Array.isArray(O)?O.length===0?F?R():{text:"",note:null}:{text:O.map(D=>P(D,!1)).map(D=>D.text).filter(Boolean).join(", "),note:null}:O===void 0||typeof O=="string"&&O.trim()===""?F?R():{text:"",note:null}:O===null?C!=null&&C.nullable?{text:"None",note:null}:F?R():{text:"",note:null}:{text:E(O),note:null}},T=P(S);return{key:k,label:(C==null?void 0:C.label)??k,description:(C==null?void 0:C.description)??null,value:T.text,note:T.note}}):[],v=d!=null&&d.finishedAt?Rn(d.finishedAt):null;return a.jsxs("div",{className:"canvas-modal best-param-modal",role:"dialog","aria-modal":"true",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:n}),a.jsxs("div",{className:"canvas-modal__panel best-param-modal__panel",role:"document",children:[a.jsxs("header",{className:"best-param-modal__header",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"best-param-modal__title",children:"Tuned Hyperparameter Presets"}),a.jsx("p",{className:"best-param-modal__subtitle",children:"Review hyperparameter sets discovered by recent tuning runs and apply them to the current model."})]}),a.jsx("button",{type:"button",className:"best-param-modal__close",onClick:n,children:"Close"})]}),a.jsxs("div",{className:"best-param-modal__layout",children:[a.jsx("aside",{className:"best-param-modal__list","aria-label":"Tuned presets",children:e.map(k=>{const S=k.id===(d==null?void 0:d.id),C=k.finishedAt?Rn(k.finishedAt):null;return a.jsxs("button",{type:"button",className:`best-param-modal__list-button${S?" best-param-modal__list-button--active":""}`,onClick:()=>u(k.id),children:[a.jsx("span",{className:"best-param-modal__list-title",children:k.label}),a.jsxs("span",{className:"best-param-modal__list-meta",children:[k.runNumber?`Run ${k.runNumber}`:"Tuning run",C?`  ${C}`:""]}),k.scoring&&a.jsxs("span",{className:"best-param-modal__list-score",children:[k.scoring,": ",Kb(k.score)]}),k.targetColumn&&a.jsxs("span",{className:"best-param-modal__list-target",children:["Target: ",k.targetColumn]})]},k.id)})}),a.jsx("section",{className:"best-param-modal__details",children:d?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"best-param-modal__summary",children:[a.jsxs("div",{className:"best-param-modal__summary-main",children:[a.jsx("h4",{children:d.label}),a.jsxs("p",{children:[d.runNumber?`Run ${d.runNumber}`:"Tuning run",v?`  ${v}`:"",d.searchStrategy?`  ${d.searchStrategy}`:""]}),a.jsxs("p",{children:["Model: ",a.jsx("strong",{children:d.modelType}),d.targetColumn?a.jsxs(a.Fragment,{children:[" "," Target: ",a.jsx("strong",{children:d.targetColumn})]}):null,d.scoring?a.jsxs(a.Fragment,{children:[" "," ",d.scoring,": ",a.jsx("strong",{children:Kb(d.score)})]}):null]})]}),a.jsx("div",{className:"best-param-modal__summary-actions",children:a.jsx("button",{type:"button",className:"best-param-modal__apply",onClick:()=>s(d),disabled:!N.length,children:f?"Already applied":"Apply preset"})})]}),d.description&&a.jsx("p",{className:"best-param-modal__note",children:d.description}),_&&a.jsxs("div",{className:"best-param-modal__notice best-param-modal__notice--warning",children:[a.jsx("strong",{children:"Tip:"})," ",_]}),a.jsx("div",{className:"best-param-modal__param-grid",role:"table",children:N.length?N.map(k=>a.jsxs("div",{className:"best-param-modal__param-row",role:"row",children:[a.jsxs("div",{className:"best-param-modal__param-name",role:"cell",children:[a.jsxs("div",{className:"best-param-modal__param-label",children:[k.label,k.label!==k.key&&a.jsx("span",{className:"best-param-modal__param-key",children:a.jsx("code",{children:k.key})})]}),k.description&&a.jsx("div",{className:"best-param-modal__param-description",children:k.description})]}),a.jsxs("div",{className:"best-param-modal__param-value",role:"cell",children:[a.jsx("code",{children:k.value}),k.note&&a.jsx("span",{className:"best-param-modal__param-note",children:k.note})]})]},k.key)):a.jsx("p",{className:"best-param-modal__empty",children:"No hyperparameters available for this preset."})})]}):a.jsx("p",{className:"best-param-modal__empty",children:"Select a tuning run to inspect its hyperparameters."})})]})]})]})},[i,f,l,t,s,n,e,d]);return h?eg.createPortal(h,document.body):null},o2=new Set(["scale_numeric_features","scaling","scale_numeric"]),i2=[/convergencewarning/i,/failed to converge/i,/did not converge/i,/optimizer failed to converge/i,/increase the number of iterations/i,/scale your features/i,/standardize your features/i,/consider scaling your (data|features)/i,/feature scaling is (recommended|required)/i],l2=["forest","tree","boost","xgboost","lightgbm","catboost","gradient","histgradient","bagging"],c2=["bayes","naive_bayes","gaussian_nb"],u2=e=>{const t=e.trim().toLowerCase();return t?l2.some(s=>t.includes(s))?{required:!1,reason:null}:c2.some(s=>t.includes(s))?{required:!1,reason:null}:t.includes("logistic")?{required:!0,reason:"logistic"}:t.includes("svm")||t.includes("svc")||t.includes("svr")?{required:!0,reason:"svm"}:t.includes("knn")||t.includes("nearest")?{required:!0,reason:"knn"}:t.includes("sgd")||t.includes("perceptron")?{required:!0,reason:"sgd"}:["linear","ridge","lasso","elastic","regression"].some(s=>t.includes(s))?{required:!0,reason:"linear"}:{required:!1,reason:null}:{required:!1,reason:null}},d2=(e,t)=>{const n=new Set;if(!e||!t)return n;const s=Array.isArray(e.edges)?e.edges:[],i=[t];for(;i.length;){const l=i.pop();if(l)for(const c of s){if(!c)continue;const u=typeof c.source=="string"?c.source.trim():"",d=typeof c.target=="string"?c.target.trim():"";!u||!d||d===l&&!n.has(u)&&(n.add(u),i.push(u))}}return n},m2=(e,t)=>{if(!e||!t)return!1;const n=d2(e,t);return n.size?(Array.isArray(e.nodes)?e.nodes:[]).some(i=>{var c;if(!i||typeof i.id!="string"||!n.has(i.id))return!1;const l=String(((c=i==null?void 0:i.data)==null?void 0:c.catalogType)??(i==null?void 0:i.type)??"").toLowerCase();return l?o2.has(l)?!0:l.includes("scale")&&l.includes("numeric"):!1}):!1},h2=(e,t)=>{const n=t.find(s=>(s==null?void 0:s.value)===e);return n!=null&&n.label?n.label:e.replace(/_/g," ").replace(/\s+/g," ").trim()},Ph=(e,t=new Set,n=0)=>{if(e==null)return[];if(typeof e=="string")return[e];if(typeof e=="number"||typeof e=="boolean")return[];if(n>3)return[];if(Array.isArray(e)){if(!e.length)return[];const s=32,i=[];for(let l=0;l<e.length&&l<s;l+=1)i.push(...Ph(e[l],t,n+1));return i}if(typeof e=="object"){if(t.has(e))return[];t.add(e);const s=Object.values(e);if(!s.length)return[];const i=32,l=[];for(let c=0;c<s.length&&c<i;c+=1)l.push(...Ph(s[c],t,n+1));return l}return[]},Ci=e=>{if(!e)return!1;const t=Ph(e);return t.length?t.some(n=>i2.some(s=>s.test(n))):!1},Bl=e=>{var n,s,i,l,c,u,d,f,h,p,g,_,N,v;if(!e)return!1;const t=[e.error_message,e.warning_message,e.message,e.details,e.notes,e.status_reason,e.status_message,e.error,(n=e.metadata)==null?void 0:n.warnings,(s=e.metadata)==null?void 0:s.warning,(i=e.metadata)==null?void 0:i.notes,(l=e.metadata)==null?void 0:l.messages,(c=e.metadata)==null?void 0:c.message,(u=e.metadata)==null?void 0:u.errors,(d=e.metrics)==null?void 0:d.warnings,(f=e.metrics)==null?void 0:f.warning,(h=e.metrics)==null?void 0:h.messages,(p=e.metrics)==null?void 0:p.message,(g=e.job_metadata)==null?void 0:g.warnings,(_=e.job_metadata)==null?void 0:_.warning,(N=e.job_metadata)==null?void 0:N.messages,(v=e.job_metadata)==null?void 0:v.notes];for(const x of t)if(Ci(x))return!0;return!!(Ci(e.metadata)||Ci(e.metrics))},f2=(e,t,n)=>{const s=t||"This model";switch(e){case"logistic":return{headline:`${s} needs scaled numeric features`,summary:'Standardize numeric inputs before launching jobs to keep the logistic solver stable and avoid repeated "scale your features" warnings.',details:["Insert a Scale numeric features step before this node or reuse an upstream scaler.","StandardScaler works for most datasets; RobustScaler can help when outliers dominate.","Once scaling is in place, re-run tuning or training so the solver converges cleanly."]};case"svm":return{headline:`${s} is sensitive to feature scale`,summary:"Support Vector Machines depend on distance calculations. Keep numeric features on comparable scales to preserve margin geometry.",details:["Add the Scale numeric features step upstream of this node.","Try StandardScaler or MinMaxScaler depending on the kernel and expected ranges.","Retrain after scaling to refresh support vectors and hyperparameters."]};case"knn":return{headline:`${s} uses distance-based comparisons`,summary:"k-NN models weigh distances directly, so unscaled columns dominate neighbors. Scale numeric fields to keep votes balanced.",details:["Drop in a Scale numeric features step before launching jobs.","MinMaxScaler keeps features in [0, 1]; StandardScaler works when values are roughly normal.","Requeue jobs after scaling so neighbor search reflects the new feature space."]};case"sgd":return{headline:`${s} benefits from normalized inputs`,summary:"Stochastic gradient models converge faster and produce steadier coefficients when numeric inputs share a common scale.",details:["Insert a Scale numeric features node prior to this step.","StandardScaler plus optional RobustScaler for heavy-tailed features keeps gradients stable.","Re-run jobs after scaling to avoid exploding or vanishing updates."]};default:return{headline:`${s} prefers standardized numeric features`,summary:n==="regression"?"Linear regression families rely on comparable feature magnitudes. Scaling keeps coefficients well-conditioned and improves R stability.":"Linear classification models respond better when numeric inputs share a common scale. Scaling prevents any single column from dominating the loss.",details:["Add the Scale numeric features step ahead of this node or reuse an existing scaler.","StandardScaler is a safe default; RobustScaler helps when outliers skew distributions.","Re-launch jobs once scaling is applied so coefficients represent the standardized space."]}}},Yb=({graph:e,nodeId:t,modelType:n,problemType:s,modelTypeOptions:i,enabled:l})=>y.useMemo(()=>{if(!l||!n||!n.trim()||m2(e,t))return null;const c=n.trim().toLowerCase(),{required:u,reason:d}=u2(c);if(!u||!d)return null;const f=h2(n,i);return f2(d,f,s)},[l,e,n,i,t,s]),p2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},Si={classification:["accuracy","f1_weighted","roc_auc","precision_weighted","recall_weighted"],regression:["rmse","mae","r2"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},Rh=(e,t)=>{if(!e)return{};const n={};return Object.entries(e).forEach(([s,i])=>{t.has(s)&&(n[s]=i)}),n},Gb=(e,t)=>{if(e===t||typeof e=="number"&&typeof t=="number"&&Number.isNaN(e)&&Number.isNaN(t))return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length!==t.length?!1:e.every((n,s)=>Gb(n,t[s]));if(e&&t&&typeof e=="object"&&typeof t=="object")try{return JSON.stringify(e)===JSON.stringify(t)}catch{return!1}return!1},g2=(e,t,n)=>{if(!e)return{};const s={};return Object.entries(e).forEach(([i,l])=>{if(!t.has(i)||l===""||l===null||l===void 0)return;const c=n==null?void 0:n[i];let u=l;if(c){if(typeof u=="string"){const d=u.trim();if(!d)return;c.type==="select"&&(u=d)}if(c.name==="multi_class"&&typeof u=="string"){const d=u.trim().toLowerCase();if(d==="auto")return;(d==="ovr"||d==="multinomial")&&(u=d)}if(c.default!==void 0){if(typeof c.default=="string"&&typeof u=="string"){const d=c.default.trim(),f=u.trim();if(d===f)return}else if(Gb(c.default,u))return}}s[i]=u}),s},Qb=e=>!!e&&typeof e=="object"&&!Array.isArray(e),Ul=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},_2=e=>{if(!e)return Si.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regressor"))return Si.regression;if(t.includes("classifier")||t.includes("classification"))return Si.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?Si.regression:n==="classification"?Si.classification:Si.fallback},v2=e=>{var l,c,u;if(!e)return null;const t=[],n=(c=(l=e==null?void 0:e.cross_validation)==null?void 0:l.metrics)==null?void 0:c.mean;Qb(n)&&((u=e==null?void 0:e.cross_validation)==null?void 0:u.status)==="completed"&&t.push({dataset:n,labelPrefix:"CV mean "});const s=[e.test,e.validation,e.train];for(const d of s)Qb(d)&&t.push({dataset:d,labelPrefix:""});const i=_2(e);for(const d of t)for(const f of i){const h=d.dataset[f];if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${f}`:f,value:h}}for(const d of t)for(const[f,h]of Object.entries(d.dataset))if(typeof h=="number"&&Number.isFinite(h))return{label:d.labelPrefix?`${d.labelPrefix}${f}`:f,value:h};return null},Xb=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",y2=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:i,cvConfig:l,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:f,hyperparametersParameter:h,cvEnabledParameter:p,cvStrategyParameter:g,cvFoldsParameter:_,cvShuffleParameter:N,cvRandomStateParameter:v,cvRefitStrategyParameter:x,onSaveDraftConfig:j})=>{var Fn,Us,os,qs;const k=ho(),[S,C]=y.useState(null),[w,E]=y.useState(null),[A,R]=y.useState(null),[P,T]=y.useState(0),[O,F]=y.useState({}),[B,L]=y.useState(!1),D=y.useRef(!1),[q,Y]=y.useState(null),[W,X]=y.useState(!1),[I,z]=y.useState(!1),[H,te]=y.useState(null),[K,V]=y.useState(null),[G,Q]=y.useState(!1),ne=((s==null?void 0:s.targetColumn)??"").trim(),J=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",re=((i==null?void 0:i.modelType)??"").trim(),Se=(i==null?void 0:i.hyperparameters)??null,Re=(i==null?void 0:i.hyperparametersError)??null,Oe=!!(l!=null&&l.enabled),Fe=(l==null?void 0:l.strategy)??"auto",lt=typeof(l==null?void 0:l.folds)=="number"?l.folds:0,Be=!!(l!=null&&l.shuffle),de=(l==null?void 0:l.randomState)??null,pe=(l==null?void 0:l.refitStrategy)??"train_plus_validation",xe=y.useMemo(()=>d?f.length?{...d,options:f}:d:null,[f,d]),ke=$s({queryKey:["model-hyperparameters",re],queryFn:()=>xu(re),enabled:!!re,staleTime:5*60*1e3}),Ue=$s({queryKey:["best-hyperparameters",re,q,t],queryFn:()=>wy(re,{pipelineId:q||void 0,datasetSourceId:t||void 0}),enabled:!!(re&&t),staleTime:30*1e3,retry:1}),ce=((Fn=ke.data)==null?void 0:Fn.fields)??[],Me=((Us=ke.data)==null?void 0:Us.defaults)??{},Ye=y.useMemo(()=>ce.length?new Set(ce.map(ie=>ie.name)):new Set,[ce]),at=y.useMemo(()=>ce.length?ce.reduce((ie,_e)=>(_e!=null&&_e.name&&(ie[_e.name]=_e),ie),{}):{},[ce]),Ze=y.useMemo(()=>{if(!re||!Se||Ye.size===0)return null;const ie=Rh(Se,Ye);return Object.keys(ie).length>0?ie:null},[Ye,Se,re]);y.useEffect(()=>{F({}),L(!1),D.current=!1},[re]),y.useEffect(()=>{Ze&&(F(ie=>{const _e=Object.keys(ie),$e=Object.keys(Ze);return _e.length===$e.length&&$e.every(we=>Object.is(ie[we],Ze[we]))?ie:Ze}),D.current||(L(!0),D.current=!0))},[Ze]),y.useEffect(()=>{if(!re||Ze||Ye.size===0||!Me||Object.keys(Me).length===0)return;const ie=Rh(Me,Ye);Object.keys(ie).length!==0&&F(_e=>Object.keys(_e).length>0?_e:ie)},[Ye,Ze,Me,re]);const _t=y.useMemo(()=>{if(Ye.size===0)return null;const ie=g2(O,Ye,at);return Object.keys(ie).length>0?ie:null},[Ye,O]),st=y.useCallback(()=>{L(ie=>{const _e=!ie;return _e&&(D.current=!0),_e})},[]),dt=y.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),jt=y.useMemo(()=>{if(!dt)return null;if(!c||Object.keys(c).length===0)return dt;const ie=Ul(dt);return!ie||!Array.isArray(ie.nodes)||(ie.nodes=ie.nodes.map(_e=>{if(!_e||_e.id!==e)return _e;const $e=(_e==null?void 0:_e.data)??{},we={...($e==null?void 0:$e.config)??{},...c};return{..._e,data:{...$e,config:we,isConfigured:!0}}})),ie},[c,dt,e]);y.useEffect(()=>{let ie=!1;return!t||!dt?(Y(null),()=>{ie=!0}):(xo(t,dt).then(_e=>{ie||Y(_e)}).catch(()=>{ie||Y(null)}),()=>{ie=!0})},[dt,t]),y.useEffect(()=>{let ie=!1;E(null);const _e=jt??dt;return!t||!_e?(C(null),()=>{ie=!0}):(xo(t,_e).then($e=>{ie||C($e)}).catch($e=>{ie||(E(($e==null?void 0:$e.message)??"Unable to compute pipeline ID"),C(null))}),()=>{ie=!0})},[dt,jt,t]),y.useEffect(()=>{if(!S||!q){X(!1);return}X(S!==q)},[S,q]);const zt=y.useMemo(()=>["feature-canvas","training-jobs",t??"none",S??"pending",e],[e,S,t]),Ge=y.useMemo(()=>["feature-canvas","tuning-jobs",t??"none",S??"pending",e],[e,S,t]),Ft=!!(t&&e),Kt=$s({queryKey:Ge,queryFn:async()=>{var _e;const ie={datasetSourceId:t||void 0,limit:5};if(S){const $e=await Ol({...ie,pipelineId:S});if((((_e=$e==null?void 0:$e.jobs)==null?void 0:_e.length)??0)>0)return $e}return Ol(ie)},enabled:Ft,retry:(ie,_e)=>_e.message.includes("Sign in")?!1:ie<2,refetchInterval:ie=>{const _e=ie.state.data;return((_e==null?void 0:_e.jobs)??[]).some(we=>we.status==="queued"||we.status==="running")?5e3:!1}}),Mt=$s({queryKey:zt,queryFn:async()=>{var _e;const ie={datasetSourceId:t||void 0,nodeId:e,limit:5};if(S){const $e=await Al({...ie,pipelineId:S});if((((_e=$e==null?void 0:$e.jobs)==null?void 0:_e.length)??0)>0)return $e}return Al(ie)},enabled:Ft,retry:(ie,_e)=>_e.message.includes("Sign in")?!1:ie<2,refetchInterval:ie=>{const _e=ie.state.data;return((_e==null?void 0:_e.jobs)??[]).some(we=>we.status==="queued"||we.status==="running")?5e3:!1}}),{mutateAsync:tn,isPending:Sn,error:At}=Bc({mutationFn:vy,onSuccess:ie=>{const _e=Array.isArray(ie.jobs)?ie.jobs.length:0,$e=_e>0?ie.jobs[0]:null;R($e),T(_e),k.invalidateQueries({queryKey:zt})}}),nn=Kt.error,En=Kt.isLoading||Kt.isFetching,It=((os=Kt.data)==null?void 0:os.jobs)??[],ut=Ue.data,zn=y.useCallback(ie=>{if(!ie)return null;const _e=Object.keys(ie);if(_e.length===0)return null;if(Ye.size===0)return{params:ie,hasUnmapped:!1};const $e=Rh(ie,Ye),Ct=Object.keys($e);return Ct.length>0?{params:$e,hasUnmapped:Ct.length!==_e.length}:{params:ie,hasUnmapped:!0}},[Ye]),Qt=y.useMemo(()=>It.length?It.filter(ie=>ie.status==="succeeded"):[],[It]),ft=y.useMemo(()=>{if(!re)return[];const ie=[],_e=new Set,$e=ne?ne.trim().toLowerCase():"",Ct=we=>!$e||!we?!0:we.trim().toLowerCase()===$e;if(ut!=null&&ut.available&&ut.best_params&&(!ut.model_type||ut.model_type===re)){const we=zn(ut.best_params);if(we){const rt=ut.job_id??null;if(!rt||!_e.has(rt)){const ct=["Most recent tuned run"];ut.run_number&&ct.push(`#${ut.run_number}`);const Lt=`best-api-${rt??re}`;ie.push({id:Lt,label:ct.join(" "),source:"best-api",modelType:ut.model_type??re,params:we.params,jobId:rt,nodeId:ut.node_id??null,runNumber:ut.run_number??null,score:ut.best_score??null,scoring:ut.scoring??null,finishedAt:ut.finished_at??null,searchStrategy:ut.search_strategy??null,nIterations:ut.n_iterations??null,targetColumn:ne||null,pipelineId:ut.pipeline_id??null,datasetSourceId:t??null,description:we.hasUnmapped?"Includes parameters outside the current template. They will be stored as custom overrides.":null}),rt&&_e.add(rt)}}}return Qt.forEach(we=>{var Xt,gs,Mn,fn,dn;if(!we.best_params||we.model_type!==re||t&&we.dataset_source_id&&we.dataset_source_id!==t||_e.has(we.id))return;const rt=zn(we.best_params);if(!rt)return;const ct=typeof((Xt=we.metadata)==null?void 0:Xt.target_column)=="string"?we.metadata.target_column:typeof((gs=we.metadata)==null?void 0:gs.targetColumn)=="string"?we.metadata.targetColumn:null;if(!Ct(ct))return;const Lt=`job-${we.id}`,Ot=(()=>{var In;const Gn=typeof((In=we.metadata)==null?void 0:In.label)=="string"?we.metadata.label.trim():"";return Gn||(we.run_number?`Run ${we.run_number}`:`Job ${we.id.slice(0,6)}`)})(),Pt=typeof((Mn=we.metadata)==null?void 0:Mn.scoring)=="string"?we.metadata.scoring:typeof((fn=we.metrics)==null?void 0:fn.scoring)=="string"?we.metrics.scoring:null,Dt=typeof((dn=we.metadata)==null?void 0:dn.n_iterations)=="number"?we.metadata.n_iterations:null;ie.push({id:Lt,label:Ot,source:"tuning-job",modelType:we.model_type,params:rt.params,jobId:we.id,nodeId:we.node_id,runNumber:we.run_number??null,score:we.best_score??null,scoring:Pt,finishedAt:we.updated_at??we.created_at??null,searchStrategy:we.search_strategy??null,nIterations:Dt,targetColumn:ct??(ne||null),pipelineId:we.pipeline_id??null,datasetSourceId:we.dataset_source_id??null,description:rt.hasUnmapped?"Some tuned parameters fall outside the current template and will be saved as custom overrides.":null}),_e.add(we.id)}),ie.sort((we,rt)=>{const ct=we.finishedAt?Date.parse(we.finishedAt):0,Lt=rt.finishedAt?Date.parse(rt.finishedAt):0;return ct!==Lt?Lt-ct:(rt.runNumber??0)-(we.runNumber??0)}),ie},[ut,zn,re,t,ne,Qt]),tt=ft[0]??null,fs=ft.length>0,Vt=!tt,pt=!fs,bt=y.useMemo(()=>Qt.length?Qt.slice().sort((ie,_e)=>{const $e=Date.parse(ie.updated_at||ie.created_at||"0");return Date.parse(_e.updated_at||_e.created_at||"0")-$e})[0]:It.length?It.slice().sort((ie,_e)=>{const $e=Date.parse(ie.updated_at||ie.created_at||"0");return Date.parse(_e.updated_at||_e.created_at||"0")-$e})[0]:null,[Qt,It]),ns=bt&&(bt.updated_at||bt.created_at)||null,hn=ns?Rn(ns):null,bn=(bt==null?void 0:bt.run_number)??null,un=tt!=null&&tt.finishedAt?Rn(tt.finishedAt):null,kn=tt&&tt.scoring&&typeof tt.score=="number"&&Number.isFinite(tt.score)?`${tt.scoring}: ${Xb(tt.score)}`:null;y.useEffect(()=>{if(!ft.length){H&&te(null),(K==null?void 0:K.tone)==="success"&&V(null);return}H&&!ft.some(ie=>ie.id===H)&&(te(null),V(null))},[K,ft,H]);const sn=y.useCallback((ie,_e)=>{if(!ie||Object.keys(ie.params??{}).length===0){V({message:"Selected preset does not include any hyperparameters to apply.",tone:"warning"});return}F(()=>Ul(ie.params)),L(!0),D.current=!0,te(ie.id),V({message:_e??`Applied tuned parameters from ${ie.label}.`,tone:"success"})},[F,L,V,te]),ss=y.useCallback(()=>{if(!tt){const _e=bt&&bt.model_type&&bt.model_type!==re?`Latest tuning run targeted ${bt.model_type}. Switch the model template to reuse its parameters.`:"No tuning job results available to apply.";V({message:_e,tone:"warning"});return}const ie=tt.runNumber?`Applied tuned parameters from run ${tt.runNumber}.`:`Applied tuned parameters from ${tt.label}.`;sn(tt,ie)},[sn,bt,re,tt,V]),$t=y.useMemo(()=>{if(!K)return"rgba(148, 163, 184, 0.75)";switch(K.tone){case"success":return"rgba(134, 239, 172, 0.9)";case"warning":return"rgba(253, 186, 116, 0.95)";default:return"rgba(148, 163, 184, 0.85)"}},[K]),Dn=y.useMemo(()=>{const ie=[];return t||ie.push("Select a dataset before launching training jobs."),(!dt||!dt.nodes.length)&&ie.push("Connect this node to an upstream pipeline before training."),ne||ie.push("Set a target column in the Train model readiness section."),re||ie.push("Choose a model type before enqueuing training jobs."),Oe&&lt<2&&ie.push("Cross-validation requires at least 2 folds."),w&&ie.push(w),Re&&ie.push(Re),ie},[Oe,lt,dt,Re,re,w,t,ne]),xn=((qs=Mt.data)==null?void 0:qs.jobs)??[],wn=y.useMemo(()=>{if(!xn.length)return xn;const ie=J==null?void 0:J.toLowerCase();return xn.filter(_e=>{if(!ie)return!0;const $e=(()=>{var Lt,Ot,Pt,Dt;const we=typeof _e.problem_type=="string"?_e.problem_type:null,rt=typeof((Lt=_e.metadata)==null?void 0:Lt.problem_type)=="string"?(Ot=_e.metadata)==null?void 0:Ot.problem_type:null,ct=typeof((Pt=_e.metadata)==null?void 0:Pt.resolved_problem_type)=="string"?(Dt=_e.metadata)==null?void 0:Dt.resolved_problem_type:null;return(we||ct||rt||"").toLowerCase()})();if($e)return $e===ie;const Ct=String(_e.model_type||"").toLowerCase();return ie==="regression"?Ct.includes("regress"):ie==="classification"?Ct.includes("classif"):!0})},[xn,J]),Js=y.useMemo(()=>!!(At instanceof Error&&Ci(At.message)||A&&Bl(A)||xn.some(ie=>Bl(ie))||It.some(ie=>Bl(ie))),[At,xn,A,It]),Kn=Yb({graph:n,nodeId:e,modelType:re,problemType:J,modelTypeOptions:f,enabled:Js});y.useEffect(()=>{Kn||Q(!1)},[Kn]);const Is=Math.max(xn.length-wn.length,0),rs=Mt.isLoading||Mt.isFetching,ps=Mt.error,Bs=Dn.length>0||!S||!t||!dt||Sn,Yn=y.useCallback((ie,_e)=>{F($e=>({...$e,[ie]:_e}))},[]),as=y.useCallback(ie=>{var Ct;const _e=O[ie.name]??ie.default,$e=`hyperparam-${e}-${ie.name}`;return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:$e,className:"canvas-modal__parameter-label",children:[ie.label,ie.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:ie.description})]}),ie.type==="number"&&a.jsx("input",{id:$e,type:"number",className:"canvas-modal__parameter-input",value:_e??"",onChange:we=>{const rt=we.target.value;if(rt===""&&ie.nullable)Yn(ie.name,null);else{const ct=parseFloat(rt);isNaN(ct)||Yn(ie.name,ct)}},min:ie.min,max:ie.max,step:ie.step,placeholder:ie.nullable?"Empty = default":""}),ie.type==="select"&&a.jsx("select",{id:$e,className:"canvas-modal__parameter-select",value:_e??"",onChange:we=>Yn(ie.name,we.target.value),children:(Ct=ie.options)==null?void 0:Ct.map(we=>a.jsx("option",{value:we.value,children:we.label},we.value))}),ie.type==="boolean"&&a.jsx("input",{id:$e,type:"checkbox",className:"canvas-modal__parameter-checkbox",checked:!!_e,onChange:we=>Yn(ie.name,we.target.checked)}),ie.type==="text"&&a.jsx("input",{id:$e,type:"text",className:"canvas-modal__parameter-input",value:_e??"",onChange:we=>Yn(ie.name,we.target.value),placeholder:ie.nullable?"Empty = default":""})]},ie.name)},[O,Yn,e]),Wt=y.useCallback(async()=>{if(!S||!t||!re)return;if(W&&j){try{const ct=j({closeModal:!1});ct&&typeof ct.then=="function"&&await ct,X(!1)}catch{}await new Promise(ct=>setTimeout(ct,100))}const ie=jt??dt;if(!ie)return;const _e={};ne&&(_e.target_column=ne),_e.problem_type=J,_e.cross_validation={enabled:Oe,strategy:Fe,folds:lt,shuffle:Be,random_state:de,refit_strategy:pe};const $e=Object.keys(_e).length?_e:void 0,Ct=Ul(ie);Ct&&Array.isArray(Ct.nodes)&&(Ct.nodes=Ct.nodes.map(ct=>{if(!ct||ct.id!==e)return ct;const Lt=(ct==null?void 0:ct.data)??{},Ot=(Lt==null?void 0:Lt.config)??{},Pt=c?{...Ot,...c}:Ot;return{...ct,data:{...Lt,config:Pt,isConfigured:!0}}}));const we=re?[re]:[],rt={dataset_source_id:t,pipeline_id:S,node_id:e,model_type:re||void 0,model_types:we.length?we:void 0,hyperparameters:B&&_t?Ul(_t):void 0,metadata:$e,job_metadata:$e,run_training:!0,graph:Ct??Ul(ie),target_node_id:e};try{await tn(rt)}catch{}},[Oe,lt,de,pe,Be,Fe,c,tn,dt,jt,W,re,e,j,S,J,_t,B,t,ne]),et=y.useCallback(()=>{Ft&&Mt.refetch()},[Ft,Mt]),qe=ie=>{var Xt,gs,Mn,fn;const _e=v2(ie.metrics??null),$e=ie.updated_at?Rn(ie.updated_at):null,Ct=ie.updated_at||ie.created_at,we=Ct?$e??new Date(Ct).toLocaleString():null,rt=p2[ie.status]??ie.status,ct=(ie.problem_type||((Xt=ie.metadata)==null?void 0:Xt.resolved_problem_type)||((gs=ie.metadata)==null?void 0:gs.problem_type)||"").toString(),Lt=((Mn=ie.metadata)==null?void 0:Mn.cross_validation)??null,Ot=((fn=ie.metrics)==null?void 0:fn.cross_validation)??null,Pt=typeof ie.error_message=="string"?ie.error_message.trim():"",Dt=[];if(Dt.push(`Model ${ie.model_type}`),ct&&Dt.push(ct.charAt(0).toUpperCase()+ct.slice(1)),Lt!=null&&Lt.enabled){const dn=String(Lt.strategy??"auto"),Gn=dn==="stratified_kfold"?"Stratified KFold":dn==="kfold"?"KFold":"Auto CV",In=typeof Lt.folds=="number"?`${Lt.folds} folds`:"CV enabled";if(Dt.push(`${Gn} (${In})`),(Ot==null?void 0:Ot.status)==="skipped"){const Xr=String((Ot==null?void 0:Ot.reason)??"unknown reason").replace(/_/g," ");Dt.push(`CV skipped (${Xr})`)}}else if((Ot==null?void 0:Ot.status)==="skipped"){const dn=String((Ot==null?void 0:Ot.reason)??"unknown reason").replace(/_/g," ");Dt.push(`CV skipped (${dn})`)}if(_e&&Dt.push(`${_e.label}: ${Xb(_e.value)}`),ie.status==="failed"&&Pt){const dn=Pt.replace(/\s+/g," ");Dt.push(`Error: ${dn}`)}return we&&Dt.push(`Updated ${we}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["v",ie.version]}),"  ",rt,Dt.length>0?`  ${Dt.join("  ")}`:""]},ie.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Background training jobs"}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:et,disabled:!Ft||rs,children:rs?"Refreshing":"Refresh jobs"})})]}),a.jsx("p",{className:"canvas-modal__note",children:"Enqueue a background training job for this node. Jobs run via Celery, versioned per pipeline, and report metrics when finished."}),S&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:S})]}),W&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Your changes will create a new training pipeline. Previous jobs remain under the old configuration. Jobs will auto-save when you launch training."]}),Dn.map((ie,_e)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:ie},`training-prereq-${_e}`)),At instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:At.message}),ps&&!(At instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:ps.message||"Unable to load training jobs."}),nn&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:nn.message||"Unable to load tuning jobs."}),A&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:P>1?a.jsxs("span",{children:["Queued ",P," training jobs. Latest job ",A.id," (version ",A.version,")."]}):a.jsxs("span",{children:["Training job ",A.id," queued (version ",A.version,")."]})}),En&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading tuning jobs"}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[xe&&u(xe),p&&u(p),Oe&&a.jsxs(a.Fragment,{children:[g&&u(g),_&&u(_),N&&u(N),v&&u(v),x&&u(x)]}),re&&ce.length>0&&a.jsx("div",{className:"canvas-modal__parameter",style:{gridColumn:"1 / -1"},children:a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"flex-start",justifyContent:"space-between",gap:"1rem",marginBottom:"0.75rem",padding:"0.75rem 1rem",background:"rgba(15, 23, 42, 0.35)",borderRadius:"6px",border:"1px solid rgba(148, 163, 184, 0.25)"},children:[a.jsxs("div",{style:{flex:"1 1 260px"},children:[a.jsx("strong",{style:{fontSize:"0.95rem",color:"#e2e8f0"},children:"Model Configuration"}),a.jsx("p",{style:{margin:"0.25rem 0 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:B?"Fine-tune hyperparameters or use defaults for quick training":"Using default hyperparameters  toggle Advanced to customize"}),(tt||bt)&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:"rgba(148, 163, 184, 0.8)"},children:tt?a.jsxs(a.Fragment,{children:[" Tuned parameters available for ",a.jsx("strong",{children:tt.modelType}),tt.runNumber?` (run ${tt.runNumber})`:"",un?`  ${un}`:"",tt.targetColumn?`  Target: ${tt.targetColumn}`:"",kn?`  ${kn}`:""]}):a.jsxs(a.Fragment,{children:["Latest tuning run ",bn||"N/A",hn?`  ${hn}`:"",bt!=null&&bt.model_type&&bt.model_type!==re?` targeted ${bt.model_type}.`:" did not produce reusable parameters for this configuration yet."]})}),K&&a.jsx("p",{style:{margin:"0.5rem 0 0 0",fontSize:"0.8rem",color:$t},children:K.message})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",alignItems:"center",justifyContent:"flex-end"},children:[a.jsx("button",{type:"button",onClick:ss,disabled:Vt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:Vt?"rgba(148, 163, 184, 0.55)":"#0c4a6e",background:Vt?"rgba(15, 23, 42, 0.35)":"rgba(191, 219, 254, 0.9)",border:Vt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(147, 197, 253, 0.9)",borderRadius:"4px",cursor:Vt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"130px",boxShadow:Vt?"none":"0 3px 10px rgba(14, 116, 144, 0.25)"},children:"Apply tuned params"}),a.jsx("button",{type:"button",onClick:()=>z(!0),disabled:pt,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:500,color:pt?"rgba(148, 163, 184, 0.55)":"rgba(168, 85, 247, 0.95)",background:pt?"rgba(15, 23, 42, 0.35)":"rgba(76, 29, 149, 0.18)",border:pt?"1px solid rgba(148, 163, 184, 0.35)":"1px solid rgba(168, 85, 247, 0.45)",borderRadius:"4px",cursor:pt?"not-allowed":"pointer",transition:"all 0.2s ease",minWidth:"150px"},children:"Browse tuned params"}),a.jsx("button",{type:"button",onClick:st,style:{padding:"0.5rem 1rem",fontSize:"0.875rem",fontWeight:"500",color:B?"#fff":"rgba(148, 163, 184, 0.85)",background:B?"linear-gradient(135deg, #667eea 0%, #764ba2 100%)":"rgba(15, 23, 42, 0.6)",border:B?"none":"1px solid rgba(148, 163, 184, 0.45)",borderRadius:"4px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"100px",boxShadow:B?"0 4px 12px rgba(118, 75, 162, 0.25)":"none"},onMouseEnter:ie=>{B?ie.currentTarget.style.boxShadow="0 6px 16px rgba(118, 75, 162, 0.35)":(ie.currentTarget.style.borderColor="rgba(148, 163, 184, 0.65)",ie.currentTarget.style.background="rgba(15, 23, 42, 0.8)")},onMouseLeave:ie=>{B?ie.currentTarget.style.boxShadow="0 4px 12px rgba(118, 75, 162, 0.25)":(ie.currentTarget.style.borderColor="rgba(148, 163, 184, 0.45)",ie.currentTarget.style.background="rgba(15, 23, 42, 0.6)")},children:B?" Advanced":"Default"})]})]})}),re&&ke.isLoading&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading hyperparameters"}),re&&ke.error&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--error",children:["Failed to load hyperparameters: ",ke.error.message]}),re&&B&&ce.length>0&&a.jsxs("div",{style:{gridColumn:"1 / -1",padding:"1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px",marginTop:"0.5rem"},children:[a.jsxs("div",{style:{marginBottom:"1rem",paddingBottom:"0.75rem",borderBottom:"2px solid rgba(102, 126, 234, 0.3)"},children:[a.jsx("h4",{style:{margin:"0 0 0.5rem 0",fontSize:"1rem",fontWeight:"600",color:"#e2e8f0"},children:"Advanced Hyperparameters"}),a.jsxs("p",{style:{margin:"0",fontSize:"0.875rem",color:"rgba(148, 163, 184, 0.85)",lineHeight:"1.5"},children:["Configure ",re.replace(/_/g," ")," hyperparameters. Leave empty to use recommended defaults."]})]}),a.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(250px, 1fr))",gap:"1rem"},children:ce.map(as)})]}),!re&&h&&u(h)]}),Oe&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation runs ",lt," folds before refitting on"," ",pe==="train_plus_validation"?"training plus validation data.":"training data only."]}),Kn&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",Kn.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:Kn.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>Q(ie=>!ie),style:{whiteSpace:"nowrap"},children:G?"Hide tips":"Show tips"})]}),G&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:Kn.details.map((ie,_e)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:ie},`scaling-tip-${_e}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Wt,disabled:Bs,children:Sn?"Queuing":"Launch training job"})}),rs&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),Is>0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:Is===1?"1 training job uses a different problem type. Switch the problem type to view it.":`${Is} training jobs use a different problem type. Switch the problem type to view them.`}),!rs&&wn.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No training jobs found for this node."}),wn.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:wn.map(qe)}),a.jsx(a2,{presets:ft,isOpen:I,onClose:()=>z(!1),onApply:ie=>{sn(ie),z(!1)},activePresetId:H,fieldMetadata:at})]})},b2=new Set(["true","1","yes","on"]),x2=new Set(["false","0","no","off"]),w2=["auto_detect","autoDetect","auto_detect_columns","auto","auto_detect_text"],Jb=new Set(["true","1","yes","y","on","t"]),Zb=new Set(["false","0","no","n","off","f"]),No=e=>{if(typeof e=="boolean")return e;if(typeof e=="number")return Number.isFinite(e)?e===1?!0:e===0?!1:null:null;if(typeof e=="string"){const t=e.trim().toLowerCase();if(!t)return null;if(b2.has(t))return!0;if(x2.has(t))return!1}return null},Ei=e=>{if(!(!e||typeof e!="object")){for(const t of w2)if(Object.prototype.hasOwnProperty.call(e,t))return e[t]}},Lh=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return Array.isArray(e)?[...e]:typeof e=="object"?{...e}:e}},zh=e=>Array.isArray(e)?e.map(t=>zh(t)):e&&typeof e=="object"?Object.keys(e).sort().reduce((t,n)=>(t[n]=zh(e[n]),t),{}):e,ql=e=>e===void 0?"":JSON.stringify(zh(e)),ex=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},N2=(e,t)=>{const n=[],s=p=>{n.includes(p)||n.push(p)},i=(e??"").toLowerCase();if(!t.length)return n;const l=t.filter(p=>p!=null);if(!l.length)return n;const c=l.reduce((p,g)=>{if(typeof g=="number"&&Number.isFinite(g))return p+1;if(typeof g=="string"){const _=g.trim();if(!_)return p;const N=Number(_);if(!Number.isNaN(N)&&Number.isFinite(N))return p+1}return p},0),u=l.reduce((p,g)=>{const _=String(g).trim().toLowerCase();return _&&(Jb.has(_)||Zb.has(_))?p+1:p},0),d=(()=>{const p=new Set;return l.forEach(g=>{p.add(String(g).trim().toLowerCase())}),p.size})(),f=c/l.length,h=u/l.length;if(i.includes("object")||i.includes("string"))return h>=.7&&s("boolean"),f>=.7&&s("float64"),d>0&&d<=20&&s("category"),n;if(i.includes("float")){const p=l.reduce((g,_)=>{if(typeof _=="number")return Number.isInteger(_)?g+1:g;if(typeof _=="string"){const N=_.trim();if(!N)return g;const v=Number(N);if(!Number.isNaN(v)&&Number.isFinite(v)&&Number.isInteger(v))return g+1}return g},0);return h>=.8&&s("boolean"),l.length>0&&p/l.length>=.9&&s("Int64"),n}return i.includes("int")&&h>=.7&&s("boolean"),n},Tu=[{value:"train",label:"Train",accent:"train"},{value:"test",label:"Test",accent:"test"},{value:"validation",label:"Validation",accent:"validation"}],$u={train:0,test:1,validation:2},j2=["train","test","validation"],Dh=e=>Array.isArray(e)?e.map(t=>typeof t=="string"?t:String(t??"")).map(t=>t.trim().toLowerCase()).filter(Boolean):typeof e=="string"?e.split(",").map(t=>t.trim().toLowerCase()).filter(Boolean):[],Hl=e=>{const t=new Set(Tu.map(i=>i.value)),n=[];e.forEach(i=>{if(i){if(i==="training"&&(i="train"),i==="valid"||i==="val"){n.push("validation");return}t.has(i)&&n.push(i)}});const s=new Set;return n.filter(i=>s.has(i)?!1:(s.add(i),!0)).sort((i,l)=>$u[i]-$u[l])},C2=(e,t)=>{if(e.length!==t.length)return!1;for(let n=0;n<e.length;n+=1)if(e[n]!==t[n])return!1;return!0},Fh=(e,t)=>{const n=No(e);return n===null?t:n},tx=(e,t)=>{if(typeof e=="number"&&Number.isFinite(e)&&e>0)return Math.round(e);if(typeof e=="string"&&e.trim()){const n=Number(e);if(Number.isFinite(n)&&n>0)return Math.round(n)}return t},nx=e=>{if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0},sx=e=>{const t=Tu.find(n=>n.value===e);return t?t.label:e.charAt(0).toUpperCase()+e.slice(1)},S2=e=>{const t=e.replace(/_/g," ");return t.charAt(0).toUpperCase()+t.slice(1)},E2=e=>{const t=[];e.model_type&&t.push(e.model_type),typeof e.version=="number"&&t.push(`v${e.version}`),t.push(` ${S2(e.status)}`);const n=Rn(e.updated_at??e.created_at);return n&&t.push(`(${n})`),t.join(" ")},Pu=e=>!Number.isFinite(e)||e<0?0:e>1?1:e,rx=e=>{if(!e||typeof e!="object")return[];const t=[];return Object.entries(e).forEach(([n,s])=>{typeof s=="number"&&Number.isFinite(s)&&t.push({key:n,value:s})}),t.sort((n,s)=>n.key.localeCompare(s.key)),t},ax=(e,t)=>{if(!Number.isFinite(e))return"";const n=t(e*100,Math.abs(e)>=.1?1:2);return n?`${n}%`:""},k2=({nodeId:e,sourceId:t,graph:n,config:s,setConfigState:i,renderParameterField:l,formatMetricValue:c,connectedSplitHandles:u})=>{var Be;const d=ho(),f=y.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),h=y.useMemo(()=>{if(!f)return[];const de=new Map;f.nodes.forEach(xe=>{xe!=null&&xe.id&&de.set(xe.id,xe)});const pe=new Set;return f.edges.forEach(xe=>{var Ue;if(!xe||xe.target!==e)return;const ke=de.get(xe.source);((Ue=ke==null?void 0:ke.data)==null?void 0:Ue.catalogType)==="train_model_draft"&&pe.add(ke.id)}),pe.size>0?Array.from(pe):f.nodes.filter(xe=>{var ke;return((ke=xe==null?void 0:xe.data)==null?void 0:ke.catalogType)==="train_model_draft"}).map(xe=>xe.id)},[f,e]),p=y.useMemo(()=>h.length?h.slice().sort().join("|"):"all",[h]),[g,_]=y.useState(null),[N,v]=y.useState(null);y.useEffect(()=>{let de=!1;return v(null),!t||!f?(_(null),()=>{de=!0}):(xo(t,f).then(pe=>{de||_(pe)}).catch(pe=>{de||(v((pe==null?void 0:pe.message)??"Unable to compute pipeline signature."),_(null))}),()=>{de=!0})},[f,t]);const x=y.useMemo(()=>{const de=s==null?void 0:s.training_job_id;return typeof de=="string"?de.trim():typeof de=="number"?String(de):""},[s==null?void 0:s.training_job_id]),j=y.useMemo(()=>Hl(Dh(s==null?void 0:s.splits)),[s==null?void 0:s.splits]),k=y.useMemo(()=>j.length?j:j2,[j]);y.useEffect(()=>{u&&i(de=>{const pe=de??{},xe=Hl(Dh(pe.splits)),ke=xe.filter(ce=>u[ce]!==!1);if(ke.length===xe.length&&ke.every((ce,Me)=>ce===xe[Me]))return de;const Ue={...pe};return ke.length?Ue.splits=ke:delete Ue.splits,Ue})},[u,i]);const S=y.useMemo(()=>u?k.filter(de=>u[de]!==!1):k,[u,k]),C=y.useMemo(()=>u?Tu.filter(de=>u[de.value]===!1).map(de=>de.label):[],[u]),w=y.useMemo(()=>{if(!C.length)return"";if(C.length===1)return C[0];if(C.length===2)return`${C[0]} and ${C[1]}`;const de=C[C.length-1];return`${C.slice(0,-1).join(", ")}, and ${de}`},[C]),E=S.length>0,A=Fh(s==null?void 0:s.include_confusion,!0),R=Fh(s==null?void 0:s.include_curves,!0),P=Fh(s==null?void 0:s.include_residuals,!0),T=tx(s==null?void 0:s.max_curve_points,500),O=tx(s==null?void 0:s.max_scatter_points,750),F=typeof(s==null?void 0:s.last_evaluated_at)=="string"?s.last_evaluated_at:null,[B,L]=y.useState(null),[D,q]=y.useState("details"),Y=y.useRef(!1);y.useEffect(()=>{L(null),Y.current=!1},[x]),y.useEffect(()=>{q("details")},[B==null?void 0:B.job_id]);const W=y.useMemo(()=>["feature-canvas","model-evaluation",t??"none",g??"pending",p],[g,t,p]),X=$s({queryKey:W,queryFn:async()=>{const de={datasetSourceId:t||void 0,limit:50},pe=new Map,xe=[];let ke=null;const Ue=at=>{Array.isArray(at)&&at.forEach(Ze=>{Ze&&!pe.has(Ze.id)&&pe.set(Ze.id,Ze)})},ce=async at=>{try{const Ze=await Al(at);return Ue(Ze==null?void 0:Ze.jobs),Ze}catch(Ze){return Ze instanceof Error&&xe.push(Ze),null}};if(g&&await ce({...de,pipelineId:g}),h.length&&await Promise.all(h.map(at=>ce({...de,nodeId:at}))),ke=await ce(de),!pe.size){if(ke)return ke;if(xe.length)throw xe[0];return{jobs:[],total:0}}const Me=Array.from(pe.values());Me.sort((at,Ze)=>nx(Ze.updated_at??Ze.created_at)-nx(at.updated_at??at.created_at));const Ye=(ke==null?void 0:ke.total)??Me.length;return{jobs:Me,total:Ye}},enabled:!!t,staleTime:30*1e3,retry:(de,pe)=>pe.message.includes("Sign in")?!1:de<2,refetchInterval:de=>{const pe=de.state.data;return((pe==null?void 0:pe.jobs)??[]).some(Ue=>Ue.status==="queued"||Ue.status==="running")?5e3:!1}}),I=((Be=X.data)==null?void 0:Be.jobs)??[],z=y.useMemo(()=>{const de=new Map;return I.forEach(pe=>{de.set(pe.id,pe)}),de},[I]),H=y.useMemo(()=>I.filter(de=>de.status==="succeeded"),[I]),te=y.useMemo(()=>H.map(de=>({value:de.id,label:E2(de)})),[H]),K=x?z.get(x)??null:null,V=$s({queryKey:["feature-canvas","training-job",x||"none"],queryFn:()=>yy(x),enabled:!!x,staleTime:30*1e3});y.useEffect(()=>{var at,Ze;const de=V.data;if(!de)return;const pe=(at=de.metrics)==null?void 0:at.evaluation;if(!pe||typeof pe!="object")return;const xe=pe.splits;if(!xe||typeof xe!="object")return;const ke={};Object.entries(xe).forEach(([_t,st])=>{st&&typeof st=="object"&&(ke[_t]=st)});const Ue=typeof pe.generated_at=="string"?pe.generated_at:F??de.updated_at??de.created_at??new Date().toISOString(),ce=pe.problem_type==="regression"?"regression":"classification",Me={job_id:de.id,pipeline_id:de.pipeline_id,node_id:de.node_id,generated_at:Ue,problem_type:ce,target_column:pe.target_column??((Ze=de.metadata)==null?void 0:Ze.target_column)??null,splits:ke};L(Me),Ue&&Ue!==F&&i(_t=>({..._t??{},last_evaluated_at:Ue}));const Ye=Hl(Object.keys(ke));Ye.length&&!Y.current&&!C2(j,Ye)&&i(_t=>({..._t??{},splits:Ye}))},[V.data,F,i,j]);const G=Bc({mutationFn:async de=>{if(!x)throw new Error("Select a training job before running evaluation.");return by(x,de)},onSuccess:de=>{L(de),i(pe=>({...pe??{},training_job_id:x,splits:de.splits?Object.keys(de.splits):S,include_confusion:A,include_curves:R,include_residuals:P,max_curve_points:T,max_scatter_points:O,last_evaluated_at:de.generated_at})),d.invalidateQueries({queryKey:["feature-canvas","training-job",x]})}}),Q=y.useCallback(de=>{const pe=de.target.value;G.reset(),i(xe=>{const ke={...xe??{}};return pe?ke.training_job_id=pe:delete ke.training_job_id,ke})},[G,i]),ne=y.useCallback(de=>{u&&u[de]===!1||(G.reset(),Y.current=!0,i(pe=>{const xe=Hl(Dh(pe==null?void 0:pe.splits)),ke=xe.includes(de);let Ue;if(ke){if(xe.length<=1)return pe??{};Ue=xe.filter(ce=>ce!==de)}else Ue=Hl([...xe,de]);return{...pe??{},splits:Ue}}))},[u,G,i]),J=y.useCallback((de,pe)=>{G.reset(),i(xe=>({...xe??{},[de]:pe}))},[G,i]),re=y.useCallback(()=>{if(!x)return;const de={splits:S,include_confusion:A,include_curves:R,include_residuals:P,max_curve_points:R?T:void 0,max_scatter_points:P?O:void 0};G.mutate(de)},[G,A,R,P,T,O,x,S]),Se=B?Rn(B.generated_at):F?Rn(F):null,Re=y.useMemo(()=>B?Object.entries(B.splits).sort((de,pe)=>{const[xe]=de,[ke]=pe,Ue=$u[xe]??99,ce=$u[ke]??99;return Ue-ce}):[],[B]),Oe=y.useMemo(()=>{if(!B||!Re.length)return null;const de=Re.map(([xe,ke])=>{const Ue=rx(ke.metrics).reduce((ce,Me)=>(ce[Me.key]=Me.value,ce),{});return{key:xe,label:sx(xe),rowCount:typeof ke.row_count=="number"?ke.row_count:null,metrics:Ue}}),pe=Array.from(new Set(de.flatMap(xe=>Object.keys(xe.metrics)))).sort((xe,ke)=>xe.localeCompare(ke));return{splits:de,metricKeys:pe}},[Re,B]),Fe=y.useMemo(()=>Oe?Oe.splits.length<=1?"Connect at least two splits to compare results.":Oe.metricKeys.length?null:"No numeric metrics available for comparison yet.":"Run an evaluation to compare metrics.",[Oe]);y.useEffect(()=>{D==="comparison"&&Fe&&q("details")},[D,Fe]);const lt=y.useCallback(de=>{de==="comparison"&&Fe||q(de)},[Fe]);return a.jsxs("div",{className:"node-settings__section node-settings__evaluation",children:[a.jsxs("div",{className:"node-settings__section-header",children:[a.jsx("h3",{children:"Model Evaluation"}),a.jsx("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:Se&&a.jsxs("span",{className:"evaluation-status",children:["Last ran ",Se]})})]}),a.jsxs("div",{className:"evaluation-controls",children:[a.jsxs("label",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Training job"}),a.jsxs("select",{className:"evaluation-control__select",value:x,onChange:Q,disabled:X.isLoading||X.isFetching,children:[a.jsx("option",{value:"",children:"Select a trained model"}),te.map(de=>a.jsx("option",{value:de.value,children:de.label},de.value))]}),X.isLoading&&a.jsx("span",{className:"evaluation-hint",children:"Loading training jobs"}),X.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:X.error.message}),!X.isLoading&&!te.length&&a.jsx("span",{className:"evaluation-hint",children:"No successful training jobs detected yet."}),N&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:N})]}),a.jsxs("div",{className:"evaluation-control",children:[a.jsx("span",{className:"evaluation-control__label",children:"Dataset splits"}),a.jsx("div",{className:"evaluation-split-toggle",children:Tu.map(de=>{const pe=u?u[de.value]!==!1:!0,xe=pe&&S.includes(de.value);return a.jsxs("label",{className:`evaluation-chip evaluation-chip--${de.accent} ${xe?"evaluation-chip--active":""}`,"aria-disabled":!pe,title:pe?void 0:`${de.label} split is not connected`,style:pe?void 0:{opacity:.45,cursor:"not-allowed",borderStyle:"dashed"},children:[a.jsx("input",{type:"checkbox",checked:xe,disabled:!pe,onChange:()=>ne(de.value)}),a.jsx("span",{children:de.label})]},de.value)})}),C.length>0&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--warning",children:["Connect ",w," split",C.length>1?"s":""," to enable diagnostics."]}),!E&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"No dataset splits are available. Attach a train, validation, or test split to run evaluation."})]}),a.jsxs("div",{className:"evaluation-control evaluation-control--toggles",children:[a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:A,onChange:de=>J("include_confusion",de.target.checked)}),a.jsx("span",{children:"Confusion matrix"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:R,onChange:de=>J("include_curves",de.target.checked)}),a.jsx("span",{children:"ROC / PR curves"})]}),a.jsxs("label",{className:"evaluation-toggle",children:[a.jsx("input",{type:"checkbox",checked:P,onChange:de=>J("include_residuals",de.target.checked)}),a.jsx("span",{children:"Residual diagnostics"})]})]})]}),a.jsxs("div",{className:"evaluation-actions",children:[a.jsx("button",{type:"button",className:"evaluation-button",onClick:re,disabled:!x||G.isPending||!E,children:G.isPending?"Running":"Run evaluation"}),K&&K.status!=="succeeded"&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Selected job is not marked as succeeded; results may be incomplete."}),!E&&a.jsx("span",{className:"evaluation-hint evaluation-hint--warning",children:"Connect at least one dataset split to run evaluation diagnostics."}),G.isError&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:G.error.message}),G.isSuccess&&B&&a.jsxs("span",{className:"evaluation-hint evaluation-hint--success",children:["Diagnostics generated ",Rn(B.generated_at),"."]}),V.error&&a.jsx("span",{className:"evaluation-hint evaluation-hint--error",children:V.error.message})]}),B?a.jsxs("div",{className:"node-settings__evaluation-results",children:[a.jsxs("div",{className:"evaluation-summary",children:[a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Problem type"}),a.jsx("span",{className:"evaluation-summary__value",children:B.problem_type==="regression"?"Regression":"Classification"})]}),B.target_column&&a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Target column"}),a.jsx("span",{className:"evaluation-summary__value",children:B.target_column})]}),a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:"Evaluation time"}),a.jsx("span",{className:"evaluation-summary__value",children:Rn(B.generated_at)??B.generated_at})]})]}),a.jsxs("div",{className:"evaluation-tabs",role:"tablist","aria-label":"Evaluation views",children:[a.jsx("button",{type:"button",className:`evaluation-tab ${D==="details"?"evaluation-tab--active":""}`,role:"tab","aria-selected":D==="details",onClick:()=>lt("details"),children:"Split details"}),a.jsx("button",{type:"button",className:`evaluation-tab ${D==="comparison"?"evaluation-tab--active":""}`,role:"tab","aria-selected":D==="comparison","aria-disabled":!!Fe,disabled:!!Fe,title:Fe??void 0,onClick:()=>lt("comparison"),children:"Split comparison"})]}),D==="comparison"&&Oe?a.jsx(M2,{comparison:Oe,formatMetricValue:c}):Re.map(([de,pe])=>a.jsx(A2,{splitKey:de,payload:pe,problemType:B.problem_type,formatMetricValue:c},de))]}):a.jsx("div",{className:"evaluation-placeholder",children:x?a.jsx("p",{children:"Run the evaluation to generate metrics and diagnostics for the selected model."}):a.jsx("p",{children:"Select a completed training job to enable the evaluation workflow."})})]})},M2=({comparison:e,formatMetricValue:t})=>e.metricKeys.length?a.jsx("section",{className:"evaluation-comparison",children:a.jsx("div",{className:"evaluation-comparison__table-wrapper",children:a.jsxs("table",{className:"evaluation-comparison__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Metric"}),e.splits.map(n=>a.jsx("th",{children:n.label},n.key))]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"evaluation-comparison__row evaluation-comparison__row--muted",children:[a.jsx("td",{children:"Rows evaluated"}),e.splits.map(n=>a.jsx("td",{children:typeof n.rowCount=="number"?n.rowCount.toLocaleString():""},`${n.key}-rows`))]}),e.metricKeys.map(n=>a.jsxs("tr",{className:"evaluation-comparison__row",children:[a.jsx("td",{children:n}),e.splits.map(s=>a.jsx("td",{children:typeof s.metrics[n]=="number"?t(s.metrics[n]):""},`${s.key}-${n}`))]},n))]})]})})}):a.jsx("div",{className:"evaluation-placeholder",children:a.jsx("p",{children:"No numeric metrics were reported across splits for comparison."})}),A2=({splitKey:e,payload:t,problemType:n,formatMetricValue:s})=>{const i=rx(t.metrics),l=i.length>0,c=Array.isArray(t.notes)?t.notes.filter(Boolean):[];return a.jsxs("section",{className:"evaluation-split",children:[a.jsx("header",{className:"evaluation-split__header",children:a.jsxs("div",{children:[a.jsxs("h4",{children:[sx(e)," split"]}),a.jsxs("span",{className:"evaluation-split__rows",children:[t.row_count," rows"]})]})}),a.jsxs("div",{className:"evaluation-split__content",children:[a.jsxs("div",{className:"evaluation-metrics",children:[a.jsx("h5",{children:"Metrics"}),l?a.jsx("div",{className:"evaluation-metrics__grid",children:i.map(u=>a.jsxs("div",{className:"evaluation-metrics__item",children:[a.jsx("span",{className:"evaluation-metrics__label",children:u.key}),a.jsx("span",{className:"evaluation-metrics__value",children:s(u.value)})]},u.key))}):a.jsx("p",{className:"evaluation-hint",children:"No numeric metrics reported for this split."})]}),n==="classification"&&t.confusion_matrix&&a.jsx(O2,{matrix:t.confusion_matrix,formatMetricValue:s}),n==="classification"&&t.roc_curves.length>0&&a.jsxs("div",{className:"evaluation-curves",children:[t.roc_curves.map(u=>a.jsx(T2,{curve:u,formatMetricValue:s},`roc-${u.label}`)),t.pr_curves.map(u=>a.jsx($2,{curve:u,formatMetricValue:s},`pr-${u.label}`))]}),n==="regression"&&t.residuals&&a.jsx(R2,{residuals:t.residuals,formatMetricValue:s})]}),c.length>0&&a.jsx("ul",{className:"evaluation-notes",children:c.map((u,d)=>a.jsx("li",{children:u},`${e}-note-${d}`))})]})},O2=({matrix:e,formatMetricValue:t})=>{const n=Array.isArray(e.labels)?e.labels:[],s=Array.isArray(e.totals)?e.totals:[],i=Array.isArray(e.normalized)?e.normalized:[],l=typeof e.accuracy=="number"?e.accuracy:null;return a.jsxs("div",{className:"evaluation-confusion",children:[a.jsx("h5",{children:"Confusion matrix"}),l!==null&&a.jsxs("span",{className:"evaluation-confusion__accuracy",children:["Accuracy ",ax(l,t)]}),a.jsxs("table",{children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{children:"Actual \\ Predicted"}),n.map((c,u)=>a.jsx("th",{children:c},`pred-${u}`)),a.jsx("th",{children:"Total"})]})}),a.jsx("tbody",{children:e.matrix.map((c,u)=>{const d=i[u]??[],f=s[u]??c.reduce((h,p)=>h+p,0);return a.jsxs("tr",{children:[a.jsx("th",{children:n[u]??`Class ${u}`}),c.map((h,p)=>{const g=typeof d[p]=="number"?d[p]:null;return a.jsxs("td",{children:[a.jsx("span",{className:"evaluation-confusion__count",children:h}),g!==null&&a.jsx("span",{className:"evaluation-confusion__percentage",children:ax(g,t)})]},`cell-${u}-${p}`)}),a.jsx("td",{children:f})]},`row-${u}`)})})]})]})},T2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.fpr)||!Array.isArray(e.tpr)||!e.fpr.length||e.fpr.length!==e.tpr.length)return null;const n=240,s=240,i=28,l=n-i*2,c=s-i*2,u=e.fpr.map((d,f)=>{const h=i+Pu(d)*l,p=s-i-Pu(e.tpr[f])*c;return`${f===0?"M":"L"}${h} ${p}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`ROC curve for ${e.label}`,children:[a.jsx("rect",{x:i,y:i,width:l,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:i,y1:s-i,x2:n-i,y2:i,className:"evaluation-curve__baseline"}),a.jsx("line",{x1:i,y1:i,x2:i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("line",{x1:i,y1:s-i,x2:n-i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"False positive rate"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"True positive rate"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.auc=="number"&&a.jsxs("span",{children:["AUC ",t(e.auc)]})]})]})},$2=({curve:e,formatMetricValue:t})=>{if(!Array.isArray(e.recall)||!Array.isArray(e.precision)||!e.recall.length||e.recall.length!==e.precision.length)return null;const n=240,s=240,i=28,l=n-i*2,c=s-i*2,u=e.recall.map((d,f)=>{const h=i+Pu(d)*l,p=s-i-Pu(e.precision[f])*c;return`${f===0?"M":"L"}${h} ${p}`}).join(" ");return a.jsxs("div",{className:"evaluation-chart",children:[a.jsxs("svg",{viewBox:`0 0 ${n} ${s}`,role:"img","aria-label":`Precision/recall for ${e.label}`,children:[a.jsx("rect",{x:i,y:i,width:l,height:c,className:"evaluation-chart__frame"}),a.jsx("line",{x1:i,y1:i,x2:i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("line",{x1:i,y1:s-i,x2:n-i,y2:s-i,className:"evaluation-chart__axis"}),a.jsx("path",{d:u,className:"evaluation-curve__path"}),a.jsx("text",{x:n/2,y:s-4,className:"evaluation-chart__tick",textAnchor:"middle",children:"Recall"}),a.jsx("text",{x:-120,y:12,transform:"rotate(-90)",className:"evaluation-chart__tick",textAnchor:"middle",children:"Precision"})]}),a.jsxs("div",{className:"evaluation-chart__caption",children:[a.jsx("span",{children:e.label}),typeof e.average_precision=="number"&&a.jsxs("span",{children:["AP ",t(e.average_precision)]})]})]})},P2={residual_min:"Residual min",residual_max:"Residual max",residual_mean:"Residual mean",residual_std:"Residual std"},R2=({residuals:e,formatMetricValue:t})=>{const n=Object.entries(e.summary??{}).filter(s=>typeof s[1]=="number"&&Number.isFinite(s[1]));return a.jsxs("div",{className:"evaluation-regression",children:[a.jsx("h5",{children:"Residual analysis"}),n.length>0&&a.jsx("div",{className:"evaluation-summary evaluation-summary--compact",children:n.map(([s,i])=>a.jsxs("div",{children:[a.jsx("span",{className:"evaluation-summary__label",children:P2[s]??s}),a.jsx("span",{className:"evaluation-summary__value",children:t(i)})]},s))}),a.jsx(L2,{histogram:e.histogram}),e.scatter&&e.scatter.length>0&&a.jsx(z2,{points:e.scatter})]})},L2=({histogram:e})=>{const t=Array.isArray(e.counts)?e.counts:[],n=Array.isArray(e.bin_edges)?e.bin_edges:[];if(!t.length||n.length!==t.length+1)return null;const s=t.reduce((i,l)=>Math.max(i,l),0)||1;return a.jsx("div",{className:"evaluation-histogram","aria-label":"Residual histogram",children:t.map((i,l)=>{const c=i/s*100;return a.jsx("div",{className:"evaluation-histogram__bin",title:`${i} rows`,children:a.jsx("div",{className:"evaluation-histogram__bar",style:{height:`${c}%`}})},`bin-${l}`)})})},z2=({points:e})=>{if(!Array.isArray(e)||!e.length)return null;const t=320,n=260,s=36,i=e.map(g=>g.actual),l=e.map(g=>g.predicted),c=Math.min(...i,...l),u=Math.max(...i,...l),d=u-c||1,f=g=>(g-c)/d,h=g=>s+f(g)*(t-s*2),p=g=>n-s-f(g)*(n-s*2);return a.jsx("div",{className:"evaluation-scatter","aria-label":"Actual vs predicted scatter",children:a.jsxs("svg",{viewBox:`0 0 ${t} ${n}`,children:[a.jsx("rect",{x:s,y:s,width:t-s*2,height:n-s*2,className:"evaluation-chart__frame"}),a.jsx("line",{x1:s,y1:n-s,x2:t-s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:s,y1:s,x2:s,y2:n-s,className:"evaluation-chart__axis"}),a.jsx("line",{x1:h(c),y1:p(c),x2:h(u),y2:p(u),className:"evaluation-curve__baseline"}),e.map((g,_)=>a.jsx("circle",{cx:h(g.actual),cy:p(g.predicted),r:2.1,className:"evaluation-scatter__point"},`scatter-${_}`))]})})},D2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},F2={queued:"info",running:"info",succeeded:"success",failed:"danger",cancelled:"neutral"},ki={classification:["accuracy","f1_weighted","roc_auc","roc_auc_weighted","precision_weighted","recall_weighted","pr_auc","pr_auc_weighted","g_score"],regression:["rmse","mae","r2","mape"],fallback:["rmse","mae","r2","accuracy","f1_weighted","roc_auc"]},ox=["accuracy","f1_weighted","precision_weighted","recall_weighted","roc_auc","roc_auc_weighted"],ix=["rmse","mae","r2","mape"],lx=new Set(["rmse","mae","mape","mse"]),cx={logistic_regression:"Logistic Regression",random_forest_classifier:"Random Forest (Classifier)",random_forest_regressor:"Random Forest (Regressor)",ridge_regression:"Ridge Regression"},Ds=e=>!!e&&typeof e=="object"&&!Array.isArray(e),I2=(e,t)=>{if(e==null)return t;if(typeof e=="boolean")return e;if(typeof e=="string"){const n=e.trim().toLowerCase();if(!n)return t;if(["true","1","yes","on","enabled"].includes(n))return!0;if(["false","0","no","off","disabled"].includes(n))return!1}return typeof e=="number"?Number.isFinite(e)?e!==0:t:!!e},Ih=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",B2=e=>{if(!e)return ki.fallback;const t=String(e.model_type??e.modelType??"").toLowerCase();if(t.includes("regress"))return ki.regression;if(t.includes("class")||t.includes("classification"))return ki.classification;const n=String(e.problem_type??e.problemType??"").toLowerCase();return n==="regression"?ki.regression:n==="classification"?ki.classification:ki.fallback},U2=e=>{var i,l,c;if(!Ds(e))return null;const t=[],n=(l=(i=e==null?void 0:e.cross_validation)==null?void 0:i.metrics)==null?void 0:l.mean;Ds(n)&&((c=e==null?void 0:e.cross_validation)==null?void 0:c.status)==="completed"&&t.push({values:n,labelPrefix:"CV mean "}),Ds(e.test)&&t.push({values:e.test,labelPrefix:""}),Ds(e.validation)&&t.push({values:e.validation,labelPrefix:""}),Ds(e.train)&&t.push({values:e.train,labelPrefix:""});const s=B2(e);for(const u of t)for(const d of s){const f=u.values[d];if(typeof f=="number"&&Number.isFinite(f))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:f}}for(const u of t)for(const[d,f]of Object.entries(u.values))if(typeof f=="number"&&Number.isFinite(f))return{label:u.labelPrefix?`${u.labelPrefix}${d}`:d,value:f};return null},q2=e=>{var n,s;if(!Ds(e))return{label:null,values:{}};if(Ds(e.test))return{label:"Test",values:e.test};if(Ds(e.validation))return{label:"Validation",values:e.validation};const t=(s=(n=e==null?void 0:e.cross_validation)==null?void 0:n.metrics)==null?void 0:s.mean;return Ds(t)?{label:"CV mean",values:t}:Ds(e.train)?{label:"Train",values:e.train}:{label:null,values:{}}},ux=e=>{if(!e)return"Unknown model";const t=e.trim();return cx[t]?cx[t]:t.split("_").filter(Boolean).map(n=>n.charAt(0).toUpperCase()+n.slice(1)).join(" ")},H2=e=>{var l,c;const t=e.metadata??{},n=[e.problem_type,t==null?void 0:t.resolved_problem_type,t==null?void 0:t.problem_type];for(const u of n)if(typeof u=="string"){const d=u.trim().toLowerCase();if(d==="classification"||d==="regression")return d}const s=typeof e.model_type=="string"?e.model_type.toLowerCase():"";if(s.includes("classifier")||s.includes("classification"))return"classification";if(s.includes("regress")||s.includes("regression"))return"regression";const i=e.metrics;if(Ds(i)){const u=new Set,d=g=>{Ds(g)&&Object.keys(g).forEach(_=>u.add(_.toLowerCase()))};d(i.test),d(i.validation),d(i.train);const f=(c=(l=i==null?void 0:i.cross_validation)==null?void 0:l.metrics)==null?void 0:c.mean;Ds(f)&&d(f);const h=ox.some(g=>u.has(g)),p=ix.some(g=>u.has(g));if(h&&!p)return"classification";if(p&&!h)return"regression"}return"unknown"},V2=e=>e.map(t=>{const n=t.metrics??null;return{job:t,problemType:H2(t),modelLabel:ux(t.model_type),primaryMetric:U2(n),metricBucket:q2(n)}}),dx=e=>{if(!e||!Number.isFinite(e.value))return null;const t=e.label.toLowerCase();return lx.has(t)||lx.has(t.replace(/^cv mean\s+/i,""))?-e.value:e.value},W2=({nodeId:e,sourceId:t,graph:n,parameters:s,config:i,renderParameterField:l})=>{var K;const c=y.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),u=y.useMemo(()=>{if(!c)return[];const V=new Map;c.nodes.forEach(ne=>{ne&&ne.id&&V.set(ne.id,ne)});const G=new Set;return c.edges.forEach(ne=>{var re;if(!ne||ne.target!==e)return;const J=V.get(ne.source);((re=J==null?void 0:J.data)==null?void 0:re.catalogType)==="train_model_draft"&&G.add(J.id)}),G.size>0?Array.from(G):c.nodes.filter(ne=>{var J;return((J=ne==null?void 0:ne.data)==null?void 0:J.catalogType)==="train_model_draft"}).map(ne=>ne.id)},[c,e]),d=y.useMemo(()=>u.length?u.slice().sort().join("|"):"all",[u]),[f,h]=y.useState(null),[p,g]=y.useState(null);y.useEffect(()=>{let V=!1;return g(null),!t||!c?(h(null),()=>{V=!0}):(xo(t,c).then(G=>{V||h(G)}).catch(G=>{V||(g((G==null?void 0:G.message)??"Unable to compute pipeline ID"),h(null))}),()=>{V=!0})},[c,t]);const _=I2(i==null?void 0:i.show_non_success,!0),N=y.useMemo(()=>["feature-canvas","model-registry",t??"none",f??"pending",d,_?"all-statuses":"succeeded"],[f,_,t,d]),v=$s({queryKey:N,queryFn:async()=>{const V={datasetSourceId:t||void 0,limit:50},G=new Map,Q=[];let ne=null;const J=Oe=>{!Array.isArray(Oe)||!Oe.length||Oe.forEach(Fe=>{Fe&&!G.has(Fe.id)&&G.set(Fe.id,Fe)})},re=async Oe=>{try{const Fe=await Al(Oe);return J(Fe==null?void 0:Fe.jobs),Fe}catch(Fe){return Fe instanceof Error&&Q.push(Fe),null}};if(f&&await re({...V,pipelineId:f}),u.length===1){const[Oe]=u;await re({...V,nodeId:Oe})}if(ne=await re(V),!G.size){if(ne)return ne;if(Q.length)throw Q[0];return{jobs:[],total:0}}const Se=Array.from(G.values()),Re=(ne==null?void 0:ne.total)??Se.length;return{jobs:Se,total:Re}},enabled:!!t,staleTime:30*1e3,retry:(V,G)=>G.message.includes("Sign in")?!1:V<2,refetchInterval:V=>{const G=V.state.data;return((G==null?void 0:G.jobs)??[]).some(J=>J.status==="queued"||J.status==="running")?5e3:!1}}),x=((K=v.data)==null?void 0:K.jobs)??[],j=y.useMemo(()=>{if(!x.length)return[];if(!u.length)return x;const V=x.filter(G=>u.includes(G.node_id));return V.length?V:x},[x,u]),k=y.useMemo(()=>V2(j),[j]),S=y.useMemo(()=>_?k:k.filter(V=>V.job.status==="succeeded"),[k,_]),C=y.useMemo(()=>S.filter(V=>V.problemType==="classification"),[S]),w=y.useMemo(()=>S.filter(V=>V.problemType==="regression"),[S]),E=y.useMemo(()=>!C.length&&!w.length?"classification":C.length?w.length?C.length>=w.length?"classification":"regression":"classification":"regression",[C.length,w.length]),A=typeof(i==null?void 0:i.default_problem_type)=="string"?i.default_problem_type.trim().toLowerCase():"auto",R=A==="classification"||A==="regression"?A:E,[P,T]=y.useState(R);y.useEffect(()=>{T(R)},[R]);const O=P==="classification"?C:w,F=y.useMemo(()=>{const V=new Map;return O.forEach(G=>{const Q=G.job.model_type,ne=V.get(Q)??{label:G.modelLabel,count:0};ne.count+=1,V.set(Q,ne)}),Array.from(V.entries()).map(([G,Q])=>({value:G,label:Q.label,count:Q.count})).sort((G,Q)=>G.label.localeCompare(Q.label))},[O]),B=typeof(i==null?void 0:i.default_method)=="string"?i.default_method.trim().toLowerCase():"",[L,D]=y.useState("all");y.useEffect(()=>{if(!F.length){D("all");return}const V=F.find(G=>G.value.toLowerCase()===B);D(V?V.value:"all")},[B,F,P]);const q=y.useMemo(()=>L==="all"?O:O.filter(V=>V.job.model_type===L),[L,O]),Y=y.useMemo(()=>q.slice().sort((V,G)=>{if(G.job.version!==V.job.version)return G.job.version-V.job.version;const Q=Date.parse(V.job.updated_at??V.job.created_at??"");return Date.parse(G.job.updated_at??G.job.created_at??"")-Q}),[q]),W=y.useMemo(()=>{if(!O.length)return[];const V=new Map;O.forEach(Q=>{const ne=Q.job.model_type,J=V.get(ne)??[];J.push(Q),V.set(ne,J)});const G=[];return V.forEach((Q,ne)=>{const J=Q.reduce((re,Se)=>{const Re=dx(Se.primaryMetric);if(Re===null)return re;if(!re)return Se;const Oe=dx(re.primaryMetric);return Oe===null||Re>Oe?Se:re},null);G.push({modelType:ne,label:ux(ne),bestJob:J})}),G.sort((Q,ne)=>Q.label.localeCompare(ne.label))},[O]),X=y.useMemo(()=>s.filter(V=>["default_problem_type","show_non_success"].includes(V.name)),[s]),I=P==="classification"?ox:ix,z=v.isLoading||v.isFetching,H=v.error??null,te=Y.length>0;return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Model registry"}),f&&a.jsxs("span",{className:"model-registry__pipeline",children:["Pipeline ID: ",f]})]}),p&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:p}),!u.length&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this node to a Train model step to populate the registry."}),X.length>0&&a.jsx("div",{className:"canvas-modal__parameter-grid model-registry__parameters",children:X.map(V=>a.jsx(ge.Fragment,{children:l(V)},V.name))}),a.jsxs("div",{className:"model-registry__toolbar",children:[a.jsx("div",{className:"model-registry__tabs",role:"tablist","aria-label":"Problem type",children:["classification","regression"].map(V=>a.jsxs("button",{type:"button",role:"tab","data-active":P===V,className:"model-registry__tab",onClick:()=>T(V),disabled:V==="classification"&&!C.length||V==="regression"&&!w.length,children:[V==="classification"?"Classification":"Regression",a.jsx("span",{className:"model-registry__tab-count",children:V==="classification"?C.length:w.length})]},V))}),a.jsxs("div",{className:"model-registry__methods","aria-label":"Model template filter",children:[a.jsxs("button",{type:"button",className:"model-registry__method","data-active":L==="all",onClick:()=>D("all"),children:["All methods",a.jsx("span",{className:"model-registry__method-count",children:O.length})]}),F.map(V=>a.jsxs("button",{type:"button",className:"model-registry__method","data-active":L===V.value,onClick:()=>D(V.value),children:[V.label,a.jsx("span",{className:"model-registry__method-count",children:V.count})]},V.value))]})]}),W.length>0&&a.jsx("div",{className:"model-registry__summary",children:W.map(V=>{const G=V.bestJob,Q=G!=null&&G.primaryMetric?G.primaryMetric.label:null,ne=G!=null&&G.primaryMetric?Ih(G.primaryMetric.value):"";return a.jsxs("div",{className:"model-registry__summary-card",children:[a.jsx("span",{className:"model-registry__summary-title",children:V.label}),a.jsxs("span",{className:"model-registry__summary-metric",children:[Q||"No metrics",Q&&a.jsx("strong",{children:ne})]}),(G==null?void 0:G.job)&&a.jsxs("span",{className:"model-registry__summary-version",children:["v",G.job.version]})]},V.modelType)})}),z&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading model history"}),H&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:H.message}),!z&&!H&&!te&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No model versions available for the current filters."}),te&&a.jsx("div",{className:"model-registry__table-wrapper",children:a.jsxs("table",{className:"model-registry__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Version"}),a.jsx("th",{scope:"col",children:"Status"}),a.jsx("th",{scope:"col",children:"Model"}),a.jsx("th",{scope:"col",children:"Primary metric"}),I.map(V=>a.jsx("th",{scope:"col",children:V.replace(/_/g," ")},V)),a.jsx("th",{scope:"col",children:"Evaluated"}),a.jsx("th",{scope:"col",children:"Updated"})]})}),a.jsx("tbody",{children:Y.map(V=>{const{job:G,primaryMetric:Q,metricBucket:ne}=V,J=ne.values||{},re=ne.label??"",Se=G.updated_at??G.created_at??null;return a.jsxs("tr",{children:[a.jsxs("td",{children:["v",G.version]}),a.jsx("td",{children:a.jsx("span",{className:`model-registry__status model-registry__status--${F2[G.status]}`,children:D2[G.status]})}),a.jsx("td",{children:V.modelLabel}),a.jsx("td",{children:Q?a.jsxs("span",{className:"model-registry__metric",children:[a.jsx("span",{className:"model-registry__metric-label",children:Q.label}),a.jsx("span",{className:"model-registry__metric-value",children:Ih(Q.value)})]}):""}),I.map(Re=>{const Oe=J[Re];return a.jsx("td",{children:typeof Oe=="number"&&Number.isFinite(Oe)?Ih(Oe):""},`${G.id}-${Re}`)}),a.jsx("td",{children:re}),a.jsx("td",{children:Se?Rn(Se)??Se:""})]},G.id)})})]})})]})},K2={queued:"Queued",running:"Running",succeeded:"Succeeded",failed:"Failed",cancelled:"Cancelled"},jo="__tuning_strategies",Co="__active_tuning_strategy_id",So="__expanded_tuning_strategy_ids",Bh=["random","grid","halving","optuna"],Ru=(e,t)=>{if(typeof e!="string")return null;const n=e.trim();if(!n.length)return null;const s=n.toLowerCase();if(t&&t.length>0){const l=t.find(c=>c.toLowerCase()===s);if(l)return l}const i=Bh.find(l=>l.toLowerCase()===s);return i||n},ur=e=>!!e&&typeof e=="object"&&!Array.isArray(e),ts=e=>{try{return JSON.parse(JSON.stringify(e))}catch{return e}},ba=e=>{if(e==null)return{value:null,error:null};if(typeof e=="string"){const t=e.trim();if(!t.length)return{value:null,error:null};try{const n=JSON.parse(t);return ur(n)?{value:n,error:null}:{value:null,error:"JSON must evaluate to an object."}}catch{return{value:null,error:"Invalid JSON. Provide a valid JSON object."}}}return ur(e)?{value:e,error:null}:{value:null,error:"Provide a JSON object for this field."}},Uh=e=>{if(!e)return{value:null,error:null};const t={};return Object.entries(e).forEach(([n,s])=>{if(n){if(Array.isArray(s)){const i=s.filter(l=>l!=null);i.length>0&&(t[n]=i.map(l=>ts(l)));return}s==null||s===""||(t[n]=[ts(s)])}}),Object.keys(e).length?Object.keys(t).length===0?{value:null,error:"Search space must list candidate values for at least one hyperparameter."}:{value:t,error:null}:{value:null,error:"Populate the search space with at least one hyperparameter."}},Y2=e=>Number.isFinite(e)?Math.abs(e)>=1e3?e.toFixed(0):Math.abs(e)>=100?e.toFixed(1):Math.abs(e)>=10?e.toFixed(2):e.toFixed(3):"",G2=new Set(["train","test","validation"]),mx=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{if(typeof n=="string"){const s=n.trim().toLowerCase();G2.has(s)&&t.add(s)}}),Array.from(t)},qh=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,i])=>{t.has(s)&&(n[s]=i)}),n},Hh=(e,t)=>{if(!e||t.size===0)return{};const n={};return Object.entries(e).forEach(([s,i])=>{if(t.has(s)){if(Array.isArray(i)){const l=i.map(c=>ts(c)).filter(c=>c!=null&&c!=="");l.length>0&&(n[s]=l);return}i!=null&&i!==""&&(n[s]=[ts(i)])}}),n},Q2=(e,t)=>{const n=t.split(/[\n,]+/).map(d=>d.trim()).filter(d=>d.length>0);if(n.length===0)return{values:[],error:null};const s=[],i=[],l=Array.isArray(e.options)?new Set(e.options.map(d=>d.value)):null;n.forEach(d=>{if(e.type==="number"){const f=Number(d);Number.isFinite(f)?s.push(f):i.push(d);return}if(e.type==="boolean"){const f=d.toLowerCase();if(["true","1","yes","y"].includes(f)){s.push(!0);return}if(["false","0","no","n"].includes(f)){s.push(!1);return}i.push(d);return}if(e.type==="select"){if(l&&!l.has(d)){i.push(d);return}s.push(d);return}s.push(d)});const c=[],u=new Set;if(s.forEach(d=>{const f=typeof d=="object"?JSON.stringify(d):String(d);u.has(f)||(u.add(f),c.push(d))}),i.length>0){const d=i.slice(0,3).join(", "),f=i.length>3?"":"";return{values:c,error:`Invalid value${i.length>1?"s":""}: ${d}${f}`}}return{values:c,error:null}},hx=(e,t)=>t==null?"":typeof t=="number"?Number.isFinite(t)?t.toString():"":typeof t=="boolean"?t?"true":"false":e.type==="select"&&typeof t=="string"?t:String(t),Lu=e=>{if(e==null)return"";if(typeof e=="number")return Number.isFinite(e)?e.toString():"";if(typeof e=="boolean")return e?"True":"False";if(typeof e=="string")return e;try{return JSON.stringify(e)}catch{return String(e)}},zu=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"&&e.trim().length){const t=Number(e);return Number.isFinite(t)?t:null}return null},Vl=(e,t,n)=>{let s=e;return typeof t=="number"&&Number.isFinite(t)&&(s=Math.max(s,t)),typeof n=="number"&&Number.isFinite(n)&&(s=Math.min(s,n)),s},X2=(e,t)=>{const n={},s=e.find(d=>(d==null?void 0:d.name)==="solver"),i=e.find(d=>(d==null?void 0:d.name)==="penalty"),l=!!(s&&i&&Array.isArray(s.options)&&s.options.some(d=>(d==null?void 0:d.value)==="liblinear")&&Array.isArray(i.options)&&i.options.some(d=>(d==null?void 0:d.value)==="elasticnet")),c=new Set(["lbfgs","saga"]),u=new Set(["l2","none"]);return e.forEach(d=>{if(!(d!=null&&d.name))return;const f=new Map,h=_=>{if(_==null||typeof _=="number"&&!Number.isFinite(_))return;const N=typeof _=="object"?JSON.stringify(_):`${typeof _}:${String(_)}`;f.has(N)||f.set(N,ts(_))},p=t==null?void 0:t[d.name];if(l&&d.name==="solver")(Array.isArray(d.options)?d.options:[]).forEach(N=>{N!=null&&N.value&&c.has(String(N.value))&&h(N.value)}),!f.size&&typeof p=="string"&&c.has(p)&&h(p),f.size||c.forEach(N=>h(N));else if(l&&d.name==="penalty")(Array.isArray(d.options)?d.options:[]).forEach(N=>{N!=null&&N.value&&u.has(String(N.value))&&h(N.value)}),!f.size&&typeof p=="string"&&u.has(p)&&h(p),f.size||u.forEach(N=>h(N));else if(d.type==="number"){const _=zu(p),N=zu(d.min),v=zu(d.max);if(N!==null&&h(N),_!==null&&h(Vl(_,N,v)),v!==null&&h(v),f.size<=1&&_!==null){const x=zu(d.step);x!==null&&x>0?(h(Vl(_+x,N,v)),h(Vl(_-x,N,v))):(h(Vl(_*1.5,N,v)),h(Vl(_*.5,N,v)))}}else d.type==="boolean"?(h(!0),h(!1),typeof p=="boolean"&&h(p)):(d.type==="select"&&(d.options??[]).slice(0,6).forEach(_=>{(_==null?void 0:_.value)!==void 0&&h(_.value)}),typeof p=="string"&&p.trim().length&&h(p.trim()));const g=Array.from(f.values());g.length>0&&(n[d.name]=g)}),n},J2={classification:[{value:"accuracy",label:"Accuracy"},{value:"balanced_accuracy",label:"Balanced accuracy"},{value:"f1",label:"F1"},{value:"f1_macro",label:"F1 macro"},{value:"f1_weighted",label:"F1 weighted"},{value:"precision",label:"Precision"},{value:"recall",label:"Recall"},{value:"roc_auc",label:"ROC AUC (binary)"},{value:"roc_auc_ovr",label:"ROC AUC (one-vs-rest)"}],regression:[{value:"neg_mean_squared_error",label:"Negative MSE"},{value:"neg_root_mean_squared_error",label:"Negative RMSE"},{value:"neg_mean_absolute_error",label:"Negative MAE"},{value:"neg_median_absolute_error",label:"Negative MedAE"},{value:"r2",label:"R"}]},Vh=()=>`strategy-${Math.random().toString(36).slice(2,10)}`,Wl=e=>{if(!ur(e))return{};const t=ts(e);return ur(t)?(delete t[jo],delete t[Co],delete t[So],t):{}},Mi=e=>Wl(e),Z2=(e,t,n)=>({id:Vh(),label:e,config:Mi(t),searchSpaceTexts:n!=null&&n.searchSpaceTexts?{...n.searchSpaceTexts}:{},searchSpaceFieldErrors:n!=null&&n.searchSpaceFieldErrors?{...n.searchSpaceFieldErrors}:{},hasAutoFilledSearchSpace:(n==null?void 0:n.hasAutoFilledSearchSpace)??!1,searchSpaceManuallyCleared:(n==null?void 0:n.searchSpaceManuallyCleared)??!1}),xa=e=>`Strategy ${e}`,fx=e=>ur(e)?Object.keys(e).filter(t=>typeof e[t]=="string").sort().reduce((t,n)=>(t[n]=String(e[n]),t),{}):{},px=e=>ur(e)?Object.keys(e).filter(t=>e[t]===null||typeof e[t]=="string").sort().reduce((t,n)=>{const s=e[n];return t[n]=s===null?null:String(s),t},{}):{},e$=e=>{if(!ur(e))return{};const t={};return Object.prototype.hasOwnProperty.call(e,jo)&&(t[jo]=ts(e[jo])),Object.prototype.hasOwnProperty.call(e,Co)&&(t[Co]=e[Co]),Object.prototype.hasOwnProperty.call(e,So)&&(t[So]=ts(e[So])),t},t$=()=>({strategies:[],activeId:null,expandedIds:[]}),Wh=e=>{var d;const t=t$();if(!ur(e))return t;const n=e[jo];if(Array.isArray(n)){const f=new Set;n.forEach(h=>{if(!ur(h))return;let p=typeof h.id=="string"?h.id.trim():"";(!p||f.has(p))&&(p=Vh()),f.add(p);const g=typeof h.label=="string"?h.label.trim():"",_=g.length?g:xa(t.strategies.length+1),N=ur(h.config)?h.config:{},v={id:p,label:_,config:Wl(N),searchSpaceTexts:fx(h.searchSpaceTexts),searchSpaceFieldErrors:px(h.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!h.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!h.searchSpaceManuallyCleared};t.strategies.push(v)})}const s=new Set(t.strategies.map(f=>f.id)),i=e[Co],l=typeof i=="string"?i.trim():"";t.activeId=l&&s.has(l)?l:((d=t.strategies[0])==null?void 0:d.id)??null;const c=e[So],u=Array.isArray(c)?c.map(f=>typeof f=="string"?f.trim():"").filter(f=>!!f&&s.has(f)):[];return t.activeId&&!u.includes(t.activeId)&&u.push(t.activeId),t.expandedIds=Array.from(new Set(u)).sort(),t},gx=e=>({id:e.id,label:e.label,config:Mi(e.config),searchSpaceTexts:{...e.searchSpaceTexts},searchSpaceFieldErrors:{...e.searchSpaceFieldErrors},hasAutoFilledSearchSpace:e.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:e.searchSpaceManuallyCleared}),n$=(e,t,n)=>{var u;const s=e.map((d,f)=>({id:typeof d.id=="string"&&d.id.trim().length?d.id:Vh(),label:typeof d.label=="string"&&d.label.trim().length?d.label:xa(f+1),config:Wl(d.config),searchSpaceTexts:fx(d.searchSpaceTexts),searchSpaceFieldErrors:px(d.searchSpaceFieldErrors),hasAutoFilledSearchSpace:!!d.hasAutoFilledSearchSpace,searchSpaceManuallyCleared:!!d.searchSpaceManuallyCleared})),i=new Set(s.map(d=>d.id)),l=typeof t=="string"&&i.has(t)?t:((u=s[0])==null?void 0:u.id)??null,c=Array.from(n??new Set).filter(d=>i.has(d));return l&&!c.includes(l)&&c.push(l),{strategies:s,activeId:l,expandedIds:Array.from(new Set(c)).sort()}},_x=(e,t)=>{var n;return t&&e.some(s=>s.id===t)?t:((n=e[0])==null?void 0:n.id)??""},vx=(e,t)=>{const n=new Set(e.map(i=>i.id)),s=t.filter(i=>n.has(i));return!s.length&&e[0]&&s.push(e[0].id),new Set(s)},Du=e=>ql(e),yx=(e,t)=>{const n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(const i of n)if(e[i]!==t[i])return!1;return!0},s$=({nodeId:e,sourceId:t,graph:n,config:s,runtimeConfig:i,cvConfig:l,draftConfigState:c,renderParameterField:u,modelTypeParameter:d,modelTypeOptions:f,searchStrategyParameter:h,searchIterationsParameter:p,searchRandomStateParameter:g,scoringMetricParameter:_,setDraftConfigState:N,onSaveDraftConfig:v})=>{var Uo,$a,Zr,Hs;const x=ho(),[j,k]=y.useState(null),[S,C]=y.useState(null),[w,E]=y.useState(null),[A,R]=y.useState(0),[P,T]=y.useState(null),[O,F]=y.useState(!1),[B,L]=y.useState(null),[D,q]=y.useState(!1),Y=((s==null?void 0:s.targetColumn)??"").trim(),W=(s==null?void 0:s.problemType)==="regression"?"regression":"classification",X=(d==null?void 0:d.name)??"model_type",I=(h==null?void 0:h.name)??"search_strategy",z=(p==null?void 0:p.name)??"search_iterations",H=(g==null?void 0:g.name)??"search_random_state",te=(_==null?void 0:_.name)??"scoring_metric",K=c==null?void 0:c[X],V=typeof K=="string"&&K.trim().length?K.trim():((i==null?void 0:i.modelType)??"").trim(),G=$s({queryKey:["model-hyperparameters",V],queryFn:()=>xu(V),enabled:!!V,staleTime:5*60*1e3}),Q=((Uo=G.data)==null?void 0:Uo.fields)??[],ne=(($a=G.data)==null?void 0:$a.defaults)??{},J=y.useMemo(()=>{if(!Q.length)return new Set;const Z=new Set;return Q.forEach(fe=>{fe!=null&&fe.name&&Z.add(fe.name)}),Z},[Q]),re=!!(l!=null&&l.enabled),Se=(l==null?void 0:l.strategy)??"auto",Re=typeof(l==null?void 0:l.folds)=="number"?l.folds:5,Oe=!!(l!=null&&l.shuffle),Fe=(l==null?void 0:l.randomState)??null,lt=y.useMemo(()=>{const Z=[];return((h==null?void 0:h.options)??[]).forEach(fe=>{if(!fe||typeof fe.value!="string")return;const me=fe.value.trim();if(!me.length)return;const Ee=me.toLowerCase();Z.some(je=>je.toLowerCase()===Ee)||Z.push(me)}),Z},[h]),Be=y.useMemo(()=>lt.length>0?[...lt]:[...Bh],[lt]),de=Ru(h==null?void 0:h.default,lt),xe=Ru(c==null?void 0:c[I],lt)??de??Be[0]??Bh[0],ke=c==null?void 0:c[z];let Ue=null;if(typeof ke=="number"&&Number.isFinite(ke))Ue=Math.max(1,Math.floor(ke));else if(typeof ke=="string"){const Z=Number(ke.trim());Number.isFinite(Z)&&Z>0&&(Ue=Math.max(1,Math.floor(Z)))}const ce=c==null?void 0:c[H];let Me=null;if(typeof ce=="number"&&Number.isFinite(ce))Me=Math.trunc(ce);else if(typeof ce=="string"){const Z=Number(ce.trim());Number.isFinite(Z)&&(Me=Math.trunc(Z))}const Ye=typeof(p==null?void 0:p.default)=="number"&&Number.isFinite(p.default)?Math.max(1,Math.floor(p.default)):null,at=typeof(g==null?void 0:g.default)=="number"&&Number.isFinite(g.default)?Math.trunc(g.default):null,Ze=typeof(c==null?void 0:c[te])=="string"?String(c[te]).trim():"",_t=Ze.length?Ze:null,st=y.useMemo(()=>ba(c==null?void 0:c.baseline_hyperparameters),[c==null?void 0:c.baseline_hyperparameters]),dt=y.useMemo(()=>ba(c==null?void 0:c.search_space),[c==null?void 0:c.search_space]),jt=y.useMemo(()=>Uh(dt.value),[dt.value]),zt=st.value,Ge=st.error,Ft=jt.value,Kt=dt.error??jt.error,Mt=y.useMemo(()=>qh(zt,J),[J,zt]),tn=y.useMemo(()=>Hh(Ft,J),[J,Ft]),Sn=y.useMemo(()=>Object.keys(Mt).length,[Mt]),At=y.useMemo(()=>Object.keys(tn).length,[tn]),nn=At>0,[En,It]=y.useState({}),[ut,zn]=y.useState({}),[Qt,ft]=y.useState(!1),[tt,fs]=y.useState(!1),Vt=y.useRef(null);if(!Vt.current){const Z=Wh(c);let Ee=Z.strategies.length>0?Z.strategies.map(gx):[];const je=_x(Ee,Z.activeId),ye=vx(Ee,Z.expandedIds);je&&!ye.has(je)&&Ee.length&&ye.add(je);const nt=Du(Z);Vt.current={strategies:Ee,activeId:je,expanded:ye,signature:nt}}const[pt,bt]=y.useState(()=>Vt.current?Vt.current.strategies:[]),[ns,hn]=y.useState(()=>new Set(Vt.current?Array.from(Vt.current.expanded):[])),[bn,un]=y.useState(()=>{var Z;return((Z=Vt.current)==null?void 0:Z.activeId)??""}),kn=y.useRef(((Zr=Vt.current)==null?void 0:Zr.signature)??""),sn=y.useRef(null),ss=y.useRef(null),$t=y.useMemo(()=>pt.length?pt.find(fe=>fe.id===bn)??pt[0]:null,[bn,pt]),Dn=y.useMemo(()=>Wh(c),[c]),xn=y.useMemo(()=>Du(Dn),[Dn]);y.useEffect(()=>{if(xn===kn.current)return;const Z=Dn.strategies.length?Dn.strategies.map(gx):[],fe=_x(Z,Dn.activeId),me=vx(Z,Dn.expandedIds);fe&&!me.has(fe)&&Z.length&&me.add(fe),sn.current=null,bt(Z),un(fe),hn(me),kn.current=xn},[xn,Dn,c]),y.useEffect(()=>{if(!pt.length)return;pt.some(fe=>fe.id===bn)||un(pt[0].id)},[bn,pt]),y.useEffect(()=>{const Z=n$(pt,bn,ns),fe=Du(Z);kn.current!==fe&&N(me=>{const Ee=Wh(me),je=Du(Ee);if(je===fe)return kn.current=je,me??{};const ye=me?{...me}:{};return Z.strategies.length?ye[jo]=Z.strategies.map(nt=>({...nt,config:ts(nt.config),searchSpaceTexts:{...nt.searchSpaceTexts},searchSpaceFieldErrors:{...nt.searchSpaceFieldErrors}})):delete ye[jo],Z.activeId?ye[Co]=Z.activeId:delete ye[Co],Z.expandedIds.length?ye[So]=[...Z.expandedIds]:delete ye[So],kn.current=fe,ye})},[bn,ns,N,pt]),y.useEffect(()=>{if(!$t||sn.current===$t.id)return;sn.current=$t.id;const Z=Mi($t.config);N(me=>({...e$(me),...Z})),It($t.searchSpaceTexts??{}),zn($t.searchSpaceFieldErrors??{}),ft($t.hasAutoFilledSearchSpace??!1),fs($t.searchSpaceManuallyCleared??!1);const fe=typeof(Z==null?void 0:Z[X])=="string"?String(Z[X]):(i==null?void 0:i.modelType)??"";ss.current=fe},[$t,X,i==null?void 0:i.modelType,N]),y.useEffect(()=>{if(!$t)return;const Z=Mi(c),fe=JSON.stringify(Z)!==JSON.stringify($t.config??{}),me=!yx(En,$t.searchSpaceTexts),Ee=!yx(ut,$t.searchSpaceFieldErrors),je=$t.hasAutoFilledSearchSpace!==Qt,ye=$t.searchSpaceManuallyCleared!==tt;!fe&&!me&&!Ee&&!je&&!ye||bt(nt=>nt.map(De=>De.id!==$t.id?De:{...De,config:Z,searchSpaceTexts:{...En},searchSpaceFieldErrors:{...ut},hasAutoFilledSearchSpace:Qt,searchSpaceManuallyCleared:tt}))},[$t,c,Qt,ut,tt,En]);const wn=y.useCallback(()=>{const Z=pt.length+1,fe=Mi(c),me=new Set;pt.forEach(De=>{var ot;const mt=Ru((ot=De.config)==null?void 0:ot[I],Be);mt&&me.add(mt)});const Ee=Be.find(De=>!me.has(De))??xe,je=ts(fe),ye=ur(je)?je:{};if(ye[I]=Ee,Ee==="random"||Ee==="optuna"){const De=Ue!==null?Ue:Ye;De!==null?ye[z]=De:delete ye[z];const mt=Me!==null?Me:at;mt!==null?ye[H]=mt:delete ye[H]}else delete ye[z],delete ye[H];const nt=Z2(xa(Z),ye,{searchSpaceTexts:{...En},searchSpaceFieldErrors:{},hasAutoFilledSearchSpace:Qt,searchSpaceManuallyCleared:tt});bt(De=>[...De,nt]),hn(De=>new Set([...De,nt.id])),sn.current=null,un(nt.id)},[Be,c,Qt,Ue,Ye,Me,at,tt,En,xe,I,z,H,bt,un,hn,pt]),Js=y.useCallback(Z=>{hn(fe=>{const me=new Set(fe);return me.has(Z)?me.delete(Z):me.add(Z),me})},[]),Kn=y.useCallback(Z=>{!Z||Z===bn||(sn.current=null,un(Z),hn(fe=>{const me=new Set(fe);return me.add(Z),me}))},[bn]),Is=y.useCallback(Z=>{let fe=null;bt(me=>{if(me.length<=1)return me;const Ee=me.filter(ye=>ye.id!==Z);if(!Ee.length)return me;const je=Ee.map((ye,nt)=>({...ye,label:xa(nt+1)}));if(Z===bn){sn.current=null;const ye=je[0].id;fe=ye,un(ye)}return je}),hn(me=>{const Ee=new Set(me);return Ee.delete(Z),fe&&Ee.add(fe),Ee})},[bn]),rs=y.useMemo(()=>pt.map((Z,fe)=>{var Sr,Zs;const me=Z.config??{},Ee=me==null?void 0:me[X],je=typeof Ee=="string"?Ee.trim():"",ye=((Sr=f.find(Qn=>Qn.value===je))==null?void 0:Sr.label)??je,nt=me==null?void 0:me[I],De=typeof nt=="string"?nt.trim():"",mt=(Zs=((h==null?void 0:h.options)??[]).find(Qn=>Qn.value===De))==null?void 0:Zs.label,ot=me==null?void 0:me[te],Qe=typeof ot=="string"?ot.trim():"",An=ba(me==null?void 0:me.baseline_hyperparameters).error,Bt=ba(me==null?void 0:me.search_space),pn=Uh(Bt.value),ks=pn.value?Object.keys(pn.value).length:0,_s=pn.value?Object.values(pn.value).reduce((Qn,vs)=>Qn+(Array.isArray(vs)?vs.length:0),0):0,Vs=An!==null||Object.values(Z.searchSpaceFieldErrors).some(Qn=>!!Qn);return{id:Z.id,label:Z.label||xa(fe+1),modelLabel:ye||"Select model",searchStrategyLabel:mt??(De||"Random search"),scoringLabel:Qe||"Estimator default",parameterCount:ks,candidateCount:_s,hasErrors:Vs}}),[f,X,te,h,I,pt]);y.useEffect(()=>{const Z=ss.current;if(Z===null){ss.current=V;return}Z!==V&&(ss.current=V,It({}),zn({}),ft(!1),fs(!1))},[V]),y.useEffect(()=>{!V||!Q.length||It(Z=>{const fe={...Z};let me=!1;return Q.forEach(Ee=>{if(ut[Ee.name])return;const je=tn[Ee.name],ye=Array.isArray(je)&&je.length>0?je.map(nt=>hx(Ee,nt)).join(", "):"";fe[Ee.name]!==ye&&(fe[Ee.name]=ye,me=!0)}),me?fe:Z})},[tn,Q,V,ut]),y.useEffect(()=>{if(!V||!Q.length||tt)return;if(nn){Qt||ft(!0);return}if(Qt)return;const Z=X2(Q,ne);Object.keys(Z).length&&(ft(!0),zn({}),It(()=>{const fe={};return Q.forEach(me=>{if(!Z[me.name])return;const Ee=Z[me.name].map(je=>hx(me,je)).filter(je=>je.length>0).join(", ");fe[me.name]=Ee}),fe}),N(fe=>{const me=fe?{...fe}:{};return me.search_space=Z,me}))},[Qt,ne,Q,V,nn,tt,N]);const[ps,Bs]=y.useState(_t??"");y.useEffect(()=>{Bs(_t??"")},[_t]);const Yn=y.useMemo(()=>J2[W==="regression"?"regression":"classification"],[W]),as=(_==null?void 0:_.label)??"Scoring metric",Wt=(_==null?void 0:_.description)??"Pick the evaluation metric used to rank candidates.",et=y.useMemo(()=>`tuning-${e}-scoring-metric`,[e]),qe=y.useMemo(()=>Object.values(ut).some(Z=>!!Z),[ut]),Fn=y.useCallback((Z,fe)=>{J.has(Z)&&N(me=>{const Ee={...me},je=ba(me==null?void 0:me.baseline_hyperparameters).value??{},nt={...qh(je,J)};return fe===void 0?delete nt[Z]:nt[Z]=fe,Object.keys(nt).length>0?Ee.baseline_hyperparameters=nt:delete Ee.baseline_hyperparameters,Ee})},[J,N]),Us=y.useCallback((Z,fe)=>{It(je=>({...je,[Z.name]:fe}));const{values:me,error:Ee}=Q2(Z,fe);zn(je=>({...je,[Z.name]:Ee})),!Ee&&N(je=>{const ye={...je},nt=ba(je==null?void 0:je.search_space).value??{},mt={...Hh(nt,J)};return me.length>0?mt[Z.name]=me.map(ot=>ts(ot)):delete mt[Z.name],Object.keys(mt).length>0?ye.search_space=mt:delete ye.search_space,ye})},[J,N]),os=y.useCallback(Z=>{Fn(Z,void 0)},[Fn]),qs=y.useCallback(()=>{N(Z=>{if(!Z||!Z.baseline_hyperparameters)return Z??{};const fe={...Z};return delete fe.baseline_hyperparameters,fe})},[N]),ie=y.useCallback(()=>{fs(!0),ft(!0),It({}),zn({}),N(Z=>{if(!Z||!Z.search_space)return Z??{};const fe={...Z};return delete fe.search_space,fe})},[N]),_e=y.useCallback(Z=>{Bs(Z);const fe=Z.trim();N(me=>{const Ee={...me};return fe.length>0?Ee.scoring_metric=fe:delete Ee.scoring_metric,Ee})},[N]),$e=y.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const fe=`baseline-${e}-${Z.name}`,me=Mt[Z.name],Ee=me!==void 0,je=ne==null?void 0:ne[Z.name],ye=Z.label??Z.name,nt=Z.description,De=je!==void 0?`Default: ${Lu(je)}`:"Default: estimator setting";let mt;if(Z.type==="number"){const ot=typeof me=="number"?String(me):"";mt=a.jsx("input",{id:fe,type:"number",className:"canvas-modal__parameter-input",value:ot,onChange:Qe=>{const wt=Qe.target.value;if(!wt.length){os(Z.name);return}const An=Number(wt);Number.isFinite(An)&&Fn(Z.name,An)},min:Z.min,max:Z.max,step:Z.step,placeholder:"Leave blank to use default"})}else if(Z.type==="select"){const ot=Ee?String(me):"";mt=a.jsxs("select",{id:fe,className:"canvas-modal__parameter-select",value:ot,onChange:Qe=>{const wt=Qe.target.value;if(!wt.length){os(Z.name);return}Fn(Z.name,wt)},children:[a.jsx("option",{value:"",children:"Use default"}),(Z.options??[]).map(Qe=>a.jsx("option",{value:Qe.value,children:Qe.label},Qe.value))]})}else if(Z.type==="boolean"){const ot=Ee?me?"true":"false":"";mt=a.jsxs("select",{id:fe,className:"canvas-modal__parameter-select",value:ot,onChange:Qe=>{const wt=Qe.target.value;if(!wt.length){os(Z.name);return}Fn(Z.name,wt==="true")},children:[a.jsx("option",{value:"",children:"Use default"}),a.jsx("option",{value:"true",children:"True"}),a.jsx("option",{value:"false",children:"False"})]})}else{const ot=typeof me=="string"?me:"";mt=a.jsx("input",{id:fe,type:"text",className:"canvas-modal__parameter-input",value:ot,onChange:Qe=>{const wt=Qe.target.value;if(!wt.length){os(Z.name);return}Fn(Z.name,wt)},placeholder:"Leave blank to use default"})}return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:fe,className:"canvas-modal__parameter-label",children:[ye,nt&&a.jsx("span",{className:"canvas-modal__parameter-description",children:nt})]}),mt,a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:Ee?`Override: ${Lu(me)}`:De})})]},Z.name)},[J,Mt,ne,e,Fn]),Ct=y.useCallback(Z=>{if(!(Z!=null&&Z.name)||!J.has(Z.name))return null;const fe=`search-${e}-${Z.name}`,me=En[Z.name]??"",Ee=tn[Z.name],je=Array.isArray(Ee)?Ee.length:0,ye=ut[Z.name],nt=ne==null?void 0:ne[Z.name],De=Z.type==="number"?"Comma or newline separated numbers (e.g. 0.01, 0.1, 1)":Z.type==="boolean"?"Enter true/false values, separated by commas or new lines":Z.type==="select"?"Comma or newline separated option values":"Comma or newline separated values",mt=Array.isArray(Ee)?Ee.slice(0,3).map(ot=>Lu(ot)).join(", "):"";return a.jsxs("div",{className:"canvas-modal__parameter",children:[a.jsxs("label",{htmlFor:fe,className:"canvas-modal__parameter-label",children:[Z.label??Z.name,Z.description&&a.jsx("span",{className:"canvas-modal__parameter-description",children:Z.description})]}),a.jsx("textarea",{id:fe,className:"canvas-modal__parameter-input",rows:3,value:me,onChange:ot=>Us(Z,ot.target.value),placeholder:De,style:{minHeight:"92px",resize:"vertical"}}),a.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginTop:"0.4rem",gap:"0.75rem",flexWrap:"wrap"},children:a.jsx("small",{style:{color:"rgba(148, 163, 184, 0.85)"},children:je>0?`Configured ${je} value${je===1?"":"s"}${mt?` (${mt}${je>3?"":""})`:""}`:`Default: ${Lu(nt)}`})}),ye&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.5rem"},children:ye})]},Z.name)},[J,tn,Us,ne,e,ut,En]),we=y.useMemo(()=>{if(!nn)return{parameterCount:0,candidateProduct:null};const Z=Object.values(tn),fe=Z.length;let me=null;if(Z.length>0){let Ee=1,je=!1;Z.forEach(ye=>{Ee*=Math.max(ye.length,1),(!Number.isFinite(Ee)||Ee>1e6)&&(je=!0)}),me=je?null:Ee}return{parameterCount:fe,candidateProduct:me}},[tn,nn]),rt=y.useMemo(()=>!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges)?null:{nodes:n.nodes,edges:n.edges},[n]),ct=y.useCallback(Z=>{if(!rt)return null;const fe=ts(rt);if(!fe||!Array.isArray(fe.nodes))return rt;const me=Wl(Z),Ee=Object.keys(me).length>0;return fe.nodes=fe.nodes.map(je=>{if(!je||je.id!==e)return je;const ye=(je==null?void 0:je.data)??{},nt=(ye==null?void 0:ye.config)??{},De=Wl(nt),mt=Ee?{...De,...me}:De;return{...je,data:{...ye,config:mt,isConfigured:!0}}}),fe},[rt,e]),Lt=y.useMemo(()=>{const Z=ct(c);return Z||rt},[c,rt,ct]),Ot=y.useMemo(()=>{if(!n||!Array.isArray(n.nodes)||!Array.isArray(n.edges))return null;const Z=n.nodes,fe=n.edges;return(()=>{var nt;const ye=Z.find(De=>(De==null?void 0:De.id)===e);return ye?mx((nt=ye==null?void 0:ye.data)==null?void 0:nt.connectedSplits):[]})().includes("validation")||fe.some(ye=>!ye||(typeof ye.target=="string"?ye.target:null)!==e?!1:(typeof ye.sourceHandle=="string"?ye.sourceHandle.toLowerCase():"").includes("validation"))?!0:fe.some(ye=>{var Qe;if(!ye||(typeof ye.target=="string"?ye.target:null)!==e)return!1;const De=typeof ye.source=="string"?ye.source:null;if(!De)return!1;const mt=Z.find(wt=>(wt==null?void 0:wt.id)===De);return mt?mx((Qe=mt==null?void 0:mt.data)==null?void 0:Qe.activeSplits).includes("validation"):!1})?!1:null},[n,e]);y.useEffect(()=>{let Z=!1;return!t||!rt?(T(null),()=>{Z=!0}):(xo(t,rt).then(fe=>{Z||T(fe)}).catch(()=>{Z||T(null)}),()=>{Z=!0})},[rt,t]),y.useEffect(()=>{let Z=!1;C(null);const fe=Lt??rt;return!t||!fe?(k(null),()=>{Z=!0}):(xo(t,fe).then(me=>{Z||k(me)}).catch(me=>{Z||(C((me==null?void 0:me.message)??"Unable to compute pipeline ID"),k(null))}),()=>{Z=!0})},[rt,Lt,t]),y.useEffect(()=>{if(!j||!P){F(!1);return}F(j!==P)},[j,P]);const Pt=!!(t&&e),Dt=y.useMemo(()=>["feature-canvas","hyperparameter-tuning-jobs",t??"none",j??"pending",e],[e,j,t]),Xt=$s({queryKey:Dt,queryFn:async()=>{var fe;const Z={datasetSourceId:t||void 0,nodeId:e,limit:5};if(j){const me=await Ol({...Z,pipelineId:j});if((((fe=me==null?void 0:me.jobs)==null?void 0:fe.length)??0)>0)return me}return Ol(Z)},enabled:Pt,retry:(Z,fe)=>fe.message.includes("Sign in")?!1:Z<2,refetchInterval:Z=>{const fe=Z.state.data;return((fe==null?void 0:fe.jobs)??[]).some(je=>je.status==="queued"||je.status==="running")?5e3:!1}}),{mutateAsync:gs,isPending:Mn,error:fn}=Bc({mutationFn:xy,onSuccess:Z=>{const fe=Array.isArray(Z.jobs)?Z.jobs.length:0,me=fe>0?Z.jobs[0]:null;E(me),R(fe),x.invalidateQueries({queryKey:Dt})}}),dn=y.useMemo(()=>{const Z=[];return t||Z.push("Select a dataset before launching tuning jobs."),(!rt||!rt.nodes.length)&&Z.push("Connect this node to an upstream pipeline before tuning."),Y||Z.push("Set a target column before tuning."),Ot===!1&&Z.push("Connect the validation split to this node to enable tuning."),V||Z.push("Choose a model type before enqueuing tuning jobs."),pt.length===0&&Z.push("Add a tuning strategy before launching tuning jobs."),nn||Z.push("Define at least one hyperparameter in the search space."),Ge&&Z.push(Ge),Kt&&Z.push(Kt),qe&&Z.push("Resolve invalid candidate values in the search space."),(xe==="random"||xe==="optuna")&&!Ue&&Z.push("Provide the maximum iterations for random or Optuna search."),re&&Re<2&&Z.push("Cross-validation requires at least 2 folds."),S&&Z.push(S),Z},[Ge,re,Re,rt,nn,qe,V,S,Ue,Kt,xe,t,Y,Ot,pt.length]),Gn=((Hs=Xt.data)==null?void 0:Hs.jobs)??[],In=Xt.isLoading||Xt.isFetching,Xr=Xt.error,Ta=y.useMemo(()=>!!(fn instanceof Error&&Ci(fn.message)||B&&Ci(B)||w&&Bl(w)||Gn.some(Z=>Bl(Z))),[B,fn,w,Gn]),vt=Yb({graph:n,nodeId:e,modelType:V,problemType:W,modelTypeOptions:f,enabled:Ta});y.useEffect(()=>{vt||q(!1)},[vt]);const Fo=dn.length>0||qe||!j||!t||!rt||pt.length===0||!nn||Mn,Io=y.useMemo(()=>d?f.length?{...d,options:f}:d:null,[f,d]),Jr=y.useCallback(async()=>{if(!j||!t||!rt||pt.length===0)return;if(v){try{const je=v({closeModal:!1});F(!1),je&&typeof je.then=="function"&&await je}catch{}await new Promise(je=>setTimeout(je,100))}const Z=async()=>{const je=[],ye=[],nt=async De=>{if(!De)return new Set;if(De===V)return J;const mt=["model-hyperparameters",De],ot=x.getQueryData(mt),Qe=wt=>{const An=new Set;return(wt??[]).forEach(Bt=>{Bt!=null&&Bt.name&&An.add(Bt.name)}),An};if(ot)return Qe(ot.fields);try{const wt=await x.fetchQuery({queryKey:mt,queryFn:()=>xu(De)});return Qe(wt==null?void 0:wt.fields)}catch{return new Set}};for(let De=0;De<pt.length;De+=1){const mt=pt[De],ot=mt.label||xa(De+1),Qe=Mi(mt.config),wt=Qe==null?void 0:Qe[X],An=typeof wt=="string"&&wt.trim().length?wt.trim():V;if(!An){ye.push(`${ot} is missing a model selection.`);continue}const Bt=Ru(Qe==null?void 0:Qe[I],Be)??de??"random",pn=await nt(An),_s=ba(Qe==null?void 0:Qe.baseline_hyperparameters).value??{},Vs=pn.size>0?qh(_s,pn):ts(_s),Sr=ba(Qe==null?void 0:Qe.search_space);if(Sr.error){ye.push(`${ot} has invalid search space: ${Sr.error}`);continue}const Zs=Uh(Sr.value);if(Zs.error){ye.push(`${ot} has invalid search space: ${Zs.error}`);continue}const Qn=Zs.value??{},vs=pn.size>0?Hh(Qn,pn):ts(Qn);if(!vs||Object.keys(vs).length===0){ye.push(`${ot} requires at least one hyperparameter in the search space.`);continue}if(Object.values(mt.searchSpaceFieldErrors??{}).some(Zt=>!!Zt)){ye.push(`${ot} has search space entries that need attention.`);continue}const Pa=Object.keys(vs).length;let Ms=null;if(Pa>0){let Zt=1,Nn=!1;Object.values(vs).forEach(is=>{const qi=Array.isArray(is)?is.length:0;Zt*=Math.max(qi,1),(!Number.isFinite(Zt)||Zt>1e6)&&(Nn=!0)}),Ms=Nn?null:Zt}const Ra=Qe==null?void 0:Qe[te],ea=typeof Ra=="string"?Ra.trim():"",La=ea.length?ea:null,za=()=>{const Zt=Qe==null?void 0:Qe[z];let Nn=null;if(typeof Zt=="number"&&Number.isFinite(Zt))Nn=Math.max(1,Math.floor(Zt));else if(typeof Zt=="string"){const is=Number(Zt.trim());Number.isFinite(is)&&is>0&&(Nn=Math.max(1,Math.floor(is)))}return Nn===null&&(Bt==="random"||Bt==="optuna")?Ye!==null?Ye:null:Nn},Da=()=>{const Zt=Qe==null?void 0:Qe[H];let Nn=null;if(typeof Zt=="number"&&Number.isFinite(Zt))Nn=Math.trunc(Zt);else if(typeof Zt=="string"){const is=Number(Zt.trim());Number.isFinite(is)&&(Nn=Math.trunc(is))}return Nn===null&&(Bt==="random"||Bt==="optuna")?at!==null?at:null:Nn},Fa=za(),On=Da(),Jt={};Y&&(Jt.target_column=Y),Jt.problem_type=W,Jt.strategy_id=mt.id,Jt.strategy_label=ot,Jt.strategy_index=De+1,Jt.search_strategy=Bt,Fa!==null&&(Bt==="random"||Bt==="optuna")&&(Jt.max_iterations=Fa),La&&(Jt.scoring_metric=La),On!==null&&(Jt.random_state=On),Jt.search_space_keys=Object.keys(vs),Pa>0&&(Jt.search_space_parameters=Pa),Ms!==null&&(Jt.search_space_candidates=Ms),Jt.cross_validation={enabled:re,strategy:Se,folds:Re,shuffle:Oe,random_state:Fe};const ta=ct(Qe)??rt;if(!ta){ye.push(`Unable to build pipeline graph for ${ot}.`);continue}const na=Vs&&Object.keys(Vs).length>0?ts(Vs):void 0,sc=ts(vs),sa={dataset_source_id:t,pipeline_id:j,node_id:e,model_type:An,model_types:[An],search_strategy:Bt,search_space:sc,baseline_hyperparameters:na,n_iterations:Bt==="random"||Bt==="optuna"?Fa??void 0:void 0,scoring:La??void 0,random_state:On??void 0,cross_validation:{enabled:re,strategy:Se,folds:Re,shuffle:Oe,random_state:Fe},metadata:Jt,job_metadata:Jt,run_tuning:!0,graph:ta,target_node_id:e};je.push({payload:sa,label:ot})}return{plans:je,issues:ye}};L(null);const{plans:fe,issues:me}=await Z();if(!fe.length){me.length&&L(me.join(" "));return}const Ee=[];for(const{payload:je}of fe)try{const ye=await gs(je);Array.isArray(ye==null?void 0:ye.jobs)&&ye.jobs.length&&Ee.push(...ye.jobs)}catch(ye){ye instanceof Error&&ye.message?L(ye.message):L("Failed to enqueue one or more tuning jobs.");return}if(Ee.length){const je=Ee[Ee.length-1];E(je),R(Ee.length)}},[J,re,Re,Fe,Oe,Se,gs,rt,ct,V,X,e,v,de,x,j,W,te,Ye,z,at,H,I,L,F,t,pt,Y]),Bo=y.useCallback(()=>{Pt&&Xt.refetch()},[Pt,Xt]),Ui=Z=>{var An,Bt,pn,ks,_s;const fe=K2[Z.status]??Z.status,Ee=(((An=f.find(Vs=>Vs.value===Z.model_type))==null?void 0:An.label)??Z.model_type??"").trim(),je=(()=>{switch(Z.search_strategy){case"grid":return"Grid search";case"halving":return"Successive halving";case"halving_random":return"Successive halving (randomized)";case"optuna":return"Optuna search";default:return"Random search"}})(),ye=Z.updated_at?Rn(Z.updated_at):null,nt=Z.updated_at||Z.created_at,De=nt?ye??new Date(nt).toLocaleString():null,mt=typeof Z.error_message=="string"?Z.error_message.trim():"",ot=[];Ee&&ot.push(`Model ${Ee}`),ot.push(je),Array.isArray(Z.results)&&Z.results.length>0&&ot.push(`${Z.results.length} candidates`);const Qe=typeof Z.best_score=="number"&&Number.isFinite(Z.best_score)?Z.best_score:typeof((Bt=Z.metrics)==null?void 0:Bt.best_score)=="number"?Z.metrics.best_score:null;Qe!==null&&ot.push(`Best score ${Y2(Qe)}`);const wt=String(((pn=Z.metrics)==null?void 0:pn.scoring)??((ks=Z.metrics)==null?void 0:ks.scorer)??((_s=Z.metadata)==null?void 0:_s.scoring_metric)??"").trim();if(wt&&ot.push(`Scoring ${wt}`),Z.status==="failed"&&mt){const Vs=mt.replace(/\s+/g," ");ot.push(`Error: ${Vs}`)}return De&&ot.push(`Updated ${De}`),a.jsxs("li",{children:[a.jsxs("strong",{children:["Run ",Z.run_number]}),"  ",fe,ot.length?`  ${ot.join("  ")}`:""]},Z.id)};return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Hyperparameter tuning jobs"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:wn,children:"Add strategy"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:Bo,disabled:!Pt||In,children:In?"Refreshing":"Refresh jobs"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Launch background tuning jobs that evaluate candidate hyperparameters via cross-validation. Jobs are versioned per pipeline and surface the best configuration when finished."}),j&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Pipeline ID: ",a.jsx("code",{children:j})]}),O&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{background:"rgba(251, 146, 60, 0.1)",borderLeft:"3px solid rgba(251, 146, 60, 0.8)",padding:"0.75rem 1rem",margin:"0.75rem 0"},children:[a.jsx("strong",{children:" Unsaved Configuration Changes"}),a.jsx("br",{}),"Enqueuing a tuning job saves the current configuration so results align with this pipeline snapshot."]}),dn.map((Z,fe)=>a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:Z},`tuning-prereq-${fe}`)),fn instanceof Error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:fn.message}),B&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:B}),Xr&&!(fn instanceof Error)&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:Xr.message||"Unable to load tuning jobs."}),w&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:A>1?a.jsxs("span",{children:["Queued ",A," tuning jobs. Latest job ",w.id," (run ",w.run_number,")."]}):a.jsxs("span",{children:["Tuning job ",w.id," queued (run ",w.run_number,")."]})}),nn&&we.parameterCount>0&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Search space covers ",we.parameterCount," hyperparameter",we.parameterCount===1?"":"s",we.candidateProduct!==null?`  up to ${we.candidateProduct.toLocaleString()} combinations`:"","."]}),a.jsxs("div",{className:"canvas-imputer__list",style:{marginTop:"1.25rem"},children:[pt.length===0&&a.jsx("p",{style:{margin:"0",padding:"1rem 1.25rem",border:"1px dashed rgba(148, 163, 184, 0.4)",borderRadius:"6px",color:"rgba(148, 163, 184, 0.85)",background:"rgba(15, 23, 42, 0.35)"},children:'No tuning strategies configured yet. Use "Add strategy" to define your search plan.'}),pt.map((Z,fe)=>{const me=rs[fe],Ee=!!($t&&$t.id===Z.id),je=ns.has(Z.id),ye=[];if(me!=null&&me.modelLabel&&ye.push(me.modelLabel),me!=null&&me.searchStrategyLabel&&ye.push(me.searchStrategyLabel),me!=null&&me.scoringLabel&&ye.push(`Scoring ${me.scoringLabel}`),me!=null&&me.parameterCount){const De=me.candidateCount?`${me.parameterCount} param${me.parameterCount===1?"":"s"}  ${me.candidateCount} candidate${me.candidateCount===1?"":"s"}`:`${me.parameterCount} param${me.parameterCount===1?"":"s"}`;ye.push(De)}else ye.includes("Needs attention")||ye.push("No search values");me!=null&&me.hasErrors&&ye.push("Needs attention");const nt=ye.length>0?ye.join("  "):"Configure strategy settings";return a.jsxs("div",{className:"canvas-imputer__card",children:[a.jsxs("div",{className:"canvas-imputer__card-header",children:[a.jsxs("button",{type:"button",className:"canvas-imputer__card-toggle",onClick:()=>{Js(Z.id),Ee||Kn(Z.id)},"aria-expanded":je,"aria-controls":`tuning-strategy-body-${Z.id}`,children:[a.jsx("span",{className:`canvas-imputer__toggle-icon${je?" canvas-imputer__toggle-icon--open":""}`,"aria-hidden":"true"}),a.jsxs("span",{className:"canvas-imputer__card-text",children:[a.jsx("span",{className:"canvas-imputer__card-title",children:(me==null?void 0:me.label)??xa(fe+1)}),a.jsx("span",{className:"canvas-imputer__card-summary",children:nt})]})]}),pt.length>1&&a.jsx("button",{type:"button",className:"canvas-imputer__remove",onClick:()=>Is(Z.id),"aria-label":`Remove ${(me==null?void 0:me.label)??xa(fe+1)}`,children:"Remove"})]}),je&&Ee&&a.jsxs("div",{className:"canvas-imputer__card-body",id:`tuning-strategy-body-${Z.id}`,children:[a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[Io&&u(Io),h&&u(h),(xe==="random"||xe==="optuna")&&p&&u(p),(xe==="random"||xe==="optuna")&&g&&u(g)]}),a.jsxs("div",{style:{marginTop:"1rem",padding:"1rem 1.25rem",background:"rgba(15, 23, 42, 0.25)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsx("div",{style:{fontWeight:600,color:"#e2e8f0",display:"block"},children:as}),a.jsx("p",{style:{margin:"0.4rem 0 0.75rem",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Wt}),a.jsxs("div",{id:et,style:{display:"inline-flex",alignItems:"center",gap:"0.5rem",padding:"0.4rem 0.75rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",fontSize:"0.85rem",maxWidth:"320px",marginBottom:"0.75rem"},children:[a.jsx("span",{style:{opacity:.75},children:"Selected:"}),a.jsx("strong",{style:{color:"#e2e8f0"},children:ps||"Estimator default"})]}),a.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem",marginTop:"0.75rem"},children:[Yn.map(De=>a.jsx("button",{type:"button",onClick:()=>_e(De.value),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:ps===De.value?"rgba(59, 130, 246, 0.2)":"rgba(15, 23, 42, 0.35)",color:ps===De.value?"#bfdbfe":"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:De.label},De.value)),a.jsx("button",{type:"button",onClick:()=>_e(""),style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset to default"})]})]}),V&&Q.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Baseline hyperparameter overrides"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Pre-fill model defaults before the search runs. Leave fields blank to keep the template values."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:Sn>0?`${Sn} override${Sn===1?"":"s"} configured`:"Using template defaults"}),Sn>0&&a.jsx("button",{type:"button",onClick:qs,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:"rgba(15, 23, 42, 0.35)",color:"rgba(203, 213, 225, 0.9)",cursor:"pointer"},children:"Reset overrides"})]})]}),Ge&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Ge}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:"1rem"},children:Q.map($e)})]}),V&&Q.length>0&&a.jsxs("div",{style:{marginTop:"1.25rem",padding:"1.25rem",background:"rgba(15, 23, 42, 0.2)",border:"1px solid rgba(148, 163, 184, 0.2)",borderRadius:"6px"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsx("h4",{style:{margin:0,fontSize:"1rem",fontWeight:600,color:"#e2e8f0"},children:"Search space"}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:"Provide candidate values for each hyperparameter. Separate entries with commas or new lines."})]}),a.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:"0.5rem"},children:[a.jsx("span",{style:{fontSize:"0.85rem",color:"rgba(148, 163, 184, 0.85)"},children:At>0?`${At} parameter${At===1?"":"s"} targeted`:"No parameters queued for tuning yet"}),a.jsx("button",{type:"button",onClick:ie,disabled:At===0,style:{padding:"0.35rem 0.7rem",fontSize:"0.8rem",borderRadius:"999px",border:"1px solid rgba(148, 163, 184, 0.35)",background:At===0?"rgba(15, 23, 42, 0.2)":"rgba(15, 23, 42, 0.35)",color:At===0?"rgba(148, 163, 184, 0.5)":"rgba(203, 213, 225, 0.9)",cursor:At===0?"not-allowed":"pointer"},children:"Clear search space"})]})]}),Kt&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",style:{marginTop:"0.75rem"},children:Kt}),qe&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",style:{marginTop:"0.75rem"},children:"Fix the highlighted search entries before launching tuning jobs."}),a.jsx("div",{style:{marginTop:"1rem",display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(260px, 1fr))",gap:"1rem"},children:Q.map(Ct)})]})]})]},Z.id)})]}),re&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Cross-validation evaluates each candidate with ",Re," folds before reporting aggregate metrics."]}),vt&&a.jsxs("div",{className:"canvas-modal__note canvas-modal__note--warning",style:{margin:"0.75rem 0",borderLeft:"3px solid rgba(251, 191, 36, 0.9)",background:"rgba(251, 191, 36, 0.12)",padding:"0.75rem 1rem"},children:[a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",gap:"0.75rem"},children:[a.jsxs("div",{children:[a.jsxs("strong",{children:[" ",vt.headline]}),a.jsx("p",{style:{margin:"0.35rem 0 0",fontSize:"0.85rem"},children:vt.summary})]}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>q(Z=>!Z),style:{whiteSpace:"nowrap"},children:D?"Hide tips":"Show tips"})]}),D&&a.jsx("ul",{style:{margin:"0.75rem 0 0 1rem",padding:0,listStyle:"disc",fontSize:"0.85rem"},children:vt.details.map((Z,fe)=>a.jsx("li",{style:{marginBottom:"0.35rem"},children:Z},`tuning-scaling-tip-${fe}`))})]}),a.jsx("div",{className:"canvas-modal__actions",children:a.jsx("button",{type:"button",className:"btn btn-primary",onClick:Jr,disabled:Fo,children:Mn?"Queuing":"Launch tuning job"})}),In&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"Loading recent jobs"}),!In&&Gn.length===0&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--muted",children:"No tuning jobs found for this node."}),Gn.length>0&&a.jsx("ul",{className:"canvas-modal__note-list",children:Gn.map(Ui)})]})},Kh={undersampling:{auto:"auto (match majority to the smallest class)",majority:"majority (down-sample only the majority class)","not minority":"not minority (down-sample all but the minority class)","not majority":"not majority (down-sample every class except the majority)",all:"all (down-sample every class)"},oversampling:{auto:"auto (boost minority class to majority size)",minority:"minority (only over-sample the minority class)","not minority":"not minority (over-sample every class except the minority)","not majority":"not majority (avoid synthesising the majority class)",all:"all (over-sample all classes equally)"}},r$=(e,t)=>{if(e==null||e==="")return Kh[t].auto;if(typeof e=="number"){if(!Number.isFinite(e))return Kh[t].auto;const s=Math.max(Math.min(e,1),0),i=s*100,l=s.toFixed(s>=.1||s===0?2:3),c=t==="undersampling"?"majority":"majority baseline";return`${l} ratio (${i.toFixed(1)}% of ${c})`}const n=e.trim().toLowerCase();return Kh[t][n]??n},a$=(e,t)=>{const n=t==="oversampling"?["over-sampling","oversampling","smote","adasyn","tomek","svm smote","kmeans smote","borderline smote"]:["under-sampling","undersampling","resampling"];for(let s=e.length-1;s>=0;s-=1){const i=e[s];if(typeof i!="string")continue;const l=i.toLowerCase();if(n.some(c=>l.includes(c)))return i}return null},o$=(e,t)=>t?"Missing":e.length?e:"Empty string",i$=({mode:e="undersampling",sourceId:t,hasReachableSource:n,previewState:s,onRefreshPreview:i,config:l,methodParameter:c,targetColumnParameter:u,samplingStrategyParameter:d,randomStateParameter:f,replacementParameter:h,kNeighborsParameter:p,renderParameterField:g,formatMetricValue:_,formatMissingPercentage:N,schemaGuard:v})=>{var z;const x=s.data,j=s.status,k=Array.isArray(x==null?void 0:x.applied_steps)?x==null?void 0:x.applied_steps:[],S=y.useMemo(()=>a$(k,e),[k,e]),C=(l==null?void 0:l.targetColumn)??"",w=(l==null?void 0:l.method)||(typeof(c==null?void 0:c.default)=="string"?c.default:""),E=y.useMemo(()=>{const H=Array.isArray(c==null?void 0:c.options)?c==null?void 0:c.options:[];if(w){const te=H.find(K=>K.value===w);return te!=null&&te.label?te.label:w.replace(/_/g," ")}return H.length>0?H[0].label??H[0].value:e==="undersampling"?"Random under-sampling":"Synthetic over-sampling"},[w,c==null?void 0:c.options,e]),A=y.useMemo(()=>r$(l==null?void 0:l.samplingStrategy,e),[l==null?void 0:l.samplingStrategy,e]),R=y.useMemo(()=>(l==null?void 0:l.randomState)===null||(l==null?void 0:l.randomState)===void 0?"Not set":Number.isFinite(l.randomState)?String(l.randomState):"Not set",[l==null?void 0:l.randomState]),P=y.useMemo(()=>{if(e!=="oversampling")return null;const H=l==null?void 0:l.kNeighbors;if(typeof H=="number"&&Number.isFinite(H))return String(Math.max(1,Math.round(H)));if(p&&typeof p.default=="number"){const te=p.default;if(Number.isFinite(te))return String(Math.max(1,Math.round(te)))}return"Default"},[l==null?void 0:l.kNeighbors,p,e]),T=(l==null?void 0:l.replacement)===null||(l==null?void 0:l.replacement)===void 0?null:l.replacement?"With replacement":"Without replacement",O=y.useMemo(()=>{if(j!=="success"||!x||!C)return{rows:[],total:0,truncated:!1};const H=Array.isArray(x.sample_rows)?x.sample_rows:[];if(!H.length)return{rows:[],total:0,truncated:!1};const te=new Map;H.forEach(re=>{if(!re||typeof re!="object")return;const Se=re[C],Re=Se==null,Oe=Re?"__missing__":String(Se),Fe=o$(Re?"":Oe,Re),lt=te.get(Oe);lt?lt.count+=1:te.set(Oe,{label:Fe,count:1,percentage:0,isMissing:Re})});const K=Array.from(te.values()).sort((re,Se)=>Se.count-re.count),V=K.reduce((re,Se)=>re+Se.count,0),G=8,Q=K.length>G;return{rows:(Q?K.slice(0,G):K).map(re=>({...re,percentage:V>0?re.count/V*100:0})),total:V,truncated:Q}},[x,j,C]),F=((z=x==null?void 0:x.metrics)==null?void 0:z.row_count)??null,B=!!t&&n&&j!=="loading"&&!(v!=null&&v.blocked),L=y.useMemo(()=>t?n?null:"Link this node to the dataset input to evaluate class balance.":"Connect to a dataset to preview class distributions.",[n,t]),D=y.useMemo(()=>!(v!=null&&v.blocked)||!v.details.length?"":v.details.map(H=>H.logical_family?`${H.name} (${H.logical_family})`:H.name).join(", "),[v]),q=!C,Y=!!C&&Array.isArray(x==null?void 0:x.columns)&&!(x!=null&&x.columns.includes(C)),W=e==="undersampling"?"Class undersampling":"Class oversampling",X=e==="undersampling"?"Random under-sampling trims majority-class examples to mitigate imbalance before training downstream models. It preserves minority class signals but can discard information from majority classes when ratios are aggressive.":"Synthetic over-sampling boosts minority representation by generating new samples. Integer feature columns are temporarily cast to float so synthesized values can include decimals, which helps models learn rare classes while requiring careful preprocessing to avoid noise.",I=e==="undersampling"?"enable undersampling":"enable oversampling";return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:W}),a.jsx("div",{className:"canvas-modal__section-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:i,disabled:!B,children:j==="loading"?"Refreshing":"Refresh preview"})})]}),a.jsx("p",{className:"canvas-modal__note",children:X}),L&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:L}),q&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Specify a target column to compute class ratios and ",I,"."]}),(v==null?void 0:v.blocked)&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:[v.message,D&&a.jsxs(a.Fragment,{children:[" ","Columns: ",D,"."]})]}),j==="error"&&s.error&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:s.error}),Y&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--warning",children:["Target column ",C," is not present in the current preview. Check upstream nodes or refresh the dataset snapshot."]}),S&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--info",children:S}),a.jsxs("ul",{className:"canvas-modal__note-list",children:[a.jsxs("li",{children:["Method: ",a.jsx("strong",{children:E})]}),a.jsxs("li",{children:["Sampling strategy: ",a.jsx("strong",{children:A})]}),e==="oversampling"&&P&&a.jsxs("li",{children:["k-neighbors: ",a.jsx("strong",{children:P})]}),T&&a.jsxs("li",{children:["Replacement: ",a.jsx("strong",{children:T})]}),a.jsxs("li",{children:["Random state: ",a.jsx("strong",{children:R})]})]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[c&&g(c),d&&g(d),e==="oversampling"&&p&&g(p),f&&g(f),h&&g(h)]}),u&&a.jsx("div",{className:"canvas-modal__parameter-list",children:g(u)}),C&&j==="success"&&!Y&&(O.rows.length?a.jsxs("div",{className:"canvas-cast__table-wrapper",children:[a.jsxs("table",{className:"canvas-cast__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Class"}),a.jsx("th",{scope:"col",children:"Sample count"}),a.jsx("th",{scope:"col",children:"Share"})]})}),a.jsx("tbody",{children:O.rows.map(H=>a.jsxs("tr",{children:[a.jsx("th",{scope:"row",children:H.label}),a.jsx("td",{children:_(H.count)}),a.jsx("td",{children:N(H.percentage)})]},`resampling-class-${H.label}`))})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Analysed ",_(O.total)," row",O.total===1?"":"s"," from the preview.",O.truncated?" Showing top classes by frequency.":""]}),F!==null&&a.jsxs("p",{className:"canvas-modal__note canvas-modal__note--muted",children:["Preview rows after resampling: ",_(F),"."]})]}):a.jsx("p",{className:"canvas-modal__note",children:"No class distribution available in the preview sample. Refresh after configuring the node or increasing the sample size."}))]})},l$=({catalogFlags:e,binnedDistributionData:t})=>{const{isBinnedDistributionNode:n}=e;return y.useMemo(()=>{if(!n)return[];const i=(Array.isArray(t==null?void 0:t.columns)?t==null?void 0:t.columns:[]).map(l=>{if(!l||!l.column)return null;const c=Number(l.total_rows),u=Number.isFinite(c)?Math.max(0,Math.round(c)):0;if(u<=0)return null;const f=(Array.isArray(l.bins)?l.bins:[]).map(P=>{if(!P)return null;const O=(typeof P.label=="string"?P.label.trim():String(P.label??""))||(P.is_missing?"Missing":"Unlabeled bin"),F=Number(P.count);if(!Number.isFinite(F))return null;const B=Math.max(0,Math.round(F)),L=Number(P.percentage),D=Number.isFinite(L)?Math.min(100,Math.max(0,L)):0,q=Number(D.toFixed(2));return{label:O,count:B,percentage:q,isMissing:!!P.is_missing}}).filter(P=>!!P);if(!f.length)return null;f.sort((P,T)=>P.isMissing!==T.isMissing?P.isMissing?1:-1:P.count!==T.count?T.count-P.count:P.label.localeCompare(T.label));const h=f.length,p=12,g=h>p,_=g?f.slice(0,p):f,N=Number(l.missing_rows),v=Number.isFinite(N)?Math.max(0,Math.round(N)):0,x=Number(l.distinct_bins),j=Number.isFinite(x)?Math.max(0,Math.round(x)):f.length,k=l.top_label;let S=typeof k=="string"?k.trim()||null:k??null;const C=Number(l.top_count);let w=Number.isFinite(C)?Math.max(0,Math.round(C)):null;const E=Number(l.top_percentage);let A=Number.isFinite(E)?Number(Math.min(100,Math.max(0,E)).toFixed(2)):null;(S===null||w===null||A===null)&&_.length&&(S=_[0].label,w=_[0].count,A=_[0].percentage);const R=typeof l.source_column=="string"?l.source_column.trim()||null:l.source_column??null;return{column:l.column,sourceColumn:R,totalRows:u,missingRows:v,distinctBins:j,topLabel:S,topCount:w,topPercentage:A,bins:_,hasMoreBins:g,totalBinCount:h}}).filter(l=>!!l);return i.sort((l,c)=>{const u=(c.topCount??0)-(l.topCount??0);return u!==0?u:l.column.localeCompare(c.column)}),i},[t,n])},Cs=["iqr","zscore","elliptic_envelope","winsorize","manual"],Eo={iqr:"IQR filter",zscore:"Z-score filter",elliptic_envelope:"Elliptic Envelope",winsorize:"Winsorize",manual:"Manual bounds"},Fu={iqr:["multiplier"],zscore:["threshold"],elliptic_envelope:["contamination"],winsorize:["lower_percentile","upper_percentile"],manual:["lower_bound","upper_bound"]},wa={iqr:{multiplier:1.5},zscore:{threshold:3},elliptic_envelope:{contamination:.01},winsorize:{lower_percentile:5,upper_percentile:95},manual:{}},Iu=(e,{min:t,max:n}={})=>{const s=typeof e=="number"?e:Number(e);if(!Number.isFinite(s))return null;let i=s;return typeof t=="number"&&Number.isFinite(t)&&i<t&&(i=t),typeof n=="number"&&Number.isFinite(n)&&i>n&&(i=n),i},bx=e=>{const t=[];return Array.isArray(e)?e.forEach(n=>{const s=String(n??"").trim();s&&t.push(s)}):typeof e=="string"&&e.split(",").map(n=>n.trim()).forEach(n=>{n&&t.push(n)}),Array.from(new Set(t)).sort((n,s)=>n.localeCompare(s))},c$=e=>{const t={iqr:{...wa.iqr},zscore:{...wa.zscore},elliptic_envelope:{...wa.elliptic_envelope},winsorize:{...wa.winsorize},manual:{}};return!e||typeof e!="object"||Array.isArray(e)||Object.entries(e).forEach(([n,s])=>{const i=n.trim().toLowerCase();if(!Cs.includes(i))return;const l=t[i]??{};if(!(!s||typeof s!="object"||Array.isArray(s))){if(Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Fu[i].includes(d))return;let f={};d==="threshold"?f={min:.1}:d==="multiplier"?f={min:.1}:(d==="lower_percentile"||d==="upper_percentile")&&(f={min:0,max:100});const h=Iu(u,f);h!==null&&(l[d]=h)}),i==="winsorize"){const c=Iu(l.lower_percentile,{min:0,max:100}),u=Iu(l.upper_percentile,{min:0,max:100});typeof c=="number"&&typeof u=="number"&&c>=u?(l.lower_percentile=wa.winsorize.lower_percentile,l.upper_percentile=wa.winsorize.upper_percentile):(typeof c=="number"&&(l.lower_percentile=c),typeof u=="number"&&(l.upper_percentile=u))}t[i]=l}}),t},u$=e=>{if(!e||typeof e!="object"||Array.isArray(e))return{};const t={};return Object.entries(e).forEach(([n,s])=>{const i=String(n??"").trim();if(!i||!s||typeof s!="object"||Array.isArray(s))return;const l={};Object.entries(s).forEach(([c,u])=>{const d=c.trim().toLowerCase();if(!Object.values(Fu).some(g=>g.includes(d)))return;let h={};d==="threshold"?h={min:.1}:d==="multiplier"?h={min:.1}:d==="contamination"?h={min:1e-4,max:.49}:(d==="lower_percentile"||d==="upper_percentile")&&(h={min:0,max:100});const p=Iu(u,h);p!==null&&(l[d]=p)}),Object.keys(l).length&&(t[i]=l)}),t},d$=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=bx(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",i=Cs.includes(s)?s:"iqr",l={};t.column_methods&&typeof t.column_methods=="object"&&!Array.isArray(t.column_methods)&&Object.entries(t.column_methods).forEach(([h,p])=>{const g=String(h??"").trim(),_=typeof p=="string"?p.trim().toLowerCase():"";g&&Cs.includes(_)&&(l[g]=_)});const c=typeof t.auto_detect=="boolean"?t.auto_detect:!0,u=bx(t.skipped_columns),d=c$(t.method_parameters),f=u$(t.column_parameters);return{columns:n,defaultMethod:i,columnMethods:l,autoDetect:c,skippedColumns:u,methodParameters:d,columnParameters:f}},m$=e=>{const t={...Eo};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&i&&Cs.includes(s)&&(t[s]=i)}),t},h$=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&Cs.includes(s)&&t.set(s,n)}),t},f$=e=>Cs.map(t=>({value:t,label:e[t]??Eo[t]??t})),p$=({insights:e,outlierConfig:t,labelMap:n,selectedColumns:s,skippedColumns:i,excludedColumns:l})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const f={};Array.isArray(u==null?void 0:u.method_summaries)&&u.method_summaries.forEach(S=>{const C=S==null?void 0:S.method;C&&Cs.includes(C)&&(f[C]=S)});const h=u!=null&&u.recommended_method&&Cs.includes(u.recommended_method)?u.recommended_method:null,p=h?n[h]??Eo[h]??h:null,g=t.columnMethods[d]??null,_=g??t.defaultMethod,N=n[_]??Eo[_]??_,v=i.has(d),x=l.has(d),j=s.has(d),k=!!(u!=null&&u.has_missing);c.push({column:d,dtype:typeof(u==null?void 0:u.dtype)=="string"?u.dtype:null,stats:(u==null?void 0:u.stats)??{},recommendedMethod:h,recommendedLabel:p,recommendedReason:typeof(u==null?void 0:u.recommended_reason)=="string"?u.recommended_reason:null,methodSummaries:f,currentOverride:g,currentMethod:_,currentMethodLabel:N,isOverrideApplied:g!==null,isSelected:j,isSkipped:v,isExcluded:x,hasMissing:k})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},g$=(e,t,n,s)=>{if(!e.length)return null;const i=e.map(l=>{const c=t[l],u=c?n[c]??Eo[c]??c:null;return u?`${l} -> ${u}`:l});return s>e.length&&i.push(""),i.join(", ")},_$=(e,t)=>{var i;const n=(i=e==null?void 0:e.parameter_help)==null?void 0:i[t];if(n)return n;const s=t.replace(/_/g," ").trim();return s.charAt(0).toUpperCase()+s.slice(1)},v$=e=>{if(!e)return null;const t=[];if(e.removed_rows&&e.removed_rows>0&&t.push(`Removed ${e.removed_rows} row${e.removed_rows===1?"":"s"}`),Array.isArray(e.clipped_columns)&&e.clipped_columns.length){const n=Array.from(new Set(e.clipped_columns));t.push(`Winsorized ${n.length} column${n.length===1?"":"s"}`)}if(t.length||t.push("No rows removed or clipped during the last preview"),Array.isArray(e.skipped_columns)&&e.skipped_columns.length){const n=e.skipped_columns.join(", ");t.push(`Skipped columns: ${n}`)}return t.join("  ")},y$=(e,t,n,s,i)=>{var f;const l=n[s]??{};if(Object.prototype.hasOwnProperty.call(l,t)){const h=l[t];if(typeof h=="number"&&Number.isFinite(h))return{value:h,fallback:null}}const u=(i[e]??{})[t];return typeof u=="number"&&Number.isFinite(u)?{value:"",fallback:u}:{value:"",fallback:((f=wa[e])==null?void 0:f[t])??null??null}},xx=e=>typeof e=="number"&&Number.isFinite(e)?String(e):"",wx={lower_percentile:"%",upper_percentile:"%"},b$=({sourceId:e,hasReachableSource:t,isFetchingOutliers:n,outlierConfig:s,outlierMethodOptions:i,outlierMethodDetailMap:l,outlierDefaultDetail:c,outlierAutoDetectEnabled:u,outlierSelectedCount:d,outlierDefaultLabel:f,outlierOverrideCount:h,outlierParameterOverrideCount:p,outlierOverrideExampleSummary:g,outlierHasOverrides:_,outlierRecommendationRows:N,outlierHasRecommendations:v,outlierStatusMessage:x,outlierError:j,outlierSampleSize:k,relativeOutlierGeneratedAt:S,outlierPreviewSignal:C,formatMetricValue:w,formatNumericStat:E,onApplyAllRecommendations:A,onClearOverrides:R,onDefaultMethodChange:P,onAutoDetectToggle:T,onOverrideSelect:O,onMethodParameterChange:F,onColumnParameterChange:B})=>{const L=v$(C);return a.jsxs("section",{className:"canvas-modal__section",children:[a.jsxs("div",{className:"canvas-modal__section-header",children:[a.jsx("h3",{children:"Outlier insights"}),a.jsxs("div",{className:"canvas-modal__section-actions",children:[a.jsx("button",{type:"button",className:"btn btn-primary",onClick:A,disabled:!v,children:"Apply recommendations"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:R,disabled:!_,children:"Clear overrides"})]})]}),a.jsx("p",{className:"canvas-modal__note",children:"Diagnose numeric outliers and configure how to handle them across the dataset. Preview updates immediately, letting you validate the impact before saving this node."}),!e&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Select a dataset to surface outlier diagnostics."}),e&&!t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Connect this step to an upstream output to analyse numeric distributions."}),S&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated ",S,k!==null?` on ${w(k)} row${k===1?"":"s"}.`:"."]}),!S&&k!==null&&a.jsxs("p",{className:"canvas-modal__note",children:["Insights generated on ",w(k)," row",k===1?"":"s","."]}),L&&a.jsxs("p",{className:"canvas-modal__note",children:["Last preview: ",L]}),a.jsxs("div",{className:"canvas-modal__parameter-grid",children:[a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Default outlier method"})}),a.jsx("div",{className:"canvas-scaling__method-toggle",role:"group","aria-label":"Default outlier method",children:i.map(D=>{const q=l.get(D.value)??null,Y=D.value===s.defaultMethod;return a.jsxs("button",{type:"button",className:`canvas-scaling__method-button${Y?" canvas-scaling__method-button--active":""}`,"aria-pressed":Y,onClick:()=>P(D.value),children:[a.jsx("span",{className:"canvas-scaling__method-label",children:D.label}),(q==null?void 0:q.description)&&a.jsx("span",{className:"canvas-scaling__method-description",children:q.description})]},D.value)})}),(c==null?void 0:c.description)&&a.jsx("p",{className:"canvas-modal__parameter-description",children:c.description})]}),a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Auto-detect numeric columns"})}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{type:"checkbox",checked:u,onChange:D=>T(D.target.checked)}),a.jsx("span",{children:u?"Enabled":"Disabled"})]}),a.jsx("p",{className:"canvas-modal__parameter-description",children:"Auto-detection tracks numeric features so newly profiled columns join the node automatically."})]})]}),a.jsxs("section",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("span",{children:"Global method parameters"})}),a.jsx("p",{className:"canvas-modal__parameter-description canvas-outlier__method-note",children:"Tune default thresholds for each strategy. Column overrides can refine these further."}),a.jsx("div",{className:"canvas-outlier__method-grid",children:Cs.map(D=>{const q=l.get(D)??null,Y=Fu[D];if(!Y.length)return null;const W=(q==null?void 0:q.label)??Eo[D]??D;return a.jsxs("article",{className:"canvas-outlier__method-card",children:[a.jsxs("header",{className:"canvas-outlier__method-header",children:[a.jsx("span",{className:"canvas-outlier__method-title",children:W}),(q==null?void 0:q.description)&&a.jsx("p",{className:"canvas-outlier__method-summary",children:q.description})]}),a.jsx("div",{className:"canvas-outlier__parameter-list",children:Y.map(X=>{var H,te;const I=((H=s.methodParameters[D])==null?void 0:H[X])??null,z=wx[X]??"";return a.jsxs("label",{className:"canvas-outlier__method-parameter",children:[a.jsx("span",{className:"canvas-outlier__parameter-label",children:_$(q,X)}),a.jsxs("div",{className:"canvas-outlier__method-input",children:[a.jsx("input",{type:"number",className:"canvas-outlier__method-input-field",value:typeof I=="number"&&Number.isFinite(I)?I:"",placeholder:xx(((te=wa[D])==null?void 0:te[X])??null),onChange:K=>{const V=K.target.value;if(V==="")F(D,X,null);else{const G=Number(V);F(D,X,Number.isFinite(G)?G:null)}}}),z&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:z})]})]},`${D}-${X}`)})})]},`outlier-method-${D}`)})})]}),a.jsxs("p",{className:"canvas-modal__note",children:["Tracking ",a.jsx("strong",{children:d})," column",d===1?"":"s","  Default method"," ",a.jsx("strong",{children:f})," ",u?" Auto-detect on":" Auto-detect off",(()=>{if(!(h+p))return"  No overrides yet";const q=[];return h>0&&q.push(g?`${h} method override${h===1?"":"s"} (${g})`:`${h} method override${h===1?"":"s"}`),p>0&&q.push(`${p} parameter override${p===1?"":"s"}`),`  Overrides: ${q.join("; ")}`})()]}),n&&a.jsx("p",{className:"canvas-modal__note",children:"Loading outlier diagnostics"}),!n&&j&&e&&t&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:j}),!n&&!j&&a.jsxs(a.Fragment,{children:[x&&a.jsx("p",{className:"canvas-modal__note",children:x}),N.length>0&&a.jsx("div",{className:"canvas-cast__body",children:a.jsx("div",{className:"canvas-cast__table-wrapper",children:a.jsxs("table",{className:"canvas-cast__table canvas-scaling__table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",children:"Column"}),a.jsx("th",{scope:"col",children:"Recommendation"}),a.jsx("th",{scope:"col",children:"Distribution"}),a.jsx("th",{scope:"col",children:"Configured method"})]})}),a.jsx("tbody",{children:N.map(D=>{const q=!D.isSkipped&&!D.isExcluded&&D.recommendedMethod&&D.recommendedMethod!==D.currentMethod,Y=["canvas-cast__row"];q&&Y.push("canvas-cast__row--attention"),D.isOverrideApplied&&Y.push("canvas-cast__row--override"),D.isSkipped&&Y.push("canvas-cast__row--muted");const W=D.isSkipped?"__skip__":D.isOverrideApplied?D.currentMethod:"__default__",X=D.isOverrideApplied?`Override -> ${D.currentMethodLabel}`:D.isSkipped?"Skipped (column will not be altered)":D.isSelected?`Inheriting ${f}`:"Pending inclusion",I=D.stats,z=[];typeof I.valid_count=="number"&&Number.isFinite(I.valid_count)&&z.push(`${w(I.valid_count)} valid rows`);const H=typeof I.minimum=="number"&&Number.isFinite(I.minimum),te=typeof I.maximum=="number"&&Number.isFinite(I.maximum);if(H||te){const J=H?E(I.minimum):"",re=te?E(I.maximum):"";z.push(`Range ${J}  ${re}`)}typeof I.mean=="number"&&Number.isFinite(I.mean)&&z.push(`Mean ${E(I.mean)}`),typeof I.median=="number"&&Number.isFinite(I.median)&&z.push(`Median ${E(I.median)}`),typeof I.stddev=="number"&&Number.isFinite(I.stddev)&&z.push(` ${E(I.stddev)}`);const K=z.length?z.join("  "):null,V=!D.recommendedMethod||!D.recommendedLabel?D.recommendedReason||"No outlier risk detected":D.recommendedReason?`${D.recommendedLabel}  ${D.recommendedReason}`:D.recommendedLabel,G=s.columnParameters,Q=s.methodParameters,ne=Fu[D.currentMethod]??[];return a.jsxs("tr",{className:Y.join(" "),children:[a.jsx("th",{scope:"row",children:a.jsxs("div",{className:"canvas-cast__column-cell",children:[a.jsx("span",{className:"canvas-cast__column-name",children:D.column}),a.jsxs("div",{className:"canvas-cast__column-meta",children:[D.dtype&&a.jsxs("span",{className:"canvas-cast__muted",children:["dtype: ",D.dtype]}),D.isExcluded&&a.jsx("span",{className:"canvas-cast__muted",children:"Excluded from outlier evaluation (non-numeric)"}),D.isSelected&&!D.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--selected",children:"In node"}),D.isSkipped&&!D.isExcluded&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--skipped",children:"Skipped"}),D.isOverrideApplied&&a.jsx("span",{className:"canvas-cast__badge canvas-cast__badge--override",children:"Override"}),D.hasMissing&&a.jsx("span",{className:"canvas-cast__muted",children:"Contains missing values"})]})]})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__recommendation",children:[D.recommendedLabel?a.jsx("span",{className:`canvas-cast__chip${q?" canvas-cast__chip--attention":" canvas-cast__chip--applied"}`,children:D.recommendedLabel}):a.jsx("span",{className:"canvas-cast__chip",children:"No action needed"}),V&&a.jsx("span",{className:"canvas-cast__recommendation-note",children:V})]})}),a.jsx("td",{children:K?a.jsx("span",{children:K}):a.jsx("span",{className:"canvas-cast__muted",children:"No distribution summary"})}),a.jsx("td",{children:a.jsxs("div",{className:"canvas-cast__target",children:[a.jsxs("select",{value:W,onChange:J=>O(D.column,J.target.value),disabled:D.isExcluded,children:[a.jsxs("option",{value:"__default__",children:["Inherit default (",f,")"]}),a.jsx("option",{value:"__skip__",children:"Skip outlier handling"}),i.map(J=>a.jsx("option",{value:J.value,children:J.label},`${D.column}-${J.value}`))]}),a.jsx("span",{className:"canvas-cast__target-note",children:X}),ne.length>0&&!D.isExcluded&&a.jsx("div",{className:"canvas-outlier__parameters",children:ne.map(J=>{const{value:re,fallback:Se}=y$(D.currentMethod,J,G,D.column,Q),Re=wx[J]??"";return a.jsxs("label",{children:[a.jsx("span",{children:J.replace(/_/g," ")}),a.jsx("input",{type:"number",value:re,placeholder:xx(Se),onChange:Oe=>{const Fe=Oe.target.value;if(Fe==="")B(D.column,J,null);else{const lt=Number(Fe);B(D.column,J,Number.isFinite(lt)?lt:null)}}}),Re&&a.jsx("span",{className:"canvas-outlier__parameter-suffix",children:Re})]},`${D.column}-${D.currentMethod}-${J}`)})})]})})]},`outlier-row-${D.column}`)})})]})})})]})]})},x$=({connectionInfo:e,connectedInputHandles:t,connectedOutputHandles:n,connectionReady:s})=>e?a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Connection requirements"})}),a.jsxs("p",{className:s?"canvas-modal__note":"canvas-modal__note canvas-modal__note--warning",children:[a.jsx("strong",{children:s?"Ready to execute.":"Missing required connections."})," ",s?"All required inputs are connected; you can continue configuring this node.":"Connect the required inputs listed below before running training or evaluation workflows."]}),e.inputs&&e.inputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Inputs"}),a.jsx("ul",{children:e.inputs.map(i=>{const l=t.has(i.key),c=i.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:i.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:l?"Connected":c?"Missing":"Optional"})]},`inputs-${i.key}`)})})]}),e.outputs&&e.outputs.length>0&&a.jsxs("div",{className:"canvas-modal__note",children:[a.jsx("strong",{children:"Outputs"}),a.jsx("ul",{children:e.outputs.map(i=>{const l=n.has(i.key),c=i.required!==!1;return a.jsxs("li",{children:[a.jsx("span",{children:i.label}),a.jsx("span",{children:" - "}),a.jsx("span",{children:l?"Connected":c?"Unlinked":"Optional"})]},`outputs-${i.key}`)})})]})]}):null,w$=({node:e,graphContext:t,hasReachableSource:n,sourceId:s,formatRelativeTime:i,catalogFlags:l})=>{const{isDatasetProfileNode:c}=l,u=y.useMemo(()=>t?ql(t):"",[t]),d=z1({node:e,isDatasetProfileNode:c,sourceId:s,hasReachableSource:n,graphContext:t,profilingGraphSignature:u,formatRelativeTime:i}),{profileState:f}=d;return{datasetProfileController:d,profileState:f}},N$=({hasDropColumnSource:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:i,columnTypeMap:l,setAvailableColumns:c,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:f,setColumnSuggestions:h})=>{const[p,g]=y.useState([]),[_,N]=y.useState(null),[v,x]=y.useState([]),[j,k]=y.useState(null),[S,C]=y.useState(!1),[w,E]=y.useState(null),[A,R]=y.useState(null),[P,T]=y.useState(0),O=y.useRef(l);y.useEffect(()=>{O.current=l},[l]),y.useEffect(()=>{let q=!0;const Y=W=>{x([]),k(W??null),E(null),R(null),C(!1),g([]),N(null),c([]),u(""),d({}),f({}),h({})};return e?t?i?(C(!0),k(null),yh(t,{graph:s,targetNodeId:n??null}).then(W=>{if(!q)return;const X=Array.isArray(W==null?void 0:W.candidates)?W.candidates:[];x(X),E((W==null?void 0:W.generated_at)??null),R(typeof(W==null?void 0:W.suggested_threshold)=="number"?Number(W.suggested_threshold):null);const I=Array.isArray(W==null?void 0:W.available_filters)?W.available_filters:[];g(I),N(K=>K&&I.some(V=>V.id===K)?K:null);const z={};W&&typeof W=="object"&&(W!=null&&W.column_missing_map)&&typeof W.column_missing_map=="object"&&Object.entries(W.column_missing_map).forEach(([K,V])=>{const G=String(K??"").trim();if(!G)return;const Q=Number(V);Number.isFinite(Q)&&(z[G]=Number(Q))});const H=new Set;Array.isArray(W==null?void 0:W.all_columns)&&W.all_columns.forEach(K=>{const V=String(K??"").trim();V&&H.add(V)}),Object.keys(O.current??{}).forEach(K=>H.add(K));const te=Array.from(H).sort((K,V)=>K.localeCompare(V));te.forEach(K=>{Object.prototype.hasOwnProperty.call(z,K)||(z[K]=0)}),c(te),u(""),d(z),f(K=>{const V=W==null?void 0:W.column_type_map;if(!V||typeof V!="object")return K;const G={...K};return Object.entries(V).forEach(([Q,ne])=>{const J=String(Q??"").trim();if(!J)return;const re=String(ne??"").trim();G[J]=re||K[J]||""}),G}),h(K=>{const V=W==null?void 0:W.column_recommendations;if(!V||typeof V!="object")return K;const G={};return Object.entries(V).forEach(([Q,ne])=>{const J=String(Q??"").trim();if(!J)return;const re=Array.isArray(ne)?ne.map(Se=>String(Se??"").trim()).filter(Boolean):[];G[J]=re}),G})}).catch(W=>{q&&Y((W==null?void 0:W.message)??"Unable to load recommendations")}).finally(()=>{q&&C(!1)}),()=>{q=!1}):(Y("Connect this step to an upstream output to load recommendations."),()=>{q=!1}):(Y(),()=>{q=!1}):(Y(),()=>{q=!1})},[O,s,e,i,n,P,c,d,u,h,f,t]);const F=y.useCallback(()=>{!e||!t||!i||T(q=>q+1)},[e,i,t]),B=y.useMemo(()=>{const q=new Map;return p.forEach(Y=>{Y!=null&&Y.id&&q.set(Y.id,Y.label)}),q},[p]),L=y.useCallback(q=>q?B.has(q)?B.get(q)??null:q.split("_").filter(Boolean).map(W=>W.charAt(0).toUpperCase()+W.slice(1)).join(" ")||q:null,[B]),D=y.useMemo(()=>_?v.filter(q=>Array.isArray(q==null?void 0:q.signals)&&q.signals.includes(_)):v,[_,v]);return{hasDropColumnSource:e,availableFilters:p,activeFilterId:_,setActiveFilterId:N,recommendations:v,filteredRecommendations:D,formatSignalName:L,isFetchingRecommendations:S,recommendationsError:j,recommendationsGeneratedAt:w,suggestedThreshold:A,refreshRecommendations:F}},j$=({sourceId:e,availableFilters:t,activeFilterId:n,setActiveFilterId:s,recommendations:i,filteredRecommendations:l,isFetchingRecommendations:c,recommendationsError:u,relativeGeneratedAt:d,formatSignalName:f,formatMissingPercentage:h,getPriorityClass:p,getPriorityLabel:g,handleToggleColumn:_,selectedColumns:N})=>{const v=x=>{if(!(x!=null&&x.name))return null;const j=String(x.name),k=N.includes(j),S=p(x.priority),C=g(x.priority),w=Array.isArray(x==null?void 0:x.signals)?x.signals.map(E=>f(E)).filter(E=>!!E):[];return a.jsxs("label",{className:"canvas-modal__checkbox-item",children:[a.jsx("input",{type:"checkbox",checked:k,onChange:()=>_(j)}),a.jsxs("div",{className:"canvas-modal__checkbox-content",children:[a.jsx("div",{className:"canvas-modal__recommendation-name",children:j}),a.jsxs("div",{className:"canvas-modal__recommendation-meta",children:[x.missing_percentage!==void 0&&x.missing_percentage!==null&&a.jsx("span",{children:`Missing: ${h(x.missing_percentage)}`}),S&&C&&a.jsx("span",{className:`canvas-modal__priority-badge canvas-modal__priority-badge--${S}`,children:C})]}),w.length>0&&a.jsx("div",{className:"canvas-modal__signal-badges",children:w.map(E=>a.jsx("span",{className:"canvas-modal__signal-badge",children:E},`${j}-${E}`))}),x.reason&&a.jsx("p",{className:"canvas-modal__recommendation-reason",children:x.reason})]})]},j)};return e?a.jsxs(a.Fragment,{children:[t.length>0&&a.jsxs("div",{className:"canvas-modal__filter-row",role:"group","aria-label":"Recommendation filters",children:[a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${n?"":" canvas-modal__filter-button--active"}`,onClick:()=>s(null),children:["All reasons (",i.length,")"]}),t.map(x=>{const j=n===x.id;return a.jsxs("button",{type:"button",className:`canvas-modal__filter-button${j?" canvas-modal__filter-button--active":""}`,onClick:()=>s(k=>k===x.id?null:x.id),title:x.description??void 0,children:[x.label," (",x.count,")"]},x.id)})]}),c&&a.jsx("p",{className:"canvas-modal__note",children:"Loading column recommendations"}),!c&&u&&a.jsx("p",{className:"canvas-modal__note canvas-modal__note--error",children:u}),!c&&!u&&a.jsxs(a.Fragment,{children:[d&&a.jsxs("p",{className:"canvas-modal__note",children:["Recommendations generated ",d,"."]}),l.length?a.jsx("div",{className:"canvas-modal__checkbox-list",role:"group","aria-label":"Recommended columns",children:l.map(x=>v(x))}):a.jsx("p",{className:"canvas-modal__note",children:n?"No columns matched this filter in the latest quality scan.":"No columns crossed the missingness threshold in the latest quality scan."})]})]}):a.jsx("p",{className:"canvas-modal__note canvas-modal__note--warning",children:"Choose a dataset to load EDA-backed column suggestions."})},C$=({parameter:e,previewStateStatus:t,isBinningNode:n,isScalingNode:s,binningAllNumericColumns:i,binningRecommendedColumnSet:l,selectedColumns:c,availableColumns:u,scalingExcludedColumns:d,normalizedColumnSearch:f,filteredColumnOptions:h,binningExcludedColumns:p,selectionCount:g,isCastNode:_,columnSuggestions:N,sourceId:v,isFetchingRecommendations:x,hasReachableSource:j,refreshRecommendations:k,availableFilters:S,activeFilterId:C,setActiveFilterId:w,recommendations:E,filteredRecommendations:A,recommendationsError:R,relativeGeneratedAt:P,formatSignalName:T,handleToggleColumn:O,handleRemoveColumn:F,handleApplyAllRecommended:B,handleBinningApplyColumns:L,handleSelectAllColumns:D,handleClearColumns:q,columnSearch:Y,setColumnSearch:W,columnMissingMap:X,columnTypeMap:I,binningColumnPreviewMap:z,isImputerNode:H,showRecommendations:te})=>{var Ue;const K=((Ue=e==null?void 0:e.source)==null?void 0:Ue.type)==="drop_column_recommendations",V=!K,G=V&&t==="loading",Q=n&&e.name==="columns",ne=s&&e.name==="columns",J=(()=>{if(!Q)return[];const ce=[...i];return l.size>0&&l.forEach(Me=>{ce.includes(Me)||ce.push(Me)}),c.forEach(Me=>{Me&&!ce.includes(Me)&&ce.push(Me)}),ce})(),re=Q?J:ne?u.filter(ce=>!d.has(ce)):u,Se=Q?f?J.filter(ce=>ce.toLowerCase().includes(f)):J:ne?h.filter(ce=>!d.has(ce)):h,Re=Q?c.filter(ce=>!p.has(ce)).length:ne?c.filter(ce=>!d.has(ce)).length:g,Oe=V&&re.length>0&&Re>=re.length,Fe=K||H,lt=new Set(re),Be=_&&V?Object.entries(N).filter(([ce,Me])=>lt.has(ce)&&Me.length>0).map(([ce,Me])=>`${ce}: ${Me.join(", ")}`).slice(0,4):[],de=Q?Array.from(p).slice(0,4):[],pe=ne?Array.from(d).slice(0,4):[],xe=Q&&l.size>0,ke=xe?Array.from(l).some(ce=>!c.includes(ce)):!1;return a.jsxs("div",{className:"canvas-modal__parameter-field canvas-modal__parameter-field--multiselect",children:[a.jsxs("div",{className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),K&&v&&a.jsx("div",{className:"canvas-modal__parameter-actions",children:a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:k,disabled:x||!j,children:x?"Refreshing":"Refresh suggestions"})})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),Be.length>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Smart suggestions: ",Be.join("; ")]}),Q&&p.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",p.size," non-numeric column",p.size===1?"":"s",de.length?` (examples: ${de.join(", ")}${p.size>de.length?", ":""})`:""," binning only supports numeric inputs."]}),ne&&d.size>0&&a.jsxs("p",{className:"canvas-modal__note",children:["Skipping ",d.size," non-numeric column",d.size===1?"":"s",pe.length?` (examples: ${pe.join(", ")}${d.size>pe.length?", ":""})`:""," scaling only supports numeric inputs."]}),K&&a.jsx(j$,{sourceId:v,availableFilters:S,activeFilterId:C,setActiveFilterId:w,recommendations:E,filteredRecommendations:A,isFetchingRecommendations:x,recommendationsError:R,relativeGeneratedAt:P,formatSignalName:T,formatMissingPercentage:Wn,getPriorityClass:U1,getPriorityLabel:q1,handleToggleColumn:O,selectedColumns:c}),a.jsxs("div",{className:"canvas-modal__note",children:["Selected columns: ",a.jsx("strong",{children:Re})]}),Re>0&&a.jsxs("div",{className:"canvas-modal__selection-summary",children:[a.jsx("h4",{children:"Selected columns"}),a.jsx("div",{className:"canvas-modal__selection-chips",children:c.map(ce=>a.jsxs("span",{className:"canvas-modal__selection-chip",children:[ce,a.jsx("button",{type:"button",onClick:()=>F(ce),"aria-label":`Remove ${ce}`,children:""})]},ce))})]}),a.jsxs("div",{className:"canvas-modal__multi-select-actions",children:[K&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:B,disabled:!E.length,children:"Use all recommendations"}),xe&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:()=>L(l),disabled:!ke,children:"Add recommended columns"}),V&&a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:D,disabled:!re.length||Oe,children:"Select all columns"}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:q,disabled:!g,children:"Clear selection"})]}),a.jsxs("div",{className:"canvas-modal__all-columns",children:[a.jsx("h4",{children:"All columns"}),a.jsx("div",{className:"canvas-modal__all-columns-search",children:a.jsx("input",{type:"text",className:"canvas-modal__custom-input",value:Y,onChange:ce=>W(ce.target.value),placeholder:"Search columns","aria-label":"Search columns"})}),a.jsx("div",{className:"canvas-modal__all-columns-list",role:"group","aria-label":"All columns",children:Se.length?Se.map(ce=>{const Me=c.includes(ce),Ye=Object.prototype.hasOwnProperty.call(X,ce)?X[ce]:void 0,at=Wn(typeof Ye=="number"?Ye:null),Ze=I[ce]??null,_t=N[ce]??[],st=Q?z[ce]:void 0,dt=!!(st&&(st.min!==null&&st.min!==void 0||st.max!==null&&st.max!==void 0)),jt=Q?(st==null?void 0:st.distinct)??null:null,zt=Q&&jt!==null&&Number.isFinite(jt),Ge=zt?jt:null,Ft=!Q,Kt=Ft||Fe||dt||zt,Mt=Ft&&_t.length>0;return a.jsxs("label",{className:`canvas-modal__checkbox-item canvas-modal__checkbox-item--compact${Me?" canvas-modal__checkbox-item--selected":""}`,children:[a.jsx("input",{type:"checkbox",checked:Me,onChange:()=>O(ce)}),a.jsxs("div",{className:"canvas-modal__column-option",children:[a.jsx("span",{className:"canvas-modal__column-option-name",children:ce}),Kt&&a.jsxs("div",{className:"canvas-modal__column-option-meta",children:[Ft&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Type: ",s2(Ze)]}),Fe&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Missing: ",at]}),dt&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:[Q?"Sample range":"Range",":"," ",st&&st.min!==null&&st.min!==void 0?js(st.min):""," ",""," ",st&&st.max!==null&&st.max!==void 0?js(st.max):""]}),zt&&Ge!==null&&a.jsxs("span",{className:"canvas-modal__column-option-metric",children:["Distinct sample values: ",zs(Ge)]})]}),Mt&&a.jsxs("span",{className:"canvas-modal__column-option-hint",children:["Suggested: ",_t.join(", ")]})]})]},ce)}):a.jsx("p",{className:"canvas-modal__note",children:u.length?Q&&re.length===0?"No eligible columns for binning (non-numeric fields are skipped).":"No columns match your search.":G?"Loading column catalog":v?j?"Column catalog unavailable for this dataset.":"Connect this step to an upstream output to load column catalog.":"Select a dataset to load column catalog."})})]})]},e.name)},S$=({parameter:e,nodeId:t,configState:n,handleNumberChange:s,handleBooleanChange:i,handleTextChange:l,thresholdParameterName:c,normalizedSuggestedThreshold:u,showRecommendations:d,canApplySuggestedThreshold:f,thresholdMatchesSuggestion:h,handleApplySuggestedThreshold:p,renderMultiSelect:g})=>{var v;if(!(e!=null&&e.name))return null;if(e.type==="multi_select")return a.jsx(a.Fragment,{children:g(e)});if(e.type==="number"){const x=`node-${t}-${e.name}`,j=n==null?void 0:n[e.name],k=typeof j=="number"?j:j??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsxs("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:[a.jsx("span",{children:e.label}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("div",{className:"canvas-modal__parameter-control",children:[a.jsx("input",{id:x,type:"number",className:"canvas-modal__input",value:k,min:e.min!==void 0?e.min:void 0,max:e.max!==void 0?e.max:void 0,step:e.step!==void 0?e.step:"any",onChange:S=>s(e.name,S.target.value)}),e.unit&&a.jsx("span",{className:"canvas-modal__parameter-unit",children:e.unit})]}),c===e.name&&u!==null&&d&&a.jsxs("div",{className:"canvas-modal__note",children:["Suggested threshold from EDA:"," ",a.jsx("strong",{children:Wn(u)}),a.jsx("button",{type:"button",className:"btn btn-outline-secondary",onClick:p,disabled:!f,children:h?"Applied":"Apply suggestion"})]})]},e.name)}if(e.type==="boolean"){const x=`node-${t}-${e.name}`,j=!!(n!=null&&n[e.name]);return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("div",{className:"canvas-modal__parameter-label",children:a.jsx("label",{htmlFor:x,children:e.label})}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsxs("label",{className:"canvas-modal__boolean-control",children:[a.jsx("input",{id:x,type:"checkbox",checked:j,onChange:k=>i(e.name,k.target.checked)}),a.jsx("span",{children:j?"Enabled":"Disabled"})]})]},e.name)}if(e.type==="select"){const x=`node-${t}-${e.name}`,j=Array.isArray(e.options)?e.options:[],k=n==null?void 0:n[e.name],S=typeof e.default=="string"?e.default:((v=j.find(w=>w&&typeof w.value=="string"))==null?void 0:v.value)??"",C=typeof k=="string"&&k.trim().length?k:S;return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("select",{id:x,className:"canvas-modal__input",value:C,onChange:w=>l(e.name,w.target.value),children:j.map(w=>a.jsx("option",{value:w.value,title:w.description??void 0,children:w.label??w.value},w.value))})]},e.name)}if(e.type==="textarea"){const x=`node-${t}-${e.name}`;if(e.name==="hyperparameters"){let k="",S=n==null?void 0:n[e.name];if(typeof S=="string"&&S.trim())try{const C=JSON.parse(S);C&&typeof C=="object"&&!Array.isArray(C)?k=Object.entries(C).map(([w,E])=>`${w}: ${JSON.stringify(E)}`).join(`
`):k=S}catch{k=S}else S&&typeof S=="object"&&!Array.isArray(S)&&(k=Object.entries(S).map(([C,w])=>`${C}: ${JSON.stringify(w)}`).join(`
`));return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description||"Enter parameters as key: value pairs (one per line)"}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:k,placeholder:`n_estimators: 100
max_depth: 10
learning_rate: 0.01`,onChange:C=>{const E=C.target.value.split(`
`).filter(R=>R.trim()),A={};for(const R of E){const P=R.indexOf(":");if(P===-1)continue;const T=R.substring(0,P).trim(),O=R.substring(P+1).trim();if(T)try{A[T]=JSON.parse(O)}catch{A[T]=O}}l(e.name,JSON.stringify(A,null,2))},rows:6})]},e.name)}const j=typeof(n==null?void 0:n[e.name])=="string"?n==null?void 0:n[e.name]:"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:x,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("textarea",{id:x,className:"canvas-modal__input canvas-modal__input--wide",value:j,placeholder:e.placeholder??"",onChange:k=>l(e.name,k.target.value),rows:4})]},e.name)}const _=`node-${t}-${e.name}`,N=(n==null?void 0:n[e.name])??"";return a.jsxs("div",{className:"canvas-modal__parameter-field",children:[a.jsx("label",{htmlFor:_,className:"canvas-modal__parameter-label",children:e.label}),e.description&&a.jsx("p",{className:"canvas-modal__parameter-description",children:e.description}),a.jsx("input",{id:_,type:"text",className:"canvas-modal__input canvas-modal__input--wide",value:N,placeholder:e.placeholder??"",onChange:x=>l(e.name,x.target.value)})]},e.name)},E$=({nodeId:e,catalogFlags:t,configState:n,previewState:s,binning:i,scaling:l,selectedColumns:c,availableColumns:u,filteredColumnOptions:d,normalizedColumnSearch:f,columnSearch:h,setColumnSearch:p,columnSuggestions:g,columnMissingMap:_,columnTypeMap:N,sourceId:v,hasReachableSource:x,recommendationsState:j,columnSelectionHandlers:k,parameterHandlers:S,thresholdRecommendations:C,numericExcludedColumns:w,selectionCount:E})=>{const{isBinningNode:A,isScalingNode:R,isCastNode:P,isImputerNode:T}=t,O=y.useCallback(B=>a.jsx(C$,{parameter:B,previewStateStatus:s.status,isBinningNode:A,isScalingNode:R,binningAllNumericColumns:i.state.allNumericColumns,binningRecommendedColumnSet:i.state.recommendedColumnSet,selectedColumns:c,availableColumns:u,scalingExcludedColumns:l.state.excludedColumns,normalizedColumnSearch:f,filteredColumnOptions:d,binningExcludedColumns:i.state.excludedColumns,selectionCount:E,isCastNode:P,columnSuggestions:g,sourceId:v,isFetchingRecommendations:j.isFetching,hasReachableSource:x,refreshRecommendations:j.refresh,availableFilters:j.availableFilters,activeFilterId:j.activeFilterId,setActiveFilterId:j.setActiveFilterId,recommendations:j.recommendations,filteredRecommendations:j.filteredRecommendations,recommendationsError:j.error,relativeGeneratedAt:j.relativeGeneratedAt,formatSignalName:j.formatSignalName,handleToggleColumn:k.handleToggleColumn,handleRemoveColumn:k.handleRemoveColumn,handleApplyAllRecommended:k.handleApplyAllRecommended,handleBinningApplyColumns:i.handlers.handleApplyColumns,handleSelectAllColumns:k.handleSelectAllColumns,handleClearColumns:k.handleClearColumns,columnSearch:h,setColumnSearch:p,columnMissingMap:_,columnTypeMap:N,binningColumnPreviewMap:i.state.columnPreviewMap,isImputerNode:T,showRecommendations:j.show}),[j.activeFilterId,u,j.availableFilters,_,h,g,N,i.state.allNumericColumns,w,d,j.filteredRecommendations,j.formatSignalName,k.handleApplyAllRecommended,i.handlers.handleApplyColumns,k.handleClearColumns,k.handleRemoveColumn,k.handleSelectAllColumns,k.handleToggleColumn,x,P,j.isFetching,A,i.state.recommendedColumnSet,i.state.columnPreviewMap,T,R,i.state.excludedColumns,s.status,j.recommendations,j.error,j.relativeGeneratedAt,c,E,j.setActiveFilterId,p,l.state.excludedColumns,j.show,v,j.refresh,f]),F=y.useCallback(B=>a.jsx(S$,{parameter:B,nodeId:e,configState:n,handleNumberChange:S.handleNumberChange,handleBooleanChange:S.handleBooleanChange,handleTextChange:S.handleTextChange,thresholdParameterName:C.thresholdParameterName,normalizedSuggestedThreshold:C.normalizedSuggestedThreshold,showRecommendations:j.show,canApplySuggestedThreshold:C.canApplySuggestedThreshold,thresholdMatchesSuggestion:C.thresholdMatchesSuggestion,handleApplySuggestedThreshold:C.handleApplySuggestedThreshold,renderMultiSelect:O}),[C.canApplySuggestedThreshold,n,C.handleApplySuggestedThreshold,S.handleBooleanChange,S.handleNumberChange,S.handleTextChange,e,C.normalizedSuggestedThreshold,O,j.show,C.thresholdMatchesSuggestion,C.thresholdParameterName]);return{renderMultiSelectField:O,renderParameterField:F}},Kl={status:"idle",data:null,error:null},k$=1e3,M$=({shouldFetchPreview:e,sourceId:t,canTriggerPreview:n,graphSnapshot:s,catalogFlags:i,targetNodeId:l,previewSignature:c,skipPreview:u=!1,requestPreviewRows:d,includeSignals:f})=>{const{isPreviewNode:h}=i,[p,g]=y.useState(Kl),[_,N]=y.useState(0),v=y.useRef(null),x=y.useRef(-1),j=y.useCallback(()=>{N(k=>k+1)},[]);return y.useEffect(()=>{if(!e){g(Kl),v.current=null,x.current=-1;return}if(u)return;if(!t){g(h?{status:"error",data:null,error:"Select a dataset to generate previews."}:Kl);return}if(!n){g(h?{status:"error",data:null,error:"Add nodes to the canvas before generating a snapshot."}:Kl);return}if(!s)return;const k=(()=>{const T=Array.isArray(s.nodes)?s.nodes.map(F=>F&&typeof F.id=="string"?F.id:null).filter(F=>!!F).sort():[],O=Array.isArray(s.edges)?s.edges.map(F=>{const B=F&&typeof F.source=="string"?F.source.trim():"",L=F&&typeof F.target=="string"?F.target.trim():"";return B&&L?`${B}->${L}`:null}).filter(F=>!!F).sort():[];return JSON.stringify({sourceId:t??null,targetNodeId:l??null,nodeIds:T,edgePairs:O})})(),S=c??k,C=S!==v.current;if(!(x.current!==_)&&!C)return;v.current=S,x.current=_;let E=!0;g(T=>({status:"loading",data:T.data??null,error:null}));const A=d??h,R=f??A,P={dataset_source_id:t,graph:{nodes:s.nodes,edges:s.edges},target_node_id:l??void 0,include_preview_rows:A,include_signals:R};return A&&(P.sample_size=k$),gy(P).then(T=>{E&&g({status:"success",data:T,error:null})}).catch(T=>{E&&g(h?{status:"error",data:null,error:(T==null?void 0:T.message)??"Unable to generate preview."}:Kl)}),()=>{E=!1}},[n,s,h,u,c,_,e,t,l]),{previewState:p,refreshPreview:j}},A$=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:i,nodeId:l,previewSignature:c,skipPreview:u,catalogFlags:d,cachedPreviewSchema:f,setCachedPreviewSchema:h})=>{var R;const{isPreviewNode:p,isFeatureMathNode:g,isPolynomialFeaturesNode:_,isFeatureSelectionNode:N,isTrainTestSplitNode:v,isOutlierNode:x,isTransformerAuditNode:j}=d,k=y.useMemo(()=>!(!e||!t||!n),[t,e,n]),S=y.useMemo(()=>!e||!s||!n?!1:t>0,[t,e,n,s]),C=y.useMemo(()=>p||g||_||N||v||x||j,[g,N,x,_,p,v,j]),{previewState:w,refreshPreview:E}=M$({shouldFetchPreview:k,sourceId:s,canTriggerPreview:S,graphSnapshot:e,catalogFlags:d,targetNodeId:(i==null?void 0:i.id)??null,previewSignature:c,skipPreview:u,requestPreviewRows:p,includeSignals:C});y.useEffect(()=>{var T;const P=((T=w.data)==null?void 0:T.schema)??null;P&&h(O=>O!=null&&O.signature&&P.signature&&O.signature===P.signature?O:P)},[(R=w.data)==null?void 0:R.schema]),y.useEffect(()=>{h(null)},[s]),y.useEffect(()=>{h(null)},[c]);const A=y.useCallback(()=>{h(null)},[]);return{previewState:w,refreshPreview:E,cachedPreviewSchema:f,clearCachedPreviewSchema:A,canTriggerPreview:S}},O$=({previewState:e,nodeId:t,catalogFlags:n})=>{var _,N,v,x,j,k,S,C,w,E;const{isFeatureMathNode:s,isPolynomialFeaturesNode:i,isFeatureSelectionNode:l,isOutlierNode:c,isTransformerAuditNode:u}=n,d=y.useMemo(()=>{var R,P;if(!s)return[];const A=(P=(R=e.data)==null?void 0:R.signals)==null?void 0:P.feature_math;return Array.isArray(A)?A:[]},[s,(N=(_=e.data)==null?void 0:_.signals)==null?void 0:N.feature_math]),f=y.useMemo(()=>{var P,T;if(!i)return null;const A=(T=(P=e.data)==null?void 0:P.signals)==null?void 0:T.polynomial_features;return!Array.isArray(A)||A.length===0?null:(t?A.find(O=>O&&typeof O.node_id=="string"&&O.node_id===t):null)??A[0]??null},[i,t,(x=(v=e.data)==null?void 0:v.signals)==null?void 0:x.polynomial_features]),h=y.useMemo(()=>{var P,T;if(!l)return null;const A=(T=(P=e.data)==null?void 0:P.signals)==null?void 0:T.feature_selection;return!Array.isArray(A)||A.length===0?null:(t?A.find(O=>O&&typeof O.node_id=="string"&&O.node_id===t):null)??A[0]??null},[l,t,(k=(j=e.data)==null?void 0:j.signals)==null?void 0:k.feature_selection]),p=y.useMemo(()=>{var P,T;if(!c)return null;const A=(T=(P=e.data)==null?void 0:P.signals)==null?void 0:T.outlier_removal;return!Array.isArray(A)||!A.length?null:t?A.find(O=>O&&O.node_id===t)??A[A.length-1]??null:A[A.length-1]??null},[c,t,(C=(S=e.data)==null?void 0:S.signals)==null?void 0:C.outlier_removal]),g=y.useMemo(()=>{var P,T;if(!u)return null;const A=(T=(P=e.data)==null?void 0:P.signals)==null?void 0:T.transformer_audit;return!Array.isArray(A)||!A.length?null:t?A.find(O=>O&&O.node_id===t)??A[A.length-1]??null:A[A.length-1]??null},[u,t,(E=(w=e.data)==null?void 0:w.signals)==null?void 0:E.transformer_audit]);return{featureMathSignals:d,polynomialSignal:f,featureSelectionSignal:h,outlierPreviewSignal:p,transformerAuditSignal:g}},T$=({catalogFlags:e,featureSelectionSignal:t,upstreamTargetColumn:n,setConfigState:s})=>{const{isFeatureSelectionNode:i}=e;y.useEffect(()=>{if(!i)return;const l=typeof(t==null?void 0:t.target_column)=="string"?t.target_column.trim():"",c=typeof n=="string"?n.trim():"",u=l||c;u&&s(d=>(typeof(d==null?void 0:d.target_column)=="string"?d.target_column.trim():"")?d:{...d,target_column:u})},[t==null?void 0:t.target_column,i,s,n]),y.useEffect(()=>{if(!i)return;const l=typeof(t==null?void 0:t.k)=="number"&&Number.isFinite(t.k)?Math.max(0,Math.trunc(t.k)):null,c=Array.isArray(t==null?void 0:t.selected_columns)?t.selected_columns.length:null,u=l??c??null;u===null||u<=0||s(d=>{const f=d==null?void 0:d.k;let h=null;if(typeof f=="number"&&Number.isFinite(f))h=Math.trunc(f);else if(typeof f=="string"){const p=Number(f);Number.isFinite(p)&&(h=Math.trunc(p))}return h!==null&&h<=u?d:{...d,k:u}})},[t==null?void 0:t.k,t==null?void 0:t.selected_columns,i,s])},$$=(e,t,n)=>{const{isFeatureMathNode:s}=e,[i,l]=y.useState(()=>new Set),c=y.useMemo(()=>s?Tb((t==null?void 0:t.operations)??[]):[],[t==null?void 0:t.operations,s]),u=y.useMemo(()=>s?dT(c,n):[],[c,n,s]);return y.useEffect(()=>{if(!s){l(()=>new Set);return}l(d=>{if(!d.size)return d;const f=new Set(c.map(p=>p.id)),h=new Set;return d.forEach(p=>{f.has(p)&&h.add(p)}),h.size===d.size?d:h})},[c,s]),{featureMathOperations:c,featureMathSummaries:u,collapsedFeatureMath:i,setCollapsedFeatureMath:l}},P$=e=>{var i,l,c;const t=y.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.columns;return Array.isArray(u)?u.filter(f=>typeof f=="string"):[]},[(i=e.data)==null?void 0:i.columns]),n=y.useMemo(()=>{var d;const u=(d=e.data)==null?void 0:d.column_stats;return Array.isArray(u)?u:[]},[(l=e.data)==null?void 0:l.column_stats]),s=y.useMemo(()=>{var u;return Array.isArray((u=e.data)==null?void 0:u.sample_rows)?e.data.sample_rows:[]},[(c=e.data)==null?void 0:c.sample_rows]);return{previewColumns:t,previewColumnStats:n,previewSampleRows:s}},R$=({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:i,nodeId:l,previewSignature:c,skipPreview:u,cachedPreviewSchema:d,setCachedPreviewSchema:f,catalogFlags:h,upstreamTargetColumn:p,setConfigState:g,configState:_})=>{const N=A$({graphSnapshot:e,graphNodeCount:t,hasReachableSource:n,sourceId:s,node:i,nodeId:l,previewSignature:c,skipPreview:u,cachedPreviewSchema:d,setCachedPreviewSchema:f,catalogFlags:h}),{previewState:v}=N,x=O$({previewState:v,nodeId:l,catalogFlags:h}),{featureSelectionSignal:j,featureMathSignals:k}=x;T$({catalogFlags:h,featureSelectionSignal:j,upstreamTargetColumn:p??"",setConfigState:g});const S=$$(h,_,k),C=P$(v);return{nodePreview:N,previewSignals:x,featureMathState:S,previewData:C}},L$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i,setAvailableColumns:l,setColumnMissingMap:c})=>{const{isImputerNode:u}=e,d=u,[f,h]=y.useState(!1),[p,g]=y.useState(null),[_,N]=y.useState(0),v=y.useCallback(()=>{!d||!t||!n||N(x=>x+1)},[n,d,t]);return y.useEffect(()=>{let x=!0;return d?t?n?(h(!0),g(null),yh(t,{graph:s,targetNodeId:i}).then(j=>{if(!x)return;const k={};j&&typeof j=="object"&&(j!=null&&j.column_missing_map)&&typeof j.column_missing_map=="object"&&Object.entries(j.column_missing_map).forEach(([w,E])=>{const A=String(w??"").trim();if(!A)return;const R=Number(E);Number.isNaN(R)||R<0||(k[A]=Number(R))});const S=new Set;Array.isArray(j==null?void 0:j.all_columns)&&j.all_columns.forEach(w=>{const E=String(w??"").trim();E&&S.add(E)}),Object.keys(k).forEach(w=>S.add(w));const C=Array.from(S).sort((w,E)=>w.localeCompare(E));C.forEach(w=>{Object.prototype.hasOwnProperty.call(k,w)||(k[w]=0)}),C.length&&l(C),Object.keys(k).length&&c(w=>({...w,...k}))}).catch(j=>{x&&g((j==null?void 0:j.message)??"Unable to load column metrics.")}).finally(()=>{x&&h(!1)}),()=>{x=!1}):(g("Connect this step to an upstream output to load column metrics."),h(!1),()=>{x=!1}):(g("Select a dataset to load column metrics."),h(!1),()=>{x=!1}):()=>{x=!1}},[s,n,_,l,c,d,t,i]),{isFetching:f,error:p,refreshDropColumnRecommendations:v}},Yh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,highCardinalityColumns:[],notes:[]},z$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Gh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],D$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=z$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,h=Gh(t.sample_values),p=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:h,score:p,selectable:g}}).filter(t=>!!t),F$=e=>{if(!e||typeof e!="object")return{...Yh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.auto_detect_default,c=Gh(e.high_cardinality_columns),u=Gh(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:l,highCardinalityColumns:c,notes:u}},I$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isLabelEncodingNode:l}=e,[c,u]=y.useState(!1),[d,f]=y.useState(null),[h,p]=y.useState([]),[g,_]=y.useState({...Yh}),[N,v]=y.useState(0);y.useEffect(()=>{let S=!0;const C=w=>{p([]),_({...Yh}),u(!1),f(w??null)};return l?t?n?(u(!0),f(null),ey(t,{graph:s??null,targetNodeId:i??null}).then(w=>{S&&(p(D$(w)),_(F$(w)))}).catch(w=>{if(!S)return;const E=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load label encoding suggestions";C(E)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(C("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(C(),()=>{S=!1}):(C(),()=>{S=!1})},[s,n,l,N,t,i]);const x=y.useCallback(()=>{!l||!t||!n||v(S=>S+1)},[n,l,t]),j=y.useMemo(()=>g,[g]),k=y.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:k,metadata:j,refresh:x}},Qh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableGlobalFallbackDefault:!1,highCardinalityColumns:[],notes:[]},B$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Xh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],U$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=B$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,h=Xh(t.sample_values),p=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_use_global_fallback=="boolean"?t.recommended_use_global_fallback:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:h,score:p,selectable:g,recommended_use_global_fallback:_}}).filter(t=>!!t),q$=e=>{if(!e||typeof e!="object")return{...Qh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.enable_global_fallback_default,c=Xh(e.high_cardinality_columns),u=Xh(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:d,enableGlobalFallbackDefault:l,highCardinalityColumns:c,notes:u}},H$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isTargetEncodingNode:l}=e,[c,u]=y.useState(!1),[d,f]=y.useState(null),[h,p]=y.useState([]),[g,_]=y.useState({...Qh}),[N,v]=y.useState(0);y.useEffect(()=>{let S=!0;const C=w=>{p([]),_({...Qh}),u(!1),f(w??null)};return l?t?n?(u(!0),f(null),ny(t,{graph:s??null,targetNodeId:i??null}).then(w=>{S&&(p(U$(w)),_(q$(w)))}).catch(w=>{if(!S)return;const E=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load target encoding suggestions";C(E)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(C("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(C(),()=>{S=!1}):(C(),()=>{S=!1})},[s,n,l,N,t,i]);const x=y.useCallback(()=>{!l||!t||!n||v(S=>S+1)},[n,l,t]),j=y.useMemo(()=>g,[g]),k=y.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:k,metadata:j,refresh:x}},Bu={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,suggestedBucketDefault:0,highCardinalityColumns:[],notes:[]},V$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},Jh=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],W$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=V$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,h=Jh(t.sample_values),p=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_bucket_count=="number"?Math.max(2,Math.round(t.recommended_bucket_count)):0;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:h,score:p,selectable:g,recommended_bucket_count:_}}).filter(t=>!!t),K$=e=>{if(!e||typeof e!="object")return{...Bu};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.auto_detect_default,c=Number(e.suggested_bucket_default??0)||0,u=Jh(e.high_cardinality_columns),d=Jh(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:l,suggestedBucketDefault:c,highCardinalityColumns:u,notes:d}},Y$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isHashEncodingNode:l}=e,[c,u]=y.useState(!1),[d,f]=y.useState(null),[h,p]=y.useState([]),[g,_]=y.useState({...Bu}),[N,v]=y.useState(0),x=y.useCallback(S=>{p([]),_({...Bu}),u(!1),f(S??null)},[]);y.useEffect(()=>{let S=!0;return l?t?n?(u(!0),f(null),sy(t,{graph:s??null,targetNodeId:i??null}).then(C=>{S&&(p(W$(C)),_(K$(C)))}).catch(C=>{S&&(p([]),_({...Bu}),f(C!=null&&C.message?String(C.message):"Unable to load hash encoding suggestions"))}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(x("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(x(),()=>{S=!1}):(x(),()=>{S=!1})},[s,n,l,x,t,i,N]);const j=y.useCallback(()=>{v(S=>S+1)},[]);return y.useMemo(()=>({isFetching:c,error:d,suggestions:h,metadata:g,refresh:j}),[d,c,g,j,h])},Zh={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,autoDetectDefault:!1,enableUnknownDefault:!1,highCardinalityColumns:[],notes:[]},G$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},ef=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],Q$=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=G$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,h=ef(t.sample_values),p=typeof t.score=="number"?t.score:0,g=typeof t.selectable=="boolean"?t.selectable:!0,_=typeof t.recommended_handle_unknown=="boolean"?t.recommended_handle_unknown:!!(t.missing_percentage&&t.missing_percentage>0);return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:h,score:p,selectable:g,recommended_handle_unknown:_}}).filter(t=>!!t),X$=e=>{if(!e||typeof e!="object")return{...Zh};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=!!e.enable_unknown_default,c=ef(e.high_cardinality_columns),u=ef(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,autoDetectDefault:d,enableUnknownDefault:l,highCardinalityColumns:c,notes:u}},J$=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isOrdinalEncodingNode:l}=e,[c,u]=y.useState(!1),[d,f]=y.useState(null),[h,p]=y.useState([]),[g,_]=y.useState({...Zh}),[N,v]=y.useState(0);y.useEffect(()=>{let S=!0;const C=w=>{p([]),_({...Zh}),u(!1),f(w??null)};return l?t?n?(u(!0),f(null),ty(t,{graph:s??null,targetNodeId:i??null}).then(w=>{S&&(p(Q$(w)),_(X$(w)))}).catch(w=>{if(!S)return;const E=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load ordinal encoding suggestions";C(E)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(C("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(C(),()=>{S=!1}):(C(),()=>{S=!1})},[s,n,l,N,t,i]);const x=y.useCallback(()=>{!l||!t||!n||v(S=>S+1)},[n,l,t]),j=y.useMemo(()=>g,[g]),k=y.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:k,metadata:j,refresh:x}},tf={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[],autoDetectDefault:!1},Z$=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},nf=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],eP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=Z$(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,h=nf(t.sample_values),p=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0,N=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!0;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:h,estimated_dummy_columns:p,score:g,selectable:_,recommended_drop_first:N}}).filter(t=>!!t),tP=e=>{if(!e||typeof e!="object")return{...tf};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=Number(e.cautioned_count??0)||0,c=nf(e.high_cardinality_columns),u=nf(e.notes),d=!!e.auto_detect_default;return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,cautionedCount:l,highCardinalityColumns:c,notes:u,autoDetectDefault:d}},nP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isDummyEncodingNode:l}=e,[c,u]=y.useState(!1),[d,f]=y.useState(null),[h,p]=y.useState([]),[g,_]=y.useState({...tf}),[N,v]=y.useState(0);y.useEffect(()=>{let S=!0;const C=w=>{p([]),_({...tf}),u(!1),f(w??null)};return l?t?n?(u(!0),f(null),ay(t,{graph:s??null,targetNodeId:i??null}).then(w=>{S&&(p(eP(w)),_(tP(w)))}).catch(w=>{if(!S)return;const E=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load dummy encoding suggestions";C(E)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(C("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(C(),()=>{S=!1}):(C(),()=>{S=!1})},[s,n,l,N,t,i]);const x=y.useCallback(()=>{!l||!t||!n||v(S=>S+1)},[n,l,t]),j=y.useMemo(()=>g,[g]),k=y.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:k,metadata:j,refresh:x}},sf={sampleSize:null,generatedAt:null,totalTextColumns:0,recommendedCount:0,cautionedCount:0,highCardinalityColumns:[],notes:[]},sP=e=>{if(typeof e!="string")return"recommended";const t=e.trim().toLowerCase();switch(t){case"recommended":case"high_cardinality":case"identifier":case"free_text":case"single_category":case"too_many_categories":return t;default:return"recommended"}},rf=e=>Array.isArray(e)?e.map(t=>t==null?"":String(t)).filter(t=>t.trim().length>0):[],rP=e=>!e||!Array.isArray(e.columns)?[]:e.columns.map(t=>{if(!t||typeof t!="object")return null;const n=typeof t.column=="string"?t.column.trim():"";if(!n)return null;const s=sP(t.status),i=typeof t.reason=="string"?t.reason:"",l=typeof t.dtype=="string"?t.dtype:null,c=typeof t.unique_count=="number"?t.unique_count:null,u=typeof t.unique_percentage=="number"?t.unique_percentage:null,d=typeof t.missing_percentage=="number"?t.missing_percentage:null,f=typeof t.text_category=="string"?t.text_category:null,h=rf(t.sample_values),p=typeof t.estimated_dummy_columns=="number"?Math.max(0,Math.round(t.estimated_dummy_columns)):0,g=typeof t.score=="number"?t.score:0,_=typeof t.selectable=="boolean"?t.selectable:!0,N=typeof t.recommended_drop_first=="boolean"?t.recommended_drop_first:!1;return{column:n,status:s,reason:i,dtype:l,unique_count:c,unique_percentage:u,missing_percentage:d,text_category:f,sample_values:h,estimated_dummy_columns:p,score:g,selectable:_,recommended_drop_first:N}}).filter(t=>!!t),aP=e=>{if(!e||typeof e!="object")return{...sf};const t=typeof e.sample_size=="number"?e.sample_size:null,n=typeof e.generated_at=="string"?e.generated_at:null,s=Number(e.total_text_columns??0)||0,i=Number(e.recommended_count??0)||0,l=Number(e.cautioned_count??0)||0,c=rf(e.high_cardinality_columns),u=rf(e.notes);return{sampleSize:t,generatedAt:n,totalTextColumns:s,recommendedCount:i,cautionedCount:l,highCardinalityColumns:c,notes:u}},oP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isOneHotEncodingNode:l}=e,[c,u]=y.useState(!1),[d,f]=y.useState(null),[h,p]=y.useState([]),[g,_]=y.useState({...sf}),[N,v]=y.useState(0);y.useEffect(()=>{let S=!0;const C=w=>{p([]),_({...sf}),u(!1),f(w??null)};return l?t?n?(u(!0),f(null),ry(t,{graph:s??null,targetNodeId:i??null}).then(w=>{S&&(p(rP(w)),_(aP(w)))}).catch(w=>{if(!S)return;const E=typeof(w==null?void 0:w.message)=="string"?w.message:"Unable to load one-hot encoding suggestions";C(E)}).finally(()=>{S&&u(!1)}),()=>{S=!1}):(C("Connect this node to the dataset input to load suggestions."),()=>{S=!1}):(C(),()=>{S=!1}):(C(),()=>{S=!1})},[s,n,l,N,t,i]);const x=y.useCallback(()=>{!l||!t||!n||v(S=>S+1)},[n,l,t]),j=y.useMemo(()=>g,[g]),k=y.useMemo(()=>h,[h]);return{isFetching:c,error:d,suggestions:k,metadata:j,refresh:x}},iP=({catalogFlags:e,enableGlobalFallbackDefault:t,encodeMissing:n,handleUnknown:s,setConfigState:i,nodeChangeVersion:l})=>{const{isTargetEncodingNode:c}=e,u=y.useRef(!1);y.useEffect(()=>{u.current=!1},[l]),y.useEffect(()=>{if(!c||!t||u.current)return;const d=typeof n=="boolean"?n:null,f=typeof s=="string"?s.trim().toLowerCase():"";if(d===!0&&f==="global_mean"){u.current=!0;return}i(h=>{const p=typeof(h==null?void 0:h.encode_missing)=="boolean"?h.encode_missing:null,g=typeof(h==null?void 0:h.handle_unknown)=="string"?h.handle_unknown.trim().toLowerCase():"";if(p===!0&&g==="global_mean")return u.current=!0,h;const _={...h};return p!==!0&&(_.encode_missing=!0),g!=="global_mean"&&(_.handle_unknown="global_mean"),u.current=!0,_})},[n,s,c,t,i])},lP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,node:i,configState:l,setConfigState:c,nodeChangeVersion:u})=>{const{isLabelEncodingNode:d,isTargetEncodingNode:f,isHashEncodingNode:h,isOrdinalEncodingNode:p,isDummyEncodingNode:g,isOneHotEncodingNode:_}=e,N=(i==null?void 0:i.id)??null,{isFetching:v,error:x,suggestions:j,metadata:k}=I$({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:N}),{isFetching:S,error:C,suggestions:w,metadata:E}=H$({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:N});iP({catalogFlags:e,enableGlobalFallbackDefault:E.enableGlobalFallbackDefault,encodeMissing:l==null?void 0:l.encode_missing,handleUnknown:l==null?void 0:l.handle_unknown,setConfigState:c,nodeChangeVersion:u});const{isFetching:A,error:R,suggestions:P,metadata:T}=Y$({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:N}),{isFetching:O,error:F,suggestions:B,metadata:L}=J$({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:N}),{isFetching:D,error:q,suggestions:Y,metadata:W}=nP({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:N}),{isFetching:X,error:I,suggestions:z,metadata:H}=oP({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:N});y.useEffect(()=>{d&&(l!=null&&l.auto_detect)&&k.autoDetectDefault&&c(J=>({...J,columns:k.autoDetectDefault}))},[l==null?void 0:l.auto_detect,d,k.autoDetectDefault,c]),y.useEffect(()=>{f&&(l!=null&&l.auto_detect)&&E.autoDetectDefault&&c(J=>({...J,columns:E.autoDetectDefault}))},[l==null?void 0:l.auto_detect,f,c,E.autoDetectDefault]),y.useEffect(()=>{h&&(l!=null&&l.auto_detect)&&T.autoDetectDefault&&c(J=>({...J,columns:T.autoDetectDefault}))},[l==null?void 0:l.auto_detect,T.autoDetectDefault,h,c]),y.useEffect(()=>{h&&T.suggestedBucketDefault&&c(J=>({...J,n_buckets:T.suggestedBucketDefault}))},[T.suggestedBucketDefault,h,c]),y.useEffect(()=>{f&&E.enableGlobalFallbackDefault&&c(J=>{const re={};return J.encode_missing===void 0&&(re.encode_missing=!0),J.handle_unknown===void 0&&(re.handle_unknown="value"),Object.keys(re).length>0?{...J,...re}:J})},[l==null?void 0:l.encode_missing,l==null?void 0:l.handle_unknown,f,c,E.enableGlobalFallbackDefault]),y.useEffect(()=>{p&&(l!=null&&l.auto_detect)&&L.autoDetectDefault&&c(J=>({...J,columns:L.autoDetectDefault}))},[l==null?void 0:l.auto_detect,p,L.autoDetectDefault,c]),y.useEffect(()=>{p&&L.enableUnknownDefault&&c(J=>J.handle_unknown===void 0?{...J,handle_unknown:"use_encoded_value",unknown_value:-1}:J)},[l==null?void 0:l.handle_unknown,p,L.enableUnknownDefault,c]),y.useEffect(()=>{g&&(l!=null&&l.auto_detect)&&W.autoDetectDefault&&c(J=>({...J,columns:W.autoDetectDefault}))},[l==null?void 0:l.auto_detect,W.autoDetectDefault,g,c]);const te=y.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),K=y.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),V=y.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),G=y.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),Q=y.useCallback(J=>{c(re=>({...re,columns:J}))},[c]),ne=y.useCallback(J=>{c(re=>({...re,columns:J}))},[c]);return{labelEncoding:{isFetching:v,error:x,suggestions:j,metadata:k,handleApplyRecommended:te},targetEncoding:{isFetching:S,error:C,suggestions:w,metadata:E,handleApplyRecommended:K},hashEncoding:{isFetching:A,error:R,suggestions:P,metadata:T,handleApplyRecommended:V},ordinalEncoding:{isFetching:O,error:F,suggestions:B,metadata:L,handleApplyRecommended:G},dummyEncoding:{isFetching:D,error:q,suggestions:Y,metadata:W,handleApplyRecommended:Q},oneHotEncoding:{isFetching:X,error:I,suggestions:z,metadata:H,handleApplyRecommended:ne}}},cP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isOutlierNode:l}=e,[c,u]=y.useState(null),[d,f]=y.useState(null),[h,p]=y.useState(!1),[g,_]=y.useState(0),N=y.useCallback(()=>{_(v=>v+1)},[]);return y.useEffect(()=>{let v=!0;return l?t?n?(p(!0),f(null),oy(t,{graph:s,targetNodeId:i}).then(x=>{v&&u(x??null)}).catch(x=>{v&&(u(null),f((x==null?void 0:x.message)??"Unable to load outlier insights"))}).finally(()=>{v&&p(!1)}),()=>{v=!1}):(u(null),f("Connect this step to an upstream output to load outlier insights."),p(!1),()=>{v=!1}):(u(null),f("Select a dataset to load outlier insights."),p(!1),()=>{v=!1}):(u(null),f(null),p(!1),()=>{v=!1})},[s,n,l,g,t,i]),{outlierData:c,outlierError:d,isFetchingOutliers:h,refreshOutliers:N}},uP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isScalingNode:l}=e,[c,u]=y.useState(null),[d,f]=y.useState(null),[h,p]=y.useState(!1),[g,_]=y.useState(0),N=y.useCallback(()=>{_(v=>v+1)},[]);return y.useEffect(()=>{let v=!0;return l?t?n?(p(!0),f(null),ly(t,{graph:s,targetNodeId:i}).then(x=>{v&&u(x??null)}).catch(x=>{v&&(u(null),f((x==null?void 0:x.message)??"Unable to load scaling insights"))}).finally(()=>{v&&p(!1)}),()=>{v=!1}):(u(null),f("Connect this step to an upstream output to load scaling insights."),p(!1),()=>{v=!1}):(u(null),f("Select a dataset to load scaling insights."),p(!1),()=>{v=!1}):(u(null),f(null),p(!1),()=>{v=!1})},[s,n,l,g,t,i]),{scalingData:c,scalingError:d,isFetchingScaling:h,refreshScaling:N}},dP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i})=>{const{isBinningNode:l}=e,[c,u]=y.useState(null),[d,f]=y.useState(null),[h,p]=y.useState(!1),[g,_]=y.useState(0),N=y.useCallback(()=>{_(v=>v+1)},[]);return y.useEffect(()=>{let v=!0;return l?t?n?(p(!0),f(null),cy(t,{graph:s,targetNodeId:i}).then(x=>{v&&u(x??null)}).catch(x=>{v&&(u(null),f((x==null?void 0:x.message)??"Unable to load binning insights"))}).finally(()=>{v&&p(!1)}),()=>{v=!1}):(u(null),f("Connect this step to an upstream output to analyse numeric columns."),p(!1),()=>{v=!1}):(u(null),f("Select a dataset to load binning insights."),p(!1),()=>{v=!1}):(u(null),f(null),p(!1),()=>{v=!1})},[s,n,l,g,t,i]),{binningData:c,binningError:d,isFetchingBinning:h,refreshBinning:N}},mP=({catalogFlags:e,sourceId:t,hasReachableSource:n,graphContext:s,targetNodeId:i,samplePreset:l})=>{const{isBinnedDistributionNode:c}=e,[u,d]=y.useState(null),[f,h]=y.useState(null),[p,g]=y.useState(!1),[_,N]=y.useState(0),v=y.useCallback(()=>{N(x=>x+1)},[]);return y.useEffect(()=>{let x=!0;if(!c)return d(null),h(null),g(!1),()=>{x=!1};if(!t)return d(null),h("Select a dataset to load binned column distributions."),g(!1),()=>{x=!1};if(!n)return d(null),h("Connect this step to an upstream output to load binned column distributions."),g(!1),()=>{x=!1};g(!0),h(null);const j=$l.find(S=>S.value===l)??$l[0],k=j.value==="all"?"all":Number(j.value);return uy(t,{sampleSize:k,graph:s,targetNodeId:i}).then(S=>{x&&d(S??null)}).catch(S=>{x&&(d(null),h((S==null?void 0:S.message)??"Unable to load binned column distributions"))}).finally(()=>{x&&g(!1)}),()=>{x=!1}},[s,n,c,_,l,t,i]),{binnedDistributionData:u,binnedDistributionError:f,isFetchingBinnedDistribution:p,refreshBinnedDistribution:v}},hP=({catalogFlags:e,sourceId:t,graphContext:n,targetNodeId:s,transformations:i})=>{const{isSkewnessNode:l,isSkewnessDistributionNode:c}=e,u=l||c,[d,f]=y.useState(null),[h,p]=y.useState(null),[g,_]=y.useState(!1),[N,v]=y.useState(0),x=y.useRef(null),j=y.useCallback(()=>{v(k=>k+1)},[]);return y.useEffect(()=>{let k=!0;return u?t?(x.current&&clearTimeout(x.current),x.current=setTimeout(()=>{if(!k)return;_(!0),p(null);let S;i.length>0&&(S=i.map(C=>({column:C.column,method:C.method}))),iy(t,{transformations:S,graph:n,targetNodeId:s}).then(C=>{k&&f(C??null)}).catch(C=>{k&&(f(null),p((C==null?void 0:C.message)??"Unable to load skewness insights"))}).finally(()=>{k&&_(!1)})},300),()=>{k=!1,x.current&&clearTimeout(x.current)}):(f(null),p("Select a dataset to load skewness insights."),_(!1),x.current&&(clearTimeout(x.current),x.current=null),()=>{k=!1}):(f(null),p(null),_(!1),x.current&&(clearTimeout(x.current),x.current=null),()=>{k=!1})},[n,N,u,t,s,i]),{skewnessData:d,skewnessError:h,isFetchingSkewness:g,refreshSkewness:j}},fP="_was_missing",pP=(e,t)=>{const n=typeof e=="string"?e.trim():"";if(n)return n;const s=typeof t=="string"?t.trim():"";return s||fP},gP=(e,t)=>{const n=typeof e=="string"?e.trim():"",s=typeof t=="string"?t:"";return!n||!s?!1:n.endsWith(s)},_P=({selectedColumns:e,availableColumns:t,columnMissingMap:n,suffix:s})=>{const i=typeof s=="string"?s:"",l=We(t),c=new Set(l),u=Array.from(new Set(We(e))),d=[];if(u.forEach(p=>{const g=`${p}${i}`,_=n[p],N=typeof _=="number"&&Number.isFinite(_)?Math.max(0,_):null;d.push({column:p,missingPercentage:N,flagColumn:g,conflicts:{alreadyExists:c.has(g),duplicateFlag:!1}})}),d.length>0){const p=new Map;d.forEach(g=>{p.set(g.flagColumn,(p.get(g.flagColumn)??0)+1)}),d.forEach(g=>{g.conflicts.duplicateFlag=(p.get(g.flagColumn)??0)>1})}d.sort((p,g)=>{const _=p.missingPercentage,N=g.missingPercentage,v=typeof _=="number",x=typeof N=="number";return v&&x&&_!==N?N-_:v!==x?v?-1:1:p.column.localeCompare(g.column)});const f=i?Array.from(new Set(l.filter(p=>gP(p,i)))):[],h=d.reduce((p,g)=>g.conflicts.alreadyExists||g.conflicts.duplicateFlag?p+1:p,0);return{rows:d,flaggedColumnsInDataset:f,conflictCount:h}},vP=({catalogFlags:e,configState:t,node:n,availableColumns:s,columnMissingMap:i})=>{var f,h;const{isMissingIndicatorNode:l}=e,c=y.useMemo(()=>{var p,g;return l?pP(t==null?void 0:t.flag_suffix,(g=(p=n==null?void 0:n.data)==null?void 0:p.config)==null?void 0:g.flag_suffix):""},[t==null?void 0:t.flag_suffix,l,(h=(f=n==null?void 0:n.data)==null?void 0:f.config)==null?void 0:h.flag_suffix]),u=y.useMemo(()=>l?We(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,l]),d=y.useMemo(()=>l?_P({selectedColumns:u,availableColumns:s,columnMissingMap:i,suffix:c}):{rows:[],flaggedColumnsInDataset:[],conflictCount:0},[c,s,i,l,u]);return{activeFlagSuffix:c,missingIndicatorColumns:u,missingIndicatorInsights:d}},Nx={enabled:!1,explicit:!1},yP={selectedColumns:[],nonTextSelected:[],autoDetectionActive:!1,recommendedColumns:[],textColumnCount:0,textColumns:[]},bP={totalPairs:0,previewPairs:[],previewOverflow:0,duplicates:[],duplicateOverflow:0,invalidEntries:[],invalidOverflow:0},xP={},wP=[],NP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isReplaceAliasesNode:c}=e,u=y.useMemo(()=>{if(!c)return Nx;const x=Ei(t);if(x!==void 0)return{enabled:!!No(x),explicit:!0};if(n&&typeof n=="object"){const j=Ei(n);if(j!==void 0)return{enabled:!!No(j),explicit:!0}}return Nx},[t,c,n]),d=y.useMemo(()=>{if(!c)return[];const x=We((t==null?void 0:t.columns)??(n==null?void 0:n.columns)),j=ju(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),k=(()=>{const C=Ei(t);if(C!==void 0){const w=No(C);if(w!==null)return w}if(n&&typeof n=="object"){const w=Ei(n);if(w!==void 0){const E=No(w);if(E!==null)return E}}return x.length===0})(),S=(t==null?void 0:t.alias_strategies)??(t==null?void 0:t.strategies)??(n==null?void 0:n.alias_strategies)??(n==null?void 0:n.strategies);return Fy(S,{mode:j,columns:x,autoDetect:k})},[t,c,n]),f=y.useMemo(()=>c?d.length?Array.from(new Set(d.flatMap(x=>x.columns.map(j=>j.trim()).filter(Boolean)))).sort((x,j)=>x.localeCompare(j)):We(t==null?void 0:t.columns):[],[d,t==null?void 0:t.columns,c]),h=y.useMemo(()=>c?d.length?d.some(x=>x.autoDetect):u.explicit?u.enabled:f.length===0:!1,[u.enabled,u.explicit,f.length,d,c]),p=y.useMemo(()=>{if(c)return t==null?void 0:t.custom_pairs},[t==null?void 0:t.custom_pairs,c]),g=y.useMemo(()=>c?HM(l):xP,[c,l]),_=y.useMemo(()=>c?DM({selectedColumns:f,availableColumns:s,columnTypeMap:i,autoDetectEnabled:h}):yP,[h,f,s,i,c]),N=y.useMemo(()=>c?IM(p):bP,[c,p]),v=y.useMemo(()=>{if(!c)return wP;const x=new Set(_.recommendedColumns),j=new Set(_.textColumns);return s.map(k=>{const S=i[k]??null,C=g[k]??[];return{name:k,dtype:S,samples:C.slice(0,3),isRecommended:x.has(k),isTextLike:j.has(k)}})},[_.recommendedColumns,_.textColumns,g,s,i,c]);return{aliasAutoDetectMeta:u,aliasStrategies:d,aliasStrategyCount:d.length,aliasSelectedColumns:f,aliasAutoDetectEnabled:h,replaceAliasesCustomPairsValue:p,aliasColumnSummary:_,aliasCustomPairSummary:N,aliasSampleMap:g,aliasColumnOptions:v}},jP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isTrimWhitespaceNode:c,isRemoveSpecialCharsNode:u,isRegexCleanupNode:d,isNormalizeTextCaseNode:f}=e,h=y.useMemo(()=>xA(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,c,n==null?void 0:n.mode]),p=y.useMemo(()=>c?We(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,c]),g=y.useMemo(()=>c?kA(l):{},[c,l]),_=y.useMemo(()=>c?jA({selectedColumns:p,availableColumns:s,columnTypeMap:i,sampleMap:g}):AA,[s,i,c,p,g]),N=y.useMemo(()=>wA(h),[h]),v=y.useMemo(()=>UA(u?t==null?void 0:t.mode:void 0,u?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,u,n==null?void 0:n.mode]),x=y.useMemo(()=>u?We(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,u]),j=y.useMemo(()=>u?KA(l):{},[u,l]),k=y.useMemo(()=>u?VA({selectedColumns:x,availableColumns:s,columnTypeMap:i,sampleMap:j}):GA,[s,i,u,x,j]),S=y.useMemo(()=>qA(v),[v]),C=y.useMemo(()=>xO(d?t==null?void 0:t.mode:void 0,d?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,d,n==null?void 0:n.mode]),w=y.useMemo(()=>d?We(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,d]),E=y.useMemo(()=>d?SO(l):{},[d,l]),A=y.useMemo(()=>d?jO({selectedColumns:w,availableColumns:s,columnTypeMap:i,sampleMap:E}):MO,[s,i,d,w,E]),R=y.useMemo(()=>wO(C),[C]),P=y.useMemo(()=>{if(!d)return null;const D=(t==null?void 0:t.replacement)??(n==null?void 0:n.replacement)??null;return typeof D=="string"?D:null},[t==null?void 0:t.replacement,d,n==null?void 0:n.replacement]),T=y.useMemo(()=>aO(f?t==null?void 0:t.mode:void 0,f?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,f,n==null?void 0:n.mode]),O=y.useMemo(()=>f?We(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,f]),F=y.useMemo(()=>f?uO(l):{},[f,l]),B=y.useMemo(()=>f?lO({selectedColumns:O,availableColumns:s,columnTypeMap:i,sampleMap:F,mode:T}):mO,[s,i,f,O,T,F]),L=y.useMemo(()=>oO(T),[T]);return{trimWhitespace:{columnSummary:_,sampleMap:g,modeDetails:N},removeSpecial:{columnSummary:k,sampleMap:j,modeDetails:S,selectedMode:v},regexCleanup:{columnSummary:A,sampleMap:E,modeDetails:R,selectedMode:C,replacementValue:P},normalizeCase:{columnSummary:B,sampleMap:F,modeDetails:L,selectedMode:T}}},CP={},SP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isReplaceInvalidValuesNode:c}=e,u=y.useMemo(()=>IO(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,c,n==null?void 0:n.mode]),d=y.useMemo(()=>c?We(t==null?void 0:t.columns):[],[t==null?void 0:t.columns,c]),f=y.useMemo(()=>{if(!c)return null;const N=(t==null?void 0:t.min_value)??(n==null?void 0:n.min_value),v=Number(N);return Number.isFinite(v)?v:null},[t==null?void 0:t.min_value,c,n==null?void 0:n.min_value]),h=y.useMemo(()=>{if(!c)return null;const N=(t==null?void 0:t.max_value)??(n==null?void 0:n.max_value),v=Number(N);return Number.isFinite(v)?v:null},[t==null?void 0:t.max_value,c,n==null?void 0:n.max_value]),p=y.useMemo(()=>c?VO(l):CP,[c,l]),g=y.useMemo(()=>c?qO({selectedColumns:d,availableColumns:s,columnTypeMap:i,sampleMap:p}):ZO,[s,i,c,p,d]),_=y.useMemo(()=>BO(u),[u]);return{selectedColumns:d,selectedMode:u,modeDetails:_,sampleMap:p,columnSummary:g,minValue:f,maxValue:h}},EP={},kP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isStandardizeDatesNode:c}=e,u=y.useMemo(()=>Qy(c?t==null?void 0:t.mode:void 0,c?n==null?void 0:n.mode:void 0),[t==null?void 0:t.mode,c,n==null?void 0:n.mode]),d=y.useMemo(()=>c?We((t==null?void 0:t.columns)??(n==null?void 0:n.columns)):[],[t==null?void 0:t.columns,c,n==null?void 0:n.columns]),f=y.useMemo(()=>{if(!c)return[];const v={columns:d,mode:u,autoDetect:d.length===0};return Xy((t==null?void 0:t.format_strategies)??(n==null?void 0:n.format_strategies),v)},[t==null?void 0:t.format_strategies,c,d,n==null?void 0:n.format_strategies,u]),h=y.useMemo(()=>{if(!c)return[];const v=new Set;return f.forEach(x=>{x.columns.forEach(j=>{const k=j.trim();k&&v.add(k)})}),Array.from(v).sort((x,j)=>x.localeCompare(j))},[c,f]),p=y.useMemo(()=>f.some(v=>v.autoDetect),[f]),g=y.useMemo(()=>c?dA(l):EP,[c,l]),_=y.useMemo(()=>{if(!c)return mA;const v=aA({selectedColumns:h,availableColumns:s,columnTypeMap:i,sampleMap:g});return p?{...v,autoDetectionActive:!0}:v},[s,i,p,c,g,h]),N=y.useMemo(()=>{if(!c)return[];const v=new Set(_.recommendedColumns),x=new Set(_.sampleCandidates);return s.map(j=>{const k=i[j]??null,S=g[j]??[];return{name:j,dtype:k,samples:S.slice(0,3),isRecommended:v.has(j),isSampleCandidate:x.has(j)}})},[s,_,i,c,g]);return{selectedMode:u,strategies:f,sampleMap:g,columnSummary:_,columnOptions:N}},MP=({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l})=>{const{isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isRegexCleanupNode:f,isNormalizeTextCaseNode:h,isReplaceInvalidValuesNode:p,isStandardizeDatesNode:g}=e,{aliasAutoDetectMeta:_,aliasStrategies:N,aliasStrategyCount:v,aliasSelectedColumns:x,aliasAutoDetectEnabled:j,replaceAliasesCustomPairsValue:k,aliasColumnSummary:S,aliasCustomPairSummary:C,aliasSampleMap:w,aliasColumnOptions:E}=NP({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l}),{trimWhitespace:A,removeSpecial:R,regexCleanup:P,normalizeCase:T}=jP({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l}),{selectedMode:O,modeDetails:F,sampleMap:B,columnSummary:L,minValue:D,maxValue:q}=SP({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l}),{selectedMode:Y,strategies:W,sampleMap:X,columnSummary:I,columnOptions:z}=kP({catalogFlags:e,configState:t,nodeConfig:n,availableColumns:s,columnTypeMap:i,previewSampleRows:l});return{alias:{autoDetectMeta:_,strategies:N,strategyCount:v,selectedColumns:x,autoDetectEnabled:j,customPairsValue:k,columnSummary:S,customPairSummary:C,sampleMap:w,columnOptions:E},trimWhitespace:A,removeSpecial:R,regexCleanup:P,normalizeCase:T,replaceInvalid:{mode:O,modeDetails:F,sampleMap:B,columnSummary:L,minValue:D,maxValue:q},standardizeDates:{mode:Y,strategies:W,sampleMap:X,columnSummary:I,columnOptions:z}}},AP=["int","float","double","decimal","number","numeric","long","short"],OP=["datetime","date","time","timestamp"],TP=["object","string","text","category","categorical","char"],$P=({catalogFlags:e,availableColumns:t,columnTypeMap:n,previewSampleRows:s})=>{const{isBinningNode:i,isScalingNode:l,isOutlierNode:c}=e,u=i||l||c,d=y.useMemo(()=>{if(!u)return{excluded:new Set,reasons:new Map};const f=new Set,h=new Map;return t.forEach(p=>{const g=(n[p]??"").toLowerCase(),_=AP.some(w=>g.includes(w)),N=OP.some(w=>g.includes(w)),v=TP.some(w=>g.includes(w));if(g.includes("bool")){f.add(p),h.set(p,"Boolean dtype");return}if((N||v)&&!_){f.add(p),h.set(p,"Non-numeric dtype");return}const x=s.map(w=>w&&Object.prototype.hasOwnProperty.call(w,p)?w[p]:void 0).filter(w=>w!=null);if(!x.length){_||(f.add(p),h.set(p,"No numeric samples"));return}let j=!0,k=!1,S=!1;const C=new Set;for(const w of x){if(typeof w=="boolean"){C.add(w?"1":"0");continue}if(typeof w=="number"){if(!Number.isFinite(w)){j=!1;break}k=!0,Math.abs(w)<1e-9?C.add("0"):Math.abs(w-1)<1e-9?C.add("1"):S=!0;continue}if(typeof w=="string"){const E=w.trim();if(!E)continue;const A=E.toLowerCase();if(Jb.has(A)){C.add("1");continue}if(Zb.has(A)){C.add("0");continue}const R=Number(E);if(!Number.isNaN(R)&&Number.isFinite(R)){k=!0,Math.abs(R)<1e-9?C.add("0"):Math.abs(R-1)<1e-9?C.add("1"):S=!0;continue}j=!1;break}j=!1;break}if(!j||!k&&!_){f.add(p),h.set(p,"Non-numeric values");return}!S&&C.size>0&&Array.from(C).every(E=>E==="0"||E==="1")&&(f.add(p),h.set(p,"Binary/bool-like values"))}),{excluded:f,reasons:h}},[t,n,s,u]);return{numericExcludedColumns:d.excluded,numericExclusionReasons:d.reasons}},Fs=["standard","robust","minmax","maxabs"],ko={standard:"Standard scaler",robust:"Robust scaler",minmax:"MinMax scaler",maxabs:"MaxAbs scaler"},jx={high:"High confidence",medium:"Moderate confidence",low:"Exploratory"},Cx=e=>Array.isArray(e)?Array.from(new Set(e.map(t=>String(t??"").trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):typeof e=="string"?Array.from(new Set(e.split(",").map(t=>t.trim()).filter(Boolean))).sort((t,n)=>t.localeCompare(n)):[],Sx=e=>{const t=e&&typeof e=="object"&&!Array.isArray(e)?e:{},n=Cx(t.columns),s=typeof t.default_method=="string"?t.default_method.trim().toLowerCase():"",i=Fs.includes(s)?s:"standard",l={},c=t.column_methods;c&&typeof c=="object"&&!Array.isArray(c)&&Object.entries(c).forEach(([f,h])=>{const p=String(f??"").trim(),g=typeof h=="string"?h.trim().toLowerCase():"";p&&Fs.includes(g)&&(l[p]=g)});const u=typeof t.auto_detect=="boolean"?t.auto_detect:!0,d=Cx(t.skipped_columns);return{columns:n,defaultMethod:i,columnMethods:l,autoDetect:u,skippedColumns:d}},PP=e=>{const t={...ko};return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null,i=typeof(n==null?void 0:n.label)=="string"?n.label.trim():"";s&&Fs.includes(s)&&i&&(t[s]=i)}),t},RP=e=>{const t=new Map;return Array.isArray(e)&&e.forEach(n=>{const s=typeof(n==null?void 0:n.key)=="string"?n.key.trim().toLowerCase():null;s&&Fs.includes(s)&&t.set(s,n)}),t},LP=e=>Fs.map(t=>({value:t,label:e[t]??ko[t]??t})),zP=({recommendations:e,scalingConfig:t,scalingMethodLabelMap:n,scalingSelectedSet:s,scalingSkippedColumns:i,scalingExcludedColumns:l})=>{if(!e.length)return[];const c=[];return e.forEach(u=>{const d=String((u==null?void 0:u.column)??"").trim();if(!d)return;const f=u.recommended_method,h=n[f]??ko[f]??f,p=Array.isArray(u.fallback_methods)?u.fallback_methods.filter(E=>Fs.includes(E)).map(E=>{const A=E;return n[A]??ko[A]??A}):[],g=u.confidence??"medium",_=jx[g]??jx.medium,v=t.columnMethods[d]??null,x=v??t.defaultMethod,j=n[x]??ko[x]??x,k=l.has(d),S=i.has(d),C=s.has(d),w=u.stats;c.push({column:d,dtype:u.dtype??null,recommendedMethod:f,recommendedLabel:h,confidence:g,confidenceLabel:_,reasons:Array.isArray(u.reasons)?u.reasons:[],fallbackLabels:p,stats:w,hasMissing:!!u.has_missing,currentOverride:v,currentMethod:x,currentMethodLabel:j,isOverrideApplied:v!==null,isSelected:C,isExcluded:k,isSkipped:S})}),c.sort((u,d)=>u.column.localeCompare(d.column)),c},DP=(e,t,n,s)=>{if(!e.length)return null;const i=e.map(l=>{const c=t[l],u=c?n[c]??ko[c]??c:null;return u?`${l} -> ${u}`:l});return s>e.length&&i.push(""),i.join(", ")},FP=({catalogFlags:e,configState:t,numericExcludedColumns:n,scalingData:s})=>{const{isScalingNode:i}=e,l=y.useMemo(()=>Sx(t),[t]),c=y.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),u=y.useMemo(()=>i?n:new Set,[i,n]),d=y.useMemo(()=>i?new Set(l.columns):new Set,[i,l.columns]),f=y.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),h=y.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(B=>!!(B&&B.column)):[],[s==null?void 0:s.columns]),p=y.useMemo(()=>PP(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=y.useMemo(()=>RP(s==null?void 0:s.methods),[s==null?void 0:s.methods]),_=y.useMemo(()=>zP({recommendations:h,scalingConfig:l,scalingMethodLabelMap:p,scalingSelectedSet:d,scalingSkippedColumns:c,scalingExcludedColumns:u}),[h,l,p,d,c,u]),N=y.useMemo(()=>Array.from(f).sort((B,L)=>B.localeCompare(L)),[f]),v=y.useMemo(()=>N.slice(0,4),[N]),x=_.length,j=f.size,k=d.size,S=l.autoDetect,C=y.useMemo(()=>g.get(l.defaultMethod)??null,[l.defaultMethod,g]),w=y.useMemo(()=>{const B=l.defaultMethod;return p[B]??ko[B]??B},[l.defaultMethod,p]),E=x>0,A=y.useMemo(()=>_.filter(B=>!B.isSkipped&&!B.isExcluded&&B.isSelected&&B.recommendedMethod!==B.currentMethod).length,[_]),R=y.useMemo(()=>_.filter(B=>B.isSelected&&!B.isSkipped&&!B.isExcluded).length,[_]),P=y.useMemo(()=>_.filter(B=>B.isSkipped&&!B.isExcluded).length,[_]),T=y.useMemo(()=>_.length?A>0?`${A} column${A===1?"":"s"} need attention. Apply the recommended scalers or override them manually below.`:R>0?"All configured columns align with the recommended scalers.":P>0?"All recommendations are currently skipped.":"Review the recommendations below.":"No scaling recommendations yetselect numeric columns to evaluate.",[A,R,_,P]),O=y.useMemo(()=>LP(p),[p]),F=y.useMemo(()=>DP(v,l.columnMethods,p,j),[v,l.columnMethods,p,j]);return{scalingConfig:l,scalingExcludedColumns:u,scalingMethodDetailMap:g,scalingMethodOptions:O,scalingRecommendations:h,scalingRecommendationRows:_,scalingSelectedCount:k,scalingOverrideCount:j,scalingDefaultDetail:C,scalingDefaultLabel:w,scalingAutoDetectEnabled:S,scalingHasRecommendations:E,scalingStatusMessage:T,scalingOverrideExampleSummary:F}},IP=({catalogFlags:e,configState:t,numericExcludedColumns:n,outlierData:s})=>{const{isOutlierNode:i}=e,l=y.useMemo(()=>d$(t),[t]),c=y.useMemo(()=>Array.isArray(s==null?void 0:s.columns)?s.columns.filter(B=>!!(B&&B.column)):[],[s==null?void 0:s.columns]),u=y.useMemo(()=>new Set(l.skippedColumns),[l.skippedColumns]),d=y.useMemo(()=>i?new Set(l.columns):new Set,[i,l.columns]),f=y.useMemo(()=>{if(!i||!n.size)return new Set;const B=new Set;l.columns.forEach(D=>{const q=String(D??"").trim();q&&B.add(q)}),c.forEach(D=>{const q=String((D==null?void 0:D.column)??"").trim();q&&B.add(q)});const L=new Set;return n.forEach(D=>{B.has(D)||L.add(D)}),L},[i,n,l.columns,c]),h=y.useMemo(()=>new Set(Object.keys(l.columnMethods)),[l.columnMethods]),p=y.useMemo(()=>m$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),g=y.useMemo(()=>h$(s==null?void 0:s.methods),[s==null?void 0:s.methods]),_=y.useMemo(()=>p$({insights:c,outlierConfig:l,labelMap:p,selectedColumns:d,skippedColumns:u,excludedColumns:f}),[c,l,p,d,u,f]),N=y.useMemo(()=>f$(p),[p]),v=y.useMemo(()=>Array.from(h).sort((B,L)=>B.localeCompare(L)),[h]),x=y.useMemo(()=>v.slice(0,4),[v]),j=d.size,k=h.size,S=y.useMemo(()=>Object.keys(l.columnParameters).length,[l.columnParameters]),C=l.autoDetect,w=y.useMemo(()=>g.get(l.defaultMethod)??null,[l.defaultMethod,g]),E=y.useMemo(()=>{const B=l.defaultMethod;return p[B]??Eo[B]??B},[l.defaultMethod,p]),A=_.length>0,R=y.useMemo(()=>_.filter(B=>B.isSkipped||B.isExcluded||!B.isSelected||!B.recommendedMethod?!1:B.recommendedMethod!==B.currentMethod).length,[_]),P=y.useMemo(()=>_.filter(B=>B.isSelected&&!B.isSkipped&&!B.isExcluded).length,[_]),T=y.useMemo(()=>_.filter(B=>B.isSkipped&&!B.isExcluded).length,[_]),O=y.useMemo(()=>_.length?R>0?`${R} column${R===1?"":"s"} need attention. Apply the recommended strategies or adjust manually below.`:P>0?"All configured columns align with the recommended outlier handling strategies.":T>0?"All outlier recommendations are currently skipped.":"Review the outlier diagnostics below.":"No outlier recommendations yetselect numeric columns to evaluate.",[R,P,_,T]),F=y.useMemo(()=>g$(x,l.columnMethods,p,k),[x,l.columnMethods,p,k]);return{outlierConfig:l,outlierExcludedColumns:f,outlierMethodLabelMap:p,outlierMethodDetailMap:g,outlierMethodOptions:N,outlierRecommendations:c,outlierRecommendationRows:_,outlierSelectedCount:j,outlierOverrideCount:k,outlierParameterOverrideCount:S,outlierDefaultDetail:w,outlierDefaultLabel:E,outlierAutoDetectEnabled:C,outlierHasRecommendations:A,outlierStatusMessage:O,outlierOverrideExampleSummary:F}},BP=({configState:e,nodeId:t})=>{const n=y.useMemo(()=>ky(e),[e]),s=n.columns.length,i=xh[n.strategy]??n.strategy,l=y.useMemo(()=>Object.keys(n.columnStrategies).map(N=>N.trim()).filter(Boolean).sort((N,v)=>N.localeCompare(v)),[n.columnStrategies]),c=l.length,u=y.useMemo(()=>{if(!l.length)return null;const N=l.slice(0,4);return eM(N,n.columnStrategies,c)},[n.columnStrategies,l,c]),d=y.useMemo(()=>`binning-${t||"node"}`,[t]),f=y.useMemo(()=>({equalWidth:`${d}-equal-width-bins`,equalFrequency:`${d}-equal-frequency-bins`,precision:`${d}-precision`,suffix:`${d}-suffix`,missingLabel:`${d}-missing-label`,includeLowest:`${d}-include-lowest`,dropOriginal:`${d}-drop-original`,labelFormat:`${d}-label-format`,duplicates:`${d}-duplicates`,kbinsNBins:`${d}-kbins-n-bins`,kbinsEncode:`${d}-kbins-encode`,kbinsStrategy:`${d}-kbins-strategy`}),[d]),[h,p]=y.useState({}),[g,_]=y.useState({});return y.useEffect(()=>{p(N=>{const v=new Set,x={...N};return n.columns.forEach(j=>{const k=String(j??"").trim();if(!k||(v.add(k),Object.prototype.hasOwnProperty.call(x,k)))return;const S=n.customBins[k]??[];x[k]=S.length>=2?S.join(", "):""}),Object.keys(x).forEach(j=>{v.has(j)||delete x[j]}),x})},[n.columns,n.customBins]),y.useEffect(()=>{_(N=>{const v=new Set,x={...N};return n.columns.forEach(j=>{const k=String(j??"").trim();if(!k||(v.add(k),Object.prototype.hasOwnProperty.call(x,k)))return;const S=n.customLabels[k]??[];x[k]=S.length>0?S.join(", "):""}),Object.keys(x).forEach(j=>{v.has(j)||delete x[j]}),x})},[n.columns,n.customLabels]),{binningConfig:n,binningSelectedCount:s,binningDefaultLabel:i,binningOverrideColumns:l,binningOverrideCount:c,binningOverrideSummary:u,fieldIds:f,customEdgeDrafts:h,setCustomEdgeDrafts:p,customLabelDrafts:g,setCustomLabelDrafts:_}},UP=({setConfigState:e,setBinningCustomEdgeDrafts:t,setBinningCustomLabelDrafts:n,binningConfig:s,binningInsightsRecommendations:i,binningAllNumericColumns:l})=>{const c=y.useCallback((P,T,O,F)=>{e(B=>{const L=typeof(B==null?void 0:B[P])=="number"&&Number.isFinite(B[P])?B[P]:void 0;if(T===""){if(L===void 0)return B;const Y={...B};return delete Y[P],Y}const D=Number(T);if(!Number.isFinite(D))return B;const q=Math.min(Math.max(Math.round(D),O),F);return L===q?B:{...B,[P]:q}})},[e]),u=y.useCallback((P,T)=>{e(O=>!!(O!=null&&O[P])===T?O:{...O,[P]:T})},[e]),d=y.useCallback(P=>{const T=P.trim();e(O=>{const F=typeof(O==null?void 0:O.output_suffix)=="string"?O.output_suffix:"";if(!T){if(!F)return O;const B={...O};return delete B.output_suffix,B}return F===T?O:{...O,output_suffix:T}})},[e]),f=y.useCallback(P=>{e(T=>{const O=typeof(T==null?void 0:T.label_format)=="string"?T.label_format:"";return(["range","bin_index","ordinal","column_suffix"].includes(O)?O:"range")===P?T:{...T,label_format:P}})},[e]),h=y.useCallback(P=>{e(T=>{if(((T==null?void 0:T.missing_strategy)==="label"?"label":"keep")===P)return T;const F={...T,missing_strategy:P};return P!=="label"&&Object.prototype.hasOwnProperty.call(F,"missing_label")&&delete F.missing_label,F})},[e]),p=y.useCallback(P=>{const T=P.trim();e(O=>{const F=typeof(O==null?void 0:O.missing_label)=="string"?O.missing_label:"";if(!T){if(!F)return O;const B={...O};return delete B.missing_label,B}return F===T?O:{...O,missing_label:T}})},[e]),g=y.useCallback((P,T)=>{const O=String(P??"").trim();O&&(t(F=>({...F,[O]:T})),e(F=>{const B=F==null?void 0:F.custom_bins,L=B&&typeof B=="object"&&!Array.isArray(B)?B:{},D=Array.isArray(L[O])?L[O]:void 0,Y=T.split(/[,\n]/).map(z=>z.trim()).filter(Boolean).map(z=>Number(z)).filter(z=>Number.isFinite(z)).sort((z,H)=>z-H).filter((z,H,te)=>H===0||z!==te[H-1]),W=Y.length>=2;if(W&&D&&D.length===Y.length&&D.every((z,H)=>z===Y[H])||!W&&!D)return F;const X={...F},I={...L};return W?I[O]=Y:delete I[O],Object.keys(I).length>0?X.custom_bins=I:delete X.custom_bins,X}))},[t,e]),_=y.useCallback((P,T)=>{const O=String(P??"").trim();O&&(n(F=>({...F,[O]:T})),e(F=>{const B=F==null?void 0:F.custom_labels,L=B&&typeof B=="object"&&!Array.isArray(B)?B:{},D=Array.isArray(L[O])?L[O]:void 0,q=T.split(/[,\n]/).map(X=>X.trim()).filter(Boolean);if(q.length>0&&D&&D.length===q.length&&D.every((X,I)=>X===q[I])||q.length===0&&!D)return F;const Y={...F},W={...L};return q.length>0?W[O]=q:delete W[O],Object.keys(W).length>0?Y.custom_labels=W:delete Y.custom_labels,Y}))},[n,e]),N=y.useCallback(P=>{const T=String(P??"").trim();T&&(t(O=>{if(!Object.prototype.hasOwnProperty.call(O,T))return O;const F={...O};return delete F[T],F}),n(O=>{if(!Object.prototype.hasOwnProperty.call(O,T))return O;const F={...O};return delete F[T],F}),e(O=>{let F=!1;const B={...O};if(O!=null&&O.custom_bins&&typeof O.custom_bins=="object"&&!Array.isArray(O.custom_bins)&&Object.prototype.hasOwnProperty.call(O.custom_bins,T)){const L={...O.custom_bins};delete L[T],Object.keys(L).length>0?B.custom_bins=L:delete B.custom_bins,F=!0}if(O!=null&&O.custom_labels&&typeof O.custom_labels=="object"&&!Array.isArray(O.custom_labels)&&Object.prototype.hasOwnProperty.call(O.custom_labels,T)){const L={...O.custom_labels};delete L[T],Object.keys(L).length>0?B.custom_labels=L:delete B.custom_labels,F=!0}return F?B:O}))},[t,n,e]),v=y.useCallback((P,T)=>{const O=String(P??"").trim();O&&e(F=>{const L={...F!=null&&F.column_strategies&&typeof F.column_strategies=="object"&&!Array.isArray(F.column_strategies)?F.column_strategies:F!=null&&F.column_overrides&&typeof F.column_overrides=="object"&&!Array.isArray(F.column_overrides)?F.column_overrides:{}},D=L[O],q=D&&typeof D=="object"&&!Array.isArray(D)?{...D}:{},Y=T(q),W=!!(Y&&Object.keys(Y).length);W?L[O]=Y:delete L[O];const X={...F};if(W){const I=new Set(We(F==null?void 0:F.columns));I.has(O)||(I.add(O),X.columns=Array.from(I).sort((z,H)=>z.localeCompare(H)))}return Object.keys(L).length?(X.column_overrides=L,X.column_strategies=L):(Object.prototype.hasOwnProperty.call(X,"column_overrides")&&delete X.column_overrides,Object.prototype.hasOwnProperty.call(X,"column_strategies")&&delete X.column_strategies),X})},[e]),x=y.useCallback((P,T,O)=>{const F=String(P??"").trim();if(!F)return;if(T==="__default__"){N(F),v(F,()=>null);return}const B=Number.isFinite(O==null?void 0:O.recommendedBins)?Math.round(O.recommendedBins):null;v(F,L=>{const D={...L};D.strategy=T;const q=Y=>Math.min(200,Math.max(2,Math.round(B??Y)));return T==="equal_width"?(D.equal_width_bins=q(s.equalWidthBins),delete D.equal_frequency_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy):T==="equal_frequency"?(D.equal_frequency_bins=q(s.equalFrequencyBins),delete D.equal_width_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy):T==="kbins"?(D.kbins_n_bins=q(s.kbinsNBins),D.kbins_encode=s.kbinsEncode,D.kbins_strategy=s.kbinsStrategy,delete D.equal_width_bins,delete D.equal_frequency_bins):T==="custom"&&(delete D.equal_width_bins,delete D.equal_frequency_bins,delete D.kbins_n_bins,delete D.kbins_encode,delete D.kbins_strategy),Object.keys(D).length?D:null}),T!=="custom"&&N(F)},[s.equalFrequencyBins,s.equalWidthBins,s.kbinsEncode,s.kbinsNBins,s.kbinsStrategy,N,v]),j=y.useCallback((P,T,O)=>{const F=String(P??"").trim();F&&(v(F,B=>{const L={...B};if(!O.trim())delete L[T];else{const D=Number(O);if(!Number.isFinite(D))return B;const q=Math.min(200,Math.max(2,Math.round(D)));L[T]=q,T==="equal_width_bins"?(L.strategy="equal_width",delete L.equal_frequency_bins,delete L.kbins_n_bins,delete L.kbins_encode,delete L.kbins_strategy):T==="equal_frequency_bins"?(L.strategy="equal_frequency",delete L.equal_width_bins,delete L.kbins_n_bins,delete L.kbins_encode,delete L.kbins_strategy):T==="kbins_n_bins"&&(L.strategy="kbins",delete L.equal_width_bins,delete L.equal_frequency_bins)}return Object.keys(L).length?L:null}),N(F))},[N,v]),k=y.useCallback((P,T)=>{const O=String(P??"").trim();O&&v(O,F=>{const B={...F};return T?(B.strategy="kbins",B.kbins_encode=T):delete B.kbins_encode,Object.keys(B).length?B:null})},[v]),S=y.useCallback((P,T)=>{const O=String(P??"").trim();O&&v(O,F=>{const B={...F};return T?(B.strategy="kbins",B.kbins_strategy=T):delete B.kbins_strategy,Object.keys(B).length?B:null})},[v]),C=y.useCallback(P=>{const T=String(P??"").trim();T&&(N(T),v(T,()=>null))},[N,v]),w=y.useCallback(()=>{e(P=>{if(!((P==null?void 0:P.column_strategies)&&typeof P.column_strategies=="object"&&!Array.isArray(P.column_strategies)&&Object.keys(P.column_strategies).length>0||(P==null?void 0:P.column_overrides)&&typeof P.column_overrides=="object"&&!Array.isArray(P.column_overrides)&&Object.keys(P.column_overrides).length>0))return P;const O={...P};return Object.prototype.hasOwnProperty.call(O,"column_overrides")&&delete O.column_overrides,Object.prototype.hasOwnProperty.call(O,"column_strategies")&&delete O.column_strategies,O})},[e]),E=y.useCallback(()=>{i.length&&i.forEach(P=>{const T=typeof(P==null?void 0:P.column)=="string"?P.column.trim():"";if(!T)return;const O=P.recommended_strategy??"equal_width";x(T,O,{recommendedBins:Number.isFinite(P==null?void 0:P.recommended_bins)?P.recommended_bins:null})})},[i,x]),A=y.useCallback(P=>{if(!P)return;const T=[];for(const O of P){const F=typeof O=="string"?O.trim():"";F&&T.push(F)}T.length&&e(O=>{const F=O&&typeof O=="object"?O:{},B=new Set(We(F.columns));let L=!1;if(T.forEach(q=>{B.has(q)||(B.add(q),L=!0)}),!L)return O;const D={...F};return D.columns=Array.from(B).sort((q,Y)=>q.localeCompare(Y)),D})},[e]),R=y.useCallback(()=>{l.length&&A(l)},[l,A]);return{handleBinningIntegerChange:c,handleBinningBooleanToggle:u,handleBinningSuffixChange:d,handleBinningLabelFormatChange:f,handleBinningMissingStrategyChange:h,handleBinningMissingLabelChange:p,handleBinningCustomBinsChange:g,handleBinningCustomLabelsChange:_,handleBinningClearCustomColumn:N,updateBinningColumnOverride:v,handleBinningOverrideStrategyChange:x,handleBinningOverrideNumberChange:j,handleBinningOverrideKbinsEncodeChange:k,handleBinningOverrideKbinsStrategyChange:S,handleBinningClearOverride:C,handleBinningClearOverrides:w,handleBinningApplyStrategies:E,handleBinningApplyColumns:A,handleApplyAllBinningNumeric:R}},qP=({setConfigState:e,outlierRecommendationRows:t,outlierExcludedColumns:n,outlierConfig:s})=>{const i=y.useCallback(N=>{Cs.includes(N)&&e(v=>(v==null?void 0:v.default_method)===N?v:{...v,default_method:N})},[e]),l=y.useCallback(N=>{e(v=>(typeof(v==null?void 0:v.auto_detect)=="boolean"?v.auto_detect:!0)===N?v:{...v,auto_detect:N})},[e]),c=y.useCallback((N,v)=>{const x=String(N??"").trim();x&&e(j=>{if(!j||typeof j!="object")return j;const k=We(j.columns),S=new Set(k),C=j.column_methods&&typeof j.column_methods=="object"&&!Array.isArray(j.column_methods)?{...j.column_methods}:{};let w=!1;if(v){if(!Cs.includes(v))return j;C[x]!==v&&(C[x]=v,w=!0),S.has(x)||(S.add(x),w=!0)}else Object.prototype.hasOwnProperty.call(C,x)&&(delete C[x],w=!0);if(!w)return j;const E={...j};return E.columns=Array.from(S).sort((A,R)=>A.localeCompare(R)),Object.keys(C).length?E.column_methods=C:Object.prototype.hasOwnProperty.call(E,"column_methods")&&delete E.column_methods,E})},[e]),u=y.useCallback(()=>{e(N=>{if(!N||typeof N!="object")return N;const v=N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)&&Object.keys(N.column_methods).length>0,x=N.column_parameters&&typeof N.column_parameters=="object"&&!Array.isArray(N.column_parameters)&&Object.keys(N.column_parameters).length>0;if(!v&&!x)return N;const j={...N};return v&&delete j.column_methods,x&&delete j.column_parameters,j})},[e]),d=y.useCallback(()=>{t.length&&e(N=>{if(!N||typeof N!="object")return N;const v=new Set(We(N.columns)),x=new Set(We(N.skipped_columns)),j=N.column_methods&&typeof N.column_methods=="object"&&!Array.isArray(N.column_methods)?{...N.column_methods}:{},k=N.column_parameters&&typeof N.column_parameters=="object"&&!Array.isArray(N.column_parameters)?{...N.column_parameters}:{};let S=!1;if(t.forEach(w=>{if(!w||w.isExcluded||!w.recommendedMethod)return;const E=String(w.column??"").trim();if(!E||n.has(E))return;const A=w.recommendedMethod;Cs.includes(A)&&(x.has(E)&&(x.delete(E),S=!0),v.has(E)||(v.add(E),S=!0),A===s.defaultMethod?Object.prototype.hasOwnProperty.call(j,E)&&(delete j[E],S=!0):j[E]!==A&&(j[E]=A,S=!0),Object.prototype.hasOwnProperty.call(k,E)&&(delete k[E],S=!0))}),!S)return N;const C={...N,columns:Array.from(v).sort((w,E)=>w.localeCompare(E))};return x.size?C.skipped_columns=Array.from(x).sort((w,E)=>w.localeCompare(E)):Object.prototype.hasOwnProperty.call(C,"skipped_columns")&&delete C.skipped_columns,Object.keys(j).length?C.column_methods=j:Object.prototype.hasOwnProperty.call(C,"column_methods")&&delete C.column_methods,Object.keys(k).length?C.column_parameters=k:Object.prototype.hasOwnProperty.call(C,"column_parameters")&&delete C.column_parameters,C})},[s.defaultMethod,n,t,e]),f=y.useCallback(N=>{const v=String(N??"").trim();v&&e(x=>{if(!x||typeof x!="object")return x;const j=We(x.columns),k=j.filter(F=>F!==v),S=new Set(We(x.skipped_columns)),C=S.size;S.add(v);const w=C!==S.size,E=x.column_methods&&typeof x.column_methods=="object"&&!Array.isArray(x.column_methods)?{...x.column_methods}:{},A=Object.prototype.hasOwnProperty.call(E,v);A&&delete E[v];const R=x.column_parameters&&typeof x.column_parameters=="object"&&!Array.isArray(x.column_parameters)?{...x.column_parameters}:{},P=Object.prototype.hasOwnProperty.call(R,v);if(P&&delete R[v],!(k.length!==j.length)&&!w&&!A&&!P)return x;const O={...x,columns:k.sort((F,B)=>F.localeCompare(B)),skipped_columns:Array.from(S).sort((F,B)=>F.localeCompare(B))};return Object.keys(E).length?O.column_methods=E:Object.prototype.hasOwnProperty.call(O,"column_methods")&&delete O.column_methods,Object.keys(R).length?O.column_parameters=R:Object.prototype.hasOwnProperty.call(O,"column_parameters")&&delete O.column_parameters,O})},[e]),h=y.useCallback(N=>{const v=String(N??"").trim();v&&e(x=>{if(!x||typeof x!="object")return x;const j=We(x.skipped_columns);if(!j.includes(v))return x;const k=j.filter(w=>w!==v),S=new Set(We(x.columns));S.has(v)||S.add(v);const C={...x,columns:Array.from(S).sort((w,E)=>w.localeCompare(E))};return k.length?C.skipped_columns=k.sort((w,E)=>w.localeCompare(E)):Object.prototype.hasOwnProperty.call(C,"skipped_columns")&&delete C.skipped_columns,C})},[e]),p=y.useCallback((N,v)=>{if(v==="__skip__"){f(N);return}if(v==="__default__"){h(N),c(N,null);return}Cs.includes(v)&&(h(N),c(N,v))},[f,h,c]),g=y.useCallback((N,v,x)=>{const j=String(v??"").trim().toLowerCase();e(k=>{if(!k||typeof k!="object")return k;const S=k.method_parameters&&typeof k.method_parameters=="object"&&!Array.isArray(k.method_parameters)?{...k.method_parameters}:{},C={...S[N]??{}},w=typeof x=="number"&&Number.isFinite(x)?x:null;let E=!1;if(w===null?Object.prototype.hasOwnProperty.call(C,j)&&(delete C[j],E=!0):C[j]!==w&&(C[j]=w,E=!0),!E)return k;if(Object.keys(C).length?S[N]=C:delete S[N],!Object.keys(S).length){const A={...k};return Object.prototype.hasOwnProperty.call(A,"method_parameters")&&delete A.method_parameters,A}return{...k,method_parameters:S}})},[e]),_=y.useCallback((N,v,x)=>{const j=String(N??"").trim();if(!j)return;const k=String(v??"").trim().toLowerCase();e(S=>{if(!S||typeof S!="object")return S;const C=S.column_parameters&&typeof S.column_parameters=="object"&&!Array.isArray(S.column_parameters)?{...S.column_parameters}:{},w={...C[j]??{}},E=typeof x=="number"&&Number.isFinite(x)?x:null;let A=!1;if(E===null?Object.prototype.hasOwnProperty.call(w,k)&&(delete w[k],A=!0):w[k]!==E&&(w[k]=E,A=!0),!A)return S;if(Object.keys(w).length?C[j]=w:delete C[j],!Object.keys(C).length){const R={...S};return Object.prototype.hasOwnProperty.call(R,"column_parameters")&&delete R.column_parameters,R}return{...S,column_parameters:C}})},[e]);return{handleOutlierDefaultMethodChange:i,handleOutlierAutoDetectToggle:l,setOutlierColumnMethod:c,handleOutlierClearOverrides:u,handleOutlierApplyAllRecommendations:d,handleOutlierSkipColumn:f,handleOutlierUnskipColumn:h,handleOutlierOverrideSelect:p,handleOutlierMethodParameterChange:g,handleOutlierColumnParameterChange:_}},HP=({setConfigState:e,scalingRecommendations:t})=>{const n=y.useCallback(h=>{Fs.includes(h)&&e(p=>(p==null?void 0:p.default_method)===h?p:{...p,default_method:h})},[e]),s=y.useCallback(h=>{e(p=>(typeof(p==null?void 0:p.auto_detect)=="boolean"?p.auto_detect:!0)===h?p:{...p,auto_detect:h})},[e]),i=y.useCallback((h,p)=>{const g=String(h??"").trim();g&&e(_=>{const N=We(_.columns),v=N.includes(g),x=_.column_methods&&typeof _.column_methods=="object"&&!Array.isArray(_.column_methods)?{..._.column_methods}:{};if(p){if(!Fs.includes(p))return _;const S=(x[g]??null)!==p,C=!v;if(!S&&!C)return _;x[g]=p;const w=C?[...N,g].sort((E,A)=>E.localeCompare(A)):N;return{..._,columns:w,column_methods:x}}if(!Object.prototype.hasOwnProperty.call(x,g))return _;if(delete x[g],Object.keys(x).length)return{..._,column_methods:x};const j={..._};return Object.prototype.hasOwnProperty.call(j,"column_methods")&&delete j.column_methods,j})},[e]),l=y.useCallback(()=>{e(h=>{if(!h.column_methods||typeof h.column_methods!="object"||Array.isArray(h.column_methods)||!Object.keys(h.column_methods).length)return h;const p={...h};return delete p.column_methods,p})},[e]),c=y.useCallback(()=>{t.length&&e(h=>{const p=We(h.columns),g=new Set(p),_=new Set(We(h.skipped_columns)),N=h.column_methods&&typeof h.column_methods=="object"&&!Array.isArray(h.column_methods)?{...h.column_methods}:{};let v=!1;if(t.forEach(j=>{const k=String(j.column??"").trim(),S=j.recommended_method;!k||!Fs.includes(S)||_.has(k)||(N[k]!==S&&(N[k]=S,v=!0),g.has(k)||(g.add(k),v=!0))}),!v)return h;const x=Array.from(g).sort((j,k)=>j.localeCompare(k));return{...h,columns:x,column_methods:N}})},[t,e]),u=y.useCallback(h=>{const p=String(h??"").trim();p&&e(g=>{const _=We(g.columns),N=_.filter(C=>C!==p),v=new Set(We(g.skipped_columns)),x=v.size;v.add(p);const j=v.size!==x,k=g.column_methods&&typeof g.column_methods=="object"&&!Array.isArray(g.column_methods)?{...g.column_methods}:{},S=Object.prototype.hasOwnProperty.call(k,p);return S&&delete k[p],!j&&N.length===_.length&&!S?g:{...g,columns:N.sort((C,w)=>C.localeCompare(w)),column_methods:k,skipped_columns:Array.from(v).sort((C,w)=>C.localeCompare(w))}})},[e]),d=y.useCallback(h=>{const p=String(h??"").trim();p&&e(g=>{const _=We(g.skipped_columns);if(!_.includes(p))return g;const N=new Set(_);N.delete(p);const v=new Set(We(g.columns));return v.has(p)||v.add(p),{...g,columns:Array.from(v).sort((j,k)=>j.localeCompare(k)),skipped_columns:Array.from(N).sort((j,k)=>j.localeCompare(k))}})},[e]),f=y.useCallback((h,p)=>{if(p==="__skip__"){u(h);return}if(p==="__default__"){d(h),i(h,null);return}Fs.includes(p)&&(d(h),i(h,p))},[u,d,i]);return{handleScalingDefaultMethodChange:n,handleScalingAutoDetectToggle:s,setScalingColumnMethod:i,handleScalingClearOverrides:l,handleScalingApplyAllRecommendations:c,handleScalingSkipColumn:u,handleScalingUnskipColumn:d,handleScalingOverrideSelect:f}},VP=e=>{if(typeof e=="number"&&Number.isFinite(e))return e;if(typeof e=="string"){const t=Number(e);if(Number.isFinite(t))return t}return null},WP=({catalogFlags:e,numericExcludedColumns:t,selectedColumns:n,previewSampleRows:s,availableColumns:i,recommendedColumns:l})=>{const{isBinningNode:c}=e,u=y.useMemo(()=>{if(!l)return null;const p=new Set;for(const g of l){const _=typeof g=="string"?g.trim():"";_&&p.add(_)}return p.size>0?p:null},[l]),d=y.useMemo(()=>{if(!Array.isArray(n)||!n.length)return null;const p=new Set;return n.forEach(g=>{const _=typeof g=="string"?g.trim():"";_&&p.add(_)}),p.size>0?p:null},[n]),f=y.useMemo(()=>{if(!c)return new Set;if(!t.size||!u&&!d)return t;const p=new Set;return t.forEach(g=>{u!=null&&u.has(g)||d!=null&&d.has(g)||p.add(g)}),p},[c,t,u,d]),h=y.useMemo(()=>{if(!c||!s.length)return{};const p={};return i.forEach(g=>{if(f.has(g))return;let _=null,N=null;const v=new Set;if(s.forEach(x=>{if(!x||!Object.prototype.hasOwnProperty.call(x,g))return;const j=VP(x[g]);j!==null&&((_===null||j<_)&&(_=j),(N===null||j>N)&&(N=j),v.size<=1e3&&v.add(j))}),_!==null||N!==null){const x=v.size>0?v.size:null;p[g]={min:_,max:N,distinct:x}}}),p},[i,f,c,s]);return{binningExcludedColumns:f,binningColumnPreviewMap:h,manualBoundColumns:[],manualRangeFallbackMap:{}}},KP=({catalogFlags:e,scalingExcludedColumns:t,binningExcludedColumns:n,outlierExcludedColumns:s,setConfigState:i})=>{const{isScalingNode:l,isBinningNode:c,isOutlierNode:u}=e;y.useEffect(()=>{!l||t.size===0||i(d=>{if(!d||typeof d!="object")return d;const f=We(d.columns);if(!f.length)return d;const h=f.filter(g=>!t.has(g));if(h.length===f.length||!h.length)return d;const p={...d,columns:h};if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const g={};let _=!1;Object.entries(d.column_methods).forEach(([N,v])=>{const x=String(N??"").trim();if(!x)return;if(t.has(x)){_=!0;return}const j=typeof v=="string"?v.trim():null;j&&Fs.includes(j)&&(g[x]=j)}),_?Object.keys(g).length?p.column_methods=g:p.column_methods={}:p.column_methods=d.column_methods}return p})},[l,t,i]),y.useEffect(()=>{!c||n.size===0||i(d=>{if(!d||typeof d!="object")return d;const f=We(d.columns);if(!f.length)return d;const h=f.filter(_=>!n.has(_));if(h.length===f.length)return d;const p=new Set(f.filter(_=>n.has(_))),g={...d,columns:h};if(d.custom_bins&&typeof d.custom_bins=="object"&&!Array.isArray(d.custom_bins)){const _={};Object.entries(d.custom_bins).forEach(([N,v])=>{!p.has(N)&&Array.isArray(v)&&v.length&&(_[N]=[...v])}),Object.keys(_).length?g.custom_bins=_:Object.prototype.hasOwnProperty.call(g,"custom_bins")&&delete g.custom_bins}if(d.custom_labels&&typeof d.custom_labels=="object"&&!Array.isArray(d.custom_labels)){const _={};Object.entries(d.custom_labels).forEach(([N,v])=>{!p.has(N)&&Array.isArray(v)&&v.length&&(_[N]=v.map(x=>String(x)))}),Object.keys(_).length?g.custom_labels=_:Object.prototype.hasOwnProperty.call(g,"custom_labels")&&delete g.custom_labels}return g})},[n,c,i]),y.useEffect(()=>{!u||s.size===0||i(d=>{if(!d||typeof d!="object")return d;const f=We(d.columns),h=f.filter(S=>!s.has(S)),p=h.length!==f.length,g=We(d.skipped_columns),_=g.filter(S=>!s.has(S)),N=_.length!==g.length,v=S=>S??{...d};let x=null;p&&(x=v(x),x.columns=h.sort((S,C)=>S.localeCompare(C))),N&&(x=v(x),_.length?x.skipped_columns=_.sort((S,C)=>S.localeCompare(C)):Object.prototype.hasOwnProperty.call(x,"skipped_columns")&&delete x.skipped_columns);let j=!1;if(d.column_methods&&typeof d.column_methods=="object"&&!Array.isArray(d.column_methods)){const S={};Object.entries(d.column_methods).forEach(([C,w])=>{const E=String(C??"").trim();if(!E||s.has(E)){j=!0;return}const A=typeof w=="string"?w.trim():null;A&&Cs.includes(A)?S[E]=A:j=!0}),j&&(x=v(x),Object.keys(S).length?x.column_methods=S:Object.prototype.hasOwnProperty.call(x,"column_methods")&&delete x.column_methods)}let k=!1;if(d.column_parameters&&typeof d.column_parameters=="object"&&!Array.isArray(d.column_parameters)){const S={};Object.entries(d.column_parameters).forEach(([C,w])=>{const E=String(C??"").trim();if(!E||s.has(E)){k=!0;return}if(!w||typeof w!="object"||Array.isArray(w)){k=!0;return}S[E]={...w}}),k&&(x=v(x),Object.keys(S).length?x.column_parameters=S:Object.prototype.hasOwnProperty.call(x,"column_parameters")&&delete x.column_parameters)}return x||d})},[u,s,i])},YP=({catalogFlags:e,configState:t,setConfigState:n,nodeId:s,numericExcludedColumns:i,scalingData:l,outlierData:c,binningData:u,availableColumns:d,previewSampleRows:f})=>{const{isScalingNode:h,isOutlierNode:p,isBinningNode:g}=e,{scalingConfig:_,scalingExcludedColumns:N,scalingMethodDetailMap:v,scalingMethodOptions:x,scalingRecommendations:j,scalingRecommendationRows:k,scalingSelectedCount:S,scalingOverrideCount:C,scalingDefaultDetail:w,scalingDefaultLabel:E,scalingAutoDetectEnabled:A,scalingHasRecommendations:R,scalingStatusMessage:P,scalingOverrideExampleSummary:T}=FP({catalogFlags:e,configState:t,numericExcludedColumns:i,scalingData:l}),{outlierConfig:O,outlierExcludedColumns:F,outlierMethodLabelMap:B,outlierMethodDetailMap:L,outlierMethodOptions:D,outlierRecommendations:q,outlierRecommendationRows:Y,outlierSelectedCount:W,outlierOverrideCount:X,outlierParameterOverrideCount:I,outlierDefaultDetail:z,outlierDefaultLabel:H,outlierAutoDetectEnabled:te,outlierHasRecommendations:K,outlierStatusMessage:V,outlierOverrideExampleSummary:G}=IP({catalogFlags:e,configState:t,numericExcludedColumns:i,outlierData:c}),Q=typeof(c==null?void 0:c.sample_size)=="number"?c.sample_size:null,ne=null,J=X>0||I>0,re=y.useMemo(()=>X>0?G:I>0?`${I} column${I===1?"":"s"} with parameter overrides`:null,[X,I,G]),{binningConfig:Se,binningSelectedCount:Re,binningDefaultLabel:Oe,binningOverrideColumns:Fe,binningOverrideCount:lt,binningOverrideSummary:Be,fieldIds:de,customEdgeDrafts:pe,setCustomEdgeDrafts:xe,customLabelDrafts:ke,setCustomLabelDrafts:Ue}=BP({configState:t,nodeId:s}),ce=y.useMemo(()=>h?_.columns:g?Se.columns:p?O.columns:We(t==null?void 0:t.columns),[Se.columns,t,g,p,h,O.columns,_.columns]),Me=y.useMemo(()=>{const Wt=u==null?void 0:u.columns;return Array.isArray(Wt)?Wt.filter(et=>!et||typeof et.column!="string"?!1:!!et.column.trim()):[]},[u==null?void 0:u.columns]),Ye=y.useMemo(()=>{if(!Me.length)return new Set;const Wt=new Set;return Me.forEach(et=>{const qe=typeof et.column=="string"?et.column.trim():"";qe&&Wt.add(qe)}),Wt},[Me]),at=y.useMemo(()=>{if(!g)return[];const Wt=new Set;return d.forEach(et=>{if(i.has(et))return;const qe=et.trim();qe&&Wt.add(qe)}),Me.forEach(et=>{const qe=typeof et.column=="string"?et.column.trim():"";qe&&(!i.has(qe)||Ye.has(qe))&&Wt.add(qe)}),ce.forEach(et=>{const qe=typeof et=="string"?et.trim():"";qe&&(!i.has(qe)||Ye.has(qe))&&Wt.add(qe)}),Array.from(Wt).sort((et,qe)=>et.localeCompare(qe))},[d,Me,Ye,g,i,ce]),Ze=y.useMemo(()=>!g||!at.length?[]:at.filter(Wt=>!ce.includes(Wt)),[at,g,ce]),_t=Ze.length>0,{handleBinningIntegerChange:st,handleBinningBooleanToggle:dt,handleBinningSuffixChange:jt,handleBinningLabelFormatChange:zt,handleBinningMissingStrategyChange:Ge,handleBinningMissingLabelChange:Ft,handleBinningCustomBinsChange:Kt,handleBinningCustomLabelsChange:Mt,handleBinningClearCustomColumn:tn,updateBinningColumnOverride:Sn,handleBinningOverrideStrategyChange:At,handleBinningOverrideNumberChange:nn,handleBinningOverrideKbinsEncodeChange:En,handleBinningOverrideKbinsStrategyChange:It,handleBinningClearOverride:ut,handleBinningClearOverrides:zn,handleBinningApplyStrategies:Qt,handleBinningApplyColumns:ft,handleApplyAllBinningNumeric:tt}=UP({setConfigState:n,setBinningCustomEdgeDrafts:xe,setBinningCustomLabelDrafts:Ue,binningConfig:Se,binningInsightsRecommendations:Me,binningAllNumericColumns:at}),{handleOutlierDefaultMethodChange:fs,handleOutlierAutoDetectToggle:Vt,setOutlierColumnMethod:pt,handleOutlierClearOverrides:bt,handleOutlierApplyAllRecommendations:ns,handleOutlierSkipColumn:hn,handleOutlierUnskipColumn:bn,handleOutlierOverrideSelect:un,handleOutlierMethodParameterChange:kn,handleOutlierColumnParameterChange:sn}=qP({setConfigState:n,outlierRecommendationRows:Y,outlierExcludedColumns:F,outlierConfig:O}),{handleScalingDefaultMethodChange:ss,handleScalingAutoDetectToggle:$t,setScalingColumnMethod:Dn,handleScalingClearOverrides:xn,handleScalingApplyAllRecommendations:wn,handleScalingSkipColumn:Js,handleScalingUnskipColumn:Kn,handleScalingOverrideSelect:Is}=HP({setConfigState:n,scalingRecommendations:j}),{binningExcludedColumns:rs,binningColumnPreviewMap:ps,manualBoundColumns:Bs,manualRangeFallbackMap:Yn}=WP({catalogFlags:e,numericExcludedColumns:i,selectedColumns:ce,previewSampleRows:f,availableColumns:d,recommendedColumns:Ye}),as=y.useMemo(()=>{const Wt=u==null?void 0:u.excluded_columns;return Array.isArray(Wt)?Wt.filter(et=>!et||typeof et.column!="string"?!1:!!et.column.trim()):[]},[u==null?void 0:u.excluded_columns]);return KP({catalogFlags:e,scalingExcludedColumns:N,binningExcludedColumns:rs,outlierExcludedColumns:F,setConfigState:n}),{scaling:{config:_,state:{excludedColumns:N,methodDetailMap:v,methodOptions:x,recommendations:j,recommendationRows:k,selectedCount:S,overrideCount:C,defaultDetail:w,defaultLabel:E,autoDetectEnabled:A,hasRecommendations:R,statusMessage:P,overrideExampleSummary:T},handlers:{handleDefaultMethodChange:ss,handleAutoDetectToggle:$t,setColumnMethod:Dn,handleClearOverrides:xn,handleApplyAllRecommendations:wn,handleSkipColumn:Js,handleUnskipColumn:Kn,handleOverrideSelect:Is}},outlier:{config:O,state:{excludedColumns:F,methodLabelMap:B,methodDetailMap:L,methodOptions:D,recommendations:q,recommendationRows:Y,selectedCount:W,overrideCount:X,parameterOverrideCount:I,defaultDetail:z,defaultLabel:H,autoDetectEnabled:te,hasRecommendations:K,statusMessage:V,overrideExampleSummary:G,sampleSize:Q,relativeGeneratedAt:ne,hasOverrides:J,overrideSummaryDisplay:re},handlers:{handleDefaultMethodChange:fs,handleAutoDetectToggle:Vt,setColumnMethod:pt,handleClearOverrides:bt,handleApplyAllRecommendations:ns,handleSkipColumn:hn,handleUnskipColumn:bn,handleOverrideSelect:un,handleMethodParameterChange:kn,handleColumnParameterChange:sn}},binning:{config:Se,state:{selectedCount:Re,defaultLabel:Oe,overrideColumns:Fe,overrideCount:lt,overrideSummary:Be,fieldIds:de,customEdgeDrafts:pe,customLabelDrafts:ke,insightsRecommendations:Me,recommendedColumnSet:Ye,allNumericColumns:at,numericColumnsNotSelected:Ze,canApplyAllNumeric:_t,excludedColumns:rs,columnPreviewMap:ps,manualBoundColumns:Bs,manualRangeFallbackMap:Yn,insightsExcludedColumns:as},handlers:{setCustomEdgeDrafts:xe,setCustomLabelDrafts:Ue,handleIntegerChange:st,handleBooleanToggle:dt,handleSuffixChange:jt,handleLabelFormatChange:zt,handleMissingStrategyChange:Ge,handleMissingLabelChange:Ft,handleCustomBinsChange:Kt,handleCustomLabelsChange:Mt,handleClearCustomColumn:tn,updateColumnOverride:Sn,handleOverrideStrategyChange:At,handleOverrideNumberChange:nn,handleOverrideKbinsEncodeChange:En,handleOverrideKbinsStrategyChange:It,handleClearOverride:ut,handleClearOverrides:zn,handleApplyStrategies:Qt,handleApplyColumns:ft,handleApplyAllNumeric:tt}},selectedColumns:ce}},GP=({catalogFlags:e,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:i,columnTypeMap:l,setAvailableColumns:c,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:f,setColumnSuggestions:h,dropColumnParameter:p,node:g,configState:_,setConfigState:N,nodeChangeVersion:v,binnedSamplePreset:x,skewnessTransformations:j,availableColumns:k,columnMissingMap:S,previewSampleRows:C})=>{var Y;const E=N$({hasDropColumnSource:!!p,sourceId:t,nodeId:n,graphContext:s,hasReachableSource:i,columnTypeMap:l,setAvailableColumns:c,setColumnSearch:u,setColumnMissingMap:d,setColumnTypeMap:f,setColumnSuggestions:h});L$({catalogFlags:e,sourceId:t,hasReachableSource:i,graphContext:s,targetNodeId:(g==null?void 0:g.id)??null,setAvailableColumns:c,setColumnMissingMap:d});const A=lP({catalogFlags:e,sourceId:t,hasReachableSource:i,graphContext:s,node:g,configState:_,setConfigState:N,nodeChangeVersion:v}),R=cP({catalogFlags:e,sourceId:t,hasReachableSource:i,graphContext:s,targetNodeId:n||null}),P=uP({catalogFlags:e,sourceId:t,hasReachableSource:i,graphContext:s,targetNodeId:(g==null?void 0:g.id)??null}),T=dP({catalogFlags:e,sourceId:t,hasReachableSource:i,graphContext:s,targetNodeId:(g==null?void 0:g.id)??null}),O=mP({catalogFlags:e,sourceId:t,hasReachableSource:i,graphContext:s,targetNodeId:(g==null?void 0:g.id)??null,samplePreset:x}),F=hP({catalogFlags:e,sourceId:t,graphContext:s,targetNodeId:(g==null?void 0:g.id)??null,transformations:j}),B=vP({catalogFlags:e,configState:_,node:g,availableColumns:k,columnMissingMap:S}),L=MP({catalogFlags:e,configState:_,nodeConfig:((Y=g==null?void 0:g.data)==null?void 0:Y.config)??null,availableColumns:k,columnTypeMap:l,previewSampleRows:C}),D=$P({catalogFlags:e,availableColumns:k,columnTypeMap:l,previewSampleRows:C}),q=YP({catalogFlags:e,configState:_,setConfigState:N,nodeId:n,numericExcludedColumns:D.numericExcludedColumns,scalingData:P.scalingData,outlierData:R.outlierData,binningData:T.binningData,availableColumns:k,previewSampleRows:C});return{dropMissingColumns:E,encodingRecommendations:A,outlierRecommendations:R,scalingInsights:P,binningInsights:T,binnedDistribution:O,skewnessInsights:F,missingIndicatorState:B,dataCleaningState:L,numericColumnAnalysis:D,numericAnalysisState:q}},QP=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:i})=>{var l;y.useEffect(()=>{var h;const c=Array.isArray((h=e.data)==null?void 0:h.column_stats)?e.data.column_stats:[],u=e.status;if(!c.length){if(u==="loading")return;s(p=>Object.keys(p).length?{}:p),i(p=>Object.keys(p).length?{}:p);return}const d={},f={};c.forEach(p=>{if(!p||!p.name)return;const g=String(p.name).trim();if(!g||n&&g.endsWith(n))return;const _=typeof p.dtype=="string"?p.dtype:null;_&&(d[g]=_);const N=t.map(x=>x&&Object.prototype.hasOwnProperty.call(x,g)?x[g]:void 0),v=N2(_,N);v.length&&(f[g]=v)}),s(p=>{const g=Object.entries(p),_=Object.entries(d);return g.length===_.length&&g.every(([N,v])=>Object.prototype.hasOwnProperty.call(d,N)&&d[N]===v)?p:d}),i(p=>{const g=Object.keys(p),_=Object.keys(f);return g.length===_.length&&g.every(N=>{if(!Object.prototype.hasOwnProperty.call(f,N))return!1;const v=p[N]??[],x=f[N]??[];return ex(v,x)})?p:f})},[n,t,(l=e.data)==null?void 0:l.column_stats,e.status,i,s])},XP=({previewState:e,activeFlagSuffix:t,hasReachableSource:n,requiresColumnCatalog:s,nodeColumns:i,selectedColumns:l,setAvailableColumns:c,setColumnMissingMap:u})=>{var d,f;y.useEffect(()=>{var v,x;if(!s||!n)return;const h=new Set;(Array.isArray((v=e.data)==null?void 0:v.columns)?e.data.columns:[]).forEach(j=>{const k=typeof j=="string"?j.trim():"";k&&(t&&k.endsWith(t)||h.add(k))});const g=Array.isArray((x=e.data)==null?void 0:x.column_stats)?e.data.column_stats:[],_={};if(g.forEach(j=>{if(!j||!j.name)return;const k=String(j.name).trim();if(!k||t&&k.endsWith(t))return;h.add(k);const S=Number(j.missing_percentage);!Number.isNaN(S)&&S>=0&&(_[k]=S)}),We(i).forEach(j=>{j&&!(t&&j.endsWith(t))&&h.add(j)}),l.forEach(j=>{j&&!(t&&j.endsWith(t))&&h.add(j)}),h.size===0)return;const N=Array.from(h).sort((j,k)=>j.localeCompare(k));c(j=>ex(j,N)?j:N),Object.keys(_).length>0&&u(j=>({...j,..._}))},[t,n,i,(d=e.data)==null?void 0:d.column_stats,(f=e.data)==null?void 0:f.columns,s,l,c,u])},JP=({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:i,hasReachableSource:l,requiresColumnCatalog:c,nodeColumns:u,selectedColumns:d,setAvailableColumns:f,setColumnMissingMap:h})=>{QP({previewState:e,previewSampleRows:t,activeFlagSuffix:n,setColumnTypeMap:s,setColumnSuggestions:i}),XP({previewState:e,activeFlagSuffix:n,hasReachableSource:l,requiresColumnCatalog:c,nodeColumns:u,selectedColumns:d,setAvailableColumns:f,setColumnMissingMap:h})},ZP=["int","float","double","numeric","number"],Ex=e=>{if(!e)return!1;const t=e.toLowerCase();return ZP.some(n=>t.includes(n))},eR=({catalogFlags:e,skewnessData:t,skewnessTransformations:n,availableColumns:s,previewColumns:i,columnTypeMap:l,updateSkewnessTransformations:c})=>{const{isSkewnessNode:u,isSkewnessDistributionNode:d}=e,f=u||d,[h,p]=y.useState("recommended"),[g,_]=y.useState(!1),[N,v]=y.useState("before"),x=n.length,j=y.useMemo(()=>t!=null&&t.methods?[...t.methods]:[],[t==null?void 0:t.methods]),k=y.useMemo(()=>yM(j),[j]),S=y.useMemo(()=>t!=null&&t.columns?[...t.columns]:[],[t==null?void 0:t.columns]),C=y.useMemo(()=>{const I=new Map;return S.forEach(z=>{z&&z.column&&I.set(z.column,z)}),I},[S]),w=y.useMemo(()=>{const I=new Set;return S.forEach(z=>{z!=null&&z.column&&I.add(z.column)}),s.forEach(z=>{z&&Ex(l[z]??null)&&I.add(z)}),i.forEach(z=>{const H=typeof z=="string"?z.trim():"";H&&Ex(l[H]??null)&&I.add(H)}),Array.from(I).sort((z,H)=>z.localeCompare(H))},[s,i,S,l]);y.useEffect(()=>{h==="recommended"&&S.length===0&&w.length>0&&p("all")},[w.length,S.length,h]);const E=(t==null?void 0:t.skewness_threshold)??null,A=y.useCallback(I=>k[I]??I,[k]),R=y.useCallback((I,z)=>{const H=C.get(I);return!H||!H.method_status?{status:"ready",reason:void 0}:H.method_status[z]??{status:"ready",reason:void 0}},[C]),P=y.useCallback(()=>{const I=S.map(z=>{if(!z||!z.column)return null;const H=Array.isArray(z.recommended_methods)?z.recommended_methods.find(Ur):void 0;return H?{column:z.column,method:H}:null}).filter(z=>!!z);I.length&&c(z=>{const H=new Map;return z.forEach(te=>{const K=typeof te.column=="string"?te.column.trim():"";K&&Ur(te.method)&&H.set(K,te.method)}),I.forEach(te=>{const K=typeof te.column=="string"?te.column.trim():"";K&&H.set(K,te.method)}),Array.from(H.entries()).map(([te,K])=>({column:te,method:K}))})},[S,c]),T=y.useMemo(()=>{const I=new Map;return n.forEach(z=>{const H=typeof z.column=="string"?z.column.trim():"";!H||I.has(H)||I.set(H,z.method)}),I},[n]),O=y.useCallback((I,z)=>{const H=typeof I=="string"?I.trim():"";H&&c(te=>{const K=te.filter(V=>V.column!==H);return z?[...K,{column:H,method:z}]:K})},[c]),F=y.useCallback((I,z)=>{if(I){if(!z){O(I,null);return}Ur(z)&&O(I,z)}},[O]),B=y.useCallback(()=>{c(()=>[])},[c]),L=S.length,D=y.useMemo(()=>S.some(I=>I&&typeof I.column=="string"&&Array.isArray(I.recommended_methods)&&I.recommended_methods.some(Ur)),[S]),q=w.length,Y=y.useMemo(()=>bM({viewMode:h,recommendations:S,columnOptions:w,recommendationMap:C,transformationMap:T}),[h,S,w,C,T]),W=y.useMemo(()=>f?S.map(I=>{var re;if(!I||!I.column)return null;const z=I.distribution_before??I.distribution??null;if(!z||!Array.isArray(z.bin_edges)||!Array.isArray(z.counts)||z.counts.length===0||z.bin_edges.length!==z.counts.length+1)return null;let H=I.distribution_after??null;H&&(!Array.isArray(H.bin_edges)||!Array.isArray(H.counts)||H.counts.length===0||H.bin_edges.length!==H.counts.length+1)&&(H=null);const te=((re=I.recommended_methods)==null?void 0:re.find(Ur))??null,K=I.magnitude?`${I.magnitude.charAt(0).toUpperCase()}${I.magnitude.slice(1)}`:null,V=I.direction?Py[I.direction]??I.direction:null,G=I.applied_method&&Ur(I.applied_method)?I.applied_method:null,Q=T.get(I.column)??null,ne=G??Q??null,J=ne?A(ne):null;return{column:I.column,skewness:typeof I.skewness=="number"?I.skewness:null,magnitudeLabel:K,directionLabel:V,summary:I.summary??null,recommendedLabel:J?null:te?A(te):null,appliedLabel:J,distributionBefore:z,distributionAfter:H}}).filter(I=>!!I).sort((I,z)=>{const H=I.skewness!==null?Math.abs(I.skewness):-1/0,te=z.skewness!==null?Math.abs(z.skewness):-1/0;return H!==te?te-H:I.column.localeCompare(z.column)}):[],[A,f,S,T]),X=y.useMemo(()=>xM(Y,g,A),[Y,g,A]);return{state:{threshold:E,viewMode:h,groupByMethod:g,distributionView:N,recommendedCount:L,numericCount:q,transformationsCount:x,hasAutoRecommendations:D,rows:Y,tableGroups:X,distributionCards:W},handlers:{setViewMode:p,setGroupByMethod:_,setDistributionView:v,getMethodLabel:A,getMethodStatus:R,applyRecommendations:P,handleOverrideChange:F,clearTransformations:B}}},tR=({catalogFlags:e,imputerStrategies:t,availableColumns:n,columnMissingMap:s,previewColumns:i,previewColumnStats:l,nodeColumns:c,imputerMissingFilter:u})=>{const{isImputerNode:d}=e,f=y.useMemo(()=>{if(!d)return[];const _=i.length?new Set(i.map(C=>typeof C=="string"?C.trim():"").filter(C=>C.length>0)):null,N=new Set;t.forEach(C=>{C.columns.forEach(w=>{const E=typeof w=="string"?w.trim():"";E&&N.add(E)})}),We(c).forEach(C=>{C&&N.add(C)});const v=C=>!_||_.size===0?!1:!_.has(C)&&!N.has(C),x=new Map,j=(C,w)=>{const E=typeof C=="string"?C.trim():"";if(!E||v(E))return;const A=x.get(E)??{missingPercentage:null,dtype:void 0,mean:null,median:null,mode:null};w&&(typeof w.missingPercentage=="number"&&!Number.isNaN(w.missingPercentage)&&(A.missingPercentage=Math.max(0,w.missingPercentage)),w.dtype!==void 0&&(A.dtype=w.dtype),typeof w.mean=="number"&&!Number.isNaN(w.mean)&&(A.mean=w.mean),typeof w.median=="number"&&!Number.isNaN(w.median)&&(A.median=w.median),w.mode!==void 0&&w.mode!==null&&w.mode!==""&&(A.mode=w.mode)),x.set(E,A)};n.forEach(C=>{const w=Object.prototype.hasOwnProperty.call(s,C)?s[C]:null;j(C,{missingPercentage:typeof w=="number"?w:null})}),(Array.isArray(l)?l:[]).forEach(C=>{!C||!C.name||j(C.name,{missingPercentage:typeof C.missing_percentage=="number"?C.missing_percentage:null,dtype:C.dtype??null,mean:typeof C.mean=="number"?C.mean:null,median:typeof C.median=="number"?C.median:null,mode:C.mode??null})}),We(c).forEach(C=>j(C)),t.forEach(C=>{C.columns.forEach(w=>j(w))});const S=Array.from(x.entries()).map(([C,w])=>({name:C,missingPercentage:typeof w.missingPercentage=="number"&&!Number.isNaN(w.missingPercentage)?Math.max(0,w.missingPercentage):null,dtype:w.dtype??null,mean:typeof w.mean=="number"&&!Number.isNaN(w.mean)?w.mean:null,median:typeof w.median=="number"&&!Number.isNaN(w.median)?w.median:null,mode:w.mode!==void 0&&w.mode!==null&&w.mode!==""?w.mode:null}));return S.sort((C,w)=>{const E=typeof C.missingPercentage=="number",A=typeof w.missingPercentage=="number";return E&&A&&C.missingPercentage!==w.missingPercentage?w.missingPercentage-C.missingPercentage:E!==A?E?-1:1:C.name.localeCompare(w.name)}),S},[n,s,t,c,l,i,d]),h=y.useMemo(()=>{if(!f.length)return 100;const _=f.reduce((v,x)=>{const j=typeof x.missingPercentage=="number"?x.missingPercentage:0;return j>v?j:v},0),N=Math.ceil(_/5)*5;return Math.max(100,N||0)},[f]),p=y.useMemo(()=>f.length?f.reduce((_,N)=>{const v=typeof N.missingPercentage=="number"?N.missingPercentage:null;return v!==null?v<=0?_:v>=u?_+1:_:u===0?_+1:_},0):0,[f,u]),g=u>0;return{imputerColumnOptions:f,imputerMissingSliderMax:h,imputerFilteredOptionCount:p,imputerMissingFilterActive:g}},nR=({suggestedThreshold:e,thresholdParameterName:t,configState:n,handleParameterChange:s})=>{const i=y.useMemo(()=>{if(e===null||Number.isNaN(Number(e)))return null;const d=Number(e);return Math.round(d*10)/10},[e]),l=y.useMemo(()=>{if(t===null||i===null)return!1;const d=Number(n==null?void 0:n[t]);return!Number.isNaN(d)&&d===i},[n,i,t]),c=i!==null&&!l,u=y.useCallback(()=>{i===null||!t||s(t,i)},[s,i,t]);return{normalizedSuggestedThreshold:i,thresholdMatchesSuggestion:l,canApplySuggestedThreshold:c,handleApplySuggestedThreshold:u}},sR=({catalogFlags:e,skewnessData:t,skewnessTransformations:n,availableColumns:s,previewColumns:i,columnTypeMap:l,updateSkewnessTransformations:c,imputerStrategies:u,columnMissingMap:d,previewColumnStats:f,nodeColumns:h,imputerMissingFilter:p,suggestedThreshold:g,thresholdParameterName:_,configState:N,handleParameterChange:v})=>{const x=eR({catalogFlags:e,skewnessData:t,skewnessTransformations:n,availableColumns:s,previewColumns:i,columnTypeMap:l,updateSkewnessTransformations:c}),j=tR({catalogFlags:e,imputerStrategies:u,availableColumns:s,columnMissingMap:d,previewColumns:i,previewColumnStats:f,nodeColumns:h,imputerMissingFilter:p}),k=nR({suggestedThreshold:g,thresholdParameterName:_,configState:N,handleParameterChange:v});return{skewness:x,imputationConfiguration:j,thresholdRecommendations:k}},Uu=e=>String(e??"").trim(),rR=({catalogFlags:e,setConfigState:t,binningExcludedColumns:n,scalingExcludedColumns:s,availableColumns:i,recommendations:l})=>{const{isBinningNode:c,isScalingNode:u}=e,d=y.useCallback((v,x,j)=>{const k=Uu(v);k&&t(S=>{const C=S.manual_bounds&&typeof S.manual_bounds=="object"&&!Array.isArray(S.manual_bounds)?{...S.manual_bounds}:{},w=C[k]&&typeof C[k]=="object"?{...C[k]}:{lower:null,upper:null};if(j==="")x==="lower"?w.lower=null:w.upper=null;else{const R=Number(j);if(!Number.isFinite(R))return S;x==="lower"?w.lower=R:w.upper=R}const E=w.lower??null,A=w.upper??null;return E===null&&A===null?delete C[k]:C[k]={lower:E,upper:A},{...S,manual_bounds:C}})},[t]),f=y.useCallback(v=>{const x=Uu(v);x&&t(j=>{const k=j.manual_bounds&&typeof j.manual_bounds=="object"&&!Array.isArray(j.manual_bounds)?j.manual_bounds:null;if(!k||!Object.prototype.hasOwnProperty.call(k,x))return j;const S={...k};return delete S[x],{...j,manual_bounds:S}})},[t]),h=y.useCallback(v=>{const x=Uu(v);x&&t(j=>{const k=We(j.columns),S=k.includes(x),C=S?k.filter(R=>R!==x):[...k,x];let w=!1,E=j.manual_bounds;S&&E&&typeof E=="object"&&!Array.isArray(E)&&Object.prototype.hasOwnProperty.call(E,x)&&(E={...E},delete E[x],w=!0);const A={...j,columns:C};if(w&&(A.manual_bounds=E),c){const R=new Set(C);if(j.custom_bins&&typeof j.custom_bins=="object"&&!Array.isArray(j.custom_bins)){const P={};Object.entries(j.custom_bins).forEach(([T,O])=>{R.has(T)&&Array.isArray(O)&&O.length&&(P[T]=[...O])}),Object.keys(P).length?A.custom_bins=P:"custom_bins"in A&&delete A.custom_bins}else"custom_bins"in A&&delete A.custom_bins;if(j.custom_labels&&typeof j.custom_labels=="object"&&!Array.isArray(j.custom_labels)){const P={};Object.entries(j.custom_labels).forEach(([T,O])=>{R.has(T)&&Array.isArray(O)&&O.length&&(P[T]=O.map(F=>String(F)))}),Object.keys(P).length?A.custom_labels=P:"custom_labels"in A&&delete A.custom_labels}else"custom_labels"in A&&delete A.custom_labels;if(j.column_overrides&&typeof j.column_overrides=="object"&&!Array.isArray(j.column_overrides)){const P={};Object.entries(j.column_overrides).forEach(([T,O])=>{R.has(T)&&O&&typeof O=="object"&&!Array.isArray(O)&&(P[T]={...O})}),Object.keys(P).length?(A.column_overrides=P,A.column_strategies=P):("column_overrides"in A&&delete A.column_overrides,"column_strategies"in A&&delete A.column_strategies)}else"column_overrides"in A&&delete A.column_overrides,"column_strategies"in A&&delete A.column_strategies}if(u){let R=null;j.column_methods&&typeof j.column_methods=="object"&&!Array.isArray(j.column_methods)&&(R={},Object.entries(j.column_methods).forEach(([P,T])=>{const O=typeof T=="string"?T.trim():null;!O||!Fs.includes(O)||S&&P===x||(R[P]=O)})),R&&Object.keys(R).length?A.column_methods=R:S&&Object.prototype.hasOwnProperty.call(A,"column_methods")&&delete A.column_methods}return A})},[c,u,t]),p=y.useCallback(()=>{l.length&&t(v=>{const x=new Set(We(v.columns));return l.forEach(j=>{j!=null&&j.name&&x.add(String(j.name))}),{...v,columns:Array.from(x)}})},[l,t]),g=y.useCallback(()=>{i.length&&t(v=>{const x=new Set(We(v.columns));return i.filter(k=>c?!n.has(k):u?!s.has(k):!0).forEach(k=>x.add(k)),{...v,columns:Array.from(x).sort((k,S)=>k.localeCompare(S))}})},[i,n,c,u,s,t]),_=y.useCallback(()=>{t(v=>{const x={...v,columns:[]};return v!=null&&v.manual_bounds&&typeof v.manual_bounds=="object"&&!Array.isArray(v.manual_bounds)&&Object.keys(v.manual_bounds).length&&(x.manual_bounds={}),c&&("custom_bins"in x&&delete x.custom_bins,"custom_labels"in x&&delete x.custom_labels,"column_overrides"in x&&delete x.column_overrides,"column_strategies"in x&&delete x.column_strategies),u&&"column_methods"in x&&delete x.column_methods,x})},[c,u,t]),N=y.useCallback(v=>{const x=Uu(v);x&&t(j=>{const k=We(j.columns);if(!k.includes(x))return j;const S=k.filter(A=>A!==x);let C=!1,w=j.manual_bounds;w&&typeof w=="object"&&!Array.isArray(w)&&Object.prototype.hasOwnProperty.call(w,x)&&(w={...w},delete w[x],C=!0);const E={...j,columns:S};if(C&&(E.manual_bounds=w),c){if(j.custom_bins&&typeof j.custom_bins=="object"&&!Array.isArray(j.custom_bins)){const A={};Object.entries(j.custom_bins).forEach(([R,P])=>{R!==x&&Array.isArray(P)&&P.length&&(A[R]=[...P])}),Object.keys(A).length?E.custom_bins=A:"custom_bins"in E&&delete E.custom_bins}else"custom_bins"in E&&delete E.custom_bins;if(j.custom_labels&&typeof j.custom_labels=="object"&&!Array.isArray(j.custom_labels)){const A={};Object.entries(j.custom_labels).forEach(([R,P])=>{R!==x&&Array.isArray(P)&&P.length&&(A[R]=P.map(T=>String(T)))}),Object.keys(A).length?E.custom_labels=A:"custom_labels"in E&&delete E.custom_labels}else"custom_labels"in E&&delete E.custom_labels;if(j.column_overrides&&typeof j.column_overrides=="object"&&!Array.isArray(j.column_overrides)){const A={};Object.entries(j.column_overrides).forEach(([R,P])=>{R!==x&&P&&typeof P=="object"&&!Array.isArray(P)&&(A[R]={...P})}),Object.keys(A).length?(E.column_overrides=A,E.column_strategies=A):("column_overrides"in E&&delete E.column_overrides,"column_strategies"in E&&delete E.column_strategies)}else"column_overrides"in E&&delete E.column_overrides,"column_strategies"in E&&delete E.column_strategies}if(u)if(j.column_methods&&typeof j.column_methods=="object"&&!Array.isArray(j.column_methods)){const A={};Object.entries(j.column_methods).forEach(([R,P])=>{const T=typeof P=="string"?P.trim():null;!T||!Fs.includes(T)||R!==x&&(A[R]=T)}),Object.keys(A).length?E.column_methods=A:Object.prototype.hasOwnProperty.call(E,"column_methods")&&delete E.column_methods}else Object.prototype.hasOwnProperty.call(E,"column_methods")&&delete E.column_methods;return E})},[c,u,t]);return{handleManualBoundChange:d,handleClearManualBound:f,handleToggleColumn:h,handleApplyAllRecommended:p,handleSelectAllColumns:g,handleClearColumns:_,handleRemoveColumn:N}},aR=({configState:e,catalogFlags:t,nodeId:n,onUpdateConfig:s,onClose:i,sourceId:l,graphSnapshot:c,onUpdateNodeData:u,setConfigState:d,canResetNode:f,defaultConfigTemplate:h,onResetConfig:p})=>{const{isBinningNode:g,isScalingNode:_,isInspectionNode:N}=t,v=y.useCallback(j=>{if(!n)return;let k=Lh(e);if(g){const S=ky(k);k={...k,strategy:S.strategy,columns:S.columns,equal_width_bins:S.equalWidthBins,equal_frequency_bins:S.equalFrequencyBins,include_lowest:S.includeLowest,precision:S.precision,duplicates:S.duplicates,output_suffix:S.outputSuffix,drop_original:S.dropOriginal,label_format:S.labelFormat,missing_strategy:S.missingStrategy},S.missingStrategy==="label"?k.missing_label=S.missingLabel:Object.prototype.hasOwnProperty.call(k,"missing_label")&&delete k.missing_label,Object.keys(S.customBins).length?k.custom_bins=S.customBins:Object.prototype.hasOwnProperty.call(k,"custom_bins")&&delete k.custom_bins,Object.keys(S.customLabels).length?k.custom_labels=S.customLabels:Object.prototype.hasOwnProperty.call(k,"custom_labels")&&delete k.custom_labels}if(_){const S=Sx(k);k={...k,columns:S.columns,default_method:S.defaultMethod,auto_detect:S.autoDetect,skipped_columns:S.skippedColumns},Object.keys(S.columnMethods).length>0?k.column_methods=S.columnMethods:Object.prototype.hasOwnProperty.call(k,"column_methods")&&delete k.column_methods}s(n,k),(j==null?void 0:j.closeModal)!==!1&&i(),l&&c&&!N&&(u==null||u(n,{backgroundExecutionStatus:"loading"}),_y({dataset_source_id:l,graph:{nodes:c.nodes||[],edges:c.edges||[]},target_node_id:n}).then(()=>{u==null||u(n,{backgroundExecutionStatus:"success"})}).catch(S=>{u==null||u(n,{backgroundExecutionStatus:"error"}),console.warn("Background full dataset execution failed:",S)}))},[e,c,g,N,_,n,i,s,u,l]),x=y.useCallback(()=>{if(!f||!n)return;const j=Lh(h??{});d(j),p==null||p(n,j)},[f,h,n,p,d]);return{handleSave:v,handleResetNode:x}},oR=({setConfigState:e,imputationMethodValues:t,imputationMethodOptions:n,imputerStrategyCount:s,setCollapsedStrategies:i,setImputerMissingFilter:l})=>{const c=y.useCallback(v=>{e(x=>{const j=Ty(x==null?void 0:x.strategies,t),k=v(j).map(S=>({...S,options:Pl(S.method,S.options)}));return{...x,strategies:fM(k)}})},[t,e]),u=y.useCallback(()=>{var j;const v=s,x=((j=n[0])==null?void 0:j.value)??"mean";c(k=>[...k,{method:x,columns:[],options:Pl(x,Oy(x))}]),i(k=>{const S=new Set(k);return S.delete(v),S})},[n,s,c,i]),d=y.useCallback(v=>{c(x=>x.filter((j,k)=>k!==v)),i(x=>{const j=new Set;return x.forEach(k=>{k!==v&&j.add(k>v?k-1:k)}),j})},[c,i]),f=y.useCallback(v=>{i(x=>{const j=new Set(x);return j.has(v)?j.delete(v):j.add(v),j})},[i]),h=y.useCallback((v,x)=>{c(j=>j.map((k,S)=>S===v?{...k,method:x,options:Pl(x,k.options)}:k))},[c]),p=y.useCallback((v,x,j)=>{c(k=>k.map((S,C)=>{if(C!==v)return S;const w={...S.options??{}};if(j==="")delete w[x];else{const E=Number(j);if(!Number.isFinite(E))return S;w[x]=E}return{...S,options:Pl(S.method,w)}}))},[c]),g=y.useCallback((v,x)=>{const j=x.split(",").map(k=>k.trim()).filter(Boolean);c(k=>k.map((S,C)=>C===v?{...S,columns:j}:S))},[c]),_=y.useCallback((v,x)=>{const j=x.trim();j&&c(k=>k.map((S,C)=>{if(C!==v)return S;const E=S.columns.includes(j)?S.columns.filter(A=>A!==j):[...S.columns,j];return E.sort((A,R)=>A.localeCompare(R)),{...S,columns:E}}))},[c]),N=y.useCallback(v=>{l(v)},[l]);return{updateImputerStrategies:c,handleAddImputerStrategy:u,handleRemoveImputerStrategy:d,toggleImputerStrategySection:f,handleImputerMethodChange:h,handleImputerOptionNumberChange:p,handleImputerColumnsChange:g,handleImputerColumnToggle:_,handleImputerMissingFilterChange:N}},iR=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,aliasColumnSummary:i,aliasStrategyCount:l})=>{var v;const{isReplaceAliasesNode:c}=e,u=y.useCallback(x=>{c&&n(j=>{var F,B,L,D,q,Y,W,X,I;if(!c)return j;const k=We((j==null?void 0:j.columns)??((B=(F=t==null?void 0:t.data)==null?void 0:F.config)==null?void 0:B.columns)),S=ju(j==null?void 0:j.mode,(D=(L=t==null?void 0:t.data)==null?void 0:L.config)==null?void 0:D.mode),C=(()=>{var te;const z=Ei(j);if(z!==void 0){const K=No(z);if(K!==null)return K}const H=Ei((te=t==null?void 0:t.data)==null?void 0:te.config);if(H!==void 0){const K=No(H);if(K!==null)return K}return k.length===0})(),w=(j==null?void 0:j.alias_strategies)??(j==null?void 0:j.strategies)??((Y=(q=t==null?void 0:t.data)==null?void 0:q.config)==null?void 0:Y.alias_strategies)??((X=(W=t==null?void 0:t.data)==null?void 0:W.config)==null?void 0:X.strategies),E=Fy(w,{mode:S,columns:k,autoDetect:C}),A=x(E).map(z=>({mode:ju(z.mode,S),columns:Array.from(new Set(z.columns.map(H=>H.trim()).filter(Boolean))).sort((H,te)=>H.localeCompare(te)),autoDetect:!!z.autoDetect})),R=RM(A),P=Array.from(new Set(A.flatMap(z=>z.columns))).sort((z,H)=>z.localeCompare(H)),T=((I=A[0])==null?void 0:I.mode)??S,O=A.length?A.some(z=>z.autoDetect):C;return{...j,alias_strategies:R,columns:P,mode:T,auto_detect:O}})},[c,(v=t==null?void 0:t.data)==null?void 0:v.config,n]),d=y.useCallback(()=>{if(!c)return;const x=l;u(j=>{var E;const k=new Set;j.forEach(A=>{A.columns.forEach(R=>{const P=R.trim();P&&k.add(P)})});const S=i.recommendedColumns.find(A=>!k.has(A)),w={mode:j.length?j[j.length-1].mode:((E=zy[0])==null?void 0:E.value)??Nh,columns:S?[S]:[],autoDetect:!S};return[...j,w]}),s(j=>{const k=new Set(j);return k.delete(x),k})},[i.recommendedColumns,l,c,s,u]),f=y.useCallback(x=>{u(j=>j.filter((k,S)=>S!==x)),s(j=>{const k=new Set;return j.forEach(S=>{S!==x&&k.add(S>x?S-1:S)}),k})},[s,u]),h=y.useCallback(x=>{s(j=>{const k=new Set(j);return k.has(x)?k.delete(x):k.add(x),k})},[s]),p=y.useCallback((x,j)=>{u(k=>k.map((S,C)=>C===x?{...S,mode:j}:S))},[u]),g=y.useCallback((x,j)=>{const k=j.trim();k&&u(S=>S.map((C,w)=>{if(w!==x)return C;const A=C.columns.includes(k)?C.columns.filter(R=>R!==k):[...C.columns,k];return A.sort((R,P)=>R.localeCompare(P)),{...C,columns:A}}))},[u]),_=y.useCallback((x,j)=>{const k=j.split(",").map(C=>C.trim()).filter(Boolean),S=Array.from(new Set(k)).sort((C,w)=>C.localeCompare(w));u(C=>C.map((w,E)=>E===x?{...w,columns:S}:w))},[u]),N=y.useCallback((x,j)=>{u(k=>k.map((S,C)=>C===x?{...S,autoDetect:j}:S))},[u]);return{updateAliasStrategies:u,handleAddAliasStrategy:d,handleRemoveAliasStrategy:f,toggleAliasStrategySection:h,handleAliasModeChange:p,handleAliasColumnToggle:g,handleAliasColumnsChange:_,handleAliasAutoDetectToggle:N}},lR=({catalogFlags:e,node:t,setConfigState:n,setCollapsedStrategies:s,dateStrategies:i,standardizeDatesColumnSummary:l,standardizeDatesMode:c})=>{var x,j,k,S,C,w;const{isStandardizeDatesNode:u}=e,d=y.useCallback(E=>{n(A=>{var q,Y,W,X,I,z,H;if(!u)return A;const R=We((A==null?void 0:A.columns)??((Y=(q=t==null?void 0:t.data)==null?void 0:q.config)==null?void 0:Y.columns)),P=Qy(A==null?void 0:A.mode,(X=(W=t==null?void 0:t.data)==null?void 0:W.config)==null?void 0:X.mode),T=R.length===0,O=Xy((A==null?void 0:A.format_strategies)??((z=(I=t==null?void 0:t.data)==null?void 0:I.config)==null?void 0:z.format_strategies),{columns:R,mode:P,autoDetect:T}),F=E(O),B=lA(F),L=Array.from(new Set(F.flatMap(te=>te.columns.map(K=>K.trim()).filter(Boolean)))).sort((te,K)=>te.localeCompare(K)),D=((H=F[0])==null?void 0:H.mode)??P;return{...A,format_strategies:B,columns:L,mode:D}})},[u,(j=(x=t==null?void 0:t.data)==null?void 0:x.config)==null?void 0:j.columns,(S=(k=t==null?void 0:t.data)==null?void 0:k.config)==null?void 0:S.format_strategies,(w=(C=t==null?void 0:t.data)==null?void 0:C.config)==null?void 0:w.mode,n]),f=y.useCallback(()=>{const E=i.length;d(A=>{var F;const R=new Set;A.forEach(B=>{B.columns.forEach(L=>{const D=L.trim();D&&R.add(D)})});const P=l.recommendedColumns.find(B=>!R.has(B)),O={mode:A.length?A[A.length-1].mode:((F=Eh[0])==null?void 0:F.value)??c,columns:P?[P]:[],autoDetect:!P};return[...A,O]}),s(A=>{const R=new Set(A);return R.delete(E),R})},[i.length,s,l.recommendedColumns,c,d]),h=y.useCallback(E=>{d(A=>A.filter((R,P)=>P!==E)),s(A=>{const R=new Set;return A.forEach(P=>{P!==E&&R.add(P>E?P-1:P)}),R})},[s,d]),p=y.useCallback(E=>{s(A=>{const R=new Set(A);return R.has(E)?R.delete(E):R.add(E),R})},[s]),g=y.useCallback((E,A)=>{d(R=>R.map((P,T)=>T===E?{...P,mode:A}:P))},[d]),_=y.useCallback((E,A)=>{const R=A.split(",").map(P=>P.trim()).filter(Boolean).sort((P,T)=>P.localeCompare(T));d(P=>P.map((T,O)=>O===E?{...T,columns:R}:T))},[d]),N=y.useCallback((E,A)=>{const R=A.trim();R&&d(P=>P.map((T,O)=>{if(O!==E)return T;const B=T.columns.includes(R)?T.columns.filter(L=>L!==R):[...T.columns,R];return B.sort((L,D)=>L.localeCompare(D)),{...T,columns:B}}))},[d]),v=y.useCallback((E,A)=>{d(R=>R.map((P,T)=>T===E?{...P,autoDetect:A}:P))},[d]);return{updateDateStrategies:d,handleAddDateStrategy:f,handleRemoveDateStrategy:h,toggleDateStrategySection:p,handleDateStrategyModeChange:g,handleDateStrategyColumnsChange:_,handleDateStrategyColumnToggle:N,handleDateStrategyAutoDetectToggle:v}},cR=new Set(Au.map(e=>e.value)),Yl=e=>!e||!e.length?[]:Array.from(new Set(e.map(t=>t.trim()).filter(t=>t.length>0))).sort((t,n)=>t.localeCompare(n)),kx=e=>!e||!e.length?[]:e.filter(t=>Number.isFinite(t)),Mx=e=>{const n=Yl(e).filter(s=>cR.has(s));return n.length?n:["year","month","day"]},Gl=e=>e==null?null:Number.isFinite(e)?e:null,Ax=e=>{const t=Gl(e);if(t===null)return null;const n=Math.round(t);return Number.isFinite(n)?n:null},Ox=e=>typeof e!="string"?"UTC":e.trim()||"UTC",uR=({catalogFlags:e,setConfigState:t,setCollapsedFeatureMath:n})=>{const{isFeatureMathNode:s}=e,i=y.useCallback(p=>{t(g=>{if(!s)return g;const _=g&&typeof g=="object"&&!Array.isArray(g)?{...g}:{},N=Tb(Array.isArray(g==null?void 0:g.operations)?g.operations:[]),v=p(N);return _.operations=cT(v),_})},[s,t]),l=y.useCallback(p=>{if(!s)return;let g="";i(_=>{const N=new Set(_.map(x=>x.id)),v=$b(p,N);return g=v.id,[..._,v]}),g&&n(_=>{const N=new Set(_);return N.delete(g),N})},[s,n,i]),c=y.useCallback(p=>{if(!s)return;let g="";i(_=>{const N=_.findIndex(C=>C.id===p);if(N===-1)return _;const v=_[N],x=new Set(_.map(C=>C.id)),j=$b(v.type,x);g=j.id;const k={...v,id:j.id,inputColumns:[...v.inputColumns],secondaryColumns:[...v.secondaryColumns],constants:[...v.constants],datetimeFeatures:[...v.datetimeFeatures],outputColumn:v.outputColumn?`${v.outputColumn}_copy`:""},S=[..._];return S.splice(N+1,0,k),S}),g&&n(_=>{const N=new Set(_);return N.delete(g),N})},[s,n,i]),u=y.useCallback(p=>{s&&(i(g=>g.filter(_=>_.id!==p)),n(g=>{const _=new Set(g);return _.delete(p),_}))},[s,n,i]),d=y.useCallback((p,g)=>{s&&i(_=>{const N=_.findIndex(k=>k.id===p);if(N===-1)return _;const v=g==="up"?N-1:N+1;if(v<0||v>=_.length)return _;const x=[..._],[j]=x.splice(N,1);return x.splice(v,0,j),x})},[s,i]),f=y.useCallback(p=>{n(g=>{const _=new Set(g);return _.has(p)?_.delete(p):_.add(p),_})},[n]),h=y.useCallback((p,g)=>{s&&i(_=>_.map(N=>{if(N.id!==p)return N;let v={...N};if(g.type&&(v.type=g.type),g.method!==void 0&&(v.method=g.method),g.inputColumns!==void 0&&(v.inputColumns=Yl(g.inputColumns)),g.secondaryColumns!==void 0&&(v.secondaryColumns=Yl(g.secondaryColumns)),g.constants!==void 0&&(v.constants=kx(g.constants)),g.outputColumn!==void 0&&(v.outputColumn=g.outputColumn.trim()),g.outputPrefix!==void 0&&(v.outputPrefix=g.outputPrefix.trim()),g.datetimeFeatures!==void 0&&(v.datetimeFeatures=Mx(g.datetimeFeatures)),g.timezone!==void 0&&(v.timezone=Ox(g.timezone)),g.fillna!==void 0&&(v.fillna=Gl(g.fillna)),g.roundDigits!==void 0&&(v.roundDigits=Ax(g.roundDigits)),g.normalize!==void 0&&(v.normalize=g.normalize),g.epsilon!==void 0&&(v.epsilon=Gl(g.epsilon)),g.allowOverwrite!==void 0&&(v.allowOverwrite=g.allowOverwrite),g.description!==void 0){const k=typeof g.description=="string"?g.description.trim():"";v.description=k||void 0}const x=v.type,j=Pb(x);return j.length?new Set(j.map(S=>S.value)).has(v.method)||(v.method=j[0].value):x==="ratio"?v.method="ratio":x==="datetime_extract"&&(v.method="datetime_extract"),v.inputColumns=Yl(v.inputColumns),x==="ratio"||x==="similarity"?v.secondaryColumns=Yl(v.secondaryColumns):v.secondaryColumns=[],v.constants=kx(v.constants),v.fillna=Gl(v.fillna),v.roundDigits=Ax(v.roundDigits),v.epsilon=Gl(v.epsilon),x==="datetime_extract"?(v.datetimeFeatures=Mx(v.datetimeFeatures),v.timezone=Ox(v.timezone)):(v.datetimeFeatures=[],v.timezone="UTC"),x!=="similarity"?v.normalize=!1:v.normalize=!!v.normalize,typeof v.allowOverwrite!="boolean"&&(v.allowOverwrite=null),v.outputColumn=v.outputColumn.trim(),v.outputPrefix=v.outputPrefix.trim(),v}))},[s,i]);return{updateFeatureMathOperations:i,handleAddFeatureMathOperation:l,handleDuplicateFeatureMathOperation:c,handleRemoveFeatureMathOperation:u,handleReorderFeatureMathOperation:d,handleToggleFeatureMathOperation:f,handleFeatureMathOperationChange:h}},dR=({catalogFlags:e,setConfigState:t,binningExcludedColumns:n,scalingExcludedColumns:s,availableColumns:i,recommendations:l,nodeId:c,onUpdateConfig:u,onClose:d,sourceId:f,graphSnapshot:h,onUpdateNodeData:p,canResetNode:g,defaultConfigTemplate:_,onResetConfig:N,imputationMethodValues:v,imputationMethodOptions:x,imputerStrategyCount:j,setCollapsedStrategies:k,setImputerMissingFilter:S,node:C,aliasColumnSummary:w,aliasStrategyCount:E,dateStrategies:A,standardizeDatesColumnSummary:R,standardizeDatesMode:P,setCollapsedFeatureMath:T,configState:O})=>{const F=rR({catalogFlags:e,setConfigState:t,binningExcludedColumns:n,scalingExcludedColumns:s,availableColumns:i,recommendations:l}),B=aR({configState:O,catalogFlags:e,nodeId:c,onUpdateConfig:u,onClose:d,sourceId:f,graphSnapshot:h,onUpdateNodeData:p,setConfigState:t,canResetNode:g,defaultConfigTemplate:_,onResetConfig:N}),L=oR({setConfigState:t,imputationMethodValues:v,imputationMethodOptions:x,imputerStrategyCount:j,setCollapsedStrategies:k,setImputerMissingFilter:S}),D=iR({catalogFlags:e,node:C,setConfigState:t,setCollapsedStrategies:k,aliasColumnSummary:w,aliasStrategyCount:E}),q=lR({catalogFlags:e,node:C,setConfigState:t,setCollapsedStrategies:k,dateStrategies:A,standardizeDatesColumnSummary:R,standardizeDatesMode:P}),Y=uR({catalogFlags:e,setConfigState:t,setCollapsedFeatureMath:T});return{columnSelectionHandlers:F,nodeSaveHandlers:B,imputationStrategyHandlers:L,aliasStrategyHandlers:D,dateStrategyHandlers:q,featureMathHandlers:Y}},qu=e=>{const t=Number(e);return Number.isFinite(t)?Math.max(0,Math.round(t)):null},mR=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:i})=>{const l=y.useMemo(()=>Rn(e??null),[e]),c=y.useMemo(()=>Rn((t==null?void 0:t.generated_at)??null),[t==null?void 0:t.generated_at]),u=y.useMemo(()=>Rn((n==null?void 0:n.generated_at)??null),[n==null?void 0:n.generated_at]),d=y.useMemo(()=>Rn((s==null?void 0:s.generated_at)??null),[s==null?void 0:s.generated_at]),f=y.useMemo(()=>Rn((i==null?void 0:i.generated_at)??null),[i==null?void 0:i.generated_at]),h=y.useMemo(()=>qu((t==null?void 0:t.sample_size)??null),[t==null?void 0:t.sample_size]),p=y.useMemo(()=>qu((n==null?void 0:n.sample_size)??null),[n==null?void 0:n.sample_size]),g=y.useMemo(()=>qu((s==null?void 0:s.sample_size)??null),[s==null?void 0:s.sample_size]),_=y.useMemo(()=>qu((i==null?void 0:i.sample_size)??null),[i==null?void 0:i.sample_size]);return{relativeGeneratedAt:l,relativeScalingGeneratedAt:c,relativeBinningGeneratedAt:u,relativeBinnedGeneratedAt:d,relativeOutlierGeneratedAt:f,scalingSampleSize:h,binningSampleSize:p,binnedSampleSize:g,outlierSampleSize:_}},hR=({isProfileLoading:e,isPreviewLoading:t,isFetchingScaling:n,isFetchingBinning:s,isFetchingHashEncoding:i,isFetchingBinnedDistribution:l,isFetchingRecommendations:c,catalogFlags:u})=>{const{isPreviewNode:d}=u,f=y.useMemo(()=>e||t||n||s||i||l||c,[l,s,i,n,c,t,e]),h=y.useMemo(()=>e?"Generating dataset profile":n?"Loading scaling insights":s?"Loading binning insights":i?"Loading hash encoding insights":l?"Computing binned distributions":c?"Fetching column recommendations":t?d?"Loading dataset preview":"Analyzing node outputs":null,[l,s,i,c,n,t,d,e]);return{hasActiveAsyncWork:f,busyLabel:h,footerBusyLabel:h??(f?"Processing":null)}},fR=({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:i,isProfileLoading:l,isPreviewLoading:c,isFetchingScaling:u,isFetchingBinning:d,isFetchingHashEncoding:f,isFetchingBinnedDistribution:h,isFetchingRecommendations:p,catalogFlags:g})=>{const _=mR({recommendationsGeneratedAt:e,scalingData:t,binningData:n,binnedDistributionData:s,outlierData:i}),N=hR({isProfileLoading:l,isPreviewLoading:c,isFetchingScaling:u,isFetchingBinning:d,isFetchingHashEncoding:f,isFetchingBinnedDistribution:h,isFetchingRecommendations:p,catalogFlags:g});return{insightSummaries:_,asyncBusyLabel:N}},pR=({graphSnapshot:e,nodeId:t,catalogFlags:n})=>{const{isDataset:s}=n,i=y.useMemo(()=>{if(!e)return null;const g=Array.isArray(e.nodes)?e.nodes:[],_=Array.isArray(e.edges)?e.edges:[];return{nodes:g,edges:_}},[e]),l=y.useMemo(()=>e&&Array.isArray(e.nodes)?e.nodes:[],[e]),c=y.useMemo(()=>e&&Array.isArray(e.edges)?e.edges:[],[e]),u=l.length,d=y.useMemo(()=>{if(!t||!c.length)return[];const g=new Set,_=[t];for(;_.length;){const v=_.pop();v&&c.forEach(x=>{const j=x&&typeof x.source=="string"?x.source.trim():"",k=x&&typeof x.target=="string"?x.target.trim():"";!j||!k||k===v&&!g.has(j)&&(g.add(j),_.push(j))})}const N=Array.from(g);return N.sort(),N},[c,t]),f=y.useMemo(()=>{var N,v,x,j,k;if(!d.length)return"";let g="",_="";for(const S of d){const C=l.find(E=>(E==null?void 0:E.id)===S);if(!C)continue;const w=String(((N=C==null?void 0:C.data)==null?void 0:N.catalogType)??"").toLowerCase().trim();if(w==="feature_target_split"){const E=(x=(v=C==null?void 0:C.data)==null?void 0:v.config)==null?void 0:x.target_column;typeof E=="string"&&E.trim()&&(g=E.trim())}else if(w==="train_test_split"){const E=(k=(j=C==null?void 0:C.data)==null?void 0:j.config)==null?void 0:k.target_column;typeof E=="string"&&E.trim()&&(_=E.trim())}}return g||_||""},[l,d]),h=y.useMemo(()=>{const g=new Set;return l.forEach(_=>{if(!_)return;const N=typeof _.id=="string"?_.id.trim():String((_==null?void 0:_.id)??"").trim();if(!N)return;const v=(_==null?void 0:_.data)??{};(N==="dataset-source"||(v==null?void 0:v.isDataset)===!0||(v==null?void 0:v.catalogType)==="dataset")&&g.add(N)}),g.size||g.add("dataset-source"),Array.from(g)},[l]),p=y.useMemo(()=>{if(!t)return!1;if(s)return!0;if(!c.length)return h.includes(t);const g=new Map;c.forEach(v=>{const x=v==null?void 0:v.source,j=v==null?void 0:v.target,k=typeof x=="string"?x.trim():String(x??"").trim(),S=typeof j=="string"?j.trim():String(j??"").trim();if(!k||!S)return;const C=g.get(k);C?C.push(S):g.set(k,[S])});const _=new Set,N=[...h];for(;N.length;){const v=N.pop();if(!v||_.has(v))continue;_.add(v);const x=g.get(v);x&&x.forEach(j=>{j&&!_.has(j)&&N.push(j)})}return _.has(t)},[h,c,s,t]);return{graphContext:i,graphNodes:l,graphEdges:c,graphNodeCount:u,upstreamNodeIds:d,upstreamTargetColumn:f,hasReachableSource:p}},gR=({configState:e,setConfigState:t,catalogFlags:n,upstreamTargetColumn:s,nodeId:i,modelTypeOptions:l})=>{const{isFeatureTargetSplitNode:c,isTrainTestSplitNode:u,isTrainModelDraftNode:d,isHyperparameterTuningNode:f,isClassOversamplingNode:h,isClassUndersamplingNode:p}=n,g=p||h,_=d||f,N=y.useMemo(()=>{if(!c)return null;const P=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",T=We(e==null?void 0:e.feature_columns).map(O=>typeof O=="string"?O.trim():"").filter(O=>!!O);return{targetColumn:P,featureColumns:T}},[e==null?void 0:e.feature_columns,e==null?void 0:e.target_column,c]),v=y.useMemo(()=>{if(!u)return null;const P=typeof(e==null?void 0:e.test_size)=="number"?e.test_size:.2,T=typeof(e==null?void 0:e.validation_size)=="number"?e.validation_size:0,O=typeof(e==null?void 0:e.random_state)=="number"?e.random_state:42,F=typeof(e==null?void 0:e.shuffle)=="boolean"?e.shuffle:!0,B=typeof(e==null?void 0:e.stratify)=="boolean"?e.stratify:!1,L=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"";return{test_size:P,validation_size:T,random_state:O,shuffle:F,stratify:B,target_column:L}},[e==null?void 0:e.random_state,e==null?void 0:e.shuffle,e==null?void 0:e.stratify,e==null?void 0:e.target_column,e==null?void 0:e.test_size,e==null?void 0:e.validation_size,u]),x=y.useMemo(()=>{if(!g)return null;const P=typeof(e==null?void 0:e.method)=="string"?e.method.trim():"",T=typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",O=e==null?void 0:e.sampling_strategy;let F=null;if(typeof O=="number"&&Number.isFinite(O))F=O;else if(typeof O=="string"){const Y=O.trim();F=Y||null}else O===null&&(F=null);const B=e==null?void 0:e.random_state;let L=null;if(typeof B=="number"&&Number.isFinite(B))L=B;else if(typeof B=="string"){const Y=Number(B);L=Number.isFinite(Y)?Y:null}let D=null;if(p){const Y=e==null?void 0:e.replacement;D=typeof Y=="boolean"?Y:typeof Y=="string"?Y.trim().toLowerCase()==="true":!!Y}let q=null;if(h){const Y=e==null?void 0:e.k_neighbors;if(typeof Y=="number"&&Number.isFinite(Y))q=Math.max(1,Math.round(Y));else if(typeof Y=="string"){const W=Number(Y);Number.isFinite(W)&&(q=Math.max(1,Math.round(W)))}}return{method:P,targetColumn:T,samplingStrategy:F,randomState:L,replacement:D,kNeighbors:q}},[e==null?void 0:e.k_neighbors,e==null?void 0:e.method,e==null?void 0:e.random_state,e==null?void 0:e.replacement,e==null?void 0:e.sampling_strategy,e==null?void 0:e.target_column,h,g,p]),j=typeof(e==null?void 0:e.problem_type)=="string"?e.problem_type.trim().toLowerCase():"",k=j==="regression"?"regression":"classification",S=y.useMemo(()=>Array.isArray(l)?l.filter(P=>P&&typeof P.value=="string"):[],[l]),C=y.useMemo(()=>{const P={classification:[],regression:[]};return S.forEach(T=>{var F;const O=String(((F=T==null?void 0:T.metadata)==null?void 0:F.problem_type)??"").trim().toLowerCase();O==="regression"?P.regression.push(T):O==="classification"?P.classification.push(T):(P.classification.push(T),P.regression.push(T))}),P},[S]),w=y.useMemo(()=>{if(!S.length)return[];const P=k==="regression"?C.regression:C.classification;return P.length>0?P:S},[S,C,k]),E=y.useMemo(()=>_?{targetColumn:typeof(e==null?void 0:e.target_column)=="string"?e.target_column.trim():"",problemType:k}:null,[e==null?void 0:e.target_column,_,k]),A=y.useMemo(()=>{if(!_)return{enabled:!1,strategy:"auto",folds:5,shuffle:!0,randomState:42,refitStrategy:"train_plus_validation"};const P=(e==null?void 0:e.cv_enabled)===void 0?!!f:!!e.cv_enabled,T=typeof(e==null?void 0:e.cv_strategy)=="string"?e.cv_strategy.trim().toLowerCase():"auto",O=["auto","kfold","stratified_kfold"].includes(T)?T:"auto",F=Number(e==null?void 0:e.cv_folds),B=Number.isFinite(F)&&F>=2?Math.floor(F):5,L=(e==null?void 0:e.cv_shuffle)===void 0?!0:!!e.cv_shuffle;let D=null;if(typeof(e==null?void 0:e.cv_random_state)=="number"&&Number.isFinite(e.cv_random_state))D=Math.trunc(e.cv_random_state);else if(typeof(e==null?void 0:e.cv_random_state)=="string"){const W=Number(e.cv_random_state.trim());D=Number.isFinite(W)?Math.trunc(W):null}const Y=(typeof(e==null?void 0:e.cv_refit_strategy)=="string"?e.cv_refit_strategy.trim().toLowerCase():"train_plus_validation")==="train_only"?"train_only":"train_plus_validation";return{enabled:P,strategy:O,folds:B,shuffle:L,randomState:D,refitStrategy:Y}},[e==null?void 0:e.cv_enabled,e==null?void 0:e.cv_folds,e==null?void 0:e.cv_random_state,e==null?void 0:e.cv_refit_strategy,e==null?void 0:e.cv_shuffle,e==null?void 0:e.cv_strategy,f,_]);y.useEffect(()=>{_&&j!==k&&t(P=>({...P,problem_type:k}))},[_,k,j,t]),y.useEffect(()=>{var F;if(!_||!w.length)return;const P=new Set(w.map(B=>B.value)),T=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"";if(T&&P.has(T))return;const O=((F=w[0])==null?void 0:F.value)??"";O&&t(B=>{const L=typeof(B==null?void 0:B.model_type)=="string"?B.model_type.trim():"";return L&&P.has(L)||L===O?B:{...B,model_type:O}})},[e==null?void 0:e.model_type,w,_,t]);const R=y.useMemo(()=>{if(!_)return null;const P=typeof(e==null?void 0:e.model_type)=="string"?e.model_type.trim():"",T=e==null?void 0:e.hyperparameters;let O=null,F=null;if(T&&typeof T=="string"){const B=T.trim();if(B.length)try{const L=JSON.parse(B);L&&typeof L=="object"&&!Array.isArray(L)?O=L:F="Hyperparameters JSON must be an object."}catch{F="Hyperparameters JSON is invalid. Provide a valid JSON object."}}else T&&typeof T=="object"&&!Array.isArray(T)&&(O=T);return{modelType:P||null,hyperparameters:O,hyperparametersError:F}},[e==null?void 0:e.hyperparameters,e==null?void 0:e.model_type,_]);return y.useEffect(()=>{(u||d||f)&&s&&(u&&(e==null?void 0:e.stratify)!==!0||t(P=>(typeof(P==null?void 0:P.target_column)=="string"?P.target_column.trim():"")?P:{...P,target_column:s}))},[e==null?void 0:e.stratify,f,d,u,i,t,s]),{featureTargetSplitConfig:N,trainTestSplitConfig:v,resamplingConfig:x,trainModelDraftConfig:E,trainModelRuntimeConfig:R,trainModelCVConfig:A,filteredModelTypeOptions:w}},_R=({nodeId:e,sourceId:t,configState:n,upstreamNodeIds:s,graphNodes:i})=>{const l=y.useMemo(()=>{if(!s.length)return{};const u={};return s.forEach(d=>{var p;const f=i.find(g=>g&&typeof g.id=="string"&&g.id===d);if(!f)return;const h=((p=f==null?void 0:f.data)==null?void 0:p.config)??null;u[d]=h}),u},[i,s]),c=y.useMemo(()=>ql({sourceId:t??null,nodeId:e||null,config:n,upstreamIds:s,upstreamConfig:l}),[n,e,t,l,s]);return{upstreamConfigFingerprints:l,previewSignature:c}},vR=({cachedPreviewSchema:e,catalogFlags:t,resamplingTargetColumn:n,imputerStrategies:s})=>{const{isClassOversamplingNode:i,isImputerNode:l}=t,c=y.useMemo(()=>(e==null?void 0:e.columns)??[],[e]),u=y.useMemo(()=>{if(!i||!c.length||!n)return null;const h=new Set(["numeric","integer","boolean"]),p=c.filter(g=>g&&g.name!==n).filter(g=>!h.has(String(g.logical_family??"unknown"))).map(g=>({name:g.name,logical_family:String(g.logical_family??"unknown")}));return p.length?{blocked:!0,message:"Class oversampling requires numeric feature columns. Encode or cast the listed fields before refreshing the preview.",columns:p.map(g=>g.name),details:p}:null},[c,i,n]),d=y.useMemo(()=>{if(!l||!c.length||!s.length)return null;const h=new Set(["numeric","integer"]),p=new Map(c.map(_=>[_.name,_])),g=[];return s.forEach((_,N)=>{if(!Ay(_.method)||!Array.isArray(_.columns)||!_.columns.length)return;const v=_.columns.map(x=>p.get(x)).filter(x=>!!x).filter(x=>!h.has(String(x.logical_family??"unknown"))).map(x=>({name:x.name,logical_family:String(x.logical_family??"unknown")}));v.length&&g.push({index:N,columns:v.map(x=>x.name),details:v})}),g.length?{blocked:!0,message:"Numeric imputation methods can only target numeric columns. Recast or adjust the highlighted fields before running the preview.",entries:g}:null},[c,s,l]),f=!!(u!=null&&u.blocked||d!=null&&d.blocked);return{cachedSchemaColumns:c,oversamplingSchemaGuard:u,imputationSchemaDiagnostics:d,skipPreview:f}},yR=(e,t,n,s,i)=>{e([]),t({}),n({}),s({}),i("")},bR=({requiresColumnCatalog:e,catalogFlags:t,nodeId:n,sourceId:s,hasReachableSource:i})=>{const{isImputerNode:l}=t,[c,u]=y.useState([]),[d,f]=y.useState(""),[h,p]=y.useState({}),[g,_]=y.useState({}),[N,v]=y.useState({}),[x,j]=y.useState(0);return y.useEffect(()=>{!e&&!l||s&&i||yR(u,p,_,v,f)},[i,l,e,s]),y.useEffect(()=>{j(0)},[l,n]),{availableColumns:c,setAvailableColumns:u,columnSearch:d,setColumnSearch:f,columnMissingMap:h,setColumnMissingMap:p,columnTypeMap:g,setColumnTypeMap:_,columnSuggestions:N,setColumnSuggestions:v,imputerMissingFilter:x,setImputerMissingFilter:j}},xR=({graphSnapshot:e,nodeId:t,catalogFlags:n,configState:s,setConfigState:i,nodeParams:l,sourceId:c,requiresColumnCatalog:u,imputerStrategies:d})=>{var w;const f=pR({graphSnapshot:e,nodeId:t,catalogFlags:n}),{graphNodes:h,upstreamNodeIds:p,upstreamTargetColumn:g,hasReachableSource:_}=f,N=gR({configState:s,setConfigState:i,catalogFlags:n,upstreamTargetColumn:g,nodeId:t,modelTypeOptions:((w=l.trainModel.modelType)==null?void 0:w.options)??null}),{resamplingConfig:v}=N,x=_R({nodeId:t,sourceId:c,configState:s,upstreamNodeIds:p,graphNodes:h}),[j,k]=y.useState(null),S=vR({cachedPreviewSchema:j,catalogFlags:n,resamplingTargetColumn:(v==null?void 0:v.targetColumn)??null,imputerStrategies:d}),C=bR({requiresColumnCatalog:u,catalogFlags:n,nodeId:t,sourceId:c,hasReachableSource:_});return{graphTopology:f,modelingConfig:N,previewSignatureResult:x,cachedPreviewSchema:j,setCachedPreviewSchema:k,schemaDiagnostics:S,columnCatalogState:C}},wR=e=>{const t=y.useMemo(()=>{var i,l,c,u,d,f;const s=[];return(i=e==null?void 0:e.data)!=null&&i.label&&s.push({label:"Label",value:String(e.data.label)}),(l=e==null?void 0:e.data)!=null&&l.description&&s.push({label:"Description",value:String(e.data.description)}),(c=e==null?void 0:e.data)!=null&&c.category&&s.push({label:"Category",value:String(e.data.category)}),(u=e==null?void 0:e.data)!=null&&u.catalogType&&s.push({label:"Node type",value:String(e.data.catalogType)}),(d=e==null?void 0:e.data)!=null&&d.inputs&&Array.isArray(e.data.inputs)&&e.data.inputs.length&&s.push({label:"Inputs",value:e.data.inputs.join(", ")}),(f=e==null?void 0:e.data)!=null&&f.outputs&&Array.isArray(e.data.outputs)&&e.data.outputs.length&&s.push({label:"Outputs",value:e.data.outputs.join(", ")}),s},[e]),n=y.useMemo(()=>{var i;const s=((i=e==null?void 0:e.data)==null?void 0:i.label)??(e==null?void 0:e.id);return typeof s=="string"&&s.trim()?s:`Node ${(e==null?void 0:e.id)??""}`},[e]);return{metadata:t,title:n}},Tx=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},NR=(e,t)=>{var _;const n=typeof(e==null?void 0:e.id)=="string"?e.id:"",s=y.useMemo(()=>{var x;const N=(x=e==null?void 0:e.data)==null?void 0:x.connectionInfo;if(!N)return null;const v=j=>Array.isArray(j)?j.map(k=>({...k})):[];return{inputs:v(N.inputs),outputs:v(N.outputs)}},[e]),i=y.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const N=t.edges.filter(v=>(v==null?void 0:v.target)===n).map(v=>Tx(n,v==null?void 0:v.targetHandle)).filter(v=>!!v);return new Set(N)},[t,n]),l=y.useMemo(()=>{if(!n||!t||!Array.isArray(t.edges))return new Set;const N=t.edges.filter(v=>(v==null?void 0:v.source)===n).map(v=>Tx(n,v==null?void 0:v.sourceHandle)).filter(v=>!!v);return new Set(N)},[t,n]),c=((_=e==null?void 0:e.data)==null?void 0:_.hasRequiredConnections)!==!1,u=y.useMemo(()=>{var N;return(N=s==null?void 0:s.inputs)!=null&&N.length?s.inputs.filter(v=>v.required!==!1):[]},[s==null?void 0:s.inputs]),d=y.useMemo(()=>u.length?u.filter(N=>!i.has(N.key)):[],[i,u]),f=c&&d.length===0,h=y.useMemo(()=>{if(!f)return{opacity:.45,pointerEvents:"none",userSelect:"none"}},[f]),p=f?void 0:!0,g=y.useMemo(()=>{if(!(s!=null&&s.inputs)||s.inputs.length===0)return;let N=!1;const v={};return s.inputs.forEach(x=>{if(!Array.isArray(x.accepts)||x.accepts.length===0)return;const j=i.has(x.key);x.accepts.forEach(k=>{(k==="train"||k==="validation"||k==="test")&&(v[k]=j,N=!0)})}),N?v:void 0},[s==null?void 0:s.inputs,i]);return{connectionInfo:s,connectedHandleKeys:i,connectedOutputHandleKeys:l,evaluationSplitConnectivity:g,connectionReady:f,gatedSectionStyle:h,gatedAriaDisabled:p}},jR=e=>{var t;return!!((t=e==null?void 0:e.data)!=null&&t.isDataset||(e==null?void 0:e.id)==="dataset-source")},CR=new Set(["binned_distribution","data_preview","outlier_monitor","skewness_distribution","dataset_profile","transformer_audit"]),SR=new Set(["trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix"]),ER=e=>{var n;const t=((n=e==null?void 0:e.data)==null?void 0:n.catalogType)??"";return y.useMemo(()=>{const s=jR(e),i=t==="data_preview",l=t==="dataset_profile",c=t==="imputation_methods"||t==="advanced_imputer"||t==="simple_imputer",u=t==="missing_value_indicator",d=t==="replace_aliases_typos",f=t==="trim_whitespace",h=t==="remove_special_characters",p=t==="replace_invalid_values",g=t==="regex_replace_fix",_=t==="normalize_text_case",N=t==="standardize_date_formats",v=t==="label_encoding",x=t==="target_encoding",j=t==="hash_encoding",k=t==="train_model_draft",S=t==="model_evaluation",C=t==="model_registry_overview",w=t==="hyperparameter_tuning",E=t==="feature_target_split",A=t==="train_test_split",R=t==="class_undersampling",P=t==="class_oversampling",T=t==="ordinal_encoding",O=t==="dummy_encoding",F=t==="one_hot_encoding",B=t==="feature_math",L=t==="cast_column_types",D=t==="binning_discretization",q=t==="scale_numeric_features",Y=t==="polynomial_features",W=t==="feature_selection",X=t==="transformer_audit",I=t==="outlier_removal",z=t==="skewness_transform",H=t==="skewness_distribution",te=t==="binned_distribution",K=SR.has(t),V=CR.has(t),G=t==="remove_duplicates",Q=t==="drop_missing_columns",ne=t==="drop_missing_rows";return{catalogType:t,isDataset:s,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:f,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:p,isRegexCleanupNode:g,isNormalizeTextCaseNode:_,isStandardizeDatesNode:N,isLabelEncodingNode:v,isTargetEncodingNode:x,isHashEncodingNode:j,isTrainModelDraftNode:k,isModelEvaluationNode:S,isModelRegistryNode:C,isHyperparameterTuningNode:w,isFeatureTargetSplitNode:E,isTrainTestSplitNode:A,isClassUndersamplingNode:R,isClassOversamplingNode:P,isOrdinalEncodingNode:T,isDummyEncodingNode:O,isOneHotEncodingNode:F,isFeatureMathNode:B,isCastNode:L,isBinningNode:D,isScalingNode:q,isPolynomialFeaturesNode:Y,isFeatureSelectionNode:W,isTransformerAuditNode:X,isOutlierNode:I,isSkewnessNode:z,isSkewnessDistributionNode:H,isBinnedDistributionNode:te,isDataConsistencyNode:K,isInspectionNode:V,isRemoveDuplicatesNode:G,isDropMissingColumnsNode:Q,isDropMissingRowsNode:ne,isDropMissingNode:Q||ne,isPreviewNode:i,isDatasetProfileNode:l}},[t,e])},kR=e=>y.useMemo(()=>{const t=new Map;return e.forEach(n=>{n!=null&&n.name&&t.set(n.name,n)}),n=>t.get(n)??null},[e]),MR=e=>{const t=y.useMemo(()=>{var u;const c=(u=e==null?void 0:e.data)==null?void 0:u.parameters;return Array.isArray(c)?c.filter(d=>!!(d!=null&&d.name)).map(d=>({...d})):[]},[e]),n=kR(t),s=y.useCallback((c,u)=>c?n(u):null,[n]),i=y.useMemo(()=>t.some(c=>{var u;return(c==null?void 0:c.type)==="multi_select"&&((u=c==null?void 0:c.source)==null?void 0:u.type)!=="drop_column_recommendations"}),[t]),l=y.useMemo(()=>t.find(c=>{var u;return((u=c==null?void 0:c.source)==null?void 0:u.type)==="drop_column_recommendations"})??null,[t]);return{parameters:t,getParameter:n,getParameterIf:s,requiresColumnCatalog:i,dropColumnParameter:l}},AR=({isResetAvailable:e=!1,defaultConfigTemplate:t,catalogFlags:n})=>{const{isDataset:s,isScalingNode:i,isBinningNode:l,isBinnedDistributionNode:c,isSkewnessDistributionNode:u,isFeatureMathNode:d,isFeatureTargetSplitNode:f,isTrainTestSplitNode:h,isModelEvaluationNode:p,isHashEncodingNode:g,isPolynomialFeaturesNode:_,isFeatureSelectionNode:N,isDataConsistencyNode:v,isTrainModelDraftNode:x,isHyperparameterTuningNode:j,isClassUndersamplingNode:k,isClassOversamplingNode:S,isLabelEncodingNode:C,isTargetEncodingNode:w,isDummyEncodingNode:E,isOneHotEncodingNode:A,isOrdinalEncodingNode:R,isImputerNode:P,isMissingIndicatorNode:T,isReplaceAliasesNode:O,isTrimWhitespaceNode:F,isRemoveSpecialCharsNode:B,isReplaceInvalidValuesNode:L,isRegexCleanupNode:D,isNormalizeTextCaseNode:q,isStandardizeDatesNode:Y,isCastNode:W,isRemoveDuplicatesNode:X,isDropMissingNode:I,isOutlierNode:z}=n,H=y.useMemo(()=>!!(e&&!s&&t),[t,s,e]),V=[d,f,h,p,g,_,N,v,x,j,k||S,C,w,E,A,R,P,T,O,F,B,L,D,q,Y,W,X,I,z].some(Boolean),G=c||u;return{canResetNode:H,headerCanResetNode:H&&!(G||i||l||V),footerCanResetNode:H&&!G}},OR=({node:e})=>{var p;const t=typeof(e==null?void 0:e.id)=="string"?e.id:void 0,n=y.useMemo(()=>{var _;const g=Lh(((_=e==null?void 0:e.data)==null?void 0:_.config)??{});return!g||typeof g!="object"||Array.isArray(g)?{}:((!g.column_overrides||typeof g.column_overrides!="object"||Array.isArray(g.column_overrides))&&(g.column_overrides={}),g)},[e==null?void 0:e.id,(p=e==null?void 0:e.data)==null?void 0:p.config]),[s,i]=y.useState(n),[l,c]=y.useState(0),u=y.useRef(t);y.useEffect(()=>{u.current!==t&&(u.current=t,i(n),c(g=>g+1))},[t]);const d=y.useMemo(()=>ql(n),[n]),f=y.useMemo(()=>ql(s),[s]),h=y.useCallback(()=>{i(n)},[n]);return{initialConfig:n,configState:s,setConfigState:i,stableInitialConfig:d,stableCurrentConfig:f,nodeChangeVersion:l,resetToInitialConfig:h}},TR=({setConfigState:e})=>{const t=y.useCallback((c,u)=>{c&&e(d=>{const f={...d};return u===void 0?delete f[c]:f[c]=u,f})},[e]),n=y.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);Number.isNaN(d)||t(c,d)},[t]),s=y.useCallback((c,u)=>{if(!c)return;if(u===""){t(c,void 0);return}const d=Number(u);if(!Number.isFinite(d))return;const f=Math.min(Math.max(d,0),100);t(c,f)},[t]),i=y.useCallback((c,u)=>{t(c,u)},[t]),l=y.useCallback((c,u)=>{t(c,u)},[t]);return{handleParameterChange:t,handleNumberChange:n,handlePercentileChange:s,handleBooleanChange:i,handleTextChange:l}},$R=(e,t)=>{const n=(s,i)=>s?e(i):null;return y.useMemo(()=>{const{isBinningNode:s,isScalingNode:i,isRemoveDuplicatesNode:l,isReplaceAliasesNode:c,isTrimWhitespaceNode:u,isRemoveSpecialCharsNode:d,isReplaceInvalidValuesNode:f,isRegexCleanupNode:h,isNormalizeTextCaseNode:p,isLabelEncodingNode:g,isHashEncodingNode:_,isPolynomialFeaturesNode:N,isFeatureSelectionNode:v,isFeatureMathNode:x,isClassUndersamplingNode:j,isClassOversamplingNode:k,isFeatureTargetSplitNode:S,isTrainModelDraftNode:C,isHyperparameterTuningNode:w,isTargetEncodingNode:E,isOrdinalEncodingNode:A,isDummyEncodingNode:R,isOneHotEncodingNode:P,isMissingIndicatorNode:T,isDropMissingRowsNode:O,isDropMissingColumnsNode:F}=t,B=j||k,L=C||w;return{binning:{columns:n(s,"columns")},scaling:{columns:n(i,"columns"),defaultMethod:n(i,"default_method"),autoDetect:n(i,"auto_detect")},removeDuplicates:{columns:n(l,"columns"),keep:n(l,"keep")},replaceAliases:{customPairs:n(c,"custom_pairs")},trimWhitespace:{columns:n(u,"columns"),mode:n(u,"mode")},removeSpecial:{columns:n(d,"columns"),mode:n(d,"mode"),replacement:n(d,"replacement")},replaceInvalid:{columns:n(f,"columns"),mode:n(f,"mode"),minValue:n(f,"min_value"),maxValue:n(f,"max_value")},regexCleanup:{columns:n(h,"columns"),mode:n(h,"mode"),pattern:n(h,"pattern"),replacement:n(h,"replacement")},normalizeCase:{columns:n(p,"columns"),mode:n(p,"mode")},labelEncoding:{columns:g?e("columns"):null,autoDetect:g?e("auto_detect"):null,maxUnique:g?e("max_unique_values"):null,outputSuffix:g?e("output_suffix"):null,dropOriginal:g?e("drop_original"):null,missingStrategy:g?e("missing_strategy"):null,missingCode:g?e("missing_code"):null},hashEncoding:{columns:_?e("columns"):null,autoDetect:_?e("auto_detect"):null,maxCategories:_?e("max_categories"):null,buckets:_?e("n_buckets"):null,outputSuffix:_?e("output_suffix"):null,dropOriginal:_?e("drop_original"):null,encodeMissing:_?e("encode_missing"):null},polynomial:{columns:n(N,"columns"),autoDetect:n(N,"auto_detect"),degree:n(N,"degree"),includeBias:n(N,"include_bias"),interactionOnly:n(N,"interaction_only"),includeInputFeatures:n(N,"include_input_features"),outputPrefix:n(N,"output_prefix")},featureSelection:{columns:n(v,"columns"),autoDetect:n(v,"auto_detect"),targetColumn:n(v,"target_column"),method:n(v,"method"),scoreFunc:n(v,"score_func"),problemType:n(v,"problem_type"),k:n(v,"k"),percentile:n(v,"percentile"),alpha:n(v,"alpha"),threshold:n(v,"threshold"),mode:n(v,"mode"),estimator:n(v,"estimator"),step:n(v,"step"),minFeatures:n(v,"min_features"),maxFeatures:n(v,"max_features"),dropUnselected:n(v,"drop_unselected")},featureMath:{errorHandling:n(x,"error_handling"),allowOverwrite:n(x,"allow_overwrite"),defaultTimezone:n(x,"default_timezone"),epsilon:n(x,"epsilon")},resampling:{method:n(B,"method"),targetColumn:n(B,"target_column"),samplingStrategy:n(B,"sampling_strategy"),randomState:n(B,"random_state"),kNeighbors:n(k,"k_neighbors"),replacement:n(j,"replacement")},featureTargetSplit:{targetColumn:n(S,"target_column")},trainModel:{targetColumn:n(L,"target_column"),problemType:n(L,"problem_type"),modelType:n(L,"model_type"),hyperparameters:n(C,"hyperparameters"),cvEnabled:n(L,"cv_enabled"),cvStrategy:n(L,"cv_strategy"),cvFolds:n(L,"cv_folds"),cvShuffle:n(L,"cv_shuffle"),cvRandomState:n(L,"cv_random_state"),cvRefitStrategy:n(C,"cv_refit_strategy")},hyperparameterTuning:{searchStrategy:n(w,"search_strategy"),searchIterations:n(w,"search_iterations"),searchRandomState:n(w,"search_random_state"),scoringMetric:n(w,"scoring_metric")},targetEncoding:{columns:E?e("columns"):null,targetColumn:E?e("target_column"):null,autoDetect:E?e("auto_detect"):null,maxCategories:E?e("max_categories"):null,outputSuffix:E?e("output_suffix"):null,dropOriginal:E?e("drop_original"):null,smoothing:E?e("smoothing"):null,encodeMissing:E?e("encode_missing"):null,handleUnknown:E?e("handle_unknown"):null},ordinalEncoding:{columns:A?e("columns"):null,autoDetect:A?e("auto_detect"):null,maxCategories:A?e("max_categories"):null,outputSuffix:A?e("output_suffix"):null,dropOriginal:A?e("drop_original"):null,encodeMissing:A?e("encode_missing"):null,handleUnknown:A?e("handle_unknown"):null,unknownValue:A?e("unknown_value"):null},dummyEncoding:{columns:R?e("columns"):null,autoDetect:R?e("auto_detect"):null,maxCategories:R?e("max_categories"):null,dropFirst:R?e("drop_first"):null,includeMissing:R?e("include_missing"):null,dropOriginal:R?e("drop_original"):null,prefixSeparator:R?e("prefix_separator"):null},oneHotEncoding:{columns:P?e("columns"):null,autoDetect:P?e("auto_detect"):null,maxCategories:P?e("max_categories"):null,dropFirst:P?e("drop_first"):null,includeMissing:P?e("include_missing"):null,dropOriginal:P?e("drop_original"):null,prefixSeparator:P?e("prefix_separator"):null},missingIndicator:{columns:n(T,"columns"),suffix:n(T,"flag_suffix")},dropRows:{any:n(O,"drop_if_any_missing")},dropMissing:{threshold:n(F||O,"missing_threshold")}}},[t,e])},PR=(e,t)=>{const{isBinningNode:n,isCastNode:s,isDropMissingColumnsNode:i,isDropMissingRowsNode:l,isImputerNode:c,isMissingIndicatorNode:u,isReplaceAliasesNode:d,isTrimWhitespaceNode:f,isRemoveSpecialCharsNode:h,isReplaceInvalidValuesNode:p,isRegexCleanupNode:g,isNormalizeTextCaseNode:_,isStandardizeDatesNode:N,isScalingNode:v,isClassUndersamplingNode:x,isClassOversamplingNode:j,isTrainModelDraftNode:k,isLabelEncodingNode:S,isOrdinalEncodingNode:C,isDummyEncodingNode:w,isOneHotEncodingNode:E,isRemoveDuplicatesNode:A,isSkewnessNode:R,isFeatureTargetSplitNode:P}=t;return y.useMemo(()=>{let T=e;return T=T.filter(O=>{var F;return((F=O==null?void 0:O.source)==null?void 0:F.type)!=="drop_column_recommendations"}),(i||l)&&(T=T.filter(O=>O.name!=="missing_threshold")),l&&(T=T.filter(O=>O.name!=="drop_if_any_missing")),c&&(T=T.filter(O=>O.name!=="strategies")),R&&(T=T.filter(O=>O.name!=="transformations")),s&&(T=T.filter(O=>O.name!=="columns")),n&&(T=T.filter(O=>O.name!=="columns")),v&&(T=T.filter(O=>!["columns","default_method","auto_detect"].includes(O.name))),A&&(T=T.filter(O=>O.name!=="columns"&&O.name!=="keep")),u&&(T=T.filter(O=>O.name!=="columns"&&O.name!=="flag_suffix")),d&&(T=T.filter(O=>!["columns","mode","custom_pairs"].includes(O.name))),f&&(T=T.filter(O=>!["columns","mode"].includes(O.name))),h&&(T=T.filter(O=>!["columns","mode","replacement"].includes(O.name))),p&&(T=T.filter(O=>!["columns","mode","min_value","max_value"].includes(O.name))),g&&(T=T.filter(O=>!["columns","mode","pattern","replacement"].includes(O.name))),_&&(T=T.filter(O=>!["columns","mode"].includes(O.name))),N&&(T=T.filter(O=>!["columns","mode"].includes(O.name))),x&&(T=T.filter(O=>!["method","target_column","sampling_strategy","random_state","replacement"].includes(O.name))),j&&(T=T.filter(O=>!["method","target_column","sampling_strategy","random_state"].includes(O.name))),k&&(T=T.filter(O=>!["target_column","problem_type","cv_enabled","cv_strategy","cv_folds","cv_shuffle","cv_random_state","cv_refit_strategy"].includes(O.name))),P&&(T=T.filter(O=>O.name!=="target_column")),S&&(T=T.filter(O=>!["columns","auto_detect","max_unique_values","output_suffix","drop_original","missing_strategy","missing_code"].includes(O.name))),C&&(T=T.filter(O=>!["columns","auto_detect","max_categories","output_suffix","drop_original","encode_missing","handle_unknown","unknown_value"].includes(O.name))),w&&(T=T.filter(O=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(O.name))),E&&(T=T.filter(O=>!["columns","auto_detect","max_categories","drop_first","include_missing","drop_original","prefix_separator"].includes(O.name))),T},[e,n,s,i,l,c,u,d,f,h,p,g,_,N,v,x,j,k,S,C,w,E,A,R,P])},RR=e=>{const t=y.useMemo(()=>lM,[]),n=y.useMemo(()=>t.map(l=>l.value),[t]),s=y.useMemo(()=>Ty(e==null?void 0:e.strategies,n),[e==null?void 0:e.strategies,n]),i=s.length;return{imputationMethodOptions:t,imputationMethodValues:n,imputerStrategies:s,imputerStrategyCount:i}},LR=(e,t)=>{const n=y.useMemo(()=>wh($y(e==null?void 0:e.transformations)),[e==null?void 0:e.transformations]),s=y.useCallback(i=>{t(l=>{const c=wh($y(l==null?void 0:l.transformations)),u=wh(i(c));return{...l,transformations:u.map(d=>({...d}))}})},[t]);return{skewnessTransformations:n,updateSkewnessTransformations:s}},zR={trim_whitespace:{title:"Use after Dataset snapshot or Missing indicator nodes",body:"Great for cleaning string columns before alias replacement or case normalization. Auto-detects text columns when left blank."},normalize_text_case:{title:"Use after trimming and alias cleanup",body:"Keeps categorical values consistent for joins and grouping. Pair with Dataset profile or Preview to confirm column impacts."},replace_aliases_typos:{title:"Requires Dataset profile insights",body:"Apply after profiling so you can confirm value distributions. Combine with custom pairs to align business-specific labels."},standardize_date_formats:{title:"Run after parsing-friendly nodes",body:"Normalizes mixed date strings into the format you choose. Works best once whitespace and punctuation cleanup nodes have run."},remove_special_characters:{title:"Pair with Trim whitespace or Regex cleanup",body:"Strips punctuation or noise from text fields before alias grouping. Preview to ensure replacements retain the intent of each field."},replace_invalid_values:{title:"Use after Outlier diagnostics or Dataset profile",body:"Flags negative, zero, or out-of-range numeric placeholders and converts them to missing for downstream handling."},regex_replace_fix:{title:"Configure after reviewing Dataset snapshot",body:"Use presets for quick fixes or supply a custom regex. Ideal before date standardization or alias cleanup passes."}},DR=({node:e,graphSnapshot:t,isResetAvailable:n,defaultConfigTemplate:s})=>{const{metadata:i,title:l}=wR(e),c=NR(e,t),u=ER(e),{catalogType:d,isDataset:f,isClassUndersamplingNode:h,isClassOversamplingNode:p,isDataConsistencyNode:g,isSkewnessNode:_,isSkewnessDistributionNode:N}=u,v=f,x=h||p,{parameters:j,getParameter:k,requiresColumnCatalog:S,dropColumnParameter:C}=MR(e),w=y.useMemo(()=>zR[d]??null,[d]),E=typeof(e==null?void 0:e.id)=="string"?e.id:"",A=AR({isResetAvailable:n,defaultConfigTemplate:s,catalogFlags:u}),R=$R(k,u),P=PR(j,u),T=y.useMemo(()=>g?P:[],[P,g]),O=_||N,F=OR({node:e}),{setConfigState:B,configState:L}=F,D=TR({setConfigState:B}),q=RR(L),Y=LR(L,B);return{metadata:i,title:l,connectionReadiness:c,catalogFlags:u,datasetBadge:v,isClassResamplingNode:x,parameters:j,getParameter:k,requiresColumnCatalog:S,dropColumnParameter:C,dataConsistencyHint:w,nodeId:E,resetPermissions:A,nodeParams:R,filteredParameters:P,dataConsistencyParameters:T,shouldLoadSkewnessInsights:O,configStateResult:F,parameterHandlers:D,imputationStrategiesResult:q,skewnessStateResult:Y}},FR=({node:e,onClose:t,onUpdateConfig:n,onUpdateNodeData:s,sourceId:i,graphSnapshot:l,onResetConfig:c,defaultConfigTemplate:u,isResetAvailable:d=!1})=>{var Tn,Xn,Rr;const{metadata:f,title:h,connectionReadiness:p,catalogFlags:g,datasetBadge:_,isClassResamplingNode:N,parameters:v,requiresColumnCatalog:x,dropColumnParameter:j,dataConsistencyHint:k,nodeId:S,resetPermissions:C,nodeParams:w,dataConsistencyParameters:E,configStateResult:A,parameterHandlers:R,imputationStrategiesResult:P,skewnessStateResult:T}=DR({node:e,graphSnapshot:l??null,isResetAvailable:d,defaultConfigTemplate:u}),{connectionInfo:O,connectedHandleKeys:F,connectedOutputHandleKeys:B,evaluationSplitConnectivity:L,connectionReady:D,gatedSectionStyle:q,gatedAriaDisabled:Y}=p,{catalogType:W,isDataset:X,isImputerNode:I,isMissingIndicatorNode:z,isReplaceAliasesNode:H,isTrimWhitespaceNode:te,isRemoveSpecialCharsNode:K,isReplaceInvalidValuesNode:V,isRegexCleanupNode:G,isNormalizeTextCaseNode:Q,isStandardizeDatesNode:ne,isLabelEncodingNode:J,isTargetEncodingNode:re,isHashEncodingNode:Se,isFeatureTargetSplitNode:Re,isTrainTestSplitNode:Oe,isTrainModelDraftNode:Fe,isModelEvaluationNode:lt,isModelRegistryNode:Be,isHyperparameterTuningNode:de,isClassUndersamplingNode:pe,isClassOversamplingNode:xe,isOrdinalEncodingNode:ke,isDummyEncodingNode:Ue,isOneHotEncodingNode:ce,isFeatureMathNode:Me,isCastNode:Ye,isBinningNode:at,isScalingNode:Ze,isPolynomialFeaturesNode:_t,isFeatureSelectionNode:st,isTransformerAuditNode:dt,isOutlierNode:jt,isSkewnessNode:zt,isSkewnessDistributionNode:Ge,isBinnedDistributionNode:Ft,isDataConsistencyNode:Kt,isInspectionNode:Mt,isRemoveDuplicatesNode:tn,isDropMissingColumnsNode:Sn,isDropMissingRowsNode:At,isDropMissingNode:nn,isPreviewNode:En,isDatasetProfileNode:It}=g,{canResetNode:ut,headerCanResetNode:zn,footerCanResetNode:Qt}=C,{configState:ft,setConfigState:tt,stableInitialConfig:fs,stableCurrentConfig:Vt,nodeChangeVersion:pt}=A,{handleParameterChange:bt,handleNumberChange:ns,handlePercentileChange:hn,handleBooleanChange:bn,handleTextChange:un}=R,kn=y.useMemo(()=>Be?ft?{...ft}:{}:null,[ft,Be]),{imputationMethodOptions:sn,imputationMethodValues:ss,imputerStrategies:$t,imputerStrategyCount:Dn}=P,{skewnessTransformations:xn,updateSkewnessTransformations:wn}=T,{graphTopology:Js,modelingConfig:Kn,previewSignatureResult:Is,cachedPreviewSchema:rs,setCachedPreviewSchema:ps,schemaDiagnostics:Bs,columnCatalogState:Yn}=xR({graphSnapshot:l??null,nodeId:S,catalogFlags:g,configState:ft,setConfigState:tt,nodeParams:w,sourceId:i,requiresColumnCatalog:x,imputerStrategies:$t}),{graphContext:as,graphNodeCount:Wt,upstreamTargetColumn:et,hasReachableSource:qe}=Js,{featureTargetSplitConfig:Fn,trainTestSplitConfig:Us,resamplingConfig:os,trainModelDraftConfig:qs,trainModelRuntimeConfig:ie,trainModelCVConfig:_e,filteredModelTypeOptions:$e}=Kn,{upstreamConfigFingerprints:Ct,previewSignature:we}=Is,{cachedSchemaColumns:rt,oversamplingSchemaGuard:ct,imputationSchemaDiagnostics:Lt,skipPreview:Ot}=Bs,{availableColumns:Pt,setAvailableColumns:Dt,columnSearch:Xt,setColumnSearch:gs,columnMissingMap:Mn,setColumnMissingMap:fn,columnTypeMap:dn,setColumnTypeMap:Gn,columnSuggestions:In,setColumnSuggestions:Xr,imputerMissingFilter:Ta,setImputerMissingFilter:vt}=Yn,[Fo,Io]=y.useState("500"),[Jr,Bo]=y.useState(()=>new Set);y.useEffect(()=>{Bo(new Set)},[fs]);const{datasetProfileController:Ui,profileState:Uo}=w$({node:e,graphContext:as,hasReachableSource:qe,sourceId:i,formatRelativeTime:Rn,catalogFlags:g}),{nodePreview:$a,previewSignals:Zr,featureMathState:Hs,previewData:Z}=R$({graphSnapshot:l??null,graphNodeCount:Wt,hasReachableSource:qe,sourceId:i,node:e,nodeId:S,previewSignature:we,skipPreview:Ot,cachedPreviewSchema:rs,setCachedPreviewSchema:ps,catalogFlags:g,upstreamTargetColumn:et,setConfigState:tt,configState:ft}),{previewState:fe,refreshPreview:me,clearCachedPreviewSchema:Ee,canTriggerPreview:je}=$a,{featureMathSignals:ye,polynomialSignal:nt,featureSelectionSignal:De,outlierPreviewSignal:mt,transformerAuditSignal:ot}=Zr,{featureMathOperations:Qe,featureMathSummaries:wt,collapsedFeatureMath:An,setCollapsedFeatureMath:Bt}=Hs,{previewColumns:pn,previewColumnStats:ks,previewSampleRows:_s}=Z,{dropMissingColumns:Vs,encodingRecommendations:Sr,outlierRecommendations:Zs,scalingInsights:Qn,binningInsights:vs,binnedDistribution:Pa,skewnessInsights:Ms,missingIndicatorState:Ra,dataCleaningState:ea,numericColumnAnalysis:La,numericAnalysisState:za}=GP({catalogFlags:g,sourceId:i,nodeId:S,graphContext:as,hasReachableSource:qe,columnTypeMap:dn,setAvailableColumns:Dt,setColumnSearch:gs,setColumnMissingMap:fn,setColumnTypeMap:Gn,setColumnSuggestions:Xr,dropColumnParameter:j,node:e,configState:ft,setConfigState:tt,nodeChangeVersion:pt,binnedSamplePreset:Fo,skewnessTransformations:xn,availableColumns:Pt,columnMissingMap:Mn,previewSampleRows:_s}),{hasDropColumnSource:Da,availableFilters:Fa,activeFilterId:On,setActiveFilterId:Jt,recommendations:ta,filteredRecommendations:na,formatSignalName:sc,isFetchingRecommendations:sa,recommendationsError:Zt,recommendationsGeneratedAt:Nn,suggestedThreshold:is,refreshRecommendations:qi}=Vs,{labelEncoding:qo,targetEncoding:Ho,hashEncoding:Ia,ordinalEncoding:ra,dummyEncoding:Vo,oneHotEncoding:Wo}=Sr,{outlierData:uf,outlierError:df,isFetchingOutliers:mf,refreshOutliers:rc}=Zs,{scalingData:hf,scalingError:ff,isFetchingScaling:Gu,refreshScaling:Qu}=Qn,{binningData:ac,binningError:pf,isFetchingBinning:Xu,refreshBinning:Ju}=vs,aa=y.useCallback(()=>{Ee(),me(),Ze&&Qu(),at&&Ju(),jt&&rc()},[at,jt,Ze,Ju,rc,Ee,me,Qu]),{binnedDistributionData:Zu,binnedDistributionError:gf,isFetchingBinnedDistribution:ed,refreshBinnedDistribution:td}=Pa,{skewnessData:_f,skewnessError:nd,isFetchingSkewness:sd,refreshSkewness:oc}=Ms,{activeFlagSuffix:Ba,missingIndicatorColumns:i0,missingIndicatorInsights:rd}=Ra,ad=!!i&&qe,od=y.useMemo(()=>{var Gt;return We((Gt=e==null?void 0:e.data)==null?void 0:Gt.columns)},[(Tn=e==null?void 0:e.data)==null?void 0:Tn.columns]),{alias:Er,trimWhitespace:Hi,removeSpecial:kr,regexCleanup:Ko,normalizeCase:Vi,replaceInvalid:Ua,standardizeDates:Mr}=ea,{numericExcludedColumns:id}=La,{scaling:Yt,outlier:qt,binning:St,selectedColumns:ys}=za;JP({previewState:fe,previewSampleRows:_s,activeFlagSuffix:Ba??"",setColumnTypeMap:Gn,setColumnSuggestions:Xr,hasReachableSource:qe,requiresColumnCatalog:x,nodeColumns:od,selectedColumns:ys,setAvailableColumns:Dt,setColumnMissingMap:fn});const vf=`${S||"node"}-remove-duplicates-keep`,ld=y.useMemo(()=>{const Gt=typeof(ft==null?void 0:ft.keep)=="string"?ft.keep.trim().toLowerCase():"";return Gt==="last"||Gt==="none"?Gt:g1},[ft==null?void 0:ft.keep]),qa=y.useMemo(()=>Xt.trim().toLowerCase(),[Xt]),ic=y.useMemo(()=>qa?Pt.filter(Gt=>Gt.toLowerCase().includes(qa)):Pt,[Pt,qa]),lc=((Xn=w.dropMissing.threshold)==null?void 0:Xn.name)??null,{skewness:rn,imputationConfiguration:cd,thresholdRecommendations:yf}=sR({catalogFlags:g,skewnessData:_f,skewnessTransformations:xn,availableColumns:Pt,previewColumns:pn,columnTypeMap:dn,updateSkewnessTransformations:wn,imputerStrategies:$t,columnMissingMap:Mn,previewColumnStats:ks,nodeColumns:(Rr=e==null?void 0:e.data)==null?void 0:Rr.columns,imputerMissingFilter:Ta,suggestedThreshold:is,thresholdParameterName:lc,configState:ft,handleParameterChange:bt}),{imputerColumnOptions:bf,imputerMissingSliderMax:xf,imputerFilteredOptionCount:wf,imputerMissingFilterActive:Nf}=cd,{normalizedSuggestedThreshold:Ws,thresholdMatchesSuggestion:Yo,canApplySuggestedThreshold:ud,handleApplySuggestedThreshold:dd}=yf,md=At&&!!(w.dropMissing.threshold||w.dropRows.any),{columnSelectionHandlers:hd,nodeSaveHandlers:cc,imputationStrategyHandlers:jf,aliasStrategyHandlers:Cf,dateStrategyHandlers:Ha,featureMathHandlers:uc}=dR({catalogFlags:g,setConfigState:tt,binningExcludedColumns:St.state.excludedColumns,scalingExcludedColumns:Yt.state.excludedColumns,availableColumns:Pt,recommendations:ta,nodeId:S,onUpdateConfig:n,onClose:t,sourceId:i??null,graphSnapshot:l??null,onUpdateNodeData:s,canResetNode:ut,defaultConfigTemplate:u,onResetConfig:c,imputationMethodValues:ss,imputationMethodOptions:sn,imputerStrategyCount:Dn,setCollapsedStrategies:Bo,setImputerMissingFilter:vt,node:e,aliasColumnSummary:Er.columnSummary,aliasStrategyCount:Er.strategyCount,dateStrategies:Mr.strategies,standardizeDatesColumnSummary:Mr.columnSummary,standardizeDatesMode:Mr.mode,setCollapsedFeatureMath:Bt,configState:ft}),{handleManualBoundChange:Wi,handleClearManualBound:fd,handleToggleColumn:Ar,handleApplyAllRecommended:Ki,handleSelectAllColumns:Va,handleClearColumns:dc,handleRemoveColumn:pd}=hd,{handleSave:Wa,handleResetNode:mc}=cc,gd=ys.length,_d=Da&&!!i&&qe,hc=!_&&!Mt,vd=hc&&fs!==Vt,yd=Uo.status==="loading",Or=fe.status==="loading",{insightSummaries:fc,asyncBusyLabel:pc}=fR({recommendationsGeneratedAt:Nn,scalingData:hf,binningData:ac,binnedDistributionData:Zu,outlierData:uf,isProfileLoading:yd,isPreviewLoading:Or,isFetchingScaling:Gu,isFetchingBinning:Xu,isFetchingHashEncoding:Ia.isFetching,isFetchingBinnedDistribution:ed,isFetchingRecommendations:sa,catalogFlags:g}),{relativeGeneratedAt:Sf,relativeScalingGeneratedAt:Ef,relativeBinningGeneratedAt:Go,relativeBinnedGeneratedAt:kf,relativeOutlierGeneratedAt:bd,scalingSampleSize:xd,binningSampleSize:Ht,binnedSampleSize:gc,outlierSampleSize:Yi}=fc,{hasActiveAsyncWork:Qo,busyLabel:Mf,footerBusyLabel:_c}=pc,{updateImputerStrategies:Gi,handleAddImputerStrategy:Qi,handleRemoveImputerStrategy:Ka,toggleImputerStrategySection:wd,handleImputerMethodChange:Af,handleImputerOptionNumberChange:Of,handleImputerColumnsChange:Nd,handleImputerColumnToggle:Xi,handleImputerMissingFilterChange:Ji}=jf,{updateAliasStrategies:jd,handleAddAliasStrategy:vc,handleRemoveAliasStrategy:yc,toggleAliasStrategySection:bc,handleAliasModeChange:Tf,handleAliasColumnToggle:Cd,handleAliasColumnsChange:$f,handleAliasAutoDetectToggle:Pf}=Cf,{updateDateStrategies:Sd,handleAddDateStrategy:Tr,handleRemoveDateStrategy:Ed,toggleDateStrategySection:Ya,handleDateStrategyModeChange:er,handleDateStrategyColumnsChange:Xo,handleDateStrategyColumnToggle:hr,handleDateStrategyAutoDetectToggle:xc}=Ha,{updateFeatureMathOperations:l0,handleAddFeatureMathOperation:Rf,handleDuplicateFeatureMathOperation:oa,handleRemoveFeatureMathOperation:Jo,handleReorderFeatureMathOperation:Ga,handleToggleFeatureMathOperation:Zi,handleFeatureMathOperationChange:wc}=uc,Qa=y.useCallback(()=>{i&&td()},[td,i]),$r=l$({catalogFlags:g,binnedDistributionData:Zu}),{renderMultiSelectField:Et,renderParameterField:Ke}=E$({nodeId:S,catalogFlags:g,configState:ft,previewState:fe,binning:St,scaling:Yt,selectedColumns:ys,availableColumns:Pt,filteredColumnOptions:ic,normalizedColumnSearch:qa,columnSearch:Xt,setColumnSearch:gs,columnSuggestions:In,columnMissingMap:Mn,columnTypeMap:dn,sourceId:i,hasReachableSource:qe,recommendationsState:{isFetching:sa,availableFilters:Fa,activeFilterId:On,setActiveFilterId:Jt,recommendations:ta,filteredRecommendations:na,error:Zt,relativeGeneratedAt:Sf,formatSignalName:sc,refresh:qi,show:_d},columnSelectionHandlers:{handleToggleColumn:Ar,handleRemoveColumn:pd,handleApplyAllRecommended:Ki,handleSelectAllColumns:Va,handleClearColumns:dc},parameterHandlers:{handleNumberChange:ns,handleBooleanChange:bn,handleTextChange:un},thresholdRecommendations:{thresholdParameterName:lc,normalizedSuggestedThreshold:Ws,canApplySuggestedThreshold:ud,thresholdMatchesSuggestion:Yo,handleApplySuggestedThreshold:dd},numericExcludedColumns:id,selectionCount:gd}),Pr=y.useCallback(Gt=>{tt(Bn=>({...Bn,keep:Gt}))},[tt]);return a.jsxs("div",{className:"canvas-modal",role:"dialog","aria-modal":"true","aria-labelledby":"node-settings-title",children:[a.jsx("div",{className:"canvas-modal__backdrop",onClick:t}),a.jsxs("div",{className:"canvas-modal__panel",children:[a.jsx(I1,{title:h,isDataset:_,onClose:t,canResetNode:zn,onResetNode:mc}),a.jsxs("div",{className:"canvas-modal__body",children:[O&&a.jsx(x$,{connectionInfo:O,connectedInputHandles:F,connectedOutputHandles:B,connectionReady:D}),md&&a.jsx(p1,{thresholdParameter:w.dropMissing.threshold??null,dropIfAnyParameter:w.dropRows.any,renderParameterField:Ke}),j&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missingness recommendations"})}),w.dropMissing.threshold&&Ke(w.dropMissing.threshold),Et(j)]}),z&&a.jsxs(a.Fragment,{children:[a.jsx(CM,{suffix:Ba,insights:rd,formatMissingPercentage:Wn}),(w.missingIndicator.columns||w.missingIndicator.suffix)&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Missing indicator settings"})}),a.jsxs("div",{className:"canvas-modal__parameter-list",children:[w.missingIndicator.columns?Ke(w.missingIndicator.columns):null,w.missingIndicator.suffix?Ke(w.missingIndicator.suffix):null]})]})]}),En&&a.jsx(L1,{previewState:fe,datasetSourceId:i??null,canTriggerPreview:je,onRefresh:aa,formatCellValue:Wb,formatMetricValue:zs,formatMissingPercentage:Wn,formatNumericStat:js,formatModeStat:Sy}),a.jsx(D1,{isDatasetProfileNode:It,controller:Ui,formatCellValue:Wb,formatNumericStat:js,formatMissingPercentage:Wn}),k&&a.jsx("section",{className:"canvas-modal__section",children:a.jsxs("p",{className:"canvas-modal__note",children:[a.jsxs("strong",{children:[k.title,"."]})," ",k.body]})}),te&&a.jsx(OA,{sourceId:i,hasReachableSource:qe,columnsParameter:w.trimWhitespace.columns,modeParameter:w.trimWhitespace.mode,renderMultiSelectField:Et,renderParameterField:Ke,columnSummary:Hi.columnSummary,modeDetails:Hi.modeDetails,sampleMap:Hi.sampleMap}),K&&a.jsx(QA,{sourceId:i,hasReachableSource:qe,columnsParameter:w.removeSpecial.columns,modeParameter:w.removeSpecial.mode,replacementParameter:w.removeSpecial.replacement,renderMultiSelectField:Et,renderParameterField:Ke,columnSummary:kr.columnSummary,modeDetails:kr.modeDetails,sampleMap:kr.sampleMap}),V&&a.jsx(tT,{sourceId:i,hasReachableSource:qe,columnsParameter:w.replaceInvalid.columns,modeParameter:w.replaceInvalid.mode,minValueParameter:w.replaceInvalid.minValue,maxValueParameter:w.replaceInvalid.maxValue,renderMultiSelectField:Et,renderParameterField:Ke,columnSummary:Ua.columnSummary,modeDetails:Ua.modeDetails,sampleMap:Ua.sampleMap,selectedMode:Ua.mode,minValue:Ua.minValue,maxValue:Ua.maxValue}),G&&a.jsx(OO,{sourceId:i,hasReachableSource:qe,columnsParameter:w.regexCleanup.columns,modeParameter:w.regexCleanup.mode,patternParameter:w.regexCleanup.pattern,replacementParameter:w.regexCleanup.replacement,renderMultiSelectField:Et,renderParameterField:Ke,columnSummary:Ko.columnSummary,modeDetails:Ko.modeDetails,sampleMap:Ko.sampleMap,selectedMode:Ko.selectedMode,replacementValue:Ko.replacementValue}),Q&&a.jsx(hO,{sourceId:i,hasReachableSource:qe,columnsParameter:w.normalizeCase.columns,modeParameter:w.normalizeCase.mode,renderMultiSelectField:Et,renderParameterField:Ke,columnSummary:Vi.columnSummary,modeDetails:Vi.modeDetails,sampleMap:Vi.sampleMap,selectedMode:Vi.selectedMode}),Me&&a.jsx(bT,{operations:Qe,summaries:wt,collapsed:An,onToggleCollapsed:Zi,onAddOperation:Rf,onDuplicateOperation:oa,onRemoveOperation:Jo,onReorderOperation:Ga,onOperationChange:wc,availableColumns:Pt,signals:ye,previewStatus:fe.status,errorHandlingParameter:w.featureMath.errorHandling,allowOverwriteParameter:w.featureMath.allowOverwrite,defaultTimezoneParameter:w.featureMath.defaultTimezone,epsilonParameter:w.featureMath.epsilon,renderParameterField:Ke}),ke&&a.jsx(RT,{sourceId:i,hasReachableSource:qe,isFetching:ra.isFetching,error:ra.error,suggestions:ra.suggestions,metadata:ra.metadata,columnsParameter:w.ordinalEncoding.columns,autoDetectParameter:w.ordinalEncoding.autoDetect,maxCategoriesParameter:w.ordinalEncoding.maxCategories,outputSuffixParameter:w.ordinalEncoding.outputSuffix,dropOriginalParameter:w.ordinalEncoding.dropOriginal,encodeMissingParameter:w.ordinalEncoding.encodeMissing,handleUnknownParameter:w.ordinalEncoding.handleUnknown,unknownValueParameter:w.ordinalEncoding.unknownValue,selectedColumns:ys,renderParameterField:Ke,onToggleColumn:Ar,onApplyRecommended:ra.handleApplyRecommended,formatMissingPercentage:Wn}),re&&a.jsx(ST,{sourceId:i,hasReachableSource:qe,isFetching:Ho.isFetching,error:Ho.error,suggestions:Ho.suggestions,metadata:Ho.metadata,columnsParameter:w.targetEncoding.columns,targetColumnParameter:w.targetEncoding.targetColumn,autoDetectParameter:w.targetEncoding.autoDetect,maxCategoriesParameter:w.targetEncoding.maxCategories,outputSuffixParameter:w.targetEncoding.outputSuffix,dropOriginalParameter:w.targetEncoding.dropOriginal,smoothingParameter:w.targetEncoding.smoothing,encodeMissingParameter:w.targetEncoding.encodeMissing,handleUnknownParameter:w.targetEncoding.handleUnknown,selectedColumns:ys,renderParameterField:Ke,onToggleColumn:Ar,onApplyRecommended:Ho.handleApplyRecommended,formatMissingPercentage:Wn}),Ue&&a.jsx(DT,{sourceId:i,hasReachableSource:qe,isFetching:Vo.isFetching,error:Vo.error,suggestions:Vo.suggestions,metadata:Vo.metadata,columnsParameter:w.dummyEncoding.columns,autoDetectParameter:w.dummyEncoding.autoDetect,maxCategoriesParameter:w.dummyEncoding.maxCategories,dropFirstParameter:w.dummyEncoding.dropFirst,includeMissingParameter:w.dummyEncoding.includeMissing,dropOriginalParameter:w.dummyEncoding.dropOriginal,prefixSeparatorParameter:w.dummyEncoding.prefixSeparator,selectedColumns:ys,renderParameterField:Ke,onToggleColumn:Ar,onApplyRecommended:Vo.handleApplyRecommended,formatMissingPercentage:Wn}),ce&&a.jsx(BT,{sourceId:i,hasReachableSource:qe,isFetching:Wo.isFetching,error:Wo.error,suggestions:Wo.suggestions,metadata:Wo.metadata,columnsParameter:w.oneHotEncoding.columns,autoDetectParameter:w.oneHotEncoding.autoDetect,maxCategoriesParameter:w.oneHotEncoding.maxCategories,dropFirstParameter:w.oneHotEncoding.dropFirst,includeMissingParameter:w.oneHotEncoding.includeMissing,dropOriginalParameter:w.oneHotEncoding.dropOriginal,prefixSeparatorParameter:w.oneHotEncoding.prefixSeparator,selectedColumns:ys,renderParameterField:Ke,onToggleColumn:Ar,onApplyRecommended:Wo.handleApplyRecommended,formatMissingPercentage:Wn}),Re&&a.jsx(GT,{nodeId:S,sourceId:i,hasReachableSource:qe,previewState:fe,onRefreshPreview:aa,config:Fn,targetColumnParameter:w.featureTargetSplit.targetColumn,renderParameterField:Ke,formatMetricValue:zs,formatMissingPercentage:Wn}),Oe&&a.jsx(XT,{nodeId:S,sourceId:i,hasReachableSource:qe,previewState:fe,onRefreshPreview:aa,config:Us,parameters:v,renderParameterField:Ke,formatMetricValue:zs}),N&&a.jsx(i$,{mode:xe?"oversampling":"undersampling",sourceId:i,hasReachableSource:qe,previewState:fe,onRefreshPreview:aa,config:os,methodParameter:w.resampling.method,targetColumnParameter:w.resampling.targetColumn,samplingStrategyParameter:w.resampling.samplingStrategy,randomStateParameter:w.resampling.randomState,kNeighborsParameter:xe?w.resampling.kNeighbors:null,replacementParameter:pe?w.resampling.replacement:null,renderParameterField:Ke,formatMetricValue:zs,formatMissingPercentage:Wn,schemaGuard:ct}),(Fe||de)&&a.jsx(n2,{sourceId:i,hasReachableSource:qe,previewState:fe,onRefreshPreview:aa,config:qs,targetColumnParameter:w.trainModel.targetColumn,problemTypeParameter:w.trainModel.problemType,renderParameterField:Ke,formatMetricValue:zs,formatMissingPercentage:Wn,schemaColumns:rt}),Fe&&a.jsx("div",{style:q,"aria-disabled":Y,children:a.jsx(y2,{nodeId:S,sourceId:i,graph:as,config:qs,runtimeConfig:ie,cvConfig:_e,draftConfigState:ft,renderParameterField:Ke,modelTypeParameter:w.trainModel.modelType,modelTypeOptions:$e,hyperparametersParameter:w.trainModel.hyperparameters,cvEnabledParameter:w.trainModel.cvEnabled,cvStrategyParameter:w.trainModel.cvStrategy,cvFoldsParameter:w.trainModel.cvFolds,cvShuffleParameter:w.trainModel.cvShuffle,cvRandomStateParameter:w.trainModel.cvRandomState,cvRefitStrategyParameter:w.trainModel.cvRefitStrategy,onSaveDraftConfig:Wa})}),lt&&a.jsx("div",{style:q,"aria-disabled":Y,children:a.jsx(k2,{nodeId:S,sourceId:i,graph:as,config:ft,setConfigState:tt,renderParameterField:Ke,formatMetricValue:zs,connectedSplitHandles:L})}),Be&&a.jsx("div",{style:q,"aria-disabled":Y,children:a.jsx(W2,{nodeId:S,sourceId:i,graph:as,parameters:v,config:kn,renderParameterField:Ke})}),de&&a.jsx("div",{style:q,"aria-disabled":Y,children:a.jsx(s$,{nodeId:S,sourceId:i,graph:as,config:qs,runtimeConfig:ie,cvConfig:_e,draftConfigState:ft,renderParameterField:Ke,modelTypeParameter:w.trainModel.modelType,modelTypeOptions:$e,searchStrategyParameter:w.hyperparameterTuning.searchStrategy,searchIterationsParameter:w.hyperparameterTuning.searchIterations,searchRandomStateParameter:w.hyperparameterTuning.searchRandomState,scoringMetricParameter:w.hyperparameterTuning.scoringMetric,setDraftConfigState:tt,onSaveDraftConfig:Wa})}),J&&a.jsx(NT,{sourceId:i,hasReachableSource:qe,isFetching:qo.isFetching,error:qo.error,suggestions:qo.suggestions,metadata:qo.metadata,columnsParameter:w.labelEncoding.columns,autoDetectParameter:w.labelEncoding.autoDetect,maxUniqueParameter:w.labelEncoding.maxUnique,outputSuffixParameter:w.labelEncoding.outputSuffix,dropOriginalParameter:w.labelEncoding.dropOriginal,missingStrategyParameter:w.labelEncoding.missingStrategy,missingCodeParameter:w.labelEncoding.missingCode,selectedColumns:ys,renderParameterField:Ke,onToggleColumn:Ar,onApplyRecommended:qo.handleApplyRecommended,formatMissingPercentage:Wn}),Se&&a.jsx(MT,{sourceId:i,hasReachableSource:qe,isFetching:Ia.isFetching,error:Ia.error,suggestions:Ia.suggestions,metadata:Ia.metadata,columnsParameter:w.hashEncoding.columns,autoDetectParameter:w.hashEncoding.autoDetect,maxCategoriesParameter:w.hashEncoding.maxCategories,bucketsParameter:w.hashEncoding.buckets,outputSuffixParameter:w.hashEncoding.outputSuffix,dropOriginalParameter:w.hashEncoding.dropOriginal,encodeMissingParameter:w.hashEncoding.encodeMissing,selectedColumns:ys,renderParameterField:Ke,onToggleColumn:Ar,onApplyRecommended:Ia.handleApplyRecommended,formatMissingPercentage:Wn}),_t&&a.jsx(AT,{columnsParameter:w.polynomial.columns,autoDetectParameter:w.polynomial.autoDetect,degreeParameter:w.polynomial.degree,includeBiasParameter:w.polynomial.includeBias,interactionOnlyParameter:w.polynomial.interactionOnly,includeInputFeaturesParameter:w.polynomial.includeInputFeatures,outputPrefixParameter:w.polynomial.outputPrefix,renderParameterField:Ke,signal:nt}),st&&a.jsx(TT,{columnsParameter:w.featureSelection.columns,autoDetectParameter:w.featureSelection.autoDetect,targetColumnParameter:w.featureSelection.targetColumn,methodParameter:w.featureSelection.method,scoreFuncParameter:w.featureSelection.scoreFunc,problemTypeParameter:w.featureSelection.problemType,kParameter:w.featureSelection.k,percentileParameter:w.featureSelection.percentile,alphaParameter:w.featureSelection.alpha,thresholdParameter:w.featureSelection.threshold,modeParameter:w.featureSelection.mode,estimatorParameter:w.featureSelection.estimator,stepParameter:w.featureSelection.step,minFeaturesParameter:w.featureSelection.minFeatures,maxFeaturesParameter:w.featureSelection.maxFeatures,dropUnselectedParameter:w.featureSelection.dropUnselected,renderParameterField:Ke,signal:De}),ne&&a.jsx(hA,{hasSource:!!i,hasReachableSource:qe,strategies:Mr.strategies,columnSummary:Mr.columnSummary,columnOptions:Mr.columnOptions,sampleMap:Mr.sampleMap,collapsedStrategies:Jr,onToggleStrategy:Ya,onRemoveStrategy:Ed,onAddStrategy:Tr,onModeChange:er,onColumnToggle:hr,onColumnsChange:Xo,onAutoDetectToggle:xc,modeOptions:Eh}),H&&a.jsx(JM,{hasSource:!!i,hasReachableSource:qe,strategies:Er.strategies,columnSummary:Er.columnSummary,columnOptions:Er.columnOptions,sampleMap:Er.sampleMap,customPairSummary:Er.customPairSummary,customPairsParameter:w.replaceAliases.customPairs,collapsedStrategies:Jr,onToggleStrategy:bc,onRemoveStrategy:yc,onAddStrategy:vc,onModeChange:Tf,onAutoDetectToggle:Pf,onColumnToggle:Cd,onColumnsChange:$f,renderParameterField:Ke}),I&&a.jsx(pM,{hasSource:!!i,hasReachableSource:qe,strategies:$t,columnOptions:bf,methodOptions:sn,missingFilter:Ta,missingFilterMax:xf,missingFilterActive:Nf,filteredOptionCount:wf,collapsedStrategies:Jr,onToggleStrategy:wd,onRemoveStrategy:Ka,onAddStrategy:Qi,onMethodChange:Af,onOptionNumberChange:Of,onColumnsChange:Nd,onColumnToggle:Xi,onMissingFilterChange:Ji,formatMissingPercentage:Wn,formatNumericStat:js,formatModeStat:Sy,schemaDiagnostics:Lt}),Ye&&a.jsx(b1,{configState:ft,setConfigState:tt,availableColumns:Pt,columnTypeMap:dn,columnSuggestions:In,selectedColumns:ys,previewColumns:pn,previewStatus:fe.status,sourceId:i,hasReachableSource:qe}),jt&&a.jsx(b$,{sourceId:i,hasReachableSource:qe,isFetchingOutliers:mf,outlierConfig:qt.config,outlierMethodOptions:qt.state.methodOptions,outlierMethodDetailMap:qt.state.methodDetailMap,outlierDefaultDetail:qt.state.defaultDetail,outlierAutoDetectEnabled:qt.state.autoDetectEnabled,outlierSelectedCount:qt.state.selectedCount,outlierDefaultLabel:qt.state.defaultLabel,outlierOverrideCount:qt.state.overrideCount,outlierParameterOverrideCount:qt.state.parameterOverrideCount,outlierOverrideExampleSummary:qt.state.overrideExampleSummary,outlierHasOverrides:qt.state.hasOverrides,outlierRecommendationRows:qt.state.recommendationRows,outlierHasRecommendations:qt.state.hasRecommendations,outlierStatusMessage:qt.state.statusMessage,outlierError:df,outlierSampleSize:Yi,relativeOutlierGeneratedAt:bd,outlierPreviewSignal:mt,formatMetricValue:zs,formatNumericStat:js,onApplyAllRecommendations:qt.handlers.handleApplyAllRecommendations,onClearOverrides:qt.handlers.handleClearOverrides,onDefaultMethodChange:qt.handlers.handleDefaultMethodChange,onAutoDetectToggle:qt.handlers.handleAutoDetectToggle,onOverrideSelect:qt.handlers.handleOverrideSelect,onMethodParameterChange:qt.handlers.handleMethodParameterChange,onColumnParameterChange:qt.handlers.handleColumnParameterChange}),Ze&&a.jsx(gM,{sourceId:i,hasReachableSource:qe,isFetchingScaling:Gu,scalingConfig:Yt.config,scalingMethodOptions:Yt.state.methodOptions,scalingMethodDetailMap:Yt.state.methodDetailMap,scalingDefaultDetail:Yt.state.defaultDetail,scalingAutoDetectEnabled:Yt.state.autoDetectEnabled,scalingSelectedCount:Yt.state.selectedCount,scalingDefaultLabel:Yt.state.defaultLabel,scalingOverrideCount:Yt.state.overrideCount,scalingOverrideExampleSummary:Yt.state.overrideExampleSummary,scalingRecommendationRows:Yt.state.recommendationRows,scalingHasRecommendations:Yt.state.hasRecommendations,scalingStatusMessage:Yt.state.statusMessage,scalingError:ff,scalingSampleSize:xd,relativeScalingGeneratedAt:Ef,formatMetricValue:zs,formatNumericStat:js,formatMissingPercentage:Wn,onApplyAllRecommendations:Yt.handlers.handleApplyAllRecommendations,onClearOverrides:Yt.handlers.handleClearOverrides,onDefaultMethodChange:Yt.handlers.handleDefaultMethodChange,onAutoDetectToggle:Yt.handlers.handleAutoDetectToggle,onOverrideSelect:Yt.handlers.handleOverrideSelect}),at&&a.jsxs(a.Fragment,{children:[a.jsx(rM,{hasSource:!!i,hasReachableSource:qe,isFetching:Xu,error:pf,relativeGeneratedAt:Go,sampleSize:Ht,binningConfig:St.config,binningDefaultLabel:St.state.defaultLabel,binningOverrideCount:St.state.overrideCount,binningOverrideSummary:St.state.overrideSummary,recommendations:St.state.insightsRecommendations,excludedColumns:St.state.insightsExcludedColumns,numericColumnCount:St.state.allNumericColumns.length,canApplyAllNumeric:St.state.canApplyAllNumeric,onApplyAllNumeric:St.handlers.handleApplyAllNumeric,onApplyStrategies:St.handlers.handleApplyStrategies,onClearOverrides:St.handlers.handleClearOverrides,customEdgeDrafts:St.state.customEdgeDrafts,customLabelDrafts:St.state.customLabelDrafts,onOverrideStrategyChange:St.handlers.handleOverrideStrategyChange,onOverrideNumberChange:St.handlers.handleOverrideNumberChange,onOverrideKbinsEncodeChange:St.handlers.handleOverrideKbinsEncodeChange,onOverrideKbinsStrategyChange:St.handlers.handleOverrideKbinsStrategyChange,onOverrideClear:St.handlers.handleClearOverride,onCustomBinsChange:St.handlers.handleCustomBinsChange,onCustomLabelsChange:St.handlers.handleCustomLabelsChange,onClearCustomColumn:St.handlers.handleClearCustomColumn,formatMetricValue:zs,formatNumericStat:js}),a.jsx(tM,{config:St.config,fieldIds:St.state.fieldIds,onIntegerChange:St.handlers.handleIntegerChange,onBooleanToggle:St.handlers.handleBooleanToggle,onSuffixChange:St.handlers.handleSuffixChange,onLabelFormatChange:St.handlers.handleLabelFormatChange,onMissingStrategyChange:St.handlers.handleMissingStrategyChange,onMissingLabelChange:St.handlers.handleMissingLabelChange})]}),zt&&a.jsx(wM,{sourceId:i,hasReachableSource:qe,isFetchingSkewness:sd,skewnessThreshold:rn.state.threshold,skewnessError:nd,skewnessViewMode:rn.state.viewMode,skewnessRecommendedCount:rn.state.recommendedCount,skewnessNumericCount:rn.state.numericCount,skewnessGroupByMethod:rn.state.groupByMethod,skewnessRows:rn.state.rows,skewnessTableGroups:rn.state.tableGroups,hasSkewnessAutoRecommendations:rn.state.hasAutoRecommendations,skewnessTransformationsCount:rn.state.transformationsCount,isFetchingRecommendations:sa,getSkewnessMethodLabel:rn.handlers.getMethodLabel,getSkewnessMethodStatus:rn.handlers.getMethodStatus,onApplyRecommendations:rn.handlers.applyRecommendations,onViewModeChange:rn.handlers.setViewMode,onGroupByToggle:rn.handlers.setGroupByMethod,onOverrideChange:rn.handlers.handleOverrideChange,onClearSelections:rn.handlers.clearTransformations}),Ge&&a.jsx(jM,{skewnessThreshold:rn.state.threshold,isFetchingSkewness:sd,skewnessError:nd,skewnessDistributionCards:rn.state.distributionCards,skewnessDistributionView:rn.state.distributionView,setSkewnessDistributionView:rn.handlers.setDistributionView,onRefresh:oc,canRefresh:ad}),Ft&&a.jsx(aM,{cards:$r,selectedPreset:Fo,onSelectPreset:Gt=>Io(Gt),isFetching:ed,sampleSize:gc,relativeGeneratedAt:kf,error:gf,onRefresh:Qa,canRefresh:!!i}),tn&&a.jsx(v1,{sourceId:i,hasReachableSource:qe,removeDuplicatesColumnsParameter:w.removeDuplicates.columns,removeDuplicatesKeepParameter:w.removeDuplicates.keep,renderMultiSelectField:Et,removeDuplicatesKeepSelectId:vf,removeDuplicatesKeep:ld,onKeepChange:Pr}),Kt&&E.length>0&&a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("div",{className:"canvas-modal__section-header",children:a.jsx("h3",{children:"Data consistency settings"})}),a.jsx("div",{className:"canvas-modal__parameter-list",children:E.map(Gt=>Ke(Gt))})]}),dt&&a.jsx(WT,{signal:ot,previewStatus:fe.status,hasSource:!!i,hasReachableSource:qe,onRefreshPreview:aa}),a.jsxs("section",{className:"canvas-modal__section",children:[a.jsx("h3",{children:"Node details"}),f.length?a.jsx("dl",{className:"canvas-modal__metadata",children:f.map((Gt,Bn)=>a.jsxs("div",{className:"canvas-modal__metadata-row",children:[a.jsx("dt",{children:Gt.label}),a.jsx("dd",{children:Gt.value})]},`${Gt.label}-${Bn}`))}):a.jsx("p",{className:"canvas-modal__empty",children:"No metadata available for this node."})]})]}),a.jsx(B1,{onClose:t,canResetNode:Qt,onResetNode:mc,showSaveButton:hc,canSave:vd,onSave:Wa,isBusy:Qo,busyLabel:_c})]})]})},$x=[{key:"train",label:"Train"},{key:"test",label:"Test"},{key:"validation",label:"Validation"}],Hr=$x.map(e=>e.key),IR=$x.reduce((e,t)=>({...e,[t.key]:t.label}),{}),BR=e=>typeof e=="string"&&Hr.includes(e),Vr=e=>{if(!Array.isArray(e))return[];const t=new Set;return e.forEach(n=>{BR(n)&&t.add(n)}),Hr.filter(n=>t.has(n))},Px=(e,t)=>{const n=Vr(e),s=Vr(t);return n.length!==s.length?!1:n.every((i,l)=>i===s[l])},Rx=e=>!e||typeof e!="string"?null:Hr.find(t=>e.endsWith(`-${t}`))??null,Lx=(e,t)=>{if(t<=1)return"50%";const n=100/(t+1);return`${Math.round((e+1)*n)}%`},UR={train:e=>e.endsWith("-train"),validation:e=>e.endsWith("-validation"),test:e=>e.endsWith("-test"),model:e=>e.endsWith("-model-out"),params:e=>e.endsWith("-best-params-out")},Ql={hyperparameter_tuning:{inputs:[{key:"train-in",label:"Train Split",position:35,required:!0,accepts:["train"]},{key:"validation-in",label:"Validation Split",position:65,required:!0,accepts:["validation"]}],outputs:[{key:"best-params-out",label:"Best Params",position:50}]},train_model_draft:{inputs:[{key:"train-in",label:"Train Split",position:40,required:!0,accepts:["train"]},{key:"params-in",label:"Best Params",position:60,required:!1,accepts:["params"]}],outputs:[{key:"model-out",label:"Model",position:50}]},model_evaluation:{inputs:[{key:"train-in",label:"Train Split",position:20,required:!1,accepts:["train"]},{key:"test-in",label:"Test Split",position:40,required:!1,accepts:["test"]},{key:"validation-in",label:"Validation Split",position:60,required:!1,accepts:["validation"]},{key:"models-in",label:"Model",position:80,required:!0,accepts:["model"]}]},model_registry_overview:{inputs:[{key:"models-in",label:"Model",position:50,required:!0,accepts:["model"]}]}},zx=(e,t,n)=>typeof e.position=="number"&&Number.isFinite(e.position)?`${Math.min(Math.max(e.position,5),95)}%`:Lx(t,n),qR=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,HR=e=>e.required===!1?`${e.label} (optional)`:`${e.label} (required)`,Dx=(e,t)=>{if(!t||typeof t!="string")return null;const n=`${e}-`;if(t.startsWith(n))return t.slice(n.length);const s=t.split("-");return s.length>=2?s.slice(-2).join("-"):t},Fx=28,Ix=320,VR=170,Bx="Removes columns whose missing percentage exceeds a configurable threshold and applies EDA-backed column drop recommendations.",Ux="Drop columns",qx=new Set(["transformer_audit"]),WR=e=>({width:`${Fx}px`,height:`${Fx}px`,borderRadius:"999px",border:e==="target"?"1px solid rgba(148, 163, 184, 0.55)":"1px solid rgba(45, 212, 191, 0.55)",background:e==="target"?"rgba(148, 163, 184, 0.22)":"rgba(45, 212, 191, 0.18)",boxShadow:e==="target"?"0 0 0 3px rgba(148, 163, 184, 0.18)":"0 0 0 3px rgba(45, 212, 191, 0.18)",backdropFilter:"blur(2px)"}),KR=({id:e,data:t,selected:n})=>{var C;const s=(t==null?void 0:t.label)??e,i=!!((t==null?void 0:t.isDataset)??e==="dataset-source"),l=(t==null?void 0:t.isRemovable)??!i,c=(t==null?void 0:t.catalogType)==="train_test_split",u=i?"Primary dataset input":void 0,d=(t==null?void 0:t.description)??u,h=(t==null?void 0:t.catalogType)==="drop_missing_columns"||d===Bx?Ux:d,p=(t==null?void 0:t.backgroundExecutionStatus)??"idle",_=!((t==null?void 0:t.hasRequiredConnections)??!0),N=(t==null?void 0:t.catalogType)??"",v=["hyperparameter_tuning","train_model_draft","model_evaluation","model_registry_overview"].includes(N),x=y.useCallback(w=>{var E;w.stopPropagation(),(E=t==null?void 0:t.onRemoveNode)==null||E.call(t,e)},[t,e]),j=y.useMemo(()=>{if(i)return[];const w=(t==null?void 0:t.catalogType)??"",E=w?Ql[w]:void 0;if(E!=null&&E.inputs&&E.inputs.length){const A=E.inputs.length;return E.inputs.map((R,P)=>({position:Ae.Left,id:`${e}-${R.key}`,label:qR(R),style:{top:zx(R,P,A)}}))}return[{position:Ae.Left,id:`${e}-target`},{position:Ae.Top,id:`${e}-target-top`}]},[t==null?void 0:t.catalogType,e,i]),k=y.useMemo(()=>{if(i)return[{position:Ae.Left,id:`${e}-source-left`},{position:Ae.Right,id:`${e}-source`},{position:Ae.Top,id:`${e}-source-top`},{position:Ae.Bottom,id:`${e}-source-bottom`}];const w=(t==null?void 0:t.catalogType)??"",E=w?Ql[w]:void 0;if(E!=null&&E.outputs&&E.outputs.length){const P=E.outputs.length;return E.outputs.map((T,O)=>({position:Ae.Right,id:`${e}-${T.key}`,label:T.label,style:{top:zx(T,O,P)}}))}const A=c?Hr:Vr((t==null?void 0:t.activeSplits)??[]),R=Vr((t==null?void 0:t.connectedSplits)??[]);if(A.length){const P=A.length;return A.map((T,O)=>({position:Ae.Right,id:`${e}-${T}`,style:{top:Lx(O,P)},label:(()=>{var B;const F=IR[T];if(c){if(T==="validation"&&!(Number(((B=t==null?void 0:t.config)==null?void 0:B.validation_size)??0)>0))return`${F} (disabled)`;if(!R.includes(T))return`${F} (not set)`}return F})()}))}return[{position:Ae.Right,id:`${e}-source`},{position:Ae.Bottom,id:`${e}-source-bottom`}]},[t==null?void 0:t.activeSplits,t==null?void 0:t.catalogType,t==null?void 0:t.connectedSplits,(C=t==null?void 0:t.config)==null?void 0:C.validation_size,e,i,c]),S=y.useCallback((w,E)=>{const{position:A,id:R,style:P,label:T}=w,O=R.includes("-train")||R.includes("-test")||R.includes("-validation");return a.jsxs(ge.Fragment,{children:[a.jsx(kl,{type:E,position:A,id:R,className:`feature-node__handle feature-node__handle--${E}`,style:{...WR(E),...P??{},...O?{opacity:1,visibility:"visible",pointerEvents:"all"}:{}}}),T&&E==="source"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",right:"-8px",top:(P==null?void 0:P.top)||"50%",transform:"translate(100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:T}),T&&E==="target"&&a.jsx("div",{className:"feature-node__handle-label",style:{position:"absolute",left:"-8px",top:(P==null?void 0:P.top)||"50%",transform:"translate(-100%, calc(-100% - 8px))",fontSize:"0.7rem",fontWeight:"600",color:"rgba(148, 163, 184, 0.9)",background:"rgba(15, 23, 42, 0.95)",padding:"3px 8px",borderRadius:"4px",whiteSpace:"nowrap",pointerEvents:"none",zIndex:100,border:"1px solid rgba(71, 85, 105, 0.5)",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)"},children:T})]},R)},[]);return a.jsxs("div",{className:`feature-node${n?" feature-node--selected":""}${i?" feature-node--dataset":""}`,children:[j.map(w=>S(w,"target")),a.jsxs("div",{className:"feature-node__header",children:[a.jsxs("div",{className:"feature-node__title-group",children:[a.jsx("span",{className:"feature-node__drag-handle","aria-hidden":"true",children:""}),a.jsx("span",{className:"feature-node__title",children:s})]}),a.jsxs("div",{className:"feature-node__controls",children:[_&&v&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--warning",title:"Required connections missing",style:{background:"rgba(251, 191, 36, 0.2)",color:"rgb(245, 158, 11)",border:"1px solid rgba(245, 158, 11, 0.3)"},children:""}),p==="loading"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--loading",title:"Loading full dataset in background...",children:a.jsx("svg",{className:"feature-node__spinner",viewBox:"0 0 24 24",children:a.jsx("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:"60",strokeDashoffset:"30",strokeLinecap:"round"})})}),p==="success"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--success",title:"Full dataset ready",children:""}),p==="error"&&a.jsx("span",{className:"feature-node__status-indicator feature-node__status-indicator--error",title:"Background execution failed",children:"!"}),l&&a.jsx("button",{className:"feature-node__control feature-node__control--danger",type:"button",onClick:x,title:"Remove node",children:""})]})]}),h&&a.jsx("p",{className:"feature-node__description",children:h}),k.map(w=>S(w,"source"))]})},Mo="__pending_confirmation__",YR=[/^columns?$/i,/_columns$/i,/_features$/i,/_list$/i,/_ids$/i,/^selected_/i,/^target_/i,/^include_/i,/^exclude_/i,/^skipped_/i,/_rules$/i,/_transformations$/i,/^strategies$/i,/^recommendations$/i],GR=[/methods$/i,/overrides$/i,/mapping$/i,/weights$/i,/assignments$/i],Hu=e=>e&&typeof e=="object"&&!Array.isArray(e),Xl=e=>{if(e==null)return{};try{return JSON.parse(JSON.stringify(e))}catch{return{...e}}},Vu=e=>typeof e=="string"&&qx.has(e),Wu=e=>{const t=e==null?void 0:e.default_config,n=(e==null?void 0:e.type)??"",s=!qx.has(n),i=c=>(s?c[Mo]=!0:delete c[Mo],c);if(t==null)return i({});const l=Xl(t);if(!Hu(l))return i(l&&typeof l=="object"?l:{});switch(Object.entries(l).forEach(([c,u])=>{Array.isArray(u)?YR.some(f=>f.test(c))&&(l[c]=[]):Hu(u)&&GR.some(f=>f.test(c))&&(l[c]={})}),"auto_detect"in l&&(l.auto_detect=!1),e==null?void 0:e.type){case"scale_numeric_features":l.columns=Array.isArray(l.columns)?l.columns:[],l.column_methods=Hu(l.column_methods)?l.column_methods:{},l.skipped_columns=Array.isArray(l.skipped_columns)?l.skipped_columns:[],l.default_method=typeof l.default_method=="string"&&l.default_method.trim()?l.default_method:"standard";break;case"polynomial_features":l.columns=Array.isArray(l.columns)?l.columns:[],l.auto_detect=!!l.auto_detect,l.include_bias=!!l.include_bias,l.interaction_only=!!l.interaction_only,l.include_input_features=!!l.include_input_features,l.degree=typeof l.degree=="number"&&Number.isFinite(l.degree)?l.degree:2,l.output_prefix=typeof l.output_prefix=="string"&&l.output_prefix.trim()?l.output_prefix:"poly";break;case"drop_missing_columns":"missing_threshold"in l&&(l.missing_threshold=null),l.columns=Array.isArray(l.columns)?l.columns:[];break;case"drop_missing_rows":"missing_threshold"in l&&(l.missing_threshold=null),"drop_if_any_missing"in l&&(l.drop_if_any_missing=!1);break;case"outlier_removal":l.method="manual",l.columns=Array.isArray(l.columns)?l.columns:[],l.manual_bounds=Hu(l.manual_bounds)?l.manual_bounds:{};break;case"missing_value_indicator":l.columns=Array.isArray(l.columns)?l.columns:[];break;case"remove_duplicates":if(l.columns=Array.isArray(l.columns)?l.columns:[],typeof l.keep=="string"){const c=l.keep.trim().toLowerCase();l.keep=c==="last"||c==="none"?c:"first"}else l.keep="first";break}return i(l)},QR=(e,t)=>t==="drop_missing_columns"||e===Bx?Ux:e,XR=e=>Array.isArray(e)?e.map(t=>({...t})):[],JR=[{id:"dataset-source",type:"featureNode",position:{x:-200,y:0},data:{label:"Dataset input",description:"Start from the currently selected dataset",isDataset:!0,isRemovable:!1,isConfigured:!0},style:{background:"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))",border:"1px solid rgba(59, 130, 246, 0.55)",color:"#e0f2fe",fontWeight:600}}],ZR=[],eL=e=>({...e,data:{...e.data??{}}}),Ku=()=>JR.map(e=>eL(e)),tL=()=>ZR.map(e=>({...e})),nL=12,sL=e=>{const n=`Dataset input
(${e&&e.trim()?e.trim():"Demo dataset"})`;return{nodes:[{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:n,isDataset:!0,isRemovable:!1},style:{whiteSpace:"pre-line",background:"#eef2ff",border:"1px solid rgba(99, 102, 241, 0.35)",color:"#312e81",fontWeight:600}},{id:"node-1",type:"featureNode",position:{x:260,y:40},data:{label:`Profile columns
(assess types & nulls)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(30, 41, 59, 0.95), rgba(15, 23, 42, 0.85))"}},{id:"node-4",type:"featureNode",position:{x:600,y:60},data:{label:`Feature preview
(sample rows)`},style:{whiteSpace:"pre-line",background:"linear-gradient(165deg, rgba(8, 145, 178, 0.42), rgba(2, 132, 199, 0.32))"}}],edges:[{id:"edge-dataset-profile",source:"dataset-source",target:"node-1",animated:!0,type:"animatedEdge",sourceHandle:"dataset-source-source",targetHandle:"node-1-target"},{id:"edge-profile-preview",source:"node-1",target:"node-4",animated:!0,type:"animatedEdge",sourceHandle:"node-1-source",targetHandle:"node-4-target"}]}},rL=(e,t,n)=>{if(!t||typeof t.project!="function"||!n)return;const s=n.getBoundingClientRect(),i=t.project({x:s.width/2,y:s.height/2});if(!i)return;const l=e.filter(p=>p.id!=="dataset-source").length,c=[{x:0,y:0},{x:220,y:0},{x:-220,y:0},{x:0,y:180},{x:220,y:180},{x:-220,y:180},{x:0,y:-180},{x:220,y:-180},{x:-220,y:-180}],u=l%c.length,d=Math.floor(l/c.length),f=c[u],h=d+1;return{x:i.x+f.x*h,y:i.y+f.y*h}},aL=new Set(["binned_distribution","skewness_distribution","skewness_transform","binning_discretization","label_encoding","target_encoding","ordinal_encoding","dummy_encoding","one_hot_encoding","hash_encoding","scale_numeric_features","polynomial_features","feature_selection","feature_math","missing_value_indicator","trim_whitespace","normalize_text_case","replace_aliases_typos","standardize_date_formats","remove_special_characters","replace_invalid_values","regex_replace_fix","class_undersampling","class_oversampling","feature_target_split","train_test_split","train_model_draft","model_evaluation","hyperparameter_tuning"]),Hx=(e,t)=>{if(!e)return!1;if(aL.has(e))return!0;const n=t==null?void 0:t.get(e);return n?(typeof n.category=="string"?n.category.toLowerCase():"").includes("preprocess"):!1},Vx=(e,t)=>{var C,w,E,A,R,P;const{handleOpenSettings:n,handleRemoveNode:s,catalogEntryMap:i}=t,l=e.data??{},c=l.isDataset??e.id==="dataset-source",u={...e.style??{}},d=l.catalogType??l.type??e.id;let h=Array.isArray(l.parameters)?l.parameters:null;if((!h||h.length===0)&&typeof d=="string"){const T=i.get(d)??null;(C=T==null?void 0:T.parameters)!=null&&C.length&&(h=T.parameters)}const p=XR(h);let g;if(p.length||l.config&&typeof l.config=="object"){const T=Xl(l.config);p.forEach(O=>{O!=null&&O.name&&T[O.name]===void 0&&O.default!==void 0&&(Array.isArray(O.default)?T[O.name]=[...O.default]:O.type==="boolean"?T[O.name]=!!O.default:T[O.name]=O.default)}),g=T}u.width||(u.width=c?Ix+20:Ix),u.minHeight||(u.minHeight=VR),u.padding||(u.padding=12),u.borderRadius||(u.borderRadius=16),u.boxSizing=u.boxSizing??"border-box",u.whiteSpace=u.whiteSpace??"pre-line",u.background||(u.background=c?"linear-gradient(165deg, rgba(30, 64, 175, 0.9), rgba(59, 130, 246, 0.85))":"linear-gradient(160deg, rgba(30, 41, 59, 0.92), rgba(15, 23, 42, 0.92))"),u.border||(u.border=c?"1px solid rgba(59, 130, 246, 0.55)":"1px solid rgba(148, 163, 184, 0.22)"),u.boxShadow||(u.boxShadow=c?"0 24px 54px rgba(59, 130, 246, 0.28)":"0 18px 42px rgba(2, 6, 23, 0.45)"),u.color||(u.color=c?"#e0f2fe":"#e2e8f0"),u.fontWeight||(u.fontWeight=c?600:500);const _=QR(l.description,d),N=Vu(d),v=g??(l.config&&typeof l.config=="object"?Xl(l.config):void 0);v&&typeof v=="object"&&N&&delete v[Mo];const x={...l,label:l.label??e.id,description:_,isDataset:c,isRemovable:l.isRemovable??!c,isConfigured:c||l.isConfigured===!0?!0:l.config&&typeof l.config=="object"?N?!0:!l.config[Mo]:!1,inputs:Array.isArray(l.inputs)?[...l.inputs]:l.inputs,outputs:Array.isArray(l.outputs)?[...l.outputs]:l.outputs,category:l.category,parameters:p,config:v,catalogType:d,onRemoveNode:s,onOpenSettings:n},j=typeof d=="string"?Ql[d]:void 0;if(j){const T=((w=j.inputs)==null?void 0:w.map(F=>HR(F)))??[],O=((E=j.outputs)==null?void 0:E.map(F=>F.label))??[];T.length?x.inputs=T:delete x.inputs,O.length?x.outputs=O:delete x.outputs,x.connectionInfo={inputs:((A=j.inputs)==null?void 0:A.map(F=>({...F})))??[],outputs:((R=j.outputs)==null?void 0:R.map(F=>({...F})))??[]}}else(!x.inputs||x.inputs.length===0)&&delete x.inputs,(!x.outputs||x.outputs.length===0)&&delete x.outputs,delete x.connectionInfo;const k=Vr(x.activeSplits);k.length?x.activeSplits=k:delete x.activeSplits;const S=Vr(x.connectedSplits);return S.length?x.connectedSplits=S:delete x.connectedSplits,d==="train_test_split"&&(x.activeSplits=[...Hr],S.length||delete x.connectedSplits),(P=x.parameters)!=null&&P.length||delete x.parameters,x.config===void 0&&delete x.config,{...e,type:"featureNode",position:e.position??{x:0,y:0},data:x,style:u}},oL=(e,t,n,s,i)=>{const l=(e==null?void 0:e.label)??(e==null?void 0:e.type)??s,c=typeof l=="string"&&l.trim()?l:s,u=Wu(e),d=Vu((e==null?void 0:e.type)??null);return Vx({id:t,type:"featureNode",position:n,data:{label:c,description:e==null?void 0:e.description,inputs:e==null?void 0:e.inputs,outputs:e==null?void 0:e.outputs,category:e==null?void 0:e.category,parameters:e==null?void 0:e.parameters,config:u,catalogType:e==null?void 0:e.type,isConfigured:!!d}},i)},iL=(e,t)=>{const n=e.map(i=>{const{data:l,...c}=i,u=l?{...l}:void 0;return u&&(delete u.onRemoveNode,delete u.onOpenSettings),JSON.parse(JSON.stringify({...c,data:u}))}),s=t.map(i=>JSON.parse(JSON.stringify(i)));return{nodes:n,edges:s}},lL=()=>{var h;const[e,t]=y.useState(!1),n=y.useRef(new Map),s=$s({queryKey:["feature-canvas","node-catalog"],queryFn:Jv,staleTime:5*60*1e3}),i=s.data??[],l=s.isLoading||s.isFetching,c=s.error?((h=s.error)==null?void 0:h.message)??"Unable to load node catalog":null;y.useEffect(()=>{const p=new Map;i.forEach(g=>{g&&typeof g.type=="string"&&g.type.trim()&&p.set(g.type,g)}),n.current=p},[i]);const u=y.useCallback(()=>t(!0),[]),d=y.useCallback(()=>t(!1),[]),f=y.useCallback(()=>t(p=>!p),[]);return{nodeCatalog:i,catalogEntryMapRef:n,isCatalogOpen:e,openCatalog:u,closeCatalog:d,toggleCatalog:f,isCatalogLoading:l,catalogErrorMessage:c}},Yu=e=>!e||!e.length?"":e.join(", "),cL=({nodes:e,onAddNode:t})=>{const[n,s]=y.useState(""),[i,l]=y.useState([]),c=n.trim().toLowerCase(),u=y.useMemo(()=>c?e.filter(g=>{const _=[g.label,g.type,g.description];return g.category&&_.push(g.category),g.tags&&g.tags.length&&_.push(g.tags.join(" ")),_.some(N=>N==null?void 0:N.toLowerCase().includes(c))}):e,[e,c]),d=y.useMemo(()=>{const g=new Map;return u.forEach(_=>{var x;const N=((x=_.category)==null?void 0:x.trim())||"Other",v=g.get(N)??[];v.push(_),g.set(N,v)}),Array.from(g.entries()).sort(([_],[N])=>_.localeCompare(N)).map(([_,N])=>({category:_,entries:N.sort((v,x)=>(v.label||v.type).localeCompare(x.label||x.type))}))},[u]);y.useEffect(()=>{if(!c){l([]);return}l(g=>{const _=new Set(g);let N=!1;return d.forEach(({category:v})=>{_.has(v)||(_.add(v),N=!0)}),N?Array.from(_):g})},[d,c]);const f=g=>{l(_=>{const N=new Set(_);return N.has(g)?N.delete(g):N.add(g),Array.from(N)})},h=u.length,p=h>0;return a.jsxs("div",{className:"feature-canvas-sidebar",role:"presentation",children:[a.jsxs("header",{className:"feature-canvas-sidebar__header",children:[a.jsx("h3",{children:"Available steps"}),a.jsxs("div",{className:"feature-canvas-sidebar__search",children:[a.jsx("input",{type:"search",value:n,onChange:g=>s(g.target.value),placeholder:"Search by name, tag, or output",className:"feature-canvas-sidebar__search-input","aria-label":"Search available steps"}),n&&a.jsx("button",{type:"button",className:"feature-canvas-sidebar__search-clear",onClick:()=>s(""),"aria-label":"Clear search",children:""})]}),a.jsxs("span",{className:"feature-canvas-sidebar__results",children:["Showing ",h," ",h===1?"step":"steps",c?` matching ${n.trim()}`:""]})]}),p?a.jsx("div",{className:"feature-canvas-sidebar__sections",children:d.map(({category:g,entries:_})=>{const N=i.includes(g);return a.jsxs("section",{className:"feature-canvas-sidebar__section",children:[a.jsxs("button",{type:"button",className:"feature-canvas-sidebar__section-toggle",onClick:()=>f(g),"aria-expanded":N,children:[a.jsx("span",{className:"feature-canvas-sidebar__section-label",children:g.charAt(0).toUpperCase()+g.slice(1)}),a.jsxs("span",{className:"feature-canvas-sidebar__section-meta",children:[_.length,a.jsx("span",{className:"feature-canvas-sidebar__section-arrow","data-expanded":N,children:""})]})]}),N&&a.jsx("div",{className:"feature-canvas-sidebar__group",children:_.map(v=>{var x,j;return a.jsx("button",{className:"feature-canvas-sidebar__card",type:"button",onClick:()=>t==null?void 0:t(v),children:a.jsxs("div",{className:"feature-canvas-sidebar__card-body",children:[a.jsx("span",{className:"feature-canvas-sidebar__card-title",children:v.label||v.type}),v.description&&a.jsx("span",{className:"feature-canvas-sidebar__card-description",children:v.description}),a.jsxs("div",{className:"feature-canvas-sidebar__card-tags",children:[(x=v.inputs)!=null&&x.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Inputs: ${Yu(v.inputs)}`,children:["In: ",Yu(v.inputs)]}):null,(j=v.outputs)!=null&&j.length?a.jsxs("span",{className:"feature-canvas-sidebar__chip",title:`Outputs: ${Yu(v.outputs)}`,children:["Out: ",Yu(v.outputs)]}):null,v.parameters&&v.parameters.length>0?a.jsxs("span",{className:"feature-canvas-sidebar__chip",children:[v.parameters.length," param",v.parameters.length>1?"s":""]}):null]})]})},v.type)})})]},g)})}):a.jsx("div",{className:"feature-canvas-sidebar__empty",children:a.jsxs("p",{children:["No steps match ",n.trim(),". Try adjusting your search or browse by category."]})})]})},uL=({nodeCatalog:e,isCatalogLoading:t,catalogErrorMessage:n,handleAddNode:s})=>({sidebarContent:y.useMemo(()=>t?a.jsx("p",{className:"text-muted",children:"Loading node catalog"}):n?a.jsx("p",{className:"text-danger",children:n}):e.length?a.jsx(cL,{nodes:e,onAddNode:s}):a.jsx("p",{className:"text-muted",children:"Node catalog unavailable. Define nodes in the backend to continue."}),[n,s,t,e])}),dL=({setNodes:e,setEdges:t,setSelectedNodeId:n,setIsSettingsModalOpen:s,catalogEntryMapRef:i,handleOpenSettings:l,reactFlowInstanceRef:c,canvasViewportRef:u,scheduleFitView:d})=>{const f=y.useRef(0),h=y.useCallback(S=>{S!=="dataset-source"&&(e(C=>C.filter(w=>w.id!==S)),t(C=>C.filter(w=>w.source!==S&&w.target!==S)),n(C=>C===S?(s(!1),null):C))},[t,s,e,n]),p=y.useCallback(S=>Vx(S,{handleOpenSettings:l,handleRemoveNode:h,catalogEntryMap:i.current}),[i,l,h]),g=y.useCallback(S=>{const C=S.reduce((w,E)=>{if(typeof E.id=="string"&&E.id.startsWith("node-")){const A=Number(E.id.replace("node-",""));if(!Number.isNaN(A))return Math.max(w,A)}return w},0);C>f.current&&(f.current=C)},[]),_=y.useCallback((S,C)=>{const w=f.current+1,E=`node-${w}`;f.current=w;const A=C??{x:160+(w-1)%4*220,y:40+Math.floor((w-1)/4)*160};return p(oL(S??null,E,A,`Step ${w}`,{handleOpenSettings:l,handleRemoveNode:h,catalogEntryMap:i.current}))},[i,l,h,p]),N=y.useCallback(S=>{e(C=>{const w=rL(C,c.current,u.current),E=_(S,w);return[...C,E]}),d()},[u,_,c,d,e]),v=y.useCallback((S,C)=>{e(w=>w.map(E=>{if(E.id!==S)return E;const A=Xl(C);A&&typeof A=="object"&&delete A[Mo];const R={...E.data??{},config:A,isConfigured:!0};return p({...E,data:R})}))},[p,e]),x=y.useCallback((S,C)=>{e(w=>w.map(E=>{if(E.id!==S)return E;const A={...E.data??{},...C};return p({...E,data:A})}))},[p,e]),j=y.useCallback((S,C)=>{e(w=>w.map(E=>{var O;if(E.id!==S)return E;const A=(O=E==null?void 0:E.data)==null?void 0:O.catalogType,R=A?i.current.get(A)??null:null,P=C&&typeof C=="object"?Xl(C):Wu(R??null),T={...E.data??{},config:P,isConfigured:!1,backgroundExecutionStatus:"idle"};return p({...E,data:T})}))},[i,p,e]),k=y.useCallback(()=>{e(S=>S.map(C=>{var P,T;if(!Hx((P=C==null?void 0:C.data)==null?void 0:P.catalogType,i.current))return C;const w=(T=C==null?void 0:C.data)==null?void 0:T.catalogType,E=w?i.current.get(w)??null:null,A=Wu(E??null),R={...C.data??{},config:A,isConfigured:!1,backgroundExecutionStatus:"idle"};return p({...C,data:R})}))},[i,p,e]);return{registerNode:p,createNode:_,handleAddNode:N,handleRemoveNode:h,handleUpdateNodeConfig:v,handleUpdateNodeData:x,handleResetNodeConfig:j,handleResetAllNodes:k,updateNodeCounter:g}},mL=({sourceId:e,datasetDisplayLabel:t,registerNode:n,prepareNodes:s,setNodes:i,setEdges:l,updateNodeCounter:c,scheduleFitView:u,onPipelineHydrated:d,onPipelineError:f})=>{const h=y.useRef(!1),p=$s({queryKey:["feature-canvas","pipeline",e],queryFn:()=>my(e),enabled:!!e,staleTime:60*1e3,retry:1});return y.useEffect(()=>{const g=`Dataset input
(${t})`;if(!e){if(h.current)i(_=>{let N=!1;const v=_.map(x=>{var k;return x.id!=="dataset-source"||(((k=x==null?void 0:x.data)==null?void 0:k.label)??"")===g?x:(N=!0,n({...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}))});return N?v:_});else{const _=sL(t),N=s(_.nodes);h.current=!0,i(N),l(_.edges),c(N),u(),d==null||d({nodes:N,edges:_.edges,pipeline:null,context:"sample"})}return}if(h.current=!1,p.isLoading){i(_=>_.map(N=>N.id==="dataset-source"?n({...N,data:{...N.data??{},label:g,isDataset:!0,isRemovable:!1}}):N));return}if(p.isError){const _=p.error??new Error("Failed to load saved pipeline");console.error("Failed to load saved pipeline",_),f==null||f(_);const N=Ku().map(x=>x.id==="dataset-source"?{...x,data:{...x.data??{},label:g,isDataset:!0,isRemovable:!1}}:x),v=s(N);i(v),l([]),c(v),u(),d==null||d({nodes:v,edges:[],pipeline:null,context:"reset"});return}if(p.data){const _=p.data.graph??{},N=Array.isArray(_==null?void 0:_.nodes)&&_.nodes.length?_.nodes:Ku(),v=s(N),j=(Array.isArray(_==null?void 0:_.edges)?_.edges:[]).map(k=>{var T;const S=k==null?void 0:k.type,C=!S||S==="smoothstep"||S==="default"?"animatedEdge":S,w=k==null?void 0:k.source,E=k==null?void 0:k.target,A=v.find(O=>O.id===E),R=(k==null?void 0:k.sourceHandle)??(w?`${w}-source`:void 0),P=(k==null?void 0:k.targetHandle)??((T=A==null?void 0:A.data)!=null&&T.isDataset?void 0:E?`${E}-target`:void 0);return{...k,animated:(k==null?void 0:k.animated)??!0,type:C,sourceHandle:R,targetHandle:P}});i(v),l(j),c(v),u(),d==null||d({nodes:v,edges:j,pipeline:p.data??null,context:"stored"});return}if(p.isFetched&&!p.data){const _=Ku().map(v=>v.id==="dataset-source"?{...v,data:{...v.data??{},label:g,isDataset:!0,isRemovable:!1}}:v),N=s(_);i(N),l([]),c(N),u(),d==null||d({nodes:N,edges:[],pipeline:null,context:"sample"})}},[t,d,f,p.data,p.error,p.isError,p.isFetched,p.isLoading,s,n,u,l,i,e,c]),{isPipelineLoading:p.isLoading||p.isFetching}},hL=new Set(["train_model_draft","model_registry_overview","model_evaluation","hyperparameter_tuning"]),fL=e=>{var n;const t=e?Ql[e]:void 0;return(n=t==null?void 0:t.inputs)!=null&&n.length?t.inputs.filter(s=>s.required!==!1).map(s=>s.key):[]},pL=(e,t,n)=>{const s=fL(t);if(s.length===0)return!0;const i=n.filter(c=>c.target===e),l=new Set(i.map(c=>Dx(e,c.targetHandle)).filter(c=>!!c));return s.every(c=>l.has(c))},gL=(e,t)=>{const n=new Map,s=new Set;e.forEach(d=>{var h;const f=(h=d==null?void 0:d.data)==null?void 0:h.catalogType;if(f&&hL.has(f)){s.add(d.id);return}f==="train_test_split"&&n.set(d.id,new Set(Hr))});let i=!0,l=0;const c=e.length*3;for(;i&&l<c;)i=!1,l++,t.forEach(d=>{if(s.has(d.source)||s.has(d.target))return;const f=n.get(d.source),h=Rx(d.sourceHandle);if(!f||f.size===0)return;n.has(d.target)||n.set(d.target,new Set);const p=n.get(d.target),g=p.size;h?f.has(h)&&p.add(h):f.forEach(_=>p.add(_)),p.size>g&&(i=!0)});const u=new Map;return n.forEach((d,f)=>{!d.size||s.has(f)||u.set(f,Hr.filter(h=>d.has(h)))}),u},_L=e=>{const t=new Map;e.forEach(s=>{const i=Rx(s.sourceHandle);i&&(t.has(s.source)||t.set(s.source,new Set),t.get(s.source).add(i))});const n=new Map;return t.forEach((s,i)=>{n.set(i,Hr.filter(l=>s.has(l)))}),n},vL=({edges:e,setNodes:t,scheduleNodeInternalsUpdate:n})=>{y.useEffect(()=>{const s=[];t(i=>{const l=gL(i,e),c=_L(e);let u=!1;const d=i.map(f=>{var E,A,R,P,T;const p=((E=f==null?void 0:f.data)==null?void 0:E.catalogType)==="train_test_split"?[...Hr]:l.get(f.id)??[],g=Vr((A=f.data)==null?void 0:A.activeSplits),_=Vr(c.get(f.id)),N=Vr((R=f.data)==null?void 0:R.connectedSplits),v=((P=f==null?void 0:f.data)==null?void 0:P.catalogType)??"",x=pL(f.id,v,e),j=((T=f.data)==null?void 0:T.hasRequiredConnections)??!0,k=!Px(g,p),S=!Px(N,_);if(!k&&!S&&!(x!==j))return f;const w={...f.data,hasRequiredConnections:x};return p.length?w.activeSplits=p:delete w.activeSplits,_.length?w.connectedSplits=_:delete w.connectedSplits,(k||S)&&s.push(f.id),u=!0,{...f,data:w}});return u?d:i}),s.length&&n(s)},[e,n,t])},yL=({nodes:e,setEdges:t,scheduleNodeInternalsUpdate:n})=>{const s=y.useCallback(l=>{var _,N;const{source:c,target:u,sourceHandle:d,targetHandle:f}=l;if(!c||!u||!f||c===u)return!1;const h=e.find(v=>v.id===u);if(!h)return!1;const p=((_=h==null?void 0:h.data)==null?void 0:_.catalogType)??"",g=p?Ql[p]:void 0;if((N=g==null?void 0:g.inputs)!=null&&N.length){const v=Dx(u,f);if(!v)return!1;const x=g.inputs.find(j=>j.key===v);return!x||!d?!1:x.accepts&&x.accepts.length>0?x.accepts.some(j=>{const k=UR[j];return k?k(d):!1}):!0}return!0},[e]),i=y.useCallback(l=>{t(u=>k_({...l,type:"animatedEdge",animated:!0},u));const c=[l.source,l.target].filter(u=>!!u);c.length&&n(c)},[n,t]);return{isValidConnection:s,onConnect:i}},bL=(e,t,n,s)=>{if(e===n&&t===s)return`M ${e},${t}`;const i=Math.abs(n-e),l=Math.max(64,Math.min(i*.45,240)),c=Number.isFinite(l)?l:100,u=n>=e?1:-1,d=e+u*c,f=t,h=n-u*c;return`M ${e},${t} C ${d},${f} ${h},${s} ${n},${s}`},xL=({sourceX:e,sourceY:t,targetX:n,targetY:s,sourcePosition:i,targetPosition:l})=>{const c=bL(e,t,n,s),u="connection-line-gradient";return a.jsxs("g",{children:[a.jsxs("defs",{children:[a.jsxs("linearGradient",{id:u,gradientUnits:"userSpaceOnUse",x1:e,y1:t,x2:n,y2:s,children:[a.jsx("stop",{offset:"0%",stopColor:"#38bdf8",stopOpacity:.8}),a.jsx("stop",{offset:"50%",stopColor:"#6366f1",stopOpacity:.9}),a.jsx("stop",{offset:"100%",stopColor:"#a855f7",stopOpacity:.85})]}),a.jsxs("filter",{id:"connection-glow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[a.jsx("feGaussianBlur",{stdDeviation:"3",result:"coloredBlur"}),a.jsxs("feMerge",{children:[a.jsx("feMergeNode",{in:"coloredBlur"}),a.jsx("feMergeNode",{in:"SourceGraphic"})]})]})]}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:8,strokeOpacity:.2,strokeLinecap:"round",style:{filter:"url(#connection-glow)"}}),a.jsx("path",{d:c,fill:"none",stroke:`url(#${u})`,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",style:{strokeDasharray:"8 4",animation:"connection-line-dash 1s linear infinite"}}),a.jsx("circle",{cx:n,cy:s,r:6,fill:"#a855f7",opacity:.8,style:{animation:"connection-pulse 1.5s ease-in-out infinite"}})]})},wL=({nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:i,onEdgesChange:l,onConnect:c,isValidConnection:u,onNodeClick:d,reactFlowInstanceRef:f,canvasViewportRef:h,handleResetAllNodes:p,openCatalog:g})=>a.jsxs("div",{className:"canvas-stage__viewport",ref:h,children:[a.jsxs(Gv,{style:{width:"100%",height:"100%"},nodes:e,edges:t,nodeTypes:n,edgeTypes:s,onNodesChange:i,onEdgesChange:l,onConnect:c,isValidConnection:u,onNodeClick:d,onInit:_=>{f.current=_,requestAnimationFrame(()=>_.fitView({padding:.25}))},minZoom:.5,maxZoom:1.75,connectionRadius:180,connectionMode:vo.Loose,connectOnClick:!0,nodeDragHandle:".feature-node__drag-handle",defaultEdgeOptions:{type:"animatedEdge",animated:!0,style:{strokeWidth:3}},connectionLineComponent:xL,elevateEdgesOnSelect:!0,edgesUpdatable:!1,children:[a.jsx(zE,{position:"bottom-left"}),a.jsx(UE,{gap:16})]}),a.jsx("button",{type:"button",className:"canvas-fab canvas-fab--reset",onClick:p,"aria-label":"Reset preprocessing nodes",children:""}),a.jsx("button",{type:"button",className:"canvas-fab",onClick:g,"aria-label":"Open node catalog",children:"+"})]}),NL=y.forwardRef(({sourceId:e,datasetName:t,onGraphChange:n,onPipelineHydrated:s,onPipelineError:i},l)=>{const c=y.useMemo(()=>({featureNode:KR}),[]),u=y.useMemo(()=>({animatedEdge:f1}),[]),[d,f,h]=u1(Ku().map(Be=>({...Be,type:"featureNode"}))),[p,g,_]=d1(tL()),[N,v]=y.useState(null),[x,j]=y.useState(!1),k=y.useRef(null),S=y.useRef(null),C=y.useRef(!1),w=t??e??"Demo dataset",E=HE(),{nodeCatalog:A,catalogEntryMapRef:R,isCatalogOpen:P,openCatalog:T,closeCatalog:O,isCatalogLoading:F,catalogErrorMessage:B}=lL(),L=y.useCallback(Be=>{const de=(Array.isArray(Be)?Be:[Be]).filter(Boolean);if(!de.length)return;const pe=Array.from(new Set(de));requestAnimationFrame(()=>{requestAnimationFrame(()=>{pe.forEach(xe=>{E(xe)})})})},[E]);vL({edges:p,setNodes:f,scheduleNodeInternalsUpdate:L});const D=y.useMemo(()=>d.find(Be=>Be.id===N)??null,[d,N]),q=y.useMemo(()=>iL(d,p),[p,d]),Y=y.useCallback(Be=>{v(Be),j(!0)},[]),W=y.useCallback(()=>{j(!1),v(null)},[]),X=y.useCallback(()=>{C.current=!0},[]);y.useEffect(()=>{C.current&&(C.current=!1,requestAnimationFrame(()=>{var Be;(Be=k.current)==null||Be.fitView({padding:.25,duration:350})}))},[p,d]);const{registerNode:I,handleAddNode:z,handleUpdateNodeConfig:H,handleUpdateNodeData:te,handleResetNodeConfig:K,handleResetAllNodes:V,updateNodeCounter:G}=dL({setNodes:f,setEdges:g,setSelectedNodeId:v,setIsSettingsModalOpen:j,catalogEntryMapRef:R,handleOpenSettings:Y,reactFlowInstanceRef:k,canvasViewportRef:S,scheduleFitView:X});y.useEffect(()=>{G(d)},[d,G]);const Q=y.useCallback(Be=>Be.map(de=>{const pe={...de.data??{}};de.id==="dataset-source"&&(pe.label=`Dataset input
(${w})`,pe.isDataset=!0,pe.isRemovable=!1,pe.isConfigured=!0);const xe=pe.catalogType??pe.type??de.id;return pe.config&&typeof pe.config=="object"&&Vu(xe)&&delete pe.config[Mo],pe.isConfigured===void 0&&(pe.config&&typeof pe.config=="object"?pe.isConfigured=Vu(xe)?!0:!pe.config[Mo]:pe.isConfigured=!0),I({...de,data:pe})}),[w,I]),{isPipelineLoading:ne}=mL({sourceId:e,datasetDisplayLabel:w,registerNode:I,prepareNodes:Q,setNodes:f,setEdges:g,updateNodeCounter:G,scheduleFitView:X,onPipelineHydrated:s,onPipelineError:i}),J=y.useCallback(()=>{f(Be=>{const de=Be.find(xe=>xe.id==="dataset-source");return[I(de?{...de,data:{...de.data??{},label:`Dataset input
(${w})`,isDataset:!0,isRemovable:!1,isConfigured:!0}}:{id:"dataset-source",type:"featureNode",position:{x:-200,y:40},data:{label:`Dataset input
(${w})`,isDataset:!0,isRemovable:!1,isConfigured:!0}})]}),g([]),v(null),j(!1),X()},[w,I,X,g,f,v,j]);y.useImperativeHandle(l,()=>({openCatalog:T,closeCatalog:O,clearGraph:J}),[J,O,T]);const{isValidConnection:re,onConnect:Se}=yL({nodes:d,setEdges:g,scheduleNodeInternalsUpdate:L});y.useEffect(()=>{n==null||n(d,p)},[p,d,n]);const Re=y.useMemo(()=>{var pe;if(!D)return null;const Be=(pe=D==null?void 0:D.data)==null?void 0:pe.catalogType;if(!Be)return null;const de=R.current.get(Be);return de?Wu(de):null},[D]),Oe=y.useMemo(()=>{var de,pe;if(!D||(de=D.data)!=null&&de.isDataset)return!1;const Be=(pe=D==null?void 0:D.data)==null?void 0:pe.catalogType;return Hx(typeof Be=="string"?Be:null,R.current)},[D]),{sidebarContent:Fe}=uL({nodeCatalog:A,isCatalogLoading:F,catalogErrorMessage:B,handleAddNode:z}),lt=y.useCallback((Be,de)=>{Y(de.id)},[Y]);return a.jsxs("div",{className:"canvas-stage","data-pipeline-loading":ne?"true":"false","aria-busy":ne,children:[a.jsx(wL,{nodes:d,edges:p,nodeTypes:c,edgeTypes:u,onNodesChange:h,onEdgesChange:_,onConnect:Se,isValidConnection:re,onNodeClick:lt,reactFlowInstanceRef:k,canvasViewportRef:S,handleResetAllNodes:V,openCatalog:T}),a.jsxs("div",{className:`canvas-drawer${P?" canvas-drawer--open":""}`,children:[a.jsxs("div",{className:"canvas-drawer__header",children:[a.jsx("h2",{children:"Node catalog"}),a.jsx("button",{type:"button",className:"canvas-drawer__close",onClick:O,"aria-label":"Close catalog",children:""})]}),a.jsx("div",{className:"canvas-drawer__body",children:Fe})]}),P&&a.jsx("div",{className:"canvas-drawer__backdrop",onClick:O}),x&&D&&a.jsx(FR,{node:D,sourceId:e??null,graphSnapshot:q,onClose:W,onUpdateConfig:H,onUpdateNodeData:te,onResetConfig:K,defaultConfigTemplate:Re,isResetAvailable:Oe})]})}),Wx=e=>{if(!e)return null;let t=e.trim();if(!t)return null;/^\d{4}-\d{2}-\d{2}\s+\d/.test(t)&&(t=t.replace(" ","T")),/(Z|z|[+-]\d{2}:?\d{2})$/.test(t)||(t=`${t}Z`);const n=new Date(t);return Number.isNaN(n.getTime())?null:n},af=e=>{const t=Wx(e);return t?t.toLocaleString(void 0,{dateStyle:"medium",timeStyle:"short"}):"Unknown time"},of=e=>{const t=Wx(e);if(!t)return null;const n=t.getTime(),s=Date.now()-n,i=Math.round(s/6e4);if(i<1)return"just now";if(i===1)return"1 minute ago";if(i<60)return`${i} minutes ago`;const l=Math.round(i/60);if(l===1)return"1 hour ago";if(l<24)return`${l} hours ago`;const c=Math.round(l/24);if(c===1)return"1 day ago";if(c<7)return`${c} days ago`;const u=Math.round(c/7);return u===1?"1 week ago":`${u} weeks ago`},jL=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:i,canSelectDatasets:l,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:f,onDatasetSelection:h,onClearCanvas:p,onRefreshHistory:g,onSaveClick:_,isHistoryLoading:N,historyErrorMessage:v,historyItems:x,activePipelineId:j,isDirty:k,isSaveDisabled:S,saveButtonLabel:C,saveFeedback:w,feedbackIcon:E,feedbackClass:A,onSelectHistory:R})=>{const P=d?(u==null?void 0:u.name)??d:null;return a.jsxs("aside",{id:"feature-canvas-sidepanel",className:"canvas-sidepanel",role:"complementary","aria-label":"Canvas details",children:[a.jsxs("div",{className:"canvas-sidepanel__content",role:"group","aria-label":"Canvas controls",children:[a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"Dataset"}),e&&a.jsx("span",{className:"canvas-sidepanel__meta",children:of(e)??af(e)})]}),t?a.jsx("p",{className:"text-danger",children:t}):i?a.jsx("div",{className:"canvas-sidepanel__select-wrapper",children:a.jsx("select",{className:"canvas-sidepanel__select",value:d??"",onChange:T=>h(T.target.value),disabled:n||!l,"aria-label":"Select dataset",children:c.map(T=>a.jsx("option",{value:T.value,disabled:!T.isOwned,children:`${T.label}${T.isOwned?"":" (locked)"}`},T.value))})}):a.jsx("p",{className:"text-muted",children:"Dataset switching is limited to collections you own."}),n&&a.jsx("p",{className:"text-muted",children:"Loading datasets"}),!n&&!s&&!t&&a.jsx("p",{className:"text-muted",children:"No datasets available. Send one from EDA to get started."}),(u==null?void 0:u.description)&&a.jsx("p",{className:"canvas-sidepanel__description",children:u.description}),P&&a.jsxs("p",{className:"canvas-sidepanel__meta",children:["Working with ",a.jsx("strong",{children:P})]}),!l&&i>0&&a.jsx("p",{className:"canvas-sidepanel__hint",children:"Add more owned datasets to switch between them."})]}),a.jsxs("section",{className:"canvas-sidepanel__section",children:[a.jsx("div",{className:"canvas-sidepanel__section-action",children:a.jsxs("button",{type:"button",className:"canvas-sidepanel__action-button",onClick:p,disabled:!f,"aria-label":"Clean all nodes",title:f?"Remove all nodes and edges from the canvas":"Nothing to clean yet",children:[a.jsx("span",{"aria-hidden":"true",children:""}),a.jsx("span",{children:"Clean all nodes"})]})}),a.jsxs("div",{className:"canvas-sidepanel__section-heading",children:[a.jsx("h2",{children:"History"}),a.jsxs("div",{className:"canvas-sidepanel__section-controls",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:g,disabled:N||!d,"aria-label":"Refresh history",title:"Refresh history",children:""}),a.jsx("button",{type:"button",className:"canvas-sidepanel__icon-button",onClick:_,disabled:S,"aria-label":C,title:C,children:""})]})]}),a.jsx("div",{className:"canvas-sidepanel__history",children:N?a.jsx("p",{className:"text-muted",children:"Loading history"}):v?a.jsx("p",{className:"text-danger",children:v}):x.length?x.map(T=>{const F=of(T.updated_at)??af(T.updated_at),B=T.id===j,L=B&&!k;return a.jsxs("button",{type:"button",className:`canvas-sidepanel__history-item${B?" canvas-sidepanel__history-item--active":""}`,onClick:()=>R(T),disabled:L,children:[a.jsx("span",{className:"canvas-sidepanel__history-title",children:T.name||`Pipeline #${T.id}`}),a.jsx("span",{className:"canvas-sidepanel__history-meta",children:F}),B&&k&&a.jsx("span",{className:"canvas-sidepanel__history-badge",children:"Unsaved edits"})]},T.id)}):a.jsx("p",{className:"text-muted",children:"No saved revisions yet. Save a draft to populate history."})})]})]}),w&&a.jsxs("p",{className:`canvas-sidepanel__feedback ${A}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:E}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:w.message})]})]})},CL=e=>{var _;const[t,n]=y.useState(e??null),[s,i]=y.useState(null),l=$s({queryKey:["feature-canvas","datasets"],queryFn:()=>Zv(12),staleTime:5*60*1e3}),c=l.data??[],u=y.useMemo(()=>c.filter(N=>(N==null?void 0:N.is_owned)!==!1),[c]);y.useEffect(()=>{if(!c.length){i(null);return}if(t){const v=c.find(x=>x.source_id===t);if(v){i(x=>(x==null?void 0:x.id)===v.id?x:v);return}}const N=u[0]??c[0];N&&(t||n(N.source_id??String(N.id)),i(N))},[t,c,u]);const d=y.useMemo(()=>c.map(N=>({value:N.source_id,label:N.name??N.source_id,isOwned:N.is_owned!==!1})),[c]),f=u.length>1,h=c.length>0,p=u.length,g=l.error?((_=l.error)==null?void 0:_.message)??"Unable to load datasets":null;return{datasets:c,ownedDatasets:u,selectedDataset:s,setSelectedDataset:i,activeSourceId:t,setActiveSourceId:n,datasetOptions:d,canSelectDatasets:f,hasDatasets:h,ownedDatasetsCount:p,isDatasetLoading:l.isLoading,datasetErrorMessage:g}},SL=({sourceId:e,setIsDirty:t,setSaveFeedback:n,isHydratingRef:s})=>{const i=CL(e),{datasets:l,setActiveSourceId:c,setSelectedDataset:u}=i,d=y.useCallback(f=>{const h=l.find(p=>p.source_id===f)??null;if(!h){n({message:"Dataset unavailable. Choose another option.",tone:"error"});return}if(h.is_owned===!1){n({message:"Only datasets you own can be selected.",tone:"error"});return}c(f),u(h),s.current=!0,t(!1),n(null)},[l,s,c,t,n,u]);return{...i,handleDatasetSelection:d}},Kx=(e,t)=>({nodes:JSON.parse(JSON.stringify(e??[])),edges:JSON.parse(JSON.stringify(t??[]))}),Yx=e=>Array.isArray(e)?e.some(t=>(t==null?void 0:t.id)&&t.id!=="dataset-source"):!1,Gx=e=>Array.isArray(e)?e.length>0:!1,EL=({setIsDirty:e,setSaveFeedback:t,isHydratingRef:n})=>{const s=y.useRef({nodes:[],edges:[]}),[i,l]=y.useState(!1),c=y.useCallback((d,f)=>{const h=Kx(d,f);s.current=h;const p=Yx(h.nodes),g=Gx(h.edges);return l(p||g),{hasCustomNodes:p,hasEdges:g}},[]),u=y.useCallback((d,f)=>{const h=Kx(d,f),p=s.current,g=JSON.stringify(p.nodes??[])===JSON.stringify(h.nodes??[])&&JSON.stringify(p.edges??[])===JSON.stringify(h.edges??[]);s.current=h;const _=Yx(h.nodes),N=Gx(h.edges);l(_||N),!(n.current||g)&&(e(!0),t(null))},[n,e,t]);return{graphSnapshotRef:s,canClearCanvas:i,handleGraphChange:u,applyHydratedSnapshot:c}},kL=({canvasShellRef:e,canClearCanvas:t,setSaveFeedback:n})=>y.useCallback(()=>{var s;t&&(typeof window<"u"&&!window.confirm("Clear all nodes and connections from the canvas? This cannot be undone.")||((s=e.current)==null||s.clearGraph(),n(i=>(i==null?void 0:i.tone)==="error"?i:{message:"Canvas cleared. Unsaved edits pending.",tone:"info"})))},[e,t,n]),ML=({activeSourceId:e,isDirty:t,setSaveFeedback:n,pipelineQueryKey:s,pendingHistoryIdRef:i,isHydratingRef:l,historyLimit:c=nL})=>{var h;const u=ho(),d=$s({queryKey:["feature-canvas","pipeline-history",e],queryFn:()=>fy(e,c),enabled:!!e,staleTime:30*1e3,retry:1}),f=y.useCallback(p=>{if(!(p!=null&&p.graph)){n({message:"Selected revision is missing pipeline data.",tone:"error"});return}t&&typeof window<"u"&&!window.confirm("You have unsaved changes. Replace the canvas with the selected revision?")||(i.current=p.id??null,l.current=!0,n({message:`Loading revision ${p.name??`#${p.id}`}`,tone:"info"}),u.setQueryData(s,p))},[t,l,i,s,u,n]);return{historyItems:d.data??[],isHistoryLoading:d.isLoading||d.isFetching,historyErrorMessage:d.error?((h=d.error)==null?void 0:h.message)??"Unable to load history":null,refetchHistory:d.refetch,handleHistorySelection:f}},AL=({applyHydratedSnapshot:e,selectedDataset:t,activeSourceId:n,setActivePipelineId:s,setActivePipelineName:i,setActivePipelineUpdatedAt:l,setIsDirty:c,setSaveFeedback:u,pendingHistoryIdRef:d,isHydratingRef:f})=>{const h=y.useCallback(g=>{const{nodes:_,edges:N,pipeline:v,context:x}=g,{hasCustomNodes:j}=e(_,N),k=(v==null?void 0:v.id)??null;if(s(k),i((v==null?void 0:v.name)??null),l((v==null?void 0:v.updated_at)??null),x==="stored"&&v)if(d.current===v.id){const C=of(v.updated_at)??af(v.updated_at);u({message:`Saved revision ${v.name??`#${v.id}`} (${C})`,tone:"info"}),d.current=null}else f.current&&u(S=>(S==null?void 0:S.tone)==="error"?S:j?{message:"Loaded saved pipeline",tone:"info"}:S);else x==="sample"?(d.current=null,u(S=>(S==null?void 0:S.tone)==="error"||j?S:{message:`Showing starter pipeline for ${(t==null?void 0:t.name)??(t==null?void 0:t.source_id)??n??"demo dataset"}`,tone:"info"})):x==="reset"?d.current=null:v||(d.current=null,u(S=>(S==null?void 0:S.tone)==="error"?S:null));f.current&&c(!1),v&&d.current&&d.current!==v.id&&(d.current=null),f.current=!1},[n,e,d,t,s,i,l,c,u,f]),p=y.useCallback(g=>{u({message:(g==null?void 0:g.message)??"Unable to load saved pipeline. Starting fresh.",tone:"error"})},[u]);return{handlePipelineHydrated:h,handlePipelineError:p}},OL=({queryClient:e,setSaveFeedback:t,setIsDirty:n,setActivePipelineId:s,setActivePipelineName:i,setActivePipelineUpdatedAt:l,pendingHistoryIdRef:c})=>{const{mutate:u,isPending:d}=Bc({mutationFn:async({sourceId:f,payload:h})=>hy(f,h),onSuccess:(f,h)=>{t({message:"Draft saved successfully.",tone:"success"}),n(!1),s(f.id??null),i(f.name??null),l(f.updated_at??null),c.current=f.id??null,e.setQueryData(["feature-canvas","pipeline",h.sourceId],f),e.invalidateQueries({queryKey:["feature-canvas","pipeline-history",h.sourceId],exact:!1})},onError:f=>{t({message:(f==null?void 0:f.message)??"Failed to save pipeline.",tone:"error"})}});return{triggerSave:u,isSaving:d}},TL=e=>e==="success"?"":e==="error"?"":"",$L=e=>e==="error"?"text-danger":e==="success"?"text-success":"text-muted",PL=()=>{const[e,t]=y.useState(null);y.useEffect(()=>{if(!e||e.tone==="error"||typeof window>"u")return;const i=window.setTimeout(()=>t(null),e.tone==="success"?4e3:2500);return()=>window.clearTimeout(i)},[e]);const n=y.useMemo(()=>TL(e==null?void 0:e.tone),[e]),s=y.useMemo(()=>$L(e==null?void 0:e.tone),[e]);return{saveFeedback:e,setSaveFeedback:t,feedbackIcon:n,feedbackClass:s}},RL=({activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:i,canSelectDatasets:l,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:f,onDatasetSelection:h,onClearCanvas:p,onRefreshHistory:g,onSaveClick:_,isHistoryLoading:N,historyErrorMessage:v,historyItems:x,activePipelineId:j,isDirty:k,isSaving:S,saveFeedback:C,feedbackIcon:w,feedbackClass:E,onSelectHistory:A})=>({sidepanelProps:{activePipelineUpdatedAt:e,datasetErrorMessage:t,isDatasetLoading:n,hasDatasets:s,ownedDatasetsCount:i,canSelectDatasets:l,datasetOptions:c,selectedDataset:u,activeSourceId:d,canClearCanvas:f,onDatasetSelection:h,onClearCanvas:p,onRefreshHistory:g,onSaveClick:_,isHistoryLoading:N,historyErrorMessage:v,historyItems:x,activePipelineId:j,isDirty:k,isSaveDisabled:!d||S,saveButtonLabel:S?"Saving":k?"Save draft*":"Save draft",saveFeedback:C,feedbackIcon:w,feedbackClass:E,onSelectHistory:A}}),LL=(e=!0)=>{const[t,n]=y.useState(e),s=y.useCallback(()=>{n(i=>!i)},[]);return{isSidepanelExpanded:t,handleToggleSidepanel:s}},zL=e=>{const t=e==null?void 0:e.type;return!t||t==="smoothstep"||t==="default"?"animatedEdge":t},DL=({snapshot:e,selectedDataset:t,activeSourceId:n})=>{const s=e.nodes??[],i=e.edges??[];return{name:t!=null&&t.name?`Draft pipeline for ${t.name}`:`Draft pipeline for ${n}`,graph:{nodes:s,edges:i.map(l=>({...l,animated:(l==null?void 0:l.animated)??!0,type:zL(l)}))},metadata:{lastClientSave:new Date().toISOString(),nodeCount:s.length,edgeCount:i.length}}},FL=({sourceId:e})=>{const t=ho(),n=y.useRef(null),s=y.useRef(!0),{isSidepanelExpanded:i,handleToggleSidepanel:l}=LL(!0),[c,u]=y.useState(!1),{saveFeedback:d,setSaveFeedback:f,feedbackIcon:h,feedbackClass:p}=PL(),{selectedDataset:g,activeSourceId:_,datasetOptions:N,canSelectDatasets:v,hasDatasets:x,ownedDatasetsCount:j,isDatasetLoading:k,datasetErrorMessage:S,handleDatasetSelection:C}=SL({sourceId:e,setIsDirty:u,setSaveFeedback:f,isHydratingRef:s}),[w,E]=y.useState(null),[A,R]=y.useState(null),[P,T]=y.useState(null),O=y.useMemo(()=>["feature-canvas","pipeline",_],[_]),F=y.useRef(null),{graphSnapshotRef:B,canClearCanvas:L,handleGraphChange:D,applyHydratedSnapshot:q}=EL({setIsDirty:u,setSaveFeedback:f,isHydratingRef:s}),Y=kL({canvasShellRef:n,canClearCanvas:L,setSaveFeedback:f}),{historyItems:W,isHistoryLoading:X,historyErrorMessage:I,refetchHistory:z,handleHistorySelection:H}=ML({activeSourceId:_,isDirty:c,setSaveFeedback:f,pipelineQueryKey:O,pendingHistoryIdRef:F,isHydratingRef:s}),{triggerSave:te,isSaving:K}=OL({queryClient:t,setSaveFeedback:f,setIsDirty:u,setActivePipelineId:E,setActivePipelineName:T,setActivePipelineUpdatedAt:R,pendingHistoryIdRef:F}),{handlePipelineHydrated:V,handlePipelineError:G}=AL({applyHydratedSnapshot:q,selectedDataset:g,activeSourceId:_,setActivePipelineId:E,setActivePipelineName:T,setActivePipelineUpdatedAt:R,setIsDirty:u,setSaveFeedback:f,pendingHistoryIdRef:F,isHydratingRef:s}),Q=y.useCallback(()=>{if(!_){f({message:"Select a dataset before saving.",tone:"error"});return}const J=B.current;if(!J.nodes||!J.nodes.length){f({message:"Add nodes to the canvas before saving.",tone:"error"});return}const re=DL({snapshot:J,selectedDataset:g,activeSourceId:_});f({message:"Saving draft",tone:"info"}),te({sourceId:_,payload:re})},[_,g==null?void 0:g.name,te]),{sidepanelProps:ne}=RL({activePipelineUpdatedAt:A,datasetErrorMessage:S,isDatasetLoading:k,hasDatasets:x,ownedDatasetsCount:j,canSelectDatasets:v,datasetOptions:N,selectedDataset:g,activeSourceId:_,canClearCanvas:L,onDatasetSelection:C,onClearCanvas:Y,onRefreshHistory:()=>{z()},onSaveClick:Q,isHistoryLoading:X,historyErrorMessage:I,historyItems:W,activePipelineId:w,isDirty:c,isSaving:K,saveFeedback:d,feedbackIcon:h,feedbackClass:p,onSelectHistory:H});return a.jsxs("div",{className:"feature-canvas-app","data-sidepanel-expanded":i?"true":"false",children:[a.jsx("button",{type:"button",className:"canvas-sidepanel__toggle",onClick:l,"aria-label":i?"Collapse details panel":"Expand details panel","aria-expanded":i,"aria-controls":"feature-canvas-sidepanel",children:i?"":""}),!i&&d&&a.jsxs("div",{className:`canvas-sidepanel__feedback canvas-sidepanel__feedback--floating ${p}`,children:[a.jsx("span",{className:"canvas-sidepanel__feedback-icon","aria-hidden":"true",children:h}),a.jsx("span",{className:"canvas-sidepanel__feedback-text",children:d.message})]}),i&&a.jsx(jL,{...ne}),a.jsx("div",{className:"feature-canvas-app__viewport",children:a.jsx(Qv,{children:a.jsx(NL,{ref:n,sourceId:_,datasetName:(g==null?void 0:g.name)??(g==null?void 0:g.source_id)??null,onGraphChange:D,onPipelineHydrated:V,onPipelineError:G})})})]})},IL=new _N,lf=document.getElementById("ml-workflow-root");if(!lf)throw new Error("ML workflow root element not found");const BL=fm.createRoot(lf),UL=lf.getAttribute("data-source-id")||void 0;BL.render(a.jsx(ge.StrictMode,{children:a.jsx(vN,{client:IL,children:a.jsx(FL,{sourceId:UL})})}))})();
//# sourceMappingURL=feature-canvas.js.map
